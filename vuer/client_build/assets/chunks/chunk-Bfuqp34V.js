const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/chunk-Dhe4rJMi.js","assets/chunks/chunk-CJqYWPfW.js","assets/static/onRenderClient.C5hpRi0h.css","assets/chunks/chunk-D7HrI6pR.js","assets/chunks/chunk-CY_2iGUk.js"])))=>i.map(i=>d[i]);
var Mee=Object.defineProperty;var Cee=(t,e,n)=>e in t?Mee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $t=(t,e,n)=>Cee(t,typeof e!="symbol"?e+"":e,n);import{_ as t6}from"./chunk-D7HrI6pR.js";import{r as v,g as Zd,j as H,d as n6,o as Ge,R as WB,h as r6,k as Ree,e as pi,H as $B}from"./chunk-CJqYWPfW.js";function It(){return It=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},It.apply(null,arguments)}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const wl="171",Fc={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Uc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},XB=0,jA=1,qB=2,Iee=3,YB=0,pb=1,s1=2,gl=3,Cs=0,zi=1,Nr=2,$a=0,ec=1,A3=2,VA=3,WA=4,mb=5,Ku=100,KB=101,ZB=102,QB=103,JB=104,ez=200,gb=201,tz=202,nz=203,O1=204,M3=205,rz=206,iz=207,sz=208,oz=209,az=210,lz=211,cz=212,uz=213,fz=214,C3=0,R3=1,I3=2,Ud=3,P3=4,k3=5,L3=6,D3=7,fy=0,dz=1,hz=2,Xa=0,i6=1,s6=2,o6=3,yb=4,a6=5,pz=6,mz=7,$A="attached",gz="detached",uf=300,sc=301,ff=302,pm=303,F1=304,Lm=306,Or=1e3,ei=1001,Bd=1002,zn=1003,dy=1004,Pee=1004,Zu=1005,kee=1005,Pn=1006,Td=1007,Lee=1007,Ts=1008,XA=1008,Rs=1009,mm=1010,hy=1011,df=1012,rf=1013,io=1014,pr=1015,ti=1016,vb=1017,xb=1018,zd=1020,l6=35902,c6=1021,u6=1022,Pr=1023,f6=1024,d6=1025,sf=1026,Hd=1027,Yc=1028,Dm=1029,_b=1030,Nm=1031,Dee=1032,hf=1033,o1=33776,a1=33777,l1=33778,c1=33779,N3=35840,O3=35841,F3=35842,U3=35843,B3=36196,z3=37492,H3=37496,G3=37808,j3=37809,V3=37810,W3=37811,$3=37812,X3=37813,q3=37814,Y3=37815,K3=37816,Z3=37817,Q3=37818,J3=37819,e_=37820,t_=37821,u1=36492,n_=36494,r_=36495,h6=36283,i_=36284,s_=36285,o_=36286,yz=2200,vz=2201,xz=2202,Gd=2300,pf=2301,l3=2302,md=2400,gd=2401,U1=2402,bb=2500,p6=2501,m6=0,py=1,jd=2,_z=3200,g6=3201,Nee=3202,Oee=3203,du=0,bz=1,ss="",Er="srgb",as="srgb-linear",B1="linear",Dr="srgb",Fee=0,$l=7680,c3=7681,Uee=7682,Bee=7683,zee=34055,Hee=34056,Gee=5386,jee=512,Vee=513,Ez=514,Wee=515,$ee=516,wz=517,Xee=518,a_=519,Sz=512,Tz=513,Az=514,y6=515,Mz=516,Cz=517,Rz=518,Iz=519,z1=35044,Ji=35048,qee=35040,Yee=35045,Kee=35049,Zee=35041,Qee=35046,Jee=35050,ete=35042,tte="100",qA="300 es",Ql=2e3,H1=2001;let uc=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(n);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}};const Ys=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let O7=1234567;const Ad=Math.PI/180,gm=180/Math.PI;function ha(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Ys[t&255]+Ys[t>>8&255]+Ys[t>>16&255]+Ys[t>>24&255]+"-"+Ys[e&255]+Ys[e>>8&255]+"-"+Ys[e>>16&15|64]+Ys[e>>24&255]+"-"+Ys[n&63|128]+Ys[n>>8&255]+"-"+Ys[n>>16&255]+Ys[n>>24&255]+Ys[r&255]+Ys[r>>8&255]+Ys[r>>16&255]+Ys[r>>24&255]).toLowerCase()}function Wn(t,e,n){return Math.max(e,Math.min(n,t))}function v6(t,e){return(t%e+e)%e}function nte(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)}function rte(t,e,n){return t!==e?(n-t)/(e-t):0}function f1(t,e,n){return(1-n)*t+n*e}function ite(t,e,n,r){return f1(t,e,1-Math.exp(-n*r))}function ste(t,e=1){return e-Math.abs(v6(t,e*2)-e)}function ote(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function ate(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function lte(t,e){return t+Math.floor(Math.random()*(e-t+1))}function cte(t,e){return t+Math.random()*(e-t)}function ute(t){return t*(.5-Math.random())}function fte(t){t!==void 0&&(O7=t);let e=O7+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function dte(t){return t*Ad}function hte(t){return t*gm}function pte(t){return(t&t-1)===0&&t!==0}function mte(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function gte(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function yte(t,e,n,r,i){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+r)/2),u=o((e+r)/2),f=s((e-r)/2),d=o((e-r)/2),h=s((r-e)/2),p=o((r-e)/2);switch(i){case"XYX":t.set(a*u,l*f,l*d,a*c);break;case"YZY":t.set(l*d,a*u,l*f,a*c);break;case"ZXZ":t.set(l*f,l*d,a*u,a*c);break;case"XZX":t.set(a*u,l*p,l*h,a*c);break;case"YXY":t.set(l*h,a*u,l*p,a*c);break;case"ZYZ":t.set(l*p,l*h,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function wo(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Yn(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const ri={DEG2RAD:Ad,RAD2DEG:gm,generateUUID:ha,clamp:Wn,euclideanModulo:v6,mapLinear:nte,inverseLerp:rte,lerp:f1,damp:ite,pingpong:ste,smoothstep:ote,smootherstep:ate,randInt:lte,randFloat:cte,randFloatSpread:ute,seededRandom:fte,degToRad:dte,radToDeg:hte,isPowerOfTwo:pte,ceilPowerOfTwo:mte,floorPowerOfTwo:gte,setQuaternionFromProperEuler:yte,normalize:Yn,denormalize:wo};class Ke{constructor(e=0,n=0){Ke.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,i=e.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Wn(this.x,e.x,n.x),this.y=Wn(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Wn(this.x,e,n),this.y=Wn(this.y,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Wn(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Wn(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),i=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ln{constructor(e,n,r,i,s,o,a,l,c){Ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,i,s,o,a,l,c)}set(e,n,r,i,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=n,u[4]=s,u[5]=l,u[6]=r,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,s=this.elements,o=r[0],a=r[3],l=r[6],c=r[1],u=r[4],f=r[7],d=r[2],h=r[5],p=r[8],m=i[0],g=i[3],y=i[6],x=i[1],_=i[4],w=i[7],T=i[2],S=i[5],C=i[8];return s[0]=o*m+a*x+l*T,s[3]=o*g+a*_+l*S,s[6]=o*y+a*w+l*C,s[1]=c*m+u*x+f*T,s[4]=c*g+u*_+f*S,s[7]=c*y+u*w+f*C,s[2]=d*m+h*x+p*T,s[5]=d*g+h*_+p*S,s[8]=d*y+h*w+p*C,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return n*o*u-n*a*c-r*s*u+r*a*l+i*s*c-i*o*l}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=u*o-a*c,d=a*l-u*s,h=c*s-o*l,p=n*f+r*d+i*h;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=f*m,e[1]=(i*c-u*r)*m,e[2]=(a*r-i*o)*m,e[3]=d*m,e[4]=(u*n-i*l)*m,e[5]=(i*s-a*n)*m,e[6]=h*m,e[7]=(r*l-c*n)*m,e[8]=(o*n-r*s)*m,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,i,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*o+c*a)+o+e,-i*c,i*l,-i*(-c*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(vS.makeScale(e,n)),this}rotate(e){return this.premultiply(vS.makeRotation(-e)),this}translate(e,n){return this.premultiply(vS.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const vS=new Ln;function Pz(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const vte={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function jp(t,e){return new vte[t](e)}function G1(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function kz(){const t=G1("canvas");return t.style.display="block",t}const F7={};function Np(t){t in F7||(F7[t]=!0,console.warn(t))}function xte(t,e,n){return new Promise(function(r,i){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:i();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:r()}}setTimeout(s,n)})}function _te(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function bte(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const U7=new Ln().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),B7=new Ln().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Ete(){const t={enabled:!0,workingColorSpace:as,spaces:{},convert:function(i,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===Dr&&(i.r=Kc(i.r),i.g=Kc(i.g),i.b=Kc(i.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Dr&&(i.r=im(i.r),i.g=im(i.g),i.b=im(i.b))),i},fromWorkingColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},toWorkingColorSpace:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===ss?B1:this.spaces[i].transfer},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,o){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return t.define({[as]:{primaries:e,whitePoint:r,transfer:B1,toXYZ:U7,fromXYZ:B7,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Er},outputColorSpaceConfig:{drawingBufferColorSpace:Er}},[Er]:{primaries:e,whitePoint:r,transfer:Dr,toXYZ:U7,fromXYZ:B7,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Er}}}),t}const er=Ete();function Kc(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function im(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let kh;class Lz{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{kh===void 0&&(kh=G1("canvas")),kh.width=e.width,kh.height=e.height;const r=kh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=kh}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=G1("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=Kc(s[o]/255)*255;return r.putImageData(i,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(Kc(n[r]/255)*255):n[r]=Kc(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let wte=0;class yd{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:wte++}),this.uuid=ha(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(xS(i[o].image)):s.push(xS(i[o]))}else s=xS(i);r.url=s}return n||(e.images[this.uuid]=r),r}}function xS(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?Lz.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Ste=0,tr=class u3 extends uc{constructor(e=u3.DEFAULT_IMAGE,n=u3.DEFAULT_MAPPING,r=ei,i=ei,s=Pn,o=Ts,a=Pr,l=Rs,c=u3.DEFAULT_ANISOTROPY,u=ss){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Ste++}),this.uuid=ha(),this.name="",this.source=new yd(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ke(0,0),this.repeat=new Ke(1,1),this.center=new Ke(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==uf)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Or:e.x=e.x-Math.floor(e.x);break;case ei:e.x=e.x<0?0:1;break;case Bd:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Or:e.y=e.y-Math.floor(e.y);break;case ei:e.y=e.y<0?0:1;break;case Bd:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};tr.DEFAULT_IMAGE=null;tr.DEFAULT_MAPPING=uf;tr.DEFAULT_ANISOTROPY=1;class Hn{constructor(e=0,n=0,r=0,i=1){Hn.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,i){return this.x=e,this.y=n,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*n+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*n+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*n+o[7]*r+o[11]*i+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,i,s;const l=e.elements,c=l[0],u=l[4],f=l[8],d=l[1],h=l[5],p=l[9],m=l[2],g=l[6],y=l[10];if(Math.abs(u-d)<.01&&Math.abs(f-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+d)<.1&&Math.abs(f+m)<.1&&Math.abs(p+g)<.1&&Math.abs(c+h+y-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const _=(c+1)/2,w=(h+1)/2,T=(y+1)/2,S=(u+d)/4,C=(f+m)/4,A=(p+g)/4;return _>w&&_>T?_<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(_),i=S/r,s=C/r):w>T?w<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(w),r=S/i,s=A/i):T<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(T),r=C/s,i=A/s),this.set(r,i,s,n),this}let x=Math.sqrt((g-p)*(g-p)+(f-m)*(f-m)+(d-u)*(d-u));return Math.abs(x)<.001&&(x=1),this.x=(g-p)/x,this.y=(f-m)/x,this.z=(d-u)/x,this.w=Math.acos((c+h+y-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Wn(this.x,e.x,n.x),this.y=Wn(this.y,e.y,n.y),this.z=Wn(this.z,e.z,n.z),this.w=Wn(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Wn(this.x,e,n),this.y=Wn(this.y,e,n),this.z=Wn(this.z,e,n),this.w=Wn(this.w,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Wn(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Dz extends uc{constructor(e=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Hn(0,0,e,n),this.scissorTest=!1,this.viewport=new Hn(0,0,e,n);const i={width:e,height:n,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Pn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const s=new tr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);s.flipY=!1,s.generateMipmaps=r.generateMipmaps,s.internalFormat=r.internalFormat,this.textures=[];const o=r.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=n,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,i=e.textures.length;r<i;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new yd(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class fr extends Dz{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class Eb extends tr{constructor(e=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=zn,this.minFilter=zn,this.wrapR=ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Tte extends fr{constructor(e=1,n=1,r=1,i={}){super(e,n,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new Eb(null,e,n,r),this.texture.isRenderTargetTexture=!0}}class x6 extends tr{constructor(e=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=zn,this.minFilter=zn,this.wrapR=ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ate extends fr{constructor(e=1,n=1,r=1,i={}){super(e,n,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new x6(null,e,n,r),this.texture.isRenderTargetTexture=!0}}class bn{constructor(e=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}static slerpFlat(e,n,r,i,s,o,a){let l=r[i+0],c=r[i+1],u=r[i+2],f=r[i+3];const d=s[o+0],h=s[o+1],p=s[o+2],m=s[o+3];if(a===0){e[n+0]=l,e[n+1]=c,e[n+2]=u,e[n+3]=f;return}if(a===1){e[n+0]=d,e[n+1]=h,e[n+2]=p,e[n+3]=m;return}if(f!==m||l!==d||c!==h||u!==p){let g=1-a;const y=l*d+c*h+u*p+f*m,x=y>=0?1:-1,_=1-y*y;if(_>Number.EPSILON){const T=Math.sqrt(_),S=Math.atan2(T,y*x);g=Math.sin(g*S)/T,a=Math.sin(a*S)/T}const w=a*x;if(l=l*g+d*w,c=c*g+h*w,u=u*g+p*w,f=f*g+m*w,g===1-a){const T=1/Math.sqrt(l*l+c*c+u*u+f*f);l*=T,c*=T,u*=T,f*=T}}e[n]=l,e[n+1]=c,e[n+2]=u,e[n+3]=f}static multiplyQuaternionsFlat(e,n,r,i,s,o){const a=r[i],l=r[i+1],c=r[i+2],u=r[i+3],f=s[o],d=s[o+1],h=s[o+2],p=s[o+3];return e[n]=a*p+u*f+l*h-c*d,e[n+1]=l*p+u*d+c*f-a*h,e[n+2]=c*p+u*h+a*d-l*f,e[n+3]=u*p-a*f-l*d-c*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(r/2),u=a(i/2),f=a(s/2),d=l(r/2),h=l(i/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*f+c*h*p,this._y=c*h*f-d*u*p,this._z=c*u*p+d*h*f,this._w=c*u*f-d*h*p;break;case"YXZ":this._x=d*u*f+c*h*p,this._y=c*h*f-d*u*p,this._z=c*u*p-d*h*f,this._w=c*u*f+d*h*p;break;case"ZXY":this._x=d*u*f-c*h*p,this._y=c*h*f+d*u*p,this._z=c*u*p+d*h*f,this._w=c*u*f-d*h*p;break;case"ZYX":this._x=d*u*f-c*h*p,this._y=c*h*f+d*u*p,this._z=c*u*p-d*h*f,this._w=c*u*f+d*h*p;break;case"YZX":this._x=d*u*f+c*h*p,this._y=c*h*f+d*u*p,this._z=c*u*p-d*h*f,this._w=c*u*f-d*h*p;break;case"XZY":this._x=d*u*f-c*h*p,this._y=c*h*f-d*u*p,this._z=c*u*p+d*h*f,this._w=c*u*f+d*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],i=n[4],s=n[8],o=n[1],a=n[5],l=n[9],c=n[2],u=n[6],f=n[10],d=r+a+f;if(d>0){const h=.5/Math.sqrt(d+1);this._w=.25/h,this._x=(u-l)*h,this._y=(s-c)*h,this._z=(o-i)*h}else if(r>a&&r>f){const h=2*Math.sqrt(1+r-a-f);this._w=(u-l)/h,this._x=.25*h,this._y=(i+o)/h,this._z=(s+c)/h}else if(a>f){const h=2*Math.sqrt(1+a-r-f);this._w=(s-c)/h,this._x=(i+o)/h,this._y=.25*h,this._z=(l+u)/h}else{const h=2*Math.sqrt(1+f-r-a);this._w=(o-i)/h,this._x=(s+c)/h,this._y=(l+u)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Wn(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,i=e._y,s=e._z,o=e._w,a=n._x,l=n._y,c=n._z,u=n._w;return this._x=r*u+o*a+i*c-s*l,this._y=i*u+o*l+s*a-r*c,this._z=s*u+o*c+r*l-i*a,this._w=o*u-r*a-i*l-s*c,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const h=1-n;return this._w=h*o+n*this._w,this._x=h*r+n*this._x,this._y=h*i+n*this._y,this._z=h*s+n*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),f=Math.sin((1-n)*u)/c,d=Math.sin(n*u)/c;return this._w=o*f+this._w*d,this._x=r*f+this._x*d,this._y=i*f+this._y*d,this._z=s*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ${constructor(e=0,n=0,r=0){$.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(z7.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(z7.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*n+s[3]*r+s[6]*i,this.y=s[1]*n+s[4]*r+s[7]*i,this.z=s[2]*n+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*n+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*n+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*n+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*n+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const n=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*i-a*r),u=2*(a*n-s*i),f=2*(s*r-o*n);return this.x=n+l*c+o*f-a*u,this.y=r+l*u+a*c-s*f,this.z=i+l*f+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*n+s[4]*r+s[8]*i,this.y=s[1]*n+s[5]*r+s[9]*i,this.z=s[2]*n+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Wn(this.x,e.x,n.x),this.y=Wn(this.y,e.y,n.y),this.z=Wn(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Wn(this.x,e,n),this.y=Wn(this.y,e,n),this.z=Wn(this.z,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Wn(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,i=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=i*l-s*a,this.y=s*o-r*l,this.z=r*a-i*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return _S.copy(this).projectOnVector(e),this.sub(_S)}reflect(e){return this.sub(_S.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Wn(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n*n+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const i=Math.sin(n)*e;return this.x=i*Math.sin(r),this.y=Math.cos(n)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(e),this.y=n,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _S=new $,z7=new bn;class Kn{constructor(e=new $(1/0,1/0,1/0),n=new $(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(al.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(al.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=al.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,al):al.fromBufferAttribute(s,o),al.applyMatrix4(e.matrixWorld),this.expandByPoint(al);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Gv.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Gv.copy(r.boundingBox)),Gv.applyMatrix4(e.matrixWorld),this.union(Gv)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,al),al.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(N0),jv.subVectors(this.max,N0),Lh.subVectors(e.a,N0),Dh.subVectors(e.b,N0),Nh.subVectors(e.c,N0),Cu.subVectors(Dh,Lh),Ru.subVectors(Nh,Dh),Vf.subVectors(Lh,Nh);let n=[0,-Cu.z,Cu.y,0,-Ru.z,Ru.y,0,-Vf.z,Vf.y,Cu.z,0,-Cu.x,Ru.z,0,-Ru.x,Vf.z,0,-Vf.x,-Cu.y,Cu.x,0,-Ru.y,Ru.x,0,-Vf.y,Vf.x,0];return!bS(n,Lh,Dh,Nh,jv)||(n=[1,0,0,0,1,0,0,0,1],!bS(n,Lh,Dh,Nh,jv))?!1:(Vv.crossVectors(Cu,Ru),n=[Vv.x,Vv.y,Vv.z],bS(n,Lh,Dh,Nh,jv))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,al).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(al).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(xc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const xc=[new $,new $,new $,new $,new $,new $,new $,new $],al=new $,Gv=new Kn,Lh=new $,Dh=new $,Nh=new $,Cu=new $,Ru=new $,Vf=new $,N0=new $,jv=new $,Vv=new $,Wf=new $;function bS(t,e,n,r,i){for(let s=0,o=t.length-3;s<=o;s+=3){Wf.fromArray(t,s);const a=i.x*Math.abs(Wf.x)+i.y*Math.abs(Wf.y)+i.z*Math.abs(Wf.z),l=e.dot(Wf),c=n.dot(Wf),u=r.dot(Wf);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const Mte=new Kn,O0=new $,ES=new $;let wr=class{constructor(e=new $,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):Mte.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;O0.subVectors(e,this.center);const n=O0.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(O0,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ES.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(O0.copy(e.center).add(ES)),this.expandByPoint(O0.copy(e.center).sub(ES))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const _c=new $,wS=new $,Wv=new $,Iu=new $,SS=new $,$v=new $,TS=new $;class Yo{constructor(e=new $,n=new $(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,_c)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=_c.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(_c.copy(this.origin).addScaledVector(this.direction,n),_c.distanceToSquared(e))}distanceSqToSegment(e,n,r,i){wS.copy(e).add(n).multiplyScalar(.5),Wv.copy(n).sub(e).normalize(),Iu.copy(this.origin).sub(wS);const s=e.distanceTo(n)*.5,o=-this.direction.dot(Wv),a=Iu.dot(this.direction),l=-Iu.dot(Wv),c=Iu.lengthSq(),u=Math.abs(1-o*o);let f,d,h,p;if(u>0)if(f=o*l-a,d=o*a-l,p=s*u,f>=0)if(d>=-p)if(d<=p){const m=1/u;f*=m,d*=m,h=f*(f+o*d+2*a)+d*(o*f+d+2*l)+c}else d=s,f=Math.max(0,-(o*d+a)),h=-f*f+d*(d+2*l)+c;else d=-s,f=Math.max(0,-(o*d+a)),h=-f*f+d*(d+2*l)+c;else d<=-p?(f=Math.max(0,-(-o*s+a)),d=f>0?-s:Math.min(Math.max(-s,-l),s),h=-f*f+d*(d+2*l)+c):d<=p?(f=0,d=Math.min(Math.max(-s,-l),s),h=d*(d+2*l)+c):(f=Math.max(0,-(o*s+a)),d=f>0?s:Math.min(Math.max(-s,-l),s),h=-f*f+d*(d+2*l)+c);else d=o>0?-s:s,f=Math.max(0,-(o*d+a)),h=-f*f+d*(d+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(wS).addScaledVector(Wv,d),h}intersectSphere(e,n){_c.subVectors(e.center,this.origin);const r=_c.dot(this.direction),i=_c.dot(_c)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,i,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,d=this.origin;return c>=0?(r=(e.min.x-d.x)*c,i=(e.max.x-d.x)*c):(r=(e.max.x-d.x)*c,i=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),f>=0?(a=(e.min.z-d.z)*f,l=(e.max.z-d.z)*f):(a=(e.max.z-d.z)*f,l=(e.min.z-d.z)*f),r>l||a>i)||((a>r||r!==r)&&(r=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(e){return this.intersectBox(e,_c)!==null}intersectTriangle(e,n,r,i,s){SS.subVectors(n,e),$v.subVectors(r,e),TS.crossVectors(SS,$v);let o=this.direction.dot(TS),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Iu.subVectors(this.origin,e);const l=a*this.direction.dot($v.crossVectors(Iu,$v));if(l<0)return null;const c=a*this.direction.dot(SS.cross(Iu));if(c<0||l+c>o)return null;const u=-a*Iu.dot(TS);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class et{constructor(e,n,r,i,s,o,a,l,c,u,f,d,h,p,m,g){et.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,i,s,o,a,l,c,u,f,d,h,p,m,g)}set(e,n,r,i,s,o,a,l,c,u,f,d,h,p,m,g){const y=this.elements;return y[0]=e,y[4]=n,y[8]=r,y[12]=i,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=f,y[14]=d,y[3]=h,y[7]=p,y[11]=m,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new et().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,i=1/Oh.setFromMatrixColumn(e,0).length(),s=1/Oh.setFromMatrixColumn(e,1).length(),o=1/Oh.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*s,n[5]=r[5]*s,n[6]=r[6]*s,n[7]=0,n[8]=r[8]*o,n[9]=r[9]*o,n[10]=r[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const d=o*u,h=o*f,p=a*u,m=a*f;n[0]=l*u,n[4]=-l*f,n[8]=c,n[1]=h+p*c,n[5]=d-m*c,n[9]=-a*l,n[2]=m-d*c,n[6]=p+h*c,n[10]=o*l}else if(e.order==="YXZ"){const d=l*u,h=l*f,p=c*u,m=c*f;n[0]=d+m*a,n[4]=p*a-h,n[8]=o*c,n[1]=o*f,n[5]=o*u,n[9]=-a,n[2]=h*a-p,n[6]=m+d*a,n[10]=o*l}else if(e.order==="ZXY"){const d=l*u,h=l*f,p=c*u,m=c*f;n[0]=d-m*a,n[4]=-o*f,n[8]=p+h*a,n[1]=h+p*a,n[5]=o*u,n[9]=m-d*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){const d=o*u,h=o*f,p=a*u,m=a*f;n[0]=l*u,n[4]=p*c-h,n[8]=d*c+m,n[1]=l*f,n[5]=m*c+d,n[9]=h*c-p,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){const d=o*l,h=o*c,p=a*l,m=a*c;n[0]=l*u,n[4]=m-d*f,n[8]=p*f+h,n[1]=f,n[5]=o*u,n[9]=-a*u,n[2]=-c*u,n[6]=h*f+p,n[10]=d-m*f}else if(e.order==="XZY"){const d=o*l,h=o*c,p=a*l,m=a*c;n[0]=l*u,n[4]=-f,n[8]=c*u,n[1]=d*f+m,n[5]=o*u,n[9]=h*f-p,n[2]=p*f-h,n[6]=a*u,n[10]=m*f+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Cte,e,Rte)}lookAt(e,n,r){const i=this.elements;return na.subVectors(e,n),na.lengthSq()===0&&(na.z=1),na.normalize(),Pu.crossVectors(r,na),Pu.lengthSq()===0&&(Math.abs(r.z)===1?na.x+=1e-4:na.z+=1e-4,na.normalize(),Pu.crossVectors(r,na)),Pu.normalize(),Xv.crossVectors(na,Pu),i[0]=Pu.x,i[4]=Xv.x,i[8]=na.x,i[1]=Pu.y,i[5]=Xv.y,i[9]=na.y,i[2]=Pu.z,i[6]=Xv.z,i[10]=na.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,s=this.elements,o=r[0],a=r[4],l=r[8],c=r[12],u=r[1],f=r[5],d=r[9],h=r[13],p=r[2],m=r[6],g=r[10],y=r[14],x=r[3],_=r[7],w=r[11],T=r[15],S=i[0],C=i[4],A=i[8],R=i[12],M=i[1],D=i[5],k=i[9],L=i[13],N=i[2],z=i[6],O=i[10],K=i[14],V=i[3],ne=i[7],re=i[11],P=i[15];return s[0]=o*S+a*M+l*N+c*V,s[4]=o*C+a*D+l*z+c*ne,s[8]=o*A+a*k+l*O+c*re,s[12]=o*R+a*L+l*K+c*P,s[1]=u*S+f*M+d*N+h*V,s[5]=u*C+f*D+d*z+h*ne,s[9]=u*A+f*k+d*O+h*re,s[13]=u*R+f*L+d*K+h*P,s[2]=p*S+m*M+g*N+y*V,s[6]=p*C+m*D+g*z+y*ne,s[10]=p*A+m*k+g*O+y*re,s[14]=p*R+m*L+g*K+y*P,s[3]=x*S+_*M+w*N+T*V,s[7]=x*C+_*D+w*z+T*ne,s[11]=x*A+_*k+w*O+T*re,s[15]=x*R+_*L+w*K+T*P,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],f=e[6],d=e[10],h=e[14],p=e[3],m=e[7],g=e[11],y=e[15];return p*(+s*l*f-i*c*f-s*a*d+r*c*d+i*a*h-r*l*h)+m*(+n*l*h-n*c*d+s*o*d-i*o*h+i*c*u-s*l*u)+g*(+n*c*f-n*a*h-s*o*f+r*o*h+s*a*u-r*c*u)+y*(-i*a*u-n*l*f+n*a*d+i*o*f-r*o*d+r*l*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=n,i[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=e[9],d=e[10],h=e[11],p=e[12],m=e[13],g=e[14],y=e[15],x=f*g*c-m*d*c+m*l*h-a*g*h-f*l*y+a*d*y,_=p*d*c-u*g*c-p*l*h+o*g*h+u*l*y-o*d*y,w=u*m*c-p*f*c+p*a*h-o*m*h-u*a*y+o*f*y,T=p*f*l-u*m*l-p*a*d+o*m*d+u*a*g-o*f*g,S=n*x+r*_+i*w+s*T;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/S;return e[0]=x*C,e[1]=(m*d*s-f*g*s-m*i*h+r*g*h+f*i*y-r*d*y)*C,e[2]=(a*g*s-m*l*s+m*i*c-r*g*c-a*i*y+r*l*y)*C,e[3]=(f*l*s-a*d*s-f*i*c+r*d*c+a*i*h-r*l*h)*C,e[4]=_*C,e[5]=(u*g*s-p*d*s+p*i*h-n*g*h-u*i*y+n*d*y)*C,e[6]=(p*l*s-o*g*s-p*i*c+n*g*c+o*i*y-n*l*y)*C,e[7]=(o*d*s-u*l*s+u*i*c-n*d*c-o*i*h+n*l*h)*C,e[8]=w*C,e[9]=(p*f*s-u*m*s-p*r*h+n*m*h+u*r*y-n*f*y)*C,e[10]=(o*m*s-p*a*s+p*r*c-n*m*c-o*r*y+n*a*y)*C,e[11]=(u*a*s-o*f*s-u*r*c+n*f*c+o*r*h-n*a*h)*C,e[12]=T*C,e[13]=(u*m*i-p*f*i+p*r*d-n*m*d-u*r*g+n*f*g)*C,e[14]=(p*a*i-o*m*i-p*r*l+n*m*l+o*r*g-n*a*g)*C,e[15]=(o*f*i-u*a*i+u*r*l-n*f*l-o*r*d+n*a*d)*C,this}scale(e){const n=this.elements,r=e.x,i=e.y,s=e.z;return n[0]*=r,n[4]*=i,n[8]*=s,n[1]*=r,n[5]*=i,n[9]*=s,n[2]*=r,n[6]*=i,n[10]*=s,n[3]*=r,n[7]*=i,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),i=Math.sin(n),s=1-r,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+r,c*a-i*l,c*l+i*a,0,c*a+i*l,u*a+r,u*l-i*o,0,c*l-i*a,u*l+i*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,n,i,1,0,0,0,0,1),this}compose(e,n,r){const i=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,u=o+o,f=a+a,d=s*c,h=s*u,p=s*f,m=o*u,g=o*f,y=a*f,x=l*c,_=l*u,w=l*f,T=r.x,S=r.y,C=r.z;return i[0]=(1-(m+y))*T,i[1]=(h+w)*T,i[2]=(p-_)*T,i[3]=0,i[4]=(h-w)*S,i[5]=(1-(d+y))*S,i[6]=(g+x)*S,i[7]=0,i[8]=(p+_)*C,i[9]=(g-x)*C,i[10]=(1-(d+m))*C,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,n,r){const i=this.elements;let s=Oh.set(i[0],i[1],i[2]).length();const o=Oh.set(i[4],i[5],i[6]).length(),a=Oh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],ll.copy(this);const c=1/s,u=1/o,f=1/a;return ll.elements[0]*=c,ll.elements[1]*=c,ll.elements[2]*=c,ll.elements[4]*=u,ll.elements[5]*=u,ll.elements[6]*=u,ll.elements[8]*=f,ll.elements[9]*=f,ll.elements[10]*=f,n.setFromRotationMatrix(ll),r.x=s,r.y=o,r.z=a,this}makePerspective(e,n,r,i,s,o,a=Ql){const l=this.elements,c=2*s/(n-e),u=2*s/(r-i),f=(n+e)/(n-e),d=(r+i)/(r-i);let h,p;if(a===Ql)h=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===H1)h=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=h,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,n,r,i,s,o,a=Ql){const l=this.elements,c=1/(n-e),u=1/(r-i),f=1/(o-s),d=(n+e)*c,h=(r+i)*u;let p,m;if(a===Ql)p=(o+s)*f,m=-2*f;else if(a===H1)p=s*f,m=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-h,l[2]=0,l[6]=0,l[10]=m,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const Oh=new $,ll=new et,Cte=new $(0,0,0),Rte=new $(1,1,1),Pu=new $,Xv=new $,na=new $,H7=new et,G7=new bn;class xr{constructor(e=0,n=0,r=0,i=xr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,i=this._order){return this._x=e,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],c=i[5],u=i[9],f=i[2],d=i[6],h=i[10];switch(n){case"XYZ":this._y=Math.asin(Wn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Wn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(Wn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,h),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Wn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Wn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-Wn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return H7.makeRotationFromQuaternion(e),this.setFromRotationMatrix(H7,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return G7.setFromEuler(this),this.setFromQuaternion(G7,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}xr.DEFAULT_ORDER="XYZ";class Md{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Ite=0;const j7=new $,Fh=new bn,bc=new et,qv=new $,F0=new $,Pte=new $,kte=new bn,V7=new $(1,0,0),W7=new $(0,1,0),$7=new $(0,0,1),X7={type:"added"},Lte={type:"removed"},Uh={type:"childadded",child:null},AS={type:"childremoved",child:null};class yn extends uc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Ite++}),this.uuid=ha(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=yn.DEFAULT_UP.clone();const e=new $,n=new xr,r=new bn,i=new $(1,1,1);function s(){r.setFromEuler(n,!1)}function o(){n.setFromQuaternion(r,void 0,!1)}n._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new et},normalMatrix:{value:new Ln}}),this.matrix=new et,this.matrixWorld=new et,this.matrixAutoUpdate=yn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=yn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Md,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Fh.setFromAxisAngle(e,n),this.quaternion.multiply(Fh),this}rotateOnWorldAxis(e,n){return Fh.setFromAxisAngle(e,n),this.quaternion.premultiply(Fh),this}rotateX(e){return this.rotateOnAxis(V7,e)}rotateY(e){return this.rotateOnAxis(W7,e)}rotateZ(e){return this.rotateOnAxis($7,e)}translateOnAxis(e,n){return j7.copy(e).applyQuaternion(this.quaternion),this.position.add(j7.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(V7,e)}translateY(e){return this.translateOnAxis(W7,e)}translateZ(e){return this.translateOnAxis($7,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(bc.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?qv.copy(e):qv.set(e,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),F0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bc.lookAt(F0,qv,this.up):bc.lookAt(qv,F0,this.up),this.quaternion.setFromRotationMatrix(bc),i&&(bc.extractRotation(i.matrixWorld),Fh.setFromRotationMatrix(bc),this.quaternion.premultiply(Fh.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(X7),Uh.child=e,this.dispatchEvent(Uh),Uh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Lte),AS.child=e,this.dispatchEvent(AS),AS.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),bc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),bc.multiply(e.parent.matrixWorld)),e.applyMatrix4(bc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(X7),Uh.child=e,this.dispatchEvent(Uh),Uh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(F0,e,Pte),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(F0,kte,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].updateMatrixWorld(e)}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const f=l[c];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(n){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),f=o(e.shapes),d=o(e.skeletons),h=o(e.animations),p=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),f.length>0&&(r.shapes=f),d.length>0&&(r.skeletons=d),h.length>0&&(r.animations=h),p.length>0&&(r.nodes=p)}return r.object=i,r;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}yn.DEFAULT_UP=new $(0,1,0);yn.DEFAULT_MATRIX_AUTO_UPDATE=!0;yn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const cl=new $,Ec=new $,MS=new $,wc=new $,Bh=new $,zh=new $,q7=new $,CS=new $,RS=new $,IS=new $,PS=new Hn,kS=new Hn,LS=new Hn;class Ci{constructor(e=new $,n=new $,r=new $){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,i){i.subVectors(r,n),cl.subVectors(e,n),i.cross(cl);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,n,r,i,s){cl.subVectors(i,n),Ec.subVectors(r,n),MS.subVectors(e,n);const o=cl.dot(cl),a=cl.dot(Ec),l=cl.dot(MS),c=Ec.dot(Ec),u=Ec.dot(MS),f=o*c-a*a;if(f===0)return s.set(0,0,0),null;const d=1/f,h=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-h-p,p,h)}static containsPoint(e,n,r,i){return this.getBarycoord(e,n,r,i,wc)===null?!1:wc.x>=0&&wc.y>=0&&wc.x+wc.y<=1}static getInterpolation(e,n,r,i,s,o,a,l){return this.getBarycoord(e,n,r,i,wc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,wc.x),l.addScaledVector(o,wc.y),l.addScaledVector(a,wc.z),l)}static getInterpolatedAttribute(e,n,r,i,s,o){return PS.setScalar(0),kS.setScalar(0),LS.setScalar(0),PS.fromBufferAttribute(e,n),kS.fromBufferAttribute(e,r),LS.fromBufferAttribute(e,i),o.setScalar(0),o.addScaledVector(PS,s.x),o.addScaledVector(kS,s.y),o.addScaledVector(LS,s.z),o}static isFrontFacing(e,n,r,i){return cl.subVectors(r,n),Ec.subVectors(e,n),cl.cross(Ec).dot(i)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,i){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,n,r,i){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return cl.subVectors(this.c,this.b),Ec.subVectors(this.a,this.b),cl.cross(Ec).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ci.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Ci.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,r,i,s){return Ci.getInterpolation(e,this.a,this.b,this.c,n,r,i,s)}containsPoint(e){return Ci.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ci.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,i=this.b,s=this.c;let o,a;Bh.subVectors(i,r),zh.subVectors(s,r),CS.subVectors(e,r);const l=Bh.dot(CS),c=zh.dot(CS);if(l<=0&&c<=0)return n.copy(r);RS.subVectors(e,i);const u=Bh.dot(RS),f=zh.dot(RS);if(u>=0&&f<=u)return n.copy(i);const d=l*f-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),n.copy(r).addScaledVector(Bh,o);IS.subVectors(e,s);const h=Bh.dot(IS),p=zh.dot(IS);if(p>=0&&h<=p)return n.copy(s);const m=h*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),n.copy(r).addScaledVector(zh,a);const g=u*p-h*f;if(g<=0&&f-u>=0&&h-p>=0)return q7.subVectors(s,i),a=(f-u)/(f-u+(h-p)),n.copy(i).addScaledVector(q7,a);const y=1/(g+m+d);return o=m*y,a=d*y,n.copy(r).addScaledVector(Bh,o).addScaledVector(zh,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Nz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ku={h:0,s:0,l:0},Yv={h:0,s:0,l:0};function DS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}let wt=class{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Er){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,er.toWorkingColorSpace(this,n),this}setRGB(e,n,r,i=er.workingColorSpace){return this.r=e,this.g=n,this.b=r,er.toWorkingColorSpace(this,i),this}setHSL(e,n,r,i=er.workingColorSpace){if(e=v6(e,1),n=Wn(n,0,1),r=Wn(r,0,1),n===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;this.r=DS(o,s,e+1/3),this.g=DS(o,s,e),this.b=DS(o,s,e-1/3)}return er.toWorkingColorSpace(this,i),this}setStyle(e,n=Er){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Er){const r=Nz[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Kc(e.r),this.g=Kc(e.g),this.b=Kc(e.b),this}copyLinearToSRGB(e){return this.r=im(e.r),this.g=im(e.g),this.b=im(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Er){return er.fromWorkingColorSpace(Ks.copy(this),e),Math.round(Wn(Ks.r*255,0,255))*65536+Math.round(Wn(Ks.g*255,0,255))*256+Math.round(Wn(Ks.b*255,0,255))}getHexString(e=Er){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=er.workingColorSpace){er.fromWorkingColorSpace(Ks.copy(this),n);const r=Ks.r,i=Ks.g,s=Ks.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const f=o-a;switch(c=u<=.5?f/(o+a):f/(2-o-a),o){case r:l=(i-s)/f+(i<s?6:0);break;case i:l=(s-r)/f+2;break;case s:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,n=er.workingColorSpace){return er.fromWorkingColorSpace(Ks.copy(this),n),e.r=Ks.r,e.g=Ks.g,e.b=Ks.b,e}getStyle(e=Er){er.fromWorkingColorSpace(Ks.copy(this),e);const n=Ks.r,r=Ks.g,i=Ks.b;return e!==Er?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,n,r){return this.getHSL(ku),this.setHSL(ku.h+e,ku.s+n,ku.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(ku),e.getHSL(Yv);const r=f1(ku.h,Yv.h,n),i=f1(ku.s,Yv.s,n),s=f1(ku.l,Yv.l,n);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*n+s[3]*r+s[6]*i,this.g=s[1]*n+s[4]*r+s[7]*i,this.b=s[2]*n+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ks=new wt;wt.NAMES=Nz;let Dte=0;class Wr extends uc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dte++}),this.uuid=ha(),this.name="",this.type="Material",this.blending=ec,this.side=Cs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=O1,this.blendDst=M3,this.blendEquation=Ku,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new wt(0,0,0),this.blendAlpha=0,this.depthFunc=Ud,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=a_,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=$l,this.stencilZFail=$l,this.stencilZPass=$l,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==ec&&(r.blending=this.blending),this.side!==Cs&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==O1&&(r.blendSrc=this.blendSrc),this.blendDst!==M3&&(r.blendDst=this.blendDst),this.blendEquation!==Ku&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Ud&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==a_&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==$l&&(r.stencilFail=this.stencilFail),this.stencilZFail!==$l&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==$l&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=n[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Fr extends Wr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xr,this.combine=fy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Hc=Nte();function Nte(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(r[l]=1024>>-c-14,r[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(r[l]=c+15<<10,r[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function Bo(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Wn(t,-65504,65504),Hc.floatView[0]=t;const e=Hc.uint32View[0],n=e>>23&511;return Hc.baseTable[n]+((e&8388607)>>Hc.shiftTable[n])}function $g(t){const e=t>>10;return Hc.uint32View[0]=Hc.mantissaTable[Hc.offsetTable[e]+(t&1023)]+Hc.exponentTable[e],Hc.floatView[0]}const vd={toHalfFloat:Bo,fromHalfFloat:$g},qi=new $,Kv=new Ke;class fn{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=z1,this.updateRanges=[],this.gpuType=pr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=n.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)Kv.fromBufferAttribute(this,n),Kv.applyMatrix3(e),this.setXY(n,Kv.x,Kv.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix3(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix4(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)qi.fromBufferAttribute(this,n),qi.applyNormalMatrix(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)qi.fromBufferAttribute(this,n),qi.transformDirection(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=wo(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Yn(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=wo(n,this.array)),n}setX(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=wo(n,this.array)),n}setY(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=wo(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=wo(n,this.array)),n}setW(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array),i=Yn(i,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,n,r,i,s){return e*=this.itemSize,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array),i=Yn(i,this.array),s=Yn(s,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==z1&&(e.usage=this.usage),e}}class Ote extends fn{constructor(e,n,r){super(new Int8Array(e),n,r)}}class Fte extends fn{constructor(e,n,r){super(new Uint8Array(e),n,r)}}class Ute extends fn{constructor(e,n,r){super(new Uint8ClampedArray(e),n,r)}}class Bte extends fn{constructor(e,n,r){super(new Int16Array(e),n,r)}}class _6 extends fn{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class zte extends fn{constructor(e,n,r){super(new Int32Array(e),n,r)}}class b6 extends fn{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class Hte extends fn{constructor(e,n,r){super(new Uint16Array(e),n,r),this.isFloat16BufferAttribute=!0}getX(e){let n=$g(this.array[e*this.itemSize]);return this.normalized&&(n=wo(n,this.array)),n}setX(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize]=Bo(n),this}getY(e){let n=$g(this.array[e*this.itemSize+1]);return this.normalized&&(n=wo(n,this.array)),n}setY(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+1]=Bo(n),this}getZ(e){let n=$g(this.array[e*this.itemSize+2]);return this.normalized&&(n=wo(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+2]=Bo(n),this}getW(e){let n=$g(this.array[e*this.itemSize+3]);return this.normalized&&(n=wo(n,this.array)),n}setW(e,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+3]=Bo(n),this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array)),this.array[e+0]=Bo(n),this.array[e+1]=Bo(r),this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array),i=Yn(i,this.array)),this.array[e+0]=Bo(n),this.array[e+1]=Bo(r),this.array[e+2]=Bo(i),this}setXYZW(e,n,r,i,s){return e*=this.itemSize,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array),i=Yn(i,this.array),s=Yn(s,this.array)),this.array[e+0]=Bo(n),this.array[e+1]=Bo(r),this.array[e+2]=Bo(i),this.array[e+3]=Bo(s),this}}class Dt extends fn{constructor(e,n,r){super(new Float32Array(e),n,r)}}let Gte=0;const Sa=new et,NS=new yn,Hh=new $,ra=new Kn,U0=new Kn,vs=new $;class gn extends uc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Gte++}),this.uuid=ha(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Pz(e)?b6:_6)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Ln().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Sa.makeRotationFromQuaternion(e),this.applyMatrix4(Sa),this}rotateX(e){return Sa.makeRotationX(e),this.applyMatrix4(Sa),this}rotateY(e){return Sa.makeRotationY(e),this.applyMatrix4(Sa),this}rotateZ(e){return Sa.makeRotationZ(e),this.applyMatrix4(Sa),this}translate(e,n,r){return Sa.makeTranslation(e,n,r),this.applyMatrix4(Sa),this}scale(e,n,r){return Sa.makeScale(e,n,r),this.applyMatrix4(Sa),this}lookAt(e){return NS.lookAt(e),NS.updateMatrix(),this.applyMatrix4(NS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hh).negate(),this.translate(Hh.x,Hh.y,Hh.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let i=0,s=e.length;i<s;i++){const o=e[i];r.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Dt(r,3))}else{const r=Math.min(e.length,n.count);for(let i=0;i<r;i++){const s=e[i];n.setXYZ(i,s.x,s.y,s.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Kn);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new $(-1/0,-1/0,-1/0),new $(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,i=n.length;r<i;r++){const s=n[r];ra.setFromBufferAttribute(s),this.morphTargetsRelative?(vs.addVectors(this.boundingBox.min,ra.min),this.boundingBox.expandByPoint(vs),vs.addVectors(this.boundingBox.max,ra.max),this.boundingBox.expandByPoint(vs)):(this.boundingBox.expandByPoint(ra.min),this.boundingBox.expandByPoint(ra.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new wr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new $,1/0);return}if(e){const r=this.boundingSphere.center;if(ra.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const a=n[s];U0.setFromBufferAttribute(a),this.morphTargetsRelative?(vs.addVectors(ra.min,U0.min),ra.expandByPoint(vs),vs.addVectors(ra.max,U0.max),ra.expandByPoint(vs)):(ra.expandByPoint(U0.min),ra.expandByPoint(U0.max))}ra.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)vs.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(vs));if(n)for(let s=0,o=n.length;s<o;s++){const a=n[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)vs.fromBufferAttribute(a,c),l&&(Hh.fromBufferAttribute(e,c),vs.add(Hh)),i=Math.max(i,r.distanceToSquared(vs))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,i=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new fn(new Float32Array(4*r.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let A=0;A<r.count;A++)a[A]=new $,l[A]=new $;const c=new $,u=new $,f=new $,d=new Ke,h=new Ke,p=new Ke,m=new $,g=new $;function y(A,R,M){c.fromBufferAttribute(r,A),u.fromBufferAttribute(r,R),f.fromBufferAttribute(r,M),d.fromBufferAttribute(s,A),h.fromBufferAttribute(s,R),p.fromBufferAttribute(s,M),u.sub(c),f.sub(c),h.sub(d),p.sub(d);const D=1/(h.x*p.y-p.x*h.y);isFinite(D)&&(m.copy(u).multiplyScalar(p.y).addScaledVector(f,-h.y).multiplyScalar(D),g.copy(f).multiplyScalar(h.x).addScaledVector(u,-p.x).multiplyScalar(D),a[A].add(m),a[R].add(m),a[M].add(m),l[A].add(g),l[R].add(g),l[M].add(g))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let A=0,R=x.length;A<R;++A){const M=x[A],D=M.start,k=M.count;for(let L=D,N=D+k;L<N;L+=3)y(e.getX(L+0),e.getX(L+1),e.getX(L+2))}const _=new $,w=new $,T=new $,S=new $;function C(A){T.fromBufferAttribute(i,A),S.copy(T);const R=a[A];_.copy(R),_.sub(T.multiplyScalar(T.dot(R))).normalize(),w.crossVectors(S,R);const D=w.dot(l[A])<0?-1:1;o.setXYZW(A,_.x,_.y,_.z,D)}for(let A=0,R=x.length;A<R;++A){const M=x[A],D=M.start,k=M.count;for(let L=D,N=D+k;L<N;L+=3)C(e.getX(L+0)),C(e.getX(L+1)),C(e.getX(L+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new fn(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let d=0,h=r.count;d<h;d++)r.setXYZ(d,0,0,0);const i=new $,s=new $,o=new $,a=new $,l=new $,c=new $,u=new $,f=new $;if(e)for(let d=0,h=e.count;d<h;d+=3){const p=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);i.fromBufferAttribute(n,p),s.fromBufferAttribute(n,m),o.fromBufferAttribute(n,g),u.subVectors(o,s),f.subVectors(i,s),u.cross(f),a.fromBufferAttribute(r,p),l.fromBufferAttribute(r,m),c.fromBufferAttribute(r,g),a.add(u),l.add(u),c.add(u),r.setXYZ(p,a.x,a.y,a.z),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,h=n.count;d<h;d+=3)i.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),o.fromBufferAttribute(n,d+2),u.subVectors(o,s),f.subVectors(i,s),u.cross(f),r.setXYZ(d+0,u.x,u.y,u.z),r.setXYZ(d+1,u.x,u.y,u.z),r.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)vs.fromBufferAttribute(e,n),vs.normalize(),e.setXYZ(n,vs.x,vs.y,vs.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,f=a.normalized,d=new c.constructor(l.length*u);let h=0,p=0;for(let m=0,g=l.length;m<g;m++){a.isInterleavedBufferAttribute?h=l[m]*a.data.stride+a.offset:h=l[m]*u;for(let y=0;y<u;y++)d[p++]=c[h++]}return new fn(d,u,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new gn,r=this.index.array,i=this.attributes;for(const a in i){const l=i[a],c=e(l,r);n.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,f=c.length;u<f;u++){const d=c[u],h=e(d,r);l.push(h)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let f=0,d=c.length;f<d;f++){const h=c[f];u.push(h.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(n));const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(n))}const s=e.morphAttributes;for(const c in s){const u=[],f=s[c];for(let d=0,h=f.length;d<h;d++)u.push(f[d].clone(n));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const f=o[c];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Y7=new et,$f=new Yo,Zv=new wr,K7=new $,Qv=new $,Jv=new $,e2=new $,OS=new $,t2=new $,Z7=new $,n2=new $;class ln extends yn{constructor(e=new gn,n=new Fr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;n.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){t2.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],f=s[l];u!==0&&(OS.fromBufferAttribute(f,e),o?t2.addScaledVector(OS,u):t2.addScaledVector(OS.sub(n),u))}n.add(t2)}return n}raycast(e,n){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),Zv.copy(r.boundingSphere),Zv.applyMatrix4(s),$f.copy(e.ray).recast(e.near),!(Zv.containsPoint($f.origin)===!1&&($f.intersectSphere(Zv,K7)===null||$f.origin.distanceToSquared(K7)>(e.far-e.near)**2))&&(Y7.copy(s).invert(),$f.copy(e.ray).applyMatrix4(Y7),!(r.boundingBox!==null&&$f.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,$f)))}_computeIntersections(e,n,r){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,f=s.attributes.normal,d=s.groups,h=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,m=d.length;p<m;p++){const g=d[p],y=o[g.materialIndex],x=Math.max(g.start,h.start),_=Math.min(a.count,Math.min(g.start+g.count,h.start+h.count));for(let w=x,T=_;w<T;w+=3){const S=a.getX(w),C=a.getX(w+1),A=a.getX(w+2);i=r2(this,y,e,r,c,u,f,S,C,A),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=g.materialIndex,n.push(i))}}else{const p=Math.max(0,h.start),m=Math.min(a.count,h.start+h.count);for(let g=p,y=m;g<y;g+=3){const x=a.getX(g),_=a.getX(g+1),w=a.getX(g+2);i=r2(this,o,e,r,c,u,f,x,_,w),i&&(i.faceIndex=Math.floor(g/3),n.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,m=d.length;p<m;p++){const g=d[p],y=o[g.materialIndex],x=Math.max(g.start,h.start),_=Math.min(l.count,Math.min(g.start+g.count,h.start+h.count));for(let w=x,T=_;w<T;w+=3){const S=w,C=w+1,A=w+2;i=r2(this,y,e,r,c,u,f,S,C,A),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=g.materialIndex,n.push(i))}}else{const p=Math.max(0,h.start),m=Math.min(l.count,h.start+h.count);for(let g=p,y=m;g<y;g+=3){const x=g,_=g+1,w=g+2;i=r2(this,o,e,r,c,u,f,x,_,w),i&&(i.faceIndex=Math.floor(g/3),n.push(i))}}}}function jte(t,e,n,r,i,s,o,a){let l;if(e.side===zi?l=r.intersectTriangle(o,s,i,!0,a):l=r.intersectTriangle(i,s,o,e.side===Cs,a),l===null)return null;n2.copy(a),n2.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(n2);return c<n.near||c>n.far?null:{distance:c,point:n2.clone(),object:t}}function r2(t,e,n,r,i,s,o,a,l,c){t.getVertexPosition(a,Qv),t.getVertexPosition(l,Jv),t.getVertexPosition(c,e2);const u=jte(t,e,n,r,Qv,Jv,e2,Z7);if(u){const f=new $;Ci.getBarycoord(Z7,Qv,Jv,e2,f),i&&(u.uv=Ci.getInterpolatedAttribute(i,a,l,c,f,new Ke)),s&&(u.uv1=Ci.getInterpolatedAttribute(s,a,l,c,f,new Ke)),o&&(u.normal=Ci.getInterpolatedAttribute(o,a,l,c,f,new $),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const d={a,b:l,c,normal:new $,materialIndex:0};Ci.getNormal(Qv,Jv,e2,d.normal),u.face=d,u.barycoord=f}return u}class fc extends gn{constructor(e=1,n=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],f=[];let d=0,h=0;p("z","y","x",-1,-1,r,n,e,o,s,0),p("z","y","x",1,-1,r,n,-e,o,s,1),p("x","z","y",1,1,e,r,n,i,o,2),p("x","z","y",1,-1,e,r,-n,i,o,3),p("x","y","z",1,-1,e,n,r,i,s,4),p("x","y","z",-1,-1,e,n,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Dt(c,3)),this.setAttribute("normal",new Dt(u,3)),this.setAttribute("uv",new Dt(f,2));function p(m,g,y,x,_,w,T,S,C,A,R){const M=w/C,D=T/A,k=w/2,L=T/2,N=S/2,z=C+1,O=A+1;let K=0,V=0;const ne=new $;for(let re=0;re<O;re++){const P=re*D-L;for(let se=0;se<z;se++){const ue=se*M-k;ne[m]=ue*x,ne[g]=P*_,ne[y]=N,c.push(ne.x,ne.y,ne.z),ne[m]=0,ne[g]=0,ne[y]=S>0?1:-1,u.push(ne.x,ne.y,ne.z),f.push(se/C),f.push(1-re/A),K+=1}}for(let re=0;re<A;re++)for(let P=0;P<C;P++){const se=d+P+z*re,ue=d+P+z*(re+1),te=d+(P+1)+z*(re+1),W=d+(P+1)+z*re;l.push(se,ue,W),l.push(ue,te,W),V+=6}a.addGroup(h,V,R),h+=V,d+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ym(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function bo(t){const e={};for(let n=0;n<t.length;n++){const r=ym(t[n]);for(const i in r)e[i]=r[i]}return e}function Vte(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function Oz(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:er.workingColorSpace}const mf={clone:ym,merge:bo};var Wte=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$te=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class yr extends Wr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Wte,this.fragmentShader=$te,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ym(e.uniforms),this.uniformsGroups=Vte(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?n.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[i]={type:"m4",value:o.toArray()}:n.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class Om extends yn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new et,this.projectionMatrix=new et,this.projectionMatrixInverse=new et,this.coordinateSystem=Ql}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Lu=new $,Q7=new Ke,J7=new Ke;let Ar=class extends Om{constructor(e=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=gm*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ad*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return gm*2*Math.atan(Math.tan(Ad*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,r){Lu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Lu.x,Lu.y).multiplyScalar(-e/Lu.z),Lu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Lu.x,Lu.y).multiplyScalar(-e/Lu.z)}getViewSize(e,n){return this.getViewBounds(e,Q7,J7),n.subVectors(J7,Q7)}setViewOffset(e,n,r,i,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Ad*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*i/l,n-=o.offsetY*r/c,i*=o.width/l,r*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const Gh=-90,jh=1;let wb=class extends yn{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Ar(Gh,jh,e,n);i.layers=this.layers,this.add(i);const s=new Ar(Gh,jh,e,n);s.layers=this.layers,this.add(s);const o=new Ar(Gh,jh,e,n);o.layers=this.layers,this.add(o);const a=new Ar(Gh,jh,e,n);a.layers=this.layers,this.add(a);const l=new Ar(Gh,jh,e,n);l.layers=this.layers,this.add(l);const c=new Ar(Gh,jh,e,n);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,i,s,o,a,l]=n;for(const c of n)this.remove(c);if(e===Ql)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===H1)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of n)this.add(c),c.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,f=e.getRenderTarget(),d=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const m=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(n,s),e.setRenderTarget(r,1,i),e.render(n,o),e.setRenderTarget(r,2,i),e.render(n,a),e.setRenderTarget(r,3,i),e.render(n,l),e.setRenderTarget(r,4,i),e.render(n,c),r.texture.generateMipmaps=m,e.setRenderTarget(r,5,i),e.render(n,u),e.setRenderTarget(f,d,h),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}};class my extends tr{constructor(e,n,r,i,s,o,a,l,c,u){e=e!==void 0?e:[],n=n!==void 0?n:sc,super(e,n,r,i,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Fm extends fr{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new my(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Pn}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new fc(5,5,5),s=new yr({name:"CubemapFromEquirect",uniforms:ym(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:zi,blending:$a});s.uniforms.tEquirect.value=n;const o=new ln(i,s),a=n.minFilter;return n.minFilter===Ts&&(n.minFilter=Pn),new wb(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,r,i);e.setRenderTarget(s)}}class Sb{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new wt(e),this.density=n}clone(){return new Sb(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Tb{constructor(e,n=1,r=1e3){this.isFog=!0,this.name="",this.color=new wt(e),this.near=n,this.far=r}clone(){return new Tb(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class ls extends yn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new xr,this.environmentIntensity=1,this.environmentRotation=new xr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class Um{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=z1,this.updateRanges=[],this.version=0,this.uuid=ha()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,r){e*=this.stride,r*=n.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=n.array[r+i];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ha()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(n,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ha()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const go=new $;class Ao{constructor(e,n,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,r=this.data.count;n<r;n++)go.fromBufferAttribute(this,n),go.applyMatrix4(e),this.setXYZ(n,go.x,go.y,go.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)go.fromBufferAttribute(this,n),go.applyNormalMatrix(e),this.setXYZ(n,go.x,go.y,go.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)go.fromBufferAttribute(this,n),go.transformDirection(e),this.setXYZ(n,go.x,go.y,go.z);return this}getComponent(e,n){let r=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(r=wo(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Yn(r,this.array)),this.data.array[e*this.data.stride+this.offset+n]=r,this}setX(e,n){return this.normalized&&(n=Yn(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=Yn(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=Yn(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=Yn(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=wo(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=wo(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=wo(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=wo(n,this.array)),n}setXY(e,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this}setXYZ(e,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array),i=Yn(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,n,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=Yn(n,this.array),r=Yn(r,this.array),i=Yn(i,this.array),s=Yn(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[i+s])}return new fn(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ao(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Ab extends Wr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new wt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Vh;const B0=new $,Wh=new $,$h=new $,Xh=new Ke,z0=new Ke,Fz=new et,i2=new $,H0=new $,s2=new $,eI=new Ke,FS=new Ke,tI=new Ke;class Uz extends yn{constructor(e=new Ab){if(super(),this.isSprite=!0,this.type="Sprite",Vh===void 0){Vh=new gn;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Um(n,5);Vh.setIndex([0,1,2,0,2,3]),Vh.setAttribute("position",new Ao(r,3,0,!1)),Vh.setAttribute("uv",new Ao(r,2,3,!1))}this.geometry=Vh,this.material=e,this.center=new Ke(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Wh.setFromMatrixScale(this.matrixWorld),Fz.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),$h.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Wh.multiplyScalar(-$h.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;o2(i2.set(-.5,-.5,0),$h,o,Wh,i,s),o2(H0.set(.5,-.5,0),$h,o,Wh,i,s),o2(s2.set(.5,.5,0),$h,o,Wh,i,s),eI.set(0,0),FS.set(1,0),tI.set(1,1);let a=e.ray.intersectTriangle(i2,H0,s2,!1,B0);if(a===null&&(o2(H0.set(-.5,.5,0),$h,o,Wh,i,s),FS.set(0,1),a=e.ray.intersectTriangle(i2,s2,H0,!1,B0),a===null))return;const l=e.ray.origin.distanceTo(B0);l<e.near||l>e.far||n.push({distance:l,point:B0.clone(),uv:Ci.getInterpolation(B0,i2,H0,s2,eI,FS,tI,new Ke),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function o2(t,e,n,r,i,s){Xh.subVectors(t,n).addScalar(.5).multiply(r),i!==void 0?(z0.x=s*Xh.x-i*Xh.y,z0.y=i*Xh.x+s*Xh.y):z0.copy(Xh),t.copy(e),t.x+=z0.x,t.y+=z0.y,t.applyMatrix4(Fz)}const a2=new $,nI=new $;class Bz extends yn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,r=0){n=Math.abs(n);const i=this.levels;let s;for(s=0;s<i.length&&!(n<i[s].distance);s++);return i.splice(s,0,{distance:n,hysteresis:r,object:e}),this.add(e),this}removeLevel(e){const n=this.levels;for(let r=0;r<n.length;r++)if(n[r].distance===e){const i=n.splice(r,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let r,i;for(r=1,i=n.length;r<i;r++){let s=n[r].distance;if(n[r].object.visible&&(s-=s*n[r].hysteresis),e<s)break}return n[r-1].object}return null}raycast(e,n){if(this.levels.length>0){a2.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(a2);this.getObjectForDistance(i).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){a2.setFromMatrixPosition(e.matrixWorld),nI.setFromMatrixPosition(this.matrixWorld);const r=a2.distanceTo(nI)/e.zoom;n[0].object.visible=!0;let i,s;for(i=1,s=n.length;i<s;i++){let o=n[i].distance;if(n[i].object.visible&&(o-=o*n[i].hysteresis),r>=o)n[i-1].object.visible=!1,n[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)n[i].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const o=r[i];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}const rI=new $,iI=new Hn,sI=new Hn,Xte=new $,oI=new et,l2=new $,US=new wr,aI=new et,BS=new Yo;class Qd extends ln{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=$A,this.bindMatrix=new et,this.bindMatrixInverse=new et,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Kn),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,l2),this.boundingBox.expandByPoint(l2)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new wr),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,l2),this.boundingSphere.expandByPoint(l2)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),US.copy(this.boundingSphere),US.applyMatrix4(i),e.ray.intersectsSphere(US)!==!1&&(aI.copy(i).invert(),BS.copy(e.ray).applyMatrix4(aI),!(this.boundingBox!==null&&BS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,BS)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Hn,n=this.geometry.attributes.skinWeight;for(let r=0,i=n.count;r<i;r++){e.fromBufferAttribute(n,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===$A?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===gz?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const r=this.skeleton,i=this.geometry;iI.fromBufferAttribute(i.attributes.skinIndex,e),sI.fromBufferAttribute(i.attributes.skinWeight,e),rI.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const o=sI.getComponent(s);if(o!==0){const a=iI.getComponent(s);oI.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),n.addScaledVector(Xte.copy(rI).applyMatrix4(oI),o)}}return n.applyMatrix4(this.bindMatrixInverse)}}class Jd extends yn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class As extends tr{constructor(e=null,n=1,r=1,i,s,o,a,l,c=zn,u=zn,f,d){super(null,o,a,l,c,u,i,s,f,d),this.isDataTexture=!0,this.image={data:e,width:n,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const lI=new et,qte=new et;class wf{constructor(e=[],n=[]){this.uuid=ha(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new et)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const r=new et;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,n=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:qte;lI.multiplyMatrices(a,n[s]),lI.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new wf(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const r=new As(n,e,e,Pr,pr);return r.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=r,this}getBoneByName(e){for(let n=0,r=this.bones.length;n<r;n++){const i=this.bones[n];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=n[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Jd),this.bones.push(o),this.boneInverses.push(new et().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,r=this.boneInverses;for(let i=0,s=n.length;i<s;i++){const o=n[i];e.bones.push(o.uuid);const a=r[i];e.boneInverses.push(a.toArray())}return e}}class Ya extends fn{constructor(e,n,r,i=1){super(e,n,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const qh=new et,cI=new et,c2=[],uI=new Kn,Yte=new et,G0=new ln,j0=new wr;class eh extends ln{constructor(e,n,r){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Ya(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,Yte)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new Kn),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<n;r++)this.getMatrixAt(r,qh),uI.copy(e.boundingBox).applyMatrix4(qh),this.boundingBox.union(uI)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new wr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<n;r++)this.getMatrixAt(r,qh),j0.copy(e.boundingSphere).applyMatrix4(qh),this.boundingSphere.union(j0)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const r=n.morphTargetInfluences,i=this.morphTexture.source.data.data,s=r.length+1,o=e*s+1;for(let a=0;a<r.length;a++)r[a]=i[o+a]}raycast(e,n){const r=this.matrixWorld,i=this.count;if(G0.geometry=this.geometry,G0.material=this.material,G0.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),j0.copy(this.boundingSphere),j0.applyMatrix4(r),e.ray.intersectsSphere(j0)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,qh),cI.multiplyMatrices(r,qh),G0.matrixWorld=cI,G0.raycast(e,c2);for(let o=0,a=c2.length;o<a;o++){const l=c2[o];l.instanceId=s,l.object=this,n.push(l)}c2.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Ya(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const r=n.morphTargetInfluences,i=r.length+1;this.morphTexture===null&&(this.morphTexture=new As(new Float32Array(i*this.count),i,this.count,Yc,pr));const s=this.morphTexture.source.data.data;let o=0;for(let c=0;c<r.length;c++)o+=r[c];const a=this.geometry.morphTargetsRelative?1:1-o,l=i*e;s[l]=a,s.set(r,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}const zS=new $,Kte=new $,Zte=new Ln;let Oi=class{constructor(e=new $(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,i){return this.normal.set(e,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const i=zS.subVectors(r,n).cross(Kte.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(zS),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:n.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||Zte.getNormalMatrix(e),i=this.coplanarPoint(zS).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const Xf=new wr,u2=new $;class th{constructor(e=new Oi,n=new Oi,r=new Oi,i=new Oi,s=new Oi,o=new Oi){this.planes=[e,n,r,i,s,o]}set(e,n,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=Ql){const r=this.planes,i=e.elements,s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],f=i[6],d=i[7],h=i[8],p=i[9],m=i[10],g=i[11],y=i[12],x=i[13],_=i[14],w=i[15];if(r[0].setComponents(l-s,d-c,g-h,w-y).normalize(),r[1].setComponents(l+s,d+c,g+h,w+y).normalize(),r[2].setComponents(l+o,d+u,g+p,w+x).normalize(),r[3].setComponents(l-o,d-u,g-p,w-x).normalize(),r[4].setComponents(l-a,d-f,g-m,w-_).normalize(),n===Ql)r[5].setComponents(l+a,d+f,g+m,w+_).normalize();else if(n===H1)r[5].setComponents(a,f,m,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Xf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Xf.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Xf)}intersectsSprite(e){return Xf.center.set(0,0,0),Xf.radius=.7071067811865476,Xf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Xf)}intersectsSphere(e){const n=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(u2.x=i.normal.x>0?e.max.x:e.min.x,u2.y=i.normal.y>0?e.max.y:e.min.y,u2.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(u2)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function HS(t,e){return t-e}function Qte(t,e){return t.z-e.z}function Jte(t,e){return e.z-t.z}class ene{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,r,i){const s=this.pool,o=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const a=s[this.index];o.push(a),this.index++,a.start=e,a.count=n,a.z=r,a.index=i}reset(){this.list.length=0,this.index=0}}const No=new et,tne=new wt(1,1,1),GS=new th,f2=new Kn,qf=new wr,V0=new $,fI=new $,nne=new $,jS=new ene,Zs=new ln,d2=[];function rne(t,e,n=0){const r=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const i=t.count;for(let s=0;s<i;s++)for(let o=0;o<r;o++)e.setComponent(s+n,o,t.getComponent(s,o))}else e.array.set(t.array,n*r);e.needsUpdate=!0}function Yf(t,e){if(t.constructor!==e.constructor){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++)e[r]=t[r]}else{const n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}let Mb=class extends ln{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,n,r=n*2,i){super(new gn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=r,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),r=new As(n,e,e,Pr,pr);this._matricesTexture=r}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),r=new As(n,e,e,Dm,io);this._indirectTexture=r}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),r=new As(n,e,e,Pr,pr);r.colorSpace=er.workingColorSpace,this._colorsTexture=r}_initializeGeometry(e){const n=this.geometry,r=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:a,itemSize:l,normalized:c}=o,u=new a.constructor(r*l),f=new fn(u,l,c);n.setAttribute(s,f)}if(e.getIndex()!==null){const s=r>65535?new Uint32Array(i):new Uint16Array(i);n.setIndex(new fn(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const r in n.attributes){if(!e.hasAttribute(r))throw new Error(`THREE.BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=n.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Kn);const e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let r=0,i=n.length;r<i;r++){if(n[r].active===!1)continue;const s=n[r].geometryIndex;this.getMatrixAt(r,No),this.getBoundingBoxAt(s,f2).applyMatrix4(No),e.union(f2)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new wr);const e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let r=0,i=n.length;r<i;r++){if(n[r].active===!1)continue;const s=n[r].geometryIndex;this.getMatrixAt(r,No),this.getBoundingSphereAt(s,qf).applyMatrix4(No),e.union(qf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const r={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(HS),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=r):(i=this._instanceInfo.length,this._instanceInfo.push(r));const s=this._matricesTexture;No.identity().toArray(s.image.data,i*16),s.needsUpdate=!0;const o=this._colorsTexture;return o&&(tne.toArray(o.image.data,i*4),o.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,n=-1,r=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=n===-1?e.getAttribute("position").count:n;const o=e.getIndex();if(o!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=r===-1?o.count:r),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(HS),l=this._availableGeometryIds.shift(),s[l]=i):(l=this._geometryCount,this._geometryCount++,s.push(i)),this.setGeometryAt(l,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,l}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),o=n.getIndex(),a=this._geometryInfo[e];if(i&&o.count>a.reservedIndexCount||n.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,c=a.reservedVertexCount;a.vertexCount=n.getAttribute("position").count;for(const u in r.attributes){const f=n.getAttribute(u),d=r.getAttribute(u);rne(f,d,l);const h=f.itemSize;for(let p=f.count,m=c;p<m;p++){const g=l+p;for(let y=0;y<h;y++)d.setComponent(g,y,0)}d.needsUpdate=!0,d.addUpdateRange(l*h,c*h)}if(i){const u=a.indexStart,f=a.reservedIndexCount;a.indexCount=n.getIndex().count;for(let d=0;d<o.count;d++)s.setX(u+d,l+o.getX(d));for(let d=o.count,h=f;d<h;d++)s.setX(u+d,l);s.needsUpdate=!0,s.addUpdateRange(u,a.reservedIndexCount)}return a.start=i?a.indexStart:a.vertexStart,a.count=i?a.indexCount:a.vertexCount,a.boundingBox=null,n.boundingBox!==null&&(a.boundingBox=n.boundingBox.clone()),a.boundingSphere=null,n.boundingSphere!==null&&(a.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;const r=this._instanceInfo;for(let i=0,s=r.length;i<s;i++)r[i].geometryIndex===e&&this.deleteInstance(i);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0;const r=this._geometryInfo,i=r.map((o,a)=>a).sort((o,a)=>r[o].vertexStart-r[a].vertexStart),s=this.geometry;for(let o=0,a=r.length;o<a;o++){const l=i[o],c=r[l];if(c.active!==!1){if(s.index!==null){if(c.indexStart!==n){const{indexStart:u,vertexStart:f,reservedIndexCount:d}=c,h=s.index,p=h.array,m=e-f;for(let g=u;g<u+d;g++)p[g]=p[g]+m;h.array.copyWithin(n,u,u+d),h.addUpdateRange(n,d),c.indexStart=n}n+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:u,reservedVertexCount:f}=c,d=s.attributes;for(const h in d){const p=d[h],{array:m,itemSize:g}=p;m.copyWithin(e*g,u*g,(u+f)*g),p.addUpdateRange(e*g,f*g)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=s.index?c.indexStart:c.vertexStart,this._nextIndexStart=s.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const s=new Kn,o=r.index,a=r.attributes.position;for(let l=i.start,c=i.start+i.count;l<c;l++){let u=l;o&&(u=o.getX(u)),s.expandByPoint(V0.fromBufferAttribute(a,u))}i.boundingBox=s}return n.copy(i.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const s=new wr;this.getBoundingBoxAt(e,f2),f2.getCenter(s.center);const o=r.index,a=r.attributes.position;let l=0;for(let c=i.start,u=i.start+i.count;c<u;c++){let f=c;o&&(f=o.getX(f)),V0.fromBufferAttribute(a,f),l=Math.max(l,s.center.distanceToSquared(V0))}s.radius=Math.sqrt(l),i.boundingSphere=s}return n.copy(i.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);const r=this._matricesTexture,i=this._matricesTexture.image.data;return n.toArray(i,e*16),r.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);const r=this._geometryInfo[e];return n.vertexStart=r.vertexStart,n.vertexCount=r.vertexCount,n.reservedVertexCount=r.reservedVertexCount,n.indexStart=r.indexStart,n.indexCount=r.indexCount,n.reservedIndexCount=r.reservedIndexCount,n.start=r.start,n.count=r.count,n}setInstanceCount(e){const n=this._availableInstanceIds,r=this._instanceInfo;for(n.sort(HS);n[n.length-1]===r.length;)r.pop(),n.pop();if(e<r.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),s=new Int32Array(e);Yf(this._multiDrawCounts,i),Yf(this._multiDrawStarts,s),this._multiDrawCounts=i,this._multiDrawStarts=s,this._maxInstanceCount=e;const o=this._indirectTexture,a=this._matricesTexture,l=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Yf(o.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),Yf(a.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),Yf(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){const r=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...r.map(a=>a.vertexStart+a.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...r.map(l=>l.indexStart+l.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new gn,this._initializeGeometry(s));const o=this.geometry;s.index&&Yf(s.index.array,o.index.array);for(const a in s.attributes)Yf(s.attributes[a].array,o.attributes[a].array)}raycast(e,n){const r=this._instanceInfo,i=this._geometryInfo,s=this.matrixWorld,o=this.geometry;Zs.material=this.material,Zs.geometry.index=o.index,Zs.geometry.attributes=o.attributes,Zs.geometry.boundingBox===null&&(Zs.geometry.boundingBox=new Kn),Zs.geometry.boundingSphere===null&&(Zs.geometry.boundingSphere=new wr);for(let a=0,l=r.length;a<l;a++){if(!r[a].visible||!r[a].active)continue;const c=r[a].geometryIndex,u=i[c];Zs.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(a,Zs.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,Zs.geometry.boundingBox),this.getBoundingSphereAt(c,Zs.geometry.boundingSphere),Zs.raycast(e,d2);for(let f=0,d=d2.length;f<d;f++){const h=d2[f];h.object=this,h.batchId=a,n.push(h)}d2.length=0}Zs.material=null,Zs.geometry.index=null,Zs.geometry.attributes={},Zs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,n,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,f=this._geometryInfo,d=this.perObjectFrustumCulled,h=this._indirectTexture,p=h.image.data;d&&(No.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),GS.setFromProjectionMatrix(No,e.coordinateSystem));let m=0;if(this.sortObjects){No.copy(this.matrixWorld).invert(),V0.setFromMatrixPosition(r.matrixWorld).applyMatrix4(No),fI.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(No);for(let x=0,_=l.length;x<_;x++)if(l[x].visible&&l[x].active){const w=l[x].geometryIndex;this.getMatrixAt(x,No),this.getBoundingSphereAt(w,qf).applyMatrix4(No);let T=!1;if(d&&(T=!GS.intersectsSphere(qf)),!T){const S=f[w],C=nne.subVectors(qf.center,V0).dot(fI);jS.push(S.start,S.count,C,x)}}const g=jS.list,y=this.customSort;y===null?g.sort(s.transparent?Jte:Qte):y.call(this,g,r);for(let x=0,_=g.length;x<_;x++){const w=g[x];c[m]=w.start*a,u[m]=w.count,p[m]=w.index,m++}jS.reset()}else for(let g=0,y=l.length;g<y;g++)if(l[g].visible&&l[g].active){const x=l[g].geometryIndex;let _=!1;if(d&&(this.getMatrixAt(g,No),this.getBoundingSphereAt(x,qf).applyMatrix4(No),_=!GS.intersectsSphere(qf)),!_){const w=f[x];c[m]=w.start*a,u[m]=w.count,p[m]=g,m++}}h.needsUpdate=!0,this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,n,r,i,s,o){this.onBeforeRender(e,null,i,s,o)}};class oi extends Wr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new wt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const l_=new $,c_=new $,dI=new et,W0=new Yo,h2=new wr,VS=new $,hI=new $;let $o=class extends yn{constructor(e=new gn,n=new oi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let i=1,s=n.count;i<s;i++)l_.fromBufferAttribute(n,i-1),c_.fromBufferAttribute(n,i),r[i]=r[i-1],r[i]+=l_.distanceTo(c_);e.setAttribute("lineDistance",new Dt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),h2.copy(r.boundingSphere),h2.applyMatrix4(i),h2.radius+=s,e.ray.intersectsSphere(h2)===!1)return;dI.copy(i).invert(),W0.copy(e.ray).applyMatrix4(dI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=this.isLineSegments?2:1,u=r.index,d=r.attributes.position;if(u!==null){const h=Math.max(0,o.start),p=Math.min(u.count,o.start+o.count);for(let m=h,g=p-1;m<g;m+=c){const y=u.getX(m),x=u.getX(m+1),_=p2(this,e,W0,l,y,x);_&&n.push(_)}if(this.isLineLoop){const m=u.getX(p-1),g=u.getX(h),y=p2(this,e,W0,l,m,g);y&&n.push(y)}}else{const h=Math.max(0,o.start),p=Math.min(d.count,o.start+o.count);for(let m=h,g=p-1;m<g;m+=c){const y=p2(this,e,W0,l,m,m+1);y&&n.push(y)}if(this.isLineLoop){const m=p2(this,e,W0,l,p-1,h);m&&n.push(m)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function p2(t,e,n,r,i,s){const o=t.geometry.attributes.position;if(l_.fromBufferAttribute(o,i),c_.fromBufferAttribute(o,s),n.distanceSqToSegment(l_,c_,VS,hI)>r)return;VS.applyMatrix4(t.matrixWorld);const l=e.ray.origin.distanceTo(VS);if(!(l<e.near||l>e.far))return{distance:l,point:hI.clone().applyMatrix4(t.matrixWorld),index:i,face:null,faceIndex:null,barycoord:null,object:t}}const pI=new $,mI=new $;class so extends $o{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[];for(let i=0,s=n.count;i<s;i+=2)pI.fromBufferAttribute(n,i),mI.fromBufferAttribute(n,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+pI.distanceTo(mI);e.setAttribute("lineDistance",new Dt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Cb extends $o{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class Ha extends Wr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new wt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const gI=new et,YA=new Yo,m2=new wr,g2=new $;let Zc=class extends yn{constructor(e=new gn,n=new Ha){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),m2.copy(r.boundingSphere),m2.applyMatrix4(i),m2.radius+=s,e.ray.intersectsSphere(m2)===!1)return;gI.copy(i).invert(),YA.copy(e.ray).applyMatrix4(gI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=r.index,f=r.attributes.position;if(c!==null){const d=Math.max(0,o.start),h=Math.min(c.count,o.start+o.count);for(let p=d,m=h;p<m;p++){const g=c.getX(p);g2.fromBufferAttribute(f,g),yI(g2,g,l,i,e,n,this)}}else{const d=Math.max(0,o.start),h=Math.min(f.count,o.start+o.count);for(let p=d,m=h;p<m;p++)g2.fromBufferAttribute(f,p),yI(g2,p,l,i,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function yI(t,e,n,r,i,s,o){const a=YA.distanceSqToPoint(t);if(a<n){const l=new $;YA.closestPointToPoint(t,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class es extends yn{constructor(){super(),this.isGroup=!0,this.type="Group"}}class E6 extends tr{constructor(e,n,r,i,s,o,a,l,c){super(e,n,r,i,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Pn,this.magFilter=s!==void 0?s:Pn,this.generateMipmaps=!1;const u=this;function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class ine extends tr{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=zn,this.minFilter=zn,this.generateMipmaps=!1,this.needsUpdate=!0}}class Rb extends tr{constructor(e,n,r,i,s,o,a,l,c,u,f,d){super(null,o,a,l,c,u,i,s,f,d),this.isCompressedTexture=!0,this.image={width:n,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class sne extends Rb{constructor(e,n,r,i,s,o){super(e,n,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=ei,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class one extends Rb{constructor(e,n,r){super(void 0,e[0].width,e[0].height,n,r,sc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class w6 extends tr{constructor(e,n,r,i,s,o,a,l,c){super(e,n,r,i,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Bm extends tr{constructor(e,n,r,i,s,o,a,l,c,u=sf){if(u!==sf&&u!==Hd)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===sf&&(r=io),r===void 0&&u===Hd&&(r=zd),super(null,i,s,o,a,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=a!==void 0?a:zn,this.minFilter=l!==void 0?l:zn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class Sl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const r=this.getUtoTmapping(e);return this.getPoint(r,n)}getPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return n}getSpacedPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPointAt(r/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let r,i=this.getPoint(0),s=0;n.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),n.push(s),i=r;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const r=this.getLengths();let i=0;const s=r.length;let o;n?o=n:o=e*r[s-1];let a=0,l=s-1,c;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),c=r[i]-o,c<0)a=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,r[i]===o)return i/(s-1);const u=r[i],d=r[i+1]-u,h=(o-u)/d;return(i+h)/(s-1)}getTangent(e,n){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=n||(o.isVector2?new Ke:new $);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,n){const r=this.getUtoTmapping(e);return this.getTangent(r,n)}computeFrenetFrames(e,n){const r=new $,i=[],s=[],o=[],a=new $,l=new et;for(let h=0;h<=e;h++){const p=h/e;i[h]=this.getTangentAt(p,new $)}s[0]=new $,o[0]=new $;let c=Number.MAX_VALUE;const u=Math.abs(i[0].x),f=Math.abs(i[0].y),d=Math.abs(i[0].z);u<=c&&(c=u,r.set(1,0,0)),f<=c&&(c=f,r.set(0,1,0)),d<=c&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let h=1;h<=e;h++){if(s[h]=s[h-1].clone(),o[h]=o[h-1].clone(),a.crossVectors(i[h-1],i[h]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(Wn(i[h-1].dot(i[h]),-1,1));s[h].applyMatrix4(l.makeRotationAxis(a,p))}o[h].crossVectors(i[h],s[h])}if(n===!0){let h=Math.acos(Wn(s[0].dot(s[e]),-1,1));h/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(h=-h);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(i[p],h*p)),o[p].crossVectors(i[p],s[p])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ib extends Sl{constructor(e=0,n=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,n=new Ke){const r=n,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),d=l-this.aX,h=c-this.aY;l=d*u-h*f+this.aX,c=d*f+h*u+this.aY}return r.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class zz extends Ib{constructor(e,n,r,i,s,o){super(e,n,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function S6(){let t=0,e=0,n=0,r=0;function i(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){i(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,f){let d=(o-s)/c-(a-s)/(c+u)+(a-o)/u,h=(a-o)/u-(l-o)/(u+f)+(l-a)/f;d*=u,h*=u,i(o,a,d,h)},calc:function(s){const o=s*s,a=o*s;return t+e*s+n*o+r*a}}}const y2=new $,WS=new S6,$S=new S6,XS=new S6;class T6 extends Sl{constructor(e=[],n=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=r,this.tension=i}getPoint(e,n=new $){const r=n,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=i[(a-1)%s]:(y2.subVectors(i[0],i[1]).add(i[0]),c=y2);const f=i[a%s],d=i[(a+1)%s];if(this.closed||a+2<s?u=i[(a+2)%s]:(y2.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=y2),this.curveType==="centripetal"||this.curveType==="chordal"){const h=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(f),h),m=Math.pow(f.distanceToSquared(d),h),g=Math.pow(d.distanceToSquared(u),h);m<1e-4&&(m=1),p<1e-4&&(p=m),g<1e-4&&(g=m),WS.initNonuniformCatmullRom(c.x,f.x,d.x,u.x,p,m,g),$S.initNonuniformCatmullRom(c.y,f.y,d.y,u.y,p,m,g),XS.initNonuniformCatmullRom(c.z,f.z,d.z,u.z,p,m,g)}else this.curveType==="catmullrom"&&(WS.initCatmullRom(c.x,f.x,d.x,u.x,this.tension),$S.initCatmullRom(c.y,f.y,d.y,u.y,this.tension),XS.initCatmullRom(c.z,f.z,d.z,u.z,this.tension));return r.set(WS.calc(l),$S.calc(l),XS.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const i=this.points[n];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(new $().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function vI(t,e,n,r,i){const s=(r-e)*.5,o=(i-n)*.5,a=t*t,l=t*a;return(2*n-2*r+s+o)*l+(-3*n+3*r-2*s-o)*a+s*t+n}function ane(t,e){const n=1-t;return n*n*e}function lne(t,e){return 2*(1-t)*t*e}function cne(t,e){return t*t*e}function d1(t,e,n,r){return ane(t,e)+lne(t,n)+cne(t,r)}function une(t,e){const n=1-t;return n*n*n*e}function fne(t,e){const n=1-t;return 3*n*n*t*e}function dne(t,e){return 3*(1-t)*t*t*e}function hne(t,e){return t*t*t*e}function h1(t,e,n,r,i){return une(t,e)+fne(t,n)+dne(t,r)+hne(t,i)}class A6 extends Sl{constructor(e=new Ke,n=new Ke,r=new Ke,i=new Ke){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=r,this.v3=i}getPoint(e,n=new Ke){const r=n,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(h1(e,i.x,s.x,o.x,a.x),h1(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class M6 extends Sl{constructor(e=new $,n=new $,r=new $,i=new $){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=r,this.v3=i}getPoint(e,n=new $){const r=n,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(h1(e,i.x,s.x,o.x,a.x),h1(e,i.y,s.y,o.y,a.y),h1(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class C6 extends Sl{constructor(e=new Ke,n=new Ke){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Ke){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Ke){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hz extends Sl{constructor(e=new $,n=new $){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new $){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new $){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class R6 extends Sl{constructor(e=new Ke,n=new Ke,r=new Ke){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new Ke){const r=n,i=this.v0,s=this.v1,o=this.v2;return r.set(d1(e,i.x,s.x,o.x),d1(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gy extends Sl{constructor(e=new $,n=new $,r=new $){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new $){const r=n,i=this.v0,s=this.v1,o=this.v2;return r.set(d1(e,i.x,s.x,o.x),d1(e,i.y,s.y,o.y),d1(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class I6 extends Sl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Ke){const r=n,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],c=i[o],u=i[o>i.length-2?i.length-1:o+1],f=i[o>i.length-3?i.length-1:o+2];return r.set(vI(a,l.x,c.x,u.x,f.x),vI(a,l.y,c.y,u.y,f.y)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const i=this.points[n];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(new Ke().fromArray(i))}return this}}var u_=Object.freeze({__proto__:null,ArcCurve:zz,CatmullRomCurve3:T6,CubicBezierCurve:A6,CubicBezierCurve3:M6,EllipseCurve:Ib,LineCurve:C6,LineCurve3:Hz,QuadraticBezierCurve:R6,QuadraticBezierCurve3:gy,SplineCurve:I6});class Gz extends Sl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new u_[r](n,e))}return this}getPoint(e,n){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let r=0,i=this.curves.length;r<i;r++)n+=this.curves[r].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];r&&r.equals(u)||(n.push(u),r=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const i=e.curves[n];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,r=this.curves.length;n<r;n++){const i=this.curves[n];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const i=e.curves[n];this.curves.push(new u_[i.type]().fromJSON(i))}return this}}class of extends Gz{constructor(e){super(),this.type="Path",this.currentPoint=new Ke,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,r=e.length;n<r;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const r=new C6(this.currentPoint.clone(),new Ke(e,n));return this.curves.push(r),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,r,i){const s=new R6(this.currentPoint.clone(),new Ke(e,n),new Ke(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,n,r,i,s,o){const a=new A6(this.currentPoint.clone(),new Ke(e,n),new Ke(r,i),new Ke(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),r=new I6(n);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,r,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,n+l,r,i,s,o),this}absarc(e,n,r,i,s,o){return this.absellipse(e,n,r,r,i,s,o),this}ellipse(e,n,r,i,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,n+u,r,i,s,o,a,l),this}absellipse(e,n,r,i,s,o,a,l){const c=new Ib(e,n,r,i,s,o,a,l);if(this.curves.length>0){const f=c.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class yy extends gn{constructor(e=[new Ke(0,-.5),new Ke(.5,0),new Ke(0,.5)],n=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:r,phiLength:i},n=Math.floor(n),i=Wn(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/n,f=new $,d=new Ke,h=new $,p=new $,m=new $;let g=0,y=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:g=e[x+1].x-e[x].x,y=e[x+1].y-e[x].y,h.x=y*1,h.y=-g,h.z=y*0,m.copy(h),h.normalize(),l.push(h.x,h.y,h.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:g=e[x+1].x-e[x].x,y=e[x+1].y-e[x].y,h.x=y*1,h.y=-g,h.z=y*0,p.copy(h),h.x+=m.x,h.y+=m.y,h.z+=m.z,h.normalize(),l.push(h.x,h.y,h.z),m.copy(p)}for(let x=0;x<=n;x++){const _=r+x*u*i,w=Math.sin(_),T=Math.cos(_);for(let S=0;S<=e.length-1;S++){f.x=e[S].x*w,f.y=e[S].y,f.z=e[S].x*T,o.push(f.x,f.y,f.z),d.x=x/n,d.y=S/(e.length-1),a.push(d.x,d.y);const C=l[3*S+0]*w,A=l[3*S+1],R=l[3*S+0]*T;c.push(C,A,R)}}for(let x=0;x<n;x++)for(let _=0;_<e.length-1;_++){const w=_+x*e.length,T=w,S=w+e.length,C=w+e.length+1,A=w+1;s.push(T,S,A),s.push(C,A,S)}this.setIndex(s),this.setAttribute("position",new Dt(o,3)),this.setAttribute("uv",new Dt(a,2)),this.setAttribute("normal",new Dt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yy(e.points,e.segments,e.phiStart,e.phiLength)}}class Pb extends yy{constructor(e=1,n=1,r=4,i=8){const s=new of;s.absarc(0,-n/2,e,Math.PI*1.5,0),s.absarc(0,n/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:n,capSegments:r,radialSegments:i}}static fromJSON(e){return new Pb(e.radius,e.length,e.capSegments,e.radialSegments)}}class kb extends gn{constructor(e=1,n=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:r,thetaLength:i},n=Math.max(3,n);const s=[],o=[],a=[],l=[],c=new $,u=new Ke;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let f=0,d=3;f<=n;f++,d+=3){const h=r+f/n*i;c.x=e*Math.cos(h),c.y=e*Math.sin(h),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[d]/e+1)/2,u.y=(o[d+1]/e+1)/2,l.push(u.x,u.y)}for(let f=1;f<=n;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new Dt(o,3)),this.setAttribute("normal",new Dt(a,3)),this.setAttribute("uv",new Dt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kb(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class hu extends gn{constructor(e=1,n=1,r=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const u=[],f=[],d=[],h=[];let p=0;const m=[],g=r/2;let y=0;x(),o===!1&&(e>0&&_(!0),n>0&&_(!1)),this.setIndex(u),this.setAttribute("position",new Dt(f,3)),this.setAttribute("normal",new Dt(d,3)),this.setAttribute("uv",new Dt(h,2));function x(){const w=new $,T=new $;let S=0;const C=(n-e)/r;for(let A=0;A<=s;A++){const R=[],M=A/s,D=M*(n-e)+e;for(let k=0;k<=i;k++){const L=k/i,N=L*l+a,z=Math.sin(N),O=Math.cos(N);T.x=D*z,T.y=-M*r+g,T.z=D*O,f.push(T.x,T.y,T.z),w.set(z,C,O).normalize(),d.push(w.x,w.y,w.z),h.push(L,1-M),R.push(p++)}m.push(R)}for(let A=0;A<i;A++)for(let R=0;R<s;R++){const M=m[R][A],D=m[R+1][A],k=m[R+1][A+1],L=m[R][A+1];(e>0||R!==0)&&(u.push(M,D,L),S+=3),(n>0||R!==s-1)&&(u.push(D,k,L),S+=3)}c.addGroup(y,S,0),y+=S}function _(w){const T=p,S=new Ke,C=new $;let A=0;const R=w===!0?e:n,M=w===!0?1:-1;for(let k=1;k<=i;k++)f.push(0,g*M,0),d.push(0,M,0),h.push(.5,.5),p++;const D=p;for(let k=0;k<=i;k++){const N=k/i*l+a,z=Math.cos(N),O=Math.sin(N);C.x=R*O,C.y=g*M,C.z=R*z,f.push(C.x,C.y,C.z),d.push(0,M,0),S.x=z*.5+.5,S.y=O*.5*M+.5,h.push(S.x,S.y),p++}for(let k=0;k<i;k++){const L=T+k,N=D+k;w===!0?u.push(N,N+1,L):u.push(N+1,N,L),A+=3}c.addGroup(y,A,w===!0?1:2),y+=A}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hu(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Lb extends hu{constructor(e=1,n=1,r=32,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,n,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Lb(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Sf extends gn{constructor(e=[],n=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:r,detail:i};const s=[],o=[];a(i),c(r),u(),this.setAttribute("position",new Dt(s,3)),this.setAttribute("normal",new Dt(s.slice(),3)),this.setAttribute("uv",new Dt(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(x){const _=new $,w=new $,T=new $;for(let S=0;S<n.length;S+=3)h(n[S+0],_),h(n[S+1],w),h(n[S+2],T),l(_,w,T,x)}function l(x,_,w,T){const S=T+1,C=[];for(let A=0;A<=S;A++){C[A]=[];const R=x.clone().lerp(w,A/S),M=_.clone().lerp(w,A/S),D=S-A;for(let k=0;k<=D;k++)k===0&&A===S?C[A][k]=R:C[A][k]=R.clone().lerp(M,k/D)}for(let A=0;A<S;A++)for(let R=0;R<2*(S-A)-1;R++){const M=Math.floor(R/2);R%2===0?(d(C[A][M+1]),d(C[A+1][M]),d(C[A][M])):(d(C[A][M+1]),d(C[A+1][M+1]),d(C[A+1][M]))}}function c(x){const _=new $;for(let w=0;w<s.length;w+=3)_.x=s[w+0],_.y=s[w+1],_.z=s[w+2],_.normalize().multiplyScalar(x),s[w+0]=_.x,s[w+1]=_.y,s[w+2]=_.z}function u(){const x=new $;for(let _=0;_<s.length;_+=3){x.x=s[_+0],x.y=s[_+1],x.z=s[_+2];const w=g(x)/2/Math.PI+.5,T=y(x)/Math.PI+.5;o.push(w,1-T)}p(),f()}function f(){for(let x=0;x<o.length;x+=6){const _=o[x+0],w=o[x+2],T=o[x+4],S=Math.max(_,w,T),C=Math.min(_,w,T);S>.9&&C<.1&&(_<.2&&(o[x+0]+=1),w<.2&&(o[x+2]+=1),T<.2&&(o[x+4]+=1))}}function d(x){s.push(x.x,x.y,x.z)}function h(x,_){const w=x*3;_.x=e[w+0],_.y=e[w+1],_.z=e[w+2]}function p(){const x=new $,_=new $,w=new $,T=new $,S=new Ke,C=new Ke,A=new Ke;for(let R=0,M=0;R<s.length;R+=9,M+=6){x.set(s[R+0],s[R+1],s[R+2]),_.set(s[R+3],s[R+4],s[R+5]),w.set(s[R+6],s[R+7],s[R+8]),S.set(o[M+0],o[M+1]),C.set(o[M+2],o[M+3]),A.set(o[M+4],o[M+5]),T.copy(x).add(_).add(w).divideScalar(3);const D=g(T);m(S,M+0,x,D),m(C,M+2,_,D),m(A,M+4,w,D)}}function m(x,_,w,T){T<0&&x.x===1&&(o[_]=x.x-1),w.x===0&&w.z===0&&(o[_]=T/2/Math.PI+.5)}function g(x){return Math.atan2(x.z,-x.x)}function y(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sf(e.vertices,e.indices,e.radius,e.details)}}class Db extends Sf{constructor(e=1,n=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Db(e.radius,e.detail)}}const v2=new $,x2=new $,qS=new $,_2=new Ci;class P6 extends gn{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const i=Math.pow(10,4),s=Math.cos(Ad*n),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],f=new Array(3),d={},h=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:m,b:g,c:y}=_2;if(m.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),y.fromBufferAttribute(a,c[2]),_2.getNormal(qS),f[0]=`${Math.round(m.x*i)},${Math.round(m.y*i)},${Math.round(m.z*i)}`,f[1]=`${Math.round(g.x*i)},${Math.round(g.y*i)},${Math.round(g.z*i)}`,f[2]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let x=0;x<3;x++){const _=(x+1)%3,w=f[x],T=f[_],S=_2[u[x]],C=_2[u[_]],A=`${w}_${T}`,R=`${T}_${w}`;R in d&&d[R]?(qS.dot(d[R].normal)<=s&&(h.push(S.x,S.y,S.z),h.push(C.x,C.y,C.z)),d[R]=null):A in d||(d[A]={index0:c[x],index1:c[_],normal:qS.clone()})}}for(const p in d)if(d[p]){const{index0:m,index1:g}=d[p];v2.fromBufferAttribute(a,m),x2.fromBufferAttribute(a,g),h.push(v2.x,v2.y,v2.z),h.push(x2.x,x2.y,x2.z)}this.setAttribute("position",new Dt(h,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}let tc=class extends of{constructor(e){super(e),this.uuid=ha(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let r=0,i=this.holes.length;r<i;r++)n[r]=this.holes[r].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){const i=e.holes[n];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,r=this.holes.length;n<r;n++){const i=this.holes[n];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){const i=e.holes[n];this.holes.push(new of().fromJSON(i))}return this}};const pne={triangulate:function(t,e,n=2){const r=e&&e.length,i=r?e[0]*n:t.length;let s=jz(t,0,i,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,f,d,h;if(r&&(s=xne(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(let p=n;p<i;p+=n)f=t[p],d=t[p+1],f<a&&(a=f),d<l&&(l=d),f>c&&(c=f),d>u&&(u=d);h=Math.max(c-a,u-l),h=h!==0?32767/h:0}return j1(s,o,n,a,l,h,0),o}};function jz(t,e,n,r,i){let s,o;if(i===Ine(t,e,n,r)>0)for(s=e;s<n;s+=r)o=xI(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=xI(s,t[s],t[s+1],o);return o&&Nb(o,o.next)&&(W1(o),o=o.next),o}function Vd(t,e){if(!t)return t;e||(e=t);let n=t,r;do if(r=!1,!n.steiner&&(Nb(n,n.next)||bi(n.prev,n,n.next)===0)){if(W1(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function j1(t,e,n,r,i,s,o){if(!t)return;!o&&s&&Sne(t,r,i,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?gne(t,r,i,s):mne(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),W1(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=yne(Vd(t),e,n),j1(t,e,n,r,i,s,2)):o===2&&vne(t,e,n,r,i,s):j1(Vd(t),e,n,r,i,s,1);break}}}function mne(t){const e=t.prev,n=t,r=t.next;if(bi(e,n,r)>=0)return!1;const i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,f=a<l?a<c?a:c:l<c?l:c,d=i>s?i>o?i:o:s>o?s:o,h=a>l?a>c?a:c:l>c?l:c;let p=r.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=f&&p.y<=h&&Vp(i,a,s,l,o,c,p.x,p.y)&&bi(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function gne(t,e,n,r){const i=t.prev,s=t,o=t.next;if(bi(i,s,o)>=0)return!1;const a=i.x,l=s.x,c=o.x,u=i.y,f=s.y,d=o.y,h=a<l?a<c?a:c:l<c?l:c,p=u<f?u<d?u:d:f<d?f:d,m=a>l?a>c?a:c:l>c?l:c,g=u>f?u>d?u:d:f>d?f:d,y=KA(h,p,e,n,r),x=KA(m,g,e,n,r);let _=t.prevZ,w=t.nextZ;for(;_&&_.z>=y&&w&&w.z<=x;){if(_.x>=h&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==o&&Vp(a,u,l,f,c,d,_.x,_.y)&&bi(_.prev,_,_.next)>=0||(_=_.prevZ,w.x>=h&&w.x<=m&&w.y>=p&&w.y<=g&&w!==i&&w!==o&&Vp(a,u,l,f,c,d,w.x,w.y)&&bi(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;_&&_.z>=y;){if(_.x>=h&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==o&&Vp(a,u,l,f,c,d,_.x,_.y)&&bi(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;w&&w.z<=x;){if(w.x>=h&&w.x<=m&&w.y>=p&&w.y<=g&&w!==i&&w!==o&&Vp(a,u,l,f,c,d,w.x,w.y)&&bi(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function yne(t,e,n){let r=t;do{const i=r.prev,s=r.next.next;!Nb(i,s)&&Vz(i,r,r.next,s)&&V1(i,s)&&V1(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),W1(r),W1(r.next),r=t=s),r=r.next}while(r!==t);return Vd(r)}function vne(t,e,n,r,i,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Mne(o,a)){let l=Wz(o,a);o=Vd(o,o.next),l=Vd(l,l.next),j1(o,e,n,r,i,s,0),j1(l,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function xne(t,e,n,r){const i=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=jz(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(Ane(c));for(i.sort(_ne),s=0;s<i.length;s++)n=bne(i[s],n);return n}function _ne(t,e){return t.x-e.x}function bne(t,e){const n=Ene(t,e);if(!n)return e;const r=Wz(n,t);return Vd(r,r.next),Vd(n,n.next)}function Ene(t,e){let n=e,r=-1/0,i;const s=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const d=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=s&&d>r&&(r=d,i=n.x<n.next.x?n:n.next,d===s))return i}n=n.next}while(n!==e);if(!i)return null;const a=i,l=i.x,c=i.y;let u=1/0,f;n=i;do s>=n.x&&n.x>=l&&s!==n.x&&Vp(o<c?s:r,o,l,c,o<c?r:s,o,n.x,n.y)&&(f=Math.abs(o-n.y)/(s-n.x),V1(n,t)&&(f<u||f===u&&(n.x>i.x||n.x===i.x&&wne(i,n)))&&(i=n,u=f)),n=n.next;while(n!==a);return i}function wne(t,e){return bi(t.prev,t,e.prev)<0&&bi(e.next,t,t.next)<0}function Sne(t,e,n,r){let i=t;do i.z===0&&(i.z=KA(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Tne(i)}function Tne(t){let e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1);return t}function KA(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Ane(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Vp(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function Mne(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Cne(t,e)&&(V1(t,e)&&V1(e,t)&&Rne(t,e)&&(bi(t.prev,t,e.prev)||bi(t,e.prev,e))||Nb(t,e)&&bi(t.prev,t,t.next)>0&&bi(e.prev,e,e.next)>0)}function bi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Nb(t,e){return t.x===e.x&&t.y===e.y}function Vz(t,e,n,r){const i=E2(bi(t,e,n)),s=E2(bi(t,e,r)),o=E2(bi(n,r,t)),a=E2(bi(n,r,e));return!!(i!==s&&o!==a||i===0&&b2(t,n,e)||s===0&&b2(t,r,e)||o===0&&b2(n,t,r)||a===0&&b2(n,e,r))}function b2(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function E2(t){return t>0?1:t<0?-1:0}function Cne(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Vz(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function V1(t,e){return bi(t.prev,t,t.next)<0?bi(t,e,t.next)>=0&&bi(t,t.prev,e)>=0:bi(t,e,t.prev)<0||bi(t,t.next,e)<0}function Rne(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function Wz(t,e){const n=new ZA(t.i,t.x,t.y),r=new ZA(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function xI(t,e,n,r){const i=new ZA(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function W1(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ZA(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ine(t,e,n,r){let i=0;for(let s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}class vl{static area(e){const n=e.length;let r=0;for(let i=n-1,s=0;s<n;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return vl.area(e)<0}static triangulateShape(e,n){const r=[],i=[],s=[];_I(e),bI(r,e);let o=e.length;n.forEach(_I);for(let l=0;l<n.length;l++)i.push(o),o+=n[l].length,bI(r,n[l]);const a=pne.triangulate(r,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function _I(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function bI(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class vy extends gn{constructor(e=new tc([new Ke(.5,.5),new Ke(-.5,.5),new Ke(-.5,-.5),new Ke(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new Dt(i,3)),this.setAttribute("uv",new Dt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,f=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,h=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:h-.1,m=n.bevelOffset!==void 0?n.bevelOffset:0,g=n.bevelSegments!==void 0?n.bevelSegments:3;const y=n.extrudePath,x=n.UVGenerator!==void 0?n.UVGenerator:Pne;let _,w=!1,T,S,C,A;y&&(_=y.getSpacedPoints(u),w=!0,d=!1,T=y.computeFrenetFrames(u,!1),S=new $,C=new $,A=new $),d||(g=0,h=0,p=0,m=0);const R=a.extractPoints(c);let M=R.shape;const D=R.holes;if(!vl.isClockWise(M)){M=M.reverse();for(let _e=0,Re=D.length;_e<Re;_e++){const ae=D[_e];vl.isClockWise(ae)&&(D[_e]=ae.reverse())}}const L=vl.triangulateShape(M,D),N=M;for(let _e=0,Re=D.length;_e<Re;_e++){const ae=D[_e];M=M.concat(ae)}function z(_e,Re,ae){return Re||console.error("THREE.ExtrudeGeometry: vec does not exist"),_e.clone().addScaledVector(Re,ae)}const O=M.length,K=L.length;function V(_e,Re,ae){let Ce,Pe,Ve;const ye=_e.x-Re.x,ge=_e.y-Re.y,ze=ae.x-_e.x,fe=ae.y-_e.y,ie=ye*ye+ge*ge,ve=ye*fe-ge*ze;if(Math.abs(ve)>Number.EPSILON){const Me=Math.sqrt(ie),Be=Math.sqrt(ze*ze+fe*fe),Ze=Re.x-ge/Me,F=Re.y+ye/Me,Z=ae.x-fe/Be,q=ae.y+ze/Be,xe=((Z-Ze)*fe-(q-F)*ze)/(ye*fe-ge*ze);Ce=Ze+ye*xe-_e.x,Pe=F+ge*xe-_e.y;const be=Ce*Ce+Pe*Pe;if(be<=2)return new Ke(Ce,Pe);Ve=Math.sqrt(be/2)}else{let Me=!1;ye>Number.EPSILON?ze>Number.EPSILON&&(Me=!0):ye<-Number.EPSILON?ze<-Number.EPSILON&&(Me=!0):Math.sign(ge)===Math.sign(fe)&&(Me=!0),Me?(Ce=-ge,Pe=ye,Ve=Math.sqrt(ie)):(Ce=ye,Pe=ge,Ve=Math.sqrt(ie/2))}return new Ke(Ce/Ve,Pe/Ve)}const ne=[];for(let _e=0,Re=N.length,ae=Re-1,Ce=_e+1;_e<Re;_e++,ae++,Ce++)ae===Re&&(ae=0),Ce===Re&&(Ce=0),ne[_e]=V(N[_e],N[ae],N[Ce]);const re=[];let P,se=ne.concat();for(let _e=0,Re=D.length;_e<Re;_e++){const ae=D[_e];P=[];for(let Ce=0,Pe=ae.length,Ve=Pe-1,ye=Ce+1;Ce<Pe;Ce++,Ve++,ye++)Ve===Pe&&(Ve=0),ye===Pe&&(ye=0),P[Ce]=V(ae[Ce],ae[Ve],ae[ye]);re.push(P),se=se.concat(P)}for(let _e=0;_e<g;_e++){const Re=_e/g,ae=h*Math.cos(Re*Math.PI/2),Ce=p*Math.sin(Re*Math.PI/2)+m;for(let Pe=0,Ve=N.length;Pe<Ve;Pe++){const ye=z(N[Pe],ne[Pe],Ce);J(ye.x,ye.y,-ae)}for(let Pe=0,Ve=D.length;Pe<Ve;Pe++){const ye=D[Pe];P=re[Pe];for(let ge=0,ze=ye.length;ge<ze;ge++){const fe=z(ye[ge],P[ge],Ce);J(fe.x,fe.y,-ae)}}}const ue=p+m;for(let _e=0;_e<O;_e++){const Re=d?z(M[_e],se[_e],ue):M[_e];w?(C.copy(T.normals[0]).multiplyScalar(Re.x),S.copy(T.binormals[0]).multiplyScalar(Re.y),A.copy(_[0]).add(C).add(S),J(A.x,A.y,A.z)):J(Re.x,Re.y,0)}for(let _e=1;_e<=u;_e++)for(let Re=0;Re<O;Re++){const ae=d?z(M[Re],se[Re],ue):M[Re];w?(C.copy(T.normals[_e]).multiplyScalar(ae.x),S.copy(T.binormals[_e]).multiplyScalar(ae.y),A.copy(_[_e]).add(C).add(S),J(A.x,A.y,A.z)):J(ae.x,ae.y,f/u*_e)}for(let _e=g-1;_e>=0;_e--){const Re=_e/g,ae=h*Math.cos(Re*Math.PI/2),Ce=p*Math.sin(Re*Math.PI/2)+m;for(let Pe=0,Ve=N.length;Pe<Ve;Pe++){const ye=z(N[Pe],ne[Pe],Ce);J(ye.x,ye.y,f+ae)}for(let Pe=0,Ve=D.length;Pe<Ve;Pe++){const ye=D[Pe];P=re[Pe];for(let ge=0,ze=ye.length;ge<ze;ge++){const fe=z(ye[ge],P[ge],Ce);w?J(fe.x,fe.y+_[u-1].y,_[u-1].x+ae):J(fe.x,fe.y,f+ae)}}}te(),W();function te(){const _e=i.length/3;if(d){let Re=0,ae=O*Re;for(let Ce=0;Ce<K;Ce++){const Pe=L[Ce];oe(Pe[2]+ae,Pe[1]+ae,Pe[0]+ae)}Re=u+g*2,ae=O*Re;for(let Ce=0;Ce<K;Ce++){const Pe=L[Ce];oe(Pe[0]+ae,Pe[1]+ae,Pe[2]+ae)}}else{for(let Re=0;Re<K;Re++){const ae=L[Re];oe(ae[2],ae[1],ae[0])}for(let Re=0;Re<K;Re++){const ae=L[Re];oe(ae[0]+O*u,ae[1]+O*u,ae[2]+O*u)}}r.addGroup(_e,i.length/3-_e,0)}function W(){const _e=i.length/3;let Re=0;X(N,Re),Re+=N.length;for(let ae=0,Ce=D.length;ae<Ce;ae++){const Pe=D[ae];X(Pe,Re),Re+=Pe.length}r.addGroup(_e,i.length/3-_e,1)}function X(_e,Re){let ae=_e.length;for(;--ae>=0;){const Ce=ae;let Pe=ae-1;Pe<0&&(Pe=_e.length-1);for(let Ve=0,ye=u+g*2;Ve<ye;Ve++){const ge=O*Ve,ze=O*(Ve+1),fe=Re+Ce+ge,ie=Re+Pe+ge,ve=Re+Pe+ze,Me=Re+Ce+ze;Ee(fe,ie,ve,Me)}}}function J(_e,Re,ae){l.push(_e),l.push(Re),l.push(ae)}function oe(_e,Re,ae){me(_e),me(Re),me(ae);const Ce=i.length/3,Pe=x.generateTopUV(r,i,Ce-3,Ce-2,Ce-1);Te(Pe[0]),Te(Pe[1]),Te(Pe[2])}function Ee(_e,Re,ae,Ce){me(_e),me(Re),me(Ce),me(Re),me(ae),me(Ce);const Pe=i.length/3,Ve=x.generateSideWallUV(r,i,Pe-6,Pe-3,Pe-2,Pe-1);Te(Ve[0]),Te(Ve[1]),Te(Ve[3]),Te(Ve[1]),Te(Ve[2]),Te(Ve[3])}function me(_e){i.push(l[_e*3+0]),i.push(l[_e*3+1]),i.push(l[_e*3+2])}function Te(_e){s.push(_e.x),s.push(_e.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,r=this.parameters.options;return kne(n,r,e)}static fromJSON(e,n){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new u_[i.type]().fromJSON(i)),new vy(r,e.options)}}const Pne={generateTopUV:function(t,e,n,r,i){const s=e[n*3],o=e[n*3+1],a=e[r*3],l=e[r*3+1],c=e[i*3],u=e[i*3+1];return[new Ke(s,o),new Ke(a,l),new Ke(c,u)]},generateSideWallUV:function(t,e,n,r,i,s){const o=e[n*3],a=e[n*3+1],l=e[n*3+2],c=e[r*3],u=e[r*3+1],f=e[r*3+2],d=e[i*3],h=e[i*3+1],p=e[i*3+2],m=e[s*3],g=e[s*3+1],y=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new Ke(o,1-l),new Ke(c,1-f),new Ke(d,1-p),new Ke(m,1-y)]:[new Ke(a,1-l),new Ke(u,1-f),new Ke(h,1-p),new Ke(g,1-y)]}};function kne(t,e,n){if(n.shapes=[],Array.isArray(t))for(let r=0,i=t.length;r<i;r++){const s=t[r];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class xy extends Sf{constructor(e=1,n=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new xy(e.radius,e.detail)}}class _y extends Sf{constructor(e=1,n=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new _y(e.radius,e.detail)}}class Ps extends gn{constructor(e=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:i};const s=e/2,o=n/2,a=Math.floor(r),l=Math.floor(i),c=a+1,u=l+1,f=e/a,d=n/l,h=[],p=[],m=[],g=[];for(let y=0;y<u;y++){const x=y*d-o;for(let _=0;_<c;_++){const w=_*f-s;p.push(w,-x,0),m.push(0,0,1),g.push(_/a),g.push(1-y/l)}}for(let y=0;y<l;y++)for(let x=0;x<a;x++){const _=x+c*y,w=x+c*(y+1),T=x+1+c*(y+1),S=x+1+c*y;h.push(_,w,S),h.push(w,T,S)}this.setIndex(h),this.setAttribute("position",new Dt(p,3)),this.setAttribute("normal",new Dt(m,3)),this.setAttribute("uv",new Dt(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ps(e.width,e.height,e.widthSegments,e.heightSegments)}}class Ob extends gn{constructor(e=.5,n=1,r=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:o},r=Math.max(3,r),i=Math.max(1,i);const a=[],l=[],c=[],u=[];let f=e;const d=(n-e)/i,h=new $,p=new Ke;for(let m=0;m<=i;m++){for(let g=0;g<=r;g++){const y=s+g/r*o;h.x=f*Math.cos(y),h.y=f*Math.sin(y),l.push(h.x,h.y,h.z),c.push(0,0,1),p.x=(h.x/n+1)/2,p.y=(h.y/n+1)/2,u.push(p.x,p.y)}f+=d}for(let m=0;m<i;m++){const g=m*(r+1);for(let y=0;y<r;y++){const x=y+g,_=x,w=x+r+1,T=x+r+2,S=x+1;a.push(_,w,S),a.push(w,T,S)}}this.setIndex(a),this.setAttribute("position",new Dt(l,3)),this.setAttribute("normal",new Dt(c,3)),this.setAttribute("uv",new Dt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ob(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class by extends gn{constructor(e=new tc([new Ke(0,.5),new Ke(-.5,-.5),new Ke(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const r=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(r),this.setAttribute("position",new Dt(i,3)),this.setAttribute("normal",new Dt(s,3)),this.setAttribute("uv",new Dt(o,2));function c(u){const f=i.length/3,d=u.extractPoints(n);let h=d.shape;const p=d.holes;vl.isClockWise(h)===!1&&(h=h.reverse());for(let g=0,y=p.length;g<y;g++){const x=p[g];vl.isClockWise(x)===!0&&(p[g]=x.reverse())}const m=vl.triangulateShape(h,p);for(let g=0,y=p.length;g<y;g++){const x=p[g];h=h.concat(x)}for(let g=0,y=h.length;g<y;g++){const x=h[g];i.push(x.x,x.y,0),s.push(0,0,1),o.push(x.x,x.y)}for(let g=0,y=m.length;g<y;g++){const x=m[g],_=x[0]+f,w=x[1]+f,T=x[2]+f;r.push(_,w,T),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return Lne(n,e)}static fromJSON(e,n){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=n[e.shapes[i]];r.push(o)}return new by(r,e.curveSegments)}}function Lne(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}class Tf extends gn{constructor(e=1,n=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const l=Math.min(o+a,Math.PI);let c=0;const u=[],f=new $,d=new $,h=[],p=[],m=[],g=[];for(let y=0;y<=r;y++){const x=[],_=y/r;let w=0;y===0&&o===0?w=.5/n:y===r&&l===Math.PI&&(w=-.5/n);for(let T=0;T<=n;T++){const S=T/n;f.x=-e*Math.cos(i+S*s)*Math.sin(o+_*a),f.y=e*Math.cos(o+_*a),f.z=e*Math.sin(i+S*s)*Math.sin(o+_*a),p.push(f.x,f.y,f.z),d.copy(f).normalize(),m.push(d.x,d.y,d.z),g.push(S+w,1-_),x.push(c++)}u.push(x)}for(let y=0;y<r;y++)for(let x=0;x<n;x++){const _=u[y][x+1],w=u[y][x],T=u[y+1][x],S=u[y+1][x+1];(y!==0||o>0)&&h.push(_,w,S),(y!==r-1||l<Math.PI)&&h.push(w,T,S)}this.setIndex(h),this.setAttribute("position",new Dt(p,3)),this.setAttribute("normal",new Dt(m,3)),this.setAttribute("uv",new Dt(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tf(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Fb extends Sf{constructor(e=1,n=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Fb(e.radius,e.detail)}}class Ub extends gn{constructor(e=1,n=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],l=[],c=[],u=new $,f=new $,d=new $;for(let h=0;h<=r;h++)for(let p=0;p<=i;p++){const m=p/i*s,g=h/r*Math.PI*2;f.x=(e+n*Math.cos(g))*Math.cos(m),f.y=(e+n*Math.cos(g))*Math.sin(m),f.z=n*Math.sin(g),a.push(f.x,f.y,f.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),d.subVectors(f,u).normalize(),l.push(d.x,d.y,d.z),c.push(p/i),c.push(h/r)}for(let h=1;h<=r;h++)for(let p=1;p<=i;p++){const m=(i+1)*h+p-1,g=(i+1)*(h-1)+p-1,y=(i+1)*(h-1)+p,x=(i+1)*h+p;o.push(m,g,x),o.push(g,y,x)}this.setIndex(o),this.setAttribute("position",new Dt(a,3)),this.setAttribute("normal",new Dt(l,3)),this.setAttribute("uv",new Dt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ub(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Bb extends gn{constructor(e=1,n=.4,r=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:r,radialSegments:i,p:s,q:o},r=Math.floor(r),i=Math.floor(i);const a=[],l=[],c=[],u=[],f=new $,d=new $,h=new $,p=new $,m=new $,g=new $,y=new $;for(let _=0;_<=r;++_){const w=_/r*s*Math.PI*2;x(w,s,o,e,h),x(w+.01,s,o,e,p),g.subVectors(p,h),y.addVectors(p,h),m.crossVectors(g,y),y.crossVectors(m,g),m.normalize(),y.normalize();for(let T=0;T<=i;++T){const S=T/i*Math.PI*2,C=-n*Math.cos(S),A=n*Math.sin(S);f.x=h.x+(C*y.x+A*m.x),f.y=h.y+(C*y.y+A*m.y),f.z=h.z+(C*y.z+A*m.z),l.push(f.x,f.y,f.z),d.subVectors(f,h).normalize(),c.push(d.x,d.y,d.z),u.push(_/r),u.push(T/i)}}for(let _=1;_<=r;_++)for(let w=1;w<=i;w++){const T=(i+1)*(_-1)+(w-1),S=(i+1)*_+(w-1),C=(i+1)*_+w,A=(i+1)*(_-1)+w;a.push(T,S,A),a.push(S,C,A)}this.setIndex(a),this.setAttribute("position",new Dt(l,3)),this.setAttribute("normal",new Dt(c,3)),this.setAttribute("uv",new Dt(u,2));function x(_,w,T,S,C){const A=Math.cos(_),R=Math.sin(_),M=T/w*_,D=Math.cos(M);C.x=S*(2+D)*.5*A,C.y=S*(2+D)*R*.5,C.z=S*Math.sin(M)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bb(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class zb extends gn{constructor(e=new gy(new $(-1,-1,0),new $(-1,1,0),new $(1,1,0)),n=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:r,radialSegments:i,closed:s};const o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new $,l=new $,c=new Ke;let u=new $;const f=[],d=[],h=[],p=[];m(),this.setIndex(p),this.setAttribute("position",new Dt(f,3)),this.setAttribute("normal",new Dt(d,3)),this.setAttribute("uv",new Dt(h,2));function m(){for(let _=0;_<n;_++)g(_);g(s===!1?n:0),x(),y()}function g(_){u=e.getPointAt(_/n,u);const w=o.normals[_],T=o.binormals[_];for(let S=0;S<=i;S++){const C=S/i*Math.PI*2,A=Math.sin(C),R=-Math.cos(C);l.x=R*w.x+A*T.x,l.y=R*w.y+A*T.y,l.z=R*w.z+A*T.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=u.x+r*l.x,a.y=u.y+r*l.y,a.z=u.z+r*l.z,f.push(a.x,a.y,a.z)}}function y(){for(let _=1;_<=n;_++)for(let w=1;w<=i;w++){const T=(i+1)*(_-1)+(w-1),S=(i+1)*_+(w-1),C=(i+1)*_+w,A=(i+1)*(_-1)+w;p.push(T,S,A),p.push(S,C,A)}}function x(){for(let _=0;_<=n;_++)for(let w=0;w<=i;w++)c.x=_/n,c.y=w/i,h.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new zb(new u_[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class k6 extends gn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],r=new Set,i=new $,s=new $;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const f=l[c],d=f.start,h=f.count;for(let p=d,m=d+h;p<m;p+=3)for(let g=0;g<3;g++){const y=a.getX(p+g),x=a.getX(p+(g+1)%3);i.fromBufferAttribute(o,y),s.fromBufferAttribute(o,x),EI(i,s,r)===!0&&(n.push(i.x,i.y,i.z),n.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,f=3*a+(c+1)%3;i.fromBufferAttribute(o,u),s.fromBufferAttribute(o,f),EI(i,s,r)===!0&&(n.push(i.x,i.y,i.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new Dt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function EI(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(r)===!0||n.has(i)===!0?!1:(n.add(r),n.add(i),!0)}var wI=Object.freeze({__proto__:null,BoxGeometry:fc,CapsuleGeometry:Pb,CircleGeometry:kb,ConeGeometry:Lb,CylinderGeometry:hu,DodecahedronGeometry:Db,EdgesGeometry:P6,ExtrudeGeometry:vy,IcosahedronGeometry:xy,LatheGeometry:yy,OctahedronGeometry:_y,PlaneGeometry:Ps,PolyhedronGeometry:Sf,RingGeometry:Ob,ShapeGeometry:by,SphereGeometry:Tf,TetrahedronGeometry:Fb,TorusGeometry:Ub,TorusKnotGeometry:Bb,TubeGeometry:zb,WireframeGeometry:k6});class L6 extends Wr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new wt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class D6 extends yr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ka extends Wr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new wt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new Ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ur extends Ka{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ke(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Wn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new wt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new wt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new wt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class nu extends Wr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new wt(16777215),this.specular=new wt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new Ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xr,this.combine=fy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $z extends Wr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new wt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new Ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Hb extends Wr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new Ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class nh extends Wr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new Ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xr,this.combine=fy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class zm extends Wr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=_z,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Gb extends Wr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Xz extends Wr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new wt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=du,this.normalScale=new Ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class N6 extends oi{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function xd(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function qz(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Yz(t){function e(i,s){return t[i]-t[s]}const n=t.length,r=new Array(n);for(let i=0;i!==n;++i)r[i]=i;return r.sort(e),r}function QA(t,e,n){const r=t.length,i=new t.constructor(r);for(let s=0,o=0;o!==r;++s){const a=n[s]*e;for(let l=0;l!==e;++l)i[o++]=t[a+l]}return i}function O6(t,e,n,r){let i=1,s=t[0];for(;s!==void 0&&s[r]===void 0;)s=t[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),n.push.apply(n,o)),s=t[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),n.push(o)),s=t[i++];while(s!==void 0)}function Dne(t,e,n,r,i=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),f=[],d=[];for(let h=0;h<c.times.length;++h){const p=c.times[h]*i;if(!(p<n||p>=r)){f.push(c.times[h]);for(let m=0;m<u;++m)d.push(c.values[h*u+m])}}f.length!==0&&(c.times=xd(f,c.times.constructor),c.values=xd(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function Nne(t,e=0,n=t,r=30){r<=0&&(r=30);const i=n.tracks.length,s=e/r;for(let o=0;o<i;++o){const a=n.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(c===void 0)continue;let u=0;const f=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let d=0;const h=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=h/3);const p=a.times.length-1;let m;if(s<=a.times[0]){const y=u,x=f-u;m=a.values.slice(y,x)}else if(s>=a.times[p]){const y=p*f+u,x=y+f-u;m=a.values.slice(y,x)}else{const y=a.createInterpolant(),x=u,_=f-u;y.evaluate(s),m=y.resultBuffer.slice(x,_)}l==="quaternion"&&new bn().fromArray(m).normalize().conjugate().toArray(m);const g=c.times.length;for(let y=0;y<g;++y){const x=y*h+d;if(l==="quaternion")bn.multiplyQuaternionsFlat(c.values,x,m,0,c.values,x);else{const _=h-d*2;for(let w=0;w<_;++w)c.values[x+w]-=m[w]}}}return t.blendMode=p6,t}const One={convertArray:xd,isTypedArray:qz,getKeyframeOrder:Yz,sortedArray:QA,flattenJSON:O6,subclip:Dne,makeClipAdditive:Nne};class rh{constructor(e,n,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let r=this._cachedIndex,i=n[r],s=n[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=n[++r],e<i)break t}o=n.length;break n}if(!(e>=s)){const a=n[1];e<a&&(r=2,s=a);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=n[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<n[a]?o=a:r=a+1}if(i=n[r],s=n[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)n[o]=r[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Kz extends rh{constructor(e,n,r,i){super(e,n,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:md,endingEnd:md}}intervalChanged_(e,n,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case gd:s=e,a=2*n-r;break;case U1:s=i.length-2,a=n+i[s]-i[s+1];break;default:s=e,a=r}if(l===void 0)switch(this.getSettings_().endingEnd){case gd:o=e,l=2*r-n;break;case U1:o=1,l=r+i[1]-i[0];break;default:o=e-1,l=n}const c=(r-n)*.5,u=this.valueSize;this._weightPrev=c/(n-a),this._weightNext=c/(l-r),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,n,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,f=this._offsetNext,d=this._weightPrev,h=this._weightNext,p=(r-n)/(i-n),m=p*p,g=m*p,y=-d*g+2*d*m-d*p,x=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*p+1,_=(-1-h)*g+(1.5+h)*m+.5*p,w=h*g-h*m;for(let T=0;T!==a;++T)s[T]=y*o[u+T]+x*o[c+T]+_*o[l+T]+w*o[f+T];return s}}class F6 extends rh{constructor(e,n,r,i){super(e,n,r,i)}interpolate_(e,n,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(r-n)/(i-n),f=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*f+o[l+d]*u;return s}}class Zz extends rh{constructor(e,n,r,i){super(e,n,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Tl{constructor(e,n,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=xd(n,this.TimeBufferType),this.values=xd(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let r;if(n.toJSON!==this.toJSON)r=n.toJSON(e);else{r={name:e.name,times:xd(e.times,Array),values:xd(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Zz(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new F6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Kz(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case Gd:n=this.InterpolantFactoryMethodDiscrete;break;case pf:n=this.InterpolantFactoryMethodLinear;break;case l3:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Gd;case this.InterpolantFactoryMethodLinear:return pf;case this.InterpolantFactoryMethodSmooth:return l3}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let r=0,i=n.length;r!==i;++r)n[r]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let r=0,i=n.length;r!==i;++r)n[r]*=e}return this}trim(e,n){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>n;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=r[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&qz(i))for(let a=0,l=i.length;a!==l;++a){const c=i[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===l3,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(i)l=!0;else{const f=a*r,d=f-r,h=f+r;for(let p=0;p!==r;++p){const m=n[f+p];if(m!==n[d+p]||m!==n[h+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*r,d=o*r;for(let h=0;h!==r;++h)n[d+h]=n[f+h]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,l=o*r,c=0;c!==r;++c)n[l+c]=n[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=n.slice(0,o*r)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),r=this.constructor,i=new r(this.name,e,n);return i.createInterpolant=this.createInterpolant,i}}Tl.prototype.TimeBufferType=Float32Array;Tl.prototype.ValueBufferType=Float32Array;Tl.prototype.DefaultInterpolation=pf;class ih extends Tl{constructor(e,n,r){super(e,n,r)}}ih.prototype.ValueTypeName="bool";ih.prototype.ValueBufferType=Array;ih.prototype.DefaultInterpolation=Gd;ih.prototype.InterpolantFactoryMethodLinear=void 0;ih.prototype.InterpolantFactoryMethodSmooth=void 0;class U6 extends Tl{}U6.prototype.ValueTypeName="color";class ru extends Tl{}ru.prototype.ValueTypeName="number";class Qz extends rh{constructor(e,n,r,i){super(e,n,r,i)}interpolate_(e,n,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(r-n)/(i-n);let c=e*a;for(let u=c+a;c!==u;c+=4)bn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Za extends Tl{InterpolantFactoryMethodLinear(e){return new Qz(this.times,this.values,this.getValueSize(),e)}}Za.prototype.ValueTypeName="quaternion";Za.prototype.InterpolantFactoryMethodSmooth=void 0;class sh extends Tl{constructor(e,n,r){super(e,n,r)}}sh.prototype.ValueTypeName="string";sh.prototype.ValueBufferType=Array;sh.prototype.DefaultInterpolation=Gd;sh.prototype.InterpolantFactoryMethodLinear=void 0;sh.prototype.InterpolantFactoryMethodSmooth=void 0;class Xo extends Tl{}Xo.prototype.ValueTypeName="vector";class Qa{constructor(e="",n=-1,r=[],i=bb){this.name=e,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=ha(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)n.push(Une(r[o]).scale(i));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)n.push(Tl.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,n,r,i){const s=n.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=Yz(l);l=QA(l,1,u),c=QA(c,1,u),!i&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new ru(".morphTargetInfluences["+n[a].name+"]",l,c).scale(1/r))}return new this(e,-1,o)}static findByName(e,n){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===n)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,n,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const f=u[1];let d=i[f];d||(i[f]=d=[]),d.push(c)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],n,r));return o}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,d,h,p,m){if(h.length!==0){const g=[],y=[];O6(h,g,y,p),g.length!==0&&m.push(new f(d,g,y))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let f=0;f<c.length;f++){const d=c[f].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const h={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let m=0;m<d[p].morphTargets.length;m++)h[d[p].morphTargets[m]]=-1;for(const m in h){const g=[],y=[];for(let x=0;x!==d[p].morphTargets.length;++x){const _=d[p];g.push(_.time),y.push(_.morphTarget===m?1:0)}i.push(new ru(".morphTargetInfluence["+m+"]",g,y))}l=h.length*o}else{const h=".bones["+n[f].name+"]";r(Xo,h+".position",d,"pos",i),r(Za,h+".quaternion",d,"rot",i),r(Xo,h+".scale",d,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let n=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Fne(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ru;case"vector":case"vector2":case"vector3":case"vector4":return Xo;case"color":return U6;case"quaternion":return Za;case"bool":case"boolean":return ih;case"string":return sh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function Une(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Fne(t.type);if(t.times===void 0){const n=[],r=[];O6(t.keys,n,r,"value"),t.times=n,t.values=r}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const qc={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class jb{constructor(e,n,r){const i=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(u){a++,s===!1&&i.onStart!==void 0&&i.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,f){return c.push(u,f),this},this.removeHandler=function(u){const f=c.indexOf(u);return f!==-1&&c.splice(f,2),this},this.getHandler=function(u){for(let f=0,d=c.length;f<d;f+=2){const h=c[f],p=c[f+1];if(h.global&&(h.lastIndex=0),h.test(u))return p}return null}}}const Vb=new jb;class Br{constructor(e){this.manager=e!==void 0?e:Vb,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(i,s){r.load(e,i,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Br.DEFAULT_MATERIAL_NAME="__DEFAULT";const Sc={};class Bne extends Error{constructor(e,n){super(e),this.response=n}}class qr extends Br{constructor(e){super(e)}load(e,n,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=qc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(Sc[e]!==void 0){Sc[e].push({onLoad:n,onProgress:r,onError:i});return}Sc[e]=[],Sc[e].push({onLoad:n,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=Sc[e],f=c.body.getReader(),d=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),h=d?parseInt(d):0,p=h!==0;let m=0;const g=new ReadableStream({start(y){x();function x(){f.read().then(({done:_,value:w})=>{if(_)y.close();else{m+=w.byteLength;const T=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:h});for(let S=0,C=u.length;S<C;S++){const A=u[S];A.onProgress&&A.onProgress(T)}y.enqueue(w),x()}},_=>{y.error(_)})}}});return new Response(g)}else throw new Bne(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),d=f&&f[1]?f[1].toLowerCase():void 0,h=new TextDecoder(d);return c.arrayBuffer().then(p=>h.decode(p))}}}).then(c=>{qc.add(e,c);const u=Sc[e];delete Sc[e];for(let f=0,d=u.length;f<d;f++){const h=u[f];h.onLoad&&h.onLoad(c)}}).catch(c=>{const u=Sc[e];if(u===void 0)throw this.manager.itemError(e),c;delete Sc[e];for(let f=0,d=u.length;f<d;f++){const h=u[f];h.onError&&h.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class zne extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=new qr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const n=[];for(let r=0;r<e.length;r++){const i=Qa.parse(e[r]);n.push(i)}return n}}class Hne extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=[],a=new Rb,l=new qr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(f){l.load(e[f],function(d){const h=s.parse(d,!0);o[f]={width:h.width,height:h.height,format:h.format,mipmaps:h.mipmaps},c+=1,c===6&&(h.mipmapCount===1&&(a.minFilter=Pn),a.image=o,a.format=h.format,a.needsUpdate=!0,n&&n(a))},r,i)}if(Array.isArray(e))for(let f=0,d=e.length;f<d;++f)u(f);else l.load(e,function(f){const d=s.parse(f,!0);if(d.isCubemap){const h=d.mipmaps.length/d.mipmapCount;for(let p=0;p<h;p++){o[p]={mipmaps:[]};for(let m=0;m<d.mipmapCount;m++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+m]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=Pn),a.format=d.format,a.needsUpdate=!0,n&&n(a)},r,i);return a}}class $1 extends Br{constructor(e){super(e)}load(e,n,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=qc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a=G1("img");function l(){u(),qc.add(e,this),n&&n(this),s.manager.itemEnd(e)}function c(f){u(),i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Jz extends Br{constructor(e){super(e)}load(e,n,r,i){const s=new my;s.colorSpace=Er;const o=new $1(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,n&&n(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class Ey extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=new As,a=new qr(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(i!==void 0)i(u);else{console.error(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:ei,o.wrapT=c.wrapT!==void 0?c.wrapT:ei,o.magFilter=c.magFilter!==void 0?c.magFilter:Pn,o.minFilter=c.minFilter!==void 0?c.minFilter:Pn,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(o.colorSpace=c.colorSpace),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Ts),c.mipmapCount===1&&(o.minFilter=Pn),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,n&&n(o,c)},r,i),o}}class ns extends Br{constructor(e){super(e)}load(e,n,r,i){const s=new tr,o=new $1(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,n!==void 0&&n(s)},r,i),s}}class Af extends yn{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new wt(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class eH extends Af{constructor(e,n,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(yn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new wt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const YS=new et,SI=new $,TI=new $;class B6{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ke(512,512),this.map=null,this.mapPass=null,this.matrix=new et,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new th,this._frameExtents=new Ke(1,1),this._viewportCount=1,this._viewports=[new Hn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,r=this.matrix;SI.setFromMatrixPosition(e.matrixWorld),n.position.copy(SI),TI.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(TI),n.updateMatrixWorld(),YS.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(YS),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(YS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}let Gne=class extends B6{constructor(){super(new Ar(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,r=gm*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(r!==n.fov||i!==n.aspect||s!==n.far)&&(n.fov=r,n.aspect=i,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},Hm=class extends Af{constructor(e,n,r=0,i=Math.PI/3,s=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(yn.DEFAULT_UP),this.updateMatrix(),this.target=new yn,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Gne}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};const AI=new et,$0=new $,KS=new $;class jne extends B6{constructor(){super(new Ar(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ke(4,2),this._viewportCount=6,this._viewports=[new Hn(2,1,1,1),new Hn(0,1,1,1),new Hn(3,1,1,1),new Hn(1,1,1,1),new Hn(3,0,1,1),new Hn(1,0,1,1)],this._cubeDirections=[new $(1,0,0),new $(-1,0,0),new $(0,0,1),new $(0,0,-1),new $(0,1,0),new $(0,-1,0)],this._cubeUps=[new $(0,1,0),new $(0,1,0),new $(0,1,0),new $(0,1,0),new $(0,0,1),new $(0,0,-1)]}updateMatrices(e,n=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),$0.setFromMatrixPosition(e.matrixWorld),r.position.copy($0),KS.copy(r.position),KS.add(this._cubeDirections[n]),r.up.copy(this._cubeUps[n]),r.lookAt(KS),r.updateMatrixWorld(),i.makeTranslation(-$0.x,-$0.y,-$0.z),AI.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(AI)}}class Gm extends Af{constructor(e,n,r=0,i=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new jne}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let Hi=class extends Om{constructor(e=-1,n=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+n,l=i-n;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}};class Vne extends B6{constructor(){super(new Hi(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jm extends Af{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(yn.DEFAULT_UP),this.updateMatrix(),this.target=new yn,this.shadow=new Vne}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Wb extends Af{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class tH extends Af{constructor(e,n,r=10,i=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class nH{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new $)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*i),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*r),n.addScaledVector(o[4],1.092548*(r*i)),n.addScaledVector(o[5],1.092548*(i*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(r*s)),n.addScaledVector(o[8],.546274*(r*r-i*i)),n}getIrradianceAt(e,n){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*i),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*r),n.addScaledVector(o[4],2*.429043*r*i),n.addScaledVector(o[5],2*.429043*i*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*r*s),n.addScaledVector(o[8],.429043*(r*r-i*i)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,n+i*3);return this}toArray(e=[],n=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,n+i*3);return e}static getBasisAt(e,n){const r=e.x,i=e.y,s=e.z;n[0]=.282095,n[1]=.488603*i,n[2]=.488603*s,n[3]=.488603*r,n[4]=1.092548*r*i,n[5]=1.092548*i*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*r*s,n[8]=.546274*(r*r-i*i)}}class rH extends Af{constructor(e=new nH,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class $b extends Br{constructor(e){super(e),this.textures={}}load(e,n,r,i){const s=this,o=new qr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const n=this.textures;function r(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new wt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=r(o.value);break;case"c":i.uniforms[s].value=new wt().setHex(o.value);break;case"v2":i.uniforms[s].value=new Ke().fromArray(o.value);break;case"v3":i.uniforms[s].value=new $().fromArray(o.value);break;case"v4":i.uniforms[s].value=new Hn().fromArray(o.value);break;case"m3":i.uniforms[s].value=new Ln().fromArray(o.value);break;case"m4":i.uniforms[s].value=new et().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Ke().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Ke().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return $b.createMaterialFromType(e)}static createMaterialFromType(e){const n={ShadowMaterial:L6,SpriteMaterial:Ab,RawShaderMaterial:D6,ShaderMaterial:yr,PointsMaterial:Ha,MeshPhysicalMaterial:Ur,MeshStandardMaterial:Ka,MeshPhongMaterial:nu,MeshToonMaterial:$z,MeshNormalMaterial:Hb,MeshLambertMaterial:nh,MeshDepthMaterial:zm,MeshDistanceMaterial:Gb,MeshBasicMaterial:Fr,MeshMatcapMaterial:Xz,LineDashedMaterial:N6,LineBasicMaterial:oi,Material:Wr};return new n[e]}}class Ms{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class wy extends gn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class iH extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=new qr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const n={},r={};function i(h,p){if(n[p]!==void 0)return n[p];const g=h.interleavedBuffers[p],y=s(h,g.buffer),x=jp(g.type,y),_=new Um(x,g.stride);return _.uuid=g.uuid,n[p]=_,_}function s(h,p){if(r[p]!==void 0)return r[p];const g=h.arrayBuffers[p],y=new Uint32Array(g).buffer;return r[p]=y,y}const o=e.isInstancedBufferGeometry?new wy:new gn,a=e.data.index;if(a!==void 0){const h=jp(a.type,a.array);o.setIndex(new fn(h,1))}const l=e.data.attributes;for(const h in l){const p=l[h];let m;if(p.isInterleavedBufferAttribute){const g=i(e.data,p.data);m=new Ao(g,p.itemSize,p.offset,p.normalized)}else{const g=jp(p.type,p.array),y=p.isInstancedBufferAttribute?Ya:fn;m=new y(g,p.itemSize,p.normalized)}p.name!==void 0&&(m.name=p.name),p.usage!==void 0&&m.setUsage(p.usage),o.setAttribute(h,m)}const c=e.data.morphAttributes;if(c)for(const h in c){const p=c[h],m=[];for(let g=0,y=p.length;g<y;g++){const x=p[g];let _;if(x.isInterleavedBufferAttribute){const w=i(e.data,x.data);_=new Ao(w,x.itemSize,x.offset,x.normalized)}else{const w=jp(x.type,x.array);_=new fn(w,x.itemSize,x.normalized)}x.name!==void 0&&(_.name=x.name),m.push(_)}o.morphAttributes[h]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let h=0,p=f.length;h!==p;++h){const m=f[h];o.addGroup(m.start,m.count,m.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const h=new $;d.center!==void 0&&h.fromArray(d.center),o.boundingSphere=new wr(h,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Wne extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=this.path===""?Ms.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new qr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,n)},r,i)}async loadAsync(e,n){const r=this,i=this.path===""?Ms.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new qr(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,n),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,n){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){n!==void 0&&n(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,r),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),n!==void 0){let f=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){f=!0;break}f===!1&&n(c)}return c}async parseAsync(e){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,n),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const n={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new tc().fromJSON(e[r]);n[s.uuid]=s}return n}parseSkeletons(e,n){const r={},i={};if(n.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new wf().fromJSON(e[s],i);r[a.uuid]=a}return r}parseGeometries(e,n){const r={};if(e!==void 0){const i=new iH;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in wI?a=wI[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),r[l.uuid]=a}}return r}parseMaterials(e,n){const r={},i={};if(e!==void 0){const s=new $b;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){const l=e[o];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const n={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=Qa.parse(i);n[s.uuid]=s}return n}parseImages(e,n){const r=this,i={};let s;function o(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return o(u)}else return l.data?{data:jp(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new jb(n);s=new $1(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const f=e[c],d=f.url;if(Array.isArray(d)){const h=[];for(let p=0,m=d.length;p<m;p++){const g=d[p],y=a(g);y!==null&&(y instanceof HTMLImageElement?h.push(y):h.push(new As(y.data,y.width,y.height)))}i[f.uuid]=new yd(h)}else{const h=a(f.url);i[f.uuid]=new yd(h)}}}return i}async parseImagesAsync(e){const n=this,r={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:n.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:jp(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new $1(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let f=0,d=c.length;f<d;f++){const h=c[f],p=await s(h);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new As(p.data,p.width,p.height)))}r[l.uuid]=new yd(u)}else{const u=await s(l.url);r[l.uuid]=new yd(u)}}}return r}parseTextures(e,n){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=n[a.image],c=l.data;let u;Array.isArray(c)?(u=new my,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new As:u=new tr,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=r(a.mapping,$ne)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=r(a.wrap[0],MI),u.wrapT=r(a.wrap[1],MI)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.minFilter!==void 0&&(u.minFilter=r(a.minFilter,CI)),a.magFilter!==void 0&&(u.magFilter=r(a.magFilter,CI)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),i[a.uuid]=u}return i}parseObject(e,n,r,i,s){let o;function a(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),n[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const h=[];for(let p=0,m=d.length;p<m;p++){const g=d[p];r[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),h.push(r[g])}return h}return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),r[d]}}function c(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),i[d]}let u,f;switch(e.type){case"Scene":o=new ls,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new wt(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Tb(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Sb(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Ar(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Hi(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Wb(e.color,e.intensity);break;case"DirectionalLight":o=new jm(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Gm(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new tH(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Hm(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new eH(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new rH().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),f=l(e.material),o=new Qd(u,f),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),f=l(e.material),o=new ln(u,f);break;case"InstancedMesh":u=a(e.geometry),f=l(e.material);const d=e.count,h=e.instanceMatrix,p=e.instanceColor;o=new eh(u,f,d),o.instanceMatrix=new Ya(new Float32Array(h.array),16),p!==void 0&&(o.instanceColor=new Ya(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=a(e.geometry),f=l(e.material),o=new Mb(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,f),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(m=>{const g=new Kn;g.min.fromArray(m.boxMin),g.max.fromArray(m.boxMax);const y=new wr;return y.radius=m.sphereRadius,y.center.fromArray(m.sphereCenter),{boxInitialized:m.boxInitialized,box:g,sphereInitialized:m.sphereInitialized,sphere:y}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=c(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=c(e.colorsTexture.uuid));break;case"LOD":o=new Bz;break;case"Line":o=new $o(a(e.geometry),l(e.material));break;case"LineLoop":o=new Cb(a(e.geometry),l(e.material));break;case"LineSegments":o=new so(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new Zc(a(e.geometry),l(e.material));break;case"Sprite":o=new Uz(l(e.material));break;case"Group":o=new es;break;case"Bone":o=new Jd;break;default:o=new yn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let h=0;h<d.length;h++)o.add(this.parseObject(d[h],n,r,i,s))}if(e.animations!==void 0){const d=e.animations;for(let h=0;h<d.length;h++){const p=d[h];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let h=0;h<d.length;h++){const p=d[h],m=o.getObjectByProperty("uuid",p.object);m!==void 0&&o.addLevel(m,p.distance,p.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=n[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const r=n.target,i=e.getObjectByProperty("uuid",r);i!==void 0?n.target=i:n.target=new yn}})}}const $ne={UVMapping:uf,CubeReflectionMapping:sc,CubeRefractionMapping:ff,EquirectangularReflectionMapping:pm,EquirectangularRefractionMapping:F1,CubeUVReflectionMapping:Lm},MI={RepeatWrapping:Or,ClampToEdgeWrapping:ei,MirroredRepeatWrapping:Bd},CI={NearestFilter:zn,NearestMipmapNearestFilter:dy,NearestMipmapLinearFilter:Zu,LinearFilter:Pn,LinearMipmapNearestFilter:Td,LinearMipmapLinearFilter:Ts};class z6 extends Br{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=qc.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{n&&n(c),s.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return qc.add(e,c),n&&n(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),qc.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});qc.add(e,l),s.manager.itemStart(e)}}let w2;class H6{static getContext(){return w2===void 0&&(w2=new(window.AudioContext||window.webkitAudioContext)),w2}static setContext(e){w2=e}}class sH extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=new qr(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);H6.getContext().decodeAudioData(c,function(f){n(f)}).catch(a)}catch(c){a(c)}},r,i);function a(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const RI=new et,II=new et,Kf=new et;class Xne{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ar,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ar,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Kf.copy(e.projectionMatrix);const i=n.eyeSep/2,s=i*n.near/n.focus,o=n.near*Math.tan(Ad*n.fov*.5)/n.zoom;let a,l;II.elements[12]=-i,RI.elements[12]=i,a=-o*n.aspect+s,l=o*n.aspect+s,Kf.elements[0]=2*n.near/(l-a),Kf.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Kf),a=-o*n.aspect-s,l=o*n.aspect-s,Kf.elements[0]=2*n.near/(l-a),Kf.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Kf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(II),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(RI)}}class oH extends Ar{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Xb{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=PI(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=PI();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function PI(){return performance.now()}const Zf=new $,kI=new bn,qne=new $,Qf=new $;class aH extends yn{constructor(){super(),this.type="AudioListener",this.context=H6.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Xb}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Zf,kI,qne),Qf.set(0,0,-1).applyQuaternion(kI),n.positionX){const i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Zf.x,i),n.positionY.linearRampToValueAtTime(Zf.y,i),n.positionZ.linearRampToValueAtTime(Zf.z,i),n.forwardX.linearRampToValueAtTime(Qf.x,i),n.forwardY.linearRampToValueAtTime(Qf.y,i),n.forwardZ.linearRampToValueAtTime(Qf.z,i),n.upX.linearRampToValueAtTime(r.x,i),n.upY.linearRampToValueAtTime(r.y,i),n.upZ.linearRampToValueAtTime(r.z,i)}else n.setPosition(Zf.x,Zf.y,Zf.z),n.setOrientation(Qf.x,Qf.y,Qf.z,r.x,r.y,r.z)}}class lH extends yn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Jf=new $,LI=new bn,Yne=new $,ed=new $;let Kne=class extends lH{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Jf,LI,Yne),ed.set(0,0,1).applyQuaternion(LI);const n=this.panner;if(n.positionX){const r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Jf.x,r),n.positionY.linearRampToValueAtTime(Jf.y,r),n.positionZ.linearRampToValueAtTime(Jf.z,r),n.orientationX.linearRampToValueAtTime(ed.x,r),n.orientationY.linearRampToValueAtTime(ed.y,r),n.orientationZ.linearRampToValueAtTime(ed.z,r)}else n.setPosition(Jf.x,Jf.y,Jf.z),n.setOrientation(ed.x,ed.y,ed.z)}};class Zne{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let r=0;r<n.length;r++)e+=n[r];return e/n.length}}class cH{constructor(e,n,r){this.binding=e,this.valueSize=r;let i,s,o;switch(n){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=n}else{o+=n;const a=n/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const n=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,r=this.buffer,i=e*n+n,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(r,i,l,1-s,n)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*n,1,n);for(let l=n,c=n+n;l!==c;++l)if(r[l]!==r[l+n]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,n=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(n,i);for(let s=r,o=i;s!==o;++s)n[s]=n[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let r=e;r<n;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[n+r]=this.buffer[e+r]}_select(e,n,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[n+o]=e[r+o]}_slerp(e,n,r,i){bn.slerpFlat(e,n,e,n,e,r,i)}_slerpAdditive(e,n,r,i,s){const o=this._workIndex*s;bn.multiplyQuaternionsFlat(e,o,e,n,e,r),bn.slerpFlat(e,n,e,n,e,o,i)}_lerp(e,n,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=n+a;e[l]=e[l]*o+e[r+a]*i}}_lerpAdditive(e,n,r,i,s){for(let o=0;o!==s;++o){const a=n+o;e[a]=e[a]+e[r+o]*i}}}const G6="\\[\\]\\.:\\/",Qne=new RegExp("["+G6+"]","g"),j6="[^"+G6+"]",Jne="[^"+G6.replace("\\.","")+"]",ere=/((?:WC+[\/:])*)/.source.replace("WC",j6),tre=/(WCOD+)?/.source.replace("WCOD",Jne),nre=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",j6),rre=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",j6),ire=new RegExp("^"+ere+tre+nre+rre+"$"),sre=["material","materials","bones","map"];class ore{constructor(e,n,r){const i=r||dr.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,i)}getValue(e,n){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,n)}setValue(e,n){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].unbind()}}class dr{constructor(e,n,r){this.path=n,this.parsedPath=r||dr.parseTrackName(n),this.node=dr.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,r){return e&&e.isAnimationObjectGroup?new dr.Composite(e,n,r):new dr(e,n,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Qne,"")}static parseTrackName(e){const n=ire.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);sre.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(n);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===n||a.uuid===n)return a;const l=r(a.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[n++]=r[i]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,r=n.objectName,i=n.propertyName;let s=n.propertyIndex;if(e||(e=dr.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=n.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[i];if(o===void 0){const c=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}dr.Composite=ore;dr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};dr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};dr.prototype.GetterByBindingType=[dr.prototype._getValue_direct,dr.prototype._getValue_array,dr.prototype._getValue_arrayElement,dr.prototype._getValue_toArray];dr.prototype.SetterByBindingTypeAndVersioning=[[dr.prototype._setValue_direct,dr.prototype._setValue_direct_setNeedsUpdate,dr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[dr.prototype._setValue_array,dr.prototype._setValue_array_setNeedsUpdate,dr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[dr.prototype._setValue_arrayElement,dr.prototype._setValue_arrayElement_setNeedsUpdate,dr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[dr.prototype._setValue_fromArray,dr.prototype._setValue_fromArray_setNeedsUpdate,dr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class are{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ha(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const d=arguments[u],h=d.uuid;let p=n[h];if(p===void 0){p=l++,n[h]=p,e.push(d);for(let m=0,g=o;m!==g;++m)s[m].push(new dr(d,r[m],i[m]))}else if(p<c){a=e[p];const m=--c,g=e[m];n[g.uuid]=p,e[p]=g,n[h]=m,e[m]=d;for(let y=0,x=o;y!==x;++y){const _=s[y],w=_[m];let T=_[p];_[p]=w,T===void 0&&(T=new dr(d,r[y],i[y])),_[m]=T}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,n=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=n[c];if(u!==void 0&&u>=s){const f=s++,d=e[f];n[d.uuid]=u,e[u]=d,n[c]=f,e[f]=l;for(let h=0,p=i;h!==p;++h){const m=r[h],g=m[f],y=m[u];m[u]=g,m[f]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,f=n[u];if(f!==void 0)if(delete n[u],f<s){const d=--s,h=e[d],p=--o,m=e[p];n[h.uuid]=f,e[f]=h,n[m.uuid]=d,e[d]=m,e.pop();for(let g=0,y=i;g!==y;++g){const x=r[g],_=x[d],w=x[p];x[f]=_,x[d]=w,x.pop()}}else{const d=--o,h=e[d];d>0&&(n[h.uuid]=f),e[f]=h,e.pop();for(let p=0,m=i;p!==m;++p){const g=r[p];g[f]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,f=new Array(c);i=s.length,r[e]=i,o.push(e),a.push(n),s.push(f);for(let d=u,h=l.length;d!==h;++d){const p=l[d];f[d]=new dr(p,e,n)}return f}unsubscribe_(e){const n=this._bindingsIndicesByPath,r=n[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];n[c]=r,o[r]=l,o.pop(),s[r]=s[a],s.pop(),i[r]=i[a],i.pop()}}}class uH{constructor(e,n,r=null,i=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=r,this.blendMode=i;const s=n.tracks,o=s.length,a=new Array(o),l={endingStart:md,endingEnd:md};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=vz,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,r){if(e.fadeOut(n),this.fadeIn(n),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,r){return e.crossFadeFrom(this,n,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+r,c[0]=e/o,c[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?n=0:(this._startTime=null,n=r*l)}n*=this._updateTimeScale(e);const o=this._updateTime(n),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case p6:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case bb:default:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(o),c[u].accumulate(i,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];n*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];n*=i,e>r.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===xz;if(e===0)return s===-1?i:o&&(s&1)===1?n-i:i;if(r===yz){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=n)i=n;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=n||i<0){const a=Math.floor(i/n);i-=n*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?n:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return n-i}return i}_setEndings(e,n,r){const i=this._interpolantSettings;r?(i.endingStart=gd,i.endingEnd=gd):(e?i.endingStart=this.zeroSlopeAtStart?gd:md:i.endingStart=U1,n?i.endingEnd=this.zeroSlopeAtEnd?gd:md:i.endingEnd=U1)}_scheduleFading(e,n,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=n,a[1]=s+e,l[1]=r,this}}const lre=new Float32Array(1);class fH extends uc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=r.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let f=0;f!==s;++f){const d=i[f],h=d.name;let p=u[h];if(p!==void 0)++p.referenceCount,o[f]=p;else{if(p=o[f],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,h));continue}const m=n&&n._propertyBindings[f].binding.parsedPath;p=new cH(dr.create(r,h,m),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,h),o[f]=p}a[f].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const n=e._propertyBindings;for(let r=0,i=n.length;r!==i;++r){const s=n[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let r=0,i=n.length;r!==i;++r){const s=n[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,r){const i=this._actions,s=this._actionsByClip;let o=s[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const n=this._actions,r=n[n.length-1],i=e._cacheIndex;r._cacheIndex=i,n[i]=r,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const f=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete f[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let r=0,i=n.length;r!==i;++r){const s=n[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_takeBackAction(e){const n=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_addInactiveBinding(e,n,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[n];o===void 0&&(o={},i[n]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],l=n[n.length-1],c=e._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const n=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_takeBackBinding(e){const n=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let r=e[n];return r===void 0&&(r=new F6(new Float32Array(2),new Float32Array(2),1,lre),r.__cacheIndex=n,e[n]=r),r}_takeBackControlInterpolant(e){const n=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=n[i];e.__cacheIndex=i,n[i]=e,s.__cacheIndex=r,n[r]=s}clipAction(e,n,r){const i=n||this._root,s=i.uuid;let o=typeof e=="string"?Qa.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(r===void 0&&(o!==null?r=o.blendMode:r=bb),l!==void 0){const f=l.actionByRoot[s];if(f!==void 0&&f.blendMode===r)return f;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new uH(this,o,n,r);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,n){const r=n||this._root,i=r.uuid,s=typeof e=="string"?Qa.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let r=n-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const n=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==r;++c)n[c]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,f=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,f._cacheIndex=u,n[u]=f,n.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}}uncacheRoot(e){const n=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,l=a[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[n];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,n){const r=this.existingAction(e,n);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class Js{constructor(e){this.value=e}clone(){return new Js(this.value.clone===void 0?this.value:this.value.clone())}}let cre=0;class ure extends uc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:cre++}),this.name="",this.usage=z1,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let r=0,i=n.length;r<i;r++){const s=Array.isArray(n[r])?n[r]:[n[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class f_ extends Um{constructor(e,n,r=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class fre{constructor(e,n,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const DI=new et;class oh{constructor(e,n,r=0,i=1/0){this.ray=new Yo(e,n),this.near=r,this.far=i,this.camera=null,this.layers=new Md,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return DI.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(DI),this}intersectObject(e,n=!0,r=[]){return JA(e,this,r,n),r.sort(NI),r}intersectObjects(e,n=!0,r=[]){for(let i=0,s=e.length;i<s;i++)JA(e[i],this,r,n);return r.sort(NI),r}}function NI(t,e){return t.distance-e.distance}function JA(t,e,n,r){let i=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(i=!1),i===!0&&r===!0){const s=t.children;for(let o=0,a=s.length;o<a;o++)JA(s[o],e,n,!0)}}class d_{constructor(e=1,n=0,r=0){return this.radius=e,this.phi=n,this.theta=r,this}set(e,n,r){return this.radius=e,this.phi=n,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Wn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+n*n+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Wn(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class dre{constructor(e=1,n=0,r=0){return this.radius=e,this.theta=n,this.y=r,this}set(e,n,r){return this.radius=e,this.theta=n,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=n,this}clone(){return new this.constructor().copy(this)}}class V6{constructor(e,n,r,i){V6.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,r,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let r=0;r<4;r++)this.elements[r]=e[r+n];return this}set(e,n,r,i){const s=this.elements;return s[0]=e,s[2]=n,s[1]=r,s[3]=i,this}}const OI=new Ke;class W6{constructor(e=new Ke(1/0,1/0),n=new Ke(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=OI.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,OI).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const FI=new $,S2=new $;class qa{constructor(e=new $,n=new $){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){FI.subVectors(e,this.start),S2.subVectors(this.end,this.start);const r=S2.dot(S2);let s=S2.dot(FI)/r;return n&&(s=Wn(s,0,1)),s}closestPointToPoint(e,n,r){const i=this.closestPointToPointParameter(e,n);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const UI=new $;class dH extends yn{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const r=new gn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}r.setAttribute("position",new Dt(i,3));const s=new oi({fog:!1,toneMapped:!1});this.cone=new so(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),UI.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(UI),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Du=new $,T2=new et,ZS=new et;class hH extends so{constructor(e){const n=pH(e),r=new gn,i=[],s=[],o=new wt(0,0,1),a=new wt(0,1,0);for(let c=0;c<n.length;c++){const u=n[c];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new Dt(i,3)),r.setAttribute("color",new Dt(s,3));const l=new oi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,r=this.geometry,i=r.getAttribute("position");ZS.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<n.length;s++){const a=n[s];a.parent&&a.parent.isBone&&(T2.multiplyMatrices(ZS,a.matrixWorld),Du.setFromMatrixPosition(T2),i.setXYZ(o,Du.x,Du.y,Du.z),T2.multiplyMatrices(ZS,a.parent.matrixWorld),Du.setFromMatrixPosition(T2),i.setXYZ(o+1,Du.x,Du.y,Du.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function pH(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,pH(t.children[n]));return e}class mH extends ln{constructor(e,n,r){const i=new Tf(n,4,2),s=new Fr({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const hre=new $,BI=new wt,zI=new wt;class gH extends yn{constructor(e,n,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new _y(n);i.rotateY(Math.PI*.5),this.material=new Fr({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new fn(o,3)),this.add(new ln(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");BI.copy(this.light.color),zI.copy(this.light.groundColor);for(let r=0,i=n.count;r<i;r++){const s=r<i/2?BI:zI;n.setXYZ(r,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(hre.setFromMatrixPosition(this.light.matrixWorld).negate())}}class pre extends so{constructor(e=10,n=10,r=4473924,i=8947848){r=new wt(r),i=new wt(i);const s=n/2,o=e/n,a=e/2,l=[],c=[];for(let d=0,h=0,p=-a;d<=n;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const m=d===s?r:i;m.toArray(c,h),h+=3,m.toArray(c,h),h+=3,m.toArray(c,h),h+=3,m.toArray(c,h),h+=3}const u=new gn;u.setAttribute("position",new Dt(l,3)),u.setAttribute("color",new Dt(c,3));const f=new oi({vertexColors:!0,toneMapped:!1});super(u,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class mre extends so{constructor(e=10,n=16,r=8,i=64,s=4473924,o=8947848){s=new wt(s),o=new wt(o);const a=[],l=[];if(n>1)for(let f=0;f<n;f++){const d=f/n*(Math.PI*2),h=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(h,0,p);const m=f&1?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let f=0;f<r;f++){const d=f&1?s:o,h=e-e/r*f;for(let p=0;p<i;p++){let m=p/i*(Math.PI*2),g=Math.sin(m)*h,y=Math.cos(m)*h;a.push(g,0,y),l.push(d.r,d.g,d.b),m=(p+1)/i*(Math.PI*2),g=Math.sin(m)*h,y=Math.cos(m)*h,a.push(g,0,y),l.push(d.r,d.g,d.b)}}const c=new gn;c.setAttribute("position",new Dt(a,3)),c.setAttribute("color",new Dt(l,3));const u=new oi({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const HI=new $,A2=new $,GI=new $;class yH extends yn{constructor(e,n,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",n===void 0&&(n=1);let i=new gn;i.setAttribute("position",new Dt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new oi({fog:!1,toneMapped:!1});this.lightPlane=new $o(i,s),this.add(this.lightPlane),i=new gn,i.setAttribute("position",new Dt([0,0,0,0,0,1],3)),this.targetLine=new $o(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),HI.setFromMatrixPosition(this.light.matrixWorld),A2.setFromMatrixPosition(this.light.target.matrixWorld),GI.subVectors(A2,HI),this.lightPlane.lookAt(A2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(A2),this.targetLine.scale.z=GI.length()}}const M2=new $,Ai=new Om;class $6 extends so{constructor(e){const n=new gn,r=new oi({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,m){l(p),l(m)}function l(p){i.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(i.length/3-1)}n.setAttribute("position",new Dt(i,3)),n.setAttribute("color",new Dt(s,3)),super(n,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new wt(16755200),u=new wt(16711680),f=new wt(43775),d=new wt(16777215),h=new wt(3355443);this.setColors(c,u,f,d,h)}setColors(e,n,r,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,n.r,n.g,n.b),a.setXYZ(25,n.r,n.g,n.b),a.setXYZ(26,n.r,n.g,n.b),a.setXYZ(27,n.r,n.g,n.b),a.setXYZ(28,n.r,n.g,n.b),a.setXYZ(29,n.r,n.g,n.b),a.setXYZ(30,n.r,n.g,n.b),a.setXYZ(31,n.r,n.g,n.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,r=1,i=1;Ai.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Di("c",n,e,Ai,0,0,-1),Di("t",n,e,Ai,0,0,1),Di("n1",n,e,Ai,-r,-i,-1),Di("n2",n,e,Ai,r,-i,-1),Di("n3",n,e,Ai,-r,i,-1),Di("n4",n,e,Ai,r,i,-1),Di("f1",n,e,Ai,-r,-i,1),Di("f2",n,e,Ai,r,-i,1),Di("f3",n,e,Ai,-r,i,1),Di("f4",n,e,Ai,r,i,1),Di("u1",n,e,Ai,r*.7,i*1.1,-1),Di("u2",n,e,Ai,-r*.7,i*1.1,-1),Di("u3",n,e,Ai,0,i*2,-1),Di("cf1",n,e,Ai,-r,0,1),Di("cf2",n,e,Ai,r,0,1),Di("cf3",n,e,Ai,0,-i,1),Di("cf4",n,e,Ai,0,i,1),Di("cn1",n,e,Ai,-r,0,-1),Di("cn2",n,e,Ai,r,0,-1),Di("cn3",n,e,Ai,0,-i,-1),Di("cn4",n,e,Ai,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Di(t,e,n,r,i,s,o){M2.set(i,s,o).unproject(r);const a=e[t];if(a!==void 0){const l=n.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],M2.x,M2.y,M2.z)}}const C2=new Kn;class gre extends so{constructor(e,n=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new gn;s.setIndex(new fn(r,1)),s.setAttribute("position",new fn(i,3)),super(s,new oi({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&C2.setFromObject(this.object),C2.isEmpty())return;const n=C2.min,r=C2.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=n.x,s[4]=r.y,s[5]=r.z,s[6]=n.x,s[7]=n.y,s[8]=r.z,s[9]=r.x,s[10]=n.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=n.z,s[15]=n.x,s[16]=r.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=r.x,s[22]=n.y,s[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class yre extends so{constructor(e,n=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new gn;s.setIndex(new fn(r,1)),s.setAttribute("position",new Dt(i,3)),super(s,new oi({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class vre extends $o{constructor(e,n=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new gn;o.setAttribute("position",new Dt(s,3)),o.computeBoundingSphere(),super(o,new oi({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new gn;l.setAttribute("position",new Dt(a,3)),l.computeBoundingSphere(),this.add(new ln(l,new Fr({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const jI=new $;let R2,QS;class xre extends yn{constructor(e=new $(0,0,1),n=new $(0,0,0),r=1,i=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",R2===void 0&&(R2=new gn,R2.setAttribute("position",new Dt([0,0,0,0,1,0],3)),QS=new hu(0,.5,1,5,1),QS.translate(0,-.5,0)),this.position.copy(n),this.line=new $o(R2,new oi({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ln(QS,new Fr({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{jI.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(jI,n)}}setLength(e,n=e*.2,r=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(r,n,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class _re extends so{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new gn;i.setAttribute("position",new Dt(n,3)),i.setAttribute("color",new Dt(r,3));const s=new oi({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,n,r){const i=new wt,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(n),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Dc{constructor(){this.type="ShapePath",this.color=new wt,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new of,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,r,i){return this.currentPath.quadraticCurveTo(e,n,r,i),this}bezierCurveTo(e,n,r,i,s,o){return this.currentPath.bezierCurveTo(e,n,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(y){const x=[];for(let _=0,w=y.length;_<w;_++){const T=y[_],S=new tc;S.curves=T.curves,x.push(S)}return x}function r(y,x){const _=x.length;let w=!1;for(let T=_-1,S=0;S<_;T=S++){let C=x[T],A=x[S],R=A.x-C.x,M=A.y-C.y;if(Math.abs(M)>Number.EPSILON){if(M<0&&(C=x[S],R=-R,A=x[T],M=-M),y.y<C.y||y.y>A.y)continue;if(y.y===C.y){if(y.x===C.x)return!0}else{const D=M*(y.x-C.x)-R*(y.y-C.y);if(D===0)return!0;if(D<0)continue;w=!w}}else{if(y.y!==C.y)continue;if(A.x<=y.x&&y.x<=C.x||C.x<=y.x&&y.x<=A.x)return!0}}return w}const i=vl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new tc,l.curves=a.curves,c.push(l),c;let u=!i(s[0].getPoints());u=e?!u:u;const f=[],d=[];let h=[],p=0,m;d[p]=void 0,h[p]=[];for(let y=0,x=s.length;y<x;y++)a=s[y],m=a.getPoints(),o=i(m),o=e?!o:o,o?(!u&&d[p]&&p++,d[p]={s:new tc,p:m},d[p].s.curves=a.curves,u&&p++,h[p]=[]):h[p].push({h:a,p:m[0]});if(!d[0])return n(s);if(d.length>1){let y=!1,x=0;for(let _=0,w=d.length;_<w;_++)f[_]=[];for(let _=0,w=d.length;_<w;_++){const T=h[_];for(let S=0;S<T.length;S++){const C=T[S];let A=!0;for(let R=0;R<d.length;R++)r(C.p,d[R].p)&&(_!==R&&x++,A?(A=!1,f[R].push(C)):y=!0);A&&f[_].push(C)}}x>0&&y===!1&&(h=f)}let g;for(let y=0,x=d.length;y<x;y++){l=d[y].s,c.push(l),g=h[y];for(let _=0,w=g.length;_<w;_++)l.holes.push(g[_].h)}return c}}class bre extends uc{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function Ere(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function wre(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function Sre(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function e5(t,e,n,r){const i=Tre(r);switch(n){case c6:return t*e;case f6:return t*e;case d6:return t*e*2;case Yc:return t*e/i.components*i.byteLength;case Dm:return t*e/i.components*i.byteLength;case _b:return t*e*2/i.components*i.byteLength;case Nm:return t*e*2/i.components*i.byteLength;case u6:return t*e*3/i.components*i.byteLength;case Pr:return t*e*4/i.components*i.byteLength;case hf:return t*e*4/i.components*i.byteLength;case o1:case a1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case l1:case c1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case O3:case U3:return Math.max(t,16)*Math.max(e,8)/4;case N3:case F3:return Math.max(t,8)*Math.max(e,8)/2;case B3:case z3:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case H3:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case G3:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case j3:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case V3:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case W3:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case $3:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case X3:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case q3:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case Y3:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case K3:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case Z3:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case Q3:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case J3:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case e_:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case t_:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case u1:case n_:case r_:return Math.ceil(t/4)*Math.ceil(e/4)*16;case h6:case i_:return Math.ceil(t/4)*Math.ceil(e/4)*8;case s_:case o_:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function Tre(t){switch(t){case Rs:case mm:return{byteLength:1,components:1};case df:case hy:case ti:return{byteLength:2,components:1};case vb:case xb:return{byteLength:2,components:4};case io:case rf:case pr:return{byteLength:4,components:1};case l6:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}const Are={contain:Ere,cover:wre,fill:Sre,getByteLength:e5};class Mre extends fr{constructor(e=1,n=1,r=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,n,{...i,count:r}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:wl}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=wl);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function vH(){let t=null,e=!1,n=null,r=null;function i(s,o){n(s,o),r=t.requestAnimationFrame(i)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function Cre(t){const e=new WeakMap;function n(a,l){const c=a.array,u=a.usage,f=c.byteLength,d=t.createBuffer();t.bindBuffer(l,d),t.bufferData(l,c,u),a.onUploadCallback();let h;if(c instanceof Float32Array)h=t.FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?h=t.HALF_FLOAT:h=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)h=t.SHORT;else if(c instanceof Uint32Array)h=t.UNSIGNED_INT;else if(c instanceof Int32Array)h=t.INT;else if(c instanceof Int8Array)h=t.BYTE;else if(c instanceof Uint8Array)h=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)h=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:d,type:h,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:f}}function r(a,l,c){const u=l.array,f=l.updateRanges;if(t.bindBuffer(c,a),f.length===0)t.bufferSubData(c,0,u);else{f.sort((h,p)=>h.start-p.start);let d=0;for(let h=1;h<f.length;h++){const p=f[d],m=f[h];m.start<=p.start+p.count+1?p.count=Math.max(p.count,m.start+m.count-p.start):(++d,f[d]=m)}f.length=d+1;for(let h=0,p=f.length;h<p;h++){const m=f[h];t.bufferSubData(c,m.start*u.BYTES_PER_ELEMENT,u,m.start,m.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(t.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const c=e.get(a);if(c===void 0)e.set(a,n(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(c.buffer,a,l),c.version=a.version}}return{get:i,remove:s,update:o}}var Rre=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Ire=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Pre=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,kre=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Lre=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Dre=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Nre=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Ore=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Fre=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Ure=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Bre=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zre=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Hre=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Gre=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,jre=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Vre=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Wre=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,$re=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Xre=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,qre=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Yre=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Kre=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Zre=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Qre=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Jre=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,eie=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,tie=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,nie=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,rie=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,iie=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,sie="gl_FragColor = linearToOutputTexel( gl_FragColor );",oie=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,aie=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,lie=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,cie=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,uie=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,fie=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,die=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,hie=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,pie=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,mie=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gie=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,yie=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,vie=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,xie=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,_ie=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,bie=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Eie=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,wie=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Sie=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Tie=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Aie=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Mie=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Cie=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Rie=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Iie=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Pie=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,kie=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Lie=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Die=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Nie=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Oie=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Fie=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Uie=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Bie=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,zie=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Hie=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Gie=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,jie=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Vie=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Wie=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,$ie=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Xie=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,qie=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Yie=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Kie=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Zie=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Qie=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Jie=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,ese=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,tse=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,nse=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,rse=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,ise=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,sse=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ose=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,ase=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,lse=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,cse=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,use=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,fse=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,dse=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,hse=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,pse=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,mse=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,gse=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,yse=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,vse=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,xse=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,_se=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,bse=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Ese=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,wse=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Sse=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Tse=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Ase=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Mse=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Cse=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Rse=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ise=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Pse=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,kse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Lse=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Dse=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Nse=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Ose=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Fse=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Use=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Bse=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zse=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Hse=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Gse=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,jse=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vse=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Wse=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$se=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Xse=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qse=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Yse=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Kse=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Zse=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qse=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Jse=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eoe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,toe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,noe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,roe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ioe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,soe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ooe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,aoe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Fn={alphahash_fragment:Rre,alphahash_pars_fragment:Ire,alphamap_fragment:Pre,alphamap_pars_fragment:kre,alphatest_fragment:Lre,alphatest_pars_fragment:Dre,aomap_fragment:Nre,aomap_pars_fragment:Ore,batching_pars_vertex:Fre,batching_vertex:Ure,begin_vertex:Bre,beginnormal_vertex:zre,bsdfs:Hre,iridescence_fragment:Gre,bumpmap_pars_fragment:jre,clipping_planes_fragment:Vre,clipping_planes_pars_fragment:Wre,clipping_planes_pars_vertex:$re,clipping_planes_vertex:Xre,color_fragment:qre,color_pars_fragment:Yre,color_pars_vertex:Kre,color_vertex:Zre,common:Qre,cube_uv_reflection_fragment:Jre,defaultnormal_vertex:eie,displacementmap_pars_vertex:tie,displacementmap_vertex:nie,emissivemap_fragment:rie,emissivemap_pars_fragment:iie,colorspace_fragment:sie,colorspace_pars_fragment:oie,envmap_fragment:aie,envmap_common_pars_fragment:lie,envmap_pars_fragment:cie,envmap_pars_vertex:uie,envmap_physical_pars_fragment:bie,envmap_vertex:fie,fog_vertex:die,fog_pars_vertex:hie,fog_fragment:pie,fog_pars_fragment:mie,gradientmap_pars_fragment:gie,lightmap_pars_fragment:yie,lights_lambert_fragment:vie,lights_lambert_pars_fragment:xie,lights_pars_begin:_ie,lights_toon_fragment:Eie,lights_toon_pars_fragment:wie,lights_phong_fragment:Sie,lights_phong_pars_fragment:Tie,lights_physical_fragment:Aie,lights_physical_pars_fragment:Mie,lights_fragment_begin:Cie,lights_fragment_maps:Rie,lights_fragment_end:Iie,logdepthbuf_fragment:Pie,logdepthbuf_pars_fragment:kie,logdepthbuf_pars_vertex:Lie,logdepthbuf_vertex:Die,map_fragment:Nie,map_pars_fragment:Oie,map_particle_fragment:Fie,map_particle_pars_fragment:Uie,metalnessmap_fragment:Bie,metalnessmap_pars_fragment:zie,morphinstance_vertex:Hie,morphcolor_vertex:Gie,morphnormal_vertex:jie,morphtarget_pars_vertex:Vie,morphtarget_vertex:Wie,normal_fragment_begin:$ie,normal_fragment_maps:Xie,normal_pars_fragment:qie,normal_pars_vertex:Yie,normal_vertex:Kie,normalmap_pars_fragment:Zie,clearcoat_normal_fragment_begin:Qie,clearcoat_normal_fragment_maps:Jie,clearcoat_pars_fragment:ese,iridescence_pars_fragment:tse,opaque_fragment:nse,packing:rse,premultiplied_alpha_fragment:ise,project_vertex:sse,dithering_fragment:ose,dithering_pars_fragment:ase,roughnessmap_fragment:lse,roughnessmap_pars_fragment:cse,shadowmap_pars_fragment:use,shadowmap_pars_vertex:fse,shadowmap_vertex:dse,shadowmask_pars_fragment:hse,skinbase_vertex:pse,skinning_pars_vertex:mse,skinning_vertex:gse,skinnormal_vertex:yse,specularmap_fragment:vse,specularmap_pars_fragment:xse,tonemapping_fragment:_se,tonemapping_pars_fragment:bse,transmission_fragment:Ese,transmission_pars_fragment:wse,uv_pars_fragment:Sse,uv_pars_vertex:Tse,uv_vertex:Ase,worldpos_vertex:Mse,background_vert:Cse,background_frag:Rse,backgroundCube_vert:Ise,backgroundCube_frag:Pse,cube_vert:kse,cube_frag:Lse,depth_vert:Dse,depth_frag:Nse,distanceRGBA_vert:Ose,distanceRGBA_frag:Fse,equirect_vert:Use,equirect_frag:Bse,linedashed_vert:zse,linedashed_frag:Hse,meshbasic_vert:Gse,meshbasic_frag:jse,meshlambert_vert:Vse,meshlambert_frag:Wse,meshmatcap_vert:$se,meshmatcap_frag:Xse,meshnormal_vert:qse,meshnormal_frag:Yse,meshphong_vert:Kse,meshphong_frag:Zse,meshphysical_vert:Qse,meshphysical_frag:Jse,meshtoon_vert:eoe,meshtoon_frag:toe,points_vert:noe,points_frag:roe,shadow_vert:ioe,shadow_frag:soe,sprite_vert:ooe,sprite_frag:aoe},Qt={common:{diffuse:{value:new wt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ln},alphaMap:{value:null},alphaMapTransform:{value:new Ln},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ln}},envmap:{envMap:{value:null},envMapRotation:{value:new Ln},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ln}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ln}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ln},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ln},normalScale:{value:new Ke(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ln},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ln}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ln}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ln}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new wt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ln},alphaTest:{value:0},uvTransform:{value:new Ln}},sprite:{diffuse:{value:new wt(16777215)},opacity:{value:1},center:{value:new Ke(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ln},alphaMap:{value:null},alphaMapTransform:{value:new Ln},alphaTest:{value:0}}},yl={basic:{uniforms:bo([Qt.common,Qt.specularmap,Qt.envmap,Qt.aomap,Qt.lightmap,Qt.fog]),vertexShader:Fn.meshbasic_vert,fragmentShader:Fn.meshbasic_frag},lambert:{uniforms:bo([Qt.common,Qt.specularmap,Qt.envmap,Qt.aomap,Qt.lightmap,Qt.emissivemap,Qt.bumpmap,Qt.normalmap,Qt.displacementmap,Qt.fog,Qt.lights,{emissive:{value:new wt(0)}}]),vertexShader:Fn.meshlambert_vert,fragmentShader:Fn.meshlambert_frag},phong:{uniforms:bo([Qt.common,Qt.specularmap,Qt.envmap,Qt.aomap,Qt.lightmap,Qt.emissivemap,Qt.bumpmap,Qt.normalmap,Qt.displacementmap,Qt.fog,Qt.lights,{emissive:{value:new wt(0)},specular:{value:new wt(1118481)},shininess:{value:30}}]),vertexShader:Fn.meshphong_vert,fragmentShader:Fn.meshphong_frag},standard:{uniforms:bo([Qt.common,Qt.envmap,Qt.aomap,Qt.lightmap,Qt.emissivemap,Qt.bumpmap,Qt.normalmap,Qt.displacementmap,Qt.roughnessmap,Qt.metalnessmap,Qt.fog,Qt.lights,{emissive:{value:new wt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Fn.meshphysical_vert,fragmentShader:Fn.meshphysical_frag},toon:{uniforms:bo([Qt.common,Qt.aomap,Qt.lightmap,Qt.emissivemap,Qt.bumpmap,Qt.normalmap,Qt.displacementmap,Qt.gradientmap,Qt.fog,Qt.lights,{emissive:{value:new wt(0)}}]),vertexShader:Fn.meshtoon_vert,fragmentShader:Fn.meshtoon_frag},matcap:{uniforms:bo([Qt.common,Qt.bumpmap,Qt.normalmap,Qt.displacementmap,Qt.fog,{matcap:{value:null}}]),vertexShader:Fn.meshmatcap_vert,fragmentShader:Fn.meshmatcap_frag},points:{uniforms:bo([Qt.points,Qt.fog]),vertexShader:Fn.points_vert,fragmentShader:Fn.points_frag},dashed:{uniforms:bo([Qt.common,Qt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fn.linedashed_vert,fragmentShader:Fn.linedashed_frag},depth:{uniforms:bo([Qt.common,Qt.displacementmap]),vertexShader:Fn.depth_vert,fragmentShader:Fn.depth_frag},normal:{uniforms:bo([Qt.common,Qt.bumpmap,Qt.normalmap,Qt.displacementmap,{opacity:{value:1}}]),vertexShader:Fn.meshnormal_vert,fragmentShader:Fn.meshnormal_frag},sprite:{uniforms:bo([Qt.sprite,Qt.fog]),vertexShader:Fn.sprite_vert,fragmentShader:Fn.sprite_frag},background:{uniforms:{uvTransform:{value:new Ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Fn.background_vert,fragmentShader:Fn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ln}},vertexShader:Fn.backgroundCube_vert,fragmentShader:Fn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Fn.cube_vert,fragmentShader:Fn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Fn.equirect_vert,fragmentShader:Fn.equirect_frag},distanceRGBA:{uniforms:bo([Qt.common,Qt.displacementmap,{referencePosition:{value:new $},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Fn.distanceRGBA_vert,fragmentShader:Fn.distanceRGBA_frag},shadow:{uniforms:bo([Qt.lights,Qt.fog,{color:{value:new wt(0)},opacity:{value:1}}]),vertexShader:Fn.shadow_vert,fragmentShader:Fn.shadow_frag}};yl.physical={uniforms:bo([yl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ln},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ln},clearcoatNormalScale:{value:new Ke(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ln},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ln},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ln},sheen:{value:0},sheenColor:{value:new wt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ln},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ln},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ln},transmissionSamplerSize:{value:new Ke},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ln},attenuationDistance:{value:0},attenuationColor:{value:new wt(0)},specularColor:{value:new wt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ln},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ln},anisotropyVector:{value:new Ke},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ln}}]),vertexShader:Fn.meshphysical_vert,fragmentShader:Fn.meshphysical_frag};const I2={r:0,b:0,g:0},td=new xr,loe=new et;function coe(t,e,n,r,i,s,o){const a=new wt(0);let l=s===!0?0:1,c,u,f=null,d=0,h=null;function p(_){let w=_.isScene===!0?_.background:null;return w&&w.isTexture&&(w=(_.backgroundBlurriness>0?n:e).get(w)),w}function m(_){let w=!1;const T=p(_);T===null?y(a,l):T&&T.isColor&&(y(T,1),w=!0);const S=t.xr.getEnvironmentBlendMode();S==="additive"?r.buffers.color.setClear(0,0,0,1,o):S==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(t.autoClear||w)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function g(_,w){const T=p(w);T&&(T.isCubeTexture||T.mapping===Lm)?(u===void 0&&(u=new ln(new fc(1,1,1),new yr({name:"BackgroundCubeMaterial",uniforms:ym(yl.backgroundCube.uniforms),vertexShader:yl.backgroundCube.vertexShader,fragmentShader:yl.backgroundCube.fragmentShader,side:zi,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(S,C,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),td.copy(w.backgroundRotation),td.x*=-1,td.y*=-1,td.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(td.y*=-1,td.z*=-1),u.material.uniforms.envMap.value=T,u.material.uniforms.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(loe.makeRotationFromEuler(td)),u.material.toneMapped=er.getTransfer(T.colorSpace)!==Dr,(f!==T||d!==T.version||h!==t.toneMapping)&&(u.material.needsUpdate=!0,f=T,d=T.version,h=t.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):T&&T.isTexture&&(c===void 0&&(c=new ln(new Ps(2,2),new yr({name:"BackgroundMaterial",uniforms:ym(yl.background.uniforms),vertexShader:yl.background.vertexShader,fragmentShader:yl.background.fragmentShader,side:Cs,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=T,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=er.getTransfer(T.colorSpace)!==Dr,T.matrixAutoUpdate===!0&&T.updateMatrix(),c.material.uniforms.uvTransform.value.copy(T.matrix),(f!==T||d!==T.version||h!==t.toneMapping)&&(c.material.needsUpdate=!0,f=T,d=T.version,h=t.toneMapping),c.layers.enableAll(),_.unshift(c,c.geometry,c.material,0,0,null))}function y(_,w){_.getRGB(I2,Oz(t)),r.buffers.color.setClear(I2.r,I2.g,I2.b,w,o)}function x(){u!==void 0&&(u.geometry.dispose(),u.material.dispose()),c!==void 0&&(c.geometry.dispose(),c.material.dispose())}return{getClearColor:function(){return a},setClearColor:function(_,w=1){a.set(_),l=w,y(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(_){l=_,y(a,l)},render:m,addToRenderList:g,dispose:x}}function uoe(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r={},i=d(null);let s=i,o=!1;function a(M,D,k,L,N){let z=!1;const O=f(L,k,D);s!==O&&(s=O,c(s.object)),z=h(M,L,k,N),z&&p(M,L,k,N),N!==null&&e.update(N,t.ELEMENT_ARRAY_BUFFER),(z||o)&&(o=!1,w(M,D,k,L),N!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(N).buffer))}function l(){return t.createVertexArray()}function c(M){return t.bindVertexArray(M)}function u(M){return t.deleteVertexArray(M)}function f(M,D,k){const L=k.wireframe===!0;let N=r[M.id];N===void 0&&(N={},r[M.id]=N);let z=N[D.id];z===void 0&&(z={},N[D.id]=z);let O=z[L];return O===void 0&&(O=d(l()),z[L]=O),O}function d(M){const D=[],k=[],L=[];for(let N=0;N<n;N++)D[N]=0,k[N]=0,L[N]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:D,enabledAttributes:k,attributeDivisors:L,object:M,attributes:{},index:null}}function h(M,D,k,L){const N=s.attributes,z=D.attributes;let O=0;const K=k.getAttributes();for(const V in K)if(K[V].location>=0){const re=N[V];let P=z[V];if(P===void 0&&(V==="instanceMatrix"&&M.instanceMatrix&&(P=M.instanceMatrix),V==="instanceColor"&&M.instanceColor&&(P=M.instanceColor)),re===void 0||re.attribute!==P||P&&re.data!==P.data)return!0;O++}return s.attributesNum!==O||s.index!==L}function p(M,D,k,L){const N={},z=D.attributes;let O=0;const K=k.getAttributes();for(const V in K)if(K[V].location>=0){let re=z[V];re===void 0&&(V==="instanceMatrix"&&M.instanceMatrix&&(re=M.instanceMatrix),V==="instanceColor"&&M.instanceColor&&(re=M.instanceColor));const P={};P.attribute=re,re&&re.data&&(P.data=re.data),N[V]=P,O++}s.attributes=N,s.attributesNum=O,s.index=L}function m(){const M=s.newAttributes;for(let D=0,k=M.length;D<k;D++)M[D]=0}function g(M){y(M,0)}function y(M,D){const k=s.newAttributes,L=s.enabledAttributes,N=s.attributeDivisors;k[M]=1,L[M]===0&&(t.enableVertexAttribArray(M),L[M]=1),N[M]!==D&&(t.vertexAttribDivisor(M,D),N[M]=D)}function x(){const M=s.newAttributes,D=s.enabledAttributes;for(let k=0,L=D.length;k<L;k++)D[k]!==M[k]&&(t.disableVertexAttribArray(k),D[k]=0)}function _(M,D,k,L,N,z,O){O===!0?t.vertexAttribIPointer(M,D,k,N,z):t.vertexAttribPointer(M,D,k,L,N,z)}function w(M,D,k,L){m();const N=L.attributes,z=k.getAttributes(),O=D.defaultAttributeValues;for(const K in z){const V=z[K];if(V.location>=0){let ne=N[K];if(ne===void 0&&(K==="instanceMatrix"&&M.instanceMatrix&&(ne=M.instanceMatrix),K==="instanceColor"&&M.instanceColor&&(ne=M.instanceColor)),ne!==void 0){const re=ne.normalized,P=ne.itemSize,se=e.get(ne);if(se===void 0)continue;const ue=se.buffer,te=se.type,W=se.bytesPerElement,X=te===t.INT||te===t.UNSIGNED_INT||ne.gpuType===rf;if(ne.isInterleavedBufferAttribute){const J=ne.data,oe=J.stride,Ee=ne.offset;if(J.isInstancedInterleavedBuffer){for(let me=0;me<V.locationSize;me++)y(V.location+me,J.meshPerAttribute);M.isInstancedMesh!==!0&&L._maxInstanceCount===void 0&&(L._maxInstanceCount=J.meshPerAttribute*J.count)}else for(let me=0;me<V.locationSize;me++)g(V.location+me);t.bindBuffer(t.ARRAY_BUFFER,ue);for(let me=0;me<V.locationSize;me++)_(V.location+me,P/V.locationSize,te,re,oe*W,(Ee+P/V.locationSize*me)*W,X)}else{if(ne.isInstancedBufferAttribute){for(let J=0;J<V.locationSize;J++)y(V.location+J,ne.meshPerAttribute);M.isInstancedMesh!==!0&&L._maxInstanceCount===void 0&&(L._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let J=0;J<V.locationSize;J++)g(V.location+J);t.bindBuffer(t.ARRAY_BUFFER,ue);for(let J=0;J<V.locationSize;J++)_(V.location+J,P/V.locationSize,te,re,P*W,P/V.locationSize*J*W,X)}}else if(O!==void 0){const re=O[K];if(re!==void 0)switch(re.length){case 2:t.vertexAttrib2fv(V.location,re);break;case 3:t.vertexAttrib3fv(V.location,re);break;case 4:t.vertexAttrib4fv(V.location,re);break;default:t.vertexAttrib1fv(V.location,re)}}}}x()}function T(){A();for(const M in r){const D=r[M];for(const k in D){const L=D[k];for(const N in L)u(L[N].object),delete L[N];delete D[k]}delete r[M]}}function S(M){if(r[M.id]===void 0)return;const D=r[M.id];for(const k in D){const L=D[k];for(const N in L)u(L[N].object),delete L[N];delete D[k]}delete r[M.id]}function C(M){for(const D in r){const k=r[D];if(k[M.id]===void 0)continue;const L=k[M.id];for(const N in L)u(L[N].object),delete L[N];delete k[M.id]}}function A(){R(),o=!0,s!==i&&(s=i,c(s.object))}function R(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:a,reset:A,resetDefaultState:R,dispose:T,releaseStatesOfGeometry:S,releaseStatesOfProgram:C,initAttributes:m,enableAttribute:g,disableUnusedAttributes:x}}function foe(t,e,n){let r;function i(c){r=c}function s(c,u){t.drawArrays(r,c,u),n.update(u,r,1)}function o(c,u,f){f!==0&&(t.drawArraysInstanced(r,c,u,f),n.update(u,r,f))}function a(c,u,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,c,0,u,0,f);let h=0;for(let p=0;p<f;p++)h+=u[p];n.update(h,r,1)}function l(c,u,f,d){if(f===0)return;const h=e.get("WEBGL_multi_draw");if(h===null)for(let p=0;p<c.length;p++)o(c[p],u[p],d[p]);else{h.multiDrawArraysInstancedWEBGL(r,c,0,u,0,d,0,f);let p=0;for(let m=0;m<f;m++)p+=u[m]*d[m];n.update(p,r,1)}}this.setMode=i,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function doe(t,e,n,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(C){return!(C!==Pr&&r.convert(C)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(C){const A=C===ti&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(C!==Rs&&r.convert(C)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&C!==pr&&!A)}function l(C){if(C==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return C==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=n.precision!==void 0?n.precision:"highp";const u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const f=n.logarithmicDepthBuffer===!0,d=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),h=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=t.getParameter(t.MAX_TEXTURE_SIZE),g=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),y=t.getParameter(t.MAX_VERTEX_ATTRIBS),x=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),_=t.getParameter(t.MAX_VARYING_VECTORS),w=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),T=p>0,S=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:f,reverseDepthBuffer:d,maxTextures:h,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:g,maxAttributes:y,maxVertexUniforms:x,maxVaryings:_,maxFragmentUniforms:w,vertexTextures:T,maxSamples:S}}function hoe(t){const e=this;let n=null,r=0,i=!1,s=!1;const o=new Oi,a=new Ln,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,d){const h=f.length!==0||d||r!==0||i;return i=d,r=f.length,h},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,d){n=u(f,d,0)},this.setState=function(f,d,h){const p=f.clippingPlanes,m=f.clipIntersection,g=f.clipShadows,y=t.get(f);if(!i||p===null||p.length===0||s&&!g)s?u(null):c();else{const x=s?0:r,_=x*4;let w=y.clippingState||null;l.value=w,w=u(p,d,_,h);for(let T=0;T!==_;++T)w[T]=n[T];y.clippingState=w,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(f,d,h,p){const m=f!==null?f.length:0;let g=null;if(m!==0){if(g=l.value,p!==!0||g===null){const y=h+m*4,x=d.matrixWorldInverse;a.getNormalMatrix(x),(g===null||g.length<y)&&(g=new Float32Array(y));for(let _=0,w=h;_!==m;++_,w+=4)o.copy(f[_]).applyMatrix4(x,a),o.normal.toArray(g,w),g[w+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}}function poe(t){let e=new WeakMap;function n(o,a){return a===pm?o.mapping=sc:a===F1&&(o.mapping=ff),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===pm||a===F1)if(e.has(o)){const l=e.get(o).texture;return n(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new Fm(l.height);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",i),n(c.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}const Wp=4,VI=[.125,.215,.35,.446,.526,.582],hd=20,JS=new Hi,WI=new wt;let e4=null,t4=0,n4=0,r4=!1;const dd=(1+Math.sqrt(5))/2,Yh=1/dd,$I=[new $(-dd,Yh,0),new $(dd,Yh,0),new $(-Yh,0,dd),new $(Yh,0,dd),new $(0,dd,-Yh),new $(0,dd,Yh),new $(-1,1,-1),new $(1,1,-1),new $(-1,1,1),new $(1,1,1)];class t5{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,i=100){e4=this._renderer.getRenderTarget(),t4=this._renderer.getActiveCubeFace(),n4=this._renderer.getActiveMipmapLevel(),r4=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=YI(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=qI(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(e4,t4,n4),this._renderer.xr.enabled=r4,e.scissorTest=!1,P2(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===sc||e.mapping===ff?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),e4=this._renderer.getRenderTarget(),t4=this._renderer.getActiveCubeFace(),n4=this._renderer.getActiveMipmapLevel(),r4=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:Pn,minFilter:Pn,generateMipmaps:!1,type:ti,format:Pr,colorSpace:as,depthBuffer:!1},i=XI(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=XI(e,n,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=moe(s)),this._blurMaterial=goe(s,e,n)}return i}_compileMaterial(e){const n=new ln(this._lodPlanes[0],e);this._renderer.compile(n,JS)}_sceneToCubeUV(e,n,r,i){const a=new Ar(90,1,n,r),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,f=u.autoClear,d=u.toneMapping;u.getClearColor(WI),u.toneMapping=Xa,u.autoClear=!1;const h=new Fr({name:"PMREM.Background",side:zi,depthWrite:!1,depthTest:!1}),p=new ln(new fc,h);let m=!1;const g=e.background;g?g.isColor&&(h.color.copy(g),e.background=null,m=!0):(h.color.copy(WI),m=!0);for(let y=0;y<6;y++){const x=y%3;x===0?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):x===1?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const _=this._cubeSize;P2(i,x*_,y>2?_:0,_,_),u.setRenderTarget(i),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=f,e.background=g}_textureToCubeUV(e,n){const r=this._renderer,i=e.mapping===sc||e.mapping===ff;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=YI()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=qI());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new ln(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;P2(n,0,0,3*l,2*l),r.setRenderTarget(n),r.render(o,JS)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=$I[(i-s-1)%$I.length];this._blur(e,s-1,s,o,a)}n.autoClear=r}_blur(e,n,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,n,r,i,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,f=new ln(this._lodPlanes[i],c),d=c.uniforms,h=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*h):2*Math.PI/(2*hd-1),m=s/p,g=isFinite(s)?1+Math.floor(u*m):hd;g>hd&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${hd}`);const y=[];let x=0;for(let C=0;C<hd;++C){const A=C/m,R=Math.exp(-A*A/2);y.push(R),C===0?x+=R:C<g&&(x+=2*R)}for(let C=0;C<y.length;C++)y[C]=y[C]/x;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=y,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:_}=this;d.dTheta.value=p,d.mipInt.value=_-r;const w=this._sizeLods[i],T=3*w*(i>_-Wp?i-_+Wp:0),S=4*(this._cubeSize-w);P2(n,T,S,3*w,2*w),l.setRenderTarget(n),l.render(f,JS)}}function moe(t){const e=[],n=[],r=[];let i=t;const s=t-Wp+1+VI.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);n.push(a);let l=1/a;o>t-Wp?l=VI[o-t+Wp-1]:o===0&&(l=0),r.push(l);const c=1/(a-2),u=-c,f=1+c,d=[u,u,f,u,f,f,u,u,f,f,u,f],h=6,p=6,m=3,g=2,y=1,x=new Float32Array(m*p*h),_=new Float32Array(g*p*h),w=new Float32Array(y*p*h);for(let S=0;S<h;S++){const C=S%3*2/3-1,A=S>2?0:-1,R=[C,A,0,C+2/3,A,0,C+2/3,A+1,0,C,A,0,C+2/3,A+1,0,C,A+1,0];x.set(R,m*p*S),_.set(d,g*p*S);const M=[S,S,S,S,S,S];w.set(M,y*p*S)}const T=new gn;T.setAttribute("position",new fn(x,m)),T.setAttribute("uv",new fn(_,g)),T.setAttribute("faceIndex",new fn(w,y)),e.push(T),i>Wp&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function XI(t,e,n){const r=new fr(t,e,n);return r.texture.mapping=Lm,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function P2(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function goe(t,e,n){const r=new Float32Array(hd),i=new $(0,1,0);return new yr({name:"SphericalGaussianBlur",defines:{n:hd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:X6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$a,depthTest:!1,depthWrite:!1})}function qI(){return new yr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:X6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$a,depthTest:!1,depthWrite:!1})}function YI(){return new yr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:X6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$a,depthTest:!1,depthWrite:!1})}function X6(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function yoe(t){let e=new WeakMap,n=null;function r(a){if(a&&a.isTexture){const l=a.mapping,c=l===pm||l===F1,u=l===sc||l===ff;if(c||u){let f=e.get(a);const d=f!==void 0?f.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==d)return n===null&&(n=new t5(t)),f=c?n.fromEquirectangular(a,f):n.fromCubemap(a,f),f.texture.pmremVersion=a.pmremVersion,e.set(a,f),f.texture;if(f!==void 0)return f.texture;{const h=a.image;return c&&h&&h.height>0||u&&h&&i(h)?(n===null&&(n=new t5(t)),f=c?n.fromEquirectangular(a):n.fromCubemap(a),f.texture.pmremVersion=a.pmremVersion,e.set(a,f),a.addEventListener("dispose",s),f.texture):null}}}return a}function i(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:o}}function voe(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return e[r]=i,i}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const i=n(r);return i===null&&Np("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function xoe(t,e,n,r){const i={},s=new WeakMap;function o(f){const d=f.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete i[d.id];const h=s.get(d);h&&(e.remove(h),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function a(f,d){return i[d.id]===!0||(d.addEventListener("dispose",o),i[d.id]=!0,n.memory.geometries++),d}function l(f){const d=f.attributes;for(const h in d)e.update(d[h],t.ARRAY_BUFFER)}function c(f){const d=[],h=f.index,p=f.attributes.position;let m=0;if(h!==null){const x=h.array;m=h.version;for(let _=0,w=x.length;_<w;_+=3){const T=x[_+0],S=x[_+1],C=x[_+2];d.push(T,S,S,C,C,T)}}else if(p!==void 0){const x=p.array;m=p.version;for(let _=0,w=x.length/3-1;_<w;_+=3){const T=_+0,S=_+1,C=_+2;d.push(T,S,S,C,C,T)}}else return;const g=new(Pz(d)?b6:_6)(d,1);g.version=m;const y=s.get(f);y&&e.remove(y),s.set(f,g)}function u(f){const d=s.get(f);if(d){const h=f.index;h!==null&&d.version<h.version&&c(f)}else c(f);return s.get(f)}return{get:a,update:l,getWireframeAttribute:u}}function _oe(t,e,n){let r;function i(d){r=d}let s,o;function a(d){s=d.type,o=d.bytesPerElement}function l(d,h){t.drawElements(r,h,s,d*o),n.update(h,r,1)}function c(d,h,p){p!==0&&(t.drawElementsInstanced(r,h,s,d*o,p),n.update(h,r,p))}function u(d,h,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,h,0,s,d,0,p);let g=0;for(let y=0;y<p;y++)g+=h[y];n.update(g,r,1)}function f(d,h,p,m){if(p===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let y=0;y<d.length;y++)c(d[y]/o,h[y],m[y]);else{g.multiDrawElementsInstancedWEBGL(r,h,0,s,d,0,m,0,p);let y=0;for(let x=0;x<p;x++)y+=h[x]*m[x];n.update(y,r,1)}}this.setMode=i,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=f}function boe(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:i,update:r}}function Eoe(t,e,n){const r=new WeakMap,i=new Hn;function s(o,a,l){const c=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,f=u!==void 0?u.length:0;let d=r.get(a);if(d===void 0||d.count!==f){let R=function(){C.dispose(),r.delete(a),a.removeEventListener("dispose",R)};d!==void 0&&d.texture.dispose();const h=a.morphAttributes.position!==void 0,p=a.morphAttributes.normal!==void 0,m=a.morphAttributes.color!==void 0,g=a.morphAttributes.position||[],y=a.morphAttributes.normal||[],x=a.morphAttributes.color||[];let _=0;h===!0&&(_=1),p===!0&&(_=2),m===!0&&(_=3);let w=a.attributes.position.count*_,T=1;w>e.maxTextureSize&&(T=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);const S=new Float32Array(w*T*4*f),C=new Eb(S,w,T,f);C.type=pr,C.needsUpdate=!0;const A=_*4;for(let M=0;M<f;M++){const D=g[M],k=y[M],L=x[M],N=w*T*4*M;for(let z=0;z<D.count;z++){const O=z*A;h===!0&&(i.fromBufferAttribute(D,z),S[N+O+0]=i.x,S[N+O+1]=i.y,S[N+O+2]=i.z,S[N+O+3]=0),p===!0&&(i.fromBufferAttribute(k,z),S[N+O+4]=i.x,S[N+O+5]=i.y,S[N+O+6]=i.z,S[N+O+7]=0),m===!0&&(i.fromBufferAttribute(L,z),S[N+O+8]=i.x,S[N+O+9]=i.y,S[N+O+10]=i.z,S[N+O+11]=L.itemSize===4?i.w:1)}}d={count:f,texture:C,size:new Ke(w,T)},r.set(a,d),a.addEventListener("dispose",R)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",o.morphTexture,n);else{let h=0;for(let m=0;m<c.length;m++)h+=c[m];const p=a.morphTargetsRelative?1:1-h;l.getUniforms().setValue(t,"morphTargetBaseInfluence",p),l.getUniforms().setValue(t,"morphTargetInfluences",c)}l.getUniforms().setValue(t,"morphTargetsTexture",d.texture,n),l.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}return{update:s}}function woe(t,e,n,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,f=e.get(l,u);if(i.get(f)!==c&&(e.update(f),i.set(f,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==c&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;i.get(d)!==c&&(d.update(),i.set(d,c))}return f}function o(){i=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}const xH=new tr,KI=new Bm(1,1),_H=new Eb,bH=new x6,EH=new my,ZI=[],QI=[],JI=new Float32Array(16),eP=new Float32Array(9),tP=new Float32Array(4);function Vm(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let s=ZI[i];if(s===void 0&&(s=new Float32Array(i),ZI[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function cs(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function us(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function qb(t,e){let n=QI[e];n===void 0&&(n=new Int32Array(e),QI[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Soe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Toe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(cs(n,e))return;t.uniform2fv(this.addr,e),us(n,e)}}function Aoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(cs(n,e))return;t.uniform3fv(this.addr,e),us(n,e)}}function Moe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(cs(n,e))return;t.uniform4fv(this.addr,e),us(n,e)}}function Coe(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(cs(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),us(n,e)}else{if(cs(n,r))return;tP.set(r),t.uniformMatrix2fv(this.addr,!1,tP),us(n,r)}}function Roe(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(cs(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),us(n,e)}else{if(cs(n,r))return;eP.set(r),t.uniformMatrix3fv(this.addr,!1,eP),us(n,r)}}function Ioe(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(cs(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),us(n,e)}else{if(cs(n,r))return;JI.set(r),t.uniformMatrix4fv(this.addr,!1,JI),us(n,r)}}function Poe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function koe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(cs(n,e))return;t.uniform2iv(this.addr,e),us(n,e)}}function Loe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(cs(n,e))return;t.uniform3iv(this.addr,e),us(n,e)}}function Doe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(cs(n,e))return;t.uniform4iv(this.addr,e),us(n,e)}}function Noe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Ooe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(cs(n,e))return;t.uniform2uiv(this.addr,e),us(n,e)}}function Foe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(cs(n,e))return;t.uniform3uiv(this.addr,e),us(n,e)}}function Uoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(cs(n,e))return;t.uniform4uiv(this.addr,e),us(n,e)}}function Boe(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i);let s;this.type===t.SAMPLER_2D_SHADOW?(KI.compareFunction=y6,s=KI):s=xH,n.setTexture2D(e||s,i)}function zoe(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||bH,i)}function Hoe(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||EH,i)}function Goe(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||_H,i)}function joe(t){switch(t){case 5126:return Soe;case 35664:return Toe;case 35665:return Aoe;case 35666:return Moe;case 35674:return Coe;case 35675:return Roe;case 35676:return Ioe;case 5124:case 35670:return Poe;case 35667:case 35671:return koe;case 35668:case 35672:return Loe;case 35669:case 35673:return Doe;case 5125:return Noe;case 36294:return Ooe;case 36295:return Foe;case 36296:return Uoe;case 35678:case 36198:case 36298:case 36306:case 35682:return Boe;case 35679:case 36299:case 36307:return zoe;case 35680:case 36300:case 36308:case 36293:return Hoe;case 36289:case 36303:case 36311:case 36292:return Goe}}function Voe(t,e){t.uniform1fv(this.addr,e)}function Woe(t,e){const n=Vm(e,this.size,2);t.uniform2fv(this.addr,n)}function $oe(t,e){const n=Vm(e,this.size,3);t.uniform3fv(this.addr,n)}function Xoe(t,e){const n=Vm(e,this.size,4);t.uniform4fv(this.addr,n)}function qoe(t,e){const n=Vm(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Yoe(t,e){const n=Vm(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Koe(t,e){const n=Vm(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Zoe(t,e){t.uniform1iv(this.addr,e)}function Qoe(t,e){t.uniform2iv(this.addr,e)}function Joe(t,e){t.uniform3iv(this.addr,e)}function eae(t,e){t.uniform4iv(this.addr,e)}function tae(t,e){t.uniform1uiv(this.addr,e)}function nae(t,e){t.uniform2uiv(this.addr,e)}function rae(t,e){t.uniform3uiv(this.addr,e)}function iae(t,e){t.uniform4uiv(this.addr,e)}function sae(t,e,n){const r=this.cache,i=e.length,s=qb(n,i);cs(r,s)||(t.uniform1iv(this.addr,s),us(r,s));for(let o=0;o!==i;++o)n.setTexture2D(e[o]||xH,s[o])}function oae(t,e,n){const r=this.cache,i=e.length,s=qb(n,i);cs(r,s)||(t.uniform1iv(this.addr,s),us(r,s));for(let o=0;o!==i;++o)n.setTexture3D(e[o]||bH,s[o])}function aae(t,e,n){const r=this.cache,i=e.length,s=qb(n,i);cs(r,s)||(t.uniform1iv(this.addr,s),us(r,s));for(let o=0;o!==i;++o)n.setTextureCube(e[o]||EH,s[o])}function lae(t,e,n){const r=this.cache,i=e.length,s=qb(n,i);cs(r,s)||(t.uniform1iv(this.addr,s),us(r,s));for(let o=0;o!==i;++o)n.setTexture2DArray(e[o]||_H,s[o])}function cae(t){switch(t){case 5126:return Voe;case 35664:return Woe;case 35665:return $oe;case 35666:return Xoe;case 35674:return qoe;case 35675:return Yoe;case 35676:return Koe;case 5124:case 35670:return Zoe;case 35667:case 35671:return Qoe;case 35668:case 35672:return Joe;case 35669:case 35673:return eae;case 5125:return tae;case 36294:return nae;case 36295:return rae;case 36296:return iae;case 35678:case 36198:case 36298:case 36306:case 35682:return sae;case 35679:case 36299:case 36307:return oae;case 35680:case 36300:case 36308:case 36293:return aae;case 36289:case 36303:case 36311:case 36292:return lae}}class uae{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=joe(n.type)}}class fae{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=cae(n.type)}}class dae{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,n[a.id],r)}}}const i4=/(\w+)(\])?(\[|\.)?/g;function nP(t,e){t.seq.push(e),t.map[e.id]=e}function hae(t,e,n){const r=t.name,i=r.length;for(i4.lastIndex=0;;){const s=i4.exec(r),o=i4.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===i){nP(n,c===void 0?new uae(a,t,e):new fae(a,t,e));break}else{let f=n.map[a];f===void 0&&(f=new dae(a),nP(n,f)),n=f}}}class f3{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(n,i),o=e.getUniformLocation(n,s.name);hae(s,o,this)}}setValue(e,n,r,i){const s=this.map[n];s!==void 0&&s.setValue(e,r,i)}setOptional(e,n,r){const i=n[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,n,r,i){for(let s=0,o=n.length;s!==o;++s){const a=n[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,n){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in n&&r.push(o)}return r}}function rP(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const pae=37297;let mae=0;function gae(t,e){const n=t.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return r.join(`
`)}const iP=new Ln;function yae(t){er._getMatrix(iP,er.workingColorSpace,t);const e=`mat3( ${iP.elements.map(n=>n.toFixed(4))} )`;switch(er.getTransfer(t)){case B1:return[e,"LinearTransferOETF"];case Dr:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function sP(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return n.toUpperCase()+`

`+i+`

`+gae(t.getShaderSource(e),o)}else return i}function vae(t,e){const n=yae(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function xae(t,e){let n;switch(e){case i6:n="Linear";break;case s6:n="Reinhard";break;case o6:n="Cineon";break;case yb:n="ACESFilmic";break;case pz:n="AgX";break;case mz:n="Neutral";break;case a6:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const k2=new $;function _ae(){er.getLuminanceCoefficients(k2);const t=k2.x.toFixed(4),e=k2.y.toFixed(4),n=k2.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function bae(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Xg).join(`
`)}function Eae(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function wae(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function Xg(t){return t!==""}function oP(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function aP(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Sae=/^[ \t]*#include +<([\w\d./]+)>/gm;function n5(t){return t.replace(Sae,Aae)}const Tae=new Map;function Aae(t,e){let n=Fn[e];if(n===void 0){const r=Tae.get(e);if(r!==void 0)n=Fn[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return n5(n)}const Mae=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lP(t){return t.replace(Mae,Cae)}function Cae(t,e,n,r){let i="";for(let s=parseInt(e);s<parseInt(n);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function cP(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Rae(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===pb?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===s1?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===gl&&(e="SHADOWMAP_TYPE_VSM"),e}function Iae(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case sc:case ff:e="ENVMAP_TYPE_CUBE";break;case Lm:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Pae(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case ff:e="ENVMAP_MODE_REFRACTION";break}return e}function kae(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case fy:e="ENVMAP_BLENDING_MULTIPLY";break;case dz:e="ENVMAP_BLENDING_MIX";break;case hz:e="ENVMAP_BLENDING_ADD";break}return e}function Lae(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function Dae(t,e,n,r){const i=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=Rae(n),c=Iae(n),u=Pae(n),f=kae(n),d=Lae(n),h=bae(n),p=Eae(s),m=i.createProgram();let g,y,x=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(Xg).join(`
`),g.length>0&&(g+=`
`),y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(Xg).join(`
`),y.length>0&&(y+=`
`)):(g=[cP(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Xg).join(`
`),y=[cP(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+f:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Xa?"#define TONE_MAPPING":"",n.toneMapping!==Xa?Fn.tonemapping_pars_fragment:"",n.toneMapping!==Xa?xae("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Fn.colorspace_pars_fragment,vae("linearToOutputTexel",n.outputColorSpace),_ae(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Xg).join(`
`)),o=n5(o),o=oP(o,n),o=aP(o,n),a=n5(a),a=oP(a,n),a=aP(a,n),o=lP(o),a=lP(a),n.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,g=[h,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,y=["#define varying in",n.glslVersion===qA?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===qA?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const _=x+g+o,w=x+y+a,T=rP(i,i.VERTEX_SHADER,_),S=rP(i,i.FRAGMENT_SHADER,w);i.attachShader(m,T),i.attachShader(m,S),n.index0AttributeName!==void 0?i.bindAttribLocation(m,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m);function C(D){if(t.debug.checkShaderErrors){const k=i.getProgramInfoLog(m).trim(),L=i.getShaderInfoLog(T).trim(),N=i.getShaderInfoLog(S).trim();let z=!0,O=!0;if(i.getProgramParameter(m,i.LINK_STATUS)===!1)if(z=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(i,m,T,S);else{const K=sP(i,T,"vertex"),V=sP(i,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+`

Material Name: `+D.name+`
Material Type: `+D.type+`

Program Info Log: `+k+`
`+K+`
`+V)}else k!==""?console.warn("THREE.WebGLProgram: Program Info Log:",k):(L===""||N==="")&&(O=!1);O&&(D.diagnostics={runnable:z,programLog:k,vertexShader:{log:L,prefix:g},fragmentShader:{log:N,prefix:y}})}i.deleteShader(T),i.deleteShader(S),A=new f3(i,m),R=wae(i,m)}let A;this.getUniforms=function(){return A===void 0&&C(this),A};let R;this.getAttributes=function(){return R===void 0&&C(this),R};let M=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=i.getProgramParameter(m,pae)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=mae++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=T,this.fragmentShader=S,this}let Nae=0;class Oae{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(n),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new Fae(e),n.set(e,r)),r}}class Fae{constructor(e){this.id=Nae++,this.code=e,this.usedTimes=0}}function Uae(t,e,n,r,i,s,o){const a=new Md,l=new Oae,c=new Set,u=[],f=i.logarithmicDepthBuffer,d=i.vertexTextures;let h=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(R){return c.add(R),R===0?"uv":`uv${R}`}function g(R,M,D,k,L){const N=k.fog,z=L.geometry,O=R.isMeshStandardMaterial?k.environment:null,K=(R.isMeshStandardMaterial?n:e).get(R.envMap||O),V=K&&K.mapping===Lm?K.image.height:null,ne=p[R.type];R.precision!==null&&(h=i.getMaxPrecision(R.precision),h!==R.precision&&console.warn("THREE.WebGLProgram.getParameters:",R.precision,"not supported, using",h,"instead."));const re=z.morphAttributes.position||z.morphAttributes.normal||z.morphAttributes.color,P=re!==void 0?re.length:0;let se=0;z.morphAttributes.position!==void 0&&(se=1),z.morphAttributes.normal!==void 0&&(se=2),z.morphAttributes.color!==void 0&&(se=3);let ue,te,W,X;if(ne){const Vt=yl[ne];ue=Vt.vertexShader,te=Vt.fragmentShader}else ue=R.vertexShader,te=R.fragmentShader,l.update(R),W=l.getVertexShaderID(R),X=l.getFragmentShaderID(R);const J=t.getRenderTarget(),oe=t.state.buffers.depth.getReversed(),Ee=L.isInstancedMesh===!0,me=L.isBatchedMesh===!0,Te=!!R.map,_e=!!R.matcap,Re=!!K,ae=!!R.aoMap,Ce=!!R.lightMap,Pe=!!R.bumpMap,Ve=!!R.normalMap,ye=!!R.displacementMap,ge=!!R.emissiveMap,ze=!!R.metalnessMap,fe=!!R.roughnessMap,ie=R.anisotropy>0,ve=R.clearcoat>0,Me=R.dispersion>0,Be=R.iridescence>0,Ze=R.sheen>0,F=R.transmission>0,Z=ie&&!!R.anisotropyMap,q=ve&&!!R.clearcoatMap,xe=ve&&!!R.clearcoatNormalMap,be=ve&&!!R.clearcoatRoughnessMap,De=Be&&!!R.iridescenceMap,$e=Be&&!!R.iridescenceThicknessMap,st=Ze&&!!R.sheenColorMap,it=Ze&&!!R.sheenRoughnessMap,Ie=!!R.specularMap,Ye=!!R.specularColorMap,at=!!R.specularIntensityMap,ke=F&&!!R.transmissionMap,Xe=F&&!!R.thicknessMap,Qe=!!R.gradientMap,_t=!!R.alphaMap,kt=R.alphaTest>0,Ct=!!R.alphaHash,Kt=!!R.extensions;let cn=Xa;R.toneMapped&&(J===null||J.isXRRenderTarget===!0)&&(cn=t.toneMapping);const sn={shaderID:ne,shaderType:R.type,shaderName:R.name,vertexShader:ue,fragmentShader:te,defines:R.defines,customVertexShaderID:W,customFragmentShaderID:X,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:h,batching:me,batchingColor:me&&L._colorsTexture!==null,instancing:Ee,instancingColor:Ee&&L.instanceColor!==null,instancingMorph:Ee&&L.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:J===null?t.outputColorSpace:J.isXRRenderTarget===!0?J.texture.colorSpace:as,alphaToCoverage:!!R.alphaToCoverage,map:Te,matcap:_e,envMap:Re,envMapMode:Re&&K.mapping,envMapCubeUVHeight:V,aoMap:ae,lightMap:Ce,bumpMap:Pe,normalMap:Ve,displacementMap:d&&ye,emissiveMap:ge,normalMapObjectSpace:Ve&&R.normalMapType===bz,normalMapTangentSpace:Ve&&R.normalMapType===du,metalnessMap:ze,roughnessMap:fe,anisotropy:ie,anisotropyMap:Z,clearcoat:ve,clearcoatMap:q,clearcoatNormalMap:xe,clearcoatRoughnessMap:be,dispersion:Me,iridescence:Be,iridescenceMap:De,iridescenceThicknessMap:$e,sheen:Ze,sheenColorMap:st,sheenRoughnessMap:it,specularMap:Ie,specularColorMap:Ye,specularIntensityMap:at,transmission:F,transmissionMap:ke,thicknessMap:Xe,gradientMap:Qe,opaque:R.transparent===!1&&R.blending===ec&&R.alphaToCoverage===!1,alphaMap:_t,alphaTest:kt,alphaHash:Ct,combine:R.combine,mapUv:Te&&m(R.map.channel),aoMapUv:ae&&m(R.aoMap.channel),lightMapUv:Ce&&m(R.lightMap.channel),bumpMapUv:Pe&&m(R.bumpMap.channel),normalMapUv:Ve&&m(R.normalMap.channel),displacementMapUv:ye&&m(R.displacementMap.channel),emissiveMapUv:ge&&m(R.emissiveMap.channel),metalnessMapUv:ze&&m(R.metalnessMap.channel),roughnessMapUv:fe&&m(R.roughnessMap.channel),anisotropyMapUv:Z&&m(R.anisotropyMap.channel),clearcoatMapUv:q&&m(R.clearcoatMap.channel),clearcoatNormalMapUv:xe&&m(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:be&&m(R.clearcoatRoughnessMap.channel),iridescenceMapUv:De&&m(R.iridescenceMap.channel),iridescenceThicknessMapUv:$e&&m(R.iridescenceThicknessMap.channel),sheenColorMapUv:st&&m(R.sheenColorMap.channel),sheenRoughnessMapUv:it&&m(R.sheenRoughnessMap.channel),specularMapUv:Ie&&m(R.specularMap.channel),specularColorMapUv:Ye&&m(R.specularColorMap.channel),specularIntensityMapUv:at&&m(R.specularIntensityMap.channel),transmissionMapUv:ke&&m(R.transmissionMap.channel),thicknessMapUv:Xe&&m(R.thicknessMap.channel),alphaMapUv:_t&&m(R.alphaMap.channel),vertexTangents:!!z.attributes.tangent&&(Ve||ie),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!z.attributes.color&&z.attributes.color.itemSize===4,pointsUvs:L.isPoints===!0&&!!z.attributes.uv&&(Te||_t),fog:!!N,useFog:R.fog===!0,fogExp2:!!N&&N.isFogExp2,flatShading:R.flatShading===!0,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:oe,skinning:L.isSkinnedMesh===!0,morphTargets:z.morphAttributes.position!==void 0,morphNormals:z.morphAttributes.normal!==void 0,morphColors:z.morphAttributes.color!==void 0,morphTargetsCount:P,morphTextureStride:se,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:R.dithering,shadowMapEnabled:t.shadowMap.enabled&&D.length>0,shadowMapType:t.shadowMap.type,toneMapping:cn,decodeVideoTexture:Te&&R.map.isVideoTexture===!0&&er.getTransfer(R.map.colorSpace)===Dr,decodeVideoTextureEmissive:ge&&R.emissiveMap.isVideoTexture===!0&&er.getTransfer(R.emissiveMap.colorSpace)===Dr,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===Nr,flipSided:R.side===zi,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:Kt&&R.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Kt&&R.extensions.multiDraw===!0||me)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return sn.vertexUv1s=c.has(1),sn.vertexUv2s=c.has(2),sn.vertexUv3s=c.has(3),c.clear(),sn}function y(R){const M=[];if(R.shaderID?M.push(R.shaderID):(M.push(R.customVertexShaderID),M.push(R.customFragmentShaderID)),R.defines!==void 0)for(const D in R.defines)M.push(D),M.push(R.defines[D]);return R.isRawShaderMaterial===!1&&(x(M,R),_(M,R),M.push(t.outputColorSpace)),M.push(R.customProgramCacheKey),M.join()}function x(R,M){R.push(M.precision),R.push(M.outputColorSpace),R.push(M.envMapMode),R.push(M.envMapCubeUVHeight),R.push(M.mapUv),R.push(M.alphaMapUv),R.push(M.lightMapUv),R.push(M.aoMapUv),R.push(M.bumpMapUv),R.push(M.normalMapUv),R.push(M.displacementMapUv),R.push(M.emissiveMapUv),R.push(M.metalnessMapUv),R.push(M.roughnessMapUv),R.push(M.anisotropyMapUv),R.push(M.clearcoatMapUv),R.push(M.clearcoatNormalMapUv),R.push(M.clearcoatRoughnessMapUv),R.push(M.iridescenceMapUv),R.push(M.iridescenceThicknessMapUv),R.push(M.sheenColorMapUv),R.push(M.sheenRoughnessMapUv),R.push(M.specularMapUv),R.push(M.specularColorMapUv),R.push(M.specularIntensityMapUv),R.push(M.transmissionMapUv),R.push(M.thicknessMapUv),R.push(M.combine),R.push(M.fogExp2),R.push(M.sizeAttenuation),R.push(M.morphTargetsCount),R.push(M.morphAttributeCount),R.push(M.numDirLights),R.push(M.numPointLights),R.push(M.numSpotLights),R.push(M.numSpotLightMaps),R.push(M.numHemiLights),R.push(M.numRectAreaLights),R.push(M.numDirLightShadows),R.push(M.numPointLightShadows),R.push(M.numSpotLightShadows),R.push(M.numSpotLightShadowsWithMaps),R.push(M.numLightProbes),R.push(M.shadowMapType),R.push(M.toneMapping),R.push(M.numClippingPlanes),R.push(M.numClipIntersection),R.push(M.depthPacking)}function _(R,M){a.disableAll(),M.supportsVertexTextures&&a.enable(0),M.instancing&&a.enable(1),M.instancingColor&&a.enable(2),M.instancingMorph&&a.enable(3),M.matcap&&a.enable(4),M.envMap&&a.enable(5),M.normalMapObjectSpace&&a.enable(6),M.normalMapTangentSpace&&a.enable(7),M.clearcoat&&a.enable(8),M.iridescence&&a.enable(9),M.alphaTest&&a.enable(10),M.vertexColors&&a.enable(11),M.vertexAlphas&&a.enable(12),M.vertexUv1s&&a.enable(13),M.vertexUv2s&&a.enable(14),M.vertexUv3s&&a.enable(15),M.vertexTangents&&a.enable(16),M.anisotropy&&a.enable(17),M.alphaHash&&a.enable(18),M.batching&&a.enable(19),M.dispersion&&a.enable(20),M.batchingColor&&a.enable(21),R.push(a.mask),a.disableAll(),M.fog&&a.enable(0),M.useFog&&a.enable(1),M.flatShading&&a.enable(2),M.logarithmicDepthBuffer&&a.enable(3),M.reverseDepthBuffer&&a.enable(4),M.skinning&&a.enable(5),M.morphTargets&&a.enable(6),M.morphNormals&&a.enable(7),M.morphColors&&a.enable(8),M.premultipliedAlpha&&a.enable(9),M.shadowMapEnabled&&a.enable(10),M.doubleSided&&a.enable(11),M.flipSided&&a.enable(12),M.useDepthPacking&&a.enable(13),M.dithering&&a.enable(14),M.transmission&&a.enable(15),M.sheen&&a.enable(16),M.opaque&&a.enable(17),M.pointsUvs&&a.enable(18),M.decodeVideoTexture&&a.enable(19),M.decodeVideoTextureEmissive&&a.enable(20),M.alphaToCoverage&&a.enable(21),R.push(a.mask)}function w(R){const M=p[R.type];let D;if(M){const k=yl[M];D=mf.clone(k.uniforms)}else D=R.uniforms;return D}function T(R,M){let D;for(let k=0,L=u.length;k<L;k++){const N=u[k];if(N.cacheKey===M){D=N,++D.usedTimes;break}}return D===void 0&&(D=new Dae(t,M,R,s),u.push(D)),D}function S(R){if(--R.usedTimes===0){const M=u.indexOf(R);u[M]=u[u.length-1],u.pop(),R.destroy()}}function C(R){l.remove(R)}function A(){l.dispose()}return{getParameters:g,getProgramCacheKey:y,getUniforms:w,acquireProgram:T,releaseProgram:S,releaseShaderCache:C,programs:u,dispose:A}}function Bae(){let t=new WeakMap;function e(o){return t.has(o)}function n(o){let a=t.get(o);return a===void 0&&(a={},t.set(o,a)),a}function r(o){t.delete(o)}function i(o,a,l){t.get(o)[a]=l}function s(){t=new WeakMap}return{has:e,get:n,remove:r,update:i,dispose:s}}function zae(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function uP(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function fP(){const t=[];let e=0;const n=[],r=[],i=[];function s(){e=0,n.length=0,r.length=0,i.length=0}function o(f,d,h,p,m,g){let y=t[e];return y===void 0?(y={id:f.id,object:f,geometry:d,material:h,groupOrder:p,renderOrder:f.renderOrder,z:m,group:g},t[e]=y):(y.id=f.id,y.object=f,y.geometry=d,y.material=h,y.groupOrder=p,y.renderOrder=f.renderOrder,y.z=m,y.group=g),e++,y}function a(f,d,h,p,m,g){const y=o(f,d,h,p,m,g);h.transmission>0?r.push(y):h.transparent===!0?i.push(y):n.push(y)}function l(f,d,h,p,m,g){const y=o(f,d,h,p,m,g);h.transmission>0?r.unshift(y):h.transparent===!0?i.unshift(y):n.unshift(y)}function c(f,d){n.length>1&&n.sort(f||zae),r.length>1&&r.sort(d||uP),i.length>1&&i.sort(d||uP)}function u(){for(let f=e,d=t.length;f<d;f++){const h=t[f];if(h.id===null)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}}return{opaque:n,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:u,sort:c}}function Hae(){let t=new WeakMap;function e(r,i){const s=t.get(r);let o;return s===void 0?(o=new fP,t.set(r,[o])):i>=s.length?(o=new fP,s.push(o)):o=s[i],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function Gae(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new $,color:new wt};break;case"SpotLight":n={position:new $,direction:new $,color:new wt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new $,color:new wt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new $,skyColor:new wt,groundColor:new wt};break;case"RectAreaLight":n={color:new wt,position:new $,halfWidth:new $,halfHeight:new $};break}return t[e.id]=n,n}}}function jae(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ke};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ke};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ke,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let Vae=0;function Wae(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function $ae(t){const e=new Gae,n=jae(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)r.probe.push(new $);const i=new $,s=new et,o=new et;function a(c){let u=0,f=0,d=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let h=0,p=0,m=0,g=0,y=0,x=0,_=0,w=0,T=0,S=0,C=0;c.sort(Wae);for(let R=0,M=c.length;R<M;R++){const D=c[R],k=D.color,L=D.intensity,N=D.distance,z=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)u+=k.r*L,f+=k.g*L,d+=k.b*L;else if(D.isLightProbe){for(let O=0;O<9;O++)r.probe[O].addScaledVector(D.sh.coefficients[O],L);C++}else if(D.isDirectionalLight){const O=e.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity),D.castShadow){const K=D.shadow,V=n.get(D);V.shadowIntensity=K.intensity,V.shadowBias=K.bias,V.shadowNormalBias=K.normalBias,V.shadowRadius=K.radius,V.shadowMapSize=K.mapSize,r.directionalShadow[h]=V,r.directionalShadowMap[h]=z,r.directionalShadowMatrix[h]=D.shadow.matrix,x++}r.directional[h]=O,h++}else if(D.isSpotLight){const O=e.get(D);O.position.setFromMatrixPosition(D.matrixWorld),O.color.copy(k).multiplyScalar(L),O.distance=N,O.coneCos=Math.cos(D.angle),O.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),O.decay=D.decay,r.spot[m]=O;const K=D.shadow;if(D.map&&(r.spotLightMap[T]=D.map,T++,K.updateMatrices(D),D.castShadow&&S++),r.spotLightMatrix[m]=K.matrix,D.castShadow){const V=n.get(D);V.shadowIntensity=K.intensity,V.shadowBias=K.bias,V.shadowNormalBias=K.normalBias,V.shadowRadius=K.radius,V.shadowMapSize=K.mapSize,r.spotShadow[m]=V,r.spotShadowMap[m]=z,w++}m++}else if(D.isRectAreaLight){const O=e.get(D);O.color.copy(k).multiplyScalar(L),O.halfWidth.set(D.width*.5,0,0),O.halfHeight.set(0,D.height*.5,0),r.rectArea[g]=O,g++}else if(D.isPointLight){const O=e.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity),O.distance=D.distance,O.decay=D.decay,D.castShadow){const K=D.shadow,V=n.get(D);V.shadowIntensity=K.intensity,V.shadowBias=K.bias,V.shadowNormalBias=K.normalBias,V.shadowRadius=K.radius,V.shadowMapSize=K.mapSize,V.shadowCameraNear=K.camera.near,V.shadowCameraFar=K.camera.far,r.pointShadow[p]=V,r.pointShadowMap[p]=z,r.pointShadowMatrix[p]=D.shadow.matrix,_++}r.point[p]=O,p++}else if(D.isHemisphereLight){const O=e.get(D);O.skyColor.copy(D.color).multiplyScalar(L),O.groundColor.copy(D.groundColor).multiplyScalar(L),r.hemi[y]=O,y++}}g>0&&(t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Qt.LTC_FLOAT_1,r.rectAreaLTC2=Qt.LTC_FLOAT_2):(r.rectAreaLTC1=Qt.LTC_HALF_1,r.rectAreaLTC2=Qt.LTC_HALF_2)),r.ambient[0]=u,r.ambient[1]=f,r.ambient[2]=d;const A=r.hash;(A.directionalLength!==h||A.pointLength!==p||A.spotLength!==m||A.rectAreaLength!==g||A.hemiLength!==y||A.numDirectionalShadows!==x||A.numPointShadows!==_||A.numSpotShadows!==w||A.numSpotMaps!==T||A.numLightProbes!==C)&&(r.directional.length=h,r.spot.length=m,r.rectArea.length=g,r.point.length=p,r.hemi.length=y,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=_,r.pointShadowMap.length=_,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=_,r.spotLightMatrix.length=w+T-S,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=S,r.numLightProbes=C,A.directionalLength=h,A.pointLength=p,A.spotLength=m,A.rectAreaLength=g,A.hemiLength=y,A.numDirectionalShadows=x,A.numPointShadows=_,A.numSpotShadows=w,A.numSpotMaps=T,A.numLightProbes=C,r.version=Vae++)}function l(c,u){let f=0,d=0,h=0,p=0,m=0;const g=u.matrixWorldInverse;for(let y=0,x=c.length;y<x;y++){const _=c[y];if(_.isDirectionalLight){const w=r.directional[f];w.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(g),f++}else if(_.isSpotLight){const w=r.spot[h];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(g),w.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(g),h++}else if(_.isRectAreaLight){const w=r.rectArea[p];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(g),o.identity(),s.copy(_.matrixWorld),s.premultiply(g),o.extractRotation(s),w.halfWidth.set(_.width*.5,0,0),w.halfHeight.set(0,_.height*.5,0),w.halfWidth.applyMatrix4(o),w.halfHeight.applyMatrix4(o),p++}else if(_.isPointLight){const w=r.point[d];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(g),d++}else if(_.isHemisphereLight){const w=r.hemi[m];w.direction.setFromMatrixPosition(_.matrixWorld),w.direction.transformDirection(g),m++}}}return{setup:a,setupView:l,state:r}}function dP(t){const e=new $ae(t),n=[],r=[];function i(u){c.camera=u,n.length=0,r.length=0}function s(u){n.push(u)}function o(u){r.push(u)}function a(){e.setup(n)}function l(u){e.setupView(n,u)}const c={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:c,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function Xae(t){let e=new WeakMap;function n(i,s=0){const o=e.get(i);let a;return o===void 0?(a=new dP(t),e.set(i,[a])):s>=o.length?(a=new dP(t),o.push(a)):a=o[s],a}function r(){e=new WeakMap}return{get:n,dispose:r}}const qae=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Yae=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Kae(t,e,n){let r=new th;const i=new Ke,s=new Ke,o=new Hn,a=new zm({depthPacking:g6}),l=new Gb,c={},u=n.maxTextureSize,f={[Cs]:zi,[zi]:Cs,[Nr]:Nr},d=new yr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ke},radius:{value:4}},vertexShader:qae,fragmentShader:Yae}),h=d.clone();h.defines.HORIZONTAL_PASS=1;const p=new gn;p.setAttribute("position",new fn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new ln(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=pb;let y=this.type;this.render=function(S,C,A){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||S.length===0)return;const R=t.getRenderTarget(),M=t.getActiveCubeFace(),D=t.getActiveMipmapLevel(),k=t.state;k.setBlending($a),k.buffers.color.setClear(1,1,1,1),k.buffers.depth.setTest(!0),k.setScissorTest(!1);const L=y!==gl&&this.type===gl,N=y===gl&&this.type!==gl;for(let z=0,O=S.length;z<O;z++){const K=S[z],V=K.shadow;if(V===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(V.autoUpdate===!1&&V.needsUpdate===!1)continue;i.copy(V.mapSize);const ne=V.getFrameExtents();if(i.multiply(ne),s.copy(V.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/ne.x),i.x=s.x*ne.x,V.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/ne.y),i.y=s.y*ne.y,V.mapSize.y=s.y)),V.map===null||L===!0||N===!0){const P=this.type!==gl?{minFilter:zn,magFilter:zn}:{};V.map!==null&&V.map.dispose(),V.map=new fr(i.x,i.y,P),V.map.texture.name=K.name+".shadowMap",V.camera.updateProjectionMatrix()}t.setRenderTarget(V.map),t.clear();const re=V.getViewportCount();for(let P=0;P<re;P++){const se=V.getViewport(P);o.set(s.x*se.x,s.y*se.y,s.x*se.z,s.y*se.w),k.viewport(o),V.updateMatrices(K,P),r=V.getFrustum(),w(C,A,V.camera,K,this.type)}V.isPointLightShadow!==!0&&this.type===gl&&x(V,A),V.needsUpdate=!1}y=this.type,g.needsUpdate=!1,t.setRenderTarget(R,M,D)};function x(S,C){const A=e.update(m);d.defines.VSM_SAMPLES!==S.blurSamples&&(d.defines.VSM_SAMPLES=S.blurSamples,h.defines.VSM_SAMPLES=S.blurSamples,d.needsUpdate=!0,h.needsUpdate=!0),S.mapPass===null&&(S.mapPass=new fr(i.x,i.y)),d.uniforms.shadow_pass.value=S.map.texture,d.uniforms.resolution.value=S.mapSize,d.uniforms.radius.value=S.radius,t.setRenderTarget(S.mapPass),t.clear(),t.renderBufferDirect(C,null,A,d,m,null),h.uniforms.shadow_pass.value=S.mapPass.texture,h.uniforms.resolution.value=S.mapSize,h.uniforms.radius.value=S.radius,t.setRenderTarget(S.map),t.clear(),t.renderBufferDirect(C,null,A,h,m,null)}function _(S,C,A,R){let M=null;const D=A.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(D!==void 0)M=D;else if(M=A.isPointLight===!0?l:a,t.localClippingEnabled&&C.clipShadows===!0&&Array.isArray(C.clippingPlanes)&&C.clippingPlanes.length!==0||C.displacementMap&&C.displacementScale!==0||C.alphaMap&&C.alphaTest>0||C.map&&C.alphaTest>0){const k=M.uuid,L=C.uuid;let N=c[k];N===void 0&&(N={},c[k]=N);let z=N[L];z===void 0&&(z=M.clone(),N[L]=z,C.addEventListener("dispose",T)),M=z}if(M.visible=C.visible,M.wireframe=C.wireframe,R===gl?M.side=C.shadowSide!==null?C.shadowSide:C.side:M.side=C.shadowSide!==null?C.shadowSide:f[C.side],M.alphaMap=C.alphaMap,M.alphaTest=C.alphaTest,M.map=C.map,M.clipShadows=C.clipShadows,M.clippingPlanes=C.clippingPlanes,M.clipIntersection=C.clipIntersection,M.displacementMap=C.displacementMap,M.displacementScale=C.displacementScale,M.displacementBias=C.displacementBias,M.wireframeLinewidth=C.wireframeLinewidth,M.linewidth=C.linewidth,A.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const k=t.properties.get(M);k.light=A}return M}function w(S,C,A,R,M){if(S.visible===!1)return;if(S.layers.test(C.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&M===gl)&&(!S.frustumCulled||r.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,S.matrixWorld);const L=e.update(S),N=S.material;if(Array.isArray(N)){const z=L.groups;for(let O=0,K=z.length;O<K;O++){const V=z[O],ne=N[V.materialIndex];if(ne&&ne.visible){const re=_(S,ne,R,M);S.onBeforeShadow(t,S,C,A,L,re,V),t.renderBufferDirect(A,null,L,re,S,V),S.onAfterShadow(t,S,C,A,L,re,V)}}}else if(N.visible){const z=_(S,N,R,M);S.onBeforeShadow(t,S,C,A,L,z,null),t.renderBufferDirect(A,null,L,z,S,null),S.onAfterShadow(t,S,C,A,L,z,null)}}const k=S.children;for(let L=0,N=k.length;L<N;L++)w(k[L],C,A,R,M)}function T(S){S.target.removeEventListener("dispose",T);for(const A in c){const R=c[A],M=S.target.uuid;M in R&&(R[M].dispose(),delete R[M])}}}const Zae={[C3]:R3,[I3]:L3,[P3]:D3,[Ud]:k3,[R3]:C3,[L3]:I3,[D3]:P3,[k3]:Ud};function Qae(t,e){function n(){let ke=!1;const Xe=new Hn;let Qe=null;const _t=new Hn(0,0,0,0);return{setMask:function(kt){Qe!==kt&&!ke&&(t.colorMask(kt,kt,kt,kt),Qe=kt)},setLocked:function(kt){ke=kt},setClear:function(kt,Ct,Kt,cn,sn){sn===!0&&(kt*=cn,Ct*=cn,Kt*=cn),Xe.set(kt,Ct,Kt,cn),_t.equals(Xe)===!1&&(t.clearColor(kt,Ct,Kt,cn),_t.copy(Xe))},reset:function(){ke=!1,Qe=null,_t.set(-1,0,0,0)}}}function r(){let ke=!1,Xe=!1,Qe=null,_t=null,kt=null;return{setReversed:function(Ct){if(Xe!==Ct){const Kt=e.get("EXT_clip_control");Xe?Kt.clipControlEXT(Kt.LOWER_LEFT_EXT,Kt.ZERO_TO_ONE_EXT):Kt.clipControlEXT(Kt.LOWER_LEFT_EXT,Kt.NEGATIVE_ONE_TO_ONE_EXT);const cn=kt;kt=null,this.setClear(cn)}Xe=Ct},getReversed:function(){return Xe},setTest:function(Ct){Ct?J(t.DEPTH_TEST):oe(t.DEPTH_TEST)},setMask:function(Ct){Qe!==Ct&&!ke&&(t.depthMask(Ct),Qe=Ct)},setFunc:function(Ct){if(Xe&&(Ct=Zae[Ct]),_t!==Ct){switch(Ct){case C3:t.depthFunc(t.NEVER);break;case R3:t.depthFunc(t.ALWAYS);break;case I3:t.depthFunc(t.LESS);break;case Ud:t.depthFunc(t.LEQUAL);break;case P3:t.depthFunc(t.EQUAL);break;case k3:t.depthFunc(t.GEQUAL);break;case L3:t.depthFunc(t.GREATER);break;case D3:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}_t=Ct}},setLocked:function(Ct){ke=Ct},setClear:function(Ct){kt!==Ct&&(Xe&&(Ct=1-Ct),t.clearDepth(Ct),kt=Ct)},reset:function(){ke=!1,Qe=null,_t=null,kt=null,Xe=!1}}}function i(){let ke=!1,Xe=null,Qe=null,_t=null,kt=null,Ct=null,Kt=null,cn=null,sn=null;return{setTest:function(Vt){ke||(Vt?J(t.STENCIL_TEST):oe(t.STENCIL_TEST))},setMask:function(Vt){Xe!==Vt&&!ke&&(t.stencilMask(Vt),Xe=Vt)},setFunc:function(Vt,Gn,rr){(Qe!==Vt||_t!==Gn||kt!==rr)&&(t.stencilFunc(Vt,Gn,rr),Qe=Vt,_t=Gn,kt=rr)},setOp:function(Vt,Gn,rr){(Ct!==Vt||Kt!==Gn||cn!==rr)&&(t.stencilOp(Vt,Gn,rr),Ct=Vt,Kt=Gn,cn=rr)},setLocked:function(Vt){ke=Vt},setClear:function(Vt){sn!==Vt&&(t.clearStencil(Vt),sn=Vt)},reset:function(){ke=!1,Xe=null,Qe=null,_t=null,kt=null,Ct=null,Kt=null,cn=null,sn=null}}}const s=new n,o=new r,a=new i,l=new WeakMap,c=new WeakMap;let u={},f={},d=new WeakMap,h=[],p=null,m=!1,g=null,y=null,x=null,_=null,w=null,T=null,S=null,C=new wt(0,0,0),A=0,R=!1,M=null,D=null,k=null,L=null,N=null;const z=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let O=!1,K=0;const V=t.getParameter(t.VERSION);V.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(V)[1]),O=K>=1):V.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(V)[1]),O=K>=2);let ne=null,re={};const P=t.getParameter(t.SCISSOR_BOX),se=t.getParameter(t.VIEWPORT),ue=new Hn().fromArray(P),te=new Hn().fromArray(se);function W(ke,Xe,Qe,_t){const kt=new Uint8Array(4),Ct=t.createTexture();t.bindTexture(ke,Ct),t.texParameteri(ke,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(ke,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Kt=0;Kt<Qe;Kt++)ke===t.TEXTURE_3D||ke===t.TEXTURE_2D_ARRAY?t.texImage3D(Xe,0,t.RGBA,1,1,_t,0,t.RGBA,t.UNSIGNED_BYTE,kt):t.texImage2D(Xe+Kt,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,kt);return Ct}const X={};X[t.TEXTURE_2D]=W(t.TEXTURE_2D,t.TEXTURE_2D,1),X[t.TEXTURE_CUBE_MAP]=W(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),X[t.TEXTURE_2D_ARRAY]=W(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),X[t.TEXTURE_3D]=W(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),J(t.DEPTH_TEST),o.setFunc(Ud),Pe(!1),Ve(jA),J(t.CULL_FACE),ae($a);function J(ke){u[ke]!==!0&&(t.enable(ke),u[ke]=!0)}function oe(ke){u[ke]!==!1&&(t.disable(ke),u[ke]=!1)}function Ee(ke,Xe){return f[ke]!==Xe?(t.bindFramebuffer(ke,Xe),f[ke]=Xe,ke===t.DRAW_FRAMEBUFFER&&(f[t.FRAMEBUFFER]=Xe),ke===t.FRAMEBUFFER&&(f[t.DRAW_FRAMEBUFFER]=Xe),!0):!1}function me(ke,Xe){let Qe=h,_t=!1;if(ke){Qe=d.get(Xe),Qe===void 0&&(Qe=[],d.set(Xe,Qe));const kt=ke.textures;if(Qe.length!==kt.length||Qe[0]!==t.COLOR_ATTACHMENT0){for(let Ct=0,Kt=kt.length;Ct<Kt;Ct++)Qe[Ct]=t.COLOR_ATTACHMENT0+Ct;Qe.length=kt.length,_t=!0}}else Qe[0]!==t.BACK&&(Qe[0]=t.BACK,_t=!0);_t&&t.drawBuffers(Qe)}function Te(ke){return p!==ke?(t.useProgram(ke),p=ke,!0):!1}const _e={[Ku]:t.FUNC_ADD,[KB]:t.FUNC_SUBTRACT,[ZB]:t.FUNC_REVERSE_SUBTRACT};_e[QB]=t.MIN,_e[JB]=t.MAX;const Re={[ez]:t.ZERO,[gb]:t.ONE,[tz]:t.SRC_COLOR,[O1]:t.SRC_ALPHA,[az]:t.SRC_ALPHA_SATURATE,[sz]:t.DST_COLOR,[rz]:t.DST_ALPHA,[nz]:t.ONE_MINUS_SRC_COLOR,[M3]:t.ONE_MINUS_SRC_ALPHA,[oz]:t.ONE_MINUS_DST_COLOR,[iz]:t.ONE_MINUS_DST_ALPHA,[lz]:t.CONSTANT_COLOR,[cz]:t.ONE_MINUS_CONSTANT_COLOR,[uz]:t.CONSTANT_ALPHA,[fz]:t.ONE_MINUS_CONSTANT_ALPHA};function ae(ke,Xe,Qe,_t,kt,Ct,Kt,cn,sn,Vt){if(ke===$a){m===!0&&(oe(t.BLEND),m=!1);return}if(m===!1&&(J(t.BLEND),m=!0),ke!==mb){if(ke!==g||Vt!==R){if((y!==Ku||w!==Ku)&&(t.blendEquation(t.FUNC_ADD),y=Ku,w=Ku),Vt)switch(ke){case ec:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case A3:t.blendFunc(t.ONE,t.ONE);break;case VA:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case WA:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ke);break}else switch(ke){case ec:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case A3:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case VA:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case WA:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ke);break}x=null,_=null,T=null,S=null,C.set(0,0,0),A=0,g=ke,R=Vt}return}kt=kt||Xe,Ct=Ct||Qe,Kt=Kt||_t,(Xe!==y||kt!==w)&&(t.blendEquationSeparate(_e[Xe],_e[kt]),y=Xe,w=kt),(Qe!==x||_t!==_||Ct!==T||Kt!==S)&&(t.blendFuncSeparate(Re[Qe],Re[_t],Re[Ct],Re[Kt]),x=Qe,_=_t,T=Ct,S=Kt),(cn.equals(C)===!1||sn!==A)&&(t.blendColor(cn.r,cn.g,cn.b,sn),C.copy(cn),A=sn),g=ke,R=!1}function Ce(ke,Xe){ke.side===Nr?oe(t.CULL_FACE):J(t.CULL_FACE);let Qe=ke.side===zi;Xe&&(Qe=!Qe),Pe(Qe),ke.blending===ec&&ke.transparent===!1?ae($a):ae(ke.blending,ke.blendEquation,ke.blendSrc,ke.blendDst,ke.blendEquationAlpha,ke.blendSrcAlpha,ke.blendDstAlpha,ke.blendColor,ke.blendAlpha,ke.premultipliedAlpha),o.setFunc(ke.depthFunc),o.setTest(ke.depthTest),o.setMask(ke.depthWrite),s.setMask(ke.colorWrite);const _t=ke.stencilWrite;a.setTest(_t),_t&&(a.setMask(ke.stencilWriteMask),a.setFunc(ke.stencilFunc,ke.stencilRef,ke.stencilFuncMask),a.setOp(ke.stencilFail,ke.stencilZFail,ke.stencilZPass)),ge(ke.polygonOffset,ke.polygonOffsetFactor,ke.polygonOffsetUnits),ke.alphaToCoverage===!0?J(t.SAMPLE_ALPHA_TO_COVERAGE):oe(t.SAMPLE_ALPHA_TO_COVERAGE)}function Pe(ke){M!==ke&&(ke?t.frontFace(t.CW):t.frontFace(t.CCW),M=ke)}function Ve(ke){ke!==XB?(J(t.CULL_FACE),ke!==D&&(ke===jA?t.cullFace(t.BACK):ke===qB?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):oe(t.CULL_FACE),D=ke}function ye(ke){ke!==k&&(O&&t.lineWidth(ke),k=ke)}function ge(ke,Xe,Qe){ke?(J(t.POLYGON_OFFSET_FILL),(L!==Xe||N!==Qe)&&(t.polygonOffset(Xe,Qe),L=Xe,N=Qe)):oe(t.POLYGON_OFFSET_FILL)}function ze(ke){ke?J(t.SCISSOR_TEST):oe(t.SCISSOR_TEST)}function fe(ke){ke===void 0&&(ke=t.TEXTURE0+z-1),ne!==ke&&(t.activeTexture(ke),ne=ke)}function ie(ke,Xe,Qe){Qe===void 0&&(ne===null?Qe=t.TEXTURE0+z-1:Qe=ne);let _t=re[Qe];_t===void 0&&(_t={type:void 0,texture:void 0},re[Qe]=_t),(_t.type!==ke||_t.texture!==Xe)&&(ne!==Qe&&(t.activeTexture(Qe),ne=Qe),t.bindTexture(ke,Xe||X[ke]),_t.type=ke,_t.texture=Xe)}function ve(){const ke=re[ne];ke!==void 0&&ke.type!==void 0&&(t.bindTexture(ke.type,null),ke.type=void 0,ke.texture=void 0)}function Me(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function Be(){try{t.compressedTexImage3D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function Ze(){try{t.texSubImage2D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function F(){try{t.texSubImage3D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function Z(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function q(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function xe(){try{t.texStorage2D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function be(){try{t.texStorage3D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function De(){try{t.texImage2D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function $e(){try{t.texImage3D.apply(t,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}}function st(ke){ue.equals(ke)===!1&&(t.scissor(ke.x,ke.y,ke.z,ke.w),ue.copy(ke))}function it(ke){te.equals(ke)===!1&&(t.viewport(ke.x,ke.y,ke.z,ke.w),te.copy(ke))}function Ie(ke,Xe){let Qe=c.get(Xe);Qe===void 0&&(Qe=new WeakMap,c.set(Xe,Qe));let _t=Qe.get(ke);_t===void 0&&(_t=t.getUniformBlockIndex(Xe,ke.name),Qe.set(ke,_t))}function Ye(ke,Xe){const _t=c.get(Xe).get(ke);l.get(Xe)!==_t&&(t.uniformBlockBinding(Xe,_t,ke.__bindingPointIndex),l.set(Xe,_t))}function at(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},ne=null,re={},f={},d=new WeakMap,h=[],p=null,m=!1,g=null,y=null,x=null,_=null,w=null,T=null,S=null,C=new wt(0,0,0),A=0,R=!1,M=null,D=null,k=null,L=null,N=null,ue.set(0,0,t.canvas.width,t.canvas.height),te.set(0,0,t.canvas.width,t.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:J,disable:oe,bindFramebuffer:Ee,drawBuffers:me,useProgram:Te,setBlending:ae,setMaterial:Ce,setFlipSided:Pe,setCullFace:Ve,setLineWidth:ye,setPolygonOffset:ge,setScissorTest:ze,activeTexture:fe,bindTexture:ie,unbindTexture:ve,compressedTexImage2D:Me,compressedTexImage3D:Be,texImage2D:De,texImage3D:$e,updateUBOMapping:Ie,uniformBlockBinding:Ye,texStorage2D:xe,texStorage3D:be,texSubImage2D:Ze,texSubImage3D:F,compressedTexSubImage2D:Z,compressedTexSubImage3D:q,scissor:st,viewport:it,reset:at}}function Jae(t,e,n,r,i,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Ke,u=new WeakMap;let f;const d=new WeakMap;let h=!1;try{h=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(fe,ie){return h?new OffscreenCanvas(fe,ie):G1("canvas")}function m(fe,ie,ve){let Me=1;const Be=ze(fe);if((Be.width>ve||Be.height>ve)&&(Me=ve/Math.max(Be.width,Be.height)),Me<1)if(typeof HTMLImageElement<"u"&&fe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&fe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&fe instanceof ImageBitmap||typeof VideoFrame<"u"&&fe instanceof VideoFrame){const Ze=Math.floor(Me*Be.width),F=Math.floor(Me*Be.height);f===void 0&&(f=p(Ze,F));const Z=ie?p(Ze,F):f;return Z.width=Ze,Z.height=F,Z.getContext("2d").drawImage(fe,0,0,Ze,F),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Be.width+"x"+Be.height+") to ("+Ze+"x"+F+")."),Z}else return"data"in fe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Be.width+"x"+Be.height+")."),fe;return fe}function g(fe){return fe.generateMipmaps}function y(fe){t.generateMipmap(fe)}function x(fe){return fe.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:fe.isWebGL3DRenderTarget?t.TEXTURE_3D:fe.isWebGLArrayRenderTarget||fe.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function _(fe,ie,ve,Me,Be=!1){if(fe!==null){if(t[fe]!==void 0)return t[fe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+fe+"'")}let Ze=ie;if(ie===t.RED&&(ve===t.FLOAT&&(Ze=t.R32F),ve===t.HALF_FLOAT&&(Ze=t.R16F),ve===t.UNSIGNED_BYTE&&(Ze=t.R8)),ie===t.RED_INTEGER&&(ve===t.UNSIGNED_BYTE&&(Ze=t.R8UI),ve===t.UNSIGNED_SHORT&&(Ze=t.R16UI),ve===t.UNSIGNED_INT&&(Ze=t.R32UI),ve===t.BYTE&&(Ze=t.R8I),ve===t.SHORT&&(Ze=t.R16I),ve===t.INT&&(Ze=t.R32I)),ie===t.RG&&(ve===t.FLOAT&&(Ze=t.RG32F),ve===t.HALF_FLOAT&&(Ze=t.RG16F),ve===t.UNSIGNED_BYTE&&(Ze=t.RG8)),ie===t.RG_INTEGER&&(ve===t.UNSIGNED_BYTE&&(Ze=t.RG8UI),ve===t.UNSIGNED_SHORT&&(Ze=t.RG16UI),ve===t.UNSIGNED_INT&&(Ze=t.RG32UI),ve===t.BYTE&&(Ze=t.RG8I),ve===t.SHORT&&(Ze=t.RG16I),ve===t.INT&&(Ze=t.RG32I)),ie===t.RGB_INTEGER&&(ve===t.UNSIGNED_BYTE&&(Ze=t.RGB8UI),ve===t.UNSIGNED_SHORT&&(Ze=t.RGB16UI),ve===t.UNSIGNED_INT&&(Ze=t.RGB32UI),ve===t.BYTE&&(Ze=t.RGB8I),ve===t.SHORT&&(Ze=t.RGB16I),ve===t.INT&&(Ze=t.RGB32I)),ie===t.RGBA_INTEGER&&(ve===t.UNSIGNED_BYTE&&(Ze=t.RGBA8UI),ve===t.UNSIGNED_SHORT&&(Ze=t.RGBA16UI),ve===t.UNSIGNED_INT&&(Ze=t.RGBA32UI),ve===t.BYTE&&(Ze=t.RGBA8I),ve===t.SHORT&&(Ze=t.RGBA16I),ve===t.INT&&(Ze=t.RGBA32I)),ie===t.RGB&&ve===t.UNSIGNED_INT_5_9_9_9_REV&&(Ze=t.RGB9_E5),ie===t.RGBA){const F=Be?B1:er.getTransfer(Me);ve===t.FLOAT&&(Ze=t.RGBA32F),ve===t.HALF_FLOAT&&(Ze=t.RGBA16F),ve===t.UNSIGNED_BYTE&&(Ze=F===Dr?t.SRGB8_ALPHA8:t.RGBA8),ve===t.UNSIGNED_SHORT_4_4_4_4&&(Ze=t.RGBA4),ve===t.UNSIGNED_SHORT_5_5_5_1&&(Ze=t.RGB5_A1)}return(Ze===t.R16F||Ze===t.R32F||Ze===t.RG16F||Ze===t.RG32F||Ze===t.RGBA16F||Ze===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ze}function w(fe,ie){let ve;return fe?ie===null||ie===io||ie===zd?ve=t.DEPTH24_STENCIL8:ie===pr?ve=t.DEPTH32F_STENCIL8:ie===df&&(ve=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ie===null||ie===io||ie===zd?ve=t.DEPTH_COMPONENT24:ie===pr?ve=t.DEPTH_COMPONENT32F:ie===df&&(ve=t.DEPTH_COMPONENT16),ve}function T(fe,ie){return g(fe)===!0||fe.isFramebufferTexture&&fe.minFilter!==zn&&fe.minFilter!==Pn?Math.log2(Math.max(ie.width,ie.height))+1:fe.mipmaps!==void 0&&fe.mipmaps.length>0?fe.mipmaps.length:fe.isCompressedTexture&&Array.isArray(fe.image)?ie.mipmaps.length:1}function S(fe){const ie=fe.target;ie.removeEventListener("dispose",S),A(ie),ie.isVideoTexture&&u.delete(ie)}function C(fe){const ie=fe.target;ie.removeEventListener("dispose",C),M(ie)}function A(fe){const ie=r.get(fe);if(ie.__webglInit===void 0)return;const ve=fe.source,Me=d.get(ve);if(Me){const Be=Me[ie.__cacheKey];Be.usedTimes--,Be.usedTimes===0&&R(fe),Object.keys(Me).length===0&&d.delete(ve)}r.remove(fe)}function R(fe){const ie=r.get(fe);t.deleteTexture(ie.__webglTexture);const ve=fe.source,Me=d.get(ve);delete Me[ie.__cacheKey],o.memory.textures--}function M(fe){const ie=r.get(fe);if(fe.depthTexture&&(fe.depthTexture.dispose(),r.remove(fe.depthTexture)),fe.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++){if(Array.isArray(ie.__webglFramebuffer[Me]))for(let Be=0;Be<ie.__webglFramebuffer[Me].length;Be++)t.deleteFramebuffer(ie.__webglFramebuffer[Me][Be]);else t.deleteFramebuffer(ie.__webglFramebuffer[Me]);ie.__webglDepthbuffer&&t.deleteRenderbuffer(ie.__webglDepthbuffer[Me])}else{if(Array.isArray(ie.__webglFramebuffer))for(let Me=0;Me<ie.__webglFramebuffer.length;Me++)t.deleteFramebuffer(ie.__webglFramebuffer[Me]);else t.deleteFramebuffer(ie.__webglFramebuffer);if(ie.__webglDepthbuffer&&t.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let Me=0;Me<ie.__webglColorRenderbuffer.length;Me++)ie.__webglColorRenderbuffer[Me]&&t.deleteRenderbuffer(ie.__webglColorRenderbuffer[Me]);ie.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}const ve=fe.textures;for(let Me=0,Be=ve.length;Me<Be;Me++){const Ze=r.get(ve[Me]);Ze.__webglTexture&&(t.deleteTexture(Ze.__webglTexture),o.memory.textures--),r.remove(ve[Me])}r.remove(fe)}let D=0;function k(){D=0}function L(){const fe=D;return fe>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+fe+" texture units while this GPU supports only "+i.maxTextures),D+=1,fe}function N(fe){const ie=[];return ie.push(fe.wrapS),ie.push(fe.wrapT),ie.push(fe.wrapR||0),ie.push(fe.magFilter),ie.push(fe.minFilter),ie.push(fe.anisotropy),ie.push(fe.internalFormat),ie.push(fe.format),ie.push(fe.type),ie.push(fe.generateMipmaps),ie.push(fe.premultiplyAlpha),ie.push(fe.flipY),ie.push(fe.unpackAlignment),ie.push(fe.colorSpace),ie.join()}function z(fe,ie){const ve=r.get(fe);if(fe.isVideoTexture&&ye(fe),fe.isRenderTargetTexture===!1&&fe.version>0&&ve.__version!==fe.version){const Me=fe.image;if(Me===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Me.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{te(ve,fe,ie);return}}n.bindTexture(t.TEXTURE_2D,ve.__webglTexture,t.TEXTURE0+ie)}function O(fe,ie){const ve=r.get(fe);if(fe.version>0&&ve.__version!==fe.version){te(ve,fe,ie);return}n.bindTexture(t.TEXTURE_2D_ARRAY,ve.__webglTexture,t.TEXTURE0+ie)}function K(fe,ie){const ve=r.get(fe);if(fe.version>0&&ve.__version!==fe.version){te(ve,fe,ie);return}n.bindTexture(t.TEXTURE_3D,ve.__webglTexture,t.TEXTURE0+ie)}function V(fe,ie){const ve=r.get(fe);if(fe.version>0&&ve.__version!==fe.version){W(ve,fe,ie);return}n.bindTexture(t.TEXTURE_CUBE_MAP,ve.__webglTexture,t.TEXTURE0+ie)}const ne={[Or]:t.REPEAT,[ei]:t.CLAMP_TO_EDGE,[Bd]:t.MIRRORED_REPEAT},re={[zn]:t.NEAREST,[dy]:t.NEAREST_MIPMAP_NEAREST,[Zu]:t.NEAREST_MIPMAP_LINEAR,[Pn]:t.LINEAR,[Td]:t.LINEAR_MIPMAP_NEAREST,[Ts]:t.LINEAR_MIPMAP_LINEAR},P={[Sz]:t.NEVER,[Iz]:t.ALWAYS,[Tz]:t.LESS,[y6]:t.LEQUAL,[Az]:t.EQUAL,[Rz]:t.GEQUAL,[Mz]:t.GREATER,[Cz]:t.NOTEQUAL};function se(fe,ie){if(ie.type===pr&&e.has("OES_texture_float_linear")===!1&&(ie.magFilter===Pn||ie.magFilter===Td||ie.magFilter===Zu||ie.magFilter===Ts||ie.minFilter===Pn||ie.minFilter===Td||ie.minFilter===Zu||ie.minFilter===Ts)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(fe,t.TEXTURE_WRAP_S,ne[ie.wrapS]),t.texParameteri(fe,t.TEXTURE_WRAP_T,ne[ie.wrapT]),(fe===t.TEXTURE_3D||fe===t.TEXTURE_2D_ARRAY)&&t.texParameteri(fe,t.TEXTURE_WRAP_R,ne[ie.wrapR]),t.texParameteri(fe,t.TEXTURE_MAG_FILTER,re[ie.magFilter]),t.texParameteri(fe,t.TEXTURE_MIN_FILTER,re[ie.minFilter]),ie.compareFunction&&(t.texParameteri(fe,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(fe,t.TEXTURE_COMPARE_FUNC,P[ie.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ie.magFilter===zn||ie.minFilter!==Zu&&ie.minFilter!==Ts||ie.type===pr&&e.has("OES_texture_float_linear")===!1)return;if(ie.anisotropy>1||r.get(ie).__currentAnisotropy){const ve=e.get("EXT_texture_filter_anisotropic");t.texParameterf(fe,ve.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ie.anisotropy,i.getMaxAnisotropy())),r.get(ie).__currentAnisotropy=ie.anisotropy}}}function ue(fe,ie){let ve=!1;fe.__webglInit===void 0&&(fe.__webglInit=!0,ie.addEventListener("dispose",S));const Me=ie.source;let Be=d.get(Me);Be===void 0&&(Be={},d.set(Me,Be));const Ze=N(ie);if(Ze!==fe.__cacheKey){Be[Ze]===void 0&&(Be[Ze]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,ve=!0),Be[Ze].usedTimes++;const F=Be[fe.__cacheKey];F!==void 0&&(Be[fe.__cacheKey].usedTimes--,F.usedTimes===0&&R(ie)),fe.__cacheKey=Ze,fe.__webglTexture=Be[Ze].texture}return ve}function te(fe,ie,ve){let Me=t.TEXTURE_2D;(ie.isDataArrayTexture||ie.isCompressedArrayTexture)&&(Me=t.TEXTURE_2D_ARRAY),ie.isData3DTexture&&(Me=t.TEXTURE_3D);const Be=ue(fe,ie),Ze=ie.source;n.bindTexture(Me,fe.__webglTexture,t.TEXTURE0+ve);const F=r.get(Ze);if(Ze.version!==F.__version||Be===!0){n.activeTexture(t.TEXTURE0+ve);const Z=er.getPrimaries(er.workingColorSpace),q=ie.colorSpace===ss?null:er.getPrimaries(ie.colorSpace),xe=ie.colorSpace===ss||Z===q?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ie.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ie.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,xe);let be=m(ie.image,!1,i.maxTextureSize);be=ge(ie,be);const De=s.convert(ie.format,ie.colorSpace),$e=s.convert(ie.type);let st=_(ie.internalFormat,De,$e,ie.colorSpace,ie.isVideoTexture);se(Me,ie);let it;const Ie=ie.mipmaps,Ye=ie.isVideoTexture!==!0,at=F.__version===void 0||Be===!0,ke=Ze.dataReady,Xe=T(ie,be);if(ie.isDepthTexture)st=w(ie.format===Hd,ie.type),at&&(Ye?n.texStorage2D(t.TEXTURE_2D,1,st,be.width,be.height):n.texImage2D(t.TEXTURE_2D,0,st,be.width,be.height,0,De,$e,null));else if(ie.isDataTexture)if(Ie.length>0){Ye&&at&&n.texStorage2D(t.TEXTURE_2D,Xe,st,Ie[0].width,Ie[0].height);for(let Qe=0,_t=Ie.length;Qe<_t;Qe++)it=Ie[Qe],Ye?ke&&n.texSubImage2D(t.TEXTURE_2D,Qe,0,0,it.width,it.height,De,$e,it.data):n.texImage2D(t.TEXTURE_2D,Qe,st,it.width,it.height,0,De,$e,it.data);ie.generateMipmaps=!1}else Ye?(at&&n.texStorage2D(t.TEXTURE_2D,Xe,st,be.width,be.height),ke&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,be.width,be.height,De,$e,be.data)):n.texImage2D(t.TEXTURE_2D,0,st,be.width,be.height,0,De,$e,be.data);else if(ie.isCompressedTexture)if(ie.isCompressedArrayTexture){Ye&&at&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Xe,st,Ie[0].width,Ie[0].height,be.depth);for(let Qe=0,_t=Ie.length;Qe<_t;Qe++)if(it=Ie[Qe],ie.format!==Pr)if(De!==null)if(Ye){if(ke)if(ie.layerUpdates.size>0){const kt=e5(it.width,it.height,ie.format,ie.type);for(const Ct of ie.layerUpdates){const Kt=it.data.subarray(Ct*kt/it.data.BYTES_PER_ELEMENT,(Ct+1)*kt/it.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Qe,0,0,Ct,it.width,it.height,1,De,Kt)}ie.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Qe,0,0,0,it.width,it.height,be.depth,De,it.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Qe,st,it.width,it.height,be.depth,0,it.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ye?ke&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Qe,0,0,0,it.width,it.height,be.depth,De,$e,it.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Qe,st,it.width,it.height,be.depth,0,De,$e,it.data)}else{Ye&&at&&n.texStorage2D(t.TEXTURE_2D,Xe,st,Ie[0].width,Ie[0].height);for(let Qe=0,_t=Ie.length;Qe<_t;Qe++)it=Ie[Qe],ie.format!==Pr?De!==null?Ye?ke&&n.compressedTexSubImage2D(t.TEXTURE_2D,Qe,0,0,it.width,it.height,De,it.data):n.compressedTexImage2D(t.TEXTURE_2D,Qe,st,it.width,it.height,0,it.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ye?ke&&n.texSubImage2D(t.TEXTURE_2D,Qe,0,0,it.width,it.height,De,$e,it.data):n.texImage2D(t.TEXTURE_2D,Qe,st,it.width,it.height,0,De,$e,it.data)}else if(ie.isDataArrayTexture)if(Ye){if(at&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Xe,st,be.width,be.height,be.depth),ke)if(ie.layerUpdates.size>0){const Qe=e5(be.width,be.height,ie.format,ie.type);for(const _t of ie.layerUpdates){const kt=be.data.subarray(_t*Qe/be.data.BYTES_PER_ELEMENT,(_t+1)*Qe/be.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,_t,be.width,be.height,1,De,$e,kt)}ie.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,be.width,be.height,be.depth,De,$e,be.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,st,be.width,be.height,be.depth,0,De,$e,be.data);else if(ie.isData3DTexture)Ye?(at&&n.texStorage3D(t.TEXTURE_3D,Xe,st,be.width,be.height,be.depth),ke&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,be.width,be.height,be.depth,De,$e,be.data)):n.texImage3D(t.TEXTURE_3D,0,st,be.width,be.height,be.depth,0,De,$e,be.data);else if(ie.isFramebufferTexture){if(at)if(Ye)n.texStorage2D(t.TEXTURE_2D,Xe,st,be.width,be.height);else{let Qe=be.width,_t=be.height;for(let kt=0;kt<Xe;kt++)n.texImage2D(t.TEXTURE_2D,kt,st,Qe,_t,0,De,$e,null),Qe>>=1,_t>>=1}}else if(Ie.length>0){if(Ye&&at){const Qe=ze(Ie[0]);n.texStorage2D(t.TEXTURE_2D,Xe,st,Qe.width,Qe.height)}for(let Qe=0,_t=Ie.length;Qe<_t;Qe++)it=Ie[Qe],Ye?ke&&n.texSubImage2D(t.TEXTURE_2D,Qe,0,0,De,$e,it):n.texImage2D(t.TEXTURE_2D,Qe,st,De,$e,it);ie.generateMipmaps=!1}else if(Ye){if(at){const Qe=ze(be);n.texStorage2D(t.TEXTURE_2D,Xe,st,Qe.width,Qe.height)}ke&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,De,$e,be)}else n.texImage2D(t.TEXTURE_2D,0,st,De,$e,be);g(ie)&&y(Me),F.__version=Ze.version,ie.onUpdate&&ie.onUpdate(ie)}fe.__version=ie.version}function W(fe,ie,ve){if(ie.image.length!==6)return;const Me=ue(fe,ie),Be=ie.source;n.bindTexture(t.TEXTURE_CUBE_MAP,fe.__webglTexture,t.TEXTURE0+ve);const Ze=r.get(Be);if(Be.version!==Ze.__version||Me===!0){n.activeTexture(t.TEXTURE0+ve);const F=er.getPrimaries(er.workingColorSpace),Z=ie.colorSpace===ss?null:er.getPrimaries(ie.colorSpace),q=ie.colorSpace===ss||F===Z?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ie.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ie.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,q);const xe=ie.isCompressedTexture||ie.image[0].isCompressedTexture,be=ie.image[0]&&ie.image[0].isDataTexture,De=[];for(let _t=0;_t<6;_t++)!xe&&!be?De[_t]=m(ie.image[_t],!0,i.maxCubemapSize):De[_t]=be?ie.image[_t].image:ie.image[_t],De[_t]=ge(ie,De[_t]);const $e=De[0],st=s.convert(ie.format,ie.colorSpace),it=s.convert(ie.type),Ie=_(ie.internalFormat,st,it,ie.colorSpace),Ye=ie.isVideoTexture!==!0,at=Ze.__version===void 0||Me===!0,ke=Be.dataReady;let Xe=T(ie,$e);se(t.TEXTURE_CUBE_MAP,ie);let Qe;if(xe){Ye&&at&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Xe,Ie,$e.width,$e.height);for(let _t=0;_t<6;_t++){Qe=De[_t].mipmaps;for(let kt=0;kt<Qe.length;kt++){const Ct=Qe[kt];ie.format!==Pr?st!==null?Ye?ke&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt,0,0,Ct.width,Ct.height,st,Ct.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt,Ie,Ct.width,Ct.height,0,Ct.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ye?ke&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt,0,0,Ct.width,Ct.height,st,it,Ct.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt,Ie,Ct.width,Ct.height,0,st,it,Ct.data)}}}else{if(Qe=ie.mipmaps,Ye&&at){Qe.length>0&&Xe++;const _t=ze(De[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Xe,Ie,_t.width,_t.height)}for(let _t=0;_t<6;_t++)if(be){Ye?ke&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,0,0,0,De[_t].width,De[_t].height,st,it,De[_t].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,0,Ie,De[_t].width,De[_t].height,0,st,it,De[_t].data);for(let kt=0;kt<Qe.length;kt++){const Kt=Qe[kt].image[_t].image;Ye?ke&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt+1,0,0,Kt.width,Kt.height,st,it,Kt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt+1,Ie,Kt.width,Kt.height,0,st,it,Kt.data)}}else{Ye?ke&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,0,0,0,st,it,De[_t]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,0,Ie,st,it,De[_t]);for(let kt=0;kt<Qe.length;kt++){const Ct=Qe[kt];Ye?ke&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt+1,0,0,st,it,Ct.image[_t]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+_t,kt+1,Ie,st,it,Ct.image[_t])}}}g(ie)&&y(t.TEXTURE_CUBE_MAP),Ze.__version=Be.version,ie.onUpdate&&ie.onUpdate(ie)}fe.__version=ie.version}function X(fe,ie,ve,Me,Be,Ze){const F=s.convert(ve.format,ve.colorSpace),Z=s.convert(ve.type),q=_(ve.internalFormat,F,Z,ve.colorSpace),xe=r.get(ie),be=r.get(ve);if(be.__renderTarget=ie,!xe.__hasExternalTextures){const De=Math.max(1,ie.width>>Ze),$e=Math.max(1,ie.height>>Ze);Be===t.TEXTURE_3D||Be===t.TEXTURE_2D_ARRAY?n.texImage3D(Be,Ze,q,De,$e,ie.depth,0,F,Z,null):n.texImage2D(Be,Ze,q,De,$e,0,F,Z,null)}n.bindFramebuffer(t.FRAMEBUFFER,fe),Ve(ie)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Me,Be,be.__webglTexture,0,Pe(ie)):(Be===t.TEXTURE_2D||Be>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Be<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Me,Be,be.__webglTexture,Ze),n.bindFramebuffer(t.FRAMEBUFFER,null)}function J(fe,ie,ve){if(t.bindRenderbuffer(t.RENDERBUFFER,fe),ie.depthBuffer){const Me=ie.depthTexture,Be=Me&&Me.isDepthTexture?Me.type:null,Ze=w(ie.stencilBuffer,Be),F=ie.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Z=Pe(ie);Ve(ie)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Z,Ze,ie.width,ie.height):ve?t.renderbufferStorageMultisample(t.RENDERBUFFER,Z,Ze,ie.width,ie.height):t.renderbufferStorage(t.RENDERBUFFER,Ze,ie.width,ie.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,F,t.RENDERBUFFER,fe)}else{const Me=ie.textures;for(let Be=0;Be<Me.length;Be++){const Ze=Me[Be],F=s.convert(Ze.format,Ze.colorSpace),Z=s.convert(Ze.type),q=_(Ze.internalFormat,F,Z,Ze.colorSpace),xe=Pe(ie);ve&&Ve(ie)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,xe,q,ie.width,ie.height):Ve(ie)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,xe,q,ie.width,ie.height):t.renderbufferStorage(t.RENDERBUFFER,q,ie.width,ie.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function oe(fe,ie){if(ie&&ie.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,fe),!(ie.depthTexture&&ie.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Me=r.get(ie.depthTexture);Me.__renderTarget=ie,(!Me.__webglTexture||ie.depthTexture.image.width!==ie.width||ie.depthTexture.image.height!==ie.height)&&(ie.depthTexture.image.width=ie.width,ie.depthTexture.image.height=ie.height,ie.depthTexture.needsUpdate=!0),z(ie.depthTexture,0);const Be=Me.__webglTexture,Ze=Pe(ie);if(ie.depthTexture.format===sf)Ve(ie)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Be,0,Ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Be,0);else if(ie.depthTexture.format===Hd)Ve(ie)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Be,0,Ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Be,0);else throw new Error("Unknown depthTexture format")}function Ee(fe){const ie=r.get(fe),ve=fe.isWebGLCubeRenderTarget===!0;if(ie.__boundDepthTexture!==fe.depthTexture){const Me=fe.depthTexture;if(ie.__depthDisposeCallback&&ie.__depthDisposeCallback(),Me){const Be=()=>{delete ie.__boundDepthTexture,delete ie.__depthDisposeCallback,Me.removeEventListener("dispose",Be)};Me.addEventListener("dispose",Be),ie.__depthDisposeCallback=Be}ie.__boundDepthTexture=Me}if(fe.depthTexture&&!ie.__autoAllocateDepthBuffer){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");oe(ie.__webglFramebuffer,fe)}else if(ve){ie.__webglDepthbuffer=[];for(let Me=0;Me<6;Me++)if(n.bindFramebuffer(t.FRAMEBUFFER,ie.__webglFramebuffer[Me]),ie.__webglDepthbuffer[Me]===void 0)ie.__webglDepthbuffer[Me]=t.createRenderbuffer(),J(ie.__webglDepthbuffer[Me],fe,!1);else{const Be=fe.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ze=ie.__webglDepthbuffer[Me];t.bindRenderbuffer(t.RENDERBUFFER,Ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,Be,t.RENDERBUFFER,Ze)}}else if(n.bindFramebuffer(t.FRAMEBUFFER,ie.__webglFramebuffer),ie.__webglDepthbuffer===void 0)ie.__webglDepthbuffer=t.createRenderbuffer(),J(ie.__webglDepthbuffer,fe,!1);else{const Me=fe.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Be=ie.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Be),t.framebufferRenderbuffer(t.FRAMEBUFFER,Me,t.RENDERBUFFER,Be)}n.bindFramebuffer(t.FRAMEBUFFER,null)}function me(fe,ie,ve){const Me=r.get(fe);ie!==void 0&&X(Me.__webglFramebuffer,fe,fe.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),ve!==void 0&&Ee(fe)}function Te(fe){const ie=fe.texture,ve=r.get(fe),Me=r.get(ie);fe.addEventListener("dispose",C);const Be=fe.textures,Ze=fe.isWebGLCubeRenderTarget===!0,F=Be.length>1;if(F||(Me.__webglTexture===void 0&&(Me.__webglTexture=t.createTexture()),Me.__version=ie.version,o.memory.textures++),Ze){ve.__webglFramebuffer=[];for(let Z=0;Z<6;Z++)if(ie.mipmaps&&ie.mipmaps.length>0){ve.__webglFramebuffer[Z]=[];for(let q=0;q<ie.mipmaps.length;q++)ve.__webglFramebuffer[Z][q]=t.createFramebuffer()}else ve.__webglFramebuffer[Z]=t.createFramebuffer()}else{if(ie.mipmaps&&ie.mipmaps.length>0){ve.__webglFramebuffer=[];for(let Z=0;Z<ie.mipmaps.length;Z++)ve.__webglFramebuffer[Z]=t.createFramebuffer()}else ve.__webglFramebuffer=t.createFramebuffer();if(F)for(let Z=0,q=Be.length;Z<q;Z++){const xe=r.get(Be[Z]);xe.__webglTexture===void 0&&(xe.__webglTexture=t.createTexture(),o.memory.textures++)}if(fe.samples>0&&Ve(fe)===!1){ve.__webglMultisampledFramebuffer=t.createFramebuffer(),ve.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,ve.__webglMultisampledFramebuffer);for(let Z=0;Z<Be.length;Z++){const q=Be[Z];ve.__webglColorRenderbuffer[Z]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,ve.__webglColorRenderbuffer[Z]);const xe=s.convert(q.format,q.colorSpace),be=s.convert(q.type),De=_(q.internalFormat,xe,be,q.colorSpace,fe.isXRRenderTarget===!0),$e=Pe(fe);t.renderbufferStorageMultisample(t.RENDERBUFFER,$e,De,fe.width,fe.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Z,t.RENDERBUFFER,ve.__webglColorRenderbuffer[Z])}t.bindRenderbuffer(t.RENDERBUFFER,null),fe.depthBuffer&&(ve.__webglDepthRenderbuffer=t.createRenderbuffer(),J(ve.__webglDepthRenderbuffer,fe,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ze){n.bindTexture(t.TEXTURE_CUBE_MAP,Me.__webglTexture),se(t.TEXTURE_CUBE_MAP,ie);for(let Z=0;Z<6;Z++)if(ie.mipmaps&&ie.mipmaps.length>0)for(let q=0;q<ie.mipmaps.length;q++)X(ve.__webglFramebuffer[Z][q],fe,ie,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Z,q);else X(ve.__webglFramebuffer[Z],fe,ie,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Z,0);g(ie)&&y(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(F){for(let Z=0,q=Be.length;Z<q;Z++){const xe=Be[Z],be=r.get(xe);n.bindTexture(t.TEXTURE_2D,be.__webglTexture),se(t.TEXTURE_2D,xe),X(ve.__webglFramebuffer,fe,xe,t.COLOR_ATTACHMENT0+Z,t.TEXTURE_2D,0),g(xe)&&y(t.TEXTURE_2D)}n.unbindTexture()}else{let Z=t.TEXTURE_2D;if((fe.isWebGL3DRenderTarget||fe.isWebGLArrayRenderTarget)&&(Z=fe.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Z,Me.__webglTexture),se(Z,ie),ie.mipmaps&&ie.mipmaps.length>0)for(let q=0;q<ie.mipmaps.length;q++)X(ve.__webglFramebuffer[q],fe,ie,t.COLOR_ATTACHMENT0,Z,q);else X(ve.__webglFramebuffer,fe,ie,t.COLOR_ATTACHMENT0,Z,0);g(ie)&&y(Z),n.unbindTexture()}fe.depthBuffer&&Ee(fe)}function _e(fe){const ie=fe.textures;for(let ve=0,Me=ie.length;ve<Me;ve++){const Be=ie[ve];if(g(Be)){const Ze=x(fe),F=r.get(Be).__webglTexture;n.bindTexture(Ze,F),y(Ze),n.unbindTexture()}}}const Re=[],ae=[];function Ce(fe){if(fe.samples>0){if(Ve(fe)===!1){const ie=fe.textures,ve=fe.width,Me=fe.height;let Be=t.COLOR_BUFFER_BIT;const Ze=fe.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,F=r.get(fe),Z=ie.length>1;if(Z)for(let q=0;q<ie.length;q++)n.bindFramebuffer(t.FRAMEBUFFER,F.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+q,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,F.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+q,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,F.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,F.__webglFramebuffer);for(let q=0;q<ie.length;q++){if(fe.resolveDepthBuffer&&(fe.depthBuffer&&(Be|=t.DEPTH_BUFFER_BIT),fe.stencilBuffer&&fe.resolveStencilBuffer&&(Be|=t.STENCIL_BUFFER_BIT)),Z){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,F.__webglColorRenderbuffer[q]);const xe=r.get(ie[q]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,xe,0)}t.blitFramebuffer(0,0,ve,Me,0,0,ve,Me,Be,t.NEAREST),l===!0&&(Re.length=0,ae.length=0,Re.push(t.COLOR_ATTACHMENT0+q),fe.depthBuffer&&fe.resolveDepthBuffer===!1&&(Re.push(Ze),ae.push(Ze),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,ae)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Re))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Z)for(let q=0;q<ie.length;q++){n.bindFramebuffer(t.FRAMEBUFFER,F.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+q,t.RENDERBUFFER,F.__webglColorRenderbuffer[q]);const xe=r.get(ie[q]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,F.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+q,t.TEXTURE_2D,xe,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,F.__webglMultisampledFramebuffer)}else if(fe.depthBuffer&&fe.resolveDepthBuffer===!1&&l){const ie=fe.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[ie])}}}function Pe(fe){return Math.min(i.maxSamples,fe.samples)}function Ve(fe){const ie=r.get(fe);return fe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ie.__useRenderToTexture!==!1}function ye(fe){const ie=o.render.frame;u.get(fe)!==ie&&(u.set(fe,ie),fe.update())}function ge(fe,ie){const ve=fe.colorSpace,Me=fe.format,Be=fe.type;return fe.isCompressedTexture===!0||fe.isVideoTexture===!0||ve!==as&&ve!==ss&&(er.getTransfer(ve)===Dr?(Me!==Pr||Be!==Rs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ve)),ie}function ze(fe){return typeof HTMLImageElement<"u"&&fe instanceof HTMLImageElement?(c.width=fe.naturalWidth||fe.width,c.height=fe.naturalHeight||fe.height):typeof VideoFrame<"u"&&fe instanceof VideoFrame?(c.width=fe.displayWidth,c.height=fe.displayHeight):(c.width=fe.width,c.height=fe.height),c}this.allocateTextureUnit=L,this.resetTextureUnits=k,this.setTexture2D=z,this.setTexture2DArray=O,this.setTexture3D=K,this.setTextureCube=V,this.rebindTextures=me,this.setupRenderTarget=Te,this.updateRenderTargetMipmap=_e,this.updateMultisampleRenderTarget=Ce,this.setupDepthRenderbuffer=Ee,this.setupFrameBufferTexture=X,this.useMultisampledRTT=Ve}function wH(t,e){function n(r,i=ss){let s;const o=er.getTransfer(i);if(r===Rs)return t.UNSIGNED_BYTE;if(r===vb)return t.UNSIGNED_SHORT_4_4_4_4;if(r===xb)return t.UNSIGNED_SHORT_5_5_5_1;if(r===l6)return t.UNSIGNED_INT_5_9_9_9_REV;if(r===mm)return t.BYTE;if(r===hy)return t.SHORT;if(r===df)return t.UNSIGNED_SHORT;if(r===rf)return t.INT;if(r===io)return t.UNSIGNED_INT;if(r===pr)return t.FLOAT;if(r===ti)return t.HALF_FLOAT;if(r===c6)return t.ALPHA;if(r===u6)return t.RGB;if(r===Pr)return t.RGBA;if(r===f6)return t.LUMINANCE;if(r===d6)return t.LUMINANCE_ALPHA;if(r===sf)return t.DEPTH_COMPONENT;if(r===Hd)return t.DEPTH_STENCIL;if(r===Yc)return t.RED;if(r===Dm)return t.RED_INTEGER;if(r===_b)return t.RG;if(r===Nm)return t.RG_INTEGER;if(r===hf)return t.RGBA_INTEGER;if(r===o1||r===a1||r===l1||r===c1)if(o===Dr)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===o1)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===a1)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===l1)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===c1)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===o1)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===a1)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===l1)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===c1)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===N3||r===O3||r===F3||r===U3)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===N3)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===O3)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===F3)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===U3)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===B3||r===z3||r===H3)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===B3||r===z3)return o===Dr?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===H3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===G3||r===j3||r===V3||r===W3||r===$3||r===X3||r===q3||r===Y3||r===K3||r===Z3||r===Q3||r===J3||r===e_||r===t_)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===G3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===j3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===V3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===W3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===$3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===X3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===q3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===Y3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===K3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===Z3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===Q3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===J3)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===e_)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===t_)return o===Dr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===u1||r===n_||r===r_)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===u1)return o===Dr?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===n_)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===r_)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===h6||r===i_||r===s_||r===o_)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===u1)return s.COMPRESSED_RED_RGTC1_EXT;if(r===i_)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===s_)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===o_)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===zd?t.UNSIGNED_INT_24_8:t[r]!==void 0?t[r]:null}return{convert:n}}const ele={type:"move"};class s4{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new es,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new es,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new $,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new $),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new es,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new $,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new $),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const m of e.hand.values()){const g=n.getJointPose(m,r),y=this._getHandJoint(c,m);g!==null&&(y.matrix.fromArray(g.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=g.radius),y.visible=g!==null}const u=c.joints["index-finger-tip"],f=c.joints["thumb-tip"],d=u.position.distanceTo(f.position),h=.02,p=.005;c.inputState.pinching&&d>h+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=h-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=n.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(ele)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new es;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}const tle=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,nle=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class rle{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,r){if(this.texture===null){const i=new tr,s=e.properties.get(i);s.__webglTexture=n.texture,(n.depthNear!=r.depthNear||n.depthFar!=r.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,r=new yr({vertexShader:tle,fragmentShader:nle,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new ln(new Ps(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class ile extends uc{constructor(e,n){super();const r=this;let i=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,f=null,d=null,h=null,p=null;const m=new rle,g=n.getContextAttributes();let y=null,x=null;const _=[],w=[],T=new Ke;let S=null;const C=new Ar;C.viewport=new Hn;const A=new Ar;A.viewport=new Hn;const R=[C,A],M=new oH;let D=null,k=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(te){let W=_[te];return W===void 0&&(W=new s4,_[te]=W),W.getTargetRaySpace()},this.getControllerGrip=function(te){let W=_[te];return W===void 0&&(W=new s4,_[te]=W),W.getGripSpace()},this.getHand=function(te){let W=_[te];return W===void 0&&(W=new s4,_[te]=W),W.getHandSpace()};function L(te){const W=w.indexOf(te.inputSource);if(W===-1)return;const X=_[W];X!==void 0&&(X.update(te.inputSource,te.frame,c||o),X.dispatchEvent({type:te.type,data:te.inputSource}))}function N(){i.removeEventListener("select",L),i.removeEventListener("selectstart",L),i.removeEventListener("selectend",L),i.removeEventListener("squeeze",L),i.removeEventListener("squeezestart",L),i.removeEventListener("squeezeend",L),i.removeEventListener("end",N),i.removeEventListener("inputsourceschange",z);for(let te=0;te<_.length;te++){const W=w[te];W!==null&&(w[te]=null,_[te].disconnect(W))}D=null,k=null,m.reset(),e.setRenderTarget(y),h=null,d=null,f=null,i=null,x=null,ue.stop(),r.isPresenting=!1,e.setPixelRatio(S),e.setSize(T.width,T.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(te){s=te,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(te){a=te,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(te){c=te},this.getBaseLayer=function(){return d!==null?d:h},this.getBinding=function(){return f},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(te){if(i=te,i!==null){if(y=e.getRenderTarget(),i.addEventListener("select",L),i.addEventListener("selectstart",L),i.addEventListener("selectend",L),i.addEventListener("squeeze",L),i.addEventListener("squeezestart",L),i.addEventListener("squeezeend",L),i.addEventListener("end",N),i.addEventListener("inputsourceschange",z),g.xrCompatible!==!0&&await n.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(T),i.renderState.layers===void 0){const W={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};h=new XRWebGLLayer(i,n,W),i.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),x=new fr(h.framebufferWidth,h.framebufferHeight,{format:Pr,type:Rs,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let W=null,X=null,J=null;g.depth&&(J=g.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,W=g.stencil?Hd:sf,X=g.stencil?zd:io);const oe={colorFormat:n.RGBA8,depthFormat:J,scaleFactor:s};f=new XRWebGLBinding(i,n),d=f.createProjectionLayer(oe),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),x=new fr(d.textureWidth,d.textureHeight,{format:Pr,type:Rs,depthTexture:new Bm(d.textureWidth,d.textureHeight,X,void 0,void 0,void 0,void 0,void 0,void 0,W),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1})}x.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await i.requestReferenceSpace(a),ue.setContext(i),ue.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};function z(te){for(let W=0;W<te.removed.length;W++){const X=te.removed[W],J=w.indexOf(X);J>=0&&(w[J]=null,_[J].disconnect(X))}for(let W=0;W<te.added.length;W++){const X=te.added[W];let J=w.indexOf(X);if(J===-1){for(let Ee=0;Ee<_.length;Ee++)if(Ee>=w.length){w.push(X),J=Ee;break}else if(w[Ee]===null){w[Ee]=X,J=Ee;break}if(J===-1)break}const oe=_[J];oe&&oe.connect(X)}}const O=new $,K=new $;function V(te,W,X){O.setFromMatrixPosition(W.matrixWorld),K.setFromMatrixPosition(X.matrixWorld);const J=O.distanceTo(K),oe=W.projectionMatrix.elements,Ee=X.projectionMatrix.elements,me=oe[14]/(oe[10]-1),Te=oe[14]/(oe[10]+1),_e=(oe[9]+1)/oe[5],Re=(oe[9]-1)/oe[5],ae=(oe[8]-1)/oe[0],Ce=(Ee[8]+1)/Ee[0],Pe=me*ae,Ve=me*Ce,ye=J/(-ae+Ce),ge=ye*-ae;if(W.matrixWorld.decompose(te.position,te.quaternion,te.scale),te.translateX(ge),te.translateZ(ye),te.matrixWorld.compose(te.position,te.quaternion,te.scale),te.matrixWorldInverse.copy(te.matrixWorld).invert(),oe[10]===-1)te.projectionMatrix.copy(W.projectionMatrix),te.projectionMatrixInverse.copy(W.projectionMatrixInverse);else{const ze=me+ye,fe=Te+ye,ie=Pe-ge,ve=Ve+(J-ge),Me=_e*Te/fe*ze,Be=Re*Te/fe*ze;te.projectionMatrix.makePerspective(ie,ve,Me,Be,ze,fe),te.projectionMatrixInverse.copy(te.projectionMatrix).invert()}}function ne(te,W){W===null?te.matrixWorld.copy(te.matrix):te.matrixWorld.multiplyMatrices(W.matrixWorld,te.matrix),te.matrixWorldInverse.copy(te.matrixWorld).invert()}this.updateCamera=function(te){if(i===null)return;let W=te.near,X=te.far;m.texture!==null&&(m.depthNear>0&&(W=m.depthNear),m.depthFar>0&&(X=m.depthFar)),M.near=A.near=C.near=W,M.far=A.far=C.far=X,(D!==M.near||k!==M.far)&&(i.updateRenderState({depthNear:M.near,depthFar:M.far}),D=M.near,k=M.far),C.layers.mask=te.layers.mask|2,A.layers.mask=te.layers.mask|4,M.layers.mask=C.layers.mask|A.layers.mask;const J=te.parent,oe=M.cameras;ne(M,J);for(let Ee=0;Ee<oe.length;Ee++)ne(oe[Ee],J);oe.length===2?V(M,C,A):M.projectionMatrix.copy(C.projectionMatrix),re(te,M,J)};function re(te,W,X){X===null?te.matrix.copy(W.matrixWorld):(te.matrix.copy(X.matrixWorld),te.matrix.invert(),te.matrix.multiply(W.matrixWorld)),te.matrix.decompose(te.position,te.quaternion,te.scale),te.updateMatrixWorld(!0),te.projectionMatrix.copy(W.projectionMatrix),te.projectionMatrixInverse.copy(W.projectionMatrixInverse),te.isPerspectiveCamera&&(te.fov=gm*2*Math.atan(1/te.projectionMatrix.elements[5]),te.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(d===null&&h===null))return l},this.setFoveation=function(te){l=te,d!==null&&(d.fixedFoveation=te),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=te)},this.hasDepthSensing=function(){return m.texture!==null},this.getDepthSensingMesh=function(){return m.getMesh(M)};let P=null;function se(te,W){if(u=W.getViewerPose(c||o),p=W,u!==null){const X=u.views;h!==null&&(e.setRenderTargetFramebuffer(x,h.framebuffer),e.setRenderTarget(x));let J=!1;X.length!==M.cameras.length&&(M.cameras.length=0,J=!0);for(let Ee=0;Ee<X.length;Ee++){const me=X[Ee];let Te=null;if(h!==null)Te=h.getViewport(me);else{const Re=f.getViewSubImage(d,me);Te=Re.viewport,Ee===0&&(e.setRenderTargetTextures(x,Re.colorTexture,d.ignoreDepthValues?void 0:Re.depthStencilTexture),e.setRenderTarget(x))}let _e=R[Ee];_e===void 0&&(_e=new Ar,_e.layers.enable(Ee),_e.viewport=new Hn,R[Ee]=_e),_e.matrix.fromArray(me.transform.matrix),_e.matrix.decompose(_e.position,_e.quaternion,_e.scale),_e.projectionMatrix.fromArray(me.projectionMatrix),_e.projectionMatrixInverse.copy(_e.projectionMatrix).invert(),_e.viewport.set(Te.x,Te.y,Te.width,Te.height),Ee===0&&(M.matrix.copy(_e.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),J===!0&&M.cameras.push(_e)}const oe=i.enabledFeatures;if(oe&&oe.includes("depth-sensing")){const Ee=f.getDepthInformation(X[0]);Ee&&Ee.isValid&&Ee.texture&&m.init(e,Ee,i.renderState)}}for(let X=0;X<_.length;X++){const J=w[X],oe=_[X];J!==null&&oe!==void 0&&oe.update(J,W,c||o)}P&&P(te,W),W.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:W}),p=null}const ue=new vH;ue.setAnimationLoop(se),this.setAnimationLoop=function(te){P=te},this.dispose=function(){}}}const nd=new xr,sle=new et;function ole(t,e){function n(g,y){g.matrixAutoUpdate===!0&&g.updateMatrix(),y.value.copy(g.matrix)}function r(g,y){y.color.getRGB(g.fogColor.value,Oz(t)),y.isFog?(g.fogNear.value=y.near,g.fogFar.value=y.far):y.isFogExp2&&(g.fogDensity.value=y.density)}function i(g,y,x,_,w){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(g,y):y.isMeshToonMaterial?(s(g,y),f(g,y)):y.isMeshPhongMaterial?(s(g,y),u(g,y)):y.isMeshStandardMaterial?(s(g,y),d(g,y),y.isMeshPhysicalMaterial&&h(g,y,w)):y.isMeshMatcapMaterial?(s(g,y),p(g,y)):y.isMeshDepthMaterial?s(g,y):y.isMeshDistanceMaterial?(s(g,y),m(g,y)):y.isMeshNormalMaterial?s(g,y):y.isLineBasicMaterial?(o(g,y),y.isLineDashedMaterial&&a(g,y)):y.isPointsMaterial?l(g,y,x,_):y.isSpriteMaterial?c(g,y):y.isShadowMaterial?(g.color.value.copy(y.color),g.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(g,y){g.opacity.value=y.opacity,y.color&&g.diffuse.value.copy(y.color),y.emissive&&g.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(g.map.value=y.map,n(y.map,g.mapTransform)),y.alphaMap&&(g.alphaMap.value=y.alphaMap,n(y.alphaMap,g.alphaMapTransform)),y.bumpMap&&(g.bumpMap.value=y.bumpMap,n(y.bumpMap,g.bumpMapTransform),g.bumpScale.value=y.bumpScale,y.side===zi&&(g.bumpScale.value*=-1)),y.normalMap&&(g.normalMap.value=y.normalMap,n(y.normalMap,g.normalMapTransform),g.normalScale.value.copy(y.normalScale),y.side===zi&&g.normalScale.value.negate()),y.displacementMap&&(g.displacementMap.value=y.displacementMap,n(y.displacementMap,g.displacementMapTransform),g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias),y.emissiveMap&&(g.emissiveMap.value=y.emissiveMap,n(y.emissiveMap,g.emissiveMapTransform)),y.specularMap&&(g.specularMap.value=y.specularMap,n(y.specularMap,g.specularMapTransform)),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);const x=e.get(y),_=x.envMap,w=x.envMapRotation;_&&(g.envMap.value=_,nd.copy(w),nd.x*=-1,nd.y*=-1,nd.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(nd.y*=-1,nd.z*=-1),g.envMapRotation.value.setFromMatrix4(sle.makeRotationFromEuler(nd)),g.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=y.reflectivity,g.ior.value=y.ior,g.refractionRatio.value=y.refractionRatio),y.lightMap&&(g.lightMap.value=y.lightMap,g.lightMapIntensity.value=y.lightMapIntensity,n(y.lightMap,g.lightMapTransform)),y.aoMap&&(g.aoMap.value=y.aoMap,g.aoMapIntensity.value=y.aoMapIntensity,n(y.aoMap,g.aoMapTransform))}function o(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,y.map&&(g.map.value=y.map,n(y.map,g.mapTransform))}function a(g,y){g.dashSize.value=y.dashSize,g.totalSize.value=y.dashSize+y.gapSize,g.scale.value=y.scale}function l(g,y,x,_){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.size.value=y.size*x,g.scale.value=_*.5,y.map&&(g.map.value=y.map,n(y.map,g.uvTransform)),y.alphaMap&&(g.alphaMap.value=y.alphaMap,n(y.alphaMap,g.alphaMapTransform)),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest)}function c(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.rotation.value=y.rotation,y.map&&(g.map.value=y.map,n(y.map,g.mapTransform)),y.alphaMap&&(g.alphaMap.value=y.alphaMap,n(y.alphaMap,g.alphaMapTransform)),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest)}function u(g,y){g.specular.value.copy(y.specular),g.shininess.value=Math.max(y.shininess,1e-4)}function f(g,y){y.gradientMap&&(g.gradientMap.value=y.gradientMap)}function d(g,y){g.metalness.value=y.metalness,y.metalnessMap&&(g.metalnessMap.value=y.metalnessMap,n(y.metalnessMap,g.metalnessMapTransform)),g.roughness.value=y.roughness,y.roughnessMap&&(g.roughnessMap.value=y.roughnessMap,n(y.roughnessMap,g.roughnessMapTransform)),y.envMap&&(g.envMapIntensity.value=y.envMapIntensity)}function h(g,y,x){g.ior.value=y.ior,y.sheen>0&&(g.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),g.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(g.sheenColorMap.value=y.sheenColorMap,n(y.sheenColorMap,g.sheenColorMapTransform)),y.sheenRoughnessMap&&(g.sheenRoughnessMap.value=y.sheenRoughnessMap,n(y.sheenRoughnessMap,g.sheenRoughnessMapTransform))),y.clearcoat>0&&(g.clearcoat.value=y.clearcoat,g.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(g.clearcoatMap.value=y.clearcoatMap,n(y.clearcoatMap,g.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,n(y.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(g.clearcoatNormalMap.value=y.clearcoatNormalMap,n(y.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===zi&&g.clearcoatNormalScale.value.negate())),y.dispersion>0&&(g.dispersion.value=y.dispersion),y.iridescence>0&&(g.iridescence.value=y.iridescence,g.iridescenceIOR.value=y.iridescenceIOR,g.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(g.iridescenceMap.value=y.iridescenceMap,n(y.iridescenceMap,g.iridescenceMapTransform)),y.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=y.iridescenceThicknessMap,n(y.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),y.transmission>0&&(g.transmission.value=y.transmission,g.transmissionSamplerMap.value=x.texture,g.transmissionSamplerSize.value.set(x.width,x.height),y.transmissionMap&&(g.transmissionMap.value=y.transmissionMap,n(y.transmissionMap,g.transmissionMapTransform)),g.thickness.value=y.thickness,y.thicknessMap&&(g.thicknessMap.value=y.thicknessMap,n(y.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=y.attenuationDistance,g.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(g.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(g.anisotropyMap.value=y.anisotropyMap,n(y.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=y.specularIntensity,g.specularColor.value.copy(y.specularColor),y.specularColorMap&&(g.specularColorMap.value=y.specularColorMap,n(y.specularColorMap,g.specularColorMapTransform)),y.specularIntensityMap&&(g.specularIntensityMap.value=y.specularIntensityMap,n(y.specularIntensityMap,g.specularIntensityMapTransform))}function p(g,y){y.matcap&&(g.matcap.value=y.matcap)}function m(g,y){const x=e.get(y).light;g.referencePosition.value.setFromMatrixPosition(x.matrixWorld),g.nearDistance.value=x.shadow.camera.near,g.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function ale(t,e,n,r){let i={},s={},o=[];const a=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(x,_){const w=_.program;r.uniformBlockBinding(x,w)}function c(x,_){let w=i[x.id];w===void 0&&(p(x),w=u(x),i[x.id]=w,x.addEventListener("dispose",g));const T=_.program;r.updateUBOMapping(x,T);const S=e.render.frame;s[x.id]!==S&&(d(x),s[x.id]=S)}function u(x){const _=f();x.__bindingPointIndex=_;const w=t.createBuffer(),T=x.__size,S=x.usage;return t.bindBuffer(t.UNIFORM_BUFFER,w),t.bufferData(t.UNIFORM_BUFFER,T,S),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,_,w),w}function f(){for(let x=0;x<a;x++)if(o.indexOf(x)===-1)return o.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(x){const _=i[x.id],w=x.uniforms,T=x.__cache;t.bindBuffer(t.UNIFORM_BUFFER,_);for(let S=0,C=w.length;S<C;S++){const A=Array.isArray(w[S])?w[S]:[w[S]];for(let R=0,M=A.length;R<M;R++){const D=A[R];if(h(D,S,R,T)===!0){const k=D.__offset,L=Array.isArray(D.value)?D.value:[D.value];let N=0;for(let z=0;z<L.length;z++){const O=L[z],K=m(O);typeof O=="number"||typeof O=="boolean"?(D.__data[0]=O,t.bufferSubData(t.UNIFORM_BUFFER,k+N,D.__data)):O.isMatrix3?(D.__data[0]=O.elements[0],D.__data[1]=O.elements[1],D.__data[2]=O.elements[2],D.__data[3]=0,D.__data[4]=O.elements[3],D.__data[5]=O.elements[4],D.__data[6]=O.elements[5],D.__data[7]=0,D.__data[8]=O.elements[6],D.__data[9]=O.elements[7],D.__data[10]=O.elements[8],D.__data[11]=0):(O.toArray(D.__data,N),N+=K.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,k,D.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function h(x,_,w,T){const S=x.value,C=_+"_"+w;if(T[C]===void 0)return typeof S=="number"||typeof S=="boolean"?T[C]=S:T[C]=S.clone(),!0;{const A=T[C];if(typeof S=="number"||typeof S=="boolean"){if(A!==S)return T[C]=S,!0}else if(A.equals(S)===!1)return A.copy(S),!0}return!1}function p(x){const _=x.uniforms;let w=0;const T=16;for(let C=0,A=_.length;C<A;C++){const R=Array.isArray(_[C])?_[C]:[_[C]];for(let M=0,D=R.length;M<D;M++){const k=R[M],L=Array.isArray(k.value)?k.value:[k.value];for(let N=0,z=L.length;N<z;N++){const O=L[N],K=m(O),V=w%T,ne=V%K.boundary,re=V+ne;w+=ne,re!==0&&T-re<K.storage&&(w+=T-re),k.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),k.__offset=w,w+=K.storage}}}const S=w%T;return S>0&&(w+=T-S),x.__size=w,x.__cache={},this}function m(x){const _={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(_.boundary=4,_.storage=4):x.isVector2?(_.boundary=8,_.storage=8):x.isVector3||x.isColor?(_.boundary=16,_.storage=12):x.isVector4?(_.boundary=16,_.storage=16):x.isMatrix3?(_.boundary=48,_.storage=48):x.isMatrix4?(_.boundary=64,_.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),_}function g(x){const _=x.target;_.removeEventListener("dispose",g);const w=o.indexOf(_.__bindingPointIndex);o.splice(w,1),t.deleteBuffer(i[_.id]),delete i[_.id],delete s[_.id]}function y(){for(const x in i)t.deleteBuffer(i[x]);o=[],i={},s={}}return{bind:l,update:c,dispose:y}}class Yb{constructor(e={}){const{canvas:n=kz(),context:r=null,depth:i=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let h;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");h=r.getContextAttributes().alpha}else h=o;const p=new Uint32Array(4),m=new Int32Array(4);let g=null,y=null;const x=[],_=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Er,this.toneMapping=Xa,this.toneMappingExposure=1;const w=this;let T=!1,S=0,C=0,A=null,R=-1,M=null;const D=new Hn,k=new Hn;let L=null;const N=new wt(0);let z=0,O=n.width,K=n.height,V=1,ne=null,re=null;const P=new Hn(0,0,O,K),se=new Hn(0,0,O,K);let ue=!1;const te=new th;let W=!1,X=!1;const J=new et,oe=new et,Ee=new $,me=new Hn,Te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let _e=!1;function Re(){return A===null?V:1}let ae=r;function Ce(de,Le){return n.getContext(de,Le)}try{const de={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:f};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${wl}`),n.addEventListener("webglcontextlost",_t,!1),n.addEventListener("webglcontextrestored",kt,!1),n.addEventListener("webglcontextcreationerror",Ct,!1),ae===null){const Le="webgl2";if(ae=Ce(Le,de),ae===null)throw Ce(Le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(de){throw console.error("THREE.WebGLRenderer: "+de.message),de}let Pe,Ve,ye,ge,ze,fe,ie,ve,Me,Be,Ze,F,Z,q,xe,be,De,$e,st,it,Ie,Ye,at,ke;function Xe(){Pe=new voe(ae),Pe.init(),Ye=new wH(ae,Pe),Ve=new doe(ae,Pe,e,Ye),ye=new Qae(ae,Pe),Ve.reverseDepthBuffer&&d&&ye.buffers.depth.setReversed(!0),ge=new boe(ae),ze=new Bae,fe=new Jae(ae,Pe,ye,ze,Ve,Ye,ge),ie=new poe(w),ve=new yoe(w),Me=new Cre(ae),at=new uoe(ae,Me),Be=new xoe(ae,Me,ge,at),Ze=new woe(ae,Be,Me,ge),st=new Eoe(ae,Ve,fe),be=new hoe(ze),F=new Uae(w,ie,ve,Pe,Ve,at,be),Z=new ole(w,ze),q=new Hae,xe=new Xae(Pe),$e=new coe(w,ie,ve,ye,Ze,h,l),De=new Kae(w,Ze,Ve),ke=new ale(ae,ge,Ve,ye),it=new foe(ae,Pe,ge),Ie=new _oe(ae,Pe,ge),ge.programs=F.programs,w.capabilities=Ve,w.extensions=Pe,w.properties=ze,w.renderLists=q,w.shadowMap=De,w.state=ye,w.info=ge}Xe();const Qe=new ile(w,ae);this.xr=Qe,this.getContext=function(){return ae},this.getContextAttributes=function(){return ae.getContextAttributes()},this.forceContextLoss=function(){const de=Pe.get("WEBGL_lose_context");de&&de.loseContext()},this.forceContextRestore=function(){const de=Pe.get("WEBGL_lose_context");de&&de.restoreContext()},this.getPixelRatio=function(){return V},this.setPixelRatio=function(de){de!==void 0&&(V=de,this.setSize(O,K,!1))},this.getSize=function(de){return de.set(O,K)},this.setSize=function(de,Le,Ue=!0){if(Qe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}O=de,K=Le,n.width=Math.floor(de*V),n.height=Math.floor(Le*V),Ue===!0&&(n.style.width=de+"px",n.style.height=Le+"px"),this.setViewport(0,0,de,Le)},this.getDrawingBufferSize=function(de){return de.set(O*V,K*V).floor()},this.setDrawingBufferSize=function(de,Le,Ue){O=de,K=Le,V=Ue,n.width=Math.floor(de*Ue),n.height=Math.floor(Le*Ue),this.setViewport(0,0,de,Le)},this.getCurrentViewport=function(de){return de.copy(D)},this.getViewport=function(de){return de.copy(P)},this.setViewport=function(de,Le,Ue,He){de.isVector4?P.set(de.x,de.y,de.z,de.w):P.set(de,Le,Ue,He),ye.viewport(D.copy(P).multiplyScalar(V).round())},this.getScissor=function(de){return de.copy(se)},this.setScissor=function(de,Le,Ue,He){de.isVector4?se.set(de.x,de.y,de.z,de.w):se.set(de,Le,Ue,He),ye.scissor(k.copy(se).multiplyScalar(V).round())},this.getScissorTest=function(){return ue},this.setScissorTest=function(de){ye.setScissorTest(ue=de)},this.setOpaqueSort=function(de){ne=de},this.setTransparentSort=function(de){re=de},this.getClearColor=function(de){return de.copy($e.getClearColor())},this.setClearColor=function(){$e.setClearColor.apply($e,arguments)},this.getClearAlpha=function(){return $e.getClearAlpha()},this.setClearAlpha=function(){$e.setClearAlpha.apply($e,arguments)},this.clear=function(de=!0,Le=!0,Ue=!0){let He=0;if(de){let Se=!1;if(A!==null){const Tt=A.texture.format;Se=Tt===hf||Tt===Nm||Tt===Dm}if(Se){const Tt=A.texture.type,xt=Tt===Rs||Tt===io||Tt===df||Tt===zd||Tt===vb||Tt===xb,bt=$e.getClearColor(),Pt=$e.getClearAlpha(),Bt=bt.r,Xt=bt.g,Ot=bt.b;xt?(p[0]=Bt,p[1]=Xt,p[2]=Ot,p[3]=Pt,ae.clearBufferuiv(ae.COLOR,0,p)):(m[0]=Bt,m[1]=Xt,m[2]=Ot,m[3]=Pt,ae.clearBufferiv(ae.COLOR,0,m))}else He|=ae.COLOR_BUFFER_BIT}Le&&(He|=ae.DEPTH_BUFFER_BIT),Ue&&(He|=ae.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ae.clear(He)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",_t,!1),n.removeEventListener("webglcontextrestored",kt,!1),n.removeEventListener("webglcontextcreationerror",Ct,!1),$e.dispose(),q.dispose(),xe.dispose(),ze.dispose(),ie.dispose(),ve.dispose(),Ze.dispose(),at.dispose(),ke.dispose(),F.dispose(),Qe.dispose(),Qe.removeEventListener("sessionstart",Cr),Qe.removeEventListener("sessionend",wi),zr.stop()};function _t(de){de.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function kt(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const de=ge.autoReset,Le=De.enabled,Ue=De.autoUpdate,He=De.needsUpdate,Se=De.type;Xe(),ge.autoReset=de,De.enabled=Le,De.autoUpdate=Ue,De.needsUpdate=He,De.type=Se}function Ct(de){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",de.statusMessage)}function Kt(de){const Le=de.target;Le.removeEventListener("dispose",Kt),cn(Le)}function cn(de){sn(de),ze.remove(de)}function sn(de){const Le=ze.get(de).programs;Le!==void 0&&(Le.forEach(function(Ue){F.releaseProgram(Ue)}),de.isShaderMaterial&&F.releaseShaderCache(de))}this.renderBufferDirect=function(de,Le,Ue,He,Se,Tt){Le===null&&(Le=Te);const xt=Se.isMesh&&Se.matrixWorld.determinant()<0,bt=qe(de,Le,Ue,He,Se);ye.setMaterial(He,xt);let Pt=Ue.index,Bt=1;if(He.wireframe===!0){if(Pt=Be.getWireframeAttribute(Ue),Pt===void 0)return;Bt=2}const Xt=Ue.drawRange,Ot=Ue.attributes.position;let Ht=Xt.start*Bt,Gt=(Xt.start+Xt.count)*Bt;Tt!==null&&(Ht=Math.max(Ht,Tt.start*Bt),Gt=Math.min(Gt,(Tt.start+Tt.count)*Bt)),Pt!==null?(Ht=Math.max(Ht,0),Gt=Math.min(Gt,Pt.count)):Ot!=null&&(Ht=Math.max(Ht,0),Gt=Math.min(Gt,Ot.count));const dn=Gt-Ht;if(dn<0||dn===1/0)return;at.setup(Se,He,bt,Ue,Pt);let En,Zt=it;if(Pt!==null&&(En=Me.get(Pt),Zt=Ie,Zt.setIndex(En)),Se.isMesh)He.wireframe===!0?(ye.setLineWidth(He.wireframeLinewidth*Re()),Zt.setMode(ae.LINES)):Zt.setMode(ae.TRIANGLES);else if(Se.isLine){let qt=He.linewidth;qt===void 0&&(qt=1),ye.setLineWidth(qt*Re()),Se.isLineSegments?Zt.setMode(ae.LINES):Se.isLineLoop?Zt.setMode(ae.LINE_LOOP):Zt.setMode(ae.LINE_STRIP)}else Se.isPoints?Zt.setMode(ae.POINTS):Se.isSprite&&Zt.setMode(ae.TRIANGLES);if(Se.isBatchedMesh)if(Se._multiDrawInstances!==null)Zt.renderMultiDrawInstances(Se._multiDrawStarts,Se._multiDrawCounts,Se._multiDrawCount,Se._multiDrawInstances);else if(Pe.get("WEBGL_multi_draw"))Zt.renderMultiDraw(Se._multiDrawStarts,Se._multiDrawCounts,Se._multiDrawCount);else{const qt=Se._multiDrawStarts,jn=Se._multiDrawCounts,wn=Se._multiDrawCount,Zn=Pt?Me.get(Pt).bytesPerElement:1,Nn=ze.get(He).currentProgram.getUniforms();for(let Jt=0;Jt<wn;Jt++)Nn.setValue(ae,"_gl_DrawID",Jt),Zt.render(qt[Jt]/Zn,jn[Jt])}else if(Se.isInstancedMesh)Zt.renderInstances(Ht,dn,Se.count);else if(Ue.isInstancedBufferGeometry){const qt=Ue._maxInstanceCount!==void 0?Ue._maxInstanceCount:1/0,jn=Math.min(Ue.instanceCount,qt);Zt.renderInstances(Ht,dn,jn)}else Zt.render(Ht,dn)};function Vt(de,Le,Ue){de.transparent===!0&&de.side===Nr&&de.forceSinglePass===!1?(de.side=zi,de.needsUpdate=!0,Wi(de,Le,Ue),de.side=Cs,de.needsUpdate=!0,Wi(de,Le,Ue),de.side=Nr):Wi(de,Le,Ue)}this.compile=function(de,Le,Ue=null){Ue===null&&(Ue=de),y=xe.get(Ue),y.init(Le),_.push(y),Ue.traverseVisible(function(Se){Se.isLight&&Se.layers.test(Le.layers)&&(y.pushLight(Se),Se.castShadow&&y.pushShadow(Se))}),de!==Ue&&de.traverseVisible(function(Se){Se.isLight&&Se.layers.test(Le.layers)&&(y.pushLight(Se),Se.castShadow&&y.pushShadow(Se))}),y.setupLights();const He=new Set;return de.traverse(function(Se){if(!(Se.isMesh||Se.isPoints||Se.isLine||Se.isSprite))return;const Tt=Se.material;if(Tt)if(Array.isArray(Tt))for(let xt=0;xt<Tt.length;xt++){const bt=Tt[xt];Vt(bt,Ue,Se),He.add(bt)}else Vt(Tt,Ue,Se),He.add(Tt)}),_.pop(),y=null,He},this.compileAsync=function(de,Le,Ue=null){const He=this.compile(de,Le,Ue);return new Promise(Se=>{function Tt(){if(He.forEach(function(xt){ze.get(xt).currentProgram.isReady()&&He.delete(xt)}),He.size===0){Se(de);return}setTimeout(Tt,10)}Pe.get("KHR_parallel_shader_compile")!==null?Tt():setTimeout(Tt,10)})};let Gn=null;function rr(de){Gn&&Gn(de)}function Cr(){zr.stop()}function wi(){zr.start()}const zr=new vH;zr.setAnimationLoop(rr),typeof self<"u"&&zr.setContext(self),this.setAnimationLoop=function(de){Gn=de,Qe.setAnimationLoop(de),de===null?zr.stop():zr.start()},Qe.addEventListener("sessionstart",Cr),Qe.addEventListener("sessionend",wi),this.render=function(de,Le){if(Le!==void 0&&Le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;if(de.matrixWorldAutoUpdate===!0&&de.updateMatrixWorld(),Le.parent===null&&Le.matrixWorldAutoUpdate===!0&&Le.updateMatrixWorld(),Qe.enabled===!0&&Qe.isPresenting===!0&&(Qe.cameraAutoUpdate===!0&&Qe.updateCamera(Le),Le=Qe.getCamera()),de.isScene===!0&&de.onBeforeRender(w,de,Le,A),y=xe.get(de,_.length),y.init(Le),_.push(y),oe.multiplyMatrices(Le.projectionMatrix,Le.matrixWorldInverse),te.setFromProjectionMatrix(oe),X=this.localClippingEnabled,W=be.init(this.clippingPlanes,X),g=q.get(de,x.length),g.init(),x.push(g),Qe.enabled===!0&&Qe.isPresenting===!0){const Tt=w.xr.getDepthSensingMesh();Tt!==null&&mi(Tt,Le,-1/0,w.sortObjects)}mi(de,Le,0,w.sortObjects),g.finish(),w.sortObjects===!0&&g.sort(ne,re),_e=Qe.enabled===!1||Qe.isPresenting===!1||Qe.hasDepthSensing()===!1,_e&&$e.addToRenderList(g,de),this.info.render.frame++,W===!0&&be.beginShadows();const Ue=y.state.shadowsArray;De.render(Ue,de,Le),W===!0&&be.endShadows(),this.info.autoReset===!0&&this.info.reset();const He=g.opaque,Se=g.transmissive;if(y.setupLights(),Le.isArrayCamera){const Tt=Le.cameras;if(Se.length>0)for(let xt=0,bt=Tt.length;xt<bt;xt++){const Pt=Tt[xt];Hr(He,Se,de,Pt)}_e&&$e.render(de);for(let xt=0,bt=Tt.length;xt<bt;xt++){const Pt=Tt[xt];gi(g,de,Pt,Pt.viewport)}}else Se.length>0&&Hr(He,Se,de,Le),_e&&$e.render(de),gi(g,de,Le);A!==null&&(fe.updateMultisampleRenderTarget(A),fe.updateRenderTargetMipmap(A)),de.isScene===!0&&de.onAfterRender(w,de,Le),at.resetDefaultState(),R=-1,M=null,_.pop(),_.length>0?(y=_[_.length-1],W===!0&&be.setGlobalState(w.clippingPlanes,y.state.camera)):y=null,x.pop(),x.length>0?g=x[x.length-1]:g=null};function mi(de,Le,Ue,He){if(de.visible===!1)return;if(de.layers.test(Le.layers)){if(de.isGroup)Ue=de.renderOrder;else if(de.isLOD)de.autoUpdate===!0&&de.update(Le);else if(de.isLight)y.pushLight(de),de.castShadow&&y.pushShadow(de);else if(de.isSprite){if(!de.frustumCulled||te.intersectsSprite(de)){He&&me.setFromMatrixPosition(de.matrixWorld).applyMatrix4(oe);const xt=Ze.update(de),bt=de.material;bt.visible&&g.push(de,xt,bt,Ue,me.z,null)}}else if((de.isMesh||de.isLine||de.isPoints)&&(!de.frustumCulled||te.intersectsObject(de))){const xt=Ze.update(de),bt=de.material;if(He&&(de.boundingSphere!==void 0?(de.boundingSphere===null&&de.computeBoundingSphere(),me.copy(de.boundingSphere.center)):(xt.boundingSphere===null&&xt.computeBoundingSphere(),me.copy(xt.boundingSphere.center)),me.applyMatrix4(de.matrixWorld).applyMatrix4(oe)),Array.isArray(bt)){const Pt=xt.groups;for(let Bt=0,Xt=Pt.length;Bt<Xt;Bt++){const Ot=Pt[Bt],Ht=bt[Ot.materialIndex];Ht&&Ht.visible&&g.push(de,xt,Ht,Ue,me.z,Ot)}}else bt.visible&&g.push(de,xt,bt,Ue,me.z,null)}}const Tt=de.children;for(let xt=0,bt=Tt.length;xt<bt;xt++)mi(Tt[xt],Le,Ue,He)}function gi(de,Le,Ue,He){const Se=de.opaque,Tt=de.transmissive,xt=de.transparent;y.setupLightsView(Ue),W===!0&&be.setGlobalState(w.clippingPlanes,Ue),He&&ye.viewport(D.copy(He)),Se.length>0&&An(Se,Le,Ue),Tt.length>0&&An(Tt,Le,Ue),xt.length>0&&An(xt,Le,Ue),ye.buffers.depth.setTest(!0),ye.buffers.depth.setMask(!0),ye.buffers.color.setMask(!0),ye.setPolygonOffset(!1)}function Hr(de,Le,Ue,He){if((Ue.isScene===!0?Ue.overrideMaterial:null)!==null)return;y.state.transmissionRenderTarget[He.id]===void 0&&(y.state.transmissionRenderTarget[He.id]=new fr(1,1,{generateMipmaps:!0,type:Pe.has("EXT_color_buffer_half_float")||Pe.has("EXT_color_buffer_float")?ti:Rs,minFilter:Ts,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:er.workingColorSpace}));const Tt=y.state.transmissionRenderTarget[He.id],xt=He.viewport||D;Tt.setSize(xt.z,xt.w);const bt=w.getRenderTarget();w.setRenderTarget(Tt),w.getClearColor(N),z=w.getClearAlpha(),z<1&&w.setClearColor(16777215,.5),w.clear(),_e&&$e.render(Ue);const Pt=w.toneMapping;w.toneMapping=Xa;const Bt=He.viewport;if(He.viewport!==void 0&&(He.viewport=void 0),y.setupLightsView(He),W===!0&&be.setGlobalState(w.clippingPlanes,He),An(de,Ue,He),fe.updateMultisampleRenderTarget(Tt),fe.updateRenderTargetMipmap(Tt),Pe.has("WEBGL_multisampled_render_to_texture")===!1){let Xt=!1;for(let Ot=0,Ht=Le.length;Ot<Ht;Ot++){const Gt=Le[Ot],dn=Gt.object,En=Gt.geometry,Zt=Gt.material,qt=Gt.group;if(Zt.side===Nr&&dn.layers.test(He.layers)){const jn=Zt.side;Zt.side=zi,Zt.needsUpdate=!0,kr(dn,Ue,He,En,Zt,qt),Zt.side=jn,Zt.needsUpdate=!0,Xt=!0}}Xt===!0&&(fe.updateMultisampleRenderTarget(Tt),fe.updateRenderTargetMipmap(Tt))}w.setRenderTarget(bt),w.setClearColor(N,z),Bt!==void 0&&(He.viewport=Bt),w.toneMapping=Pt}function An(de,Le,Ue){const He=Le.isScene===!0?Le.overrideMaterial:null;for(let Se=0,Tt=de.length;Se<Tt;Se++){const xt=de[Se],bt=xt.object,Pt=xt.geometry,Bt=He===null?xt.material:He,Xt=xt.group;bt.layers.test(Ue.layers)&&kr(bt,Le,Ue,Pt,Bt,Xt)}}function kr(de,Le,Ue,He,Se,Tt){de.onBeforeRender(w,Le,Ue,He,Se,Tt),de.modelViewMatrix.multiplyMatrices(Ue.matrixWorldInverse,de.matrixWorld),de.normalMatrix.getNormalMatrix(de.modelViewMatrix),Se.onBeforeRender(w,Le,Ue,He,de,Tt),Se.transparent===!0&&Se.side===Nr&&Se.forceSinglePass===!1?(Se.side=zi,Se.needsUpdate=!0,w.renderBufferDirect(Ue,Le,He,Se,de,Tt),Se.side=Cs,Se.needsUpdate=!0,w.renderBufferDirect(Ue,Le,He,Se,de,Tt),Se.side=Nr):w.renderBufferDirect(Ue,Le,He,Se,de,Tt),de.onAfterRender(w,Le,Ue,He,Se,Tt)}function Wi(de,Le,Ue){Le.isScene!==!0&&(Le=Te);const He=ze.get(de),Se=y.state.lights,Tt=y.state.shadowsArray,xt=Se.state.version,bt=F.getParameters(de,Se.state,Tt,Le,Ue),Pt=F.getProgramCacheKey(bt);let Bt=He.programs;He.environment=de.isMeshStandardMaterial?Le.environment:null,He.fog=Le.fog,He.envMap=(de.isMeshStandardMaterial?ve:ie).get(de.envMap||He.environment),He.envMapRotation=He.environment!==null&&de.envMap===null?Le.environmentRotation:de.envMapRotation,Bt===void 0&&(de.addEventListener("dispose",Kt),Bt=new Map,He.programs=Bt);let Xt=Bt.get(Pt);if(Xt!==void 0){if(He.currentProgram===Xt&&He.lightsStateVersion===xt)return we(de,bt),Xt}else bt.uniforms=F.getUniforms(de),de.onBeforeCompile(bt,w),Xt=F.acquireProgram(bt,Pt),Bt.set(Pt,Xt),He.uniforms=bt.uniforms;const Ot=He.uniforms;return(!de.isShaderMaterial&&!de.isRawShaderMaterial||de.clipping===!0)&&(Ot.clippingPlanes=be.uniform),we(de,bt),He.needsLights=yt(de),He.lightsStateVersion=xt,He.needsLights&&(Ot.ambientLightColor.value=Se.state.ambient,Ot.lightProbe.value=Se.state.probe,Ot.directionalLights.value=Se.state.directional,Ot.directionalLightShadows.value=Se.state.directionalShadow,Ot.spotLights.value=Se.state.spot,Ot.spotLightShadows.value=Se.state.spotShadow,Ot.rectAreaLights.value=Se.state.rectArea,Ot.ltc_1.value=Se.state.rectAreaLTC1,Ot.ltc_2.value=Se.state.rectAreaLTC2,Ot.pointLights.value=Se.state.point,Ot.pointLightShadows.value=Se.state.pointShadow,Ot.hemisphereLights.value=Se.state.hemi,Ot.directionalShadowMap.value=Se.state.directionalShadowMap,Ot.directionalShadowMatrix.value=Se.state.directionalShadowMatrix,Ot.spotShadowMap.value=Se.state.spotShadowMap,Ot.spotLightMatrix.value=Se.state.spotLightMatrix,Ot.spotLightMap.value=Se.state.spotLightMap,Ot.pointShadowMap.value=Se.state.pointShadowMap,Ot.pointShadowMatrix.value=Se.state.pointShadowMatrix),He.currentProgram=Xt,He.uniformsList=null,Xt}function pe(de){if(de.uniformsList===null){const Le=de.currentProgram.getUniforms();de.uniformsList=f3.seqWithValue(Le.seq,de.uniforms)}return de.uniformsList}function we(de,Le){const Ue=ze.get(de);Ue.outputColorSpace=Le.outputColorSpace,Ue.batching=Le.batching,Ue.batchingColor=Le.batchingColor,Ue.instancing=Le.instancing,Ue.instancingColor=Le.instancingColor,Ue.instancingMorph=Le.instancingMorph,Ue.skinning=Le.skinning,Ue.morphTargets=Le.morphTargets,Ue.morphNormals=Le.morphNormals,Ue.morphColors=Le.morphColors,Ue.morphTargetsCount=Le.morphTargetsCount,Ue.numClippingPlanes=Le.numClippingPlanes,Ue.numIntersection=Le.numClipIntersection,Ue.vertexAlphas=Le.vertexAlphas,Ue.vertexTangents=Le.vertexTangents,Ue.toneMapping=Le.toneMapping}function qe(de,Le,Ue,He,Se){Le.isScene!==!0&&(Le=Te),fe.resetTextureUnits();const Tt=Le.fog,xt=He.isMeshStandardMaterial?Le.environment:null,bt=A===null?w.outputColorSpace:A.isXRRenderTarget===!0?A.texture.colorSpace:as,Pt=(He.isMeshStandardMaterial?ve:ie).get(He.envMap||xt),Bt=He.vertexColors===!0&&!!Ue.attributes.color&&Ue.attributes.color.itemSize===4,Xt=!!Ue.attributes.tangent&&(!!He.normalMap||He.anisotropy>0),Ot=!!Ue.morphAttributes.position,Ht=!!Ue.morphAttributes.normal,Gt=!!Ue.morphAttributes.color;let dn=Xa;He.toneMapped&&(A===null||A.isXRRenderTarget===!0)&&(dn=w.toneMapping);const En=Ue.morphAttributes.position||Ue.morphAttributes.normal||Ue.morphAttributes.color,Zt=En!==void 0?En.length:0,qt=ze.get(He),jn=y.state.lights;if(W===!0&&(X===!0||de!==M)){const Bn=de===M&&He.id===R;be.setState(He,de,Bn)}let wn=!1;He.version===qt.__version?(qt.needsLights&&qt.lightsStateVersion!==jn.state.version||qt.outputColorSpace!==bt||Se.isBatchedMesh&&qt.batching===!1||!Se.isBatchedMesh&&qt.batching===!0||Se.isBatchedMesh&&qt.batchingColor===!0&&Se.colorTexture===null||Se.isBatchedMesh&&qt.batchingColor===!1&&Se.colorTexture!==null||Se.isInstancedMesh&&qt.instancing===!1||!Se.isInstancedMesh&&qt.instancing===!0||Se.isSkinnedMesh&&qt.skinning===!1||!Se.isSkinnedMesh&&qt.skinning===!0||Se.isInstancedMesh&&qt.instancingColor===!0&&Se.instanceColor===null||Se.isInstancedMesh&&qt.instancingColor===!1&&Se.instanceColor!==null||Se.isInstancedMesh&&qt.instancingMorph===!0&&Se.morphTexture===null||Se.isInstancedMesh&&qt.instancingMorph===!1&&Se.morphTexture!==null||qt.envMap!==Pt||He.fog===!0&&qt.fog!==Tt||qt.numClippingPlanes!==void 0&&(qt.numClippingPlanes!==be.numPlanes||qt.numIntersection!==be.numIntersection)||qt.vertexAlphas!==Bt||qt.vertexTangents!==Xt||qt.morphTargets!==Ot||qt.morphNormals!==Ht||qt.morphColors!==Gt||qt.toneMapping!==dn||qt.morphTargetsCount!==Zt)&&(wn=!0):(wn=!0,qt.__version=He.version);let Zn=qt.currentProgram;wn===!0&&(Zn=Wi(He,Le,Se));let Nn=!1,Jt=!1,On=!1;const on=Zn.getUniforms(),Un=qt.uniforms;if(ye.useProgram(Zn.program)&&(Nn=!0,Jt=!0,On=!0),He.id!==R&&(R=He.id,Jt=!0),Nn||M!==de){ye.buffers.depth.getReversed()?(J.copy(de.projectionMatrix),_te(J),bte(J),on.setValue(ae,"projectionMatrix",J)):on.setValue(ae,"projectionMatrix",de.projectionMatrix),on.setValue(ae,"viewMatrix",de.matrixWorldInverse);const sr=on.map.cameraPosition;sr!==void 0&&sr.setValue(ae,Ee.setFromMatrixPosition(de.matrixWorld)),Ve.logarithmicDepthBuffer&&on.setValue(ae,"logDepthBufFC",2/(Math.log(de.far+1)/Math.LN2)),(He.isMeshPhongMaterial||He.isMeshToonMaterial||He.isMeshLambertMaterial||He.isMeshBasicMaterial||He.isMeshStandardMaterial||He.isShaderMaterial)&&on.setValue(ae,"isOrthographic",de.isOrthographicCamera===!0),M!==de&&(M=de,Jt=!0,On=!0)}if(Se.isSkinnedMesh){on.setOptional(ae,Se,"bindMatrix"),on.setOptional(ae,Se,"bindMatrixInverse");const Bn=Se.skeleton;Bn&&(Bn.boneTexture===null&&Bn.computeBoneTexture(),on.setValue(ae,"boneTexture",Bn.boneTexture,fe))}Se.isBatchedMesh&&(on.setOptional(ae,Se,"batchingTexture"),on.setValue(ae,"batchingTexture",Se._matricesTexture,fe),on.setOptional(ae,Se,"batchingIdTexture"),on.setValue(ae,"batchingIdTexture",Se._indirectTexture,fe),on.setOptional(ae,Se,"batchingColorTexture"),Se._colorsTexture!==null&&on.setValue(ae,"batchingColorTexture",Se._colorsTexture,fe));const mr=Ue.morphAttributes;if((mr.position!==void 0||mr.normal!==void 0||mr.color!==void 0)&&st.update(Se,Ue,Zn),(Jt||qt.receiveShadow!==Se.receiveShadow)&&(qt.receiveShadow=Se.receiveShadow,on.setValue(ae,"receiveShadow",Se.receiveShadow)),He.isMeshGouraudMaterial&&He.envMap!==null&&(Un.envMap.value=Pt,Un.flipEnvMap.value=Pt.isCubeTexture&&Pt.isRenderTargetTexture===!1?-1:1),He.isMeshStandardMaterial&&He.envMap===null&&Le.environment!==null&&(Un.envMapIntensity.value=Le.environmentIntensity),Jt&&(on.setValue(ae,"toneMappingExposure",w.toneMappingExposure),qt.needsLights&&ut(Un,On),Tt&&He.fog===!0&&Z.refreshFogUniforms(Un,Tt),Z.refreshMaterialUniforms(Un,He,V,K,y.state.transmissionRenderTarget[de.id]),f3.upload(ae,pe(qt),Un,fe)),He.isShaderMaterial&&He.uniformsNeedUpdate===!0&&(f3.upload(ae,pe(qt),Un,fe),He.uniformsNeedUpdate=!1),He.isSpriteMaterial&&on.setValue(ae,"center",Se.center),on.setValue(ae,"modelViewMatrix",Se.modelViewMatrix),on.setValue(ae,"normalMatrix",Se.normalMatrix),on.setValue(ae,"modelMatrix",Se.matrixWorld),He.isShaderMaterial||He.isRawShaderMaterial){const Bn=He.uniformsGroups;for(let sr=0,Ii=Bn.length;sr<Ii;sr++){const Si=Bn[sr];ke.update(Si,Zn),ke.bind(Si,Zn)}}return Zn}function ut(de,Le){de.ambientLightColor.needsUpdate=Le,de.lightProbe.needsUpdate=Le,de.directionalLights.needsUpdate=Le,de.directionalLightShadows.needsUpdate=Le,de.pointLights.needsUpdate=Le,de.pointLightShadows.needsUpdate=Le,de.spotLights.needsUpdate=Le,de.spotLightShadows.needsUpdate=Le,de.rectAreaLights.needsUpdate=Le,de.hemisphereLights.needsUpdate=Le}function yt(de){return de.isMeshLambertMaterial||de.isMeshToonMaterial||de.isMeshPhongMaterial||de.isMeshStandardMaterial||de.isShadowMaterial||de.isShaderMaterial&&de.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(de,Le,Ue){ze.get(de.texture).__webglTexture=Le,ze.get(de.depthTexture).__webglTexture=Ue;const He=ze.get(de);He.__hasExternalTextures=!0,He.__autoAllocateDepthBuffer=Ue===void 0,He.__autoAllocateDepthBuffer||Pe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),He.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(de,Le){const Ue=ze.get(de);Ue.__webglFramebuffer=Le,Ue.__useDefaultFramebuffer=Le===void 0},this.setRenderTarget=function(de,Le=0,Ue=0){A=de,S=Le,C=Ue;let He=!0,Se=null,Tt=!1,xt=!1;if(de){const Pt=ze.get(de);if(Pt.__useDefaultFramebuffer!==void 0)ye.bindFramebuffer(ae.FRAMEBUFFER,null),He=!1;else if(Pt.__webglFramebuffer===void 0)fe.setupRenderTarget(de);else if(Pt.__hasExternalTextures)fe.rebindTextures(de,ze.get(de.texture).__webglTexture,ze.get(de.depthTexture).__webglTexture);else if(de.depthBuffer){const Ot=de.depthTexture;if(Pt.__boundDepthTexture!==Ot){if(Ot!==null&&ze.has(Ot)&&(de.width!==Ot.image.width||de.height!==Ot.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");fe.setupDepthRenderbuffer(de)}}const Bt=de.texture;(Bt.isData3DTexture||Bt.isDataArrayTexture||Bt.isCompressedArrayTexture)&&(xt=!0);const Xt=ze.get(de).__webglFramebuffer;de.isWebGLCubeRenderTarget?(Array.isArray(Xt[Le])?Se=Xt[Le][Ue]:Se=Xt[Le],Tt=!0):de.samples>0&&fe.useMultisampledRTT(de)===!1?Se=ze.get(de).__webglMultisampledFramebuffer:Array.isArray(Xt)?Se=Xt[Ue]:Se=Xt,D.copy(de.viewport),k.copy(de.scissor),L=de.scissorTest}else D.copy(P).multiplyScalar(V).floor(),k.copy(se).multiplyScalar(V).floor(),L=ue;if(ye.bindFramebuffer(ae.FRAMEBUFFER,Se)&&He&&ye.drawBuffers(de,Se),ye.viewport(D),ye.scissor(k),ye.setScissorTest(L),Tt){const Pt=ze.get(de.texture);ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_CUBE_MAP_POSITIVE_X+Le,Pt.__webglTexture,Ue)}else if(xt){const Pt=ze.get(de.texture),Bt=Le||0;ae.framebufferTextureLayer(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,Pt.__webglTexture,Ue||0,Bt)}R=-1},this.readRenderTargetPixels=function(de,Le,Ue,He,Se,Tt,xt){if(!(de&&de.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let bt=ze.get(de).__webglFramebuffer;if(de.isWebGLCubeRenderTarget&&xt!==void 0&&(bt=bt[xt]),bt){ye.bindFramebuffer(ae.FRAMEBUFFER,bt);try{const Pt=de.texture,Bt=Pt.format,Xt=Pt.type;if(!Ve.textureFormatReadable(Bt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ve.textureTypeReadable(Xt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Le>=0&&Le<=de.width-He&&Ue>=0&&Ue<=de.height-Se&&ae.readPixels(Le,Ue,He,Se,Ye.convert(Bt),Ye.convert(Xt),Tt)}finally{const Pt=A!==null?ze.get(A).__webglFramebuffer:null;ye.bindFramebuffer(ae.FRAMEBUFFER,Pt)}}},this.readRenderTargetPixelsAsync=async function(de,Le,Ue,He,Se,Tt,xt){if(!(de&&de.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let bt=ze.get(de).__webglFramebuffer;if(de.isWebGLCubeRenderTarget&&xt!==void 0&&(bt=bt[xt]),bt){const Pt=de.texture,Bt=Pt.format,Xt=Pt.type;if(!Ve.textureFormatReadable(Bt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ve.textureTypeReadable(Xt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Le>=0&&Le<=de.width-He&&Ue>=0&&Ue<=de.height-Se){ye.bindFramebuffer(ae.FRAMEBUFFER,bt);const Ot=ae.createBuffer();ae.bindBuffer(ae.PIXEL_PACK_BUFFER,Ot),ae.bufferData(ae.PIXEL_PACK_BUFFER,Tt.byteLength,ae.STREAM_READ),ae.readPixels(Le,Ue,He,Se,Ye.convert(Bt),Ye.convert(Xt),0);const Ht=A!==null?ze.get(A).__webglFramebuffer:null;ye.bindFramebuffer(ae.FRAMEBUFFER,Ht);const Gt=ae.fenceSync(ae.SYNC_GPU_COMMANDS_COMPLETE,0);return ae.flush(),await xte(ae,Gt,4),ae.bindBuffer(ae.PIXEL_PACK_BUFFER,Ot),ae.getBufferSubData(ae.PIXEL_PACK_BUFFER,0,Tt),ae.deleteBuffer(Ot),ae.deleteSync(Gt),Tt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(de,Le=null,Ue=0){de.isTexture!==!0&&(Np("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Le=arguments[0]||null,de=arguments[1]);const He=Math.pow(2,-Ue),Se=Math.floor(de.image.width*He),Tt=Math.floor(de.image.height*He),xt=Le!==null?Le.x:0,bt=Le!==null?Le.y:0;fe.setTexture2D(de,0),ae.copyTexSubImage2D(ae.TEXTURE_2D,Ue,0,0,xt,bt,Se,Tt),ye.unbindTexture()};const vt=ae.createFramebuffer(),Ft=ae.createFramebuffer();this.copyTextureToTexture=function(de,Le,Ue=null,He=null,Se=0,Tt=null){de.isTexture!==!0&&(Np("WebGLRenderer: copyTextureToTexture function signature has changed."),He=arguments[0]||null,de=arguments[1],Le=arguments[2],Tt=arguments[3]||0,Ue=null),Tt===null&&(Se!==0?(Np("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Tt=Se,Se=0):Tt=0);let xt,bt,Pt,Bt,Xt,Ot,Ht,Gt,dn;const En=de.isCompressedTexture?de.mipmaps[Tt]:de.image;if(Ue!==null)xt=Ue.max.x-Ue.min.x,bt=Ue.max.y-Ue.min.y,Pt=Ue.isBox3?Ue.max.z-Ue.min.z:1,Bt=Ue.min.x,Xt=Ue.min.y,Ot=Ue.isBox3?Ue.min.z:0;else{const mr=Math.pow(2,-Se);xt=Math.floor(En.width*mr),bt=Math.floor(En.height*mr),de.isDataArrayTexture?Pt=En.depth:de.isData3DTexture?Pt=Math.floor(En.depth*mr):Pt=1,Bt=0,Xt=0,Ot=0}He!==null?(Ht=He.x,Gt=He.y,dn=He.z):(Ht=0,Gt=0,dn=0);const Zt=Ye.convert(Le.format),qt=Ye.convert(Le.type);let jn;Le.isData3DTexture?(fe.setTexture3D(Le,0),jn=ae.TEXTURE_3D):Le.isDataArrayTexture||Le.isCompressedArrayTexture?(fe.setTexture2DArray(Le,0),jn=ae.TEXTURE_2D_ARRAY):(fe.setTexture2D(Le,0),jn=ae.TEXTURE_2D),ae.pixelStorei(ae.UNPACK_FLIP_Y_WEBGL,Le.flipY),ae.pixelStorei(ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Le.premultiplyAlpha),ae.pixelStorei(ae.UNPACK_ALIGNMENT,Le.unpackAlignment);const wn=ae.getParameter(ae.UNPACK_ROW_LENGTH),Zn=ae.getParameter(ae.UNPACK_IMAGE_HEIGHT),Nn=ae.getParameter(ae.UNPACK_SKIP_PIXELS),Jt=ae.getParameter(ae.UNPACK_SKIP_ROWS),On=ae.getParameter(ae.UNPACK_SKIP_IMAGES);ae.pixelStorei(ae.UNPACK_ROW_LENGTH,En.width),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,En.height),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,Bt),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,Xt),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,Ot);const on=de.isDataArrayTexture||de.isData3DTexture,Un=Le.isDataArrayTexture||Le.isData3DTexture;if(de.isDepthTexture){const mr=ze.get(de),Bn=ze.get(Le),sr=ze.get(mr.__renderTarget),Ii=ze.get(Bn.__renderTarget);ye.bindFramebuffer(ae.READ_FRAMEBUFFER,sr.__webglFramebuffer),ye.bindFramebuffer(ae.DRAW_FRAMEBUFFER,Ii.__webglFramebuffer);for(let Si=0;Si<Pt;Si++)on&&(ae.framebufferTextureLayer(ae.READ_FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ze.get(de).__webglTexture,Se,Ot+Si),ae.framebufferTextureLayer(ae.DRAW_FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ze.get(Le).__webglTexture,Tt,dn+Si)),ae.blitFramebuffer(Bt,Xt,xt,bt,Ht,Gt,xt,bt,ae.DEPTH_BUFFER_BIT,ae.NEAREST);ye.bindFramebuffer(ae.READ_FRAMEBUFFER,null),ye.bindFramebuffer(ae.DRAW_FRAMEBUFFER,null)}else if(Se!==0||de.isRenderTargetTexture||ze.has(de)){const mr=ze.get(de),Bn=ze.get(Le);ye.bindFramebuffer(ae.READ_FRAMEBUFFER,vt),ye.bindFramebuffer(ae.DRAW_FRAMEBUFFER,Ft);for(let sr=0;sr<Pt;sr++)on?ae.framebufferTextureLayer(ae.READ_FRAMEBUFFER,ae.COLOR_ATTACHMENT0,mr.__webglTexture,Se,Ot+sr):ae.framebufferTexture2D(ae.READ_FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_2D,mr.__webglTexture,Se),Un?ae.framebufferTextureLayer(ae.DRAW_FRAMEBUFFER,ae.COLOR_ATTACHMENT0,Bn.__webglTexture,Tt,dn+sr):ae.framebufferTexture2D(ae.DRAW_FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_2D,Bn.__webglTexture,Tt),Se!==0?ae.blitFramebuffer(Bt,Xt,xt,bt,Ht,Gt,xt,bt,ae.COLOR_BUFFER_BIT,ae.NEAREST):Un?ae.copyTexSubImage3D(jn,Tt,Ht,Gt,dn+sr,Bt,Xt,xt,bt):ae.copyTexSubImage2D(jn,Tt,Ht,Gt,Bt,Xt,xt,bt);ye.bindFramebuffer(ae.READ_FRAMEBUFFER,null),ye.bindFramebuffer(ae.DRAW_FRAMEBUFFER,null)}else Un?de.isDataTexture||de.isData3DTexture?ae.texSubImage3D(jn,Tt,Ht,Gt,dn,xt,bt,Pt,Zt,qt,En.data):Le.isCompressedArrayTexture?ae.compressedTexSubImage3D(jn,Tt,Ht,Gt,dn,xt,bt,Pt,Zt,En.data):ae.texSubImage3D(jn,Tt,Ht,Gt,dn,xt,bt,Pt,Zt,qt,En):de.isDataTexture?ae.texSubImage2D(ae.TEXTURE_2D,Tt,Ht,Gt,xt,bt,Zt,qt,En.data):de.isCompressedTexture?ae.compressedTexSubImage2D(ae.TEXTURE_2D,Tt,Ht,Gt,En.width,En.height,Zt,En.data):ae.texSubImage2D(ae.TEXTURE_2D,Tt,Ht,Gt,xt,bt,Zt,qt,En);ae.pixelStorei(ae.UNPACK_ROW_LENGTH,wn),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,Zn),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,Nn),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,Jt),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,On),Tt===0&&Le.generateMipmaps&&ae.generateMipmap(jn),ye.unbindTexture()},this.copyTextureToTexture3D=function(de,Le,Ue=null,He=null,Se=0){return de.isTexture!==!0&&(Np("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Ue=arguments[0]||null,He=arguments[1]||null,de=arguments[2],Le=arguments[3],Se=arguments[4]||0),Np('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(de,Le,Ue,He,Se)},this.initRenderTarget=function(de){ze.get(de).__webglFramebuffer===void 0&&fe.setupRenderTarget(de)},this.initTexture=function(de){de.isCubeTexture?fe.setTextureCube(de,0):de.isData3DTexture?fe.setTexture3D(de,0):de.isDataArrayTexture||de.isCompressedArrayTexture?fe.setTexture2DArray(de,0):fe.setTexture2D(de,0),ye.unbindTexture()},this.resetState=function(){S=0,C=0,A=null,ye.reset(),at.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ql}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorspace=er._getDrawingBufferColorSpace(e),n.unpackColorSpace=er._getUnpackColorSpace()}}const SH=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:yb,AddEquation:Ku,AddOperation:hz,AdditiveAnimationBlendMode:p6,AdditiveBlending:A3,AgXToneMapping:pz,AlphaFormat:c6,AlwaysCompare:Iz,AlwaysDepth:R3,AlwaysStencilFunc:a_,AmbientLight:Wb,AnimationAction:uH,AnimationClip:Qa,AnimationLoader:zne,AnimationMixer:fH,AnimationObjectGroup:are,AnimationUtils:One,ArcCurve:zz,ArrayCamera:oH,ArrowHelper:xre,AttachedBindMode:$A,Audio:lH,AudioAnalyser:Zne,AudioContext:H6,AudioListener:aH,AudioLoader:sH,AxesHelper:_re,BackSide:zi,BasicDepthPacking:_z,BasicShadowMap:YB,BatchedMesh:Mb,Bone:Jd,BooleanKeyframeTrack:ih,Box2:W6,Box3:Kn,Box3Helper:yre,BoxGeometry:fc,BoxHelper:gre,BufferAttribute:fn,BufferGeometry:gn,BufferGeometryLoader:iH,ByteType:mm,Cache:qc,Camera:Om,CameraHelper:$6,CanvasTexture:w6,CapsuleGeometry:Pb,CatmullRomCurve3:T6,CineonToneMapping:o6,CircleGeometry:kb,ClampToEdgeWrapping:ei,Clock:Xb,Color:wt,ColorKeyframeTrack:U6,ColorManagement:er,CompressedArrayTexture:sne,CompressedCubeTexture:one,CompressedTexture:Rb,CompressedTextureLoader:Hne,ConeGeometry:Lb,ConstantAlphaFactor:uz,ConstantColorFactor:lz,Controls:bre,CubeCamera:wb,CubeReflectionMapping:sc,CubeRefractionMapping:ff,CubeTexture:my,CubeTextureLoader:Jz,CubeUVReflectionMapping:Lm,CubicBezierCurve:A6,CubicBezierCurve3:M6,CubicInterpolant:Kz,CullFaceBack:jA,CullFaceFront:qB,CullFaceFrontBack:Iee,CullFaceNone:XB,Curve:Sl,CurvePath:Gz,CustomBlending:mb,CustomToneMapping:a6,CylinderGeometry:hu,Cylindrical:dre,Data3DTexture:x6,DataArrayTexture:Eb,DataTexture:As,DataTextureLoader:Ey,DataUtils:vd,DecrementStencilOp:Bee,DecrementWrapStencilOp:Hee,DefaultLoadingManager:Vb,DepthFormat:sf,DepthStencilFormat:Hd,DepthTexture:Bm,DetachedBindMode:gz,DirectionalLight:jm,DirectionalLightHelper:yH,DiscreteInterpolant:Zz,DodecahedronGeometry:Db,DoubleSide:Nr,DstAlphaFactor:rz,DstColorFactor:sz,DynamicCopyUsage:Jee,DynamicDrawUsage:Ji,DynamicReadUsage:Kee,EdgesGeometry:P6,EllipseCurve:Ib,EqualCompare:Az,EqualDepth:P3,EqualStencilFunc:Ez,EquirectangularReflectionMapping:pm,EquirectangularRefractionMapping:F1,Euler:xr,EventDispatcher:uc,ExtrudeGeometry:vy,FileLoader:qr,Float16BufferAttribute:Hte,Float32BufferAttribute:Dt,FloatType:pr,Fog:Tb,FogExp2:Sb,FramebufferTexture:ine,FrontSide:Cs,Frustum:th,GLBufferAttribute:fre,GLSL1:tte,GLSL3:qA,GreaterCompare:Mz,GreaterDepth:L3,GreaterEqualCompare:Rz,GreaterEqualDepth:k3,GreaterEqualStencilFunc:Xee,GreaterStencilFunc:$ee,GridHelper:pre,Group:es,HalfFloatType:ti,HemisphereLight:eH,HemisphereLightHelper:gH,IcosahedronGeometry:xy,ImageBitmapLoader:z6,ImageLoader:$1,ImageUtils:Lz,IncrementStencilOp:Uee,IncrementWrapStencilOp:zee,InstancedBufferAttribute:Ya,InstancedBufferGeometry:wy,InstancedInterleavedBuffer:f_,InstancedMesh:eh,Int16BufferAttribute:Bte,Int32BufferAttribute:zte,Int8BufferAttribute:Ote,IntType:rf,InterleavedBuffer:Um,InterleavedBufferAttribute:Ao,Interpolant:rh,InterpolateDiscrete:Gd,InterpolateLinear:pf,InterpolateSmooth:l3,InvertStencilOp:Gee,KeepStencilOp:$l,KeyframeTrack:Tl,LOD:Bz,LatheGeometry:yy,Layers:Md,LessCompare:Tz,LessDepth:I3,LessEqualCompare:y6,LessEqualDepth:Ud,LessEqualStencilFunc:Wee,LessStencilFunc:Vee,Light:Af,LightProbe:rH,Line:$o,Line3:qa,LineBasicMaterial:oi,LineCurve:C6,LineCurve3:Hz,LineDashedMaterial:N6,LineLoop:Cb,LineSegments:so,LinearFilter:Pn,LinearInterpolant:F6,LinearMipMapLinearFilter:XA,LinearMipMapNearestFilter:Lee,LinearMipmapLinearFilter:Ts,LinearMipmapNearestFilter:Td,LinearSRGBColorSpace:as,LinearToneMapping:i6,LinearTransfer:B1,Loader:Br,LoaderUtils:Ms,LoadingManager:jb,LoopOnce:yz,LoopPingPong:xz,LoopRepeat:vz,LuminanceAlphaFormat:d6,LuminanceFormat:f6,MOUSE:Fc,Material:Wr,MaterialLoader:$b,MathUtils:ri,Matrix2:V6,Matrix3:Ln,Matrix4:et,MaxEquation:JB,Mesh:ln,MeshBasicMaterial:Fr,MeshDepthMaterial:zm,MeshDistanceMaterial:Gb,MeshLambertMaterial:nh,MeshMatcapMaterial:Xz,MeshNormalMaterial:Hb,MeshPhongMaterial:nu,MeshPhysicalMaterial:Ur,MeshStandardMaterial:Ka,MeshToonMaterial:$z,MinEquation:QB,MirroredRepeatWrapping:Bd,MixOperation:dz,MultiplyBlending:WA,MultiplyOperation:fy,NearestFilter:zn,NearestMipMapLinearFilter:kee,NearestMipMapNearestFilter:Pee,NearestMipmapLinearFilter:Zu,NearestMipmapNearestFilter:dy,NeutralToneMapping:mz,NeverCompare:Sz,NeverDepth:C3,NeverStencilFunc:jee,NoBlending:$a,NoColorSpace:ss,NoToneMapping:Xa,NormalAnimationBlendMode:bb,NormalBlending:ec,NotEqualCompare:Cz,NotEqualDepth:D3,NotEqualStencilFunc:wz,NumberKeyframeTrack:ru,Object3D:yn,ObjectLoader:Wne,ObjectSpaceNormalMap:bz,OctahedronGeometry:_y,OneFactor:gb,OneMinusConstantAlphaFactor:fz,OneMinusConstantColorFactor:cz,OneMinusDstAlphaFactor:iz,OneMinusDstColorFactor:oz,OneMinusSrcAlphaFactor:M3,OneMinusSrcColorFactor:nz,OrthographicCamera:Hi,PCFShadowMap:pb,PCFSoftShadowMap:s1,PMREMGenerator:t5,Path:of,PerspectiveCamera:Ar,Plane:Oi,PlaneGeometry:Ps,PlaneHelper:vre,PointLight:Gm,PointLightHelper:mH,Points:Zc,PointsMaterial:Ha,PolarGridHelper:mre,PolyhedronGeometry:Sf,PositionalAudio:Kne,PropertyBinding:dr,PropertyMixer:cH,QuadraticBezierCurve:R6,QuadraticBezierCurve3:gy,Quaternion:bn,QuaternionKeyframeTrack:Za,QuaternionLinearInterpolant:Qz,RED_GREEN_RGTC2_Format:s_,RED_RGTC1_Format:h6,REVISION:wl,RGBADepthPacking:g6,RGBAFormat:Pr,RGBAIntegerFormat:hf,RGBA_ASTC_10x10_Format:J3,RGBA_ASTC_10x5_Format:K3,RGBA_ASTC_10x6_Format:Z3,RGBA_ASTC_10x8_Format:Q3,RGBA_ASTC_12x10_Format:e_,RGBA_ASTC_12x12_Format:t_,RGBA_ASTC_4x4_Format:G3,RGBA_ASTC_5x4_Format:j3,RGBA_ASTC_5x5_Format:V3,RGBA_ASTC_6x5_Format:W3,RGBA_ASTC_6x6_Format:$3,RGBA_ASTC_8x5_Format:X3,RGBA_ASTC_8x6_Format:q3,RGBA_ASTC_8x8_Format:Y3,RGBA_BPTC_Format:u1,RGBA_ETC2_EAC_Format:H3,RGBA_PVRTC_2BPPV1_Format:U3,RGBA_PVRTC_4BPPV1_Format:F3,RGBA_S3TC_DXT1_Format:a1,RGBA_S3TC_DXT3_Format:l1,RGBA_S3TC_DXT5_Format:c1,RGBDepthPacking:Nee,RGBFormat:u6,RGBIntegerFormat:Dee,RGB_BPTC_SIGNED_Format:n_,RGB_BPTC_UNSIGNED_Format:r_,RGB_ETC1_Format:B3,RGB_ETC2_Format:z3,RGB_PVRTC_2BPPV1_Format:O3,RGB_PVRTC_4BPPV1_Format:N3,RGB_S3TC_DXT1_Format:o1,RGDepthPacking:Oee,RGFormat:_b,RGIntegerFormat:Nm,RawShaderMaterial:D6,Ray:Yo,Raycaster:oh,RectAreaLight:tH,RedFormat:Yc,RedIntegerFormat:Dm,ReinhardToneMapping:s6,RenderTarget:Dz,RepeatWrapping:Or,ReplaceStencilOp:c3,ReverseSubtractEquation:ZB,RingGeometry:Ob,SIGNED_RED_GREEN_RGTC2_Format:o_,SIGNED_RED_RGTC1_Format:i_,SRGBColorSpace:Er,SRGBTransfer:Dr,Scene:ls,ShaderChunk:Fn,ShaderLib:yl,ShaderMaterial:yr,ShadowMaterial:L6,Shape:tc,ShapeGeometry:by,ShapePath:Dc,ShapeUtils:vl,ShortType:hy,Skeleton:wf,SkeletonHelper:hH,SkinnedMesh:Qd,Source:yd,Sphere:wr,SphereGeometry:Tf,Spherical:d_,SphericalHarmonics3:nH,SplineCurve:I6,SpotLight:Hm,SpotLightHelper:dH,Sprite:Uz,SpriteMaterial:Ab,SrcAlphaFactor:O1,SrcAlphaSaturateFactor:az,SrcColorFactor:tz,StaticCopyUsage:Qee,StaticDrawUsage:z1,StaticReadUsage:Yee,StereoCamera:Xne,StreamCopyUsage:ete,StreamDrawUsage:qee,StreamReadUsage:Zee,StringKeyframeTrack:sh,SubtractEquation:KB,SubtractiveBlending:VA,TOUCH:Uc,TangentSpaceNormalMap:du,TetrahedronGeometry:Fb,Texture:tr,TextureLoader:ns,TextureUtils:Are,TorusGeometry:Ub,TorusKnotGeometry:Bb,Triangle:Ci,TriangleFanDrawMode:jd,TriangleStripDrawMode:py,TrianglesDrawMode:m6,TubeGeometry:zb,UVMapping:uf,Uint16BufferAttribute:_6,Uint32BufferAttribute:b6,Uint8BufferAttribute:Fte,Uint8ClampedBufferAttribute:Ute,Uniform:Js,UniformsGroup:ure,UniformsLib:Qt,UniformsUtils:mf,UnsignedByteType:Rs,UnsignedInt248Type:zd,UnsignedInt5999Type:l6,UnsignedIntType:io,UnsignedShort4444Type:vb,UnsignedShort5551Type:xb,UnsignedShortType:df,VSMShadowMap:gl,Vector2:Ke,Vector3:$,Vector4:Hn,VectorKeyframeTrack:Xo,VideoTexture:E6,WebGL3DRenderTarget:Ate,WebGLArrayRenderTarget:Tte,WebGLCoordinateSystem:Ql,WebGLCubeRenderTarget:Fm,WebGLMultipleRenderTargets:Mre,WebGLRenderTarget:fr,WebGLRenderer:Yb,WebGLUtils:wH,WebGPUCoordinateSystem:H1,WireframeGeometry:k6,WrapAroundEnding:U1,ZeroCurvatureEnding:md,ZeroFactor:ez,ZeroSlopeEnding:gd,ZeroStencilOp:Fee,createCanvasElement:kz},Symbol.toStringTag,{value:"Module"}));var TH={exports:{}},Nu={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hP;function lle(){return hP||(hP=1,Nu.ConcurrentRoot=1,Nu.ContinuousEventPriority=4,Nu.DefaultEventPriority=16,Nu.DiscreteEventPriority=1,Nu.IdleEventPriority=536870912,Nu.LegacyRoot=0),Nu}TH.exports=lle();var $p=TH.exports;function cle(t){let e;const n=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(f!==e){const d=e;e=u?f:Object.assign({},e,f),n.forEach(h=>h(e,d))}},i=()=>e,s=(c,u=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=u(e);function h(){const p=u(e);if(!f(d,p)){const m=d;c(d=p,m)}}return n.add(h),()=>n.delete(h)},l={setState:r,getState:i,subscribe:(c,u,f)=>u||f?s(c,u,f):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(r,i,l),l}const ule=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),pP=ule?v.useEffect:v.useLayoutEffect;function AH(t){const e=typeof t=="function"?cle(t):t,n=(r=e.getState,i=Object.is)=>{const[,s]=v.useReducer(g=>g+1,0),o=e.getState(),a=v.useRef(o),l=v.useRef(r),c=v.useRef(i),u=v.useRef(!1),f=v.useRef();f.current===void 0&&(f.current=r(o));let d,h=!1;(a.current!==o||l.current!==r||c.current!==i||u.current)&&(d=r(o),h=!i(f.current,d)),pP(()=>{h&&(f.current=d),a.current=o,l.current=r,c.current=i,u.current=!1});const p=v.useRef(o);pP(()=>{const g=()=>{try{const x=e.getState(),_=l.current(x);c.current(f.current,_)||(a.current=x,f.current=_,s())}catch{u.current=!0,s()}},y=e.subscribe(g);return e.getState()!==p.current&&g(),y},[]);const m=h?d:f.current;return v.useDebugValue(m),m};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}const fle=t=>typeof t=="object"&&typeof t.then=="function",_d=[];function MH(t,e,n=(r,i)=>r===i){if(t===e)return!0;if(!t||!e)return!1;const r=t.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!n(t[i],e[i]))return!1;return!0}function CH(t,e=null,n=!1,r={}){e===null&&(e=[t]);for(const s of _d)if(MH(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!n)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=_d.indexOf(i);s!==-1&&_d.splice(s,1)},promise:(fle(t)?t:t(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(_d.push(i),!n)throw i.promise}const ah=(t,e,n)=>CH(t,e,!1,n),RH=(t,e,n)=>void CH(t,e,!0,n),q6=t=>{if(t===void 0||t.length===0)_d.splice(0,_d.length);else{const e=_d.find(n=>MH(t,n.keys,n.equal));e&&e.remove()}};var IH={exports:{}},PH={exports:{}},o4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mP;function dle(){return mP||(mP=1,function(t){function e(V,ne){var re=V.length;V.push(ne);e:for(;0<re;){var P=re-1>>>1,se=V[P];if(0<i(se,ne))V[P]=ne,V[re]=se,re=P;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var ne=V[0],re=V.pop();if(re!==ne){V[0]=re;e:for(var P=0,se=V.length,ue=se>>>1;P<ue;){var te=2*(P+1)-1,W=V[te],X=te+1,J=V[X];if(0>i(W,re))X<se&&0>i(J,W)?(V[P]=J,V[X]=re,P=X):(V[P]=W,V[te]=re,P=te);else if(X<se&&0>i(J,re))V[P]=J,V[X]=re,P=X;else break e}}return ne}function i(V,ne){var re=V.sortIndex-ne.sortIndex;return re!==0?re:V.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,d=3,h=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(V){for(var ne=n(c);ne!==null;){if(ne.callback===null)r(c);else if(ne.startTime<=V)r(c),ne.sortIndex=ne.expirationTime,e(l,ne);else break;ne=n(c)}}function w(V){if(m=!1,_(V),!p)if(n(l)!==null)p=!0,O(T);else{var ne=n(c);ne!==null&&K(w,ne.startTime-V)}}function T(V,ne){p=!1,m&&(m=!1,y(A),A=-1),h=!0;var re=d;try{for(_(ne),f=n(l);f!==null&&(!(f.expirationTime>ne)||V&&!D());){var P=f.callback;if(typeof P=="function"){f.callback=null,d=f.priorityLevel;var se=P(f.expirationTime<=ne);ne=t.unstable_now(),typeof se=="function"?f.callback=se:f===n(l)&&r(l),_(ne)}else r(l);f=n(l)}if(f!==null)var ue=!0;else{var te=n(c);te!==null&&K(w,te.startTime-ne),ue=!1}return ue}finally{f=null,d=re,h=!1}}var S=!1,C=null,A=-1,R=5,M=-1;function D(){return!(t.unstable_now()-M<R)}function k(){if(C!==null){var V=t.unstable_now();M=V;var ne=!0;try{ne=C(!0,V)}finally{ne?L():(S=!1,C=null)}}else S=!1}var L;if(typeof x=="function")L=function(){x(k)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,z=N.port2;N.port1.onmessage=k,L=function(){z.postMessage(null)}}else L=function(){g(k,0)};function O(V){C=V,S||(S=!0,L())}function K(V,ne){A=g(function(){V(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,O(T))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(d){case 1:case 2:case 3:var ne=3;break;default:ne=d}var re=d;d=ne;try{return V()}finally{d=re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,ne){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var re=d;d=V;try{return ne()}finally{d=re}},t.unstable_scheduleCallback=function(V,ne,re){var P=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?P+re:P):re=P,V){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=re+se,V={id:u++,callback:ne,priorityLevel:V,startTime:re,expirationTime:se,sortIndex:-1},re>P?(V.sortIndex=re,e(c,V),n(l)===null&&V===n(c)&&(m?(y(A),A=-1):m=!0,K(w,re-P))):(V.sortIndex=se,e(l,V),p||h||(p=!0,O(T))),V},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(V){var ne=d;return function(){var re=d;d=ne;try{return V.apply(this,arguments)}finally{d=re}}}}(o4)),o4}PH.exports=dle();var r5=PH.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a4,gP;function hle(){return gP||(gP=1,a4=function(e){var n={},r=v,i=r5,s=Object.assign;function o(b){for(var E="https://reactjs.org/docs/error-decoder.html?invariant="+b,I=1;I<arguments.length;I++)E+="&args[]="+encodeURIComponent(arguments[I]);return"Minified React error #"+b+"; visit "+E+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),p=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),T=Symbol.iterator;function S(b){return b===null||typeof b!="object"?null:(b=T&&b[T]||b["@@iterator"],typeof b=="function"?b:null)}function C(b){if(b==null)return null;if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case u:return"Fragment";case c:return"Portal";case d:return"Profiler";case f:return"StrictMode";case g:return"Suspense";case y:return"SuspenseList"}if(typeof b=="object")switch(b.$$typeof){case p:return(b.displayName||"Context")+".Consumer";case h:return(b._context.displayName||"Context")+".Provider";case m:var E=b.render;return b=b.displayName,b||(b=E.displayName||E.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case x:return E=b.displayName||null,E!==null?E:C(b.type)||"Memo";case _:E=b._payload,b=b._init;try{return C(b(E))}catch{}}return null}function A(b){var E=b.type;switch(b.tag){case 24:return"Cache";case 9:return(E.displayName||"Context")+".Consumer";case 10:return(E._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return b=E.render,b=b.displayName||b.name||"",E.displayName||(b!==""?"ForwardRef("+b+")":"ForwardRef");case 7:return"Fragment";case 5:return E;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return C(E);case 8:return E===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof E=="function")return E.displayName||E.name||null;if(typeof E=="string")return E}return null}function R(b){var E=b,I=b;if(b.alternate)for(;E.return;)E=E.return;else{b=E;do E=b,E.flags&4098&&(I=E.return),b=E.return;while(b)}return E.tag===3?I:null}function M(b){if(R(b)!==b)throw Error(o(188))}function D(b){var E=b.alternate;if(!E){if(E=R(b),E===null)throw Error(o(188));return E!==b?null:b}for(var I=b,B=E;;){var ee=I.return;if(ee===null)break;var le=ee.alternate;if(le===null){if(B=ee.return,B!==null){I=B;continue}break}if(ee.child===le.child){for(le=ee.child;le;){if(le===I)return M(ee),b;if(le===B)return M(ee),E;le=le.sibling}throw Error(o(188))}if(I.return!==B.return)I=ee,B=le;else{for(var Oe=!1,Je=ee.child;Je;){if(Je===I){Oe=!0,I=ee,B=le;break}if(Je===B){Oe=!0,B=ee,I=le;break}Je=Je.sibling}if(!Oe){for(Je=le.child;Je;){if(Je===I){Oe=!0,I=le,B=ee;break}if(Je===B){Oe=!0,B=le,I=ee;break}Je=Je.sibling}if(!Oe)throw Error(o(189))}}if(I.alternate!==B)throw Error(o(190))}if(I.tag!==3)throw Error(o(188));return I.stateNode.current===I?b:E}function k(b){return b=D(b),b!==null?L(b):null}function L(b){if(b.tag===5||b.tag===6)return b;for(b=b.child;b!==null;){var E=L(b);if(E!==null)return E;b=b.sibling}return null}function N(b){if(b.tag===5||b.tag===6)return b;for(b=b.child;b!==null;){if(b.tag!==4){var E=N(b);if(E!==null)return E}b=b.sibling}return null}var z=Array.isArray,O=e.getPublicInstance,K=e.getRootHostContext,V=e.getChildHostContext,ne=e.prepareForCommit,re=e.resetAfterCommit,P=e.createInstance,se=e.appendInitialChild,ue=e.finalizeInitialChildren,te=e.prepareUpdate,W=e.shouldSetTextContent,X=e.createTextInstance,J=e.scheduleTimeout,oe=e.cancelTimeout,Ee=e.noTimeout,me=e.isPrimaryRenderer,Te=e.supportsMutation,_e=e.supportsPersistence,Re=e.supportsHydration,ae=e.getInstanceFromNode,Ce=e.preparePortalMount,Pe=e.getCurrentEventPriority,Ve=e.detachDeletedInstance,ye=e.supportsMicrotasks,ge=e.scheduleMicrotask,ze=e.supportsTestSelectors,fe=e.findFiberRoot,ie=e.getBoundingRect,ve=e.getTextContent,Me=e.isHiddenSubtree,Be=e.matchAccessibilityRole,Ze=e.setFocusIfFocusable,F=e.setupIntersectionObserver,Z=e.appendChild,q=e.appendChildToContainer,xe=e.commitTextUpdate,be=e.commitMount,De=e.commitUpdate,$e=e.insertBefore,st=e.insertInContainerBefore,it=e.removeChild,Ie=e.removeChildFromContainer,Ye=e.resetTextContent,at=e.hideInstance,ke=e.hideTextInstance,Xe=e.unhideInstance,Qe=e.unhideTextInstance,_t=e.clearContainer,kt=e.cloneInstance,Ct=e.createContainerChildSet,Kt=e.appendChildToContainerChildSet,cn=e.finalizeContainerChildren,sn=e.replaceContainerChildren,Vt=e.cloneHiddenInstance,Gn=e.cloneHiddenTextInstance,rr=e.canHydrateInstance,Cr=e.canHydrateTextInstance,wi=e.canHydrateSuspenseInstance,zr=e.isSuspenseInstancePending,mi=e.isSuspenseInstanceFallback,gi=e.registerSuspenseInstanceRetry,Hr=e.getNextHydratableSibling,An=e.getFirstHydratableChild,kr=e.getFirstHydratableChildWithinContainer,Wi=e.getFirstHydratableChildWithinSuspenseInstance,pe=e.hydrateInstance,we=e.hydrateTextInstance,qe=e.hydrateSuspenseInstance,ut=e.getNextHydratableInstanceAfterSuspenseInstance,yt=e.commitHydratedContainer,vt=e.commitHydratedSuspenseInstance,Ft=e.clearSuspenseBoundary,de=e.clearSuspenseBoundaryFromContainer,Le=e.shouldDeleteUnhydratedTailInstances,Ue=e.didNotMatchHydratedContainerTextInstance,He=e.didNotMatchHydratedTextInstance,Se;function Tt(b){if(Se===void 0)try{throw Error()}catch(I){var E=I.stack.trim().match(/\n( *(at )?)/);Se=E&&E[1]||""}return`
`+Se+b}var xt=!1;function bt(b,E){if(!b||xt)return"";xt=!0;var I=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(E)if(E=function(){throw Error()},Object.defineProperty(E.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(E,[])}catch(Wt){var B=Wt}Reflect.construct(b,[],E)}else{try{E.call()}catch(Wt){B=Wt}b.call(E.prototype)}else{try{throw Error()}catch(Wt){B=Wt}b()}}catch(Wt){if(Wt&&B&&typeof Wt.stack=="string"){for(var ee=Wt.stack.split(`
`),le=B.stack.split(`
`),Oe=ee.length-1,Je=le.length-1;1<=Oe&&0<=Je&&ee[Oe]!==le[Je];)Je--;for(;1<=Oe&&0<=Je;Oe--,Je--)if(ee[Oe]!==le[Je]){if(Oe!==1||Je!==1)do if(Oe--,Je--,0>Je||ee[Oe]!==le[Je]){var Mt=`
`+ee[Oe].replace(" at new "," at ");return b.displayName&&Mt.includes("<anonymous>")&&(Mt=Mt.replace("<anonymous>",b.displayName)),Mt}while(1<=Oe&&0<=Je);break}}}finally{xt=!1,Error.prepareStackTrace=I}return(b=b?b.displayName||b.name:"")?Tt(b):""}var Pt=Object.prototype.hasOwnProperty,Bt=[],Xt=-1;function Ot(b){return{current:b}}function Ht(b){0>Xt||(b.current=Bt[Xt],Bt[Xt]=null,Xt--)}function Gt(b,E){Xt++,Bt[Xt]=b.current,b.current=E}var dn={},En=Ot(dn),Zt=Ot(!1),qt=dn;function jn(b,E){var I=b.type.contextTypes;if(!I)return dn;var B=b.stateNode;if(B&&B.__reactInternalMemoizedUnmaskedChildContext===E)return B.__reactInternalMemoizedMaskedChildContext;var ee={},le;for(le in I)ee[le]=E[le];return B&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=E,b.__reactInternalMemoizedMaskedChildContext=ee),ee}function wn(b){return b=b.childContextTypes,b!=null}function Zn(){Ht(Zt),Ht(En)}function Nn(b,E,I){if(En.current!==dn)throw Error(o(168));Gt(En,E),Gt(Zt,I)}function Jt(b,E,I){var B=b.stateNode;if(E=E.childContextTypes,typeof B.getChildContext!="function")return I;B=B.getChildContext();for(var ee in B)if(!(ee in E))throw Error(o(108,A(b)||"Unknown",ee));return s({},I,B)}function On(b){return b=(b=b.stateNode)&&b.__reactInternalMemoizedMergedChildContext||dn,qt=En.current,Gt(En,b),Gt(Zt,Zt.current),!0}function on(b,E,I){var B=b.stateNode;if(!B)throw Error(o(169));I?(b=Jt(b,E,qt),B.__reactInternalMemoizedMergedChildContext=b,Ht(Zt),Ht(En),Gt(En,b)):Ht(Zt),Gt(Zt,I)}var Un=Math.clz32?Math.clz32:sr,mr=Math.log,Bn=Math.LN2;function sr(b){return b>>>=0,b===0?32:31-(mr(b)/Bn|0)|0}var Ii=64,Si=4194304;function _n(b){switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return b&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return b}}function vn(b,E){var I=b.pendingLanes;if(I===0)return 0;var B=0,ee=b.suspendedLanes,le=b.pingedLanes,Oe=I&268435455;if(Oe!==0){var Je=Oe&~ee;Je!==0?B=_n(Je):(le&=Oe,le!==0&&(B=_n(le)))}else Oe=I&~ee,Oe!==0?B=_n(Oe):le!==0&&(B=_n(le));if(B===0)return 0;if(E!==0&&E!==B&&!(E&ee)&&(ee=B&-B,le=E&-E,ee>=le||ee===16&&(le&4194240)!==0))return E;if(B&4&&(B|=I&16),E=b.entangledLanes,E!==0)for(b=b.entanglements,E&=B;0<E;)I=31-Un(E),ee=1<<I,B|=b[I],E&=~ee;return B}function he(b,E){switch(b){case 1:case 2:case 4:return E+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return E+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U(b,E){for(var I=b.suspendedLanes,B=b.pingedLanes,ee=b.expirationTimes,le=b.pendingLanes;0<le;){var Oe=31-Un(le),Je=1<<Oe,Mt=ee[Oe];Mt===-1?(!(Je&I)||Je&B)&&(ee[Oe]=he(Je,E)):Mt<=E&&(b.expiredLanes|=Je),le&=~Je}}function j(b){return b=b.pendingLanes&-1073741825,b!==0?b:b&1073741824?1073741824:0}function Q(b){for(var E=[],I=0;31>I;I++)E.push(b);return E}function Y(b,E,I){b.pendingLanes|=E,E!==536870912&&(b.suspendedLanes=0,b.pingedLanes=0),b=b.eventTimes,E=31-Un(E),b[E]=I}function ce(b,E){var I=b.pendingLanes&~E;b.pendingLanes=E,b.suspendedLanes=0,b.pingedLanes=0,b.expiredLanes&=E,b.mutableReadLanes&=E,b.entangledLanes&=E,E=b.entanglements;var B=b.eventTimes;for(b=b.expirationTimes;0<I;){var ee=31-Un(I),le=1<<ee;E[ee]=0,B[ee]=-1,b[ee]=-1,I&=~le}}function Fe(b,E){var I=b.entangledLanes|=E;for(b=b.entanglements;I;){var B=31-Un(I),ee=1<<B;ee&E|b[B]&E&&(b[B]|=E),I&=~ee}}var je=0;function gt(b){return b&=-b,1<b?4<b?b&268435455?16:536870912:4:1}var lt=i.unstable_scheduleCallback,pt=i.unstable_cancelCallback,mt=i.unstable_shouldYield,ct=i.unstable_requestPaint,dt=i.unstable_now,Rt=i.unstable_ImmediatePriority,Nt=i.unstable_UserBlockingPriority,jt=i.unstable_NormalPriority,xn=i.unstable_IdlePriority,un=null,nn=null;function Vn(b){if(nn&&typeof nn.onCommitFiberRoot=="function")try{nn.onCommitFiberRoot(un,b,void 0,(b.current.flags&128)===128)}catch{}}function Lr(b,E){return b===E&&(b!==0||1/b===1/E)||b!==b&&E!==E}var gr=typeof Object.is=="function"?Object.is:Lr,ci=null,co=!1,uo=!1;function g0(b){ci===null?ci=[b]:ci.push(b)}function y0(b){co=!0,g0(b)}function Po(){if(!uo&&ci!==null){uo=!0;var b=0,E=je;try{var I=ci;for(je=1;b<I.length;b++){var B=I[b];do B=B(!0);while(B!==null)}ci=null,co=!1}catch(ee){throw ci!==null&&(ci=ci.slice(b+1)),lt(Rt,Po),ee}finally{je=E,uo=!1}}return null}var kf=a.ReactCurrentBatchConfig;function Lf(b,E){if(gr(b,E))return!0;if(typeof b!="object"||b===null||typeof E!="object"||E===null)return!1;var I=Object.keys(b),B=Object.keys(E);if(I.length!==B.length)return!1;for(B=0;B<I.length;B++){var ee=I[B];if(!Pt.call(E,ee)||!gr(b[ee],E[ee]))return!1}return!0}function Df(b){switch(b.tag){case 5:return Tt(b.type);case 16:return Tt("Lazy");case 13:return Tt("Suspense");case 19:return Tt("SuspenseList");case 0:case 2:case 15:return b=bt(b.type,!1),b;case 11:return b=bt(b.type.render,!1),b;case 1:return b=bt(b.type,!0),b;default:return""}}function fo(b,E){if(b&&b.defaultProps){E=s({},E),b=b.defaultProps;for(var I in b)E[I]===void 0&&(E[I]=b[I]);return E}return E}var ps=Ot(null),_h=null,sl=null,xu=null;function bh(){xu=sl=_h=null}function rv(b,E,I){me?(Gt(ps,E._currentValue),E._currentValue=I):(Gt(ps,E._currentValue2),E._currentValue2=I)}function ms(b){var E=ps.current;Ht(ps),me?b._currentValue=E:b._currentValue2=E}function ho(b,E,I){for(;b!==null;){var B=b.alternate;if((b.childLanes&E)!==E?(b.childLanes|=E,B!==null&&(B.childLanes|=E)):B!==null&&(B.childLanes&E)!==E&&(B.childLanes|=E),b===I)break;b=b.return}}function Pi(b,E){_h=b,xu=sl=null,b=b.dependencies,b!==null&&b.firstContext!==null&&(b.lanes&E&&(ea=!0),b.firstContext=null)}function ki(b){var E=me?b._currentValue:b._currentValue2;if(xu!==b)if(b={context:b,memoizedValue:E,next:null},sl===null){if(_h===null)throw Error(o(308));sl=b,_h.dependencies={lanes:0,firstContext:b}}else sl=sl.next=b;return E}var Zo=null,_u=!1;function Tw(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function c9(b,E){b=b.updateQueue,E.updateQueue===b&&(E.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,effects:b.effects})}function pc(b,E){return{eventTime:b,lane:E,tag:0,payload:null,callback:null,next:null}}function bu(b,E){var I=b.updateQueue;I!==null&&(I=I.shared,$i!==null&&b.mode&1&&!(ir&2)?(b=I.interleaved,b===null?(E.next=E,Zo===null?Zo=[I]:Zo.push(I)):(E.next=b.next,b.next=E),I.interleaved=E):(b=I.pending,b===null?E.next=E:(E.next=b.next,b.next=E),I.pending=E))}function iv(b,E,I){if(E=E.updateQueue,E!==null&&(E=E.shared,(I&4194240)!==0)){var B=E.lanes;B&=b.pendingLanes,I|=B,E.lanes=I,Fe(b,I)}}function u9(b,E){var I=b.updateQueue,B=b.alternate;if(B!==null&&(B=B.updateQueue,I===B)){var ee=null,le=null;if(I=I.firstBaseUpdate,I!==null){do{var Oe={eventTime:I.eventTime,lane:I.lane,tag:I.tag,payload:I.payload,callback:I.callback,next:null};le===null?ee=le=Oe:le=le.next=Oe,I=I.next}while(I!==null);le===null?ee=le=E:le=le.next=E}else ee=le=E;I={baseState:B.baseState,firstBaseUpdate:ee,lastBaseUpdate:le,shared:B.shared,effects:B.effects},b.updateQueue=I;return}b=I.lastBaseUpdate,b===null?I.firstBaseUpdate=E:b.next=E,I.lastBaseUpdate=E}function sv(b,E,I,B){var ee=b.updateQueue;_u=!1;var le=ee.firstBaseUpdate,Oe=ee.lastBaseUpdate,Je=ee.shared.pending;if(Je!==null){ee.shared.pending=null;var Mt=Je,Wt=Mt.next;Mt.next=null,Oe===null?le=Wt:Oe.next=Wt,Oe=Mt;var hn=b.alternate;hn!==null&&(hn=hn.updateQueue,Je=hn.lastBaseUpdate,Je!==Oe&&(Je===null?hn.firstBaseUpdate=Wt:Je.next=Wt,hn.lastBaseUpdate=Mt))}if(le!==null){var $n=ee.baseState;Oe=0,hn=Wt=Mt=null,Je=le;do{var Rn=Je.lane,Xr=Je.eventTime;if((B&Rn)===Rn){hn!==null&&(hn=hn.next={eventTime:Xr,lane:0,tag:Je.tag,payload:Je.payload,callback:Je.callback,next:null});e:{var Tn=b,qs=Je;switch(Rn=E,Xr=I,qs.tag){case 1:if(Tn=qs.payload,typeof Tn=="function"){$n=Tn.call(Xr,$n,Rn);break e}$n=Tn;break e;case 3:Tn.flags=Tn.flags&-65537|128;case 0:if(Tn=qs.payload,Rn=typeof Tn=="function"?Tn.call(Xr,$n,Rn):Tn,Rn==null)break e;$n=s({},$n,Rn);break e;case 2:_u=!0}}Je.callback!==null&&Je.lane!==0&&(b.flags|=64,Rn=ee.effects,Rn===null?ee.effects=[Je]:Rn.push(Je))}else Xr={eventTime:Xr,lane:Rn,tag:Je.tag,payload:Je.payload,callback:Je.callback,next:null},hn===null?(Wt=hn=Xr,Mt=$n):hn=hn.next=Xr,Oe|=Rn;if(Je=Je.next,Je===null){if(Je=ee.shared.pending,Je===null)break;Rn=Je,Je=Rn.next,Rn.next=null,ee.lastBaseUpdate=Rn,ee.shared.pending=null}}while(!0);if(hn===null&&(Mt=$n),ee.baseState=Mt,ee.firstBaseUpdate=Wt,ee.lastBaseUpdate=hn,E=ee.shared.interleaved,E!==null){ee=E;do Oe|=ee.lane,ee=ee.next;while(ee!==E)}else le===null&&(ee.shared.lanes=0);Ih|=Oe,b.lanes=Oe,b.memoizedState=$n}}function f9(b,E,I){if(b=E.effects,E.effects=null,b!==null)for(E=0;E<b.length;E++){var B=b[E],ee=B.callback;if(ee!==null){if(B.callback=null,B=I,typeof ee!="function")throw Error(o(191,ee));ee.call(B)}}}var d9=new r.Component().refs;function Aw(b,E,I,B){E=b.memoizedState,I=I(B,E),I=I==null?E:s({},E,I),b.memoizedState=I,b.lanes===0&&(b.updateQueue.baseState=I)}var ov={isMounted:function(b){return(b=b._reactInternals)?R(b)===b:!1},enqueueSetState:function(b,E,I){b=b._reactInternals;var B=mo(),ee=Su(b),le=pc(B,ee);le.payload=E,I!=null&&(le.callback=I),bu(b,le),E=ba(b,ee,B),E!==null&&iv(E,b,ee)},enqueueReplaceState:function(b,E,I){b=b._reactInternals;var B=mo(),ee=Su(b),le=pc(B,ee);le.tag=1,le.payload=E,I!=null&&(le.callback=I),bu(b,le),E=ba(b,ee,B),E!==null&&iv(E,b,ee)},enqueueForceUpdate:function(b,E){b=b._reactInternals;var I=mo(),B=Su(b),ee=pc(I,B);ee.tag=2,E!=null&&(ee.callback=E),bu(b,ee),E=ba(b,B,I),E!==null&&iv(E,b,B)}};function h9(b,E,I,B,ee,le,Oe){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(B,le,Oe):E.prototype&&E.prototype.isPureReactComponent?!Lf(I,B)||!Lf(ee,le):!0}function p9(b,E,I){var B=!1,ee=dn,le=E.contextType;return typeof le=="object"&&le!==null?le=ki(le):(ee=wn(E)?qt:En.current,B=E.contextTypes,le=(B=B!=null)?jn(b,ee):dn),E=new E(I,le),b.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=ov,b.stateNode=E,E._reactInternals=b,B&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=ee,b.__reactInternalMemoizedMaskedChildContext=le),E}function m9(b,E,I,B){b=E.state,typeof E.componentWillReceiveProps=="function"&&E.componentWillReceiveProps(I,B),typeof E.UNSAFE_componentWillReceiveProps=="function"&&E.UNSAFE_componentWillReceiveProps(I,B),E.state!==b&&ov.enqueueReplaceState(E,E.state,null)}function Mw(b,E,I,B){var ee=b.stateNode;ee.props=I,ee.state=b.memoizedState,ee.refs=d9,Tw(b);var le=E.contextType;typeof le=="object"&&le!==null?ee.context=ki(le):(le=wn(E)?qt:En.current,ee.context=jn(b,le)),ee.state=b.memoizedState,le=E.getDerivedStateFromProps,typeof le=="function"&&(Aw(b,E,le,I),ee.state=b.memoizedState),typeof E.getDerivedStateFromProps=="function"||typeof ee.getSnapshotBeforeUpdate=="function"||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(E=ee.state,typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount(),E!==ee.state&&ov.enqueueReplaceState(ee,ee.state,null),sv(b,I,ee,B),ee.state=b.memoizedState),typeof ee.componentDidMount=="function"&&(b.flags|=4194308)}var Eh=[],wh=0,av=null,lv=0,ya=[],va=0,Nf=null,mc=1,gc="";function Of(b,E){Eh[wh++]=lv,Eh[wh++]=av,av=b,lv=E}function g9(b,E,I){ya[va++]=mc,ya[va++]=gc,ya[va++]=Nf,Nf=b;var B=mc;b=gc;var ee=32-Un(B)-1;B&=~(1<<ee),I+=1;var le=32-Un(E)+ee;if(30<le){var Oe=ee-ee%5;le=(B&(1<<Oe)-1).toString(32),B>>=Oe,ee-=Oe,mc=1<<32-Un(E)+ee|I<<ee|B,gc=le+b}else mc=1<<le|I<<ee|B,gc=b}function Cw(b){b.return!==null&&(Of(b,1),g9(b,1,0))}function Rw(b){for(;b===av;)av=Eh[--wh],Eh[wh]=null,lv=Eh[--wh],Eh[wh]=null;for(;b===Nf;)Nf=ya[--va],ya[va]=null,gc=ya[--va],ya[va]=null,mc=ya[--va],ya[va]=null}var Qo=null,Jo=null,ui=!1,v0=!1,ol=null;function y9(b,E){var I=Ea(5,null,null,0);I.elementType="DELETED",I.stateNode=E,I.return=b,E=b.deletions,E===null?(b.deletions=[I],b.flags|=16):E.push(I)}function v9(b,E){switch(b.tag){case 5:return E=rr(E,b.type,b.pendingProps),E!==null?(b.stateNode=E,Qo=b,Jo=An(E),!0):!1;case 6:return E=Cr(E,b.pendingProps),E!==null?(b.stateNode=E,Qo=b,Jo=null,!0):!1;case 13:if(E=wi(E),E!==null){var I=Nf!==null?{id:mc,overflow:gc}:null;return b.memoizedState={dehydrated:E,treeContext:I,retryLane:1073741824},I=Ea(18,null,null,0),I.stateNode=E,I.return=b,b.child=I,Qo=b,Jo=null,!0}return!1;default:return!1}}function Iw(b){return(b.mode&1)!==0&&(b.flags&128)===0}function Pw(b){if(ui){var E=Jo;if(E){var I=E;if(!v9(b,E)){if(Iw(b))throw Error(o(418));E=Hr(I);var B=Qo;E&&v9(b,E)?y9(B,I):(b.flags=b.flags&-4097|2,ui=!1,Qo=b)}}else{if(Iw(b))throw Error(o(418));b.flags=b.flags&-4097|2,ui=!1,Qo=b}}}function x9(b){for(b=b.return;b!==null&&b.tag!==5&&b.tag!==3&&b.tag!==13;)b=b.return;Qo=b}function x0(b){if(!Re||b!==Qo)return!1;if(!ui)return x9(b),ui=!0,!1;if(b.tag!==3&&(b.tag!==5||Le(b.type)&&!W(b.type,b.memoizedProps))){var E=Jo;if(E){if(Iw(b)){for(b=Jo;b;)b=Hr(b);throw Error(o(418))}for(;E;)y9(b,E),E=Hr(E)}}if(x9(b),b.tag===13){if(!Re)throw Error(o(316));if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(o(317));Jo=ut(b)}else Jo=Qo?Hr(b.stateNode):null;return!0}function Sh(){Re&&(Jo=Qo=null,v0=ui=!1)}function kw(b){ol===null?ol=[b]:ol.push(b)}function _0(b,E,I){if(b=I.ref,b!==null&&typeof b!="function"&&typeof b!="object"){if(I._owner){if(I=I._owner,I){if(I.tag!==1)throw Error(o(309));var B=I.stateNode}if(!B)throw Error(o(147,b));var ee=B,le=""+b;return E!==null&&E.ref!==null&&typeof E.ref=="function"&&E.ref._stringRef===le?E.ref:(E=function(Oe){var Je=ee.refs;Je===d9&&(Je=ee.refs={}),Oe===null?delete Je[le]:Je[le]=Oe},E._stringRef=le,E)}if(typeof b!="string")throw Error(o(284));if(!I._owner)throw Error(o(290,b))}return b}function cv(b,E){throw b=Object.prototype.toString.call(E),Error(o(31,b==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":b))}function _9(b){var E=b._init;return E(b._payload)}function b9(b){function E(ht,nt){if(b){var Et=ht.deletions;Et===null?(ht.deletions=[nt],ht.flags|=16):Et.push(nt)}}function I(ht,nt){if(!b)return null;for(;nt!==null;)E(ht,nt),nt=nt.sibling;return null}function B(ht,nt){for(ht=new Map;nt!==null;)nt.key!==null?ht.set(nt.key,nt):ht.set(nt.index,nt),nt=nt.sibling;return ht}function ee(ht,nt){return ht=Au(ht,nt),ht.index=0,ht.sibling=null,ht}function le(ht,nt,Et){return ht.index=Et,b?(Et=ht.alternate,Et!==null?(Et=Et.index,Et<nt?(ht.flags|=2,nt):Et):(ht.flags|=2,nt)):(ht.flags|=1048576,nt)}function Oe(ht){return b&&ht.alternate===null&&(ht.flags|=2),ht}function Je(ht,nt,Et,an){return nt===null||nt.tag!==6?(nt=mS(Et,ht.mode,an),nt.return=ht,nt):(nt=ee(nt,Et),nt.return=ht,nt)}function Mt(ht,nt,Et,an){var Sn=Et.type;return Sn===u?hn(ht,nt,Et.props.children,an,Et.key):nt!==null&&(nt.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===_&&_9(Sn)===nt.type)?(an=ee(nt,Et.props),an.ref=_0(ht,nt,Et),an.return=ht,an):(an=zv(Et.type,Et.key,Et.props,null,ht.mode,an),an.ref=_0(ht,nt,Et),an.return=ht,an)}function Wt(ht,nt,Et,an){return nt===null||nt.tag!==4||nt.stateNode.containerInfo!==Et.containerInfo||nt.stateNode.implementation!==Et.implementation?(nt=gS(Et,ht.mode,an),nt.return=ht,nt):(nt=ee(nt,Et.children||[]),nt.return=ht,nt)}function hn(ht,nt,Et,an,Sn){return nt===null||nt.tag!==7?(nt=jf(Et,ht.mode,an,Sn),nt.return=ht,nt):(nt=ee(nt,Et),nt.return=ht,nt)}function $n(ht,nt,Et){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return nt=mS(""+nt,ht.mode,Et),nt.return=ht,nt;if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case l:return Et=zv(nt.type,nt.key,nt.props,null,ht.mode,Et),Et.ref=_0(ht,null,nt),Et.return=ht,Et;case c:return nt=gS(nt,ht.mode,Et),nt.return=ht,nt;case _:var an=nt._init;return $n(ht,an(nt._payload),Et)}if(z(nt)||S(nt))return nt=jf(nt,ht.mode,Et,null),nt.return=ht,nt;cv(ht,nt)}return null}function Rn(ht,nt,Et,an){var Sn=nt!==null?nt.key:null;if(typeof Et=="string"&&Et!==""||typeof Et=="number")return Sn!==null?null:Je(ht,nt,""+Et,an);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case l:return Et.key===Sn?Mt(ht,nt,Et,an):null;case c:return Et.key===Sn?Wt(ht,nt,Et,an):null;case _:return Sn=Et._init,Rn(ht,nt,Sn(Et._payload),an)}if(z(Et)||S(Et))return Sn!==null?null:hn(ht,nt,Et,an,null);cv(ht,Et)}return null}function Xr(ht,nt,Et,an,Sn){if(typeof an=="string"&&an!==""||typeof an=="number")return ht=ht.get(Et)||null,Je(nt,ht,""+an,Sn);if(typeof an=="object"&&an!==null){switch(an.$$typeof){case l:return ht=ht.get(an.key===null?Et:an.key)||null,Mt(nt,ht,an,Sn);case c:return ht=ht.get(an.key===null?Et:an.key)||null,Wt(nt,ht,an,Sn);case _:var Qn=an._init;return Xr(ht,nt,Et,Qn(an._payload),Sn)}if(z(an)||S(an))return ht=ht.get(Et)||null,hn(nt,ht,an,Sn,null);cv(nt,an)}return null}function Tn(ht,nt,Et,an){for(var Sn=null,Qn=null,Xn=nt,_r=nt=0,ys=null;Xn!==null&&_r<Et.length;_r++){Xn.index>_r?(ys=Xn,Xn=null):ys=Xn.sibling;var br=Rn(ht,Xn,Et[_r],an);if(br===null){Xn===null&&(Xn=ys);break}b&&Xn&&br.alternate===null&&E(ht,Xn),nt=le(br,nt,_r),Qn===null?Sn=br:Qn.sibling=br,Qn=br,Xn=ys}if(_r===Et.length)return I(ht,Xn),ui&&Of(ht,_r),Sn;if(Xn===null){for(;_r<Et.length;_r++)Xn=$n(ht,Et[_r],an),Xn!==null&&(nt=le(Xn,nt,_r),Qn===null?Sn=Xn:Qn.sibling=Xn,Qn=Xn);return ui&&Of(ht,_r),Sn}for(Xn=B(ht,Xn);_r<Et.length;_r++)ys=Xr(Xn,ht,_r,Et[_r],an),ys!==null&&(b&&ys.alternate!==null&&Xn.delete(ys.key===null?_r:ys.key),nt=le(ys,nt,_r),Qn===null?Sn=ys:Qn.sibling=ys,Qn=ys);return b&&Xn.forEach(function(Mu){return E(ht,Mu)}),ui&&Of(ht,_r),Sn}function qs(ht,nt,Et,an){var Sn=S(Et);if(typeof Sn!="function")throw Error(o(150));if(Et=Sn.call(Et),Et==null)throw Error(o(151));for(var Qn=Sn=null,Xn=nt,_r=nt=0,ys=null,br=Et.next();Xn!==null&&!br.done;_r++,br=Et.next()){Xn.index>_r?(ys=Xn,Xn=null):ys=Xn.sibling;var Mu=Rn(ht,Xn,br.value,an);if(Mu===null){Xn===null&&(Xn=ys);break}b&&Xn&&Mu.alternate===null&&E(ht,Xn),nt=le(Mu,nt,_r),Qn===null?Sn=Mu:Qn.sibling=Mu,Qn=Mu,Xn=ys}if(br.done)return I(ht,Xn),ui&&Of(ht,_r),Sn;if(Xn===null){for(;!br.done;_r++,br=Et.next())br=$n(ht,br.value,an),br!==null&&(nt=le(br,nt,_r),Qn===null?Sn=br:Qn.sibling=br,Qn=br);return ui&&Of(ht,_r),Sn}for(Xn=B(ht,Xn);!br.done;_r++,br=Et.next())br=Xr(Xn,ht,_r,br.value,an),br!==null&&(b&&br.alternate!==null&&Xn.delete(br.key===null?_r:br.key),nt=le(br,nt,_r),Qn===null?Sn=br:Qn.sibling=br,Qn=br);return b&&Xn.forEach(function(Aee){return E(ht,Aee)}),ui&&Of(ht,_r),Sn}function wa(ht,nt,Et,an){if(typeof Et=="object"&&Et!==null&&Et.type===u&&Et.key===null&&(Et=Et.props.children),typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case l:e:{for(var Sn=Et.key,Qn=nt;Qn!==null;){if(Qn.key===Sn){if(Sn=Et.type,Sn===u){if(Qn.tag===7){I(ht,Qn.sibling),nt=ee(Qn,Et.props.children),nt.return=ht,ht=nt;break e}}else if(Qn.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===_&&_9(Sn)===Qn.type){I(ht,Qn.sibling),nt=ee(Qn,Et.props),nt.ref=_0(ht,Qn,Et),nt.return=ht,ht=nt;break e}I(ht,Qn);break}else E(ht,Qn);Qn=Qn.sibling}Et.type===u?(nt=jf(Et.props.children,ht.mode,an,Et.key),nt.return=ht,ht=nt):(an=zv(Et.type,Et.key,Et.props,null,ht.mode,an),an.ref=_0(ht,nt,Et),an.return=ht,ht=an)}return Oe(ht);case c:e:{for(Qn=Et.key;nt!==null;){if(nt.key===Qn)if(nt.tag===4&&nt.stateNode.containerInfo===Et.containerInfo&&nt.stateNode.implementation===Et.implementation){I(ht,nt.sibling),nt=ee(nt,Et.children||[]),nt.return=ht,ht=nt;break e}else{I(ht,nt);break}else E(ht,nt);nt=nt.sibling}nt=gS(Et,ht.mode,an),nt.return=ht,ht=nt}return Oe(ht);case _:return Qn=Et._init,wa(ht,nt,Qn(Et._payload),an)}if(z(Et))return Tn(ht,nt,Et,an);if(S(Et))return qs(ht,nt,Et,an);cv(ht,Et)}return typeof Et=="string"&&Et!==""||typeof Et=="number"?(Et=""+Et,nt!==null&&nt.tag===6?(I(ht,nt.sibling),nt=ee(nt,Et),nt.return=ht,ht=nt):(I(ht,nt),nt=mS(Et,ht.mode,an),nt.return=ht,ht=nt),Oe(ht)):I(ht,nt)}return wa}var Th=b9(!0),E9=b9(!1),b0={},xa=Ot(b0),E0=Ot(b0),Ah=Ot(b0);function Ll(b){if(b===b0)throw Error(o(174));return b}function Lw(b,E){Gt(Ah,E),Gt(E0,b),Gt(xa,b0),b=K(E),Ht(xa),Gt(xa,b)}function Mh(){Ht(xa),Ht(E0),Ht(Ah)}function w9(b){var E=Ll(Ah.current),I=Ll(xa.current);E=V(I,b.type,E),I!==E&&(Gt(E0,b),Gt(xa,E))}function Dw(b){E0.current===b&&(Ht(xa),Ht(E0))}var yi=Ot(0);function uv(b){for(var E=b;E!==null;){if(E.tag===13){var I=E.memoizedState;if(I!==null&&(I=I.dehydrated,I===null||zr(I)||mi(I)))return E}else if(E.tag===19&&E.memoizedProps.revealOrder!==void 0){if(E.flags&128)return E}else if(E.child!==null){E.child.return=E,E=E.child;continue}if(E===b)break;for(;E.sibling===null;){if(E.return===null||E.return===b)return null;E=E.return}E.sibling.return=E.return,E=E.sibling}return null}var Nw=[];function Ow(){for(var b=0;b<Nw.length;b++){var E=Nw[b];me?E._workInProgressVersionPrimary=null:E._workInProgressVersionSecondary=null}Nw.length=0}var fv=a.ReactCurrentDispatcher,_a=a.ReactCurrentBatchConfig,Ch=0,Ti=null,Ws=null,gs=null,dv=!1,w0=!1,S0=0,ZJ=0;function $s(){throw Error(o(321))}function Fw(b,E){if(E===null)return!1;for(var I=0;I<E.length&&I<b.length;I++)if(!gr(b[I],E[I]))return!1;return!0}function Uw(b,E,I,B,ee,le){if(Ch=le,Ti=E,E.memoizedState=null,E.updateQueue=null,E.lanes=0,fv.current=b===null||b.memoizedState===null?tee:nee,b=I(B,ee),w0){le=0;do{if(w0=!1,S0=0,25<=le)throw Error(o(301));le+=1,gs=Ws=null,E.updateQueue=null,fv.current=ree,b=I(B,ee)}while(w0)}if(fv.current=yv,E=Ws!==null&&Ws.next!==null,Ch=0,gs=Ws=Ti=null,dv=!1,E)throw Error(o(300));return b}function Bw(){var b=S0!==0;return S0=0,b}function yc(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gs===null?Ti.memoizedState=gs=b:gs=gs.next=b,gs}function Dl(){if(Ws===null){var b=Ti.alternate;b=b!==null?b.memoizedState:null}else b=Ws.next;var E=gs===null?Ti.memoizedState:gs.next;if(E!==null)gs=E,Ws=b;else{if(b===null)throw Error(o(310));Ws=b,b={memoizedState:Ws.memoizedState,baseState:Ws.baseState,baseQueue:Ws.baseQueue,queue:Ws.queue,next:null},gs===null?Ti.memoizedState=gs=b:gs=gs.next=b}return gs}function Ff(b,E){return typeof E=="function"?E(b):E}function hv(b){var E=Dl(),I=E.queue;if(I===null)throw Error(o(311));I.lastRenderedReducer=b;var B=Ws,ee=B.baseQueue,le=I.pending;if(le!==null){if(ee!==null){var Oe=ee.next;ee.next=le.next,le.next=Oe}B.baseQueue=ee=le,I.pending=null}if(ee!==null){le=ee.next,B=B.baseState;var Je=Oe=null,Mt=null,Wt=le;do{var hn=Wt.lane;if((Ch&hn)===hn)Mt!==null&&(Mt=Mt.next={lane:0,action:Wt.action,hasEagerState:Wt.hasEagerState,eagerState:Wt.eagerState,next:null}),B=Wt.hasEagerState?Wt.eagerState:b(B,Wt.action);else{var $n={lane:hn,action:Wt.action,hasEagerState:Wt.hasEagerState,eagerState:Wt.eagerState,next:null};Mt===null?(Je=Mt=$n,Oe=B):Mt=Mt.next=$n,Ti.lanes|=hn,Ih|=hn}Wt=Wt.next}while(Wt!==null&&Wt!==le);Mt===null?Oe=B:Mt.next=Je,gr(B,E.memoizedState)||(ea=!0),E.memoizedState=B,E.baseState=Oe,E.baseQueue=Mt,I.lastRenderedState=B}if(b=I.interleaved,b!==null){ee=b;do le=ee.lane,Ti.lanes|=le,Ih|=le,ee=ee.next;while(ee!==b)}else ee===null&&(I.lanes=0);return[E.memoizedState,I.dispatch]}function pv(b){var E=Dl(),I=E.queue;if(I===null)throw Error(o(311));I.lastRenderedReducer=b;var B=I.dispatch,ee=I.pending,le=E.memoizedState;if(ee!==null){I.pending=null;var Oe=ee=ee.next;do le=b(le,Oe.action),Oe=Oe.next;while(Oe!==ee);gr(le,E.memoizedState)||(ea=!0),E.memoizedState=le,E.baseQueue===null&&(E.baseState=le),I.lastRenderedState=le}return[le,B]}function S9(){}function T9(b,E){var I=Ti,B=Dl(),ee=E(),le=!gr(B.memoizedState,ee);if(le&&(B.memoizedState=ee,ea=!0),B=B.queue,A0(C9.bind(null,I,B,b),[b]),B.getSnapshot!==E||le||gs!==null&&gs.memoizedState.tag&1){if(I.flags|=2048,T0(9,M9.bind(null,I,B,ee,E),void 0,null),$i===null)throw Error(o(349));Ch&30||A9(I,E,ee)}return ee}function A9(b,E,I){b.flags|=16384,b={getSnapshot:E,value:I},E=Ti.updateQueue,E===null?(E={lastEffect:null,stores:null},Ti.updateQueue=E,E.stores=[b]):(I=E.stores,I===null?E.stores=[b]:I.push(b))}function M9(b,E,I,B){E.value=I,E.getSnapshot=B,R9(E)&&ba(b,1,-1)}function C9(b,E,I){return I(function(){R9(E)&&ba(b,1,-1)})}function R9(b){var E=b.getSnapshot;b=b.value;try{var I=E();return!gr(b,I)}catch{return!0}}function zw(b){var E=yc();return typeof b=="function"&&(b=b()),E.memoizedState=E.baseState=b,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ff,lastRenderedState:b},E.queue=b,b=b.dispatch=eee.bind(null,Ti,b),[E.memoizedState,b]}function T0(b,E,I,B){return b={tag:b,create:E,destroy:I,deps:B,next:null},E=Ti.updateQueue,E===null?(E={lastEffect:null,stores:null},Ti.updateQueue=E,E.lastEffect=b.next=b):(I=E.lastEffect,I===null?E.lastEffect=b.next=b:(B=I.next,I.next=b,b.next=B,E.lastEffect=b)),b}function I9(){return Dl().memoizedState}function mv(b,E,I,B){var ee=yc();Ti.flags|=b,ee.memoizedState=T0(1|E,I,void 0,B===void 0?null:B)}function gv(b,E,I,B){var ee=Dl();B=B===void 0?null:B;var le=void 0;if(Ws!==null){var Oe=Ws.memoizedState;if(le=Oe.destroy,B!==null&&Fw(B,Oe.deps)){ee.memoizedState=T0(E,I,le,B);return}}Ti.flags|=b,ee.memoizedState=T0(1|E,I,le,B)}function Hw(b,E){return mv(8390656,8,b,E)}function A0(b,E){return gv(2048,8,b,E)}function P9(b,E){return gv(4,2,b,E)}function k9(b,E){return gv(4,4,b,E)}function L9(b,E){if(typeof E=="function")return b=b(),E(b),function(){E(null)};if(E!=null)return b=b(),E.current=b,function(){E.current=null}}function D9(b,E,I){return I=I!=null?I.concat([b]):null,gv(4,4,L9.bind(null,E,b),I)}function Gw(){}function N9(b,E){var I=Dl();E=E===void 0?null:E;var B=I.memoizedState;return B!==null&&E!==null&&Fw(E,B[1])?B[0]:(I.memoizedState=[b,E],b)}function O9(b,E){var I=Dl();E=E===void 0?null:E;var B=I.memoizedState;return B!==null&&E!==null&&Fw(E,B[1])?B[0]:(b=b(),I.memoizedState=[b,E],b)}function QJ(b,E){var I=je;je=I!==0&&4>I?I:4,b(!0);var B=_a.transition;_a.transition={};try{b(!1),E()}finally{je=I,_a.transition=B}}function F9(){return Dl().memoizedState}function JJ(b,E,I){var B=Su(b);I={lane:B,action:I,hasEagerState:!1,eagerState:null,next:null},U9(b)?B9(E,I):(z9(b,E,I),I=mo(),b=ba(b,B,I),b!==null&&H9(b,E,B))}function eee(b,E,I){var B=Su(b),ee={lane:B,action:I,hasEagerState:!1,eagerState:null,next:null};if(U9(b))B9(E,ee);else{z9(b,E,ee);var le=b.alternate;if(b.lanes===0&&(le===null||le.lanes===0)&&(le=E.lastRenderedReducer,le!==null))try{var Oe=E.lastRenderedState,Je=le(Oe,I);if(ee.hasEagerState=!0,ee.eagerState=Je,gr(Je,Oe))return}catch{}finally{}I=mo(),b=ba(b,B,I),b!==null&&H9(b,E,B)}}function U9(b){var E=b.alternate;return b===Ti||E!==null&&E===Ti}function B9(b,E){w0=dv=!0;var I=b.pending;I===null?E.next=E:(E.next=I.next,I.next=E),b.pending=E}function z9(b,E,I){$i!==null&&b.mode&1&&!(ir&2)?(b=E.interleaved,b===null?(I.next=I,Zo===null?Zo=[E]:Zo.push(E)):(I.next=b.next,b.next=I),E.interleaved=I):(b=E.pending,b===null?I.next=I:(I.next=b.next,b.next=I),E.pending=I)}function H9(b,E,I){if(I&4194240){var B=E.lanes;B&=b.pendingLanes,I|=B,E.lanes=I,Fe(b,I)}}var yv={readContext:ki,useCallback:$s,useContext:$s,useEffect:$s,useImperativeHandle:$s,useInsertionEffect:$s,useLayoutEffect:$s,useMemo:$s,useReducer:$s,useRef:$s,useState:$s,useDebugValue:$s,useDeferredValue:$s,useTransition:$s,useMutableSource:$s,useSyncExternalStore:$s,useId:$s,unstable_isNewReconciler:!1},tee={readContext:ki,useCallback:function(b,E){return yc().memoizedState=[b,E===void 0?null:E],b},useContext:ki,useEffect:Hw,useImperativeHandle:function(b,E,I){return I=I!=null?I.concat([b]):null,mv(4194308,4,L9.bind(null,E,b),I)},useLayoutEffect:function(b,E){return mv(4194308,4,b,E)},useInsertionEffect:function(b,E){return mv(4,2,b,E)},useMemo:function(b,E){var I=yc();return E=E===void 0?null:E,b=b(),I.memoizedState=[b,E],b},useReducer:function(b,E,I){var B=yc();return E=I!==void 0?I(E):E,B.memoizedState=B.baseState=E,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:E},B.queue=b,b=b.dispatch=JJ.bind(null,Ti,b),[B.memoizedState,b]},useRef:function(b){var E=yc();return b={current:b},E.memoizedState=b},useState:zw,useDebugValue:Gw,useDeferredValue:function(b){var E=zw(b),I=E[0],B=E[1];return Hw(function(){var ee=_a.transition;_a.transition={};try{B(b)}finally{_a.transition=ee}},[b]),I},useTransition:function(){var b=zw(!1),E=b[0];return b=QJ.bind(null,b[1]),yc().memoizedState=b,[E,b]},useMutableSource:function(){},useSyncExternalStore:function(b,E,I){var B=Ti,ee=yc();if(ui){if(I===void 0)throw Error(o(407));I=I()}else{if(I=E(),$i===null)throw Error(o(349));Ch&30||A9(B,E,I)}ee.memoizedState=I;var le={value:I,getSnapshot:E};return ee.queue=le,Hw(C9.bind(null,B,le,b),[b]),B.flags|=2048,T0(9,M9.bind(null,B,le,I,E),void 0,null),I},useId:function(){var b=yc(),E=$i.identifierPrefix;if(ui){var I=gc,B=mc;I=(B&~(1<<32-Un(B)-1)).toString(32)+I,E=":"+E+"R"+I,I=S0++,0<I&&(E+="H"+I.toString(32)),E+=":"}else I=ZJ++,E=":"+E+"r"+I.toString(32)+":";return b.memoizedState=E},unstable_isNewReconciler:!1},nee={readContext:ki,useCallback:N9,useContext:ki,useEffect:A0,useImperativeHandle:D9,useInsertionEffect:P9,useLayoutEffect:k9,useMemo:O9,useReducer:hv,useRef:I9,useState:function(){return hv(Ff)},useDebugValue:Gw,useDeferredValue:function(b){var E=hv(Ff),I=E[0],B=E[1];return A0(function(){var ee=_a.transition;_a.transition={};try{B(b)}finally{_a.transition=ee}},[b]),I},useTransition:function(){var b=hv(Ff)[0],E=Dl().memoizedState;return[b,E]},useMutableSource:S9,useSyncExternalStore:T9,useId:F9,unstable_isNewReconciler:!1},ree={readContext:ki,useCallback:N9,useContext:ki,useEffect:A0,useImperativeHandle:D9,useInsertionEffect:P9,useLayoutEffect:k9,useMemo:O9,useReducer:pv,useRef:I9,useState:function(){return pv(Ff)},useDebugValue:Gw,useDeferredValue:function(b){var E=pv(Ff),I=E[0],B=E[1];return A0(function(){var ee=_a.transition;_a.transition={};try{B(b)}finally{_a.transition=ee}},[b]),I},useTransition:function(){var b=pv(Ff)[0],E=Dl().memoizedState;return[b,E]},useMutableSource:S9,useSyncExternalStore:T9,useId:F9,unstable_isNewReconciler:!1};function jw(b,E){try{var I="",B=E;do I+=Df(B),B=B.return;while(B);var ee=I}catch(le){ee=`
Error generating stack: `+le.message+`
`+le.stack}return{value:b,source:E,stack:ee}}function Vw(b,E){try{console.error(E.value)}catch(I){setTimeout(function(){throw I})}}var iee=typeof WeakMap=="function"?WeakMap:Map;function G9(b,E,I){I=pc(-1,I),I.tag=3,I.payload={element:null};var B=E.value;return I.callback=function(){Lv||(Lv=!0,lS=B),Vw(b,E)},I}function j9(b,E,I){I=pc(-1,I),I.tag=3;var B=b.type.getDerivedStateFromError;if(typeof B=="function"){var ee=E.value;I.payload=function(){return B(ee)},I.callback=function(){Vw(b,E)}}var le=b.stateNode;return le!==null&&typeof le.componentDidCatch=="function"&&(I.callback=function(){Vw(b,E),typeof B!="function"&&(Eu===null?Eu=new Set([this]):Eu.add(this));var Oe=E.stack;this.componentDidCatch(E.value,{componentStack:Oe!==null?Oe:""})}),I}function V9(b,E,I){var B=b.pingCache;if(B===null){B=b.pingCache=new iee;var ee=new Set;B.set(E,ee)}else ee=B.get(E),ee===void 0&&(ee=new Set,B.set(E,ee));ee.has(I)||(ee.add(I),b=vee.bind(null,b,E,I),E.then(b,b))}function W9(b){do{var E;if((E=b.tag===13)&&(E=b.memoizedState,E=E!==null?E.dehydrated!==null:!0),E)return b;b=b.return}while(b!==null);return null}function $9(b,E,I,B,ee){return b.mode&1?(b.flags|=65536,b.lanes=ee,b):(b===E?b.flags|=65536:(b.flags|=128,I.flags|=131072,I.flags&=-52805,I.tag===1&&(I.alternate===null?I.tag=17:(E=pc(-1,1),E.tag=2,bu(I,E))),I.lanes|=1),b)}function Nl(b){b.flags|=4}function X9(b,E){if(b!==null&&b.child===E.child)return!0;if(E.flags&16)return!1;for(b=E.child;b!==null;){if(b.flags&12854||b.subtreeFlags&12854)return!1;b=b.sibling}return!0}var M0,C0,vv,xv;if(Te)M0=function(b,E){for(var I=E.child;I!==null;){if(I.tag===5||I.tag===6)se(b,I.stateNode);else if(I.tag!==4&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===E)break;for(;I.sibling===null;){if(I.return===null||I.return===E)return;I=I.return}I.sibling.return=I.return,I=I.sibling}},C0=function(){},vv=function(b,E,I,B,ee){if(b=b.memoizedProps,b!==B){var le=E.stateNode,Oe=Ll(xa.current);I=te(le,I,b,B,ee,Oe),(E.updateQueue=I)&&Nl(E)}},xv=function(b,E,I,B){I!==B&&Nl(E)};else if(_e){M0=function(b,E,I,B){for(var ee=E.child;ee!==null;){if(ee.tag===5){var le=ee.stateNode;I&&B&&(le=Vt(le,ee.type,ee.memoizedProps,ee)),se(b,le)}else if(ee.tag===6)le=ee.stateNode,I&&B&&(le=Gn(le,ee.memoizedProps,ee)),se(b,le);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)le=ee.child,le!==null&&(le.return=ee),M0(b,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===E)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===E)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};var q9=function(b,E,I,B){for(var ee=E.child;ee!==null;){if(ee.tag===5){var le=ee.stateNode;I&&B&&(le=Vt(le,ee.type,ee.memoizedProps,ee)),Kt(b,le)}else if(ee.tag===6)le=ee.stateNode,I&&B&&(le=Gn(le,ee.memoizedProps,ee)),Kt(b,le);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)le=ee.child,le!==null&&(le.return=ee),q9(b,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===E)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===E)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};C0=function(b,E){var I=E.stateNode;if(!X9(b,E)){b=I.containerInfo;var B=Ct(b);q9(B,E,!1,!1),I.pendingChildren=B,Nl(E),cn(b,B)}},vv=function(b,E,I,B,ee){var le=b.stateNode,Oe=b.memoizedProps;if((b=X9(b,E))&&Oe===B)E.stateNode=le;else{var Je=E.stateNode,Mt=Ll(xa.current),Wt=null;Oe!==B&&(Wt=te(Je,I,Oe,B,ee,Mt)),b&&Wt===null?E.stateNode=le:(le=kt(le,Wt,I,Oe,B,E,b,Je),ue(le,I,B,ee,Mt)&&Nl(E),E.stateNode=le,b?Nl(E):M0(le,E,!1,!1))}},xv=function(b,E,I,B){I!==B?(b=Ll(Ah.current),I=Ll(xa.current),E.stateNode=X(B,b,I,E),Nl(E)):E.stateNode=b.stateNode}}else C0=function(){},vv=function(){},xv=function(){};function R0(b,E){if(!ui)switch(b.tailMode){case"hidden":E=b.tail;for(var I=null;E!==null;)E.alternate!==null&&(I=E),E=E.sibling;I===null?b.tail=null:I.sibling=null;break;case"collapsed":I=b.tail;for(var B=null;I!==null;)I.alternate!==null&&(B=I),I=I.sibling;B===null?E||b.tail===null?b.tail=null:b.tail.sibling=null:B.sibling=null}}function Xs(b){var E=b.alternate!==null&&b.alternate.child===b.child,I=0,B=0;if(E)for(var ee=b.child;ee!==null;)I|=ee.lanes|ee.childLanes,B|=ee.subtreeFlags&14680064,B|=ee.flags&14680064,ee.return=b,ee=ee.sibling;else for(ee=b.child;ee!==null;)I|=ee.lanes|ee.childLanes,B|=ee.subtreeFlags,B|=ee.flags,ee.return=b,ee=ee.sibling;return b.subtreeFlags|=B,b.childLanes=I,E}function see(b,E,I){var B=E.pendingProps;switch(Rw(E),E.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xs(E),null;case 1:return wn(E.type)&&Zn(),Xs(E),null;case 3:return B=E.stateNode,Mh(),Ht(Zt),Ht(En),Ow(),B.pendingContext&&(B.context=B.pendingContext,B.pendingContext=null),(b===null||b.child===null)&&(x0(E)?Nl(E):b===null||b.memoizedState.isDehydrated&&!(E.flags&256)||(E.flags|=1024,ol!==null&&(fS(ol),ol=null))),C0(b,E),Xs(E),null;case 5:Dw(E),I=Ll(Ah.current);var ee=E.type;if(b!==null&&E.stateNode!=null)vv(b,E,ee,B,I),b.ref!==E.ref&&(E.flags|=512,E.flags|=2097152);else{if(!B){if(E.stateNode===null)throw Error(o(166));return Xs(E),null}if(b=Ll(xa.current),x0(E)){if(!Re)throw Error(o(175));b=pe(E.stateNode,E.type,E.memoizedProps,I,b,E,!v0),E.updateQueue=b,b!==null&&Nl(E)}else{var le=P(ee,B,I,b,E);M0(le,E,!1,!1),E.stateNode=le,ue(le,ee,B,I,b)&&Nl(E)}E.ref!==null&&(E.flags|=512,E.flags|=2097152)}return Xs(E),null;case 6:if(b&&E.stateNode!=null)xv(b,E,b.memoizedProps,B);else{if(typeof B!="string"&&E.stateNode===null)throw Error(o(166));if(b=Ll(Ah.current),I=Ll(xa.current),x0(E)){if(!Re)throw Error(o(176));if(b=E.stateNode,B=E.memoizedProps,(I=we(b,B,E,!v0))&&(ee=Qo,ee!==null))switch(le=(ee.mode&1)!==0,ee.tag){case 3:Ue(ee.stateNode.containerInfo,b,B,le);break;case 5:He(ee.type,ee.memoizedProps,ee.stateNode,b,B,le)}I&&Nl(E)}else E.stateNode=X(B,b,I,E)}return Xs(E),null;case 13:if(Ht(yi),B=E.memoizedState,ui&&Jo!==null&&E.mode&1&&!(E.flags&128)){for(b=Jo;b;)b=Hr(b);return Sh(),E.flags|=98560,E}if(B!==null&&B.dehydrated!==null){if(B=x0(E),b===null){if(!B)throw Error(o(318));if(!Re)throw Error(o(344));if(b=E.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(o(317));qe(b,E)}else Sh(),!(E.flags&128)&&(E.memoizedState=null),E.flags|=4;return Xs(E),null}return ol!==null&&(fS(ol),ol=null),E.flags&128?(E.lanes=I,E):(B=B!==null,I=!1,b===null?x0(E):I=b.memoizedState!==null,B&&!I&&(E.child.flags|=8192,E.mode&1&&(b===null||yi.current&1?is===0&&(is=3):hS())),E.updateQueue!==null&&(E.flags|=4),Xs(E),null);case 4:return Mh(),C0(b,E),b===null&&Ce(E.stateNode.containerInfo),Xs(E),null;case 10:return ms(E.type._context),Xs(E),null;case 17:return wn(E.type)&&Zn(),Xs(E),null;case 19:if(Ht(yi),ee=E.memoizedState,ee===null)return Xs(E),null;if(B=(E.flags&128)!==0,le=ee.rendering,le===null)if(B)R0(ee,!1);else{if(is!==0||b!==null&&b.flags&128)for(b=E.child;b!==null;){if(le=uv(b),le!==null){for(E.flags|=128,R0(ee,!1),b=le.updateQueue,b!==null&&(E.updateQueue=b,E.flags|=4),E.subtreeFlags=0,b=I,B=E.child;B!==null;)I=B,ee=b,I.flags&=14680066,le=I.alternate,le===null?(I.childLanes=0,I.lanes=ee,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=le.childLanes,I.lanes=le.lanes,I.child=le.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=le.memoizedProps,I.memoizedState=le.memoizedState,I.updateQueue=le.updateQueue,I.type=le.type,ee=le.dependencies,I.dependencies=ee===null?null:{lanes:ee.lanes,firstContext:ee.firstContext}),B=B.sibling;return Gt(yi,yi.current&1|2),E.child}b=b.sibling}ee.tail!==null&&dt()>aS&&(E.flags|=128,B=!0,R0(ee,!1),E.lanes=4194304)}else{if(!B)if(b=uv(le),b!==null){if(E.flags|=128,B=!0,b=b.updateQueue,b!==null&&(E.updateQueue=b,E.flags|=4),R0(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!le.alternate&&!ui)return Xs(E),null}else 2*dt()-ee.renderingStartTime>aS&&I!==1073741824&&(E.flags|=128,B=!0,R0(ee,!1),E.lanes=4194304);ee.isBackwards?(le.sibling=E.child,E.child=le):(b=ee.last,b!==null?b.sibling=le:E.child=le,ee.last=le)}return ee.tail!==null?(E=ee.tail,ee.rendering=E,ee.tail=E.sibling,ee.renderingStartTime=dt(),E.sibling=null,b=yi.current,Gt(yi,B?b&1|2:b&1),E):(Xs(E),null);case 22:case 23:return dS(),B=E.memoizedState!==null,b!==null&&b.memoizedState!==null!==B&&(E.flags|=8192),B&&E.mode&1?ta&1073741824&&(Xs(E),Te&&E.subtreeFlags&6&&(E.flags|=8192)):Xs(E),null;case 24:return null;case 25:return null}throw Error(o(156,E.tag))}var oee=a.ReactCurrentOwner,ea=!1;function po(b,E,I,B){E.child=b===null?E9(E,null,I,B):Th(E,b.child,I,B)}function Y9(b,E,I,B,ee){I=I.render;var le=E.ref;return Pi(E,ee),B=Uw(b,E,I,B,le,ee),I=Bw(),b!==null&&!ea?(E.updateQueue=b.updateQueue,E.flags&=-2053,b.lanes&=~ee,vc(b,E,ee)):(ui&&I&&Cw(E),E.flags|=1,po(b,E,B,ee),E.child)}function K9(b,E,I,B,ee){if(b===null){var le=I.type;return typeof le=="function"&&!pS(le)&&le.defaultProps===void 0&&I.compare===null&&I.defaultProps===void 0?(E.tag=15,E.type=le,Z9(b,E,le,B,ee)):(b=zv(I.type,null,B,E,E.mode,ee),b.ref=E.ref,b.return=E,E.child=b)}if(le=b.child,!(b.lanes&ee)){var Oe=le.memoizedProps;if(I=I.compare,I=I!==null?I:Lf,I(Oe,B)&&b.ref===E.ref)return vc(b,E,ee)}return E.flags|=1,b=Au(le,B),b.ref=E.ref,b.return=E,E.child=b}function Z9(b,E,I,B,ee){if(b!==null&&Lf(b.memoizedProps,B)&&b.ref===E.ref)if(ea=!1,(b.lanes&ee)!==0)b.flags&131072&&(ea=!0);else return E.lanes=b.lanes,vc(b,E,ee);return Ww(b,E,I,B,ee)}function Q9(b,E,I){var B=E.pendingProps,ee=B.children,le=b!==null?b.memoizedState:null;if(B.mode==="hidden")if(!(E.mode&1))E.memoizedState={baseLanes:0,cachePool:null},Gt(Rh,ta),ta|=I;else if(I&1073741824)E.memoizedState={baseLanes:0,cachePool:null},B=le!==null?le.baseLanes:I,Gt(Rh,ta),ta|=B;else return b=le!==null?le.baseLanes|I:I,E.lanes=E.childLanes=1073741824,E.memoizedState={baseLanes:b,cachePool:null},E.updateQueue=null,Gt(Rh,ta),ta|=b,null;else le!==null?(B=le.baseLanes|I,E.memoizedState=null):B=I,Gt(Rh,ta),ta|=B;return po(b,E,ee,I),E.child}function J9(b,E){var I=E.ref;(b===null&&I!==null||b!==null&&b.ref!==I)&&(E.flags|=512,E.flags|=2097152)}function Ww(b,E,I,B,ee){var le=wn(I)?qt:En.current;return le=jn(E,le),Pi(E,ee),I=Uw(b,E,I,B,le,ee),B=Bw(),b!==null&&!ea?(E.updateQueue=b.updateQueue,E.flags&=-2053,b.lanes&=~ee,vc(b,E,ee)):(ui&&B&&Cw(E),E.flags|=1,po(b,E,I,ee),E.child)}function e7(b,E,I,B,ee){if(wn(I)){var le=!0;On(E)}else le=!1;if(Pi(E,ee),E.stateNode===null)b!==null&&(b.alternate=null,E.alternate=null,E.flags|=2),p9(E,I,B),Mw(E,I,B,ee),B=!0;else if(b===null){var Oe=E.stateNode,Je=E.memoizedProps;Oe.props=Je;var Mt=Oe.context,Wt=I.contextType;typeof Wt=="object"&&Wt!==null?Wt=ki(Wt):(Wt=wn(I)?qt:En.current,Wt=jn(E,Wt));var hn=I.getDerivedStateFromProps,$n=typeof hn=="function"||typeof Oe.getSnapshotBeforeUpdate=="function";$n||typeof Oe.UNSAFE_componentWillReceiveProps!="function"&&typeof Oe.componentWillReceiveProps!="function"||(Je!==B||Mt!==Wt)&&m9(E,Oe,B,Wt),_u=!1;var Rn=E.memoizedState;Oe.state=Rn,sv(E,B,Oe,ee),Mt=E.memoizedState,Je!==B||Rn!==Mt||Zt.current||_u?(typeof hn=="function"&&(Aw(E,I,hn,B),Mt=E.memoizedState),(Je=_u||h9(E,I,Je,B,Rn,Mt,Wt))?($n||typeof Oe.UNSAFE_componentWillMount!="function"&&typeof Oe.componentWillMount!="function"||(typeof Oe.componentWillMount=="function"&&Oe.componentWillMount(),typeof Oe.UNSAFE_componentWillMount=="function"&&Oe.UNSAFE_componentWillMount()),typeof Oe.componentDidMount=="function"&&(E.flags|=4194308)):(typeof Oe.componentDidMount=="function"&&(E.flags|=4194308),E.memoizedProps=B,E.memoizedState=Mt),Oe.props=B,Oe.state=Mt,Oe.context=Wt,B=Je):(typeof Oe.componentDidMount=="function"&&(E.flags|=4194308),B=!1)}else{Oe=E.stateNode,c9(b,E),Je=E.memoizedProps,Wt=E.type===E.elementType?Je:fo(E.type,Je),Oe.props=Wt,$n=E.pendingProps,Rn=Oe.context,Mt=I.contextType,typeof Mt=="object"&&Mt!==null?Mt=ki(Mt):(Mt=wn(I)?qt:En.current,Mt=jn(E,Mt));var Xr=I.getDerivedStateFromProps;(hn=typeof Xr=="function"||typeof Oe.getSnapshotBeforeUpdate=="function")||typeof Oe.UNSAFE_componentWillReceiveProps!="function"&&typeof Oe.componentWillReceiveProps!="function"||(Je!==$n||Rn!==Mt)&&m9(E,Oe,B,Mt),_u=!1,Rn=E.memoizedState,Oe.state=Rn,sv(E,B,Oe,ee);var Tn=E.memoizedState;Je!==$n||Rn!==Tn||Zt.current||_u?(typeof Xr=="function"&&(Aw(E,I,Xr,B),Tn=E.memoizedState),(Wt=_u||h9(E,I,Wt,B,Rn,Tn,Mt)||!1)?(hn||typeof Oe.UNSAFE_componentWillUpdate!="function"&&typeof Oe.componentWillUpdate!="function"||(typeof Oe.componentWillUpdate=="function"&&Oe.componentWillUpdate(B,Tn,Mt),typeof Oe.UNSAFE_componentWillUpdate=="function"&&Oe.UNSAFE_componentWillUpdate(B,Tn,Mt)),typeof Oe.componentDidUpdate=="function"&&(E.flags|=4),typeof Oe.getSnapshotBeforeUpdate=="function"&&(E.flags|=1024)):(typeof Oe.componentDidUpdate!="function"||Je===b.memoizedProps&&Rn===b.memoizedState||(E.flags|=4),typeof Oe.getSnapshotBeforeUpdate!="function"||Je===b.memoizedProps&&Rn===b.memoizedState||(E.flags|=1024),E.memoizedProps=B,E.memoizedState=Tn),Oe.props=B,Oe.state=Tn,Oe.context=Mt,B=Wt):(typeof Oe.componentDidUpdate!="function"||Je===b.memoizedProps&&Rn===b.memoizedState||(E.flags|=4),typeof Oe.getSnapshotBeforeUpdate!="function"||Je===b.memoizedProps&&Rn===b.memoizedState||(E.flags|=1024),B=!1)}return $w(b,E,I,B,le,ee)}function $w(b,E,I,B,ee,le){J9(b,E);var Oe=(E.flags&128)!==0;if(!B&&!Oe)return ee&&on(E,I,!1),vc(b,E,le);B=E.stateNode,oee.current=E;var Je=Oe&&typeof I.getDerivedStateFromError!="function"?null:B.render();return E.flags|=1,b!==null&&Oe?(E.child=Th(E,b.child,null,le),E.child=Th(E,null,Je,le)):po(b,E,Je,le),E.memoizedState=B.state,ee&&on(E,I,!0),E.child}function t7(b){var E=b.stateNode;E.pendingContext?Nn(b,E.pendingContext,E.pendingContext!==E.context):E.context&&Nn(b,E.context,!1),Lw(b,E.containerInfo)}function n7(b,E,I,B,ee){return Sh(),kw(ee),E.flags|=256,po(b,E,I,B),E.child}var _v={dehydrated:null,treeContext:null,retryLane:0};function bv(b){return{baseLanes:b,cachePool:null}}function r7(b,E,I){var B=E.pendingProps,ee=yi.current,le=!1,Oe=(E.flags&128)!==0,Je;if((Je=Oe)||(Je=b!==null&&b.memoizedState===null?!1:(ee&2)!==0),Je?(le=!0,E.flags&=-129):(b===null||b.memoizedState!==null)&&(ee|=1),Gt(yi,ee&1),b===null)return Pw(E),b=E.memoizedState,b!==null&&(b=b.dehydrated,b!==null)?(E.mode&1?mi(b)?E.lanes=8:E.lanes=1073741824:E.lanes=1,null):(ee=B.children,b=B.fallback,le?(B=E.mode,le=E.child,ee={mode:"hidden",children:ee},!(B&1)&&le!==null?(le.childLanes=0,le.pendingProps=ee):le=Hv(ee,B,0,null),b=jf(b,B,I,null),le.return=E,b.return=E,le.sibling=b,E.child=le,E.child.memoizedState=bv(I),E.memoizedState=_v,b):Xw(E,ee));if(ee=b.memoizedState,ee!==null){if(Je=ee.dehydrated,Je!==null){if(Oe)return E.flags&256?(E.flags&=-257,Ev(b,E,I,Error(o(422)))):E.memoizedState!==null?(E.child=b.child,E.flags|=128,null):(le=B.fallback,ee=E.mode,B=Hv({mode:"visible",children:B.children},ee,0,null),le=jf(le,ee,I,null),le.flags|=2,B.return=E,le.return=E,B.sibling=le,E.child=B,E.mode&1&&Th(E,b.child,null,I),E.child.memoizedState=bv(I),E.memoizedState=_v,le);if(!(E.mode&1))E=Ev(b,E,I,null);else if(mi(Je))E=Ev(b,E,I,Error(o(419)));else if(B=(I&b.childLanes)!==0,ea||B){if(B=$i,B!==null){switch(I&-I){case 4:le=2;break;case 16:le=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:le=32;break;case 536870912:le=268435456;break;default:le=0}B=le&(B.suspendedLanes|I)?0:le,B!==0&&B!==ee.retryLane&&(ee.retryLane=B,ba(b,B,-1))}hS(),E=Ev(b,E,I,Error(o(421)))}else zr(Je)?(E.flags|=128,E.child=b.child,E=xee.bind(null,b),gi(Je,E),E=null):(I=ee.treeContext,Re&&(Jo=Wi(Je),Qo=E,ui=!0,ol=null,v0=!1,I!==null&&(ya[va++]=mc,ya[va++]=gc,ya[va++]=Nf,mc=I.id,gc=I.overflow,Nf=E)),E=Xw(E,E.pendingProps.children),E.flags|=4096);return E}return le?(B=s7(b,E,B.children,B.fallback,I),le=E.child,ee=b.child.memoizedState,le.memoizedState=ee===null?bv(I):{baseLanes:ee.baseLanes|I,cachePool:null},le.childLanes=b.childLanes&~I,E.memoizedState=_v,B):(I=i7(b,E,B.children,I),E.memoizedState=null,I)}return le?(B=s7(b,E,B.children,B.fallback,I),le=E.child,ee=b.child.memoizedState,le.memoizedState=ee===null?bv(I):{baseLanes:ee.baseLanes|I,cachePool:null},le.childLanes=b.childLanes&~I,E.memoizedState=_v,B):(I=i7(b,E,B.children,I),E.memoizedState=null,I)}function Xw(b,E){return E=Hv({mode:"visible",children:E},b.mode,0,null),E.return=b,b.child=E}function i7(b,E,I,B){var ee=b.child;return b=ee.sibling,I=Au(ee,{mode:"visible",children:I}),!(E.mode&1)&&(I.lanes=B),I.return=E,I.sibling=null,b!==null&&(B=E.deletions,B===null?(E.deletions=[b],E.flags|=16):B.push(b)),E.child=I}function s7(b,E,I,B,ee){var le=E.mode;b=b.child;var Oe=b.sibling,Je={mode:"hidden",children:I};return!(le&1)&&E.child!==b?(I=E.child,I.childLanes=0,I.pendingProps=Je,E.deletions=null):(I=Au(b,Je),I.subtreeFlags=b.subtreeFlags&14680064),Oe!==null?B=Au(Oe,B):(B=jf(B,le,ee,null),B.flags|=2),B.return=E,I.return=E,I.sibling=B,E.child=I,B}function Ev(b,E,I,B){return B!==null&&kw(B),Th(E,b.child,null,I),b=Xw(E,E.pendingProps.children),b.flags|=2,E.memoizedState=null,b}function o7(b,E,I){b.lanes|=E;var B=b.alternate;B!==null&&(B.lanes|=E),ho(b.return,E,I)}function qw(b,E,I,B,ee){var le=b.memoizedState;le===null?b.memoizedState={isBackwards:E,rendering:null,renderingStartTime:0,last:B,tail:I,tailMode:ee}:(le.isBackwards=E,le.rendering=null,le.renderingStartTime=0,le.last=B,le.tail=I,le.tailMode=ee)}function a7(b,E,I){var B=E.pendingProps,ee=B.revealOrder,le=B.tail;if(po(b,E,B.children,I),B=yi.current,B&2)B=B&1|2,E.flags|=128;else{if(b!==null&&b.flags&128)e:for(b=E.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&o7(b,I,E);else if(b.tag===19)o7(b,I,E);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===E)break e;for(;b.sibling===null;){if(b.return===null||b.return===E)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}B&=1}if(Gt(yi,B),!(E.mode&1))E.memoizedState=null;else switch(ee){case"forwards":for(I=E.child,ee=null;I!==null;)b=I.alternate,b!==null&&uv(b)===null&&(ee=I),I=I.sibling;I=ee,I===null?(ee=E.child,E.child=null):(ee=I.sibling,I.sibling=null),qw(E,!1,ee,I,le);break;case"backwards":for(I=null,ee=E.child,E.child=null;ee!==null;){if(b=ee.alternate,b!==null&&uv(b)===null){E.child=ee;break}b=ee.sibling,ee.sibling=I,I=ee,ee=b}qw(E,!0,I,null,le);break;case"together":qw(E,!1,null,null,void 0);break;default:E.memoizedState=null}return E.child}function vc(b,E,I){if(b!==null&&(E.dependencies=b.dependencies),Ih|=E.lanes,!(I&E.childLanes))return null;if(b!==null&&E.child!==b.child)throw Error(o(153));if(E.child!==null){for(b=E.child,I=Au(b,b.pendingProps),E.child=I,I.return=E;b.sibling!==null;)b=b.sibling,I=I.sibling=Au(b,b.pendingProps),I.return=E;I.sibling=null}return E.child}function aee(b,E,I){switch(E.tag){case 3:t7(E),Sh();break;case 5:w9(E);break;case 1:wn(E.type)&&On(E);break;case 4:Lw(E,E.stateNode.containerInfo);break;case 10:rv(E,E.type._context,E.memoizedProps.value);break;case 13:var B=E.memoizedState;if(B!==null)return B.dehydrated!==null?(Gt(yi,yi.current&1),E.flags|=128,null):I&E.child.childLanes?r7(b,E,I):(Gt(yi,yi.current&1),b=vc(b,E,I),b!==null?b.sibling:null);Gt(yi,yi.current&1);break;case 19:if(B=(I&E.childLanes)!==0,b.flags&128){if(B)return a7(b,E,I);E.flags|=128}var ee=E.memoizedState;if(ee!==null&&(ee.rendering=null,ee.tail=null,ee.lastEffect=null),Gt(yi,yi.current),B)break;return null;case 22:case 23:return E.lanes=0,Q9(b,E,I)}return vc(b,E,I)}function lee(b,E){switch(Rw(E),E.tag){case 1:return wn(E.type)&&Zn(),b=E.flags,b&65536?(E.flags=b&-65537|128,E):null;case 3:return Mh(),Ht(Zt),Ht(En),Ow(),b=E.flags,b&65536&&!(b&128)?(E.flags=b&-65537|128,E):null;case 5:return Dw(E),null;case 13:if(Ht(yi),b=E.memoizedState,b!==null&&b.dehydrated!==null){if(E.alternate===null)throw Error(o(340));Sh()}return b=E.flags,b&65536?(E.flags=b&-65537|128,E):null;case 19:return Ht(yi),null;case 4:return Mh(),null;case 10:return ms(E.type._context),null;case 22:case 23:return dS(),null;case 24:return null;default:return null}}var wv=!1,Uf=!1,cee=typeof WeakSet=="function"?WeakSet:Set,rn=null;function Sv(b,E){var I=b.ref;if(I!==null)if(typeof I=="function")try{I(null)}catch(B){Do(b,E,B)}else I.current=null}function Yw(b,E,I){try{I()}catch(B){Do(b,E,B)}}var l7=!1;function uee(b,E){for(ne(b.containerInfo),rn=E;rn!==null;)if(b=rn,E=b.child,(b.subtreeFlags&1028)!==0&&E!==null)E.return=b,rn=E;else for(;rn!==null;){b=rn;try{var I=b.alternate;if(b.flags&1024)switch(b.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var B=I.memoizedProps,ee=I.memoizedState,le=b.stateNode,Oe=le.getSnapshotBeforeUpdate(b.elementType===b.type?B:fo(b.type,B),ee);le.__reactInternalSnapshotBeforeUpdate=Oe}break;case 3:Te&&_t(b.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Je){Do(b,b.return,Je)}if(E=b.sibling,E!==null){E.return=b.return,rn=E;break}rn=b.return}return I=l7,l7=!1,I}function Bf(b,E,I){var B=E.updateQueue;if(B=B!==null?B.lastEffect:null,B!==null){var ee=B=B.next;do{if((ee.tag&b)===b){var le=ee.destroy;ee.destroy=void 0,le!==void 0&&Yw(E,I,le)}ee=ee.next}while(ee!==B)}}function I0(b,E){if(E=E.updateQueue,E=E!==null?E.lastEffect:null,E!==null){var I=E=E.next;do{if((I.tag&b)===b){var B=I.create;I.destroy=B()}I=I.next}while(I!==E)}}function Kw(b){var E=b.ref;if(E!==null){var I=b.stateNode;switch(b.tag){case 5:b=O(I);break;default:b=I}typeof E=="function"?E(b):E.current=b}}function c7(b,E,I){if(nn&&typeof nn.onCommitFiberUnmount=="function")try{nn.onCommitFiberUnmount(un,E)}catch{}switch(E.tag){case 0:case 11:case 14:case 15:if(b=E.updateQueue,b!==null&&(b=b.lastEffect,b!==null)){var B=b=b.next;do{var ee=B,le=ee.destroy;ee=ee.tag,le!==void 0&&(ee&2||ee&4)&&Yw(E,I,le),B=B.next}while(B!==b)}break;case 1:if(Sv(E,I),b=E.stateNode,typeof b.componentWillUnmount=="function")try{b.props=E.memoizedProps,b.state=E.memoizedState,b.componentWillUnmount()}catch(Oe){Do(E,I,Oe)}break;case 5:Sv(E,I);break;case 4:Te?m7(b,E,I):_e&&_e&&(E=E.stateNode.containerInfo,I=Ct(E),sn(E,I))}}function u7(b,E,I){for(var B=E;;)if(c7(b,B,I),B.child===null||Te&&B.tag===4){if(B===E)break;for(;B.sibling===null;){if(B.return===null||B.return===E)return;B=B.return}B.sibling.return=B.return,B=B.sibling}else B.child.return=B,B=B.child}function f7(b){var E=b.alternate;E!==null&&(b.alternate=null,f7(E)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(E=b.stateNode,E!==null&&Ve(E)),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}function d7(b){return b.tag===5||b.tag===3||b.tag===4}function h7(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||d7(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function p7(b){if(Te){e:{for(var E=b.return;E!==null;){if(d7(E))break e;E=E.return}throw Error(o(160))}var I=E;switch(I.tag){case 5:E=I.stateNode,I.flags&32&&(Ye(E),I.flags&=-33),I=h7(b),Qw(b,I,E);break;case 3:case 4:E=I.stateNode.containerInfo,I=h7(b),Zw(b,I,E);break;default:throw Error(o(161))}}}function Zw(b,E,I){var B=b.tag;if(B===5||B===6)b=b.stateNode,E?st(I,b,E):q(I,b);else if(B!==4&&(b=b.child,b!==null))for(Zw(b,E,I),b=b.sibling;b!==null;)Zw(b,E,I),b=b.sibling}function Qw(b,E,I){var B=b.tag;if(B===5||B===6)b=b.stateNode,E?$e(I,b,E):Z(I,b);else if(B!==4&&(b=b.child,b!==null))for(Qw(b,E,I),b=b.sibling;b!==null;)Qw(b,E,I),b=b.sibling}function m7(b,E,I){for(var B=E,ee=!1,le,Oe;;){if(!ee){ee=B.return;e:for(;;){if(ee===null)throw Error(o(160));switch(le=ee.stateNode,ee.tag){case 5:Oe=!1;break e;case 3:le=le.containerInfo,Oe=!0;break e;case 4:le=le.containerInfo,Oe=!0;break e}ee=ee.return}ee=!0}if(B.tag===5||B.tag===6)u7(b,B,I),Oe?Ie(le,B.stateNode):it(le,B.stateNode);else if(B.tag===18)Oe?de(le,B.stateNode):Ft(le,B.stateNode);else if(B.tag===4){if(B.child!==null){le=B.stateNode.containerInfo,Oe=!0,B.child.return=B,B=B.child;continue}}else if(c7(b,B,I),B.child!==null){B.child.return=B,B=B.child;continue}if(B===E)break;for(;B.sibling===null;){if(B.return===null||B.return===E)return;B=B.return,B.tag===4&&(ee=!1)}B.sibling.return=B.return,B=B.sibling}}function Jw(b,E){if(Te){switch(E.tag){case 0:case 11:case 14:case 15:Bf(3,E,E.return),I0(3,E),Bf(5,E,E.return);return;case 1:return;case 5:var I=E.stateNode;if(I!=null){var B=E.memoizedProps;b=b!==null?b.memoizedProps:B;var ee=E.type,le=E.updateQueue;E.updateQueue=null,le!==null&&De(I,le,ee,b,B,E)}return;case 6:if(E.stateNode===null)throw Error(o(162));I=E.memoizedProps,xe(E.stateNode,b!==null?b.memoizedProps:I,I);return;case 3:Re&&b!==null&&b.memoizedState.isDehydrated&&yt(E.stateNode.containerInfo);return;case 12:return;case 13:Tv(E);return;case 19:Tv(E);return;case 17:return}throw Error(o(163))}switch(E.tag){case 0:case 11:case 14:case 15:Bf(3,E,E.return),I0(3,E),Bf(5,E,E.return);return;case 12:return;case 13:Tv(E);return;case 19:Tv(E);return;case 3:Re&&b!==null&&b.memoizedState.isDehydrated&&yt(E.stateNode.containerInfo);break;case 22:case 23:return}e:if(_e){switch(E.tag){case 1:case 5:case 6:break e;case 3:case 4:E=E.stateNode,sn(E.containerInfo,E.pendingChildren);break e}throw Error(o(163))}}function Tv(b){var E=b.updateQueue;if(E!==null){b.updateQueue=null;var I=b.stateNode;I===null&&(I=b.stateNode=new cee),E.forEach(function(B){var ee=_ee.bind(null,b,B);I.has(B)||(I.add(B),B.then(ee,ee))})}}function fee(b,E){for(rn=E;rn!==null;){E=rn;var I=E.deletions;if(I!==null)for(var B=0;B<I.length;B++){var ee=I[B];try{var le=b;Te?m7(le,ee,E):u7(le,ee,E);var Oe=ee.alternate;Oe!==null&&(Oe.return=null),ee.return=null}catch(Sn){Do(ee,E,Sn)}}if(I=E.child,E.subtreeFlags&12854&&I!==null)I.return=E,rn=I;else for(;rn!==null;){E=rn;try{var Je=E.flags;if(Je&32&&Te&&Ye(E.stateNode),Je&512){var Mt=E.alternate;if(Mt!==null){var Wt=Mt.ref;Wt!==null&&(typeof Wt=="function"?Wt(null):Wt.current=null)}}if(Je&8192)switch(E.tag){case 13:if(E.memoizedState!==null){var hn=E.alternate;(hn===null||hn.memoizedState===null)&&(oS=dt())}break;case 22:var $n=E.memoizedState!==null,Rn=E.alternate,Xr=Rn!==null&&Rn.memoizedState!==null;if(I=E,Te){e:if(B=I,ee=$n,le=null,Te)for(var Tn=B;;){if(Tn.tag===5){if(le===null){le=Tn;var qs=Tn.stateNode;ee?at(qs):Xe(Tn.stateNode,Tn.memoizedProps)}}else if(Tn.tag===6){if(le===null){var wa=Tn.stateNode;ee?ke(wa):Qe(wa,Tn.memoizedProps)}}else if((Tn.tag!==22&&Tn.tag!==23||Tn.memoizedState===null||Tn===B)&&Tn.child!==null){Tn.child.return=Tn,Tn=Tn.child;continue}if(Tn===B)break;for(;Tn.sibling===null;){if(Tn.return===null||Tn.return===B)break e;le===Tn&&(le=null),Tn=Tn.return}le===Tn&&(le=null),Tn.sibling.return=Tn.return,Tn=Tn.sibling}}if($n&&!Xr&&I.mode&1){rn=I;for(var ht=I.child;ht!==null;){for(I=rn=ht;rn!==null;){B=rn;var nt=B.child;switch(B.tag){case 0:case 11:case 14:case 15:Bf(4,B,B.return);break;case 1:Sv(B,B.return);var Et=B.stateNode;if(typeof Et.componentWillUnmount=="function"){var an=B.return;try{Et.props=B.memoizedProps,Et.state=B.memoizedState,Et.componentWillUnmount()}catch(Sn){Do(B,an,Sn)}}break;case 5:Sv(B,B.return);break;case 22:if(B.memoizedState!==null){v7(I);continue}}nt!==null?(nt.return=B,rn=nt):v7(I)}ht=ht.sibling}}}switch(Je&4102){case 2:p7(E),E.flags&=-3;break;case 6:p7(E),E.flags&=-3,Jw(E.alternate,E);break;case 4096:E.flags&=-4097;break;case 4100:E.flags&=-4097,Jw(E.alternate,E);break;case 4:Jw(E.alternate,E)}}catch(Sn){Do(E,E.return,Sn)}if(I=E.sibling,I!==null){I.return=E.return,rn=I;break}rn=E.return}}}function dee(b,E,I){rn=b,g7(b)}function g7(b,E,I){for(var B=(b.mode&1)!==0;rn!==null;){var ee=rn,le=ee.child;if(ee.tag===22&&B){var Oe=ee.memoizedState!==null||wv;if(!Oe){var Je=ee.alternate,Mt=Je!==null&&Je.memoizedState!==null||Uf;Je=wv;var Wt=Uf;if(wv=Oe,(Uf=Mt)&&!Wt)for(rn=ee;rn!==null;)Oe=rn,Mt=Oe.child,Oe.tag===22&&Oe.memoizedState!==null?x7(ee):Mt!==null?(Mt.return=Oe,rn=Mt):x7(ee);for(;le!==null;)rn=le,g7(le),le=le.sibling;rn=ee,wv=Je,Uf=Wt}y7(b)}else ee.subtreeFlags&8772&&le!==null?(le.return=ee,rn=le):y7(b)}}function y7(b){for(;rn!==null;){var E=rn;if(E.flags&8772){var I=E.alternate;try{if(E.flags&8772)switch(E.tag){case 0:case 11:case 15:Uf||I0(5,E);break;case 1:var B=E.stateNode;if(E.flags&4&&!Uf)if(I===null)B.componentDidMount();else{var ee=E.elementType===E.type?I.memoizedProps:fo(E.type,I.memoizedProps);B.componentDidUpdate(ee,I.memoizedState,B.__reactInternalSnapshotBeforeUpdate)}var le=E.updateQueue;le!==null&&f9(E,le,B);break;case 3:var Oe=E.updateQueue;if(Oe!==null){if(I=null,E.child!==null)switch(E.child.tag){case 5:I=O(E.child.stateNode);break;case 1:I=E.child.stateNode}f9(E,Oe,I)}break;case 5:var Je=E.stateNode;I===null&&E.flags&4&&be(Je,E.type,E.memoizedProps,E);break;case 6:break;case 4:break;case 12:break;case 13:if(Re&&E.memoizedState===null){var Mt=E.alternate;if(Mt!==null){var Wt=Mt.memoizedState;if(Wt!==null){var hn=Wt.dehydrated;hn!==null&&vt(hn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Uf||E.flags&512&&Kw(E)}catch($n){Do(E,E.return,$n)}}if(E===b){rn=null;break}if(I=E.sibling,I!==null){I.return=E.return,rn=I;break}rn=E.return}}function v7(b){for(;rn!==null;){var E=rn;if(E===b){rn=null;break}var I=E.sibling;if(I!==null){I.return=E.return,rn=I;break}rn=E.return}}function x7(b){for(;rn!==null;){var E=rn;try{switch(E.tag){case 0:case 11:case 15:var I=E.return;try{I0(4,E)}catch(Mt){Do(E,I,Mt)}break;case 1:var B=E.stateNode;if(typeof B.componentDidMount=="function"){var ee=E.return;try{B.componentDidMount()}catch(Mt){Do(E,ee,Mt)}}var le=E.return;try{Kw(E)}catch(Mt){Do(E,le,Mt)}break;case 5:var Oe=E.return;try{Kw(E)}catch(Mt){Do(E,Oe,Mt)}}}catch(Mt){Do(E,E.return,Mt)}if(E===b){rn=null;break}var Je=E.sibling;if(Je!==null){Je.return=E.return,rn=Je;break}rn=E.return}}var Av=0,Mv=1,Cv=2,Rv=3,Iv=4;if(typeof Symbol=="function"&&Symbol.for){var P0=Symbol.for;Av=P0("selector.component"),Mv=P0("selector.has_pseudo_class"),Cv=P0("selector.role"),Rv=P0("selector.test_id"),Iv=P0("selector.text")}function eS(b){var E=ae(b);if(E!=null){if(typeof E.memoizedProps["data-testname"]!="string")throw Error(o(364));return E}if(b=fe(b),b===null)throw Error(o(362));return b.stateNode.current}function tS(b,E){switch(E.$$typeof){case Av:if(b.type===E.value)return!0;break;case Mv:e:{E=E.value,b=[b,0];for(var I=0;I<b.length;){var B=b[I++],ee=b[I++],le=E[ee];if(B.tag!==5||!Me(B)){for(;le!=null&&tS(B,le);)ee++,le=E[ee];if(ee===E.length){E=!0;break e}else for(B=B.child;B!==null;)b.push(B,ee),B=B.sibling}}E=!1}return E;case Cv:if(b.tag===5&&Be(b.stateNode,E.value))return!0;break;case Iv:if((b.tag===5||b.tag===6)&&(b=ve(b),b!==null&&0<=b.indexOf(E.value)))return!0;break;case Rv:if(b.tag===5&&(b=b.memoizedProps["data-testname"],typeof b=="string"&&b.toLowerCase()===E.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function nS(b){switch(b.$$typeof){case Av:return"<"+(C(b.value)||"Unknown")+">";case Mv:return":has("+(nS(b)||"")+")";case Cv:return'[role="'+b.value+'"]';case Iv:return'"'+b.value+'"';case Rv:return'[data-testname="'+b.value+'"]';default:throw Error(o(365))}}function _7(b,E){var I=[];b=[b,0];for(var B=0;B<b.length;){var ee=b[B++],le=b[B++],Oe=E[le];if(ee.tag!==5||!Me(ee)){for(;Oe!=null&&tS(ee,Oe);)le++,Oe=E[le];if(le===E.length)I.push(ee);else for(ee=ee.child;ee!==null;)b.push(ee,le),ee=ee.sibling}}return I}function rS(b,E){if(!ze)throw Error(o(363));b=eS(b),b=_7(b,E),E=[],b=Array.from(b);for(var I=0;I<b.length;){var B=b[I++];if(B.tag===5)Me(B)||E.push(B.stateNode);else for(B=B.child;B!==null;)b.push(B),B=B.sibling}return E}var hee=Math.ceil,Pv=a.ReactCurrentDispatcher,iS=a.ReactCurrentOwner,Li=a.ReactCurrentBatchConfig,ir=0,$i=null,Xi=null,ks=0,ta=0,Rh=Ot(0),is=0,k0=null,Ih=0,kv=0,sS=0,L0=null,ko=null,oS=0,aS=1/0;function Ph(){aS=dt()+500}var Lv=!1,lS=null,Eu=null,Dv=!1,wu=null,Nv=0,D0=0,cS=null,Ov=-1,Fv=0;function mo(){return ir&6?dt():Ov!==-1?Ov:Ov=dt()}function Su(b){return b.mode&1?ir&2&&ks!==0?ks&-ks:kf.transition!==null?(Fv===0&&(b=Ii,Ii<<=1,!(Ii&4194240)&&(Ii=64),Fv=b),Fv):(b=je,b!==0?b:Pe()):1}function ba(b,E,I){if(50<D0)throw D0=0,cS=null,Error(o(185));var B=Uv(b,E);return B===null?null:(Y(B,E,I),(!(ir&2)||B!==$i)&&(B===$i&&(!(ir&2)&&(kv|=E),is===4&&Tu(B,ks)),Lo(B,I),E===1&&ir===0&&!(b.mode&1)&&(Ph(),co&&Po())),B)}function Uv(b,E){b.lanes|=E;var I=b.alternate;for(I!==null&&(I.lanes|=E),I=b,b=b.return;b!==null;)b.childLanes|=E,I=b.alternate,I!==null&&(I.childLanes|=E),I=b,b=b.return;return I.tag===3?I.stateNode:null}function Lo(b,E){var I=b.callbackNode;U(b,E);var B=vn(b,b===$i?ks:0);if(B===0)I!==null&&pt(I),b.callbackNode=null,b.callbackPriority=0;else if(E=B&-B,b.callbackPriority!==E){if(I!=null&&pt(I),E===1)b.tag===0?y0(E7.bind(null,b)):g0(E7.bind(null,b)),ye?ge(function(){ir===0&&Po()}):lt(Rt,Po),I=null;else{switch(gt(B)){case 1:I=Rt;break;case 4:I=Nt;break;case 16:I=jt;break;case 536870912:I=xn;break;default:I=jt}I=P7(I,b7.bind(null,b))}b.callbackPriority=E,b.callbackNode=I}}function b7(b,E){if(Ov=-1,Fv=0,ir&6)throw Error(o(327));var I=b.callbackNode;if(Gf()&&b.callbackNode!==I)return null;var B=vn(b,b===$i?ks:0);if(B===0)return null;if(B&30||B&b.expiredLanes||E)E=Bv(b,B);else{E=B;var ee=ir;ir|=2;var le=T7();($i!==b||ks!==E)&&(Ph(),zf(b,E));do try{gee();break}catch(Je){S7(b,Je)}while(!0);bh(),Pv.current=le,ir=ee,Xi!==null?E=0:($i=null,ks=0,E=is)}if(E!==0){if(E===2&&(ee=j(b),ee!==0&&(B=ee,E=uS(b,ee))),E===1)throw I=k0,zf(b,0),Tu(b,B),Lo(b,dt()),I;if(E===6)Tu(b,B);else{if(ee=b.current.alternate,!(B&30)&&!pee(ee)&&(E=Bv(b,B),E===2&&(le=j(b),le!==0&&(B=le,E=uS(b,le))),E===1))throw I=k0,zf(b,0),Tu(b,B),Lo(b,dt()),I;switch(b.finishedWork=ee,b.finishedLanes=B,E){case 0:case 1:throw Error(o(345));case 2:Hf(b,ko);break;case 3:if(Tu(b,B),(B&130023424)===B&&(E=oS+500-dt(),10<E)){if(vn(b,0)!==0)break;if(ee=b.suspendedLanes,(ee&B)!==B){mo(),b.pingedLanes|=b.suspendedLanes&ee;break}b.timeoutHandle=J(Hf.bind(null,b,ko),E);break}Hf(b,ko);break;case 4:if(Tu(b,B),(B&4194240)===B)break;for(E=b.eventTimes,ee=-1;0<B;){var Oe=31-Un(B);le=1<<Oe,Oe=E[Oe],Oe>ee&&(ee=Oe),B&=~le}if(B=ee,B=dt()-B,B=(120>B?120:480>B?480:1080>B?1080:1920>B?1920:3e3>B?3e3:4320>B?4320:1960*hee(B/1960))-B,10<B){b.timeoutHandle=J(Hf.bind(null,b,ko),B);break}Hf(b,ko);break;case 5:Hf(b,ko);break;default:throw Error(o(329))}}}return Lo(b,dt()),b.callbackNode===I?b7.bind(null,b):null}function uS(b,E){var I=L0;return b.current.memoizedState.isDehydrated&&(zf(b,E).flags|=256),b=Bv(b,E),b!==2&&(E=ko,ko=I,E!==null&&fS(E)),b}function fS(b){ko===null?ko=b:ko.push.apply(ko,b)}function pee(b){for(var E=b;;){if(E.flags&16384){var I=E.updateQueue;if(I!==null&&(I=I.stores,I!==null))for(var B=0;B<I.length;B++){var ee=I[B],le=ee.getSnapshot;ee=ee.value;try{if(!gr(le(),ee))return!1}catch{return!1}}}if(I=E.child,E.subtreeFlags&16384&&I!==null)I.return=E,E=I;else{if(E===b)break;for(;E.sibling===null;){if(E.return===null||E.return===b)return!0;E=E.return}E.sibling.return=E.return,E=E.sibling}}return!0}function Tu(b,E){for(E&=~sS,E&=~kv,b.suspendedLanes|=E,b.pingedLanes&=~E,b=b.expirationTimes;0<E;){var I=31-Un(E),B=1<<I;b[I]=-1,E&=~B}}function E7(b){if(ir&6)throw Error(o(327));Gf();var E=vn(b,0);if(!(E&1))return Lo(b,dt()),null;var I=Bv(b,E);if(b.tag!==0&&I===2){var B=j(b);B!==0&&(E=B,I=uS(b,B))}if(I===1)throw I=k0,zf(b,0),Tu(b,E),Lo(b,dt()),I;if(I===6)throw Error(o(345));return b.finishedWork=b.current.alternate,b.finishedLanes=E,Hf(b,ko),Lo(b,dt()),null}function w7(b){wu!==null&&wu.tag===0&&!(ir&6)&&Gf();var E=ir;ir|=1;var I=Li.transition,B=je;try{if(Li.transition=null,je=1,b)return b()}finally{je=B,Li.transition=I,ir=E,!(ir&6)&&Po()}}function dS(){ta=Rh.current,Ht(Rh)}function zf(b,E){b.finishedWork=null,b.finishedLanes=0;var I=b.timeoutHandle;if(I!==Ee&&(b.timeoutHandle=Ee,oe(I)),Xi!==null)for(I=Xi.return;I!==null;){var B=I;switch(Rw(B),B.tag){case 1:B=B.type.childContextTypes,B!=null&&Zn();break;case 3:Mh(),Ht(Zt),Ht(En),Ow();break;case 5:Dw(B);break;case 4:Mh();break;case 13:Ht(yi);break;case 19:Ht(yi);break;case 10:ms(B.type._context);break;case 22:case 23:dS()}I=I.return}if($i=b,Xi=b=Au(b.current,null),ks=ta=E,is=0,k0=null,sS=kv=Ih=0,ko=L0=null,Zo!==null){for(E=0;E<Zo.length;E++)if(I=Zo[E],B=I.interleaved,B!==null){I.interleaved=null;var ee=B.next,le=I.pending;if(le!==null){var Oe=le.next;le.next=ee,B.next=Oe}I.pending=B}Zo=null}return b}function S7(b,E){do{var I=Xi;try{if(bh(),fv.current=yv,dv){for(var B=Ti.memoizedState;B!==null;){var ee=B.queue;ee!==null&&(ee.pending=null),B=B.next}dv=!1}if(Ch=0,gs=Ws=Ti=null,w0=!1,S0=0,iS.current=null,I===null||I.return===null){is=1,k0=E,Xi=null;break}e:{var le=b,Oe=I.return,Je=I,Mt=E;if(E=ks,Je.flags|=32768,Mt!==null&&typeof Mt=="object"&&typeof Mt.then=="function"){var Wt=Mt,hn=Je,$n=hn.tag;if(!(hn.mode&1)&&($n===0||$n===11||$n===15)){var Rn=hn.alternate;Rn?(hn.updateQueue=Rn.updateQueue,hn.memoizedState=Rn.memoizedState,hn.lanes=Rn.lanes):(hn.updateQueue=null,hn.memoizedState=null)}var Xr=W9(Oe);if(Xr!==null){Xr.flags&=-257,$9(Xr,Oe,Je,le,E),Xr.mode&1&&V9(le,Wt,E),E=Xr,Mt=Wt;var Tn=E.updateQueue;if(Tn===null){var qs=new Set;qs.add(Mt),E.updateQueue=qs}else Tn.add(Mt);break e}else{if(!(E&1)){V9(le,Wt,E),hS();break e}Mt=Error(o(426))}}else if(ui&&Je.mode&1){var wa=W9(Oe);if(wa!==null){!(wa.flags&65536)&&(wa.flags|=256),$9(wa,Oe,Je,le,E),kw(Mt);break e}}le=Mt,is!==4&&(is=2),L0===null?L0=[le]:L0.push(le),Mt=jw(Mt,Je),Je=Oe;do{switch(Je.tag){case 3:Je.flags|=65536,E&=-E,Je.lanes|=E;var ht=G9(Je,Mt,E);u9(Je,ht);break e;case 1:le=Mt;var nt=Je.type,Et=Je.stateNode;if(!(Je.flags&128)&&(typeof nt.getDerivedStateFromError=="function"||Et!==null&&typeof Et.componentDidCatch=="function"&&(Eu===null||!Eu.has(Et)))){Je.flags|=65536,E&=-E,Je.lanes|=E;var an=j9(Je,le,E);u9(Je,an);break e}}Je=Je.return}while(Je!==null)}M7(I)}catch(Sn){E=Sn,Xi===I&&I!==null&&(Xi=I=I.return);continue}break}while(!0)}function T7(){var b=Pv.current;return Pv.current=yv,b===null?yv:b}function hS(){(is===0||is===3||is===2)&&(is=4),$i===null||!(Ih&268435455)&&!(kv&268435455)||Tu($i,ks)}function Bv(b,E){var I=ir;ir|=2;var B=T7();$i===b&&ks===E||zf(b,E);do try{mee();break}catch(ee){S7(b,ee)}while(!0);if(bh(),ir=I,Pv.current=B,Xi!==null)throw Error(o(261));return $i=null,ks=0,is}function mee(){for(;Xi!==null;)A7(Xi)}function gee(){for(;Xi!==null&&!mt();)A7(Xi)}function A7(b){var E=I7(b.alternate,b,ta);b.memoizedProps=b.pendingProps,E===null?M7(b):Xi=E,iS.current=null}function M7(b){var E=b;do{var I=E.alternate;if(b=E.return,E.flags&32768){if(I=lee(I,E),I!==null){I.flags&=32767,Xi=I;return}if(b!==null)b.flags|=32768,b.subtreeFlags=0,b.deletions=null;else{is=6,Xi=null;return}}else if(I=see(I,E,ta),I!==null){Xi=I;return}if(E=E.sibling,E!==null){Xi=E;return}Xi=E=b}while(E!==null);is===0&&(is=5)}function Hf(b,E){var I=je,B=Li.transition;try{Li.transition=null,je=1,yee(b,E,I)}finally{Li.transition=B,je=I}return null}function yee(b,E,I){do Gf();while(wu!==null);if(ir&6)throw Error(o(327));var B=b.finishedWork,ee=b.finishedLanes;if(B===null)return null;if(b.finishedWork=null,b.finishedLanes=0,B===b.current)throw Error(o(177));b.callbackNode=null,b.callbackPriority=0;var le=B.lanes|B.childLanes;if(ce(b,le),b===$i&&(Xi=$i=null,ks=0),!(B.subtreeFlags&2064)&&!(B.flags&2064)||Dv||(Dv=!0,P7(jt,function(){return Gf(),null})),le=(B.flags&15990)!==0,B.subtreeFlags&15990||le){le=Li.transition,Li.transition=null;var Oe=je;je=1;var Je=ir;ir|=4,iS.current=null,uee(b,B),fee(b,B),re(b.containerInfo),b.current=B,dee(B),ct(),ir=Je,je=Oe,Li.transition=le}else b.current=B;if(Dv&&(Dv=!1,wu=b,Nv=ee),le=b.pendingLanes,le===0&&(Eu=null),Vn(B.stateNode),Lo(b,dt()),E!==null)for(I=b.onRecoverableError,B=0;B<E.length;B++)I(E[B]);if(Lv)throw Lv=!1,b=lS,lS=null,b;return Nv&1&&b.tag!==0&&Gf(),le=b.pendingLanes,le&1?b===cS?D0++:(D0=0,cS=b):D0=0,Po(),null}function Gf(){if(wu!==null){var b=gt(Nv),E=Li.transition,I=je;try{if(Li.transition=null,je=16>b?16:b,wu===null)var B=!1;else{if(b=wu,wu=null,Nv=0,ir&6)throw Error(o(331));var ee=ir;for(ir|=4,rn=b.current;rn!==null;){var le=rn,Oe=le.child;if(rn.flags&16){var Je=le.deletions;if(Je!==null){for(var Mt=0;Mt<Je.length;Mt++){var Wt=Je[Mt];for(rn=Wt;rn!==null;){var hn=rn;switch(hn.tag){case 0:case 11:case 15:Bf(8,hn,le)}var $n=hn.child;if($n!==null)$n.return=hn,rn=$n;else for(;rn!==null;){hn=rn;var Rn=hn.sibling,Xr=hn.return;if(f7(hn),hn===Wt){rn=null;break}if(Rn!==null){Rn.return=Xr,rn=Rn;break}rn=Xr}}}var Tn=le.alternate;if(Tn!==null){var qs=Tn.child;if(qs!==null){Tn.child=null;do{var wa=qs.sibling;qs.sibling=null,qs=wa}while(qs!==null)}}rn=le}}if(le.subtreeFlags&2064&&Oe!==null)Oe.return=le,rn=Oe;else e:for(;rn!==null;){if(le=rn,le.flags&2048)switch(le.tag){case 0:case 11:case 15:Bf(9,le,le.return)}var ht=le.sibling;if(ht!==null){ht.return=le.return,rn=ht;break e}rn=le.return}}var nt=b.current;for(rn=nt;rn!==null;){Oe=rn;var Et=Oe.child;if(Oe.subtreeFlags&2064&&Et!==null)Et.return=Oe,rn=Et;else e:for(Oe=nt;rn!==null;){if(Je=rn,Je.flags&2048)try{switch(Je.tag){case 0:case 11:case 15:I0(9,Je)}}catch(Sn){Do(Je,Je.return,Sn)}if(Je===Oe){rn=null;break e}var an=Je.sibling;if(an!==null){an.return=Je.return,rn=an;break e}rn=Je.return}}if(ir=ee,Po(),nn&&typeof nn.onPostCommitFiberRoot=="function")try{nn.onPostCommitFiberRoot(un,b)}catch{}B=!0}return B}finally{je=I,Li.transition=E}}return!1}function C7(b,E,I){E=jw(I,E),E=G9(b,E,1),bu(b,E),E=mo(),b=Uv(b,1),b!==null&&(Y(b,1,E),Lo(b,E))}function Do(b,E,I){if(b.tag===3)C7(b,b,I);else for(;E!==null;){if(E.tag===3){C7(E,b,I);break}else if(E.tag===1){var B=E.stateNode;if(typeof E.type.getDerivedStateFromError=="function"||typeof B.componentDidCatch=="function"&&(Eu===null||!Eu.has(B))){b=jw(I,b),b=j9(E,b,1),bu(E,b),b=mo(),E=Uv(E,1),E!==null&&(Y(E,1,b),Lo(E,b));break}}E=E.return}}function vee(b,E,I){var B=b.pingCache;B!==null&&B.delete(E),E=mo(),b.pingedLanes|=b.suspendedLanes&I,$i===b&&(ks&I)===I&&(is===4||is===3&&(ks&130023424)===ks&&500>dt()-oS?zf(b,0):sS|=I),Lo(b,E)}function R7(b,E){E===0&&(b.mode&1?(E=Si,Si<<=1,!(Si&130023424)&&(Si=4194304)):E=1);var I=mo();b=Uv(b,E),b!==null&&(Y(b,E,I),Lo(b,I))}function xee(b){var E=b.memoizedState,I=0;E!==null&&(I=E.retryLane),R7(b,I)}function _ee(b,E){var I=0;switch(b.tag){case 13:var B=b.stateNode,ee=b.memoizedState;ee!==null&&(I=ee.retryLane);break;case 19:B=b.stateNode;break;default:throw Error(o(314))}B!==null&&B.delete(E),R7(b,I)}var I7;I7=function(b,E,I){if(b!==null)if(b.memoizedProps!==E.pendingProps||Zt.current)ea=!0;else{if(!(b.lanes&I)&&!(E.flags&128))return ea=!1,aee(b,E,I);ea=!!(b.flags&131072)}else ea=!1,ui&&E.flags&1048576&&g9(E,lv,E.index);switch(E.lanes=0,E.tag){case 2:var B=E.type;b!==null&&(b.alternate=null,E.alternate=null,E.flags|=2),b=E.pendingProps;var ee=jn(E,En.current);Pi(E,I),ee=Uw(null,E,B,b,ee,I);var le=Bw();return E.flags|=1,typeof ee=="object"&&ee!==null&&typeof ee.render=="function"&&ee.$$typeof===void 0?(E.tag=1,E.memoizedState=null,E.updateQueue=null,wn(B)?(le=!0,On(E)):le=!1,E.memoizedState=ee.state!==null&&ee.state!==void 0?ee.state:null,Tw(E),ee.updater=ov,E.stateNode=ee,ee._reactInternals=E,Mw(E,B,b,I),E=$w(null,E,B,!0,le,I)):(E.tag=0,ui&&le&&Cw(E),po(null,E,ee,I),E=E.child),E;case 16:B=E.elementType;e:{switch(b!==null&&(b.alternate=null,E.alternate=null,E.flags|=2),b=E.pendingProps,ee=B._init,B=ee(B._payload),E.type=B,ee=E.tag=Eee(B),b=fo(B,b),ee){case 0:E=Ww(null,E,B,b,I);break e;case 1:E=e7(null,E,B,b,I);break e;case 11:E=Y9(null,E,B,b,I);break e;case 14:E=K9(null,E,B,fo(B.type,b),I);break e}throw Error(o(306,B,""))}return E;case 0:return B=E.type,ee=E.pendingProps,ee=E.elementType===B?ee:fo(B,ee),Ww(b,E,B,ee,I);case 1:return B=E.type,ee=E.pendingProps,ee=E.elementType===B?ee:fo(B,ee),e7(b,E,B,ee,I);case 3:e:{if(t7(E),b===null)throw Error(o(387));B=E.pendingProps,le=E.memoizedState,ee=le.element,c9(b,E),sv(E,B,null,I);var Oe=E.memoizedState;if(B=Oe.element,Re&&le.isDehydrated)if(le={element:B,isDehydrated:!1,cache:Oe.cache,transitions:Oe.transitions},E.updateQueue.baseState=le,E.memoizedState=le,E.flags&256){ee=Error(o(423)),E=n7(b,E,B,I,ee);break e}else if(B!==ee){ee=Error(o(424)),E=n7(b,E,B,I,ee);break e}else for(Re&&(Jo=kr(E.stateNode.containerInfo),Qo=E,ui=!0,ol=null,v0=!1),I=E9(E,null,B,I),E.child=I;I;)I.flags=I.flags&-3|4096,I=I.sibling;else{if(Sh(),B===ee){E=vc(b,E,I);break e}po(b,E,B,I)}E=E.child}return E;case 5:return w9(E),b===null&&Pw(E),B=E.type,ee=E.pendingProps,le=b!==null?b.memoizedProps:null,Oe=ee.children,W(B,ee)?Oe=null:le!==null&&W(B,le)&&(E.flags|=32),J9(b,E),po(b,E,Oe,I),E.child;case 6:return b===null&&Pw(E),null;case 13:return r7(b,E,I);case 4:return Lw(E,E.stateNode.containerInfo),B=E.pendingProps,b===null?E.child=Th(E,null,B,I):po(b,E,B,I),E.child;case 11:return B=E.type,ee=E.pendingProps,ee=E.elementType===B?ee:fo(B,ee),Y9(b,E,B,ee,I);case 7:return po(b,E,E.pendingProps,I),E.child;case 8:return po(b,E,E.pendingProps.children,I),E.child;case 12:return po(b,E,E.pendingProps.children,I),E.child;case 10:e:{if(B=E.type._context,ee=E.pendingProps,le=E.memoizedProps,Oe=ee.value,rv(E,B,Oe),le!==null)if(gr(le.value,Oe)){if(le.children===ee.children&&!Zt.current){E=vc(b,E,I);break e}}else for(le=E.child,le!==null&&(le.return=E);le!==null;){var Je=le.dependencies;if(Je!==null){Oe=le.child;for(var Mt=Je.firstContext;Mt!==null;){if(Mt.context===B){if(le.tag===1){Mt=pc(-1,I&-I),Mt.tag=2;var Wt=le.updateQueue;if(Wt!==null){Wt=Wt.shared;var hn=Wt.pending;hn===null?Mt.next=Mt:(Mt.next=hn.next,hn.next=Mt),Wt.pending=Mt}}le.lanes|=I,Mt=le.alternate,Mt!==null&&(Mt.lanes|=I),ho(le.return,I,E),Je.lanes|=I;break}Mt=Mt.next}}else if(le.tag===10)Oe=le.type===E.type?null:le.child;else if(le.tag===18){if(Oe=le.return,Oe===null)throw Error(o(341));Oe.lanes|=I,Je=Oe.alternate,Je!==null&&(Je.lanes|=I),ho(Oe,I,E),Oe=le.sibling}else Oe=le.child;if(Oe!==null)Oe.return=le;else for(Oe=le;Oe!==null;){if(Oe===E){Oe=null;break}if(le=Oe.sibling,le!==null){le.return=Oe.return,Oe=le;break}Oe=Oe.return}le=Oe}po(b,E,ee.children,I),E=E.child}return E;case 9:return ee=E.type,B=E.pendingProps.children,Pi(E,I),ee=ki(ee),B=B(ee),E.flags|=1,po(b,E,B,I),E.child;case 14:return B=E.type,ee=fo(B,E.pendingProps),ee=fo(B.type,ee),K9(b,E,B,ee,I);case 15:return Z9(b,E,E.type,E.pendingProps,I);case 17:return B=E.type,ee=E.pendingProps,ee=E.elementType===B?ee:fo(B,ee),b!==null&&(b.alternate=null,E.alternate=null,E.flags|=2),E.tag=1,wn(B)?(b=!0,On(E)):b=!1,Pi(E,I),p9(E,B,ee),Mw(E,B,ee,I),$w(null,E,B,!0,b,I);case 19:return a7(b,E,I);case 22:return Q9(b,E,I)}throw Error(o(156,E.tag))};function P7(b,E){return lt(b,E)}function bee(b,E,I,B){this.tag=b,this.key=I,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=E,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=B,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ea(b,E,I,B){return new bee(b,E,I,B)}function pS(b){return b=b.prototype,!(!b||!b.isReactComponent)}function Eee(b){if(typeof b=="function")return pS(b)?1:0;if(b!=null){if(b=b.$$typeof,b===m)return 11;if(b===x)return 14}return 2}function Au(b,E){var I=b.alternate;return I===null?(I=Ea(b.tag,E,b.key,b.mode),I.elementType=b.elementType,I.type=b.type,I.stateNode=b.stateNode,I.alternate=b,b.alternate=I):(I.pendingProps=E,I.type=b.type,I.flags=0,I.subtreeFlags=0,I.deletions=null),I.flags=b.flags&14680064,I.childLanes=b.childLanes,I.lanes=b.lanes,I.child=b.child,I.memoizedProps=b.memoizedProps,I.memoizedState=b.memoizedState,I.updateQueue=b.updateQueue,E=b.dependencies,I.dependencies=E===null?null:{lanes:E.lanes,firstContext:E.firstContext},I.sibling=b.sibling,I.index=b.index,I.ref=b.ref,I}function zv(b,E,I,B,ee,le){var Oe=2;if(B=b,typeof b=="function")pS(b)&&(Oe=1);else if(typeof b=="string")Oe=5;else e:switch(b){case u:return jf(I.children,ee,le,E);case f:Oe=8,ee|=8;break;case d:return b=Ea(12,I,E,ee|2),b.elementType=d,b.lanes=le,b;case g:return b=Ea(13,I,E,ee),b.elementType=g,b.lanes=le,b;case y:return b=Ea(19,I,E,ee),b.elementType=y,b.lanes=le,b;case w:return Hv(I,ee,le,E);default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case h:Oe=10;break e;case p:Oe=9;break e;case m:Oe=11;break e;case x:Oe=14;break e;case _:Oe=16,B=null;break e}throw Error(o(130,b==null?b:typeof b,""))}return E=Ea(Oe,I,E,ee),E.elementType=b,E.type=B,E.lanes=le,E}function jf(b,E,I,B){return b=Ea(7,b,B,E),b.lanes=I,b}function Hv(b,E,I,B){return b=Ea(22,b,B,E),b.elementType=w,b.lanes=I,b.stateNode={},b}function mS(b,E,I){return b=Ea(6,b,null,E),b.lanes=I,b}function gS(b,E,I){return E=Ea(4,b.children!==null?b.children:[],b.key,E),E.lanes=I,E.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},E}function wee(b,E,I,B,ee){this.tag=E,this.containerInfo=b,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ee,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q(0),this.expirationTimes=Q(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q(0),this.identifierPrefix=B,this.onRecoverableError=ee,Re&&(this.mutableSourceEagerHydrationData=null)}function k7(b,E,I,B,ee,le,Oe,Je,Mt){return b=new wee(b,E,I,Je,Mt),E===1?(E=1,le===!0&&(E|=8)):E=0,le=Ea(3,null,null,E),b.current=le,le.stateNode=b,le.memoizedState={element:B,isDehydrated:I,cache:null,transitions:null},Tw(le),b}function L7(b){if(!b)return dn;b=b._reactInternals;e:{if(R(b)!==b||b.tag!==1)throw Error(o(170));var E=b;do{switch(E.tag){case 3:E=E.stateNode.context;break e;case 1:if(wn(E.type)){E=E.stateNode.__reactInternalMemoizedMergedChildContext;break e}}E=E.return}while(E!==null);throw Error(o(171))}if(b.tag===1){var I=b.type;if(wn(I))return Jt(b,I,E)}return E}function D7(b){var E=b._reactInternals;if(E===void 0)throw typeof b.render=="function"?Error(o(188)):(b=Object.keys(b).join(","),Error(o(268,b)));return b=k(E),b===null?null:b.stateNode}function N7(b,E){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var I=b.retryLane;b.retryLane=I!==0&&I<E?I:E}}function yS(b,E){N7(b,E),(b=b.alternate)&&N7(b,E)}function See(b){return b=k(b),b===null?null:b.stateNode}function Tee(){return null}return n.attemptContinuousHydration=function(b){if(b.tag===13){var E=mo();ba(b,134217728,E),yS(b,134217728)}},n.attemptHydrationAtCurrentPriority=function(b){if(b.tag===13){var E=mo(),I=Su(b);ba(b,I,E),yS(b,I)}},n.attemptSynchronousHydration=function(b){switch(b.tag){case 3:var E=b.stateNode;if(E.current.memoizedState.isDehydrated){var I=_n(E.pendingLanes);I!==0&&(Fe(E,I|1),Lo(E,dt()),!(ir&6)&&(Ph(),Po()))}break;case 13:var B=mo();w7(function(){return ba(b,1,B)}),yS(b,1)}},n.batchedUpdates=function(b,E){var I=ir;ir|=1;try{return b(E)}finally{ir=I,ir===0&&(Ph(),co&&Po())}},n.createComponentSelector=function(b){return{$$typeof:Av,value:b}},n.createContainer=function(b,E,I,B,ee,le,Oe){return k7(b,E,!1,null,I,B,ee,le,Oe)},n.createHasPseudoClassSelector=function(b){return{$$typeof:Mv,value:b}},n.createHydrationContainer=function(b,E,I,B,ee,le,Oe,Je,Mt){return b=k7(I,B,!0,b,ee,le,Oe,Je,Mt),b.context=L7(null),I=b.current,B=mo(),ee=Su(I),le=pc(B,ee),le.callback=E??null,bu(I,le),b.current.lanes=ee,Y(b,ee,B),Lo(b,B),b},n.createPortal=function(b,E,I){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:B==null?null:""+B,children:b,containerInfo:E,implementation:I}},n.createRoleSelector=function(b){return{$$typeof:Cv,value:b}},n.createTestNameSelector=function(b){return{$$typeof:Rv,value:b}},n.createTextSelector=function(b){return{$$typeof:Iv,value:b}},n.deferredUpdates=function(b){var E=je,I=Li.transition;try{return Li.transition=null,je=16,b()}finally{je=E,Li.transition=I}},n.discreteUpdates=function(b,E,I,B,ee){var le=je,Oe=Li.transition;try{return Li.transition=null,je=1,b(E,I,B,ee)}finally{je=le,Li.transition=Oe,ir===0&&Ph()}},n.findAllNodes=rS,n.findBoundingRects=function(b,E){if(!ze)throw Error(o(363));E=rS(b,E),b=[];for(var I=0;I<E.length;I++)b.push(ie(E[I]));for(E=b.length-1;0<E;E--){I=b[E];for(var B=I.x,ee=B+I.width,le=I.y,Oe=le+I.height,Je=E-1;0<=Je;Je--)if(E!==Je){var Mt=b[Je],Wt=Mt.x,hn=Wt+Mt.width,$n=Mt.y,Rn=$n+Mt.height;if(B>=Wt&&le>=$n&&ee<=hn&&Oe<=Rn){b.splice(E,1);break}else if(B!==Wt||I.width!==Mt.width||Rn<le||$n>Oe){if(!(le!==$n||I.height!==Mt.height||hn<B||Wt>ee)){Wt>B&&(Mt.width+=Wt-B,Mt.x=B),hn<ee&&(Mt.width=ee-Wt),b.splice(E,1);break}}else{$n>le&&(Mt.height+=$n-le,Mt.y=le),Rn<Oe&&(Mt.height=Oe-$n),b.splice(E,1);break}}}return b},n.findHostInstance=D7,n.findHostInstanceWithNoPortals=function(b){return b=D(b),b=b!==null?N(b):null,b===null?null:b.stateNode},n.findHostInstanceWithWarning=function(b){return D7(b)},n.flushControlled=function(b){var E=ir;ir|=1;var I=Li.transition,B=je;try{Li.transition=null,je=1,b()}finally{je=B,Li.transition=I,ir=E,ir===0&&(Ph(),Po())}},n.flushPassiveEffects=Gf,n.flushSync=w7,n.focusWithin=function(b,E){if(!ze)throw Error(o(363));for(b=eS(b),E=_7(b,E),E=Array.from(E),b=0;b<E.length;){var I=E[b++];if(!Me(I)){if(I.tag===5&&Ze(I.stateNode))return!0;for(I=I.child;I!==null;)E.push(I),I=I.sibling}}return!1},n.getCurrentUpdatePriority=function(){return je},n.getFindAllNodesFailureDescription=function(b,E){if(!ze)throw Error(o(363));var I=0,B=[];b=[eS(b),0];for(var ee=0;ee<b.length;){var le=b[ee++],Oe=b[ee++],Je=E[Oe];if((le.tag!==5||!Me(le))&&(tS(le,Je)&&(B.push(nS(Je)),Oe++,Oe>I&&(I=Oe)),Oe<E.length))for(le=le.child;le!==null;)b.push(le,Oe),le=le.sibling}if(I<E.length){for(b=[];I<E.length;I++)b.push(nS(E[I]));return`findAllNodes was able to match part of the selector:
  `+(B.join(" > ")+`

No matching component was found for:
  `)+b.join(" > ")}return null},n.getPublicRootInstance=function(b){if(b=b.current,!b.child)return null;switch(b.child.tag){case 5:return O(b.child.stateNode);default:return b.child.stateNode}},n.injectIntoDevTools=function(b){if(b={bundleType:b.bundleType,version:b.version,rendererPackageName:b.rendererPackageName,rendererConfig:b.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:See,findFiberByHostInstance:b.findFiberByHostInstance||Tee,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")b=!1;else{var E=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(E.isDisabled||!E.supportsFiber)b=!0;else{try{un=E.inject(b),nn=E}catch{}b=!!E.checkDCE}}return b},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(b,E,I,B){if(!ze)throw Error(o(363));b=rS(b,E);var ee=F(b,I,B).disconnect;return{disconnect:function(){ee()}}},n.registerMutableSourceForHydration=function(b,E){var I=E._getVersion;I=I(E._source),b.mutableSourceEagerHydrationData==null?b.mutableSourceEagerHydrationData=[E,I]:b.mutableSourceEagerHydrationData.push(E,I)},n.runWithPriority=function(b,E){var I=je;try{return je=b,E()}finally{je=I}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(b,E,I,B){var ee=E.current,le=mo(),Oe=Su(ee);return I=L7(I),E.context===null?E.context=I:E.pendingContext=I,E=pc(le,Oe),E.payload={element:b},B=B===void 0?null:B,B!==null&&(E.callback=B),bu(ee,E),b=ba(ee,Oe,le),b!==null&&iv(b,ee,Oe),Oe},n}),a4}IH.exports=hle();var ple=IH.exports;const mle=Zd(ple);var gle=Object.freeze({__proto__:null});const Y6={},Gi=t=>void Object.assign(Y6,t);function yle(t,e){function n(u,{args:f=[],attach:d,...h},p){let m=`${u[0].toUpperCase()}${u.slice(1)}`,g;if(u==="primitive"){if(h.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const y=h.object;g=Fp(y,{type:u,root:p,attach:d,primitive:!0})}else{const y=Y6[m];if(!y)throw new Error(`R3F: ${m} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(f))throw new Error("R3F: The args prop must be an array!");g=Fp(new y(...f),{type:u,root:p,attach:d,memoizedProps:{args:f}})}return g.__r3f.attach===void 0&&(g instanceof gn?g.__r3f.attach="geometry":g instanceof Wr&&(g.__r3f.attach="material")),m!=="inject"&&u4(g,h),g}function r(u,f){let d=!1;if(f){var h,p;(h=f.__r3f)!=null&&h.attach?c4(u,f,f.__r3f.attach):f.isObject3D&&u.isObject3D&&(u.add(f),d=!0),d||(p=u.__r3f)==null||p.objects.push(f),f.__r3f||Fp(f,{}),f.__r3f.parent=u,s5(f),Up(f)}}function i(u,f,d){let h=!1;if(f){var p,m;if((p=f.__r3f)!=null&&p.attach)c4(u,f,f.__r3f.attach);else if(f.isObject3D&&u.isObject3D){f.parent=u,f.dispatchEvent({type:"added"}),u.dispatchEvent({type:"childadded",child:f});const g=u.children.filter(x=>x!==f),y=g.indexOf(d);u.children=[...g.slice(0,y),f,...g.slice(y)],h=!0}h||(m=u.__r3f)==null||m.objects.push(f),f.__r3f||Fp(f,{}),f.__r3f.parent=u,s5(f),Up(f)}}function s(u,f,d=!1){u&&[...u].forEach(h=>o(f,h,d))}function o(u,f,d){if(f){var h,p,m;if(f.__r3f&&(f.__r3f.parent=null),(h=u.__r3f)!=null&&h.objects&&(u.__r3f.objects=u.__r3f.objects.filter(w=>w!==f)),(p=f.__r3f)!=null&&p.attach)bP(u,f,f.__r3f.attach);else if(f.isObject3D&&u.isObject3D){var g;u.remove(f),(g=f.__r3f)!=null&&g.root&&wle(d3(f),f)}const x=(m=f.__r3f)==null?void 0:m.primitive,_=!x&&(d===void 0?f.dispose!==null:d);if(!x){var y;s((y=f.__r3f)==null?void 0:y.objects,f,_),s(f.children,f,_)}if(delete f.__r3f,_&&f.dispose&&f.type!=="Scene"){const w=()=>{try{f.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?r5.unstable_scheduleCallback(r5.unstable_IdlePriority,w):w()}Up(u)}}function a(u,f,d,h){var p;const m=(p=u.__r3f)==null?void 0:p.parent;if(!m)return;const g=n(f,d,u.__r3f.root);if(u.children){for(const y of u.children)y.__r3f&&r(g,y);u.children=u.children.filter(y=>!y.__r3f)}u.__r3f.objects.forEach(y=>r(g,y)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(m,u),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),r(m,g),g.raycast&&g.__r3f.eventCount&&d3(g).getState().internal.interaction.push(g),[h,h.alternate].forEach(y=>{y!==null&&(y.stateNode=g,y.ref&&(typeof y.ref=="function"?y.ref(g):y.ref.current=g))})}const l=()=>{};return{reconciler:mle({createInstance:n,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,f)=>{if(!f)return;const d=u.getState().scene;d.__r3f&&(d.__r3f.root=u,r(d,f))},removeChildFromContainer:(u,f)=>{f&&o(u.getState().scene,f)},insertInContainerBefore:(u,f,d)=>{if(!f||!d)return;const h=u.getState().scene;h.__r3f&&i(h,f,d)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var f;return!!((f=u==null?void 0:u.__r3f)!=null?f:{}).handlers},prepareUpdate(u,f,d,h){var p;if(((p=u==null?void 0:u.__r3f)!=null?p:{}).primitive&&h.object&&h.object!==u)return[!0];{const{args:g=[],children:y,...x}=h,{args:_=[],children:w,...T}=d;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((C,A)=>C!==_[A]))return[!0];const S=BH(u,x,T,!0);return S.changes.length?[!1,S]:null}},commitUpdate(u,[f,d],h,p,m,g){f?a(u,h,m,g):u4(u,d)},commitMount(u,f,d,h){var p;const m=(p=u.__r3f)!=null?p:{};u.raycast&&m.handlers&&m.eventCount&&d3(u).getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>Fp(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var f;const{attach:d,parent:h}=(f=u.__r3f)!=null?f:{};d&&h&&bP(h,u,d),u.isObject3D&&(u.visible=!1),Up(u)},unhideInstance(u,f){var d;const{attach:h,parent:p}=(d=u.__r3f)!=null?d:{};h&&p&&c4(p,u,h),(u.isObject3D&&f.visible==null||f.visible)&&(u.visible=!0),Up(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():$p.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Zr.fun(performance.now)?performance.now:Zr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Zr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Zr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:u4}}var yP,vP;const l4=t=>"colorSpace"in t||"outputColorSpace"in t,kH=()=>{var t;return(t=Y6.ColorManagement)!=null?t:null},LH=t=>t&&t.isOrthographicCamera,vle=t=>t&&t.hasOwnProperty("current"),Wm=typeof window<"u"&&((yP=window.document)!=null&&yP.createElement||((vP=window.navigator)==null?void 0:vP.product)==="ReactNative")?v.useLayoutEffect:v.useEffect;function DH(t){const e=v.useRef(t);return Wm(()=>void(e.current=t),[t]),e}function xle({set:t}){return Wm(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class NH extends v.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}NH.getDerivedStateFromError=()=>({error:!0});const OH="__default",xP=new Map,_le=t=>t&&!!t.memoized&&!!t.changes;function FH(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const Op=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()};function d3(t){let e=t.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Zr={obj:t=>t===Object(t)&&!Zr.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:r="reference",strict:i=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Zr.str(t)||Zr.num(t)||Zr.boo(t))return t===e;const s=Zr.obj(t);if(s&&r==="reference")return t===e;const o=Zr.arr(t);if(o&&n==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&n==="shallow"&&r==="shallow"){for(a in i?e:t)if(!Zr.equ(t[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:t)if(t[a]!==e[a])return!1;if(Zr.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function K6(t){const e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function UH(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function Fp(t,e){const n=t;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function i5(t,e){let n=t;if(e.includes("-")){const r=e.split("-"),i=r.pop();return n=r.reduce((s,o)=>s[o],t),{target:n,key:i}}else return{target:n,key:e}}const _P=/-\d+$/;function c4(t,e,n){if(Zr.str(n)){if(_P.test(n)){const s=n.replace(_P,""),{target:o,key:a}=i5(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:r,key:i}=i5(t,n);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=n(t,e)}function bP(t,e,n){var r,i;if(Zr.str(n)){const{target:s,key:o}=i5(t,n),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(t,e);(i=e.__r3f)==null||delete i.previousAttach}function BH(t,{children:e,key:n,ref:r,...i},{children:s,key:o,ref:a,...l}={},c=!1){const u=t.__r3f,f=Object.entries(i),d=[];if(c){const p=Object.keys(l);for(let m=0;m<p.length;m++)i.hasOwnProperty(p[m])||f.unshift([p[m],OH+"remove"])}f.forEach(([p,m])=>{var g;if((g=t.__r3f)!=null&&g.primitive&&p==="object"||Zr.equ(m,l[p]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(p))return d.push([p,m,!0,[]]);let y=[];p.includes("-")&&(y=p.split("-")),d.push([p,m,!1,y]);for(const x in i){const _=i[x];x.startsWith(`${p}-`)&&d.push([x,_,!1,x.split("-")])}});const h={...i};return u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.args&&(h.args=u.memoizedProps.args),u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.attach&&(h.attach=u.memoizedProps.attach),{memoized:h,changes:d}}const ble=typeof process<"u"&&!1;function u4(t,e){var n;const r=t.__r3f,i=r==null?void 0:r.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:o,changes:a}=_le(e)?e:BH(t,e),l=r==null?void 0:r.eventCount;t.__r3f&&(t.__r3f.memoizedProps=o);for(let u=0;u<a.length;u++){let[f,d,h,p]=a[u];if(l4(t)){const x="srgb",_="srgb-linear";f==="encoding"?(f="colorSpace",d=d===3001?x:_):f==="outputEncoding"&&(f="outputColorSpace",d=d===3001?x:_)}let m=t,g=m[f];if(p.length&&(g=p.reduce((y,x)=>y[x],t),!(g&&g.set))){const[y,...x]=p.reverse();m=x.reverse().reduce((_,w)=>_[w],t),f=y}if(d===OH+"remove")if(m.constructor){let y=xP.get(m.constructor);y||(y=new m.constructor,xP.set(m.constructor,y)),d=y[f]}else d=0;if(h&&r)d?r.handlers[f]=d:delete r.handlers[f],r.eventCount=Object.keys(r.handlers).length;else if(g&&g.set&&(g.copy||g instanceof Md)){if(Array.isArray(d))g.fromArray?g.fromArray(d):g.set(...d);else if(g.copy&&d&&d.constructor&&(ble?g.constructor.name===d.constructor.name:g.constructor===d.constructor))g.copy(d);else if(d!==void 0){const y=g instanceof wt;!y&&g.setScalar?g.setScalar(d):g instanceof Md&&d instanceof Md?g.mask=d.mask:g.set(d),!kH()&&s&&!s.linear&&y&&g.convertSRGBToLinear()}}else if(m[f]=d,m[f]instanceof tr&&m[f].format===Pr&&m[f].type===Rs&&s){const y=m[f];l4(y)&&l4(s.gl)?y.colorSpace=s.gl.outputColorSpace:y.encoding=s.gl.outputEncoding}Up(t)}if(r&&r.parent&&t.raycast&&l!==r.eventCount){const u=d3(t).getState().internal,f=u.interaction.indexOf(t);f>-1&&u.interaction.splice(f,1),r.eventCount&&u.interaction.push(t)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(n=t.__r3f)!=null&&n.parent&&s5(t),t}function Up(t){var e,n;const r=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();r&&r.internal.frames===0&&r.invalidate()}function s5(t){t.onUpdate==null||t.onUpdate(t)}function zH(t,e){t.manual||(LH(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function L2(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function Ele(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return $p.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return $p.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return $p.ContinuousEventPriority;default:return $p.DefaultEventPriority}}function HH(t,e,n,r){const i=n.get(e);i&&(n.delete(e),n.size===0&&(t.delete(r),i.target.releasePointerCapture(r)))}function wle(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(r=>r!==e),n.initialHits=n.initialHits.filter(r=>r!==e),n.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&n.hovered.delete(i)}),n.capturedMap.forEach((r,i)=>{HH(n.capturedMap,e,r,i)})}function GH(t){function e(l){const{internal:c}=t.getState(),u=l.offsetX-c.initialClick[0],f=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+f*f))}function n(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var f;return(f=c.__r3f)==null?void 0:f.handlers["onPointer"+u]}))}function r(l,c){const u=t.getState(),f=new Set,d=[],h=c?c(u.internal.interaction):u.internal.interaction;for(let y=0;y<h.length;y++){const x=Op(h[y]);x&&(x.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function p(y){const x=Op(y);if(!x||!x.events.enabled||x.raycaster.camera===null)return[];if(x.raycaster.camera===void 0){var _;x.events.compute==null||x.events.compute(l,x,(_=x.previousRoot)==null?void 0:_.getState()),x.raycaster.camera===void 0&&(x.raycaster.camera=null)}return x.raycaster.camera?x.raycaster.intersectObject(y,!0):[]}let m=h.flatMap(p).sort((y,x)=>{const _=Op(y.object),w=Op(x.object);return!_||!w?y.distance-x.distance:w.events.priority-_.events.priority||y.distance-x.distance}).filter(y=>{const x=L2(y);return f.has(x)?!1:(f.add(x),!0)});u.events.filter&&(m=u.events.filter(m,u));for(const y of m){let x=y.object;for(;x;){var g;(g=x.__r3f)!=null&&g.eventCount&&d.push({...y,eventObject:x}),x=x.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let y of u.internal.capturedMap.get(l.pointerId).values())f.has(L2(y.intersection))||d.push(y.intersection);return d}function i(l,c,u,f){const d=t.getState();if(l.length){const h={stopped:!1};for(const p of l){const m=Op(p.object)||d,{raycaster:g,pointer:y,camera:x,internal:_}=m,w=new $(y.x,y.y,0).unproject(x),T=M=>{var D,k;return(D=(k=_.capturedMap.get(M))==null?void 0:k.has(p.eventObject))!=null?D:!1},S=M=>{const D={intersection:p,target:c.target};_.capturedMap.has(M)?_.capturedMap.get(M).set(p.eventObject,D):_.capturedMap.set(M,new Map([[p.eventObject,D]])),c.target.setPointerCapture(M)},C=M=>{const D=_.capturedMap.get(M);D&&HH(_.capturedMap,p.eventObject,D,M)};let A={};for(let M in c){let D=c[M];typeof D!="function"&&(A[M]=D)}let R={...p,...A,pointer:y,intersections:l,stopped:h.stopped,delta:u,unprojectedPoint:w,ray:g.ray,camera:x,stopPropagation(){const M="pointerId"in c&&_.capturedMap.get(c.pointerId);if((!M||M.has(p.eventObject))&&(R.stopped=h.stopped=!0,_.hovered.size&&Array.from(_.hovered.values()).find(D=>D.eventObject===p.eventObject))){const D=l.slice(0,l.indexOf(p));s([...D,p])}},target:{hasPointerCapture:T,setPointerCapture:S,releasePointerCapture:C},currentTarget:{hasPointerCapture:T,setPointerCapture:S,releasePointerCapture:C},nativeEvent:c};if(f(R),h.stopped===!0)break}}return l}function s(l){const{internal:c}=t.getState();for(const u of c.hovered.values())if(!l.length||!l.find(f=>f.object===u.object&&f.index===u.index&&f.instanceId===u.instanceId)){const d=u.eventObject.__r3f,h=d==null?void 0:d.handlers;if(c.hovered.delete(L2(u)),d!=null&&d.eventCount){const p={...u,intersections:l};h.onPointerOut==null||h.onPointerOut(p),h.onPointerLeave==null||h.onPointerLeave(p)}}}function o(l,c){for(let u=0;u<c.length;u++){const f=c[u].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=t.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:f,internal:d}=t.getState();d.lastEvent.current=u;const h=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",g=r(u,h?n:void 0),y=p?e(u):0;l==="onPointerDown"&&(d.initialClick=[u.offsetX,u.offsetY],d.initialHits=g.map(_=>_.eventObject)),p&&!g.length&&y<=2&&(o(u,d.interaction),f&&f(u)),h&&s(g);function x(_){const w=_.eventObject,T=w.__r3f,S=T==null?void 0:T.handlers;if(T!=null&&T.eventCount)if(h){if(S.onPointerOver||S.onPointerEnter||S.onPointerOut||S.onPointerLeave){const C=L2(_),A=d.hovered.get(C);A?A.stopped&&_.stopPropagation():(d.hovered.set(C,_),S.onPointerOver==null||S.onPointerOver(_),S.onPointerEnter==null||S.onPointerEnter(_))}S.onPointerMove==null||S.onPointerMove(_)}else{const C=S[l];C?(!p||d.initialHits.includes(w))&&(o(u,d.interaction.filter(A=>!d.initialHits.includes(A))),C(_)):p&&d.initialHits.includes(w)&&o(u,d.interaction.filter(A=>!d.initialHits.includes(A)))}}i(g,u,y,x)}}return{handlePointer:a}}const Sle=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],jH=t=>!!(t!=null&&t.render),lh=v.createContext(null),Tle=(t,e)=>{const n=AH((a,l)=>{const c=new $,u=new $,f=new $;function d(y=l().camera,x=u,_=l().size){const{width:w,height:T,top:S,left:C}=_,A=w/T;x instanceof $?f.copy(x):f.set(...x);const R=y.getWorldPosition(c).distanceTo(f);if(LH(y))return{width:w/y.zoom,height:T/y.zoom,top:S,left:C,factor:1,distance:R,aspect:A};{const M=y.fov*Math.PI/180,D=2*Math.tan(M/2)*R,k=D*(w/T);return{width:k,height:D,top:S,left:C,factor:w/k,distance:R,aspect:A}}}let h;const p=y=>a(x=>({performance:{...x.performance,current:y}})),m=new Ke;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(y=1)=>t(l(),y),advance:(y,x)=>e(y,x,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Xb,pointer:m,mouse:m,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=l();h&&clearTimeout(h),y.performance.current!==y.performance.min&&p(y.performance.min),h=setTimeout(()=>p(l().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:y=>a(x=>({...x,events:{...x.events,...y}})),setSize:(y,x,_,w,T)=>{const S=l().camera,C={width:y,height:x,top:w||0,left:T||0,updateStyle:_};a(A=>({size:C,viewport:{...A.viewport,...d(S,u,C)}}))},setDpr:y=>a(x=>{const _=FH(y);return{viewport:{...x.viewport,dpr:_,initialDpr:x.viewport.initialDpr||_}}}),setFrameloop:(y="always")=>{const x=l().clock;x.stop(),x.elapsedTime=0,y!=="never"&&(x.start(),x.elapsedTime=0),a(()=>({frameloop:y}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:v.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,x,_)=>{const w=l().internal;return w.priority=w.priority+(x>0?1:0),w.subscribers.push({ref:y,priority:x,store:_}),w.subscribers=w.subscribers.sort((T,S)=>T.priority-S.priority),()=>{const T=l().internal;T!=null&&T.subscribers&&(T.priority=T.priority-(x>0?1:0),T.subscribers=T.subscribers.filter(S=>S.ref!==y))}}}}}),r=n.getState();let i=r.size,s=r.viewport.dpr,o=r.camera;return n.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:u,set:f}=n.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==s){var d;i=l,s=c.dpr,zH(a,l),u.setPixelRatio(c.dpr);const h=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,h)}a!==o&&(o=a,f(h=>({viewport:{...h.viewport,...h.viewport.getCurrentViewport(a)}})))}),n.subscribe(a=>t(a)),n};function Z6(t,e){const n={callback:t};return e.add(n),()=>void e.delete(n)}let D2,VH=new Set,WH=new Set,$H=new Set;const Kb=t=>Z6(t,VH),Q6=t=>Z6(t,WH),XH=t=>Z6(t,$H);function f4(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function Bp(t,e){switch(t){case"before":return f4(VH,e);case"after":return f4(WH,e);case"tail":return f4($H,e)}}let d4,h4;function p4(t,e,n){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(r=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),d4=e.internal.subscribers,D2=0;D2<d4.length;D2++)h4=d4[D2],h4.ref.current(h4.store.getState(),r,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Ale(t){let e=!1,n=!1,r,i,s;function o(c){i=requestAnimationFrame(o),e=!0,r=0,Bp("before",c),n=!0;for(const f of t.values()){var u;s=f.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((u=s.gl.xr)!=null&&u.isPresenting)&&(r+=p4(c,s))}if(n=!1,Bp("after",c),r===0)return Bp("tail",c),e=!1,cancelAnimationFrame(i)}function a(c,u=1){var f;if(!c)return t.forEach(d=>a(d.store.getState(),u));(f=c.gl.xr)!=null&&f.isPresenting||!c.internal.active||c.frameloop==="never"||(u>1?c.internal.frames=Math.min(60,c.internal.frames+u):n?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(c,u=!0,f,d){if(u&&Bp("before",c),f)p4(c,f,d);else for(const h of t.values())p4(c,h.store.getState());u&&Bp("after",c)}return{loop:o,invalidate:a,advance:l}}function Mle(t){const e=v.useRef(null);return Wm(()=>void(e.current=t.current.__r3f),[t]),e}function el(){const t=v.useContext(lh);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function At(t=n=>n,e){return el()(t,e)}function Yt(t,e=0){const n=el(),r=n.getState().internal.subscribe,i=DH(t);return Wm(()=>r(i,e,n),[e,r,n]),null}function Cle(t){return v.useMemo(()=>K6(t),[t])}const EP=new WeakMap;function qH(t,e){return function(n,...r){let i=EP.get(n);return i||(i=new n,EP.set(n,i)),t&&t(i),Promise.all(r.map(s=>new Promise((o,a)=>i.load(s,l=>{l.scene&&Object.assign(l,K6(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`))))))}}function rs(t,e,n,r){const i=Array.isArray(e)?e:[e],s=ah(qH(n,r),[t,...i],{equal:Zr.equ});return Array.isArray(e)?s:s[0]}rs.preload=function(t,e,n){const r=Array.isArray(e)?e:[e];return RH(qH(n),[t,...r])};rs.clear=function(t,e){const n=Array.isArray(e)?e:[e];return q6([t,...n])};const Wd=new Map,{invalidate:vm,advance:o5}=Ale(Wd),{reconciler:iu,applyProps:to}=yle(Wd,Ele),Kh={objects:"shallow",strict:!1},Rle=(t,e)=>{const n=typeof t=="function"?t(e):t;return jH(n)?n:new Yb({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function Ile(t,e){const n=typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:o,updateStyle:a=n}=e;return{width:r,height:i,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:r,height:i,top:s,left:o}=t.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:o,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function J6(t){const e=Wd.get(t),n=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||Tle(vm,o5),o=n||iu.createContainer(s,$p.ConcurrentRoot,null,!1,null,"",i,null);e||Wd.set(t,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:f,size:d,scene:h,events:p,onCreated:m,shadows:g=!1,linear:y=!1,flat:x=!1,legacy:_=!1,orthographic:w=!1,frameloop:T="always",dpr:S=[1,2],performance:C,raycaster:A,camera:R,onPointerMissed:M}=u,D=s.getState(),k=D.gl;D.gl||D.set({gl:k=Rle(f,t)});let L=D.raycaster;L||D.set({raycaster:L=new oh});const{params:N,...z}=A||{};if(Zr.equ(z,L,Kh)||to(L,{...z}),Zr.equ(N,L.params,Kh)||to(L,{params:{...L.params,...N}}),!D.camera||D.camera===c&&!Zr.equ(c,R,Kh)){c=R;const re=R instanceof Om,P=re?R:w?new Hi(0,0,0,0,.1,1e3):new Ar(75,0,.1,1e3);re||(P.position.z=5,R&&(to(P,R),("aspect"in R||"left"in R||"right"in R||"bottom"in R||"top"in R)&&(P.manual=!0,P.updateProjectionMatrix())),!D.camera&&!(R!=null&&R.rotation)&&P.lookAt(0,0,0)),D.set({camera:P}),L.camera=P}if(!D.scene){let re;h instanceof ls?re=h:(re=new ls,h&&to(re,h)),D.set({scene:Fp(re)})}if(!D.xr){var O;const re=(ue,te)=>{const W=s.getState();W.frameloop!=="never"&&o5(ue,!0,W,te)},P=()=>{const ue=s.getState();ue.gl.xr.enabled=ue.gl.xr.isPresenting,ue.gl.xr.setAnimationLoop(ue.gl.xr.isPresenting?re:null),ue.gl.xr.isPresenting||vm(ue)},se={connect(){const ue=s.getState().gl;ue.xr.addEventListener("sessionstart",P),ue.xr.addEventListener("sessionend",P)},disconnect(){const ue=s.getState().gl;ue.xr.removeEventListener("sessionstart",P),ue.xr.removeEventListener("sessionend",P)}};typeof((O=k.xr)==null?void 0:O.addEventListener)=="function"&&se.connect(),D.set({xr:se})}if(k.shadowMap){const re=k.shadowMap.enabled,P=k.shadowMap.type;if(k.shadowMap.enabled=!!g,Zr.boo(g))k.shadowMap.type=s1;else if(Zr.str(g)){var K;const se={basic:YB,percentage:pb,soft:s1,variance:gl};k.shadowMap.type=(K=se[g])!=null?K:s1}else Zr.obj(g)&&Object.assign(k.shadowMap,g);(re!==k.shadowMap.enabled||P!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const V=kH();V&&("enabled"in V?V.enabled=!_:"legacyMode"in V&&(V.legacyMode=_)),l||to(k,{outputEncoding:y?3e3:3001,toneMapping:x?Xa:yb}),D.legacy!==_&&D.set(()=>({legacy:_})),D.linear!==y&&D.set(()=>({linear:y})),D.flat!==x&&D.set(()=>({flat:x})),f&&!Zr.fun(f)&&!jH(f)&&!Zr.equ(f,k,Kh)&&to(k,f),p&&!D.events.handlers&&D.set({events:p(s)});const ne=Ile(t,d);return Zr.equ(ne,D.size,Kh)||D.setSize(ne.width,ne.height,ne.updateStyle,ne.top,ne.left),S&&D.viewport.dpr!==FH(S)&&D.setDpr(S),D.frameloop!==T&&D.setFrameloop(T),D.onPointerMissed||D.set({onPointerMissed:M}),C&&!Zr.equ(C,D.performance,Kh)&&D.set(re=>({performance:{...re.performance,...C}})),a=m,l=!0,this},render(u){return l||this.configure(),iu.updateContainer(H.jsx(kle,{store:s,children:u,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){eC(t)}}}function Ple(t,e,n){console.warn("R3F.render is no longer supported in React 18. Use createRoot instead!");const r=J6(e);return r.configure(n),r.render(t)}function kle({store:t,children:e,onCreated:n,rootElement:r}){return Wm(()=>{const i=t.getState();i.set(s=>({internal:{...s.internal,active:!0}})),n&&n(i),t.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),H.jsx(lh.Provider,{value:t,children:e})}function eC(t,e){const n=Wd.get(t),r=n==null?void 0:n.fiber;if(r){const i=n==null?void 0:n.store.getState();i&&(i.internal.active=!1),iu.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,o,a,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),UH(i),Wd.delete(t),e&&e(t)}catch{}},500)})}}function Al(t,e,n){return H.jsx(Lle,{children:t,container:e,state:n},e.uuid)}function Lle({state:t={},children:e,container:n}){const{events:r,size:i,...s}=t,o=el(),[a]=v.useState(()=>new oh),[l]=v.useState(()=>new Ke),c=v.useCallback((f,d)=>{const h={...f};Object.keys(f).forEach(m=>{(Sle.includes(m)||f[m]!==d[m]&&d[m])&&delete h[m]});let p;if(d&&i){const m=d.camera;p=f.viewport.getCurrentViewport(m,new $,i),m!==f.camera&&zH(m,i)}return{...h,scene:n,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...d==null?void 0:d.events,...r},size:{...f.size,...i},viewport:{...f.viewport,...p},...s}},[t]),[u]=v.useState(()=>{const f=o.getState();return AH((h,p)=>({...f,scene:n,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...r},size:{...f.size,...i},...s,set:h,get:p,setEvents:m=>h(g=>({...g,events:{...g.events,...m}}))}))});return v.useEffect(()=>{const f=o.subscribe(d=>u.setState(h=>c(d,h)));return()=>{f()}},[c]),v.useEffect(()=>{u.setState(f=>c(o.getState(),f))},[c]),v.useEffect(()=>()=>{u.destroy()},[]),H.jsx(H.Fragment,{children:iu.createPortal(H.jsx(lh.Provider,{value:u,children:e}),u,null)})}function Dle(t){return iu.flushSync(t,void 0)}iu.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:v.version});const Nle=v.unstable_act,m4={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function a5(t){const{handlePointer:e}=GH(t);return{priority:1,enabled:!0,compute(n,r,i){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(m4).reduce((n,r)=>({...n,[r]:e(r)}),{}),update:()=>{var n;const{events:r,internal:i}=t.getState();(n=i.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:n=>{var r;const{set:i,events:s}=t.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:n}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,a])=>{const[l,c]=m4[o];n.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:n,events:r}=t.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[a]=m4[s];r.connected.removeEventListener(a,o)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}function l5(t,e,n){var r,i,s,o,a;e==null&&(e=100);function l(){var u=Date.now()-o;u<e&&u>=0?r=setTimeout(l,e-u):(r=null,n||(a=t.apply(s,i),s=i=null))}var c=function(){s=this,i=arguments,o=Date.now();var u=n&&!r;return r||(r=setTimeout(l,e)),u&&(a=t.apply(s,i),s=i=null),a};return c.clear=function(){r&&(clearTimeout(r),r=null)},c.flush=function(){r&&(a=t.apply(s,i),s=i=null,clearTimeout(r),r=null)},c}l5.debounce=l5;var Ole=l5;const wP=Zd(Ole);var Fle=Object.defineProperty,Ule=Object.defineProperties,Ble=Object.getOwnPropertyDescriptors,SP=Object.getOwnPropertySymbols,zle=Object.prototype.hasOwnProperty,Hle=Object.prototype.propertyIsEnumerable,TP=(t,e,n)=>e in t?Fle(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,AP=(t,e)=>{for(var n in e||(e={}))zle.call(e,n)&&TP(t,n,e[n]);if(SP)for(var n of SP(e))Hle.call(e,n)&&TP(t,n,e[n]);return t},Gle=(t,e)=>Ule(t,Ble(e)),MP,CP;typeof window<"u"&&((MP=window.document)!=null&&MP.createElement||((CP=window.navigator)==null?void 0:CP.product)==="ReactNative")?v.useLayoutEffect:v.useEffect;function YH(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=t.child;for(;r;){const i=YH(r,e,n);if(i)return i;r=r.sibling}}function KH(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const RP=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=RP;return}return RP.apply(this,arguments)};const tC=KH(v.createContext(null));class ZH extends v.Component{render(){return v.createElement(tC.Provider,{value:this._reactInternals},this.props.children)}}function jle(){const t=v.useContext(tC);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=v.useId();return v.useMemo(()=>{for(const r of[t,t==null?void 0:t.alternate]){if(!r)continue;const i=YH(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[t,e])}function Vle(){const t=jle(),[e]=v.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const i=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;i&&i!==tC&&!e.has(i)&&e.set(i,v.useContext(KH(i)))}n=n.return}return e}function Wle(){const t=Vle();return v.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>v.createElement(e,null,v.createElement(n.Provider,Gle(AP({},r),{value:t.get(n)}))),e=>v.createElement(ZH,AP({},e))),[t])}function $le({debounce:t,scroll:e,polyfill:n,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=n||typeof window<"u"&&window.ResizeObserver,[s,o]=v.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!i)return s.width=1280,s.height=800,[()=>{},s,()=>{}];const a=v.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=t?typeof t=="number"?t:t.scroll:null,c=t?typeof t=="number"?t:t.resize:null,u=v.useRef(!1);v.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[f,d,h]=v.useMemo(()=>{const y=()=>{if(!a.current.element)return;const{left:x,top:_,width:w,height:T,bottom:S,right:C,x:A,y:R}=a.current.element.getBoundingClientRect(),M={left:x,top:_,width:w,height:T,bottom:S,right:C,x:A,y:R};a.current.element instanceof HTMLElement&&r&&(M.height=a.current.element.offsetHeight,M.width=a.current.element.offsetWidth),Object.freeze(M),u.current&&!Kle(a.current.lastBounds,M)&&o(a.current.lastBounds=M)};return[y,c?wP(y,c):y,l?wP(y,l):y]},[o,r,l,c]);function p(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",h,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function m(){var y;a.current.element&&(a.current.resizeObserver=new i(d),(y=a.current.resizeObserver)==null||y.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(x=>x.addEventListener("scroll",h,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{h()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const g=y=>{!y||y===a.current.element||(p(),a.current.element=y,a.current.scrollContainers=QH(y),m())};return qle(h,!!e),Xle(d),v.useEffect(()=>{p(),m()},[e,h,d]),v.useEffect(()=>p,[]),[g,s,f]}function Xle(t){v.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function qle(t,e){v.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function QH(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(t);return[n,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...QH(t.parentElement)]}const Yle=["x","y","top","bottom","left","right","width","height"],Kle=(t,e)=>Yle.every(n=>t[n]===e[n]),Zle=v.forwardRef(function({children:e,fallback:n,resize:r,style:i,gl:s,events:o=a5,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:f,legacy:d,orthographic:h,frameloop:p,dpr:m,performance:g,raycaster:y,camera:x,scene:_,onPointerMissed:w,onCreated:T,...S},C){v.useMemo(()=>Gi(SH),[]);const A=Wle(),[R,M]=$le({scroll:!0,debounce:{scroll:50,resize:0},...r}),D=v.useRef(null),k=v.useRef(null);v.useImperativeHandle(C,()=>D.current);const L=DH(w),[N,z]=v.useState(!1),[O,K]=v.useState(!1);if(N)throw N;if(O)throw O;const V=v.useRef(null);Wm(()=>{const re=D.current;M.width>0&&M.height>0&&re&&(V.current||(V.current=J6(re)),V.current.configure({gl:s,events:o,shadows:c,linear:u,flat:f,legacy:d,orthographic:h,frameloop:p,dpr:m,performance:g,raycaster:y,camera:x,scene:_,size:M,onPointerMissed:(...P)=>L.current==null?void 0:L.current(...P),onCreated:P=>{P.events.connect==null||P.events.connect(a?vle(a)?a.current:a:k.current),l&&P.setEvents({compute:(se,ue)=>{const te=se[l+"X"],W=se[l+"Y"];ue.pointer.set(te/ue.size.width*2-1,-(W/ue.size.height)*2+1),ue.raycaster.setFromCamera(ue.pointer,ue.camera)}}),T==null||T(P)}}),V.current.render(H.jsx(A,{children:H.jsx(NH,{set:K,children:H.jsx(v.Suspense,{fallback:H.jsx(xle,{set:z}),children:e})})})))}),v.useEffect(()=>{const re=D.current;if(re)return()=>eC(re)},[]);const ne=a?"none":"auto";return H.jsx("div",{ref:k,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ne,...i},...S,children:H.jsx("div",{ref:R,style:{width:"100%",height:"100%"},children:H.jsx("canvas",{ref:D,style:{display:"block"},children:n})})})}),nC=v.forwardRef(function(e,n){return H.jsx(ZH,{children:H.jsx(Zle,{...e,ref:n})})}),Qle=Object.freeze(Object.defineProperty({__proto__:null,Canvas:nC,ReactThreeFiber:gle,_roots:Wd,act:Nle,addAfterEffect:Q6,addEffect:Kb,addTail:XH,advance:o5,applyProps:to,buildGraph:K6,context:lh,createEvents:GH,createPointerEvents:a5,createPortal:Al,createRoot:J6,dispose:UH,events:a5,extend:Gi,flushGlobalEffects:Bp,flushSync:Dle,getRootState:Op,invalidate:vm,reconciler:iu,render:Ple,unmountComponentAtNode:eC,useFrame:Yt,useGraph:Cle,useInstanceHandle:Mle,useLoader:rs,useStore:el,useThree:At},Symbol.toStringTag,{value:"Module"})),Sy=new $,rC=new $,Jle=new $,IP=new Ke;function ece(t,e,n){const r=Sy.setFromMatrixPosition(t.matrixWorld);r.project(e);const i=n.width/2,s=n.height/2;return[r.x*i+i,-(r.y*s)+s]}function tce(t,e){const n=Sy.setFromMatrixPosition(t.matrixWorld),r=rC.setFromMatrixPosition(e.matrixWorld),i=n.sub(r),s=e.getWorldDirection(Jle);return i.angleTo(s)>Math.PI/2}function nce(t,e,n,r){const i=Sy.setFromMatrixPosition(t.matrixWorld),s=i.clone();s.project(e),IP.set(s.x,s.y),n.setFromCamera(IP,e);const o=n.intersectObjects(r,!0);if(o.length){const a=o[0].distance;return i.distanceTo(n.ray.origin)<a}return!0}function rce(t,e){if(e instanceof Hi)return e.zoom;if(e instanceof Ar){const n=Sy.setFromMatrixPosition(t.matrixWorld),r=rC.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,s=n.distanceTo(r);return 1/(2*Math.tan(i/2)*s)}else return 1}function ice(t,e,n){if(e instanceof Ar||e instanceof Hi){const r=Sy.setFromMatrixPosition(t.matrixWorld),i=rC.setFromMatrixPosition(e.matrixWorld),s=r.distanceTo(i),o=(n[1]-n[0])/(e.far-e.near),a=n[1]-o*e.far;return Math.round(o*s+a)}}const c5=t=>Math.abs(t)<1e-10?0:t;function JH(t,e,n=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=c5(e[i]*t.elements[i])+(i!==15?",":")");return n+r}const sce=(t=>e=>JH(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),oce=(t=>(e,n)=>JH(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function ace(t){return t&&typeof t=="object"&&"current"in t}const ch=v.forwardRef(({children:t,eps:e=.001,style:n,className:r,prepend:i,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:u=!1,occlude:f,onOcclude:d,castShadow:h,receiveShadow:p,material:m,geometry:g,zIndexRange:y=[16777271,0],calculatePosition:x=ece,as:_="div",wrapperClass:w,pointerEvents:T="auto",...S},C)=>{const{gl:A,camera:R,scene:M,size:D,raycaster:k,events:L,viewport:N}=At(),[z]=v.useState(()=>document.createElement(_)),O=v.useRef(),K=v.useRef(null),V=v.useRef(0),ne=v.useRef([0,0]),re=v.useRef(null),P=v.useRef(null),se=(a==null?void 0:a.current)||L.connected||A.domElement.parentNode,ue=v.useRef(null),te=v.useRef(!1),W=v.useMemo(()=>f&&f!=="blending"||Array.isArray(f)&&f.length&&ace(f[0]),[f]);v.useLayoutEffect(()=>{const me=A.domElement;f&&f==="blending"?(me.style.zIndex=`${Math.floor(y[0]/2)}`,me.style.position="absolute",me.style.pointerEvents="none"):(me.style.zIndex=null,me.style.position=null,me.style.pointerEvents=null)},[f]),v.useLayoutEffect(()=>{if(K.current){const me=O.current=n6(z);if(M.updateMatrixWorld(),u)z.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Te=x(K.current,R,D);z.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Te[0]}px,${Te[1]}px,0);transform-origin:0 0;`}return se&&(i?se.prepend(z):se.appendChild(z)),()=>{se&&se.removeChild(z),me.unmount()}}},[se,u]),v.useLayoutEffect(()=>{w&&(z.className=w)},[w]);const X=v.useMemo(()=>u?{position:"absolute",top:0,left:0,width:D.width,height:D.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-D.height/2,left:-D.width/2,width:D.width,height:D.height},...n},[n,s,o,D,u]),J=v.useMemo(()=>({position:"absolute",pointerEvents:T}),[T]);v.useLayoutEffect(()=>{if(te.current=!1,u){var me;(me=O.current)==null||me.render(v.createElement("div",{ref:re,style:X},v.createElement("div",{ref:P,style:J},v.createElement("div",{ref:C,className:r,style:n,children:t}))))}else{var Te;(Te=O.current)==null||Te.render(v.createElement("div",{ref:C,style:X,className:r,children:t}))}});const oe=v.useRef(!0);Yt(me=>{if(K.current){R.updateMatrixWorld(),K.current.updateWorldMatrix(!0,!1);const Te=u?ne.current:x(K.current,R,D);if(u||Math.abs(V.current-R.zoom)>e||Math.abs(ne.current[0]-Te[0])>e||Math.abs(ne.current[1]-Te[1])>e){const _e=tce(K.current,R);let Re=!1;W&&(Array.isArray(f)?Re=f.map(Ve=>Ve.current):f!=="blending"&&(Re=[M]));const ae=oe.current;if(Re){const Ve=nce(K.current,R,k,Re);oe.current=Ve&&!_e}else oe.current=!_e;ae!==oe.current&&(d?d(!oe.current):z.style.display=oe.current?"block":"none");const Ce=Math.floor(y[0]/2),Pe=f?W?[y[0],Ce]:[Ce-1,0]:y;if(z.style.zIndex=`${ice(K.current,R,Pe)}`,u){const[Ve,ye]=[D.width/2,D.height/2],ge=R.projectionMatrix.elements[5]*ye,{isOrthographicCamera:ze,top:fe,left:ie,bottom:ve,right:Me}=R,Be=sce(R.matrixWorldInverse),Ze=ze?`scale(${ge})translate(${c5(-(Me+ie)/2)}px,${c5((fe+ve)/2)}px)`:`translateZ(${ge}px)`;let F=K.current.matrixWorld;c&&(F=R.matrixWorldInverse.clone().transpose().copyPosition(F).scale(K.current.scale),F.elements[3]=F.elements[7]=F.elements[11]=0,F.elements[15]=1),z.style.width=D.width+"px",z.style.height=D.height+"px",z.style.perspective=ze?"":`${ge}px`,re.current&&P.current&&(re.current.style.transform=`${Ze}${Be}translate(${Ve}px,${ye}px)`,P.current.style.transform=oce(F,1/((l||10)/400)))}else{const Ve=l===void 0?1:rce(K.current,R)*l;z.style.transform=`translate3d(${Te[0]}px,${Te[1]}px,0) scale(${Ve})`}ne.current=Te,V.current=R.zoom}}if(!W&&ue.current&&!te.current)if(u){if(re.current){const Te=re.current.children[0];if(Te!=null&&Te.clientWidth&&Te!=null&&Te.clientHeight){const{isOrthographicCamera:_e}=R;if(_e||g)S.scale&&(Array.isArray(S.scale)?S.scale instanceof $?ue.current.scale.copy(S.scale.clone().divideScalar(1)):ue.current.scale.set(1/S.scale[0],1/S.scale[1],1/S.scale[2]):ue.current.scale.setScalar(1/S.scale));else{const Re=(l||10)/400,ae=Te.clientWidth*Re,Ce=Te.clientHeight*Re;ue.current.scale.set(ae,Ce,1)}te.current=!0}}}else{const Te=z.children[0];if(Te!=null&&Te.clientWidth&&Te!=null&&Te.clientHeight){const _e=1/N.factor,Re=Te.clientWidth*_e,ae=Te.clientHeight*_e;ue.current.scale.set(Re,ae,1),te.current=!0}ue.current.lookAt(me.camera.position)}});const Ee=v.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return v.createElement("group",It({},S,{ref:K}),f&&!W&&v.createElement("mesh",{castShadow:h,receiveShadow:p,ref:ue},g||v.createElement("planeGeometry",null),m||v.createElement("shaderMaterial",{side:Nr,vertexShader:Ee.vertexShader,fragmentShader:Ee.fragmentShader})))});function eG({onChanged:t,portal:e,preventDefault:n=!0,scroll:r=!0,keyCode:i=9}){const s=v.useRef(0),o=At(c=>c.setEvents),a=At(c=>c.get),l=At(c=>c.gl);return v.useEffect(()=>{var c;let u=[],f;const d=a().events.filter,h=(c=e==null?void 0:e.current)!==null&&c!==void 0?c:l.domElement.parentNode,p=()=>h&&t&&t(u,Math.round(s.current)%u.length);o({filter:(_,w)=>{let T=[..._];(T.length!==u.length||!u.every(S=>T.map(C=>C.object.uuid).includes(S.object.uuid)))&&(s.current=0,u=T,p()),d&&(T=d(T,w));for(let S=0;S<Math.round(s.current)%T.length;S++){const C=T.shift();T=[...T,C]}return T}});const m=_=>{var w,T;s.current=_(s.current),(w=a().events.handlers)==null||w.onPointerCancel(void 0),(T=a().events.handlers)==null||T.onPointerMove(f),p()},g=_=>{(_.keyCode||_.which)===i&&(n&&_.preventDefault(),u.length>1&&m(w=>w+1))},y=_=>{n&&_.preventDefault();let w=0;_||(_=window.event),_.wheelDelta?w=_.wheelDelta/120:_.detail&&(w=-_.detail/3),u.length>1&&m(T=>Math.abs(T-w))},x=_=>f=_;return document.addEventListener("pointermove",x,{passive:!0}),r&&document.addEventListener("wheel",y),i!==void 0&&document.addEventListener("keydown",g),()=>{o({filter:d}),i!==void 0&&document.removeEventListener("keydown",g),r&&document.removeEventListener("wheel",y),document.removeEventListener("pointermove",x)}},[l,a,o,n,r,i]),null}function lce(t,e,n){return Math.max(e,Math.min(t,n))}const si={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function PP(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function kP(t,e,n,r=.15){return r===0?lce(t,e,n):t<e?-PP(e-t,n-e,r)+e:t>n?+PP(t-n,n-e,r)+n:t}function cce(t,[e,n],[r,i]){const[[s,o],[a,l]]=t;return[kP(e,s,o,r),kP(n,a,l,i)]}function uce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fce(t){var e=uce(t,"string");return typeof e=="symbol"?e:String(e)}function Zi(t,e,n){return e=fce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LP(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ei(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LP(Object(n),!0).forEach(function(r){Zi(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LP(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const tG={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function DP(t){return t?t[0].toUpperCase()+t.slice(1):""}const dce=["enter","leave"];function hce(t=!1,e){return t&&!dce.includes(e)}function pce(t,e="",n=!1){const r=tG[t],i=r&&r[e]||e;return"on"+DP(t)+DP(i)+(hce(n,i)?"Capture":"")}const mce=["gotpointercapture","lostpointercapture"];function gce(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const r=mce.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(r);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:n}}function yce(t,e=""){const n=tG[t],r=n&&n[e]||e;return t+r}function Zb(t){return"touches"in t}function nG(t){return Zb(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function vce(t){return Array.from(t.touches).filter(e=>{var n,r;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,e.target))})}function xce(t){return t.type==="touchend"||t.type==="touchcancel"?t.changedTouches:t.targetTouches}function rG(t){return Zb(t)?xce(t)[0]:t}function u5(t,e){try{const n=e.clientX-t.clientX,r=e.clientY-t.clientY,i=(e.clientX+t.clientX)/2,s=(e.clientY+t.clientY)/2,o=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:o,origin:[i,s]}}catch{}return null}function _ce(t){return vce(t).map(e=>e.identifier)}function NP(t,e){const[n,r]=Array.from(t.touches).filter(i=>e.includes(i.identifier));return u5(n,r)}function g4(t){const e=rG(t);return Zb(t)?e.identifier:e.pointerId}function xm(t){const e=rG(t);return[e.clientX,e.clientY]}const OP=40,FP=800;function iG(t){let{deltaX:e,deltaY:n,deltaMode:r}=t;return r===1?(e*=OP,n*=OP):r===2&&(e*=FP,n*=FP),[e,n]}function bce(t){var e,n;const{scrollX:r,scrollY:i,scrollLeft:s,scrollTop:o}=t.currentTarget;return[(e=r??s)!==null&&e!==void 0?e:0,(n=i??o)!==null&&n!==void 0?n:0]}function Ece(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:r,metaKey:i,ctrlKey:s}=t;Object.assign(e,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:s})}return e}function h_(t,...e){return typeof t=="function"?t(...e):t}function wce(){}function Sce(...t){return t.length===0?wce:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function UP(t,e){return Object.assign({},e,t||{})}const Tce=32;class sG{constructor(e,n,r){this.ctrl=e,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:r,args:i}=this;n[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=r.from?h_(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:r,shared:i}=this;n.args=this.args;let s=0;if(e&&(n.event=e,r.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,Ece(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,s=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const S=n._delta.map(Math.abs);si.addTo(n._distance,S)}this.axisIntent&&this.axisIntent(e);const[o,a]=n._movement,[l,c]=r.threshold,{_step:u,values:f}=n;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(o)>=l&&f[0]),u[1]===!1&&(u[1]=Math.abs(a)>=c&&f[1])):(u[0]===!1&&(u[0]=Math.abs(o)>=l&&Math.sign(o)*l),u[1]===!1&&(u[1]=Math.abs(a)>=c&&Math.sign(a)*c)),n.intentional=u[0]!==!1||u[1]!==!1,!n.intentional)return;const d=[0,0];if(r.hasCustomTransform){const[S,C]=f;d[0]=u[0]!==!1?S-u[0]:0,d[1]=u[1]!==!1?C-u[1]:0}else d[0]=u[0]!==!1?o-u[0]:0,d[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(d);const h=n.offset,p=n._active&&!n._blocked||n.active;p&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=i[this.ingKey]=n._active,e&&(n.first&&("bounds"in r&&(n._bounds=h_(r.bounds,n)),this.setup&&this.setup()),n.movement=d,this.computeOffset()));const[m,g]=n.offset,[[y,x],[_,w]]=n._bounds;n.overflow=[m<y?-1:m>x?1:0,g<_?-1:g>w?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const T=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=cce(n._bounds,n.offset,T),n.delta=si.sub(n.offset,h),this.computeMovement(),p&&(!n.last||s>Tce)){n.delta=si.sub(n.offset,h);const S=n.delta.map(Math.abs);si.addTo(n.distance,S),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&s>0&&(n.velocity=[S[0]/s,S[1]/s],n.timeDelta=s)}}emit(){const e=this.state,n=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const i=this.handler(Ei(Ei(Ei({},n),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Ace([t,e],n){const r=Math.abs(t),i=Math.abs(e);if(r>i&&r>n)return"x";if(i>r&&i>n)return"y"}class Ty extends sG{constructor(...e){super(...e),Zi(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=si.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=si.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,r=this.config;if(!n.axis&&e){const i=typeof r.axisThreshold=="object"?r.axisThreshold[nG(e)]:r.axisThreshold;n.axis=Ace(n._movement,i)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const Mce=t=>t,BP=.15,oG={enabled(t=!0){return t},eventOptions(t,e,n){return Ei(Ei({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[BP,BP];case!1:return[0,0];default:return si.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return si.toVector(t)},transform(t,e,n){const r=t||n.shared.transform;return this.hasCustomTransform=!!r,r||Mce},threshold(t){return si.toVector(t,0)}},Cce=0,uh=Ei(Ei({},oG),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=Cce){return t},bounds(t={}){if(typeof t=="function")return s=>uh.bounds(t(s));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:r=-1/0,bottom:i=1/0}=t;return[[e,n],[r,i]]}}),zP={ArrowRight:(t,e=1)=>[t*e,0],ArrowLeft:(t,e=1)=>[-1*t*e,0],ArrowUp:(t,e=1)=>[0,-1*t*e],ArrowDown:(t,e=1)=>[0,t*e]};class Rce extends Ty{constructor(...e){super(...e),Zi(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const n=e._bounds.getBoundingClientRect(),r=e.currentTarget.getBoundingClientRect(),i={left:n.left-r.left+e.offset[0],right:n.right-r.right+e.offset[0],top:n.top-r.top+e.offset[1],bottom:n.bottom-r.bottom+e.offset[1]};e._bounds=uh.bounds(i)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const n=this.config,r=this.state;if(e.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(e.buttons):n.pointerButtons!==-1&&n.pointerButtons!==e.buttons))return;const i=this.ctrl.setEventIds(e);n.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(i&&i.size>1&&r._pointerActive)&&(this.start(e),this.setupPointer(e),r._pointerId=g4(e),r._pointerActive=!0,this.computeValues(xm(e)),this.computeInitial(),n.preventScrollAxis&&nG(e)!=="mouse"?(r._active=!1,this.setupScrollPrevention(e)):n.delay>0?(this.setupDelayTrigger(e),n.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const n=this.state,r=this.config;if(!n._pointerActive)return;const i=g4(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;const s=xm(e);if(document.pointerLockElement===e.target?n._delta=[e.movementX,e.movementY]:(n._delta=si.sub(s,n._values),this.computeValues(s)),si.addTo(n._movement,n._delta),this.compute(e),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(e);return}if(r.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===r.preventScrollAxis||r.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const n=this.state,r=this.config;if(!n._active||!n._pointerActive)return;const i=g4(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[s,o]=n._distance;if(n.tap=s<=r.tapsThreshold&&o<=r.tapsThreshold,n.tap&&r.filterTaps)n._force=!0;else{const[a,l]=n._delta,[c,u]=n._movement,[f,d]=r.swipe.velocity,[h,p]=r.swipe.distance,m=r.swipe.duration;if(n.elapsedTime<m){const g=Math.abs(a/n.timeDelta),y=Math.abs(l/n.timeDelta);g>f&&Math.abs(c)>h&&(n.swipe[0]=Math.sign(a)),y>d&&Math.abs(u)>p&&(n.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const n=this.config,r=n.device;n.pointerLock&&e.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Ice(e);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const n=zP[e.key];if(n){const r=this.state,i=e.shiftKey?10:e.altKey?.1:1;this.start(e),r._delta=n(this.config.keyboardDisplacement,i),r._keyboardActive=!0,si.addTo(r._movement,r._delta),this.compute(e),this.emit()}}keyUp(e){e.key in zP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const n=this.config.device;e(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(n,"change",this.pointerMove.bind(this)),e(n,"end",this.pointerUp.bind(this)),e(n,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Ice(t){"persist"in t&&typeof t.persist=="function"&&t.persist()}const Ay=typeof window<"u"&&window.document&&window.document.createElement;function aG(){return Ay&&"ontouchstart"in window}function Pce(){return aG()||Ay&&window.navigator.maxTouchPoints>1}function kce(){return Ay&&"onpointerdown"in window}function Lce(){return Ay&&"exitPointerLock"in window.document}function Dce(){try{return"constructor"in GestureEvent}catch{return!1}}const Oa={isBrowser:Ay,gesture:Dce(),touch:aG(),touchscreen:Pce(),pointer:kce(),pointerLock:Lce()},Nce=250,Oce=180,Fce=.5,Uce=50,Bce=250,zce=10,HP={mouse:0,touch:0,pen:8},Hce=Ei(Ei({},uh),{},{device(t,e,{pointer:{touch:n=!1,lock:r=!1,mouse:i=!1}={}}){return this.pointerLock=r&&Oa.pointerLock,Oa.touch&&n?"touch":this.pointerLock?"mouse":Oa.pointer&&!i?"pointer":Oa.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?Nce:void 0,!(!Oa.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:r=1,keys:i=!0}={}}){return this.pointerButtons=r,this.keys=i,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:r=3,axis:i=void 0}){const s=si.toVector(t,n?r:i?1:0);return this.filterTaps=n,this.tapsThreshold=r,s},swipe({velocity:t=Fce,distance:e=Uce,duration:n=Bce}={}){return{velocity:this.transform(si.toVector(t)),distance:this.transform(si.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return Oce;case!1:return 0;default:return t}},axisThreshold(t){return t?Ei(Ei({},HP),t):HP},keyboardDisplacement(t=zce){return t}});function lG(t){const[e,n]=t.overflow,[r,i]=t._delta,[s,o]=t._direction;(e<0&&r>0&&s<0||e>0&&r<0&&s>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&i>0&&o<0||n>0&&i<0&&o>0)&&(t._movement[1]=t._movementBound[1])}const Gce=30,jce=100;class Vce extends sG{constructor(...e){super(...e),Zi(this,"ingKey","pinching"),Zi(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:n,lastOffset:r}=this.state;e==="wheel"?this.state.offset=si.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:e,lastOffset:n}=this.state;this.state.movement=[e[0]/n[0],e[1]-n[1]]}axisIntent(){const e=this.state,[n,r]=e._movement;if(!e.axis){const i=Math.abs(n)*Gce-Math.abs(r);i<0?e.axis="angle":i>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(s=>r.has(s))||r.size<2)return;this.start(e),n._touchIds=Array.from(r).slice(0,2);const i=NP(e,n._touchIds);i&&this.pinchStart(e,i)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const n=this.state,r=n._pointerEvents,i=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(o=>i.has(o))||(r.size<2&&r.set(e.pointerId,e),n._pointerEvents.size<2))return;this.start(e);const s=u5(...Array.from(r.values()));s&&this.pinchStart(e,s)}pinchStart(e,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const n=NP(e,this.state._touchIds);n&&this.pinchMove(e,n)}pointerMove(e){const n=this.state._pointerEvents;if(n.has(e.pointerId)&&n.set(e.pointerId,e),!this.state._active)return;const r=u5(...Array.from(n.values()));r&&this.pinchMove(e,r)}pinchMove(e,n){const r=this.state,i=r._values[1],s=n.angle-i;let o=0;Math.abs(s)>270&&(o+=Math.sign(s)),this.computeValues([n.distance,n.angle-360*o]),r.origin=n.origin,r.turns=o,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const n=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}n._pointerEvents.has(e.pointerId)&&n._pointerEvents.delete(e.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const n=this.state;n._active||(this.start(e),this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY];const r=n._movement;n._movement=[e.scale-1,e.rotation],n._delta=si.sub(n._movement,r),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(r=>e[r]):!e[n])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const r=this.state;r._delta=[-iG(e)[1]/jce*r.offset[0],0],si.addTo(r._movement,r._delta),lG(r),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const n=this.config.device;n&&(e(n,"start",this[n+"Start"].bind(this)),e(n,"change",this[n+"Move"].bind(this)),e(n,"end",this[n+"End"].bind(this)),e(n,"cancel",this[n+"End"].bind(this)),e("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const Wce=Ei(Ei({},oG),{},{device(t,e,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Oa.touch&&Oa.gesture)return"gesture";if(Oa.touch&&r)return"touch";if(Oa.touchscreen){if(Oa.pointer)return"pointer";if(Oa.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:r={}}){const i=o=>{const a=UP(h_(n,o),{min:-1/0,max:1/0});return[a.min,a.max]},s=o=>{const a=UP(h_(r,o),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof r!="function"?[i(),s()]:o=>[i(o),s(o)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",si.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});class $ce extends Ty{constructor(...e){super(...e),Zi(this,"ingKey","moving")}move(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(e){this.start(e),this.computeValues(xm(e)),this.compute(e),this.computeInitial(),this.emit()}moveChange(e){if(!this.state._active)return;const n=xm(e),r=this.state;r._delta=si.sub(n,r._values),si.addTo(r._movement,r._delta),this.computeValues(n),this.compute(e),this.emit()}moveEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}bind(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}}const Xce=Ei(Ei({},uh),{},{mouseOnly:(t=!0)=>t});class qce extends Ty{constructor(...e){super(...e),Zi(this,"ingKey","scrolling")}scroll(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(e){e.cancelable&&e.preventDefault();const n=this.state,r=bce(e);n._delta=si.sub(r,n._values),si.addTo(n._movement,n._delta),this.computeValues(r),this.compute(e),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("scroll","",this.scroll.bind(this))}}const Yce=uh;class Kce extends Ty{constructor(...e){super(...e),Zi(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const n=this.state;n._delta=iG(e),si.addTo(n._movement,n._delta),lG(n),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const Zce=uh;class Qce extends Ty{constructor(...e){super(...e),Zi(this,"ingKey","hovering")}enter(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.start(e),this.computeValues(xm(e)),this.compute(e),this.emit())}leave(e){if(this.config.mouseOnly&&e.pointerType!=="mouse")return;const n=this.state;if(!n._active)return;n._active=!1;const r=xm(e);n._movement=n._delta=si.sub(r,n._values),this.computeValues(r),this.compute(e),n.delta=n.movement,this.emit()}bind(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}}const Jce=Ei(Ei({},uh),{},{mouseOnly:(t=!0)=>t}),iC=new Map,f5=new Map;function cG(t){iC.set(t.key,t.engine),f5.set(t.key,t.resolver)}const uG={key:"drag",engine:Rce,resolver:Hce},eue={key:"hover",engine:Qce,resolver:Jce},tue={key:"move",engine:$ce,resolver:Xce},nue={key:"pinch",engine:Vce,resolver:Wce},rue={key:"scroll",engine:qce,resolver:Yce},iue={key:"wheel",engine:Kce,resolver:Zce};function sue(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function oue(t,e){if(t==null)return{};var n=sue(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}const aue={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=Oa.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},lue=["target","eventOptions","window","enabled","transform"];function h3(t={},e){const n={};for(const[r,i]of Object.entries(e))switch(typeof i){case"function":n[r]=i.call(n,t[r],r,t);break;case"object":n[r]=h3(t[r],i);break;case"boolean":i&&(n[r]=t[r]);break}return n}function cue(t,e,n={}){const r=t,{target:i,eventOptions:s,window:o,enabled:a,transform:l}=r,c=oue(r,lue);if(n.shared=h3({target:i,eventOptions:s,window:o,enabled:a,transform:l},aue),e){const u=f5.get(e);n[e]=h3(Ei({shared:n.shared},c),u)}else for(const u in c){const f=f5.get(u);f&&(n[u]=h3(Ei({shared:n.shared},c[u]),f))}return n}class fG{constructor(e,n){Zi(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,r,i,s){const o=this._listeners,a=yce(n,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=Ei(Ei({},l),s);e.addEventListener(a,i,c);const u=()=>{e.removeEventListener(a,i,c),o.delete(u)};return o.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class uue{constructor(){Zi(this,"_timeouts",new Map)}add(e,n,r=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(n,r,...i))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class fue{constructor(e){Zi(this,"gestures",new Set),Zi(this,"_targetEventStore",new fG(this)),Zi(this,"gestureEventStores",{}),Zi(this,"gestureTimeoutStores",{}),Zi(this,"handlers",{}),Zi(this,"config",{}),Zi(this,"pointerIds",new Set),Zi(this,"touchIds",new Set),Zi(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),due(this,e)}setEventIds(e){if(Zb(e))return this.touchIds=new Set(_ce(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=cue(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,r={};let i;if(!(n.target&&(i=n.target(),!i))){if(n.enabled){for(const o of this.gestures){const a=this.config[o],l=GP(r,a.eventOptions,!!i);if(a.enabled){const c=iC.get(o);new c(this,e,o).bind(l)}}const s=GP(r,n.eventOptions,!!i);for(const o in this.nativeHandlers)s(o,"",a=>this.nativeHandlers[o](Ei(Ei({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const s in r)r[s]=Sce(...r[s]);if(!i)return r;for(const s in r){const{device:o,capture:a,passive:l}=gce(s);this._targetEventStore.add(i,o,"",r[s],{capture:a,passive:l})}}}}function Zh(t,e){t.gestures.add(e),t.gestureEventStores[e]=new fG(t,e),t.gestureTimeoutStores[e]=new uue}function due(t,e){e.drag&&Zh(t,"drag"),e.wheel&&Zh(t,"wheel"),e.scroll&&Zh(t,"scroll"),e.move&&Zh(t,"move"),e.pinch&&Zh(t,"pinch"),e.hover&&Zh(t,"hover")}const GP=(t,e,n)=>(r,i,s,o={},a=!1)=>{var l,c;const u=(l=o.capture)!==null&&l!==void 0?l:e.capture,f=(c=o.passive)!==null&&c!==void 0?c:e.passive;let d=a?r:pce(r,i,u);n&&f&&(d+="Passive"),t[d]=t[d]||[],t[d].push(s)},hue=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function pue(t){const e={},n={},r=new Set;for(let i in t)hue.test(i)?(r.add(RegExp.lastMatch),n[i]=t[i]):e[i]=t[i];return[n,e,r]}function Qh(t,e,n,r,i,s){if(!t.has(n)||!iC.has(r))return;const o=n+"Start",a=n+"End",l=c=>{let u;return c.first&&o in e&&e[o](c),n in e&&(u=e[n](c)),c.last&&a in e&&e[a](c),u};i[r]=l,s[r]=s[r]||{}}function mue(t,e){const[n,r,i]=pue(t),s={};return Qh(i,n,"onDrag","drag",s,e),Qh(i,n,"onWheel","wheel",s,e),Qh(i,n,"onScroll","scroll",s,e),Qh(i,n,"onPinch","pinch",s,e),Qh(i,n,"onMove","move",s,e),Qh(i,n,"onHover","hover",s,e),{handlers:s,config:e,nativeHandlers:r}}function dG(t,e={},n,r){const i=Ge.useMemo(()=>new fue(t),[]);if(i.applyHandlers(t,r),i.applyConfig(e,n),Ge.useEffect(i.effect.bind(i)),Ge.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function gue(t,e){return cG(uG),dG({drag:t},e||{},"drag")}function yue(t){return t.forEach(cG),function(n,r){const{handlers:i,nativeHandlers:s,config:o}=mue(n,r||{});return dG(i,o,void 0,s)}}function kWe(t,e){return yue([uG,nue,rue,iue,tue,eue])(t,e||{})}const sC=parseInt(wl.replace(/\D+/g,"")),oC=sC>=125?"uv1":"uv2";var vue=Object.defineProperty,xue=(t,e,n)=>e in t?vue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X0=(t,e,n)=>(xue(t,typeof e!="symbol"?e+"":e,n),n);const zp=4,sm=1024,ql=4,_ue=(t=1)=>{const e=new Float32Array(sm*ql*t*zp),n=new As(e,sm,ql*t,Pr,pr);return n.wrapS=Or,n.wrapT=Or,n.magFilter=zn,n.needsUpdate=!0,n},bue=(t,e,n=0)=>{const r=Math.floor(sm*(ql/4));e.arcLengthDivisions=r/2,e.updateArcLengths();const i=e.getSpacedPoints(r),s=e.computeFrenetFrames(r,!0);for(let o=0;o<r;o++){const a=Math.floor(o/sm),l=o%sm;let c=i[o];N2(t,l,c.x,c.y,c.z,0+a+ql*n),c=s.tangents[o],N2(t,l,c.x,c.y,c.z,1+a+ql*n),c=s.normals[o],N2(t,l,c.x,c.y,c.z,2+a+ql*n),c=s.binormals[o],N2(t,l,c.x,c.y,c.z,3+a+ql*n)}t.needsUpdate=!0},N2=(t,e,n,r,i,s)=>{const o=t.image,{data:a}=o,l=zp*sm*s;a[e*zp+l+0]=n,a[e*zp+l+1]=r,a[e*zp+l+2]=i,a[e*zp+l+3]=1},Eue=t=>({spineTexture:{value:t},pathOffset:{type:"f",value:0},pathSegment:{type:"f",value:1},spineOffset:{type:"f",value:161},spineLength:{type:"f",value:400},flow:{type:"i",value:1}});function wue(t,e,n=1){t.__ok||(t.__ok=!0,t.onBeforeCompile=r=>{if(r.__modified)return;r.__modified=!0,Object.assign(r.uniforms,e);const i=`
		uniform sampler2D spineTexture;
		uniform float pathOffset;
		uniform float pathSegment;
		uniform float spineOffset;
		uniform float spineLength;
		uniform int flow;

		float textureLayers = ${ql*n}.;
		float textureStacks = ${ql/4}.;

		${r.vertexShader}
		`.replace("#include <beginnormal_vertex>","").replace("#include <defaultnormal_vertex>","").replace("#include <begin_vertex>","").replace(/void\s*main\s*\(\)\s*\{/,`
        void main() {
        #include <beginnormal_vertex>

        vec4 worldPos = modelMatrix * vec4(position, 1.);

        bool bend = flow > 0;
        float xWeight = bend ? 0. : 1.;

        #ifdef USE_INSTANCING
        float pathOffsetFromInstanceMatrix = instanceMatrix[3][2];
        float spineLengthFromInstanceMatrix = instanceMatrix[3][0];
        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLengthFromInstanceMatrix : 0.;
        float mt = (spinePortion * pathSegment + pathOffset + pathOffsetFromInstanceMatrix)*textureStacks;
        #else
        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLength : 0.;
        float mt = (spinePortion * pathSegment + pathOffset)*textureStacks;
        #endif

        mt = mod(mt, textureStacks);
        float rowOffset = floor(mt);

        #ifdef USE_INSTANCING
        rowOffset += instanceMatrix[3][1] * ${ql}.;
        #endif

        vec3 spinePos = texture2D(spineTexture, vec2(mt, (0. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 a =        texture2D(spineTexture, vec2(mt, (1. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 b =        texture2D(spineTexture, vec2(mt, (2. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 c =        texture2D(spineTexture, vec2(mt, (3. + rowOffset + 0.5) / textureLayers)).xyz;
        mat3 basis = mat3(a, b, c);

        vec3 transformed = basis
          * vec3(worldPos.x * xWeight, worldPos.y * 1., worldPos.z * 1.)
          + spinePos;

        vec3 transformedNormal = normalMatrix * (basis * objectNormal);
			`).replace("#include <project_vertex>",`vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );
				gl_Position = projectionMatrix * mvPosition;`);r.vertexShader=i})}class Sue{constructor(e,n=1){X0(this,"curveArray"),X0(this,"curveLengthArray"),X0(this,"object3D"),X0(this,"splineTexure"),X0(this,"uniforms");const r=e.clone(),i=_ue(n),s=Eue(i);r.traverse(o=>{(o instanceof ln||o instanceof eh)&&(o.material=o.material.clone(),wue(o.material,s,n))}),this.curveArray=new Array(n),this.curveLengthArray=new Array(n),this.object3D=r,this.splineTexure=i,this.uniforms=s}updateCurve(e,n){if(e>=this.curveArray.length)throw Error("Index out of range for Flow");const r=n.getLength();this.uniforms.spineLength.value=r,this.curveLengthArray[e]=r,this.curveArray[e]=n,bue(this.splineTexure,n,e)}moveAlongCurve(e){this.uniforms.pathOffset.value+=e}}new et;function Tue(t,e=1e-4){e=Math.max(e,Number.EPSILON);const n={},r=t.getIndex(),i=t.getAttribute("position"),s=r?r.count:i.count;let o=0;const a=Object.keys(t.attributes),l={},c={},u=[],f=["getX","getY","getZ","getW"];for(let m=0,g=a.length;m<g;m++){const y=a[m];l[y]=[];const x=t.morphAttributes[y];x&&(c[y]=new Array(x.length).fill(0).map(()=>[]))}const d=Math.log10(1/e),h=Math.pow(10,d);for(let m=0;m<s;m++){const g=r?r.getX(m):m;let y="";for(let x=0,_=a.length;x<_;x++){const w=a[x],T=t.getAttribute(w),S=T.itemSize;for(let C=0;C<S;C++)y+=`${~~(T[f[C]](g)*h)},`}if(y in n)u.push(n[y]);else{for(let x=0,_=a.length;x<_;x++){const w=a[x],T=t.getAttribute(w),S=t.morphAttributes[w],C=T.itemSize,A=l[w],R=c[w];for(let M=0;M<C;M++){const D=f[M];if(A.push(T[D](g)),S)for(let k=0,L=S.length;k<L;k++)R[k].push(S[k][D](g))}}n[y]=o,u.push(o),o++}}const p=t.clone();for(let m=0,g=a.length;m<g;m++){const y=a[m],x=t.getAttribute(y),_=new x.array.constructor(l[y]),w=new fn(_,x.itemSize,x.normalized);if(p.setAttribute(y,w),y in c)for(let T=0;T<c[y].length;T++){const S=t.morphAttributes[y][T],C=new S.array.constructor(c[y][T]),A=new fn(C,S.itemSize,S.normalized);p.morphAttributes[y][T]=A}}return p.setIndex(u),p}function jP(t,e){if(e===m6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===jd||e===py){let n=t.getIndex();if(n===null){const o=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);t.setIndex(o),n=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const r=n.count-2,i=[];if(n)if(e===jd)for(let o=1;o<=r;o++)i.push(n.getX(0)),i.push(n.getX(o)),i.push(n.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(n.getX(o)),i.push(n.getX(o+1)),i.push(n.getX(o+2))):(i.push(n.getX(o+2)),i.push(n.getX(o+1)),i.push(n.getX(o)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}function hG(t,e=Math.PI/3){const n=Math.cos(e),r=(1+1e-10)*100,i=[new $,new $,new $],s=new $,o=new $,a=new $,l=new $;function c(m){const g=~~(m.x*r),y=~~(m.y*r),x=~~(m.z*r);return`${g},${y},${x}`}const u=t.index?t.toNonIndexed():t,f=u.attributes.position,d={};for(let m=0,g=f.count/3;m<g;m++){const y=3*m,x=i[0].fromBufferAttribute(f,y+0),_=i[1].fromBufferAttribute(f,y+1),w=i[2].fromBufferAttribute(f,y+2);s.subVectors(w,_),o.subVectors(x,_);const T=new $().crossVectors(s,o).normalize();for(let S=0;S<3;S++){const C=i[S],A=c(C);A in d||(d[A]=[]),d[A].push(T)}}const h=new Float32Array(f.count*3),p=new fn(h,3,!1);for(let m=0,g=f.count/3;m<g;m++){const y=3*m,x=i[0].fromBufferAttribute(f,y+0),_=i[1].fromBufferAttribute(f,y+1),w=i[2].fromBufferAttribute(f,y+2);s.subVectors(w,_),o.subVectors(x,_),a.crossVectors(s,o).normalize();for(let T=0;T<3;T++){const S=i[T],C=c(S),A=d[C];l.set(0,0,0);for(let R=0,M=A.length;R<M;R++){const D=A[R];a.dot(D)>n&&l.add(D)}l.normalize(),p.setXYZ(y+T,l.x,l.y,l.z)}}return u.setAttribute("normal",p),u}var Ua=Uint8Array,Qu=Uint16Array,d5=Uint32Array,pG=new Ua([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),mG=new Ua([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Aue=new Ua([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),gG=function(t,e){for(var n=new Qu(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new d5(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},yG=gG(pG,2),vG=yG[0],Mue=yG[1];vG[28]=258,Mue[258]=28;var Cue=gG(mG,0),Rue=Cue[0],h5=new Qu(32768);for(var ii=0;ii<32768;++ii){var Ou=(ii&43690)>>>1|(ii&21845)<<1;Ou=(Ou&52428)>>>2|(Ou&13107)<<2,Ou=(Ou&61680)>>>4|(Ou&3855)<<4,h5[ii]=((Ou&65280)>>>8|(Ou&255)<<8)>>>1}var p1=function(t,e,n){for(var r=t.length,i=0,s=new Qu(e);i<r;++i)++s[t[i]-1];var o=new Qu(e);for(i=0;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(n){a=new Qu(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var c=i<<4|t[i],u=e-t[i],f=o[t[i]-1]++<<u,d=f|(1<<u)-1;f<=d;++f)a[h5[f]>>>l]=c}else for(a=new Qu(r),i=0;i<r;++i)t[i]&&(a[i]=h5[o[t[i]-1]++]>>>15-t[i]);return a},My=new Ua(288);for(var ii=0;ii<144;++ii)My[ii]=8;for(var ii=144;ii<256;++ii)My[ii]=9;for(var ii=256;ii<280;++ii)My[ii]=7;for(var ii=280;ii<288;++ii)My[ii]=8;var xG=new Ua(32);for(var ii=0;ii<32;++ii)xG[ii]=5;var Iue=p1(My,9,1),Pue=p1(xG,5,1),y4=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},ul=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},v4=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},kue=function(t){return(t/8|0)+(t&7&&1)},Lue=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var r=new(t instanceof Qu?Qu:t instanceof d5?d5:Ua)(n-e);return r.set(t.subarray(e,n)),r},Due=function(t,e,n){var r=t.length;if(!r||n&&!n.l&&r<5)return e||new Ua(0);var i=!e||n,s=!n||n.i;n||(n={}),e||(e=new Ua(r*3));var o=function(X){var J=e.length;if(X>J){var oe=new Ua(Math.max(J*2,X));oe.set(e),e=oe}},a=n.f||0,l=n.p||0,c=n.b||0,u=n.l,f=n.d,d=n.m,h=n.n,p=r*8;do{if(!u){n.f=a=ul(t,l,1);var m=ul(t,l+1,3);if(l+=3,m)if(m==1)u=Iue,f=Pue,d=9,h=5;else if(m==2){var _=ul(t,l,31)+257,w=ul(t,l+10,15)+4,T=_+ul(t,l+5,31)+1;l+=14;for(var S=new Ua(T),C=new Ua(19),A=0;A<w;++A)C[Aue[A]]=ul(t,l+A*3,7);l+=w*3;for(var R=y4(C),M=(1<<R)-1,D=p1(C,R,1),A=0;A<T;){var k=D[ul(t,l,M)];l+=k&15;var g=k>>>4;if(g<16)S[A++]=g;else{var L=0,N=0;for(g==16?(N=3+ul(t,l,3),l+=2,L=S[A-1]):g==17?(N=3+ul(t,l,7),l+=3):g==18&&(N=11+ul(t,l,127),l+=7);N--;)S[A++]=L}}var z=S.subarray(0,_),O=S.subarray(_);d=y4(z),h=y4(O),u=p1(z,d,1),f=p1(O,h,1)}else throw"invalid block type";else{var g=kue(l)+4,y=t[g-4]|t[g-3]<<8,x=g+y;if(x>r){if(s)throw"unexpected EOF";break}i&&o(c+y),e.set(t.subarray(g,x),c),n.b=c+=y,n.p=l=x*8;continue}if(l>p){if(s)throw"unexpected EOF";break}}i&&o(c+131072);for(var K=(1<<d)-1,V=(1<<h)-1,ne=l;;ne=l){var L=u[v4(t,l)&K],re=L>>>4;if(l+=L&15,l>p){if(s)throw"unexpected EOF";break}if(!L)throw"invalid length/literal";if(re<256)e[c++]=re;else if(re==256){ne=l,u=null;break}else{var P=re-254;if(re>264){var A=re-257,se=pG[A];P=ul(t,l,(1<<se)-1)+vG[A],l+=se}var ue=f[v4(t,l)&V],te=ue>>>4;if(!ue)throw"invalid distance";l+=ue&15;var O=Rue[te];if(te>3){var se=mG[te];O+=v4(t,l)&(1<<se)-1,l+=se}if(l>p){if(s)throw"unexpected EOF";break}i&&o(c+131072);for(var W=c+P;c<W;c+=4)e[c]=e[c-O],e[c+1]=e[c+1-O],e[c+2]=e[c+2-O],e[c+3]=e[c+3-O];c=W}}n.l=u,n.p=ne,n.b=c,u&&(a=1,n.m=d,n.d=f,n.n=h)}while(!a);return c==e.length?e:Lue(e,0,c)},Nue=new Ua(0),Oue=function(t){if((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(t[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function O2(t,e){return Due((Oue(t),t.subarray(2,-4)),e)}var Fue=typeof TextDecoder<"u"&&new TextDecoder,Uue=0;try{Fue.decode(Nue,{stream:!0}),Uue=1}catch{}let Bue=class extends ln{constructor(e,n,r=!1,i=!1,s=1e4){const o=new gn;super(o,n),this.isMarchingCubes=!0;const a=this,l=new Float32Array(12*3),c=new Float32Array(12*3),u=new Float32Array(12*3);this.enableUvs=r,this.enableColors=i,this.init=function(x){this.resolution=x,this.isolation=80,this.size=x,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(this.size3*3),this.palette=new Float32Array(this.size3*3),this.count=0;const _=s*3;this.positionArray=new Float32Array(_*3);const w=new fn(this.positionArray,3);w.setUsage(Ji),o.setAttribute("position",w),this.normalArray=new Float32Array(_*3);const T=new fn(this.normalArray,3);if(T.setUsage(Ji),o.setAttribute("normal",T),this.enableUvs){this.uvArray=new Float32Array(_*2);const S=new fn(this.uvArray,2);S.setUsage(Ji),o.setAttribute("uv",S)}if(this.enableColors){this.colorArray=new Float32Array(_*3);const S=new fn(this.colorArray,3);S.setUsage(Ji),o.setAttribute("color",S)}o.boundingSphere=new wr(new $,1)};function f(x,_,w){return x+(_-x)*w}function d(x,_,w,T,S,C,A,R,M,D){const k=(w-A)/(R-A),L=a.normal_cache;l[_+0]=T+k*a.delta,l[_+1]=S,l[_+2]=C,c[_+0]=f(L[x+0],L[x+3],k),c[_+1]=f(L[x+1],L[x+4],k),c[_+2]=f(L[x+2],L[x+5],k),u[_+0]=f(a.palette[M*3+0],a.palette[D*3+0],k),u[_+1]=f(a.palette[M*3+1],a.palette[D*3+1],k),u[_+2]=f(a.palette[M*3+2],a.palette[D*3+2],k)}function h(x,_,w,T,S,C,A,R,M,D){const k=(w-A)/(R-A),L=a.normal_cache;l[_+0]=T,l[_+1]=S+k*a.delta,l[_+2]=C;const N=x+a.yd*3;c[_+0]=f(L[x+0],L[N+0],k),c[_+1]=f(L[x+1],L[N+1],k),c[_+2]=f(L[x+2],L[N+2],k),u[_+0]=f(a.palette[M*3+0],a.palette[D*3+0],k),u[_+1]=f(a.palette[M*3+1],a.palette[D*3+1],k),u[_+2]=f(a.palette[M*3+2],a.palette[D*3+2],k)}function p(x,_,w,T,S,C,A,R,M,D){const k=(w-A)/(R-A),L=a.normal_cache;l[_+0]=T,l[_+1]=S,l[_+2]=C+k*a.delta;const N=x+a.zd*3;c[_+0]=f(L[x+0],L[N+0],k),c[_+1]=f(L[x+1],L[N+1],k),c[_+2]=f(L[x+2],L[N+2],k),u[_+0]=f(a.palette[M*3+0],a.palette[D*3+0],k),u[_+1]=f(a.palette[M*3+1],a.palette[D*3+1],k),u[_+2]=f(a.palette[M*3+2],a.palette[D*3+2],k)}function m(x){const _=x*3;a.normal_cache[_]===0&&(a.normal_cache[_+0]=a.field[x-1]-a.field[x+1],a.normal_cache[_+1]=a.field[x-a.yd]-a.field[x+a.yd],a.normal_cache[_+2]=a.field[x-a.zd]-a.field[x+a.zd])}function g(x,_,w,T,S){const C=T+1,A=T+a.yd,R=T+a.zd,M=C+a.yd,D=C+a.zd,k=T+a.yd+a.zd,L=C+a.yd+a.zd;let N=0;const z=a.field[T],O=a.field[C],K=a.field[A],V=a.field[M],ne=a.field[R],re=a.field[D],P=a.field[k],se=a.field[L];z<S&&(N|=1),O<S&&(N|=2),K<S&&(N|=8),V<S&&(N|=4),ne<S&&(N|=16),re<S&&(N|=32),P<S&&(N|=128),se<S&&(N|=64);const ue=zue[N];if(ue===0)return 0;const te=a.delta,W=x+te,X=_+te,J=w+te;ue&1&&(m(T),m(C),d(T*3,0,S,x,_,w,z,O,T,C)),ue&2&&(m(C),m(M),h(C*3,3,S,W,_,w,O,V,C,M)),ue&4&&(m(A),m(M),d(A*3,6,S,x,X,w,K,V,A,M)),ue&8&&(m(T),m(A),h(T*3,9,S,x,_,w,z,K,T,A)),ue&16&&(m(R),m(D),d(R*3,12,S,x,_,J,ne,re,R,D)),ue&32&&(m(D),m(L),h(D*3,15,S,W,_,J,re,se,D,L)),ue&64&&(m(k),m(L),d(k*3,18,S,x,X,J,P,se,k,L)),ue&128&&(m(R),m(k),h(R*3,21,S,x,_,J,ne,P,R,k)),ue&256&&(m(T),m(R),p(T*3,24,S,x,_,w,z,ne,T,R)),ue&512&&(m(C),m(D),p(C*3,27,S,W,_,w,O,re,C,D)),ue&1024&&(m(M),m(L),p(M*3,30,S,W,X,w,V,se,M,L)),ue&2048&&(m(A),m(k),p(A*3,33,S,x,X,w,K,P,A,k)),N<<=4;let oe,Ee,me,Te=0,_e=0;for(;F2[N+_e]!=-1;)oe=N+_e,Ee=oe+1,me=oe+2,y(l,c,u,3*F2[oe],3*F2[Ee],3*F2[me]),_e+=3,Te++;return Te}function y(x,_,w,T,S,C){const A=a.count*3;if(a.positionArray[A+0]=x[T],a.positionArray[A+1]=x[T+1],a.positionArray[A+2]=x[T+2],a.positionArray[A+3]=x[S],a.positionArray[A+4]=x[S+1],a.positionArray[A+5]=x[S+2],a.positionArray[A+6]=x[C],a.positionArray[A+7]=x[C+1],a.positionArray[A+8]=x[C+2],a.material.flatShading===!0){const R=(_[T+0]+_[S+0]+_[C+0])/3,M=(_[T+1]+_[S+1]+_[C+1])/3,D=(_[T+2]+_[S+2]+_[C+2])/3;a.normalArray[A+0]=R,a.normalArray[A+1]=M,a.normalArray[A+2]=D,a.normalArray[A+3]=R,a.normalArray[A+4]=M,a.normalArray[A+5]=D,a.normalArray[A+6]=R,a.normalArray[A+7]=M,a.normalArray[A+8]=D}else a.normalArray[A+0]=_[T+0],a.normalArray[A+1]=_[T+1],a.normalArray[A+2]=_[T+2],a.normalArray[A+3]=_[S+0],a.normalArray[A+4]=_[S+1],a.normalArray[A+5]=_[S+2],a.normalArray[A+6]=_[C+0],a.normalArray[A+7]=_[C+1],a.normalArray[A+8]=_[C+2];if(a.enableUvs){const R=a.count*2;a.uvArray[R+0]=x[T+0],a.uvArray[R+1]=x[T+2],a.uvArray[R+2]=x[S+0],a.uvArray[R+3]=x[S+2],a.uvArray[R+4]=x[C+0],a.uvArray[R+5]=x[C+2]}a.enableColors&&(a.colorArray[A+0]=w[T+0],a.colorArray[A+1]=w[T+1],a.colorArray[A+2]=w[T+2],a.colorArray[A+3]=w[S+0],a.colorArray[A+4]=w[S+1],a.colorArray[A+5]=w[S+2],a.colorArray[A+6]=w[C+0],a.colorArray[A+7]=w[C+1],a.colorArray[A+8]=w[C+2]),a.count+=3}this.addBall=function(x,_,w,T,S,C){const A=Math.sign(T);T=Math.abs(T);const R=C!=null;let M=new wt(x,_,w);if(R)try{M=C instanceof wt?C:Array.isArray(C)?new wt(Math.min(Math.abs(C[0]),1),Math.min(Math.abs(C[1]),1),Math.min(Math.abs(C[2]),1)):new wt(C)}catch{M=new wt(x,_,w)}const D=this.size*Math.sqrt(T/S),k=w*this.size,L=_*this.size,N=x*this.size;let z=Math.floor(k-D);z<1&&(z=1);let O=Math.floor(k+D);O>this.size-1&&(O=this.size-1);let K=Math.floor(L-D);K<1&&(K=1);let V=Math.floor(L+D);V>this.size-1&&(V=this.size-1);let ne=Math.floor(N-D);ne<1&&(ne=1);let re=Math.floor(N+D);re>this.size-1&&(re=this.size-1);let P,se,ue,te,W,X,J,oe,Ee,me,Te;for(ue=z;ue<O;ue++)for(W=this.size2*ue,oe=ue/this.size-w,Ee=oe*oe,se=K;se<V;se++)for(te=W+this.size*se,J=se/this.size-_,me=J*J,P=ne;P<re;P++)if(X=P/this.size-x,Te=T/(1e-6+X*X+me+Ee)-S,Te>0){this.field[te+P]+=Te*A;const _e=Math.sqrt((P-N)*(P-N)+(se-L)*(se-L)+(ue-k)*(ue-k))/D,Re=1-_e*_e*_e*(_e*(_e*6-15)+10);this.palette[(te+P)*3+0]+=M.r*Re,this.palette[(te+P)*3+1]+=M.g*Re,this.palette[(te+P)*3+2]+=M.b*Re}},this.addPlaneX=function(x,_){const w=this.size,T=this.yd,S=this.zd,C=this.field;let A,R,M,D,k,L,N,z=w*Math.sqrt(x/_);for(z>w&&(z=w),A=0;A<z;A++)if(L=A/w,D=L*L,k=x/(1e-4+D)-_,k>0)for(R=0;R<w;R++)for(N=A+R*T,M=0;M<w;M++)C[S*M+N]+=k},this.addPlaneY=function(x,_){const w=this.size,T=this.yd,S=this.zd,C=this.field;let A,R,M,D,k,L,N,z,O=w*Math.sqrt(x/_);for(O>w&&(O=w),R=0;R<O;R++)if(L=R/w,D=L*L,k=x/(1e-4+D)-_,k>0)for(N=R*T,A=0;A<w;A++)for(z=N+A,M=0;M<w;M++)C[S*M+z]+=k},this.addPlaneZ=function(x,_){const w=this.size,T=this.yd,S=this.zd,C=this.field;let A,R,M,D,k,L,N,z,O=w*Math.sqrt(x/_);for(O>w&&(O=w),M=0;M<O;M++)if(L=M/w,D=L*L,k=x/(1e-4+D)-_,k>0)for(N=S*M,R=0;R<w;R++)for(z=N+R*T,A=0;A<w;A++)C[z+A]+=k},this.setCell=function(x,_,w,T){const S=this.size2*w+this.size*_+x;this.field[S]=T},this.getCell=function(x,_,w){const T=this.size2*w+this.size*_+x;return this.field[T]},this.blur=function(x=1){const _=this.field,w=_.slice(),T=this.size,S=this.size2;for(let C=0;C<T;C++)for(let A=0;A<T;A++)for(let R=0;R<T;R++){const M=S*R+T*A+C;let D=w[M],k=1;for(let L=-1;L<=1;L+=2){const N=L+C;if(!(N<0||N>=T))for(let z=-1;z<=1;z+=2){const O=z+A;if(!(O<0||O>=T))for(let K=-1;K<=1;K+=2){const V=K+R;if(V<0||V>=T)continue;const ne=S*V+T*O+N,re=w[ne];k++,D+=x*(re-D)/k}}}_[M]=D}},this.reset=function(){for(let x=0;x<this.size3;x++)this.normal_cache[x*3]=0,this.field[x]=0,this.palette[x*3]=this.palette[x*3+1]=this.palette[x*3+2]=0},this.update=function(){this.count=0;const x=this.size-2;for(let _=1;_<x;_++){const w=this.size2*_,T=(_-this.halfsize)/this.halfsize;for(let S=1;S<x;S++){const C=w+this.size*S,A=(S-this.halfsize)/this.halfsize;for(let R=1;R<x;R++){const M=(R-this.halfsize)/this.halfsize,D=C+R;g(M,A,T,D,this.isolation)}}}this.geometry.setDrawRange(0,this.count),o.getAttribute("position").needsUpdate=!0,o.getAttribute("normal").needsUpdate=!0,this.enableUvs&&(o.getAttribute("uv").needsUpdate=!0),this.enableColors&&(o.getAttribute("color").needsUpdate=!0),this.count/3>s&&console.warn("THREE.MarchingCubes: Geometry buffers too small for rendering. Please create an instance with a higher poly count.")},this.init(e)}};const zue=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),F2=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);var Hue=Object.defineProperty,Gue=(t,e,n)=>e in t?Hue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fl=(t,e,n)=>(Gue(t,typeof e!="symbol"?e+"":e,n),n);class x4{constructor(e=Math){fl(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),fl(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),fl(this,"p",[]),fl(this,"perm",[]),fl(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),fl(this,"dot",(n,r,i)=>n[0]*r+n[1]*i),fl(this,"dot3",(n,r,i,s)=>n[0]*r+n[1]*i+n[2]*s),fl(this,"dot4",(n,r,i,s,o)=>n[0]*r+n[1]*i+n[2]*s+n[3]*o),fl(this,"noise",(n,r)=>{let i,s,o;const a=.5*(Math.sqrt(3)-1),l=(n+r)*a,c=Math.floor(n+l),u=Math.floor(r+l),f=(3-Math.sqrt(3))/6,d=(c+u)*f,h=c-d,p=u-d,m=n-h,g=r-p;let y=0,x=1;m>g&&(y=1,x=0);const _=m-y+f,w=g-x+f,T=m-1+2*f,S=g-1+2*f,C=c&255,A=u&255,R=this.perm[C+this.perm[A]]%12,M=this.perm[C+y+this.perm[A+x]]%12,D=this.perm[C+1+this.perm[A+1]]%12;let k=.5-m*m-g*g;k<0?i=0:(k*=k,i=k*k*this.dot(this.grad3[R],m,g));let L=.5-_*_-w*w;L<0?s=0:(L*=L,s=L*L*this.dot(this.grad3[M],_,w));let N=.5-T*T-S*S;return N<0?o=0:(N*=N,o=N*N*this.dot(this.grad3[D],T,S)),70*(i+s+o)}),fl(this,"noise3d",(n,r,i)=>{let s,o,a,l;const u=(n+r+i)*.3333333333333333,f=Math.floor(n+u),d=Math.floor(r+u),h=Math.floor(i+u),p=1/6,m=(f+d+h)*p,g=f-m,y=d-m,x=h-m,_=n-g,w=r-y,T=i-x;let S,C,A,R,M,D;_>=w?w>=T?(S=1,C=0,A=0,R=1,M=1,D=0):_>=T?(S=1,C=0,A=0,R=1,M=0,D=1):(S=0,C=0,A=1,R=1,M=0,D=1):w<T?(S=0,C=0,A=1,R=0,M=1,D=1):_<T?(S=0,C=1,A=0,R=0,M=1,D=1):(S=0,C=1,A=0,R=1,M=1,D=0);const k=_-S+p,L=w-C+p,N=T-A+p,z=_-R+2*p,O=w-M+2*p,K=T-D+2*p,V=_-1+3*p,ne=w-1+3*p,re=T-1+3*p,P=f&255,se=d&255,ue=h&255,te=this.perm[P+this.perm[se+this.perm[ue]]]%12,W=this.perm[P+S+this.perm[se+C+this.perm[ue+A]]]%12,X=this.perm[P+R+this.perm[se+M+this.perm[ue+D]]]%12,J=this.perm[P+1+this.perm[se+1+this.perm[ue+1]]]%12;let oe=.6-_*_-w*w-T*T;oe<0?s=0:(oe*=oe,s=oe*oe*this.dot3(this.grad3[te],_,w,T));let Ee=.6-k*k-L*L-N*N;Ee<0?o=0:(Ee*=Ee,o=Ee*Ee*this.dot3(this.grad3[W],k,L,N));let me=.6-z*z-O*O-K*K;me<0?a=0:(me*=me,a=me*me*this.dot3(this.grad3[X],z,O,K));let Te=.6-V*V-ne*ne-re*re;return Te<0?l=0:(Te*=Te,l=Te*Te*this.dot3(this.grad3[J],V,ne,re)),32*(s+o+a+l)}),fl(this,"noise4d",(n,r,i,s)=>{const o=this.grad4,a=this.simplex,l=this.perm,c=(Math.sqrt(5)-1)/4,u=(5-Math.sqrt(5))/20;let f,d,h,p,m;const g=(n+r+i+s)*c,y=Math.floor(n+g),x=Math.floor(r+g),_=Math.floor(i+g),w=Math.floor(s+g),T=(y+x+_+w)*u,S=y-T,C=x-T,A=_-T,R=w-T,M=n-S,D=r-C,k=i-A,L=s-R,N=M>D?32:0,z=M>k?16:0,O=D>k?8:0,K=M>L?4:0,V=D>L?2:0,ne=k>L?1:0,re=N+z+O+K+V+ne;let P,se,ue,te,W,X,J,oe,Ee,me,Te,_e;P=a[re][0]>=3?1:0,se=a[re][1]>=3?1:0,ue=a[re][2]>=3?1:0,te=a[re][3]>=3?1:0,W=a[re][0]>=2?1:0,X=a[re][1]>=2?1:0,J=a[re][2]>=2?1:0,oe=a[re][3]>=2?1:0,Ee=a[re][0]>=1?1:0,me=a[re][1]>=1?1:0,Te=a[re][2]>=1?1:0,_e=a[re][3]>=1?1:0;const Re=M-P+u,ae=D-se+u,Ce=k-ue+u,Pe=L-te+u,Ve=M-W+2*u,ye=D-X+2*u,ge=k-J+2*u,ze=L-oe+2*u,fe=M-Ee+3*u,ie=D-me+3*u,ve=k-Te+3*u,Me=L-_e+3*u,Be=M-1+4*u,Ze=D-1+4*u,F=k-1+4*u,Z=L-1+4*u,q=y&255,xe=x&255,be=_&255,De=w&255,$e=l[q+l[xe+l[be+l[De]]]]%32,st=l[q+P+l[xe+se+l[be+ue+l[De+te]]]]%32,it=l[q+W+l[xe+X+l[be+J+l[De+oe]]]]%32,Ie=l[q+Ee+l[xe+me+l[be+Te+l[De+_e]]]]%32,Ye=l[q+1+l[xe+1+l[be+1+l[De+1]]]]%32;let at=.6-M*M-D*D-k*k-L*L;at<0?f=0:(at*=at,f=at*at*this.dot4(o[$e],M,D,k,L));let ke=.6-Re*Re-ae*ae-Ce*Ce-Pe*Pe;ke<0?d=0:(ke*=ke,d=ke*ke*this.dot4(o[st],Re,ae,Ce,Pe));let Xe=.6-Ve*Ve-ye*ye-ge*ge-ze*ze;Xe<0?h=0:(Xe*=Xe,h=Xe*Xe*this.dot4(o[it],Ve,ye,ge,ze));let Qe=.6-fe*fe-ie*ie-ve*ve-Me*Me;Qe<0?p=0:(Qe*=Qe,p=Qe*Qe*this.dot4(o[Ie],fe,ie,ve,Me));let _t=.6-Be*Be-Ze*Ze-F*F-Z*Z;return _t<0?m=0:(_t*=_t,m=_t*_t*this.dot4(o[Ye],Be,Ze,F,Z)),27*(f+d+h+p+m)});for(let n=0;n<256;n++)this.p[n]=Math.floor(e.random()*256);for(let n=0;n<512;n++)this.perm[n]=this.p[n&255]}}var jue=Object.defineProperty,Vue=(t,e,n)=>e in t?jue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_G=(t,e,n)=>(Vue(t,typeof e!="symbol"?e+"":e,n),n);const p3={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new $},up:{value:new $(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${sC>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},bG=new yr({name:"SkyShader",fragmentShader:p3.fragmentShader,vertexShader:p3.vertexShader,uniforms:mf.clone(p3.uniforms),side:zi,depthWrite:!1});let aC=class extends ln{constructor(){super(new fc(1,1,1),bG)}};_G(aC,"SkyShader",p3);_G(aC,"material",bG);const Wue=t=>t&&t.isCubeTexture;class $ue extends ln{constructor(e,n){var r,i;const s=Wue(e),a=((i=s?(r=e.image[0])==null?void 0:r.width:e.image.width)!=null?i:1024)/4,l=Math.floor(Math.log2(a)),c=Math.pow(2,l),u=3*Math.max(c,16*7),f=4*c,d=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/u}`,`#define CUBEUV_TEXEL_HEIGHT ${1/f}`,`#define CUBEUV_MAX_MIP ${l}.0`],h=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,p=d.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(wl.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,m={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},g=new xy(1,16),y=new yr({uniforms:m,fragmentShader:p,vertexShader:h,side:Nr});super(g,y)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}function EG(t,e,n={}){const r=new $,i=new bn,s=new $,o=new et,a=new et,l=new et;n.preserveMatrix=n.preserveMatrix!==void 0?n.preserveMatrix:!0,n.preservePosition=n.preservePosition!==void 0?n.preservePosition:!0,n.preserveHipPosition=n.preserveHipPosition!==void 0?n.preserveHipPosition:!1,n.useTargetMatrix=n.useTargetMatrix!==void 0?n.useTargetMatrix:!1,n.hip=n.hip!==void 0?n.hip:"hip",n.names=n.names||{};const c=e.isObject3D?e.skeleton.bones:p_(e),u=t.isObject3D?t.skeleton.bones:p_(t);let f,d,h,p,m;if(t.isObject3D?t.skeleton.pose():(n.useTargetMatrix=!0,n.preserveMatrix=!1),n.preservePosition){m=[];for(let g=0;g<u.length;g++)m.push(u[g].position.clone())}if(n.preserveMatrix){t.updateMatrixWorld(),t.matrixWorld.identity();for(let g=0;g<t.children.length;++g)t.children[g].updateMatrixWorld(!0)}if(n.offsets){f=[];for(let g=0;g<u.length;++g)d=u[g],h=n.names[d.name]||d.name,n.offsets[h]&&(d.matrix.multiply(n.offsets[h]),d.matrix.decompose(d.position,d.quaternion,d.scale),d.updateMatrixWorld()),f.push(d.matrixWorld.clone())}for(let g=0;g<u.length;++g){if(d=u[g],h=n.names[d.name]||d.name,p=wG(h,c),l.copy(d.matrixWorld),p){if(p.updateMatrixWorld(),n.useTargetMatrix?a.copy(p.matrixWorld):(a.copy(t.matrixWorld).invert(),a.multiply(p.matrixWorld)),s.setFromMatrixScale(a),a.scale(s.set(1/s.x,1/s.y,1/s.z)),l.makeRotationFromQuaternion(i.setFromRotationMatrix(a)),t.isObject3D){const y=u.indexOf(d),x=f?f[y]:o.copy(t.skeleton.boneInverses[y]).invert();l.multiply(x)}l.copyPosition(a)}d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(l)):d.matrix.copy(l),n.preserveHipPosition&&h===n.hip&&d.matrix.setPosition(r.set(0,d.position.y,0)),d.matrix.decompose(d.position,d.quaternion,d.scale),d.updateMatrixWorld()}if(n.preservePosition)for(let g=0;g<u.length;++g)d=u[g],h=n.names[d.name]||d.name,h!==n.hip&&d.position.copy(m[g]);n.preserveMatrix&&t.updateMatrixWorld(!0)}function Xue(t,e,n,r={}){r.useFirstFramePosition=r.useFirstFramePosition!==void 0?r.useFirstFramePosition:!1,r.fps=r.fps!==void 0?r.fps:30,r.names=r.names||[],e.isObject3D||(e=Yue(e));const i=Math.round(n.duration*(r.fps/1e3)*1e3),s=1/r.fps,o=[],a=new fH(e),l=p_(t.skeleton),c=[];let u,f,d,h,p;a.clipAction(n).play(),a.update(0),e.updateMatrixWorld();for(let m=0;m<i;++m){const g=m*s;EG(t,e,r);for(let y=0;y<l.length;++y)p=r.names[l[y].name]||l[y].name,d=wG(p,e.skeleton),d&&(f=l[y],h=c[y]=c[y]||{bone:f},r.hip===p&&(h.pos||(h.pos={times:new Float32Array(i),values:new Float32Array(i*3)}),r.useFirstFramePosition&&(m===0&&(u=f.position.clone()),f.position.sub(u)),h.pos.times[m]=g,f.position.toArray(h.pos.values,m*3)),h.quat||(h.quat={times:new Float32Array(i),values:new Float32Array(i*4)}),h.quat.times[m]=g,f.quaternion.toArray(h.quat.values,m*4));a.update(s),e.updateMatrixWorld()}for(let m=0;m<c.length;++m)h=c[m],h&&(h.pos&&o.push(new Xo(".bones["+h.bone.name+"].position",h.pos.times,h.pos.values)),o.push(new Za(".bones["+h.bone.name+"].quaternion",h.quat.times,h.quat.values)));return a.uncacheAction(n),new Qa(n.name,-1,o)}function que(t){const e=new Map,n=new Map,r=t.clone();return SG(t,r,function(i,s){e.set(s,i),n.set(i,s)}),r.traverse(function(i){if(!i.isSkinnedMesh)return;const s=i,o=e.get(i),a=o.skeleton.bones;s.skeleton=o.skeleton.clone(),s.bindMatrix.copy(o.bindMatrix),s.skeleton.bones=a.map(function(l){return n.get(l)}),s.bind(s.skeleton,s.bindMatrix)}),r}function wG(t,e){for(let n=0,r=p_(e);n<r.length;n++)if(t===r[n].name)return r[n]}function p_(t){return Array.isArray(t)?t:t.bones}function Yue(t){const e=new hH(t.bones[0]);return e.skeleton=t,e}function SG(t,e,n){n(t,e);for(let r=0;r<t.children.length;r++)SG(t.children[r],e.children[r],n)}const Kue={retarget:EG,retargetClip:Xue,clone:que},Ls=new Ci,U2=new $;class Zue{constructor(e){let n=e.geometry;n.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),n=n.toNonIndexed()),this.geometry=n,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){const e=this.positionAttribute,n=this.weightAttribute,r=new Float32Array(e.count/3);for(let s=0;s<e.count;s+=3){let o=1;n&&(o=n.getX(s)+n.getX(s+1)+n.getX(s+2)),Ls.a.fromBufferAttribute(e,s),Ls.b.fromBufferAttribute(e,s+1),Ls.c.fromBufferAttribute(e,s+2),o*=Ls.getArea(),r[s/3]=o}this.distribution=new Float32Array(e.count/3);let i=0;for(let s=0;s<r.length;s++)i+=r[s],this.distribution[s]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,n,r){const i=this.sampleFaceIndex();return this.sampleFace(i,e,n,r)}sampleFaceIndex(){const e=this.distribution[this.distribution.length-1];return this.binarySearch(this.randomFunction()*e)}binarySearch(e){const n=this.distribution;let r=0,i=n.length-1,s=-1;for(;r<=i;){const o=Math.ceil((r+i)/2);if(o===0||n[o-1]<=e&&n[o]>e){s=o;break}else e<n[o]?i=o-1:r=o+1}return s}sampleFace(e,n,r,i){let s=this.randomFunction(),o=this.randomFunction();return s+o>1&&(s=1-s,o=1-o),Ls.a.fromBufferAttribute(this.positionAttribute,e*3),Ls.b.fromBufferAttribute(this.positionAttribute,e*3+1),Ls.c.fromBufferAttribute(this.positionAttribute,e*3+2),n.set(0,0,0).addScaledVector(Ls.a,s).addScaledVector(Ls.b,o).addScaledVector(Ls.c,1-(s+o)),r!==void 0&&Ls.getNormal(r),i!==void 0&&this.colorAttribute!==void 0&&(Ls.a.fromBufferAttribute(this.colorAttribute,e*3),Ls.b.fromBufferAttribute(this.colorAttribute,e*3+1),Ls.c.fromBufferAttribute(this.colorAttribute,e*3+2),U2.set(0,0,0).addScaledVector(Ls.a,s).addScaledVector(Ls.b,o).addScaledVector(Ls.c,1-(s+o)),i.r=U2.x,i.g=U2.y,i.b=U2.z),this}}var Que=Object.defineProperty,Jue=(t,e,n)=>e in t?Que(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,efe=(t,e,n)=>(Jue(t,e+"",n),n);class tfe{constructor(){efe(this,"_listeners")}addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(n);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}var nfe=Object.defineProperty,rfe=(t,e,n)=>e in t?nfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,In=(t,e,n)=>(rfe(t,typeof e!="symbol"?e+"":e,n),n);const B2=new Yo,VP=new Oi,ife=Math.cos(70*(Math.PI/180)),WP=(t,e)=>(t%e+e)%e;let TG=class extends tfe{constructor(e,n){super(),In(this,"object"),In(this,"domElement"),In(this,"enabled",!0),In(this,"target",new $),In(this,"minDistance",0),In(this,"maxDistance",1/0),In(this,"minZoom",0),In(this,"maxZoom",1/0),In(this,"minPolarAngle",0),In(this,"maxPolarAngle",Math.PI),In(this,"minAzimuthAngle",-1/0),In(this,"maxAzimuthAngle",1/0),In(this,"enableDamping",!1),In(this,"dampingFactor",.05),In(this,"enableZoom",!0),In(this,"zoomSpeed",1),In(this,"enableRotate",!0),In(this,"rotateSpeed",1),In(this,"enablePan",!0),In(this,"panSpeed",1),In(this,"screenSpacePanning",!0),In(this,"keyPanSpeed",7),In(this,"zoomToCursor",!1),In(this,"autoRotate",!1),In(this,"autoRotateSpeed",2),In(this,"reverseOrbit",!1),In(this,"reverseHorizontalOrbit",!1),In(this,"reverseVerticalOrbit",!1),In(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),In(this,"mouseButtons",{LEFT:Fc.ROTATE,MIDDLE:Fc.DOLLY,RIGHT:Fc.PAN}),In(this,"touches",{ONE:Uc.ROTATE,TWO:Uc.DOLLY_PAN}),In(this,"target0"),In(this,"position0"),In(this,"zoom0"),In(this,"_domElementKeyEvents",null),In(this,"getPolarAngle"),In(this,"getAzimuthalAngle"),In(this,"setPolarAngle"),In(this,"setAzimuthalAngle"),In(this,"getDistance"),In(this,"getZoomScale"),In(this,"listenToKeyEvents"),In(this,"stopListenToKeyEvents"),In(this,"saveState"),In(this,"reset"),In(this,"update"),In(this,"connect"),In(this,"dispose"),In(this,"dollyIn"),In(this,"dollyOut"),In(this,"getScale"),In(this,"setScale"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=Ie=>{let Ye=WP(Ie,2*Math.PI),at=u.phi;at<0&&(at+=2*Math.PI),Ye<0&&(Ye+=2*Math.PI);let ke=Math.abs(Ye-at);2*Math.PI-ke<ke&&(Ye<at?Ye+=2*Math.PI:at+=2*Math.PI),f.phi=Ye-at,r.update()},this.setAzimuthalAngle=Ie=>{let Ye=WP(Ie,2*Math.PI),at=u.theta;at<0&&(at+=2*Math.PI),Ye<0&&(Ye+=2*Math.PI);let ke=Math.abs(Ye-at);2*Math.PI-ke<ke&&(Ye<at?Ye+=2*Math.PI:at+=2*Math.PI),f.theta=Ye-at,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=Ie=>{Ie.addEventListener("keydown",Z),this._domElementKeyEvents=Ie},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Z),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),l=a.NONE},this.update=(()=>{const Ie=new $,Ye=new $(0,1,0),at=new bn().setFromUnitVectors(e.up,Ye),ke=at.clone().invert(),Xe=new $,Qe=new bn,_t=2*Math.PI;return function(){const Ct=r.object.position;at.setFromUnitVectors(e.up,Ye),ke.copy(at).invert(),Ie.copy(Ct).sub(r.target),Ie.applyQuaternion(at),u.setFromVector3(Ie),r.autoRotate&&l===a.NONE&&N(k()),r.enableDamping?(u.theta+=f.theta*r.dampingFactor,u.phi+=f.phi*r.dampingFactor):(u.theta+=f.theta,u.phi+=f.phi);let Kt=r.minAzimuthAngle,cn=r.maxAzimuthAngle;isFinite(Kt)&&isFinite(cn)&&(Kt<-Math.PI?Kt+=_t:Kt>Math.PI&&(Kt-=_t),cn<-Math.PI?cn+=_t:cn>Math.PI&&(cn-=_t),Kt<=cn?u.theta=Math.max(Kt,Math.min(cn,u.theta)):u.theta=u.theta>(Kt+cn)/2?Math.max(Kt,u.theta):Math.min(cn,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(h,r.dampingFactor):r.target.add(h),r.zoomToCursor&&R||r.object.isOrthographicCamera?u.radius=ue(u.radius):u.radius=ue(u.radius*d),Ie.setFromSpherical(u),Ie.applyQuaternion(ke),Ct.copy(r.target).add(Ie),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(f.theta*=1-r.dampingFactor,f.phi*=1-r.dampingFactor,h.multiplyScalar(1-r.dampingFactor)):(f.set(0,0,0),h.set(0,0,0));let sn=!1;if(r.zoomToCursor&&R){let Vt=null;if(r.object instanceof Ar&&r.object.isPerspectiveCamera){const Gn=Ie.length();Vt=ue(Gn*d);const rr=Gn-Vt;r.object.position.addScaledVector(C,rr),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const Gn=new $(A.x,A.y,0);Gn.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),r.object.updateProjectionMatrix(),sn=!0;const rr=new $(A.x,A.y,0);rr.unproject(r.object),r.object.position.sub(rr).add(Gn),r.object.updateMatrixWorld(),Vt=Ie.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;Vt!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Vt).add(r.object.position):(B2.origin.copy(r.object.position),B2.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(B2.direction))<ife?e.lookAt(r.target):(VP.setFromNormalAndCoplanarPoint(r.object.up,r.target),B2.intersectPlane(VP,r.target))))}else r.object instanceof Hi&&r.object.isOrthographicCamera&&(sn=d!==1,sn&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),r.object.updateProjectionMatrix()));return d=1,R=!1,sn||Xe.distanceToSquared(r.object.position)>c||8*(1-Qe.dot(r.object.quaternion))>c?(r.dispatchEvent(i),Xe.copy(r.object.position),Qe.copy(r.object.quaternion),sn=!1,!0):!1}})(),this.connect=Ie=>{r.domElement=Ie,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",be),r.domElement.addEventListener("pointerdown",ie),r.domElement.addEventListener("pointercancel",Me),r.domElement.addEventListener("wheel",F)},this.dispose=()=>{var Ie,Ye,at,ke,Xe,Qe;r.domElement&&(r.domElement.style.touchAction="auto"),(Ie=r.domElement)==null||Ie.removeEventListener("contextmenu",be),(Ye=r.domElement)==null||Ye.removeEventListener("pointerdown",ie),(at=r.domElement)==null||at.removeEventListener("pointercancel",Me),(ke=r.domElement)==null||ke.removeEventListener("wheel",F),(Xe=r.domElement)==null||Xe.ownerDocument.removeEventListener("pointermove",ve),(Qe=r.domElement)==null||Qe.ownerDocument.removeEventListener("pointerup",Me),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",Z)};const r=this,i={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new d_,f=new d_;let d=1;const h=new $,p=new Ke,m=new Ke,g=new Ke,y=new Ke,x=new Ke,_=new Ke,w=new Ke,T=new Ke,S=new Ke,C=new $,A=new Ke;let R=!1;const M=[],D={};function k(){return 2*Math.PI/60/60*r.autoRotateSpeed}function L(){return Math.pow(.95,r.zoomSpeed)}function N(Ie){r.reverseOrbit||r.reverseHorizontalOrbit?f.theta+=Ie:f.theta-=Ie}function z(Ie){r.reverseOrbit||r.reverseVerticalOrbit?f.phi+=Ie:f.phi-=Ie}const O=(()=>{const Ie=new $;return function(at,ke){Ie.setFromMatrixColumn(ke,0),Ie.multiplyScalar(-at),h.add(Ie)}})(),K=(()=>{const Ie=new $;return function(at,ke){r.screenSpacePanning===!0?Ie.setFromMatrixColumn(ke,1):(Ie.setFromMatrixColumn(ke,0),Ie.crossVectors(r.object.up,Ie)),Ie.multiplyScalar(at),h.add(Ie)}})(),V=(()=>{const Ie=new $;return function(at,ke){const Xe=r.domElement;if(Xe&&r.object instanceof Ar&&r.object.isPerspectiveCamera){const Qe=r.object.position;Ie.copy(Qe).sub(r.target);let _t=Ie.length();_t*=Math.tan(r.object.fov/2*Math.PI/180),O(2*at*_t/Xe.clientHeight,r.object.matrix),K(2*ke*_t/Xe.clientHeight,r.object.matrix)}else Xe&&r.object instanceof Hi&&r.object.isOrthographicCamera?(O(at*(r.object.right-r.object.left)/r.object.zoom/Xe.clientWidth,r.object.matrix),K(ke*(r.object.top-r.object.bottom)/r.object.zoom/Xe.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function ne(Ie){r.object instanceof Ar&&r.object.isPerspectiveCamera||r.object instanceof Hi&&r.object.isOrthographicCamera?d=Ie:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function re(Ie){ne(d/Ie)}function P(Ie){ne(d*Ie)}function se(Ie){if(!r.zoomToCursor||!r.domElement)return;R=!0;const Ye=r.domElement.getBoundingClientRect(),at=Ie.clientX-Ye.left,ke=Ie.clientY-Ye.top,Xe=Ye.width,Qe=Ye.height;A.x=at/Xe*2-1,A.y=-(ke/Qe)*2+1,C.set(A.x,A.y,1).unproject(r.object).sub(r.object.position).normalize()}function ue(Ie){return Math.max(r.minDistance,Math.min(r.maxDistance,Ie))}function te(Ie){p.set(Ie.clientX,Ie.clientY)}function W(Ie){se(Ie),w.set(Ie.clientX,Ie.clientY)}function X(Ie){y.set(Ie.clientX,Ie.clientY)}function J(Ie){m.set(Ie.clientX,Ie.clientY),g.subVectors(m,p).multiplyScalar(r.rotateSpeed);const Ye=r.domElement;Ye&&(N(2*Math.PI*g.x/Ye.clientHeight),z(2*Math.PI*g.y/Ye.clientHeight)),p.copy(m),r.update()}function oe(Ie){T.set(Ie.clientX,Ie.clientY),S.subVectors(T,w),S.y>0?re(L()):S.y<0&&P(L()),w.copy(T),r.update()}function Ee(Ie){x.set(Ie.clientX,Ie.clientY),_.subVectors(x,y).multiplyScalar(r.panSpeed),V(_.x,_.y),y.copy(x),r.update()}function me(Ie){se(Ie),Ie.deltaY<0?P(L()):Ie.deltaY>0&&re(L()),r.update()}function Te(Ie){let Ye=!1;switch(Ie.code){case r.keys.UP:V(0,r.keyPanSpeed),Ye=!0;break;case r.keys.BOTTOM:V(0,-r.keyPanSpeed),Ye=!0;break;case r.keys.LEFT:V(r.keyPanSpeed,0),Ye=!0;break;case r.keys.RIGHT:V(-r.keyPanSpeed,0),Ye=!0;break}Ye&&(Ie.preventDefault(),r.update())}function _e(){if(M.length==1)p.set(M[0].pageX,M[0].pageY);else{const Ie=.5*(M[0].pageX+M[1].pageX),Ye=.5*(M[0].pageY+M[1].pageY);p.set(Ie,Ye)}}function Re(){if(M.length==1)y.set(M[0].pageX,M[0].pageY);else{const Ie=.5*(M[0].pageX+M[1].pageX),Ye=.5*(M[0].pageY+M[1].pageY);y.set(Ie,Ye)}}function ae(){const Ie=M[0].pageX-M[1].pageX,Ye=M[0].pageY-M[1].pageY,at=Math.sqrt(Ie*Ie+Ye*Ye);w.set(0,at)}function Ce(){r.enableZoom&&ae(),r.enablePan&&Re()}function Pe(){r.enableZoom&&ae(),r.enableRotate&&_e()}function Ve(Ie){if(M.length==1)m.set(Ie.pageX,Ie.pageY);else{const at=it(Ie),ke=.5*(Ie.pageX+at.x),Xe=.5*(Ie.pageY+at.y);m.set(ke,Xe)}g.subVectors(m,p).multiplyScalar(r.rotateSpeed);const Ye=r.domElement;Ye&&(N(2*Math.PI*g.x/Ye.clientHeight),z(2*Math.PI*g.y/Ye.clientHeight)),p.copy(m)}function ye(Ie){if(M.length==1)x.set(Ie.pageX,Ie.pageY);else{const Ye=it(Ie),at=.5*(Ie.pageX+Ye.x),ke=.5*(Ie.pageY+Ye.y);x.set(at,ke)}_.subVectors(x,y).multiplyScalar(r.panSpeed),V(_.x,_.y),y.copy(x)}function ge(Ie){const Ye=it(Ie),at=Ie.pageX-Ye.x,ke=Ie.pageY-Ye.y,Xe=Math.sqrt(at*at+ke*ke);T.set(0,Xe),S.set(0,Math.pow(T.y/w.y,r.zoomSpeed)),re(S.y),w.copy(T)}function ze(Ie){r.enableZoom&&ge(Ie),r.enablePan&&ye(Ie)}function fe(Ie){r.enableZoom&&ge(Ie),r.enableRotate&&Ve(Ie)}function ie(Ie){var Ye,at;r.enabled!==!1&&(M.length===0&&((Ye=r.domElement)==null||Ye.ownerDocument.addEventListener("pointermove",ve),(at=r.domElement)==null||at.ownerDocument.addEventListener("pointerup",Me)),De(Ie),Ie.pointerType==="touch"?q(Ie):Be(Ie))}function ve(Ie){r.enabled!==!1&&(Ie.pointerType==="touch"?xe(Ie):Ze(Ie))}function Me(Ie){var Ye,at,ke;$e(Ie),M.length===0&&((Ye=r.domElement)==null||Ye.releasePointerCapture(Ie.pointerId),(at=r.domElement)==null||at.ownerDocument.removeEventListener("pointermove",ve),(ke=r.domElement)==null||ke.ownerDocument.removeEventListener("pointerup",Me)),r.dispatchEvent(o),l=a.NONE}function Be(Ie){let Ye;switch(Ie.button){case 0:Ye=r.mouseButtons.LEFT;break;case 1:Ye=r.mouseButtons.MIDDLE;break;case 2:Ye=r.mouseButtons.RIGHT;break;default:Ye=-1}switch(Ye){case Fc.DOLLY:if(r.enableZoom===!1)return;W(Ie),l=a.DOLLY;break;case Fc.ROTATE:if(Ie.ctrlKey||Ie.metaKey||Ie.shiftKey){if(r.enablePan===!1)return;X(Ie),l=a.PAN}else{if(r.enableRotate===!1)return;te(Ie),l=a.ROTATE}break;case Fc.PAN:if(Ie.ctrlKey||Ie.metaKey||Ie.shiftKey){if(r.enableRotate===!1)return;te(Ie),l=a.ROTATE}else{if(r.enablePan===!1)return;X(Ie),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function Ze(Ie){if(r.enabled!==!1)switch(l){case a.ROTATE:if(r.enableRotate===!1)return;J(Ie);break;case a.DOLLY:if(r.enableZoom===!1)return;oe(Ie);break;case a.PAN:if(r.enablePan===!1)return;Ee(Ie);break}}function F(Ie){r.enabled===!1||r.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(Ie.preventDefault(),r.dispatchEvent(s),me(Ie),r.dispatchEvent(o))}function Z(Ie){r.enabled===!1||r.enablePan===!1||Te(Ie)}function q(Ie){switch(st(Ie),M.length){case 1:switch(r.touches.ONE){case Uc.ROTATE:if(r.enableRotate===!1)return;_e(),l=a.TOUCH_ROTATE;break;case Uc.PAN:if(r.enablePan===!1)return;Re(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case Uc.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;Ce(),l=a.TOUCH_DOLLY_PAN;break;case Uc.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Pe(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function xe(Ie){switch(st(Ie),l){case a.TOUCH_ROTATE:if(r.enableRotate===!1)return;Ve(Ie),r.update();break;case a.TOUCH_PAN:if(r.enablePan===!1)return;ye(Ie),r.update();break;case a.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ze(Ie),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;fe(Ie),r.update();break;default:l=a.NONE}}function be(Ie){r.enabled!==!1&&Ie.preventDefault()}function De(Ie){M.push(Ie)}function $e(Ie){delete D[Ie.pointerId];for(let Ye=0;Ye<M.length;Ye++)if(M[Ye].pointerId==Ie.pointerId){M.splice(Ye,1);return}}function st(Ie){let Ye=D[Ie.pointerId];Ye===void 0&&(Ye=new Ke,D[Ie.pointerId]=Ye),Ye.set(Ie.pageX,Ie.pageY)}function it(Ie){const Ye=Ie.pointerId===M[0].pointerId?M[1]:M[0];return D[Ye.pointerId]}this.dollyIn=(Ie=L())=>{P(Ie),r.update()},this.dollyOut=(Ie=L())=>{re(Ie),r.update()},this.getScale=()=>d,this.setScale=Ie=>{ne(Ie),r.update()},this.getZoomScale=()=>L(),n!==void 0&&this.connect(n),this.update()}};class OWe extends TG{constructor(e,n){super(e,n),this.screenSpacePanning=!1,this.mouseButtons.LEFT=Fc.PAN,this.mouseButtons.RIGHT=Fc.ROTATE,this.touches.ONE=Uc.PAN,this.touches.TWO=Uc.DOLLY_ROTATE}}var sfe=Object.defineProperty,ofe=(t,e,n)=>e in t?sfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bd=(t,e,n)=>(ofe(t,typeof e!="symbol"?e+"":e,n),n);class Qb{constructor(){bd(this,"enabled",!0),bd(this,"needsSwap",!0),bd(this,"clear",!1),bd(this,"renderToScreen",!1)}setSize(e,n){}render(e,n,r,i,s){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}class Gc{constructor(e){bd(this,"camera",new Hi(-1,1,1,-1,0,1)),bd(this,"geometry",new Ps(2,2)),bd(this,"mesh"),this.mesh=new ln(this.geometry,e)}get material(){return this.mesh.material}set material(e){this.mesh.material=e}dispose(){this.mesh.geometry.dispose()}render(e){e.render(this.mesh,this.camera)}}var afe=Object.defineProperty,lfe=(t,e,n)=>e in t?afe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,z2=(t,e,n)=>(lfe(t,typeof e!="symbol"?e+"":e,n),n);class p5 extends Qb{constructor(e,n="tDiffuse"){super(),z2(this,"textureID"),z2(this,"uniforms"),z2(this,"material"),z2(this,"fsQuad"),this.textureID=n,e instanceof yr?(this.uniforms=e.uniforms,this.material=e):(this.uniforms=mf.clone(e.uniforms),this.material=new yr({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Gc(this.material)}render(e,n,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.fsQuad.dispose(),this.material.dispose()}}const $P={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","	vec4 texel = texture2D( tDiffuse, vUv );","	gl_FragColor = opacity * texel;","}"].join(`
`)};var cfe=Object.defineProperty,ufe=(t,e,n)=>e in t?cfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_4=(t,e,n)=>(ufe(t,typeof e!="symbol"?e+"":e,n),n);class XP extends Qb{constructor(e,n){super(),_4(this,"scene"),_4(this,"camera"),_4(this,"inverse"),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,r){const i=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),s.buffers.stencil.setFunc(i.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(i.EQUAL,1,4294967295),s.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),s.buffers.stencil.setLocked(!0)}}class ffe extends Qb{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}var dfe=Object.defineProperty,hfe=(t,e,n)=>e in t?dfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ta=(t,e,n)=>(hfe(t,typeof e!="symbol"?e+"":e,n),n);class pfe{constructor(e,n){if(Ta(this,"renderer"),Ta(this,"_pixelRatio"),Ta(this,"_width"),Ta(this,"_height"),Ta(this,"renderTarget1"),Ta(this,"renderTarget2"),Ta(this,"writeBuffer"),Ta(this,"readBuffer"),Ta(this,"renderToScreen"),Ta(this,"passes",[]),Ta(this,"copyPass"),Ta(this,"clock"),this.renderer=e,n===void 0){const r={minFilter:Pn,magFilter:Pn,format:Pr},i=e.getSize(new Ke);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,n=new fr(this._width*this._pixelRatio,this._height*this._pixelRatio,r),n.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,$P===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),p5===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new p5($P),this.copyPass.material.blending=$a,this.clock=new Xb}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let r=!1;const i=this.passes.length;for(let s=0;s<i;s++){const o=this.passes[s];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),o.needsSwap){if(r){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}XP!==void 0&&(o instanceof XP?r=!0:o instanceof ffe&&(r=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Ke);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}var mfe=Object.defineProperty,gfe=(t,e,n)=>e in t?mfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rd=(t,e,n)=>(gfe(t,typeof e!="symbol"?e+"":e,n),n);class yfe extends Qb{constructor(e,n,r,i,s=0){super(),rd(this,"scene"),rd(this,"camera"),rd(this,"overrideMaterial"),rd(this,"clearColor"),rd(this,"clearAlpha"),rd(this,"clearDepth",!1),rd(this,"_oldClearColor",new wt),this.scene=e,this.camera=n,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=s,this.clear=!0,this.needsSwap=!1}render(e,n,r){let i=e.autoClear;e.autoClear=!1;let s,o=null;this.overrideMaterial!==void 0&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=o),e.autoClear=i}}function $d(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}}const Ed="srgb",Qc="srgb-linear",qP=3001,vfe=3e3;let m5=class extends Br{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new wfe(n)}),this.register(function(n){return new Sfe(n)}),this.register(function(n){return new Lfe(n)}),this.register(function(n){return new Dfe(n)}),this.register(function(n){return new Nfe(n)}),this.register(function(n){return new Afe(n)}),this.register(function(n){return new Mfe(n)}),this.register(function(n){return new Cfe(n)}),this.register(function(n){return new Rfe(n)}),this.register(function(n){return new Efe(n)}),this.register(function(n){return new Ife(n)}),this.register(function(n){return new Tfe(n)}),this.register(function(n){return new kfe(n)}),this.register(function(n){return new Pfe(n)}),this.register(function(n){return new _fe(n)}),this.register(function(n){return new Ofe(n)}),this.register(function(n){return new Ffe(n)})}load(e,n,r,i){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const c=Ms.extractUrlBase(e);o=Ms.resolveURL(c,this.path)}else o=Ms.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){i?i(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new qr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){n(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,r,i){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if($d(new Uint8Array(e.slice(0,4)))===AG){try{o[lr.KHR_BINARY_GLTF]=new Ufe(e)}catch(u){i&&i(u);return}s=JSON.parse(o[lr.KHR_BINARY_GLTF].content)}else s=JSON.parse($d(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new Zfe(s,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const u=this.pluginCallbacks[c](l);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const u=s.extensionsUsed[c],f=s.extensionsRequired||[];switch(u){case lr.KHR_MATERIALS_UNLIT:o[u]=new bfe;break;case lr.KHR_DRACO_MESH_COMPRESSION:o[u]=new Bfe(s,this.dracoLoader);break;case lr.KHR_TEXTURE_TRANSFORM:o[u]=new zfe;break;case lr.KHR_MESH_QUANTIZATION:o[u]=new Hfe;break;default:f.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(r,i)}parseAsync(e,n){const r=this;return new Promise(function(i,s){r.parse(e,n,i,s)})}};function xfe(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const lr={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let _fe=class{constructor(e){this.parser=e,this.name=lr.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let r=0,i=n.length;r<i;r++){const s=n[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const n=this.parser,r="light:"+e;let i=n.cache.get(r);if(i)return i;const s=n.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new wt(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],Qc);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new jm(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Gm(u),c.distance=f;break;case"spot":c=new Hm(u),c.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Nc(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=n.createUniqueName(l.name||"light_"+e),i=Promise.resolve(c),n.cache.add(r,i),i}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,r=this.parser,s=r.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return r._getNodeRef(n.cache,a,l)})}},bfe=class{constructor(){this.name=lr.KHR_MATERIALS_UNLIT}getMaterialType(){return Fr}extendParams(e,n,r){const i=[];e.color=new wt(1,1,1),e.opacity=1;const s=n.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Qc),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,Ed))}return Promise.all(i)}},Efe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(n.emissiveIntensity=s),Promise.resolve()}},wfe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(n.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(r.assignTexture(n,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(n,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(n,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new Ke(a,a)}return Promise.all(s)}},Sfe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return n.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}},Tfe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(n.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(r.assignTexture(n,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(n.iridescenceIOR=o.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(n,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}},Afe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];n.sheenColor=new wt(0,0,0),n.sheenRoughness=0,n.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;n.sheenColor.setRGB(a[0],a[1],a[2],Qc)}return o.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(r.assignTexture(n,"sheenColorMap",o.sheenColorTexture,Ed)),o.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(n,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}},Mfe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(n.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(r.assignTexture(n,"transmissionMap",o.transmissionTexture)),Promise.all(s)}},Cfe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];n.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(r.assignTexture(n,"thicknessMap",o.thicknessTexture)),n.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return n.attenuationColor=new wt().setRGB(a[0],a[1],a[2],Qc),Promise.all(s)}},Rfe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return n.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}},Ife=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];n.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(r.assignTexture(n,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return n.specularColor=new wt().setRGB(a[0],a[1],a[2],Qc),o.specularColorTexture!==void 0&&s.push(r.assignTexture(n,"specularColorMap",o.specularColorTexture,Ed)),Promise.all(s)}},Pfe=class{constructor(e){this.parser=e,this.name=lr.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return n.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(r.assignTexture(n,"bumpMap",o.bumpTexture)),Promise.all(s)}},kfe=class{constructor(e){this.parser=e,this.name=lr.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(n.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(n.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(r.assignTexture(n,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}},Lfe=class{constructor(e){this.parser=e,this.name=lr.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=n.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,s.source,o)}},Dfe=class{constructor(e){this.parser=e,this.name=lr.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}},Nfe=class{constructor(e){this.parser=e,this.name=lr.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}},Ofe=class{constructor(e){this.name=lr.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,r=n.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=i.byteOffset||0,c=i.byteLength||0,u=i.count,f=i.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,f,d,i.mode,i.filter).then(function(h){return h.buffer}):o.ready.then(function(){const h=new ArrayBuffer(u*f);return o.decodeGltfBuffer(new Uint8Array(h),u,f,d,i.mode,i.filter),h})})}else return null}},Ffe=class{constructor(e){this.name=lr.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,r=n.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=n.meshes[r.mesh];for(const c of i.primitives)if(c.mode!==ka.TRIANGLES&&c.mode!==ka.TRIANGLE_STRIP&&c.mode!==ka.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=r.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),f=u.isGroup?u.children:[u],d=c[0].count,h=[];for(const p of f){const m=new et,g=new $,y=new bn,x=new $(1,1,1),_=new eh(p.geometry,p.material,d);for(let w=0;w<d;w++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,w),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,w),l.SCALE&&x.fromBufferAttribute(l.SCALE,w),_.setMatrixAt(w,m.compose(g,y,x));for(const w in l)if(w==="_COLOR_0"){const T=l[w];_.instanceColor=new Ya(T.array,T.itemSize,T.normalized)}else w!=="TRANSLATION"&&w!=="ROTATION"&&w!=="SCALE"&&p.geometry.setAttribute(w,l[w]);yn.prototype.copy.call(_,p),this.parser.assignFinalMaterial(_),h.push(_)}return u.isGroup?(u.clear(),u.add(...h),u):h[0]}))}};const AG="glTF",q0=12,YP={JSON:1313821514,BIN:5130562};let Ufe=class{constructor(e){this.name=lr.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,q0);if(this.header={magic:$d(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==AG)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-q0,i=new DataView(e,q0);let s=0;for(;s<r;){const o=i.getUint32(s,!0);s+=4;const a=i.getUint32(s,!0);if(s+=4,a===YP.JSON){const l=new Uint8Array(e,q0+s,o);this.content=$d(l)}else if(a===YP.BIN){const l=q0+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},Bfe=class{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=lr.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const f=g5[u]||u.toLowerCase();a[f]=o[u]}for(const u in e.attributes){const f=g5[u]||u.toLowerCase();if(o[u]!==void 0){const d=r.accessors[e.attributes[u]],h=om[d.componentType];c[f]=h.name,l[f]=d.normalized===!0}}return n.getDependency("bufferView",s).then(function(u){return new Promise(function(f,d){i.decodeDracoFile(u,function(h){for(const p in h.attributes){const m=h.attributes[p],g=l[p];g!==void 0&&(m.normalized=g)}f(h)},a,c,Qc,d)})})}},zfe=class{constructor(){this.name=lr.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}},Hfe=class{constructor(){this.name=lr.KHR_MESH_QUANTIZATION}},MG=class extends rh{constructor(e,n,r,i){super(e,n,r,i)}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)n[o]=r[s+o];return n}interpolate_(e,n,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=i-n,f=(r-n)/u,d=f*f,h=d*f,p=e*c,m=p-c,g=-2*h+3*d,y=h-d,x=1-g,_=y-d+f;for(let w=0;w!==a;w++){const T=o[m+w+a],S=o[m+w+l]*u,C=o[p+w+a],A=o[p+w]*u;s[w]=x*T+_*S+g*C+y*A}return s}};const Gfe=new bn;let jfe=class extends MG{interpolate_(e,n,r,i){const s=super.interpolate_(e,n,r,i);return Gfe.fromArray(s).normalize().toArray(s),s}};const ka={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},om={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},KP={9728:zn,9729:Pn,9984:dy,9985:Td,9986:Zu,9987:Ts},ZP={33071:ei,33648:Bd,10497:Or},b4={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},g5={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...sC>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Fu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Vfe={CUBICSPLINE:void 0,LINEAR:pf,STEP:Gd},E4={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Wfe(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new Ka({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Cs})),t.DefaultMaterial}function id(t,e,n){for(const r in n.extensions)t[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function Nc(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function $fe(t,e,n){let r=!1,i=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const f=e[c];if(f.POSITION!==void 0&&(r=!0),f.NORMAL!==void 0&&(i=!0),f.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const f=e[c];if(r){const d=f.POSITION!==void 0?n.getDependency("accessor",f.POSITION):t.attributes.position;o.push(d)}if(i){const d=f.NORMAL!==void 0?n.getDependency("accessor",f.NORMAL):t.attributes.normal;a.push(d)}if(s){const d=f.COLOR_0!==void 0?n.getDependency("accessor",f.COLOR_0):t.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],f=c[1],d=c[2];return r&&(t.morphAttributes.position=u),i&&(t.morphAttributes.normal=f),s&&(t.morphAttributes.color=d),t.morphTargetsRelative=!0,t})}function Xfe(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let n=0,r=e.weights.length;n<r;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let r=0,i=n.length;r<i;r++)t.morphTargetDictionary[n[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function qfe(t){let e;const n=t.extensions&&t.extensions[lr.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+w4(n.attributes):e=t.indices+":"+w4(t.attributes)+":"+t.mode,t.targets!==void 0)for(let r=0,i=t.targets.length;r<i;r++)e+=":"+w4(t.targets[r]);return e}function w4(t){let e="";const n=Object.keys(t).sort();for(let r=0,i=n.length;r<i;r++)e+=n[r]+":"+t[n[r]]+";";return e}function y5(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Yfe(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Kfe=new et;let Zfe=class{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new xfe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||i&&s<98?this.textureLoader=new ns(this.options.manager):this.textureLoader=new z6(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new qr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(o){const a={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:r,userData:{}};return id(s,a,i),Nc(a,i),Promise.all(r._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=n.length;i<s;i++){const o=n[i].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(r[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,r){if(e.refs[n]<=1)return r;const i=r.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(r,i),i.name+="_instance_"+e.uses[n]++,i}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let r=0;r<n.length;r++){const i=e(n[r]);if(i)return i}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const r=[];for(let i=0;i<n.length;i++){const s=e(n[i]);s&&r.push(s)}return r}getDependency(e,n){const r=e+":"+n;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(n);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(n)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(n)});break;case"accessor":i=this.loadAccessor(n);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(n)});break;case"buffer":i=this.loadBuffer(n);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(n)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(n)});break;case"skin":i=this.loadSkin(n);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(n)});break;case"camera":i=this.loadCamera(n);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,n)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let n=this.cache.get(e);if(!n){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(i.map(function(s,o){return r.getDependency(e,o)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],r=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[lr.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){r.load(Ms.resolveURL(n.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(r){const i=n.byteLength||0,s=n.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const n=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=b4[i.type],a=om[i.componentType],l=i.normalized===!0,c=new a(i.count*o);return Promise.resolve(new fn(c,o,l))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=b4[i.type],c=om[i.componentType],u=c.BYTES_PER_ELEMENT,f=u*l,d=i.byteOffset||0,h=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,p=i.normalized===!0;let m,g;if(h&&h!==f){const y=Math.floor(d/h),x="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+y+":"+i.count;let _=n.cache.get(x);_||(m=new c(a,y*h,i.count*h/u),_=new Um(m,h/u),n.cache.add(x,_)),g=new Ao(_,l,d%h/u,p)}else a===null?m=new c(i.count*l):m=new c(a,d,i.count*l),g=new fn(m,l,p);if(i.sparse!==void 0){const y=b4.SCALAR,x=om[i.sparse.indices.componentType],_=i.sparse.indices.byteOffset||0,w=i.sparse.values.byteOffset||0,T=new x(o[1],_,i.sparse.count*y),S=new c(o[2],w,i.sparse.count*l);a!==null&&(g=new fn(g.array.slice(),g.itemSize,g.normalized));for(let C=0,A=T.length;C<A;C++){const R=T[C];if(g.setX(R,S[C*l]),l>=2&&g.setY(R,S[C*l+1]),l>=3&&g.setZ(R,S[C*l+2]),l>=4&&g.setW(R,S[C*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const n=this.json,r=this.options,s=n.textures[e].source,o=n.images[s];let a=this.textureLoader;if(o.uri){const l=r.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,n,r){const i=this,s=this.json,o=s.textures[e],a=s.images[n],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(n,r).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=KP[d.magFilter]||Pn,u.minFilter=KP[d.minFilter]||Ts,u.wrapS=ZP[d.wrapS]||Or,u.wrapT=ZP[d.wrapT]||Or,i.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,n){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=i.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=r.getDependency("bufferView",o.bufferView).then(function(f){c=!0;const d=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(f){return new Promise(function(d,h){let p=d;n.isImageBitmapLoader===!0&&(p=function(m){const g=new tr(m);g.needsUpdate=!0,d(g)}),n.load(Ms.resolveURL(f,s.path),p,void 0,h)})}).then(function(f){return c===!0&&a.revokeObjectURL(l),Nc(f,o),f.userData.mimeType=o.mimeType||Yfe(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=u,u}assignTexture(e,n,r,i){const s=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(o=o.clone(),o.channel=r.texCoord),s.extensions[lr.KHR_TEXTURE_TRANSFORM]){const a=r.extensions!==void 0?r.extensions[lr.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[lr.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return i!==void 0&&(typeof i=="number"&&(i=i===qP?Ed:Qc),"colorSpace"in o?o.colorSpace=i:o.encoding=i===Ed?qP:vfe),e[n]=o,o})}assignFinalMaterial(e){const n=e.geometry;let r=e.material;const i=n.attributes.tangent===void 0,s=n.attributes.color!==void 0,o=n.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new Ha,Wr.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,l.sizeAttenuation=!1,this.cache.add(a,l)),r=l}else if(e.isLine){const a="LineBasicMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new oi,Wr.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,this.cache.add(a,l)),r=l}if(i||s||o){let a="ClonedMaterial:"+r.uuid+":";i&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=r.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(r))),r=l}e.material=r}getMaterialType(){return Ka}loadMaterial(e){const n=this,r=this.json,i=this.extensions,s=r.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[lr.KHR_MATERIALS_UNLIT]){const f=i[lr.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),c.push(f.extendParams(a,s,n))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new wt(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const d=f.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],Qc),a.opacity=d[3]}f.baseColorTexture!==void 0&&c.push(n.assignTexture(a,"map",f.baseColorTexture,Ed)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(c.push(n.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),c.push(n.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Nr);const u=s.alphaMode||E4.OPAQUE;if(u===E4.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===E4.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Fr&&(c.push(n.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ke(1,1),s.normalTexture.scale!==void 0)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}if(s.occlusionTexture!==void 0&&o!==Fr&&(c.push(n.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Fr){const f=s.emissiveFactor;a.emissive=new wt().setRGB(f[0],f[1],f[2],Qc)}return s.emissiveTexture!==void 0&&o!==Fr&&c.push(n.assignTexture(a,"emissiveMap",s.emissiveTexture,Ed)),Promise.all(c).then(function(){const f=new o(a);return s.name&&(f.name=s.name),Nc(f,s),n.associations.set(f,{materials:e}),s.extensions&&id(i,f,s),f})}createUniqueName(e){const n=dr.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,r=this.extensions,i=this.primitiveCache;function s(a){return r[lr.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,n).then(function(l){return QP(l,a,n)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=qfe(c),f=i[u];if(f)o.push(f.promise);else{let d;c.extensions&&c.extensions[lr.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=QP(new gn,c,n),i[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const n=this,r=this.json,i=this.extensions,s=r.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=o[l].material===void 0?Wfe(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(n.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],f=[];for(let h=0,p=u.length;h<p;h++){const m=u[h],g=o[h];let y;const x=c[h];if(g.mode===ka.TRIANGLES||g.mode===ka.TRIANGLE_STRIP||g.mode===ka.TRIANGLE_FAN||g.mode===void 0)y=s.isSkinnedMesh===!0?new Qd(m,x):new ln(m,x),y.isSkinnedMesh===!0&&y.normalizeSkinWeights(),g.mode===ka.TRIANGLE_STRIP?y.geometry=jP(y.geometry,py):g.mode===ka.TRIANGLE_FAN&&(y.geometry=jP(y.geometry,jd));else if(g.mode===ka.LINES)y=new so(m,x);else if(g.mode===ka.LINE_STRIP)y=new $o(m,x);else if(g.mode===ka.LINE_LOOP)y=new Cb(m,x);else if(g.mode===ka.POINTS)y=new Zc(m,x);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(y.geometry.morphAttributes).length>0&&Xfe(y,s),y.name=n.createUniqueName(s.name||"mesh_"+e),Nc(y,s),g.extensions&&id(i,y,g),n.assignFinalMaterial(y),f.push(y)}for(let h=0,p=f.length;h<p;h++)n.associations.set(f[h],{meshes:e,primitives:h});if(f.length===1)return s.extensions&&id(i,f[0],s),f[0];const d=new es;s.extensions&&id(i,d,s),n.associations.set(d,{meshes:e});for(let h=0,p=f.length;h<p;h++)d.add(f[h]);return d})}loadCamera(e){let n;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?n=new Ar(ri.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(n=new Hi(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(n.name=this.createUniqueName(r.name)),Nc(n,r),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],r=[];for(let i=0,s=n.joints.length;i<s;i++)r.push(this._loadNodeShallow(n.joints[i]));return n.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",n.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),o=i,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const f=o[c];if(f){a.push(f);const d=new et;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[c])}return new wf(a,l)})}loadAnimation(e){const n=this.json,r=this,i=n.animations[e],s=i.name?i.name:"animation_"+e,o=[],a=[],l=[],c=[],u=[];for(let f=0,d=i.channels.length;f<d;f++){const h=i.channels[f],p=i.samplers[h.sampler],m=h.target,g=m.node,y=i.parameters!==void 0?i.parameters[p.input]:p.input,x=i.parameters!==void 0?i.parameters[p.output]:p.output;m.node!==void 0&&(o.push(this.getDependency("node",g)),a.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",x)),c.push(p),u.push(m))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(f){const d=f[0],h=f[1],p=f[2],m=f[3],g=f[4],y=[];for(let x=0,_=d.length;x<_;x++){const w=d[x],T=h[x],S=p[x],C=m[x],A=g[x];if(w===void 0)continue;w.updateMatrix&&w.updateMatrix();const R=r._createAnimationTracks(w,T,S,C,A);if(R)for(let M=0;M<R.length;M++)y.push(R[M])}return new Qa(s,void 0,y)})}createNodeMesh(e){const n=this.json,r=this,i=n.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const o=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=i.weights.length;l<c;l++)a.morphTargetInfluences[l]=i.weights[l]}),o})}loadNode(e){const n=this.json,r=this,i=n.nodes[e],s=r._loadNodeShallow(e),o=[],a=i.children||[];for(let c=0,u=a.length;c<u;c++)o.push(r.getDependency("node",a[c]));const l=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],f=c[1],d=c[2];d!==null&&u.traverse(function(h){h.isSkinnedMesh&&h.bind(d,Kfe)});for(let h=0,p=f.length;h<p;h++)u.add(f[h]);return u})}_loadNodeShallow(e){const n=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=n.nodes[e],o=s.name?i.createUniqueName(s.name):"",a=[],l=i._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(i.getDependency("camera",s.camera).then(function(c){return i._getNodeRef(i.cameraCache,s.camera,c)})),i._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(s.isBone===!0?u=new Jd:c.length>1?u=new es:c.length===1?u=c[0]:u=new yn,u!==c[0])for(let f=0,d=c.length;f<d;f++)u.add(c[f]);if(s.name&&(u.userData.name=s.name,u.name=o),Nc(u,s),s.extensions&&id(r,u,s),s.matrix!==void 0){const f=new et;f.fromArray(s.matrix),u.applyMatrix4(f)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return i.associations.has(u)||i.associations.set(u,{}),i.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const n=this.extensions,r=this.json.scenes[e],i=this,s=new es;r.name&&(s.name=i.createUniqueName(r.name)),Nc(s,r),r.extensions&&id(n,s,r);const o=r.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(i.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,f=l.length;u<f;u++)s.add(l[u]);const c=u=>{const f=new Map;for(const[d,h]of i.associations)(d instanceof Wr||d instanceof tr)&&f.set(d,h);return u.traverse(d=>{const h=i.associations.get(d);h!=null&&f.set(d,h)}),f};return i.associations=c(s),s})}_createAnimationTracks(e,n,r,i,s){const o=[],a=e.name?e.name:e.uuid,l=[];Fu[s.path]===Fu.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let c;switch(Fu[s.path]){case Fu.weights:c=ru;break;case Fu.rotation:c=Za;break;case Fu.position:case Fu.scale:c=Xo;break;default:switch(r.itemSize){case 1:c=ru;break;case 2:case 3:default:c=Xo;break}break}const u=i.interpolation!==void 0?Vfe[i.interpolation]:pf,f=this._getArrayFromAccessor(r);for(let d=0,h=l.length;d<h;d++){const p=new c(l[d]+"."+Fu[s.path],n.array,f,u);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const r=y5(n.constructor),i=new Float32Array(n.length);for(let s=0,o=n.length;s<o;s++)i[s]=n[s]*r;n=i}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof Za?jfe:MG;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function Qfe(t,e,n){const r=e.attributes,i=new Kn;if(r.POSITION!==void 0){const a=n.json.accessors[r.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(i.set(new $(l[0],l[1],l[2]),new $(c[0],c[1],c[2])),a.normalized){const u=y5(om[a.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new $,l=new $;for(let c=0,u=s.length;c<u;c++){const f=s[c];if(f.POSITION!==void 0){const d=n.json.accessors[f.POSITION],h=d.min,p=d.max;if(h!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(h[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(h[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(h[2]),Math.abs(p[2]))),d.normalized){const m=y5(om[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}t.boundingBox=i;const o=new wr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=o}function QP(t,e,n){const r=e.attributes,i=[];function s(o,a){return n.getDependency("accessor",o).then(function(l){t.setAttribute(a,l)})}for(const o in r){const a=g5[o]||o.toLowerCase();a in t.attributes||i.push(s(r[o],a))}if(e.indices!==void 0&&!t.index){const o=n.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});i.push(o)}return Nc(t,e),Qfe(t,e,n),Promise.all(i).then(function(){return e.targets!==void 0?$fe(t,e.targets,n):t})}class Jfe extends gn{constructor(e,n,r,i){super();const s=[],o=[],a=[],l=new $,c=new et;c.makeRotationFromEuler(r),c.setPosition(n);const u=new et;u.copy(c).invert(),f(),this.setAttribute("position",new Dt(s,3)),this.setAttribute("normal",new Dt(o,3)),this.setAttribute("uv",new Dt(a,2));function f(){let m,g=[];const y=new $,x=new $;if(e.geometry.isGeometry===!0){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}const _=e.geometry,w=_.attributes.position,T=_.attributes.normal;if(_.index!==null){const S=_.index;for(m=0;m<S.count;m++)y.fromBufferAttribute(w,S.getX(m)),x.fromBufferAttribute(T,S.getX(m)),d(g,y,x)}else for(m=0;m<w.count;m++)y.fromBufferAttribute(w,m),x.fromBufferAttribute(T,m),d(g,y,x);for(g=h(g,l.set(1,0,0)),g=h(g,l.set(-1,0,0)),g=h(g,l.set(0,1,0)),g=h(g,l.set(0,-1,0)),g=h(g,l.set(0,0,1)),g=h(g,l.set(0,0,-1)),m=0;m<g.length;m++){const S=g[m];a.push(.5+S.position.x/i.x,.5+S.position.y/i.y),S.position.applyMatrix4(c),s.push(S.position.x,S.position.y,S.position.z),o.push(S.normal.x,S.normal.y,S.normal.z)}}function d(m,g,y){g.applyMatrix4(e.matrixWorld),g.applyMatrix4(u),y.transformDirection(e.matrixWorld),m.push(new JP(g.clone(),y.clone()))}function h(m,g){const y=[],x=.5*Math.abs(i.dot(g));for(let _=0;_<m.length;_+=3){let w,T,S,C=0,A,R,M,D;const k=m[_+0].position.dot(g)-x,L=m[_+1].position.dot(g)-x,N=m[_+2].position.dot(g)-x;switch(w=k>0,T=L>0,S=N>0,C=(w?1:0)+(T?1:0)+(S?1:0),C){case 0:{y.push(m[_]),y.push(m[_+1]),y.push(m[_+2]);break}case 1:{if(w&&(A=m[_+1],R=m[_+2],M=p(m[_],A,g,x),D=p(m[_],R,g,x)),T){A=m[_],R=m[_+2],M=p(m[_+1],A,g,x),D=p(m[_+1],R,g,x),y.push(M),y.push(R.clone()),y.push(A.clone()),y.push(R.clone()),y.push(M.clone()),y.push(D);break}S&&(A=m[_],R=m[_+1],M=p(m[_+2],A,g,x),D=p(m[_+2],R,g,x)),y.push(A.clone()),y.push(R.clone()),y.push(M),y.push(D),y.push(M.clone()),y.push(R.clone());break}case 2:{w||(A=m[_].clone(),R=p(A,m[_+1],g,x),M=p(A,m[_+2],g,x),y.push(A),y.push(R),y.push(M)),T||(A=m[_+1].clone(),R=p(A,m[_+2],g,x),M=p(A,m[_],g,x),y.push(A),y.push(R),y.push(M)),S||(A=m[_+2].clone(),R=p(A,m[_],g,x),M=p(A,m[_+1],g,x),y.push(A),y.push(R),y.push(M));break}}}return y}function p(m,g,y,x){const _=m.position.dot(y)-x,w=g.position.dot(y)-x,T=_/(_-w);return new JP(new $(m.position.x+T*(g.position.x-m.position.x),m.position.y+T*(g.position.y-m.position.y),m.position.z+T*(g.position.z-m.position.z)),new $(m.normal.x+T*(g.normal.x-m.normal.x),m.normal.y+T*(g.normal.y-m.normal.y),m.normal.z+T*(g.normal.z-m.normal.z)))}}}class JP{constructor(e,n){this.position=e,this.normal=n}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}class ede extends vy{constructor(e,n={}){const{bevelEnabled:r=!1,bevelSize:i=8,bevelThickness:s=10,font:o,height:a=50,size:l=100,lineHeight:c=1,letterSpacing:u=0,...f}=n;if(o===void 0)super();else{const d=o.generateShapes(e,l,{lineHeight:c,letterSpacing:u});super(d,{...f,bevelEnabled:r,bevelSize:i,bevelThickness:s,depth:a})}this.type="TextGeometry"}}const tde={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","	vec4 tex = texture2D( tDiffuse, vUv );","	#ifdef LinearTosRGB","		gl_FragColor = LinearTosRGB( tex );","	#else","		gl_FragColor = sRGBTransferOETF( tex );","	#endif","}"].join(`
`)},nde={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},rde={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `},S4=new th,T4=new $,Jh=new $,dl=new $,Tc=new $,Ol=new $,Ac=new $,Mc=new $,Y0=new $,K0=new $,Z0=new $,H2=new $,Q0=new $,J0=new $,eg=new $;class ide{constructor(e,n,r){this.camera=e,this.scene=n,this.startPoint=new $,this.endPoint=new $,this.collection=[],this.deep=r||Number.MAX_VALUE}select(e,n){return this.startPoint=e||this.startPoint,this.endPoint=n||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(S4,this.scene),this.collection}updateFrustum(e,n){if(e=e||this.startPoint,n=n||this.endPoint,e.x===n.x&&(n.x+=Number.EPSILON),e.y===n.y&&(n.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){Jh.copy(e),Jh.x=Math.min(e.x,n.x),Jh.y=Math.max(e.y,n.y),n.x=Math.max(e.x,n.x),n.y=Math.min(e.y,n.y),dl.setFromMatrixPosition(this.camera.matrixWorld),Tc.copy(Jh),Ol.set(n.x,Jh.y,0),Ac.copy(n),Mc.set(Jh.x,n.y,0),Tc.unproject(this.camera),Ol.unproject(this.camera),Ac.unproject(this.camera),Mc.unproject(this.camera),Q0.copy(Tc).sub(dl),J0.copy(Ol).sub(dl),eg.copy(Ac).sub(dl),Q0.normalize(),J0.normalize(),eg.normalize(),Q0.multiplyScalar(this.deep),J0.multiplyScalar(this.deep),eg.multiplyScalar(this.deep),Q0.add(dl),J0.add(dl),eg.add(dl);var r=S4.planes;r[0].setFromCoplanarPoints(dl,Tc,Ol),r[1].setFromCoplanarPoints(dl,Ol,Ac),r[2].setFromCoplanarPoints(Ac,Mc,dl),r[3].setFromCoplanarPoints(Mc,Tc,dl),r[4].setFromCoplanarPoints(Ol,Ac,Mc),r[5].setFromCoplanarPoints(eg,J0,Q0),r[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const i=Math.min(e.x,n.x),s=Math.max(e.y,n.y),o=Math.max(e.x,n.x),a=Math.min(e.y,n.y);Tc.set(i,s,-1),Ol.set(o,s,-1),Ac.set(o,a,-1),Mc.set(i,a,-1),Y0.set(i,s,1),K0.set(o,s,1),Z0.set(o,a,1),H2.set(i,a,1),Tc.unproject(this.camera),Ol.unproject(this.camera),Ac.unproject(this.camera),Mc.unproject(this.camera),Y0.unproject(this.camera),K0.unproject(this.camera),Z0.unproject(this.camera),H2.unproject(this.camera);var r=S4.planes;r[0].setFromCoplanarPoints(Tc,Y0,K0),r[1].setFromCoplanarPoints(Ol,K0,Z0),r[2].setFromCoplanarPoints(Z0,H2,Mc),r[3].setFromCoplanarPoints(H2,Y0,Tc),r[4].setFromCoplanarPoints(Ol,Ac,Mc),r[5].setFromCoplanarPoints(Z0,K0,Y0),r[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,n){if((n.isMesh||n.isLine||n.isPoints)&&n.material!==void 0&&(n.geometry.boundingSphere===null&&n.geometry.computeBoundingSphere(),T4.copy(n.geometry.boundingSphere.center),T4.applyMatrix4(n.matrixWorld),e.containsPoint(T4)&&this.collection.push(n)),n.children.length>0)for(let r=0;r<n.children.length;r++)this.searchChildInFrustum(e,n.children[r])}}class sde{constructor(e,n=" .:-=+*#%@",r={}){const i=r.resolution||.15,s=r.scale||1,o=r.color||!1,a=r.alpha||!1,l=r.block||!1,c=r.invert||!1,u=r.strResolution||"low";let f,d;const h=document.createElement("div");h.style.cursor="default";const p=document.createElement("table");h.appendChild(p);let m,g,y;this.setSize=function(N,z){f=N,d=z,e.setSize(N,z),x()},this.render=function(N,z){e.render(N,z),L(p)},this.domElement=h;function x(){m=Math.floor(f*i),g=Math.floor(d*i),C.width=m,C.height=g,y=e.domElement,y.style.backgroundColor&&(p.rows[0].cells[0].style.backgroundColor=y.style.backgroundColor,p.rows[0].cells[0].style.color=y.style.color),p.cellSpacing=0,p.cellPadding=0;const N=p.style;N.whiteSpace="pre",N.margin="0px",N.padding="0px",N.letterSpacing=k+"px",N.fontFamily=T,N.fontSize=M+"px",N.lineHeight=D+"px",N.textAlign="left",N.textDecoration="none"}const _=" .,:;i1tfLCG08@".split(""),w=" CGO08@".split(""),T="courier new, monospace",S=e.domElement,C=document.createElement("canvas");if(!C.getContext)return;const A=C.getContext("2d");if(!A.getImageData)return;let R=o?w:_;n&&(R=n);const M=2/i*s,D=2/i*s;let k=0;if(u=="low")switch(s){case 1:k=-1;break;case 2:case 3:k=-2.1;break;case 4:k=-3.1;break;case 5:k=-4.15;break}if(u=="medium")switch(s){case 1:k=0;break;case 2:k=-1;break;case 3:k=-1.04;break;case 4:case 5:k=-2.1;break}if(u=="high")switch(s){case 1:case 2:k=0;break;case 3:case 4:case 5:k=-1;break}function L(N){A.clearRect(0,0,m,g),A.drawImage(S,0,0,m,g);const z=A.getImageData(0,0,m,g).data;let O="";for(let K=0;K<g;K+=2){for(let V=0;V<m;V++){const ne=(K*m+V)*4,re=z[ne],P=z[ne+1],se=z[ne+2],ue=z[ne+3];let te,W;W=(.3*re+.59*P+.11*se)/255,ue==0&&(W=1),te=Math.floor((1-W)*(R.length-1)),c&&(te=R.length-te-1);let X=R[te];(X===void 0||X==" ")&&(X="&nbsp;"),o?O+="<span style='color:rgb("+re+","+P+","+se+");"+(l?"background-color:rgb("+re+","+P+","+se+");":"")+(a?"opacity:"+ue/255+";":"")+"'>"+X+"</span>":O+=X}O+="<br/>"}N.innerHTML=`<tr><td style="display:block;width:${f}px;height:${d}px;overflow:hidden">${O}</td></tr>`}}}var ode=Object.defineProperty,ade=(t,e,n)=>e in t?ode(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lC=(t,e,n)=>(ade(t,typeof e!="symbol"?e+"":e,n),n);class lde extends Br{constructor(e){super(e)}load(e,n,r,i){const s=new qr(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{if(typeof o!="string")throw new Error("unsupported data type");const a=JSON.parse(o),l=this.parse(a);n&&n(l)},r,i)}loadAsync(e,n){return super.loadAsync(e,n)}parse(e){return new cC(e)}}class cC{constructor(e){lC(this,"data"),this.data=e}generateShapes(e,n=100,r){const i=[],s={letterSpacing:0,lineHeight:1,...r},o=cde(e,n,this.data,s);for(let a=0,l=o.length;a<l;a++)Array.prototype.push.apply(i,o[a].toShapes(!1));return i}}lC(cC,"isFont");lC(cC,"type");function cde(t,e,n,r){const i=Array.from(t),s=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*s,a=[];let l=0,c=0;for(let u=0;u<i.length;u++){const f=i[u];if(f===`
`)l=0,c-=o*r.lineHeight;else{const d=ude(f,s,l,c,n);d&&(l+=d.offsetX+r.letterSpacing,a.push(d.path))}}return a}function ude(t,e,n,r,i){const s=i.glyphs[t]||i.glyphs["?"];if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".");return}const o=new Dc;let a,l,c,u,f,d,h,p;if(s.o){const m=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let g=0,y=m.length;g<y;)switch(m[g++]){case"m":a=parseInt(m[g++])*e+n,l=parseInt(m[g++])*e+r,o.moveTo(a,l);break;case"l":a=parseInt(m[g++])*e+n,l=parseInt(m[g++])*e+r,o.lineTo(a,l);break;case"q":c=parseInt(m[g++])*e+n,u=parseInt(m[g++])*e+r,f=parseInt(m[g++])*e+n,d=parseInt(m[g++])*e+r,o.quadraticCurveTo(f,d,c,u);break;case"b":c=parseInt(m[g++])*e+n,u=parseInt(m[g++])*e+r,f=parseInt(m[g++])*e+n,d=parseInt(m[g++])*e+r,h=parseInt(m[g++])*e+n,p=parseInt(m[g++])*e+r,o.bezierCurveTo(f,d,h,p,c,u);break}}return{offsetX:s.ha*e,path:o}}class ek extends Ey{constructor(e){super(e)}parse(e){function n(O){switch(O.image_type){case d:case m:(O.colormap_length>256||O.colormap_size!==24||O.colormap_type!==1)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case h:case p:case g:case y:O.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case f:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',O.image_type)}(O.width<=0||O.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),O.pixel_size!==8&&O.pixel_size!==16&&O.pixel_size!==24&&O.pixel_size!==32&&console.error('THREE.TGALoader: Invalid pixel size "%s".',O.pixel_size)}function r(O,K,V,ne,re){let P,se;const ue=V.pixel_size>>3,te=V.width*V.height*ue;if(K&&(se=re.subarray(ne,ne+=V.colormap_length*(V.colormap_size>>3))),O){P=new Uint8Array(te);let W,X,J,oe=0;const Ee=new Uint8Array(ue);for(;oe<te;)if(W=re[ne++],X=(W&127)+1,W&128){for(J=0;J<ue;++J)Ee[J]=re[ne++];for(J=0;J<X;++J)P.set(Ee,oe+J*ue);oe+=ue*X}else{for(X*=ue,J=0;J<X;++J)P[oe+J]=re[ne++];oe+=X}}else P=re.subarray(ne,ne+=K?V.width*V.height:te);return{pixel_data:P,palettes:se}}function i(O,K,V,ne,re,P,se,ue,te){const W=te;let X,J=0,oe,Ee;const me=M.width;for(Ee=K;Ee!==ne;Ee+=V)for(oe=re;oe!==se;oe+=P,J++)X=ue[J],O[(oe+me*Ee)*4+3]=255,O[(oe+me*Ee)*4+2]=W[X*3+0],O[(oe+me*Ee)*4+1]=W[X*3+1],O[(oe+me*Ee)*4+0]=W[X*3+2];return O}function s(O,K,V,ne,re,P,se,ue){let te,W=0,X,J;const oe=M.width;for(J=K;J!==ne;J+=V)for(X=re;X!==se;X+=P,W+=2)te=ue[W+0]+(ue[W+1]<<8),O[(X+oe*J)*4+0]=(te&31744)>>7,O[(X+oe*J)*4+1]=(te&992)>>2,O[(X+oe*J)*4+2]=(te&31)>>3,O[(X+oe*J)*4+3]=te&32768?0:255;return O}function o(O,K,V,ne,re,P,se,ue){let te=0,W,X;const J=M.width;for(X=K;X!==ne;X+=V)for(W=re;W!==se;W+=P,te+=3)O[(W+J*X)*4+3]=255,O[(W+J*X)*4+2]=ue[te+0],O[(W+J*X)*4+1]=ue[te+1],O[(W+J*X)*4+0]=ue[te+2];return O}function a(O,K,V,ne,re,P,se,ue){let te=0,W,X;const J=M.width;for(X=K;X!==ne;X+=V)for(W=re;W!==se;W+=P,te+=4)O[(W+J*X)*4+2]=ue[te+0],O[(W+J*X)*4+1]=ue[te+1],O[(W+J*X)*4+0]=ue[te+2],O[(W+J*X)*4+3]=ue[te+3];return O}function l(O,K,V,ne,re,P,se,ue){let te,W=0,X,J;const oe=M.width;for(J=K;J!==ne;J+=V)for(X=re;X!==se;X+=P,W++)te=ue[W],O[(X+oe*J)*4+0]=te,O[(X+oe*J)*4+1]=te,O[(X+oe*J)*4+2]=te,O[(X+oe*J)*4+3]=255;return O}function c(O,K,V,ne,re,P,se,ue){let te=0,W,X;const J=M.width;for(X=K;X!==ne;X+=V)for(W=re;W!==se;W+=P,te+=2)O[(W+J*X)*4+0]=ue[te+0],O[(W+J*X)*4+1]=ue[te+0],O[(W+J*X)*4+2]=ue[te+0],O[(W+J*X)*4+3]=ue[te+1];return O}function u(O,K,V,ne,re){let P,se,ue,te,W,X;switch((M.flags&x)>>_){default:case S:P=0,ue=1,W=K,se=0,te=1,X=V;break;case w:P=0,ue=1,W=K,se=V-1,te=-1,X=-1;break;case C:P=K-1,ue=-1,W=-1,se=0,te=1,X=V;break;case T:P=K-1,ue=-1,W=-1,se=V-1,te=-1,X=-1;break}if(L)switch(M.pixel_size){case 8:l(O,se,te,X,P,ue,W,ne);break;case 16:c(O,se,te,X,P,ue,W,ne);break;default:console.error("THREE.TGALoader: Format not supported.");break}else switch(M.pixel_size){case 8:i(O,se,te,X,P,ue,W,ne,re);break;case 16:s(O,se,te,X,P,ue,W,ne);break;case 24:o(O,se,te,X,P,ue,W,ne);break;case 32:a(O,se,te,X,P,ue,W,ne);break;default:console.error("THREE.TGALoader: Format not supported.");break}return O}const f=0,d=1,h=2,p=3,m=9,g=10,y=11,x=48,_=4,w=0,T=1,S=2,C=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let A=0;const R=new Uint8Array(e),M={id_length:R[A++],colormap_type:R[A++],image_type:R[A++],colormap_index:R[A++]|R[A++]<<8,colormap_length:R[A++]|R[A++]<<8,colormap_size:R[A++],origin:[R[A++]|R[A++]<<8,R[A++]|R[A++]<<8],width:R[A++]|R[A++]<<8,height:R[A++]|R[A++]<<8,pixel_size:R[A++],flags:R[A++]};n(M),M.id_length+A>e.length&&console.error("THREE.TGALoader: No data."),A+=M.id_length;let D=!1,k=!1,L=!1;switch(M.image_type){case m:D=!0,k=!0;break;case d:k=!0;break;case g:D=!0;break;case h:break;case y:D=!0,L=!0;break;case p:L=!0;break}const N=new Uint8Array(M.width*M.height*4),z=r(D,k,M,A,R);return u(N,M.width,M.height,z.pixel_data,z.palettes),{data:N,width:M.width,height:M.height,flipY:!0,generateMipmaps:!0,minFilter:Ts}}}class CG extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=new qr(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(a))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){function n(c){const u=new DataView(c),f=32/8*3+32/8*3*3+16/8,d=u.getUint32(80,!0);if(80+32/8+d*f===u.byteLength)return!0;const p=[115,111,108,105,100];for(let m=0;m<5;m++)if(r(p,u,m))return!1;return!0}function r(c,u,f){for(let d=0,h=c.length;d<h;d++)if(c[d]!==u.getUint8(f+d,!1))return!1;return!0}function i(c){const u=new DataView(c),f=u.getUint32(80,!0);let d,h,p,m=!1,g,y,x,_,w;for(let M=0;M<70;M++)u.getUint32(M,!1)==1129270351&&u.getUint8(M+4)==82&&u.getUint8(M+5)==61&&(m=!0,g=new Float32Array(f*3*3),y=u.getUint8(M+6)/255,x=u.getUint8(M+7)/255,_=u.getUint8(M+8)/255,w=u.getUint8(M+9)/255);const T=84,S=12*4+2,C=new gn,A=new Float32Array(f*3*3),R=new Float32Array(f*3*3);for(let M=0;M<f;M++){const D=T+M*S,k=u.getFloat32(D,!0),L=u.getFloat32(D+4,!0),N=u.getFloat32(D+8,!0);if(m){const z=u.getUint16(D+48,!0);z&32768?(d=y,h=x,p=_):(d=(z&31)/31,h=(z>>5&31)/31,p=(z>>10&31)/31)}for(let z=1;z<=3;z++){const O=D+z*12,K=M*3*3+(z-1)*3;A[K]=u.getFloat32(O,!0),A[K+1]=u.getFloat32(O+4,!0),A[K+2]=u.getFloat32(O+8,!0),R[K]=k,R[K+1]=L,R[K+2]=N,m&&(g[K]=d,g[K+1]=h,g[K+2]=p)}}return C.setAttribute("position",new fn(A,3)),C.setAttribute("normal",new fn(R,3)),m&&(C.setAttribute("color",new fn(g,3)),C.hasColors=!0,C.alpha=w),C}function s(c){const u=new gn,f=/solid([\s\S]*?)endsolid/g,d=/facet([\s\S]*?)endfacet/g;let h=0;const p=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,m=new RegExp("vertex"+p+p+p,"g"),g=new RegExp("normal"+p+p+p,"g"),y=[],x=[],_=new $;let w,T=0,S=0,C=0;for(;(w=f.exec(c))!==null;){S=C;const A=w[0];for(;(w=d.exec(A))!==null;){let D=0,k=0;const L=w[0];for(;(w=g.exec(L))!==null;)_.x=parseFloat(w[1]),_.y=parseFloat(w[2]),_.z=parseFloat(w[3]),k++;for(;(w=m.exec(L))!==null;)y.push(parseFloat(w[1]),parseFloat(w[2]),parseFloat(w[3])),x.push(_.x,_.y,_.z),D++,C++;k!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+h),D!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+h),h++}const R=S,M=C-S;u.addGroup(R,M,T),T++}return u.setAttribute("position",new Dt(y,3)),u.setAttribute("normal",new Dt(x,3)),u}function o(c){return typeof c!="string"?$d(new Uint8Array(c)):c}function a(c){if(typeof c=="string"){const u=new Uint8Array(c.length);for(let f=0;f<c.length;f++)u[f]=c.charCodeAt(f)&255;return u.buffer||u}else return c}const l=a(e);return n(l)?i(l):s(o(e))}}class fde extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=this.path===""?Ms.extractUrlBase(e):this.path,a=new qr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{n(s.parse(l,o))}catch(c){i?i(c):console.error(c),s.manager.itemError(e)}},r,i)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,n){const r=e.split(`
`);let i={};const s=/\s+/,o={};for(let l=0;l<r.length;l++){let c=r[l];if(c=c.trim(),c.length===0||c.charAt(0)==="#")continue;const u=c.indexOf(" ");let f=u>=0?c.substring(0,u):c;f=f.toLowerCase();let d=u>=0?c.substring(u+1):"";if(d=d.trim(),f==="newmtl")i={name:d},o[d]=i;else if(f==="ka"||f==="kd"||f==="ks"||f==="ke"){const h=d.split(s,3);i[f]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else i[f]=d}const a=new dde(this.resourcePath||n,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(o),a}}class dde{constructor(e="",n={}){this.baseUrl=e,this.options=n,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:Cs,this.wrap=this.options.wrap!==void 0?this.options.wrap:Or}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const n={};for(const r in e){const i=e[r],s={};n[r]=s;for(const o in i){let a=!0,l=i[o];const c=o.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(l=[l[0]/255,l[1]/255,l[2]/255]),this.options&&this.options.ignoreZeroRGBs&&l[0]===0&&l[1]===0&&l[2]===0&&(a=!1);break}a&&(s[c]=l)}}return n}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const n in this.materialsInfo)this.materialsArray[e]=this.create(n),this.nameLookup[n]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const n=this,r=this.materialsInfo[e],i={name:e,side:this.side};function s(a,l){return typeof l!="string"||l===""?"":/^https?:\/\//i.test(l)?l:a+l}function o(a,l){if(i[a])return;const c=n.getTextureParams(l,i),u=n.loadTexture(s(n.baseUrl,c.url));u.repeat.copy(c.scale),u.offset.copy(c.offset),u.wrapS=n.wrap,u.wrapT=n.wrap,i[a]=u}for(const a in r){const l=r[a];let c;if(l!=="")switch(a.toLowerCase()){case"kd":i.color=new wt().fromArray(l);break;case"ks":i.specular=new wt().fromArray(l);break;case"ke":i.emissive=new wt().fromArray(l);break;case"map_kd":o("map",l);break;case"map_ks":o("specularMap",l);break;case"map_ke":o("emissiveMap",l);break;case"norm":o("normalMap",l);break;case"map_bump":case"bump":o("bumpMap",l);break;case"map_d":o("alphaMap",l),i.transparent=!0;break;case"ns":i.shininess=parseFloat(l);break;case"d":c=parseFloat(l),c<1&&(i.opacity=c,i.transparent=!0);break;case"tr":c=parseFloat(l),this.options&&this.options.invertTrProperty&&(c=1-c),c>0&&(i.opacity=1-c,i.transparent=!0);break}}return this.materials[e]=new nu(i),this.materials[e]}getTextureParams(e,n){const r={scale:new Ke(1,1),offset:new Ke(0,0)},i=e.split(/\s+/);let s;return s=i.indexOf("-bm"),s>=0&&(n.bumpScale=parseFloat(i[s+1]),i.splice(s,2)),s=i.indexOf("-s"),s>=0&&(r.scale.set(parseFloat(i[s+1]),parseFloat(i[s+2])),i.splice(s,4)),s=i.indexOf("-o"),s>=0&&(r.offset.set(parseFloat(i[s+1]),parseFloat(i[s+2])),i.splice(s,4)),r.url=i.join(" ").trim(),r}loadTexture(e,n,r,i,s){const o=this.manager!==void 0?this.manager:Vb;let a=o.getHandler(e);a===null&&(a=new ns(o)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);const l=a.load(e,r,i,s);return n!==void 0&&(l.mapping=n),l}}class RG extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=s.path===""?Ms.extractUrlBase(e):s.path,a=new qr(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{n(s.parse(l,o))}catch(c){i?i(c):console.error(c),s.manager.itemError(e)}},r,i)}parse(e,n){function r(he,U){const j=[],Q=he.childNodes;for(let Y=0,ce=Q.length;Y<ce;Y++){const Fe=Q[Y];Fe.nodeName===U&&j.push(Fe)}return j}function i(he){if(he.length===0)return[];const U=he.trim().split(/\s+/),j=new Array(U.length);for(let Q=0,Y=U.length;Q<Y;Q++)j[Q]=U[Q];return j}function s(he){if(he.length===0)return[];const U=he.trim().split(/\s+/),j=new Array(U.length);for(let Q=0,Y=U.length;Q<Y;Q++)j[Q]=parseFloat(U[Q]);return j}function o(he){if(he.length===0)return[];const U=he.trim().split(/\s+/),j=new Array(U.length);for(let Q=0,Y=U.length;Q<Y;Q++)j[Q]=parseInt(U[Q]);return j}function a(he){return he.substring(1)}function l(){return"three_default_"+Si++}function c(he){return Object.keys(he).length===0}function u(he){return{unit:f(r(he,"unit")[0]),upAxis:d(r(he,"up_axis")[0])}}function f(he){return he!==void 0&&he.hasAttribute("meter")===!0?parseFloat(he.getAttribute("meter")):1}function d(he){return he!==void 0?he.textContent:"Y_UP"}function h(he,U,j,Q){const Y=r(he,U)[0];if(Y!==void 0){const ce=r(Y,j);for(let Fe=0;Fe<ce.length;Fe++)Q(ce[Fe])}}function p(he,U){for(const j in he){const Q=he[j];Q.build=U(he[j])}}function m(he,U){return he.build!==void 0||(he.build=U(he)),he.build}function g(he){const U={sources:{},samplers:{},channels:{}};let j=!1;for(let Q=0,Y=he.childNodes.length;Q<Y;Q++){const ce=he.childNodes[Q];if(ce.nodeType!==1)continue;let Fe;switch(ce.nodeName){case"source":Fe=ce.getAttribute("id"),U.sources[Fe]=Qe(ce);break;case"sampler":Fe=ce.getAttribute("id"),U.samplers[Fe]=y(ce);break;case"channel":Fe=ce.getAttribute("target"),U.channels[Fe]=x(ce);break;case"animation":g(ce),j=!0;break;default:console.log(ce)}}j===!1&&(_n.animations[he.getAttribute("id")||ri.generateUUID()]=U)}function y(he){const U={inputs:{}};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"input":const ce=a(Y.getAttribute("source")),Fe=Y.getAttribute("semantic");U.inputs[Fe]=ce;break}}return U}function x(he){const U={};let Q=he.getAttribute("target").split("/");const Y=Q.shift();let ce=Q.shift();const Fe=ce.indexOf("(")!==-1,je=ce.indexOf(".")!==-1;if(je)Q=ce.split("."),ce=Q.shift(),U.member=Q.shift();else if(Fe){const gt=ce.split("(");ce=gt.shift();for(let lt=0;lt<gt.length;lt++)gt[lt]=parseInt(gt[lt].replace(/\)/,""));U.indices=gt}return U.id=Y,U.sid=ce,U.arraySyntax=Fe,U.memberSyntax=je,U.sampler=a(he.getAttribute("source")),U}function _(he){const U=[],j=he.channels,Q=he.samplers,Y=he.sources;for(const ce in j)if(j.hasOwnProperty(ce)){const Fe=j[ce],je=Q[Fe.sampler],gt=je.inputs.INPUT,lt=je.inputs.OUTPUT,pt=Y[gt],mt=Y[lt],ct=T(Fe,pt,mt);M(ct,U)}return U}function w(he){return m(_n.animations[he],_)}function T(he,U,j){const Q=_n.nodes[he.id],Y=Gt(Q.id),ce=Q.transforms[he.sid],Fe=Q.matrix.clone().transpose();let je,gt,lt,pt,mt,ct;const dt={};switch(ce){case"matrix":for(lt=0,pt=U.array.length;lt<pt;lt++)if(je=U.array[lt],gt=lt*j.stride,dt[je]===void 0&&(dt[je]={}),he.arraySyntax===!0){const jt=j.array[gt],xn=he.indices[0]+4*he.indices[1];dt[je][xn]=jt}else for(mt=0,ct=j.stride;mt<ct;mt++)dt[je][mt]=j.array[gt+mt];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ce);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ce);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',ce);break}const Rt=S(dt,Fe);return{name:Y.uuid,keyframes:Rt}}function S(he,U){const j=[];for(const Y in he)j.push({time:parseFloat(Y),value:he[Y]});j.sort(Q);for(let Y=0;Y<16;Y++)D(j,Y,U.elements[Y]);return j;function Q(Y,ce){return Y.time-ce.time}}const C=new $,A=new $,R=new bn;function M(he,U){const j=he.keyframes,Q=he.name,Y=[],ce=[],Fe=[],je=[];for(let gt=0,lt=j.length;gt<lt;gt++){const pt=j[gt],mt=pt.time,ct=pt.value;Ue.fromArray(ct).transpose(),Ue.decompose(C,R,A),Y.push(mt),ce.push(C.x,C.y,C.z),Fe.push(R.x,R.y,R.z,R.w),je.push(A.x,A.y,A.z)}return ce.length>0&&U.push(new Xo(Q+".position",Y,ce)),Fe.length>0&&U.push(new Za(Q+".quaternion",Y,Fe)),je.length>0&&U.push(new Xo(Q+".scale",Y,je)),U}function D(he,U,j){let Q,Y=!0,ce,Fe;for(ce=0,Fe=he.length;ce<Fe;ce++)Q=he[ce],Q.value[U]===void 0?Q.value[U]=null:Y=!1;if(Y===!0)for(ce=0,Fe=he.length;ce<Fe;ce++)Q=he[ce],Q.value[U]=j;else k(he,U)}function k(he,U){let j,Q;for(let Y=0,ce=he.length;Y<ce;Y++){const Fe=he[Y];if(Fe.value[U]===null){if(j=L(he,Y,U),Q=N(he,Y,U),j===null){Fe.value[U]=Q.value[U];continue}if(Q===null){Fe.value[U]=j.value[U];continue}z(Fe,j,Q,U)}}}function L(he,U,j){for(;U>=0;){const Q=he[U];if(Q.value[j]!==null)return Q;U--}return null}function N(he,U,j){for(;U<he.length;){const Q=he[U];if(Q.value[j]!==null)return Q;U++}return null}function z(he,U,j,Q){if(j.time-U.time===0){he.value[Q]=U.value[Q];return}he.value[Q]=(he.time-U.time)*(j.value[Q]-U.value[Q])/(j.time-U.time)+U.value[Q]}function O(he){const U={name:he.getAttribute("id")||"default",start:parseFloat(he.getAttribute("start")||0),end:parseFloat(he.getAttribute("end")||0),animations:[]};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"instance_animation":U.animations.push(a(Y.getAttribute("url")));break}}_n.clips[he.getAttribute("id")]=U}function K(he){const U=[],j=he.name,Q=he.end-he.start||-1,Y=he.animations;for(let ce=0,Fe=Y.length;ce<Fe;ce++){const je=w(Y[ce]);for(let gt=0,lt=je.length;gt<lt;gt++)U.push(je[gt])}return new Qa(j,Q,U)}function V(he){return m(_n.clips[he],K)}function ne(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"skin":U.id=a(Y.getAttribute("source")),U.skin=re(Y);break;case"morph":U.id=a(Y.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}_n.controllers[he.getAttribute("id")]=U}function re(he){const U={sources:{}};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"bind_shape_matrix":U.bindShapeMatrix=s(Y.textContent);break;case"source":const ce=Y.getAttribute("id");U.sources[ce]=Qe(Y);break;case"joints":U.joints=P(Y);break;case"vertex_weights":U.vertexWeights=se(Y);break}}return U}function P(he){const U={inputs:{}};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"input":const ce=Y.getAttribute("semantic"),Fe=a(Y.getAttribute("source"));U.inputs[ce]=Fe;break}}return U}function se(he){const U={inputs:{}};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"input":const ce=Y.getAttribute("semantic"),Fe=a(Y.getAttribute("source")),je=parseInt(Y.getAttribute("offset"));U.inputs[ce]={id:Fe,offset:je};break;case"vcount":U.vcount=o(Y.textContent);break;case"v":U.v=o(Y.textContent);break}}return U}function ue(he){const U={id:he.id},j=_n.geometries[U.id];return he.skin!==void 0&&(U.skin=te(he.skin),j.sources.skinIndices=U.skin.indices,j.sources.skinWeights=U.skin.weights),U}function te(he){const j={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},Q=he.sources,Y=he.vertexWeights,ce=Y.vcount,Fe=Y.v,je=Y.inputs.JOINT.offset,gt=Y.inputs.WEIGHT.offset,lt=he.sources[he.joints.inputs.JOINT],pt=he.sources[he.joints.inputs.INV_BIND_MATRIX],mt=Q[Y.inputs.WEIGHT.id].array;let ct=0,dt,Rt,Nt;for(dt=0,Nt=ce.length;dt<Nt;dt++){const xn=ce[dt],un=[];for(Rt=0;Rt<xn;Rt++){const nn=Fe[ct+je],Vn=Fe[ct+gt],Lr=mt[Vn];un.push({index:nn,weight:Lr}),ct+=2}for(un.sort(jt),Rt=0;Rt<4;Rt++){const nn=un[Rt];nn!==void 0?(j.indices.array.push(nn.index),j.weights.array.push(nn.weight)):(j.indices.array.push(0),j.weights.array.push(0))}}for(he.bindShapeMatrix?j.bindMatrix=new et().fromArray(he.bindShapeMatrix).transpose():j.bindMatrix=new et().identity(),dt=0,Nt=lt.array.length;dt<Nt;dt++){const xn=lt.array[dt],un=new et().fromArray(pt.array,dt*pt.stride).transpose();j.joints.push({name:xn,boneInverse:un})}return j;function jt(xn,un){return un.weight-xn.weight}}function W(he){return m(_n.controllers[he],ue)}function X(he){const U={init_from:r(he,"init_from")[0].textContent};_n.images[he.getAttribute("id")]=U}function J(he){return he.build!==void 0?he.build:he.init_from}function oe(he){const U=_n.images[he];return U!==void 0?m(U,J):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",he),null)}function Ee(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"profile_COMMON":U.profile=me(Y);break}}_n.effects[he.getAttribute("id")]=U}function me(he){const U={surfaces:{},samplers:{}};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"newparam":Te(Y,U);break;case"technique":U.technique=ae(Y);break;case"extra":U.extra=ze(Y);break}}return U}function Te(he,U){const j=he.getAttribute("sid");for(let Q=0,Y=he.childNodes.length;Q<Y;Q++){const ce=he.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"surface":U.surfaces[j]=_e(ce);break;case"sampler2D":U.samplers[j]=Re(ce);break}}}function _e(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"init_from":U.init_from=Y.textContent;break}}return U}function Re(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"source":U.source=Y.textContent;break}}return U}function ae(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"constant":case"lambert":case"blinn":case"phong":U.type=Y.nodeName,U.parameters=Ce(Y);break;case"extra":U.extra=ze(Y);break}}return U}function Ce(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":U[Y.nodeName]=Pe(Y);break;case"transparent":U[Y.nodeName]={opaque:Y.hasAttribute("opaque")?Y.getAttribute("opaque"):"A_ONE",data:Pe(Y)};break}}return U}function Pe(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"color":U[Y.nodeName]=s(Y.textContent);break;case"float":U[Y.nodeName]=parseFloat(Y.textContent);break;case"texture":U[Y.nodeName]={id:Y.getAttribute("texture"),extra:Ve(Y)};break}}return U}function Ve(he){const U={technique:{}};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"extra":ye(Y,U);break}}return U}function ye(he,U){for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"technique":ge(Y,U);break}}}function ge(he,U){for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":U.technique[Y.nodeName]=parseFloat(Y.textContent);break;case"wrapU":case"wrapV":Y.textContent.toUpperCase()==="TRUE"?U.technique[Y.nodeName]=1:Y.textContent.toUpperCase()==="FALSE"?U.technique[Y.nodeName]=0:U.technique[Y.nodeName]=parseInt(Y.textContent);break;case"bump":U[Y.nodeName]=ie(Y);break}}}function ze(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"technique":U.technique=fe(Y);break}}return U}function fe(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"double_sided":U[Y.nodeName]=parseInt(Y.textContent);break;case"bump":U[Y.nodeName]=ie(Y);break}}return U}function ie(he){for(var U={},j=0,Q=he.childNodes.length;j<Q;j++){var Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"texture":U[Y.nodeName]={id:Y.getAttribute("texture"),texcoord:Y.getAttribute("texcoord"),extra:Ve(Y)};break}}return U}function ve(he){return he}function Me(he){return m(_n.effects[he],ve)}function Be(he){const U={name:he.getAttribute("name")};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"instance_effect":U.url=a(Y.getAttribute("url"));break}}_n.materials[he.getAttribute("id")]=U}function Ze(he){let U,j=he.slice((he.lastIndexOf(".")-1>>>0)+2);switch(j=j.toLowerCase(),j){case"tga":U=Bn;break;default:U=mr}return U}function F(he){const U=Me(he.url),j=U.profile.technique;let Q;switch(j.type){case"phong":case"blinn":Q=new nu;break;case"lambert":Q=new nh;break;default:Q=new Fr;break}Q.name=he.name||"";function Y(gt){const lt=U.profile.samplers[gt.id];let pt=null;if(lt!==void 0){const mt=U.profile.surfaces[lt.source];pt=oe(mt.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),pt=oe(gt.id);if(pt!==null){const mt=Ze(pt);if(mt!==void 0){const ct=mt.load(pt),dt=gt.extra;if(dt!==void 0&&dt.technique!==void 0&&c(dt.technique)===!1){const Rt=dt.technique;ct.wrapS=Rt.wrapU?Or:ei,ct.wrapT=Rt.wrapV?Or:ei,ct.offset.set(Rt.offsetU||0,Rt.offsetV||0),ct.repeat.set(Rt.repeatU||1,Rt.repeatV||1)}else ct.wrapS=Or,ct.wrapT=Or;return ct}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",pt),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",gt.id),null}const ce=j.parameters;for(const gt in ce){const lt=ce[gt];switch(gt){case"diffuse":lt.color&&Q.color.fromArray(lt.color),lt.texture&&(Q.map=Y(lt.texture));break;case"specular":lt.color&&Q.specular&&Q.specular.fromArray(lt.color),lt.texture&&(Q.specularMap=Y(lt.texture));break;case"bump":lt.texture&&(Q.normalMap=Y(lt.texture));break;case"ambient":lt.texture&&(Q.lightMap=Y(lt.texture));break;case"shininess":lt.float&&Q.shininess&&(Q.shininess=lt.float);break;case"emission":lt.color&&Q.emissive&&Q.emissive.fromArray(lt.color),lt.texture&&(Q.emissiveMap=Y(lt.texture));break}}let Fe=ce.transparent,je=ce.transparency;if(je===void 0&&Fe&&(je={float:1}),Fe===void 0&&je&&(Fe={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Fe&&je)if(Fe.data.texture)Q.transparent=!0;else{const gt=Fe.data.color;switch(Fe.opaque){case"A_ONE":Q.opacity=gt[3]*je.float;break;case"RGB_ZERO":Q.opacity=1-gt[0]*je.float;break;case"A_ZERO":Q.opacity=1-gt[3]*je.float;break;case"RGB_ONE":Q.opacity=gt[0]*je.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Fe.opaque)}Q.opacity<1&&(Q.transparent=!0)}if(j.extra!==void 0&&j.extra.technique!==void 0){const gt=j.extra.technique;for(const lt in gt){const pt=gt[lt];switch(lt){case"double_sided":Q.side=pt===1?Nr:Cs;break;case"bump":Q.normalMap=Y(pt.texture),Q.normalScale=new Ke(1,1);break}}}return Q}function Z(he){return m(_n.materials[he],F)}function q(he){const U={name:he.getAttribute("name")};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"optics":U.optics=xe(Y);break}}_n.cameras[he.getAttribute("id")]=U}function xe(he){for(let U=0;U<he.childNodes.length;U++){const j=he.childNodes[U];switch(j.nodeName){case"technique_common":return be(j)}}return{}}function be(he){const U={};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];switch(Q.nodeName){case"perspective":case"orthographic":U.technique=Q.nodeName,U.parameters=De(Q);break}}return U}function De(he){const U={};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];switch(Q.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":U[Q.nodeName]=parseFloat(Q.textContent);break}}return U}function $e(he){let U;switch(he.optics.technique){case"perspective":U=new Ar(he.optics.parameters.yfov,he.optics.parameters.aspect_ratio,he.optics.parameters.znear,he.optics.parameters.zfar);break;case"orthographic":let j=he.optics.parameters.ymag,Q=he.optics.parameters.xmag;const Y=he.optics.parameters.aspect_ratio;Q=Q===void 0?j*Y:Q,j=j===void 0?Q/Y:j,Q*=.5,j*=.5,U=new Hi(-Q,Q,j,-j,he.optics.parameters.znear,he.optics.parameters.zfar);break;default:U=new Ar;break}return U.name=he.name||"",U}function st(he){const U=_n.cameras[he];return U!==void 0?m(U,$e):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",he),null)}function it(he){let U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"technique_common":U=Ie(Y);break}}_n.lights[he.getAttribute("id")]=U}function Ie(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"directional":case"point":case"spot":case"ambient":U.technique=Y.nodeName,U.parameters=Ye(Y)}}return U}function Ye(he){const U={};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"color":const ce=s(Y.textContent);U.color=new wt().fromArray(ce);break;case"falloff_angle":U.falloffAngle=parseFloat(Y.textContent);break;case"quadratic_attenuation":const Fe=parseFloat(Y.textContent);U.distance=Fe?Math.sqrt(1/Fe):0;break}}return U}function at(he){let U;switch(he.technique){case"directional":U=new jm;break;case"point":U=new Gm;break;case"spot":U=new Hm;break;case"ambient":U=new Wb;break}return he.parameters.color&&U.color.copy(he.parameters.color),he.parameters.distance&&(U.distance=he.parameters.distance),U}function ke(he){const U=_n.lights[he];return U!==void 0?m(U,at):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",he),null)}function Xe(he){const U={name:he.getAttribute("name"),sources:{},vertices:{},primitives:[]},j=r(he,"mesh")[0];if(j!==void 0){for(let Q=0;Q<j.childNodes.length;Q++){const Y=j.childNodes[Q];if(Y.nodeType!==1)continue;const ce=Y.getAttribute("id");switch(Y.nodeName){case"source":U.sources[ce]=Qe(Y);break;case"vertices":U.vertices=_t(Y);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Y.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":U.primitives.push(kt(Y));break;default:console.log(Y)}}_n.geometries[he.getAttribute("id")]=U}}function Qe(he){const U={array:[],stride:3};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"float_array":U.array=s(Q.textContent);break;case"Name_array":U.array=i(Q.textContent);break;case"technique_common":const Y=r(Q,"accessor")[0];Y!==void 0&&(U.stride=parseInt(Y.getAttribute("stride")));break}}return U}function _t(he){const U={};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];Q.nodeType===1&&(U[Q.getAttribute("semantic")]=a(Q.getAttribute("source")))}return U}function kt(he){const U={type:he.nodeName,material:he.getAttribute("material"),count:parseInt(he.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let j=0,Q=he.childNodes.length;j<Q;j++){const Y=he.childNodes[j];if(Y.nodeType===1)switch(Y.nodeName){case"input":const ce=a(Y.getAttribute("source")),Fe=Y.getAttribute("semantic"),je=parseInt(Y.getAttribute("offset")),gt=parseInt(Y.getAttribute("set")),lt=gt>0?Fe+gt:Fe;U.inputs[lt]={id:ce,offset:je},U.stride=Math.max(U.stride,je+1),Fe==="TEXCOORD"&&(U.hasUV=!0);break;case"vcount":U.vcount=o(Y.textContent);break;case"p":U.p=o(Y.textContent);break}}return U}function Ct(he){const U={};for(let j=0;j<he.length;j++){const Q=he[j];U[Q.type]===void 0&&(U[Q.type]=[]),U[Q.type].push(Q)}return U}function Kt(he){let U=0;for(let j=0,Q=he.length;j<Q;j++)he[j].hasUV===!0&&U++;U>0&&U<he.length&&(he.uvsNeedsFix=!0)}function cn(he){const U={},j=he.sources,Q=he.vertices,Y=he.primitives;if(Y.length===0)return{};const ce=Ct(Y);for(const Fe in ce){const je=ce[Fe];Kt(je),U[Fe]=sn(je,j,Q)}return U}function sn(he,U,j){const Q={},Y={array:[],stride:0},ce={array:[],stride:0},Fe={array:[],stride:0},je={array:[],stride:0},gt={array:[],stride:0},lt={array:[],stride:4},pt={array:[],stride:4},mt=new gn,ct=[];let dt=0;for(let Rt=0;Rt<he.length;Rt++){const Nt=he[Rt],jt=Nt.inputs;let xn=0;switch(Nt.type){case"lines":case"linestrips":xn=Nt.count*2;break;case"triangles":xn=Nt.count*3;break;case"polylist":for(let un=0;un<Nt.count;un++){const nn=Nt.vcount[un];switch(nn){case 3:xn+=3;break;case 4:xn+=6;break;default:xn+=(nn-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",Nt.type)}mt.addGroup(dt,xn,Rt),dt+=xn,Nt.material&&ct.push(Nt.material);for(const un in jt){const nn=jt[un];switch(un){case"VERTEX":for(const Vn in j){const Lr=j[Vn];switch(Vn){case"POSITION":const gr=Y.array.length;if(Vt(Nt,U[Lr],nn.offset,Y.array),Y.stride=U[Lr].stride,U.skinWeights&&U.skinIndices&&(Vt(Nt,U.skinIndices,nn.offset,lt.array),Vt(Nt,U.skinWeights,nn.offset,pt.array)),Nt.hasUV===!1&&he.uvsNeedsFix===!0){const ci=(Y.array.length-gr)/Y.stride;for(let co=0;co<ci;co++)Fe.array.push(0,0)}break;case"NORMAL":Vt(Nt,U[Lr],nn.offset,ce.array),ce.stride=U[Lr].stride;break;case"COLOR":Vt(Nt,U[Lr],nn.offset,gt.array),gt.stride=U[Lr].stride;break;case"TEXCOORD":Vt(Nt,U[Lr],nn.offset,Fe.array),Fe.stride=U[Lr].stride;break;case"TEXCOORD1":Vt(Nt,U[Lr],nn.offset,je.array),Fe.stride=U[Lr].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Vn)}}break;case"NORMAL":Vt(Nt,U[nn.id],nn.offset,ce.array),ce.stride=U[nn.id].stride;break;case"COLOR":Vt(Nt,U[nn.id],nn.offset,gt.array),gt.stride=U[nn.id].stride;break;case"TEXCOORD":Vt(Nt,U[nn.id],nn.offset,Fe.array),Fe.stride=U[nn.id].stride;break;case"TEXCOORD1":Vt(Nt,U[nn.id],nn.offset,je.array),je.stride=U[nn.id].stride;break}}}return Y.array.length>0&&mt.setAttribute("position",new Dt(Y.array,Y.stride)),ce.array.length>0&&mt.setAttribute("normal",new Dt(ce.array,ce.stride)),gt.array.length>0&&mt.setAttribute("color",new Dt(gt.array,gt.stride)),Fe.array.length>0&&mt.setAttribute("uv",new Dt(Fe.array,Fe.stride)),je.array.length>0&&mt.setAttribute(oC,new Dt(je.array,je.stride)),lt.array.length>0&&mt.setAttribute("skinIndex",new Dt(lt.array,lt.stride)),pt.array.length>0&&mt.setAttribute("skinWeight",new Dt(pt.array,pt.stride)),Q.data=mt,Q.type=he[0].type,Q.materialKeys=ct,Q}function Vt(he,U,j,Q){const Y=he.p,ce=he.stride,Fe=he.vcount;function je(pt){let mt=Y[pt+j]*lt;const ct=mt+lt;for(;mt<ct;mt++)Q.push(gt[mt])}const gt=U.array,lt=U.stride;if(he.vcount!==void 0){let pt=0;for(let mt=0,ct=Fe.length;mt<ct;mt++){const dt=Fe[mt];if(dt===4){const Rt=pt+ce*0,Nt=pt+ce*1,jt=pt+ce*2,xn=pt+ce*3;je(Rt),je(Nt),je(xn),je(Nt),je(jt),je(xn)}else if(dt===3){const Rt=pt+ce*0,Nt=pt+ce*1,jt=pt+ce*2;je(Rt),je(Nt),je(jt)}else if(dt>4)for(let Rt=1,Nt=dt-2;Rt<=Nt;Rt++){const jt=pt+ce*0,xn=pt+ce*Rt,un=pt+ce*(Rt+1);je(jt),je(xn),je(un)}pt+=ce*dt}}else for(let pt=0,mt=Y.length;pt<mt;pt+=ce)je(pt)}function Gn(he){return m(_n.geometries[he],cn)}function rr(he){const U={name:he.getAttribute("name")||"",joints:{},links:[]};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"technique_common":zr(Q,U);break}}_n.kinematicsModels[he.getAttribute("id")]=U}function Cr(he){return he.build!==void 0?he.build:he}function wi(he){return m(_n.kinematicsModels[he],Cr)}function zr(he,U){for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"joint":U.joints[Q.getAttribute("sid")]=mi(Q);break;case"link":U.links.push(Hr(Q));break}}}function mi(he){let U;for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"prismatic":case"revolute":U=gi(Q);break}}return U}function gi(he){const U={sid:he.getAttribute("sid"),name:he.getAttribute("name")||"",axis:new $,limits:{min:0,max:0},type:he.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"axis":const Y=s(Q.textContent);U.axis.fromArray(Y);break;case"limits":const ce=Q.getElementsByTagName("max")[0],Fe=Q.getElementsByTagName("min")[0];U.limits.max=parseFloat(ce.textContent),U.limits.min=parseFloat(Fe.textContent);break}}return U.limits.min>=U.limits.max&&(U.static=!0),U.middlePosition=(U.limits.min+U.limits.max)/2,U}function Hr(he){const U={sid:he.getAttribute("sid"),name:he.getAttribute("name")||"",attachments:[],transforms:[]};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"attachment_full":U.attachments.push(An(Q));break;case"matrix":case"translate":case"rotate":U.transforms.push(kr(Q));break}}return U}function An(he){const U={joint:he.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"link":U.links.push(Hr(Q));break;case"matrix":case"translate":case"rotate":U.transforms.push(kr(Q));break}}return U}function kr(he){const U={type:he.nodeName},j=s(he.textContent);switch(U.type){case"matrix":U.obj=new et,U.obj.fromArray(j).transpose();break;case"translate":U.obj=new $,U.obj.fromArray(j);break;case"rotate":U.obj=new $,U.obj.fromArray(j),U.angle=ri.degToRad(j[3]);break}return U}function Wi(he){const U={name:he.getAttribute("name")||"",rigidBodies:{}};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"rigid_body":U.rigidBodies[Q.getAttribute("name")]={},pe(Q,U.rigidBodies[Q.getAttribute("name")]);break}}_n.physicsModels[he.getAttribute("id")]=U}function pe(he,U){for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"technique_common":we(Q,U);break}}}function we(he,U){for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"inertia":U.inertia=s(Q.textContent);break;case"mass":U.mass=s(Q.textContent)[0];break}}}function qe(he){const U={bindJointAxis:[]};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"bind_joint_axis":U.bindJointAxis.push(ut(Q));break}}_n.kinematicsScenes[a(he.getAttribute("url"))]=U}function ut(he){const U={target:he.getAttribute("target").split("/").pop()};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType===1)switch(Q.nodeName){case"axis":const Y=Q.getElementsByTagName("param")[0];U.axis=Y.textContent;const ce=U.axis.split("inst_").pop().split("axis")[0];U.jointIndex=ce.substr(0,ce.length-1);break}}return U}function yt(he){return he.build!==void 0?he.build:he}function vt(he){return m(_n.kinematicsScenes[he],yt)}function Ft(){const he=Object.keys(_n.kinematicsModels)[0],U=Object.keys(_n.kinematicsScenes)[0],j=Object.keys(_n.visualScenes)[0];if(he===void 0||U===void 0)return;const Q=wi(he),Y=vt(U),ce=qt(j),Fe=Y.bindJointAxis,je={};for(let pt=0,mt=Fe.length;pt<mt;pt++){const ct=Fe[pt],dt=Jt.querySelector('[sid="'+ct.target+'"]');if(dt){const Rt=dt.parentElement;gt(ct.jointIndex,Rt)}}function gt(pt,mt){const ct=mt.getAttribute("name"),dt=Q.joints[pt];ce.traverse(function(Rt){Rt.name===ct&&(je[pt]={object:Rt,transforms:de(mt),joint:dt,position:dt.zeroPosition})})}const lt=new et;Ii={joints:Q&&Q.joints,getJointValue:function(pt){const mt=je[pt];if(mt)return mt.position;console.warn("THREE.ColladaLoader: Joint "+pt+" doesn't exist.")},setJointValue:function(pt,mt){const ct=je[pt];if(ct){const dt=ct.joint;if(mt>dt.limits.max||mt<dt.limits.min)console.warn("THREE.ColladaLoader: Joint "+pt+" value "+mt+" outside of limits (min: "+dt.limits.min+", max: "+dt.limits.max+").");else if(dt.static)console.warn("THREE.ColladaLoader: Joint "+pt+" is static.");else{const Rt=ct.object,Nt=dt.axis,jt=ct.transforms;Ue.identity();for(let xn=0;xn<jt.length;xn++){const un=jt[xn];if(un.sid&&un.sid.indexOf(pt)!==-1)switch(dt.type){case"revolute":Ue.multiply(lt.makeRotationAxis(Nt,ri.degToRad(mt)));break;case"prismatic":Ue.multiply(lt.makeTranslation(Nt.x*mt,Nt.y*mt,Nt.z*mt));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+dt.type);break}else switch(un.type){case"matrix":Ue.multiply(un.obj);break;case"translate":Ue.multiply(lt.makeTranslation(un.obj.x,un.obj.y,un.obj.z));break;case"scale":Ue.scale(un.obj);break;case"rotate":Ue.multiply(lt.makeRotationAxis(un.obj,un.angle));break}}Rt.matrix.copy(Ue),Rt.matrix.decompose(Rt.position,Rt.quaternion,Rt.scale),je[pt].position=mt}}else console.log("THREE.ColladaLoader: "+pt+" does not exist.")}}}function de(he){const U=[],j=Jt.querySelector('[id="'+he.id+'"]');for(let Q=0;Q<j.childNodes.length;Q++){const Y=j.childNodes[Q];if(Y.nodeType!==1)continue;let ce,Fe;switch(Y.nodeName){case"matrix":ce=s(Y.textContent);const je=new et().fromArray(ce).transpose();U.push({sid:Y.getAttribute("sid"),type:Y.nodeName,obj:je});break;case"translate":case"scale":ce=s(Y.textContent),Fe=new $().fromArray(ce),U.push({sid:Y.getAttribute("sid"),type:Y.nodeName,obj:Fe});break;case"rotate":ce=s(Y.textContent),Fe=new $().fromArray(ce);const gt=ri.degToRad(ce[3]);U.push({sid:Y.getAttribute("sid"),type:Y.nodeName,obj:Fe,angle:gt});break}}return U}function Le(he){const U=he.getElementsByTagName("node");for(let j=0;j<U.length;j++){const Q=U[j];Q.hasAttribute("id")===!1&&Q.setAttribute("id",l())}}const Ue=new et,He=new $;function Se(he){const U={name:he.getAttribute("name")||"",type:he.getAttribute("type"),id:he.getAttribute("id"),sid:he.getAttribute("sid"),matrix:new et,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];if(Q.nodeType!==1)continue;let Y;switch(Q.nodeName){case"node":U.nodes.push(Q.getAttribute("id")),Se(Q);break;case"instance_camera":U.instanceCameras.push(a(Q.getAttribute("url")));break;case"instance_controller":U.instanceControllers.push(Tt(Q));break;case"instance_light":U.instanceLights.push(a(Q.getAttribute("url")));break;case"instance_geometry":U.instanceGeometries.push(Tt(Q));break;case"instance_node":U.instanceNodes.push(a(Q.getAttribute("url")));break;case"matrix":Y=s(Q.textContent),U.matrix.multiply(Ue.fromArray(Y).transpose()),U.transforms[Q.getAttribute("sid")]=Q.nodeName;break;case"translate":Y=s(Q.textContent),He.fromArray(Y),U.matrix.multiply(Ue.makeTranslation(He.x,He.y,He.z)),U.transforms[Q.getAttribute("sid")]=Q.nodeName;break;case"rotate":Y=s(Q.textContent);const ce=ri.degToRad(Y[3]);U.matrix.multiply(Ue.makeRotationAxis(He.fromArray(Y),ce)),U.transforms[Q.getAttribute("sid")]=Q.nodeName;break;case"scale":Y=s(Q.textContent),U.matrix.scale(He.fromArray(Y)),U.transforms[Q.getAttribute("sid")]=Q.nodeName;break;case"extra":break;default:console.log(Q)}}return Ht(U.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",U.id):_n.nodes[U.id]=U,U}function Tt(he){const U={id:a(he.getAttribute("url")),materials:{},skeletons:[]};for(let j=0;j<he.childNodes.length;j++){const Q=he.childNodes[j];switch(Q.nodeName){case"bind_material":const Y=Q.getElementsByTagName("instance_material");for(let ce=0;ce<Y.length;ce++){const Fe=Y[ce],je=Fe.getAttribute("symbol"),gt=Fe.getAttribute("target");U.materials[je]=a(gt)}break;case"skeleton":U.skeletons.push(a(Q.textContent));break}}return U}function xt(he,U){const j=[],Q=[];let Y,ce,Fe;for(Y=0;Y<he.length;Y++){const lt=he[Y];let pt;if(Ht(lt))pt=Gt(lt),bt(pt,U,j);else if(Zt(lt)){const ct=_n.visualScenes[lt].children;for(let dt=0;dt<ct.length;dt++){const Rt=ct[dt];if(Rt.type==="JOINT"){const Nt=Gt(Rt.id);bt(Nt,U,j)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",lt)}for(Y=0;Y<U.length;Y++)for(ce=0;ce<j.length;ce++)if(Fe=j[ce],Fe.bone.name===U[Y].name){Q[Y]=Fe,Fe.processed=!0;break}for(Y=0;Y<j.length;Y++)Fe=j[Y],Fe.processed===!1&&(Q.push(Fe),Fe.processed=!0);const je=[],gt=[];for(Y=0;Y<Q.length;Y++)Fe=Q[Y],je.push(Fe.bone),gt.push(Fe.boneInverse);return new wf(je,gt)}function bt(he,U,j){he.traverse(function(Q){if(Q.isBone===!0){let Y;for(let ce=0;ce<U.length;ce++){const Fe=U[ce];if(Fe.name===Q.name){Y=Fe.boneInverse;break}}Y===void 0&&(Y=new et),j.push({bone:Q,boneInverse:Y,processed:!1})}})}function Pt(he){const U=[],j=he.matrix,Q=he.nodes,Y=he.type,ce=he.instanceCameras,Fe=he.instanceControllers,je=he.instanceLights,gt=he.instanceGeometries,lt=he.instanceNodes;for(let mt=0,ct=Q.length;mt<ct;mt++)U.push(Gt(Q[mt]));for(let mt=0,ct=ce.length;mt<ct;mt++){const dt=st(ce[mt]);dt!==null&&U.push(dt.clone())}for(let mt=0,ct=Fe.length;mt<ct;mt++){const dt=Fe[mt],Rt=W(dt.id),Nt=Gn(Rt.id),jt=Ot(Nt,dt.materials),xn=dt.skeletons,un=Rt.skin.joints,nn=xt(xn,un);for(let Vn=0,Lr=jt.length;Vn<Lr;Vn++){const gr=jt[Vn];gr.isSkinnedMesh&&(gr.bind(nn,Rt.skin.bindMatrix),gr.normalizeSkinWeights()),U.push(gr)}}for(let mt=0,ct=je.length;mt<ct;mt++){const dt=ke(je[mt]);dt!==null&&U.push(dt.clone())}for(let mt=0,ct=gt.length;mt<ct;mt++){const dt=gt[mt],Rt=Gn(dt.id),Nt=Ot(Rt,dt.materials);for(let jt=0,xn=Nt.length;jt<xn;jt++)U.push(Nt[jt])}for(let mt=0,ct=lt.length;mt<ct;mt++)U.push(Gt(lt[mt]).clone());let pt;if(Q.length===0&&U.length===1)pt=U[0];else{pt=Y==="JOINT"?new Jd:new es;for(let mt=0;mt<U.length;mt++)pt.add(U[mt])}return pt.name=Y==="JOINT"?he.sid:he.name,pt.matrix.copy(j),pt.matrix.decompose(pt.position,pt.quaternion,pt.scale),pt}const Bt=new Fr({color:16711935});function Xt(he,U){const j=[];for(let Q=0,Y=he.length;Q<Y;Q++){const ce=U[he[Q]];ce===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",he[Q]),j.push(Bt)):j.push(Z(ce))}return j}function Ot(he,U){const j=[];for(const Q in he){const Y=he[Q],ce=Xt(Y.materialKeys,U);ce.length===0&&(Q==="lines"||Q==="linestrips"?ce.push(new oi):ce.push(new nu));const Fe=Y.data.attributes.skinIndex!==void 0,je=ce.length===1?ce[0]:ce;let gt;switch(Q){case"lines":gt=new so(Y.data,je);break;case"linestrips":gt=new $o(Y.data,je);break;case"triangles":case"polylist":Fe?gt=new Qd(Y.data,je):gt=new ln(Y.data,je);break}j.push(gt)}return j}function Ht(he){return _n.nodes[he]!==void 0}function Gt(he){return m(_n.nodes[he],Pt)}function dn(he){const U={name:he.getAttribute("name"),children:[]};Le(he);const j=r(he,"node");for(let Q=0;Q<j.length;Q++)U.children.push(Se(j[Q]));_n.visualScenes[he.getAttribute("id")]=U}function En(he){const U=new es;U.name=he.name;const j=he.children;for(let Q=0;Q<j.length;Q++){const Y=j[Q];U.add(Gt(Y.id))}return U}function Zt(he){return _n.visualScenes[he]!==void 0}function qt(he){return m(_n.visualScenes[he],En)}function jn(he){const U=r(he,"instance_visual_scene")[0];return qt(a(U.getAttribute("url")))}function wn(){const he=_n.clips;if(c(he)===!0){if(c(_n.animations)===!1){const U=[];for(const j in _n.animations){const Q=w(j);for(let Y=0,ce=Q.length;Y<ce;Y++)U.push(Q[Y])}sr.push(new Qa("default",-1,U))}}else for(const U in he)sr.push(V(U))}function Zn(he){let U="";const j=[he];for(;j.length;){const Q=j.shift();Q.nodeType===Node.TEXT_NODE?U+=Q.textContent:(U+=`
`,j.push.apply(j,Q.childNodes))}return U.trim()}if(e.length===0)return{scene:new ls};const Nn=new DOMParser().parseFromString(e,"application/xml"),Jt=r(Nn,"COLLADA")[0],On=Nn.getElementsByTagName("parsererror")[0];if(On!==void 0){const he=r(On,"div")[0];let U;return he?U=he.textContent:U=Zn(On),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,U),null}const on=Jt.getAttribute("version");console.log("THREE.ColladaLoader: File version",on);const Un=u(r(Jt,"asset")[0]),mr=new ns(this.manager);mr.setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);let Bn;ek&&(Bn=new ek(this.manager),Bn.setPath(this.resourcePath||n));const sr=[];let Ii={},Si=0;const _n={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};h(Jt,"library_animations","animation",g),h(Jt,"library_animation_clips","animation_clip",O),h(Jt,"library_controllers","controller",ne),h(Jt,"library_images","image",X),h(Jt,"library_effects","effect",Ee),h(Jt,"library_materials","material",Be),h(Jt,"library_cameras","camera",q),h(Jt,"library_lights","light",it),h(Jt,"library_geometries","geometry",Xe),h(Jt,"library_nodes","node",Se),h(Jt,"library_visual_scenes","visual_scene",dn),h(Jt,"library_kinematics_models","kinematics_model",rr),h(Jt,"library_physics_models","physics_model",Wi),h(Jt,"scene","instance_kinematics_scene",qe),p(_n.animations,_),p(_n.clips,K),p(_n.controllers,ue),p(_n.images,J),p(_n.effects,ve),p(_n.materials,F),p(_n.cameras,$e),p(_n.lights,at),p(_n.geometries,cn),p(_n.visualScenes,En),wn(),Ft();const vn=jn(r(Jt,"scene")[0]);return vn.animations=sr,Un.upAxis==="Z_UP"&&vn.quaternion.setFromEuler(new xr(-Math.PI/2,0,0)),vn.scale.multiplyScalar(Un.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),sr},kinematics:Ii,library:_n,scene:vn}}}class hde extends Ey{constructor(e){super(e),this.type=ti}parse(e){const o=function(A,R){switch(A){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(R||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(R||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(R||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(R||""))}},u=`
`,f=function(A,R,M){R=R||1024;let k=A.pos,L=-1,N=0,z="",O=String.fromCharCode.apply(null,new Uint16Array(A.subarray(k,k+128)));for(;0>(L=O.indexOf(u))&&N<R&&k<A.byteLength;)z+=O,N+=O.length,k+=128,O+=String.fromCharCode.apply(null,new Uint16Array(A.subarray(k,k+128)));return-1<L?(A.pos+=N+L+1,z+O.slice(0,L)):!1},d=function(A){const R=/^#\?(\S+)/,M=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,D=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,k=/^\s*FORMAT=(\S+)\s*$/,L=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,N={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let z,O;for((A.pos>=A.byteLength||!(z=f(A)))&&o(1,"no header found"),(O=z.match(R))||o(3,"bad initial token"),N.valid|=1,N.programtype=O[1],N.string+=z+`
`;z=f(A),z!==!1;){if(N.string+=z+`
`,z.charAt(0)==="#"){N.comments+=z+`
`;continue}if((O=z.match(M))&&(N.gamma=parseFloat(O[1])),(O=z.match(D))&&(N.exposure=parseFloat(O[1])),(O=z.match(k))&&(N.valid|=2,N.format=O[1]),(O=z.match(L))&&(N.valid|=4,N.height=parseInt(O[1],10),N.width=parseInt(O[2],10)),N.valid&2&&N.valid&4)break}return N.valid&2||o(3,"missing format specifier"),N.valid&4||o(3,"missing image size specifier"),N},h=function(A,R,M){const D=R;if(D<8||D>32767||A[0]!==2||A[1]!==2||A[2]&128)return new Uint8Array(A);D!==(A[2]<<8|A[3])&&o(3,"wrong scanline width");const k=new Uint8Array(4*R*M);k.length||o(4,"unable to allocate buffer space");let L=0,N=0;const z=4*D,O=new Uint8Array(4),K=new Uint8Array(z);let V=M;for(;V>0&&N<A.byteLength;){N+4>A.byteLength&&o(1),O[0]=A[N++],O[1]=A[N++],O[2]=A[N++],O[3]=A[N++],(O[0]!=2||O[1]!=2||(O[2]<<8|O[3])!=D)&&o(3,"bad rgbe scanline format");let ne=0,re;for(;ne<z&&N<A.byteLength;){re=A[N++];const se=re>128;if(se&&(re-=128),(re===0||ne+re>z)&&o(3,"bad scanline data"),se){const ue=A[N++];for(let te=0;te<re;te++)K[ne++]=ue}else K.set(A.subarray(N,N+re),ne),ne+=re,N+=re}const P=D;for(let se=0;se<P;se++){let ue=0;k[L]=K[se+ue],ue+=D,k[L+1]=K[se+ue],ue+=D,k[L+2]=K[se+ue],ue+=D,k[L+3]=K[se+ue],L+=4}V--}return k},p=function(A,R,M,D){const k=A[R+3],L=Math.pow(2,k-128)/255;M[D+0]=A[R+0]*L,M[D+1]=A[R+1]*L,M[D+2]=A[R+2]*L,M[D+3]=1},m=function(A,R,M,D){const k=A[R+3],L=Math.pow(2,k-128)/255;M[D+0]=vd.toHalfFloat(Math.min(A[R+0]*L,65504)),M[D+1]=vd.toHalfFloat(Math.min(A[R+1]*L,65504)),M[D+2]=vd.toHalfFloat(Math.min(A[R+2]*L,65504)),M[D+3]=vd.toHalfFloat(1)},g=new Uint8Array(e);g.pos=0;const y=d(g),x=y.width,_=y.height,w=h(g.subarray(g.pos),x,_);let T,S,C;switch(this.type){case pr:C=w.length/4;const A=new Float32Array(C*4);for(let M=0;M<C;M++)p(w,M*4,A,M*4);T=A,S=pr;break;case ti:C=w.length/4;const R=new Uint16Array(C*4);for(let M=0;M<C;M++)m(w,M*4,R,M*4);T=R,S=ti;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:x,height:_,data:T,header:y.string,gamma:y.gamma,exposure:y.exposure,type:S}}setDataType(e){return this.type=e,this}load(e,n,r,i){function s(o,a){switch(o.type){case pr:case ti:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=Pn,o.magFilter=Pn,o.generateMipmaps=!1,o.flipY=!0;break}n&&n(o,a)}return super.load(e,s,r,i)}}const tg="colorSpace"in new tr;class pde extends Ey{constructor(e){super(e),this.type=ti}parse(e){const R=Math.pow(2.7182818,2.2);function M(pe,we){for(var qe=0,ut=0;ut<65536;++ut)(ut==0||pe[ut>>3]&1<<(ut&7))&&(we[qe++]=ut);for(var yt=qe-1;qe<65536;)we[qe++]=0;return yt}function D(pe){for(var we=0;we<16384;we++)pe[we]={},pe[we].len=0,pe[we].lit=0,pe[we].p=null}const k={l:0,c:0,lc:0};function L(pe,we,qe,ut,yt){for(;qe<pe;)we=we<<8|it(ut,yt),qe+=8;qe-=pe,k.l=we>>qe&(1<<pe)-1,k.c=we,k.lc=qe}const N=new Array(59);function z(pe){for(var we=0;we<=58;++we)N[we]=0;for(var we=0;we<65537;++we)N[pe[we]]+=1;for(var qe=0,we=58;we>0;--we){var ut=qe+N[we]>>1;N[we]=qe,qe=ut}for(var we=0;we<65537;++we){var yt=pe[we];yt>0&&(pe[we]=yt|N[yt]++<<6)}}function O(pe,we,qe,ut,yt,vt,Ft){for(var de=qe,Le=0,Ue=0;yt<=vt;yt++){if(de.value-qe.value>ut)return!1;L(6,Le,Ue,pe,de);var He=k.l;if(Le=k.c,Ue=k.lc,Ft[yt]=He,He==63){if(de.value-qe.value>ut)throw"Something wrong with hufUnpackEncTable";L(8,Le,Ue,pe,de);var Se=k.l+6;if(Le=k.c,Ue=k.lc,yt+Se>vt+1)throw"Something wrong with hufUnpackEncTable";for(;Se--;)Ft[yt++]=0;yt--}else if(He>=59){var Se=He-59+2;if(yt+Se>vt+1)throw"Something wrong with hufUnpackEncTable";for(;Se--;)Ft[yt++]=0;yt--}}z(Ft)}function K(pe){return pe&63}function V(pe){return pe>>6}function ne(pe,we,qe,ut){for(;we<=qe;we++){var yt=V(pe[we]),vt=K(pe[we]);if(yt>>vt)throw"Invalid table entry";if(vt>14){var Ft=ut[yt>>vt-14];if(Ft.len)throw"Invalid table entry";if(Ft.lit++,Ft.p){var de=Ft.p;Ft.p=new Array(Ft.lit);for(var Le=0;Le<Ft.lit-1;++Le)Ft.p[Le]=de[Le]}else Ft.p=new Array(1);Ft.p[Ft.lit-1]=we}else if(vt)for(var Ue=0,Le=1<<14-vt;Le>0;Le--){var Ft=ut[(yt<<14-vt)+Ue];if(Ft.len||Ft.p)throw"Invalid table entry";Ft.len=vt,Ft.lit=we,Ue++}}return!0}const re={c:0,lc:0};function P(pe,we,qe,ut){pe=pe<<8|it(qe,ut),we+=8,re.c=pe,re.lc=we}const se={c:0,lc:0};function ue(pe,we,qe,ut,yt,vt,Ft,de,Le,Ue){if(pe==we){ut<8&&(P(qe,ut,yt,Ft),qe=re.c,ut=re.lc),ut-=8;var He=qe>>ut,He=new Uint8Array([He])[0];if(Le.value+He>Ue)return!1;for(var Se=de[Le.value-1];He-- >0;)de[Le.value++]=Se}else if(Le.value<Ue)de[Le.value++]=pe;else return!1;se.c=qe,se.lc=ut}function te(pe){return pe&65535}function W(pe){var we=te(pe);return we>32767?we-65536:we}const X={a:0,b:0};function J(pe,we){var qe=W(pe),ut=W(we),yt=ut,vt=qe+(yt&1)+(yt>>1),Ft=vt,de=vt-yt;X.a=Ft,X.b=de}function oe(pe,we){var qe=te(pe),ut=te(we),yt=qe-(ut>>1)&65535,vt=ut+yt-32768&65535;X.a=vt,X.b=yt}function Ee(pe,we,qe,ut,yt,vt,Ft){for(var de=Ft<16384,Le=qe>yt?yt:qe,Ue=1,He;Ue<=Le;)Ue<<=1;for(Ue>>=1,He=Ue,Ue>>=1;Ue>=1;){for(var Se=0,Tt=Se+vt*(yt-He),xt=vt*Ue,bt=vt*He,Pt=ut*Ue,Bt=ut*He,Xt,Ot,Ht,Gt;Se<=Tt;Se+=bt){for(var dn=Se,En=Se+ut*(qe-He);dn<=En;dn+=Bt){var Zt=dn+Pt,qt=dn+xt,jn=qt+Pt;de?(J(pe[dn+we],pe[qt+we]),Xt=X.a,Ht=X.b,J(pe[Zt+we],pe[jn+we]),Ot=X.a,Gt=X.b,J(Xt,Ot),pe[dn+we]=X.a,pe[Zt+we]=X.b,J(Ht,Gt),pe[qt+we]=X.a,pe[jn+we]=X.b):(oe(pe[dn+we],pe[qt+we]),Xt=X.a,Ht=X.b,oe(pe[Zt+we],pe[jn+we]),Ot=X.a,Gt=X.b,oe(Xt,Ot),pe[dn+we]=X.a,pe[Zt+we]=X.b,oe(Ht,Gt),pe[qt+we]=X.a,pe[jn+we]=X.b)}if(qe&Ue){var qt=dn+xt;de?J(pe[dn+we],pe[qt+we]):oe(pe[dn+we],pe[qt+we]),Xt=X.a,pe[qt+we]=X.b,pe[dn+we]=Xt}}if(yt&Ue)for(var dn=Se,En=Se+ut*(qe-He);dn<=En;dn+=Bt){var Zt=dn+Pt;de?J(pe[dn+we],pe[Zt+we]):oe(pe[dn+we],pe[Zt+we]),Xt=X.a,pe[Zt+we]=X.b,pe[dn+we]=Xt}He=Ue,Ue>>=1}return Se}function me(pe,we,qe,ut,yt,vt,Ft,de,Le,Ue){for(var He=0,Se=0,Tt=de,xt=Math.trunc(yt.value+(vt+7)/8);yt.value<xt;)for(P(He,Se,qe,yt),He=re.c,Se=re.lc;Se>=14;){var bt=He>>Se-14&16383,Pt=we[bt];if(Pt.len)Se-=Pt.len,ue(Pt.lit,Ft,He,Se,qe,ut,yt,Le,Ue,Tt),He=se.c,Se=se.lc;else{if(!Pt.p)throw"hufDecode issues";var Bt;for(Bt=0;Bt<Pt.lit;Bt++){for(var Xt=K(pe[Pt.p[Bt]]);Se<Xt&&yt.value<xt;)P(He,Se,qe,yt),He=re.c,Se=re.lc;if(Se>=Xt&&V(pe[Pt.p[Bt]])==(He>>Se-Xt&(1<<Xt)-1)){Se-=Xt,ue(Pt.p[Bt],Ft,He,Se,qe,ut,yt,Le,Ue,Tt),He=se.c,Se=se.lc;break}}if(Bt==Pt.lit)throw"hufDecode issues"}}var Ot=8-vt&7;for(He>>=Ot,Se-=Ot;Se>0;){var Pt=we[He<<14-Se&16383];if(Pt.len)Se-=Pt.len,ue(Pt.lit,Ft,He,Se,qe,ut,yt,Le,Ue,Tt),He=se.c,Se=se.lc;else throw"hufDecode issues"}return!0}function Te(pe,we,qe,ut,yt,vt){var Ft={value:0},de=qe.value,Le=st(we,qe),Ue=st(we,qe);qe.value+=4;var He=st(we,qe);if(qe.value+=4,Le<0||Le>=65537||Ue<0||Ue>=65537)throw"Something wrong with HUF_ENCSIZE";var Se=new Array(65537),Tt=new Array(16384);D(Tt);var xt=ut-(qe.value-de);if(O(pe,we,qe,xt,Le,Ue,Se),He>8*(ut-(qe.value-de)))throw"Something wrong with hufUncompress";ne(Se,Le,Ue,Tt),me(Se,Tt,pe,we,qe,He,Ue,vt,yt,Ft)}function _e(pe,we,qe){for(var ut=0;ut<qe;++ut)we[ut]=pe[we[ut]]}function Re(pe){for(var we=1;we<pe.length;we++){var qe=pe[we-1]+pe[we]-128;pe[we]=qe}}function ae(pe,we){for(var qe=0,ut=Math.floor((pe.length+1)/2),yt=0,vt=pe.length-1;!(yt>vt||(we[yt++]=pe[qe++],yt>vt));)we[yt++]=pe[ut++]}function Ce(pe){for(var we=pe.byteLength,qe=new Array,ut=0,yt=new DataView(pe);we>0;){var vt=yt.getInt8(ut++);if(vt<0){var Ft=-vt;we-=Ft+1;for(var de=0;de<Ft;de++)qe.push(yt.getUint8(ut++))}else{var Ft=vt;we-=2;for(var Le=yt.getUint8(ut++),de=0;de<Ft+1;de++)qe.push(Le)}}return qe}function Pe(pe,we,qe,ut,yt,vt){var Zt=new DataView(vt.buffer),Ft=qe[pe.idx[0]].width,de=qe[pe.idx[0]].height,Le=3,Ue=Math.floor(Ft/8),He=Math.ceil(Ft/8),Se=Math.ceil(de/8),Tt=Ft-(He-1)*8,xt=de-(Se-1)*8,bt={value:0},Pt=new Array(Le),Bt=new Array(Le),Xt=new Array(Le),Ot=new Array(Le),Ht=new Array(Le);for(let Nn=0;Nn<Le;++Nn)Ht[Nn]=we[pe.idx[Nn]],Pt[Nn]=Nn<1?0:Pt[Nn-1]+He*Se,Bt[Nn]=new Float32Array(64),Xt[Nn]=new Uint16Array(64),Ot[Nn]=new Uint16Array(He*64);for(let Nn=0;Nn<Se;++Nn){var Gt=8;Nn==Se-1&&(Gt=xt);var dn=8;for(let On=0;On<He;++On){On==He-1&&(dn=Tt);for(let on=0;on<Le;++on)Xt[on].fill(0),Xt[on][0]=yt[Pt[on]++],Ve(bt,ut,Xt[on]),ye(Xt[on],Bt[on]),ge(Bt[on]);ze(Bt);for(let on=0;on<Le;++on)fe(Bt[on],Ot[on],On*64)}let Jt=0;for(let On=0;On<Le;++On){const on=qe[pe.idx[On]].type;for(let Un=8*Nn;Un<8*Nn+Gt;++Un){Jt=Ht[On][Un];for(let mr=0;mr<Ue;++mr){const Bn=mr*64+(Un&7)*8;Zt.setUint16(Jt+0*2*on,Ot[On][Bn+0],!0),Zt.setUint16(Jt+1*2*on,Ot[On][Bn+1],!0),Zt.setUint16(Jt+2*2*on,Ot[On][Bn+2],!0),Zt.setUint16(Jt+3*2*on,Ot[On][Bn+3],!0),Zt.setUint16(Jt+4*2*on,Ot[On][Bn+4],!0),Zt.setUint16(Jt+5*2*on,Ot[On][Bn+5],!0),Zt.setUint16(Jt+6*2*on,Ot[On][Bn+6],!0),Zt.setUint16(Jt+7*2*on,Ot[On][Bn+7],!0),Jt+=8*2*on}}if(Ue!=He)for(let Un=8*Nn;Un<8*Nn+Gt;++Un){const mr=Ht[On][Un]+8*Ue*2*on,Bn=Ue*64+(Un&7)*8;for(let sr=0;sr<dn;++sr)Zt.setUint16(mr+sr*2*on,Ot[On][Bn+sr],!0)}}}for(var En=new Uint16Array(Ft),Zt=new DataView(vt.buffer),qt=0;qt<Le;++qt){qe[pe.idx[qt]].decoded=!0;var jn=qe[pe.idx[qt]].type;if(qe[qt].type==2)for(var wn=0;wn<de;++wn){const Nn=Ht[qt][wn];for(var Zn=0;Zn<Ft;++Zn)En[Zn]=Zt.getUint16(Nn+Zn*2*jn,!0);for(var Zn=0;Zn<Ft;++Zn)Zt.setFloat32(Nn+Zn*2*jn,Xe(En[Zn]),!0)}}}function Ve(pe,we,qe){for(var ut,yt=1;yt<64;)ut=we[pe.value],ut==65280?yt=64:ut>>8==255?yt+=ut&255:(qe[yt]=ut,yt++),pe.value++}function ye(pe,we){we[0]=Xe(pe[0]),we[1]=Xe(pe[1]),we[2]=Xe(pe[5]),we[3]=Xe(pe[6]),we[4]=Xe(pe[14]),we[5]=Xe(pe[15]),we[6]=Xe(pe[27]),we[7]=Xe(pe[28]),we[8]=Xe(pe[2]),we[9]=Xe(pe[4]),we[10]=Xe(pe[7]),we[11]=Xe(pe[13]),we[12]=Xe(pe[16]),we[13]=Xe(pe[26]),we[14]=Xe(pe[29]),we[15]=Xe(pe[42]),we[16]=Xe(pe[3]),we[17]=Xe(pe[8]),we[18]=Xe(pe[12]),we[19]=Xe(pe[17]),we[20]=Xe(pe[25]),we[21]=Xe(pe[30]),we[22]=Xe(pe[41]),we[23]=Xe(pe[43]),we[24]=Xe(pe[9]),we[25]=Xe(pe[11]),we[26]=Xe(pe[18]),we[27]=Xe(pe[24]),we[28]=Xe(pe[31]),we[29]=Xe(pe[40]),we[30]=Xe(pe[44]),we[31]=Xe(pe[53]),we[32]=Xe(pe[10]),we[33]=Xe(pe[19]),we[34]=Xe(pe[23]),we[35]=Xe(pe[32]),we[36]=Xe(pe[39]),we[37]=Xe(pe[45]),we[38]=Xe(pe[52]),we[39]=Xe(pe[54]),we[40]=Xe(pe[20]),we[41]=Xe(pe[22]),we[42]=Xe(pe[33]),we[43]=Xe(pe[38]),we[44]=Xe(pe[46]),we[45]=Xe(pe[51]),we[46]=Xe(pe[55]),we[47]=Xe(pe[60]),we[48]=Xe(pe[21]),we[49]=Xe(pe[34]),we[50]=Xe(pe[37]),we[51]=Xe(pe[47]),we[52]=Xe(pe[50]),we[53]=Xe(pe[56]),we[54]=Xe(pe[59]),we[55]=Xe(pe[61]),we[56]=Xe(pe[35]),we[57]=Xe(pe[36]),we[58]=Xe(pe[48]),we[59]=Xe(pe[49]),we[60]=Xe(pe[57]),we[61]=Xe(pe[58]),we[62]=Xe(pe[62]),we[63]=Xe(pe[63])}function ge(pe){const we=.5*Math.cos(.7853975),qe=.5*Math.cos(3.14159/16),ut=.5*Math.cos(3.14159/8),yt=.5*Math.cos(3*3.14159/16),vt=.5*Math.cos(5*3.14159/16),Ft=.5*Math.cos(3*3.14159/8),de=.5*Math.cos(7*3.14159/16);for(var Le=new Array(4),Ue=new Array(4),He=new Array(4),Se=new Array(4),Tt=0;Tt<8;++Tt){var xt=Tt*8;Le[0]=ut*pe[xt+2],Le[1]=Ft*pe[xt+2],Le[2]=ut*pe[xt+6],Le[3]=Ft*pe[xt+6],Ue[0]=qe*pe[xt+1]+yt*pe[xt+3]+vt*pe[xt+5]+de*pe[xt+7],Ue[1]=yt*pe[xt+1]-de*pe[xt+3]-qe*pe[xt+5]-vt*pe[xt+7],Ue[2]=vt*pe[xt+1]-qe*pe[xt+3]+de*pe[xt+5]+yt*pe[xt+7],Ue[3]=de*pe[xt+1]-vt*pe[xt+3]+yt*pe[xt+5]-qe*pe[xt+7],He[0]=we*(pe[xt+0]+pe[xt+4]),He[3]=we*(pe[xt+0]-pe[xt+4]),He[1]=Le[0]+Le[3],He[2]=Le[1]-Le[2],Se[0]=He[0]+He[1],Se[1]=He[3]+He[2],Se[2]=He[3]-He[2],Se[3]=He[0]-He[1],pe[xt+0]=Se[0]+Ue[0],pe[xt+1]=Se[1]+Ue[1],pe[xt+2]=Se[2]+Ue[2],pe[xt+3]=Se[3]+Ue[3],pe[xt+4]=Se[3]-Ue[3],pe[xt+5]=Se[2]-Ue[2],pe[xt+6]=Se[1]-Ue[1],pe[xt+7]=Se[0]-Ue[0]}for(var bt=0;bt<8;++bt)Le[0]=ut*pe[16+bt],Le[1]=Ft*pe[16+bt],Le[2]=ut*pe[48+bt],Le[3]=Ft*pe[48+bt],Ue[0]=qe*pe[8+bt]+yt*pe[24+bt]+vt*pe[40+bt]+de*pe[56+bt],Ue[1]=yt*pe[8+bt]-de*pe[24+bt]-qe*pe[40+bt]-vt*pe[56+bt],Ue[2]=vt*pe[8+bt]-qe*pe[24+bt]+de*pe[40+bt]+yt*pe[56+bt],Ue[3]=de*pe[8+bt]-vt*pe[24+bt]+yt*pe[40+bt]-qe*pe[56+bt],He[0]=we*(pe[bt]+pe[32+bt]),He[3]=we*(pe[bt]-pe[32+bt]),He[1]=Le[0]+Le[3],He[2]=Le[1]-Le[2],Se[0]=He[0]+He[1],Se[1]=He[3]+He[2],Se[2]=He[3]-He[2],Se[3]=He[0]-He[1],pe[0+bt]=Se[0]+Ue[0],pe[8+bt]=Se[1]+Ue[1],pe[16+bt]=Se[2]+Ue[2],pe[24+bt]=Se[3]+Ue[3],pe[32+bt]=Se[3]-Ue[3],pe[40+bt]=Se[2]-Ue[2],pe[48+bt]=Se[1]-Ue[1],pe[56+bt]=Se[0]-Ue[0]}function ze(pe){for(var we=0;we<64;++we){var qe=pe[0][we],ut=pe[1][we],yt=pe[2][we];pe[0][we]=qe+1.5747*yt,pe[1][we]=qe-.1873*ut-.4682*yt,pe[2][we]=qe+1.8556*ut}}function fe(pe,we,qe){for(var ut=0;ut<64;++ut)we[qe+ut]=vd.toHalfFloat(ie(pe[ut]))}function ie(pe){return pe<=1?Math.sign(pe)*Math.pow(Math.abs(pe),2.2):Math.sign(pe)*Math.pow(R,Math.abs(pe)-1)}function ve(pe){return new DataView(pe.array.buffer,pe.offset.value,pe.size)}function Me(pe){var we=pe.viewer.buffer.slice(pe.offset.value,pe.offset.value+pe.size),qe=new Uint8Array(Ce(we)),ut=new Uint8Array(qe.length);return Re(qe),ae(qe,ut),new DataView(ut.buffer)}function Be(pe){var we=pe.array.slice(pe.offset.value,pe.offset.value+pe.size),qe=O2(we),ut=new Uint8Array(qe.length);return Re(qe),ae(qe,ut),new DataView(ut.buffer)}function Ze(pe){for(var we=pe.viewer,qe={value:pe.offset.value},ut=new Uint16Array(pe.width*pe.scanlineBlockSize*(pe.channels*pe.type)),yt=new Uint8Array(8192),vt=0,Ft=new Array(pe.channels),de=0;de<pe.channels;de++)Ft[de]={},Ft[de].start=vt,Ft[de].end=Ft[de].start,Ft[de].nx=pe.width,Ft[de].ny=pe.lines,Ft[de].size=pe.type,vt+=Ft[de].nx*Ft[de].ny*Ft[de].size;var Le=Qe(we,qe),Ue=Qe(we,qe);if(Ue>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Le<=Ue)for(var de=0;de<Ue-Le+1;de++)yt[de+Le]=Ie(we,qe);var He=new Uint16Array(65536),Se=M(yt,He),Tt=st(we,qe);Te(pe.array,we,qe,Tt,ut,vt);for(var de=0;de<pe.channels;++de)for(var xt=Ft[de],bt=0;bt<Ft[de].size;++bt)Ee(ut,xt.start+bt,xt.nx,xt.size,xt.ny,xt.nx*xt.size,Se);_e(He,ut,vt);for(var Pt=0,Bt=new Uint8Array(ut.buffer.byteLength),Xt=0;Xt<pe.lines;Xt++)for(var Ot=0;Ot<pe.channels;Ot++){var xt=Ft[Ot],Ht=xt.nx*xt.size,Gt=new Uint8Array(ut.buffer,xt.end*2,Ht*2);Bt.set(Gt,Pt),Pt+=Ht*2,xt.end+=Ht}return new DataView(Bt.buffer)}function F(pe){var we=pe.array.slice(pe.offset.value,pe.offset.value+pe.size),qe=O2(we);const ut=pe.lines*pe.channels*pe.width,yt=pe.type==1?new Uint16Array(ut):new Uint32Array(ut);let vt=0,Ft=0;const de=new Array(4);for(let Le=0;Le<pe.lines;Le++)for(let Ue=0;Ue<pe.channels;Ue++){let He=0;switch(pe.type){case 1:de[0]=vt,de[1]=de[0]+pe.width,vt=de[1]+pe.width;for(let Se=0;Se<pe.width;++Se){const Tt=qe[de[0]++]<<8|qe[de[1]++];He+=Tt,yt[Ft]=He,Ft++}break;case 2:de[0]=vt,de[1]=de[0]+pe.width,de[2]=de[1]+pe.width,vt=de[2]+pe.width;for(let Se=0;Se<pe.width;++Se){const Tt=qe[de[0]++]<<24|qe[de[1]++]<<16|qe[de[2]++]<<8;He+=Tt,yt[Ft]=He,Ft++}break}}return new DataView(yt.buffer)}function Z(pe){var we=pe.viewer,qe={value:pe.offset.value},ut=new Uint8Array(pe.width*pe.lines*(pe.channels*pe.type*2)),yt={version:Ye(we,qe),unknownUncompressedSize:Ye(we,qe),unknownCompressedSize:Ye(we,qe),acCompressedSize:Ye(we,qe),dcCompressedSize:Ye(we,qe),rleCompressedSize:Ye(we,qe),rleUncompressedSize:Ye(we,qe),rleRawSize:Ye(we,qe),totalAcUncompressedCount:Ye(we,qe),totalDcUncompressedCount:Ye(we,qe),acCompression:Ye(we,qe)};if(yt.version<2)throw"EXRLoader.parse: "+Hr.compression+" version "+yt.version+" is unsupported";for(var vt=new Array,Ft=Qe(we,qe)-2;Ft>0;){var de=q(we.buffer,qe),Le=Ie(we,qe),Ue=Le>>2&3,He=(Le>>4)-1,Se=new Int8Array([He])[0],Tt=Ie(we,qe);vt.push({name:de,index:Se,type:Tt,compression:Ue}),Ft-=de.length+3}for(var xt=Hr.channels,bt=new Array(pe.channels),Pt=0;Pt<pe.channels;++Pt){var Bt=bt[Pt]={},Xt=xt[Pt];Bt.name=Xt.name,Bt.compression=0,Bt.decoded=!1,Bt.type=Xt.pixelType,Bt.pLinear=Xt.pLinear,Bt.width=pe.width,Bt.height=pe.lines}for(var Ot={idx:new Array(3)},Ht=0;Ht<pe.channels;++Ht)for(var Bt=bt[Ht],Pt=0;Pt<vt.length;++Pt){var Gt=vt[Pt];Bt.name==Gt.name&&(Bt.compression=Gt.compression,Gt.index>=0&&(Ot.idx[Gt.index]=Ht),Bt.offset=Ht)}if(yt.acCompressedSize>0)switch(yt.acCompression){case 0:var Zt=new Uint16Array(yt.totalAcUncompressedCount);Te(pe.array,we,qe,yt.acCompressedSize,Zt,yt.totalAcUncompressedCount);break;case 1:var dn=pe.array.slice(qe.value,qe.value+yt.totalAcUncompressedCount),En=O2(dn),Zt=new Uint16Array(En.buffer);qe.value+=yt.totalAcUncompressedCount;break}if(yt.dcCompressedSize>0){var qt={array:pe.array,offset:qe,size:yt.dcCompressedSize},jn=new Uint16Array(Be(qt).buffer);qe.value+=yt.dcCompressedSize}if(yt.rleRawSize>0){var dn=pe.array.slice(qe.value,qe.value+yt.rleCompressedSize),En=O2(dn),wn=Ce(En.buffer);qe.value+=yt.rleCompressedSize}for(var Zn=0,Nn=new Array(bt.length),Pt=0;Pt<Nn.length;++Pt)Nn[Pt]=new Array;for(var Jt=0;Jt<pe.lines;++Jt)for(var On=0;On<bt.length;++On)Nn[On].push(Zn),Zn+=bt[On].width*pe.type*2;Pe(Ot,Nn,bt,Zt,jn,ut);for(var Pt=0;Pt<bt.length;++Pt){var Bt=bt[Pt];if(!Bt.decoded)switch(Bt.compression){case 2:for(var on=0,Un=0,Jt=0;Jt<pe.lines;++Jt){for(var mr=Nn[Pt][on],Bn=0;Bn<Bt.width;++Bn){for(var sr=0;sr<2*Bt.type;++sr)ut[mr++]=wn[Un+sr*Bt.width*Bt.height];Un++}on++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(ut.buffer)}function q(pe,we){for(var qe=new Uint8Array(pe),ut=0;qe[we.value+ut]!=0;)ut+=1;var yt=new TextDecoder().decode(qe.slice(we.value,we.value+ut));return we.value=we.value+ut+1,yt}function xe(pe,we,qe){var ut=new TextDecoder().decode(new Uint8Array(pe).slice(we.value,we.value+qe));return we.value=we.value+qe,ut}function be(pe,we){var qe=$e(pe,we),ut=st(pe,we);return[qe,ut]}function De(pe,we){var qe=st(pe,we),ut=st(pe,we);return[qe,ut]}function $e(pe,we){var qe=pe.getInt32(we.value,!0);return we.value=we.value+4,qe}function st(pe,we){var qe=pe.getUint32(we.value,!0);return we.value=we.value+4,qe}function it(pe,we){var qe=pe[we.value];return we.value=we.value+1,qe}function Ie(pe,we){var qe=pe.getUint8(we.value);return we.value=we.value+1,qe}const Ye=function(pe,we){let qe;return"getBigInt64"in DataView.prototype?qe=Number(pe.getBigInt64(we.value,!0)):qe=pe.getUint32(we.value+4,!0)+Number(pe.getUint32(we.value,!0)<<32),we.value+=8,qe};function at(pe,we){var qe=pe.getFloat32(we.value,!0);return we.value+=4,qe}function ke(pe,we){return vd.toHalfFloat(at(pe,we))}function Xe(pe){var we=(pe&31744)>>10,qe=pe&1023;return(pe>>15?-1:1)*(we?we===31?qe?NaN:1/0:Math.pow(2,we-15)*(1+qe/1024):6103515625e-14*(qe/1024))}function Qe(pe,we){var qe=pe.getUint16(we.value,!0);return we.value+=2,qe}function _t(pe,we){return Xe(Qe(pe,we))}function kt(pe,we,qe,ut){for(var yt=qe.value,vt=[];qe.value<yt+ut-1;){var Ft=q(we,qe),de=$e(pe,qe),Le=Ie(pe,qe);qe.value+=3;var Ue=$e(pe,qe),He=$e(pe,qe);vt.push({name:Ft,pixelType:de,pLinear:Le,xSampling:Ue,ySampling:He})}return qe.value+=1,vt}function Ct(pe,we){var qe=at(pe,we),ut=at(pe,we),yt=at(pe,we),vt=at(pe,we),Ft=at(pe,we),de=at(pe,we),Le=at(pe,we),Ue=at(pe,we);return{redX:qe,redY:ut,greenX:yt,greenY:vt,blueX:Ft,blueY:de,whiteX:Le,whiteY:Ue}}function Kt(pe,we){var qe=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],ut=Ie(pe,we);return qe[ut]}function cn(pe,we){var qe=st(pe,we),ut=st(pe,we),yt=st(pe,we),vt=st(pe,we);return{xMin:qe,yMin:ut,xMax:yt,yMax:vt}}function sn(pe,we){var qe=["INCREASING_Y"],ut=Ie(pe,we);return qe[ut]}function Vt(pe,we){var qe=at(pe,we),ut=at(pe,we);return[qe,ut]}function Gn(pe,we){var qe=at(pe,we),ut=at(pe,we),yt=at(pe,we);return[qe,ut,yt]}function rr(pe,we,qe,ut,yt){if(ut==="string"||ut==="stringvector"||ut==="iccProfile")return xe(we,qe,yt);if(ut==="chlist")return kt(pe,we,qe,yt);if(ut==="chromaticities")return Ct(pe,qe);if(ut==="compression")return Kt(pe,qe);if(ut==="box2i")return cn(pe,qe);if(ut==="lineOrder")return sn(pe,qe);if(ut==="float")return at(pe,qe);if(ut==="v2f")return Vt(pe,qe);if(ut==="v3f")return Gn(pe,qe);if(ut==="int")return $e(pe,qe);if(ut==="rational")return be(pe,qe);if(ut==="timecode")return De(pe,qe);if(ut==="preview")return qe.value+=yt,"skipped";qe.value+=yt}function Cr(pe,we,qe){const ut={};if(pe.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";ut.version=pe.getUint8(4);const yt=pe.getUint8(5);ut.spec={singleTile:!!(yt&2),longName:!!(yt&4),deepFormat:!!(yt&8),multiPart:!!(yt&16)},qe.value=8;for(var vt=!0;vt;){var Ft=q(we,qe);if(Ft==0)vt=!1;else{var de=q(we,qe),Le=st(pe,qe),Ue=rr(pe,we,qe,de,Le);Ue===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${de}'.`):ut[Ft]=Ue}}if(yt&-5)throw console.error("EXRHeader:",ut),"THREE.EXRLoader: provided file is currently unsupported.";return ut}function wi(pe,we,qe,ut,yt){const vt={size:0,viewer:we,array:qe,offset:ut,width:pe.dataWindow.xMax-pe.dataWindow.xMin+1,height:pe.dataWindow.yMax-pe.dataWindow.yMin+1,channels:pe.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:pe.channels[0].pixelType,uncompress:null,getter:null,format:null,[tg?"colorSpace":"encoding"]:null};switch(pe.compression){case"NO_COMPRESSION":vt.lines=1,vt.uncompress=ve;break;case"RLE_COMPRESSION":vt.lines=1,vt.uncompress=Me;break;case"ZIPS_COMPRESSION":vt.lines=1,vt.uncompress=Be;break;case"ZIP_COMPRESSION":vt.lines=16,vt.uncompress=Be;break;case"PIZ_COMPRESSION":vt.lines=32,vt.uncompress=Ze;break;case"PXR24_COMPRESSION":vt.lines=16,vt.uncompress=F;break;case"DWAA_COMPRESSION":vt.lines=32,vt.uncompress=Z;break;case"DWAB_COMPRESSION":vt.lines=256,vt.uncompress=Z;break;default:throw"EXRLoader.parse: "+pe.compression+" is unsupported"}if(vt.scanlineBlockSize=vt.lines,vt.type==1)switch(yt){case pr:vt.getter=_t,vt.inputSize=2;break;case ti:vt.getter=Qe,vt.inputSize=2;break}else if(vt.type==2)switch(yt){case pr:vt.getter=at,vt.inputSize=4;break;case ti:vt.getter=ke,vt.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+vt.type+" for "+pe.compression+".";vt.blockCount=(pe.dataWindow.yMax+1)/vt.scanlineBlockSize;for(var Ft=0;Ft<vt.blockCount;Ft++)Ye(we,ut);vt.outputChannels=vt.channels==3?4:vt.channels;const de=vt.width*vt.height*vt.outputChannels;switch(yt){case pr:vt.byteArray=new Float32Array(de),vt.channels<vt.outputChannels&&vt.byteArray.fill(1,0,de);break;case ti:vt.byteArray=new Uint16Array(de),vt.channels<vt.outputChannels&&vt.byteArray.fill(15360,0,de);break;default:console.error("THREE.EXRLoader: unsupported type: ",yt);break}return vt.bytesPerLine=vt.width*vt.inputSize*vt.channels,vt.outputChannels==4?vt.format=Pr:vt.format=Yc,tg?vt.colorSpace="srgb-linear":vt.encoding=3e3,vt}const zr=new DataView(e),mi=new Uint8Array(e),gi={value:0},Hr=Cr(zr,e,gi),An=wi(Hr,zr,mi,gi,this.type),kr={value:0},Wi={R:0,G:1,B:2,A:3,Y:0};for(let pe=0;pe<An.height/An.scanlineBlockSize;pe++){const we=st(zr,gi);An.size=st(zr,gi),An.lines=we+An.scanlineBlockSize>An.height?An.height-we:An.scanlineBlockSize;const ut=An.size<An.lines*An.bytesPerLine?An.uncompress(An):ve(An);gi.value+=An.size;for(let yt=0;yt<An.scanlineBlockSize;yt++){const vt=yt+pe*An.scanlineBlockSize;if(vt>=An.height)break;for(let Ft=0;Ft<An.channels;Ft++){const de=Wi[Hr.channels[Ft].name];for(let Le=0;Le<An.width;Le++){kr.value=(yt*(An.channels*An.width)+Ft*An.width+Le)*An.inputSize;const Ue=(An.height-1-vt)*(An.width*An.outputChannels)+Le*An.outputChannels+de;An.byteArray[Ue]=An.getter(ut,kr)}}}}return{header:Hr,width:An.width,height:An.height,data:An.byteArray,format:An.format,[tg?"colorSpace":"encoding"]:An[tg?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,n,r,i){function s(o,a){tg?o.colorSpace=a.colorSpace:o.encoding=a.encoding,o.minFilter=Pn,o.magFilter=Pn,o.generateMipmaps=!1,o.flipY=!1,n&&n(o,a)}return super.load(e,s,r,i)}}const mde="srgb";class m1 extends Br{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,n,r,i){const s=this,o=new qr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(a))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const n=this;function r(te,W){if(te.nodeType!==1)return;const X=w(te);let J=!1,oe=null;switch(te.nodeName){case"svg":W=p(te,W);break;case"style":s(te);break;case"g":W=p(te,W);break;case"path":W=p(te,W),te.hasAttribute("d")&&(oe=i(te));break;case"rect":W=p(te,W),oe=l(te);break;case"polygon":W=p(te,W),oe=c(te);break;case"polyline":W=p(te,W),oe=u(te);break;case"circle":W=p(te,W),oe=f(te);break;case"ellipse":W=p(te,W),oe=d(te);break;case"line":W=p(te,W),oe=h(te);break;case"defs":J=!0;break;case"use":W=p(te,W);const Te=(te.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),_e=te.viewportElement.getElementById(Te);_e?r(_e,W):console.warn("SVGLoader: 'use node' references non-existent node id: "+Te);break}oe&&(W.fill!==void 0&&W.fill!=="none"&&oe.color.setStyle(W.fill,mde),S(oe,P),k.push(oe),oe.userData={node:te,style:W});const Ee=te.childNodes;for(let me=0;me<Ee.length;me++){const Te=Ee[me];J&&Te.nodeName!=="style"&&Te.nodeName!=="defs"||r(Te,W)}X&&(N.pop(),N.length>0?P.copy(N[N.length-1]):P.identity())}function i(te){const W=new Dc,X=new Ke,J=new Ke,oe=new Ke;let Ee=!0,me=!1;const Te=te.getAttribute("d");if(Te===""||Te==="none")return null;const _e=Te.match(/[a-df-z][^a-df-z]*/gi);for(let Re=0,ae=_e.length;Re<ae;Re++){const Ce=_e[Re],Pe=Ce.charAt(0),Ve=Ce.slice(1).trim();Ee===!0&&(me=!0,Ee=!1);let ye;switch(Pe){case"M":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=2)X.x=ye[ge+0],X.y=ye[ge+1],J.x=X.x,J.y=X.y,ge===0?W.moveTo(X.x,X.y):W.lineTo(X.x,X.y),ge===0&&oe.copy(X);break;case"H":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge++)X.x=ye[ge],J.x=X.x,J.y=X.y,W.lineTo(X.x,X.y),ge===0&&me===!0&&oe.copy(X);break;case"V":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge++)X.y=ye[ge],J.x=X.x,J.y=X.y,W.lineTo(X.x,X.y),ge===0&&me===!0&&oe.copy(X);break;case"L":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=2)X.x=ye[ge+0],X.y=ye[ge+1],J.x=X.x,J.y=X.y,W.lineTo(X.x,X.y),ge===0&&me===!0&&oe.copy(X);break;case"C":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=6)W.bezierCurveTo(ye[ge+0],ye[ge+1],ye[ge+2],ye[ge+3],ye[ge+4],ye[ge+5]),J.x=ye[ge+2],J.y=ye[ge+3],X.x=ye[ge+4],X.y=ye[ge+5],ge===0&&me===!0&&oe.copy(X);break;case"S":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=4)W.bezierCurveTo(m(X.x,J.x),m(X.y,J.y),ye[ge+0],ye[ge+1],ye[ge+2],ye[ge+3]),J.x=ye[ge+0],J.y=ye[ge+1],X.x=ye[ge+2],X.y=ye[ge+3],ge===0&&me===!0&&oe.copy(X);break;case"Q":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=4)W.quadraticCurveTo(ye[ge+0],ye[ge+1],ye[ge+2],ye[ge+3]),J.x=ye[ge+0],J.y=ye[ge+1],X.x=ye[ge+2],X.y=ye[ge+3],ge===0&&me===!0&&oe.copy(X);break;case"T":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=2){const fe=m(X.x,J.x),ie=m(X.y,J.y);W.quadraticCurveTo(fe,ie,ye[ge+0],ye[ge+1]),J.x=fe,J.y=ie,X.x=ye[ge+0],X.y=ye[ge+1],ge===0&&me===!0&&oe.copy(X)}break;case"A":ye=g(Ve,[3,4],7);for(let ge=0,ze=ye.length;ge<ze;ge+=7){if(ye[ge+5]==X.x&&ye[ge+6]==X.y)continue;const fe=X.clone();X.x=ye[ge+5],X.y=ye[ge+6],J.x=X.x,J.y=X.y,o(W,ye[ge],ye[ge+1],ye[ge+2],ye[ge+3],ye[ge+4],fe,X),ge===0&&me===!0&&oe.copy(X)}break;case"m":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=2)X.x+=ye[ge+0],X.y+=ye[ge+1],J.x=X.x,J.y=X.y,ge===0?W.moveTo(X.x,X.y):W.lineTo(X.x,X.y),ge===0&&oe.copy(X);break;case"h":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge++)X.x+=ye[ge],J.x=X.x,J.y=X.y,W.lineTo(X.x,X.y),ge===0&&me===!0&&oe.copy(X);break;case"v":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge++)X.y+=ye[ge],J.x=X.x,J.y=X.y,W.lineTo(X.x,X.y),ge===0&&me===!0&&oe.copy(X);break;case"l":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=2)X.x+=ye[ge+0],X.y+=ye[ge+1],J.x=X.x,J.y=X.y,W.lineTo(X.x,X.y),ge===0&&me===!0&&oe.copy(X);break;case"c":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=6)W.bezierCurveTo(X.x+ye[ge+0],X.y+ye[ge+1],X.x+ye[ge+2],X.y+ye[ge+3],X.x+ye[ge+4],X.y+ye[ge+5]),J.x=X.x+ye[ge+2],J.y=X.y+ye[ge+3],X.x+=ye[ge+4],X.y+=ye[ge+5],ge===0&&me===!0&&oe.copy(X);break;case"s":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=4)W.bezierCurveTo(m(X.x,J.x),m(X.y,J.y),X.x+ye[ge+0],X.y+ye[ge+1],X.x+ye[ge+2],X.y+ye[ge+3]),J.x=X.x+ye[ge+0],J.y=X.y+ye[ge+1],X.x+=ye[ge+2],X.y+=ye[ge+3],ge===0&&me===!0&&oe.copy(X);break;case"q":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=4)W.quadraticCurveTo(X.x+ye[ge+0],X.y+ye[ge+1],X.x+ye[ge+2],X.y+ye[ge+3]),J.x=X.x+ye[ge+0],J.y=X.y+ye[ge+1],X.x+=ye[ge+2],X.y+=ye[ge+3],ge===0&&me===!0&&oe.copy(X);break;case"t":ye=g(Ve);for(let ge=0,ze=ye.length;ge<ze;ge+=2){const fe=m(X.x,J.x),ie=m(X.y,J.y);W.quadraticCurveTo(fe,ie,X.x+ye[ge+0],X.y+ye[ge+1]),J.x=fe,J.y=ie,X.x=X.x+ye[ge+0],X.y=X.y+ye[ge+1],ge===0&&me===!0&&oe.copy(X)}break;case"a":ye=g(Ve,[3,4],7);for(let ge=0,ze=ye.length;ge<ze;ge+=7){if(ye[ge+5]==0&&ye[ge+6]==0)continue;const fe=X.clone();X.x+=ye[ge+5],X.y+=ye[ge+6],J.x=X.x,J.y=X.y,o(W,ye[ge],ye[ge+1],ye[ge+2],ye[ge+3],ye[ge+4],fe,X),ge===0&&me===!0&&oe.copy(X)}break;case"Z":case"z":W.currentPath.autoClose=!0,W.currentPath.curves.length>0&&(X.copy(oe),W.currentPath.currentPoint.copy(X),Ee=!0);break;default:console.warn(Ce)}me=!1}return W}function s(te){if(!(!te.sheet||!te.sheet.cssRules||!te.sheet.cssRules.length))for(let W=0;W<te.sheet.cssRules.length;W++){const X=te.sheet.cssRules[W];if(X.type!==1)continue;const J=X.selectorText.split(/,/gm).filter(Boolean).map(oe=>oe.trim());for(let oe=0;oe<J.length;oe++){const Ee=Object.fromEntries(Object.entries(X.style).filter(([,me])=>me!==""));L[J[oe]]=Object.assign(L[J[oe]]||{},Ee)}}}function o(te,W,X,J,oe,Ee,me,Te){if(W==0||X==0){te.lineTo(Te.x,Te.y);return}J=J*Math.PI/180,W=Math.abs(W),X=Math.abs(X);const _e=(me.x-Te.x)/2,Re=(me.y-Te.y)/2,ae=Math.cos(J)*_e+Math.sin(J)*Re,Ce=-Math.sin(J)*_e+Math.cos(J)*Re;let Pe=W*W,Ve=X*X;const ye=ae*ae,ge=Ce*Ce,ze=ye/Pe+ge/Ve;if(ze>1){const xe=Math.sqrt(ze);W=xe*W,X=xe*X,Pe=W*W,Ve=X*X}const fe=Pe*ge+Ve*ye,ie=(Pe*Ve-fe)/fe;let ve=Math.sqrt(Math.max(0,ie));oe===Ee&&(ve=-ve);const Me=ve*W*Ce/X,Be=-ve*X*ae/W,Ze=Math.cos(J)*Me-Math.sin(J)*Be+(me.x+Te.x)/2,F=Math.sin(J)*Me+Math.cos(J)*Be+(me.y+Te.y)/2,Z=a(1,0,(ae-Me)/W,(Ce-Be)/X),q=a((ae-Me)/W,(Ce-Be)/X,(-ae-Me)/W,(-Ce-Be)/X)%(Math.PI*2);te.currentPath.absellipse(Ze,F,W,X,Z,Z+q,Ee===0,J)}function a(te,W,X,J){const oe=te*X+W*J,Ee=Math.sqrt(te*te+W*W)*Math.sqrt(X*X+J*J);let me=Math.acos(Math.max(-1,Math.min(1,oe/Ee)));return te*J-W*X<0&&(me=-me),me}function l(te){const W=_(te.getAttribute("x")||0),X=_(te.getAttribute("y")||0),J=_(te.getAttribute("rx")||te.getAttribute("ry")||0),oe=_(te.getAttribute("ry")||te.getAttribute("rx")||0),Ee=_(te.getAttribute("width")),me=_(te.getAttribute("height")),Te=1-.551915024494,_e=new Dc;return _e.moveTo(W+J,X),_e.lineTo(W+Ee-J,X),(J!==0||oe!==0)&&_e.bezierCurveTo(W+Ee-J*Te,X,W+Ee,X+oe*Te,W+Ee,X+oe),_e.lineTo(W+Ee,X+me-oe),(J!==0||oe!==0)&&_e.bezierCurveTo(W+Ee,X+me-oe*Te,W+Ee-J*Te,X+me,W+Ee-J,X+me),_e.lineTo(W+J,X+me),(J!==0||oe!==0)&&_e.bezierCurveTo(W+J*Te,X+me,W,X+me-oe*Te,W,X+me-oe),_e.lineTo(W,X+oe),(J!==0||oe!==0)&&_e.bezierCurveTo(W,X+oe*Te,W+J*Te,X,W+J,X),_e}function c(te){function W(Ee,me,Te){const _e=_(me),Re=_(Te);oe===0?J.moveTo(_e,Re):J.lineTo(_e,Re),oe++}const X=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,J=new Dc;let oe=0;return te.getAttribute("points").replace(X,W),J.currentPath.autoClose=!0,J}function u(te){function W(Ee,me,Te){const _e=_(me),Re=_(Te);oe===0?J.moveTo(_e,Re):J.lineTo(_e,Re),oe++}const X=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,J=new Dc;let oe=0;return te.getAttribute("points").replace(X,W),J.currentPath.autoClose=!1,J}function f(te){const W=_(te.getAttribute("cx")||0),X=_(te.getAttribute("cy")||0),J=_(te.getAttribute("r")||0),oe=new of;oe.absarc(W,X,J,0,Math.PI*2);const Ee=new Dc;return Ee.subPaths.push(oe),Ee}function d(te){const W=_(te.getAttribute("cx")||0),X=_(te.getAttribute("cy")||0),J=_(te.getAttribute("rx")||0),oe=_(te.getAttribute("ry")||0),Ee=new of;Ee.absellipse(W,X,J,oe,0,Math.PI*2);const me=new Dc;return me.subPaths.push(Ee),me}function h(te){const W=_(te.getAttribute("x1")||0),X=_(te.getAttribute("y1")||0),J=_(te.getAttribute("x2")||0),oe=_(te.getAttribute("y2")||0),Ee=new Dc;return Ee.moveTo(W,X),Ee.lineTo(J,oe),Ee.currentPath.autoClose=!1,Ee}function p(te,W){W=Object.assign({},W);let X={};if(te.hasAttribute("class")){const me=te.getAttribute("class").split(/\s/).filter(Boolean).map(Te=>Te.trim());for(let Te=0;Te<me.length;Te++)X=Object.assign(X,L["."+me[Te]])}te.hasAttribute("id")&&(X=Object.assign(X,L["#"+te.getAttribute("id")]));function J(me,Te,_e){_e===void 0&&(_e=function(ae){return ae.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),ae}),te.hasAttribute(me)&&(W[Te]=_e(te.getAttribute(me))),X[me]&&(W[Te]=_e(X[me])),te.style&&te.style[me]!==""&&(W[Te]=_e(te.style[me]))}function oe(me){return Math.max(0,Math.min(1,_(me)))}function Ee(me){return Math.max(0,_(me))}return J("fill","fill"),J("fill-opacity","fillOpacity",oe),J("fill-rule","fillRule"),J("opacity","opacity",oe),J("stroke","stroke"),J("stroke-opacity","strokeOpacity",oe),J("stroke-width","strokeWidth",Ee),J("stroke-linejoin","strokeLineJoin"),J("stroke-linecap","strokeLineCap"),J("stroke-miterlimit","strokeMiterLimit",Ee),J("visibility","visibility"),W}function m(te,W){return te-(W-te)}function g(te,W,X){if(typeof te!="string")throw new TypeError("Invalid input: "+typeof te);const J={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},oe=0,Ee=1,me=2,Te=3;let _e=oe,Re=!0,ae="",Ce="";const Pe=[];function Ve(fe,ie,ve){const Me=new SyntaxError('Unexpected character "'+fe+'" at index '+ie+".");throw Me.partial=ve,Me}function ye(){ae!==""&&(Ce===""?Pe.push(Number(ae)):Pe.push(Number(ae)*Math.pow(10,Number(Ce)))),ae="",Ce=""}let ge;const ze=te.length;for(let fe=0;fe<ze;fe++){if(ge=te[fe],Array.isArray(W)&&W.includes(Pe.length%X)&&J.FLAGS.test(ge)){_e=Ee,ae=ge,ye();continue}if(_e===oe){if(J.WHITESPACE.test(ge))continue;if(J.DIGIT.test(ge)||J.SIGN.test(ge)){_e=Ee,ae=ge;continue}if(J.POINT.test(ge)){_e=me,ae=ge;continue}J.COMMA.test(ge)&&(Re&&Ve(ge,fe,Pe),Re=!0)}if(_e===Ee){if(J.DIGIT.test(ge)){ae+=ge;continue}if(J.POINT.test(ge)){ae+=ge,_e=me;continue}if(J.EXP.test(ge)){_e=Te;continue}J.SIGN.test(ge)&&ae.length===1&&J.SIGN.test(ae[0])&&Ve(ge,fe,Pe)}if(_e===me){if(J.DIGIT.test(ge)){ae+=ge;continue}if(J.EXP.test(ge)){_e=Te;continue}J.POINT.test(ge)&&ae[ae.length-1]==="."&&Ve(ge,fe,Pe)}if(_e===Te){if(J.DIGIT.test(ge)){Ce+=ge;continue}if(J.SIGN.test(ge)){if(Ce===""){Ce+=ge;continue}Ce.length===1&&J.SIGN.test(Ce)&&Ve(ge,fe,Pe)}}J.WHITESPACE.test(ge)?(ye(),_e=oe,Re=!1):J.COMMA.test(ge)?(ye(),_e=oe,Re=!0):J.SIGN.test(ge)?(ye(),_e=Ee,ae=ge):J.POINT.test(ge)?(ye(),_e=me,ae=ge):Ve(ge,fe,Pe)}return ye(),Pe}const y=["mm","cm","in","pt","pc","px"],x={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function _(te){let W="px";if(typeof te=="string"||te instanceof String)for(let J=0,oe=y.length;J<oe;J++){const Ee=y[J];if(te.endsWith(Ee)){W=Ee,te=te.substring(0,te.length-Ee.length);break}}let X;return W==="px"&&n.defaultUnit!=="px"?X=x.in[n.defaultUnit]/n.defaultDPI:(X=x[W][n.defaultUnit],X<0&&(X=x[W].in*n.defaultDPI)),X*parseFloat(te)}function w(te){if(!(te.hasAttribute("transform")||te.nodeName==="use"&&(te.hasAttribute("x")||te.hasAttribute("y"))))return null;const W=T(te);return N.length>0&&W.premultiply(N[N.length-1]),P.copy(W),N.push(W),W}function T(te){const W=new Ln,X=z;if(te.nodeName==="use"&&(te.hasAttribute("x")||te.hasAttribute("y"))){const J=_(te.getAttribute("x")),oe=_(te.getAttribute("y"));W.translate(J,oe)}if(te.hasAttribute("transform")){const J=te.getAttribute("transform").split(")");for(let oe=J.length-1;oe>=0;oe--){const Ee=J[oe].trim();if(Ee==="")continue;const me=Ee.indexOf("("),Te=Ee.length;if(me>0&&me<Te){const _e=Ee.slice(0,me),Re=g(Ee.slice(me+1));switch(X.identity(),_e){case"translate":if(Re.length>=1){const ae=Re[0];let Ce=0;Re.length>=2&&(Ce=Re[1]),X.translate(ae,Ce)}break;case"rotate":if(Re.length>=1){let ae=0,Ce=0,Pe=0;ae=Re[0]*Math.PI/180,Re.length>=3&&(Ce=Re[1],Pe=Re[2]),O.makeTranslation(-Ce,-Pe),K.makeRotation(ae),V.multiplyMatrices(K,O),O.makeTranslation(Ce,Pe),X.multiplyMatrices(O,V)}break;case"scale":if(Re.length>=1){const ae=Re[0];let Ce=ae;Re.length>=2&&(Ce=Re[1]),X.scale(ae,Ce)}break;case"skewX":Re.length===1&&X.set(1,Math.tan(Re[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":Re.length===1&&X.set(1,0,0,Math.tan(Re[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":Re.length===6&&X.set(Re[0],Re[2],Re[4],Re[1],Re[3],Re[5],0,0,1);break}}W.premultiply(X)}}return W}function S(te,W){function X(me){re.set(me.x,me.y,1).applyMatrix3(W),me.set(re.x,re.y)}function J(me){const Te=me.xRadius,_e=me.yRadius,Re=Math.cos(me.aRotation),ae=Math.sin(me.aRotation),Ce=new $(Te*Re,Te*ae,0),Pe=new $(-_e*ae,_e*Re,0),Ve=Ce.applyMatrix3(W),ye=Pe.applyMatrix3(W),ge=z.set(Ve.x,ye.x,0,Ve.y,ye.y,0,0,0,1),ze=O.copy(ge).invert(),ve=K.copy(ze).transpose().multiply(ze).elements,Me=D(ve[0],ve[1],ve[4]),Be=Math.sqrt(Me.rt1),Ze=Math.sqrt(Me.rt2);if(me.xRadius=1/Be,me.yRadius=1/Ze,me.aRotation=Math.atan2(Me.sn,Me.cs),!((me.aEndAngle-me.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const Z=O.set(Be,0,0,0,Ze,0,0,0,1),q=K.set(Me.cs,Me.sn,0,-Me.sn,Me.cs,0,0,0,1),xe=Z.multiply(q).multiply(ge),be=De=>{const{x:$e,y:st}=new $(Math.cos(De),Math.sin(De),0).applyMatrix3(xe);return Math.atan2(st,$e)};me.aStartAngle=be(me.aStartAngle),me.aEndAngle=be(me.aEndAngle),C(W)&&(me.aClockwise=!me.aClockwise)}}function oe(me){const Te=R(W),_e=M(W);me.xRadius*=Te,me.yRadius*=_e;const Re=Te>Number.EPSILON?Math.atan2(W.elements[1],W.elements[0]):Math.atan2(-W.elements[3],W.elements[4]);me.aRotation+=Re,C(W)&&(me.aStartAngle*=-1,me.aEndAngle*=-1,me.aClockwise=!me.aClockwise)}const Ee=te.subPaths;for(let me=0,Te=Ee.length;me<Te;me++){const Re=Ee[me].curves;for(let ae=0;ae<Re.length;ae++){const Ce=Re[ae];Ce.isLineCurve?(X(Ce.v1),X(Ce.v2)):Ce.isCubicBezierCurve?(X(Ce.v0),X(Ce.v1),X(Ce.v2),X(Ce.v3)):Ce.isQuadraticBezierCurve?(X(Ce.v0),X(Ce.v1),X(Ce.v2)):Ce.isEllipseCurve&&(ne.set(Ce.aX,Ce.aY),X(ne),Ce.aX=ne.x,Ce.aY=ne.y,A(W)?J(Ce):oe(Ce))}}}function C(te){const W=te.elements;return W[0]*W[4]-W[1]*W[3]<0}function A(te){const W=te.elements,X=W[0]*W[3]+W[1]*W[4];if(X===0)return!1;const J=R(te),oe=M(te);return Math.abs(X/(J*oe))>Number.EPSILON}function R(te){const W=te.elements;return Math.sqrt(W[0]*W[0]+W[1]*W[1])}function M(te){const W=te.elements;return Math.sqrt(W[3]*W[3]+W[4]*W[4])}function D(te,W,X){let J,oe,Ee,me,Te;const _e=te+X,Re=te-X,ae=Math.sqrt(Re*Re+4*W*W);return _e>0?(J=.5*(_e+ae),Te=1/J,oe=te*Te*X-W*Te*W):_e<0?oe=.5*(_e-ae):(J=.5*ae,oe=-.5*ae),Re>0?Ee=Re+ae:Ee=Re-ae,Math.abs(Ee)>2*Math.abs(W)?(Te=-2*W/Ee,me=1/Math.sqrt(1+Te*Te),Ee=Te*me):Math.abs(W)===0?(Ee=1,me=0):(Te=-.5*Ee/W,Ee=1/Math.sqrt(1+Te*Te),me=Te*Ee),Re>0&&(Te=Ee,Ee=-me,me=Te),{rt1:J,rt2:oe,cs:Ee,sn:me}}const k=[],L={},N=[],z=new Ln,O=new Ln,K=new Ln,V=new Ln,ne=new Ke,re=new $,P=new Ln,se=new DOMParser().parseFromString(e,"image/svg+xml");return r(se.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:k,xml:se.documentElement}}static createShapes(e){const r={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},i={loc:r.ORIGIN,t:0};function s(m,g,y,x){const _=m.x,w=g.x,T=y.x,S=x.x,C=m.y,A=g.y,R=y.y,M=x.y,D=(S-T)*(C-R)-(M-R)*(_-T),k=(w-_)*(C-R)-(A-C)*(_-T),L=(M-R)*(w-_)-(S-T)*(A-C),N=D/L,z=k/L;if(L===0&&D!==0||N<=0||N>=1||z<0||z>1)return null;if(D===0&&L===0){for(let O=0;O<2;O++)if(o(O===0?y:x,m,g),i.loc==r.ORIGIN){const K=O===0?y:x;return{x:K.x,y:K.y,t:i.t}}else if(i.loc==r.BETWEEN){const K=+(_+i.t*(w-_)).toPrecision(10),V=+(C+i.t*(A-C)).toPrecision(10);return{x:K,y:V,t:i.t}}return null}else{for(let V=0;V<2;V++)if(o(V===0?y:x,m,g),i.loc==r.ORIGIN){const ne=V===0?y:x;return{x:ne.x,y:ne.y,t:i.t}}const O=+(_+N*(w-_)).toPrecision(10),K=+(C+N*(A-C)).toPrecision(10);return{x:O,y:K,t:N}}}function o(m,g,y){const x=y.x-g.x,_=y.y-g.y,w=m.x-g.x,T=m.y-g.y,S=x*T-w*_;if(m.x===g.x&&m.y===g.y){i.loc=r.ORIGIN,i.t=0;return}if(m.x===y.x&&m.y===y.y){i.loc=r.DESTINATION,i.t=1;return}if(S<-Number.EPSILON){i.loc=r.LEFT;return}if(S>Number.EPSILON){i.loc=r.RIGHT;return}if(x*w<0||_*T<0){i.loc=r.BEHIND;return}if(Math.sqrt(x*x+_*_)<Math.sqrt(w*w+T*T)){i.loc=r.BEYOND;return}let C;x!==0?C=w/x:C=T/_,i.loc=r.BETWEEN,i.t=C}function a(m,g){const y=[],x=[];for(let _=1;_<m.length;_++){const w=m[_-1],T=m[_];for(let S=1;S<g.length;S++){const C=g[S-1],A=g[S],R=s(w,T,C,A);R!==null&&y.find(M=>M.t<=R.t+Number.EPSILON&&M.t>=R.t-Number.EPSILON)===void 0&&(y.push(R),x.push(new Ke(R.x,R.y)))}}return x}function l(m,g,y){const x=new Ke;g.getCenter(x);const _=[];return y.forEach(w=>{w.boundingBox.containsPoint(x)&&a(m,w.points).forEach(S=>{_.push({identifier:w.identifier,isCW:w.isCW,point:S})})}),_.sort((w,T)=>w.point.x-T.point.x),_}function c(m,g,y,x,_){(_==null||_==="")&&(_="nonzero");const w=new Ke;m.boundingBox.getCenter(w);const T=[new Ke(y,w.y),new Ke(x,w.y)],S=l(T,m.boundingBox,g);S.sort((k,L)=>k.point.x-L.point.x);const C=[],A=[];S.forEach(k=>{k.identifier===m.identifier?C.push(k):A.push(k)});const R=C[0].point.x,M=[];let D=0;for(;D<A.length&&A[D].point.x<R;)M.length>0&&M[M.length-1]===A[D].identifier?M.pop():M.push(A[D].identifier),D++;if(M.push(m.identifier),_==="evenodd"){const k=M.length%2===0,L=M[M.length-2];return{identifier:m.identifier,isHole:k,for:L}}else if(_==="nonzero"){let k=!0,L=null,N=null;for(let z=0;z<M.length;z++){const O=M[z];k?(N=g[O].isCW,k=!1,L=O):N!==g[O].isCW&&(N=g[O].isCW,k=!0)}return{identifier:m.identifier,isHole:k,for:L}}else console.warn('fill-rule: "'+_+'" is currently not implemented.')}let u=999999999,f=-999999999,d=e.subPaths.map(m=>{const g=m.getPoints();let y=-999999999,x=999999999,_=-999999999,w=999999999;for(let T=0;T<g.length;T++){const S=g[T];S.y>y&&(y=S.y),S.y<x&&(x=S.y),S.x>_&&(_=S.x),S.x<w&&(w=S.x)}return f<=_&&(f=_+1),u>=w&&(u=w-1),{curves:m.curves,points:g,isCW:vl.isClockWise(g),identifier:-1,boundingBox:new W6(new Ke(w,x),new Ke(_,y))}});d=d.filter(m=>m.points.length>1);for(let m=0;m<d.length;m++)d[m].identifier=m;const h=d.map(m=>c(m,d,u,f,e.userData?e.userData.style.fillRule:void 0)),p=[];return d.forEach(m=>{if(!h[m.identifier].isHole){const y=new tc;y.curves=m.curves,h.filter(_=>_.isHole&&_.for===m.identifier).forEach(_=>{const w=d[_.identifier],T=new of;T.curves=w.curves,y.holes.push(T)}),p.push(y)}}),p}static getStrokeStyle(e,n,r,i,s){return e=e!==void 0?e:1,n=n!==void 0?n:"#000",r=r!==void 0?r:"miter",i=i!==void 0?i:"butt",s=s!==void 0?s:4,{strokeColor:n,strokeWidth:e,strokeLineJoin:r,strokeLineCap:i,strokeMiterLimit:s}}static pointsToStroke(e,n,r,i){const s=[],o=[],a=[];if(m1.pointsToStrokeWithBuffers(e,n,r,i,s,o,a)===0)return null;const l=new gn;return l.setAttribute("position",new Dt(s,3)),l.setAttribute("normal",new Dt(o,3)),l.setAttribute("uv",new Dt(a,2)),l}static pointsToStrokeWithBuffers(e,n,r,i,s,o,a,l){const c=new Ke,u=new Ke,f=new Ke,d=new Ke,h=new Ke,p=new Ke,m=new Ke,g=new Ke,y=new Ke,x=new Ke,_=new Ke,w=new Ke,T=new Ke,S=new Ke,C=new Ke,A=new Ke,R=new Ke;r=r!==void 0?r:12,i=i!==void 0?i:.001,l=l!==void 0?l:0,e=Re(e);const M=e.length;if(M<2)return 0;const D=e[0].equals(e[M-1]);let k,L=e[0],N;const z=n.strokeWidth/2,O=1/(M-1);let K=0,V,ne,re,P,se=!1,ue=0,te=l*3,W=l*2;X(e[0],e[1],c).multiplyScalar(z),g.copy(e[0]).sub(c),y.copy(e[0]).add(c),x.copy(g),_.copy(y);for(let ae=1;ae<M;ae++){k=e[ae],ae===M-1?D?N=e[1]:N=void 0:N=e[ae+1];const Ce=c;if(X(L,k,Ce),f.copy(Ce).multiplyScalar(z),w.copy(k).sub(f),T.copy(k).add(f),V=K+O,ne=!1,N!==void 0){X(k,N,u),f.copy(u).multiplyScalar(z),S.copy(k).sub(f),C.copy(k).add(f),re=!0,f.subVectors(N,L),Ce.dot(f)<0&&(re=!1),ae===1&&(se=re),f.subVectors(N,k),f.normalize();const Pe=Math.abs(Ce.dot(f));if(Pe>Number.EPSILON){const Ve=z/Pe;f.multiplyScalar(-Ve),d.subVectors(k,L),h.copy(d).setLength(Ve).add(f),A.copy(h).negate();const ye=h.length(),ge=d.length();d.divideScalar(ge),p.subVectors(N,k);const ze=p.length();switch(p.divideScalar(ze),d.dot(A)<ge&&p.dot(A)<ze&&(ne=!0),R.copy(h).add(k),A.add(k),P=!1,ne?re?(C.copy(A),T.copy(A)):(S.copy(A),w.copy(A)):Ee(),n.strokeLineJoin){case"bevel":me(re,ne,V);break;case"round":Te(re,ne),re?oe(k,w,S,V,0):oe(k,C,T,V,1);break;case"miter":case"miter-clip":default:const fe=z*n.strokeMiterLimit/ye;if(fe<1)if(n.strokeLineJoin!=="miter-clip"){me(re,ne,V);break}else Te(re,ne),re?(p.subVectors(R,w).multiplyScalar(fe).add(w),m.subVectors(R,S).multiplyScalar(fe).add(S),J(w,V,0),J(p,V,0),J(k,V,.5),J(k,V,.5),J(p,V,0),J(m,V,0),J(k,V,.5),J(m,V,0),J(S,V,0)):(p.subVectors(R,T).multiplyScalar(fe).add(T),m.subVectors(R,C).multiplyScalar(fe).add(C),J(T,V,1),J(p,V,1),J(k,V,.5),J(k,V,.5),J(p,V,1),J(m,V,1),J(k,V,.5),J(m,V,1),J(C,V,1));else ne?(re?(J(y,K,1),J(g,K,0),J(R,V,0),J(y,K,1),J(R,V,0),J(A,V,1)):(J(y,K,1),J(g,K,0),J(R,V,1),J(g,K,0),J(A,V,0),J(R,V,1)),re?S.copy(R):C.copy(R)):re?(J(w,V,0),J(R,V,0),J(k,V,.5),J(k,V,.5),J(R,V,0),J(S,V,0)):(J(T,V,1),J(R,V,1),J(k,V,.5),J(k,V,.5),J(R,V,1),J(C,V,1)),P=!0;break}}else Ee()}else Ee();!D&&ae===M-1&&_e(e[0],x,_,re,!0,K),K=V,L=k,g.copy(S),y.copy(C)}if(!D)_e(k,w,T,re,!1,V);else if(ne&&s){let ae=R,Ce=A;se!==re&&(ae=A,Ce=R),re?(P||se)&&(Ce.toArray(s,0*3),Ce.toArray(s,3*3),P&&ae.toArray(s,1*3)):(P||!se)&&(Ce.toArray(s,1*3),Ce.toArray(s,3*3),P&&ae.toArray(s,0*3))}return ue;function X(ae,Ce,Pe){return Pe.subVectors(Ce,ae),Pe.set(-Pe.y,Pe.x).normalize()}function J(ae,Ce,Pe){s&&(s[te]=ae.x,s[te+1]=ae.y,s[te+2]=0,o&&(o[te]=0,o[te+1]=0,o[te+2]=1),te+=3,a&&(a[W]=Ce,a[W+1]=Pe,W+=2)),ue+=3}function oe(ae,Ce,Pe,Ve,ye){c.copy(Ce).sub(ae).normalize(),u.copy(Pe).sub(ae).normalize();let ge=Math.PI;const ze=c.dot(u);Math.abs(ze)<1&&(ge=Math.abs(Math.acos(ze))),ge/=r,f.copy(Ce);for(let fe=0,ie=r-1;fe<ie;fe++)d.copy(f).rotateAround(ae,ge),J(f,Ve,ye),J(d,Ve,ye),J(ae,Ve,.5),f.copy(d);J(d,Ve,ye),J(Pe,Ve,ye),J(ae,Ve,.5)}function Ee(){J(y,K,1),J(g,K,0),J(w,V,0),J(y,K,1),J(w,V,0),J(T,V,1)}function me(ae,Ce,Pe){Ce?ae?(J(y,K,1),J(g,K,0),J(w,V,0),J(y,K,1),J(w,V,0),J(A,V,1),J(w,Pe,0),J(S,Pe,0),J(A,Pe,.5)):(J(y,K,1),J(g,K,0),J(T,V,1),J(g,K,0),J(A,V,0),J(T,V,1),J(T,Pe,1),J(A,Pe,0),J(C,Pe,1)):ae?(J(w,Pe,0),J(S,Pe,0),J(k,Pe,.5)):(J(T,Pe,1),J(C,Pe,0),J(k,Pe,.5))}function Te(ae,Ce){Ce&&(ae?(J(y,K,1),J(g,K,0),J(w,V,0),J(y,K,1),J(w,V,0),J(A,V,1),J(w,K,0),J(k,V,.5),J(A,V,1),J(k,V,.5),J(S,K,0),J(A,V,1)):(J(y,K,1),J(g,K,0),J(T,V,1),J(g,K,0),J(A,V,0),J(T,V,1),J(T,K,1),J(A,V,0),J(k,V,.5),J(k,V,.5),J(A,V,0),J(C,K,1)))}function _e(ae,Ce,Pe,Ve,ye,ge){switch(n.strokeLineCap){case"round":ye?oe(ae,Pe,Ce,ge,.5):oe(ae,Ce,Pe,ge,.5);break;case"square":if(ye)c.subVectors(Ce,ae),u.set(c.y,-c.x),f.addVectors(c,u).add(ae),d.subVectors(u,c).add(ae),Ve?(f.toArray(s,1*3),d.toArray(s,0*3),d.toArray(s,3*3)):(f.toArray(s,1*3),a[3*2+1]===1?d.toArray(s,3*3):f.toArray(s,3*3),d.toArray(s,0*3));else{c.subVectors(Pe,ae),u.set(c.y,-c.x),f.addVectors(c,u).add(ae),d.subVectors(u,c).add(ae);const ze=s.length;Ve?(f.toArray(s,ze-1*3),d.toArray(s,ze-2*3),d.toArray(s,ze-4*3)):(d.toArray(s,ze-2*3),f.toArray(s,ze-1*3),d.toArray(s,ze-4*3))}break}}function Re(ae){let Ce=!1;for(let Ve=1,ye=ae.length-1;Ve<ye;Ve++)if(ae[Ve].distanceTo(ae[Ve+1])<i){Ce=!0;break}if(!Ce)return ae;const Pe=[];Pe.push(ae[0]);for(let Ve=1,ye=ae.length-1;Ve<ye;Ve++)ae[Ve].distanceTo(ae[Ve+1])>=i&&Pe.push(ae[Ve]);return Pe.push(ae[ae.length-1]),Pe}}}const gde=/^[og]\s*(.+)?/,yde=/^mtllib /,vde=/^usemtl /,xde=/^usemap /,tk=new $,A4=new $,nk=new $,rk=new $,Aa=new $;function _de(){const t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,n){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=n!==!1;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:n!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(i,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:i||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:o!==void 0?o.smooth:this.smooth,groupStart:o!==void 0?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const c={index:typeof l=="number"?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(i){const s=this.currentMaterial();if(s&&s.groupEnd===-1&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),i&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return i&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),s}},r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,n){const r=parseInt(e,10);return(r>=0?r-1:r+n/3)*3},parseNormalIndex:function(e,n){const r=parseInt(e,10);return(r>=0?r-1:r+n/3)*3},parseUVIndex:function(e,n){const r=parseInt(e,10);return(r>=0?r-1:r+n/2)*2},addVertex:function(e,n,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])},addVertexPoint:function(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])},addVertexLine:function(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])},addNormal:function(e,n,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])},addFaceNormal:function(e,n,r){const i=this.vertices,s=this.object.geometry.normals;tk.fromArray(i,e),A4.fromArray(i,n),nk.fromArray(i,r),Aa.subVectors(nk,A4),rk.subVectors(tk,A4),Aa.cross(rk),Aa.normalize(),s.push(Aa.x,Aa.y,Aa.z),s.push(Aa.x,Aa.y,Aa.z),s.push(Aa.x,Aa.y,Aa.z)},addColor:function(e,n,r){const i=this.colors,s=this.object.geometry.colors;i[e]!==void 0&&s.push(i[e+0],i[e+1],i[e+2]),i[n]!==void 0&&s.push(i[n+0],i[n+1],i[n+2]),i[r]!==void 0&&s.push(i[r+0],i[r+1],i[r+2])},addUV:function(e,n,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[n+0],i[n+1]),s.push(i[r+0],i[r+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])},addFace:function(e,n,r,i,s,o,a,l,c){const u=this.vertices.length;let f=this.parseVertexIndex(e,u),d=this.parseVertexIndex(n,u),h=this.parseVertexIndex(r,u);if(this.addVertex(f,d,h),this.addColor(f,d,h),a!==void 0&&a!==""){const p=this.normals.length;f=this.parseNormalIndex(a,p),d=this.parseNormalIndex(l,p),h=this.parseNormalIndex(c,p),this.addNormal(f,d,h)}else this.addFaceNormal(f,d,h);if(i!==void 0&&i!==""){const p=this.uvs.length;f=this.parseUVIndex(i,p),d=this.parseUVIndex(s,p),h=this.parseUVIndex(o,p),this.addUV(f,d,h),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const n=this.vertices.length;for(let r=0,i=e.length;r<i;r++){const s=this.parseVertexIndex(e[r],n);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,n){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],r));for(let s=0,o=n.length;s<o;s++)this.addUVLine(this.parseUVIndex(n[s],i))}};return t.startObject("",!1),t}class IG extends Br{constructor(e){super(e),this.materials=null}load(e,n,r,i){const s=this,o=new qr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(a))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}setMaterials(e){return this.materials=e,this}parse(e){const n=new _de;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const r=e.split(`
`);let i="",s="",o=0,a=[];const l=typeof"".trimLeft=="function";for(let f=0,d=r.length;f<d;f++)if(i=r[f],i=l?i.trimLeft():i.trim(),o=i.length,o!==0&&(s=i.charAt(0),s!=="#"))if(s==="v"){const h=i.split(/\s+/);switch(h[0]){case"v":n.vertices.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])),h.length>=7?n.colors.push(parseFloat(h[4]),parseFloat(h[5]),parseFloat(h[6])):n.colors.push(void 0,void 0,void 0);break;case"vn":n.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));break;case"vt":n.uvs.push(parseFloat(h[1]),parseFloat(h[2]));break}}else if(s==="f"){const p=i.substr(1).trim().split(/\s+/),m=[];for(let y=0,x=p.length;y<x;y++){const _=p[y];if(_.length>0){const w=_.split("/");m.push(w)}}const g=m[0];for(let y=1,x=m.length-1;y<x;y++){const _=m[y],w=m[y+1];n.addFace(g[0],_[0],w[0],g[1],_[1],w[1],g[2],_[2],w[2])}}else if(s==="l"){const h=i.substring(1).trim().split(" ");let p=[];const m=[];if(i.indexOf("/")===-1)p=h;else for(let g=0,y=h.length;g<y;g++){const x=h[g].split("/");x[0]!==""&&p.push(x[0]),x[1]!==""&&m.push(x[1])}n.addLineGeometry(p,m)}else if(s==="p"){const p=i.substr(1).trim().split(" ");n.addPointGeometry(p)}else if((a=gde.exec(i))!==null){const h=(" "+a[0].substr(1).trim()).substr(1);n.startObject(h)}else if(vde.test(i))n.object.startMaterial(i.substring(7).trim(),n.materialLibraries);else if(yde.test(i))n.materialLibraries.push(i.substring(7).trim());else if(xde.test(i))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(s==="s"){if(a=i.split(" "),a.length>1){const p=a[1].trim().toLowerCase();n.object.smooth=p!=="0"&&p!=="off"}else n.object.smooth=!0;const h=n.object.currentMaterial();h&&(h.smooth=n.object.smooth)}else{if(i==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+i+'"')}n.finalize();const c=new es;if(c.materialLibraries=[].concat(n.materialLibraries),!(n.objects.length===1&&n.objects[0].geometry.vertices.length===0)===!0)for(let f=0,d=n.objects.length;f<d;f++){const h=n.objects[f],p=h.geometry,m=h.materials,g=p.type==="Line",y=p.type==="Points";let x=!1;if(p.vertices.length===0)continue;const _=new gn;_.setAttribute("position",new Dt(p.vertices,3)),p.normals.length>0&&_.setAttribute("normal",new Dt(p.normals,3)),p.colors.length>0&&(x=!0,_.setAttribute("color",new Dt(p.colors,3))),p.hasUVIndices===!0&&_.setAttribute("uv",new Dt(p.uvs,2));const w=[];for(let S=0,C=m.length;S<C;S++){const A=m[S],R=A.name+"_"+A.smooth+"_"+x;let M=n.materials[R];if(this.materials!==null){if(M=this.materials.create(A.name),g&&M&&!(M instanceof oi)){const D=new oi;Wr.prototype.copy.call(D,M),D.color.copy(M.color),M=D}else if(y&&M&&!(M instanceof Ha)){const D=new Ha({size:10,sizeAttenuation:!1});Wr.prototype.copy.call(D,M),D.color.copy(M.color),D.map=M.map,M=D}}M===void 0&&(g?M=new oi:y?M=new Ha({size:1,sizeAttenuation:!1}):M=new nu,M.name=A.name,M.flatShading=!A.smooth,M.vertexColors=x,n.materials[R]=M),w.push(M)}let T;if(w.length>1){for(let S=0,C=m.length;S<C;S++){const A=m[S];_.addGroup(A.groupStart,A.groupCount,S)}g?T=new so(_,w):y?T=new Zc(_,w):T=new ln(_,w)}else g?T=new so(_,w[0]):y?T=new Zc(_,w[0]):T=new ln(_,w[0]);T.name=h.name,c.add(T)}else if(n.vertices.length>0){const f=new Ha({size:1,sizeAttenuation:!1}),d=new gn;d.setAttribute("position",new Dt(n.vertices,3)),n.colors.length>0&&n.colors[0]!==void 0&&(d.setAttribute("color",new Dt(n.colors,3)),f.vertexColors=!0);const h=new Zc(d,f);c.add(h)}return c}}class PG extends Br{constructor(e){super(e),this.littleEndian=!0}load(e,n,r,i){const s=this,o=new qr(s.manager);o.setPath(s.path),o.setResponseType("arraybuffer"),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(a,e))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e,n){function r(p,m){const g=p.length,y=new Uint8Array(m);let x=0,_=0,w,T,S;do if(w=p[x++],w<32){if(w++,_+w>m)throw new Error("Output buffer is not large enough");if(x+w>g)throw new Error("Invalid compressed data");do y[_++]=p[x++];while(--w)}else{if(T=w>>5,S=_-((w&31)<<8)-1,x>=g)throw new Error("Invalid compressed data");if(T===7&&(T+=p[x++],x>=g))throw new Error("Invalid compressed data");if(S-=p[x++],_+T+2>m)throw new Error("Output buffer is not large enough");if(S<0)throw new Error("Invalid compressed data");if(S>=_)throw new Error("Invalid compressed data");do y[_++]=y[S++];while(--T+2)}while(x<g);return y}function i(p){const m={},g=p.search(/[\r\n]DATA\s(\S*)\s/i),y=/[\r\n]DATA\s(\S*)\s/i.exec(p.substr(g-1));if(m.data=y[1],m.headerLen=y[0].length+g,m.str=p.substr(0,m.headerLen),m.str=m.str.replace(/\#.*/gi,""),m.version=/VERSION (.*)/i.exec(m.str),m.fields=/FIELDS (.*)/i.exec(m.str),m.size=/SIZE (.*)/i.exec(m.str),m.type=/TYPE (.*)/i.exec(m.str),m.count=/COUNT (.*)/i.exec(m.str),m.width=/WIDTH (.*)/i.exec(m.str),m.height=/HEIGHT (.*)/i.exec(m.str),m.viewpoint=/VIEWPOINT (.*)/i.exec(m.str),m.points=/POINTS (.*)/i.exec(m.str),m.version!==null&&(m.version=parseFloat(m.version[1])),m.fields!==null&&(m.fields=m.fields[1].split(" ")),m.type!==null&&(m.type=m.type[1].split(" ")),m.width!==null&&(m.width=parseInt(m.width[1])),m.height!==null&&(m.height=parseInt(m.height[1])),m.viewpoint!==null&&(m.viewpoint=m.viewpoint[1]),m.points!==null&&(m.points=parseInt(m.points[1],10)),m.points===null&&(m.points=m.width*m.height),m.size!==null&&(m.size=m.size[1].split(" ").map(function(_){return parseInt(_,10)})),m.count!==null)m.count=m.count[1].split(" ").map(function(_){return parseInt(_,10)});else{m.count=[];for(let _=0,w=m.fields.length;_<w;_++)m.count.push(1)}m.offset={};let x=0;for(let _=0,w=m.fields.length;_<w;_++)m.data==="ascii"?m.offset[m.fields[_]]=_:(m.offset[m.fields[_]]=x,x+=m.size[_]*m.count[_]);return m.rowSize=x,m}const s=$d(new Uint8Array(e)),o=i(s),a=[],l=[],c=[];if(o.data==="ascii"){const p=o.offset,g=s.substr(o.headerLen).split(`
`);for(let y=0,x=g.length;y<x;y++){if(g[y]==="")continue;const _=g[y].split(" ");if(p.x!==void 0&&(a.push(parseFloat(_[p.x])),a.push(parseFloat(_[p.y])),a.push(parseFloat(_[p.z]))),p.rgb!==void 0){const w=parseFloat(_[p.rgb]),T=w>>16&255,S=w>>8&255,C=w>>0&255;c.push(T/255,S/255,C/255)}p.normal_x!==void 0&&(l.push(parseFloat(_[p.normal_x])),l.push(parseFloat(_[p.normal_y])),l.push(parseFloat(_[p.normal_z])))}}if(o.data==="binary_compressed"){const p=new Uint32Array(e.slice(o.headerLen,o.headerLen+8)),m=p[0],g=p[1],y=r(new Uint8Array(e,o.headerLen+8,m),g),x=new DataView(y.buffer),_=o.offset;for(let w=0;w<o.points;w++)_.x!==void 0&&(a.push(x.getFloat32(o.points*_.x+o.size[0]*w,this.littleEndian)),a.push(x.getFloat32(o.points*_.y+o.size[1]*w,this.littleEndian)),a.push(x.getFloat32(o.points*_.z+o.size[2]*w,this.littleEndian))),_.rgb!==void 0&&(c.push(x.getUint8(o.points*_.rgb+o.size[3]*w+2)/255),c.push(x.getUint8(o.points*_.rgb+o.size[3]*w+1)/255),c.push(x.getUint8(o.points*_.rgb+o.size[3]*w+0)/255)),_.normal_x!==void 0&&(l.push(x.getFloat32(o.points*_.normal_x+o.size[4]*w,this.littleEndian)),l.push(x.getFloat32(o.points*_.normal_y+o.size[5]*w,this.littleEndian)),l.push(x.getFloat32(o.points*_.normal_z+o.size[6]*w,this.littleEndian)))}if(o.data==="binary"){const p=new DataView(e,o.headerLen),m=o.offset;for(let g=0,y=0;g<o.points;g++,y+=o.rowSize)m.x!==void 0&&(a.push(p.getFloat32(y+m.x,this.littleEndian)),a.push(p.getFloat32(y+m.y,this.littleEndian)),a.push(p.getFloat32(y+m.z,this.littleEndian))),m.rgb!==void 0&&(c.push(p.getUint8(y+m.rgb+2)/255),c.push(p.getUint8(y+m.rgb+1)/255),c.push(p.getUint8(y+m.rgb+0)/255)),m.normal_x!==void 0&&(l.push(p.getFloat32(y+m.normal_x,this.littleEndian)),l.push(p.getFloat32(y+m.normal_y,this.littleEndian)),l.push(p.getFloat32(y+m.normal_z,this.littleEndian)))}const u=new gn;a.length>0&&u.setAttribute("position",new Dt(a,3)),l.length>0&&u.setAttribute("normal",new Dt(l,3)),c.length>0&&u.setAttribute("color",new Dt(c,3)),u.computeBoundingSphere();const f=new Ha({size:.005});c.length>0?f.vertexColors=!0:f.color.setHex(Math.random()*16777215);const d=new Zc(u,f);let h=n.split("").reverse().join("");return h=/([^\/]*)/.exec(h),h=h[1].split("").reverse().join(""),d.name=h,d}}class bde extends Br{constructor(e){super(e),this.propertyNameMapping={}}load(e,n,r,i){const s=this,o=new qr(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(a))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}setPropertyNameMapping(e){this.propertyNameMapping=e}parse(e){function n(h){const p=/ply([\s\S]*)end_header\r?\n/;let m="",g=0;const y=p.exec(h);y!==null&&(m=y[1],g=new Blob([y[0]]).size);const x={comments:[],elements:[],headerLength:g,objInfo:""},_=m.split(`
`);let w;function T(S,C){const A={type:S[0]};return A.type==="list"?(A.name=S[3],A.countType=S[1],A.itemType=S[2]):A.name=S[1],A.name in C&&(A.name=C[A.name]),A}for(let S=0;S<_.length;S++){let C=_[S];if(C=C.trim(),C==="")continue;const A=C.split(/\s+/),R=A.shift();switch(C=A.join(" "),R){case"format":x.format=A[0],x.version=A[1];break;case"comment":x.comments.push(C);break;case"element":w!==void 0&&x.elements.push(w),w={},w.name=A[0],w.count=parseInt(A[1]),w.properties=[];break;case"property":w.properties.push(T(A,d.propertyNameMapping));break;case"obj_info":x.objInfo=C;break;default:console.log("unhandled",R,A)}}return w!==void 0&&x.elements.push(w),x}function r(h,p){switch(p){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(h);case"float":case"double":case"float32":case"float64":return parseFloat(h)}}function i(h,p){const m=p.split(/\s+/),g={};for(let y=0;y<h.length;y++)if(h[y].type==="list"){const x=[],_=r(m.shift(),h[y].countType);for(let w=0;w<_;w++)x.push(r(m.shift(),h[y].itemType));g[h[y].name]=x}else g[h[y].name]=r(m.shift(),h[y].type);return g}function s(h,p){const m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};let g;const y=/end_header\s([\s\S]*)$/;let x="";(g=y.exec(h))!==null&&(x=g[1]);const _=x.split(`
`);let w=0,T=0;for(let S=0;S<_.length;S++){let C=_[S];if(C=C.trim(),C==="")continue;T>=p.elements[w].count&&(w++,T=0);const A=i(p.elements[w].properties,C);a(m,p.elements[w].name,A),T++}return o(m)}function o(h){let p=new gn;return h.indices.length>0&&p.setIndex(h.indices),p.setAttribute("position",new Dt(h.vertices,3)),h.normals.length>0&&p.setAttribute("normal",new Dt(h.normals,3)),h.uvs.length>0&&p.setAttribute("uv",new Dt(h.uvs,2)),h.colors.length>0&&p.setAttribute("color",new Dt(h.colors,3)),h.faceVertexUvs.length>0&&(p=p.toNonIndexed(),p.setAttribute("uv",new Dt(h.faceVertexUvs,2))),p.computeBoundingSphere(),p}function a(h,p,m){if(p==="vertex")h.vertices.push(m.x,m.y,m.z),"nx"in m&&"ny"in m&&"nz"in m&&h.normals.push(m.nx,m.ny,m.nz),"s"in m&&"t"in m&&h.uvs.push(m.s,m.t),"red"in m&&"green"in m&&"blue"in m&&h.colors.push(m.red/255,m.green/255,m.blue/255);else if(p==="face"){const g=m.vertex_indices||m.vertex_index,y=m.texcoord;g.length===3?(h.indices.push(g[0],g[1],g[2]),y&&y.length===6&&(h.faceVertexUvs.push(y[0],y[1]),h.faceVertexUvs.push(y[2],y[3]),h.faceVertexUvs.push(y[4],y[5]))):g.length===4&&(h.indices.push(g[0],g[1],g[3]),h.indices.push(g[1],g[2],g[3]))}}function l(h,p,m,g){switch(m){case"int8":case"char":return[h.getInt8(p),1];case"uint8":case"uchar":return[h.getUint8(p),1];case"int16":case"short":return[h.getInt16(p,g),2];case"uint16":case"ushort":return[h.getUint16(p,g),2];case"int32":case"int":return[h.getInt32(p,g),4];case"uint32":case"uint":return[h.getUint32(p,g),4];case"float32":case"float":return[h.getFloat32(p,g),4];case"float64":case"double":return[h.getFloat64(p,g),8]}}function c(h,p,m,g){const y={};let x,_=0;for(let w=0;w<m.length;w++)if(m[w].type==="list"){const T=[];x=l(h,p+_,m[w].countType,g);const S=x[0];_+=x[1];for(let C=0;C<S;C++)x=l(h,p+_,m[w].itemType,g),T.push(x[0]),_+=x[1];y[m[w].name]=T}else x=l(h,p+_,m[w].type,g),y[m[w].name]=x[0],_+=x[1];return[y,_]}function u(h,p){const m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},g=p.format==="binary_little_endian",y=new DataView(h,p.headerLength);let x,_=0;for(let w=0;w<p.elements.length;w++)for(let T=0;T<p.elements[w].count;T++){x=c(y,_,p.elements[w].properties,g),_+=x[1];const S=x[0];a(m,p.elements[w].name,S)}return o(m)}let f;const d=this;if(e instanceof ArrayBuffer){const h=$d(new Uint8Array(e)),p=n(h);f=p.format==="ascii"?s(h,p):u(e,p)}else f=s(e,n(e));return f}}const ik=new Kn,G2=new $;class Jb extends wy{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],n=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],r=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(r),this.setAttribute("position",new Dt(e,3)),this.setAttribute("uv",new Dt(n,2))}applyMatrix4(e){const n=this.attributes.instanceStart,r=this.attributes.instanceEnd;return n!==void 0&&(n.applyMatrix4(e),r.applyMatrix4(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const r=new f_(n,6,1);return this.setAttribute("instanceStart",new Ao(r,3,0)),this.setAttribute("instanceEnd",new Ao(r,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,n=3){let r;e instanceof Float32Array?r=e:Array.isArray(e)&&(r=new Float32Array(e));const i=new f_(r,n*2,1);return this.setAttribute("instanceColorStart",new Ao(i,n,0)),this.setAttribute("instanceColorEnd",new Ao(i,n,n)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new k6(e.geometry)),this}fromLineSegments(e){const n=e.geometry;return this.setPositions(n.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Kn);const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;e!==void 0&&n!==void 0&&(this.boundingBox.setFromBufferAttribute(e),ik.setFromBufferAttribute(n),this.boundingBox.union(ik))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new wr),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;if(e!==void 0&&n!==void 0){const r=this.boundingSphere.center;this.boundingBox.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)G2.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(G2)),G2.fromBufferAttribute(n,s),i=Math.max(i,r.distanceToSquared(G2));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class kG extends Jb{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const n=e.length-3,r=new Float32Array(2*n);for(let i=0;i<n;i+=3)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5];return super.setPositions(r),this}setColors(e,n=3){const r=e.length-n,i=new Float32Array(2*r);if(n===3)for(let s=0;s<r;s+=n)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];else for(let s=0;s<r;s+=n)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5],i[2*s+6]=e[s+6],i[2*s+7]=e[s+7];return super.setColors(i,n),this}fromLine(e){const n=e.geometry;return this.setPositions(n.attributes.position.array),this}}class eE extends yr{constructor(e){super({type:"LineMaterial",uniforms:mf.clone(mf.merge([Qt.common,Qt.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ke(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${parseInt(wl.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(n){this.uniforms.diffuse.value=n}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(n){n===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(n){this.uniforms.linewidth.value=n}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(n){!!n!="USE_DASH"in this.defines&&(this.needsUpdate=!0),n===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(n){this.uniforms.dashScale.value=n}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(n){this.uniforms.dashSize.value=n}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(n){this.uniforms.dashOffset.value=n}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(n){this.uniforms.gapSize.value=n}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(n){this.uniforms.opacity.value=n}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(n){this.uniforms.resolution.value.copy(n)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(n){!!n!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),n===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const M4=new Hn,sk=new $,ok=new $,Ds=new Hn,Ns=new Hn,Fl=new Hn,C4=new $,R4=new et,zs=new qa,ak=new $,j2=new Kn,V2=new wr,Ul=new Hn;let Yl,Cd;function lk(t,e,n){return Ul.set(0,0,-e,1).applyMatrix4(t.projectionMatrix),Ul.multiplyScalar(1/Ul.w),Ul.x=Cd/n.width,Ul.y=Cd/n.height,Ul.applyMatrix4(t.projectionMatrixInverse),Ul.multiplyScalar(1/Ul.w),Math.abs(Math.max(Ul.x,Ul.y))}function Ede(t,e){const n=t.matrixWorld,r=t.geometry,i=r.attributes.instanceStart,s=r.attributes.instanceEnd,o=Math.min(r.instanceCount,i.count);for(let a=0,l=o;a<l;a++){zs.start.fromBufferAttribute(i,a),zs.end.fromBufferAttribute(s,a),zs.applyMatrix4(n);const c=new $,u=new $;Yl.distanceSqToSegment(zs.start,zs.end,u,c),u.distanceTo(c)<Cd*.5&&e.push({point:u,pointOnLine:c,distance:Yl.origin.distanceTo(u),object:t,face:null,faceIndex:a,uv:null,[oC]:null})}}function wde(t,e,n){const r=e.projectionMatrix,s=t.material.resolution,o=t.matrixWorld,a=t.geometry,l=a.attributes.instanceStart,c=a.attributes.instanceEnd,u=Math.min(a.instanceCount,l.count),f=-e.near;Yl.at(1,Fl),Fl.w=1,Fl.applyMatrix4(e.matrixWorldInverse),Fl.applyMatrix4(r),Fl.multiplyScalar(1/Fl.w),Fl.x*=s.x/2,Fl.y*=s.y/2,Fl.z=0,C4.copy(Fl),R4.multiplyMatrices(e.matrixWorldInverse,o);for(let d=0,h=u;d<h;d++){if(Ds.fromBufferAttribute(l,d),Ns.fromBufferAttribute(c,d),Ds.w=1,Ns.w=1,Ds.applyMatrix4(R4),Ns.applyMatrix4(R4),Ds.z>f&&Ns.z>f)continue;if(Ds.z>f){const _=Ds.z-Ns.z,w=(Ds.z-f)/_;Ds.lerp(Ns,w)}else if(Ns.z>f){const _=Ns.z-Ds.z,w=(Ns.z-f)/_;Ns.lerp(Ds,w)}Ds.applyMatrix4(r),Ns.applyMatrix4(r),Ds.multiplyScalar(1/Ds.w),Ns.multiplyScalar(1/Ns.w),Ds.x*=s.x/2,Ds.y*=s.y/2,Ns.x*=s.x/2,Ns.y*=s.y/2,zs.start.copy(Ds),zs.start.z=0,zs.end.copy(Ns),zs.end.z=0;const m=zs.closestPointToPointParameter(C4,!0);zs.at(m,ak);const g=ri.lerp(Ds.z,Ns.z,m),y=g>=-1&&g<=1,x=C4.distanceTo(ak)<Cd*.5;if(y&&x){zs.start.fromBufferAttribute(l,d),zs.end.fromBufferAttribute(c,d),zs.start.applyMatrix4(o),zs.end.applyMatrix4(o);const _=new $,w=new $;Yl.distanceSqToSegment(zs.start,zs.end,w,_),n.push({point:w,pointOnLine:_,distance:Yl.origin.distanceTo(w),object:t,face:null,faceIndex:d,uv:null,[oC]:null})}}}class LG extends ln{constructor(e=new Jb,n=new eE({color:Math.random()*16777215})){super(e,n),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,n=e.attributes.instanceStart,r=e.attributes.instanceEnd,i=new Float32Array(2*n.count);for(let o=0,a=0,l=n.count;o<l;o++,a+=2)sk.fromBufferAttribute(n,o),ok.fromBufferAttribute(r,o),i[a]=a===0?0:i[a-1],i[a+1]=i[a]+sk.distanceTo(ok);const s=new f_(i,2,1);return e.setAttribute("instanceDistanceStart",new Ao(s,1,0)),e.setAttribute("instanceDistanceEnd",new Ao(s,1,1)),this}raycast(e,n){const r=this.material.worldUnits,i=e.camera;i===null&&!r&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Yl=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;Cd=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),V2.copy(a.boundingSphere).applyMatrix4(o);let c;if(r)c=Cd*.5;else{const f=Math.max(i.near,V2.distanceToPoint(Yl.origin));c=lk(i,f,l.resolution)}if(V2.radius+=c,Yl.intersectsSphere(V2)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),j2.copy(a.boundingBox).applyMatrix4(o);let u;if(r)u=Cd*.5;else{const f=Math.max(i.near,j2.distanceToPoint(Yl.origin));u=lk(i,f,l.resolution)}j2.expandByScalar(u),Yl.intersectsBox(j2)!==!1&&(r?Ede(this,n):wde(this,i,n))}onBeforeRender(e){const n=this.material.uniforms;n&&n.resolution&&(e.getViewport(M4),this.material.uniforms.resolution.value.set(M4.z,M4.w))}}class DG extends LG{constructor(e=new kG,n=new eE({color:Math.random()*16777215})){super(e,n),this.isLine2=!0,this.type="Line2"}}const ck=t=>Symbol.iterator in t,uk=t=>"entries"in t,fk=(t,e)=>{const n=t instanceof Map?t:new Map(t.entries()),r=e instanceof Map?e:new Map(e.entries());if(n.size!==r.size)return!1;for(const[i,s]of n)if(!Object.is(s,r.get(i)))return!1;return!0},Sde=(t,e)=>{const n=t[Symbol.iterator](),r=e[Symbol.iterator]();let i=n.next(),s=r.next();for(;!i.done&&!s.done;){if(!Object.is(i.value,s.value))return!1;i=n.next(),s=r.next()}return!!i.done&&!!s.done};function Tde(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:!ck(t)||!ck(e)?fk({entries:()=>Object.entries(t)},{entries:()=>Object.entries(e)}):uk(t)&&uk(e)?fk(t,e):Sde(t,e)}const NG=v.createContext([]);function OG({box:t,multiple:e,children:n,onChange:r,onChangePointerUp:i,border:s="1px solid #55aaff",backgroundColor:o="rgba(75, 160, 255, 0.1)",filter:a=c=>c,...l}){const[c,u]=v.useState(!1),{setEvents:f,camera:d,raycaster:h,gl:p,controls:m,size:g,get:y}=At(),[x,_]=v.useState(!1),[w,T]=v.useReducer((R,{object:M,shift:D})=>M===void 0?[]:Array.isArray(M)?M:D?R.includes(M)?R.filter(k=>k!==M):[M,...R]:R[0]===M?[]:[M],[]);v.useEffect(()=>{c?r==null||r(w):i==null||i(w)},[w,c]);const S=v.useCallback(R=>{R.stopPropagation(),T({object:a([R.object])[0],shift:e&&R.shiftKey})},[]),C=v.useCallback(R=>!x&&T({}),[x]),A=v.useRef(null);return v.useEffect(()=>{if(!t||!e)return;const R=new ide(d,A.current),M=document.createElement("div");M.style.pointerEvents="none",M.style.border=s,M.style.backgroundColor=o,M.style.position="fixed";const D=new Ke,k=new Ke,L=new Ke,N=y().events.enabled,z=m==null?void 0:m.enabled;let O=!1;function K(W,X){const{offsetX:J,offsetY:oe}=W,{width:Ee,height:me}=g;X.set(J/Ee*2-1,-(oe/me)*2+1)}function V(W){var X;m&&(m.enabled=!1),f({enabled:!1}),u(O=!0),(X=p.domElement.parentElement)==null||X.appendChild(M),M.style.left=`${W.clientX}px`,M.style.top=`${W.clientY}px`,M.style.width="0px",M.style.height="0px",D.x=W.clientX,D.y=W.clientY}function ne(W){L.x=Math.max(D.x,W.clientX),L.y=Math.max(D.y,W.clientY),k.x=Math.min(D.x,W.clientX),k.y=Math.min(D.y,W.clientY),M.style.left=`${k.x}px`,M.style.top=`${k.y}px`,M.style.width=`${L.x-k.x}px`,M.style.height=`${L.y-k.y}px`}function re(){if(O){var W;m&&(m.enabled=z),f({enabled:N}),u(O=!1),(W=M.parentElement)==null||W.removeChild(M)}}function P(W){W.shiftKey&&(V(W),K(W,R.startPoint))}let se=[];function ue(W){if(O){ne(W),K(W,R.endPoint);const X=R.select().sort(J=>J.uuid).filter(J=>J.isMesh);Tde(X,se)||(se=X,T({object:a(X)}))}}function te(W){O&&re()}return document.addEventListener("pointerdown",P,{passive:!0}),document.addEventListener("pointermove",ue,{passive:!0,capture:!0}),document.addEventListener("pointerup",te,{passive:!0}),()=>{document.removeEventListener("pointerdown",P),document.removeEventListener("pointermove",ue,!0),document.removeEventListener("pointerup",te)}},[g.width,g.height,h,d,m,p]),v.createElement("group",It({ref:A,onClick:S,onPointerOver:()=>_(!0),onPointerOut:()=>_(!1),onPointerMissed:C},l),v.createElement(NG.Provider,{value:w},n))}function c$e(){return v.useContext(NG)}const uC=v.forwardRef(function({children:e,follow:n=!0,lockX:r=!1,lockY:i=!1,lockZ:s=!1,...o},a){const l=v.useRef(null),c=v.useRef(null),u=new bn;return Yt(({camera:f})=>{if(!n||!c.current)return;const d=c.current.rotation.clone();c.current.updateMatrix(),c.current.updateWorldMatrix(!1,!1),c.current.getWorldQuaternion(u),f.getWorldQuaternion(l.current.quaternion).premultiply(u.invert()),r&&(c.current.rotation.x=d.x),i&&(c.current.rotation.y=d.y),s&&(c.current.rotation.z=d.z)}),v.useImperativeHandle(a,()=>c.current,[]),v.createElement("group",It({ref:c},o),v.createElement("group",{ref:l},e))}),FG=v.forwardRef(({children:t,depth:e=-1,...n},r)=>{const i=v.useRef(null);return v.useImperativeHandle(r,()=>i.current,[]),Yt(({camera:s})=>{i.current.quaternion.copy(s.quaternion),i.current.position.copy(s.position)}),v.createElement("group",It({ref:i},n),v.createElement("group",{"position-z":-e},t))}),Ade=new $,Mde=new $,Cde=new $,Rde=(t,e,n)=>{const r=n.width/2,i=n.height/2;e.updateMatrixWorld(!1);const s=t.project(e);return s.x=s.x*r+r,s.y=-(s.y*i)+i,s},Ide=(t,e,n,r=1)=>{const i=Ade.set(t.x/n.width*2-1,-(t.y/n.height)*2+1,r);return i.unproject(e),i},UG=(t,e,n,r)=>{const i=Rde(Cde.copy(t),n,r);let s=0;for(let o=0;o<2;++o){const a=Mde.copy(i).setComponent(o,i.getComponent(o)+e),l=Ide(a,n,r,a.z);s=Math.max(s,t.distanceTo(l))}return s},Ni=v.forwardRef(function({points:e,color:n=16777215,vertexColors:r,linewidth:i,lineWidth:s,segments:o,dashed:a,...l},c){var u,f;const d=At(y=>y.size),h=v.useMemo(()=>o?new LG:new DG,[o]),[p]=v.useState(()=>new eE),m=(r==null||(u=r[0])==null?void 0:u.length)===4?4:3,g=v.useMemo(()=>{const y=o?new Jb:new kG,x=e.map(_=>{const w=Array.isArray(_);return _ instanceof $||_ instanceof Hn?[_.x,_.y,_.z]:_ instanceof Ke?[_.x,_.y,0]:w&&_.length===3?[_[0],_[1],_[2]]:w&&_.length===2?[_[0],_[1],0]:_});if(y.setPositions(x.flat()),r){n=16777215;const _=r.map(w=>w instanceof wt?w.toArray():w);y.setColors(_.flat(),m)}return y},[e,o,r,m]);return v.useLayoutEffect(()=>{h.computeLineDistances()},[e,h]),v.useLayoutEffect(()=>{a?p.defines.USE_DASH="":delete p.defines.USE_DASH,p.needsUpdate=!0},[a,p]),v.useEffect(()=>()=>{g.dispose(),p.dispose()},[g]),v.createElement("primitive",It({object:h,ref:c},l),v.createElement("primitive",{object:g,attach:"geometry"}),v.createElement("primitive",It({object:p,attach:"material",color:n,vertexColors:!!r,resolution:[d.width,d.height],linewidth:(f=i??s)!==null&&f!==void 0?f:1,dashed:a,transparent:m===4},l)))}),Pde=new $,BG=v.forwardRef(function({start:e=[0,0,0],end:n=[0,0,0],mid:r,segments:i=20,...s},o){const a=v.useRef(null);v.useImperativeHandle(o,()=>a.current);const[l]=v.useState(()=>new gy(void 0,void 0,void 0)),c=v.useCallback((f,d,h,p=20)=>(f instanceof $?l.v0.copy(f):l.v0.set(...f),d instanceof $?l.v2.copy(d):l.v2.set(...d),h instanceof $?l.v1.copy(h):Array.isArray(h)?l.v1.set(...h):l.v1.copy(l.v0.clone().add(l.v2.clone().sub(l.v0)).add(Pde.set(0,l.v0.y-l.v2.y,0))),l.getPoints(p)),[]);v.useLayoutEffect(()=>{a.current.setPoints=(f,d,h)=>{const p=c(f,d,h);a.current.geometry&&a.current.geometry.setPositions(p.map(m=>m.toArray()).flat())}},[]);const u=v.useMemo(()=>c(e,n,r,i),[e,n,r,i]);return v.createElement(Ni,It({ref:a,points:u},s))}),zG=v.forwardRef(function({start:e,end:n,midA:r,midB:i,segments:s=20,...o},a){const l=v.useMemo(()=>{const c=e instanceof $?e:new $(...e),u=n instanceof $?n:new $(...n),f=r instanceof $?r:new $(...r),d=i instanceof $?i:new $(...i);return new M6(c,f,d,u).getPoints(s)},[e,n,r,i,s]);return v.createElement(Ni,It({ref:a,points:l},o))}),HG=v.forwardRef(function({points:e,closed:n=!1,curveType:r="centripetal",tension:i=.5,segments:s=20,vertexColors:o,...a},l){const c=v.useMemo(()=>{const d=e.map(h=>h instanceof $?h:new $(...h));return new T6(d,n,r,i)},[e,n,r,i]),u=v.useMemo(()=>c.getPoints(s),[c,s]),f=v.useMemo(()=>{if(!o||o.length<2)return;if(o.length===s+1)return o;const d=o.map(m=>m instanceof wt?m:new wt(...m));n&&d.push(d[0].clone());const h=[d[0]],p=s/(d.length-1);for(let m=1;m<s;m++){const g=m%p/p,y=Math.floor(m/p);h.push(d[y].clone().lerp(d[y+1],g))}return h.push(d[d.length-1]),h},[o,s]);return v.createElement(Ni,It({ref:l,points:u,vertexColors:f},a))}),GG=v.forwardRef(({url:t,distance:e=1,loop:n=!0,autoplay:r,...i},s)=>{const o=v.useRef(null);v.useImperativeHandle(s,()=>o.current,[]);const a=At(({camera:u})=>u),[l]=v.useState(()=>new aH),c=rs(sH,t);return v.useEffect(()=>{const u=o.current;u&&(u.setBuffer(c),u.setRefDistance(e),u.setLoop(n),r&&!u.isPlaying&&u.play())},[c,a,e,n]),v.useEffect(()=>{const u=o.current;return a.add(l),()=>{a.remove(l),u&&(u.isPlaying&&u.stop(),u.source&&u.source._connected&&u.disconnect())}},[]),v.createElement("positionalAudio",It({ref:o,args:[l]},i))});function kde(){var t=Object.create(null);function e(i,s){var o=i.id,a=i.name,l=i.dependencies;l===void 0&&(l=[]);var c=i.init;c===void 0&&(c=function(){});var u=i.getTransferables;if(u===void 0&&(u=null),!t[o])try{l=l.map(function(d){return d&&d.isWorkerModule&&(e(d,function(h){if(h instanceof Error)throw h}),d=t[d.id].value),d}),c=r("<"+a+">.init",c),u&&(u=r("<"+a+">.getTransferables",u));var f=null;typeof c=="function"?f=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),t[o]={id:o,value:f,getTransferables:u},s(f)}catch(d){d&&d.noLog||console.error(d),s(d)}}function n(i,s){var o,a=i.id,l=i.args;(!t[a]||typeof t[a].value!="function")&&s(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var c=(o=t[a]).value.apply(o,l);c&&typeof c.then=="function"?c.then(u,function(f){return s(f instanceof Error?f:new Error(""+f))}):u(c)}catch(f){s(f)}function u(f){try{var d=t[a].getTransferables&&t[a].getTransferables(f);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),s(f,d)}catch(h){console.error(h),s(h)}}}function r(i,s){var o=void 0;self.troikaDefine=function(l){return o=l};var a=URL.createObjectURL(new Blob(["/** "+i.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(l){console.error(l)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(i){var s=i.data,o=s.messageId,a=s.action,l=s.data;try{a==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof c=="function"}})}),a==="callModule"&&n(l,function(c,u){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:c},u||void 0)})}catch(c){postMessage({messageId:o,success:!1,error:c.stack})}})}function Lde(t){var e=function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];return e._getInitResult().then(function(i){if(typeof i=="function")return i.apply(void 0,n);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var n=t.dependencies,r=t.init;n=Array.isArray(n)?n.map(function(s){return s&&(s=s.onMainThread||s,s._getInitResult&&(s=s._getInitResult())),s}):[];var i=Promise.all(n).then(function(s){return r.apply(null,s)});return e._getInitResult=function(){return i},i},e}var jG=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(n){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+n.message+"]")}return jG=function(){return t},t},Dde=0,Nde=0,I4=!1,g1=Object.create(null),y1=Object.create(null),v5=Object.create(null);function $m(t){if((!t||typeof t.init!="function")&&!I4)throw new Error("requires `options.init` function");var e=t.dependencies,n=t.init,r=t.getTransferables,i=t.workerId,s=Lde(t);i==null&&(i="#default");var o="workerModule"+ ++Dde,a=t.name||o,l=null;e=e&&e.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(I4=!0,u=$m({workerId:i,name:"<"+a+"> function dependency: "+u.name,init:`function(){return (
`+m3(u)+`
)}`}),I4=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function c(){for(var u=[],f=arguments.length;f--;)u[f]=arguments[f];if(!jG())return s.apply(void 0,u);if(!l){l=dk(i,"registerModule",c.workerModuleData);var d=function(){l=null,y1[i].delete(d)};(y1[i]||(y1[i]=new Set)).add(d)}return l.then(function(h){var p=h.isCallable;if(p)return dk(i,"callModule",{id:o,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return c.workerModuleData={isWorkerModule:!0,id:o,name:a,dependencies:e,init:m3(n),getTransferables:r&&m3(r)},c.onMainThread=s,c}function Ode(t){y1[t]&&y1[t].forEach(function(e){e()}),g1[t]&&(g1[t].terminate(),delete g1[t])}function m3(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function Fde(t){var e=g1[t];if(!e){var n=m3(kde);e=g1[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+n+")()"],{type:"application/javascript"}))),e.onmessage=function(r){var i=r.data,s=i.messageId,o=v5[s];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete v5[s],o(i)}}return e}function dk(t,e,n){return new Promise(function(r,i){var s=++Nde;v5[s]=function(o){o.success?r(o.result):i(new Error("Error in worker "+e+" call: "+o.error))},Fde(t).postMessage({messageId:s,action:e,data:n})})}function VG(){var t=function(e){function n(ne,re,P,se,ue,te,W,X){var J=1-W;X.x=J*J*ne+2*J*W*P+W*W*ue,X.y=J*J*re+2*J*W*se+W*W*te}function r(ne,re,P,se,ue,te,W,X,J,oe){var Ee=1-J;oe.x=Ee*Ee*Ee*ne+3*Ee*Ee*J*P+3*Ee*J*J*ue+J*J*J*W,oe.y=Ee*Ee*Ee*re+3*Ee*Ee*J*se+3*Ee*J*J*te+J*J*J*X}function i(ne,re){for(var P=/([MLQCZ])([^MLQCZ]*)/g,se,ue,te,W,X;se=P.exec(ne);){var J=se[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(oe){return parseFloat(oe)});switch(se[1]){case"M":W=ue=J[0],X=te=J[1];break;case"L":(J[0]!==W||J[1]!==X)&&re("L",W,X,W=J[0],X=J[1]);break;case"Q":{re("Q",W,X,W=J[2],X=J[3],J[0],J[1]);break}case"C":{re("C",W,X,W=J[4],X=J[5],J[0],J[1],J[2],J[3]);break}case"Z":(W!==ue||X!==te)&&re("L",W,X,ue,te);break}}}function s(ne,re,P){P===void 0&&(P=16);var se={x:0,y:0};i(ne,function(ue,te,W,X,J,oe,Ee,me,Te){switch(ue){case"L":re(te,W,X,J);break;case"Q":{for(var _e=te,Re=W,ae=1;ae<P;ae++)n(te,W,oe,Ee,X,J,ae/(P-1),se),re(_e,Re,se.x,se.y),_e=se.x,Re=se.y;break}case"C":{for(var Ce=te,Pe=W,Ve=1;Ve<P;Ve++)r(te,W,oe,Ee,me,Te,X,J,Ve/(P-1),se),re(Ce,Pe,se.x,se.y),Ce=se.x,Pe=se.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(ne,re){var P=ne.getContext?ne.getContext("webgl",c):ne,se=l.get(P);if(!se){let Ee=function(Ce){var Pe=te[Ce];if(!Pe&&(Pe=te[Ce]=P.getExtension(Ce),!Pe))throw new Error(Ce+" not supported");return Pe},me=function(Ce,Pe){var Ve=P.createShader(Pe);return P.shaderSource(Ve,Ce),P.compileShader(Ve),Ve},Te=function(Ce,Pe,Ve,ye){if(!W[Ce]){var ge={},ze={},fe=P.createProgram();P.attachShader(fe,me(Pe,P.VERTEX_SHADER)),P.attachShader(fe,me(Ve,P.FRAGMENT_SHADER)),P.linkProgram(fe),W[Ce]={program:fe,transaction:function(ve){P.useProgram(fe),ve({setUniform:function(Be,Ze){for(var F=[],Z=arguments.length-2;Z-- >0;)F[Z]=arguments[Z+2];var q=ze[Ze]||(ze[Ze]=P.getUniformLocation(fe,Ze));P["uniform"+Be].apply(P,[q].concat(F))},setAttribute:function(Be,Ze,F,Z,q){var xe=ge[Be];xe||(xe=ge[Be]={buf:P.createBuffer(),loc:P.getAttribLocation(fe,Be),data:null}),P.bindBuffer(P.ARRAY_BUFFER,xe.buf),P.vertexAttribPointer(xe.loc,Ze,P.FLOAT,!1,0,0),P.enableVertexAttribArray(xe.loc),ue?P.vertexAttribDivisor(xe.loc,Z):Ee("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(xe.loc,Z),q!==xe.data&&(P.bufferData(P.ARRAY_BUFFER,q,F),xe.data=q)}})}}}W[Ce].transaction(ye)},_e=function(Ce,Pe){J++;try{P.activeTexture(P.TEXTURE0+J);var Ve=X[Ce];Ve||(Ve=X[Ce]=P.createTexture(),P.bindTexture(P.TEXTURE_2D,Ve),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.NEAREST),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.NEAREST)),P.bindTexture(P.TEXTURE_2D,Ve),Pe(Ve,J)}finally{J--}},Re=function(Ce,Pe,Ve){var ye=P.createFramebuffer();oe.push(ye),P.bindFramebuffer(P.FRAMEBUFFER,ye),P.activeTexture(P.TEXTURE0+Pe),P.bindTexture(P.TEXTURE_2D,Ce),P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_2D,Ce,0);try{Ve(ye)}finally{P.deleteFramebuffer(ye),P.bindFramebuffer(P.FRAMEBUFFER,oe[--oe.length-1]||null)}},ae=function(){te={},W={},X={},J=-1,oe.length=0};var ue=typeof WebGL2RenderingContext<"u"&&P instanceof WebGL2RenderingContext,te={},W={},X={},J=-1,oe=[];P.canvas.addEventListener("webglcontextlost",function(Ce){ae(),Ce.preventDefault()},!1),l.set(P,se={gl:P,isWebGL2:ue,getExtension:Ee,withProgram:Te,withTexture:_e,withTextureFramebuffer:Re,handleContextLoss:ae})}re(se)}function f(ne,re,P,se,ue,te,W,X){W===void 0&&(W=15),X===void 0&&(X=null),u(ne,function(J){var oe=J.gl,Ee=J.withProgram,me=J.withTexture;me("copy",function(Te,_e){oe.texImage2D(oe.TEXTURE_2D,0,oe.RGBA,ue,te,0,oe.RGBA,oe.UNSIGNED_BYTE,re),Ee("copy",o,a,function(Re){var ae=Re.setUniform,Ce=Re.setAttribute;Ce("aUV",2,oe.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ae("1i","image",_e),oe.bindFramebuffer(oe.FRAMEBUFFER,X||null),oe.disable(oe.BLEND),oe.colorMask(W&8,W&4,W&2,W&1),oe.viewport(P,se,ue,te),oe.scissor(P,se,ue,te),oe.drawArrays(oe.TRIANGLES,0,3)})})})}function d(ne,re,P){var se=ne.width,ue=ne.height;u(ne,function(te){var W=te.gl,X=new Uint8Array(se*ue*4);W.readPixels(0,0,se,ue,W.RGBA,W.UNSIGNED_BYTE,X),ne.width=re,ne.height=P,f(W,X,0,0,se,ue)})}var h=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:f,resizeWebGLCanvasWithoutClearing:d});function p(ne,re,P,se,ue,te){te===void 0&&(te=1);var W=new Uint8Array(ne*re),X=se[2]-se[0],J=se[3]-se[1],oe=[];s(P,function(Ce,Pe,Ve,ye){oe.push({x1:Ce,y1:Pe,x2:Ve,y2:ye,minX:Math.min(Ce,Ve),minY:Math.min(Pe,ye),maxX:Math.max(Ce,Ve),maxY:Math.max(Pe,ye)})}),oe.sort(function(Ce,Pe){return Ce.maxX-Pe.maxX});for(var Ee=0;Ee<ne;Ee++)for(var me=0;me<re;me++){var Te=Re(se[0]+X*(Ee+.5)/ne,se[1]+J*(me+.5)/re),_e=Math.pow(1-Math.abs(Te)/ue,te)/2;Te<0&&(_e=1-_e),_e=Math.max(0,Math.min(255,Math.round(_e*255))),W[me*ne+Ee]=_e}return W;function Re(Ce,Pe){for(var Ve=1/0,ye=1/0,ge=oe.length;ge--;){var ze=oe[ge];if(ze.maxX+ye<=Ce)break;if(Ce+ye>ze.minX&&Pe-ye<ze.maxY&&Pe+ye>ze.minY){var fe=y(Ce,Pe,ze.x1,ze.y1,ze.x2,ze.y2);fe<Ve&&(Ve=fe,ye=Math.sqrt(Ve))}}return ae(Ce,Pe)&&(ye=-ye),ye}function ae(Ce,Pe){for(var Ve=0,ye=oe.length;ye--;){var ge=oe[ye];if(ge.maxX<=Ce)break;var ze=ge.y1>Pe!=ge.y2>Pe&&Ce<(ge.x2-ge.x1)*(Pe-ge.y1)/(ge.y2-ge.y1)+ge.x1;ze&&(Ve+=ge.y1<ge.y2?1:-1)}return Ve!==0}}function m(ne,re,P,se,ue,te,W,X,J,oe){te===void 0&&(te=1),X===void 0&&(X=0),J===void 0&&(J=0),oe===void 0&&(oe=0),g(ne,re,P,se,ue,te,W,null,X,J,oe)}function g(ne,re,P,se,ue,te,W,X,J,oe,Ee){te===void 0&&(te=1),J===void 0&&(J=0),oe===void 0&&(oe=0),Ee===void 0&&(Ee=0);for(var me=p(ne,re,P,se,ue,te),Te=new Uint8Array(me.length*4),_e=0;_e<me.length;_e++)Te[_e*4+Ee]=me[_e];f(W,Te,J,oe,ne,re,1<<3-Ee,X)}function y(ne,re,P,se,ue,te){var W=ue-P,X=te-se,J=W*W+X*X,oe=J?Math.max(0,Math.min(1,((ne-P)*W+(re-se)*X)/J)):0,Ee=ne-(P+oe*W),me=re-(se+oe*X);return Ee*Ee+me*me}var x=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:m,generateIntoFramebuffer:g}),_="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",w="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",T="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",S=new Float32Array([0,0,2,0,0,2]),C=null,A=!1,R={},M=new WeakMap;function D(ne){if(!A&&!z(ne))throw new Error("WebGL generation not supported")}function k(ne,re,P,se,ue,te,W){if(te===void 0&&(te=1),W===void 0&&(W=null),!W&&(W=C,!W)){var X=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!X)throw new Error("OffscreenCanvas or DOM canvas not supported");W=C=X.getContext("webgl",{depth:!1})}D(W);var J=new Uint8Array(ne*re*4);u(W,function(Te){var _e=Te.gl,Re=Te.withTexture,ae=Te.withTextureFramebuffer;Re("readable",function(Ce,Pe){_e.texImage2D(_e.TEXTURE_2D,0,_e.RGBA,ne,re,0,_e.RGBA,_e.UNSIGNED_BYTE,null),ae(Ce,Pe,function(Ve){N(ne,re,P,se,ue,te,_e,Ve,0,0,0),_e.readPixels(0,0,ne,re,_e.RGBA,_e.UNSIGNED_BYTE,J)})})});for(var oe=new Uint8Array(ne*re),Ee=0,me=0;Ee<J.length;Ee+=4)oe[me++]=J[Ee];return oe}function L(ne,re,P,se,ue,te,W,X,J,oe){te===void 0&&(te=1),X===void 0&&(X=0),J===void 0&&(J=0),oe===void 0&&(oe=0),N(ne,re,P,se,ue,te,W,null,X,J,oe)}function N(ne,re,P,se,ue,te,W,X,J,oe,Ee){te===void 0&&(te=1),J===void 0&&(J=0),oe===void 0&&(oe=0),Ee===void 0&&(Ee=0),D(W);var me=[];s(P,function(Te,_e,Re,ae){me.push(Te,_e,Re,ae)}),me=new Float32Array(me),u(W,function(Te){var _e=Te.gl,Re=Te.isWebGL2,ae=Te.getExtension,Ce=Te.withProgram,Pe=Te.withTexture,Ve=Te.withTextureFramebuffer,ye=Te.handleContextLoss;if(Pe("rawDistances",function(ge,ze){(ne!==ge._lastWidth||re!==ge._lastHeight)&&_e.texImage2D(_e.TEXTURE_2D,0,_e.RGBA,ge._lastWidth=ne,ge._lastHeight=re,0,_e.RGBA,_e.UNSIGNED_BYTE,null),Ce("main",_,w,function(fe){var ie=fe.setAttribute,ve=fe.setUniform,Me=!Re&&ae("ANGLE_instanced_arrays"),Be=!Re&&ae("EXT_blend_minmax");ie("aUV",2,_e.STATIC_DRAW,0,S),ie("aLineSegment",4,_e.DYNAMIC_DRAW,1,me),ve.apply(void 0,["4f","uGlyphBounds"].concat(se)),ve("1f","uMaxDistance",ue),ve("1f","uExponent",te),Ve(ge,ze,function(Ze){_e.enable(_e.BLEND),_e.colorMask(!0,!0,!0,!0),_e.viewport(0,0,ne,re),_e.scissor(0,0,ne,re),_e.blendFunc(_e.ONE,_e.ONE),_e.blendEquationSeparate(_e.FUNC_ADD,Re?_e.MAX:Be.MAX_EXT),_e.clear(_e.COLOR_BUFFER_BIT),Re?_e.drawArraysInstanced(_e.TRIANGLES,0,3,me.length/4):Me.drawArraysInstancedANGLE(_e.TRIANGLES,0,3,me.length/4)})}),Ce("post",o,T,function(fe){fe.setAttribute("aUV",2,_e.STATIC_DRAW,0,S),fe.setUniform("1i","tex",ze),_e.bindFramebuffer(_e.FRAMEBUFFER,X),_e.disable(_e.BLEND),_e.colorMask(Ee===0,Ee===1,Ee===2,Ee===3),_e.viewport(J,oe,ne,re),_e.scissor(J,oe,ne,re),_e.drawArrays(_e.TRIANGLES,0,3)})}),_e.isContextLost())throw ye(),new Error("webgl context lost")})}function z(ne){var re=!ne||ne===C?R:ne.canvas||ne,P=M.get(re);if(P===void 0){A=!0;var se=null;try{var ue=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],te=k(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,ne);P=te&&ue.length===te.length&&te.every(function(W,X){return W===ue[X]}),P||(se="bad trial run results",console.info(ue,te))}catch(W){P=!1,se=W.message}se&&console.warn("WebGL SDF generation not supported:",se),A=!1,M.set(re,P)}return P}var O=Object.freeze({__proto__:null,generate:k,generateIntoCanvas:L,generateIntoFramebuffer:N,isSupported:z});function K(ne,re,P,se,ue,te){ue===void 0&&(ue=Math.max(se[2]-se[0],se[3]-se[1])/2),te===void 0&&(te=1);try{return k.apply(O,arguments)}catch(W){return console.info("WebGL SDF generation failed, falling back to JS",W),p.apply(x,arguments)}}function V(ne,re,P,se,ue,te,W,X,J,oe){ue===void 0&&(ue=Math.max(se[2]-se[0],se[3]-se[1])/2),te===void 0&&(te=1),X===void 0&&(X=0),J===void 0&&(J=0),oe===void 0&&(oe=0);try{return L.apply(O,arguments)}catch(Ee){return console.info("WebGL SDF generation failed, falling back to JS",Ee),m.apply(x,arguments)}}return e.forEachPathCommand=i,e.generate=K,e.generateIntoCanvas=V,e.javascript=x,e.pathToLineSegments=s,e.webgl=O,e.webglUtils=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}function Ude(){var t=function(e){var n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},r={},i={};r.L=1,i[1]="L",Object.keys(n).forEach(function(ye,ge){r[ye]=1<<ge+1,i[r[ye]]=ye}),Object.freeze(r);var s=r.LRI|r.RLI|r.FSI,o=r.L|r.R|r.AL,a=r.B|r.S|r.WS|r.ON|r.FSI|r.LRI|r.RLI|r.PDI,l=r.BN|r.RLE|r.LRE|r.RLO|r.LRO|r.PDF,c=r.S|r.WS|r.B|s|r.PDI|l,u=null;function f(){if(!u){u=new Map;var ye=function(ze){if(n.hasOwnProperty(ze)){var fe=0;n[ze].split(",").forEach(function(ie){var ve=ie.split("+"),Me=ve[0],Be=ve[1];Me=parseInt(Me,36),Be=Be?parseInt(Be,36):0,u.set(fe+=Me,r[ze]);for(var Ze=0;Ze<Be;Ze++)u.set(++fe,r[ze])})}};for(var ge in n)ye(ge)}}function d(ye){return f(),u.get(ye.codePointAt(0))||r.L}function h(ye){return i[d(ye)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(ye,ge){var ze=36,fe=0,ie=new Map,ve=ge&&new Map,Me;return ye.split(",").forEach(function Be(Ze){if(Ze.indexOf("+")!==-1)for(var F=+Ze;F--;)Be(Me);else{Me=Ze;var Z=Ze.split(">"),q=Z[0],xe=Z[1];q=String.fromCodePoint(fe+=parseInt(q,ze)),xe=String.fromCodePoint(fe+=parseInt(xe,ze)),ie.set(q,xe),ge&&ve.set(xe,q)}}),{map:ie,reverseMap:ve}}var g,y,x;function _(){if(!g){var ye=m(p.pairs,!0),ge=ye.map,ze=ye.reverseMap;g=ge,y=ze,x=m(p.canonical,!1).map}}function w(ye){return _(),g.get(ye)||null}function T(ye){return _(),y.get(ye)||null}function S(ye){return _(),x.get(ye)||null}var C=r.L,A=r.R,R=r.EN,M=r.ES,D=r.ET,k=r.AN,L=r.CS,N=r.B,z=r.S,O=r.ON,K=r.BN,V=r.NSM,ne=r.AL,re=r.LRO,P=r.RLO,se=r.LRE,ue=r.RLE,te=r.PDF,W=r.LRI,X=r.RLI,J=r.FSI,oe=r.PDI;function Ee(ye,ge){for(var ze=125,fe=new Uint32Array(ye.length),ie=0;ie<ye.length;ie++)fe[ie]=d(ye[ie]);var ve=new Map;function Me(ms,ho){var Pi=fe[ms];fe[ms]=ho,ve.set(Pi,ve.get(Pi)-1),Pi&a&&ve.set(a,ve.get(a)-1),ve.set(ho,(ve.get(ho)||0)+1),ho&a&&ve.set(a,(ve.get(a)||0)+1)}for(var Be=new Uint8Array(ye.length),Ze=new Map,F=[],Z=null,q=0;q<ye.length;q++)Z||F.push(Z={start:q,end:ye.length-1,level:ge==="rtl"?1:ge==="ltr"?0:bh(q,!1)}),fe[q]&N&&(Z.end=q,Z=null);for(var xe=ue|se|P|re|s|oe|te|N,be=function(ms){return ms+(ms&1?1:2)},De=function(ms){return ms+(ms&1?2:1)},$e=0;$e<F.length;$e++){Z=F[$e];var st=[{_level:Z.level,_override:0,_isolate:0}],it=void 0,Ie=0,Ye=0,at=0;ve.clear();for(var ke=Z.start;ke<=Z.end;ke++){var Xe=fe[ke];if(it=st[st.length-1],ve.set(Xe,(ve.get(Xe)||0)+1),Xe&a&&ve.set(a,(ve.get(a)||0)+1),Xe&xe)if(Xe&(ue|se)){Be[ke]=it._level;var Qe=(Xe===ue?De:be)(it._level);Qe<=ze&&!Ie&&!Ye?st.push({_level:Qe,_override:0,_isolate:0}):Ie||Ye++}else if(Xe&(P|re)){Be[ke]=it._level;var _t=(Xe===P?De:be)(it._level);_t<=ze&&!Ie&&!Ye?st.push({_level:_t,_override:Xe&P?A:C,_isolate:0}):Ie||Ye++}else if(Xe&s){Xe&J&&(Xe=bh(ke+1,!0)===1?X:W),Be[ke]=it._level,it._override&&Me(ke,it._override);var kt=(Xe===X?De:be)(it._level);kt<=ze&&Ie===0&&Ye===0?(at++,st.push({_level:kt,_override:0,_isolate:1,_isolInitIndex:ke})):Ie++}else if(Xe&oe){if(Ie>0)Ie--;else if(at>0){for(Ye=0;!st[st.length-1]._isolate;)st.pop();var Ct=st[st.length-1]._isolInitIndex;Ct!=null&&(Ze.set(Ct,ke),Ze.set(ke,Ct)),st.pop(),at--}it=st[st.length-1],Be[ke]=it._level,it._override&&Me(ke,it._override)}else Xe&te?(Ie===0&&(Ye>0?Ye--:!it._isolate&&st.length>1&&(st.pop(),it=st[st.length-1])),Be[ke]=it._level):Xe&N&&(Be[ke]=Z.level);else Be[ke]=it._level,it._override&&Xe!==K&&Me(ke,it._override)}for(var Kt=[],cn=null,sn=Z.start;sn<=Z.end;sn++){var Vt=fe[sn];if(!(Vt&l)){var Gn=Be[sn],rr=Vt&s,Cr=Vt===oe;cn&&Gn===cn._level?(cn._end=sn,cn._endsWithIsolInit=rr):Kt.push(cn={_start:sn,_end:sn,_level:Gn,_startsWithPDI:Cr,_endsWithIsolInit:rr})}}for(var wi=[],zr=0;zr<Kt.length;zr++){var mi=Kt[zr];if(!mi._startsWithPDI||mi._startsWithPDI&&!Ze.has(mi._start)){for(var gi=[cn=mi],Hr=void 0;cn&&cn._endsWithIsolInit&&(Hr=Ze.get(cn._end))!=null;)for(var An=zr+1;An<Kt.length;An++)if(Kt[An]._start===Hr){gi.push(cn=Kt[An]);break}for(var kr=[],Wi=0;Wi<gi.length;Wi++)for(var pe=gi[Wi],we=pe._start;we<=pe._end;we++)kr.push(we);for(var qe=Be[kr[0]],ut=Z.level,yt=kr[0]-1;yt>=0;yt--)if(!(fe[yt]&l)){ut=Be[yt];break}var vt=kr[kr.length-1],Ft=Be[vt],de=Z.level;if(!(fe[vt]&s)){for(var Le=vt+1;Le<=Z.end;Le++)if(!(fe[Le]&l)){de=Be[Le];break}}wi.push({_seqIndices:kr,_sosType:Math.max(ut,qe)%2?A:C,_eosType:Math.max(de,Ft)%2?A:C})}}for(var Ue=0;Ue<wi.length;Ue++){var He=wi[Ue],Se=He._seqIndices,Tt=He._sosType,xt=He._eosType,bt=Be[Se[0]]&1?A:C;if(ve.get(V))for(var Pt=0;Pt<Se.length;Pt++){var Bt=Se[Pt];if(fe[Bt]&V){for(var Xt=Tt,Ot=Pt-1;Ot>=0;Ot--)if(!(fe[Se[Ot]]&l)){Xt=fe[Se[Ot]];break}Me(Bt,Xt&(s|oe)?O:Xt)}}if(ve.get(R))for(var Ht=0;Ht<Se.length;Ht++){var Gt=Se[Ht];if(fe[Gt]&R)for(var dn=Ht-1;dn>=-1;dn--){var En=dn===-1?Tt:fe[Se[dn]];if(En&o){En===ne&&Me(Gt,k);break}}}if(ve.get(ne))for(var Zt=0;Zt<Se.length;Zt++){var qt=Se[Zt];fe[qt]&ne&&Me(qt,A)}if(ve.get(M)||ve.get(L))for(var jn=1;jn<Se.length-1;jn++){var wn=Se[jn];if(fe[wn]&(M|L)){for(var Zn=0,Nn=0,Jt=jn-1;Jt>=0&&(Zn=fe[Se[Jt]],!!(Zn&l));Jt--);for(var On=jn+1;On<Se.length&&(Nn=fe[Se[On]],!!(Nn&l));On++);Zn===Nn&&(fe[wn]===M?Zn===R:Zn&(R|k))&&Me(wn,Zn)}}if(ve.get(R))for(var on=0;on<Se.length;on++){var Un=Se[on];if(fe[Un]&R){for(var mr=on-1;mr>=0&&fe[Se[mr]]&(D|l);mr--)Me(Se[mr],R);for(on++;on<Se.length&&fe[Se[on]]&(D|l|R);on++)fe[Se[on]]!==R&&Me(Se[on],R)}}if(ve.get(D)||ve.get(M)||ve.get(L))for(var Bn=0;Bn<Se.length;Bn++){var sr=Se[Bn];if(fe[sr]&(D|M|L)){Me(sr,O);for(var Ii=Bn-1;Ii>=0&&fe[Se[Ii]]&l;Ii--)Me(Se[Ii],O);for(var Si=Bn+1;Si<Se.length&&fe[Se[Si]]&l;Si++)Me(Se[Si],O)}}if(ve.get(R))for(var _n=0,vn=Tt;_n<Se.length;_n++){var he=Se[_n],U=fe[he];U&R?vn===C&&Me(he,C):U&o&&(vn=U)}if(ve.get(a)){var j=A|R|k,Q=j|C,Y=[];{for(var ce=[],Fe=0;Fe<Se.length;Fe++)if(fe[Se[Fe]]&a){var je=ye[Se[Fe]],gt=void 0;if(w(je)!==null)if(ce.length<63)ce.push({char:je,seqIndex:Fe});else break;else if((gt=T(je))!==null)for(var lt=ce.length-1;lt>=0;lt--){var pt=ce[lt].char;if(pt===gt||pt===T(S(je))||w(S(pt))===je){Y.push([ce[lt].seqIndex,Fe]),ce.length=lt;break}}}Y.sort(function(ms,ho){return ms[0]-ho[0]})}for(var mt=0;mt<Y.length;mt++){for(var ct=Y[mt],dt=ct[0],Rt=ct[1],Nt=!1,jt=0,xn=dt+1;xn<Rt;xn++){var un=Se[xn];if(fe[un]&Q){Nt=!0;var nn=fe[un]&j?A:C;if(nn===bt){jt=nn;break}}}if(Nt&&!jt){jt=Tt;for(var Vn=dt-1;Vn>=0;Vn--){var Lr=Se[Vn];if(fe[Lr]&Q){var gr=fe[Lr]&j?A:C;gr!==bt?jt=gr:jt=bt;break}}}if(jt){if(fe[Se[dt]]=fe[Se[Rt]]=jt,jt!==bt){for(var ci=dt+1;ci<Se.length;ci++)if(!(fe[Se[ci]]&l)){d(ye[Se[ci]])&V&&(fe[Se[ci]]=jt);break}}if(jt!==bt){for(var co=Rt+1;co<Se.length;co++)if(!(fe[Se[co]]&l)){d(ye[Se[co]])&V&&(fe[Se[co]]=jt);break}}}}for(var uo=0;uo<Se.length;uo++)if(fe[Se[uo]]&a){for(var g0=uo,y0=uo,Po=Tt,kf=uo-1;kf>=0;kf--)if(fe[Se[kf]]&l)g0=kf;else{Po=fe[Se[kf]]&j?A:C;break}for(var Lf=xt,Df=uo+1;Df<Se.length;Df++)if(fe[Se[Df]]&(a|l))y0=Df;else{Lf=fe[Se[Df]]&j?A:C;break}for(var fo=g0;fo<=y0;fo++)fe[Se[fo]]=Po===Lf?Po:bt;uo=y0}}}for(var ps=Z.start;ps<=Z.end;ps++){var _h=Be[ps],sl=fe[ps];if(_h&1?sl&(C|R|k)&&Be[ps]++:sl&A?Be[ps]++:sl&(k|R)&&(Be[ps]+=2),sl&l&&(Be[ps]=ps===0?Z.level:Be[ps-1]),ps===Z.end||d(ye[ps])&(z|N))for(var xu=ps;xu>=0&&d(ye[xu])&c;xu--)Be[xu]=Z.level}}return{levels:Be,paragraphs:F};function bh(ms,ho){for(var Pi=ms;Pi<ye.length;Pi++){var ki=fe[Pi];if(ki&(A|ne))return 1;if(ki&(N|C)||ho&&ki===oe)return 0;if(ki&s){var Zo=rv(Pi);Pi=Zo===-1?ye.length:Zo}}return 0}function rv(ms){for(var ho=1,Pi=ms+1;Pi<ye.length;Pi++){var ki=fe[Pi];if(ki&N)break;if(ki&oe){if(--ho===0)return Pi}else ki&s&&ho++}return-1}}var me="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Te;function _e(){if(!Te){var ye=m(me,!0),ge=ye.map,ze=ye.reverseMap;ze.forEach(function(fe,ie){ge.set(ie,fe)}),Te=ge}}function Re(ye){return _e(),Te.get(ye)||null}function ae(ye,ge,ze,fe){var ie=ye.length;ze=Math.max(0,ze==null?0:+ze),fe=Math.min(ie-1,fe==null?ie-1:+fe);for(var ve=new Map,Me=ze;Me<=fe;Me++)if(ge[Me]&1){var Be=Re(ye[Me]);Be!==null&&ve.set(Me,Be)}return ve}function Ce(ye,ge,ze,fe){var ie=ye.length;ze=Math.max(0,ze==null?0:+ze),fe=Math.min(ie-1,fe==null?ie-1:+fe);var ve=[];return ge.paragraphs.forEach(function(Me){var Be=Math.max(ze,Me.start),Ze=Math.min(fe,Me.end);if(Be<Ze){for(var F=ge.levels.slice(Be,Ze+1),Z=Ze;Z>=Be&&d(ye[Z])&c;Z--)F[Z]=Me.level;for(var q=Me.level,xe=1/0,be=0;be<F.length;be++){var De=F[be];De>q&&(q=De),De<xe&&(xe=De|1)}for(var $e=q;$e>=xe;$e--)for(var st=0;st<F.length;st++)if(F[st]>=$e){for(var it=st;st+1<F.length&&F[st+1]>=$e;)st++;st>it&&ve.push([it+Be,st+Be])}}}),ve}function Pe(ye,ge,ze,fe){var ie=Ve(ye,ge,ze,fe),ve=[].concat(ye);return ie.forEach(function(Me,Be){ve[Be]=(ge.levels[Me]&1?Re(ye[Me]):null)||ye[Me]}),ve.join("")}function Ve(ye,ge,ze,fe){for(var ie=Ce(ye,ge,ze,fe),ve=[],Me=0;Me<ye.length;Me++)ve[Me]=Me;return ie.forEach(function(Be){for(var Ze=Be[0],F=Be[1],Z=ve.slice(Ze,F+1),q=Z.length;q--;)ve[F-q]=Z[q]}),ve}return e.closingToOpeningBracket=T,e.getBidiCharType=d,e.getBidiCharTypeName=h,e.getCanonicalBracket=S,e.getEmbeddingLevels=Ee,e.getMirroredCharacter=Re,e.getMirroredCharactersMap=ae,e.getReorderSegments=Ce,e.getReorderedIndices=Ve,e.getReorderedString=Pe,e.openingToClosingBracket=w,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}const WG=/\bvoid\s+main\s*\(\s*\)\s*{/g;function x5(t){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function n(r,i){let s=Fn[i];return s?x5(s):r}return t.replace(e,n)}const Us=[];for(let t=0;t<256;t++)Us[t]=(t<16?"0":"")+t.toString(16);function Bde(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Us[t&255]+Us[t>>8&255]+Us[t>>16&255]+Us[t>>24&255]+"-"+Us[e&255]+Us[e>>8&255]+"-"+Us[e>>16&15|64]+Us[e>>24&255]+"-"+Us[n&63|128]+Us[n>>8&255]+"-"+Us[n>>16&255]+Us[n>>24&255]+Us[r&255]+Us[r>>8&255]+Us[r>>16&255]+Us[r>>24&255]).toUpperCase()}const sd=Object.assign||function(){let t=arguments[0];for(let e=1,n=arguments.length;e<n;e++){let r=arguments[e];if(r)for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},zde=Date.now(),hk=new WeakMap,pk=new Map;let Hde=1e10;function _5(t,e){const n=Wde(e);let r=hk.get(t);if(r||hk.set(t,r=Object.create(null)),r[n])return new r[n];const i=`_onBeforeCompile${n}`,s=function(c,u){t.onBeforeCompile.call(this,c,u);const f=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader;let d=pk[f];if(!d){const h=Gde(this,c,e,n);d=pk[f]=h}c.vertexShader=d.vertexShader,c.fragmentShader=d.fragmentShader,sd(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-zde}}),this[i]&&this[i](c)},o=function(){return a(e.chained?t:t.clone())},a=function(c){const u=Object.create(c,l);return Object.defineProperty(u,"baseMaterial",{value:t}),Object.defineProperty(u,"id",{value:Hde++}),u.uuid=Bde(),u.uniforms=sd({},c.uniforms,e.uniforms),u.defines=sd({},c.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",u.extensions=sd({},c.extensions,e.extensions),u._listeners=void 0,u},l={constructor:{value:o},isDerivedMaterial:{value:!0},type:{get:()=>t.type,set:c=>{t.type=c}},isDerivedFrom:{writable:!0,configurable:!0,value:function(c){const u=this.baseMaterial;return c===u||u.isDerivedMaterial&&u.isDerivedFrom(c)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get(){return s},set(c){this[i]=c}},copy:{writable:!0,configurable:!0,value:function(c){return t.copy.call(this,c),!t.isShaderMaterial&&!t.isDerivedMaterial&&(sd(this.extensions,c.extensions),sd(this.defines,c.defines),sd(this.uniforms,mf.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const c=new t.constructor;return a(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=_5(t.isDerivedMaterial?t.getDepthMaterial():new zm({depthPacking:g6}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=_5(t.isDerivedMaterial?t.getDistanceMaterial():new Gb,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:c,_distanceMaterial:u}=this;c&&c.dispose(),u&&u.dispose(),t.dispose.call(this)}}};return r[n]=o,new o}function Gde(t,{vertexShader:e,fragmentShader:n},r,i){let{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:f,fragmentColorTransform:d,customRewriter:h,timeUniform:p}=r;if(s=s||"",o=o||"",a=a||"",c=c||"",u=u||"",f=f||"",(l||h)&&(e=x5(e)),(d||h)&&(n=n.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),n=x5(n)),h){let m=h({vertexShader:e,fragmentShader:n});e=m.vertexShader,n=m.fragmentShader}if(d){let m=[];n=n.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,g=>(m.push(g),"")),f=`${d}
${m.join(`
`)}
${f}`}if(p){const m=`
uniform float ${p};
`;s=m+s,c=m+c}return l&&(e=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${e}
`,s=`${s}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,o=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(m,g,y,x)=>/\battribute\s+vec[23]\s+$/.test(x.substr(0,y))?g:`troika_${g}_${i}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),e=mk(e,i,s,o,a),n=mk(n,i,c,u,f),{vertexShader:e,fragmentShader:n}}function mk(t,e,n,r,i){return(r||i||n)&&(t=t.replace(WG,`
${n}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${r}
  troikaOrigMain${e}();
  ${i}
}`),t}function jde(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}let Vde=0;const gk=new Map;function Wde(t){const e=JSON.stringify(t,jde);let n=gk.get(e);return n==null&&gk.set(e,n=++Vde),n}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function $de(){return typeof window>"u"&&(self.window=self),function(t){var e={parse:function(i){var s=e._bin,o=new Uint8Array(i);if(s.readASCII(o,0,4)=="ttcf"){var a=4;s.readUshort(o,a),a+=2,s.readUshort(o,a),a+=2;var l=s.readUint(o,a);a+=4;for(var c=[],u=0;u<l;u++){var f=s.readUint(o,a);a+=4,c.push(e._readFont(o,f))}return c}return[e._readFont(o,0)]},_readFont:function(i,s){var o=e._bin,a=s;o.readFixed(i,s),s+=4;var l=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:i,_offset:a},f={},d=0;d<l;d++){var h=o.readASCII(i,s,4);s+=4,o.readUint(i,s),s+=4;var p=o.readUint(i,s);s+=4;var m=o.readUint(i,s);s+=4,f[h]={offset:p,length:m}}for(d=0;d<c.length;d++){var g=c[d];f[g]&&(u[g.trim()]=e[g.trim()].parse(i,f[g].offset,f[g].length,u))}return u},_tabOffset:function(i,s,o){for(var a=e._bin,l=a.readUshort(i,o+4),c=o+12,u=0;u<l;u++){var f=a.readASCII(i,c,4);c+=4,a.readUint(i,c),c+=4;var d=a.readUint(i,c);if(c+=4,a.readUint(i,c),c+=4,f==s)return d}return 0}};e._bin={readFixed:function(i,s){return(i[s]<<8|i[s+1])+(i[s+2]<<8|i[s+3])/65540},readF2dot14:function(i,s){return e._bin.readShort(i,s)/16384},readInt:function(i,s){return e._bin._view(i).getInt32(s)},readInt8:function(i,s){return e._bin._view(i).getInt8(s)},readShort:function(i,s){return e._bin._view(i).getInt16(s)},readUshort:function(i,s){return e._bin._view(i).getUint16(s)},readUshorts:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(e._bin.readUshort(i,s+2*l));return a},readUint:function(i,s){return e._bin._view(i).getUint32(s)},readUint64:function(i,s){return 4294967296*e._bin.readUint(i,s)+e._bin.readUint(i,s+4)},readASCII:function(i,s,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(i[s+l]);return a},readUnicode:function(i,s,o){for(var a="",l=0;l<o;l++){var c=i[s++]<<8|i[s++];a+=String.fromCharCode(c)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(i,s,o){var a=e._bin._tdec;return a&&s==0&&o==i.length?a.decode(i):e._bin.readASCII(i,s,o)},readBytes:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(i[s+l]);return a},readASCIIArray:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(String.fromCharCode(i[s+l]));return a},_view:function(i){return i._dataView||(i._dataView=i.buffer?new DataView(i.buffer,i.byteOffset,i.byteLength):new DataView(new Uint8Array(i).buffer))}},e._lctf={},e._lctf.parse=function(i,s,o,a,l){var c=e._bin,u={},f=s;c.readFixed(i,s),s+=4;var d=c.readUshort(i,s);s+=2;var h=c.readUshort(i,s);s+=2;var p=c.readUshort(i,s);return s+=2,u.scriptList=e._lctf.readScriptList(i,f+d),u.featureList=e._lctf.readFeatureList(i,f+h),u.lookupList=e._lctf.readLookupList(i,f+p,l),u},e._lctf.readLookupList=function(i,s,o){var a=e._bin,l=s,c=[],u=a.readUshort(i,s);s+=2;for(var f=0;f<u;f++){var d=a.readUshort(i,s);s+=2;var h=e._lctf.readLookupTable(i,l+d,o);c.push(h)}return c},e._lctf.readLookupTable=function(i,s,o){var a=e._bin,l=s,c={tabs:[]};c.ltype=a.readUshort(i,s),s+=2,c.flag=a.readUshort(i,s),s+=2;var u=a.readUshort(i,s);s+=2;for(var f=c.ltype,d=0;d<u;d++){var h=a.readUshort(i,s);s+=2;var p=o(i,f,l+h,c);c.tabs.push(p)}return c},e._lctf.numOfOnes=function(i){for(var s=0,o=0;o<32;o++)i>>>o&1&&s++;return s},e._lctf.readClassDef=function(i,s){var o=e._bin,a=[],l=o.readUshort(i,s);if(s+=2,l==1){var c=o.readUshort(i,s);s+=2;var u=o.readUshort(i,s);s+=2;for(var f=0;f<u;f++)a.push(c+f),a.push(c+f),a.push(o.readUshort(i,s)),s+=2}if(l==2){var d=o.readUshort(i,s);for(s+=2,f=0;f<d;f++)a.push(o.readUshort(i,s)),s+=2,a.push(o.readUshort(i,s)),s+=2,a.push(o.readUshort(i,s)),s+=2}return a},e._lctf.getInterval=function(i,s){for(var o=0;o<i.length;o+=3){var a=i[o],l=i[o+1];if(i[o+2],a<=s&&s<=l)return o}return-1},e._lctf.readCoverage=function(i,s){var o=e._bin,a={};a.fmt=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);return s+=2,a.fmt==1&&(a.tab=o.readUshorts(i,s,l)),a.fmt==2&&(a.tab=o.readUshorts(i,s,3*l)),a},e._lctf.coverageIndex=function(i,s){var o=i.tab;if(i.fmt==1)return o.indexOf(s);if(i.fmt==2){var a=e._lctf.getInterval(o,s);if(a!=-1)return o[a+2]+(s-o[a])}return-1},e._lctf.readFeatureList=function(i,s){var o=e._bin,a=s,l=[],c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readASCII(i,s,4);s+=4;var d=o.readUshort(i,s);s+=2;var h=e._lctf.readFeatureTable(i,a+d);h.tag=f.trim(),l.push(h)}return l},e._lctf.readFeatureTable=function(i,s){var o=e._bin,a=s,l={},c=o.readUshort(i,s);s+=2,c>0&&(l.featureParams=a+c);var u=o.readUshort(i,s);s+=2,l.tab=[];for(var f=0;f<u;f++)l.tab.push(o.readUshort(i,s+2*f));return l},e._lctf.readScriptList=function(i,s){var o=e._bin,a=s,l={},c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readASCII(i,s,4);s+=4;var d=o.readUshort(i,s);s+=2,l[f.trim()]=e._lctf.readScriptTable(i,a+d)}return l},e._lctf.readScriptTable=function(i,s){var o=e._bin,a=s,l={},c=o.readUshort(i,s);s+=2,c>0&&(l.default=e._lctf.readLangSysTable(i,a+c));var u=o.readUshort(i,s);s+=2;for(var f=0;f<u;f++){var d=o.readASCII(i,s,4);s+=4;var h=o.readUshort(i,s);s+=2,l[d.trim()]=e._lctf.readLangSysTable(i,a+h)}return l},e._lctf.readLangSysTable=function(i,s){var o=e._bin,a={};o.readUshort(i,s),s+=2,a.reqFeature=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);return s+=2,a.features=o.readUshorts(i,s,l),a},e.CFF={},e.CFF.parse=function(i,s,o){var a=e._bin;(i=new Uint8Array(i.buffer,s,o))[s=0],i[++s],i[++s],i[++s],s++;var l=[];s=e.CFF.readIndex(i,s,l);for(var c=[],u=0;u<l.length-1;u++)c.push(a.readASCII(i,s+l[u],l[u+1]-l[u]));s+=l[l.length-1];var f=[];s=e.CFF.readIndex(i,s,f);var d=[];for(u=0;u<f.length-1;u++)d.push(e.CFF.readDict(i,s+f[u],s+f[u+1]));s+=f[f.length-1];var h=d[0],p=[];s=e.CFF.readIndex(i,s,p);var m=[];for(u=0;u<p.length-1;u++)m.push(a.readASCII(i,s+p[u],p[u+1]-p[u]));if(s+=p[p.length-1],e.CFF.readSubrs(i,s,h),h.CharStrings){s=h.CharStrings,p=[],s=e.CFF.readIndex(i,s,p);var g=[];for(u=0;u<p.length-1;u++)g.push(a.readBytes(i,s+p[u],p[u+1]-p[u]));h.CharStrings=g}if(h.ROS){s=h.FDArray;var y=[];for(s=e.CFF.readIndex(i,s,y),h.FDArray=[],u=0;u<y.length-1;u++){var x=e.CFF.readDict(i,s+y[u],s+y[u+1]);e.CFF._readFDict(i,x,m),h.FDArray.push(x)}s+=y[y.length-1],s=h.FDSelect,h.FDSelect=[];var _=i[s];if(s++,_!=3)throw _;var w=a.readUshort(i,s);for(s+=2,u=0;u<w+1;u++)h.FDSelect.push(a.readUshort(i,s),i[s+2]),s+=3}return h.Encoding&&(h.Encoding=e.CFF.readEncoding(i,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=e.CFF.readCharset(i,h.charset,h.CharStrings.length)),e.CFF._readFDict(i,h,m),h},e.CFF._readFDict=function(i,s,o){var a;for(var l in s.Private&&(a=s.Private[1],s.Private=e.CFF.readDict(i,a,a+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(i,a+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(s[l]=o[s[l]-426+35])},e.CFF.readSubrs=function(i,s,o){var a=e._bin,l=[];s=e.CFF.readIndex(i,s,l);var c,u=l.length;c=u<1240?107:u<33900?1131:32768,o.Bias=c,o.Subrs=[];for(var f=0;f<l.length-1;f++)o.Subrs.push(a.readBytes(i,s+l[f],l[f+1]-l[f]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(i,s){for(var o=0;o<i.charset.length;o++)if(i.charset[o]==s)return o;return-1},e.CFF.glyphBySE=function(i,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(i,e.CFF.tableSE[s])},e.CFF.readEncoding=function(i,s,o){e._bin;var a=[".notdef"],l=i[s];if(s++,l!=0)throw"error: unknown encoding format: "+l;var c=i[s];s++;for(var u=0;u<c;u++)a.push(i[s+u]);return a},e.CFF.readCharset=function(i,s,o){var a=e._bin,l=[".notdef"],c=i[s];if(s++,c==0)for(var u=0;u<o;u++){var f=a.readUshort(i,s);s+=2,l.push(f)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<o;){f=a.readUshort(i,s),s+=2;var d=0;for(c==1?(d=i[s],s++):(d=a.readUshort(i,s),s+=2),u=0;u<=d;u++)l.push(f),f++}}return l},e.CFF.readIndex=function(i,s,o){var a=e._bin,l=a.readUshort(i,s)+1,c=i[s+=2];if(s++,c==1)for(var u=0;u<l;u++)o.push(i[s+u]);else if(c==2)for(u=0;u<l;u++)o.push(a.readUshort(i,s+2*u));else if(c==3)for(u=0;u<l;u++)o.push(16777215&a.readUint(i,s+3*u-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(s+=l*c)-1},e.CFF.getCharString=function(i,s,o){var a=e._bin,l=i[s],c=i[s+1];i[s+2],i[s+3],i[s+4];var u=1,f=null,d=null;l<=20&&(f=l,u=1),l==12&&(f=100*l+c,u=2),21<=l&&l<=27&&(f=l,u=1),l==28&&(d=a.readShort(i,s+1),u=3),29<=l&&l<=31&&(f=l,u=1),32<=l&&l<=246&&(d=l-139,u=1),247<=l&&l<=250&&(d=256*(l-247)+c+108,u=2),251<=l&&l<=254&&(d=256*-(l-251)-c-108,u=2),l==255&&(d=a.readInt(i,s+1)/65535,u=5),o.val=d??"o"+f,o.size=u},e.CFF.readCharString=function(i,s,o){for(var a=s+o,l=e._bin,c=[];s<a;){var u=i[s],f=i[s+1];i[s+2],i[s+3],i[s+4];var d=1,h=null,p=null;u<=20&&(h=u,d=1),u==12&&(h=100*u+f,d=2),u!=19&&u!=20||(h=u,d=2),21<=u&&u<=27&&(h=u,d=1),u==28&&(p=l.readShort(i,s+1),d=3),29<=u&&u<=31&&(h=u,d=1),32<=u&&u<=246&&(p=u-139,d=1),247<=u&&u<=250&&(p=256*(u-247)+f+108,d=2),251<=u&&u<=254&&(p=256*-(u-251)-f-108,d=2),u==255&&(p=l.readInt(i,s+1)/65535,d=5),c.push(p??"o"+h),s+=d}return c},e.CFF.readDict=function(i,s,o){for(var a=e._bin,l={},c=[];s<o;){var u=i[s],f=i[s+1];i[s+2],i[s+3],i[s+4];var d=1,h=null,p=null;if(u==28&&(p=a.readShort(i,s+1),d=3),u==29&&(p=a.readInt(i,s+1),d=5),32<=u&&u<=246&&(p=u-139,d=1),247<=u&&u<=250&&(p=256*(u-247)+f+108,d=2),251<=u&&u<=254&&(p=256*-(u-251)-f-108,d=2),u==255)throw p=a.readInt(i,s+1)/65535,d=5,"unknown number";if(u==30){var m=[];for(d=1;;){var g=i[s+d];d++;var y=g>>4,x=15&g;if(y!=15&&m.push(y),x!=15&&m.push(x),x==15)break}for(var _="",w=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],T=0;T<m.length;T++)_+=w[m[T]];p=parseFloat(_)}u<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],d=1,u==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],d=2)),h!=null?(l[h]=c.length==1?c[0]:c,c=[]):c.push(p),s+=d}return l},e.cmap={},e.cmap.parse=function(i,s,o){i=new Uint8Array(i.buffer,s,o),s=0;var a=e._bin,l={};a.readUshort(i,s),s+=2;var c=a.readUshort(i,s);s+=2;var u=[];l.tables=[];for(var f=0;f<c;f++){var d=a.readUshort(i,s);s+=2;var h=a.readUshort(i,s);s+=2;var p=a.readUint(i,s);s+=4;var m="p"+d+"e"+h,g=u.indexOf(p);if(g==-1){var y;g=l.tables.length,u.push(p);var x=a.readUshort(i,p);x==0?y=e.cmap.parse0(i,p):x==4?y=e.cmap.parse4(i,p):x==6?y=e.cmap.parse6(i,p):x==12?y=e.cmap.parse12(i,p):console.debug("unknown format: "+x,d,h,p),l.tables.push(y)}if(l[m]!=null)throw"multiple tables for one platform+encoding";l[m]=g}return l},e.cmap.parse0=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2,a.map=[];for(var c=0;c<l-6;c++)a.map.push(i[s+c]);return a},e.cmap.parse4=function(i,s){var o=e._bin,a=s,l={};l.format=o.readUshort(i,s),s+=2;var c=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2;var u=o.readUshort(i,s);s+=2;var f=u/2;l.searchRange=o.readUshort(i,s),s+=2,l.entrySelector=o.readUshort(i,s),s+=2,l.rangeShift=o.readUshort(i,s),s+=2,l.endCount=o.readUshorts(i,s,f),s+=2*f,s+=2,l.startCount=o.readUshorts(i,s,f),s+=2*f,l.idDelta=[];for(var d=0;d<f;d++)l.idDelta.push(o.readShort(i,s)),s+=2;for(l.idRangeOffset=o.readUshorts(i,s,f),s+=2*f,l.glyphIdArray=[];s<a+c;)l.glyphIdArray.push(o.readUshort(i,s)),s+=2;return l},e.cmap.parse6=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,a.firstCode=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2,a.glyphIdArray=[];for(var c=0;c<l;c++)a.glyphIdArray.push(o.readUshort(i,s)),s+=2;return a},e.cmap.parse12=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2,s+=2,o.readUint(i,s),s+=4,o.readUint(i,s),s+=4;var l=o.readUint(i,s);s+=4,a.groups=[];for(var c=0;c<l;c++){var u=s+12*c,f=o.readUint(i,u+0),d=o.readUint(i,u+4),h=o.readUint(i,u+8);a.groups.push([f,d,h])}return a},e.glyf={},e.glyf.parse=function(i,s,o,a){for(var l=[],c=0;c<a.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(i,s){var o=e._bin,a=i._data,l=e._tabOffset(a,"glyf",i._offset)+i.loca[s];if(i.loca[s]==i.loca[s+1])return null;var c={};if(c.noc=o.readShort(a,l),l+=2,c.xMin=o.readShort(a,l),l+=2,c.yMin=o.readShort(a,l),l+=2,c.xMax=o.readShort(a,l),l+=2,c.yMax=o.readShort(a,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var u=0;u<c.noc;u++)c.endPts.push(o.readUshort(a,l)),l+=2;var f=o.readUshort(a,l);if(l+=2,a.length-l<f)return null;c.instructions=o.readBytes(a,l,f),l+=f;var d=c.endPts[c.noc-1]+1;for(c.flags=[],u=0;u<d;u++){var h=a[l];if(l++,c.flags.push(h),(8&h)!=0){var p=a[l];l++;for(var m=0;m<p;m++)c.flags.push(h),u++}}for(c.xs=[],u=0;u<d;u++){var g=(2&c.flags[u])!=0,y=(16&c.flags[u])!=0;g?(c.xs.push(y?a[l]:-a[l]),l++):y?c.xs.push(0):(c.xs.push(o.readShort(a,l)),l+=2)}for(c.ys=[],u=0;u<d;u++)g=(4&c.flags[u])!=0,y=(32&c.flags[u])!=0,g?(c.ys.push(y?a[l]:-a[l]),l++):y?c.ys.push(0):(c.ys.push(o.readShort(a,l)),l+=2);var x=0,_=0;for(u=0;u<d;u++)x+=c.xs[u],_+=c.ys[u],c.xs[u]=x,c.ys[u]=_}else{var w;c.parts=[];do{w=o.readUshort(a,l),l+=2;var T={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(T),T.glyphIndex=o.readUshort(a,l),l+=2,1&w){var S=o.readShort(a,l);l+=2;var C=o.readShort(a,l);l+=2}else S=o.readInt8(a,l),l++,C=o.readInt8(a,l),l++;2&w?(T.m.tx=S,T.m.ty=C):(T.p1=S,T.p2=C),8&w?(T.m.a=T.m.d=o.readF2dot14(a,l),l+=2):64&w?(T.m.a=o.readF2dot14(a,l),l+=2,T.m.d=o.readF2dot14(a,l),l+=2):128&w&&(T.m.a=o.readF2dot14(a,l),l+=2,T.m.b=o.readF2dot14(a,l),l+=2,T.m.c=o.readF2dot14(a,l),l+=2,T.m.d=o.readF2dot14(a,l),l+=2)}while(32&w);if(256&w){var A=o.readUshort(a,l);for(l+=2,c.instr=[],u=0;u<A;u++)c.instr.push(a[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(i,s,o,a){var l=s;s+=4;var c=e._bin.readUshort(i,s);return{glyphClassDef:c===0?null:e._lctf.readClassDef(i,l+c)}},e.GPOS={},e.GPOS.parse=function(i,s,o,a){return e._lctf.parse(i,s,o,a,e.GPOS.subt)},e.GPOS.subt=function(i,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(i,o),o+=2,s==1||s==2||s==3||s==7||s==8&&u.fmt<=2){var f=l.readUshort(i,o);o+=2,u.coverage=e._lctf.readCoverage(i,f+c)}if(s==1&&u.fmt==1){var d=l.readUshort(i,o);o+=2,d!=0&&(u.pos=e.GPOS.readValueRecord(i,o,d))}else if(s==2&&u.fmt>=1&&u.fmt<=2){d=l.readUshort(i,o),o+=2;var h=l.readUshort(i,o);o+=2;var p=e._lctf.numOfOnes(d),m=e._lctf.numOfOnes(h);if(u.fmt==1){u.pairsets=[];var g=l.readUshort(i,o);o+=2;for(var y=0;y<g;y++){var x=c+l.readUshort(i,o);o+=2;var _=l.readUshort(i,x);x+=2;for(var w=[],T=0;T<_;T++){var S=l.readUshort(i,x);x+=2,d!=0&&(k=e.GPOS.readValueRecord(i,x,d),x+=2*p),h!=0&&(L=e.GPOS.readValueRecord(i,x,h),x+=2*m),w.push({gid2:S,val1:k,val2:L})}u.pairsets.push(w)}}if(u.fmt==2){var C=l.readUshort(i,o);o+=2;var A=l.readUshort(i,o);o+=2;var R=l.readUshort(i,o);o+=2;var M=l.readUshort(i,o);for(o+=2,u.classDef1=e._lctf.readClassDef(i,c+C),u.classDef2=e._lctf.readClassDef(i,c+A),u.matrix=[],y=0;y<R;y++){var D=[];for(T=0;T<M;T++){var k=null,L=null;d!=0&&(k=e.GPOS.readValueRecord(i,o,d),o+=2*p),h!=0&&(L=e.GPOS.readValueRecord(i,o,h),o+=2*m),D.push({val1:k,val2:L})}u.matrix.push(D)}}}else if(s==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(i,l.readUshort(i,o)+c),u.baseCoverage=e._lctf.readCoverage(i,l.readUshort(i,o+2)+c),u.markClassCount=l.readUshort(i,o+4),u.markArray=e.GPOS.readMarkArray(i,l.readUshort(i,o+6)+c),u.baseArray=e.GPOS.readBaseArray(i,l.readUshort(i,o+8)+c,u.markClassCount);else if(s==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(i,l.readUshort(i,o)+c),u.mark2Coverage=e._lctf.readCoverage(i,l.readUshort(i,o+2)+c),u.markClassCount=l.readUshort(i,o+4),u.mark1Array=e.GPOS.readMarkArray(i,l.readUshort(i,o+6)+c),u.mark2Array=e.GPOS.readBaseArray(i,l.readUshort(i,o+8)+c,u.markClassCount);else{if(s==9&&u.fmt==1){var N=l.readUshort(i,o);o+=2;var z=l.readUint(i,o);if(o+=4,a.ltype==9)a.ltype=N;else if(a.ltype!=N)throw"invalid extension substitution";return e.GPOS.subt(i,a.ltype,c+z)}console.debug("unsupported GPOS table LookupType",s,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(i,s,o){var a=e._bin,l=[];return l.push(1&o?a.readShort(i,s):0),s+=1&o?2:0,l.push(2&o?a.readShort(i,s):0),s+=2&o?2:0,l.push(4&o?a.readShort(i,s):0),s+=4&o?2:0,l.push(8&o?a.readShort(i,s):0),s+=8&o?2:0,l},e.GPOS.readBaseArray=function(i,s,o){var a=e._bin,l=[],c=s,u=a.readUshort(i,s);s+=2;for(var f=0;f<u;f++){for(var d=[],h=0;h<o;h++)d.push(e.GPOS.readAnchorRecord(i,c+a.readUshort(i,s))),s+=2;l.push(d)}return l},e.GPOS.readMarkArray=function(i,s){var o=e._bin,a=[],l=s,c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=e.GPOS.readAnchorRecord(i,o.readUshort(i,s+2)+l);f.markClass=o.readUshort(i,s),a.push(f),s+=4}return a},e.GPOS.readAnchorRecord=function(i,s){var o=e._bin,a={};return a.fmt=o.readUshort(i,s),a.x=o.readShort(i,s+2),a.y=o.readShort(i,s+4),a},e.GSUB={},e.GSUB.parse=function(i,s,o,a){return e._lctf.parse(i,s,o,a,e.GSUB.subt)},e.GSUB.subt=function(i,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(i,o),o+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&u.fmt<=2||s==6&&u.fmt<=2){var f=l.readUshort(i,o);o+=2,u.coverage=e._lctf.readCoverage(i,c+f)}if(s==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=l.readShort(i,o),o+=2;else if(u.fmt==2){var d=l.readUshort(i,o);o+=2,u.newg=l.readUshorts(i,o,d),o+=2*u.newg.length}}else if(s==2&&u.fmt==1){d=l.readUshort(i,o),o+=2,u.seqs=[];for(var h=0;h<d;h++){var p=l.readUshort(i,o)+c;o+=2;var m=l.readUshort(i,p);u.seqs.push(l.readUshorts(i,p+2,m))}}else if(s==4)for(u.vals=[],d=l.readUshort(i,o),o+=2,h=0;h<d;h++){var g=l.readUshort(i,o);o+=2,u.vals.push(e.GSUB.readLigatureSet(i,c+g))}else if(s==5&&u.fmt==2){if(u.fmt==2){var y=l.readUshort(i,o);o+=2,u.cDef=e._lctf.readClassDef(i,c+y),u.scset=[];var x=l.readUshort(i,o);for(o+=2,h=0;h<x;h++){var _=l.readUshort(i,o);o+=2,u.scset.push(_==0?null:e.GSUB.readSubClassSet(i,c+_))}}}else if(s==6&&u.fmt==3){if(u.fmt==3){for(h=0;h<3;h++){d=l.readUshort(i,o),o+=2;for(var w=[],T=0;T<d;T++)w.push(e._lctf.readCoverage(i,c+l.readUshort(i,o+2*T)));o+=2*d,h==0&&(u.backCvg=w),h==1&&(u.inptCvg=w),h==2&&(u.ahedCvg=w)}d=l.readUshort(i,o),o+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(i,o,d)}}else{if(s==7&&u.fmt==1){var S=l.readUshort(i,o);o+=2;var C=l.readUint(i,o);if(o+=4,a.ltype==9)a.ltype=S;else if(a.ltype!=S)throw"invalid extension substitution";return e.GSUB.subt(i,a.ltype,c+C)}console.debug("unsupported GSUB table LookupType",s,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(i,s){var o=e._bin.readUshort,a=s,l=[],c=o(i,s);s+=2;for(var u=0;u<c;u++){var f=o(i,s);s+=2,l.push(e.GSUB.readSubClassRule(i,a+f))}return l},e.GSUB.readSubClassRule=function(i,s){var o=e._bin.readUshort,a={},l=o(i,s),c=o(i,s+=2);s+=2,a.input=[];for(var u=0;u<l-1;u++)a.input.push(o(i,s)),s+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(i,s,c),a},e.GSUB.readSubstLookupRecords=function(i,s,o){for(var a=e._bin.readUshort,l=[],c=0;c<o;c++)l.push(a(i,s),a(i,s+2)),s+=4;return l},e.GSUB.readChainSubClassSet=function(i,s){var o=e._bin,a=s,l=[],c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readUshort(i,s);s+=2,l.push(e.GSUB.readChainSubClassRule(i,a+f))}return l},e.GSUB.readChainSubClassRule=function(i,s){for(var o=e._bin,a={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var u=o.readUshort(i,s);s+=2,c==1&&u--,a[l[c]]=o.readUshorts(i,s,u),s+=2*a[l[c]].length}return u=o.readUshort(i,s),s+=2,a.subst=o.readUshorts(i,s,2*u),s+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(i,s){var o=e._bin,a=s,l=[],c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readUshort(i,s);s+=2,l.push(e.GSUB.readLigature(i,a+f))}return l},e.GSUB.readLigature=function(i,s){var o=e._bin,a={chain:[]};a.nglyph=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2;for(var c=0;c<l-1;c++)a.chain.push(o.readUshort(i,s)),s+=2;return a},e.head={},e.head.parse=function(i,s,o){var a=e._bin,l={};return a.readFixed(i,s),s+=4,l.fontRevision=a.readFixed(i,s),s+=4,a.readUint(i,s),s+=4,a.readUint(i,s),s+=4,l.flags=a.readUshort(i,s),s+=2,l.unitsPerEm=a.readUshort(i,s),s+=2,l.created=a.readUint64(i,s),s+=8,l.modified=a.readUint64(i,s),s+=8,l.xMin=a.readShort(i,s),s+=2,l.yMin=a.readShort(i,s),s+=2,l.xMax=a.readShort(i,s),s+=2,l.yMax=a.readShort(i,s),s+=2,l.macStyle=a.readUshort(i,s),s+=2,l.lowestRecPPEM=a.readUshort(i,s),s+=2,l.fontDirectionHint=a.readShort(i,s),s+=2,l.indexToLocFormat=a.readShort(i,s),s+=2,l.glyphDataFormat=a.readShort(i,s),s+=2,l},e.hhea={},e.hhea.parse=function(i,s,o){var a=e._bin,l={};return a.readFixed(i,s),s+=4,l.ascender=a.readShort(i,s),s+=2,l.descender=a.readShort(i,s),s+=2,l.lineGap=a.readShort(i,s),s+=2,l.advanceWidthMax=a.readUshort(i,s),s+=2,l.minLeftSideBearing=a.readShort(i,s),s+=2,l.minRightSideBearing=a.readShort(i,s),s+=2,l.xMaxExtent=a.readShort(i,s),s+=2,l.caretSlopeRise=a.readShort(i,s),s+=2,l.caretSlopeRun=a.readShort(i,s),s+=2,l.caretOffset=a.readShort(i,s),s+=2,s+=8,l.metricDataFormat=a.readShort(i,s),s+=2,l.numberOfHMetrics=a.readUshort(i,s),s+=2,l},e.hmtx={},e.hmtx.parse=function(i,s,o,a){for(var l=e._bin,c={aWidth:[],lsBearing:[]},u=0,f=0,d=0;d<a.maxp.numGlyphs;d++)d<a.hhea.numberOfHMetrics&&(u=l.readUshort(i,s),s+=2,f=l.readShort(i,s),s+=2),c.aWidth.push(u),c.lsBearing.push(f);return c},e.kern={},e.kern.parse=function(i,s,o,a){var l=e._bin,c=l.readUshort(i,s);if(s+=2,c==1)return e.kern.parseV1(i,s-2,o,a);var u=l.readUshort(i,s);s+=2;for(var f={glyph1:[],rval:[]},d=0;d<u;d++){s+=2,o=l.readUshort(i,s),s+=2;var h=l.readUshort(i,s);s+=2;var p=h>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;s=e.kern.readFormat0(i,s,f)}return f},e.kern.parseV1=function(i,s,o,a){var l=e._bin;l.readFixed(i,s),s+=4;var c=l.readUint(i,s);s+=4;for(var u={glyph1:[],rval:[]},f=0;f<c;f++){l.readUint(i,s),s+=4;var d=l.readUshort(i,s);s+=2,l.readUshort(i,s),s+=2;var h=d>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;s=e.kern.readFormat0(i,s,u)}return u},e.kern.readFormat0=function(i,s,o){var a=e._bin,l=-1,c=a.readUshort(i,s);s+=2,a.readUshort(i,s),s+=2,a.readUshort(i,s),s+=2,a.readUshort(i,s),s+=2;for(var u=0;u<c;u++){var f=a.readUshort(i,s);s+=2;var d=a.readUshort(i,s);s+=2;var h=a.readShort(i,s);s+=2,f!=l&&(o.glyph1.push(f),o.rval.push({glyph2:[],vals:[]}));var p=o.rval[o.rval.length-1];p.glyph2.push(d),p.vals.push(h),l=f}return s},e.loca={},e.loca.parse=function(i,s,o,a){var l=e._bin,c=[],u=a.head.indexToLocFormat,f=a.maxp.numGlyphs+1;if(u==0)for(var d=0;d<f;d++)c.push(l.readUshort(i,s+(d<<1))<<1);if(u==1)for(d=0;d<f;d++)c.push(l.readUint(i,s+(d<<2)));return c},e.maxp={},e.maxp.parse=function(i,s,o){var a=e._bin,l={},c=a.readUint(i,s);return s+=4,l.numGlyphs=a.readUshort(i,s),s+=2,c==65536&&(l.maxPoints=a.readUshort(i,s),s+=2,l.maxContours=a.readUshort(i,s),s+=2,l.maxCompositePoints=a.readUshort(i,s),s+=2,l.maxCompositeContours=a.readUshort(i,s),s+=2,l.maxZones=a.readUshort(i,s),s+=2,l.maxTwilightPoints=a.readUshort(i,s),s+=2,l.maxStorage=a.readUshort(i,s),s+=2,l.maxFunctionDefs=a.readUshort(i,s),s+=2,l.maxInstructionDefs=a.readUshort(i,s),s+=2,l.maxStackElements=a.readUshort(i,s),s+=2,l.maxSizeOfInstructions=a.readUshort(i,s),s+=2,l.maxComponentElements=a.readUshort(i,s),s+=2,l.maxComponentDepth=a.readUshort(i,s),s+=2),l},e.name={},e.name.parse=function(i,s,o){var a=e._bin,l={};a.readUshort(i,s),s+=2;var c=a.readUshort(i,s);s+=2,a.readUshort(i,s);for(var u,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=s+=2,h=0;h<c;h++){var p=a.readUshort(i,s);s+=2;var m=a.readUshort(i,s);s+=2;var g=a.readUshort(i,s);s+=2;var y=a.readUshort(i,s);s+=2;var x=a.readUshort(i,s);s+=2;var _=a.readUshort(i,s);s+=2;var w,T=f[y],S=d+12*c+_;if(p==0)w=a.readUnicode(i,S,x/2);else if(p==3&&m==0)w=a.readUnicode(i,S,x/2);else if(m==0)w=a.readASCII(i,S,x);else if(m==1)w=a.readUnicode(i,S,x/2);else if(m==3)w=a.readUnicode(i,S,x/2);else{if(p!=1)throw"unknown encoding "+m+", platformID: "+p;w=a.readASCII(i,S,x),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var C="p"+p+","+g.toString(16);l[C]==null&&(l[C]={}),l[C][T!==void 0?T:y]=w,l[C]._lang=g}for(var A in l)if(l[A].postScriptName!=null&&l[A]._lang==1033)return l[A];for(var A in l)if(l[A].postScriptName!=null&&l[A]._lang==0)return l[A];for(var A in l)if(l[A].postScriptName!=null&&l[A]._lang==3084)return l[A];for(var A in l)if(l[A].postScriptName!=null)return l[A];for(var A in l){u=A;break}return console.debug("returning name table with languageID "+l[u]._lang),l[u]},e["OS/2"]={},e["OS/2"].parse=function(i,s,o){var a=e._bin.readUshort(i,s);s+=2;var l={};if(a==0)e["OS/2"].version0(i,s,l);else if(a==1)e["OS/2"].version1(i,s,l);else if(a==2||a==3||a==4)e["OS/2"].version2(i,s,l);else{if(a!=5)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(i,s,l)}return l},e["OS/2"].version0=function(i,s,o){var a=e._bin;return o.xAvgCharWidth=a.readShort(i,s),s+=2,o.usWeightClass=a.readUshort(i,s),s+=2,o.usWidthClass=a.readUshort(i,s),s+=2,o.fsType=a.readUshort(i,s),s+=2,o.ySubscriptXSize=a.readShort(i,s),s+=2,o.ySubscriptYSize=a.readShort(i,s),s+=2,o.ySubscriptXOffset=a.readShort(i,s),s+=2,o.ySubscriptYOffset=a.readShort(i,s),s+=2,o.ySuperscriptXSize=a.readShort(i,s),s+=2,o.ySuperscriptYSize=a.readShort(i,s),s+=2,o.ySuperscriptXOffset=a.readShort(i,s),s+=2,o.ySuperscriptYOffset=a.readShort(i,s),s+=2,o.yStrikeoutSize=a.readShort(i,s),s+=2,o.yStrikeoutPosition=a.readShort(i,s),s+=2,o.sFamilyClass=a.readShort(i,s),s+=2,o.panose=a.readBytes(i,s,10),s+=10,o.ulUnicodeRange1=a.readUint(i,s),s+=4,o.ulUnicodeRange2=a.readUint(i,s),s+=4,o.ulUnicodeRange3=a.readUint(i,s),s+=4,o.ulUnicodeRange4=a.readUint(i,s),s+=4,o.achVendID=[a.readInt8(i,s),a.readInt8(i,s+1),a.readInt8(i,s+2),a.readInt8(i,s+3)],s+=4,o.fsSelection=a.readUshort(i,s),s+=2,o.usFirstCharIndex=a.readUshort(i,s),s+=2,o.usLastCharIndex=a.readUshort(i,s),s+=2,o.sTypoAscender=a.readShort(i,s),s+=2,o.sTypoDescender=a.readShort(i,s),s+=2,o.sTypoLineGap=a.readShort(i,s),s+=2,o.usWinAscent=a.readUshort(i,s),s+=2,o.usWinDescent=a.readUshort(i,s),s+=2},e["OS/2"].version1=function(i,s,o){var a=e._bin;return s=e["OS/2"].version0(i,s,o),o.ulCodePageRange1=a.readUint(i,s),s+=4,o.ulCodePageRange2=a.readUint(i,s),s+=4},e["OS/2"].version2=function(i,s,o){var a=e._bin;return s=e["OS/2"].version1(i,s,o),o.sxHeight=a.readShort(i,s),s+=2,o.sCapHeight=a.readShort(i,s),s+=2,o.usDefault=a.readUshort(i,s),s+=2,o.usBreak=a.readUshort(i,s),s+=2,o.usMaxContext=a.readUshort(i,s),s+=2},e["OS/2"].version5=function(i,s,o){var a=e._bin;return s=e["OS/2"].version2(i,s,o),o.usLowerOpticalPointSize=a.readUshort(i,s),s+=2,o.usUpperOpticalPointSize=a.readUshort(i,s),s+=2},e.post={},e.post.parse=function(i,s,o){var a=e._bin,l={};return l.version=a.readFixed(i,s),s+=4,l.italicAngle=a.readFixed(i,s),s+=4,l.underlinePosition=a.readShort(i,s),s+=2,l.underlineThickness=a.readShort(i,s),s+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(i,s){var o=i.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var l=o.tables[a];if(l.format==0)return s>=l.map.length?0:l.map[s];if(l.format==4){for(var c=-1,u=0;u<l.endCount.length;u++)if(s<=l.endCount[u]){c=u;break}return c==-1||l.startCount[c]>s?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[s-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:s+l.idDelta[c])}if(l.format==12){if(s>l.groups[l.groups.length-1][1])return 0;for(u=0;u<l.groups.length;u++){var f=l.groups[u];if(f[0]<=s&&s<=f[1])return f[2]+(s-f[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(i,s){var o={cmds:[],crds:[]};if(i.SVG&&i.SVG.entries[s]){var a=i.SVG.entries[s];return a==null?o:(typeof a=="string"&&(a=e.SVG.toPath(a),i.SVG.entries[s]=a),a)}if(i.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:i.CFF.Private?i.CFF.Private.defaultWidthX:0,open:!1},c=i.CFF,u=i.CFF.Private;if(c.ROS){for(var f=0;c.FDSelect[f+2]<=s;)f+=2;u=c.FDArray[c.FDSelect[f+1]].Private}e.U._drawCFF(i.CFF.CharStrings[s],l,c,u,o)}else i.glyf&&e.U._drawGlyf(s,i,o);return o},e.U._drawGlyf=function(i,s,o){var a=s.glyf[i];a==null&&(a=s.glyf[i]=e.glyf._parseGlyf(s,i)),a!=null&&(a.noc>-1?e.U._simpleGlyph(a,o):e.U._compoGlyph(a,s,o))},e.U._simpleGlyph=function(i,s){for(var o=0;o<i.noc;o++){for(var a=o==0?0:i.endPts[o-1]+1,l=i.endPts[o],c=a;c<=l;c++){var u=c==a?l:c-1,f=c==l?a:c+1,d=1&i.flags[c],h=1&i.flags[u],p=1&i.flags[f],m=i.xs[c],g=i.ys[c];if(c==a)if(d){if(!h){e.U.P.moveTo(s,m,g);continue}e.U.P.moveTo(s,i.xs[u],i.ys[u])}else h?e.U.P.moveTo(s,i.xs[u],i.ys[u]):e.U.P.moveTo(s,(i.xs[u]+m)/2,(i.ys[u]+g)/2);d?h&&e.U.P.lineTo(s,m,g):p?e.U.P.qcurveTo(s,m,g,i.xs[f],i.ys[f]):e.U.P.qcurveTo(s,m,g,(m+i.xs[f])/2,(g+i.ys[f])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(i,s,o){for(var a=0;a<i.parts.length;a++){var l={cmds:[],crds:[]},c=i.parts[a];e.U._drawGlyf(c.glyphIndex,s,l);for(var u=c.m,f=0;f<l.crds.length;f+=2){var d=l.crds[f],h=l.crds[f+1];o.crds.push(d*u.a+h*u.b+u.tx),o.crds.push(d*u.c+h*u.d+u.ty)}for(f=0;f<l.cmds.length;f++)o.cmds.push(l.cmds[f])}},e.U._getGlyphClass=function(i,s){var o=e._lctf.getInterval(s,i);return o==-1?0:s[o+2]},e.U._applySubs=function(i,s,o,a){for(var l=i.length-s-1,c=0;c<o.tabs.length;c++)if(o.tabs[c]!=null){var u,f=o.tabs[c];if(!f.coverage||(u=e._lctf.coverageIndex(f.coverage,i[s]))!=-1){if(o.ltype==1)i[s],f.fmt==1?i[s]=i[s]+f.delta:i[s]=f.newg[u];else if(o.ltype==4)for(var d=f.vals[u],h=0;h<d.length;h++){var p=d[h],m=p.chain.length;if(!(m>l)){for(var g=!0,y=0,x=0;x<m;x++){for(;i[s+y+(1+x)]==-1;)y++;p.chain[x]!=i[s+y+(1+x)]&&(g=!1)}if(g){for(i[s]=p.nglyph,x=0;x<m+y;x++)i[s+x+1]=-1;break}}}else if(o.ltype==5&&f.fmt==2)for(var _=e._lctf.getInterval(f.cDef,i[s]),w=f.cDef[_+2],T=f.scset[w],S=0;S<T.length;S++){var C=T[S],A=C.input;if(!(A.length>l)){for(g=!0,x=0;x<A.length;x++){var R=e._lctf.getInterval(f.cDef,i[s+1+x]);if(_==-1&&f.cDef[R+2]!=A[x]){g=!1;break}}if(g){var M=C.substLookupRecords;for(h=0;h<M.length;h+=2)M[h],M[h+1]}}}else if(o.ltype==6&&f.fmt==3){if(!e.U._glsCovered(i,f.backCvg,s-f.backCvg.length)||!e.U._glsCovered(i,f.inptCvg,s)||!e.U._glsCovered(i,f.ahedCvg,s+f.inptCvg.length))continue;var D=f.lookupRec;for(S=0;S<D.length;S+=2){_=D[S];var k=a[D[S+1]];e.U._applySubs(i,s+_,k,a)}}}}},e.U._glsCovered=function(i,s,o){for(var a=0;a<s.length;a++)if(e._lctf.coverageIndex(s[a],i[o+a])==-1)return!1;return!0},e.U.glyphsToPath=function(i,s,o){for(var a={cmds:[],crds:[]},l=0,c=0;c<s.length;c++){var u=s[c];if(u!=-1){for(var f=c<s.length-1&&s[c+1]!=-1?s[c+1]:0,d=e.U.glyphToPath(i,u),h=0;h<d.crds.length;h+=2)a.crds.push(d.crds[h]+l),a.crds.push(d.crds[h+1]);for(o&&a.cmds.push(o),h=0;h<d.cmds.length;h++)a.cmds.push(d.cmds[h]);o&&a.cmds.push("X"),l+=i.hmtx.aWidth[u],c<s.length-1&&(l+=e.U.getPairAdjustment(i,u,f))}}return a},e.U.P={},e.U.P.moveTo=function(i,s,o){i.cmds.push("M"),i.crds.push(s,o)},e.U.P.lineTo=function(i,s,o){i.cmds.push("L"),i.crds.push(s,o)},e.U.P.curveTo=function(i,s,o,a,l,c,u){i.cmds.push("C"),i.crds.push(s,o,a,l,c,u)},e.U.P.qcurveTo=function(i,s,o,a,l){i.cmds.push("Q"),i.crds.push(s,o,a,l)},e.U.P.closePath=function(i){i.cmds.push("Z")},e.U._drawCFF=function(i,s,o,a,l){for(var c=s.stack,u=s.nStems,f=s.haveWidth,d=s.width,h=s.open,p=0,m=s.x,g=s.y,y=0,x=0,_=0,w=0,T=0,S=0,C=0,A=0,R=0,M=0,D={val:0,size:0};p<i.length;){e.CFF.getCharString(i,p,D);var k=D.val;if(p+=D.size,k=="o1"||k=="o18")c.length%2!=0&&!f&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,f=!0;else if(k=="o3"||k=="o23")c.length%2!=0&&!f&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,f=!0;else if(k=="o4")c.length>1&&!f&&(d=c.shift()+a.nominalWidthX,f=!0),h&&e.U.P.closePath(l),g+=c.pop(),e.U.P.moveTo(l,m,g),h=!0;else if(k=="o5")for(;c.length>0;)m+=c.shift(),g+=c.shift(),e.U.P.lineTo(l,m,g);else if(k=="o6"||k=="o7")for(var L=c.length,N=k=="o6",z=0;z<L;z++){var O=c.shift();N?m+=O:g+=O,N=!N,e.U.P.lineTo(l,m,g)}else if(k=="o8"||k=="o24"){L=c.length;for(var K=0;K+6<=L;)y=m+c.shift(),x=g+c.shift(),_=y+c.shift(),w=x+c.shift(),m=_+c.shift(),g=w+c.shift(),e.U.P.curveTo(l,y,x,_,w,m,g),K+=6;k=="o24"&&(m+=c.shift(),g+=c.shift(),e.U.P.lineTo(l,m,g))}else{if(k=="o11")break;if(k=="o1234"||k=="o1235"||k=="o1236"||k=="o1237")k=="o1234"&&(x=g,_=(y=m+c.shift())+c.shift(),M=w=x+c.shift(),S=w,A=g,m=(C=(T=(R=_+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,y,x,_,w,R,M),e.U.P.curveTo(l,T,S,C,A,m,g)),k=="o1235"&&(y=m+c.shift(),x=g+c.shift(),_=y+c.shift(),w=x+c.shift(),R=_+c.shift(),M=w+c.shift(),T=R+c.shift(),S=M+c.shift(),C=T+c.shift(),A=S+c.shift(),m=C+c.shift(),g=A+c.shift(),c.shift(),e.U.P.curveTo(l,y,x,_,w,R,M),e.U.P.curveTo(l,T,S,C,A,m,g)),k=="o1236"&&(y=m+c.shift(),x=g+c.shift(),_=y+c.shift(),M=w=x+c.shift(),S=w,C=(T=(R=_+c.shift())+c.shift())+c.shift(),A=S+c.shift(),m=C+c.shift(),e.U.P.curveTo(l,y,x,_,w,R,M),e.U.P.curveTo(l,T,S,C,A,m,g)),k=="o1237"&&(y=m+c.shift(),x=g+c.shift(),_=y+c.shift(),w=x+c.shift(),R=_+c.shift(),M=w+c.shift(),T=R+c.shift(),S=M+c.shift(),C=T+c.shift(),A=S+c.shift(),Math.abs(C-m)>Math.abs(A-g)?m=C+c.shift():g=A+c.shift(),e.U.P.curveTo(l,y,x,_,w,R,M),e.U.P.curveTo(l,T,S,C,A,m,g));else if(k=="o14"){if(c.length>0&&!f&&(d=c.shift()+o.nominalWidthX,f=!0),c.length==4){var V=c.shift(),ne=c.shift(),re=c.shift(),P=c.shift(),se=e.CFF.glyphBySE(o,re),ue=e.CFF.glyphBySE(o,P);e.U._drawCFF(o.CharStrings[se],s,o,a,l),s.x=V,s.y=ne,e.U._drawCFF(o.CharStrings[ue],s,o,a,l)}h&&(e.U.P.closePath(l),h=!1)}else if(k=="o19"||k=="o20")c.length%2!=0&&!f&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,f=!0,p+=u+7>>3;else if(k=="o21")c.length>2&&!f&&(d=c.shift()+a.nominalWidthX,f=!0),g+=c.pop(),m+=c.pop(),h&&e.U.P.closePath(l),e.U.P.moveTo(l,m,g),h=!0;else if(k=="o22")c.length>1&&!f&&(d=c.shift()+a.nominalWidthX,f=!0),m+=c.pop(),h&&e.U.P.closePath(l),e.U.P.moveTo(l,m,g),h=!0;else if(k=="o25"){for(;c.length>6;)m+=c.shift(),g+=c.shift(),e.U.P.lineTo(l,m,g);y=m+c.shift(),x=g+c.shift(),_=y+c.shift(),w=x+c.shift(),m=_+c.shift(),g=w+c.shift(),e.U.P.curveTo(l,y,x,_,w,m,g)}else if(k=="o26")for(c.length%2&&(m+=c.shift());c.length>0;)y=m,x=g+c.shift(),m=_=y+c.shift(),g=(w=x+c.shift())+c.shift(),e.U.P.curveTo(l,y,x,_,w,m,g);else if(k=="o27")for(c.length%2&&(g+=c.shift());c.length>0;)x=g,_=(y=m+c.shift())+c.shift(),w=x+c.shift(),m=_+c.shift(),g=w,e.U.P.curveTo(l,y,x,_,w,m,g);else if(k=="o10"||k=="o29"){var te=k=="o10"?a:o;if(c.length==0)console.debug("error: empty stack");else{var W=c.pop(),X=te.Subrs[W+te.Bias];s.x=m,s.y=g,s.nStems=u,s.haveWidth=f,s.width=d,s.open=h,e.U._drawCFF(X,s,o,a,l),m=s.x,g=s.y,u=s.nStems,f=s.haveWidth,d=s.width,h=s.open}}else if(k=="o30"||k=="o31"){var J=c.length,oe=(K=0,k=="o31");for(K+=J-(L=-3&J);K<L;)oe?(x=g,_=(y=m+c.shift())+c.shift(),g=(w=x+c.shift())+c.shift(),L-K==5?(m=_+c.shift(),K++):m=_,oe=!1):(y=m,x=g+c.shift(),_=y+c.shift(),w=x+c.shift(),m=_+c.shift(),L-K==5?(g=w+c.shift(),K++):g=w,oe=!0),e.U.P.curveTo(l,y,x,_,w,m,g),K+=4}else{if((k+"").charAt(0)=="o")throw console.debug("Unknown operation: "+k,i),k;c.push(k)}}}s.x=m,s.y=g,s.nStems=u,s.haveWidth=f,s.width=d,s.open=h};var n=e,r={Typr:n};return t.Typr=n,t.default=r,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Xde(){return function(t){var e=Uint8Array,n=Uint16Array,r=Uint32Array,i=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(k,L){for(var N=new n(31),z=0;z<31;++z)N[z]=L+=1<<k[z-1];var O=new r(N[30]);for(z=1;z<30;++z)for(var K=N[z];K<N[z+1];++K)O[K]=K-N[z]<<5|z;return[N,O]},l=a(i,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var f=a(s,0)[0],d=new n(32768),h=0;h<32768;++h){var p=(43690&h)>>>1|(21845&h)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,d[h]=((65280&p)>>>8|(255&p)<<8)>>>1}var m=function(k,L,N){for(var z=k.length,O=0,K=new n(L);O<z;++O)++K[k[O]-1];var V,ne=new n(L);for(O=0;O<L;++O)ne[O]=ne[O-1]+K[O-1]<<1;{V=new n(1<<L);var re=15-L;for(O=0;O<z;++O)if(k[O])for(var P=O<<4|k[O],se=L-k[O],ue=ne[k[O]-1]++<<se,te=ue|(1<<se)-1;ue<=te;++ue)V[d[ue]>>>re]=P}return V},g=new e(288);for(h=0;h<144;++h)g[h]=8;for(h=144;h<256;++h)g[h]=9;for(h=256;h<280;++h)g[h]=7;for(h=280;h<288;++h)g[h]=8;var y=new e(32);for(h=0;h<32;++h)y[h]=5;var x=m(g,9),_=m(y,5),w=function(k){for(var L=k[0],N=1;N<k.length;++N)k[N]>L&&(L=k[N]);return L},T=function(k,L,N){var z=L/8|0;return(k[z]|k[z+1]<<8)>>(7&L)&N},S=function(k,L){var N=L/8|0;return(k[N]|k[N+1]<<8|k[N+2]<<16)>>(7&L)},C=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],A=function(k,L,N){var z=new Error(L||C[k]);if(z.code=k,Error.captureStackTrace&&Error.captureStackTrace(z,A),!N)throw z;return z},R=function(k,L,N){var z=k.length;if(!z||N&&!N.l&&z<5)return L||new e(0);var O=!L||N,K=!N||N.i;N||(N={}),L||(L=new e(3*z));var V,ne=function(it){var Ie=L.length;if(it>Ie){var Ye=new e(Math.max(2*Ie,it));Ye.set(L),L=Ye}},re=N.f||0,P=N.p||0,se=N.b||0,ue=N.l,te=N.d,W=N.m,X=N.n,J=8*z;do{if(!ue){N.f=re=T(k,P,1);var oe=T(k,P+1,3);if(P+=3,!oe){var Ee=k[(ze=((V=P)/8|0)+(7&V&&1)+4)-4]|k[ze-3]<<8,me=ze+Ee;if(me>z){K&&A(0);break}O&&ne(se+Ee),L.set(k.subarray(ze,me),se),N.b=se+=Ee,N.p=P=8*me;continue}if(oe==1)ue=x,te=_,W=9,X=5;else if(oe==2){var Te=T(k,P,31)+257,_e=T(k,P+10,15)+4,Re=Te+T(k,P+5,31)+1;P+=14;for(var ae=new e(Re),Ce=new e(19),Pe=0;Pe<_e;++Pe)Ce[o[Pe]]=T(k,P+3*Pe,7);P+=3*_e;var Ve=w(Ce),ye=(1<<Ve)-1,ge=m(Ce,Ve);for(Pe=0;Pe<Re;){var ze,fe=ge[T(k,P,ye)];if(P+=15&fe,(ze=fe>>>4)<16)ae[Pe++]=ze;else{var ie=0,ve=0;for(ze==16?(ve=3+T(k,P,3),P+=2,ie=ae[Pe-1]):ze==17?(ve=3+T(k,P,7),P+=3):ze==18&&(ve=11+T(k,P,127),P+=7);ve--;)ae[Pe++]=ie}}var Me=ae.subarray(0,Te),Be=ae.subarray(Te);W=w(Me),X=w(Be),ue=m(Me,W),te=m(Be,X)}else A(1);if(P>J){K&&A(0);break}}O&&ne(se+131072);for(var Ze=(1<<W)-1,F=(1<<X)-1,Z=P;;Z=P){var q=(ie=ue[S(k,P)&Ze])>>>4;if((P+=15&ie)>J){K&&A(0);break}if(ie||A(2),q<256)L[se++]=q;else{if(q==256){Z=P,ue=null;break}var xe=q-254;if(q>264){var be=i[Pe=q-257];xe=T(k,P,(1<<be)-1)+c[Pe],P+=be}var De=te[S(k,P)&F],$e=De>>>4;if(De||A(3),P+=15&De,Be=f[$e],$e>3&&(be=s[$e],Be+=S(k,P)&(1<<be)-1,P+=be),P>J){K&&A(0);break}O&&ne(se+131072);for(var st=se+xe;se<st;se+=4)L[se]=L[se-Be],L[se+1]=L[se+1-Be],L[se+2]=L[se+2-Be],L[se+3]=L[se+3-Be];se=st}}N.l=ue,N.p=Z,N.b=se,ue&&(re=1,N.m=W,N.d=te,N.n=X)}while(!re);return se==L.length?L:function(it,Ie,Ye){(Ye==null||Ye>it.length)&&(Ye=it.length);var at=new(it instanceof n?n:it instanceof r?r:e)(Ye-Ie);return at.set(it.subarray(Ie,Ye)),at}(L,0,se)},M=new e(0),D=typeof TextDecoder<"u"&&new TextDecoder;try{D.decode(M,{stream:!0})}catch{}return t.convert_streams=function(k){var L=new DataView(k),N=0;function z(){var Te=L.getUint16(N);return N+=2,Te}function O(){var Te=L.getUint32(N);return N+=4,Te}function K(Te){Ee.setUint16(me,Te),me+=2}function V(Te){Ee.setUint32(me,Te),me+=4}for(var ne={signature:O(),flavor:O(),length:O(),numTables:z(),reserved:z(),totalSfntSize:O(),majorVersion:z(),minorVersion:z(),metaOffset:O(),metaLength:O(),metaOrigLength:O(),privOffset:O(),privLength:O()},re=0;Math.pow(2,re)<=ne.numTables;)re++;re--;for(var P=16*Math.pow(2,re),se=16*ne.numTables-P,ue=12,te=[],W=0;W<ne.numTables;W++)te.push({tag:O(),offset:O(),compLength:O(),origLength:O(),origChecksum:O()}),ue+=16;var X,J=new Uint8Array(12+16*te.length+te.reduce(function(Te,_e){return Te+_e.origLength+4},0)),oe=J.buffer,Ee=new DataView(oe),me=0;return V(ne.flavor),K(ne.numTables),K(P),K(re),K(se),te.forEach(function(Te){V(Te.tag),V(Te.origChecksum),V(ue),V(Te.origLength),Te.outOffset=ue,(ue+=Te.origLength)%4!=0&&(ue+=4-ue%4)}),te.forEach(function(Te){var _e,Re=k.slice(Te.offset,Te.offset+Te.compLength);if(Te.compLength!=Te.origLength){var ae=new Uint8Array(Te.origLength);_e=new Uint8Array(Re,2),R(_e,ae)}else ae=new Uint8Array(Re);J.set(ae,Te.outOffset);var Ce=0;(ue=Te.outOffset+Te.origLength)%4!=0&&(Ce=4-ue%4),J.set(new Uint8Array(Ce).buffer,Te.outOffset+Te.origLength),X=ue+Ce}),oe.slice(0,X)},Object.defineProperty(t,"__esModule",{value:!0}),t}({}).convert_streams}function qde(t,e){const n={M:2,L:2,Q:4,C:6,Z:0},r={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,s=2,o=4,a=8,l=16,c=32;let u;function f(C){if(!u){const A={R:s,L:i,D:o,C:l,U:c,T:a};u=new Map;for(let R in r){let M=0;r[R].split(",").forEach(D=>{let[k,L]=D.split("+");k=parseInt(k,36),L=L?parseInt(L,36):0,u.set(M+=k,A[R]);for(let N=L;N--;)u.set(++M,A[R])})}}return u.get(C)||c}const d=1,h=2,p=3,m=4,g=[null,"isol","init","fina","medi"];function y(C){const A=new Uint8Array(C.length);let R=c,M=d,D=-1;for(let k=0;k<C.length;k++){const L=C.codePointAt(k);let N=f(L)|0,z=d;N&a||(R&(i|o|l)?N&(s|o|l)?(z=p,(M===d||M===p)&&A[D]++):N&(i|c)&&(M===h||M===m)&&A[D]--:R&(s|c)&&(M===h||M===m)&&A[D]--,M=A[k]=z,R=N,D=k,L>65535&&k++)}return A}function x(C,A){const R=[];for(let D=0;D<A.length;D++){const k=A.codePointAt(D);k>65535&&D++,R.push(t.U.codeToGlyph(C,k))}const M=C.GSUB;if(M){const{lookupList:D,featureList:k}=M;let L;const N=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,z=[];k.forEach(O=>{if(N.test(O.tag))for(let K=0;K<O.tab.length;K++){if(z[O.tab[K]])continue;z[O.tab[K]]=!0;const V=D[O.tab[K]],ne=/^(isol|init|fina|medi)$/.test(O.tag);ne&&!L&&(L=y(A));for(let re=0;re<R.length;re++)(!L||!ne||g[L[re]]===O.tag)&&t.U._applySubs(R,re,V,D)}})}return R}function _(C,A){const R=new Int16Array(A.length*3);let M=0;for(;M<A.length;M++){const N=A[M];if(N===-1)continue;R[M*3+2]=C.hmtx.aWidth[N];const z=C.GPOS;if(z){const O=z.lookupList;for(let K=0;K<O.length;K++){const V=O[K];for(let ne=0;ne<V.tabs.length;ne++){const re=V.tabs[ne];if(V.ltype===1){if(t._lctf.coverageIndex(re.coverage,N)!==-1&&re.pos){L(re.pos,M);break}}else if(V.ltype===2){let P=null,se=D();if(se!==-1){const ue=t._lctf.coverageIndex(re.coverage,A[se]);if(ue!==-1){if(re.fmt===1){const te=re.pairsets[ue];for(let W=0;W<te.length;W++)te[W].gid2===N&&(P=te[W])}else if(re.fmt===2){const te=t.U._getGlyphClass(A[se],re.classDef1),W=t.U._getGlyphClass(N,re.classDef2);P=re.matrix[te][W]}if(P){P.val1&&L(P.val1,se),P.val2&&L(P.val2,M);break}}}}else if(V.ltype===4){const P=t._lctf.coverageIndex(re.markCoverage,N);if(P!==-1){const se=D(k),ue=se===-1?-1:t._lctf.coverageIndex(re.baseCoverage,A[se]);if(ue!==-1){const te=re.markArray[P],W=re.baseArray[ue][te.markClass];R[M*3]=W.x-te.x+R[se*3]-R[se*3+2],R[M*3+1]=W.y-te.y+R[se*3+1];break}}}else if(V.ltype===6){const P=t._lctf.coverageIndex(re.mark1Coverage,N);if(P!==-1){const se=D();if(se!==-1){const ue=A[se];if(w(C,ue)===3){const te=t._lctf.coverageIndex(re.mark2Coverage,ue);if(te!==-1){const W=re.mark1Array[P],X=re.mark2Array[te][W.markClass];R[M*3]=X.x-W.x+R[se*3]-R[se*3+2],R[M*3+1]=X.y-W.y+R[se*3+1];break}}}}}}}}else if(C.kern&&!C.cff){const O=D();if(O!==-1){const K=C.kern.glyph1.indexOf(A[O]);if(K!==-1){const V=C.kern.rval[K].glyph2.indexOf(N);V!==-1&&(R[O*3+2]+=C.kern.rval[K].vals[V])}}}}return R;function D(N){for(let z=M-1;z>=0;z--)if(A[z]!==-1&&(!N||N(A[z])))return z;return-1}function k(N){return w(C,N)===1}function L(N,z){for(let O=0;O<3;O++)R[z*3+O]+=N[O]||0}}function w(C,A){const R=C.GDEF&&C.GDEF.glyphClassDef;return R?t.U._getGlyphClass(A,R):0}function T(...C){for(let A=0;A<C.length;A++)if(typeof C[A]=="number")return C[A]}function S(C){const A=Object.create(null),R=C["OS/2"],M=C.hhea,D=C.head.unitsPerEm,k=T(R&&R.sTypoAscender,M&&M.ascender,D),L={unitsPerEm:D,ascender:k,descender:T(R&&R.sTypoDescender,M&&M.descender,0),capHeight:T(R&&R.sCapHeight,k),xHeight:T(R&&R.sxHeight,k),lineGap:T(R&&R.sTypoLineGap,M&&M.lineGap),supportsCodePoint(N){return t.U.codeToGlyph(C,N)>0},forEachGlyph(N,z,O,K){let V=0;const ne=1/L.unitsPerEm*z,re=x(C,N);let P=0;const se=_(C,re);return re.forEach((ue,te)=>{if(ue!==-1){let W=A[ue];if(!W){const{cmds:X,crds:J}=t.U.glyphToPath(C,ue);let oe="",Ee=0;for(let ae=0,Ce=X.length;ae<Ce;ae++){const Pe=n[X[ae]];oe+=X[ae];for(let Ve=1;Ve<=Pe;Ve++)oe+=(Ve>1?",":"")+J[Ee++]}let me,Te,_e,Re;if(J.length){me=Te=1/0,_e=Re=-1/0;for(let ae=0,Ce=J.length;ae<Ce;ae+=2){let Pe=J[ae],Ve=J[ae+1];Pe<me&&(me=Pe),Ve<Te&&(Te=Ve),Pe>_e&&(_e=Pe),Ve>Re&&(Re=Ve)}}else me=_e=Te=Re=0;W=A[ue]={index:ue,advanceWidth:C.hmtx.aWidth[ue],xMin:me,yMin:Te,xMax:_e,yMax:Re,path:oe}}K.call(null,W,V+se[te*3]*ne,se[te*3+1]*ne,P),V+=se[te*3+2]*ne,O&&(V+=O*z)}P+=N.codePointAt(P)>65535?2:1}),V}};return L}return function(A){const R=new Uint8Array(A,0,4),M=t._bin.readASCII(R,0,4);if(M==="wOFF")A=e(A);else if(M==="wOF2")throw new Error("woff2 fonts not supported");return S(t.parse(A)[0])}}const Yde=$m({name:"Typr Font Parser",dependencies:[$de,Xde,qde],init(t,e,n){const r=t(),i=e();return n(r,i)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Kde(){return function(t){var e=function(){this.buckets=new Map};e.prototype.add=function(_){var w=_>>5;this.buckets.set(w,(this.buckets.get(w)||0)|1<<(31&_))},e.prototype.has=function(_){var w=this.buckets.get(_>>5);return w!==void 0&&(w&1<<(31&_))!=0},e.prototype.serialize=function(){var _=[];return this.buckets.forEach(function(w,T){_.push((+T).toString(36)+":"+w.toString(36))}),_.join(",")},e.prototype.deserialize=function(_){var w=this;this.buckets.clear(),_.split(",").forEach(function(T){var S=T.split(":");w.buckets.set(parseInt(S[0],36),parseInt(S[1],36))})};var n=Math.pow(2,8),r=n-1,i=~r;function s(_){var w=function(S){return S&i}(_).toString(16),T=function(S){return(S&i)+n-1}(_).toString(16);return"codepoint-index/plane"+(_>>16)+"/"+w+"-"+T+".json"}function o(_,w){var T=_&r,S=w.codePointAt(T/6|0);return((S=(S||48)-48)&1<<T%6)!=0}function a(_,w){var T;(T=_,T.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(S){return S.split("-").map(function(C){return parseInt(C.trim(),16)})})).forEach(function(S){var C=S[0],A=S[1];A===void 0&&(A=C),w(C,A)})}function l(_,w){a(_,function(T,S){for(var C=T;C<=S;C++)w(C)})}var c={},u={},f=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function h(_){var w=f.get(_);return w||(w=new e,l(_.ranges,function(T){return w.add(T)}),f.set(_,w)),w}var p,m=new Map;function g(_,w,T){return _[w]?w:_[T]?T:function(S){for(var C in S)return C}(_)}function y(_,w){var T=w;if(!_.includes(T)){T=1/0;for(var S=0;S<_.length;S++)Math.abs(_[S]-w)<Math.abs(T-w)&&(T=_[S])}return T}function x(_){return p||(p=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(w){p.add(w)})),p.has(_)}return t.CodePointSet=e,t.clearCache=function(){c={},u={}},t.getFontsForString=function(_,w){w===void 0&&(w={});var T,S=w.lang;S===void 0&&(S=new RegExp("\\p{Script=Hangul}","u").test(T=_)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(T)?"ja":"en");var C=w.category;C===void 0&&(C="sans-serif");var A=w.style;A===void 0&&(A="normal");var R=w.weight;R===void 0&&(R=400);var M=(w.dataUrl||d).replace(/\/$/g,""),D=new Map,k=new Uint8Array(_.length),L={},N={},z=new Array(_.length),O=new Map,K=!1;function V(P){var se=m.get(P);return se||(se=fetch(M+"/"+P).then(function(ue){if(!ue.ok)throw new Error(ue.statusText);return ue.json().then(function(te){if(!Array.isArray(te)||te[0]!==1)throw new Error("Incorrect schema version; need 1, got "+te[0]);return te[1]})}).catch(function(ue){if(M!==d)return K||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+M+'", trying default CDN. '+ue.message),K=!0),M=d,m.delete(P),V(P);throw ue}),m.set(P,se)),se}for(var ne=function(P){var se=_.codePointAt(P),ue=s(se);z[P]=ue,c[ue]||O.has(ue)||O.set(ue,V(ue).then(function(te){c[ue]=te})),se>65535&&(P++,re=P)},re=0;re<_.length;re++)ne(re);return Promise.all(O.values()).then(function(){O.clear();for(var P=function(ue){var te=_.codePointAt(ue),W=null,X=c[z[ue]],J=void 0;for(var oe in X){var Ee=N[oe];if(Ee===void 0&&(Ee=N[oe]=new RegExp(oe).test(S||"en")),Ee){for(var me in J=oe,X[oe])if(o(te,X[oe][me])){W=me;break}break}}if(!W){e:for(var Te in X)if(Te!==J){for(var _e in X[Te])if(o(te,X[Te][_e])){W=_e;break e}}}W||(console.debug("No font coverage for U+"+te.toString(16)),W="latin"),z[ue]=W,u[W]||O.has(W)||O.set(W,V("font-meta/"+W+".json").then(function(Re){u[W]=Re})),te>65535&&(ue++,se=ue)},se=0;se<_.length;se++)P(se);return Promise.all(O.values())}).then(function(){for(var P,se=null,ue=0;ue<_.length;ue++){var te=_.codePointAt(ue);if(se&&(x(te)||h(se).has(te)))k[ue]=k[ue-1];else{se=u[z[ue]];var W=L[se.id];if(!W){var X=se.typeforms,J=g(X,C,"sans-serif"),oe=g(X[J],A,"normal"),Ee=y((P=X[J])===null||P===void 0?void 0:P[oe],R);W=L[se.id]=M+"/font-files/"+se.id+"/"+J+"."+oe+"."+Ee+".woff"}var me=D.get(W);me==null&&(me=D.size,D.set(W,me)),k[ue]=me}te>65535&&(ue++,k[ue]=k[ue-1])}return{fontUrls:Array.from(D.keys()),chars:k}})},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}function Zde(t,e){const n=Object.create(null),r=Object.create(null);function i(o,a){const l=c=>{console.error(`Failure loading font ${o}`,c)};try{const c=new XMLHttpRequest;c.open("get",o,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{const u=t(c.response);u.src=o,a(u)}catch(u){l(u)}},c.onerror=l,c.send()}catch(c){l(c)}}function s(o,a){let l=n[o];l?a(l):r[o]?r[o].push(a):(r[o]=[a],i(o,c=>{c.src=o,n[o]=c,r[o].forEach(u=>u(c)),delete r[o]}))}return function(o,a,{lang:l,fonts:c=[],style:u="normal",weight:f="normal",unicodeFontsURL:d}={}){const h=new Uint8Array(o.length),p=[];o.length||x();const m=new Map,g=[];if(u!=="italic"&&(u="normal"),typeof f!="number"&&(f=f==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(w=>!w.lang||w.lang.test(l)).reverse(),c.length){let C=0;(function A(R=0){for(let M=R,D=o.length;M<D;M++){const k=o.codePointAt(M);if(C===1&&p[h[M-1]].supportsCodePoint(k)||M>0&&/\s/.test(o[M]))h[M]=h[M-1],C===2&&(g[g.length-1][1]=M);else for(let L=h[M],N=c.length;L<=N;L++)if(L===N){const z=C===2?g[g.length-1]:g[g.length]=[M,M];z[1]=M,C=2}else{h[M]=L;const{src:z,unicodeRange:O}=c[L];if(!O||_(k,O)){const K=n[z];if(!K){s(z,()=>{A(M)});return}if(K.supportsCodePoint(k)){let V=m.get(K);typeof V!="number"&&(V=p.length,p.push(K),m.set(K,V)),h[M]=V,C=1;break}}}k>65535&&M+1<D&&(h[M+1]=h[M],M++,C===2&&(g[g.length-1][1]=M))}y()})()}else g.push([0,o.length-1]),y();function y(){if(g.length){const w=g.map(T=>o.substring(T[0],T[1]+1)).join(`
`);e.getFontsForString(w,{lang:l||void 0,style:u,weight:f,dataUrl:d}).then(({fontUrls:T,chars:S})=>{const C=p.length;let A=0;g.forEach(M=>{for(let D=0,k=M[1]-M[0];D<=k;D++)h[M[0]+D]=S[A++]+C;A++});let R=0;T.forEach((M,D)=>{s(M,k=>{p[D+C]=k,++R===T.length&&x()})})})}else x()}function x(){a({chars:h,fonts:p})}function _(w,T){for(let S=0;S<T.length;S++){const[C,A=C]=T[S];if(C<=w&&w<=A)return!0}return!1}}}const Qde=$m({name:"FontResolver",dependencies:[Zde,Yde,Kde],init(t,e,n){return t(e,n())}});function Jde(t,e){const r=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,i="[^\\S\\u00A0]",s=new RegExp(`${i}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:p,lang:m,fonts:g,style:y,weight:x,preResolvedFonts:_,unicodeFontsURL:w},T){const S=({chars:C,fonts:A})=>{let R,M;const D=[];for(let k=0;k<C.length;k++)C[k]!==M?(M=C[k],D.push(R={start:k,end:k,fontObj:A[C[k]]})):R.end=k;T(D)};_?S(_):t(p,S,{lang:m,fonts:g,style:y,weight:x,unicodeFontsURL:w})}function a({text:p="",font:m,lang:g,sdfGlyphSize:y=64,fontSize:x=400,fontWeight:_=1,fontStyle:w="normal",letterSpacing:T=0,lineHeight:S="normal",maxWidth:C=1/0,direction:A,textAlign:R="left",textIndent:M=0,whiteSpace:D="normal",overflowWrap:k="normal",anchorX:L=0,anchorY:N=0,metricsOnly:z=!1,unicodeFontsURL:O,preResolvedFonts:K=null,includeCaretPositions:V=!1,chunkedBoundsSize:ne=8192,colorRanges:re=null},P){const se=f(),ue={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),x=+x,T=+T,C=+C,S=S||"normal",M=+M,o({text:p,lang:g,style:w,weight:_,fonts:typeof m=="string"?[{src:m}]:m,unicodeFontsURL:O,preResolvedFonts:K},te=>{ue.fontLoad=f()-se;const W=isFinite(C);let X=null,J=null,oe=null,Ee=null,me=null,Te=null,_e=null,Re=null,ae=0,Ce=0,Pe=D!=="nowrap";const Ve=new Map,ye=f();let ge=M,ze=0,fe=new d;const ie=[fe];te.forEach(F=>{const{fontObj:Z}=F,{ascender:q,descender:xe,unitsPerEm:be,lineGap:De,capHeight:$e,xHeight:st}=Z;let it=Ve.get(Z);if(!it){const Xe=x/be,Qe=S==="normal"?(q-xe+De)*Xe:S*x,_t=(Qe-(q-xe)*Xe)/2,kt=Math.min(Qe,(q-xe)*Xe),Ct=(q+xe)/2*Xe+kt/2;it={index:Ve.size,src:Z.src,fontObj:Z,fontSizeMult:Xe,unitsPerEm:be,ascender:q*Xe,descender:xe*Xe,capHeight:$e*Xe,xHeight:st*Xe,lineHeight:Qe,baseline:-_t-q*Xe,caretTop:Ct,caretBottom:Ct-kt},Ve.set(Z,it)}const{fontSizeMult:Ie}=it,Ye=p.slice(F.start,F.end+1);let at,ke;Z.forEachGlyph(Ye,x,T,(Xe,Qe,_t,kt)=>{Qe+=ze,kt+=F.start,at=Qe,ke=Xe;const Ct=p.charAt(kt),Kt=Xe.advanceWidth*Ie,cn=fe.count;let sn;if("isEmpty"in Xe||(Xe.isWhitespace=!!Ct&&new RegExp(i).test(Ct),Xe.canBreakAfter=!!Ct&&s.test(Ct),Xe.isEmpty=Xe.xMin===Xe.xMax||Xe.yMin===Xe.yMax||r.test(Ct)),!Xe.isWhitespace&&!Xe.isEmpty&&Ce++,Pe&&W&&!Xe.isWhitespace&&Qe+Kt+ge>C&&cn){if(fe.glyphAt(cn-1).glyphObj.canBreakAfter)sn=new d,ge=-Qe;else for(let Gn=cn;Gn--;)if(Gn===0&&k==="break-word"){sn=new d,ge=-Qe;break}else if(fe.glyphAt(Gn).glyphObj.canBreakAfter){sn=fe.splitAt(Gn+1);const rr=sn.glyphAt(0).x;ge-=rr;for(let Cr=sn.count;Cr--;)sn.glyphAt(Cr).x-=rr;break}sn&&(fe.isSoftWrapped=!0,fe=sn,ie.push(fe),ae=C)}let Vt=fe.glyphAt(fe.count);Vt.glyphObj=Xe,Vt.x=Qe+ge,Vt.y=_t,Vt.width=Kt,Vt.charIndex=kt,Vt.fontData=it,Ct===`
`&&(fe=new d,ie.push(fe),ge=-(Qe+Kt+T*x)+M)}),ze=at+ke.advanceWidth*Ie+T*x});let ve=0;ie.forEach(F=>{let Z=!0;for(let q=F.count;q--;){const xe=F.glyphAt(q);Z&&!xe.glyphObj.isWhitespace&&(F.width=xe.x+xe.width,F.width>ae&&(ae=F.width),Z=!1);let{lineHeight:be,capHeight:De,xHeight:$e,baseline:st}=xe.fontData;be>F.lineHeight&&(F.lineHeight=be);const it=st-F.baseline;it<0&&(F.baseline+=it,F.cap+=it,F.ex+=it),F.cap=Math.max(F.cap,F.baseline+De),F.ex=Math.max(F.ex,F.baseline+$e)}F.baseline-=ve,F.cap-=ve,F.ex-=ve,ve+=F.lineHeight});let Me=0,Be=0;if(L&&(typeof L=="number"?Me=-L:typeof L=="string"&&(Me=-ae*(L==="left"?0:L==="center"?.5:L==="right"?1:c(L)))),N&&(typeof N=="number"?Be=-N:typeof N=="string"&&(Be=N==="top"?0:N==="top-baseline"?-ie[0].baseline:N==="top-cap"?-ie[0].cap:N==="top-ex"?-ie[0].ex:N==="middle"?ve/2:N==="bottom"?ve:N==="bottom-baseline"?-ie[ie.length-1].baseline:c(N)*ve)),!z){const F=e.getEmbeddingLevels(p,A);X=new Uint16Array(Ce),J=new Uint8Array(Ce),oe=new Float32Array(Ce*2),Ee={},_e=[1/0,1/0,-1/0,-1/0],Re=[],V&&(Te=new Float32Array(p.length*4)),re&&(me=new Uint8Array(Ce*3));let Z=0,q=-1,xe=-1,be,De;if(ie.forEach(($e,st)=>{let{count:it,width:Ie}=$e;if(it>0){let Ye=0;for(let kt=it;kt--&&$e.glyphAt(kt).glyphObj.isWhitespace;)Ye++;let at=0,ke=0;if(R==="center")at=(ae-Ie)/2;else if(R==="right")at=ae-Ie;else if(R==="justify"&&$e.isSoftWrapped){let kt=0;for(let Ct=it-Ye;Ct--;)$e.glyphAt(Ct).glyphObj.isWhitespace&&kt++;ke=(ae-Ie)/kt}if(ke||at){let kt=0;for(let Ct=0;Ct<it;Ct++){let Kt=$e.glyphAt(Ct);const cn=Kt.glyphObj;Kt.x+=at+kt,ke!==0&&cn.isWhitespace&&Ct<it-Ye&&(kt+=ke,Kt.width+=ke)}}const Xe=e.getReorderSegments(p,F,$e.glyphAt(0).charIndex,$e.glyphAt($e.count-1).charIndex);for(let kt=0;kt<Xe.length;kt++){const[Ct,Kt]=Xe[kt];let cn=1/0,sn=-1/0;for(let Vt=0;Vt<it;Vt++)if($e.glyphAt(Vt).charIndex>=Ct){let Gn=Vt,rr=Vt;for(;rr<it;rr++){let Cr=$e.glyphAt(rr);if(Cr.charIndex>Kt)break;rr<it-Ye&&(cn=Math.min(cn,Cr.x),sn=Math.max(sn,Cr.x+Cr.width))}for(let Cr=Gn;Cr<rr;Cr++){const wi=$e.glyphAt(Cr);wi.x=sn-(wi.x+wi.width-cn)}break}}let Qe;const _t=kt=>Qe=kt;for(let kt=0;kt<it;kt++){const Ct=$e.glyphAt(kt);Qe=Ct.glyphObj;const Kt=Qe.index,cn=F.levels[Ct.charIndex]&1;if(cn){const sn=e.getMirroredCharacter(p[Ct.charIndex]);sn&&Ct.fontData.fontObj.forEachGlyph(sn,0,0,_t)}if(V){const{charIndex:sn,fontData:Vt}=Ct,Gn=Ct.x+Me,rr=Ct.x+Ct.width+Me;Te[sn*4]=cn?rr:Gn,Te[sn*4+1]=cn?Gn:rr,Te[sn*4+2]=$e.baseline+Vt.caretBottom+Be,Te[sn*4+3]=$e.baseline+Vt.caretTop+Be;const Cr=sn-q;Cr>1&&u(Te,q,Cr),q=sn}if(re){const{charIndex:sn}=Ct;for(;sn>xe;)xe++,re.hasOwnProperty(xe)&&(De=re[xe])}if(!Qe.isWhitespace&&!Qe.isEmpty){const sn=Z++,{fontSizeMult:Vt,src:Gn,index:rr}=Ct.fontData,Cr=Ee[Gn]||(Ee[Gn]={});Cr[Kt]||(Cr[Kt]={path:Qe.path,pathBounds:[Qe.xMin,Qe.yMin,Qe.xMax,Qe.yMax]});const wi=Ct.x+Me,zr=Ct.y+$e.baseline+Be;oe[sn*2]=wi,oe[sn*2+1]=zr;const mi=wi+Qe.xMin*Vt,gi=zr+Qe.yMin*Vt,Hr=wi+Qe.xMax*Vt,An=zr+Qe.yMax*Vt;mi<_e[0]&&(_e[0]=mi),gi<_e[1]&&(_e[1]=gi),Hr>_e[2]&&(_e[2]=Hr),An>_e[3]&&(_e[3]=An),sn%ne===0&&(be={start:sn,end:sn,rect:[1/0,1/0,-1/0,-1/0]},Re.push(be)),be.end++;const kr=be.rect;if(mi<kr[0]&&(kr[0]=mi),gi<kr[1]&&(kr[1]=gi),Hr>kr[2]&&(kr[2]=Hr),An>kr[3]&&(kr[3]=An),X[sn]=Kt,J[sn]=rr,re){const Wi=sn*3;me[Wi]=De>>16&255,me[Wi+1]=De>>8&255,me[Wi+2]=De&255}}}}}),Te){const $e=p.length-q;$e>1&&u(Te,q,$e)}}const Ze=[];Ve.forEach(({index:F,src:Z,unitsPerEm:q,ascender:xe,descender:be,lineHeight:De,capHeight:$e,xHeight:st})=>{Ze[F]={src:Z,unitsPerEm:q,ascender:xe,descender:be,lineHeight:De,capHeight:$e,xHeight:st}}),ue.typesetting=f()-ye,P({glyphIds:X,glyphFontIndices:J,glyphPositions:oe,glyphData:Ee,fontData:Ze,caretPositions:Te,glyphColors:me,chunkedBounds:Re,fontSize:x,topBaseline:Be+ie[0].baseline,blockBounds:[Me,Be-ve,Me+ae,Be],visibleBounds:_e,timings:ue})})}function l(p,m){a({...p,metricsOnly:!0},g=>{const[y,x,_,w]=g.blockBounds;m({width:_-y,height:w-x})})}function c(p){let m=p.match(/^([\d.]+)%$/),g=m?parseFloat(m[1]):NaN;return isNaN(g)?0:g/100}function u(p,m,g){const y=p[m*4],x=p[m*4+1],_=p[m*4+2],w=p[m*4+3],T=(x-y)/g;for(let S=0;S<g;S++){const C=(m+S)*4;p[C]=y+T*S,p[C+1]=y+T*(S+1),p[C+2]=_,p[C+3]=w}}function f(){return(self.performance||Date).now()}function d(){this.data=[]}const h=["glyphObj","x","y","width","charIndex","fontData"];return d.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/h.length)},glyphAt(p){let m=d.flyweight;return m.data=this.data,m.index=p,m},splitAt(p){let m=new d;return m.data=this.data.splice(p*h.length),m}},d.flyweight=h.reduce((p,m,g,y)=>(Object.defineProperty(p,m,{get(){return this.data[this.index*h.length+g]},set(x){this.data[this.index*h.length+g]=x}}),p),{data:null,index:0}),{typeset:a,measure:l}}const Rd=()=>(self.performance||Date).now(),tE=VG();let yk;function ehe(t,e,n,r,i,s,o,a,l,c,u=!0){return u?nhe(t,e,n,r,i,s,o,a,l,c).then(null,f=>(yk||(console.warn("WebGL SDF generation failed, falling back to JS",f),yk=!0),xk(t,e,n,r,i,s,o,a,l,c))):xk(t,e,n,r,i,s,o,a,l,c)}const g3=[],the=5;let b5=0;function $G(){const t=Rd();for(;g3.length&&Rd()-t<the;)g3.shift()();b5=g3.length?setTimeout($G,0):0}const nhe=(...t)=>new Promise((e,n)=>{g3.push(()=>{const r=Rd();try{tE.webgl.generateIntoCanvas(...t),e({timing:Rd()-r})}catch(i){n(i)}}),b5||(b5=setTimeout($G,0))}),rhe=4,ihe=2e3,vk={};let she=0;function xk(t,e,n,r,i,s,o,a,l,c){const u="TroikaTextSDFGenerator_JS_"+she++%rhe;let f=vk[u];return f||(f=vk[u]={workerModule:$m({name:u,workerId:u,dependencies:[VG,Rd],init(d,h){const p=d().javascript.generate;return function(...m){const g=h();return{textureData:p(...m),timing:h()-g}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(t,e,n,r,i,s).then(({textureData:d,timing:h})=>{const p=Rd(),m=new Uint8Array(d.length*4);for(let g=0;g<d.length;g++)m[g*4+c]=d[g];return tE.webglUtils.renderImageData(o,m,a,l,t,e,1<<3-c),h+=Rd()-p,--f.requests===0&&(f.idleTimer=setTimeout(()=>{Ode(u)},ihe)),{timing:h}})}function ohe(t){t._warm||(tE.webgl.isSupported(t),t._warm=!0)}const ahe=tE.webglUtils.resizeWebGLCanvasWithoutClearing,Hp={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},lhe=new wt;function ep(){return(self.performance||Date).now()}const _k=Object.create(null);function XG(t,e){t=fhe({},t);const n=ep(),{defaultFontURL:r}=Hp,i=[];if(r&&i.push({label:"default",src:bk(r)}),t.font&&i.push({label:"user",src:bk(t.font)}),t.font=i,t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||Hp.sdfGlyphSize,t.unicodeFontsURL=t.unicodeFontsURL||Hp.unicodeFontsURL,t.colorRanges!=null){let h={};for(let p in t.colorRanges)if(t.colorRanges.hasOwnProperty(p)){let m=t.colorRanges[p];typeof m!="number"&&(m=lhe.set(m).getHex()),h[p]=m}t.colorRanges=h}Object.freeze(t);const{textureWidth:s,sdfExponent:o}=Hp,{sdfGlyphSize:a}=t,l=s/a*4;let c=_k[a];if(!c){const h=document.createElement("canvas");h.width=s,h.height=a*256/l,c=_k[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:h,sdfTexture:new tr(h,void 0,void 0,void 0,Pn,Pn),contextLost:!1,glyphsByFont:new Map},c.sdfTexture.generateMipmaps=!1,che(c)}const{sdfTexture:u,sdfCanvas:f}=c;KG(t).then(h=>{const{glyphIds:p,glyphFontIndices:m,fontData:g,glyphPositions:y,fontSize:x,timings:_}=h,w=[],T=new Float32Array(p.length*4);let S=0,C=0;const A=ep(),R=g.map(N=>{let z=c.glyphsByFont.get(N.src);return z||c.glyphsByFont.set(N.src,z=new Map),z});p.forEach((N,z)=>{const O=m[z],{src:K,unitsPerEm:V}=g[O];let ne=R[O].get(N);if(!ne){const{path:te,pathBounds:W}=h.glyphData[K][N],X=Math.max(W[2]-W[0],W[3]-W[1])/a*(Hp.sdfMargin*a+.5),J=c.glyphCount++,oe=[W[0]-X,W[1]-X,W[2]+X,W[3]+X];R[O].set(N,ne={path:te,atlasIndex:J,sdfViewBox:oe}),w.push(ne)}const{sdfViewBox:re}=ne,P=y[C++],se=y[C++],ue=x/V;T[S++]=P+re[0]*ue,T[S++]=se+re[1]*ue,T[S++]=P+re[2]*ue,T[S++]=se+re[3]*ue,p[z]=ne.atlasIndex}),_.quads=(_.quads||0)+(ep()-A);const M=ep();_.sdf={};const D=f.height,k=Math.ceil(c.glyphCount/l),L=Math.pow(2,Math.ceil(Math.log2(k*a)));L>D&&(console.info(`Increasing SDF texture size ${D}->${L}`),ahe(f,s,L),u.dispose()),Promise.all(w.map(N=>qG(N,c,t.gpuAccelerateSDF).then(({timing:z})=>{_.sdf[N.atlasIndex]=z}))).then(()=>{w.length&&!c.contextLost&&(YG(c),u.needsUpdate=!0),_.sdfTotal=ep()-M,_.total=ep()-n,e(Object.freeze({parameters:t,sdfTexture:u,sdfGlyphSize:a,sdfExponent:o,glyphBounds:T,glyphAtlasIndices:p,glyphColors:h.glyphColors,caretPositions:h.caretPositions,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))})}),Promise.resolve().then(()=>{c.contextLost||ohe(f)})}function qG({path:t,atlasIndex:e,sdfViewBox:n},{sdfGlyphSize:r,sdfCanvas:i,contextLost:s},o){if(s)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:l}=Hp,c=Math.max(n[2]-n[0],n[3]-n[1]),u=Math.floor(e/4),f=u%(a/r)*r,d=Math.floor(u/(a/r))*r,h=e%4;return ehe(r,r,t,n,c,l,i,f,d,h,o)}function che(t){const e=t.sdfCanvas;e.addEventListener("webglcontextlost",n=>{console.log("Context Lost",n),n.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",n=>{console.log("Context Restored",n),t.contextLost=!1;const r=[];t.glyphsByFont.forEach(i=>{i.forEach(s=>{r.push(qG(s,t,!0))})}),Promise.all(r).then(()=>{YG(t),t.sdfTexture.needsUpdate=!0})})}function uhe({font:t,characters:e,sdfGlyphSize:n},r){let i=Array.isArray(e)?e.join(`
`):""+e;XG({font:t,sdfGlyphSize:n,text:i},r)}function fhe(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}let W2;function bk(t){return W2||(W2=typeof document>"u"?{}:document.createElement("a")),W2.href=t,W2.href}function YG(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:n}=t,{width:r,height:i}=e,s=t.sdfCanvas.getContext("webgl");let o=n.image.data;(!o||o.length!==r*i*4)&&(o=new Uint8Array(r*i*4),n.image={width:r,height:i,data:o},n.flipY=!1,n.isDataTexture=!0),s.readPixels(0,0,r,i,s.RGBA,s.UNSIGNED_BYTE,o)}}const dhe=$m({name:"Typesetter",dependencies:[Jde,Qde,Ude],init(t,e,n){return t(e,n())}}),KG=$m({name:"Typesetter",dependencies:[dhe],init(t){return function(e){return new Promise(n=>{t.typeset(e,n)})}},getTransferables(t){const e=[];for(let n in t)t[n]&&t[n].buffer&&e.push(t[n].buffer);return e}});KG.onMainThread;const Ek={};function hhe(t){let e=Ek[t];return e||(e=Ek[t]=new Ps(1,1,t,t).translate(.5,.5,0)),e}const phe="aTroikaGlyphBounds",wk="aTroikaGlyphIndex",mhe="aTroikaGlyphColor";class ghe extends wy{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new wr,this.boundingBox=new Kn}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let n=hhe(e);["position","normal","uv"].forEach(r=>{this.attributes[r]=n.attributes[r].clone()}),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,n,r,i,s){this.updateAttributeData(phe,e,4),this.updateAttributeData(wk,n,1),this.updateAttributeData(mhe,s,3),this._blockBounds=r,this._chunkedBounds=i,this.instanceCount=n.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:n,boundingBox:r}=this;if(n){const{PI:i,floor:s,min:o,max:a,sin:l,cos:c}=Math,u=i/2,f=i*2,d=Math.abs(n),h=e[0]/d,p=e[2]/d,m=s((h+u)/f)!==s((p+u)/f)?-d:o(l(h)*d,l(p)*d),g=s((h-u)/f)!==s((p-u)/f)?d:a(l(h)*d,l(p)*d),y=s((h+i)/f)!==s((p+i)/f)?d*2:a(d-c(h)*d,d-c(p)*d);r.min.set(m,e[1],n<0?-y:0),r.max.set(g,e[3],n<0?0:y)}else r.min.set(e[0],e[1],0),r.max.set(e[2],e[3],0);r.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let n=this.getAttribute(wk).count,r=this._chunkedBounds;if(r)for(let i=r.length;i--;){n=r[i].end;let s=r[i].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=n}updateAttributeData(e,n,r){const i=this.getAttribute(e);n?i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):(this.setAttribute(e,new Ya(n,r)),delete this._maxInstanceCount,this.dispose()):i&&this.deleteAttribute(e)}}const yhe=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,vhe=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,xhe=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,_he=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function bhe(t){const e=_5(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Ke},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Hn(0,0,0,0)},uTroikaClipRect:{value:new Hn(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Ke},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new wt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Ln},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:yhe,vertexTransform:vhe,fragmentDefs:xhe,fragmentColorTransform:_he,customRewriter({vertexShader:n,fragmentShader:r}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(r)&&(r=r.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(n)||(n=n.replace(WG,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:n,fragmentShader:r}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const fC=new Fr({color:16777215,side:Nr,transparent:!0}),Sk=8421504,Tk=new et,$2=new $,P4=new $,ng=[],Ehe=new $,k4="+x+y";function Ak(t){return Array.isArray(t)?t[0]:t}let ZG=()=>{const t=new ln(new Ps(1,1),fC);return ZG=()=>t,t},QG=()=>{const t=new ln(new Ps(1,1,32,1),fC);return QG=()=>t,t};const whe={type:"syncstart"},She={type:"synccomplete"},JG=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],The=JG.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let ej=class extends ln{constructor(){const e=new ghe;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=Sk,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=k4,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(whe),XG({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},n=>{this._isSyncing=!1,this._textRenderInfo=n,this.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);const r=this._queuedSyncs;r&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{r.forEach(i=>i&&i())})),this.dispatchEvent(She),e&&e()})))}onBeforeRender(e,n,r,i,s,o){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return bhe(e)}get material(){let e=this._derivedMaterial;const n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=fC.clone());if((!e||!e.isDerivedFrom(n))&&(e=this._derivedMaterial=this.createDerivedMaterial(n),n.addEventListener("dispose",function r(){n.removeEventListener("dispose",r),e.dispose()})),this.hasOutline()){let r=e._outlineMtl;return r||(r=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),r.isTextOutlineMaterial=!0,r.depthWrite=!1,r.map=null,e.addEventListener("dispose",function i(){e.removeEventListener("dispose",i),r.dispose()})),[r,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return Ak(this.material).getDepthMaterial()}get customDistanceMaterial(){return Ak(this.material).getDistanceMaterial()}_prepareForRender(e){const n=e.isTextOutlineMaterial,r=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:a,blockBounds:l}=i;r.uTroikaSDFTexture.value=a,r.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),r.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,r.uTroikaSDFExponent.value=i.sdfExponent,r.uTroikaTotalBounds.value.fromArray(l),r.uTroikaUseGlyphColors.value=!n&&!!i.glyphColors;let c=0,u=0,f=0,d,h,p,m=0,g=0;if(n){let{outlineWidth:x,outlineOffsetX:_,outlineOffsetY:w,outlineBlur:T,outlineOpacity:S}=this;c=this._parsePercent(x)||0,u=Math.max(0,this._parsePercent(T)||0),d=S,m=this._parsePercent(_)||0,g=this._parsePercent(w)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(p=this.strokeColor,r.uTroikaStrokeColor.value.set(p??Sk),h=this.strokeOpacity,h==null&&(h=1)),d=this.fillOpacity;r.uTroikaEdgeOffset.value=c,r.uTroikaPositionOffset.value.set(m,g),r.uTroikaBlurRadius.value=u,r.uTroikaStrokeWidth.value=f,r.uTroikaStrokeOpacity.value=h,r.uTroikaFillOpacity.value=d??1,r.uTroikaCurveRadius.value=this.curveRadius||0;let y=this.clipRect;if(y&&Array.isArray(y)&&y.length===4)r.uTroikaClipRect.value.fromArray(y);else{const x=(this.fontSize||.1)*100;r.uTroikaClipRect.value.set(l[0]-x,l[1]-x,l[2]+x,l[3]+x)}this.geometry.applyClipRect(r.uTroikaClipRect.value)}r.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const s=n?this.outlineColor||0:this.color;if(s==null)delete e.color;else{const a=e.hasOwnProperty("color")?e.color:e.color=new wt;(s!==a._input||typeof s=="object")&&a.set(a._input=s)}let o=this.orientation||k4;if(o!==e._orientation){let a=r.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let l=o!==k4&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,u,f,d]=l;$2.set(0,0,0)[u]=c==="-"?1:-1,P4.set(0,0,0)[d]=f==="-"?-1:1,Tk.lookAt(Ehe,$2.cross(P4),P4),a.setFromMatrix4(Tk)}else a.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let n=e.match(/^(-?[\d.]+)%$/),r=n?parseFloat(n[1]):NaN;e=(isNaN(r)?0:r/100)*this.fontSize}return e}localPositionToTextCoords(e,n=new Ke){n.copy(e);const r=this.curveRadius;return r&&(n.x=Math.atan2(e.x,Math.abs(r)-Math.abs(e.z))*Math.abs(r)),n}worldPositionToTextCoords(e,n=new Ke){return $2.copy(e),this.localPositionToTextCoords(this.worldToLocal($2),n)}raycast(e,n){const{textRenderInfo:r,curveRadius:i}=this;if(r){const s=r.blockBounds,o=i?QG():ZG(),a=o.geometry,{position:l,uv:c}=a.attributes;for(let u=0;u<c.count;u++){let f=s[0]+c.getX(u)*(s[2]-s[0]);const d=s[1]+c.getY(u)*(s[3]-s[1]);let h=0;i&&(h=i-Math.cos(f/i)*i,f=Math.sin(f/i)*i),l.setXYZ(u,f,d,h)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,ng.length=0,o.raycast(e,ng);for(let u=0;u<ng.length;u++)ng[u].object=this,n.push(ng[u])}}copy(e){const n=this.geometry;return super.copy(e),this.geometry=n,The.forEach(r=>{this[r]=e[r]}),this}clone(){return new this.constructor().copy(this)}};JG.forEach(t=>{const e="_private_"+t;Object.defineProperty(ej.prototype,t,{get(){return this[e]},set(n){n!==this[e]&&(this[e]=n,this._needsSync=!0)}})});new Kn;new wt;const Mk=v.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:n="middle",font:r,fontSize:i=1,children:s,characters:o,onSync:a,...l},c)=>{const u=At(({invalidate:p})=>p),[f]=v.useState(()=>new ej),[d,h]=v.useMemo(()=>{const p=[];let m="";return v.Children.forEach(s,g=>{typeof g=="string"||typeof g=="number"?m+=g:p.push(g)}),[p,m]},[s]);return ah(()=>new Promise(p=>uhe({font:r,characters:o},p)),["troika-text",r,o]),v.useLayoutEffect(()=>void f.sync(()=>{u(),a&&a(f)})),v.useEffect(()=>()=>f.dispose(),[f]),v.createElement("primitive",It({object:f,ref:c,font:r,text:h,anchorX:e,anchorY:n,fontSize:i,sdfGlyphSize:t},l),d)});let L4=null;async function Ahe(t){return typeof t=="string"?await(await fetch(t)).json():t}function Mhe(t){return L4||(L4=new lde),L4.parse(t)}async function tj(t){const e=await Ahe(t);return Mhe(e)}function dC(t){return ah(tj,[t])}dC.preload=t=>RH(tj,[t]);dC.clear=t=>q6([t]);const Che=["string","number"],Rhe=t=>{let e="";const n=[];return v.Children.forEach(t,r=>{Che.includes(typeof r)?e+=r+"":n.push(r)}),[e,...n]},nj=v.forwardRef(({font:t,letterSpacing:e=0,lineHeight:n=1,size:r=1,height:i=.2,bevelThickness:s=.1,bevelSize:o=.01,bevelEnabled:a=!1,bevelOffset:l=0,bevelSegments:c=4,curveSegments:u=8,smooth:f,children:d,...h},p)=>{v.useMemo(()=>Gi({RenamedTextGeometry:ede}),[]);const m=v.useRef(null),g=dC(t),y=v.useMemo(()=>({font:g,size:r,height:i,bevelThickness:s,bevelSize:o,bevelEnabled:a,bevelSegments:c,bevelOffset:l,curveSegments:u,letterSpacing:e,lineHeight:n}),[g,r,i,s,o,a,c,l,u,e,n]),[x,..._]=v.useMemo(()=>Rhe(d),[d]),w=v.useMemo(()=>[x,y],[x,y]);return v.useLayoutEffect(()=>{f&&(m.current.geometry=Tue(m.current.geometry,f),m.current.geometry.computeVertexNormals())},[w,f]),v.useImperativeHandle(p,()=>m.current,[]),v.createElement("mesh",It({},h,{ref:m}),v.createElement("renamedTextGeometry",{args:w}),_)}),f$e=()=>{try{var t=document.createElement("canvas");return!!(window.WebGL2RenderingContext&&t.getContext("webgl2"))}catch{return!1}},rj=v.forwardRef(({children:t,multisamping:e=8,renderIndex:n=1,disableRender:r,disableGamma:i,disableRenderPass:s,depthBuffer:o=!0,stencilBuffer:a=!1,anisotropy:l=1,encoding:c,type:u,...f},d)=>{v.useMemo(()=>Gi({EffectComposer:pfe,RenderPass:yfe,ShaderPass:p5}),[]);const h=v.useRef(null);v.useImperativeHandle(d,()=>h.current,[]);const{scene:p,camera:m,gl:g,size:y,viewport:x}=At(),[_]=v.useState(()=>{const T=new fr(y.width,y.height,{type:u||ti,format:Pr,depthBuffer:o,stencilBuffer:a,anisotropy:l});return u===Rs&&c!=null&&("colorSpace"in T?T.texture.colorSpace=c:T.texture.encoding=c),T.samples=e,T});v.useEffect(()=>{var T,S;(T=h.current)==null||T.setSize(y.width,y.height),(S=h.current)==null||S.setPixelRatio(x.dpr)},[g,y,x.dpr]),Yt(()=>{var T;r||(T=h.current)==null||T.render()},n);const w=[];return s||w.push(v.createElement("renderPass",{key:"renderpass",attach:`passes-${w.length}`,args:[p,m]})),i||w.push(v.createElement("shaderPass",{attach:`passes-${w.length}`,key:"gammapass",args:[tde]})),v.Children.forEach(t,T=>{T&&w.push(v.cloneElement(T,{key:w.length,attach:`passes-${w.length}`}))}),v.createElement("effectComposer",It({ref:h,args:[g,_]},f),w)});let Ck=function(t){return t.Linear="linear",t.Radial="radial",t}({});function ij({stops:t,colors:e,size:n=1024,width:r=16,type:i=Ck.Linear,innerCircleRadius:s=0,outerCircleRadius:o="auto",...a}){const l=At(u=>u.gl),c=v.useMemo(()=>{const u=document.createElement("canvas"),f=u.getContext("2d");u.width=r,u.height=n;let d;if(i===Ck.Linear)d=f.createLinearGradient(0,0,0,n);else{const m=u.width/2,g=u.height/2,y=o!=="auto"?Math.abs(Number(o)):Math.sqrt(m**2+g**2);d=f.createRadialGradient(m,g,Math.abs(s),m,g,y)}const h=new wt;let p=t.length;for(;p--;)d.addColorStop(t[p],h.set(e[p]).getStyle());return f.save(),f.fillStyle=d,f.fillRect(0,0,r,n),f.restore(),u},[t]);return v.createElement("canvasTexture",It({colorSpace:l.outputColorSpace,args:[c],attach:"map"},a))}function Ml(t,e,n,r){const i=class extends yr{constructor(o={}){const a=Object.entries(t);super({uniforms:a.reduce((l,[c,u])=>{const f=mf.clone({[c]:{value:u}});return{...l,...f}},{}),vertexShader:e,fragmentShader:n}),this.key="",a.forEach(([l])=>Object.defineProperty(this,l,{get:()=>this.uniforms[l].value,set:c=>this.uniforms[l].value=c})),Object.assign(this,o),r&&r(this)}};return i.key=ri.generateUUID(),i}const D4=t=>t===Object(t)&&!Array.isArray(t)&&typeof t!="function";function Cy(t,e){const n=At(s=>s.gl),r=rs(ns,D4(t)?Object.values(t):t);return v.useLayoutEffect(()=>{e==null||e(r)},[e]),v.useEffect(()=>{if("initTexture"in n){let s=[];Array.isArray(r)?s=r:r instanceof tr?s=[r]:D4(r)&&(s=Object.values(r)),s.forEach(o=>{o instanceof tr&&n.initTexture(o)})}},[n,r]),v.useMemo(()=>{if(D4(t)){const s={};let o=0;for(const a in t)s[a]=r[o++];return s}else return r},[t,r])}Cy.preload=t=>rs.preload(ns,t);Cy.clear=t=>rs.clear(ns,t);const h$e=({children:t,input:e,onLoad:n})=>{const r=Cy(e,n);return v.createElement(v.Fragment,null,t==null?void 0:t(r))},Ihe=()=>parseInt(wl.replace(/\D+/g,"")),Ro=Ihe(),Rk=Ml({color:new wt("white"),scale:new Ke(1,1),imageBounds:new Ke(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},`
  varying vec2 vUv;
  varying vec2 vPos;
  void main() {
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
    vUv = uv;
    vPos = position.xy;
  }
`,`
  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44
  varying vec2 vUv;
  varying vec2 vPos;
  uniform vec2 scale;
  uniform vec2 imageBounds;
  uniform float resolution;
  uniform vec3 color;
  uniform sampler2D map;
  uniform float radius;
  uniform float zoom;
  uniform float grayscale;
  uniform float opacity;
  const vec3 luma = vec3(.299, 0.587, 0.114);
  vec4 toGrayscale(vec4 color, float intensity) {
    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);
  }
  vec2 aspect(vec2 size) {
    return size / min(size.x, size.y);
  }
  
  const float PI = 3.14159265;
    
  // from https://iquilezles.org/articles/distfunctions
  float udRoundBox( vec2 p, vec2 b, float r ) {
    return length(max(abs(p)-b+r,0.0))-r;
  }

  void main() {
    vec2 s = aspect(scale);
    vec2 i = aspect(imageBounds);
    float rs = s.x / s.y;
    float ri = i.x / i.y;
    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);
    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;
    vec2 uv = vUv * s / new + offset;
    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);

    vec2 res = vec2(scale * resolution);
    vec2 halfRes = 0.5 * res;
    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    
	  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));
    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);
    
    #include <tonemapping_fragment>
    #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
  }
`),sj=v.forwardRef(({children:t,color:e,segments:n=1,scale:r=1,zoom:i=1,grayscale:s=0,opacity:o=1,radius:a=0,texture:l,toneMapped:c,transparent:u,side:f,...d},h)=>{Gi({ImageMaterial:Rk});const p=v.useRef(null),m=At(_=>_.size),g=Array.isArray(r)?[r[0],r[1]]:[r,r],y=[l.image.width,l.image.height],x=Math.max(m.width,m.height);return v.useImperativeHandle(h,()=>p.current,[]),v.useLayoutEffect(()=>{p.current.geometry.parameters&&p.current.material.scale.set(g[0]*p.current.geometry.parameters.width,g[1]*p.current.geometry.parameters.height)},[g[0],g[1]]),v.createElement("mesh",It({ref:p,scale:Array.isArray(r)?[...r,1]:r},d),v.createElement("planeGeometry",{args:[1,1,n,n]}),v.createElement("imageMaterial",{color:e,map:l,zoom:i,grayscale:s,opacity:o,scale:g,imageBounds:y,resolution:x,radius:a,toneMapped:c,transparent:u,side:f,key:Rk.key}),t)}),Phe=v.forwardRef(({url:t,...e},n)=>{const r=Cy(t);return v.createElement(sj,It({},e,{texture:r,ref:n}))}),khe=v.forwardRef(({url:t,...e},n)=>v.createElement(sj,It({},e,{ref:n}))),oj=v.forwardRef((t,e)=>{if(t.url)return v.createElement(Phe,It({},t,{ref:e}));if(t.texture)return v.createElement(khe,It({},t,{ref:e}));throw new Error("<Image /> requires a url or texture")}),aj=v.forwardRef(({threshold:t=15,geometry:e,...n},r)=>{const i=v.useRef(null);v.useImperativeHandle(r,()=>i.current,[]);const s=v.useMemo(()=>[0,0,0,1,0,0],[]),o=v.useRef(),a=v.useRef();return v.useLayoutEffect(()=>{const l=i.current.parent,c=e??(l==null?void 0:l.geometry);if(!c||o.current===c&&a.current===t)return;o.current=c,a.current=t;const f=new P6(c,t).attributes.position.array;i.current.geometry.setPositions(f),i.current.geometry.attributes.instanceStart.needsUpdate=!0,i.current.geometry.attributes.instanceEnd.needsUpdate=!0,i.current.computeLineDistances()}),v.createElement(Ni,It({segments:!0,points:s,ref:i,raycast:()=>null},n))}),Ik=Ml({screenspace:!1,color:new wt("black"),opacity:1,thickness:.05,size:new Ke},`#include <common>
   #include <morphtarget_pars_vertex>
   #include <skinning_pars_vertex>
   uniform float thickness;
   uniform bool screenspace;
   uniform vec2 size;
   void main() {
     #if defined (USE_SKINNING)
	     #include <beginnormal_vertex>
       #include <morphnormal_vertex>
       #include <skinbase_vertex>
       #include <skinnormal_vertex>
       #include <defaultnormal_vertex>
     #endif
     #include <begin_vertex>
	   #include <morphtarget_vertex>
	   #include <skinning_vertex>
     #include <project_vertex>
     vec4 tNormal = vec4(normal, 0.0);
     vec4 tPosition = vec4(transformed, 1.0);
     #ifdef USE_INSTANCING
       tNormal = instanceMatrix * tNormal;
       tPosition = instanceMatrix * tPosition;
     #endif
     if (screenspace) {
       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;
       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); 
     } else {
       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;
       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;
       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;
       clipPosition.xy += offset;
       gl_Position = clipPosition;
     }
   }`,`uniform vec3 color;
   uniform float opacity;
   void main(){
     gl_FragColor = vec4(color, opacity);
     #include <tonemapping_fragment>
     #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
   }`);function hC({color:t="black",opacity:e=1,transparent:n=!1,screenspace:r=!1,toneMapped:i=!0,polygonOffset:s=!1,polygonOffsetFactor:o=0,renderOrder:a=0,thickness:l=.05,angle:c=Math.PI,...u}){const f=v.useRef(),[d]=v.useState(()=>new Ik({side:zi})),{gl:h}=At(),p=h.getDrawingBufferSize(new Ke);v.useMemo(()=>Gi({OutlinesMaterial:Ik}),[]);const m=v.useRef(0),g=v.useRef();return v.useLayoutEffect(()=>{const y=f.current;if(!y)return;const x=y.parent;if(x&&x.geometry&&(m.current!==c||g.current!==x.geometry)){var _;m.current=c,g.current=x.geometry;let w=(_=y.children)==null?void 0:_[0];w&&(c&&w.geometry.dispose(),y.remove(w)),x.skeleton?(w=new Qd,w.material=d,w.bind(x.skeleton,x.bindMatrix),y.add(w)):x.isInstancedMesh?(w=new eh(x.geometry,d,x.count),w.instanceMatrix=x.instanceMatrix,y.add(w)):(w=new ln,w.material=d,y.add(w)),w.geometry=c?hG(x.geometry,c):x.geometry}}),v.useLayoutEffect(()=>{const y=f.current;if(!y)return;const x=y.children[0];x&&(x.renderOrder=a,to(x.material,{transparent:n,thickness:l,color:t,opacity:e,size:p,screenspace:r,toneMapped:i,polygonOffset:s,polygonOffsetFactor:o}))}),v.useEffect(()=>()=>{const y=f.current;if(!y)return;const x=y.children[0];x&&(c&&x.geometry.dispose(),y.remove(x))},[]),v.createElement("group",It({ref:f},u))}var Lhe=Object.defineProperty,Dhe=(t,e,n)=>e in t?Lhe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Tr=(t,e,n)=>(Dhe(t,typeof e!="symbol"?e+"":e,n),n);function N4(t,e,n,r,i){let s;if(t=t.subarray||t.slice?t:t.buffer,n=n.subarray||n.slice?n:n.buffer,t=e?t.subarray?t.subarray(e,i&&e+i):t.slice(e,i&&e+i):t,n.set)n.set(t,r);else for(s=0;s<t.length;s++)n[s+r]=t[s];return n}function Nhe(t){return t instanceof Float32Array?t:t instanceof gn?t.getAttribute("position").array:t.map(e=>{const n=Array.isArray(e);return e instanceof $?[e.x,e.y,e.z]:e instanceof Ke?[e.x,e.y,0]:n&&e.length===3?[e[0],e[1],e[2]]:n&&e.length===2?[e[0],e[1],0]:e}).flat()}class lj extends gn{constructor(){super(),Tr(this,"type","MeshLine"),Tr(this,"isMeshLine",!0),Tr(this,"positions",[]),Tr(this,"previous",[]),Tr(this,"next",[]),Tr(this,"side",[]),Tr(this,"width",[]),Tr(this,"indices_array",[]),Tr(this,"uvs",[]),Tr(this,"counters",[]),Tr(this,"widthCallback",null),Tr(this,"_attributes"),Tr(this,"_points",[]),Tr(this,"points"),Tr(this,"matrixWorld",new et),Object.defineProperties(this,{points:{enumerable:!0,get(){return this._points},set(e){this.setPoints(e,this.widthCallback)}}})}setMatrixWorld(e){this.matrixWorld=e}setPoints(e,n){if(e=Nhe(e),this._points=e,this.widthCallback=n??null,this.positions=[],this.counters=[],e.length&&e[0]instanceof $)for(let r=0;r<e.length;r++){const i=e[r],s=r/(e.length-1);this.positions.push(i.x,i.y,i.z),this.positions.push(i.x,i.y,i.z),this.counters.push(s),this.counters.push(s)}else for(let r=0;r<e.length;r+=3){const i=r/(e.length-1);this.positions.push(e[r],e[r+1],e[r+2]),this.positions.push(e[r],e[r+1],e[r+2]),this.counters.push(i),this.counters.push(i)}this.process()}compareV3(e,n){const r=e*6,i=n*6;return this.positions[r]===this.positions[i]&&this.positions[r+1]===this.positions[i+1]&&this.positions[r+2]===this.positions[i+2]}copyV3(e){const n=e*6;return[this.positions[n],this.positions[n+1],this.positions[n+2]]}process(){const e=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];let n,r;this.compareV3(0,e-1)?r=this.copyV3(e-2):r=this.copyV3(0),this.previous.push(r[0],r[1],r[2]),this.previous.push(r[0],r[1],r[2]);for(let i=0;i<e;i++){if(this.side.push(1),this.side.push(-1),this.widthCallback?n=this.widthCallback(i/(e-1)):n=1,this.width.push(n),this.width.push(n),this.uvs.push(i/(e-1),0),this.uvs.push(i/(e-1),1),i<e-1){r=this.copyV3(i),this.previous.push(r[0],r[1],r[2]),this.previous.push(r[0],r[1],r[2]);const s=i*2;this.indices_array.push(s,s+1,s+2),this.indices_array.push(s+2,s+1,s+3)}i>0&&(r=this.copyV3(i),this.next.push(r[0],r[1],r[2]),this.next.push(r[0],r[1],r[2]))}this.compareV3(e-1,0)?r=this.copyV3(1):r=this.copyV3(e-1),this.next.push(r[0],r[1],r[2]),this.next.push(r[0],r[1],r[2]),!this._attributes||this._attributes.position.count!==this.counters.length?this._attributes={position:new fn(new Float32Array(this.positions),3),previous:new fn(new Float32Array(this.previous),3),next:new fn(new Float32Array(this.next),3),side:new fn(new Float32Array(this.side),1),width:new fn(new Float32Array(this.width),1),uv:new fn(new Float32Array(this.uvs),2),index:new fn(new Uint16Array(this.indices_array),1),counters:new fn(new Float32Array(this.counters),1)}:(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}advance({x:e,y:n,z:r}){const i=this._attributes.position.array,s=this._attributes.previous.array,o=this._attributes.next.array,a=i.length;N4(i,0,s,0,a),N4(i,6,i,0,a-6),i[a-6]=e,i[a-5]=n,i[a-4]=r,i[a-3]=e,i[a-2]=n,i[a-1]=r,N4(i,6,o,0,a-6),o[a-6]=e,o[a-5]=n,o[a-4]=r,o[a-3]=e,o[a-2]=n,o[a-1]=r,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0}}const Ohe=`
  #include <common>
  #include <logdepthbuf_pars_vertex>
  #include <fog_pars_vertex>
  #include <clipping_planes_pars_vertex>

  attribute vec3 previous;
  attribute vec3 next;
  attribute float side;
  attribute float width;
  attribute float counters;
  
  uniform vec2 resolution;
  uniform float lineWidth;
  uniform vec3 color;
  uniform float opacity;
  uniform float sizeAttenuation;
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  vec2 fix(vec4 i, float aspect) {
    vec2 res = i.xy / i.w;
    res.x *= aspect;
    return res;
  }
  
  void main() {
    float aspect = resolution.x / resolution.y;
    vColor = vec4(color, opacity);
    vUV = uv;
    vCounters = counters;
  
    mat4 m = projectionMatrix * modelViewMatrix;
    vec4 finalPosition = m * vec4(position, 1.0) * aspect;
    vec4 prevPos = m * vec4(previous, 1.0);
    vec4 nextPos = m * vec4(next, 1.0);
  
    vec2 currentP = fix(finalPosition, aspect);
    vec2 prevP = fix(prevPos, aspect);
    vec2 nextP = fix(nextPos, aspect);
  
    float w = lineWidth * width;
  
    vec2 dir;
    if (nextP == currentP) dir = normalize(currentP - prevP);
    else if (prevP == currentP) dir = normalize(nextP - currentP);
    else {
      vec2 dir1 = normalize(currentP - prevP);
      vec2 dir2 = normalize(nextP - currentP);
      dir = normalize(dir1 + dir2);
  
      vec2 perp = vec2(-dir1.y, dir1.x);
      vec2 miter = vec2(-dir.y, dir.x);
      //w = clamp(w / dot(miter, perp), 0., 4. * lineWidth * width);
    }
  
    //vec2 normal = (cross(vec3(dir, 0.), vec3(0., 0., 1.))).xy;
    vec4 normal = vec4(-dir.y, dir.x, 0., 1.);
    normal.xy *= .5 * w;
    //normal *= projectionMatrix;
    if (sizeAttenuation == 0.) {
      normal.xy *= finalPosition.w;
      normal.xy /= (vec4(resolution, 0., 1.) * projectionMatrix).xy * aspect;
    }
  
    finalPosition.xy += normal.xy * side;
    gl_Position = finalPosition;
    #include <logdepthbuf_vertex>
    #include <fog_vertex>
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    #include <clipping_planes_vertex>
    #include <fog_vertex>
  }
`,Fhe=parseInt(wl.replace(/\D+/g,"")),Uhe=Fhe>=154?"colorspace_fragment":"encodings_fragment",Bhe=`
  #include <fog_pars_fragment>
  #include <logdepthbuf_pars_fragment>
  #include <clipping_planes_pars_fragment>
  
  uniform sampler2D map;
  uniform sampler2D alphaMap;
  uniform float useGradient;
  uniform float useMap;
  uniform float useAlphaMap;
  uniform float useDash;
  uniform float dashArray;
  uniform float dashOffset;
  uniform float dashRatio;
  uniform float visibility;
  uniform float alphaTest;
  uniform vec2 repeat;
  uniform vec3 gradient[2];
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  void main() {
    #include <logdepthbuf_fragment>
    vec4 diffuseColor = vColor;
    if (useGradient == 1.) diffuseColor = vec4(mix(gradient[0], gradient[1], vCounters), 1.0);
    if (useMap == 1.) diffuseColor *= texture2D(map, vUV * repeat);
    if (useAlphaMap == 1.) diffuseColor.a *= texture2D(alphaMap, vUV * repeat).a;
    if (diffuseColor.a < alphaTest) discard;
    if (useDash == 1.) diffuseColor.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));
    diffuseColor.a *= step(vCounters, visibility);
    #include <clipping_planes_fragment>
    gl_FragColor = diffuseColor;     
    #include <fog_fragment>
    #include <tonemapping_fragment>
    #include <${Uhe}>
  }
`;class cj extends yr{constructor(e){super({uniforms:{...Qt.fog,lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new wt(16777215)},gradient:{value:[new wt(16711680),new wt(65280)]},opacity:{value:1},resolution:{value:new Ke(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},useGradient:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new Ke(1,1)}},vertexShader:Ohe,fragmentShader:Bhe}),Tr(this,"lineWidth"),Tr(this,"map"),Tr(this,"useMap"),Tr(this,"alphaMap"),Tr(this,"useAlphaMap"),Tr(this,"color"),Tr(this,"gradient"),Tr(this,"resolution"),Tr(this,"sizeAttenuation"),Tr(this,"dashArray"),Tr(this,"dashOffset"),Tr(this,"dashRatio"),Tr(this,"useDash"),Tr(this,"useGradient"),Tr(this,"visibility"),Tr(this,"repeat"),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get(){return this.uniforms.lineWidth.value},set(n){this.uniforms.lineWidth.value=n}},map:{enumerable:!0,get(){return this.uniforms.map.value},set(n){this.uniforms.map.value=n}},useMap:{enumerable:!0,get(){return this.uniforms.useMap.value},set(n){this.uniforms.useMap.value=n}},alphaMap:{enumerable:!0,get(){return this.uniforms.alphaMap.value},set(n){this.uniforms.alphaMap.value=n}},useAlphaMap:{enumerable:!0,get(){return this.uniforms.useAlphaMap.value},set(n){this.uniforms.useAlphaMap.value=n}},color:{enumerable:!0,get(){return this.uniforms.color.value},set(n){this.uniforms.color.value=n}},gradient:{enumerable:!0,get(){return this.uniforms.gradient.value},set(n){this.uniforms.gradient.value=n}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(n){this.uniforms.opacity.value=n}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(n){this.uniforms.resolution.value.copy(n)}},sizeAttenuation:{enumerable:!0,get(){return this.uniforms.sizeAttenuation.value},set(n){this.uniforms.sizeAttenuation.value=n}},dashArray:{enumerable:!0,get(){return this.uniforms.dashArray.value},set(n){this.uniforms.dashArray.value=n,this.useDash=n!==0?1:0}},dashOffset:{enumerable:!0,get(){return this.uniforms.dashOffset.value},set(n){this.uniforms.dashOffset.value=n}},dashRatio:{enumerable:!0,get(){return this.uniforms.dashRatio.value},set(n){this.uniforms.dashRatio.value=n}},useDash:{enumerable:!0,get(){return this.uniforms.useDash.value},set(n){this.uniforms.useDash.value=n}},useGradient:{enumerable:!0,get(){return this.uniforms.useGradient.value},set(n){this.uniforms.useGradient.value=n}},visibility:{enumerable:!0,get(){return this.uniforms.visibility.value},set(n){this.uniforms.visibility.value=n}},alphaTest:{enumerable:!0,get(){return this.uniforms.alphaTest.value},set(n){this.uniforms.alphaTest.value=n}},repeat:{enumerable:!0,get(){return this.uniforms.repeat.value},set(n){this.uniforms.repeat.value.copy(n)}}}),this.setValues(e)}copy(e){return super.copy(e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.gradient=e.gradient,this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray=e.dashArray,this.dashOffset=e.dashOffset,this.dashRatio=e.dashRatio,this.useDash=e.useDash,this.useGradient=e.useGradient,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this}}const uj={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},zhe=(t,e=1)=>(t.set(t.subarray(e)),t.fill(-1/0,-e),t);function Hhe(t,e){const{length:n,local:r,decay:i,interval:s,stride:o}={...uj,...e},a=v.useRef(),[l]=v.useState(()=>new $);v.useLayoutEffect(()=>{t&&(a.current=Float32Array.from({length:n*10*3},(f,d)=>t.position.getComponent(d%3)))},[n,t]);const c=v.useRef(new $),u=v.useRef(0);return Yt(()=>{if(t&&a.current){if(u.current===0){let f;r?f=t.position:(t.getWorldPosition(l),f=l);const d=1*i;for(let h=0;h<d;h++)f.distanceTo(c.current)<o||(zhe(a.current,3),a.current.set(f.toArray(),a.current.length-3));c.current.copy(f)}u.current++,u.current=u.current%s}}),a}const fj=v.forwardRef((t,e)=>{const{children:n}=t,{width:r,length:i,decay:s,local:o,stride:a,interval:l}={...uj,...t},{color:c="hotpink",attenuation:u,target:f}=t,d=At(w=>w.size),h=At(w=>w.scene),p=v.useRef(null),[m,g]=v.useState(null),y=Hhe(m,{length:i,decay:s,local:o,stride:a,interval:l});v.useEffect(()=>{const w=(f==null?void 0:f.current)||p.current.children.find(T=>T instanceof yn);w&&g(w)},[y,f]);const x=v.useMemo(()=>new lj,[]),_=v.useMemo(()=>{var w;const T=new cj({lineWidth:.1*r,color:c,sizeAttenuation:1,resolution:new Ke(d.width,d.height)});let S;if(n)if(Array.isArray(n))S=n.find(C=>{const A=C;return typeof A.type=="string"&&A.type==="meshLineMaterial"});else{const C=n;typeof C.type=="string"&&C.type==="meshLineMaterial"&&(S=C)}return typeof((w=S)==null?void 0:w.props)=="object"&&T.setValues(S.props),T},[r,c,d,n]);return v.useEffect(()=>{_.uniforms.resolution.value.set(d.width,d.height)},[d]),Yt(()=>{y.current&&x.setPoints(y.current,u)}),v.createElement("group",null,Al(v.createElement("mesh",{ref:e,geometry:x,material:_}),h),v.createElement("group",{ref:p},n))});function Ghe(t,e=16,n,r,i){const[s,o]=v.useState(()=>{const a=Array.from({length:e},()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]).flat();return new Ya(Float32Array.from(a),16)});return v.useLayoutEffect(()=>{if(typeof t.current>"u")return;const a=new Zue(t.current);r&&a.setWeightAttribute(r),a.build();const l=new $,c=new $,u=new wt,f=new yn;t.current.updateMatrixWorld(!0);for(let d=0;d<e;d++)a.sample(l,c,u),typeof n=="function"?n({dummy:f,sampledMesh:t.current,position:l,normal:c,color:u},d):f.position.copy(l),f.updateMatrix(),i!=null&&i.current&&i.current.setMatrixAt(d,f.matrix),f.matrix.toArray(s.array,d*16);i!=null&&i.current&&(i.current.instanceMatrix.needsUpdate=!0),s.needsUpdate=!0,o(new Ya(s.array,s.itemSize).copy(s))},[t,i,r,e,n]),s}function dj({children:t,weight:e,transform:n,instances:r,mesh:i,count:s=16,...o}){const a=v.useRef(null),l=v.useRef(null),c=v.useRef(null);return v.useLayoutEffect(()=>{var u,f;l.current=(u=r==null?void 0:r.current)!==null&&u!==void 0?u:a.current.children.find(d=>d.hasOwnProperty("instanceMatrix")),c.current=(f=i==null?void 0:i.current)!==null&&f!==void 0?f:a.current.children.find(d=>d.type==="Mesh")},[t,i==null?void 0:i.current,r==null?void 0:r.current]),Ghe(c,s,n,e,l),v.createElement("group",It({ref:a},o),t)}const hj=({compute:t,name:e,...n})=>{const[r]=v.useState(()=>new fn(new Float32Array(0),1)),i=v.useRef(null);return v.useLayoutEffect(()=>{if(i.current){var s;const o=(s=i.current.parent)!==null&&s!==void 0?s:i.current.__r3f.parent,a=t(o);i.current.copy(a)}},[t]),v.createElement("primitive",It({ref:i,object:r,attach:`attributes-${e}`},n))};function jhe(t,{keys:e=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:n,inject:r,castShadow:i,receiveShadow:s}){let o={};for(const a of e)o[a]=t[a];return n&&(o.geometry&&n!=="materialsOnly"&&(o.geometry=o.geometry.clone()),o.material&&n!=="geometriesOnly"&&(o.material=o.material.clone())),r&&(typeof r=="function"?o={...o,children:r(t)}:v.isValidElement(r)?o={...o,children:r}:o={...o,...r}),t instanceof ln&&(i&&(o.castShadow=!0),s&&(o.receiveShadow=!0)),o}const m_=v.forwardRef(({isChild:t=!1,object:e,children:n,deep:r,castShadow:i,receiveShadow:s,inject:o,keys:a,...l},c)=>{const u={keys:a,deep:r,inject:o,castShadow:i,receiveShadow:s};if(e=v.useMemo(()=>{if(t===!1&&!Array.isArray(e)){let p=!1;if(e.traverse(m=>{m.isSkinnedMesh&&(p=!0)}),p)return Kue.clone(e)}return e},[e,t]),Array.isArray(e))return v.createElement("group",It({},l,{ref:c}),e.map(p=>v.createElement(m_,It({key:p.uuid,object:p},u))),n);const{children:f,...d}=jhe(e,u),h=e.type[0].toLowerCase()+e.type.slice(1);return v.createElement(h,It({},d,l,{ref:c}),e.children.map(p=>p.type==="Bone"?v.createElement("primitive",It({key:p.uuid,object:p},u)):v.createElement(m_,It({key:p.uuid,object:p},u,{isChild:!0}))),n,f)}),pC=v.createContext(null),pj=v.forwardRef(({resolution:t=28,maxPolyCount:e=1e4,enableUvs:n=!1,enableColors:r=!1,children:i,...s},o)=>{const a=v.useRef(null);v.useImperativeHandle(o,()=>a.current,[]);const l=v.useMemo(()=>new Bue(t,null,n,r,e),[t,e,n,r]),c=v.useMemo(()=>({getParent:()=>a}),[]);return Yt(()=>{l.update(),l.reset()},-1),v.createElement(v.Fragment,null,v.createElement("primitive",It({object:l,ref:a},s),v.createElement(pC.Provider,{value:c},i)))}),p$e=v.forwardRef(({strength:t=.5,subtract:e=12,color:n,...r},i)=>{const{getParent:s}=v.useContext(pC),o=v.useMemo(()=>s(),[s]),a=v.useRef(null);v.useImperativeHandle(i,()=>a.current,[]);const l=new $;return Yt(c=>{!o.current||!a.current||(a.current.getWorldPosition(l),o.current.addBall(.5+l.x*.5,.5+l.y*.5,.5+l.z*.5,t,e,n))}),v.createElement("group",It({ref:a},r))}),m$e=v.forwardRef(({planeType:t="x",strength:e=.5,subtract:n=12,...r},i)=>{const{getParent:s}=v.useContext(pC),o=v.useMemo(()=>s(),[s]),a=v.useRef(null);v.useImperativeHandle(i,()=>a.current,[]);const l=v.useMemo(()=>t==="x"?"addPlaneX":t==="y"?"addPlaneY":"addPlaneZ",[t]);return Yt(()=>{!o.current||!a.current||o.current[l](e,n)}),v.createElement("group",It({ref:a},r))});function Vhe(t){return Array.isArray(t)}function O4(t=[0,0,0]){return Vhe(t)?t:t instanceof $||t instanceof xr?[t.x,t.y,t.z]:[t,t,t]}const mj=v.forwardRef(function({debug:e,depthTest:n=!1,polygonOffsetFactor:r=-10,map:i,mesh:s,children:o,position:a,rotation:l,scale:c,...u},f){const d=v.useRef(null);v.useImperativeHandle(f,()=>d.current);const h=v.useRef(null),p=v.useRef({position:new $,rotation:new xr,scale:new $(1,1,1)});return v.useLayoutEffect(()=>{const m=(s==null?void 0:s.current)||d.current.parent,g=d.current;if(!(m instanceof ln))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');if(m){to(p.current,{position:a,scale:c});const y=m.matrixWorld.clone();if(m.matrixWorld.identity(),!l||typeof l=="number"){const x=new yn;x.position.copy(p.current.position);const _=m.geometry.attributes.position.array;m.geometry.attributes.normal===void 0&&m.geometry.computeVertexNormals();const w=m.geometry.attributes.normal.array;let T=1/0;new $;let S=new $;const C=x.position.x,A=x.position.y,R=x.position.z,M=_.length;let D=-1;for(let k=0;k<M;k+=3){const L=_[k],N=_[k+1],z=_[k+2],O=L-C,K=N-A,V=z-R,ne=O*O+K*K+V*V;ne<T&&(T=ne,D=k)}S.fromArray(w,D),x.lookAt(x.position.clone().add(S)),x.rotateZ(Math.PI),x.rotateY(Math.PI),typeof l=="number"&&x.rotateZ(l),to(p.current,{rotation:x.rotation})}else to(p.current,{rotation:l});return g.geometry=new Jfe(m,p.current.position,p.current.rotation,p.current.scale),m.matrixWorld=y,()=>{g.geometry.dispose()}}},[s,...O4(a),...O4(c),...O4(l)]),v.useLayoutEffect(()=>{h.current&&(to(h.current,p.current),h.current.traverse(m=>m.raycast=()=>null))},[e]),v.createElement("mesh",It({ref:d,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":r,"material-depthTest":n,"material-map":i},u),o,e&&v.createElement("mesh",{ref:h},v.createElement("boxGeometry",null),v.createElement("meshNormalMaterial",{wireframe:!0}),v.createElement("axesHelper",null)))}),gj=v.forwardRef(function({src:e,skipFill:n,skipStrokes:r,fillMaterial:i,strokeMaterial:s,fillMeshProps:o,strokeMeshProps:a,...l},c){const u=rs(m1,e.startsWith("<svg")?`data:image/svg+xml;utf8,${e}`:e),f=v.useMemo(()=>r?[]:u.paths.map(h=>{var p;return((p=h.userData)==null?void 0:p.style.stroke)===void 0||h.userData.style.stroke==="none"?null:h.subPaths.map(m=>m1.pointsToStroke(m.getPoints(),h.userData.style))}),[u,r]);v.useEffect(()=>()=>f.forEach(h=>h&&h.map(p=>p.dispose())),[f]);let d=0;return v.createElement("object3D",It({ref:c},l),v.createElement("object3D",{scale:[1,-1,1]},u.paths.map((h,p)=>{var m,g;return v.createElement(v.Fragment,{key:p},!n&&((m=h.userData)==null?void 0:m.style.fill)!==void 0&&h.userData.style.fill!=="none"&&m1.createShapes(h).map((y,x)=>v.createElement("mesh",It({key:x},o,{renderOrder:d++}),v.createElement("shapeGeometry",{args:[y]}),v.createElement("meshBasicMaterial",It({color:h.userData.style.fill,opacity:h.userData.style.fillOpacity,transparent:!0,side:Nr,depthWrite:!1},i)))),!r&&((g=h.userData)==null?void 0:g.style.stroke)!==void 0&&h.userData.style.stroke!=="none"&&h.subPaths.map((y,x)=>v.createElement("mesh",It({key:x,geometry:f[p][x]},a,{renderOrder:d++}),v.createElement("meshBasicMaterial",It({color:h.userData.style.stroke,opacity:h.userData.style.strokeOpacity,transparent:!0,side:Nr,depthWrite:!1},s)))))})))});function yj({renderIndex:t=1,bgColor:e="black",fgColor:n="white",characters:r=" .:-+*=%@#",invert:i=!0,color:s=!1,resolution:o=.15}){const{size:a,gl:l,scene:c,camera:u}=At(),f=v.useMemo(()=>{const d=new sde(l,r,{invert:i,color:s,resolution:o});return d.domElement.style.position="absolute",d.domElement.style.top="0px",d.domElement.style.left="0px",d.domElement.style.pointerEvents="none",d},[r,i,s,o]);return v.useLayoutEffect(()=>{f.domElement.style.color=n,f.domElement.style.backgroundColor=e},[n,e]),v.useEffect(()=>(l.domElement.style.opacity="0",l.domElement.parentNode.appendChild(f.domElement),()=>{l.domElement.style.opacity="1",l.domElement.parentNode.removeChild(f.domElement)}),[f]),v.useEffect(()=>{f.setSize(a.width,a.height)},[f,a]),Yt(d=>{f.render(c,u)},t),v.createElement(v.Fragment,null)}const Pk=Ml({alphaTest:0,viewport:new Ke(1980,1080),focal:1e3,centerAndScaleTexture:null,covAndColorTexture:null},`
    precision highp sampler2D;
    precision highp usampler2D;
    out vec4 vColor;
    out vec3 vPosition;
    uniform vec2 resolution;
    uniform vec2 viewport;
    uniform float focal;
    attribute uint splatIndex;
    uniform sampler2D centerAndScaleTexture;
    uniform usampler2D covAndColorTexture;    

    vec2 unpackInt16(in uint value) {
      int v = int(value);
      int v0 = v >> 16;
      int v1 = (v & 0xFFFF);
      if((v & 0x8000) != 0)
        v1 |= 0xFFFF0000;
      return vec2(float(v1), float(v0));
    }

    void main () {
      ivec2 texSize = textureSize(centerAndScaleTexture, 0);
      ivec2 texPos = ivec2(splatIndex%uint(texSize.x), splatIndex/uint(texSize.x));
      vec4 centerAndScaleData = texelFetch(centerAndScaleTexture, texPos, 0);
      vec4 center = vec4(centerAndScaleData.xyz, 1);
      vec4 camspace = modelViewMatrix * center;
      vec4 pos2d = projectionMatrix * camspace;

      float bounds = 1.2 * pos2d.w;
      if (pos2d.z < -pos2d.w || pos2d.x < -bounds || pos2d.x > bounds
        || pos2d.y < -bounds || pos2d.y > bounds) {
        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);
        return;
      }

      uvec4 covAndColorData = texelFetch(covAndColorTexture, texPos, 0);
      vec2 cov3D_M11_M12 = unpackInt16(covAndColorData.x) * centerAndScaleData.w;
      vec2 cov3D_M13_M22 = unpackInt16(covAndColorData.y) * centerAndScaleData.w;
      vec2 cov3D_M23_M33 = unpackInt16(covAndColorData.z) * centerAndScaleData.w;
      mat3 Vrk = mat3(
        cov3D_M11_M12.x, cov3D_M11_M12.y, cov3D_M13_M22.x,
        cov3D_M11_M12.y, cov3D_M13_M22.y, cov3D_M23_M33.x,
        cov3D_M13_M22.x, cov3D_M23_M33.x, cov3D_M23_M33.y
      );

      mat3 J = mat3(
        focal / camspace.z, 0., -(focal * camspace.x) / (camspace.z * camspace.z),
        0., focal / camspace.z, -(focal * camspace.y) / (camspace.z * camspace.z),
        0., 0., 0.
      );

      mat3 W = transpose(mat3(modelViewMatrix));
      mat3 T = W * J;
      mat3 cov = transpose(T) * Vrk * T;
      vec2 vCenter = vec2(pos2d) / pos2d.w;
      float diagonal1 = cov[0][0] + 0.3;
      float offDiagonal = cov[0][1];
      float diagonal2 = cov[1][1] + 0.3;
      float mid = 0.5 * (diagonal1 + diagonal2);
      float radius = length(vec2((diagonal1 - diagonal2) / 2.0, offDiagonal));
      float lambda1 = mid + radius;
      float lambda2 = max(mid - radius, 0.1);
      vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));
      vec2 v1 = min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector;
      vec2 v2 = min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x);
      uint colorUint = covAndColorData.w;
      vColor = vec4(
        float(colorUint & uint(0xFF)) / 255.0,
        float((colorUint >> uint(8)) & uint(0xFF)) / 255.0,
        float((colorUint >> uint(16)) & uint(0xFF)) / 255.0,
        float(colorUint >> uint(24)) / 255.0
      );
      vPosition = position;

      gl_Position = vec4(
        vCenter 
          + position.x * v2 / viewport * 2.0 
          + position.y * v1 / viewport * 2.0, pos2d.z / pos2d.w, 1.0);
    }
    `,`
    #include <alphatest_pars_fragment>
    #include <alphahash_pars_fragment>
    in vec4 vColor;
    in vec3 vPosition;
    void main () {
      float A = -dot(vPosition.xy, vPosition.xy);
      if (A < -4.0) discard;
      float B = exp(A) * vColor.a;
      vec4 diffuseColor = vec4(vColor.rgb, B);
      #include <alphatest_fragment>
      #include <alphahash_fragment>
      gl_FragColor = diffuseColor;
      #include <tonemapping_fragment>
      #include <${parseInt(wl.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `);function Whe(t){let e=null,n=0;function r(i,s=!1){const o=e.length/16,a=-1e-4;let l=-1/0,c=1/0;const u=new Float32Array(o),f=new Int32Array(u.buffer),d=new Int32Array(o);let h=0;for(let x=0;x<o;x++){const _=i[0]*e[x*16+12]+i[1]*e[x*16+13]+i[2]*e[x*16+14]+i[3];(s||_<0&&e[x*16+15]>a*_)&&(u[h]=_,d[h]=x,h++,_>l&&(l=_),_<c&&(c=_))}const p=(256*256-1)/(l-c),m=new Uint32Array(256*256);for(let x=0;x<h;x++)f[x]=(u[x]-c)*p|0,m[f[x]]++;const g=new Uint32Array(256*256);for(let x=1;x<256*256;x++)g[x]=g[x-1]+m[x-1];const y=new Uint32Array(h);for(let x=0;x<h;x++)y[g[f[x]]++]=d[x];return y}t.onmessage=i=>{if(i.data.method=="push"){n===0&&(e=new Float32Array(i.data.length));const s=new Float32Array(i.data.matrices);e.set(s,n),n+=s.length}else if(i.data.method=="sort"&&e!==null){const s=r(new Float32Array(i.data.view),i.data.hashed);t.postMessage({indices:s,key:i.data.key},[s.buffer])}}}class $he extends Br{constructor(...e){super(...e),this.gl=null,this.chunkSize=25e3}load(e,n,r,i){const s={gl:this.gl,url:this.manager.resolveURL(e),worker:new Worker(URL.createObjectURL(new Blob(["(",Whe.toString(),")(self)"],{type:"application/javascript"}))),manager:this.manager,update:(o,a,l)=>Yhe(a,s,o,l),connect:o=>Khe(s,o),loading:!1,loaded:!1,loadedVertexCount:0,chunkSize:this.chunkSize,totalDownloadBytes:0,numVertices:0,rowLength:32,maxVertexes:0,bufferTextureWidth:0,bufferTextureHeight:0,stream:null,centerAndScaleData:null,covAndColorData:null,covAndColorTexture:null,centerAndScaleTexture:null,onProgress:r};Xhe(s).then(n).catch(o=>{i==null||i(o),s.manager.itemError(s.url)})}}async function Xhe(t){t.manager.itemStart(t.url);const e=await fetch(t.url);if(e.body===null)throw"Failed to fetch file";let n=e.headers.get("Content-Length");const r=n?parseInt(n):void 0;if(r==null)throw"Failed to get content length";t.stream=e.body.getReader(),t.totalDownloadBytes=r,t.numVertices=Math.floor(t.totalDownloadBytes/t.rowLength);const i=t.gl.getContext();let s=i.getParameter(i.MAX_TEXTURE_SIZE);return t.maxVertexes=s*s,t.numVertices>t.maxVertexes&&(t.numVertices=t.maxVertexes),t.bufferTextureWidth=s,t.bufferTextureHeight=Math.floor((t.numVertices-1)/s)+1,t.centerAndScaleData=new Float32Array(t.bufferTextureWidth*t.bufferTextureHeight*4),t.covAndColorData=new Uint32Array(t.bufferTextureWidth*t.bufferTextureHeight*4),t.centerAndScaleTexture=new As(t.centerAndScaleData,t.bufferTextureWidth,t.bufferTextureHeight,Pr,pr),t.centerAndScaleTexture.needsUpdate=!0,t.covAndColorTexture=new As(t.covAndColorData,t.bufferTextureWidth,t.bufferTextureHeight,hf,io),t.covAndColorTexture.internalFormat="RGBA32UI",t.covAndColorTexture.needsUpdate=!0,t}async function qhe(t){t.loading=!0;let e=0,n=0;const r=[];let i=0;const s=t.totalDownloadBytes!==0;for(;;)try{const{value:o,done:a}=await t.stream.read();if(a)break;if(e+=o.length,t.totalDownloadBytes!=null){const c=e/t.totalDownloadBytes*100;if(t.onProgress&&c-i>1){const u=new ProgressEvent("progress",{lengthComputable:s,loaded:e,total:t.totalDownloadBytes});t.onProgress(u),i=c}}r.push(o);const l=e-n;if(t.totalDownloadBytes!=null&&l>t.rowLength*t.chunkSize){let c=Math.floor(l/t.rowLength);const u=new Uint8Array(l);let f=0;for(const p of r)u.set(p,f),f+=p.length;if(r.length=0,l>c*t.rowLength){const p=new Uint8Array(l-c*t.rowLength);p.set(u.subarray(l-p.length,l),0),r.push(p)}const d=new Uint8Array(c*t.rowLength);d.set(u.subarray(0,d.byteLength),0);const h=kk(t,d.buffer,c);if(t.worker.postMessage({method:"push",src:t.url,length:t.numVertices*16,matrices:h.buffer},[h.buffer]),n+=c*t.rowLength,t.onProgress){const p=new ProgressEvent("progress",{lengthComputable:s,loaded:t.totalDownloadBytes,total:t.totalDownloadBytes});t.onProgress(p)}}}catch(o){console.error(o);break}if(e-n>0){let o=new Uint8Array(r.reduce((u,f)=>u+f.length,0)),a=0;for(const u of r)o.set(u,a),a+=u.length;let l=Math.floor(o.byteLength/t.rowLength);const c=kk(t,o.buffer,l);t.worker.postMessage({method:"push",src:t.url,length:l*16,matrices:c.buffer},[c.buffer])}t.loaded=!0,t.manager.itemEnd(t.url)}function Yhe(t,e,n,r){if(t.updateMatrixWorld(),e.gl.getCurrentViewport(n.viewport),n.material.viewport.x=n.viewport.z,n.material.viewport.y=n.viewport.w,n.material.focal=n.viewport.w/2*Math.abs(t.projectionMatrix.elements[5]),n.ready){if(r&&n.sorted)return;n.ready=!1;const i=new Float32Array([n.modelViewMatrix.elements[2],-n.modelViewMatrix.elements[6],n.modelViewMatrix.elements[10],n.modelViewMatrix.elements[14]]);e.worker.postMessage({method:"sort",src:e.url,key:n.uuid,view:i.buffer,hashed:r},[i.buffer]),r&&e.loaded&&(n.sorted=!0)}}function Khe(t,e){t.loading||qhe(t),e.ready=!1,e.pm=new et,e.vm1=new et,e.vm2=new et,e.viewport=new Hn;let n=new Uint32Array(t.bufferTextureWidth*t.bufferTextureHeight);const r=new Ya(n,1,!1);r.setUsage(Ji);const i=e.geometry=new wy,s=new Float32Array(6*3),o=new fn(s,3);i.setAttribute("position",o),o.setXYZ(2,-2,2,0),o.setXYZ(1,2,2,0),o.setXYZ(0,-2,-2,0),o.setXYZ(5,-2,-2,0),o.setXYZ(4,2,2,0),o.setXYZ(3,2,-2,0),o.needsUpdate=!0,i.setAttribute("splatIndex",r),i.instanceCount=1;function a(c){if(e&&c.data.key===e.uuid){let u=new Uint32Array(c.data.indices);i.attributes.splatIndex.set(u),i.attributes.splatIndex.needsUpdate=!0,i.instanceCount=u.length,e.ready=!0}}t.worker.addEventListener("message",a);async function l(){for(;;){const c=t.gl.properties.get(t.centerAndScaleTexture),u=t.gl.properties.get(t.covAndColorTexture);if(c!=null&&c.__webglTexture&&u!=null&&u.__webglTexture&&t.loadedVertexCount>0)break;await new Promise(f=>setTimeout(f,10))}e.ready=!0}return l(),()=>t.worker.removeEventListener("message",a)}function kk(t,e,n){const r=t.gl.getContext();if(t.loadedVertexCount+n>t.maxVertexes&&(n=t.maxVertexes-t.loadedVertexCount),n<=0)throw"Failed to parse file";const i=new Uint8Array(e),s=new Float32Array(e),o=new Float32Array(n*16),a=new Uint8Array(t.covAndColorData.buffer),l=new Int16Array(t.covAndColorData.buffer);for(let c=0;c<n;c++){const u=new bn(-(i[32*c+28+1]-128)/128,(i[32*c+28+2]-128)/128,(i[32*c+28+3]-128)/128,-(i[32*c+28+0]-128)/128);u.invert();const f=new $(s[8*c+0],s[8*c+1],-s[8*c+2]),d=new $(s[8*c+3+0],s[8*c+3+1],s[8*c+3+2]),h=new et;h.makeRotationFromQuaternion(u),h.transpose(),h.scale(d);const p=h.clone();h.transpose(),h.premultiply(p),h.setPosition(f);const m=[0,1,2,5,6,10];let g=0;for(let _=0;_<m.length;_++)Math.abs(h.elements[m[_]])>g&&(g=Math.abs(h.elements[m[_]]));let y=t.loadedVertexCount*4+c*4;t.centerAndScaleData[y+0]=f.x,t.centerAndScaleData[y+1]=-f.y,t.centerAndScaleData[y+2]=f.z,t.centerAndScaleData[y+3]=g/32767,y=t.loadedVertexCount*8+c*4*2;for(let _=0;_<m.length;_++)l[y+_]=h.elements[m[_]]*32767/g;y=t.loadedVertexCount*16+(c*4+3)*4;const x=new wt(i[32*c+24+0]/255,i[32*c+24+1]/255,i[32*c+24+2]/255);x.convertSRGBToLinear(),a[y+0]=x.r*255,a[y+1]=x.g*255,a[y+2]=x.b*255,a[y+3]=i[32*c+24+3],h.elements[15]=Math.max(d.x,d.y,d.z)*i[32*c+24+3]/255;for(let _=0;_<16;_++)o[c*16+_]=h.elements[_]}for(;n>0;){let c=0,u=0;const f=t.loadedVertexCount%t.bufferTextureWidth,d=Math.floor(t.loadedVertexCount/t.bufferTextureWidth);t.loadedVertexCount%t.bufferTextureWidth!=0?(c=Math.min(t.bufferTextureWidth,f+n)-f,u=1):Math.floor(n/t.bufferTextureWidth)>0?(c=t.bufferTextureWidth,u=Math.floor(n/t.bufferTextureWidth)):(c=n%t.bufferTextureWidth,u=1);const h=t.gl.properties.get(t.centerAndScaleTexture);r.bindTexture(r.TEXTURE_2D,h.__webglTexture),r.texSubImage2D(r.TEXTURE_2D,0,f,d,c,u,r.RGBA,r.FLOAT,t.centerAndScaleData,t.loadedVertexCount*4);const p=t.gl.properties.get(t.covAndColorTexture);r.bindTexture(r.TEXTURE_2D,p.__webglTexture),r.texSubImage2D(r.TEXTURE_2D,0,f,d,c,u,r.RGBA_INTEGER,r.UNSIGNED_INT,t.covAndColorData,t.loadedVertexCount*4),t.gl.resetState(),t.loadedVertexCount+=c*u,n-=c*u}return o}function Lk({src:t,toneMapped:e=!1,alphaTest:n=0,alphaHash:r=!1,chunkSize:i=25e3,...s}){Gi({SplatMaterial:Pk});const o=v.useRef(null),a=At(u=>u.gl),l=At(u=>u.camera),c=rs($he,t,u=>{u.gl=a,u.chunkSize=i});return v.useLayoutEffect(()=>c.connect(o.current),[t]),Yt(()=>c.update(o.current,l,r)),v.createElement("mesh",It({ref:o,frustumCulled:!1},s),v.createElement("splatMaterial",{key:`${t}/${n}/${r}${Pk.key}`,transparent:!r,depthTest:!0,alphaTest:r?0:n,centerAndScaleTexture:c.centerAndScaleTexture,covAndColorTexture:c.covAndColorTexture,depthWrite:r?!0:n>0,blending:r?ec:mb,blendSrcAlpha:gb,alphaHash:!!r,toneMapped:e}))}function Mo(t,e,n){const r=At(d=>d.size),i=At(d=>d.viewport),s=typeof t=="number"?t:r.width*i.dpr,o=typeof e=="number"?e:r.height*i.dpr,a=(typeof t=="number"?n:t)||{},{samples:l=0,depth:c,...u}=a,f=v.useMemo(()=>{const d=new fr(s,o,{minFilter:Pn,magFilter:Pn,type:ti,...u});return c&&(d.depthTexture=new Bm(s,o,pr)),d.samples=l,d},[]);return v.useLayoutEffect(()=>{f.setSize(s,o),l&&(f.samples=l)},[l,f,s,o]),v.useEffect(()=>()=>f.dispose(),[]),f}const g$e=({children:t,width:e,height:n,...r})=>{const i=Mo(e,n,r);return v.createElement(v.Fragment,null,t==null?void 0:t(i))},Zhe=t=>typeof t=="function",nE=v.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,children:r,makeDefault:i,...s},o)=>{const a=At(({set:g})=>g),l=At(({camera:g})=>g),c=At(({size:g})=>g),u=v.useRef(null);v.useImperativeHandle(o,()=>u.current,[]);const f=v.useRef(null),d=Mo(e);v.useLayoutEffect(()=>{s.manual||u.current.updateProjectionMatrix()},[c,s]),v.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),v.useLayoutEffect(()=>{if(i){const g=l;return a(()=>({camera:u.current})),()=>a(()=>({camera:g}))}},[u,i,a]);let h=0,p=null;const m=Zhe(r);return Yt(g=>{m&&(n===1/0||h<n)&&(f.current.visible=!1,g.gl.setRenderTarget(d),p=g.scene.background,t&&(g.scene.background=t),g.gl.render(g.scene,u.current),g.scene.background=p,g.gl.setRenderTarget(null),f.current.visible=!0,h++)}),v.createElement(v.Fragment,null,v.createElement("orthographicCamera",It({left:c.width/-2,right:c.width/2,top:c.height/2,bottom:c.height/-2,ref:u},s),!m&&r),v.createElement("group",{ref:f},m&&r(d.texture)))}),Qhe=t=>typeof t=="function",vj=v.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,makeDefault:r,children:i,...s},o)=>{const a=At(({set:g})=>g),l=At(({camera:g})=>g),c=At(({size:g})=>g),u=v.useRef(null);v.useImperativeHandle(o,()=>u.current,[]);const f=v.useRef(null),d=Mo(e);v.useLayoutEffect(()=>{s.manual||(u.current.aspect=c.width/c.height)},[c,s]),v.useLayoutEffect(()=>{u.current.updateProjectionMatrix()});let h=0,p=null;const m=Qhe(i);return Yt(g=>{m&&(n===1/0||h<n)&&(f.current.visible=!1,g.gl.setRenderTarget(d),p=g.scene.background,t&&(g.scene.background=t),g.gl.render(g.scene,u.current),g.scene.background=p,g.gl.setRenderTarget(null),f.current.visible=!0,h++)}),v.useLayoutEffect(()=>{if(r){const g=l;return a(()=>({camera:u.current})),()=>a(()=>({camera:g}))}},[u,r,a]),v.createElement(v.Fragment,null,v.createElement("perspectiveCamera",It({ref:u},s),!m&&i),v.createElement("group",{ref:f},m&&i(d.texture)))});function Jhe({resolution:t=256,near:e=.1,far:n=1e3,envMap:r,fog:i}={}){const s=At(({gl:d})=>d),o=At(({scene:d})=>d),a=v.useMemo(()=>{const d=new Fm(t);return d.texture.type=ti,d},[t]);v.useEffect(()=>()=>{a.dispose()},[a]);const l=v.useMemo(()=>new wb(e,n,a),[e,n,a]);let c,u;const f=v.useCallback(()=>{c=o.fog,u=o.background,o.background=r||u,o.fog=i||c,l.update(s,o),o.fog=c,o.background=u},[s,o,l]);return{fbo:a,camera:l,update:f}}function epe({children:t,frames:e=1/0,resolution:n,near:r,far:i,envMap:s,fog:o,...a}){const l=v.useRef(null),{fbo:c,camera:u,update:f}=Jhe({resolution:n,near:r,far:i,envMap:s,fog:o});let d=0;return Yt(()=>{l.current&&(e===1/0||d<e)&&(l.current.visible=!1,f(),l.current.visible=!0,d++)}),v.createElement("group",a,v.createElement("primitive",{object:u}),v.createElement("group",{ref:l},t==null?void 0:t(c.texture)))}const tpe=v.forwardRef(({makeDefault:t,camera:e,regress:n,domElement:r,enableDamping:i=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},u)=>{const f=At(S=>S.invalidate),d=At(S=>S.camera),h=At(S=>S.gl),p=At(S=>S.events),m=At(S=>S.setEvents),g=At(S=>S.set),y=At(S=>S.get),x=At(S=>S.performance),_=e||d,w=r||p.connected||h.domElement,T=v.useMemo(()=>new TG(_),[_]);return Yt(()=>{T.enabled&&T.update()},-1),v.useEffect(()=>(s&&T.connect(s===!0?w:s),T.connect(w),()=>void T.dispose()),[s,w,n,T,f]),v.useEffect(()=>{const S=R=>{f(),n&&x.regress(),o&&o(R)},C=R=>{a&&a(R)},A=R=>{l&&l(R)};return T.addEventListener("change",S),T.addEventListener("start",C),T.addEventListener("end",A),()=>{T.removeEventListener("start",C),T.removeEventListener("end",A),T.removeEventListener("change",S)}},[o,a,l,T,f,m]),v.useEffect(()=>{if(t){const S=y().controls;return g({controls:T}),()=>g({controls:S})}},[t,T]),v.createElement("primitive",It({ref:u,object:T,enableDamping:i},c))});function npe({defaultScene:t,defaultCamera:e,renderPriority:n=1}){const{gl:r,scene:i,camera:s}=At();let o;return Yt(()=>{o=r.autoClear,n===1&&(r.autoClear=!0,r.render(t,e)),r.autoClear=!1,r.clearDepth(),r.render(i,s),r.autoClear=o},n),v.createElement("group",{onPointerOver:()=>null})}function mC({children:t,renderPriority:e=1}){const{scene:n,camera:r}=At(),[i]=v.useState(()=>new ls);return v.createElement(v.Fragment,null,Al(v.createElement(v.Fragment,null,t,v.createElement(npe,{defaultScene:n,defaultCamera:r,renderPriority:e})),i,{events:{priority:e+1}}))}const xj=v.createContext({}),gC=()=>v.useContext(xj),rpe=2*Math.PI,Dk=new yn,Nk=new et,[tp,F4]=[new bn,new bn],Ok=new $,Fk=new $,ipe=t=>"minPolarAngle"in t,Uk=t=>"getTarget"in t,Bk=({alignment:t="bottom-right",margin:e=[80,80],renderPriority:n=1,onUpdate:r,onTarget:i,children:s})=>{const o=At(S=>S.size),a=At(S=>S.camera),l=At(S=>S.controls),c=At(S=>S.invalidate),u=v.useRef(null),f=v.useRef(null),d=v.useRef(!1),h=v.useRef(0),p=v.useRef(new $(0,0,0)),m=v.useRef(new $(0,0,0));v.useEffect(()=>{m.current.copy(a.up)},[a]);const g=v.useCallback(S=>{d.current=!0,(l||i)&&(p.current=(i==null?void 0:i())||(Uk(l)?l.getTarget(p.current):l==null?void 0:l.target)),h.current=a.position.distanceTo(Ok),tp.copy(a.quaternion),Fk.copy(S).multiplyScalar(h.current).add(Ok),Dk.lookAt(Fk),F4.copy(Dk.quaternion),c()},[l,a,i,c]);Yt((S,C)=>{if(f.current&&u.current){var A;if(d.current)if(tp.angleTo(F4)<.01)d.current=!1,ipe(l)&&a.up.copy(m.current);else{const R=C*rpe;tp.rotateTowards(F4,R),a.position.set(0,0,1).applyQuaternion(tp).multiplyScalar(h.current).add(p.current),a.up.set(0,1,0).applyQuaternion(tp).normalize(),a.quaternion.copy(tp),Uk(l)&&l.setPosition(a.position.x,a.position.y,a.position.z),r?r():l&&l.update(C),c()}Nk.copy(a.matrix).invert(),(A=u.current)==null||A.quaternion.setFromRotationMatrix(Nk)}});const y=v.useMemo(()=>({tweenCamera:g}),[g]),[x,_]=e,w=t.endsWith("-center")?0:t.endsWith("-left")?-o.width/2+x:o.width/2-x,T=t.startsWith("center-")?0:t.startsWith("top-")?o.height/2-_:-o.height/2+_;return v.createElement(mC,{renderPriority:n},v.createElement(xj.Provider,{value:y},v.createElement(nE,{makeDefault:!0,ref:f,position:[0,0,200]}),v.createElement("group",{ref:u,position:[w,T,0]},s)))},qg={bg:"#f0f0f0",hover:"#999",text:"black",stroke:"black"},spe=["Right","Left","Top","Bottom","Front","Back"],_j=t=>new $(...t).multiplyScalar(.38),ope=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(_j),ape=[.25,.25,.25],bj=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(_j),lpe=bj.map(t=>t.toArray().map(e=>e==0?.5:.25)),cpe=({hover:t,index:e,font:n="20px Inter var, Arial, sans-serif",faces:r=spe,color:i=qg.bg,hoverColor:s=qg.hover,textColor:o=qg.text,strokeColor:a=qg.stroke,opacity:l=1})=>{const c=At(f=>f.gl),u=v.useMemo(()=>{const f=document.createElement("canvas");f.width=128,f.height=128;const d=f.getContext("2d");return d.fillStyle=i,d.fillRect(0,0,f.width,f.height),d.strokeStyle=a,d.strokeRect(0,0,f.width,f.height),d.font=n,d.textAlign="center",d.fillStyle=o,d.fillText(r[e].toUpperCase(),64,76),new w6(f)},[e,r,n,i,o,a]);return v.createElement("meshBasicMaterial",{map:u,"map-anisotropy":c.capabilities.getMaxAnisotropy()||1,attach:`material-${e}`,color:t?s:"white",transparent:!0,opacity:l})},upe=t=>{const{tweenCamera:e}=gC(),[n,r]=v.useState(null),i=a=>{a.stopPropagation(),r(null)},s=a=>{a.stopPropagation(),e(a.face.normal)},o=a=>{a.stopPropagation(),r(Math.floor(a.faceIndex/2))};return v.createElement("mesh",{onPointerOut:i,onPointerMove:o,onClick:t.onClick||s},[...Array(6)].map((a,l)=>v.createElement(cpe,It({key:l,index:l,hover:n===l},t))),v.createElement("boxGeometry",null))},zk=({onClick:t,dimensions:e,position:n,hoverColor:r=qg.hover})=>{const{tweenCamera:i}=gC(),[s,o]=v.useState(!1),a=u=>{u.stopPropagation(),o(!1)},l=u=>{u.stopPropagation(),o(!0)},c=u=>{u.stopPropagation(),i(n)};return v.createElement("mesh",{scale:1.01,position:n,onPointerOver:l,onPointerOut:a,onClick:t||c},v.createElement("meshBasicMaterial",{color:s?r:"white",transparent:!0,opacity:.6,visible:s}),v.createElement("boxGeometry",{args:e}))},fpe=t=>v.createElement("group",{scale:[60,60,60]},v.createElement(upe,t),bj.map((e,n)=>v.createElement(zk,It({key:n,position:e,dimensions:lpe[n]},t))),ope.map((e,n)=>v.createElement(zk,It({key:n,position:e,dimensions:ape},t))));function U4({scale:t=[.8,.05,.05],color:e,rotation:n}){return v.createElement("group",{rotation:n},v.createElement("mesh",{position:[.4,0,0]},v.createElement("boxGeometry",{args:t}),v.createElement("meshBasicMaterial",{color:e,toneMapped:!1})))}function np({onClick:t,font:e,disabled:n,arcStyle:r,label:i,labelColor:s,axisHeadScale:o=1,...a}){const l=At(m=>m.gl),c=v.useMemo(()=>{const m=document.createElement("canvas");m.width=64,m.height=64;const g=m.getContext("2d");return g.beginPath(),g.arc(32,32,16,0,2*Math.PI),g.closePath(),g.fillStyle=r,g.fill(),i&&(g.font=e,g.textAlign="center",g.fillStyle=s,g.fillText(i,32,41)),new w6(m)},[r,i,s,e]),[u,f]=v.useState(!1),d=(i?1:.75)*(u?1.2:1)*o,h=m=>{m.stopPropagation(),f(!0)},p=m=>{m.stopPropagation(),f(!1)};return v.createElement("sprite",It({scale:d,onPointerOver:n?void 0:h,onPointerOut:n?void 0:t||p},a),v.createElement("spriteMaterial",{map:c,"map-anisotropy":l.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:i?1:.75,toneMapped:!1}))}const dpe=({hideNegativeAxes:t,hideAxisHeads:e,disabled:n,font:r="18px Inter var, Arial, sans-serif",axisColors:i=["#ff2060","#20df80","#2080ff"],axisHeadScale:s=1,axisScale:o,labels:a=["X","Y","Z"],labelColor:l="#000",onClick:c,...u})=>{const[f,d,h]=i,{tweenCamera:p}=gC(),m={font:r,disabled:n,labelColor:l,onClick:c,axisHeadScale:s,onPointerDown:n?void 0:g=>{p(g.object.position),g.stopPropagation()}};return v.createElement("group",It({scale:40},u),v.createElement(U4,{color:f,rotation:[0,0,0],scale:o}),v.createElement(U4,{color:d,rotation:[0,0,Math.PI/2],scale:o}),v.createElement(U4,{color:h,rotation:[0,-Math.PI/2,0],scale:o}),!e&&v.createElement(v.Fragment,null,v.createElement(np,It({arcStyle:f,position:[1,0,0],label:a[0]},m)),v.createElement(np,It({arcStyle:d,position:[0,1,0],label:a[1]},m)),v.createElement(np,It({arcStyle:h,position:[0,0,1],label:a[2]},m)),!t&&v.createElement(v.Fragment,null,v.createElement(np,It({arcStyle:f,position:[-1,0,0]},m)),v.createElement(np,It({arcStyle:d,position:[0,-1,0]},m)),v.createElement(np,It({arcStyle:h,position:[0,0,-1]},m)))))},hpe=Ml({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new wt,sectionColor:new wt,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new $,worldPlanePosition:new $},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),ppe=v.forwardRef(({args:t,cellColor:e="#000000",sectionColor:n="#2080ff",cellSize:r=.5,sectionSize:i=1,followCamera:s=!1,infiniteGrid:o=!1,fadeDistance:a=100,fadeStrength:l=1,fadeFrom:c=1,cellThickness:u=.5,sectionThickness:f=1,side:d=zi,...h},p)=>{Gi({GridMaterial:hpe});const m=v.useRef(null);v.useImperativeHandle(p,()=>m.current,[]);const g=new Oi,y=new $(0,1,0),x=new $(0,0,0);Yt(T=>{g.setFromNormalAndCoplanarPoint(y,x).applyMatrix4(m.current.matrixWorld);const S=m.current.material,C=S.uniforms.worldCamProjPosition,A=S.uniforms.worldPlanePosition;g.projectPoint(T.camera.position,C.value),A.value.set(0,0,0).applyMatrix4(m.current.matrixWorld)});const _={cellSize:r,sectionSize:i,cellColor:e,sectionColor:n,cellThickness:u,sectionThickness:f},w={fadeDistance:a,fadeStrength:l,fadeFrom:c,infiniteGrid:o,followCamera:s};return v.createElement("mesh",It({ref:m,frustumCulled:!1},h),v.createElement("gridMaterial",It({transparent:!0,"extensions-derivatives":!0,side:d},_,w)),v.createElement("planeGeometry",{args:t}))}),y3=(t,e)=>{if(Array.isArray(t))return t[0];{const n=e??Object.keys(t)[0];return t[n][0]}},mpe=t=>{for(let e=3;e<t.length;e+=4)if(t[e]!==0)return!1;return!0};function yC(t,e,n,r,i,s){const o=v.useRef(At(k=>k.viewport)),a=v.useRef(null),l=v.useRef(0),c=.1,u=v.useRef(t),f=v.useRef(e),d=v.useRef(n),[h,p]=v.useState(null),[m,g]=v.useState(new tr),y=v.useMemo(()=>new ns,[]),[x,_]=v.useState(null),w=v.useCallback((k,L,N)=>{const z=L*(o.current.aspect>k/L?o.current.width/k:o.current.height/L),K=k*(o.current.aspect>k/L?o.current.width/k:o.current.height/L)*N,V=z*N,ne=1;let re=Math.min(ne,K),P=Math.min(ne,V);return K>ne&&(re=ne,P=V/K*ne),new $(re,P,1)},[]),T=v.useCallback((k,L)=>{if(k.image){const N=document.createElement("canvas"),z=N.getContext("2d",s);if(!z)throw new Error("Failed to get 2d context");N.width=k.image.width,N.height=k.image.height,z.drawImage(k.image,0,0);const O=k.image.width,K=k.image.height,V=Math.round(Math.sqrt(L*(O/K))),ne=Math.round(L/V),re=O/V,P=K/ne,se=[];for(let ue=0;ue<ne;ue++)for(let te=0;te<V;te++){if(ue*V+te>=L){se.push({row:ue,col:te});continue}const X=z.getImageData(te*re,ue*P,re,P).data;mpe(X)&&se.push({row:ue,col:te})}return{rows:ne,columns:V,frameWidth:re,frameHeight:P,emptyFrames:se}}else return{rows:0,columns:0,frameWidth:0,frameHeight:0,emptyFrames:[]}},[s]),S=v.useCallback(k=>{const L=N=>{let z=null;for(const K of N){const{w:V,h:ne}=K.frame,re=V*ne;(!z||re>z.area)&&(z={w:V,h:ne,area:re})}return N.map(K=>{const{w:V,h:ne}=K.frame,re=V*ne,P=z?re===z.area?1:Math.sqrt(re/z.area):1;return{...K,scaleRatio:P}})};if(Array.isArray(k))return L(k);{const N={};for(const z in k)N[z]=L(k[z]);return N}},[]),C=v.useCallback(()=>{const k={},L=a.current,N=d.current;if(L)if(N&&Array.isArray(L.frames)){for(let z=0;z<N.length;z++){k[N[z]]=[];for(const O of L.frames){const K=O.frame,V=O.sourceSize.w,ne=O.sourceSize.h;typeof O.filename=="string"&&O.filename.toLowerCase().indexOf(N[z].toLowerCase())!==-1&&k[N[z]].push({...O,frame:K,sourceSize:{w:V,h:ne}})}}for(const z in k){const O=S(k[z]);Array.isArray(O)&&(k[z]=O)}return k}else if(N&&typeof L.frames=="object"){for(let z=0;z<N.length;z++){k[N[z]]=[];for(const O in L.frames){const K=L.frames[O],V=K.frame,ne=K.sourceSize.w,re=K.sourceSize.h;typeof O=="string"&&O.toLowerCase().indexOf(N[z].toLowerCase())!==-1&&k[N[z]].push({...K,frame:V,sourceSize:{w:ne,h:re}})}}for(const z in k){const O=S(k[z]);Array.isArray(O)&&(k[z]=O)}return k}else{let z=[];return L!=null&&L.frames&&(Array.isArray(L.frames)?z=L.frames.map(O=>({...O,x:O.frame.x,y:O.frame.y,w:O.frame.w,h:O.frame.h})):z=Object.values(L.frames).flat().map(O=>({...O,x:O.frame.x,y:O.frame.y,w:O.frame.w,h:O.frame.h}))),S(z)}return[]},[S,a]),A=v.useCallback((k,L)=>{let N=new $(1,1,1);if(k===null){if(L&&r){const z=L.image.width,O=L.image.height;l.current=r;const{rows:K,columns:V,frameWidth:ne,frameHeight:re,emptyFrames:P}=T(L,r),se={frames:[],meta:{version:"1.0",size:{w:z,h:O},rows:K,columns:V,frameWidth:ne,frameHeight:re,scale:"1"}};for(let ue=0;ue<K;ue++)for(let te=0;te<V;te++)(P??[]).some(X=>X.row===ue&&X.col===te)||Array.isArray(se.frames)&&se.frames.push({frame:{x:te*ne,y:ue*re,w:ne,h:re},scaleRatio:1,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:ne,h:re},sourceSize:{w:ne,h:re}});N=w(ne,re,c),a.current=se}a.current&&a.current.frames&&(a.current.frames=S(a.current.frames))}else if(L){a.current=k,a.current.frames=C(),l.current=Array.isArray(k.frames)?k.frames.length:Object.keys(k.frames).length;const{w:z,h:O}=y3(k.frames).sourceSize;N=w(z,O,c)}p(a.current),"encoding"in L?L.encoding=3001:"colorSpace"in L&&(L.colorSpace=Er),g(L),_({spriteTexture:L,spriteData:a.current,aspect:N})},[T,r,C,w,S]),R=v.useCallback((k,L,N)=>{const z=fetch(k).then(K=>K.json()),O=new Promise(K=>{y.load(L,K)});Promise.all([z,O]).then(K=>{N(K[0],K[1])})},[y]),M=v.useCallback(k=>{if(!k&&!u.current)throw new Error("Either textureUrl or input must be provided");const L=k??u.current;if(!L)throw new Error("A valid texture URL must be provided");y.load(L,N=>A(null,N))},[y,A]),D=v.useCallback((k,L)=>{L&&k?R(L,k,A):M(k)},[R,M,A]);return v.useLayoutEffect(()=>{f.current&&u.current?R(f.current,u.current,A):u.current&&M();const k=u.current;return()=>{k&&rs.clear(ns,k)}},[R,M,A]),v.useLayoutEffect(()=>{i==null||i(m,h??null)},[m,h,i]),{spriteObj:x,loadJsonAndTexture:D}}yC.preload=t=>rs.preload(ns,t);yC.clear=t=>rs.clear(ns,t);function fh(t,e,...n){const r=v.useRef(),i=At(s=>s.scene);return v.useLayoutEffect(()=>{let s;if(t&&t!=null&&t.current&&e&&(r.current=s=new e(t.current,...n)),s)return s.traverse(o=>o.raycast=()=>null),i.add(s),()=>{r.current=void 0,i.remove(s),s.dispose==null||s.dispose()}},[i,e,t,...n]),Yt(()=>{var s;return void((s=r.current)==null||s.update==null?void 0:s.update())}),r}const y$e=({type:t,args:e=[]})=>{const n=v.useRef(null),r=v.useRef(null);return v.useLayoutEffect(()=>{r.current=n.current.parent}),fh(r,t,...e),v.createElement("object3D",{ref:n})},Ej=0,gpe=1,rE=2,Hk=2,B4=1.25,Gk=1,af=6*4+4+4,iE=65535,ype=Math.pow(2,-24),z4=Symbol("SKIP_GENERATION");function wj(t){return t.index?t.index.count:t.attributes.position.count}function Xm(t){return wj(t)/3}function Sj(t,e=ArrayBuffer){return t>65535?new Uint32Array(new e(4*t)):new Uint16Array(new e(2*t))}function vpe(t,e){if(!t.index){const n=t.attributes.position.count,r=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=Sj(n,r);t.setIndex(new fn(i,1));for(let s=0;s<n;s++)i[s]=s}}function Tj(t,e){const n=Xm(t),r=e||t.drawRange,i=r.start/3,s=(r.start+r.count)/3,o=Math.max(0,i),a=Math.min(n,s)-o;return[{offset:Math.floor(o),count:Math.floor(a)}]}function Aj(t,e){if(!t.groups||!t.groups.length)return Tj(t,e);const n=[],r=new Set,i=e||t.drawRange,s=i.start/3,o=(i.start+i.count)/3;for(const l of t.groups){const c=l.start/3,u=(l.start+l.count)/3;r.add(Math.max(s,c)),r.add(Math.min(o,u))}const a=Array.from(r.values()).sort((l,c)=>l-c);for(let l=0;l<a.length-1;l++){const c=a[l],u=a[l+1];n.push({offset:Math.floor(c),count:Math.floor(u-c)})}return n}function xpe(t,e){const n=Xm(t),r=Aj(t,e).sort((o,a)=>o.offset-a.offset),i=r[r.length-1];i.count=Math.min(n-i.offset,i.count);let s=0;return r.forEach(({count:o})=>s+=o),n!==s}function H4(t,e,n,r,i){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,u=-1/0,f=1/0,d=1/0,h=1/0,p=-1/0,m=-1/0,g=-1/0;for(let y=e*6,x=(e+n)*6;y<x;y+=6){const _=t[y+0],w=t[y+1],T=_-w,S=_+w;T<s&&(s=T),S>l&&(l=S),_<f&&(f=_),_>p&&(p=_);const C=t[y+2],A=t[y+3],R=C-A,M=C+A;R<o&&(o=R),M>c&&(c=M),C<d&&(d=C),C>m&&(m=C);const D=t[y+4],k=t[y+5],L=D-k,N=D+k;L<a&&(a=L),N>u&&(u=N),D<h&&(h=D),D>g&&(g=D)}r[0]=s,r[1]=o,r[2]=a,r[3]=l,r[4]=c,r[5]=u,i[0]=f,i[1]=d,i[2]=h,i[3]=p,i[4]=m,i[5]=g}function _pe(t,e=null,n=null,r=null){const i=t.attributes.position,s=t.index?t.index.array:null,o=Xm(t),a=i.normalized;let l;e===null?(l=new Float32Array(o*6*4),n=0,r=o):(l=e,n=n||0,r=r||o);const c=i.array,u=i.offset||0;let f=3;i.isInterleavedBufferAttribute&&(f=i.data.stride);const d=["getX","getY","getZ"];for(let h=n;h<n+r;h++){const p=h*3,m=h*6;let g=p+0,y=p+1,x=p+2;s&&(g=s[g],y=s[y],x=s[x]),a||(g=g*f+u,y=y*f+u,x=x*f+u);for(let _=0;_<3;_++){let w,T,S;a?(w=i[d[_]](g),T=i[d[_]](y),S=i[d[_]](x)):(w=c[g+_],T=c[y+_],S=c[x+_]);let C=w;T<C&&(C=T),S<C&&(C=S);let A=w;T>A&&(A=T),S>A&&(A=S);const R=(A-C)/2,M=_*2;l[m+M+0]=C+R,l[m+M+1]=R+(Math.abs(C)+R)*ype}}return l}function Mi(t,e,n){return n.min.x=e[t],n.min.y=e[t+1],n.min.z=e[t+2],n.max.x=e[t+3],n.max.y=e[t+4],n.max.z=e[t+5],n}function jk(t){let e=-1,n=-1/0;for(let r=0;r<3;r++){const i=t[r+3]-t[r];i>n&&(n=i,e=r)}return e}function Vk(t,e){e.set(t)}function Wk(t,e,n){let r,i;for(let s=0;s<3;s++){const o=s+3;r=t[s],i=e[s],n[s]=r<i?r:i,r=t[o],i=e[o],n[o]=r>i?r:i}}function X2(t,e,n){for(let r=0;r<3;r++){const i=e[t+2*r],s=e[t+2*r+1],o=i-s,a=i+s;o<n[r]&&(n[r]=o),a>n[r+3]&&(n[r+3]=a)}}function rg(t){const e=t[3]-t[0],n=t[4]-t[1],r=t[5]-t[2];return 2*(e*n+n*r+r*e)}const kc=32,bpe=(t,e)=>t.candidate-e.candidate,Uu=new Array(kc).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),q2=new Float32Array(6);function Epe(t,e,n,r,i,s){let o=-1,a=0;if(s===Ej)o=jk(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(s===gpe)o=jk(t),o!==-1&&(a=wpe(n,r,i,o));else if(s===rE){const l=rg(t);let c=B4*i;const u=r*6,f=(r+i)*6;for(let d=0;d<3;d++){const h=e[d],g=(e[d+3]-h)/kc;if(i<kc/4){const y=[...Uu];y.length=i;let x=0;for(let w=u;w<f;w+=6,x++){const T=y[x];T.candidate=n[w+2*d],T.count=0;const{bounds:S,leftCacheBounds:C,rightCacheBounds:A}=T;for(let R=0;R<3;R++)A[R]=1/0,A[R+3]=-1/0,C[R]=1/0,C[R+3]=-1/0,S[R]=1/0,S[R+3]=-1/0;X2(w,n,S)}y.sort(bpe);let _=i;for(let w=0;w<_;w++){const T=y[w];for(;w+1<_&&y[w+1].candidate===T.candidate;)y.splice(w+1,1),_--}for(let w=u;w<f;w+=6){const T=n[w+2*d];for(let S=0;S<_;S++){const C=y[S];T>=C.candidate?X2(w,n,C.rightCacheBounds):(X2(w,n,C.leftCacheBounds),C.count++)}}for(let w=0;w<_;w++){const T=y[w],S=T.count,C=i-T.count,A=T.leftCacheBounds,R=T.rightCacheBounds;let M=0;S!==0&&(M=rg(A)/l);let D=0;C!==0&&(D=rg(R)/l);const k=Gk+B4*(M*S+D*C);k<c&&(o=d,c=k,a=T.candidate)}}else{for(let _=0;_<kc;_++){const w=Uu[_];w.count=0,w.candidate=h+g+_*g;const T=w.bounds;for(let S=0;S<3;S++)T[S]=1/0,T[S+3]=-1/0}for(let _=u;_<f;_+=6){let S=~~((n[_+2*d]-h)/g);S>=kc&&(S=kc-1);const C=Uu[S];C.count++,X2(_,n,C.bounds)}const y=Uu[kc-1];Vk(y.bounds,y.rightCacheBounds);for(let _=kc-2;_>=0;_--){const w=Uu[_],T=Uu[_+1];Wk(w.bounds,T.rightCacheBounds,w.rightCacheBounds)}let x=0;for(let _=0;_<kc-1;_++){const w=Uu[_],T=w.count,S=w.bounds,A=Uu[_+1].rightCacheBounds;T!==0&&(x===0?Vk(S,q2):Wk(S,q2,q2)),x+=T;let R=0,M=0;x!==0&&(R=rg(q2)/l);const D=i-x;D!==0&&(M=rg(A)/l);const k=Gk+B4*(R*x+M*D);k<c&&(o=d,c=k,a=w.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function wpe(t,e,n,r){let i=0;for(let s=e,o=e+n;s<o;s++)i+=t[s*6+r*2];return i/n}class G4{constructor(){this.boundingData=new Float32Array(6)}}function Spe(t,e,n,r,i,s){let o=r,a=r+i-1;const l=s.pos,c=s.axis*2;for(;;){for(;o<=a&&n[o*6+c]<l;)o++;for(;o<=a&&n[a*6+c]>=l;)a--;if(o<a){for(let u=0;u<3;u++){let f=e[o*3+u];e[o*3+u]=e[a*3+u],e[a*3+u]=f}for(let u=0;u<6;u++){let f=n[o*6+u];n[o*6+u]=n[a*6+u],n[a*6+u]=f}o++,a--}else return o}}function Tpe(t,e,n,r,i,s){let o=r,a=r+i-1;const l=s.pos,c=s.axis*2;for(;;){for(;o<=a&&n[o*6+c]<l;)o++;for(;o<=a&&n[a*6+c]>=l;)a--;if(o<a){let u=t[o];t[o]=t[a],t[a]=u;for(let f=0;f<6;f++){let d=n[o*6+f];n[o*6+f]=n[a*6+f],n[a*6+f]=d}o++,a--}else return o}}function So(t,e){return e[t+15]===65535}function jo(t,e){return e[t+6]}function ua(t,e){return e[t+14]}function Ga(t){return t+8}function fa(t,e){return e[t+6]}function vC(t,e){return e[t+7]}let Mj,Yg,v3,Cj;const Ape=Math.pow(2,32);function E5(t){return"count"in t?1:1+E5(t.left)+E5(t.right)}function Mpe(t,e,n){return Mj=new Float32Array(n),Yg=new Uint32Array(n),v3=new Uint16Array(n),Cj=new Uint8Array(n),w5(t,e)}function w5(t,e){const n=t/4,r=t/2,i="count"in e,s=e.boundingData;for(let o=0;o<6;o++)Mj[n+o]=s[o];if(i)if(e.buffer){const o=e.buffer;Cj.set(new Uint8Array(o),t);for(let a=t,l=t+o.byteLength;a<l;a+=af){const c=a/2;So(c,v3)||(Yg[a/4+6]+=n)}return t+o.byteLength}else{const o=e.offset,a=e.count;return Yg[n+6]=o,v3[r+14]=a,v3[r+15]=iE,t+af}else{const o=e.left,a=e.right,l=e.splitAxis;let c;if(c=w5(t+af,o),c/4>Ape)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return Yg[n+6]=c/4,c=w5(c,a),Yg[n+7]=l,c}}function Cpe(t,e){const n=(t.index?t.index.count:t.attributes.position.count)/3,r=n>2**16,i=r?4:2,s=e?new SharedArrayBuffer(n*i):new ArrayBuffer(n*i),o=r?new Uint32Array(s):new Uint16Array(s);for(let a=0,l=o.length;a<l;a++)o[a]=a;return o}function Rpe(t,e,n,r,i){const{maxDepth:s,verbose:o,maxLeafTris:a,strategy:l,onProgress:c,indirect:u}=i,f=t._indirectBuffer,d=t.geometry,h=d.index?d.index.array:null,p=u?Tpe:Spe,m=Xm(d),g=new Float32Array(6);let y=!1;const x=new G4;return H4(e,n,r,x.boundingData,g),w(x,n,r,g),x;function _(T){c&&c(T/m)}function w(T,S,C,A=null,R=0){if(!y&&R>=s&&(y=!0,o&&(console.warn(`MeshBVH: Max depth of ${s} reached when generating BVH. Consider increasing maxDepth.`),console.warn(d))),C<=a||R>=s)return _(S+C),T.offset=S,T.count=C,T;const M=Epe(T.boundingData,A,e,S,C,l);if(M.axis===-1)return _(S+C),T.offset=S,T.count=C,T;const D=p(f,h,e,S,C,M);if(D===S||D===S+C)_(S+C),T.offset=S,T.count=C;else{T.splitAxis=M.axis;const k=new G4,L=S,N=D-S;T.left=k,H4(e,L,N,k.boundingData,g),w(k,L,N,g,R+1);const z=new G4,O=D,K=C-N;T.right=z,H4(e,O,K,z.boundingData,g),w(z,O,K,g,R+1)}return T}}function Ipe(t,e){const n=t.geometry;e.indirect&&(t._indirectBuffer=Cpe(n,e.useSharedArrayBuffer),xpe(n,e.range)&&!e.verbose&&console.warn('MeshBVH: Provided geometry contains groups or a range that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),t._indirectBuffer||vpe(n,e);const r=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=_pe(n),s=e.indirect?Tj(n,e.range):Aj(n,e.range);t._roots=s.map(o=>{const a=Rpe(t,i,o.offset,o.count,e),l=E5(a),c=new r(af*l);return Mpe(0,a,c),c})}class su{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,n){let r=1/0,i=-1/0;for(let s=0,o=e.length;s<o;s++){const l=e[s][n];r=l<r?l:r,i=l>i?l:i}this.min=r,this.max=i}setFromPoints(e,n){let r=1/0,i=-1/0;for(let s=0,o=n.length;s<o;s++){const a=n[s],l=e.dot(a);r=l<r?l:r,i=l>i?l:i}this.min=r,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}}su.prototype.setFromBox=function(){const t=new $;return function(n,r){const i=r.min,s=r.max;let o=1/0,a=-1/0;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){t.x=i.x*l+s.x*(1-l),t.y=i.y*c+s.y*(1-c),t.z=i.z*u+s.z*(1-u);const f=n.dot(t);o=Math.min(f,o),a=Math.max(f,a)}this.min=o,this.max=a}}();const Ppe=function(){const t=new $,e=new $,n=new $;return function(i,s,o){const a=i.start,l=t,c=s.start,u=e;n.subVectors(a,c),t.subVectors(i.end,i.start),e.subVectors(s.end,s.start);const f=n.dot(u),d=u.dot(l),h=u.dot(u),p=n.dot(l),g=l.dot(l)*h-d*d;let y,x;g!==0?y=(f*d-p*h)/g:y=0,x=(f+y*d)/h,o.x=y,o.y=x}}(),xC=function(){const t=new Ke,e=new $,n=new $;return function(i,s,o,a){Ppe(i,s,t);let l=t.x,c=t.y;if(l>=0&&l<=1&&c>=0&&c<=1){i.at(l,o),s.at(c,a);return}else if(l>=0&&l<=1){c<0?s.at(0,a):s.at(1,a),i.closestPointToPoint(a,!0,o);return}else if(c>=0&&c<=1){l<0?i.at(0,o):i.at(1,o),s.closestPointToPoint(o,!0,a);return}else{let u;l<0?u=i.start:u=i.end;let f;c<0?f=s.start:f=s.end;const d=e,h=n;if(i.closestPointToPoint(f,!0,e),s.closestPointToPoint(u,!0,n),d.distanceToSquared(f)<=h.distanceToSquared(u)){o.copy(d),a.copy(f);return}else{o.copy(u),a.copy(h);return}}}}(),kpe=function(){const t=new $,e=new $,n=new Oi,r=new qa;return function(s,o){const{radius:a,center:l}=s,{a:c,b:u,c:f}=o;if(r.start=c,r.end=u,r.closestPointToPoint(l,!0,t).distanceTo(l)<=a||(r.start=c,r.end=f,r.closestPointToPoint(l,!0,t).distanceTo(l)<=a)||(r.start=u,r.end=f,r.closestPointToPoint(l,!0,t).distanceTo(l)<=a))return!0;const m=o.getPlane(n);if(Math.abs(m.distanceToPoint(l))<=a){const y=m.projectPoint(l,e);if(o.containsPoint(y))return!0}return!1}}(),Lpe=1e-15;function j4(t){return Math.abs(t)<Lpe}class xl extends Ci{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new $),this.satBounds=new Array(4).fill().map(()=>new su),this.points=[this.a,this.b,this.c],this.sphere=new wr,this.plane=new Oi,this.needsUpdate=!0}intersectsSphere(e){return kpe(e,this)}update(){const e=this.a,n=this.b,r=this.c,i=this.points,s=this.satAxes,o=this.satBounds,a=s[0],l=o[0];this.getNormal(a),l.setFromPoints(a,i);const c=s[1],u=o[1];c.subVectors(e,n),u.setFromPoints(c,i);const f=s[2],d=o[2];f.subVectors(n,r),d.setFromPoints(f,i);const h=s[3],p=o[3];h.subVectors(r,e),p.setFromPoints(h,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}}xl.prototype.closestPointToSegment=function(){const t=new $,e=new $,n=new qa;return function(i,s=null,o=null){const{start:a,end:l}=i,c=this.points;let u,f=1/0;for(let d=0;d<3;d++){const h=(d+1)%3;n.start.copy(c[d]),n.end.copy(c[h]),xC(n,i,t,e),u=t.distanceToSquared(e),u<f&&(f=u,s&&s.copy(t),o&&o.copy(e))}return this.closestPointToPoint(a,t),u=a.distanceToSquared(t),u<f&&(f=u,s&&s.copy(t),o&&o.copy(a)),this.closestPointToPoint(l,t),u=l.distanceToSquared(t),u<f&&(f=u,s&&s.copy(t),o&&o.copy(l)),Math.sqrt(f)}}();xl.prototype.intersectsTriangle=function(){const t=new xl,e=new Array(3),n=new Array(3),r=new su,i=new su,s=new $,o=new $,a=new $,l=new $,c=new $,u=new qa,f=new qa,d=new qa,h=new $;function p(m,g,y){const x=m.points;let _=0,w=-1;for(let T=0;T<3;T++){const{start:S,end:C}=u;S.copy(x[T]),C.copy(x[(T+1)%3]),u.delta(o);const A=j4(g.distanceToPoint(S));if(j4(g.normal.dot(o))&&A){y.copy(u),_=2;break}const R=g.intersectLine(u,h);if(!R&&A&&h.copy(S),(R||A)&&!j4(h.distanceTo(C))){if(_<=1)(_===1?y.start:y.end).copy(h),A&&(w=_);else if(_>=2){(w===1?y.start:y.end).copy(h),_=2;break}if(_++,_===2&&w===-1)break}}return _}return function(g,y=null,x=!1){this.needsUpdate&&this.update(),g.isExtendedTriangle?g.needsUpdate&&g.update():(t.copy(g),t.update(),g=t);const _=this.plane,w=g.plane;if(Math.abs(_.normal.dot(w.normal))>1-1e-10){const T=this.satBounds,S=this.satAxes;n[0]=g.a,n[1]=g.b,n[2]=g.c;for(let R=0;R<4;R++){const M=T[R],D=S[R];if(r.setFromPoints(D,n),M.isSeparated(r))return!1}const C=g.satBounds,A=g.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let R=0;R<4;R++){const M=C[R],D=A[R];if(r.setFromPoints(D,e),M.isSeparated(r))return!1}for(let R=0;R<4;R++){const M=S[R];for(let D=0;D<4;D++){const k=A[D];if(s.crossVectors(M,k),r.setFromPoints(s,e),i.setFromPoints(s,n),r.isSeparated(i))return!1}}return y&&(x||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),y.start.set(0,0,0),y.end.set(0,0,0)),!0}else{const T=p(this,w,f);if(T===1&&g.containsPoint(f.end))return y&&(y.start.copy(f.end),y.end.copy(f.end)),!0;if(T!==2)return!1;const S=p(g,_,d);if(S===1&&this.containsPoint(d.end))return y&&(y.start.copy(d.end),y.end.copy(d.end)),!0;if(S!==2)return!1;if(f.delta(a),d.delta(l),a.dot(l)<0){let L=d.start;d.start=d.end,d.end=L}const C=f.start.dot(a),A=f.end.dot(a),R=d.start.dot(a),M=d.end.dot(a),D=A<R,k=C<M;return C!==M&&R!==A&&D===k?!1:(y&&(c.subVectors(f.start,d.start),c.dot(a)>0?y.start.copy(f.start):y.start.copy(d.start),c.subVectors(f.end,d.end),c.dot(a)<0?y.end.copy(f.end):y.end.copy(d.end)),!0)}}}();xl.prototype.distanceToPoint=function(){const t=new $;return function(n){return this.closestPointToPoint(n,t),n.distanceTo(t)}}();xl.prototype.distanceToTriangle=function(){const t=new $,e=new $,n=["a","b","c"],r=new qa,i=new qa;return function(o,a=null,l=null){const c=a||l?r:null;if(this.intersectsTriangle(o,c))return(a||l)&&(a&&c.getCenter(a),l&&c.getCenter(l)),0;let u=1/0;for(let f=0;f<3;f++){let d;const h=n[f],p=o[h];this.closestPointToPoint(p,t),d=p.distanceToSquared(t),d<u&&(u=d,a&&a.copy(t),l&&l.copy(p));const m=this[h];o.closestPointToPoint(m,t),d=m.distanceToSquared(t),d<u&&(u=d,a&&a.copy(m),l&&l.copy(t))}for(let f=0;f<3;f++){const d=n[f],h=n[(f+1)%3];r.set(this[d],this[h]);for(let p=0;p<3;p++){const m=n[p],g=n[(p+1)%3];i.set(o[m],o[g]),xC(r,i,t,e);const y=t.distanceToSquared(e);y<u&&(u=y,a&&a.copy(t),l&&l.copy(e))}}return Math.sqrt(u)}}();class Io{constructor(e,n,r){this.isOrientedBox=!0,this.min=new $,this.max=new $,this.matrix=new et,this.invMatrix=new et,this.points=new Array(8).fill().map(()=>new $),this.satAxes=new Array(3).fill().map(()=>new $),this.satBounds=new Array(3).fill().map(()=>new su),this.alignedSatBounds=new Array(3).fill().map(()=>new su),this.needsUpdate=!1,e&&this.min.copy(e),n&&this.max.copy(n),r&&this.matrix.copy(r)}set(e,n,r){this.min.copy(e),this.max.copy(n),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}Io.prototype.update=function(){return function(){const e=this.matrix,n=this.min,r=this.max,i=this.points;for(let c=0;c<=1;c++)for(let u=0;u<=1;u++)for(let f=0;f<=1;f++){const d=1*c|2*u|4*f,h=i[d];h.x=c?r.x:n.x,h.y=u?r.y:n.y,h.z=f?r.z:n.z,h.applyMatrix4(e)}const s=this.satBounds,o=this.satAxes,a=i[0];for(let c=0;c<3;c++){const u=o[c],f=s[c],d=1<<c,h=i[d];u.subVectors(a,h),f.setFromPoints(u,i)}const l=this.alignedSatBounds;l[0].setFromPointsField(i,"x"),l[1].setFromPointsField(i,"y"),l[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Io.prototype.intersectsBox=function(){const t=new su;return function(n){this.needsUpdate&&this.update();const r=n.min,i=n.max,s=this.satBounds,o=this.satAxes,a=this.alignedSatBounds;if(t.min=r.x,t.max=i.x,a[0].isSeparated(t)||(t.min=r.y,t.max=i.y,a[1].isSeparated(t))||(t.min=r.z,t.max=i.z,a[2].isSeparated(t)))return!1;for(let l=0;l<3;l++){const c=o[l],u=s[l];if(t.setFromBox(c,n),u.isSeparated(t))return!1}return!0}}();Io.prototype.intersectsTriangle=function(){const t=new xl,e=new Array(3),n=new su,r=new su,i=new $;return function(o){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(t.copy(o),t.update(),o=t);const a=this.satBounds,l=this.satAxes;e[0]=o.a,e[1]=o.b,e[2]=o.c;for(let d=0;d<3;d++){const h=a[d],p=l[d];if(n.setFromPoints(p,e),h.isSeparated(n))return!1}const c=o.satBounds,u=o.satAxes,f=this.points;for(let d=0;d<3;d++){const h=c[d],p=u[d];if(n.setFromPoints(p,f),h.isSeparated(n))return!1}for(let d=0;d<3;d++){const h=l[d];for(let p=0;p<4;p++){const m=u[p];if(i.crossVectors(h,m),n.setFromPoints(i,e),r.setFromPoints(i,f),n.isSeparated(r))return!1}}return!0}}();Io.prototype.closestPointToPoint=function(){return function(e,n){return this.needsUpdate&&this.update(),n.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),n}}();Io.prototype.distanceToPoint=function(){const t=new $;return function(n){return this.closestPointToPoint(n,t),n.distanceTo(t)}}();Io.prototype.distanceToBox=function(){const t=["x","y","z"],e=new Array(12).fill().map(()=>new qa),n=new Array(12).fill().map(()=>new qa),r=new $,i=new $;return function(o,a=0,l=null,c=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(l||c)&&(o.getCenter(i),this.closestPointToPoint(i,r),o.closestPointToPoint(r,i),l&&l.copy(r),c&&c.copy(i)),0;const u=a*a,f=o.min,d=o.max,h=this.points;let p=1/0;for(let g=0;g<8;g++){const y=h[g];i.copy(y).clamp(f,d);const x=y.distanceToSquared(i);if(x<p&&(p=x,l&&l.copy(y),c&&c.copy(i),x<u))return Math.sqrt(x)}let m=0;for(let g=0;g<3;g++)for(let y=0;y<=1;y++)for(let x=0;x<=1;x++){const _=(g+1)%3,w=(g+2)%3,T=y<<_|x<<w,S=1<<g|y<<_|x<<w,C=h[T],A=h[S];e[m].set(C,A);const M=t[g],D=t[_],k=t[w],L=n[m],N=L.start,z=L.end;N[M]=f[M],N[D]=y?f[D]:d[D],N[k]=x?f[k]:d[D],z[M]=d[M],z[D]=y?f[D]:d[D],z[k]=x?f[k]:d[D],m++}for(let g=0;g<=1;g++)for(let y=0;y<=1;y++)for(let x=0;x<=1;x++){i.x=g?d.x:f.x,i.y=y?d.y:f.y,i.z=x?d.z:f.z,this.closestPointToPoint(i,r);const _=i.distanceToSquared(r);if(_<p&&(p=_,l&&l.copy(r),c&&c.copy(i),_<u))return Math.sqrt(_)}for(let g=0;g<12;g++){const y=e[g];for(let x=0;x<12;x++){const _=n[x];xC(y,_,r,i);const w=r.distanceToSquared(i);if(w<p&&(p=w,l&&l.copy(r),c&&c.copy(i),w<u))return Math.sqrt(w)}}return Math.sqrt(p)}}();class _C{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}class Dpe extends _C{constructor(){super(()=>new xl)}}const ja=new Dpe;class Npe{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const e=[];let n=null;this.setBuffer=r=>{n&&e.push(n),n=r,this.float32Array=new Float32Array(r),this.uint16Array=new Uint16Array(r),this.uint32Array=new Uint32Array(r)},this.clearBuffer=()=>{n=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,e.length!==0&&this.setBuffer(e.pop())}}}const ai=new Npe;let Ju,Xp;const rp=[],Y2=new _C(()=>new Kn);function Ope(t,e,n,r,i,s){Ju=Y2.getPrimitive(),Xp=Y2.getPrimitive(),rp.push(Ju,Xp),ai.setBuffer(t._roots[e]);const o=S5(0,t.geometry,n,r,i,s);ai.clearBuffer(),Y2.releasePrimitive(Ju),Y2.releasePrimitive(Xp),rp.pop(),rp.pop();const a=rp.length;return a>0&&(Xp=rp[a-1],Ju=rp[a-2]),o}function S5(t,e,n,r,i=null,s=0,o=0){const{float32Array:a,uint16Array:l,uint32Array:c}=ai;let u=t*2;if(So(u,l)){const d=jo(t,c),h=ua(u,l);return Mi(t,a,Ju),r(d,h,!1,o,s+t,Ju)}else{let M=function(k){const{uint16Array:L,uint32Array:N}=ai;let z=k*2;for(;!So(z,L);)k=Ga(k),z=k*2;return jo(k,N)},D=function(k){const{uint16Array:L,uint32Array:N}=ai;let z=k*2;for(;!So(z,L);)k=fa(k,N),z=k*2;return jo(k,N)+ua(z,L)};const d=Ga(t),h=fa(t,c);let p=d,m=h,g,y,x,_;if(i&&(x=Ju,_=Xp,Mi(p,a,x),Mi(m,a,_),g=i(x),y=i(_),y<g)){p=h,m=d;const k=g;g=y,y=k,x=_}x||(x=Ju,Mi(p,a,x));const w=So(p*2,l),T=n(x,w,g,o+1,s+p);let S;if(T===Hk){const k=M(p),N=D(p)-k;S=r(k,N,!0,o+1,s+p,x)}else S=T&&S5(p,e,n,r,i,s,o+1);if(S)return!0;_=Xp,Mi(m,a,_);const C=So(m*2,l),A=n(_,C,y,o+1,s+m);let R;if(A===Hk){const k=M(m),N=D(m)-k;R=r(k,N,!0,o+1,s+m,_)}else R=A&&S5(m,e,n,r,i,s,o+1);return!!R}}const ig=new $,V4=new $;function Fpe(t,e,n={},r=0,i=1/0){const s=r*r,o=i*i;let a=1/0,l=null;if(t.shapecast({boundsTraverseOrder:u=>(ig.copy(e).clamp(u.min,u.max),ig.distanceToSquared(e)),intersectsBounds:(u,f,d)=>d<a&&d<o,intersectsTriangle:(u,f)=>{u.closestPointToPoint(e,ig);const d=e.distanceToSquared(ig);return d<a&&(V4.copy(ig),a=d,l=f),d<s}}),a===1/0)return null;const c=Math.sqrt(a);return n.point?n.point.copy(V4):n.point=V4.clone(),n.distance=c,n.faceIndex=l,n}const ip=new $,sp=new $,op=new $,K2=new Ke,Z2=new Ke,Q2=new Ke,$k=new $,Xk=new $,qk=new $,J2=new $;function Upe(t,e,n,r,i,s,o,a){let l;if(s===zi?l=t.intersectTriangle(r,n,e,!0,i):l=t.intersectTriangle(e,n,r,s!==Nr,i),l===null)return null;const c=t.origin.distanceTo(i);return c<o||c>a?null:{distance:c,point:i.clone()}}function Bpe(t,e,n,r,i,s,o,a,l,c,u){ip.fromBufferAttribute(e,s),sp.fromBufferAttribute(e,o),op.fromBufferAttribute(e,a);const f=Upe(t,ip,sp,op,J2,l,c,u);if(f){r&&(K2.fromBufferAttribute(r,s),Z2.fromBufferAttribute(r,o),Q2.fromBufferAttribute(r,a),f.uv=Ci.getInterpolation(J2,ip,sp,op,K2,Z2,Q2,new Ke)),i&&(K2.fromBufferAttribute(i,s),Z2.fromBufferAttribute(i,o),Q2.fromBufferAttribute(i,a),f.uv1=Ci.getInterpolation(J2,ip,sp,op,K2,Z2,Q2,new Ke)),n&&($k.fromBufferAttribute(n,s),Xk.fromBufferAttribute(n,o),qk.fromBufferAttribute(n,a),f.normal=Ci.getInterpolation(J2,ip,sp,op,$k,Xk,qk,new $),f.normal.dot(t.direction)>0&&f.normal.multiplyScalar(-1));const d={a:s,b:o,c:a,normal:new $,materialIndex:0};Ci.getNormal(ip,sp,op,d.normal),f.face=d,f.faceIndex=s}return f}function sE(t,e,n,r,i,s,o){const a=r*3;let l=a+0,c=a+1,u=a+2;const f=t.index;t.index&&(l=f.getX(l),c=f.getX(c),u=f.getX(u));const{position:d,normal:h,uv:p,uv1:m}=t.attributes,g=Bpe(n,d,h,p,m,l,c,u,e,s,o);return g?(g.faceIndex=r,i&&i.push(g),g):null}function ts(t,e,n,r){const i=t.a,s=t.b,o=t.c;let a=e,l=e+1,c=e+2;n&&(a=n.getX(a),l=n.getX(l),c=n.getX(c)),i.x=r.getX(a),i.y=r.getY(a),i.z=r.getZ(a),s.x=r.getX(l),s.y=r.getY(l),s.z=r.getZ(l),o.x=r.getX(c),o.y=r.getY(c),o.z=r.getZ(c)}function zpe(t,e,n,r,i,s,o,a){const{geometry:l,_indirectBuffer:c}=t;for(let u=r,f=r+i;u<f;u++)sE(l,e,n,u,s,o,a)}function Hpe(t,e,n,r,i,s,o){const{geometry:a,_indirectBuffer:l}=t;let c=1/0,u=null;for(let f=r,d=r+i;f<d;f++){let h;h=sE(a,e,n,f,null,s,o),h&&h.distance<c&&(u=h,c=h.distance)}return u}function Gpe(t,e,n,r,i,s,o){const{geometry:a}=n,{index:l}=a,c=a.attributes.position;for(let u=t,f=e+t;u<f;u++){let d;if(d=u,ts(o,d*3,l,c),o.needsUpdate=!0,r(o,d,i,s))return!0}return!1}function jpe(t,e=null){e&&Array.isArray(e)&&(e=new Set(e));const n=t.geometry,r=n.index?n.index.array:null,i=n.attributes.position;let s,o,a,l,c=0;const u=t._roots;for(let d=0,h=u.length;d<h;d++)s=u[d],o=new Uint32Array(s),a=new Uint16Array(s),l=new Float32Array(s),f(0,c),c+=s.byteLength;function f(d,h,p=!1){const m=d*2;if(a[m+15]===iE){const y=o[d+6],x=a[m+14];let _=1/0,w=1/0,T=1/0,S=-1/0,C=-1/0,A=-1/0;for(let R=3*y,M=3*(y+x);R<M;R++){let D=r[R];const k=i.getX(D),L=i.getY(D),N=i.getZ(D);k<_&&(_=k),k>S&&(S=k),L<w&&(w=L),L>C&&(C=L),N<T&&(T=N),N>A&&(A=N)}return l[d+0]!==_||l[d+1]!==w||l[d+2]!==T||l[d+3]!==S||l[d+4]!==C||l[d+5]!==A?(l[d+0]=_,l[d+1]=w,l[d+2]=T,l[d+3]=S,l[d+4]=C,l[d+5]=A,!0):!1}else{const y=d+8,x=o[d+6],_=y+h,w=x+h;let T=p,S=!1,C=!1;e?T||(S=e.has(_),C=e.has(w),T=!S&&!C):(S=!0,C=!0);const A=T||S,R=T||C;let M=!1;A&&(M=f(y,h,T));let D=!1;R&&(D=f(x,h,T));const k=M||D;if(k)for(let L=0;L<3;L++){const N=y+L,z=x+L,O=l[N],K=l[N+3],V=l[z],ne=l[z+3];l[d+L]=O<V?O:V,l[d+L+3]=K>ne?K:ne}return k}}}function gf(t,e,n,r,i){let s,o,a,l,c,u;const f=1/n.direction.x,d=1/n.direction.y,h=1/n.direction.z,p=n.origin.x,m=n.origin.y,g=n.origin.z;let y=e[t],x=e[t+3],_=e[t+1],w=e[t+3+1],T=e[t+2],S=e[t+3+2];return f>=0?(s=(y-p)*f,o=(x-p)*f):(s=(x-p)*f,o=(y-p)*f),d>=0?(a=(_-m)*d,l=(w-m)*d):(a=(w-m)*d,l=(_-m)*d),s>l||a>o||((a>s||isNaN(s))&&(s=a),(l<o||isNaN(o))&&(o=l),h>=0?(c=(T-g)*h,u=(S-g)*h):(c=(S-g)*h,u=(T-g)*h),s>u||c>o)?!1:((c>s||s!==s)&&(s=c),(u<o||o!==o)&&(o=u),s<=i&&o>=r)}function Vpe(t,e,n,r,i,s,o,a){const{geometry:l,_indirectBuffer:c}=t;for(let u=r,f=r+i;u<f;u++){let d=c?c[u]:u;sE(l,e,n,d,s,o,a)}}function Wpe(t,e,n,r,i,s,o){const{geometry:a,_indirectBuffer:l}=t;let c=1/0,u=null;for(let f=r,d=r+i;f<d;f++){let h;h=sE(a,e,n,l?l[f]:f,null,s,o),h&&h.distance<c&&(u=h,c=h.distance)}return u}function $pe(t,e,n,r,i,s,o){const{geometry:a}=n,{index:l}=a,c=a.attributes.position;for(let u=t,f=e+t;u<f;u++){let d;if(d=n.resolveTriangleIndex(u),ts(o,d*3,l,c),o.needsUpdate=!0,r(o,d,i,s))return!0}return!1}function Xpe(t,e,n,r,i,s,o){ai.setBuffer(t._roots[e]),T5(0,t,n,r,i,s,o),ai.clearBuffer()}function T5(t,e,n,r,i,s,o){const{float32Array:a,uint16Array:l,uint32Array:c}=ai,u=t*2;if(So(u,l)){const d=jo(t,c),h=ua(u,l);zpe(e,n,r,d,h,i,s,o)}else{const d=Ga(t);gf(d,a,r,s,o)&&T5(d,e,n,r,i,s,o);const h=fa(t,c);gf(h,a,r,s,o)&&T5(h,e,n,r,i,s,o)}}const qpe=["x","y","z"];function Ype(t,e,n,r,i,s){ai.setBuffer(t._roots[e]);const o=A5(0,t,n,r,i,s);return ai.clearBuffer(),o}function A5(t,e,n,r,i,s){const{float32Array:o,uint16Array:a,uint32Array:l}=ai;let c=t*2;if(So(c,a)){const f=jo(t,l),d=ua(c,a);return Hpe(e,n,r,f,d,i,s)}else{const f=vC(t,l),d=qpe[f],p=r.direction[d]>=0;let m,g;p?(m=Ga(t),g=fa(t,l)):(m=fa(t,l),g=Ga(t));const x=gf(m,o,r,i,s)?A5(m,e,n,r,i,s):null;if(x){const T=x.point[d];if(p?T<=o[g+f]:T>=o[g+f+3])return x}const w=gf(g,o,r,i,s)?A5(g,e,n,r,i,s):null;return x&&w?x.distance<=w.distance?x:w:x||w||null}}const ex=new Kn,ap=new xl,lp=new xl,sg=new et,Yk=new Io,tx=new Io;function Kpe(t,e,n,r){ai.setBuffer(t._roots[e]);const i=M5(0,t,n,r);return ai.clearBuffer(),i}function M5(t,e,n,r,i=null){const{float32Array:s,uint16Array:o,uint32Array:a}=ai;let l=t*2;if(i===null&&(n.boundingBox||n.computeBoundingBox(),Yk.set(n.boundingBox.min,n.boundingBox.max,r),i=Yk),So(l,o)){const u=e.geometry,f=u.index,d=u.attributes.position,h=n.index,p=n.attributes.position,m=jo(t,a),g=ua(l,o);if(sg.copy(r).invert(),n.boundsTree)return Mi(t,s,tx),tx.matrix.copy(sg),tx.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:x=>tx.intersectsBox(x),intersectsTriangle:x=>{x.a.applyMatrix4(r),x.b.applyMatrix4(r),x.c.applyMatrix4(r),x.needsUpdate=!0;for(let _=m*3,w=(g+m)*3;_<w;_+=3)if(ts(lp,_,f,d),lp.needsUpdate=!0,x.intersectsTriangle(lp))return!0;return!1}});for(let y=m*3,x=(g+m)*3;y<x;y+=3){ts(ap,y,f,d),ap.a.applyMatrix4(sg),ap.b.applyMatrix4(sg),ap.c.applyMatrix4(sg),ap.needsUpdate=!0;for(let _=0,w=h.count;_<w;_+=3)if(ts(lp,_,h,p),lp.needsUpdate=!0,ap.intersectsTriangle(lp))return!0}}else{const u=t+8,f=a[t+6];return Mi(u,s,ex),!!(i.intersectsBox(ex)&&M5(u,e,n,r,i)||(Mi(f,s,ex),i.intersectsBox(ex)&&M5(f,e,n,r,i)))}}const nx=new et,W4=new Io,og=new Io,Zpe=new $,Qpe=new $,Jpe=new $,eme=new $;function tme(t,e,n,r={},i={},s=0,o=1/0){e.boundingBox||e.computeBoundingBox(),W4.set(e.boundingBox.min,e.boundingBox.max,n),W4.needsUpdate=!0;const a=t.geometry,l=a.attributes.position,c=a.index,u=e.attributes.position,f=e.index,d=ja.getPrimitive(),h=ja.getPrimitive();let p=Zpe,m=Qpe,g=null,y=null;i&&(g=Jpe,y=eme);let x=1/0,_=null,w=null;return nx.copy(n).invert(),og.matrix.copy(nx),t.shapecast({boundsTraverseOrder:T=>W4.distanceToBox(T),intersectsBounds:(T,S,C)=>C<x&&C<o?(S&&(og.min.copy(T.min),og.max.copy(T.max),og.needsUpdate=!0),!0):!1,intersectsRange:(T,S)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:A=>og.distanceToBox(A),intersectsBounds:(A,R,M)=>M<x&&M<o,intersectsRange:(A,R)=>{for(let M=A,D=A+R;M<D;M++){ts(h,3*M,f,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let k=T,L=T+S;k<L;k++){ts(d,3*k,c,l),d.needsUpdate=!0;const N=d.distanceToTriangle(h,p,g);if(N<x&&(m.copy(p),y&&y.copy(g),x=N,_=k,w=M),N<s)return!0}}}});{const C=Xm(e);for(let A=0,R=C;A<R;A++){ts(h,3*A,f,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let M=T,D=T+S;M<D;M++){ts(d,3*M,c,l),d.needsUpdate=!0;const k=d.distanceToTriangle(h,p,g);if(k<x&&(m.copy(p),y&&y.copy(g),x=k,_=M,w=A),k<s)return!0}}}}}),ja.releasePrimitive(d),ja.releasePrimitive(h),x===1/0?null:(r.point?r.point.copy(m):r.point=m.clone(),r.distance=x,r.faceIndex=_,i&&(i.point?i.point.copy(y):i.point=y.clone(),i.point.applyMatrix4(nx),m.applyMatrix4(nx),i.distance=m.sub(i.point).length(),i.faceIndex=w),r)}function nme(t,e=null){e&&Array.isArray(e)&&(e=new Set(e));const n=t.geometry,r=n.index?n.index.array:null,i=n.attributes.position;let s,o,a,l,c=0;const u=t._roots;for(let d=0,h=u.length;d<h;d++)s=u[d],o=new Uint32Array(s),a=new Uint16Array(s),l=new Float32Array(s),f(0,c),c+=s.byteLength;function f(d,h,p=!1){const m=d*2;if(a[m+15]===iE){const y=o[d+6],x=a[m+14];let _=1/0,w=1/0,T=1/0,S=-1/0,C=-1/0,A=-1/0;for(let R=y,M=y+x;R<M;R++){const D=3*t.resolveTriangleIndex(R);for(let k=0;k<3;k++){let L=D+k;L=r?r[L]:L;const N=i.getX(L),z=i.getY(L),O=i.getZ(L);N<_&&(_=N),N>S&&(S=N),z<w&&(w=z),z>C&&(C=z),O<T&&(T=O),O>A&&(A=O)}}return l[d+0]!==_||l[d+1]!==w||l[d+2]!==T||l[d+3]!==S||l[d+4]!==C||l[d+5]!==A?(l[d+0]=_,l[d+1]=w,l[d+2]=T,l[d+3]=S,l[d+4]=C,l[d+5]=A,!0):!1}else{const y=d+8,x=o[d+6],_=y+h,w=x+h;let T=p,S=!1,C=!1;e?T||(S=e.has(_),C=e.has(w),T=!S&&!C):(S=!0,C=!0);const A=T||S,R=T||C;let M=!1;A&&(M=f(y,h,T));let D=!1;R&&(D=f(x,h,T));const k=M||D;if(k)for(let L=0;L<3;L++){const N=y+L,z=x+L,O=l[N],K=l[N+3],V=l[z],ne=l[z+3];l[d+L]=O<V?O:V,l[d+L+3]=K>ne?K:ne}return k}}}function rme(t,e,n,r,i,s,o){ai.setBuffer(t._roots[e]),C5(0,t,n,r,i,s,o),ai.clearBuffer()}function C5(t,e,n,r,i,s,o){const{float32Array:a,uint16Array:l,uint32Array:c}=ai,u=t*2;if(So(u,l)){const d=jo(t,c),h=ua(u,l);Vpe(e,n,r,d,h,i,s,o)}else{const d=Ga(t);gf(d,a,r,s,o)&&C5(d,e,n,r,i,s,o);const h=fa(t,c);gf(h,a,r,s,o)&&C5(h,e,n,r,i,s,o)}}const ime=["x","y","z"];function sme(t,e,n,r,i,s){ai.setBuffer(t._roots[e]);const o=R5(0,t,n,r,i,s);return ai.clearBuffer(),o}function R5(t,e,n,r,i,s){const{float32Array:o,uint16Array:a,uint32Array:l}=ai;let c=t*2;if(So(c,a)){const f=jo(t,l),d=ua(c,a);return Wpe(e,n,r,f,d,i,s)}else{const f=vC(t,l),d=ime[f],p=r.direction[d]>=0;let m,g;p?(m=Ga(t),g=fa(t,l)):(m=fa(t,l),g=Ga(t));const x=gf(m,o,r,i,s)?R5(m,e,n,r,i,s):null;if(x){const T=x.point[d];if(p?T<=o[g+f]:T>=o[g+f+3])return x}const w=gf(g,o,r,i,s)?R5(g,e,n,r,i,s):null;return x&&w?x.distance<=w.distance?x:w:x||w||null}}const rx=new Kn,cp=new xl,up=new xl,ag=new et,Kk=new Io,ix=new Io;function ome(t,e,n,r){ai.setBuffer(t._roots[e]);const i=I5(0,t,n,r);return ai.clearBuffer(),i}function I5(t,e,n,r,i=null){const{float32Array:s,uint16Array:o,uint32Array:a}=ai;let l=t*2;if(i===null&&(n.boundingBox||n.computeBoundingBox(),Kk.set(n.boundingBox.min,n.boundingBox.max,r),i=Kk),So(l,o)){const u=e.geometry,f=u.index,d=u.attributes.position,h=n.index,p=n.attributes.position,m=jo(t,a),g=ua(l,o);if(ag.copy(r).invert(),n.boundsTree)return Mi(t,s,ix),ix.matrix.copy(ag),ix.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:x=>ix.intersectsBox(x),intersectsTriangle:x=>{x.a.applyMatrix4(r),x.b.applyMatrix4(r),x.c.applyMatrix4(r),x.needsUpdate=!0;for(let _=m,w=g+m;_<w;_++)if(ts(up,3*e.resolveTriangleIndex(_),f,d),up.needsUpdate=!0,x.intersectsTriangle(up))return!0;return!1}});for(let y=m,x=g+m;y<x;y++){const _=e.resolveTriangleIndex(y);ts(cp,3*_,f,d),cp.a.applyMatrix4(ag),cp.b.applyMatrix4(ag),cp.c.applyMatrix4(ag),cp.needsUpdate=!0;for(let w=0,T=h.count;w<T;w+=3)if(ts(up,w,h,p),up.needsUpdate=!0,cp.intersectsTriangle(up))return!0}}else{const u=t+8,f=a[t+6];return Mi(u,s,rx),!!(i.intersectsBox(rx)&&I5(u,e,n,r,i)||(Mi(f,s,rx),i.intersectsBox(rx)&&I5(f,e,n,r,i)))}}const sx=new et,$4=new Io,lg=new Io,ame=new $,lme=new $,cme=new $,ume=new $;function fme(t,e,n,r={},i={},s=0,o=1/0){e.boundingBox||e.computeBoundingBox(),$4.set(e.boundingBox.min,e.boundingBox.max,n),$4.needsUpdate=!0;const a=t.geometry,l=a.attributes.position,c=a.index,u=e.attributes.position,f=e.index,d=ja.getPrimitive(),h=ja.getPrimitive();let p=ame,m=lme,g=null,y=null;i&&(g=cme,y=ume);let x=1/0,_=null,w=null;return sx.copy(n).invert(),lg.matrix.copy(sx),t.shapecast({boundsTraverseOrder:T=>$4.distanceToBox(T),intersectsBounds:(T,S,C)=>C<x&&C<o?(S&&(lg.min.copy(T.min),lg.max.copy(T.max),lg.needsUpdate=!0),!0):!1,intersectsRange:(T,S)=>{if(e.boundsTree){const C=e.boundsTree;return C.shapecast({boundsTraverseOrder:A=>lg.distanceToBox(A),intersectsBounds:(A,R,M)=>M<x&&M<o,intersectsRange:(A,R)=>{for(let M=A,D=A+R;M<D;M++){const k=C.resolveTriangleIndex(M);ts(h,3*k,f,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let L=T,N=T+S;L<N;L++){const z=t.resolveTriangleIndex(L);ts(d,3*z,c,l),d.needsUpdate=!0;const O=d.distanceToTriangle(h,p,g);if(O<x&&(m.copy(p),y&&y.copy(g),x=O,_=L,w=M),O<s)return!0}}}})}else{const C=Xm(e);for(let A=0,R=C;A<R;A++){ts(h,3*A,f,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let M=T,D=T+S;M<D;M++){const k=t.resolveTriangleIndex(M);ts(d,3*k,c,l),d.needsUpdate=!0;const L=d.distanceToTriangle(h,p,g);if(L<x&&(m.copy(p),y&&y.copy(g),x=L,_=M,w=A),L<s)return!0}}}}}),ja.releasePrimitive(d),ja.releasePrimitive(h),x===1/0?null:(r.point?r.point.copy(m):r.point=m.clone(),r.distance=x,r.faceIndex=_,i&&(i.point?i.point.copy(y):i.point=y.clone(),i.point.applyMatrix4(sx),m.applyMatrix4(sx),i.distance=m.sub(i.point).length(),i.faceIndex=w),r)}function dme(){return typeof SharedArrayBuffer<"u"}const v1=new ai.constructor,g_=new ai.constructor,$u=new _C(()=>new Kn),fp=new Kn,dp=new Kn,X4=new Kn,q4=new Kn;let Y4=!1;function hme(t,e,n,r){if(Y4)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Y4=!0;const i=t._roots,s=e._roots;let o,a=0,l=0;const c=new et().copy(n).invert();for(let u=0,f=i.length;u<f;u++){v1.setBuffer(i[u]),l=0;const d=$u.getPrimitive();Mi(0,v1.float32Array,d),d.applyMatrix4(c);for(let h=0,p=s.length;h<p&&(g_.setBuffer(s[h]),o=hl(0,0,n,c,r,a,l,0,0,d),g_.clearBuffer(),l+=s[h].length,!o);h++);if($u.releasePrimitive(d),v1.clearBuffer(),a+=i[u].length,o)break}return Y4=!1,o}function hl(t,e,n,r,i,s=0,o=0,a=0,l=0,c=null,u=!1){let f,d;u?(f=g_,d=v1):(f=v1,d=g_);const h=f.float32Array,p=f.uint32Array,m=f.uint16Array,g=d.float32Array,y=d.uint32Array,x=d.uint16Array,_=t*2,w=e*2,T=So(_,m),S=So(w,x);let C=!1;if(S&&T)u?C=i(jo(e,y),ua(e*2,x),jo(t,p),ua(t*2,m),l,o+e,a,s+t):C=i(jo(t,p),ua(t*2,m),jo(e,y),ua(e*2,x),a,s+t,l,o+e);else if(S){const A=$u.getPrimitive();Mi(e,g,A),A.applyMatrix4(n);const R=Ga(t),M=fa(t,p);Mi(R,h,fp),Mi(M,h,dp);const D=A.intersectsBox(fp),k=A.intersectsBox(dp);C=D&&hl(e,R,r,n,i,o,s,l,a+1,A,!u)||k&&hl(e,M,r,n,i,o,s,l,a+1,A,!u),$u.releasePrimitive(A)}else{const A=Ga(e),R=fa(e,y);Mi(A,g,X4),Mi(R,g,q4);const M=c.intersectsBox(X4),D=c.intersectsBox(q4);if(M&&D)C=hl(t,A,n,r,i,s,o,a,l+1,c,u)||hl(t,R,n,r,i,s,o,a,l+1,c,u);else if(M)if(T)C=hl(t,A,n,r,i,s,o,a,l+1,c,u);else{const k=$u.getPrimitive();k.copy(X4).applyMatrix4(n);const L=Ga(t),N=fa(t,p);Mi(L,h,fp),Mi(N,h,dp);const z=k.intersectsBox(fp),O=k.intersectsBox(dp);C=z&&hl(A,L,r,n,i,o,s,l,a+1,k,!u)||O&&hl(A,N,r,n,i,o,s,l,a+1,k,!u),$u.releasePrimitive(k)}else if(D)if(T)C=hl(t,R,n,r,i,s,o,a,l+1,c,u);else{const k=$u.getPrimitive();k.copy(q4).applyMatrix4(n);const L=Ga(t),N=fa(t,p);Mi(L,h,fp),Mi(N,h,dp);const z=k.intersectsBox(fp),O=k.intersectsBox(dp);C=z&&hl(R,L,r,n,i,o,s,l,a+1,k,!u)||O&&hl(R,N,r,n,i,o,s,l,a+1,k,!u),$u.releasePrimitive(k)}}return C}const ox=new Io,Zk=new Kn,pme={strategy:Ej,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0,range:null};class oE{static serialize(e,n={}){n={cloneBuffers:!0,...n};const r=e.geometry,i=e._roots,s=e._indirectBuffer,o=r.getIndex();let a;return n.cloneBuffers?a={roots:i.map(l=>l.slice()),index:o?o.array.slice():null,indirectBuffer:s?s.slice():null}:a={roots:i,index:o?o.array:null,indirectBuffer:s},a}static deserialize(e,n,r={}){r={setIndex:!0,indirect:!!e.indirectBuffer,...r};const{index:i,roots:s,indirectBuffer:o}=e,a=new oE(n,{...r,[z4]:!0});if(a._roots=s,a._indirectBuffer=o||null,r.setIndex){const l=n.getIndex();if(l===null){const c=new fn(e.index,1,!1);n.setIndex(c)}else l.array!==i&&(l.array.set(i),l.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}constructor(e,n={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(n=Object.assign({...pme,[z4]:!1},n),n.useSharedArrayBuffer&&!dme())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,n[z4]||(Ipe(this,n),!e.boundingBox&&n.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Kn))),this.resolveTriangleIndex=n.indirect?r=>this._indirectBuffer[r]:r=>r}refit(e=null){return(this.indirect?nme:jpe)(this,e)}traverse(e,n=0){const r=this._roots[n],i=new Uint32Array(r),s=new Uint16Array(r);o(0);function o(a,l=0){const c=a*2,u=s[c+15]===iE;if(u){const f=i[a+6],d=s[c+14];e(l,u,new Float32Array(r,a*4,6),f,d)}else{const f=a+af/4,d=i[a+6],h=i[a+7];e(l,u,new Float32Array(r,a*4,6),h)||(o(f,l+1),o(d,l+1))}}}raycast(e,n=Cs,r=0,i=1/0){const s=this._roots,o=this.geometry,a=[],l=n.isMaterial,c=Array.isArray(n),u=o.groups,f=l?n.side:n,d=this.indirect?rme:Xpe;for(let h=0,p=s.length;h<p;h++){const m=c?n[u[h].materialIndex].side:f,g=a.length;if(d(this,h,m,e,a,r,i),c){const y=u[h].materialIndex;for(let x=g,_=a.length;x<_;x++)a[x].face.materialIndex=y}}return a}raycastFirst(e,n=Cs,r=0,i=1/0){const s=this._roots,o=this.geometry,a=n.isMaterial,l=Array.isArray(n);let c=null;const u=o.groups,f=a?n.side:n,d=this.indirect?sme:Ype;for(let h=0,p=s.length;h<p;h++){const m=l?n[u[h].materialIndex].side:f,g=d(this,h,m,e,r,i);g!=null&&(c==null||g.distance<c.distance)&&(c=g,l&&(g.face.materialIndex=u[h].materialIndex))}return c}intersectsGeometry(e,n){let r=!1;const i=this._roots,s=this.indirect?ome:Kpe;for(let o=0,a=i.length;o<a&&(r=s(this,o,e,n),!r);o++);return r}shapecast(e){const n=ja.getPrimitive(),r=this.indirect?$pe:Gpe;let{boundsTraverseOrder:i,intersectsBounds:s,intersectsRange:o,intersectsTriangle:a}=e;if(o&&a){const f=o;o=(d,h,p,m,g)=>f(d,h,p,m,g)?!0:r(d,h,this,a,p,m,n)}else o||(a?o=(f,d,h,p)=>r(f,d,this,a,h,p,n):o=(f,d,h)=>h);let l=!1,c=0;const u=this._roots;for(let f=0,d=u.length;f<d;f++){const h=u[f];if(l=Ope(this,f,s,o,i,c),l)break;c+=h.byteLength}return ja.releasePrimitive(n),l}bvhcast(e,n,r){let{intersectsRanges:i,intersectsTriangles:s}=r;const o=ja.getPrimitive(),a=this.geometry.index,l=this.geometry.attributes.position,c=this.indirect?p=>{const m=this.resolveTriangleIndex(p);ts(o,m*3,a,l)}:p=>{ts(o,p*3,a,l)},u=ja.getPrimitive(),f=e.geometry.index,d=e.geometry.attributes.position,h=e.indirect?p=>{const m=e.resolveTriangleIndex(p);ts(u,m*3,f,d)}:p=>{ts(u,p*3,f,d)};if(s){const p=(m,g,y,x,_,w,T,S)=>{for(let C=y,A=y+x;C<A;C++){h(C),u.a.applyMatrix4(n),u.b.applyMatrix4(n),u.c.applyMatrix4(n),u.needsUpdate=!0;for(let R=m,M=m+g;R<M;R++)if(c(R),o.needsUpdate=!0,s(o,u,R,C,_,w,T,S))return!0}return!1};if(i){const m=i;i=function(g,y,x,_,w,T,S,C){return m(g,y,x,_,w,T,S,C)?!0:p(g,y,x,_,w,T,S,C)}}else i=p}return hme(this,e,n,i)}intersectsBox(e,n){return ox.set(e.min,e.max,n),ox.needsUpdate=!0,this.shapecast({intersectsBounds:r=>ox.intersectsBox(r),intersectsTriangle:r=>ox.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:n=>e.intersectsBox(n),intersectsTriangle:n=>n.intersectsSphere(e)})}closestPointToGeometry(e,n,r={},i={},s=0,o=1/0){return(this.indirect?fme:tme)(this,e,n,r,i,s,o)}closestPointToPoint(e,n={},r=0,i=1/0){return Fpe(this,e,n,r,i)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(r=>{Mi(0,new Float32Array(r),Zk),e.union(Zk)}),e}}function Qk(t,e,n){return t===null?null:(t.point.applyMatrix4(e.matrixWorld),t.distance=t.point.distanceTo(n.ray.origin),t.object=e,t)}const Jk=Mb||null,ax=new Yo,eL=new $,tL=new et,mme=ln.prototype.raycast,gme=Jk!==null?Jk.prototype.raycast:null,nL=new $,Os=new ln,lx=[];function Rj(t,e){this.isBatchedMesh?yme.call(this,t,e):vme.call(this,t,e)}function yme(t,e){if(this.boundsTrees){const n=this.boundsTrees,r=this._drawInfo,i=this._drawRanges,s=this.matrixWorld;Os.material=this.material,Os.geometry=this.geometry;const o=Os.geometry.boundsTree,a=Os.geometry.drawRange;Os.geometry.boundingSphere===null&&(Os.geometry.boundingSphere=new wr);for(let l=0,c=r.length;l<c;l++){if(!this.getVisibleAt(l))continue;const u=r[l].geometryIndex;if(Os.geometry.boundsTree=n[u],this.getMatrixAt(l,Os.matrixWorld).premultiply(s),!Os.geometry.boundsTree){this.getBoundingBoxAt(u,Os.geometry.boundingBox),this.getBoundingSphereAt(u,Os.geometry.boundingSphere);const f=i[u];Os.geometry.setDrawRange(f.start,f.count)}Os.raycast(t,lx);for(let f=0,d=lx.length;f<d;f++){const h=lx[f];h.object=this,h.batchId=l,e.push(h)}lx.length=0}Os.geometry.boundsTree=o,Os.geometry.drawRange=a,Os.material=null,Os.geometry=null}else gme.call(this,t,e)}function vme(t,e){if(this.geometry.boundsTree){if(this.material===void 0)return;tL.copy(this.matrixWorld).invert(),ax.copy(t.ray).applyMatrix4(tL),nL.setFromMatrixScale(this.matrixWorld),eL.copy(ax.direction).multiply(nL);const n=eL.length(),r=t.near/n,i=t.far/n,s=this.geometry.boundsTree;if(t.firstHitOnly===!0){const o=Qk(s.raycastFirst(ax,this.material,r,i),this,t);o&&e.push(o)}else{const o=s.raycast(ax,this.material,r,i);for(let a=0,l=o.length;a<l;a++){const c=Qk(o[a],this,t);c&&e.push(c)}}}else mme.call(this,t,e)}function Ij(t={}){return this.boundsTree=new oE(this,t),this.boundsTree}function Pj(){this.boundsTree=null}function xme(t){switch(t){case 1:return"R";case 2:return"RG";case 3:return"RGBA";case 4:return"RGBA"}throw new Error}function _me(t){switch(t){case 1:return Yc;case 2:return _b;case 3:return Pr;case 4:return Pr}}function rL(t){switch(t){case 1:return Dm;case 2:return Nm;case 3:return hf;case 4:return hf}}class kj extends As{constructor(){super(),this.minFilter=zn,this.magFilter=zn,this.generateMipmaps=!1,this.overrideItemSize=null,this._forcedType=null}updateFrom(e){const n=this.overrideItemSize,r=e.itemSize,i=e.count;if(n!==null){if(r*i%n!==0)throw new Error("VertexAttributeTexture: overrideItemSize must divide evenly into buffer length.");e.itemSize=n,e.count=i*r/n}const s=e.itemSize,o=e.count,a=e.normalized,l=e.array.constructor,c=l.BYTES_PER_ELEMENT;let u=this._forcedType,f=s;if(u===null)switch(l){case Float32Array:u=pr;break;case Uint8Array:case Uint16Array:case Uint32Array:u=io;break;case Int8Array:case Int16Array:case Int32Array:u=rf;break}let d,h,p,m,g=xme(s);switch(u){case pr:p=1,h=_me(s),a&&c===1?(m=l,g+="8",l===Uint8Array?d=Rs:(d=mm,g+="_SNORM")):(m=Float32Array,g+="32F",d=pr);break;case rf:g+=c*8+"I",p=a?Math.pow(2,l.BYTES_PER_ELEMENT*8-1):1,h=rL(s),c===1?(m=Int8Array,d=mm):c===2?(m=Int16Array,d=hy):(m=Int32Array,d=rf);break;case io:g+=c*8+"UI",p=a?Math.pow(2,l.BYTES_PER_ELEMENT*8-1):1,h=rL(s),c===1?(m=Uint8Array,d=Rs):c===2?(m=Uint16Array,d=df):(m=Uint32Array,d=io);break}f===3&&(h===Pr||h===hf)&&(f=4);const y=Math.ceil(Math.sqrt(o))||1,x=f*y*y,_=new m(x),w=e.normalized;e.normalized=!1;for(let T=0;T<o;T++){const S=f*T;_[S]=e.getX(T)/p,s>=2&&(_[S+1]=e.getY(T)/p),s>=3&&(_[S+2]=e.getZ(T)/p,f===4&&(_[S+3]=1)),s>=4&&(_[S+3]=e.getW(T)/p)}e.normalized=w,this.internalFormat=g,this.format=h,this.type=d,this.image.width=y,this.image.height=y,this.image.data=_,this.needsUpdate=!0,this.dispose(),e.itemSize=r,e.count=i}}class bme extends kj{constructor(){super(),this._forcedType=io}}class Eme extends kj{constructor(){super(),this._forcedType=pr}}class Lj{constructor(){this.index=new bme,this.position=new Eme,this.bvhBounds=new As,this.bvhContents=new As,this._cachedIndexAttr=null,this.index.overrideItemSize=3}updateFrom(e){const{geometry:n}=e;if(Sme(e,this.bvhBounds,this.bvhContents),this.position.updateFrom(n.attributes.position),e.indirect){const r=e._indirectBuffer;if(this._cachedIndexAttr===null||this._cachedIndexAttr.count!==r.length)if(n.index)this._cachedIndexAttr=n.index.clone();else{const i=Sj(wj(n));this._cachedIndexAttr=new fn(i,1,!1)}wme(n,r,this._cachedIndexAttr),this.index.updateFrom(this._cachedIndexAttr)}else this.index.updateFrom(n.index)}dispose(){const{index:e,position:n,bvhBounds:r,bvhContents:i}=this;e&&e.dispose(),n&&n.dispose(),r&&r.dispose(),i&&i.dispose()}}function wme(t,e,n){const r=n.array,i=t.index?t.index.array:null;for(let s=0,o=e.length;s<o;s++){const a=3*s,l=3*e[s];for(let c=0;c<3;c++)r[a+c]=i?i[l+c]:l+c}}function Sme(t,e,n){const r=t._roots;if(r.length!==1)throw new Error("MeshBVHUniformStruct: Multi-root BVHs not supported.");const i=r[0],s=new Uint16Array(i),o=new Uint32Array(i),a=new Float32Array(i),l=i.byteLength/af,c=2*Math.ceil(Math.sqrt(l/2)),u=new Float32Array(4*c*c),f=Math.ceil(Math.sqrt(l)),d=new Uint32Array(2*f*f);for(let h=0;h<l;h++){const p=h*af/4,m=p*2,g=p;for(let y=0;y<3;y++)u[8*h+0+y]=a[g+0+y],u[8*h+4+y]=a[g+3+y];if(So(m,s)){const y=ua(m,s),x=jo(p,o),_=4294901760|y;d[h*2+0]=_,d[h*2+1]=x}else{const y=4*fa(p,o)/af,x=vC(p,o);d[h*2+0]=x,d[h*2+1]=y}}e.image.data=u,e.image.width=c,e.image.height=c,e.format=Pr,e.type=pr,e.internalFormat="RGBA32F",e.minFilter=zn,e.magFilter=zn,e.generateMipmaps=!1,e.needsUpdate=!0,e.dispose(),n.image.data=d,n.image.width=f,n.image.height=f,n.format=Nm,n.type=io,n.internalFormat="RG32UI",n.minFilter=zn,n.magFilter=zn,n.generateMipmaps=!1,n.needsUpdate=!0,n.dispose()}const Tme=`

// A stack of uint32 indices can can store the indices for
// a perfectly balanced tree with a depth up to 31. Lower stack
// depth gets higher performance.
//
// However not all trees are balanced. Best value to set this to
// is the trees max depth.
#ifndef BVH_STACK_DEPTH
#define BVH_STACK_DEPTH 60
#endif

#ifndef INFINITY
#define INFINITY 1e20
#endif

// Utilities
uvec4 uTexelFetch1D( usampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

ivec4 iTexelFetch1D( isampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 texelFetch1D( sampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 textureSampleBarycoord( sampler2D tex, vec3 barycoord, uvec3 faceIndices ) {

	return
		barycoord.x * texelFetch1D( tex, faceIndices.x ) +
		barycoord.y * texelFetch1D( tex, faceIndices.y ) +
		barycoord.z * texelFetch1D( tex, faceIndices.z );

}

void ndcToCameraRay(
	vec2 coord, mat4 cameraWorld, mat4 invProjectionMatrix,
	out vec3 rayOrigin, out vec3 rayDirection
) {

	// get camera look direction and near plane for camera clipping
	vec4 lookDirection = cameraWorld * vec4( 0.0, 0.0, - 1.0, 0.0 );
	vec4 nearVector = invProjectionMatrix * vec4( 0.0, 0.0, - 1.0, 1.0 );
	float near = abs( nearVector.z / nearVector.w );

	// get the camera direction and position from camera matrices
	vec4 origin = cameraWorld * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec4 direction = invProjectionMatrix * vec4( coord, 0.5, 1.0 );
	direction /= direction.w;
	direction = cameraWorld * direction - origin;

	// slide the origin along the ray until it sits at the near clip plane position
	origin.xyz += direction.xyz * near / dot( direction, lookDirection );

	rayOrigin = origin.xyz;
	rayDirection = direction.xyz;

}
`,Ame=`

#ifndef TRI_INTERSECT_EPSILON
#define TRI_INTERSECT_EPSILON 1e-5
#endif

// Raycasting
bool intersectsBounds( vec3 rayOrigin, vec3 rayDirection, vec3 boundsMin, vec3 boundsMax, out float dist ) {

	// https://www.reddit.com/r/opengl/comments/8ntzz5/fast_glsl_ray_box_intersection/
	// https://tavianator.com/2011/ray_box.html
	vec3 invDir = 1.0 / rayDirection;

	// find intersection distances for each plane
	vec3 tMinPlane = invDir * ( boundsMin - rayOrigin );
	vec3 tMaxPlane = invDir * ( boundsMax - rayOrigin );

	// get the min and max distances from each intersection
	vec3 tMinHit = min( tMaxPlane, tMinPlane );
	vec3 tMaxHit = max( tMaxPlane, tMinPlane );

	// get the furthest hit distance
	vec2 t = max( tMinHit.xx, tMinHit.yz );
	float t0 = max( t.x, t.y );

	// get the minimum hit distance
	t = min( tMaxHit.xx, tMaxHit.yz );
	float t1 = min( t.x, t.y );

	// set distance to 0.0 if the ray starts inside the box
	dist = max( t0, 0.0 );

	return t1 >= dist;

}

bool intersectsTriangle(
	vec3 rayOrigin, vec3 rayDirection, vec3 a, vec3 b, vec3 c,
	out vec3 barycoord, out vec3 norm, out float dist, out float side
) {

	// https://stackoverflow.com/questions/42740765/intersection-between-line-and-triangle-in-3d
	vec3 edge1 = b - a;
	vec3 edge2 = c - a;
	norm = cross( edge1, edge2 );

	float det = - dot( rayDirection, norm );
	float invdet = 1.0 / det;

	vec3 AO = rayOrigin - a;
	vec3 DAO = cross( AO, rayDirection );

	vec4 uvt;
	uvt.x = dot( edge2, DAO ) * invdet;
	uvt.y = - dot( edge1, DAO ) * invdet;
	uvt.z = dot( AO, norm ) * invdet;
	uvt.w = 1.0 - uvt.x - uvt.y;

	// set the hit information
	barycoord = uvt.wxy; // arranged in A, B, C order
	dist = uvt.z;
	side = sign( det );
	norm = side * normalize( norm );

	// add an epsilon to avoid misses between triangles
	uvt += vec4( TRI_INTERSECT_EPSILON );

	return all( greaterThanEqual( uvt, vec4( 0.0 ) ) );

}

bool intersectTriangles(
	// geometry info and triangle range
	sampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// outputs
	inout float minDistance, inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	bool found = false;
	vec3 localBarycoord, localNormal;
	float localDist, localSide;
	for ( uint i = offset, l = offset + count; i < l; i ++ ) {

		uvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;
		vec3 a = texelFetch1D( positionAttr, indices.x ).rgb;
		vec3 b = texelFetch1D( positionAttr, indices.y ).rgb;
		vec3 c = texelFetch1D( positionAttr, indices.z ).rgb;

		if (
			intersectsTriangle( rayOrigin, rayDirection, a, b, c, localBarycoord, localNormal, localDist, localSide )
			&& localDist < minDistance
		) {

			found = true;
			minDistance = localDist;

			faceIndices = uvec4( indices.xyz, i );
			faceNormal = localNormal;

			side = localSide;
			barycoord = localBarycoord;
			dist = localDist;

		}

	}

	return found;

}

bool intersectsBVHNodeBounds( vec3 rayOrigin, vec3 rayDirection, sampler2D bvhBounds, uint currNodeIndex, out float dist ) {

	uint cni2 = currNodeIndex * 2u;
	vec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;
	vec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;
	return intersectsBounds( rayOrigin, rayDirection, boundsMin, boundsMax, dist );

}

// use a macro to hide the fact that we need to expand the struct into separate fields
#define	bvhIntersectFirstHit(		bvh,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)	_bvhIntersectFirstHit(		bvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)

bool _bvhIntersectFirstHit(
	// bvh info
	sampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// output variables split into separate variables due to output precision
	inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	// stack needs to be twice as long as the deepest tree we expect because
	// we push both the left and right child onto the stack every traversal
	int ptr = 0;
	uint stack[ BVH_STACK_DEPTH ];
	stack[ 0 ] = 0u;

	float triangleDistance = INFINITY;
	bool found = false;
	while ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {

		uint currNodeIndex = stack[ ptr ];
		ptr --;

		// check if we intersect the current bounds
		float boundsHitDistance;
		if (
			! intersectsBVHNodeBounds( rayOrigin, rayDirection, bvh_bvhBounds, currNodeIndex, boundsHitDistance )
			|| boundsHitDistance > triangleDistance
		) {

			continue;

		}

		uvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;
		bool isLeaf = bool( boundsInfo.x & 0xffff0000u );

		if ( isLeaf ) {

			uint count = boundsInfo.x & 0x0000ffffu;
			uint offset = boundsInfo.y;

			found = intersectTriangles(
				bvh_position, bvh_index, offset, count,
				rayOrigin, rayDirection, triangleDistance,
				faceIndices, faceNormal, barycoord, side, dist
			) || found;

		} else {

			uint leftIndex = currNodeIndex + 1u;
			uint splitAxis = boundsInfo.x & 0x0000ffffu;
			uint rightIndex = boundsInfo.y;

			bool leftToRight = rayDirection[ splitAxis ] >= 0.0;
			uint c1 = leftToRight ? leftIndex : rightIndex;
			uint c2 = leftToRight ? rightIndex : leftIndex;

			// set c2 in the stack so we traverse it later. We need to keep track of a pointer in
			// the stack while we traverse. The second pointer added is the one that will be
			// traversed first
			ptr ++;
			stack[ ptr ] = c2;

			ptr ++;
			stack[ ptr ] = c1;

		}

	}

	return found;

}
`,Mme=`
struct BVH {

	usampler2D index;
	sampler2D position;

	sampler2D bvhBounds;
	usampler2D bvhContents;

};
`,Cme=Mme,Rme=`
	${Tme}
	${Ame}
`,iL=t=>t.isMesh;function v$e(t,e){e={strategy:rE,verbose:!1,setBoundingBox:!0,maxDepth:40,maxLeafTris:10,indirect:!1,...e},v.useEffect(()=>{if(t.current){t.current.raycast=Rj;const n=t.current.geometry;return n.computeBoundsTree=Ij,n.disposeBoundsTree=Pj,n.computeBoundsTree(e),()=>{n.boundsTree&&n.disposeBoundsTree()}}},[t,JSON.stringify(e)])}const Dj=v.forwardRef(({enabled:t=!0,firstHitOnly:e=!1,children:n,strategy:r=rE,verbose:i=!1,setBoundingBox:s=!0,maxDepth:o=40,maxLeafTris:a=10,indirect:l=!1,...c},u)=>{const f=v.useRef(null),d=At(h=>h.raycaster);return v.useImperativeHandle(u,()=>f.current,[]),v.useEffect(()=>{if(t){const h={strategy:r,verbose:i,setBoundingBox:s,maxDepth:o,maxLeafTris:a,indirect:l},p=f.current;return d.firstHitOnly=e,p.traverse(m=>{iL(m)&&!m.geometry.boundsTree&&m.raycast===ln.prototype.raycast&&(m.raycast=Rj,m.geometry.computeBoundsTree=Ij,m.geometry.disposeBoundsTree=Pj,m.geometry.computeBoundsTree(h))}),()=>{delete d.firstHitOnly,p.traverse(m=>{iL(m)&&m.geometry.boundsTree&&(m.geometry.disposeBoundsTree(),m.raycast=ln.prototype.raycast)})}}},[]),v.createElement("group",It({ref:f},c),n)});function Ime(t){const e=v.useRef(null),n=v.useRef(!1),r=v.useRef(!1),i=v.useRef(t);return v.useLayoutEffect(()=>void(i.current=t),[t]),v.useEffect(()=>{const s=e.current;if(s){const o=Kb(()=>(n.current=!1,!0)),a=s.onBeforeRender;s.onBeforeRender=()=>n.current=!0;const l=Q6(()=>(n.current!==r.current&&(i.current==null||i.current(r.current=n.current)),!0));return()=>{s.onBeforeRender=a,o(),l()}}},[]),e}const sL=new Kn,cx=new $,Nj=({anchor:t,...e})=>{const n=v.useRef(null),r=v.useRef(null);return v.useEffect(()=>{var i;(i=n.current)!=null&&(i=i.parent)!=null&&i.parent&&(r.current=n.current.parent,n.current.parent.parent.add(n.current))},[]),Yt(()=>{r.current&&(sL.setFromObject(r.current),sL.getSize(cx),n.current.position.set(r.current.position.x+cx.x*(Array.isArray(t)?t[0]:t.x)/2,r.current.position.y+cx.y*(Array.isArray(t)?t[1]:t.y)/2,r.current.position.z+cx.z*(Array.isArray(t)?t[2]:t.z)/2))}),v.createElement("group",It({ref:n},e))},bC=v.forwardRef(function({children:e,disable:n,disableX:r,disableY:i,disableZ:s,left:o,right:a,top:l,bottom:c,front:u,back:f,onCentered:d,precise:h=!0,cacheKey:p=0,...m},g){const y=v.useRef(null),x=v.useRef(null),_=v.useRef(null);return v.useLayoutEffect(()=>{x.current.matrixWorld.identity();const w=new Kn().setFromObject(_.current,h),T=new $,S=new wr,C=w.max.x-w.min.x,A=w.max.y-w.min.y,R=w.max.z-w.min.z;w.getCenter(T),w.getBoundingSphere(S);const M=l?A/2:c?-A/2:0,D=o?-C/2:a?C/2:0,k=u?R/2:f?-R/2:0;x.current.position.set(n||r?0:-T.x+D,n||i?0:-T.y+M,n||s?0:-T.z+k),typeof d<"u"&&d({parent:y.current.parent,container:y.current,width:C,height:A,depth:R,boundingBox:w,boundingSphere:S,center:T,verticalAlignment:M,horizontalAlignment:D,depthAlignment:k})},[p,d,l,o,u,n,r,i,s,h,a,c,f]),v.useImperativeHandle(g,()=>y.current,[]),v.createElement("group",It({ref:y},m),v.createElement("group",{ref:x},v.createElement("group",{ref:_},e)))});var Oj={exports:{}},K4,oL;function Pme(){if(oL)return K4;oL=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K4=t,K4}var Z4,aL;function kme(){if(aL)return Z4;aL=1;var t=Pme();function e(){}function n(){}return n.resetWarningCache=e,Z4=function(){function r(o,a,l,c,u,f){if(f!==t){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}r.isRequired=r;function i(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},Z4}Oj.exports=kme()();var Lme=Oj.exports;const Sr=Zd(Lme);function Fj(t){return Uj(t.children,t.components)}Fj.propTypes={children:Sr.func.isRequired,components:Sr.arrayOf(Sr.oneOfType([Sr.element,Sr.func])).isRequired};function Uj(t,e,n){if(n=n||[],!e[0])return t(n);function r(i){return Uj(t,e.slice(1),n.concat([i]))}return typeof e[0]=="function"?e[0]({results:n,render:r}):v.cloneElement(e[0],{children:r})}const x1=(t,e)=>{"updateRanges"in t?t.updateRanges[0]=e:t.updateRange=e},Dme=3e3,Nme=3001;function Ome(t){return typeof t=="function"}const lL=new et,cL=new et,ux=[],cg=new ln;class Fme extends es{constructor(){super(),this.color=new wt("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return(e=this.instance.current)==null?void 0:e.geometry}raycast(e,n){const r=this.instance.current;if(!r||!r.geometry||!r.material)return;cg.geometry=r.geometry;const i=r.matrixWorld,s=r.userData.instances.indexOf(this.instanceKey);if(!(s===-1||s>r.count)){r.getMatrixAt(s,lL),cL.multiplyMatrices(i,lL),cg.matrixWorld=cL,r.material instanceof Wr?cg.material.side=r.material.side:cg.material.side=r.material[0].side,cg.raycast(e,ux);for(let o=0,a=ux.length;o<a;o++){const l=ux[o];l.instanceId=s,l.object=this,n.push(l)}ux.length=0}}}const Bj=v.createContext(null),uL=new et,fL=new et,Ume=new et,dL=new $,hL=new bn,pL=new $,Bme=t=>t.isInstancedBufferAttribute,EC=v.forwardRef(({context:t,children:e,...n},r)=>{v.useMemo(()=>Gi({PositionMesh:Fme}),[]);const i=v.useRef();v.useImperativeHandle(r,()=>i.current,[]);const{subscribe:s,getParent:o}=v.useContext(t||Bj);return v.useLayoutEffect(()=>s(i),[]),v.createElement("positionMesh",It({instance:o(),instanceKey:i,ref:i},n),e)}),Ry=v.forwardRef(({context:t,children:e,range:n,limit:r=1e3,frames:i=1/0,...s},o)=>{const[{localContext:a,instance:l}]=v.useState(()=>{const x=v.createContext(null);return{localContext:x,instance:v.forwardRef((_,w)=>v.createElement(EC,It({context:x},_,{ref:w})))}}),c=v.useRef(null);v.useImperativeHandle(o,()=>c.current,[]);const[u,f]=v.useState([]),[[d,h]]=v.useState(()=>{const x=new Float32Array(r*16);for(let _=0;_<r;_++)Ume.identity().toArray(x,_*16);return[x,new Float32Array([...new Array(r*3)].map(()=>1))]});v.useEffect(()=>{c.current.instanceMatrix.needsUpdate=!0});let p=0,m=0;const g=v.useRef([]);v.useLayoutEffect(()=>{g.current=Object.entries(c.current.geometry.attributes).filter(([x,_])=>Bme(_))}),Yt(()=>{if(i===1/0||p<i){c.current.updateMatrix(),c.current.updateMatrixWorld(),uL.copy(c.current.matrixWorld).invert(),m=Math.min(r,n!==void 0?n:r,u.length),c.current.count=m,x1(c.current.instanceMatrix,{offset:0,count:m*16}),x1(c.current.instanceColor,{offset:0,count:m*3});for(let x=0;x<u.length;x++){const _=u[x].current;_.matrixWorld.decompose(dL,hL,pL),fL.compose(dL,hL,pL).premultiply(uL),fL.toArray(d,x*16),c.current.instanceMatrix.needsUpdate=!0,_.color.toArray(h,x*3),c.current.instanceColor.needsUpdate=!0}p++}});const y=v.useMemo(()=>({getParent:()=>c,subscribe:x=>(f(_=>[..._,x]),()=>f(_=>_.filter(w=>w.current!==x.current)))}),[]);return v.createElement("instancedMesh",It({userData:{instances:u,limit:r,frames:i},matrixAutoUpdate:!1,ref:c,args:[null,null,0],raycast:()=>null},s),v.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:d.length/16,array:d,itemSize:16,usage:Ji}),v.createElement("instancedBufferAttribute",{attach:"instanceColor",count:h.length/3,array:h,itemSize:3,usage:Ji}),Ome(e)?v.createElement(a.Provider,{value:y},e(l)):t?v.createElement(t.Provider,{value:y},e):v.createElement(Bj.Provider,{value:y},e))}),zj=v.forwardRef(function({meshes:e,children:n,...r},i){const s=Array.isArray(e);if(!s)for(const o of Object.keys(e))e[o].isMesh||delete e[o];return v.createElement("group",{ref:i},v.createElement(Fj,{components:(s?e:Object.values(e)).map(({geometry:o,material:a})=>v.createElement(Ry,It({key:o.uuid,geometry:o,material:a},r)))},o=>s?n(...o):n(Object.keys(e).filter(a=>e[a].isMesh).reduce((a,l,c)=>({...a,[l]:o[c]}),{}))))});function x$e(){const t=v.createContext(null);return[v.forwardRef((e,n)=>v.createElement(Ry,It({ref:n,context:t},e))),v.forwardRef((e,n)=>v.createElement(EC,It({ref:n,context:t},e)))]}const _$e=v.forwardRef(({name:t,defaultValue:e,normalized:n,usage:r=Ji},i)=>{const s=v.useRef(null);v.useImperativeHandle(i,()=>s.current,[]),v.useLayoutEffect(()=>{const a=s.current.__r3f.parent;a.geometry.attributes[t]=s.current;const l=Array.isArray(e)?e:[e],c=Array.from({length:a.userData.limit},()=>l).flat();return s.current.array=new Float32Array(c),s.current.itemSize=l.length,s.current.count=c.length/s.current.itemSize,()=>{delete a.geometry.attributes[t]}},[t]);let o=0;return Yt(()=>{const a=s.current.__r3f.parent;if(a.userData.frames===1/0||o<a.userData.frames){for(let l=0;l<a.userData.instances.length;l++){const u=a.userData.instances[l].current[t];u!==void 0&&(s.current.set(Array.isArray(u)?u:typeof u.toArray=="function"?u.toArray():[u],l*s.current.itemSize),s.current.needsUpdate=!0)}o++}}),v.createElement("instancedBufferAttribute",{ref:s,usage:r,normalized:n})}),Hj=v.createContext(null);function b$e(){return v.useContext(Hj)}function zme(t){return t!==null&&"meta"in t&&"frames"in t}const mL=new Ps(1,1),Gj=v.forwardRef(({startFrame:t=0,endFrame:e,fps:n=30,frameName:r="",textureDataURL:i,textureImageURL:s,loop:o=!1,numberOfFrames:a=1,autoPlay:l=!0,animationNames:c,onStart:u,onEnd:f,onLoopEnd:d,onFrame:h,play:p,pause:m=!1,flipX:g=!1,alphaTest:y=0,children:x,asSprite:_=!1,offset:w,playBackwards:T=!1,resetOnEnd:S=!1,maxItems:C=1,instanceItems:A=[[0,0,0]],spriteDataset:R,canvasRenderingContext2DSettings:M,roundFramePosition:D=!1,meshProps:k={},...L},N)=>{const z=v.useRef(new es),O=v.useRef(null),K=v.useRef(null),V=v.useRef(null),ne=v.useRef(window.performance.now()),re=v.useRef(t),P=v.useRef(r),se=n>0?1e3/n:0,[ue,te]=v.useState(new tr),W=v.useRef(0),[X,J]=v.useState(new $(1,1,1)),oe=g?-1:1,Ee=v.useRef(m),me=v.useRef(w),Te=v.useRef(!1),{spriteObj:_e,loadJsonAndTexture:Re}=yC(null,null,c,a,void 0,M),ae=v.useRef(r),Ce=v.useCallback((ie,ve)=>{if(ve===null)a&&(W.current=a,T&&(re.current=a-1),O.current=ve);else{var Me,Be;O.current=ve,O.current&&Array.isArray(O.current.frames)?W.current=O.current.frames.length:O.current&&typeof O.current=="object"&&ae.current?W.current=O.current.frames[ae.current].length:W.current=0,T&&(re.current=W.current-1);const{w:Ze,h:F}=y3((Me=(Be=O.current)==null?void 0:Be.frames)!==null&&Me!==void 0?Me:[],ae.current).sourceSize,Z=ye(Ze,F);J(Z),K.current&&(K.current.map=ie)}te(ie)},[a,T]),Pe=v.useCallback(()=>{if(!O.current)return;const{meta:{size:ie},frames:ve}=O.current,{w:Me,h:Be}=Array.isArray(ve)?ve[0].sourceSize:r?ve[r]?ve[r][0].sourceSize:{w:0,h:0}:{w:0,h:0};K.current&&K.current.map&&(K.current.map.wrapS=K.current.map.wrapT=Or,K.current.map.center.set(0,0),K.current.map.repeat.set(1*oe/(ie.w/Me),1/(ie.h/Be)));const F=1/((ie.h-1)/Be);K.current&&K.current.map&&(K.current.map.offset.x=0,K.current.map.offset.y=1-F),u&&u({currentFrameName:r??"",currentFrame:re.current})},[oe,r,u]),Ve=v.useMemo(()=>({current:me.current,offset:me.current,imageUrl:s,hasEnded:!1,ref:N}),[s,N]);v.useImperativeHandle(N,()=>z.current,[]),v.useLayoutEffect(()=>{me.current=w},[w]);const ye=(ie,ve)=>{var Me;const Be=new $,Ze=ve/ie;return Be.set(1,Ze,1),(Me=V.current)==null||Me.scale.copy(Be),Be};v.useEffect(()=>{if(R){var ie;Ce(R==null||(ie=R.spriteTexture)==null?void 0:ie.clone(),R.spriteData)}else s&&i&&Re(s,i)},[Re,R,i,s,Ce]),v.useEffect(()=>{if(_e){var ie;Ce(_e==null||(ie=_e.spriteTexture)==null?void 0:ie.clone(),_e==null?void 0:_e.spriteData)}},[_e,Ce]),v.useEffect(()=>{if(Ve.hasEnded=!1,O.current&&T===!0){var ie;re.current=((ie=O.current.frames.length)!==null&&ie!==void 0?ie:0)-1}else re.current=0},[T,Ve]),v.useLayoutEffect(()=>{Pe()},[ue,g,Pe]),v.useEffect(()=>{l&&(Ee.current=!1)},[l]),v.useLayoutEffect(()=>{if(P.current!==r&&r&&(re.current=0,P.current=r,Ve.hasEnded=!1,se<=0&&(re.current=e||t||0),O.current)){const{w:ie,h:ve}=y3(O.current.frames,r).sourceSize,Me=ye(ie,ve);J(Me)}},[r,se,Ve,e,t]);const ge=()=>{if(!zme(O.current))return;const{meta:{size:ie},frames:ve}=O.current,{w:Me,h:Be}=y3(ve,r).sourceSize,Ze=Array.isArray(ve)?ve:r?ve[r]:[],F=e||Ze.length-1;var Z=w===void 0?Ve.current:w;if(se<=0){re.current=e||t||0,ze(Me,Be,ie,Ze);return}const q=window.performance.now(),xe=q-ne.current;if(!(xe<=se)){var be=T?re.current<0:re.current>F,De=T?re.current===F:re.current===0,$e=T?re.current<0:re.current>=F;if(be){if(re.current=o?t??0:0,T&&(re.current=F),o?d==null||d({currentFrameName:r??"",currentFrame:re.current}):(f==null||f({currentFrameName:r??"",currentFrame:re.current}),Ve.hasEnded=!S,S&&(Ee.current=!0)),!o)return}else De&&(u==null||u({currentFrameName:r??"",currentFrame:re.current}));Z!==void 0&&$e?Te.current===!1&&(f==null||f({currentFrameName:r??"",currentFrame:re.current}),Te.current=!0):Te.current=!1,!(xe<=se)&&(ne.current=q-xe%se,ze(Me,Be,ie,Ze))}},ze=(ie,ve,Me,Be)=>{var Ze=w===void 0?Ve.current:w;const F=re.current;let Z=0,q=0;ye(ie,ve);const xe=D?Math.round((Me.w-1)/ie):(Me.w-1)/ie,be=D?Math.round((Me.h-1)/ve):(Me.h-1)/ve;if(!Be[F])return;const{frame:{x:De,y:$e},sourceSize:{w:st,h:it}}=Be[F],Ie=1/xe,Ye=1/be;if(K.current&&K.current.map&&(Z=oe>0?Ie*(De/st):Ie*(De/st)-K.current.map.repeat.x,q=Math.abs(1-Ye)-Ye*($e/it),K.current.map.offset.x=Z,K.current.map.offset.y=q),Ze!=null){let at=Math.floor(Ze*Be.length);at=Math.max(0,Math.min(at,Be.length-1)),isNaN(at)&&(at=0),re.current=at}else T?re.current-=1:re.current+=1};Yt((ie,ve)=>{var Me,Be;!((Me=O.current)!=null&&Me.frames)||!((Be=K.current)!=null&&Be.map)||Ee.current||!Ve.hasEnded&&(l||p)&&(ge(),h==null||h({currentFrameName:P.current,currentFrame:re.current}))});function fe(ie=new $(1,1,1),ve=1){if(typeof ve=="number")return ie.multiplyScalar(ve);if(Array.isArray(ve))return ie.multiply(new $(...ve));if(ve instanceof $)return ie.multiply(ve)}return v.createElement("group",It({},L,{ref:z,scale:fe(X,L.scale)}),v.createElement(Hj.Provider,{value:Ve},_&&v.createElement(uC,null,v.createElement("mesh",It({ref:V,scale:1,geometry:mL},k),v.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:Nr,ref:K,map:ue,transparent:!0,alphaTest:y??0}))),!_&&v.createElement(Ry,It({geometry:mL,limit:C??1},k),v.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:Nr,ref:K,map:ue,transparent:!0,alphaTest:y??0}),(A??[0]).map((ie,ve)=>v.createElement(EC,It({key:ve,ref:(A==null?void 0:A.length)===1?V:null,position:ie,scale:1},k)))),x))}),jj=v.forwardRef(({children:t,curve:e},n)=>{const[r]=v.useState(()=>new ls),[i,s]=v.useState(),o=v.useRef();return v.useEffect(()=>{o.current=new Sue(r.children[0]),s(o.current.object3D)},[t]),v.useEffect(()=>{var a;e&&((a=o.current)==null||a.updateCurve(0,e))},[e]),v.useImperativeHandle(n,()=>({moveAlongCurve:a=>{var l;(l=o.current)==null||l.moveAlongCurve(a)}})),v.createElement(v.Fragment,null,Al(t,r),i&&v.createElement("primitive",{object:i}))});var Hme=`#define GLSLIFY 1
vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}`;class Gme extends Ur{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader=`
      uniform float time;
      uniform float radius;
      uniform float distort;
      ${Hme}
      ${e.vertexShader}
    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>",`
        float updateTime = time / 50.0;
        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));
        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));
        `)}get time(){return this._time.value}set time(e){this._time.value=e}get distort(){return this._distort.value}set distort(e){this._distort.value=e}get radius(){return this._radius.value}set radius(e){this._radius.value=e}}const Vj=v.forwardRef(({speed:t=1,...e},n)=>{const[r]=v.useState(()=>new Gme);return Yt(i=>r&&(r.time=i.clock.getElapsedTime()*t)),v.createElement("primitive",It({object:r,ref:n,attach:"material"},e))});class jme extends Ka{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader=`
      uniform float time;
      uniform float factor;
      ${e.vertexShader}
    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>",`float theta = sin( time + position.y ) / 2.0 * factor;
        float c = cos( theta );
        float s = sin( theta );
        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );
        vec3 transformed = vec3( position ) * m;
        vNormal = vNormal * m;`)}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const Wj=v.forwardRef(({speed:t=1,...e},n)=>{const[r]=v.useState(()=>new jme);return Yt(i=>r&&(r.time=i.clock.getElapsedTime()*t)),v.createElement("primitive",It({object:r,ref:n,attach:"material"},e))});class Vme extends yr{constructor(e=new Ke){super({uniforms:{inputBuffer:new Js(null),depthBuffer:new Js(null),resolution:new Js(new Ke),texelSize:new Js(new Ke),halfTexelSize:new Js(new Ke),kernel:new Js(0),scale:new Js(1),cameraNear:new Js(0),cameraFar:new Js(1),minDepthThreshold:new Js(0),maxDepthThreshold:new Js(1),depthScale:new Js(0),depthToBlurRatioBias:new Js(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:$a,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,n){this.uniforms.texelSize.value.set(e,n),this.uniforms.halfTexelSize.value.set(e,n).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class Wme{constructor({gl:e,resolution:n,width:r=500,height:i=500,minDepthThreshold:s=0,maxDepthThreshold:o=1,depthScale:a=0,depthToBlurRatioBias:l=.25}){this.renderToScreen=!1,this.renderTargetA=new fr(n,n,{minFilter:Pn,magFilter:Pn,stencilBuffer:!1,depthBuffer:!1,type:ti}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Vme,this.convolutionMaterial.setTexelSize(1/r,1/i),this.convolutionMaterial.setResolution(new Ke(r,i)),this.scene=new ls,this.camera=new Om,this.convolutionMaterial.uniforms.minDepthThreshold.value=s,this.convolutionMaterial.uniforms.maxDepthThreshold.value=o,this.convolutionMaterial.uniforms.depthScale.value=a,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=l,this.convolutionMaterial.defines.USE_DEPTH=a>0;const c=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),u=new Float32Array([0,0,2,0,0,2]),f=new gn;f.setAttribute("position",new fn(c,3)),f.setAttribute("uv",new fn(u,2)),this.screen=new ln(f,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,n,r){const i=this.scene,s=this.camera,o=this.renderTargetA,a=this.renderTargetB;let l=this.convolutionMaterial,c=l.uniforms;c.depthBuffer.value=n.depthTexture;const u=l.kernel;let f=n,d,h,p;for(h=0,p=u.length-1;h<p;++h)d=h&1?a:o,c.kernel.value=u[h],c.inputBuffer.value=f.texture,e.setRenderTarget(d),e.render(i,s),f=d;c.kernel.value=u[h],c.inputBuffer.value=f.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(i,s)}}let $me=class extends Ka{constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}onBeforeCompile(e){var n;(n=e.defines)!=null&&n.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),e.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
			  uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}};const $j=v.forwardRef(({mixBlur:t=0,mixStrength:e=1,resolution:n=256,blur:r=[0,0],minDepthThreshold:i=.9,maxDepthThreshold:s=1,depthScale:o=0,depthToBlurRatioBias:a=.25,mirror:l=0,distortion:c=1,mixContrast:u=1,distortionMap:f,reflectorOffset:d=0,...h},p)=>{Gi({MeshReflectorMaterialImpl:$me});const m=At(({gl:P})=>P),g=At(({camera:P})=>P),y=At(({scene:P})=>P);r=Array.isArray(r)?r:[r,r];const x=r[0]+r[1]>0,_=v.useRef(null);v.useImperativeHandle(p,()=>_.current,[]);const[w]=v.useState(()=>new Oi),[T]=v.useState(()=>new $),[S]=v.useState(()=>new $),[C]=v.useState(()=>new $),[A]=v.useState(()=>new et),[R]=v.useState(()=>new $(0,0,-1)),[M]=v.useState(()=>new Hn),[D]=v.useState(()=>new $),[k]=v.useState(()=>new $),[L]=v.useState(()=>new Hn),[N]=v.useState(()=>new et),[z]=v.useState(()=>new Ar),O=v.useCallback(()=>{var P;const se=_.current.parent||((P=_.current)==null?void 0:P.__r3f.parent);if(!se||(S.setFromMatrixPosition(se.matrixWorld),C.setFromMatrixPosition(g.matrixWorld),A.extractRotation(se.matrixWorld),T.set(0,0,1),T.applyMatrix4(A),S.addScaledVector(T,d),D.subVectors(S,C),D.dot(T)>0))return;D.reflect(T).negate(),D.add(S),A.extractRotation(g.matrixWorld),R.set(0,0,-1),R.applyMatrix4(A),R.add(C),k.subVectors(S,R),k.reflect(T).negate(),k.add(S),z.position.copy(D),z.up.set(0,1,0),z.up.applyMatrix4(A),z.up.reflect(T),z.lookAt(k),z.far=g.far,z.updateMatrixWorld(),z.projectionMatrix.copy(g.projectionMatrix),N.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),N.multiply(z.projectionMatrix),N.multiply(z.matrixWorldInverse),N.multiply(se.matrixWorld),w.setFromNormalAndCoplanarPoint(T,S),w.applyMatrix4(z.matrixWorldInverse),M.set(w.normal.x,w.normal.y,w.normal.z,w.constant);const ue=z.projectionMatrix;L.x=(Math.sign(M.x)+ue.elements[8])/ue.elements[0],L.y=(Math.sign(M.y)+ue.elements[9])/ue.elements[5],L.z=-1,L.w=(1+ue.elements[10])/ue.elements[14],M.multiplyScalar(2/M.dot(L)),ue.elements[2]=M.x,ue.elements[6]=M.y,ue.elements[10]=M.z+1,ue.elements[14]=M.w},[g,d]),[K,V,ne,re]=v.useMemo(()=>{const P={minFilter:Pn,magFilter:Pn,type:ti},se=new fr(n,n,P);se.depthBuffer=!0,se.depthTexture=new Bm(n,n),se.depthTexture.format=sf,se.depthTexture.type=df;const ue=new fr(n,n,P),te=new Wme({gl:m,resolution:n,width:r[0],height:r[1],minDepthThreshold:i,maxDepthThreshold:s,depthScale:o,depthToBlurRatioBias:a}),W={mirror:l,textureMatrix:N,mixBlur:t,tDiffuse:se.texture,tDepth:se.depthTexture,tDiffuseBlur:ue.texture,hasBlur:x,mixStrength:e,minDepthThreshold:i,maxDepthThreshold:s,depthScale:o,depthToBlurRatioBias:a,distortion:c,distortionMap:f,mixContrast:u,"defines-USE_BLUR":x?"":void 0,"defines-USE_DEPTH":o>0?"":void 0,"defines-USE_DISTORTION":f?"":void 0};return[se,ue,te,W]},[m,r,N,n,l,x,t,e,i,s,o,a,c,f,u]);return Yt(()=>{var P;const se=_.current.parent||((P=_.current)==null?void 0:P.__r3f.parent);if(!se)return;se.visible=!1;const ue=m.xr.enabled,te=m.shadowMap.autoUpdate;O(),m.xr.enabled=!1,m.shadowMap.autoUpdate=!1,m.setRenderTarget(K),m.state.buffers.depth.setMask(!0),m.autoClear||m.clear(),m.render(y,z),x&&ne.render(m,K,V),m.xr.enabled=ue,m.shadowMap.autoUpdate=te,se.visible=!0,m.setRenderTarget(null)}),v.createElement("meshReflectorMaterialImpl",It({attach:"material",key:"key"+re["defines-USE_BLUR"]+re["defines-USE_DEPTH"]+re["defines-USE_DISTORTION"],ref:_},re,h))}),Xme=Ml({envMap:null,bounces:3,ior:2.4,correctMips:!0,aberrationStrength:.01,fresnel:0,bvh:new Lj,color:new wt("white"),opacity:1,resolution:new Ke,viewMatrixInverse:new et,projectionMatrixInverse:new et},`
  uniform mat4 viewMatrixInverse;

  varying vec3 vWorldPosition;
  varying vec3 vNormal;
  varying mat4 vModelMatrixInverse;

  #include <color_pars_vertex>

  void main() {
    #include <color_vertex>

    vec4 transformedNormal = vec4(normal, 0.0);
    vec4 transformedPosition = vec4(position, 1.0);
    #ifdef USE_INSTANCING
      transformedNormal = instanceMatrix * transformedNormal;
      transformedPosition = instanceMatrix * transformedPosition;
    #endif

    #ifdef USE_INSTANCING
      vModelMatrixInverse = inverse(modelMatrix * instanceMatrix);
    #else
      vModelMatrixInverse = inverse(modelMatrix);
    #endif

    vWorldPosition = (modelMatrix * transformedPosition).xyz;
    vNormal = normalize((viewMatrixInverse * vec4(normalMatrix * transformedNormal.xyz, 0.0)).xyz);
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * transformedPosition;
  }`,`
  #define ENVMAP_TYPE_CUBE_UV
  precision highp isampler2D;
  precision highp usampler2D;
  varying vec3 vWorldPosition;
  varying vec3 vNormal;
  varying mat4 vModelMatrixInverse;

  #include <color_pars_fragment>

  #ifdef ENVMAP_TYPE_CUBEM
    uniform samplerCube envMap;
  #else
    uniform sampler2D envMap;
  #endif

  uniform float bounces;
  ${Cme}
  ${Rme}
  uniform BVH bvh;
  uniform float ior;
  uniform bool correctMips;
  uniform vec2 resolution;
  uniform float fresnel;
  uniform mat4 modelMatrix;
  uniform mat4 projectionMatrixInverse;
  uniform mat4 viewMatrixInverse;
  uniform float aberrationStrength;
  uniform vec3 color;
  uniform float opacity;

  float fresnelFunc(vec3 viewDirection, vec3 worldNormal) {
    return pow( 1.0 + dot( viewDirection, worldNormal), 10.0 );
  }

  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 normal, float ior, mat4 modelMatrixInverse) {
    vec3 rayOrigin = ro;
    vec3 rayDirection = rd;
    rayDirection = refract(rayDirection, normal, 1.0 / ior);
    rayOrigin = vWorldPosition + rayDirection * 0.001;
    rayOrigin = (modelMatrixInverse * vec4(rayOrigin, 1.0)).xyz;
    rayDirection = normalize((modelMatrixInverse * vec4(rayDirection, 0.0)).xyz);
    for(float i = 0.0; i < bounces; i++) {
      uvec4 faceIndices = uvec4( 0u );
      vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );
      vec3 barycoord = vec3( 0.0 );
      float side = 1.0;
      float dist = 0.0;
      bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );
      vec3 hitPos = rayOrigin + rayDirection * max(dist - 0.001, 0.0);
      vec3 tempDir = refract(rayDirection, faceNormal, ior);
      if (length(tempDir) != 0.0) {
        rayDirection = tempDir;
        break;
      }
      rayDirection = reflect(rayDirection, faceNormal);
      rayOrigin = hitPos + rayDirection * 0.01;
    }
    rayDirection = normalize((modelMatrix * vec4(rayDirection, 0.0)).xyz);
    return rayDirection;
  }

  #include <common>
  #include <cube_uv_reflection_fragment>

  #ifdef ENVMAP_TYPE_CUBEM
    vec4 textureGradient(samplerCube envMap, vec3 rayDirection, vec3 directionCamPerfect) {
      return textureGrad(envMap, rayDirection, dFdx(correctMips ? directionCamPerfect: rayDirection), dFdy(correctMips ? directionCamPerfect: rayDirection));
    }
  #else
    vec4 textureGradient(sampler2D envMap, vec3 rayDirection, vec3 directionCamPerfect) {
      vec2 uvv = equirectUv( rayDirection );
      vec2 smoothUv = equirectUv( directionCamPerfect );
      return textureGrad(envMap, uvv, dFdx(correctMips ? smoothUv : uvv), dFdy(correctMips ? smoothUv : uvv));
    }
  #endif

  void main() {
    vec2 uv = gl_FragCoord.xy / resolution;
    vec3 directionCamPerfect = (projectionMatrixInverse * vec4(uv * 2.0 - 1.0, 0.0, 1.0)).xyz;
    directionCamPerfect = (viewMatrixInverse * vec4(directionCamPerfect, 0.0)).xyz;
    directionCamPerfect = normalize(directionCamPerfect);
    vec3 normal = vNormal;
    vec3 rayOrigin = cameraPosition;
    vec3 rayDirection = normalize(vWorldPosition - cameraPosition);

    vec4 diffuseColor = vec4(color, opacity);
    #include <color_fragment>

    #ifdef CHROMATIC_ABERRATIONS
      vec3 rayDirectionG = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);
      #ifdef FAST_CHROMA
        vec3 rayDirectionR = normalize(rayDirectionG + 1.0 * vec3(aberrationStrength / 2.0));
        vec3 rayDirectionB = normalize(rayDirectionG - 1.0 * vec3(aberrationStrength / 2.0));
      #else
        vec3 rayDirectionR = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 - aberrationStrength), 1.0), vModelMatrixInverse);
        vec3 rayDirectionB = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 + aberrationStrength), 1.0), vModelMatrixInverse);
      #endif
      float finalColorR = textureGradient(envMap, rayDirectionR, directionCamPerfect).r;
      float finalColorG = textureGradient(envMap, rayDirectionG, directionCamPerfect).g;
      float finalColorB = textureGradient(envMap, rayDirectionB, directionCamPerfect).b;
      diffuseColor.rgb *= vec3(finalColorR, finalColorG, finalColorB);
    #else
      rayDirection = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);
      diffuseColor.rgb *= textureGradient(envMap, rayDirection, directionCamPerfect).rgb;
    #endif

    vec3 viewDirection = normalize(vWorldPosition - cameraPosition);
    float nFresnel = fresnelFunc(viewDirection, normal) * fresnel;
    gl_FragColor = vec4(mix(diffuseColor.rgb, vec3(1.0), nFresnel), diffuseColor.a);

    #include <tonemapping_fragment>
    #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
  }`),qme=t=>t&&t.isCubeTexture;function Xj({aberrationStrength:t=0,fastChroma:e=!0,envMap:n,...r}){Gi({MeshRefractionMaterial:Xme});const i=v.useRef(),{size:s}=At(),o=v.useMemo(()=>{var a,l;const c={},u=qme(n),d=((a=u?(l=n.image[0])==null?void 0:l.width:n.image.width)!==null&&a!==void 0?a:1024)/4,h=Math.floor(Math.log2(d)),p=Math.pow(2,h),m=3*Math.max(p,16*7),g=4*p;return u&&(c.ENVMAP_TYPE_CUBEM=""),c.CUBEUV_TEXEL_WIDTH=`${1/m}`,c.CUBEUV_TEXEL_HEIGHT=`${1/g}`,c.CUBEUV_MAX_MIP=`${h}.0`,t>0&&(c.CHROMATIC_ABERRATIONS=""),e&&(c.FAST_CHROMA=""),c},[t,e]);return v.useLayoutEffect(()=>{var a;const l=(a=i.current)==null||(a=a.__r3f)==null||(a=a.parent)==null?void 0:a.geometry;l&&(i.current.bvh=new Lj,i.current.bvh.updateFrom(new oE(l.clone().toNonIndexed(),{strategy:rE})))},[]),Yt(({camera:a})=>{i.current.viewMatrixInverse=a.matrixWorld,i.current.projectionMatrixInverse=a.projectionMatrixInverse}),v.createElement("meshRefractionMaterial",It({key:JSON.stringify(o),defines:o,ref:i,resolution:[s.width,s.height],aberrationStrength:t,envMap:n},r))}const wC=Ml({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class Yme extends Ur{constructor(e=6,n=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new wt("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=r=>{r.uniforms={...r.uniforms,...this.uniforms},this.anisotropy>0&&(r.defines.USE_ANISOTROPY=""),n?r.defines.USE_SAMPLER="":r.defines.USE_TRANSMISSION="",r.fragmentShader=`
      uniform float chromaticAberration;         
      uniform float anisotropicBlur;      
      uniform float time;
      uniform float distortion;
      uniform float distortionScale;
      uniform float temporalDistortion;
      uniform sampler2D buffer;

      vec3 random3(vec3 c) {
        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
        vec3 r;
        r.z = fract(512.0*j);
        j *= .125;
        r.x = fract(512.0*j);
        j *= .125;
        r.y = fract(512.0*j);
        return r-0.5;
      }

      uint hash( uint x ) {
        x += ( x << 10u );
        x ^= ( x >>  6u );
        x += ( x <<  3u );
        x ^= ( x >> 11u );
        x += ( x << 15u );
        return x;
      }

      // Compound versions of the hashing algorithm I whipped together.
      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }
      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }
      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }

      // Construct a float with half-open range [0:1] using low 23 bits.
      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.
      float floatConstruct( uint m ) {
        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask
        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32
        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)
        m |= ieeeOne;                          // Add fractional part to 1.0
        float  f = uintBitsToFloat( m );       // Range [1:2]
        return f - 1.0;                        // Range [0:1]
      }

      // Pseudo-random value in half-open range [0:1].
      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }
      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float rand(float seed) {
        float result = randomBase(vec3(gl_FragCoord.xy, seed));
        return result;
      }

      const float F3 =  0.3333333;
      const float G3 =  0.1666667;

      float snoise(vec3 p) {
        vec3 s = floor(p + dot(p, vec3(F3)));
        vec3 x = p - s + dot(s, vec3(G3));
        vec3 e = step(vec3(0.0), x - x.yzx);
        vec3 i1 = e*(1.0 - e.zxy);
        vec3 i2 = 1.0 - e.zxy*(1.0 - e);
        vec3 x1 = x - i1 + G3;
        vec3 x2 = x - i2 + 2.0*G3;
        vec3 x3 = x - 1.0 + 3.0*G3;
        vec4 w, d;
        w.x = dot(x, x);
        w.y = dot(x1, x1);
        w.z = dot(x2, x2);
        w.w = dot(x3, x3);
        w = max(0.6 - w, 0.0);
        d.x = dot(random3(s), x);
        d.y = dot(random3(s + i1), x1);
        d.z = dot(random3(s + i2), x2);
        d.w = dot(random3(s + 1.0), x3);
        w *= w;
        w *= w;
        d *= w;
        return dot(d, vec4(52.0));
      }

      float snoiseFractal(vec3 m) {
        return 0.5333333* snoise(m)
              +0.2666667* snoise(2.0*m)
              +0.1333333* snoise(4.0*m)
              +0.0666667* snoise(8.0*m);
      }
`+r.fragmentShader,r.fragmentShader=r.fragmentShader.replace("#include <transmission_pars_fragment>",`
        #ifdef USE_TRANSMISSION
          // Transmission code is based on glTF-Sampler-Viewer
          // https://github.com/KhronosGroup/glTF-Sample-Viewer
          uniform float _transmission;
          uniform float thickness;
          uniform float attenuationDistance;
          uniform vec3 attenuationColor;
          #ifdef USE_TRANSMISSIONMAP
            uniform sampler2D transmissionMap;
          #endif
          #ifdef USE_THICKNESSMAP
            uniform sampler2D thicknessMap;
          #endif
          uniform vec2 transmissionSamplerSize;
          uniform sampler2D transmissionSamplerMap;
          uniform mat4 modelMatrix;
          uniform mat4 projectionMatrix;
          varying vec3 vWorldPosition;
          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
            // Direction of refracted light.
            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
            // Compute rotation-independant scaling of the model matrix.
            vec3 modelScale;
            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
            // The thickness is specified in local space.
            return normalize( refractionVector ) * thickness * modelScale;
          }
          float applyIorToRoughness( const in float roughness, const in float ior ) {
            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
            // an IOR of 1.5 results in the default amount of microfacet refraction.
            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
          }
          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            
            #ifdef USE_SAMPLER
              #ifdef texture2DLodEXT
                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);
              #else
                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);
              #endif
            #else
              return texture2D(buffer, fragCoord.xy);
            #endif
          }
          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
            if ( isinf( attenuationDistance ) ) {
              // Attenuation distance is +, i.e. the transmitted color is not attenuated at all.
              return radiance;
            } else {
              // Compute light attenuation using Beer's law.
              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
              return transmittance * radiance;
            }
          }
          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
            const in vec3 attenuationColor, const in float attenuationDistance ) {
            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
            vec3 refractedRayExit = position + transmissionRay;
            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
            vec2 refractionCoords = ndcPos.xy / ndcPos.w;
            refractionCoords += 1.0;
            refractionCoords /= 2.0;
            // Sample framebuffer to get pixel the refracted ray hits.
            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
            // Get the specular component.
            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
          }
        #endif
`),r.fragmentShader=r.fragmentShader.replace("#include <transmission_fragment>",`  
        // Improve the refraction to use the world pos
        material.transmission = _transmission;
        material.transmissionAlpha = 1.0;
        material.thickness = thickness;
        material.attenuationDistance = attenuationDistance;
        material.attenuationColor = attenuationColor;
        #ifdef USE_TRANSMISSIONMAP
          material.transmission *= texture2D( transmissionMap, vUv ).r;
        #endif
        #ifdef USE_THICKNESSMAP
          material.thickness *= texture2D( thicknessMap, vUv ).g;
        #endif
        
        vec3 pos = vWorldPosition;
        float runningSeed = 0.0;
        vec3 v = normalize( cameraPosition - pos );
        vec3 n = inverseTransformDirection( normal, viewMatrix );
        vec3 transmission = vec3(0.0);
        float transmissionR, transmissionB, transmissionG;
        float randomCoords = rand(runningSeed++);
        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);
        vec3 distortionNormal = vec3(0.0);
        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;
        if (distortion > 0.0) {
          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));
        }
        for (float i = 0.0; i < ${e}.0; i ++) {
          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);
          transmissionR = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(${e}),
            material.attenuationColor, material.attenuationDistance
          ).r;
          transmissionG = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(${e})) , material.thickness + thickness_smear * (i + randomCoords) / float(${e}),
            material.attenuationColor, material.attenuationDistance
          ).g;
          transmissionB = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(${e})), material.thickness + thickness_smear * (i + randomCoords) / float(${e}),
            material.attenuationColor, material.attenuationDistance
          ).b;
          transmission.r += transmissionR;
          transmission.g += transmissionG;
          transmission.b += transmissionB;
        }
        transmission /= ${e}.0;
        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
`)},Object.keys(this.uniforms).forEach(r=>Object.defineProperty(this,r,{get:()=>this.uniforms[r].value,set:i=>this.uniforms[r].value=i}))}}const qj=v.forwardRef(({buffer:t,transmissionSampler:e=!1,backside:n=!1,side:r=Cs,transmission:i=1,thickness:s=0,backsideThickness:o=0,backsideEnvMapIntensity:a=1,samples:l=10,resolution:c,backsideResolution:u,background:f,anisotropy:d,anisotropicBlur:h,...p},m)=>{Gi({MeshTransmissionMaterial:Yme});const g=v.useRef(null),[y]=v.useState(()=>new wC),x=Mo(u||c),_=Mo(c);let w,T,S,C;return Yt(A=>{g.current.time=A.clock.getElapsedTime(),g.current.buffer===_.texture&&!e&&(C=g.current.__r3f.parent,C&&(S=A.gl.toneMapping,w=A.scene.background,T=g.current.envMapIntensity,A.gl.toneMapping=Xa,f&&(A.scene.background=f),C.material=y,n&&(A.gl.setRenderTarget(x),A.gl.render(A.scene,A.camera),C.material=g.current,C.material.buffer=x.texture,C.material.thickness=o,C.material.side=zi,C.material.envMapIntensity=a),A.gl.setRenderTarget(_),A.gl.render(A.scene,A.camera),C.material=g.current,C.material.thickness=s,C.material.side=r,C.material.buffer=_.texture,C.material.envMapIntensity=T,A.scene.background=w,A.gl.setRenderTarget(null),A.gl.toneMapping=S))}),v.useImperativeHandle(m,()=>g.current,[]),v.createElement("meshTransmissionMaterial",It({args:[l,e],ref:g},p,{buffer:t||_.texture,_transmission:i,anisotropicBlur:h??d,transmission:e?i:0,thickness:s,side:r}))}),Yj=v.forwardRef((t,e)=>(Gi({DiscardMaterialImpl:wC}),v.createElement("discardMaterialImpl",It({ref:e},t)))),Q4=Ro>=154?"opaque_fragment":"output_fragment";class Kme extends Ha{constructor(e){super(e),this.onBeforeCompile=(n,r)=>{const{isWebGL2:i}=r.capabilities;n.fragmentShader=n.fragmentShader.replace(`#include <${Q4}>`,`
        ${i?`#include <${Q4}>`:`#extension GL_OES_standard_derivatives : enable
#include <${Q4}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const Kj=v.forwardRef((t,e)=>{const[n]=v.useState(()=>new Kme(null));return v.createElement("primitive",It({},t,{object:n,ref:e,attach:"material"}))}),Zme=({focus:t=0,size:e=25,samples:n=10}={})=>`
#define PENUMBRA_FILTER_SIZE float(${e})
#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))
vec3 randRGB(vec2 uv) {
  return vec3(
    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),
    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),
    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)
  );
}

vec3 lowPassRandRGB(vec2 uv) {
  // 3x3 convolution (average)
  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9
  vec3 result = vec3(0);
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));
  result *= 0.111111111; // 1.0 / 9.0
  return result;
}
vec3 highPassRandRGB(vec2 uv) {
  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal
  // hp(x) = x - lp(x)
  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;
}


vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}
float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation
  return (zReceiver - zBlocker) / zBlocker;
}
float findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float blockerDepthSum = float(${t});
  float blockers = 0.0;

  int j = 0;
  vec2 offset = vec2(0.);
  float depth = 0.;

  #pragma unroll_loop_start
  for(int i = 0; i < ${n}; i ++) {
    offset = (vogelDiskSample(j, ${n}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;
    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));
    if (depth < compare) {
      blockerDepthSum += depth;
      blockers++;
    }
    j++;
  }
  #pragma unroll_loop_end

  if (blockers > 0.0) {
    return blockerDepthSum / blockers;
  }
  return -1.0;
}

        
float vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float shadow = 0.0f;
  int j = 0;
  vec2 vogelSample = vec2(0.0);
  vec2 offset = vec2(0.0);
  #pragma unroll_loop_start
  for (int i = 0; i < ${n}; i++) {
    vogelSample = vogelDiskSample(j, ${n}, angle) * texelSize;
    offset = vogelSample * (1.0 + filterRadius * float(${e}));
    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    j++;
  }
  #pragma unroll_loop_end
  return shadow * 1.0 / ${n}.0;
}

float PCSS (sampler2D shadowMap, vec4 coords) {
  vec2 uv = coords.xy;
  float zReceiver = coords.z; // Assumed to be eye-space z in this code
  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;
  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);
  if (avgBlockerDepth == -1.0) {
    return 1.0;
  }
  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);
  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);
}`;function gL(t,e,n){e.traverse(r=>{r.material&&(t.properties.remove(r.material),r.material.dispose==null||r.material.dispose())}),t.info.programs.length=0,t.compile(e,n)}function Zj({focus:t=0,samples:e=10,size:n=25}){const r=At(o=>o.gl),i=At(o=>o.scene),s=At(o=>o.camera);return v.useEffect(()=>{const o=Fn.shadowmap_pars_fragment;return Fn.shadowmap_pars_fragment=Fn.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP",`#ifdef USE_SHADOWMAP
`+Zme({size:n,samples:e,focus:t})).replace("#if defined( SHADOWMAP_TYPE_PCF )",`
return PCSS(shadowMap, shadowCoord);
#if defined( SHADOWMAP_TYPE_PCF )`),gL(r,i,s),()=>{Fn.shadowmap_pars_fragment=o,gL(r,i,s)}},[t,n,e]),null}function fs(t,e){const n=t+"Geometry";return v.forwardRef(({args:r,children:i,...s},o)=>{const a=v.useRef(null);return v.useImperativeHandle(o,()=>a.current),v.useLayoutEffect(()=>void(e==null?void 0:e(a.current))),v.createElement("mesh",It({ref:a},s),v.createElement(n,{attach:"geometry",args:r}),i)})}const w$e=fs("box"),S$e=fs("circle"),T$e=fs("cone"),A$e=fs("cylinder"),SC=fs("sphere"),Qme=fs("plane"),M$e=fs("tube"),C$e=fs("torus"),R$e=fs("torusKnot"),I$e=fs("tetrahedron"),P$e=fs("ring"),k$e=fs("polyhedron"),L$e=fs("icosahedron"),D$e=fs("octahedron"),N$e=fs("dodecahedron"),O$e=fs("extrude"),F$e=fs("lathe"),U$e=fs("capsule"),B$e=fs("shape",({geometry:t})=>{const e=t.attributes.position,n=new Kn().setFromBufferAttribute(e),r=new $;n.getSize(r);const i=[];let s=0,o=0,a=0,l=0;for(let c=0;c<e.count;c++)s=e.getX(c),o=e.getY(c),a=(s-n.min.x)/r.x,l=(o-n.min.y)/r.y,i.push(a,l);t.setAttribute("uv",new Dt(i,2))}),Gl=1e-5;function Jme(t,e,n){const r=new tc,i=n-Gl;return r.absarc(Gl,Gl,Gl,-Math.PI/2,-Math.PI,!0),r.absarc(Gl,e-i*2,Gl,Math.PI,Math.PI/2,!0),r.absarc(t-i*2,e-i*2,Gl,Math.PI/2,0,!0),r.absarc(t-i*2,Gl,Gl,0,-Math.PI/2,!0),r}const Qj=v.forwardRef(function({args:[e=1,n=1,r=1]=[],radius:i=.05,steps:s=1,smoothness:o=4,bevelSegments:a=4,creaseAngle:l=.4,children:c,...u},f){const d=v.useMemo(()=>Jme(e,n,i),[e,n,i]),h=v.useMemo(()=>({depth:r-i*2,bevelEnabled:!0,bevelSegments:a*2,steps:s,bevelSize:i-Gl,bevelThickness:i,curveSegments:o}),[r,i,o]),p=v.useRef(null);return v.useLayoutEffect(()=>{p.current&&(p.current.center(),hG(p.current,l))},[d,h]),v.createElement("mesh",It({ref:f},u),v.createElement("extrudeGeometry",{ref:p,args:[d,h]}),c)});function e0e(){const t=new gn,e=new Float32Array([-1,-1,3,-1,-1,3]);return t.boundingSphere=new wr,t.boundingSphere.set(new $,1/0),t.setAttribute("position",new fn(e,2)),t}const Jj=v.forwardRef(function({children:e,...n},r){const i=v.useMemo(e0e,[]);return v.createElement("mesh",It({ref:r,geometry:i,frustumCulled:!1},n),e)}),eV=v.forwardRef(({children:t,width:e,height:n,depth:r,box3:i,precise:s=!0,...o},a)=>{const l=v.useRef(null),c=v.useRef(null),u=v.useRef(null);return v.useLayoutEffect(()=>{c.current.matrixWorld.identity();let f=i||new Kn().setFromObject(u.current,s);const d=f.max.x-f.min.x,h=f.max.y-f.min.y,p=f.max.z-f.min.z;let m=Math.max(d,h,p);e&&(m=d),n&&(m=h),r&&(m=p),c.current.scale.setScalar(1/m)},[e,n,r,i,s]),v.useImperativeHandle(a,()=>l.current,[]),v.createElement("group",It({ref:l},o),v.createElement("group",{ref:c},v.createElement("group",{ref:u},t)))});var Ia=function(t){return t[t.NONE=0]="NONE",t[t.START=1]="START",t[t.ACTIVE=2]="ACTIVE",t}(Ia||{});const hp=t=>t&&t.isOrthographicCamera,t0e=t=>t&&t.isBox3,n0e=t=>1-Math.exp(-5*t)+.007*t,tV=v.createContext(null);function TC({children:t,maxDuration:e=1,margin:n=1.2,observe:r,fit:i,clip:s,interpolateFunc:o=n0e,onFit:a}){const l=v.useRef(null),{camera:c,size:u,invalidate:f}=At(),d=At(T=>T.controls),h=v.useRef(a);h.current=a;const p=v.useRef({camPos:new $,camRot:new bn,camZoom:1}),m=v.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),g=v.useRef(Ia.NONE),y=v.useRef(0),[x]=v.useState(()=>new Kn),_=v.useMemo(()=>{function T(){const S=x.getSize(new $),C=x.getCenter(new $),A=Math.max(S.x,S.y,S.z),R=hp(c)?A*4:A/(2*Math.atan(Math.PI*c.fov/360)),M=hp(c)?A*4:R/c.aspect,D=n*Math.max(R,M);return{box:x,size:S,center:C,distance:D}}return{getSize:T,refresh(S){if(t0e(S))x.copy(S);else{const C=S||l.current;if(!C)return this;C.updateWorldMatrix(!0,!0),x.setFromObject(C)}if(x.isEmpty()){const C=c.position.length()||10;x.setFromCenterAndSize(new $,new $(C,C,C))}return p.current.camPos.copy(c.position),p.current.camRot.copy(c.quaternion),hp(c)&&(p.current.camZoom=c.zoom),m.current.camPos=void 0,m.current.camRot=void 0,m.current.camZoom=void 0,m.current.camUp=void 0,m.current.target=void 0,this},reset(){const{center:S,distance:C}=T(),A=c.position.clone().sub(S).normalize();m.current.camPos=S.clone().addScaledVector(A,C),m.current.target=S.clone();const R=new et().lookAt(m.current.camPos,m.current.target,c.up);return m.current.camRot=new bn().setFromRotationMatrix(R),g.current=Ia.START,y.current=0,this},moveTo(S){return m.current.camPos=Array.isArray(S)?new $(...S):S.clone(),g.current=Ia.START,y.current=0,this},lookAt({target:S,up:C}){m.current.target=Array.isArray(S)?new $(...S):S.clone(),C?m.current.camUp=Array.isArray(C)?new $(...C):C.clone():m.current.camUp=c.up.clone();const A=new et().lookAt(m.current.camPos||c.position,m.current.target,m.current.camUp);return m.current.camRot=new bn().setFromRotationMatrix(A),g.current=Ia.START,y.current=0,this},to({position:S,target:C}){return this.moveTo(S).lookAt({target:C})},fit(){if(!hp(c))return this.reset();let S=0,C=0;const A=[new $(x.min.x,x.min.y,x.min.z),new $(x.min.x,x.max.y,x.min.z),new $(x.min.x,x.min.y,x.max.z),new $(x.min.x,x.max.y,x.max.z),new $(x.max.x,x.max.y,x.max.z),new $(x.max.x,x.max.y,x.min.z),new $(x.max.x,x.min.y,x.max.z),new $(x.max.x,x.min.y,x.min.z)],R=m.current.camPos||c.position,M=m.current.target||(d==null?void 0:d.target),D=m.current.camUp||c.up,k=M?new et().lookAt(R,M,D).setPosition(R).invert():c.matrixWorldInverse;for(const z of A)z.applyMatrix4(k),S=Math.max(S,Math.abs(z.y)),C=Math.max(C,Math.abs(z.x));S*=2,C*=2;const L=(c.top-c.bottom)/S,N=(c.right-c.left)/C;return m.current.camZoom=Math.min(L,N)/n,g.current=Ia.START,y.current=0,h.current&&h.current(this.getSize()),this},clip(){const{distance:S}=T();return c.near=S/100,c.far=S*100,c.updateProjectionMatrix(),d&&(d.maxDistance=S*10,d.update()),f(),this}}},[x,c,d,n,f]);v.useLayoutEffect(()=>{if(d){const T=()=>{if(d&&m.current.target&&g.current!==Ia.NONE){const S=new $().setFromMatrixColumn(c.matrix,2),C=p.current.camPos.distanceTo(d.target),A=(m.current.camPos||p.current.camPos).distanceTo(m.current.target),R=(1-y.current)*C+y.current*A;d.target.copy(c.position).addScaledVector(S,-R),d.update()}g.current=Ia.NONE};return d.addEventListener("start",T),()=>d.removeEventListener("start",T)}},[d]);const w=v.useRef(0);return v.useLayoutEffect(()=>{(r||w.current++===0)&&(_.refresh(),i&&_.reset().fit(),s&&_.clip())},[u,s,i,r,c,d]),Yt((T,S)=>{if(g.current===Ia.START)g.current=Ia.ACTIVE,f();else if(g.current===Ia.ACTIVE){if(y.current+=S/e,y.current>=1)m.current.camPos&&c.position.copy(m.current.camPos),m.current.camRot&&c.quaternion.copy(m.current.camRot),m.current.camUp&&c.up.copy(m.current.camUp),m.current.camZoom&&hp(c)&&(c.zoom=m.current.camZoom),c.updateMatrixWorld(),c.updateProjectionMatrix(),d&&m.current.target&&(d.target.copy(m.current.target),d.update()),g.current=Ia.NONE;else{const C=o(y.current);m.current.camPos&&c.position.lerpVectors(p.current.camPos,m.current.camPos,C),m.current.camRot&&c.quaternion.slerpQuaternions(p.current.camRot,m.current.camRot,C),m.current.camUp&&c.up.set(0,1,0).applyQuaternion(c.quaternion),m.current.camZoom&&hp(c)&&(c.zoom=(1-C)*p.current.camZoom+C*m.current.camZoom),c.updateMatrixWorld(),c.updateProjectionMatrix()}f()}}),v.createElement("group",{ref:l},v.createElement(tV.Provider,{value:_},t))}function r0e(){return v.useContext(tV)}const nV=v.forwardRef(({intensity:t=1,decay:e,decayRate:n=.65,maxYaw:r=.1,maxPitch:i=.1,maxRoll:s=.1,yawFrequency:o=.1,pitchFrequency:a=.1,rollFrequency:l=.1},c)=>{const u=At(x=>x.camera),f=At(x=>x.controls),d=v.useRef(t),h=v.useRef(u.rotation.clone()),[p]=v.useState(()=>new x4),[m]=v.useState(()=>new x4),[g]=v.useState(()=>new x4),y=()=>{(d.current<0||d.current>1)&&(d.current=d.current<0?0:1)};return v.useImperativeHandle(c,()=>({getIntensity:()=>d.current,setIntensity:x=>{d.current=x,y()}}),[]),v.useEffect(()=>{if(f){const x=()=>void(h.current=u.rotation.clone());return f.addEventListener("change",x),x(),()=>void f.removeEventListener("change",x)}},[u,f]),Yt((x,_)=>{const w=Math.pow(d.current,2),T=r*w*p.noise(x.clock.elapsedTime*o,1),S=i*w*m.noise(x.clock.elapsedTime*a,1),C=s*w*g.noise(x.clock.elapsedTime*l,1);u.rotation.set(h.current.x+S,h.current.y+T,h.current.z+C),e&&d.current>0&&(d.current-=n*_,y())}),null}),rV=v.forwardRef(({children:t,enabled:e=!0,speed:n=1,rotationIntensity:r=1,floatIntensity:i=1,floatingRange:s=[-.1,.1],autoInvalidate:o=!1,...a},l)=>{const c=v.useRef(null);v.useImperativeHandle(l,()=>c.current,[]);const u=v.useRef(Math.random()*1e4);return Yt(f=>{var d,h;if(!e||n===0)return;o&&f.invalidate();const p=u.current+f.clock.getElapsedTime();c.current.rotation.x=Math.cos(p/4*n)/8*r,c.current.rotation.y=Math.sin(p/4*n)/8*r,c.current.rotation.z=Math.sin(p/4*n)/20*r;let m=Math.sin(p/4*n)/10;m=ri.mapLinear(m,-.1,.1,(d=s==null?void 0:s[0])!==null&&d!==void 0?d:-.1,(h=s==null?void 0:s[1])!==null&&h!==void 0?h:.1),c.current.position.y=m*i,c.current.updateMatrix()}),v.createElement("group",a,v.createElement("group",{ref:c,matrixAutoUpdate:!1},t))}),iV=(t,e,n)=>{let r;switch(t){case Rs:r=new Uint8ClampedArray(e*n*4);break;case ti:r=new Uint16Array(e*n*4);break;case io:r=new Uint32Array(e*n*4);break;case mm:r=new Int8Array(e*n*4);break;case hy:r=new Int16Array(e*n*4);break;case rf:r=new Int32Array(e*n*4);break;case pr:r=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return r};let fx;const i0e=(t,e,n,r)=>{if(fx!==void 0)return fx;const i=new fr(1,1,r);e.setRenderTarget(i);const s=new ln(new Ps,new Fr({color:16777215}));e.render(s,n),e.setRenderTarget(null);const o=iV(t,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,o),i.dispose(),s.geometry.dispose(),s.material.dispose(),fx=o[0]!==0,fx};class AC{constructor(e){var n,r,i,s,o,a,l,c,u,f,d,h,p,m,g,y;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(_){throw this._renderer.setRenderTarget(null),_}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const x={format:Pr,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy)!==void 0?(r=e.renderTargetOptions)===null||r===void 0?void 0:r.anisotropy:1,generateMipmaps:((i=e.renderTargetOptions)===null||i===void 0?void 0:i.generateMipmaps)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps:!1,magFilter:((o=e.renderTargetOptions)===null||o===void 0?void 0:o.magFilter)!==void 0?(a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter:Pn,minFilter:((l=e.renderTargetOptions)===null||l===void 0?void 0:l.minFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.minFilter:Pn,samples:((u=e.renderTargetOptions)===null||u===void 0?void 0:u.samples)!==void 0?(f=e.renderTargetOptions)===null||f===void 0?void 0:f.samples:void 0,wrapS:((d=e.renderTargetOptions)===null||d===void 0?void 0:d.wrapS)!==void 0?(h=e.renderTargetOptions)===null||h===void 0?void 0:h.wrapS:ei,wrapT:((p=e.renderTargetOptions)===null||p===void 0?void 0:p.wrapT)!==void 0?(m=e.renderTargetOptions)===null||m===void 0?void 0:m.wrapT:ei};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=AC.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new ls,this._camera=new Hi,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!i0e(this._type,this._renderer,this._camera,x)){let _;switch(this._type){case ti:_=this._renderer.extensions.has("EXT_color_buffer_float")?pr:void 0;break}_!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${pr}`),this._type=_):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new ln(new Ps,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new fr(this.width,this.height,x),this._renderTarget.texture.mapping=((g=e.renderTargetOptions)===null||g===void 0?void 0:g.mapping)!==void 0?(y=e.renderTargetOptions)===null||y===void 0?void 0:y.mapping:uf}static instantiateRenderer(){const e=new Yb;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=iV(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const n=new As(this.toArray(),this.width,this.height,Pr,this._type,(e==null?void 0:e.mapping)||uf,(e==null?void 0:e.wrapS)||ei,(e==null?void 0:e.wrapT)||ei,(e==null?void 0:e.magFilter)||Pn,(e==null?void 0:e.minFilter)||Pn,(e==null?void 0:e.anisotropy)||1,as);return n.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof yr&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof tr&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof tr&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const s0e=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,o0e=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class a0e extends yr{constructor({gamma:e,offsetHdr:n,offsetSdr:r,gainMapMin:i,gainMapMax:s,maxDisplayBoost:o,hdrCapacityMin:a,hdrCapacityMax:l,sdr:c,gainMap:u}){super({name:"GainMapDecoderMaterial",vertexShader:s0e,fragmentShader:o0e,uniforms:{sdr:{value:c},gainMap:{value:u},gamma:{value:new $(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new $().fromArray(n)},offsetSdr:{value:new $().fromArray(r)},gainMapMin:{value:new $().fromArray(i)},gainMapMax:{value:new $().fromArray(s)},weightFactor:{value:(Math.log2(o)-a)/(l-a)}},blending:$a,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=o,this._hdrCapacityMin=a,this._hdrCapacityMax=l,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const n=this.uniforms.gamma.value;n.x=1/e[0],n.y=1/e[1],n.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class sV extends Error{}class oV extends Error{}const ug=(t,e,n)=>{const r=new RegExp(`${e}="([^"]*)"`,"i").exec(t);if(r)return r[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(t);if(i){const s=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(n!==void 0)return n;throw new Error(`Can't find ${e} in gainmap metadata`)},l0e=t=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(t):e=t.toString();let n=e.indexOf("<x:xmpmeta");for(;n!==-1;){const r=e.indexOf("x:xmpmeta>",n),i=e.slice(n,r+10);try{const s=ug(i,"hdrgm:GainMapMin","0"),o=ug(i,"hdrgm:GainMapMax"),a=ug(i,"hdrgm:Gamma","1"),l=ug(i,"hdrgm:OffsetSDR","0.015625"),c=ug(i,"hdrgm:OffsetHDR","0.015625"),u=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),f=u?u[1]:"0",d=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!d)throw new Error("Incomplete gainmap metadata");const h=d[1];return{gainMapMin:Array.isArray(s)?s.map(p=>parseFloat(p)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(p=>parseFloat(p)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(a)?a.map(p=>parseFloat(p)):[parseFloat(a),parseFloat(a),parseFloat(a)],offsetSdr:Array.isArray(l)?l.map(p=>parseFloat(p)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(p=>parseFloat(p)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(f),hdrCapacityMax:parseFloat(h)}}catch{}n=e.indexOf("<x:xmpmeta",r)}};class c0e{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((n,r)=>{const i=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){r(new Error("Not a valid jpeg"));return}const o=s.byteLength;let a=2,l=0,c;for(;a<o;){if(++l>250){r(new Error(`Found no marker after ${l} loops `));return}if(s.getUint8(a)!==255){r(new Error(`Not a valid marker at offset 0x${a.toString(16)}, found: 0x${s.getUint8(a).toString(16)}`));return}if(c=s.getUint8(a+1),i&&console.log(`Marker: ${c.toString(16)}`),c===226){i&&console.log("Found APP2 marker (0xffe2)");const u=a+4;if(s.getUint32(u)===1297106432){const f=u+4;let d;if(s.getUint16(f)===18761)d=!1;else if(s.getUint16(f)===19789)d=!0;else{r(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(f+2,!d)!==42){r(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const h=s.getUint32(f+4,!d);if(h<8){r(new Error("Not valid TIFF data! (First offset less than 8)"));return}const p=f+h,m=s.getUint16(p,!d),g=p+2;let y=0;for(let T=g;T<g+12*m;T+=12)s.getUint16(T,!d)===45057&&(y=s.getUint32(T+8,!d));const _=p+2+m*12+4,w=[];for(let T=_;T<_+y*16;T+=16){const S={MPType:s.getUint32(T,!d),size:s.getUint32(T+4,!d),dataOffset:s.getUint32(T+8,!d),dependantImages:s.getUint32(T+12,!d),start:-1,end:-1,isFII:!1};S.dataOffset?(S.start=f+S.dataOffset,S.isFII=!1):(S.start=0,S.isFII=!0),S.end=S.start+S.size,w.push(S)}if(this.options.extractNonFII&&w.length){const T=new Blob([s]),S=[];for(const C of w){if(C.isFII&&!this.options.extractFII)continue;const A=T.slice(C.start,C.end+1,"image/jpeg");S.push(A)}n(S)}}}a+=2+s.getUint16(a+2)}})}}const u0e=async t=>{const e=l0e(t);if(!e)throw new oV("Gain map XMP metadata not found");const r=await new c0e({extractFII:!0,extractNonFII:!0}).extract(t);if(r.length!==2)throw new sV("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:e}},yL=t=>new Promise((e,n)=>{const r=document.createElement("img");r.onload=()=>{e(r)},r.onerror=i=>{n(i)},r.src=URL.createObjectURL(t)});class aV extends Br{constructor(e,n){super(n),e&&(this._renderer=e),this._internalLoadingManager=new jb}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new a0e({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new tr,sdr:new tr});return new AC({width:16,height:16,type:ti,colorSpace:as,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,n,r,i){const s=i?new Blob([i],{type:"image/jpeg"}):void 0,o=new Blob([r],{type:"image/jpeg"});let a,l,c=!1;if(typeof createImageBitmap>"u"){const d=await Promise.all([s?yL(s):Promise.resolve(void 0),yL(o)]);l=d[0],a=d[1],c=!0}else{const d=await Promise.all([s?createImageBitmap(s,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:"flipY"})]);l=d[0],a=d[1]}const u=new tr(l||new ImageData(2,2),uf,ei,ei,Pn,XA,Pr,Rs,1,as);u.flipY=c,u.needsUpdate=!0;const f=new tr(a,uf,ei,ei,Pn,XA,Pr,Rs,1,Er);f.flipY=c,f.needsUpdate=!0,e.width=a.width,e.height=a.height,e.material.gainMap=u,e.material.sdr=f,e.material.gainMapMin=n.gainMapMin,e.material.gainMapMax=n.gainMapMax,e.material.offsetHdr=n.offsetHdr,e.material.offsetSdr=n.offsetSdr,e.material.gamma=n.gamma,e.material.hdrCapacityMin=n.hdrCapacityMin,e.material.hdrCapacityMax=n.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,n.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class f0e extends aV{load([e,n,r],i,s,o){const a=this.prepareQuadRenderer();let l,c,u;const f=async()=>{if(l&&c&&u){try{await this.render(a,u,l,c)}catch(R){this.manager.itemError(e),this.manager.itemError(n),this.manager.itemError(r),typeof o=="function"&&o(R),a.disposeOnDemandRenderer();return}typeof i=="function"&&i(a),this.manager.itemEnd(e),this.manager.itemEnd(n),this.manager.itemEnd(r),a.disposeOnDemandRenderer()}};let d=!0,h=0,p=0,m=!0,g=0,y=0,x=!0,_=0,w=0;const T=()=>{if(typeof s=="function"){const R=h+g+_,M=p+y+w,D=d&&m&&x;s(new ProgressEvent("progress",{lengthComputable:D,loaded:M,total:R}))}};this.manager.itemStart(e),this.manager.itemStart(n),this.manager.itemStart(r);const S=new qr(this._internalLoadingManager);S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(e,async R=>{if(typeof R=="string")throw new Error("Invalid sdr buffer");l=R,await f()},R=>{d=R.lengthComputable,p=R.loaded,h=R.total,T()},R=>{this.manager.itemError(e),typeof o=="function"&&o(R)});const C=new qr(this._internalLoadingManager);C.setResponseType("arraybuffer"),C.setRequestHeader(this.requestHeader),C.setPath(this.path),C.setWithCredentials(this.withCredentials),C.load(n,async R=>{if(typeof R=="string")throw new Error("Invalid gainmap buffer");c=R,await f()},R=>{m=R.lengthComputable,y=R.loaded,g=R.total,T()},R=>{this.manager.itemError(n),typeof o=="function"&&o(R)});const A=new qr(this._internalLoadingManager);return A.setRequestHeader(this.requestHeader),A.setPath(this.path),A.setWithCredentials(this.withCredentials),A.load(r,async R=>{if(typeof R!="string")throw new Error("Invalid metadata string");u=JSON.parse(R),await f()},R=>{x=R.lengthComputable,w=R.loaded,_=R.total,T()},R=>{this.manager.itemError(r),typeof o=="function"&&o(R)}),a}}class d0e extends aV{load(e,n,r,i){const s=this.prepareQuadRenderer(),o=new qr(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async a=>{if(typeof a=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(a);let c,u,f;try{const d=await u0e(l);c=d.sdr,u=d.gainMap,f=d.metadata}catch(d){if(d instanceof oV||d instanceof sV)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),f={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw d}try{await this.render(s,f,c,u)}catch(d){this.manager.itemError(e),typeof i=="function"&&i(d),s.disposeOnDemandRenderer();return}typeof n=="function"&&n(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},r,a=>{this.manager.itemError(e),typeof i=="function"&&i(a)}),s}}const X1={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},lV="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",am=t=>Array.isArray(t),MC=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function aE({files:t=MC,path:e="",preset:n=void 0,encoding:r=void 0,extensions:i}={}){let s=null,o=!1;n&&(CC(n),t=X1[n],e=lV),o=am(t);const{extension:a,isCubemap:l}=RC(t);if(s=IC(a),!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);const c=At(h=>h.gl);v.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function h(){rs.clear(s,o?[t]:t)}c.domElement.addEventListener("webglcontextlost",h,{once:!0})},[t,c.domElement]);const u=rs(s,o?[t]:t,h=>{(a==="webp"||a==="jpg"||a==="jpeg")&&h.setRenderer(c),h.setPath==null||h.setPath(e),i&&i(h)});let f=o?u[0]:u;if(a==="jpg"||a==="jpeg"||a==="webp"){var d;f=(d=f.renderTarget)==null?void 0:d.texture}return f.mapping=l?sc:pm,"colorSpace"in f?f.colorSpace=r??l?"srgb":"srgb-linear":f.encoding=r??l?Nme:Dme,f}const h0e={files:MC,path:"",preset:void 0,extensions:void 0};aE.preload=t=>{const e={...h0e,...t};let{files:n,path:r=""}=e;const{preset:i,extensions:s}=e;i&&(CC(i),n=X1[i],r=lV);const{extension:o}=RC(n);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const a=IC(o);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+n);rs.preload(a,am(n)?[n]:n,l=>{l.setPath==null||l.setPath(r),s&&s(l)})};const p0e={files:MC,preset:void 0};aE.clear=t=>{const e={...p0e,...t};let{files:n}=e;const{preset:r}=e;r&&(CC(r),n=X1[r]);const{extension:i}=RC(n),s=IC(i);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);rs.clear(s,am(n)?[n]:n)};function CC(t){if(!(t in X1))throw new Error("Preset must be one of: "+Object.keys(X1).join(", "))}function RC(t){var e;const n=am(t)&&t.length===6,r=am(t)&&t.length===3&&t.some(o=>o.endsWith("json")),i=am(t)?t[0]:t;return{extension:n?"cube":r?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:n,isGainmap:r}}function IC(t){return t==="cube"?Jz:t==="hdr"?hde:t==="exr"?pde:t==="jpg"||t==="jpeg"?d0e:t==="webp"?f0e:null}const m0e=t=>t.current&&t.current.isScene,g0e=t=>m0e(t)?t.current:t;function PC(t,e,n,r,i={}){var s,o,a,l;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const c=g0e(e||n),u=c.background,f=c.environment,d={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:(s=(o=c.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:(a=(l=c.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&a!==void 0?a:[0,0,0]};return t!=="only"&&(c.environment=r),t&&(c.background=r),to(c,i),()=>{t!=="only"&&(c.environment=f),t&&(c.background=u),to(c,d)}}function kC({scene:t,background:e=!1,map:n,...r}){const i=At(s=>s.scene);return v.useLayoutEffect(()=>{if(n)return PC(e,t,i,n,r)}),null}function cV({background:t=!1,scene:e,blur:n,backgroundBlurriness:r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a,...l}){const c=aE(l),u=At(f=>f.scene);return v.useLayoutEffect(()=>PC(t,e,u,c,{backgroundBlurriness:n??r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a})),null}function y0e({children:t,near:e=.1,far:n=1e3,resolution:r=256,frames:i=1,map:s,background:o=!1,blur:a,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:f,environmentRotation:d,scene:h,files:p,path:m,preset:g=void 0,extensions:y}){const x=At(A=>A.gl),_=At(A=>A.scene),w=v.useRef(null),[T]=v.useState(()=>new ls),S=v.useMemo(()=>{const A=new Fm(r);return A.texture.type=ti,A},[r]);v.useLayoutEffect(()=>{if(i===1){const A=x.autoClear;x.autoClear=!0,w.current.update(x,T),x.autoClear=A}return PC(o,h,_,S.texture,{backgroundBlurriness:a??l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:f,environmentRotation:d})},[t,T,S.texture,h,_,o,i,x]);let C=1;return Yt(()=>{if(i===1/0||C<i){const A=x.autoClear;x.autoClear=!0,w.current.update(x,T),x.autoClear=A,C++}}),v.createElement(v.Fragment,null,Al(v.createElement(v.Fragment,null,t,v.createElement("cubeCamera",{ref:w,args:[e,n,S]}),p||g?v.createElement(cV,{background:!0,files:p,preset:g,path:m,extensions:y}):s?v.createElement(kC,{background:!0,map:s,extensions:y}):null),T))}function v0e(t){var e,n,r,i;const s=aE(t),o=t.map||s;v.useMemo(()=>Gi({GroundProjectedEnvImpl:$ue}),[]);const a=v.useMemo(()=>[o],[o]),l=(e=t.ground)==null?void 0:e.height,c=(n=t.ground)==null?void 0:n.radius,u=(r=(i=t.ground)==null?void 0:i.scale)!==null&&r!==void 0?r:1e3;return v.createElement(v.Fragment,null,v.createElement(kC,It({},t,{map:o})),v.createElement("groundProjectedEnvImpl",{args:a,scale:u,height:l,radius:c}))}function LC(t){return t.ground?v.createElement(v0e,t):t.map?v.createElement(kC,t):t.children?v.createElement(y0e,t):v.createElement(cV,t)}const DC=v.forwardRef(({scale:t=10,frames:e=1/0,opacity:n=1,width:r=1,height:i=1,blur:s=1,near:o=0,far:a=10,resolution:l=512,smooth:c=!0,color:u="#000000",depthWrite:f=!1,renderOrder:d,...h},p)=>{const m=v.useRef(null),g=At(N=>N.scene),y=At(N=>N.gl),x=v.useRef(null);r=r*(Array.isArray(t)?t[0]:t||1),i=i*(Array.isArray(t)?t[1]:t||1);const[_,w,T,S,C,A,R]=v.useMemo(()=>{const N=new fr(l,l),z=new fr(l,l);z.texture.generateMipmaps=N.texture.generateMipmaps=!1;const O=new Ps(r,i).rotateX(Math.PI/2),K=new ln(O),V=new zm;V.depthTest=V.depthWrite=!1,V.onBeforeCompile=P=>{P.uniforms={...P.uniforms,ucolor:{value:new wt(u)}},P.fragmentShader=P.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),P.fragmentShader=P.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const ne=new yr(nde),re=new yr(rde);return re.depthTest=ne.depthTest=!1,[N,O,V,K,ne,re,z]},[l,r,i,t,u]),M=N=>{S.visible=!0,S.material=C,C.uniforms.tDiffuse.value=_.texture,C.uniforms.h.value=N*1/256,y.setRenderTarget(R),y.render(S,x.current),S.material=A,A.uniforms.tDiffuse.value=R.texture,A.uniforms.v.value=N*1/256,y.setRenderTarget(_),y.render(S,x.current),S.visible=!1};let D=0,k,L;return Yt(()=>{x.current&&(e===1/0||D<e)&&(D++,k=g.background,L=g.overrideMaterial,m.current.visible=!1,g.background=null,g.overrideMaterial=T,y.setRenderTarget(_),y.render(g,x.current),M(s),c&&M(s*.4),y.setRenderTarget(null),m.current.visible=!0,g.overrideMaterial=L,g.background=k)}),v.useImperativeHandle(p,()=>m.current,[]),v.createElement("group",It({"rotation-x":Math.PI/2},h,{ref:m}),v.createElement("mesh",{renderOrder:d,geometry:w,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},v.createElement("meshBasicMaterial",{transparent:!0,map:_.texture,opacity:n,depthWrite:f})),v.createElement("orthographicCamera",{ref:x,args:[-r/2,r/2,i/2,-i/2,o,a]}))});function x0e(t){return t.isLight}function _0e(t){return!!t.geometry}const uV=v.createContext(null),b0e=Ml({color:new wt,blend:2,alphaTest:.75,opacity:0,map:null},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vUv = uv;
   }`,`varying vec2 vUv;
   uniform sampler2D map;
   uniform vec3 color;
   uniform float opacity;
   uniform float alphaTest;
   uniform float blend;
   void main() {
     vec4 sampledDiffuseColor = texture2D(map, vUv);
     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);
     #include <tonemapping_fragment>
     #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),NC=v.forwardRef(({children:t,temporal:e,frames:n=40,limit:r=1/0,blend:i=20,scale:s=10,opacity:o=1,alphaTest:a=.75,color:l="black",colorBlend:c=2,resolution:u=1024,toneMapped:f=!0,...d},h)=>{Gi({SoftShadowMaterial:b0e});const p=At(S=>S.gl),m=At(S=>S.scene),g=At(S=>S.camera),y=At(S=>S.invalidate),x=v.useRef(null),_=v.useRef(null),[w]=v.useState(()=>new E0e(p,m,u));v.useLayoutEffect(()=>{w.configure(x.current)},[]);const T=v.useMemo(()=>({lights:new Map,temporal:!!e,frames:Math.max(2,n),blend:Math.max(2,n===1/0?i:n),count:0,getMesh:()=>x.current,reset:()=>{w.clear();const S=x.current.material;S.opacity=0,S.alphaTest=0,T.count=0},update:(S=1)=>{const C=x.current.material;T.temporal?(C.opacity=Math.min(o,C.opacity+o/T.blend),C.alphaTest=Math.min(a,C.alphaTest+a/T.blend)):(C.opacity=o,C.alphaTest=a),_.current.visible=!0,w.prepare();for(let A=0;A<S;A++)T.lights.forEach(R=>R.update()),w.update(g,T.blend);_.current.visible=!1,w.finish()}}),[w,g,m,e,n,i,o,a]);return v.useLayoutEffect(()=>{T.reset(),!T.temporal&&T.frames!==1/0&&T.update(T.blend)}),v.useImperativeHandle(h,()=>T,[T]),Yt(()=>{(T.temporal||T.frames===1/0)&&T.count<T.frames&&T.count<r&&(y(),T.update(),T.count++)}),v.createElement("group",d,v.createElement("group",{traverse:()=>null,ref:_},v.createElement(uV.Provider,{value:T},t)),v.createElement("mesh",{receiveShadow:!0,ref:x,scale:s,rotation:[-Math.PI/2,0,0]},v.createElement("planeGeometry",null),v.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:f,color:l,blend:c,map:w.progressiveLightMap2.texture})))}),OC=v.forwardRef(({castShadow:t=!0,bias:e=.001,mapSize:n=512,size:r=5,near:i=.5,far:s=500,frames:o=1,position:a=[0,0,0],radius:l=1,amount:c=8,intensity:u=Ro>=155?Math.PI:1,ambient:f=.5,...d},h)=>{const p=v.useRef(null),m=new $(...a).length(),g=v.useContext(uV),y=v.useCallback(()=>{let _;if(p.current)for(let w=0;w<p.current.children.length;w++)if(_=p.current.children[w],Math.random()>f)_.position.set(a[0]+ri.randFloatSpread(l),a[1]+ri.randFloatSpread(l),a[2]+ri.randFloatSpread(l));else{let T=Math.acos(2*Math.random()-1)-Math.PI/2,S=2*Math.PI*Math.random();_.position.set(Math.cos(T)*Math.cos(S)*m,Math.abs(Math.cos(T)*Math.sin(S)*m),Math.sin(T)*m)}},[l,f,m,...a]),x=v.useMemo(()=>({update:y}),[y]);return v.useImperativeHandle(h,()=>x,[x]),v.useLayoutEffect(()=>{var _;const w=p.current;return g&&((_=g.lights)==null||_.set(w.uuid,x)),()=>{var T;return void(g==null||(T=g.lights)==null?void 0:T.delete(w.uuid))}},[g,x]),v.createElement("group",It({ref:p},d),Array.from({length:c},(_,w)=>v.createElement("directionalLight",{key:w,castShadow:t,"shadow-bias":e,"shadow-mapSize":[n,n],intensity:u/c},v.createElement("orthographicCamera",{attach:"shadow-camera",args:[-r,r,r,-r,i,s]}))))});class E0e{constructor(e,n,r=1024){this.renderer=e,this.res=r,this.scene=n,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new wt,this.clearAlpha=0;const i={type:ti,magFilter:zn,minFilter:zn};this.progressiveLightMap1=new fr(this.res,this.res,i),this.progressiveLightMap2=new fr(this.res,this.res,i),this.discardMat=new wC,this.targetMat=new nh({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=s=>{s.vertexShader=`varying vec2 vUv;
`+s.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const o=s.fragmentShader.indexOf("void main() {");s.fragmentShader=`varying vec2 vUv;
`+s.fragmentShader.slice(0,o)+`uniform sampler2D previousShadowMap;
	uniform float averagingWindow;
`+s.fragmentShader.slice(o-1,-1)+`
vec3 texelOld = texture2D(previousShadowMap, vUv).rgb;
        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);
      }`,s.uniforms.previousShadowMap=this.previousShadowMap,s.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(e=>{_0e(e)?this.meshes.push({object:e,material:e.material}):x0e(e)&&this.lights.push({object:e,intensity:e.intensity})})}prepare(){this.lights.forEach(e=>e.object.intensity=0),this.meshes.forEach(e=>e.object.material=this.discardMat)}finish(){this.lights.forEach(e=>e.object.intensity=e.intensity),this.meshes.forEach(e=>e.object.material=e.material)}configure(e){this.object=e}update(e,n=100){if(!this.object)return;this.averagingWindow.value=n,this.object.material=this.targetMat;const r=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,i=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,s=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(r),this.previousShadowMap.value=i.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=s}}const w0e={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function S0e({radius:t,adjustCamera:e}){const n=r0e();return v.useEffect(()=>{e&&n.refresh().clip().fit()},[t,e]),null}function fV({children:t,center:e,adjustCamera:n=!0,intensity:r=.5,shadows:i="contact",environment:s="city",preset:o="rembrandt",...a}){var l,c,u,f,d,h,p,m;const g=typeof o=="string"?w0e[o]:o,[{radius:y,height:x},_]=v.useState({radius:0,width:0,height:0,depth:0}),w=(l=i==null?void 0:i.bias)!==null&&l!==void 0?l:-1e-4,T=(c=i==null?void 0:i.normalBias)!==null&&c!==void 0?c:0,S=(u=i==null?void 0:i.size)!==null&&u!==void 0?u:1024,C=(f=i==null?void 0:i.offset)!==null&&f!==void 0?f:0,A=i==="contact"||(i==null?void 0:i.type)==="contact",R=i==="accumulative"||(i==null?void 0:i.type)==="accumulative",M={...typeof i=="object"?i:{}},D=s?typeof s=="string"?{preset:s}:s:null,k=v.useCallback(L=>{const{width:N,height:z,depth:O,boundingSphere:K}=L;_({radius:K.radius,width:N,height:z,depth:O}),e!=null&&e.onCentered&&e.onCentered(L)},[]);return v.createElement(v.Fragment,null,v.createElement("ambientLight",{intensity:r/3}),v.createElement("spotLight",{penumbra:1,position:[g.main[0]*y,g.main[1]*y,g.main[2]*y],intensity:r*2,castShadow:!!i,"shadow-bias":w,"shadow-normalBias":T,"shadow-mapSize":S}),v.createElement("pointLight",{position:[g.fill[0]*y,g.fill[1]*y,g.fill[2]*y],intensity:r}),v.createElement(TC,It({fit:!!n,clip:!!n,margin:Number(n),observe:!0},a),v.createElement(S0e,{radius:y,adjustCamera:n}),v.createElement(bC,It({},e,{position:[0,C/2,0],onCentered:k}),t)),v.createElement("group",{position:[0,-x/2-C/2,0]},A&&v.createElement(DC,It({scale:y*4,far:y,blur:2},M)),R&&v.createElement(NC,It({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:y*4},M),v.createElement(OC,{amount:(d=M.amount)!==null&&d!==void 0?d:8,radius:(h=M.radius)!==null&&h!==void 0?h:y,ambient:(p=M.ambient)!==null&&p!==void 0?p:.5,intensity:(m=M.intensity)!==null&&m!==void 0?m:1,position:[g.main[0]*y,g.main[1]*y,g.main[2]*y],size:y*4,bias:-w,mapSize:S}))),s&&v.createElement(LC,D))}const T0e=t=>t===0?0:Math.pow(2,10*t-10);function dV({children:t,floor:e=.25,segments:n=20,receiveShadow:r,...i}){const s=v.useRef(null);return v.useLayoutEffect(()=>{let o=0;const a=n/n/2,l=s.current.attributes.position;for(let c=0;c<n+1;c++)for(let u=0;u<n+1;u++)l.setXYZ(o++,c/n-a+(c===0?-e:0),u/n-a,T0e(c/n));l.needsUpdate=!0,s.current.computeVertexNormals()},[n,e]),v.createElement("group",i,v.createElement("mesh",{receiveShadow:r,rotation:[-Math.PI/2,0,Math.PI/2]},v.createElement("planeGeometry",{ref:s,args:[1,1,n,n]}),t))}const hV=v.forwardRef(({fog:t=!1,renderOrder:e,depthWrite:n=!1,colorStop:r=0,color:i="black",opacity:s=.5,...o},a)=>{const l=v.useMemo(()=>{const c=document.createElement("canvas");c.width=128,c.height=128;const u=c.getContext("2d"),f=u.createRadialGradient(c.width/2,c.height/2,0,c.width/2,c.height/2,c.width/2);return f.addColorStop(r,new wt(i).getStyle()),f.addColorStop(1,"rgba(0,0,0,0)"),u.fillStyle=f,u.fillRect(0,0,c.width,c.height),c},[i,r]);return v.createElement("mesh",It({renderOrder:e,ref:a,"rotation-x":-Math.PI/2},o),v.createElement("planeGeometry",null),v.createElement("meshBasicMaterial",{transparent:!0,opacity:s,fog:t,depthWrite:n,side:Nr},v.createElement("canvasTexture",{attach:"map",args:[l]})))});function vL(t=Cs){const e={value:new et};return Object.assign(new Hb({side:t}),{viewMatrix:e,onBeforeCompile:n=>{n.uniforms.viewMatrix=e,n.fragmentShader=`vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
           return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
         }
`+n.fragmentShader.replace("#include <normal_fragment_maps>",`#include <normal_fragment_maps>
           normal = inverseTransformDirection( normal, viewMatrix );
`)}})}const A0e=Ml({causticsTexture:null,causticsTextureB:null,color:new wt,lightProjMatrix:new et,lightViewMatrix:new et},`varying vec3 vWorldPosition;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vec4 worldPosition = modelMatrix * vec4(position, 1.);
     vWorldPosition = worldPosition.xyz;
   }`,`varying vec3 vWorldPosition;
  uniform vec3 color;
  uniform sampler2D causticsTexture;
  uniform sampler2D causticsTextureB;
  uniform mat4 lightProjMatrix;
  uniform mat4 lightViewMatrix;
   void main() {
    // Apply caustics
    vec4 lightSpacePos = lightProjMatrix * lightViewMatrix * vec4(vWorldPosition, 1.0);
    lightSpacePos.xyz /= lightSpacePos.w;
    lightSpacePos.xyz = lightSpacePos.xyz * 0.5 + 0.5;
    vec3 front = texture2D(causticsTexture, lightSpacePos.xy).rgb;
    vec3 back = texture2D(causticsTextureB, lightSpacePos.xy).rgb;
    gl_FragColor = vec4((front + back) * color, 1.0);
    #include <tonemapping_fragment>
    #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),M0e=Ml({cameraMatrixWorld:new et,cameraProjectionMatrixInv:new et,normalTexture:null,depthTexture:null,lightDir:new $(0,1,0),lightPlaneNormal:new $(0,1,0),lightPlaneConstant:0,near:.1,far:100,modelMatrix:new et,worldRadius:1/40,ior:1.1,bounces:0,resolution:1024,size:10,intensity:.5},`
  varying vec2 vUv;
  void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }`,`
  uniform mat4 cameraMatrixWorld;
  uniform mat4 cameraProjectionMatrixInv;
  uniform vec3 lightDir;
  uniform vec3 lightPlaneNormal;
  uniform float lightPlaneConstant;
  uniform float near;
  uniform float far;
  uniform float time;
  uniform float worldRadius;
  uniform float resolution;
  uniform float size;
  uniform float intensity;
  uniform float ior;
  precision highp isampler2D;
  precision highp usampler2D;
  uniform sampler2D normalTexture;
  uniform sampler2D depthTexture;
  uniform float bounces;
  varying vec2 vUv;
  vec3 WorldPosFromDepth(float depth, vec2 coord) {
    float z = depth * 2.0 - 1.0;
    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
    vec4 viewSpacePosition = cameraProjectionMatrixInv * clipSpacePosition;
    // Perspective division
    viewSpacePosition /= viewSpacePosition.w;
    vec4 worldSpacePosition = cameraMatrixWorld * viewSpacePosition;
    return worldSpacePosition.xyz;
  }
  float sdPlane( vec3 p, vec3 n, float h ) {
    // n must be normalized
    return dot(p,n) + h;
  }
  float planeIntersect( vec3 ro, vec3 rd, vec4 p ) {
    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);
  }
  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 pos, vec3 normal, float ior, out vec3 rayOrigin, out vec3 rayDirection) {
    rayOrigin = ro;
    rayDirection = rd;
    rayDirection = refract(rayDirection, normal, 1.0 / ior);
    rayOrigin = pos + rayDirection * 0.1;
    return rayDirection;
  }
  void main() {
    // Each sample consists of random offset in the x and y direction
    float caustic = 0.0;
    float causticTexelSize = (1.0 / resolution) * size * 2.0;
    float texelsNeeded = worldRadius / causticTexelSize;
    float sampleRadius = texelsNeeded / resolution;
    float sum = 0.0;
    if (texture2D(depthTexture, vUv).x == 1.0) {
      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
      return;
    }
    vec2 offset1 = vec2(-0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset2 = vec2(-0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset3 = vec2(0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset4 = vec2(0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 uv1 = vUv + offset1 * sampleRadius;
    vec2 uv2 = vUv + offset2 * sampleRadius;
    vec2 uv3 = vUv + offset3 * sampleRadius;
    vec2 uv4 = vUv + offset4 * sampleRadius;
    vec3 normal1 = texture2D(normalTexture, uv1, -10.0).rgb * 2.0 - 1.0;
    vec3 normal2 = texture2D(normalTexture, uv2, -10.0).rgb * 2.0 - 1.0;
    vec3 normal3 = texture2D(normalTexture, uv3, -10.0).rgb * 2.0 - 1.0;
    vec3 normal4 = texture2D(normalTexture, uv4, -10.0).rgb * 2.0 - 1.0;
    float depth1 = texture2D(depthTexture, uv1, -10.0).x;
    float depth2 = texture2D(depthTexture, uv2, -10.0).x;
    float depth3 = texture2D(depthTexture, uv3, -10.0).x;
    float depth4 = texture2D(depthTexture, uv4, -10.0).x;
    // Sanity check the depths
    if (depth1 == 1.0 || depth2 == 1.0 || depth3 == 1.0 || depth4 == 1.0) {
      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
      return;
    }
    vec3 pos1 = WorldPosFromDepth(depth1, uv1);
    vec3 pos2 = WorldPosFromDepth(depth2, uv2);
    vec3 pos3 = WorldPosFromDepth(depth3, uv3);
    vec3 pos4 = WorldPosFromDepth(depth4, uv4);
    vec3 originPos1 = WorldPosFromDepth(0.0, uv1);
    vec3 originPos2 = WorldPosFromDepth(0.0, uv2);
    vec3 originPos3 = WorldPosFromDepth(0.0, uv3);
    vec3 originPos4 = WorldPosFromDepth(0.0, uv4);
    vec3 endPos1, endPos2, endPos3, endPos4;
    vec3 endDir1, endDir2, endDir3, endDir4;
    totalInternalReflection(originPos1, lightDir, pos1, normal1, ior, endPos1, endDir1);
    totalInternalReflection(originPos2, lightDir, pos2, normal2, ior, endPos2, endDir2);
    totalInternalReflection(originPos3, lightDir, pos3, normal3, ior, endPos3, endDir3);
    totalInternalReflection(originPos4, lightDir, pos4, normal4, ior, endPos4, endDir4);
    float lightPosArea = length(cross(originPos2 - originPos1, originPos3 - originPos1)) + length(cross(originPos3 - originPos1, originPos4 - originPos1));
    float t1 = planeIntersect(endPos1, endDir1, vec4(lightPlaneNormal, lightPlaneConstant));
    float t2 = planeIntersect(endPos2, endDir2, vec4(lightPlaneNormal, lightPlaneConstant));
    float t3 = planeIntersect(endPos3, endDir3, vec4(lightPlaneNormal, lightPlaneConstant));
    float t4 = planeIntersect(endPos4, endDir4, vec4(lightPlaneNormal, lightPlaneConstant));
    vec3 finalPos1 = endPos1 + endDir1 * t1;
    vec3 finalPos2 = endPos2 + endDir2 * t2;
    vec3 finalPos3 = endPos3 + endDir3 * t3;
    vec3 finalPos4 = endPos4 + endDir4 * t4;
    float finalArea = length(cross(finalPos2 - finalPos1, finalPos3 - finalPos1)) + length(cross(finalPos3 - finalPos1, finalPos4 - finalPos1));
    caustic += intensity * (lightPosArea / finalArea);
    // Calculate the area of the triangle in light spaces
    gl_FragColor = vec4(vec3(max(caustic, 0.0)), 1.0);
  }`),xL={depth:!0,minFilter:Pn,magFilter:Pn,type:Rs},_L={minFilter:Ts,magFilter:Pn,type:pr,generateMipmaps:!0},pV=v.forwardRef(({debug:t,children:e,frames:n=1,ior:r=1.1,color:i="white",causticsOnly:s=!1,backside:o=!1,backsideIOR:a=1.1,worldRadius:l=.3125,intensity:c=.05,resolution:u=2024,lightSource:f=[5,5,5],...d},h)=>{Gi({CausticsProjectionMaterial:A0e});const p=v.useRef(null),m=v.useRef(null),g=v.useRef(null),y=v.useRef(null),x=At(X=>X.gl),_=fh(t&&m,$6),w=Mo(u,u,xL),T=Mo(u,u,xL),S=Mo(u,u,_L),C=Mo(u,u,_L),[A]=v.useState(()=>vL()),[R]=v.useState(()=>vL(zi)),[M]=v.useState(()=>new M0e),[D]=v.useState(()=>new Gc(M));v.useLayoutEffect(()=>{p.current.updateWorldMatrix(!1,!0)});let k=0;const L=new $,N=new th,z=new et,O=new Oi,K=new $,V=new $,ne=new Kn,re=new $,P=[],se=[],ue=[],te=[],W=new $;for(let X=0;X<8;X++)P.push(new $),se.push(new $),ue.push(new $),te.push(new $);return Yt(()=>{if(n===1/0||k++<n){var X,J;Array.isArray(f)?K.fromArray(f).normalize():K.copy(p.current.worldToLocal(f.current.getWorldPosition(L)).normalize()),V.copy(K).multiplyScalar(-1),(X=g.current.parent)==null||X.matrixWorld.identity(),ne.setFromObject(g.current,!0),P[0].set(ne.min.x,ne.min.y,ne.min.z),P[1].set(ne.min.x,ne.min.y,ne.max.z),P[2].set(ne.min.x,ne.max.y,ne.min.z),P[3].set(ne.min.x,ne.max.y,ne.max.z),P[4].set(ne.max.x,ne.min.y,ne.min.z),P[5].set(ne.max.x,ne.min.y,ne.max.z),P[6].set(ne.max.x,ne.max.y,ne.min.z),P[7].set(ne.max.x,ne.max.y,ne.max.z);for(let ge=0;ge<8;ge++)se[ge].copy(P[ge]);ne.getCenter(re),P.map(ge=>ge.sub(re));const oe=O.set(V,0);P.map((ge,ze)=>oe.projectPoint(ge,ue[ze]));const Ee=ue.reduce((ge,ze)=>ge.add(ze),L.set(0,0,0)).divideScalar(ue.length),me=ue.map(ge=>ge.distanceTo(Ee)).reduce((ge,ze)=>Math.max(ge,ze)),Te=P.map(ge=>ge.dot(K)).reduce((ge,ze)=>Math.max(ge,ze));m.current.position.copy(W.copy(K).multiplyScalar(Te).add(re)),m.current.lookAt(g.current.localToWorld(re));const _e=z.lookAt(m.current.position,re,L.set(0,1,0));m.current.left=-me,m.current.right=me,m.current.top=me,m.current.bottom=-me;const Re=L.set(0,me,0).applyMatrix4(_e),ae=(m.current.position.y+Re.y)/K.y;m.current.near=.1,m.current.far=ae,m.current.updateProjectionMatrix(),m.current.updateMatrixWorld();const Ce=se.map((ge,ze)=>ge.add(te[ze].copy(K).multiplyScalar(-ge.y/K.y))),Pe=Ce.reduce((ge,ze)=>ge.add(ze),L.set(0,0,0)).divideScalar(Ce.length),Ve=2*Ce.map(ge=>Math.hypot(ge.x-Pe.x,ge.z-Pe.z)).reduce((ge,ze)=>Math.max(ge,ze));y.current.scale.setScalar(Ve),y.current.position.copy(Pe),t&&((J=_.current)==null||J.update()),R.viewMatrix.value=A.viewMatrix.value=m.current.matrixWorldInverse;const ye=N.setFromProjectionMatrix(z.multiplyMatrices(m.current.projectionMatrix,m.current.matrixWorldInverse)).planes[4];M.cameraMatrixWorld=m.current.matrixWorld,M.cameraProjectionMatrixInv=m.current.projectionMatrixInverse,M.lightDir=V,M.lightPlaneNormal=ye.normal,M.lightPlaneConstant=ye.constant,M.near=m.current.near,M.far=m.current.far,M.resolution=u,M.size=me,M.intensity=c,M.worldRadius=l,g.current.visible=!0,x.setRenderTarget(w),x.clear(),g.current.overrideMaterial=A,x.render(g.current,m.current),x.setRenderTarget(T),x.clear(),o&&(g.current.overrideMaterial=R,x.render(g.current,m.current)),g.current.overrideMaterial=null,M.ior=r,y.current.material.lightProjMatrix=m.current.projectionMatrix,y.current.material.lightViewMatrix=m.current.matrixWorldInverse,M.normalTexture=w.texture,M.depthTexture=w.depthTexture,x.setRenderTarget(S),x.clear(),D.render(x),M.ior=a,M.normalTexture=T.texture,M.depthTexture=T.depthTexture,x.setRenderTarget(C),x.clear(),o&&D.render(x),x.setRenderTarget(null),s&&(g.current.visible=!1)}}),v.useImperativeHandle(h,()=>p.current,[]),v.createElement("group",It({ref:p},d),v.createElement("scene",{ref:g},v.createElement("orthographicCamera",{ref:m,up:[0,1,0]}),e),v.createElement("mesh",{renderOrder:2,ref:y,"rotation-x":-Math.PI/2},v.createElement("planeGeometry",null),v.createElement("causticsProjectionMaterial",{transparent:!0,color:i,causticsTexture:S.texture,causticsTextureB:C.texture,blending:mb,blendSrc:gb,blendDst:O1,depthWrite:!1}),t&&v.createElement(aj,null,v.createElement("lineBasicMaterial",{color:"#ffff00",toneMapped:!1}))))});class C0e extends yr{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new $(0,0,0)},lightColor:{value:new wt("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new Ke(0,0)}},transparent:!0,depthWrite:!1,vertexShader:`
        varying vec3 vNormal;
        varying float vViewZ;
        varying float vIntensity;
        uniform vec3 spotPosition;
        uniform float attenuation;

        #include <common>
        #include <logdepthbuf_pars_vertex>

        void main() {
          // compute intensity
          vNormal = normalize(normalMatrix * normal);
          vec4 worldPosition = modelMatrix * vec4(position, 1);
          vec4 viewPosition = viewMatrix * worldPosition;
          vViewZ = viewPosition.z;

          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);

          gl_Position = projectionMatrix * viewPosition;

          #include <logdepthbuf_vertex>
        }
      `,fragmentShader:`
        varying vec3 vNormal;
        varying float vViewZ;
        varying float vIntensity;

        uniform vec3 lightColor;
        uniform float anglePower;
        uniform sampler2D depth;
        uniform vec2 resolution;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float opacity;

        #include <packing>
        #include <logdepthbuf_pars_fragment>

        float readDepth(sampler2D depthSampler, vec2 uv) {
          float fragCoordZ = texture(depthSampler, uv).r;

          // https://github.com/mrdoob/three.js/issues/23072
          #ifdef USE_LOGDEPTHBUF
            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));
          #else
            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);
          #endif

          return viewZ;
        }

        void main() {
          #include <logdepthbuf_fragment>

          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));
          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);
          float intensity = vIntensity * angleIntensity;

          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry
          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;
          if (isSoft) {
            vec2 uv = gl_FragCoord.xy / resolution;
            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));
          }

          gl_FragColor = vec4(lightColor, intensity * opacity);

          #include <tonemapping_fragment>
          #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
        }
      `})}}var R0e=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D uShadowMap;uniform float uTime;void main(){vec3 color=texture2D(uShadowMap,vUv).xyz;gl_FragColor=vec4(color,1.);}`;const I0e=t=>t==null?void 0:t.isSpotLight;function P0e({opacity:t=1,radiusTop:e,radiusBottom:n,depthBuffer:r,color:i="white",distance:s=5,angle:o=.15,attenuation:a=5,anglePower:l=5}){const c=v.useRef(null),u=At(g=>g.size),f=At(g=>g.camera),d=At(g=>g.viewport.dpr),[h]=v.useState(()=>new C0e),[p]=v.useState(()=>new $);e=e===void 0?.1:e,n=n===void 0?o*7:n,Yt(()=>{h.uniforms.spotPosition.value.copy(c.current.getWorldPosition(p)),c.current.lookAt(c.current.parent.target.getWorldPosition(p))});const m=v.useMemo(()=>{const g=new hu(e,n,s,128,64,!0);return g.applyMatrix4(new et().makeTranslation(0,-s/2,0)),g.applyMatrix4(new et().makeRotationX(-Math.PI/2)),g},[s,e,n]);return v.createElement(v.Fragment,null,v.createElement("mesh",{ref:c,geometry:m,raycast:()=>null},v.createElement("primitive",{object:h,attach:"material","uniforms-opacity-value":t,"uniforms-lightColor-value":i,"uniforms-attenuation-value":a,"uniforms-anglePower-value":l,"uniforms-depth-value":r,"uniforms-cameraNear-value":f.near,"uniforms-cameraFar-value":f.far,"uniforms-resolution-value":r?[u.width*d,u.height*d]:[0,0]})))}function mV(t,e,n,r,i){const[[s,o]]=v.useState(()=>[new $,new $]);v.useLayoutEffect(()=>{if(I0e(t.current))t.current.shadow.mapSize.set(n,r),t.current.shadow.needsUpdate=!0;else throw new Error("SpotlightShadow must be a child of a SpotLight")},[t,n,r]),Yt(()=>{if(!t.current)return;const a=t.current.position,l=t.current.target.position;o.copy(l).sub(a);var c=o.length();o.normalize().multiplyScalar(c*i),s.copy(a).add(o),e.current.position.copy(s),e.current.lookAt(t.current.target.position)})}function k0e({distance:t=.4,alphaTest:e=.5,map:n,shader:r=R0e,width:i=512,height:s=512,scale:o=1,children:a,...l}){const c=v.useRef(null),u=l.spotlightRef,f=l.debug;mV(u,c,i,s,t);const d=v.useMemo(()=>new fr(i,s,{format:Pr,stencilBuffer:!1}),[i,s]),h=v.useRef({uShadowMap:{value:n},uTime:{value:0}});v.useEffect(()=>void(h.current.uShadowMap.value=n),[n]);const p=v.useMemo(()=>new Gc(new yr({uniforms:h.current,vertexShader:`
          varying vec2 vUv;

          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
          `,fragmentShader:r})),[r]);return v.useEffect(()=>()=>{p.material.dispose(),p.dispose()},[p]),v.useEffect(()=>()=>d.dispose(),[d]),Yt(({gl:m},g)=>{h.current.uTime.value+=g,m.setRenderTarget(d),p.render(m),m.setRenderTarget(null)}),v.createElement(v.Fragment,null,v.createElement("mesh",{ref:c,scale:o,castShadow:!0},v.createElement("planeGeometry",null),v.createElement("meshBasicMaterial",{transparent:!0,side:Nr,alphaTest:e,alphaMap:d.texture,"alphaMap-wrapS":Or,"alphaMap-wrapT":Or,opacity:f?1:0},a)))}function L0e({distance:t=.4,alphaTest:e=.5,map:n,width:r=512,height:i=512,scale:s,children:o,...a}){const l=v.useRef(null),c=a.spotlightRef,u=a.debug;return mV(c,l,r,i,t),v.createElement(v.Fragment,null,v.createElement("mesh",{ref:l,scale:s,castShadow:!0},v.createElement("planeGeometry",null),v.createElement("meshBasicMaterial",{transparent:!0,side:Nr,alphaTest:e,alphaMap:n,"alphaMap-wrapS":Or,"alphaMap-wrapT":Or,opacity:u?1:0},o)))}function gV(t){return t.shader?v.createElement(k0e,t):v.createElement(L0e,t)}const z$e=v.forwardRef(({opacity:t=1,radiusTop:e,radiusBottom:n,depthBuffer:r,color:i="white",distance:s=5,angle:o=.15,attenuation:a=5,anglePower:l=5,volumetric:c=!0,debug:u=!1,children:f,...d},h)=>{const p=v.useRef(null);return v.useImperativeHandle(h,()=>p.current,[]),v.createElement("group",null,u&&p.current&&v.createElement("spotLightHelper",{args:[p.current]}),v.createElement("spotLight",It({ref:p,angle:o,color:i,distance:s,castShadow:!0},d),c&&v.createElement(P0e,{debug:u,opacity:t,radiusTop:e,radiusBottom:n,depthBuffer:r,color:i,distance:s,angle:o,attenuation:a,anglePower:l})),f&&v.cloneElement(f,{spotlightRef:p,debug:u}))}),yV=v.forwardRef(({light:t,args:e,map:n,toneMapped:r=!1,color:i="white",form:s="rect",intensity:o=1,scale:a=1,target:l=[0,0,0],children:c,...u},f)=>{const d=v.useRef(null);return v.useImperativeHandle(f,()=>d.current,[]),v.useLayoutEffect(()=>{!c&&!u.material&&(to(d.current.material,{color:i}),d.current.material.color.multiplyScalar(o))},[i,o,c,u.material]),v.useLayoutEffect(()=>{u.rotation||d.current.quaternion.identity(),l&&!u.rotation&&(typeof l=="boolean"?d.current.lookAt(0,0,0):d.current.lookAt(Array.isArray(l)?new $(...l):l))},[l,u.rotation]),a=Array.isArray(a)&&a.length===2?[a[0],a[1],1]:a,v.createElement("mesh",It({ref:d,scale:a},u),s==="circle"?v.createElement("ringGeometry",{args:e||[0,.5,64]}):s==="ring"?v.createElement("ringGeometry",{args:e||[.25,.5,64]}):s==="rect"||s==="plane"?v.createElement("planeGeometry",{args:e||[1,1]}):s==="box"?v.createElement("boxGeometry",{args:e||[1,1,1]}):v.createElement(s,{args:e}),c||v.createElement("meshBasicMaterial",{toneMapped:r,map:n,side:Nr}),t&&v.createElement("pointLight",It({castShadow:!0},t)))});function D0e(t,e,n=new $){const r=Math.PI*(t-.5),i=2*Math.PI*(e-.5);return n.x=Math.cos(i),n.y=Math.sin(r),n.z=Math.sin(i),n}const vV=v.forwardRef(({inclination:t=.6,azimuth:e=.1,distance:n=1e3,mieCoefficient:r=.005,mieDirectionalG:i=.8,rayleigh:s=.5,turbidity:o=10,sunPosition:a=D0e(t,e),...l},c)=>{const u=v.useMemo(()=>new $().setScalar(n),[n]),[f]=v.useState(()=>new aC);return v.createElement("primitive",It({object:f,ref:c,"material-uniforms-mieCoefficient-value":r,"material-uniforms-mieDirectionalG-value":i,"material-uniforms-rayleigh-value":s,"material-uniforms-sunPosition-value":a,"material-uniforms-turbidity-value":o,scale:u},l))});class N0e extends yr{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}const O0e=t=>new $().setFromSpherical(new d_(t,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),xV=v.forwardRef(({radius:t=100,depth:e=50,count:n=5e3,saturation:r=0,factor:i=4,fade:s=!1,speed:o=1},a)=>{const l=v.useRef(),[c,u,f]=v.useMemo(()=>{const h=[],p=[],m=Array.from({length:n},()=>(.5+.5*Math.random())*i),g=new wt;let y=t+e;const x=e/n;for(let _=0;_<n;_++)y-=x*Math.random(),h.push(...O0e(y).toArray()),g.setHSL(_/n,r,.9),p.push(g.r,g.g,g.b);return[new Float32Array(h),new Float32Array(p),new Float32Array(m)]},[n,e,i,t,r]);Yt(h=>l.current&&(l.current.uniforms.time.value=h.clock.getElapsedTime()*o));const[d]=v.useState(()=>new N0e);return v.createElement("points",{ref:a},v.createElement("bufferGeometry",null,v.createElement("bufferAttribute",{attach:"attributes-position",args:[c,3]}),v.createElement("bufferAttribute",{attach:"attributes-color",args:[u,3]}),v.createElement("bufferAttribute",{attach:"attributes-size",args:[f,1]})),v.createElement("primitive",{ref:l,object:d,attach:"material",blending:A3,"uniforms-fade-value":s,depthWrite:!1,transparent:!0,vertexColors:!0}))});let dx;const F0e=new Uint8Array(16);function U0e(){if(!dx&&(dx=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!dx))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return dx(F0e)}const Bs=[];for(let t=0;t<256;++t)Bs.push((t+256).toString(16).slice(1));function B0e(t,e=0){return Bs[t[e+0]]+Bs[t[e+1]]+Bs[t[e+2]]+Bs[t[e+3]]+"-"+Bs[t[e+4]]+Bs[t[e+5]]+"-"+Bs[t[e+6]]+Bs[t[e+7]]+"-"+Bs[t[e+8]]+Bs[t[e+9]]+"-"+Bs[t[e+10]]+Bs[t[e+11]]+Bs[t[e+12]]+Bs[t[e+13]]+Bs[t[e+14]]+Bs[t[e+15]]}const z0e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),bL={randomUUID:z0e};function H0e(t,e,n){if(bL.randomUUID&&!e&&!t)return bL.randomUUID();t=t||{};const r=t.random||(t.rng||U0e)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,B0e(r)}const G0e="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",EL=new et,hx=new $,px=new bn,wL=new $,SL=new bn,fg=new $,FC=v.createContext(null),j0e=v.forwardRef(({children:t,material:e=nh,texture:n=G0e,range:r,limit:i=200,frustumCulled:s,...o},a)=>{var l,c;const u=v.useMemo(()=>class extends e{constructor(){super();const A=parseInt(wl.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=R=>{R.vertexShader=`attribute float cloudOpacity;
               varying float vOpacity;
              `+R.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = cloudOpacity;
                `),R.fragmentShader=`varying float vOpacity;
              `+R.fragmentShader.replace(`#include <${A}>`,`#include <${A}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}},[e]);Gi({CloudMaterial:u});const f=v.useRef(null),d=v.useRef([]),h=v.useMemo(()=>new Float32Array(Array.from({length:i},()=>1)),[i]),p=v.useMemo(()=>new Float32Array(Array.from({length:i},()=>[1,1,1]).flat()),[i]),m=Cy(n);let g=0,y=0,x;const _=new bn,w=new $(0,0,1),T=new $;Yt((A,R)=>{for(g=A.clock.getElapsedTime(),EL.copy(f.current.matrixWorld).invert(),A.camera.matrixWorld.decompose(wL,SL,fg),y=0;y<d.current.length;y++)x=d.current[y],x.ref.current.matrixWorld.decompose(hx,px,fg),hx.add(T.copy(x.position).applyQuaternion(px).multiply(fg)),px.copy(SL).multiply(_.setFromAxisAngle(w,x.rotation+=R*x.rotationFactor)),fg.multiplyScalar(x.volume+(1+Math.sin(g*x.density*x.speed))/2*x.growth),x.matrix.compose(hx,px,fg).premultiply(EL),x.dist=hx.distanceTo(wL);for(d.current.sort((M,D)=>D.dist-M.dist),y=0;y<d.current.length;y++)x=d.current[y],h[y]=x.opacity*(x.dist<x.fade-1?x.dist/x.fade:1),f.current.setMatrixAt(y,x.matrix),f.current.setColorAt(y,x.color);f.current.geometry.attributes.cloudOpacity.needsUpdate=!0,f.current.instanceMatrix.needsUpdate=!0,f.current.instanceColor&&(f.current.instanceColor.needsUpdate=!0)}),v.useLayoutEffect(()=>{const A=Math.min(i,r!==void 0?r:i,d.current.length);f.current.count=A,x1(f.current.instanceMatrix,{offset:0,count:A*16}),f.current.instanceColor&&x1(f.current.instanceColor,{offset:0,count:A*3}),x1(f.current.geometry.attributes.cloudOpacity,{offset:0,count:A})});let S=[(l=m.image.width)!==null&&l!==void 0?l:1,(c=m.image.height)!==null&&c!==void 0?c:1];const C=Math.max(S[0],S[1]);return S=[S[0]/C,S[1]/C],v.createElement("group",It({ref:a},o),v.createElement(FC.Provider,{value:d},t,v.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:f,args:[null,null,i],frustumCulled:s},v.createElement("instancedBufferAttribute",{usage:Ji,attach:"instanceColor",args:[p,3]}),v.createElement("planeGeometry",{args:[...S]},v.createElement("instancedBufferAttribute",{usage:Ji,attach:"attributes-cloudOpacity",args:[h,1]})),v.createElement("cloudMaterial",{key:e.name,map:m,transparent:!0,depthWrite:!1}))))}),TL=v.forwardRef(({opacity:t=1,speed:e=0,bounds:n=[5,1,1],segments:r=20,color:i="#ffffff",fade:s=10,volume:o=6,smallestVolume:a=.25,distribute:l=null,growth:c=4,concentrate:u="inside",seed:f=Math.random(),...d},h)=>{function p(){const _=Math.sin(f++)*1e4;return _-Math.floor(_)}const m=v.useContext(FC),g=v.useRef(null),[y]=v.useState(()=>H0e()),x=v.useMemo(()=>[...new Array(r)].map((_,w)=>({segments:r,bounds:new $(1,1,1),position:new $,uuid:y,index:w,ref:g,dist:0,matrix:new et,color:new wt,rotation:w*(Math.PI/r)})),[r,y]);return v.useLayoutEffect(()=>{x.forEach((_,w)=>{to(_,{volume:o,color:i,speed:e,growth:c,opacity:t,fade:s,bounds:n,density:Math.max(.5,p()),rotationFactor:Math.max(.2,.5*p())*e});const T=l==null?void 0:l(_,w);if(T||r>1){var S;_.position.copy(_.bounds).multiply((S=T==null?void 0:T.point)!==null&&S!==void 0?S:{x:p()*2-1,y:p()*2-1,z:p()*2-1})}const C=Math.abs(_.position.x),A=Math.abs(_.position.y),R=Math.abs(_.position.z),M=Math.max(C,A,R);_.length=1,C===M&&(_.length-=C/_.bounds.x),A===M&&(_.length-=A/_.bounds.y),R===M&&(_.length-=R/_.bounds.z),_.volume=((T==null?void 0:T.volume)!==void 0?T.volume:Math.max(Math.max(0,a),u==="random"?p():u==="inside"?_.length:1-_.length))*o})},[u,n,s,i,t,c,o,f,r,e]),v.useLayoutEffect(()=>{const _=x;return m.current=[...m.current,..._],()=>{m.current=m.current.filter(w=>w.uuid!==y)}},[x]),v.useImperativeHandle(h,()=>g.current,[]),v.createElement("group",It({ref:g},d))}),_V=v.forwardRef((t,e)=>v.useContext(FC)?v.createElement(TL,It({ref:e},t)):v.createElement(j0e,null,v.createElement(TL,It({ref:e},t)))),V0e=Ml({time:0,pixelRatio:1},` uniform float pixelRatio;
    uniform float time;
    attribute float size;  
    attribute float speed;  
    attribute float opacity;
    attribute vec3 noise;
    attribute vec3 color;
    varying vec3 vColor;
    varying float vOpacity;
    void main() {
      vec4 modelPosition = modelMatrix * vec4(position, 1.0);
      modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;
      modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;
      modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;
      vec4 viewPosition = viewMatrix * modelPosition;
      vec4 projectionPostion = projectionMatrix * viewPosition;
      gl_Position = projectionPostion;
      gl_PointSize = size * 25. * pixelRatio;
      gl_PointSize *= (1.0 / - viewPosition.z);
      vColor = color;
      vOpacity = opacity;
    }`,` varying vec3 vColor;
    varying float vOpacity;
    void main() {
      float distanceToCenter = distance(gl_PointCoord, vec2(0.5));
      float strength = 0.05 / distanceToCenter - 0.1;
      gl_FragColor = vec4(vColor, strength * vOpacity);
      #include <tonemapping_fragment>
      #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
    }`),bV=t=>t&&t.constructor===Float32Array,W0e=t=>[t.r,t.g,t.b],EV=t=>t instanceof Ke||t instanceof $||t instanceof Hn,wV=t=>Array.isArray(t)?t:EV(t)?t.toArray():[t,t,t];function dg(t,e,n){return v.useMemo(()=>{if(e!==void 0){if(bV(e))return e;if(e instanceof wt){const r=Array.from({length:t*3},()=>W0e(e)).flat();return Float32Array.from(r)}else if(EV(e)||Array.isArray(e)){const r=Array.from({length:t*3},()=>wV(e)).flat();return Float32Array.from(r)}return Float32Array.from({length:t},()=>e)}return Float32Array.from({length:t},n)},[e])}const SV=v.forwardRef(({noise:t=1,count:e=100,speed:n=1,opacity:r=1,scale:i=1,size:s,color:o,children:a,...l},c)=>{v.useMemo(()=>Gi({SparklesImplMaterial:V0e}),[]);const u=v.useRef(null),f=At(_=>_.viewport.dpr),d=wV(i),h=v.useMemo(()=>Float32Array.from(Array.from({length:e},()=>d.map(ri.randFloatSpread)).flat()),[e,...d]),p=dg(e,s,Math.random),m=dg(e,r),g=dg(e,n),y=dg(e*3,t),x=dg(o===void 0?e*3:e,bV(o)?o:new wt(o),()=>1);return Yt(_=>{u.current&&u.current.material&&(u.current.material.time=_.clock.elapsedTime)}),v.useImperativeHandle(c,()=>u.current,[]),v.createElement("points",It({key:`particle-${e}-${JSON.stringify(i)}`},l,{ref:u}),v.createElement("bufferGeometry",null,v.createElement("bufferAttribute",{attach:"attributes-position",args:[h,3]}),v.createElement("bufferAttribute",{attach:"attributes-size",args:[p,1]}),v.createElement("bufferAttribute",{attach:"attributes-opacity",args:[m,1]}),v.createElement("bufferAttribute",{attach:"attributes-speed",args:[g,1]}),v.createElement("bufferAttribute",{attach:"attributes-color",args:[x,3]}),v.createElement("bufferAttribute",{attach:"attributes-noise",args:[y,3]})),a||v.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:f,depthWrite:!1}))}),AL=new et,J4=new Yo,ML=new wr,$0e=new $;class X0e extends es{constructor(){super(),this.size=0,this.color=new wt("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return(e=this.instance.current)==null?void 0:e.geometry}raycast(e,n){var r,i;const s=this.instance.current;if(!s||!s.geometry)return;const o=s.userData.instances.indexOf(this.instanceKey);if(o===-1||o>s.geometry.drawRange.count)return;const a=(r=(i=e.params.Points)==null?void 0:i.threshold)!==null&&r!==void 0?r:1;if(ML.set(this.getWorldPosition($0e),a),e.ray.intersectsSphere(ML)===!1)return;AL.copy(s.matrixWorld).invert(),J4.copy(e.ray).applyMatrix4(AL);const l=a/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=J4.distanceSqToPoint(this.position);if(u<c){const f=new $;J4.closestPointToPoint(this.position,f),f.applyMatrix4(this.matrixWorld);const d=e.ray.origin.distanceTo(f);if(d<e.near||d>e.far)return;n.push({distance:d,distanceToRay:Math.sqrt(u),point:f,index:o,face:null,object:this})}}}let od,hg;const TV=v.createContext(null),CL=new et,RL=new $,q0e=v.forwardRef(({children:t,range:e,limit:n=1e3,...r},i)=>{const s=v.useRef(null);v.useImperativeHandle(i,()=>s.current,[]);const[o,a]=v.useState([]),[[l,c,u]]=v.useState(()=>[new Float32Array(n*3),Float32Array.from({length:n*3},()=>1),Float32Array.from({length:n},()=>1)]);v.useEffect(()=>{s.current.geometry.attributes.position.needsUpdate=!0}),Yt(()=>{for(s.current.updateMatrix(),s.current.updateMatrixWorld(),CL.copy(s.current.matrixWorld).invert(),s.current.geometry.drawRange.count=Math.min(n,e!==void 0?e:n,o.length),od=0;od<o.length;od++)hg=o[od].current,hg.getWorldPosition(RL).applyMatrix4(CL),RL.toArray(l,od*3),s.current.geometry.attributes.position.needsUpdate=!0,hg.matrixWorldNeedsUpdate=!0,hg.color.toArray(c,od*3),s.current.geometry.attributes.color.needsUpdate=!0,u.set([hg.size],od),s.current.geometry.attributes.size.needsUpdate=!0});const f=v.useMemo(()=>({getParent:()=>s,subscribe:d=>(a(h=>[...h,d]),()=>a(h=>h.filter(p=>p.current!==d.current)))}),[]);return v.createElement("points",It({userData:{instances:o},matrixAutoUpdate:!1,ref:s,raycast:()=>null},r),v.createElement("bufferGeometry",null,v.createElement("bufferAttribute",{attach:"attributes-position",count:l.length/3,array:l,itemSize:3,usage:Ji}),v.createElement("bufferAttribute",{attach:"attributes-color",count:c.length/3,array:c,itemSize:3,usage:Ji}),v.createElement("bufferAttribute",{attach:"attributes-size",count:u.length,array:u,itemSize:1,usage:Ji})),v.createElement(TV.Provider,{value:f},t))}),H$e=v.forwardRef(({children:t,...e},n)=>{v.useMemo(()=>Gi({PositionPoint:X0e}),[]);const r=v.useRef(null);v.useImperativeHandle(n,()=>r.current,[]);const{subscribe:i,getParent:s}=v.useContext(TV);return v.useLayoutEffect(()=>i(r),[]),v.createElement("positionPoint",It({instance:s(),instanceKey:r,ref:r},e),t)}),Y0e=v.forwardRef(({children:t,positions:e,colors:n,sizes:r,stride:i=3,...s},o)=>{const a=v.useRef(null);return v.useImperativeHandle(o,()=>a.current,[]),Yt(()=>{const l=a.current.geometry.attributes;l.position.needsUpdate=!0,n&&(l.color.needsUpdate=!0),r&&(l.size.needsUpdate=!0)}),v.createElement("points",It({ref:a},s),v.createElement("bufferGeometry",null,v.createElement("bufferAttribute",{attach:"attributes-position",count:e.length/i,array:e,itemSize:i,usage:Ji}),n&&v.createElement("bufferAttribute",{attach:"attributes-color",count:n.length/i,array:n,itemSize:3,usage:Ji}),r&&v.createElement("bufferAttribute",{attach:"attributes-size",count:r.length/i,array:r,itemSize:1,usage:Ji})),t)}),AV=v.forwardRef((t,e)=>t.positions instanceof Float32Array?v.createElement(Y0e,It({},t,{ref:e})):v.createElement(q0e,It({},t,{ref:e}))),MV=v.createContext(null),CV=v.forwardRef((t,e)=>{v.useMemo(()=>Gi({SegmentObject:K0e}),[]);const{limit:n=1e3,lineWidth:r=1,children:i,...s}=t,[o,a]=v.useState([]),[l]=v.useState(()=>new DG),[c]=v.useState(()=>new eE),[u]=v.useState(()=>new Jb),[f]=v.useState(()=>new Ke(512,512)),[d]=v.useState(()=>Array(n*6).fill(0)),[h]=v.useState(()=>Array(n*6).fill(0)),p=v.useMemo(()=>({subscribe:m=>(a(g=>[...g,m]),()=>a(g=>g.filter(y=>y.current!==m.current)))}),[]);return Yt(()=>{for(let g=0;g<n;g++){var m;const y=(m=o[g])==null?void 0:m.current;y&&(d[g*6+0]=y.start.x,d[g*6+1]=y.start.y,d[g*6+2]=y.start.z,d[g*6+3]=y.end.x,d[g*6+4]=y.end.y,d[g*6+5]=y.end.z,h[g*6+0]=y.color.r,h[g*6+1]=y.color.g,h[g*6+2]=y.color.b,h[g*6+3]=y.color.r,h[g*6+4]=y.color.g,h[g*6+5]=y.color.b)}u.setColors(h),u.setPositions(d),l.computeLineDistances()}),v.createElement("primitive",{object:l,ref:e},v.createElement("primitive",{object:u,attach:"geometry"}),v.createElement("primitive",It({object:c,attach:"material",vertexColors:!0,resolution:f,linewidth:r},s)),v.createElement(MV.Provider,{value:p},i))});class K0e{constructor(){this.color=new wt("white"),this.start=new $(0,0,0),this.end=new $(0,0,0)}}const IL=t=>t instanceof $?t:new $(...typeof t=="number"?[t,t,t]:t),G$e=v.forwardRef(({color:t,start:e,end:n},r)=>{const i=v.useContext(MV);if(!i)throw"Segment must used inside Segments component.";const s=v.useRef(null);return v.useImperativeHandle(r,()=>s.current,[]),v.useLayoutEffect(()=>i.subscribe(s),[]),v.createElement("segmentObject",{ref:s,color:t,start:IL(e),end:IL(n)})}),RV=v.forwardRef(({children:t,hysteresis:e=0,distances:n,...r},i)=>{const s=v.useRef(null);return v.useImperativeHandle(i,()=>s.current,[]),v.useLayoutEffect(()=>{const{current:o}=s;o.levels.length=0,o.children.forEach((a,l)=>o.levels.push({object:a,hysteresis:e,distance:n[l]}))}),Yt(o=>{var a;return(a=s.current)==null?void 0:a.update(o.camera)}),v.createElement("lOD",It({ref:s},r),t)});function IV({all:t,scene:e,camera:n}){const r=At(({gl:o})=>o),i=At(({camera:o})=>o),s=At(({scene:o})=>o);return v.useLayoutEffect(()=>{const o=[];t&&(e||s).traverse(c=>{c.visible===!1&&(o.push(c),c.visible=!0)}),r.compile(e||s,n||i);const a=new Fm(128);new wb(.01,1e5,a).update(r,e||s),a.dispose(),o.forEach(c=>c.visible=!1)},[]),null}function PV(){const t=At(e=>e.gl);return v.useEffect(()=>(t.shadowMap.autoUpdate=!1,t.shadowMap.needsUpdate=!0,()=>{t.shadowMap.autoUpdate=t.shadowMap.needsUpdate=!0}),[t.shadowMap]),null}function kV({pixelated:t}){const e=At(o=>o.gl),n=At(o=>o.internal.active),r=At(o=>o.performance.current),i=At(o=>o.viewport.initialDpr),s=At(o=>o.setDpr);return v.useEffect(()=>{const o=e.domElement;return()=>{n&&s(i),t&&o&&(o.style.imageRendering="auto")}},[]),v.useEffect(()=>{s(r*i),t&&e.domElement&&(e.domElement.style.imageRendering=r===1?"auto":"pixelated")},[r]),null}function LV(){const t=At(r=>r.get),e=At(r=>r.setEvents),n=At(r=>r.performance.current);return v.useEffect(()=>{const r=t().events.enabled;return()=>e({enabled:r})},[]),v.useEffect(()=>e({enabled:n===1}),[n]),null}const DV=v.createContext(null);function NV({iterations:t=10,ms:e=250,threshold:n=.75,step:r=.1,factor:i=.5,flipflops:s=1/0,bounds:o=d=>d>100?[60,100]:[40,60],onIncline:a,onDecline:l,onChange:c,onFallback:u,children:f}){const d=Math.pow(10,0),[h,p]=v.useState(()=>({fps:0,index:0,factor:i,flipped:0,refreshrate:0,fallback:!1,frames:[],averages:[],subscriptions:new Map,subscribe:g=>{const y=Symbol();return h.subscriptions.set(y,g.current),()=>void h.subscriptions.delete(y)}}));let m=0;return Yt(()=>{const{frames:g,averages:y}=h;if(!h.fallback&&y.length<t){g.push(performance.now());const x=g[g.length-1]-g[0];if(x>=e){if(h.fps=Math.round(g.length/x*1e3*d)/d,h.refreshrate=Math.max(h.refreshrate,h.fps),y[h.index++%t]=h.fps,y.length===t){const[_,w]=o(h.refreshrate),T=y.filter(C=>C>=w),S=y.filter(C=>C<_);T.length>t*n&&(h.factor=Math.min(1,h.factor+r),h.flipped++,a&&a(h),h.subscriptions.forEach(C=>C.onIncline&&C.onIncline(h))),S.length>t*n&&(h.factor=Math.max(0,h.factor-r),h.flipped++,l&&l(h),h.subscriptions.forEach(C=>C.onDecline&&C.onDecline(h))),m!==h.factor&&(m=h.factor,c&&c(h),h.subscriptions.forEach(C=>C.onChange&&C.onChange(h))),h.flipped>s&&!h.fallback&&(h.fallback=!0,u&&u(h),h.subscriptions.forEach(C=>C.onFallback&&C.onFallback(h))),h.averages=[]}h.frames=[]}}}),v.createElement(DV.Provider,{value:h},f)}function j$e({onIncline:t,onDecline:e,onChange:n,onFallback:r}){const i=v.useContext(DV),s=v.useRef({onIncline:t,onDecline:e,onChange:n,onFallback:r});v.useLayoutEffect(()=>{s.current.onIncline=t,s.current.onDecline=e,s.current.onChange=n,s.current.onFallback=r},[t,e,n,r]),v.useLayoutEffect(()=>i.subscribe(s),[i])}const UC=v.forwardRef(({children:t,compute:e,width:n,height:r,samples:i=8,renderPriority:s=0,eventPriority:o=0,frames:a=1/0,stencilBuffer:l=!1,depthBuffer:c=!0,generateMipmaps:u=!1,...f},d)=>{const{size:h,viewport:p}=At(),m=Mo((n||h.width)*p.dpr,(r||h.height)*p.dpr,{samples:i,stencilBuffer:l,depthBuffer:c,generateMipmaps:u}),[g]=v.useState(()=>new ls),y=v.useCallback((x,_,w)=>{var T,S;let C=(T=m.texture)==null?void 0:T.__r3f.parent;for(;C&&!(C instanceof yn);)C=C.__r3f.parent;if(!C)return!1;w.raycaster.camera||w.events.compute(x,w,(S=w.previousRoot)==null?void 0:S.getState());const[A]=w.raycaster.intersectObject(C);if(!A)return!1;const R=A.uv;if(!R)return!1;_.raycaster.setFromCamera(_.pointer.set(R.x*2-1,R.y*2-1),_.camera)},[]);return v.useImperativeHandle(d,()=>m.texture,[m]),v.createElement(v.Fragment,null,Al(v.createElement(Z0e,{renderPriority:s,frames:a,fbo:m},t,v.createElement("group",{onPointerOver:()=>null})),g,{events:{compute:e||y,priority:o}}),v.createElement("primitive",It({object:m.texture},f)))});function Z0e({frames:t,renderPriority:e,children:n,fbo:r}){let i=0,s,o,a,l;return Yt(c=>{(t===1/0||i<t)&&(s=c.gl.autoClear,o=c.gl.xr.enabled,a=c.gl.getRenderTarget(),l=c.gl.xr.isPresenting,c.gl.autoClear=!0,c.gl.xr.enabled=!1,c.gl.xr.isPresenting=!1,c.gl.setRenderTarget(r),c.gl.render(c.scene,c.camera),c.gl.setRenderTarget(a),c.gl.autoClear=s,c.gl.xr.enabled=o,c.gl.xr.isPresenting=l,i++)},e),v.createElement(v.Fragment,null,n)}const BC=v.forwardRef(({children:t,compute:e,renderPriority:n=-1,eventPriority:r=0,frames:i=1/0,stencilBuffer:s=!1,depthBuffer:o=!0,generateMipmaps:a=!1,resolution:l=896,near:c=.1,far:u=1e3,flip:f=!1,position:d,rotation:h,scale:p,quaternion:m,matrix:g,matrixAutoUpdate:y,...x},_)=>{const{size:w,viewport:T}=At(),S=v.useRef(null),C=v.useMemo(()=>{const R=new Fm(Math.max((l||w.width)*T.dpr,(l||w.height)*T.dpr),{stencilBuffer:s,depthBuffer:o,generateMipmaps:a});return R.texture.isRenderTargetTexture=!f,R.texture.flipY=!0,R.texture.type=ti,R},[l,f]);v.useEffect(()=>()=>C.dispose(),[C]);const[A]=v.useState(()=>new ls);return v.useImperativeHandle(_,()=>({scene:A,fbo:C,camera:S.current}),[C]),v.createElement(v.Fragment,null,Al(v.createElement(Q0e,{renderPriority:n,frames:i,camera:S},t,v.createElement("group",{onPointerOver:()=>null})),A,{events:{compute:e,priority:r}}),v.createElement("primitive",It({object:C.texture},x)),v.createElement("cubeCamera",{ref:S,args:[c,u,C],position:d,rotation:h,scale:p,quaternion:m,matrix:g,matrixAutoUpdate:y}))});function Q0e({frames:t,renderPriority:e,children:n,camera:r}){let i=0;return Yt(s=>{(t===1/0||i<t)&&(r.current.update(s.gl,s.scene),i++)},e),v.createElement(v.Fragment,null,n)}const OV=v.forwardRef(({id:t=1,colorWrite:e=!1,depthWrite:n=!1,...r},i)=>{const s=v.useRef(null),o=v.useMemo(()=>({colorWrite:e,depthWrite:n,stencilWrite:!0,stencilRef:t,stencilFunc:a_,stencilFail:c3,stencilZFail:c3,stencilZPass:c3}),[t,e,n]);return v.useLayoutEffect(()=>{Object.assign(s.current.material,o)}),v.useImperativeHandle(i,()=>s.current,[]),v.createElement("mesh",It({ref:s,renderOrder:-t},r))});function V$e(t,e=!1){return{stencilWrite:!0,stencilRef:t,stencilFunc:e?wz:Ez,stencilFail:$l,stencilZFail:$l,stencilZPass:$l}}function FV({renderPriority:t=1,zoom:e=0,segments:n=64,children:r,resolution:i=896,...s}){const o=v.useRef(null),a=v.useRef(null),{width:l,height:c}=At(g=>g.size),[u]=v.useState(()=>new Hi);v.useLayoutEffect(()=>{u.position.set(0,0,100),u.zoom=100,u.left=l/-2,u.right=l/2,u.top=c/2,u.bottom=c/-2,u.updateProjectionMatrix()},[l,c]);const f=Math.sqrt(l*l+c*c)/100*(.5+e/2),d=new $,h=new wr(new $,f),p=new Ln,m=v.useCallback((g,y,x)=>{if(y.pointer.set(g.offsetX/y.size.width*2-1,-(g.offsetY/y.size.height)*2+1),y.raycaster.setFromCamera(y.pointer,u),y.raycaster.ray.intersectSphere(h,d))d.normalize();else return;p.getNormalMatrix(a.current.camera.matrixWorld),a.current.camera.getWorldPosition(y.raycaster.ray.origin),y.raycaster.ray.direction.set(0,0,1).reflect(d),y.raycaster.ray.direction.x*=-1,y.raycaster.ray.direction.applyNormalMatrix(p).multiplyScalar(-1)},[]);return Yt(g=>{t&&g.gl.render(o.current,u)},t),v.createElement(v.Fragment,null,v.createElement("mesh",It({ref:o},s,{scale:f}),v.createElement("sphereGeometry",{args:[1,n,n]}),v.createElement("meshBasicMaterial",null,v.createElement(BC,{compute:m,attach:"envMap",flip:!0,resolution:i,ref:a},r,v.createElement(J0e,{api:a})))))}function J0e({api:t}){const e=new $,n=new bn,r=new $,i=new xr(0,Math.PI,0);return Yt(s=>{s.camera.matrixWorld.decompose(e,n,r),t.current.camera.position.copy(e),t.current.camera.quaternion.setFromEuler(i).premultiply(n)}),null}const ege=Ml({blur:0,map:null,sdf:null,blend:0,size:0,resolution:new Ke},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
     vUv = uv;
   }`,`uniform sampler2D sdf;
   uniform sampler2D map;
   uniform float blur;
   uniform float size;
   uniform float time;
   uniform vec2 resolution;
   varying vec2 vUv;
   #include <packing>
   void main() {
     vec2 uv = gl_FragCoord.xy / resolution.xy;
     vec4 t = texture2D(map, uv);
     float k = blur;
     float d = texture2D(sdf, vUv).r/size;
     float alpha = 1.0 - smoothstep(0.0, 1.0, clamp(d/k + 1.0, 0.0, 1.0));
     gl_FragColor = vec4(t.rgb, blur == 0.0 ? t.a : t.a * alpha);
     #include <tonemapping_fragment>
     #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),UV=v.forwardRef(({children:t,events:e=void 0,blur:n=0,eventPriority:r=0,renderPriority:i=0,worldUnits:s=!1,resolution:o=512,...a},l)=>{Gi({PortalMaterialImpl:ege});const c=v.useRef(null),{scene:u,gl:f,size:d,viewport:h,setEvents:p}=At(),m=Mo(o,o),[g,y]=v.useState(0);Yt(()=>{const S=c.current.blend>0?Math.max(1,i):0;g!==S&&y(S)}),v.useEffect(()=>{e!==void 0&&p({enabled:!e})},[e]);const[x,_]=v.useState(!0),w=Ime(_);v.useLayoutEffect(()=>{var S;w.current=(S=c.current)==null?void 0:S.__r3f.parent},[]),v.useLayoutEffect(()=>{if(w.current&&n&&c.current.sdf===null){const S=new ln(w.current.geometry,new Fr),C=new Kn().setFromBufferAttribute(S.geometry.attributes.position),A=new Hi(C.min.x*(1+2/o),C.max.x*(1+2/o),C.max.y*(1+2/o),C.min.y*(1+2/o),.1,1e3);A.position.set(0,0,1),A.lookAt(0,0,0),f.setRenderTarget(m),f.render(S,A);const M=nge(o,o,f)(m.texture),D=new Float32Array(o*o);f.readRenderTargetPixels(M,0,0,o,o,D);let k=1/0;for(let L=0;L<D.length;L++)D[L]<k&&(k=D[L]);k=-k,c.current.size=k,c.current.sdf=M.texture,f.setRenderTarget(null)}},[o,n]),v.useImperativeHandle(l,()=>c.current);const T=v.useCallback((S,C,A)=>{var R;if(!w.current)return!1;if(C.pointer.set(S.offsetX/C.size.width*2-1,-(S.offsetY/C.size.height)*2+1),C.raycaster.setFromCamera(C.pointer,C.camera),((R=c.current)==null?void 0:R.blend)===0){const[M]=C.raycaster.intersectObject(w.current);if(!M)return C.raycaster.camera=void 0,!1}},[]);return v.createElement("portalMaterialImpl",It({ref:c,blur:n,blend:0,resolution:[d.width*h.dpr,d.height*h.dpr],attach:"material"},a),v.createElement(UC,{attach:"map",frames:x?1/0:0,eventPriority:r,renderPriority:i,compute:T},t,v.createElement(tge,{events:e,rootScene:u,priority:g,material:c,worldUnits:s})))});function tge({events:t=void 0,rootScene:e,material:n,priority:r,worldUnits:i}){const s=At(f=>f.scene),o=At(f=>f.setEvents),a=Mo(),l=Mo();v.useLayoutEffect(()=>{s.matrixAutoUpdate=!1},[]),v.useEffect(()=>{t!==void 0&&o({enabled:t})},[t]);const[c,u]=v.useMemo(()=>{const f={value:0};return[new Gc(new yr({uniforms:{a:{value:a.texture},b:{value:l.texture},blend:f},vertexShader:`
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          }`,fragmentShader:`
          uniform sampler2D a;
          uniform sampler2D b;
          uniform float blend;
          varying vec2 vUv;
          #include <packing>
          void main() {
            vec4 ta = texture2D(a, vUv);
            vec4 tb = texture2D(b, vUv);
            gl_FragColor = mix(tb, ta, blend);
            #include <tonemapping_fragment>
            #include <${Ro>=154?"colorspace_fragment":"encodings_fragment"}>
          }`})),f]},[]);return Yt(f=>{var d;let h=n==null||(d=n.current)==null?void 0:d.__r3f.parent;if(h){if(i)s.matrixWorld.identity();else{var p;r&&((p=n.current)==null?void 0:p.blend)===1&&h.updateWorldMatrix(!0,!1),s.matrixWorld.copy(h.matrixWorld)}if(r){var m,g,y;((m=n.current)==null?void 0:m.blend)>0&&((g=n.current)==null?void 0:g.blend)<1?(u.value=n.current.blend,f.gl.setRenderTarget(a),f.gl.render(s,f.camera),f.gl.setRenderTarget(l),f.gl.render(e,f.camera),f.gl.setRenderTarget(null),c.render(f.gl)):((y=n.current)==null?void 0:y.blend)===1&&f.gl.render(s,f.camera)}}},r),v.createElement(v.Fragment,null)}const nge=(t,e,n)=>{let r=new fr(t,e,{minFilter:Ts,magFilter:Pn,type:pr,format:Yc,generateMipmaps:!0}),i=new fr(t,e,{minFilter:zn,magFilter:zn}),s=new fr(t,e,{minFilter:zn,magFilter:zn}),o=new fr(t,e,{minFilter:zn,magFilter:zn}),a=new fr(t,e,{minFilter:zn,magFilter:zn}),l=new fr(t,e,{minFilter:zn,magFilter:zn,type:pr,format:Yc}),c=new fr(t,e,{minFilter:zn,magFilter:zn,type:pr,format:Yc});const u=new Gc(new yr({uniforms:{tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        uniform sampler2D tex;
        varying vec2 vUv;
        #include <packing>
        void main() {
          gl_FragColor = pack2HalfToRGBA(vUv * (round(texture2D(tex, vUv).x)));
        }`})),f=new Gc(new yr({uniforms:{tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        uniform sampler2D tex;
        varying vec2 vUv;
        #include <packing>
        void main() {
          gl_FragColor = pack2HalfToRGBA(vUv * (1.0 - round(texture2D(tex, vUv).x)));
        }`})),d=new Gc(new yr({uniforms:{tex:{value:null},offset:{value:0},level:{value:0},maxSteps:{value:0}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D tex;
        uniform float offset;
        uniform float level;
        uniform float maxSteps;
        #include <packing>
        void main() {
          float closestDist = 9999999.9;
          vec2 closestPos = vec2(0.0);
          for (float x = -1.0; x <= 1.0; x += 1.0) {
            for (float y = -1.0; y <= 1.0; y += 1.0) {
              vec2 voffset = vUv;
              voffset += vec2(x, y) * vec2(${1/t}, ${1/e}) * offset;
              vec2 pos = unpackRGBATo2Half(texture2D(tex, voffset));
              float dist = distance(pos.xy, vUv);
              if(pos.x != 0.0 && pos.y != 0.0 && dist < closestDist) {
                closestDist = dist;
                closestPos = pos;
              }
            }
          }
          gl_FragColor = pack2HalfToRGBA(closestPos);
        }`})),h=new Gc(new yr({uniforms:{tex:{value:null},size:{value:new Ke(t,e)}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D tex;
        uniform vec2 size;
        #include <packing>
        void main() {
          gl_FragColor = vec4(distance(size * unpackRGBATo2Half(texture2D(tex, vUv)), size * vUv), 0.0, 0.0, 0.0);
        }`})),p=new Gc(new yr({uniforms:{inside:{value:c.texture},outside:{value:l.texture},tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D inside;
        uniform sampler2D outside;
        uniform sampler2D tex;
        #include <packing>
        void main() {
          float i = texture2D(inside, vUv).x;
          float o =texture2D(outside, vUv).x;
          if (texture2D(tex, vUv).x == 0.0) {
            gl_FragColor = vec4(o, 0.0, 0.0, 0.0);
          } else {
            gl_FragColor = vec4(-i, 0.0, 0.0, 0.0);
          }
        }`}));return m=>{let g=r;m.minFilter=zn,m.magFilter=zn,u.material.uniforms.tex.value=m,n.setRenderTarget(i),u.render(n);const y=Math.ceil(Math.log(Math.max(t,e))/Math.log(2));let x=i,_=null;for(let w=0;w<y;w++){const T=Math.pow(2,y-w-1);_=x===i?o:i,d.material.uniforms.level.value=w,d.material.uniforms.maxSteps.value=y,d.material.uniforms.offset.value=T,d.material.uniforms.tex.value=x.texture,n.setRenderTarget(_),d.render(n),x=_}n.setRenderTarget(l),h.material.uniforms.tex.value=_.texture,h.render(n),f.material.uniforms.tex.value=m,n.setRenderTarget(s),f.render(n),x=s;for(let w=0;w<y;w++){const T=Math.pow(2,y-w-1);_=x===s?a:s,d.material.uniforms.level.value=w,d.material.uniforms.maxSteps.value=y,d.material.uniforms.offset.value=T,d.material.uniforms.tex.value=x.texture,n.setRenderTarget(_),d.render(n),x=_}return n.setRenderTarget(c),h.material.uniforms.tex.value=_.texture,h.render(n),n.setRenderTarget(g),p.material.uniforms.tex.value=m,p.render(n),n.setRenderTarget(null),g}},rge={BASE_ASSETS:"/",BASE_SERVER:"/",BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_CLERK_PUBLISHABLE_KEY:"pk_test_Z3JhbmQtdmlwZXItNjAuY2xlcmsuYWNjb3VudHMuZGV2JA"},PL=t=>{let e;const n=new Set,r=(u,f)=>{const d=typeof u=="function"?u(e):u;if(!Object.is(d,e)){const h=e;e=f??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(p=>p(e,h))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(rge?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},BV=t=>t?PL(t):PL;var zV={exports:{}},eT={},tT={exports:{}},nT={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kL;function ige(){if(kL)return nT;kL=1;var t=v;function e(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function a(f,d){var h=d(),p=r({inst:{value:h,getSnapshot:d}}),m=p[0].inst,g=p[1];return s(function(){m.value=h,m.getSnapshot=d,l(m)&&g({inst:m})},[f,h,d]),i(function(){return l(m)&&g({inst:m}),f(function(){l(m)&&g({inst:m})})},[f]),o(h),h}function l(f){var d=f.getSnapshot;f=f.value;try{var h=d();return!n(f,h)}catch{return!0}}function c(f,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return nT.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,nT}var LL;function sge(){return LL||(LL=1,tT.exports=ige()),tT.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DL;function oge(){if(DL)return eT;DL=1;var t=v,e=sge();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,a=t.useMemo,l=t.useDebugValue;return eT.useSyncExternalStoreWithSelector=function(c,u,f,d,h){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=a(function(){function y(S){if(!x){if(x=!0,_=S,S=d(S),h!==void 0&&m.hasValue){var C=m.value;if(h(C,S))return w=C}return w=S}if(C=w,r(_,S))return C;var A=d(S);return h!==void 0&&h(C,A)?C:(_=S,w=A)}var x=!1,_,w,T=f===void 0?null:f;return[function(){return y(u())},T===null?void 0:function(){return y(T())}]},[u,f,d,h]);var g=i(c,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=g},[g]),l(g),g},eT}zV.exports=oge();var age=zV.exports;const lge=Zd(age),HV={BASE_ASSETS:"/",BASE_SERVER:"/",BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_CLERK_PUBLISHABLE_KEY:"pk_test_Z3JhbmQtdmlwZXItNjAuY2xlcmsuYWNjb3VudHMuZGV2JA"},{useDebugValue:cge}=Ge,{useSyncExternalStoreWithSelector:uge}=lge;let NL=!1;const fge=t=>t;function zC(t,e=fge,n){(HV?"production":void 0)!=="production"&&n&&!NL&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),NL=!0);const r=uge(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return cge(r),r}const OL=t=>{(HV?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?BV(t):t,n=(r,i)=>zC(e,r,i);return Object.assign(n,e),n},GV=t=>t?OL(t):OL;var FL,UL;const BL=typeof window<"u"&&((FL=window.document)!=null&&FL.createElement||((UL=window.navigator)==null?void 0:UL.product)==="ReactNative")?Ge.useLayoutEffect:Ge.useEffect;function jV(){const t=GV(e=>({current:new Array,version:0,set:e}));return{In:({children:e})=>{const n=t(i=>i.set),r=t(i=>i.version);return BL(()=>{n(i=>({version:i.version+1}))},[]),BL(()=>(n(({current:i})=>({current:[...i,e]})),()=>n(({current:i})=>({current:i.filter(s=>s!==e)}))),[e,r]),null},Out:()=>{const e=t(n=>n.current);return Ge.createElement(Ge.Fragment,null,e)}}}const dge=t=>t&&t.isOrthographicCamera,zL=new wt,VV=jV();function WV(t){return"top"in t}function rT(t,e){const{right:n,top:r,left:i,bottom:s,width:o,height:a}=e,l=e.bottom<0||r>t.height||n<0||e.left>t.width;if(WV(t)){const f=t.top+t.height-s,d=i-t.left;return{position:{width:o,height:a,left:d,top:r,bottom:f,right:n},isOffscreen:l}}const c=t.height-s;return{position:{width:o,height:a,top:r,left:i,bottom:c,right:n},isOffscreen:l}}function iT(t,{left:e,bottom:n,width:r,height:i}){let s;const o=r/i;return dge(t.camera)?(t.camera.left!==r/-2||t.camera.right!==r/2||t.camera.top!==i/2||t.camera.bottom!==i/-2)&&(Object.assign(t.camera,{left:r/-2,right:r/2,top:i/2,bottom:i/-2}),t.camera.updateProjectionMatrix()):t.camera.aspect!==o&&(t.camera.aspect=o,t.camera.updateProjectionMatrix()),s=t.gl.autoClear,t.gl.autoClear=!1,t.gl.setViewport(e,n,r,i),t.gl.setScissor(e,n,r,i),t.gl.setScissorTest(!0),s}function sT(t,e){t.gl.setScissorTest(!1),t.gl.autoClear=e}function HL(t){t.gl.getClearColor(zL),t.gl.setClearColor(zL,t.gl.getClearAlpha()),t.gl.clear(!0,!0)}function hge({visible:t=!0,canvasSize:e,scene:n,index:r,children:i,frames:s,rect:o,track:a}){const l=At(),[c,u]=v.useState(!1);let f=0;return Yt(d=>{if(s===1/0||f<=s){var h;a&&(o.current=(h=a.current)==null?void 0:h.getBoundingClientRect()),f++}if(o.current){const{position:p,isOffscreen:m}=rT(e,o.current);if(c!==m&&u(m),t&&!c&&o.current){const g=iT(d,p);d.gl.render(i?d.scene:n,d.camera),sT(d,g)}}},r),v.useLayoutEffect(()=>{const d=o.current;if(d&&(!t||!c)){const{position:h}=rT(e,d),p=iT(l,h);HL(l),sT(l,p)}},[t,c]),v.useEffect(()=>{if(!a)return;const d=o.current,h=l.get().events.connected;return l.setEvents({connected:a.current}),()=>{if(d){const{position:p}=rT(e,d),m=iT(l,p);HL(l),sT(l,m)}l.setEvents({connected:h})}},[a]),v.useEffect(()=>{WV(e)||console.warn(`Detected @react-three/fiber canvas size does not include position information. <View /> may not work as expected. Upgrade to @react-three/fiber ^8.1.0 for support.
 See https://github.com/pmndrs/drei/issues/944`)},[]),v.createElement(v.Fragment,null,i,v.createElement("group",{onPointerOver:()=>null}))}const $V=v.forwardRef(({track:t,visible:e=!0,index:n=1,id:r,style:i,className:s,frames:o=1/0,children:a,...l},c)=>{var u,f,d,h;const p=v.useRef(null),{size:m,scene:g}=At(),[y]=v.useState(()=>new ls),[x,_]=v.useReducer(()=>!0,!1),w=v.useCallback((T,S)=>{if(p.current&&t&&t.current&&T.target===t.current){const{width:C,height:A,left:R,top:M}=p.current,D=T.clientX-R,k=T.clientY-M;S.pointer.set(D/C*2-1,-(k/A)*2+1),S.raycaster.setFromCamera(S.pointer,S.camera)}},[p,t]);return v.useEffect(()=>{var T;t&&(p.current=(T=t.current)==null?void 0:T.getBoundingClientRect()),_()},[t]),v.createElement("group",It({ref:c},l),x&&Al(v.createElement(hge,{visible:e,canvasSize:m,frames:o,scene:g,track:t,rect:p,index:n},a),y,{events:{compute:w,priority:n},size:{width:(u=p.current)==null?void 0:u.width,height:(f=p.current)==null?void 0:f.height,top:(d=p.current)==null?void 0:d.top,left:(h=p.current)==null?void 0:h.left}}))}),pge=v.forwardRef(({as:t="div",id:e,visible:n,className:r,style:i,index:s=1,track:o,frames:a=1/0,children:l,...c},u)=>{const f=v.useId(),d=v.useRef(null);return v.useImperativeHandle(u,()=>d.current),v.createElement(v.Fragment,null,v.createElement(t,It({ref:d,id:e,className:r,style:i},c)),v.createElement(VV.In,null,v.createElement($V,{visible:n,key:f,track:d,frames:a,index:s},l)))}),HC=v.forwardRef((t,e)=>v.useContext(lh)?v.createElement($V,It({ref:e},t)):v.createElement(pge,It({ref:e},t)));HC.Port=()=>v.createElement(VV.Out,null);const Iy=v.createContext(null),mx=new $,GL=new $,mge=(t,e,n,r)=>{const i=e.dot(e),s=e.dot(t)-e.dot(n),o=e.dot(r);return o===0?-s/i:(mx.copy(r).multiplyScalar(i/o).sub(e),GL.copy(r).multiplyScalar(s/o).add(n).sub(t),-mx.dot(GL)/mx.dot(mx))},gge=new $(0,1,0),jL=new et,oT=({direction:t,axis:e})=>{const{translation:n,translationLimits:r,annotations:i,annotationsClass:s,depthTest:o,scale:a,lineWidth:l,fixed:c,axisColors:u,hoveredColor:f,opacity:d,onDragStart:h,onDrag:p,onDragEnd:m,userData:g}=v.useContext(Iy),y=At(K=>K.controls),x=v.useRef(null),_=v.useRef(null),w=v.useRef(null),T=v.useRef(0),[S,C]=v.useState(!1),A=v.useCallback(K=>{i&&(x.current.innerText=`${n.current[e].toFixed(2)}`,x.current.style.display="block"),K.stopPropagation();const V=new et().extractRotation(_.current.matrixWorld),ne=K.point.clone(),re=new $().setFromMatrixPosition(_.current.matrixWorld),P=t.clone().applyMatrix4(V).normalize();w.current={clickPoint:ne,dir:P},T.current=n.current[e],h({component:"Arrow",axis:e,origin:re,directions:[P]}),y&&(y.enabled=!1),K.target.setPointerCapture(K.pointerId)},[i,t,y,h,n,e]),R=v.useCallback(K=>{if(K.stopPropagation(),S||C(!0),w.current){const{clickPoint:V,dir:ne}=w.current,[re,P]=(r==null?void 0:r[e])||[void 0,void 0];let se=mge(V,ne,K.ray.origin,K.ray.direction);re!==void 0&&(se=Math.max(se,re-T.current)),P!==void 0&&(se=Math.min(se,P-T.current)),n.current[e]=T.current+se,i&&(x.current.innerText=`${n.current[e].toFixed(2)}`),jL.makeTranslation(ne.x*se,ne.y*se,ne.z*se),p(jL)}},[i,p,S,n,r,e]),M=v.useCallback(K=>{i&&(x.current.style.display="none"),K.stopPropagation(),w.current=null,m(),y&&(y.enabled=!0),K.target.releasePointerCapture(K.pointerId)},[i,y,m]),D=v.useCallback(K=>{K.stopPropagation(),C(!1)},[]),{cylinderLength:k,coneWidth:L,coneLength:N,matrixL:z}=v.useMemo(()=>{const K=c?l/a*1.6:a/20,V=c?.2:a/5,ne=c?1-V:a-V,re=new bn().setFromUnitVectors(gge,t.clone().normalize()),P=new et().makeRotationFromQuaternion(re);return{cylinderLength:ne,coneWidth:K,coneLength:V,matrixL:P}},[t,a,l,c]),O=S?f:u[e];return v.createElement("group",{ref:_},v.createElement("group",{matrix:z,matrixAutoUpdate:!1,onPointerDown:A,onPointerMove:R,onPointerUp:M,onPointerOut:D},i&&v.createElement(ch,{position:[0,-N,0]},v.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:s,ref:x})),v.createElement("mesh",{visible:!1,position:[0,(k+N)/2,0],userData:g},v.createElement("cylinderGeometry",{args:[L*1.4,L*1.4,k+N,8,1]})),v.createElement(Ni,{transparent:!0,raycast:()=>null,depthTest:o,points:[0,0,0,0,k,0],lineWidth:l,side:Nr,color:O,opacity:d,polygonOffset:!0,renderOrder:1,polygonOffsetFactor:-10,fog:!1}),v.createElement("mesh",{raycast:()=>null,position:[0,k+N/2,0],renderOrder:500},v.createElement("coneGeometry",{args:[L,N,24,1]}),v.createElement("meshBasicMaterial",{transparent:!0,depthTest:o,color:O,opacity:d,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},aT=new $,lT=new $,cT=t=>t*180/Math.PI,yge=t=>t*Math.PI/180,vge=(t,e,n,r,i)=>{aT.copy(t).sub(n),lT.copy(e).sub(n);const s=r.dot(r),o=i.dot(i),a=aT.dot(r)/s,l=aT.dot(i)/o,c=lT.dot(r)/s,u=lT.dot(i)/o,f=Math.atan2(l,a);return Math.atan2(u,c)-f},xge=(t,e)=>{let n=Math.floor(t/e);return n=n<0?n+1:n,t-n*e},VL=t=>{let e=xge(t,2*Math.PI);return Math.abs(e)<1e-6?0:(e<0&&(e+=2*Math.PI),e)},gx=new et,WL=new $,yx=new Yo,uT=new $,fT=({dir1:t,dir2:e,axis:n})=>{const{rotationLimits:r,annotations:i,annotationsClass:s,depthTest:o,scale:a,lineWidth:l,fixed:c,axisColors:u,hoveredColor:f,opacity:d,onDragStart:h,onDrag:p,onDragEnd:m,userData:g}=v.useContext(Iy),y=At(O=>O.controls),x=v.useRef(null),_=v.useRef(null),w=v.useRef(0),T=v.useRef(0),S=v.useRef(null),[C,A]=v.useState(!1),R=v.useCallback(O=>{i&&(x.current.innerText=`${cT(T.current).toFixed(0)}`,x.current.style.display="block"),O.stopPropagation();const K=O.point.clone(),V=new $().setFromMatrixPosition(_.current.matrixWorld),ne=new $().setFromMatrixColumn(_.current.matrixWorld,0).normalize(),re=new $().setFromMatrixColumn(_.current.matrixWorld,1).normalize(),P=new $().setFromMatrixColumn(_.current.matrixWorld,2).normalize(),se=new Oi().setFromNormalAndCoplanarPoint(P,V);S.current={clickPoint:K,origin:V,e1:ne,e2:re,normal:P,plane:se},h({component:"Rotator",axis:n,origin:V,directions:[ne,re,P]}),y&&(y.enabled=!1),O.target.setPointerCapture(O.pointerId)},[i,y,h,n]),M=v.useCallback(O=>{if(O.stopPropagation(),C||A(!0),S.current){const{clickPoint:K,origin:V,e1:ne,e2:re,normal:P,plane:se}=S.current,[ue,te]=(r==null?void 0:r[n])||[void 0,void 0];yx.copy(O.ray),yx.intersectPlane(se,uT),yx.direction.negate(),yx.intersectPlane(se,uT);let W=vge(K,uT,V,ne,re),X=cT(W);O.shiftKey&&(X=Math.round(X/10)*10,W=yge(X)),ue!==void 0&&te!==void 0&&te-ue<2*Math.PI?(W=VL(W),W=W>Math.PI?W-2*Math.PI:W,W=ri.clamp(W,ue-w.current,te-w.current),T.current=w.current+W):(T.current=VL(w.current+W),T.current=T.current>Math.PI?T.current-2*Math.PI:T.current),i&&(X=cT(T.current),x.current.innerText=`${X.toFixed(0)}`),gx.makeRotationAxis(P,W),WL.copy(V).applyMatrix4(gx).sub(V).negate(),gx.setPosition(WL),p(gx)}},[i,p,C,r,n]),D=v.useCallback(O=>{i&&(x.current.style.display="none"),O.stopPropagation(),w.current=T.current,S.current=null,m(),y&&(y.enabled=!0),O.target.releasePointerCapture(O.pointerId)},[i,y,m]),k=v.useCallback(O=>{O.stopPropagation(),A(!1)},[]),L=v.useMemo(()=>{const O=t.clone().normalize(),K=e.clone().normalize();return new et().makeBasis(O,K,O.clone().cross(K))},[t,e]),N=c?.65:a*.65,z=v.useMemo(()=>{const K=[];for(let V=0;V<=32;V++){const ne=V*(Math.PI/2)/32;K.push(new $(Math.cos(ne)*N,Math.sin(ne)*N,0))}return K},[N]);return v.createElement("group",{ref:_,onPointerDown:R,onPointerMove:M,onPointerUp:D,onPointerOut:k,matrix:L,matrixAutoUpdate:!1},i&&v.createElement(ch,{position:[N,N,0]},v.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:s,ref:x})),v.createElement(Ni,{points:z,lineWidth:l*4,visible:!1,userData:g}),v.createElement(Ni,{transparent:!0,raycast:()=>null,depthTest:o,points:z,lineWidth:l,side:Nr,color:C?f:u[n],opacity:d,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))},_ge=(t,e,n)=>{const r=Math.abs(t.x)>=Math.abs(t.y)&&Math.abs(t.x)>=Math.abs(t.z)?0:Math.abs(t.y)>=Math.abs(t.x)&&Math.abs(t.y)>=Math.abs(t.z)?1:2,i=[0,1,2].sort((p,m)=>Math.abs(e.getComponent(m))-Math.abs(e.getComponent(p))),s=r===i[0]?i[1]:i[0],o=t.getComponent(r),a=t.getComponent(s),l=e.getComponent(r),c=e.getComponent(s),u=n.getComponent(r),d=(n.getComponent(s)-u*(a/o))/(c-l*(a/o));return[(u-d*l)/o,d]},vx=new Yo,xx=new $,$L=new et,dT=({dir1:t,dir2:e,axis:n})=>{const{translation:r,translationLimits:i,annotations:s,annotationsClass:o,depthTest:a,scale:l,lineWidth:c,fixed:u,axisColors:f,hoveredColor:d,opacity:h,onDragStart:p,onDrag:m,onDragEnd:g,userData:y}=v.useContext(Iy),x=At(ne=>ne.controls),_=v.useRef(null),w=v.useRef(null),T=v.useRef(null),S=v.useRef(0),C=v.useRef(0),[A,R]=v.useState(!1),M=v.useCallback(ne=>{s&&(_.current.innerText=`${r.current[(n+1)%3].toFixed(2)}, ${r.current[(n+2)%3].toFixed(2)}`,_.current.style.display="block"),ne.stopPropagation();const re=ne.point.clone(),P=new $().setFromMatrixPosition(w.current.matrixWorld),se=new $().setFromMatrixColumn(w.current.matrixWorld,0).normalize(),ue=new $().setFromMatrixColumn(w.current.matrixWorld,1).normalize(),te=new $().setFromMatrixColumn(w.current.matrixWorld,2).normalize(),W=new Oi().setFromNormalAndCoplanarPoint(te,P);T.current={clickPoint:re,e1:se,e2:ue,plane:W},S.current=r.current[(n+1)%3],C.current=r.current[(n+2)%3],p({component:"Slider",axis:n,origin:P,directions:[se,ue,te]}),x&&(x.enabled=!1),ne.target.setPointerCapture(ne.pointerId)},[s,x,p,n]),D=v.useCallback(ne=>{if(ne.stopPropagation(),A||R(!0),T.current){const{clickPoint:re,e1:P,e2:se,plane:ue}=T.current,[te,W]=(i==null?void 0:i[(n+1)%3])||[void 0,void 0],[X,J]=(i==null?void 0:i[(n+2)%3])||[void 0,void 0];vx.copy(ne.ray),vx.intersectPlane(ue,xx),vx.direction.negate(),vx.intersectPlane(ue,xx),xx.sub(re);let[oe,Ee]=_ge(P,se,xx);te!==void 0&&(oe=Math.max(oe,te-S.current)),W!==void 0&&(oe=Math.min(oe,W-S.current)),X!==void 0&&(Ee=Math.max(Ee,X-C.current)),J!==void 0&&(Ee=Math.min(Ee,J-C.current)),r.current[(n+1)%3]=S.current+oe,r.current[(n+2)%3]=C.current+Ee,s&&(_.current.innerText=`${r.current[(n+1)%3].toFixed(2)}, ${r.current[(n+2)%3].toFixed(2)}`),$L.makeTranslation(oe*P.x+Ee*se.x,oe*P.y+Ee*se.y,oe*P.z+Ee*se.z),m($L)}},[s,m,A,r,i,n]),k=v.useCallback(ne=>{s&&(_.current.style.display="none"),ne.stopPropagation(),T.current=null,g(),x&&(x.enabled=!0),ne.target.releasePointerCapture(ne.pointerId)},[s,x,g]),L=v.useCallback(ne=>{ne.stopPropagation(),R(!1)},[]),N=v.useMemo(()=>{const ne=t.clone().normalize(),re=e.clone().normalize();return new et().makeBasis(ne,re,ne.clone().cross(re))},[t,e]),z=u?1/7:l/7,O=u?.225:l*.225,K=A?d:f[n],V=v.useMemo(()=>[new $(0,0,0),new $(0,O,0),new $(O,O,0),new $(O,0,0),new $(0,0,0)],[O]);return v.createElement("group",{ref:w,matrix:N,matrixAutoUpdate:!1},s&&v.createElement(ch,{position:[0,0,0]},v.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:o,ref:_})),v.createElement("group",{position:[z*1.7,z*1.7,0]},v.createElement("mesh",{visible:!0,onPointerDown:M,onPointerMove:D,onPointerUp:k,onPointerOut:L,scale:O,userData:y},v.createElement("planeGeometry",null),v.createElement("meshBasicMaterial",{transparent:!0,depthTest:a,color:K,polygonOffset:!0,polygonOffsetFactor:-10,side:Nr,fog:!1})),v.createElement(Ni,{position:[-O/2,-O/2,0],transparent:!0,depthTest:a,points:V,lineWidth:c,color:K,opacity:h,polygonOffset:!0,polygonOffsetFactor:-10,userData:y,fog:!1})))},Kg=new $,XL=new $,bge=(t,e,n,r)=>{const i=e.dot(e),s=e.dot(t)-e.dot(n),o=e.dot(r);return o===0?-s/i:(Kg.copy(r).multiplyScalar(i/o).sub(e),XL.copy(r).multiplyScalar(s/o).add(n).sub(t),-Kg.dot(XL)/Kg.dot(Kg))},Ege=new $(0,1,0),pg=new $,qL=new et,hT=({direction:t,axis:e})=>{const{scaleLimits:n,annotations:r,annotationsClass:i,depthTest:s,scale:o,lineWidth:a,fixed:l,axisColors:c,hoveredColor:u,opacity:f,onDragStart:d,onDrag:h,onDragEnd:p,userData:m}=v.useContext(Iy),g=At(V=>V.size),y=At(V=>V.controls),x=v.useRef(null),_=v.useRef(null),w=v.useRef(null),T=v.useRef(1),S=v.useRef(1),C=v.useRef(null),[A,R]=v.useState(!1),M=l?1.2:1.2*o,D=v.useCallback(V=>{r&&(x.current.innerText=`${S.current.toFixed(2)}`,x.current.style.display="block"),V.stopPropagation();const ne=new et().extractRotation(_.current.matrixWorld),re=V.point.clone(),P=new $().setFromMatrixPosition(_.current.matrixWorld),se=t.clone().applyMatrix4(ne).normalize(),ue=_.current.matrixWorld.clone(),te=ue.clone().invert(),W=l?1/UG(_.current.getWorldPosition(Kg),o,V.camera,g):1;C.current={clickPoint:re,dir:se,mPLG:ue,mPLGInv:te,offsetMultiplier:W},d({component:"Sphere",axis:e,origin:P,directions:[se]}),y&&(y.enabled=!1),V.target.setPointerCapture(V.pointerId)},[r,y,t,d,e,l,o,g]),k=v.useCallback(V=>{if(V.stopPropagation(),A||R(!0),C.current){const{clickPoint:ne,dir:re,mPLG:P,mPLGInv:se,offsetMultiplier:ue}=C.current,[te,W]=(n==null?void 0:n[e])||[1e-5,void 0],J=bge(ne,re,V.ray.origin,V.ray.direction)*ue,oe=l?J:J/o;let Ee=Math.pow(2,oe*.2);V.shiftKey&&(Ee=Math.round(Ee*10)/10),Ee=Math.max(Ee,te/T.current),W!==void 0&&(Ee=Math.min(Ee,W/T.current)),S.current=T.current*Ee,w.current.position.set(0,M+J,0),r&&(x.current.innerText=`${S.current.toFixed(2)}`),pg.set(1,1,1),pg.setComponent(e,Ee),qL.makeScale(pg.x,pg.y,pg.z).premultiply(P).multiply(se),h(qL)}},[r,M,h,A,n,e]),L=v.useCallback(V=>{r&&(x.current.style.display="none"),V.stopPropagation(),T.current=S.current,C.current=null,w.current.position.set(0,M,0),p(),y&&(y.enabled=!0),V.target.releasePointerCapture(V.pointerId)},[r,y,p,M]),N=v.useCallback(V=>{V.stopPropagation(),R(!1)},[]),{radius:z,matrixL:O}=v.useMemo(()=>{const V=l?a/o*1.8:o/22.5,ne=new bn().setFromUnitVectors(Ege,t.clone().normalize()),re=new et().makeRotationFromQuaternion(ne);return{radius:V,matrixL:re}},[t,o,a,l]),K=A?u:c[e];return v.createElement("group",{ref:_},v.createElement("group",{matrix:O,matrixAutoUpdate:!1,onPointerDown:D,onPointerMove:k,onPointerUp:L,onPointerOut:N},r&&v.createElement(ch,{position:[0,M/2,0]},v.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:i,ref:x})),v.createElement("mesh",{ref:w,position:[0,M,0],renderOrder:500,userData:m},v.createElement("sphereGeometry",{args:[z,12,12]}),v.createElement("meshBasicMaterial",{transparent:!0,depthTest:s,color:K,opacity:f,polygonOffset:!0,polygonOffsetFactor:-10}))))},YL=new et,KL=new et,ZL=new et,_x=new et,pT=new et,pp=new et,QL=new et,JL=new et,eD=new et,mp=new Kn,mT=new Kn,tD=new $,nD=new $,rD=new $,iD=new $,mg=new $,gp=new $(1,0,0),yp=new $(0,1,0),vp=new $(0,0,1),wge=v.forwardRef(({enabled:t=!0,matrix:e,onDragStart:n,onDrag:r,onDragEnd:i,autoTransform:s=!0,anchor:o,disableAxes:a=!1,disableSliders:l=!1,disableRotations:c=!1,disableScaling:u=!1,activeAxes:f=[!0,!0,!0],offset:d=[0,0,0],rotation:h=[0,0,0],scale:p=1,lineWidth:m=4,fixed:g=!1,translationLimits:y,rotationLimits:x,scaleLimits:_,depthTest:w=!0,axisColors:T=["#ff2060","#20df80","#2080ff"],hoveredColor:S="#ffff40",annotations:C=!1,annotationsClass:A,opacity:R=1,visible:M=!0,userData:D,children:k,...L},N)=>{const z=At(W=>W.invalidate),O=v.useRef(null),K=v.useRef(null),V=v.useRef(null),ne=v.useRef(null),re=v.useRef([0,0,0]),P=v.useRef(new $(1,1,1)),se=v.useRef(new $(1,1,1));v.useLayoutEffect(()=>{o&&(ne.current.updateWorldMatrix(!0,!0),_x.copy(ne.current.matrixWorld).invert(),mp.makeEmpty(),ne.current.traverse(W=>{W.geometry&&(W.geometry.boundingBox||W.geometry.computeBoundingBox(),pp.copy(W.matrixWorld).premultiply(_x),mT.copy(W.geometry.boundingBox),mT.applyMatrix4(pp),mp.union(mT))}),tD.copy(mp.max).add(mp.min).multiplyScalar(.5),nD.copy(mp.max).sub(mp.min).multiplyScalar(.5),rD.copy(nD).multiply(new $(...o)).add(tD),iD.set(...d).add(rD),V.current.position.copy(iD),z())});const ue=v.useMemo(()=>({onDragStart:W=>{YL.copy(K.current.matrix),KL.copy(K.current.matrixWorld),n&&n(W),z()},onDrag:W=>{ZL.copy(O.current.matrixWorld),_x.copy(ZL).invert(),pT.copy(KL).premultiply(W),pp.copy(pT).premultiply(_x),QL.copy(YL).invert(),JL.copy(pp).multiply(QL),s&&K.current.matrix.copy(pp),r&&r(pp,JL,pT,W),z()},onDragEnd:()=>{i&&i(),z()},translation:re,translationLimits:y,rotationLimits:x,axisColors:T,hoveredColor:S,opacity:R,scale:p,lineWidth:m,fixed:g,depthTest:w,userData:D,annotations:C,annotationsClass:A}),[n,r,i,re,y,x,_,w,p,m,g,...T,S,R,D,s,C,A]),te=new $;return Yt(W=>{if(g){const X=UG(V.current.getWorldPosition(te),p,W.camera,W.size);P.current.setScalar(X)}e&&e instanceof et&&(K.current.matrix=e),K.current.updateWorldMatrix(!0,!0),eD.makeRotationFromEuler(V.current.rotation).setPosition(V.current.position).premultiply(K.current.matrixWorld),se.current.setFromMatrixScale(eD),mg.copy(P.current).divide(se.current),(Math.abs(V.current.scale.x-mg.x)>1e-4||Math.abs(V.current.scale.y-mg.y)>1e-4||Math.abs(V.current.scale.z-mg.z)>1e-4)&&(V.current.scale.copy(mg),W.invalidate())}),v.useImperativeHandle(N,()=>K.current,[]),v.createElement(Iy.Provider,{value:ue},v.createElement("group",{ref:O},v.createElement("group",It({ref:K,matrix:e,matrixAutoUpdate:!1},L),v.createElement("group",{visible:M,ref:V,position:d,rotation:h},t&&v.createElement(v.Fragment,null,!a&&f[0]&&v.createElement(oT,{axis:0,direction:gp}),!a&&f[1]&&v.createElement(oT,{axis:1,direction:yp}),!a&&f[2]&&v.createElement(oT,{axis:2,direction:vp}),!l&&f[0]&&f[1]&&v.createElement(dT,{axis:2,dir1:gp,dir2:yp}),!l&&f[0]&&f[2]&&v.createElement(dT,{axis:1,dir1:vp,dir2:gp}),!l&&f[2]&&f[1]&&v.createElement(dT,{axis:0,dir1:yp,dir2:vp}),!c&&f[0]&&f[1]&&v.createElement(fT,{axis:2,dir1:gp,dir2:yp}),!c&&f[0]&&f[2]&&v.createElement(fT,{axis:1,dir1:vp,dir2:gp}),!c&&f[2]&&f[1]&&v.createElement(fT,{axis:0,dir1:yp,dir2:vp}),!u&&f[0]&&v.createElement(hT,{axis:0,direction:gp}),!u&&f[1]&&v.createElement(hT,{axis:1,direction:yp}),!u&&f[2]&&v.createElement(hT,{axis:2,direction:vp}))),v.createElement("group",{ref:ne},k))))}),Sge=new $(0,0,-1),Tge=function(){const t=new $,e=new $,n=new $,r=new $,i=new $;return function(s,o,a,l){return t.copy(s),e.copy(o),n.copy(a),r.copy(e).sub(t),i.copy(n).sub(t),l.crossVectors(i,r).normalize()}}();function Age(t,e){return t.clone().add(e).multiplyScalar(.5)}const XV=v.forwardRef(({points:t=gT.SAMPLE_FACELANDMARKER_RESULT.faceLandmarks[0],face:e,facialTransformationMatrix:n,faceBlendshapes:r,offset:i,offsetScalar:s=80,width:o,height:a,depth:l=1,verticalTri:c=[159,386,152],origin:u,eyes:f=!0,eyesAsOrigin:d=!1,debug:h=!1,children:p,...m},g)=>{var y;e&&(t=e.keypoints,console.warn("Facemesh `face` prop is deprecated: use `points` instead"));const x=v.useRef(null),_=v.useRef(null),w=v.useRef(null),T=v.useRef(null),S=v.useRef(null),C=v.useRef(null),A=v.useRef(null),[R]=v.useState(()=>new $),[M]=v.useState(()=>new yn),[D]=v.useState(()=>new bn),[k]=v.useState(()=>new $),{invalidate:L}=At();v.useEffect(()=>{var ne;(ne=S.current)==null||ne.geometry.setIndex(gT.TRIANGULATION)},[]);const[N]=v.useState(()=>new $);v.useEffect(()=>{var ne,re;const P=(ne=S.current)==null?void 0:ne.geometry;if(!P)return;if(P.setFromPoints(t),P.setDrawRange(0,gT.TRIANGULATION.length),n)if(M.matrix.fromArray(n.data),M.matrix.decompose(M.position,M.quaternion,M.scale),M.rotation.y*=-1,M.rotation.z*=-1,D.setFromEuler(M.rotation),i){var se;M.position.y*=-1,M.position.z*=-1,(se=x.current)==null||se.position.copy(M.position.divideScalar(s))}else{var ue;(ue=x.current)==null||ue.position.set(0,0,0)}else Tge(t[c[0]],t[c[1]],t[c[2]],R),D.setFromUnitVectors(Sge,R);const te=D.clone().invert();if(P.computeBoundingBox(),h&&L(),P.center(),P.applyQuaternion(te),(re=T.current)==null||re.setRotationFromQuaternion(D),f){if(!r)console.warn("Facemesh `eyes` option only works if `faceBlendshapes` is provided: skipping.");else if(C.current&&A.current&&w.current)if(d){const W=C.current._computeSphere(P),X=A.current._computeSphere(P);u=Age(W.center,X.center).negate(),C.current._update(P,r,W),A.current._update(P,r,X)}else C.current._update(P,r),A.current._update(P,r)}if(w.current){if(u!==void 0)if(typeof u=="number"){const W=P.getAttribute("position");k.set(-W.getX(u),-W.getY(u),-W.getZ(u))}else u.isVector3&&k.copy(u);else k.setScalar(0);w.current.position.copy(k)}if(_.current){let W=1;(o||a||l)&&(P.boundingBox.getSize(N),o&&(W=o/N.x),a&&(W=a/N.y),l&&(W=l/N.z)),_.current.scale.setScalar(W!==1?W:1)}P.computeVertexNormals(),P.attributes.position.needsUpdate=!0},[t,n,r,M,i,s,o,a,l,c,u,f,h,L,R,D,N,k]);const z=v.useMemo(()=>({outerRef:T,meshRef:S,eyeRightRef:C,eyeLeftRef:A}),[]);v.useImperativeHandle(g,()=>z,[z]);const[O]=v.useState(()=>new $),K=(y=S.current)==null?void 0:y.geometry.boundingBox,V=(K==null?void 0:K.getSize(O).z)||1;return v.createElement("group",m,v.createElement("group",{ref:x},v.createElement("group",{ref:T},v.createElement("group",{ref:_},h?v.createElement(v.Fragment,null,v.createElement("axesHelper",{args:[V]}),v.createElement(Ni,{points:[[0,0,0],[0,0,-V]],color:65535})):null,v.createElement("group",{ref:w},f&&r&&v.createElement("group",{name:"eyes"},v.createElement(sD,{side:"left",ref:C,debug:h}),v.createElement(sD,{side:"right",ref:A,debug:h})),v.createElement("mesh",{ref:S,name:"face"},p,h?v.createElement(v.Fragment,null,K&&v.createElement("box3Helper",{args:[K]})):null))))))}),gg={contourLandmarks:{right:[33,133,159,145,153],left:[263,362,386,374,380]},blendshapes:{right:[14,16,18,12],left:[13,15,17,11]},color:{right:"red",left:"#00ff00"},fov:{horizontal:100,vertical:90}},sD=v.forwardRef(({side:t,debug:e=!0},n)=>{const r=v.useRef(null),i=v.useRef(null),[s]=v.useState(()=>new wr),o=v.useCallback(f=>{const d=f.getAttribute("position"),p=gg.contourLandmarks[t].map(m=>new $(d.getX(m),d.getY(m),d.getZ(m)));return s.center.set(0,0,0),p.forEach(m=>s.center.add(m)),s.center.divideScalar(p.length),s.radius=p[0].sub(p[1]).length()/2,s},[s,t]),[a]=v.useState(()=>new xr),l=v.useCallback((f,d,h)=>{if(r.current){var p;(p=h)!==null&&p!==void 0||(h=o(f)),r.current.position.copy(h.center),r.current.scale.setScalar(h.radius)}if(d&&i.current){const m=gg.blendshapes[t],g=d.categories[m[0]].score,y=d.categories[m[1]].score,x=d.categories[m[2]].score,_=d.categories[m[3]].score,w=gg.fov.horizontal*ri.DEG2RAD,T=gg.fov.vertical*ri.DEG2RAD,S=w*.5*(_-x),C=T*.5*(g-y)*(t==="left"?1:-1);a.set(S,C,0),i.current.setRotationFromEuler(a)}},[o,t,a]),c=v.useMemo(()=>({eyeMeshRef:r,irisDirRef:i,_computeSphere:o,_update:l}),[o,l]);v.useImperativeHandle(n,()=>c,[c]);const u=gg.color[t];return v.createElement("group",null,v.createElement("group",{ref:r},e&&v.createElement("axesHelper",null),v.createElement("group",{ref:i},v.createElement(v.Fragment,null,e&&v.createElement(Ni,{points:[[0,0,0],[0,0,-2]],lineWidth:1,color:u})))))}),gT={TRIANGULATION:[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255],SAMPLE_FACE:{keypoints:[{x:356.2804412841797,y:295.1960563659668,z:-23.786449432373047,name:"lips"},{x:354.8859405517578,y:264.69520568847656,z:-36.718435287475586},{x:355.2180862426758,y:275.3360366821289,z:-21.183712482452393},{x:347.349853515625,y:242.4400234222412,z:-25.093655586242676},{x:354.40135955810547,y:256.67933464050293,z:-38.23572635650635},{x:353.7689971923828,y:247.54886627197266,z:-34.5475435256958},{x:352.1288299560547,y:227.34312057495117,z:-13.095386028289795},{x:303.5013198852539,y:234.67002868652344,z:12.500141859054565,name:"rightEye"},{x:351.09378814697266,y:211.87547206878662,z:-6.413471698760986},{x:350.7115936279297,y:202.1251630783081,z:-6.413471698760986},{x:348.33667755126953,y:168.7741756439209,z:6.483500003814697,name:"faceOval"},{x:356.4806365966797,y:299.2995357513428,z:-23.144519329071045},{x:356.5511703491211,y:302.66146659851074,z:-21.020312309265137},{x:356.6239547729492,y:304.1536331176758,z:-18.137459754943848,name:"lips"},{x:356.5807342529297,y:305.1840591430664,z:-18.767719268798828,name:"lips"},{x:356.8241500854492,y:308.25711250305176,z:-20.16829490661621},{x:357.113037109375,y:312.26277351379395,z:-22.10575819015503},{x:357.34962463378906,y:317.1123218536377,z:-21.837315559387207,name:"lips"},{x:357.6658630371094,y:325.51036834716797,z:-16.27002477645874},{x:355.0201416015625,y:269.36279296875,z:-33.73054027557373},{x:348.5237503051758,y:270.33411026000977,z:-24.93025302886963},{x:279.97331619262695,y:213.24176788330078,z:47.759642601013184,name:"faceOval"},{x:322.66529083251953,y:238.5027265548706,z:5.535193085670471},{x:316.0983657836914,y:239.94489669799805,z:5.777376294136047},{x:309.9431610107422,y:240.24518966674805,z:7.510589361190796},{x:301.31994247436523,y:237.86138534545898,z:13.118728399276733},{x:328.14266204833984,y:235.80496788024902,z:6.646900177001953},{x:313.7326431274414,y:222.11161136627197,z:3.9887237548828125},{x:320.45196533203125,y:221.87729358673096,z:4.601476192474365},{x:307.35679626464844,y:223.63793849945068,z:5.932023525238037},{x:303.0031204223633,y:226.3743782043457,z:8.479321002960205},{x:296.80023193359375,y:242.94299125671387,z:15.931552648544312},{x:332.2352981567383,y:340.77341079711914,z:-10.165848731994629},{x:301.38587951660156,y:233.46447944641113,z:14.764405488967896,name:"rightEye"},{x:279.0147018432617,y:244.37155723571777,z:45.77549457550049},{x:289.60548400878906,y:239.1807460784912,z:23.191204071044922},{x:320.32257080078125,y:267.1292781829834,z:-4.954537749290466},{x:347.64583587646484,y:294.4955062866211,z:-23.062820434570312,name:"lips"},{x:349.28138732910156,y:303.1095886230469,z:-20.238323211669922},{x:338.9453125,y:298.19186210632324,z:-19.456336498260498,name:"lips"},{x:333.36788177490234,y:302.6706790924072,z:-14.776077270507812,name:"lips"},{x:342.89188385009766,y:304.3561363220215,z:-17.752301692962646},{x:337.7375030517578,y:306.0098361968994,z:-13.410515785217285},{x:325.6159210205078,y:316.22995376586914,z:-6.681914925575256},{x:349.0104675292969,y:264.9818515777588,z:-36.274919509887695},{x:347.7138900756836,y:257.5664806365967,z:-37.67549514770508},{x:291.79357528686523,y:218.88171672821045,z:11.578094959259033,name:"rightEyebrow"},{x:332.2689437866211,y:247.56946563720703,z:-3.3730539679527283},{x:332.0074462890625,y:267.1201229095459,z:-19.969879388809204},{x:331.27952575683594,y:263.6967658996582,z:-17.47218608856201},{x:301.04373931884766,y:269.56552505493164,z:3.61815482378006},{x:347.4863815307617,y:249.0706443786621,z:-32.633421421051025},{x:307.26118087768555,y:208.2646894454956,z:1.1591226607561111,name:"rightEyebrow"},{x:297.91919708251953,y:212.22604751586914,z:5.914516448974609,name:"rightEyebrow"},{x:285.1651382446289,y:197.98450469970703,z:36.391637325286865,name:"faceOval"},{x:337.04097747802734,y:211.25229835510254,z:-4.548954665660858},{x:326.5912628173828,y:223.16698551177979,z:6.670243740081787},{x:320.05664825439453,y:309.5834255218506,z:-4.055835008621216},{x:289.6866226196289,y:314.617395401001,z:53.875489234924316,name:"faceOval"},{x:337.4256896972656,y:270.8755302429199,z:-17.67060160636902},{x:343.69922637939453,y:273.0000400543213,z:-18.756048679351807},{x:327.4242401123047,y:309.22399520874023,z:-4.703601002693176,name:"lips"},{x:330.37220001220703,y:308.3323001861572,z:-6.442649960517883},{x:293.87027740478516,y:207.7961826324463,z:9.821539521217346,name:"rightEyebrow"},{x:332.11437225341797,y:271.22812271118164,z:-16.64351224899292},{x:320.1197814941406,y:207.40366458892822,z:-2.48164564371109,name:"rightEyebrow"},{x:318.59575271606445,y:201.07443809509277,z:-3.110446035861969,name:"rightEyebrow"},{x:310.72303771972656,y:175.75075149536133,z:13.328815698623657,name:"faceOval"},{x:289.67578887939453,y:202.29835510253906,z:21.370456218719482},{x:315.30879974365234,y:187.35260009765625,z:5.0304025411605835},{x:287.8936767578125,y:216.54793739318848,z:17.81065821647644,name:"rightEyebrow"},{x:283.9391899108887,y:215.01142501831055,z:32.04984903335571},{x:348.35330963134766,y:299.4155788421631,z:-22.47924566268921},{x:341.1790466308594,y:301.8221855163574,z:-18.977805376052856},{x:335.69713592529297,y:304.4266891479492,z:-14.682706594467163},{x:339.4615173339844,y:272.3654365539551,z:-16.38674020767212},{x:328.99600982666016,y:308.86685371398926,z:-5.616893768310547},{x:332.00313568115234,y:309.1875743865967,z:-10.335084199905396},{x:331.0068130493164,y:307.9274368286133,z:-6.681914925575256,name:"lips"},{x:341.13792419433594,y:266.4876937866211,z:-26.56425952911377},{x:339.02950286865234,y:305.6663703918457,z:-12.33674168586731,name:"lips"},{x:344.22935485839844,y:304.9452781677246,z:-15.161235332489014,name:"lips"},{x:350.1844024658203,y:304.374303817749,z:-17.5305438041687,name:"lips"},{x:348.52630615234375,y:325.9562301635742,z:-16.164982318878174},{x:348.6581802368164,y:317.1624183654785,z:-21.510512828826904,name:"lips"},{x:348.9766311645508,y:312.1923065185547,z:-21.708929538726807},{x:349.2427444458008,y:308.0660820007324,z:-19.643079042434692},{x:349.67491149902344,y:305.42747497558594,z:-18.16080331802368,name:"lips"},{x:337.95589447021484,y:306.6535949707031,z:-12.803598642349243,name:"lips"},{x:337.06878662109375,y:307.63169288635254,z:-14.274203777313232},{x:335.77449798583984,y:309.8449516296387,z:-15.698124170303345},{x:334.6099090576172,y:312.7997016906738,z:-14.764405488967896,name:"lips"},{x:327.2330856323242,y:293.80866050720215,z:-11.864047050476074},{x:280.97679138183594,y:279.79928970336914,z:68.90834331512451,name:"faceOval"},{x:355.13843536376953,y:271.7875671386719,z:-25.350427627563477},{x:334.7235870361328,y:307.4656391143799,z:-9.302158951759338,name:"lips"},{x:333.5293960571289,y:307.89782524108887,z:-10.200862884521484},{x:346.29688262939453,y:276.4256286621094,z:-19.748122692108154},{x:335.16246795654297,y:276.22097969055176,z:-12.313398122787476},{x:345.09132385253906,y:274.7082996368408,z:-19.304605722427368},{x:325.4267883300781,y:252.95130729675293,z:-1.6661019623279572},{x:315.347843170166,y:259.05200958251953,z:-.25604281574487686},{x:330.44933319091797,y:267.7570152282715,z:-14.017432928085327},{x:294.96768951416016,y:185.26001930236816,z:23.903164863586426,name:"faceOval"},{x:299.63531494140625,y:192.7913761138916,z:12.640198469161987},{x:304.5452117919922,y:202.4142837524414,z:3.244667649269104,name:"rightEyebrow"},{x:331.6915512084961,y:320.0467872619629,z:-10.632705688476562},{x:334.5911407470703,y:201.27566814422607,z:-6.133356094360352,name:"rightEyebrow"},{x:331.4815902709961,y:185.44180870056152,z:.6627205014228821},{x:328.05816650390625,y:170.8385467529297,z:7.358860373497009,name:"faceOval"},{x:304.49764251708984,y:239.76297855377197,z:10.387605428695679},{x:290.6382179260254,y:248.85257720947266,z:19.03616428375244},{x:331.5682601928711,y:233.20727348327637,z:7.837390303611755},{x:295.5115509033203,y:228.9834451675415,z:14.41426157951355},{x:336.94332122802734,y:241.8259334564209,z:-5.27842104434967},{x:336.2792205810547,y:262.7049922943115,z:-26.12074375152588},{x:284.4102478027344,y:255.3262710571289,z:25.467140674591064},{x:295.1420593261719,y:253.02655220031738,z:12.430112361907959},{x:303.5196113586426,y:254.20703887939453,z:6.139191389083862},{x:315.73450088500977,y:251.64799690246582,z:3.3788898587226868},{x:324.69661712646484,y:247.56494522094727,z:2.3328344523906708},{x:331.57970428466797,y:243.02241325378418,z:1.1423448473215103},{x:345.6210708618164,y:229.9976634979248,z:-10.825285911560059},{x:286.26644134521484,y:270.37991523742676,z:21.708929538726807},{x:290.2525520324707,y:228.4921360015869,z:17.71728754043579},{x:351.65367126464844,y:269.3400764465332,z:-33.450424671173096},{x:333.1378936767578,y:253.88388633728027,z:-7.230473756790161},{x:277.8318977355957,y:246.95331573486328,z:68.20805549621582,name:"faceOval"},{x:336.6680908203125,y:238.10003757476807,z:.7688578963279724},{x:329.95800018310547,y:269.18323516845703,z:-7.207130789756775},{x:299.17491912841797,y:234.13324356079102,z:15.95489501953125},{x:335.61729431152344,y:258.71752738952637,z:-23.016133308410645},{x:284.1079330444336,y:297.0343494415283,z:63.25934886932373,name:"faceOval"},{x:331.44542694091797,y:230.6892442703247,z:9.92658257484436,name:"rightEye"},{x:341.41536712646484,y:253.01264762878418,z:-29.038610458374023},{x:303.5472869873047,y:327.5896739959717,z:16.725212335586548},{x:304.7756576538086,y:337.4389457702637,z:27.38126277923584,name:"faceOval"},{x:280.80501556396484,y:275.32050132751465,z:45.0752067565918},{x:295.43582916259766,y:318.4501647949219,z:26.2608003616333},{x:281.4303207397461,y:228.7355661392212,z:40.94350814819336},{x:331.2549591064453,y:349.4216537475586,z:-7.376367449760437},{x:352.4247741699219,y:271.7330074310303,z:-24.953596591949463},{x:327.5672912597656,y:260.41900634765625,z:-5.456410646438599},{x:284.5432472229004,y:241.7647933959961,z:29.668869972229004},{x:310,y:235.66174507141113,z:8.502663969993591,name:"rightEye"},{x:315.7071113586426,y:235.7572603225708,z:6.938687562942505,name:"rightEye"},{x:330.41088104248047,y:311.04143142700195,z:-9.325502514839172,name:"lips"},{x:288.5377502441406,y:285.31983375549316,z:21.837315559387207},{x:344.55039978027344,y:359.4300842285156,z:-6.705257892608643,name:"faceOval"},{x:323.41880798339844,y:351.67362213134766,z:7.802375555038452,name:"faceOval"},{x:314.64088439941406,y:346.11894607543945,z:16.36339783668518,name:"faceOval"},{x:349.4945526123047,y:184.8434829711914,z:-.21847527474164963},{x:359.24694061279297,y:359.8348903656006,z:-8.403456211090088,name:"faceOval"},{x:321.26182556152344,y:234.64492321014404,z:6.90950870513916,name:"rightEye"},{x:326.318359375,y:232.90250301361084,z:8.029969334602356,name:"rightEye"},{x:329.6211624145508,y:231.6195774078369,z:9.722331762313843,name:"rightEye"},{x:285.9398078918457,y:228.2351303100586,z:24.650139808654785},{x:325.79288482666016,y:227.88007736206055,z:7.469738721847534,name:"rightEye"},{x:320.1699447631836,y:227.5934886932373,z:6.168370842933655,name:"rightEye"},{x:314.85408782958984,y:227.85282611846924,z:6.2675780057907104,name:"rightEye"},{x:309.3084907531738,y:229.1516876220703,z:7.7031683921813965,name:"rightEye"},{x:305.5621337890625,y:230.92366218566895,z:9.722331762313843,name:"rightEye"},{x:277.8681945800781,y:228.5354232788086,z:59.71122741699219,name:"faceOval"},{x:306.1444664001465,y:235.1954698562622,z:10.603528022766113,name:"rightEye"},{x:355.4478454589844,y:281.96210861206055,z:-20.565123558044434},{x:333.02661895751953,y:288.0105400085449,z:-14.72939133644104},{x:337.15728759765625,y:269.2059516906738,z:-19.8414945602417},{x:345.9898376464844,y:283.5453128814697,z:-20.4834246635437},{x:351.48963928222656,y:219.98916149139404,z:-7.0378947257995605},{x:312.39574432373047,y:336.50628089904785,z:8.671900033950806},{x:321.32152557373047,y:343.1755256652832,z:.9067271649837494},{x:343.78379821777344,y:353.2975959777832,z:-14.355905055999756},{x:296.8791389465332,y:327.91497230529785,z:41.01353645324707,name:"faceOval"},{x:329.6939468383789,y:229.27897453308105,z:8.934508562088013,name:"rightEye"},{x:341.6905212402344,y:241.4073657989502,z:-14.589333534240723},{x:359.03079986572266,y:353.48859786987305,z:-15.803166627883911},{x:333.1861877441406,y:356.43213272094727,z:-1.0234417766332626,name:"faceOval"},{x:283.97483825683594,y:291.4318656921387,z:41.94725513458252},{x:343.33770751953125,y:305.830135345459,z:-15.756480693817139,name:"lips"},{x:342.40283966064453,y:307.7453899383545,z:-17.4021577835083},{x:341.53621673583984,y:311.0595703125,z:-19.047834873199463},{x:340.9107208251953,y:315.4837703704834,z:-18.5576331615448,name:"lips"},{x:339.1478729248047,y:323.42233657836914,z:-14.367576837539673},{x:333.3201599121094,y:307.4406337738037,z:-9.617288708686829},{x:331.2411117553711,y:306.9811820983887,z:-9.669809937477112},{x:329.23255920410156,y:306.0508346557617,z:-9.582273960113525,name:"lips"},{x:322.4586486816406,y:301.33323669433594,z:-7.720675468444824},{x:297.1712112426758,y:286.9552803039551,z:8.240055441856384},{x:341.3060760498047,y:235.4432201385498,z:-7.504753470420837},{x:336.9318389892578,y:224.3451976776123,z:5.829898118972778},{x:332.65323638916016,y:226.70403957366943,z:8.105834126472473},{x:334.67357635498047,y:306.4397621154785,z:-8.981193900108337,name:"lips"},{x:297.4601936340332,y:306.29210472106934,z:15.476365089416504},{x:342.9119110107422,y:222.37077713012695,z:-2.754466235637665},{x:335.4629898071289,y:332.20250129699707,z:-11.823196411132812},{x:353.2412338256836,y:240.56339263916016,z:-27.147831916809082},{x:346.3080596923828,y:236.41446590423584,z:-18.452589511871338},{x:352.6475143432617,y:234.1420555114746,z:-19.748122692108154},{x:337.3209762573242,y:253.39937210083008,z:-16.024924516677856},{x:358.6122131347656,y:344.90861892700195,z:-18.592647314071655},{x:358.1117248535156,y:334.64990615844727,z:-17.49552845954895},{x:346.4450454711914,y:335.0321102142334,z:-16.32838249206543},{x:319.17640686035156,y:320.2833938598633,z:-3.276764452457428},{x:325.2540588378906,y:276.2369728088379,z:-6.460157036781311},{x:326.7214584350586,y:327.3939514160156,z:-7.417217493057251},{x:310.7190132141113,y:277.2265148162842,z:-3.5452082753181458},{x:319.78355407714844,y:284.8238182067871,z:-6.4543211460113525},{x:305.773983001709,y:290.83580017089844,z:.06907138042151928},{x:344.4001770019531,y:344.85408782958984,z:-16.946970224380493},{x:333.1879425048828,y:258.74256134033203,z:-11.90489649772644},{x:313.80598068237305,y:327.08919525146484,z:2.2277912497520447},{x:322.9637908935547,y:334.6819496154785,z:-3.3643004298210144},{x:313.4055519104004,y:311.2166690826416,z:-1.1175429821014404},{x:291.0865783691406,y:298.2831001281738,z:22.467575073242188},{x:305.6580924987793,y:313.3707904815674,z:5.561453700065613},{x:288.23760986328125,y:305.9941864013672,z:36.765122413635254},{x:315.10692596435547,y:296.26991271972656,z:-4.604393839836121},{x:337.50518798828125,y:247.5944423675537,z:-10.597691535949707},{x:338.8450622558594,y:265.47778129577637,z:-27.778091430664062},{x:334.25254821777344,y:269.0671920776367,z:-20.938611030578613},{x:341.64512634277344,y:259.6387195587158,z:-32.189905643463135},{x:331.44081115722656,y:219.0976095199585,z:4.207563698291779},{x:320.56339263916016,y:216.49658203125,z:2.930997312068939},{x:311.21912002563477,y:216.57853603363037,z:2.9674705862998962},{x:303.46256256103516,y:218.54614734649658,z:5.357203483581543},{x:297.99999237060547,y:222.505202293396,z:9.325502514839172},{x:294.93839263916016,y:236.39654159545898,z:18.534289598464966},{x:278.87489318847656,y:259.7095584869385,z:45.68212032318115},{x:300.3782653808594,y:245.38593292236328,z:12.278382778167725},{x:307.06348419189453,y:246.36857986450195,z:8.164191246032715},{x:315.5229187011719,y:245.3949737548828,z:5.503097176551819},{x:323.71395111083984,y:242.75178909301758,z:4.6335723996162415},{x:330.2785873413086,y:239.34658527374268,z:4.937030673027039},{x:334.6982192993164,y:236.0460376739502,z:4.823233783245087},{x:279.3412208557129,y:263.5196113586426,z:70.91583728790283,name:"faceOval"},{x:334.65972900390625,y:271.6648578643799,z:-17.775644063949585},{x:342.05677032470703,y:246.99846267700195,z:-20.84523916244507},{x:344.0357971191406,y:264.5701503753662,z:-32.936880588531494},{x:348.25531005859375,y:268.6645030975342,z:-30.695960521697998},{x:344.12227630615234,y:266.34212493896484,z:-29.808926582336426},{x:337.12318420410156,y:274.2556858062744,z:-15.768152475357056},{x:349.49047088623047,y:269.071683883667,z:-32.51670837402344},{x:350.1683044433594,y:271.4691352844238,z:-24.93025302886963},{x:333.9634704589844,y:230.56639194488525,z:8.89949381351471},{x:338.2147979736328,y:231.4807891845703,z:4.6715047955513},{x:340.4712677001953,y:231.74463272094727,z:-.34996166825294495},{x:303.28975677490234,y:232.24980354309082,z:11.916568279266357,name:"rightEye"},{x:299.4649124145508,y:229.53842639923096,z:12.325069904327393},{x:359.09618377685547,y:241.77349090576172,z:-24.650139808654785},{x:399.46216583251953,y:229.89503860473633,z:15.919880867004395,name:"leftEye"},{x:361.38919830322266,y:269.6129894256592,z:-24.510080814361572},{x:416.9973373413086,y:206.0895538330078,z:53.26857566833496,name:"faceOval"},{x:381.32179260253906,y:235.5476474761963,z:7.6214683055877686},{x:387.8068542480469,y:236.25958442687988,z:8.345099091529846},{x:393.95751953125,y:235.8660364151001,z:10.475142002105713},{x:401.84600830078125,y:232.77019500732422,z:16.760226488113403},{x:375.70568084716797,y:233.48456382751465,z:8.234220147132874},{x:388.17752838134766,y:218.94717693328857,z:6.810300946235657},{x:381.64928436279297,y:219.2656660079956,z:6.711093783378601},{x:394.4760513305664,y:219.66821193695068,z:9.173773527145386},{x:398.8843536376953,y:221.8837022781372,z:12.03328251838684},{x:406.5454864501953,y:237.12156772613525,z:19.7131085395813},{x:383.87447357177734,y:337.6932907104492,z:-8.631049990653992},{x:401.2682342529297,y:228.5916566848755,z:18.359217643737793,name:"leftEye"},{x:422.0449447631836,y:236.73934936523438,z:51.16771221160889},{x:412.69153594970703,y:232.80198097229004,z:27.52131938934326},{x:387.3497772216797,y:263.298397064209,z:-2.8609684109687805},{x:364.5124053955078,y:293.39221000671387,z:-22.397546768188477,name:"lips"},{x:363.62987518310547,y:302.1291446685791,z:-19.643079042434692},{x:373.2334518432617,y:295.8647060394287,z:-18.125789165496826,name:"lips"},{x:378.83365631103516,y:299.5177745819092,z:-13.153743743896484,name:"lips"},{x:369.91477966308594,y:302.5704002380371,z:-16.65518283843994},{x:374.9167251586914,y:303.5416603088379,z:-11.963253021240234},{x:387.58888244628906,y:312.2716999053955,z:-4.680258631706238},{x:360.6635284423828,y:264.31986808776855,z:-35.94811677932739},{x:361.04564666748047,y:256.8225860595703,z:-37.278664112091064},{x:408.3855438232422,y:213.52088928222656,z:15.756480693817139,name:"leftEyebrow"},{x:373.2946014404297,y:245.38101196289062,z:-1.9316278398036957},{x:376.83860778808594,y:264.3721103668213,z:-18.510947227478027},{x:376.9546127319336,y:261.0010528564453,z:-15.989909172058105},{x:406.1498260498047,y:263.5030174255371,z:7.072908878326416},{x:360.07205963134766,y:248.3631706237793,z:-32.16656446456909},{x:393.11119079589844,y:205.10473251342773,z:3.7786373496055603,name:"leftEyebrow"},{x:402.12791442871094,y:207.89000988006592,z:9.383859634399414,name:"leftEyebrow"},{x:410.8693313598633,y:191.6182279586792,z:41.27030849456787,name:"faceOval"},{x:364.9509811401367,y:210.40483474731445,z:-3.758212625980377},{x:375.94444274902344,y:221.1331844329834,z:8.368442058563232},{x:392.1904754638672,y:305.0360298156738,z:-1.752179116010666},{x:419.50225830078125,y:307.25592613220215,z:58.96425247192383,name:"faceOval"},{x:372.0027160644531,y:268.7212657928467,z:-16.631840467453003},{x:366.1614227294922,y:271.6237449645996,z:-18.219159841537476},{x:385.00938415527344,y:305.3863334655762,z:-2.567722797393799},{x:381.99771881103516,y:304.9723720550537,z:-4.575215280056},{x:405.078125,y:203.21216583251953,z:13.713973760604858,name:"leftEyebrow"},{x:377.13207244873047,y:268.4710121154785,z:-15.266278982162476},{x:380.9713363647461,y:205.36980628967285,z:-.7250899076461792,name:"leftEyebrow"},{x:381.7788314819336,y:198.9268398284912,z:-1.184653863310814,name:"leftEyebrow"},{x:385.5204772949219,y:172.1484375,z:16.04826807975769,name:"faceOval"},{x:407.94189453125,y:196.76236152648926,z:25.723915100097656},{x:383.03890228271484,y:184.5157527923584,z:7.393874526023865},{x:411.61781311035156,y:210.79241752624512,z:22.315845489501953,name:"leftEyebrow"},{x:414.30870056152344,y:208.4643030166626,z:37.021894454956055},{x:364.28722381591797,y:298.35777282714844,z:-21.86065673828125},{x:371.3682556152344,y:299.78848457336426,z:-17.834001779556274},{x:376.88201904296875,y:301.6696071624756,z:-13.153743743896484},{x:370.2193832397461,y:270.49095153808594,z:-15.569736957550049},{x:383.5081100463867,y:305.2726364135742,z:-3.673594295978546},{x:380.73760986328125,y:305.96869468688965,z:-8.660228252410889},{x:381.2334442138672,y:304.63574409484863,z:-4.820316135883331,name:"lips"},{x:368.1698989868164,y:264.8884963989258,z:-25.653886795043945},{x:373.5087203979492,y:303.4233856201172,z:-10.95950722694397,name:"lips"},{x:368.4544372558594,y:303.29601287841797,z:-14.169161319732666,name:"lips"},{x:362.76554107666016,y:303.5735607147217,z:-16.911956071853638,name:"lips"},{x:366.60980224609375,y:324.8870658874512,z:-15.616422891616821},{x:365.7067108154297,y:315.95678329467773,z:-20.903596878051758,name:"lips"},{x:365.0083923339844,y:311.2232208251953,z:-21.066999435424805},{x:364.1508102416992,y:307.0583438873291,z:-18.907777070999146},{x:363.37512969970703,y:304.5721435546875,z:-17.42550015449524,name:"lips"},{x:374.580078125,y:304.3059539794922,z:-11.40302300453186,name:"lips"},{x:375.55362701416016,y:305.0998020172119,z:-12.861957550048828},{x:377.2437286376953,y:307.1674346923828,z:-14.215847253799438},{x:378.68587493896484,y:309.9015712738037,z:-13.223772048950195,name:"lips"},{x:383.8992691040039,y:290.29629707336426,z:-9.97326910495758},{x:423.3871841430664,y:271.91688537597656,z:74.37058925628662,name:"faceOval"},{x:377.68043518066406,y:304.62209701538086,z:-7.603961229324341,name:"lips"},{x:379.00428771972656,y:304.9314594268799,z:-8.57852816581726},{x:364.00279998779297,y:275.2813911437988,z:-19.25792098045349},{x:374.68231201171875,y:273.82555961608887,z:-11.28047227859497},{x:365.0354766845703,y:273.4548568725586,z:-18.791062831878662},{x:380.61901092529297,y:249.8848056793213,z:.15501167625188828},{x:391.14158630371094,y:254.7934627532959,z:2.0906515419483185},{x:378.1761169433594,y:264.9612236022949,z:-12.605184316635132},{x:400.9540557861328,y:179.99592304229736,z:27.82477855682373,name:"faceOval"},{x:398.0038833618164,y:188.50656509399414,z:16.094952821731567},{x:394.8717498779297,y:199.0359592437744,z:6.226727366447449,name:"leftEyebrow"},{x:382.10926055908203,y:316.83926582336426,z:-8.946179747581482},{x:366.51588439941406,y:200.32583713531494,z:-5.24632453918457,name:"leftEyebrow"},{x:367.4893569946289,y:183.87210845947266,z:1.9039081037044525},{x:368.6243438720703,y:168.8127565383911,z:8.736093044281006,name:"faceOval"},{x:398.96175384521484,y:234.9675178527832,z:13.713973760604858},{x:412.9645538330078,y:242.23042488098145,z:23.272905349731445},{x:372.05257415771484,y:231.41919136047363,z:9.226294755935669},{x:406.0722351074219,y:223.58965873718262,z:18.370890617370605},{x:368.27442169189453,y:240.2039337158203,z:-4.166713654994965},{x:372.3575210571289,y:260.66442489624023,z:-24.976940155029297},{x:419.2244338989258,y:247.9079246520996,z:30.299127101898193},{x:409.43885803222656,y:246.60913467407227,z:16.398411989212036},{x:401.69139862060547,y:248.76328468322754,z:9.395531415939331},{x:389.7608184814453,y:247.56915092468262,z:5.841569304466248},{x:380.5461883544922,y:244.55984115600586,z:4.263003468513489},{x:373.25817108154297,y:240.80214500427246,z:2.5356262922286987},{x:358.77086639404297,y:229.35615062713623,z:-10.387605428695679},{x:419.5793914794922,y:262.8478717803955,z:26.5175724029541},{x:410.8808898925781,y:222.51372814178467,z:22.199130058288574},{x:358.45714569091797,y:268.91467094421387,z:-33.17030906677246},{x:373.4129333496094,y:251.6385841369629,z:-5.771540403366089},{x:422.5408172607422,y:239.23919677734375,z:74.04378890991211,name:"faceOval"},{x:367.8171920776367,y:236.58040523529053,z:1.820748895406723},{x:378.51959228515625,y:266.2532329559326,z:-5.74819803237915},{x:403.3472442626953,y:229.05112266540527,z:19.689764976501465},{x:372.34840393066406,y:256.6451168060303,z:-21.872329711914062},{x:422.54566192626953,y:289.1587829589844,z:68.67491245269775,name:"faceOval"},{x:371.9297409057617,y:228.90116214752197,z:11.432201862335205,name:"leftEye"},{x:366.21360778808594,y:251.6158962249756,z:-28.19826364517212},{x:409.1571807861328,y:321.3156223297119,z:20.2266526222229},{x:408.52943420410156,y:331.44238471984863,z:31.09278917312622,name:"faceOval"},{x:424.2788314819336,y:267.1992301940918,z:50.467424392700195},{x:415.60352325439453,y:311.6528606414795,z:30.579242706298828},{x:418.12793731689453,y:221.59927368164062,z:46.26569747924805},{x:385.68286895751953,y:346.0184955596924,z:-5.70151150226593},{x:357.82936096191406,y:271.3758373260498,z:-24.836881160736084},{x:379.588623046875,y:257.5071716308594,z:-3.755294680595398},{x:417.4592590332031,y:234.71948146820068,z:34.5475435256958},{x:393.4684371948242,y:231.58967971801758,z:11.408859491348267,name:"leftEye"},{x:387.8864288330078,y:232.14245796203613,z:9.51808214187622,name:"leftEye"},{x:382.4981689453125,y:307.5654888153076,z:-7.522260546684265,name:"lips"},{x:419.00169372558594,y:277.8332805633545,z:26.424202919006348},{x:373.62953186035156,y:357.6375102996826,z:-5.75986921787262,name:"faceOval"},{x:392.8708267211914,y:347.72446632385254,z:10.154176950454712,name:"faceOval"},{x:400.3953552246094,y:341.0005187988281,z:19.39797878265381,name:"faceOval"},{x:382.25440979003906,y:231.66935920715332,z:8.998700976371765,name:"leftEye"},{x:377.14550018310547,y:230.4228687286377,z:9.804032444953918,name:"leftEye"},{x:373.8358688354492,y:229.64950561523438,z:11.292144060134888,name:"leftEye"},{x:414.5794677734375,y:221.67891025543213,z:29.412097930908203},{x:377.00672149658203,y:225.66201210021973,z:9.360517263412476,name:"leftEye"},{x:382.29530334472656,y:224.8431158065796,z:8.32175612449646,name:"leftEye"},{x:387.5133514404297,y:224.49507236480713,z:8.917000889778137,name:"leftEye"},{x:393.15906524658203,y:225.24795055389404,z:10.737749338150024,name:"leftEye"},{x:397.05554962158203,y:226.55359268188477,z:13.002015352249146,name:"leftEye"},{x:420.5299377441406,y:221.014666557312,z:65.40690422058105,name:"faceOval"},{x:397.06920623779297,y:230.6661558151245,z:13.807345628738403,name:"leftEye"},{x:377.94647216796875,y:285.1647090911865,z:-13.305472135543823},{x:372.1118927001953,y:267.1267318725586,z:-18.83774757385254},{x:364.9968719482422,y:282.24411964416504,z:-19.818150997161865},{x:401.973876953125,y:331.20131492614746,z:11.566424369812012},{x:394.3083190917969,y:338.86693954467773,z:3.142542541027069},{x:373.9820861816406,y:351.4504623413086,z:-13.50388765335083},{x:414.3888854980469,y:321.24735832214355,z:45.51872253417969,name:"faceOval"},{x:373.44234466552734,y:227.33163356781006,z:10.626870393753052,name:"leftEye"},{x:364.0731430053711,y:240.31539916992188,z:-13.807345628738403},{x:384.2658233642578,y:353.3793067932129,z:.7385850697755814,name:"faceOval"},{x:423.20526123046875,y:283.5176181793213,z:47.152724266052246},{x:369.42798614501953,y:304.0898895263672,z:-14.647691249847412,name:"lips"},{x:370.63812255859375,y:305.90051651000977,z:-16.211668252944946},{x:371.91192626953125,y:309.0167713165283,z:-17.84567356109619},{x:373.0583953857422,y:313.3545398712158,z:-17.378815412521362,name:"lips"},{x:375.39905548095703,y:321.09289169311523,z:-13.118728399276733},{x:379.2567825317383,y:304.3582534790039,z:-7.924926280975342},{x:381.18797302246094,y:303.7031364440918,z:-7.843226194381714},{x:383.0918502807617,y:302.4884605407715,z:-7.6506465673446655,name:"lips"},{x:389.09461975097656,y:297.1475315093994,z:-5.5497825145721436},{x:411.6408920288086,y:280.24898529052734,z:12.02161192893982},{x:363.3110809326172,y:234.27620887756348,z:-6.775286793708801},{x:366.0474395751953,y:223.29872131347656,z:6.827808618545532},{x:370.34427642822266,y:225.1457118988037,z:9.558931589126587},{x:377.5371551513672,y:303.60079765319824,z:-7.358860373497009,name:"lips"},{x:412.9557800292969,y:299.53579902648926,z:19.39797878265381},{x:360.0810241699219,y:221.72012329101562,z:-2.153385728597641},{x:379.82784271240234,y:329.47723388671875,z:-10.48097848892212},{x:359.08477783203125,y:235.7911491394043,z:-18.079102039337158},{x:369.6688461303711,y:251.5407943725586,z:-14.962821006774902},{x:369.5555114746094,y:333.5307312011719,z:-15.67478060722351},{x:394.0193176269531,y:315.6973171234131,z:-.9920747578144073},{x:383.78997802734375,y:272.7268695831299,z:-4.689012169837952},{x:387.67765045166016,y:323.6722755432129,z:-5.640236139297485},{x:397.8769302368164,y:272.1331214904785,z:-.9395531564950943},{x:389.87476348876953,y:280.5630111694336,z:-4.29218202829361},{x:403.83888244628906,y:285.1167869567871,z:3.0229100584983826},{x:372.5467300415039,y:343.1070327758789,z:-16.153310537338257},{x:374.1112518310547,y:256.3721466064453,z:-10.574349164962769},{x:399.73785400390625,y:321.77515983581543,z:4.849494695663452},{x:392.03365325927734,y:330.56447982788086,z:-1.3407598435878754},{x:398.59134674072266,y:305.93902587890625,z:1.517290621995926},{x:417.95997619628906,y:290.9716987609863,z:26.89105987548828},{x:406.04541778564453,y:307.35154151916504,z:8.666064143180847},{x:420.75328826904297,y:298.40752601623535,z:41.78385257720947},{x:395.4522705078125,y:291.4153575897217,z:-2.1752697229385376},{x:368.6452102661133,y:245.8882999420166,z:-9.453888535499573},{x:370.34900665283203,y:263.56690406799316,z:-26.75100326538086},{x:374.98477935791016,y:266.6126346588135,z:-19.77146625518799},{x:366.99840545654297,y:258.12140464782715,z:-31.372904777526855},{x:371.00616455078125,y:217.63479709625244,z:5.60522198677063},{x:381.30577087402344,y:214.14087295532227,z:4.983716309070587},{x:390.1496124267578,y:213.38221549987793,z:5.593550801277161},{x:397.7696990966797,y:214.3659782409668,z:8.57852816581726},{x:403.1652069091797,y:217.65509605407715,z:13.013685941696167},{x:407.3551940917969,y:230.72525024414062,z:22.444231510162354},{x:424.0876770019531,y:251.7839241027832,z:51.16771221160889},{x:403.50196838378906,y:239.88757610321045,z:15.803166627883911},{x:397.31719970703125,y:241.49806022644043,z:11.233787536621094},{x:388.99425506591797,y:241.4366912841797,z:7.948269248008728},{x:380.7804489135742,y:239.78078842163086,z:6.600214838981628},{x:374.01336669921875,y:237.11946487426758,z:6.349278092384338},{x:369.39125061035156,y:234.35351371765137,z:5.987462401390076},{x:422.9730987548828,y:255.76455116271973,z:76.61150932312012,name:"faceOval"},{x:374.73915100097656,y:269.24214363098145,z:-16.608498096466064},{x:364.61681365966797,y:245.71088790893555,z:-20.02823829650879},{x:365.3834533691406,y:263.34174156188965,z:-32.32996463775635},{x:361.58252716064453,y:267.8273677825928,z:-30.345816612243652},{x:365.37208557128906,y:265.0249671936035,z:-29.178667068481445},{x:372.72605895996094,y:272.05135345458984,z:-14.834434986114502},{x:360.48614501953125,y:268.34827423095703,z:-32.189905643463135},{x:359.9516296386719,y:270.8049201965332,z:-24.650139808654785},{x:369.5049285888672,y:229.01945114135742,z:10.107489824295044},{x:365.5447769165039,y:230.24096488952637,z:5.593550801277161},{x:363.50669860839844,y:230.6208372116089,z:.43622106313705444},{x:399.3529510498047,y:227.65677452087402,z:15.35965085029602,name:"leftEye"},{x:402.5693130493164,y:224.60190296173096,z:15.931552648544312}],box:{xMin:277.8318977355957,yMin:168.7741756439209,xMax:424.2788314819336,yMax:359.8348903656006,width:146.4469337463379,height:191.0607147216797}},SAMPLE_FACELANDMARKER_RESULT:{faceLandmarks:[[{x:.5760777592658997,y:.8639070391654968,z:-.030997956171631813},{x:.572094738483429,y:.7886289358139038,z:-.07189624011516571},{x:.5723551511764526,y:.8075382709503174,z:-.03578168898820877},{x:.5548420548439026,y:.7188365459442139,z:-.057787876576185226},{x:.5706077814102173,y:.7674974799156189,z:-.07740399986505508},{x:.5681378245353699,y:.7387768030166626,z:-.07356284558773041},{x:.5621535181999207,y:.6681165099143982,z:-.04189874976873398},{x:.46613582968711853,y:.6679812073707581,z:.011289681307971478},{x:.5579932928085327,y:.6174106597900391,z:-.03502821549773216},{x:.5563451647758484,y:.5905600190162659,z:-.03928658738732338},{x:.5487832427024841,y:.4900572597980499,z:-.029898937791585922},{x:.5765544176101685,y:.8692144751548767,z:-.02831427752971649},{x:.5771114230155945,y:.873644232749939,z:-.02345779910683632},{x:.5771905779838562,y:.877016007900238,z:-.016658689826726913},{x:.5778058767318726,y:.8770116567611694,z:-.014505492523312569},{x:.5783766508102417,y:.8835000991821289,z:-.015996402129530907},{x:.5792440176010132,y:.8913810849189758,z:-.01924579218029976},{x:.5796768069267273,y:.8996334671974182,z:-.018261712044477463},{x:.5817288160324097,y:.9255813956260681,z:-.007126849144697189},{x:.5726592540740967,y:.7992473244667053,z:-.0643521398305893},{x:.5579419136047363,y:.7996989488601685,z:-.04566684365272522},{x:.4216199815273285,y:.5958762764930725,z:.06776496022939682},{x:.5052269697189331,y:.6796539425849915,z:-.0010737782577052712},{x:.49243026971817017,y:.6838865876197815,z:-.0005227324436418712},{x:.4796970784664154,y:.6856290102005005,z:.002684245817363262},{x:.4618356227874756,y:.6764569878578186,z:.013439622707664967},{x:.5160380601882935,y:.6737282276153564,z:-17607348127057776e-21},{x:.48070961236953735,y:.6255870461463928,z:-.008339674212038517},{x:.49719780683517456,y:.6256808042526245,z:-.008027955889701843},{x:.46674346923828125,y:.6317623853683472,z:-.004460199736058712},{x:.4582492709159851,y:.641118049621582,z:.0011905613355338573},{x:.45408669114112854,y:.6911458969116211,z:.020514748990535736},{x:.535312294960022,y:.9619986414909363,z:.012499462813138962},{x:.4608460068702698,y:.6628725528717041,z:.01517564244568348},{x:.4206731915473938,y:.6828458309173584,z:.07848648726940155},{x:.4390624463558197,y:.6796106696128845,z:.03283142298460007},{x:.5029968619346619,y:.7701570391654968,z:-.009734481573104858},{x:.5595027208328247,y:.8607323169708252,z:-.030043255537748337},{x:.5621269941329956,y:.8738374710083008,z:-.021709579974412918},{x:.5451499819755554,y:.865527331829071,z:-.022014077752828598},{x:.5351184010505676,y:.8705098032951355,z:-.011602800339460373},{x:.5495014190673828,y:.8744956254959106,z:-.016490943729877472},{x:.5395170450210571,y:.8759440779685974,z:-.007333362940698862},{x:.5183624029159546,y:.8959754705429077,z:.010520773939788342},{x:.5604349374771118,y:.7895449995994568,z:-.07082037627696991},{x:.557381272315979,y:.7687489986419678,z:-.07590588927268982},{x:.4432901442050934,y:.6308897733688354,z:.0027153254486620426},{x:.5258325338363647,y:.7151225805282593,z:-.014676518738269806},{x:.5271827578544617,y:.7833116054534912,z:-.037643320858478546},{x:.5257382988929749,y:.7717816233634949,z:-.03401920944452286},{x:.46516409516334534,y:.7705106735229492,z:.0065747760236263275},{x:.5558893084526062,y:.7420997619628906,z:-.0694495290517807},{x:.4720408320426941,y:.6066038608551025,z:-.021204356104135513},{x:.45432573556900024,y:.6158540844917297,z:-.011054684408009052},{x:.4305151402950287,y:.5608053803443909,z:.0396830290555954},{x:.5310865640640259,y:.6157484650611877,z:-.03081176057457924},{x:.5114666223526001,y:.6329749226570129,z:-.00335998204536736},{x:.506435751914978,y:.8786543607711792,z:.012980876490473747},{x:.4480472207069397,y:.8640613555908203,z:.12569651007652283},{x:.5372058153152466,y:.7942581176757812,z:-.03168361634016037},{x:.5488379597663879,y:.8001630306243896,z:-.03280917927622795},{x:.5213388204574585,y:.8794381618499756,z:.011892606504261494},{x:.5242055654525757,y:.8789222240447998,z:.008370225317776203},{x:.4477175176143646,y:.6039950251579285,z:-.0050799972377717495},{x:.526964008808136,y:.7916748523712158,z:-.02968614175915718},{x:.4971255660057068,y:.6050706505775452,z:-.028175678104162216},{x:.4938119053840637,y:.5882453918457031,z:-.03210941329598427},{x:.4757143557071686,y:.5094879865646362,z:-.01300730835646391},{x:.43947282433509827,y:.5816648006439209,z:.01415177434682846},{x:.485664039850235,y:.5477864146232605,z:-.023685332387685776},{x:.43635931611061096,y:.6226438283920288,z:.013606148771941662},{x:.42910251021385193,y:.6102726459503174,z:.03926564007997513},{x:.5605402588844299,y:.8680099248886108,z:-.027318159118294716},{x:.5474816560745239,y:.8702861070632935,z:-.019686367362737656},{x:.5373021364212036,y:.8728838562965393,z:-.010484928265213966},{x:.540735125541687,y:.7979167103767395,z:-.029073253273963928},{x:.5228585004806519,y:.87913578748703,z:.009915109723806381},{x:.530497670173645,y:.8815253973007202,z:.0020524784922599792},{x:.5259912610054016,y:.8790552616119385,z:.007895970717072487},{x:.5433906316757202,y:.7882310748100281,z:-.05121905356645584},{x:.541388213634491,y:.8777219653129578,z:-.00466804439201951},{x:.5515822172164917,y:.8767023086547852,z:-.010475946590304375},{x:.5637003779411316,y:.877059817314148,z:-.015273625031113625},{x:.5640299320220947,y:.9263423085212708,z:-.00658724969252944},{x:.5642300248146057,y:.8993074893951416,z:-.017653480172157288},{x:.5637336373329163,y:.8910360932350159,z:-.01852807030081749},{x:.5637134313583374,y:.8837276697158813,z:-.01482592523097992},{x:.564205527305603,y:.8768964409828186,z:-.01331155002117157},{x:.5419867634773254,y:.8778373599052429,z:-.0037720394320786},{x:.5404468774795532,y:.880696177482605,z:-.005610354244709015},{x:.5392338633537292,y:.8845721483230591,z:-.007352025713771582},{x:.538469672203064,y:.8891173601150513,z:-.005154991988092661},{x:.5189250111579895,y:.8452741503715515,z:-.009755070321261883},{x:.4258975088596344,y:.7662280797958374,z:.1387351155281067},{x:.5725725293159485,y:.8041572570800781,z:-.04583907872438431},{x:.5342061519622803,y:.8785833120346069,z:.002659974154084921},{x:.5324031114578247,y:.8804071545600891,z:.0017832003068178892},{x:.5538818836212158,y:.8078407645225525,z:-.03254539892077446},{x:.5325431823730469,y:.8026832938194275,z:-.019140373915433884},{x:.5514076948165894,y:.8043903112411499,z:-.03313535451889038},{x:.5131856203079224,y:.7284771800041199,z:-.009399853646755219},{x:.49331504106521606,y:.7443980574607849,z:-.005225230939686298},{x:.5239617824554443,y:.7807451486587524,z:-.025881027802824974},{x:.4473606050014496,y:.5315827131271362,z:.011164786294102669},{x:.45718759298324585,y:.5604941248893738,z:-.005943301599472761},{x:.4670005738735199,y:.5909327268600464,z:-.019681761041283607},{x:.5311570167541504,y:.9076261520385742,z:.00389476353302598},{x:.5249923467636108,y:.5893563628196716,z:-.037981919944286346},{x:.5166932344436646,y:.5429551005363464,z:-.03319704160094261},{x:.5085030198097229,y:.49676206707954407,z:-.02691275253891945},{x:.4687720239162445,y:.6834565997123718,z:.008113506250083447},{x:.4426414966583252,y:.7069531679153442,z:.028577271848917007},{x:.5230373740196228,y:.6675713658332825,z:.001773772411979735},{x:.4481240212917328,y:.6527872085571289,z:.012414850294589996},{x:.5339856743812561,y:.7012367844581604,z:-.020220188423991203},{x:.5347223281860352,y:.7761190533638,z:-.05141595005989075},{x:.4315067231655121,y:.7211957573890686,z:.04381405934691429},{x:.45203351974487305,y:.7206180095672607,z:.017288070172071457},{x:.46892452239990234,y:.7265436053276062,z:.005602988880127668},{x:.49314674735069275,y:.7202282547950745,z:-.0006408205372281373},{x:.5104925632476807,y:.7091827392578125,z:-.00362918758764863},{x:.5232142210006714,y:.698553740978241,z:-.00787867046892643},{x:.5497883558273315,y:.6743605136871338,z:-.036349106580019},{x:.43658503890037537,y:.7627100348472595,z:.042555369436740875},{x:.4397648870944977,y:.6528646349906921,z:.017956094816327095},{x:.5653332471847534,y:.7992802858352661,z:-.06365057826042175},{x:.5285563468933105,y:.736810564994812,z:-.018836988136172295},{x:.4180678725242615,y:.6792560815811157,z:.12284679710865021},{x:.5328429937362671,y:.6865872144699097,z:-.010484723374247551},{x:.5230283141136169,y:.7809416055679321,z:-.011922398582100868},{x:.4551771283149719,y:.6650775074958801,z:.01774493046104908},{x:.5337203741073608,y:.7618928551673889,z:-.04697106033563614},{x:.43463975191116333,y:.8133478164672852,z:.1354849934577942},{x:.5225707292556763,y:.6605283617973328,z:.004980515688657761},{x:.5441933870315552,y:.7497199773788452,z:-.06091512367129326},{x:.4774007797241211,y:.9159183502197266,z:.059622734785079956},{x:.48068761825561523,y:.9364941716194153,z:.08404944837093353},{x:.4268292486667633,y:.7657528519630432,z:.09051097184419632},{x:.46051913499832153,y:.8880485892295837,z:.0738474428653717},{x:.4243420660495758,y:.6434382200241089,z:.06230505183339119},{x:.5342157483100891,y:.9835634231567383,z:.021662971004843712},{x:.5668109655380249,y:.8042187094688416,z:-.044937074184417725},{x:.5176341533660889,y:.7530587315559387,z:-.012967454269528389},{x:.430206298828125,y:.6835605502128601,z:.04612284153699875},{x:.4794231951236725,y:.6732114553451538,z:.003970044665038586},{x:.49073347449302673,y:.6722435355186462,z:.0008692514384165406},{x:.5294116139411926,y:.884677529335022,z:.004413890186697245},{x:.4430122375488281,y:.80235356092453,z:.04987282305955887},{x:.5603825449943542,y:1.0092442035675049,z:.026417359709739685},{x:.5186598300933838,y:.9828659892082214,z:.0513598807156086},{x:.5010536909103394,y:.9640932679176331,z:.06591596454381943},{x:.5524769425392151,y:.539441704750061,z:-.035816047340631485},{x:.5879997611045837,y:1.0091472864151,z:.02285068854689598},{x:.5016193985939026,y:.6684437990188599,z:.00028415941051207483},{x:.511952817440033,y:.6642197370529175,z:.0021144719794392586},{x:.5194343328475952,y:.6623469591140747,z:.004674181342124939},{x:.4321230351924896,y:.6496355533599854,z:.03124697133898735},{x:.508686363697052,y:.6479565501213074,z:-.00044765998609364033},{x:.4963986277580261,y:.6431032419204712,z:-.0032507688738405704},{x:.4845542013645172,y:.6430778503417969,z:-.002903624437749386},{x:.4733612537384033,y:.647506833076477,z:.00023347247042693198},{x:.4668654501438141,y:.653346598148346,z:.004762572236359119},{x:.41815051436424255,y:.633708119392395,z:.09809435904026031},{x:.47159942984580994,y:.6711485385894775,z:.007849935442209244},{x:.5734396576881409,y:.8256140351295471,z:-.03155219927430153},{x:.5306524038314819,y:.8337990641593933,z:-.018351426348090172},{x:.5371729135513306,y:.7910830974578857,z:-.037286680191755295},{x:.5549534559249878,y:.8275275826454163,z:-.030664825811982155},{x:.5597432255744934,y:.6418541669845581,z:-.03318847343325615},{x:.4958484172821045,y:.9429569244384766,z:.048340678215026855},{x:.5140507817268372,y:.9634028077125549,z:.03589847311377525},{x:.5587693452835083,y:.9951097369194031,z:.00908728688955307},{x:.46411189436912537,y:.9051855206489563,z:.10601935535669327},{x:.5181609392166138,y:.6554316878318787,z:.002546071307733655},{x:.5436590909957886,y:.7085841298103333,z:-.03844436630606651},{x:.5872187614440918,y:.9960382580757141,z:.0063423276878893375},{x:.5379653573036194,y:.9989125728607178,z:.03636329993605614},{x:.4350326955318451,y:.8088565468788147,z:.09147704392671585},{x:.5523084998130798,y:.8773422837257385,z:-.009068487212061882},{x:.5510149598121643,y:.8816931843757629,z:-.011043853126466274},{x:.5503793954849243,y:.88776695728302,z:-.01348799467086792},{x:.5501549243927002,y:.8954370617866516,z:-.012142189778387547},{x:.546072781085968,y:.9192524552345276,z:-.003157563041895628},{x:.5314661860466003,y:.8771666884422302,z:.0005075141089037061},{x:.5293324589729309,y:.8762547969818115,z:.00039177737198770046},{x:.5275698900222778,y:.8750609755516052,z:47732755774632096e-21},{x:.5104271173477173,y:.8607332110404968,z:.0012934643309563398},{x:.45938700437545776,y:.8134918212890625,z:.023569690063595772},{x:.5418947339057922,y:.6864100694656372,z:-.027333909645676613},{x:.531914234161377,y:.6456130743026733,z:-.005434140563011169},{x:.523697018623352,y:.647885262966156,z:-.0002466466394253075},{x:.5338191390037537,y:.8783687353134155,z:.002268768846988678},{x:.46226605772972107,y:.8610277771949768,z:.04718952998518944},{x:.5434442758560181,y:.6456181406974792,z:-.02327350154519081},{x:.5399754643440247,y:.940219521522522,z:.005075343884527683},{x:.5661457777023315,y:.71457839012146,z:-.06242101639509201},{x:.5523148775100708,y:.6974870562553406,z:-.04863070324063301},{x:.5639959573745728,y:.6923378109931946,z:-.05180761218070984},{x:.5367592573165894,y:.7423217296600342,z:-.03623027727007866},{x:.5853689908981323,y:.9752064943313599,z:-.002361974213272333},{x:.5835235118865967,y:.9493685960769653,z:-.003941743168979883},{x:.5615018606185913,y:.949194610118866,z:-.0015953965485095978},{x:.5068561434745789,y:.9048219323158264,z:.01862684078514576},{x:.5134067535400391,y:.7971825003623962,z:-.008485661819577217},{x:.5223897099494934,y:.925589919090271,z:.01249657291918993},{x:.48500555753707886,y:.7959478497505188,z:-.0032065745908766985},{x:.5037734508514404,y:.8184596300125122,z:-.004932103678584099},{x:.4766361117362976,y:.828806459903717,z:.01027688942849636},{x:.5589827299118042,y:.974656343460083,z:.0009666886180639267},{x:.5294582843780518,y:.7541216611862183,z:-.025603046640753746},{x:.4973002076148987,y:.9208990931510925,z:.031931452453136444},{x:.5163551568984985,y:.9432790875434875,z:.024321340024471283},{x:.49399662017822266,y:.8814862370491028,z:.018687399104237556},{x:.44948166608810425,y:.836137592792511,z:.05702034756541252},{x:.47898444533348083,y:.8836610913276672,z:.03150695189833641},{x:.4454479217529297,y:.8499438166618347,z:.08868525922298431},{x:.49572959542274475,y:.8452823758125305,z:.0036111653316766024},{x:.5362502336502075,y:.7222585678100586,z:-.027912352234125137},{x:.5393770337104797,y:.7850722074508667,z:-.05415399745106697},{x:.531399667263031,y:.7898418307304382,z:-.03883346915245056},{x:.5451627373695374,y:.7717036604881287,z:-.06480253487825394},{x:.5206395983695984,y:.6287745833396912,z:-.010521138086915016},{x:.4974782466888428,y:.6191938519477844,z:-.014098240062594414},{x:.4774145185947418,y:.6193130612373352,z:-.013643337413668633},{x:.4616098403930664,y:.6259890198707581,z:-.008448202162981033},{x:.4516478478908539,y:.6368461847305298,z:9050309745362028e-20},{x:.4485096037387848,y:.6719120740890503,z:.022984720766544342},{x:.42177659273147583,y:.7240667343139648,z:.08511673659086227},{x:.4616215229034424,y:.6988231539726257,z:.014238474890589714},{x:.4755798876285553,y:.7034608721733093,z:.00625590980052948},{x:.4924992024898529,y:.7005885243415833,z:.0009391739731654525},{x:.5082254409790039,y:.693384051322937,z:-.0009464038303121924},{x:.5203112959861755,y:.6849707961082458,z:-.0022114769089967012},{x:.52867591381073,y:.6779075860977173,z:-.002962538506835699},{x:.4213953912258148,y:.7219811677932739,z:.1350894570350647},{x:.5320829749107361,y:.794858992099762,z:-.03181503340601921},{x:.5452795028686523,y:.7286570072174072,z:-.04771539941430092},{x:.5496407747268677,y:.7866933345794678,z:-.06452003121376038},{x:.557040274143219,y:.7962084412574768,z:-.05837344378232956},{x:.549176812171936,y:.7895247936248779,z:-.057761140167713165},{x:.5362890362739563,y:.8005836606025696,z:-.026903774589300156},{x:.560200035572052,y:.7983731031417847,z:-.06172555685043335},{x:.5616944432258606,y:.8022753596305847,z:-.045200999826192856},{x:.5273328423500061,y:.6611284017562866,z:.0029021520167589188},{x:.534850537776947,y:.6660012006759644,z:-.005215510260313749},{x:.5394860506057739,y:.6701375246047974,z:-.014931917190551758},{x:.4634307324886322,y:.658291757106781,z:.009295716881752014},{x:.4538393020629883,y:.6519932150840759,z:.00930330716073513},{x:.5776031613349915,y:.7159298658370972,z:-.057365912944078445},{x:.6504855155944824,y:.6461779475212097,z:.014184834435582161},{x:.5860154032707214,y:.7962266206741333,z:-.04522843658924103},{x:.6842049360275269,y:.5631637573242188,z:.07207967340946198},{x:.6152560710906982,y:.6674962639808655,z:.0007529259892180562},{x:.6280948519706726,y:.6684326529502869,z:.0016892586136236787},{x:.6408625245094299,y:.6663892269134521,z:.005331226624548435},{x:.6557814478874207,y:.6534678936004639,z:.01646413467824459},{x:.6035663485527039,y:.6639701724052429,z:.0013799630105495453},{x:.6329053044319153,y:.608010470867157,z:-.006195899099111557},{x:.6167260408401489,y:.6117533445358276,z:-.006319951266050339},{x:.6471013426780701,y:.6112449765205383,z:-.0017843559617176652},{x:.6560901999473572,y:.6185776591300964,z:.004047257360070944},{x:.6666946411132812,y:.6651176810264587,z:.023647578433156013},{x:.6311345100402832,y:.9495396018028259,z:.014004078693687916},{x:.6544655561447144,y:.6397901773452759,z:.01809609681367874},{x:.6965808868408203,y:.6482675075531006,z:.08304904401302338},{x:.679817259311676,y:.650188148021698,z:.03632688894867897},{x:.6336516737937927,y:.7541458010673523,z:-.007742783520370722},{x:.5921701192855835,y:.8567668199539185,z:-.029399123042821884},{x:.591663658618927,y:.870215654373169,z:-.02103729173541069},{x:.6068367958068848,y:.8584195375442505,z:-.020668085664510727},{x:.6176617741584778,y:.860965371131897,z:-.009790095500648022},{x:.6040634512901306,y:.8686612844467163,z:-.015289564616978168},{x:.6143736839294434,y:.8671170473098755,z:-.005712216719985008},{x:.6373105049133301,y:.8815656900405884,z:.012672550976276398},{x:.5832505822181702,y:.7866312861442566,z:-.07051534950733185},{x:.5836675763130188,y:.7658692598342896,z:-.07566110789775848},{x:.6709531545639038,y:.604898989200592,z:.005951565690338612},{x:.6029891967773438,y:.705652117729187,z:-.013388276100158691},{x:.6131622195243835,y:.7728396058082581,z:-.036248479038476944},{x:.6123163104057312,y:.7612020373344421,z:-.03264721855521202},{x:.6696187853813171,y:.744706928730011,z:.009673702530562878},{x:.5803102254867554,y:.7385968565940857,z:-.0689152330160141},{x:.6404349207878113,y:.5877999663352966,z:-.01929756999015808},{x:.6588467955589294,y:.5929454565048218,z:-.008487257175147533},{x:.6720337867736816,y:.530631422996521,z:.043437421321868896},{x:.584305465221405,y:.6099005341529846,z:-.030301367864012718},{x:.6034283638000488,y:.6217452883720398,z:-.001970183802768588},{x:.6460927724838257,y:.8608663082122803,z:.015541625209152699},{x:.6957815289497375,y:.8326103091239929,z:.13015234470367432},{x:.6043362617492676,y:.7861682772636414,z:-.030476901680231094},{x:.594293475151062,y:.7942103147506714,z:-.032218821346759796},{x:.6324057579040527,y:.8665139675140381,z:.014255806803703308},{x:.6296147704124451,y:.8667733669281006,z:.010388285852968693},{x:.663644552230835,y:.5798642635345459,z:-.0022301070857793093},{x:.6140630841255188,y:.7809288501739502,z:-.02835679054260254},{x:.615908145904541,y:.5921698212623596,z:-.026804860681295395},{x:.617181122303009,y:.5748661756515503,z:-.03060605563223362},{x:.6222207546234131,y:.49137672781944275,z:-.011151673272252083},{x:.6669357419013977,y:.5541607141494751,z:.017466170713305473},{x:.6182981729507446,y:.5320425629615784,z:-.021793590858578682},{x:.6760554313659668,y:.595052182674408,z:.017115700989961624},{x:.6801463961601257,y:.5800720453262329,z:.043127160519361496},{x:.5922210812568665,y:.8644017577171326,z:-.02662893570959568},{x:.6054555177688599,y:.8637874722480774,z:-.018363753333687782},{x:.6161889433860779,y:.8641164898872375,z:-.008808949030935764},{x:.6017249822616577,y:.7901403307914734,z:-.028126630932092667},{x:.631446123123169,y:.8664817810058594,z:.012112865224480629},{x:.6249198913574219,y:.8716511130332947,z:.003882825840264559},{x:.6281915903091431,y:.867301881313324,z:.009891441091895103},{x:.5986843109130859,y:.7813931703567505,z:-.050227612257003784},{x:.6126407384872437,y:.869275689125061,z:-.0031255714129656553},{x:.6027271151542664,y:.8711842894554138,z:-.009324162267148495},{x:.59088134765625,y:.8742044568061829,z:-.014608660712838173},{x:.5984604358673096,y:.9216185212135315,z:-.005981989670544863},{x:.5950398445129395,y:.8964707255363464,z:-.01703473925590515},{x:.5941568613052368,y:.8882410526275635,z:-.017784785479307175},{x:.5928806662559509,y:.8803883194923401,z:-.014153128489851952},{x:.5909661054611206,y:.8748103976249695,z:-.012609979137778282},{x:.6128016710281372,y:.8702545762062073,z:-.0022550546564161777},{x:.6150846481323242,y:.8726804256439209,z:-.00414019962772727},{x:.6173093914985657,y:.8770190477371216,z:-.005970994010567665},{x:.619335412979126,y:.8814800977706909,z:-.0036864024586975574},{x:.6292637586593628,y:.8314558267593384,z:-.007714875973761082},{x:.702275276184082,y:.7320667505264282,z:.1433621346950531},{x:.6204835176467896,y:.8689177632331848,z:.0044869170524179935},{x:.6223508715629578,y:.8704851269721985,z:.00352082890458405},{x:.590448260307312,y:.8029727935791016,z:-.03200828656554222},{x:.6097423434257507,y:.7933741211891174,z:-.018042555078864098},{x:.59229576587677,y:.7993767261505127,z:-.032564569264650345},{x:.6171364188194275,y:.7153720259666443,z:-.007672437466681004},{x:.6389747858047485,y:.726390540599823,z:-.002999067772179842},{x:.6151940226554871,y:.769412100315094,z:-.024427521973848343},{x:.6526776552200317,y:.505868136882782,z:.01412637997418642},{x:.6475822329521179,y:.5375454425811768,z:-.0033899128902703524},{x:.6433356404304504,y:.5714520215988159,z:-.017428796738386154},{x:.626949667930603,y:.8962116837501526,z:.005602736957371235},{x:.5868416428565979,y:.5829002261161804,z:-.03727729618549347},{x:.5877229571342468,y:.5345035791397095,z:-.032396964728832245},{x:.5887066125869751,y:.48655083775520325,z:-.025856535881757736},{x:.6507197618484497,y:.6612282991409302,z:.011114613153040409},{x:.6803066730499268,y:.677992045879364,z:.032125361263751984},{x:.5963194370269775,y:.6598632335662842,z:.002976928371936083},{x:.667536199092865,y:.6274255514144897,z:.015618261881172657},{x:.5930740833282471,y:.6940041780471802,z:-.019217798486351967},{x:.6053346395492554,y:.7676517963409424,z:-.050308309495449066},{x:.6934473514556885,y:.6884298920631409,z:.04794462397694588},{x:.6738007664680481,y:.6934011578559875,z:.020697161555290222},{x:.6588084697723389,y:.7033141851425171,z:.008462334051728249},{x:.6346072554588318,y:.7029502391815186,z:.001542167621664703},{x:.6157816648483276,y:.6966525912284851,z:-.002009218093007803},{x:.6015574336051941,y:.688928484916687,z:-.006588225718587637},{x:.5746836066246033,y:.6711069345474243,z:-.03597589209675789},{x:.6947521567344666,y:.7309479117393494,z:.046707939356565475},{x:.6759101152420044,y:.6249120831489563,z:.021654341369867325},{x:.5794773101806641,y:.7971615195274353,z:-.06339326500892639},{x:.6041849851608276,y:.727514922618866,z:-.017512541264295578},{x:.6968844532966614,y:.6440950036048889,z:.12727996706962585},{x:.5910853147506714,y:.679325520992279,z:-.009497715160250664},{x:.6157375574111938,y:.7695677280426025,z:-.010624290443956852},{x:.6606494784355164,y:.6410489678382874,z:.0208158977329731},{x:.6040687561035156,y:.7531470656394958,z:-.045887019485235214},{x:.7012156248092651,y:.780247151851654,z:.14028730988502502},{x:.595149576663971,y:.6527782678604126,z:.006308757700026035},{x:.5925500392913818,y:.7436665892601013,z:-.060151755809783936},{x:.6780198812484741,y:.8905693888664246,z:.0626060739159584},{x:.676746666431427,y:.9113880395889282,z:.08726003766059875},{x:.7030686140060425,y:.7312687635421753,z:.09529774636030197},{x:.688987135887146,y:.8588417172431946,z:.07752864807844162},{x:.6883691549301147,y:.6109960675239563,z:.06669612973928452},{x:.6358906030654907,y:.9702065587043762,z:.023120900616049767},{x:.5781539678573608,y:.8023634552955627,z:-.044763918966054916},{x:.6170316934585571,y:.7408350706100464,z:-.011375460773706436},{x:.688542366027832,y:.6516284346580505,z:.050206027925014496},{x:.6385149359703064,y:.6540714502334595,z:.006462941411882639},{x:.6279382109642029,y:.6563615798950195,z:.003062846139073372},{x:.6268895268440247,y:.8736732006072998,z:.00627936702221632},{x:.6944946050643921,y:.7709181308746338,z:.053824134171009064},{x:.614617109298706,y:1.0022112131118774,z:.02719894051551819},{x:.6493719220161438,y:.9665167927742004,z:.053563784807920456},{x:.6624587178230286,y:.943530797958374,z:.068605437874794},{x:.6162528991699219,y:.6558693051338196,z:.002187855076044798},{x:.6058168411254883,y:.654328465461731,z:.0036193584091961384},{x:.5987918972969055,y:.6536934971809387,z:.006134530063718557},{x:.6831037402153015,y:.6195642948150635,z:.03511790186166763},{x:.6062582731246948,y:.6356398463249207,z:.001280312892049551},{x:.6174948811531067,y:.62776118516922,z:-.0013642468256875873},{x:.6297246217727661,y:.6253792643547058,z:-.0007034156005829573},{x:.6407091617584229,y:.627578616142273,z:.0028144705574959517},{x:.6479622721672058,y:.6322650909423828,z:.00750273372977972},{x:.6915091276168823,y:.5990704298019409,z:.10270945727825165},{x:.6457163095474243,y:.6504453420639038,z:.010696077719330788},{x:.6164222955703735,y:.8231936097145081,z:-.016772059723734856},{x:.6042401194572449,y:.7830976843833923,z:-.03630910441279411},{x:.5922216773033142,y:.8228387236595154,z:-.029992375522851944},{x:.6646111011505127,y:.92097008228302,z:.050967294722795486},{x:.651232898235321,y:.9460107088088989,z:.038000158965587616},{x:.6140977144241333,y:.9882472157478333,z:.009882091544568539},{x:.6870781183242798,y:.8768675327301025,z:.10980932414531708},{x:.5986856818199158,y:.6456438899040222,z:.003999010659754276},{x:.585981547832489,y:.7034481763839722,z:-.0377722829580307},{x:.6342031359672546,y:.9867448806762695,z:.03786521404981613},{x:.7013950943946838,y:.776049017906189,z:.09598205983638763},{x:.6030206680297852,y:.8719133138656616,z:-.007931148633360863},{x:.6050592064857483,y:.8767156004905701,z:-.009791925549507141},{x:.6073468923568726,y:.8831382393836975,z:-.012361008673906326},{x:.6087977290153503,y:.890143632888794,z:-.01098148338496685},{x:.6147705316543579,y:.9110084772109985,z:-.0018823575228452682},{x:.622577965259552,y:.8670604825019836,z:.002609190298244357},{x:.6241236329078674,y:.8651344180107117,z:.0025534380692988634},{x:.6257084608078003,y:.8638408184051514,z:.0023300074972212315},{x:.639931321144104,y:.8449671268463135,z:.0038123116828501225},{x:.6810906529426575,y:.7856625318527222,z:.02717764675617218},{x:.583532452583313,y:.6811994910240173,z:-.026588857173919678},{x:.5855660438537598,y:.6393819451332092,z:-.004512844607234001},{x:.5932201743125916,y:.6398029327392578,z:.0008020466193556786},{x:.6200879812240601,y:.8683351874351501,z:.00417016725987196},{x:.6842559576034546,y:.8330534100532532,z:.050836317241191864},{x:.5754412412643433,y:.6418221592903137,z:-.022838059812784195},{x:.6232790350914001,y:.9295297265052795,z:.006339520215988159},{x:.5764067769050598,y:.694546639919281,z:-.04825803264975548},{x:.59778892993927,y:.7343927621841431,z:-.035004377365112305},{x:.6042810678482056,y:.9441440105438232,z:-.0010970570147037506},{x:.6496372222900391,y:.8869078159332275,z:.021036235615611076},{x:.6274012327194214,y:.7830310463905334,z:-.006658440921455622},{x:.637792706489563,y:.9104999899864197,z:.014290250837802887},{x:.6549934148788452,y:.7748609185218811,z:-.0006672973395325243},{x:.6404005289077759,y:.801220715045929,z:-.0026642554439604282},{x:.6671456694602966,y:.8045546412467957,z:.013180811889469624},{x:.6107483506202698,y:.9680658578872681,z:.001778992242179811},{x:.6060343980789185,y:.744587242603302,z:-.024382334202528},{x:.6602751612663269,y:.8998945355415344,z:.0344940721988678},{x:.6463775038719177,y:.9262562394142151,z:.02617623284459114},{x:.6579852104187012,y:.8602304458618164,z:.021586716175079346},{x:.6926165223121643,y:.8053340315818787,z:.061075080186128616},{x:.6724731922149658,y:.8594399690628052,z:.03457934781908989},{x:.6975721716880798,y:.8183245062828064,z:.09300774335861206},{x:.6512877941131592,y:.8258221745491028,z:.006324059329926968},{x:.594887375831604,y:.7148372530937195,z:-.026898479089140892},{x:.6017440557479858,y:.7773507833480835,z:-.05312420800328255},{x:.6096571683883667,y:.7806998491287231,z:-.037646256387233734},{x:.5952993035316467,y:.7654367685317993,z:-.06398405134677887},{x:.5950021147727966,y:.6201304793357849,z:-.009297547861933708},{x:.6165438890457153,y:.6052900552749634,z:-.012455573305487633},{x:.6362661719322205,y:.6015968918800354,z:-.011649220250546932},{x:.6522727608680725,y:.6046400666236877,z:-.005903332494199276},{x:.6625409722328186,y:.6128141283988953,z:.0030042496509850025},{x:.6688099503517151,y:.6457712054252625,z:.026322703808546066},{x:.7013440728187561,y:.6893666386604309,z:.08984331786632538},{x:.6608623266220093,y:.6749406456947327,z:.0172116681933403},{x:.6482325196266174,y:.6823726296424866,z:.008881398476660252},{x:.6313265562057495,y:.6842025518417358,z:.0031308617908507586},{x:.6147016286849976,y:.6809731721878052,z:.0007630771724507213},{x:.6018834114074707,y:.6755372285842896,z:-.0008834321051836014},{x:.5925027132034302,y:.670681357383728,z:-.001968748401850462},{x:.700127363204956,y:.6871103644371033,z:.13980500400066376},{x:.6095665693283081,y:.7853189706802368,z:-.03074747882783413},{x:.5880423784255981,y:.7229287028312683,z:-.04691500961780548},{x:.5930182337760925,y:.7811514139175415,z:-.06398335844278336},{x:.5867722034454346,y:.7922660112380981,z:-.05794971063733101},{x:.5933279991149902,y:.7842848896980286,z:-.05714067071676254},{x:.6063535809516907,y:.7920218706130981,z:-.02590685710310936},{x:.5839452743530273,y:.794978141784668,z:-.0615212507545948},{x:.5828126072883606,y:.8000800013542175,z:-.0449722595512867},{x:.5909603834152222,y:.6541213393211365,z:.003991890233010054},{x:.5852181911468506,y:.6602938771247864,z:-.004428438376635313},{x:.5825737714767456,y:.6651063561439514,z:-.014345290139317513},{x:.6517343521118164,y:.6362385153770447,z:.012151890434324741},{x:.6615052819252014,y:.6281577944755554,z:.0123682152479887},{x:.4856873154640198,y:.6568945646286011,z:.000720038078725338},{x:.49988406896591187,y:.6547410488128662,z:.0006949726957827806},{x:.48438939452171326,y:.6392973065376282,z:.000705525919329375},{x:.47143134474754333,y:.6589511632919312,z:.0006980331381782889},{x:.48704618215560913,y:.6752797961235046,z:.0006921177846379578},{x:.6243702173233032,y:.640461802482605,z:-6592126737814397e-20},{x:.6390967965126038,y:.6385173797607422,z:-.00016105435497593135},{x:.6230536699295044,y:.6224825382232666,z:-.00016136496560648084},{x:.6095397472381592,y:.641917884349823,z:-.0001803556369850412},{x:.6250996589660645,y:.6586247682571411,z:-.0001785515050869435}]],faceBlendshapes:[{categories:[{index:0,score:5187174338061595e-21,categoryName:"_neutral",displayName:""},{index:1,score:.24521504342556,categoryName:"browDownLeft",displayName:""},{index:2,score:.1987743377685547,categoryName:"browDownRight",displayName:""},{index:3,score:.013400448486208916,categoryName:"browInnerUp",displayName:""},{index:4,score:.012361560948193073,categoryName:"browOuterUpLeft",displayName:""},{index:5,score:.019305096939206123,categoryName:"browOuterUpRight",displayName:""},{index:6,score:28426356948330067e-21,categoryName:"cheekPuff",displayName:""},{index:7,score:34500112633395474e-23,categoryName:"cheekSquintLeft",displayName:""},{index:8,score:483789051486383e-21,categoryName:"cheekSquintRight",displayName:""},{index:9,score:.07650448381900787,categoryName:"eyeBlinkLeft",displayName:""},{index:10,score:.05070012807846069,categoryName:"eyeBlinkRight",displayName:""},{index:11,score:.13978900015354156,categoryName:"eyeLookDownLeft",displayName:""},{index:12,score:.14198613166809082,categoryName:"eyeLookDownRight",displayName:""},{index:13,score:.2177766114473343,categoryName:"eyeLookInLeft",displayName:""},{index:14,score:.014739357866346836,categoryName:"eyeLookInRight",displayName:""},{index:15,score:.02361512929201126,categoryName:"eyeLookOutLeft",displayName:""},{index:16,score:.19679604470729828,categoryName:"eyeLookOutRight",displayName:""},{index:17,score:.04874616861343384,categoryName:"eyeLookUpLeft",displayName:""},{index:18,score:.049392376095056534,categoryName:"eyeLookUpRight",displayName:""},{index:19,score:.34944331645965576,categoryName:"eyeSquintLeft",displayName:""},{index:20,score:.2939716875553131,categoryName:"eyeSquintRight",displayName:""},{index:21,score:.005955042317509651,categoryName:"eyeWideLeft",displayName:""},{index:22,score:.006776117719709873,categoryName:"eyeWideRight",displayName:""},{index:23,score:16942436559475027e-21,categoryName:"jawForward",displayName:""},{index:24,score:.0045165494084358215,categoryName:"jawLeft",displayName:""},{index:25,score:.07803940027952194,categoryName:"jawOpen",displayName:""},{index:26,score:2090057751047425e-20,categoryName:"jawRight",displayName:""},{index:27,score:.06032035872340202,categoryName:"mouthClose",displayName:""},{index:28,score:.00228882092051208,categoryName:"mouthDimpleLeft",displayName:""},{index:29,score:.00781762320548296,categoryName:"mouthDimpleRight",displayName:""},{index:30,score:.0017093931091949344,categoryName:"mouthFrownLeft",displayName:""},{index:31,score:.0019319106359034777,categoryName:"mouthFrownRight",displayName:""},{index:32,score:8485237776767462e-20,categoryName:"mouthFunnel",displayName:""},{index:33,score:.0009051355300471187,categoryName:"mouthLeft",displayName:""},{index:34,score:.0003630454302765429,categoryName:"mouthLowerDownLeft",displayName:""},{index:35,score:.00017601238505449146,categoryName:"mouthLowerDownRight",displayName:""},{index:36,score:.12865161895751953,categoryName:"mouthPressLeft",displayName:""},{index:37,score:.20137207210063934,categoryName:"mouthPressRight",displayName:""},{index:38,score:.0022203284315764904,categoryName:"mouthPucker",displayName:""},{index:39,score:.0009096377179957926,categoryName:"mouthRight",displayName:""},{index:40,score:.34189721941947937,categoryName:"mouthRollLower",displayName:""},{index:41,score:.11409689486026764,categoryName:"mouthRollUpper",displayName:""},{index:42,score:.17172536253929138,categoryName:"mouthShrugLower",displayName:""},{index:43,score:.004038424696773291,categoryName:"mouthShrugUpper",displayName:""},{index:44,score:.00023205230536404997,categoryName:"mouthSmileLeft",displayName:""},{index:45,score:.00019313619122840464,categoryName:"mouthSmileRight",displayName:""},{index:46,score:.0018571305554360151,categoryName:"mouthStretchLeft",displayName:""},{index:47,score:.0023813238367438316,categoryName:"mouthStretchRight",displayName:""},{index:48,score:24323100660694763e-21,categoryName:"mouthUpperUpLeft",displayName:""},{index:49,score:3161552012898028e-20,categoryName:"mouthUpperUpRight",displayName:""},{index:50,score:108198406678639e-21,categoryName:"noseSneerLeft",displayName:""},{index:51,score:12652527630052646e-22,categoryName:"noseSneerRight",displayName:""}],headIndex:-1,headName:""}],facialTransformationMatrixes:[{rows:4,columns:4,data:[.9947517514228821,.10230544209480286,.0013679931871592999,0,-.10230997204780579,.9947447776794434,.003816320328041911,0,-.000970348424743861,-.0039362297393381596,.9999914169311523,0,2.8888821601867676,-7.808934211730957,-30.52109146118164,1]}]}},qV=v.createContext({}),oD={basePath:"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.17/wasm",options:{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",outputFaceBlendshapes:!0,outputFacialTransformationMatrixes:!0}},YV=v.forwardRef(({basePath:t=oD.basePath,options:e=oD.options,children:n},r)=>{const i=JSON.stringify(e),s=ah(async()=>{const{FilesetResolver:o,FaceLandmarker:a}=await t6(async()=>{const{FilesetResolver:c,FaceLandmarker:u}=await import("./chunk-CPRQl8Yc.js");return{FilesetResolver:c,FaceLandmarker:u}},[]),l=await o.forVisionTasks(t);return a.createFromOptions(l,e)},[t,i]);return v.useEffect(()=>()=>{s==null||s.close(),q6([t,i])},[s,t,i]),v.useImperativeHandle(r,()=>s,[s]),v.createElement(qV.Provider,{value:s},n)});function W$e(){return v.useContext(qV)}function Mge(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function Cge(...t){return e=>t.forEach(n=>Mge(n,e))}const KV=v.forwardRef((t,e)=>{const{children:n,...r}=t,i=v.Children.toArray(n),s=i.find(Ige);if(s){const o=s.props.children,a=i.map(l=>l===s?v.Children.count(o)>1?v.Children.only(null):v.isValidElement(o)?o.props.children:null:l);return v.createElement(P5,It({},r,{ref:e}),v.isValidElement(o)?v.cloneElement(o,void 0,a):null)}return v.createElement(P5,It({},r,{ref:e}),n)});KV.displayName="Slot";const P5=v.forwardRef((t,e)=>{const{children:n,...r}=t;return v.isValidElement(n)?v.cloneElement(n,{...Pge(r,n.props),ref:Cge(e,n.ref)}):v.Children.count(n)>1?v.Children.only(null):null});P5.displayName="SlotClone";const Rge=({children:t})=>v.createElement(v.Fragment,null,t);function Ige(t){return v.isValidElement(t)&&t.type===Rge}function Pge(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...a)=>{s(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}const kge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Lge=kge.reduce((t,e)=>{const n=v.forwardRef((r,i)=>{const{asChild:s,...o}=r,a=s?KV:e;return v.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),v.createElement(a,It({},o,{ref:i}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{}),Dge=v.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...i}=t;return r?WB.createPortal(v.createElement(Lge.div,It({},i,{ref:e})),r):null}),Nge=Dge;var aD=Object.prototype.hasOwnProperty;function q1(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&q1(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(aD.call(t,n)&&++r&&!aD.call(e,n)||!(n in e)||!q1(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}function lE(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(e,n[r])||!Object.is(t[n[r]],e[n[r]]))return!1;return!0}var cE=function(e,n,r,i){this.name=e,this.fn=n,this.args=r,this.modifiers=i};cE.prototype._test=function(e){var n=this.fn;try{lm(this.modifiers.slice(),n,this)(e)}catch{n=function(){return!1}}try{return lm(this.modifiers.slice(),n,this)(e)}catch{return!1}};cE.prototype._check=function(e){try{lm(this.modifiers.slice(),this.fn,this)(e)}catch{if(lm(this.modifiers.slice(),function(r){return r},this)(!1))return}if(!lm(this.modifiers.slice(),this.fn,this)(e))throw null};cE.prototype._testAsync=function(e){var n=this;return new Promise(function(r,i){QV(n.modifiers.slice(),n.fn,n)(e).then(function(s){s?r(e):i(null)}).catch(function(s){return i(s)})})};function ZV(t,e){return e===void 0&&(e="simple"),typeof t=="object"?t[e]:t}function lm(t,e,n){if(t.length){var r=t.shift(),i=lm(t,e,n);return r.perform(i,n)}else return ZV(e)}function QV(t,e,n){if(t.length){var r=t.shift(),i=QV(t,e,n);return r.performAsync(i,n)}else return function(s){return Promise.resolve(ZV(e,"async")(s))}}var Oge=function(e,n,r){this.name=e,this.perform=n,this.performAsync=r},GC=function(t){function e(n,r,i,s){for(var o=[],a=arguments.length-4;a-- >0;)o[a]=arguments[a+4];t.call(this,o),t.captureStackTrace&&t.captureStackTrace(this,e),this.rule=n,this.value=r,this.cause=i,this.target=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),oc=function(e,n){e===void 0&&(e=[]),n===void 0&&(n=[]),this.chain=e,this.nextRuleModifiers=n};oc.prototype._applyRule=function(e,n){var r=this;return function(){for(var i=[],s=arguments.length;s--;)i[s]=arguments[s];return r.chain.push(new cE(n,e.apply(r,i),i,r.nextRuleModifiers)),r.nextRuleModifiers=[],r}};oc.prototype._applyModifier=function(e,n){return this.nextRuleModifiers.push(new Oge(n,e.simple,e.async)),this};oc.prototype._clone=function(){return new oc(this.chain.slice(),this.nextRuleModifiers.slice())};oc.prototype.test=function(e){return this.chain.every(function(n){return n._test(e)})};oc.prototype.testAll=function(e){var n=[];return this.chain.forEach(function(r){try{r._check(e)}catch(i){n.push(new GC(r,e,i))}}),n};oc.prototype.check=function(e){this.chain.forEach(function(n){try{n._check(e)}catch(r){throw new GC(n,e,r)}})};oc.prototype.testAsync=function(e){var n=this;return new Promise(function(r,i){JV(e,n.chain.slice(),r,i)})};function JV(t,e,n,r){if(e.length){var i=e.shift();i._testAsync(t).then(function(){JV(t,e,n,r)},function(s){r(new GC(i,t,s))})}else n(t)}var lD=function(t,e){return e&&typeof t=="string"&&t.trim().length===0?!0:t==null};function Fge(t,e){return e===void 0&&(e=!1),{simple:function(n){return lD(n,e)||t.check(n)===void 0},async:function(n){return lD(n,e)||t.testAsync(n)}}}function Vo(){return typeof Proxy<"u"?eW(new oc):k5(new oc)}var Y1={};Vo.extend=function(t){Object.assign(Y1,t)};Vo.clearCustomRules=function(){Y1={}};function eW(t){return new Proxy(t,{get:function(n,r){if(r in n)return n[r];var i=eW(t._clone());if(r in y_)return i._applyModifier(y_[r],r);if(r in Y1)return i._applyRule(Y1[r],r);if(r in L5)return i._applyRule(L5[r],r)}})}function k5(t){var e=function(i,s){return Object.keys(i).forEach(function(o){s[o]=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var c=k5(s._clone()),u=c._applyRule(i[o],o).apply(void 0,a);return u}}),s},n=e(L5,t),r=e(Y1,n);return Object.keys(y_).forEach(function(i){Object.defineProperty(r,i,{get:function(){var s=k5(r._clone());return s._applyModifier(y_[i],i)}})}),r}var y_={not:{simple:function(t){return function(e){return!t(e)}},async:function(t){return function(e){return Promise.resolve(t(e)).then(function(n){return!n}).catch(function(){return!0})}}},some:{simple:function(t){return function(e){return bx(e).some(function(n){try{return t(n)}catch{return!1}})}},async:function(t){return function(e){return Promise.all(bx(e).map(function(n){try{return t(n).catch(function(){return!1})}catch{return!1}})).then(function(n){return n.some(Boolean)})}}},every:{simple:function(t){return function(e){return e!==!1&&bx(e).every(t)}},async:function(t){return function(e){return Promise.all(bx(e).map(t)).then(function(n){return n.every(Boolean)})}}},strict:{simple:function(t,e){return function(n){return cD(e)&&n&&typeof n=="object"?Object.keys(e.args[0]).length===Object.keys(n).length&&t(n):t(n)}},async:function(t,e){return function(n){return Promise.resolve(t(n)).then(function(r){return cD(e)&&n&&typeof n=="object"?Object.keys(e.args[0]).length===Object.keys(n).length&&r:r}).catch(function(){return!1})}}}};function cD(t){return t&&t.name==="schema"&&t.args.length>0&&typeof t.args[0]=="object"}function bx(t){return typeof t=="string"?t.split(""):t}var L5={equal:function(t){return function(e){return e==t}},exact:function(t){return function(e){return e===t}},number:function(t){return t===void 0&&(t=!0),function(e){return typeof e=="number"&&(t||isFinite(e))}},integer:function(){return function(t){var e=Number.isInteger||Uge;return e(t)}},numeric:function(){return function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},string:function(){return xp("string")},boolean:function(){return xp("boolean")},undefined:function(){return xp("undefined")},null:function(){return xp("null")},array:function(){return xp("array")},object:function(){return xp("object")},instanceOf:function(t){return function(e){return e instanceof t}},pattern:function(t){return function(e){return t.test(e)}},lowercase:function(){return function(t){return typeof t=="boolean"||t===t.toLowerCase()&&t.trim()!==""}},uppercase:function(){return function(t){return t===t.toUpperCase()&&t.trim()!==""}},vowel:function(){return function(t){return/^[aeiou]+$/i.test(t)}},consonant:function(){return function(t){return/^(?=[^aeiou])([a-z]+)$/i.test(t)}},first:function(t){return function(e){return e[0]==t}},last:function(t){return function(e){return e[e.length-1]==t}},empty:function(){return function(t){return t.length===0}},length:function(t,e){return function(n){return n.length>=t&&n.length<=(e||t)}},minLength:function(t){return function(e){return e.length>=t}},maxLength:function(t){return function(e){return e.length<=t}},negative:function(){return function(t){return t<0}},positive:function(){return function(t){return t>=0}},between:function(t,e){return function(n){return n>=t&&n<=e}},range:function(t,e){return function(n){return n>=t&&n<=e}},lessThan:function(t){return function(e){return e<t}},lessThanOrEqual:function(t){return function(e){return e<=t}},greaterThan:function(t){return function(e){return e>t}},greaterThanOrEqual:function(t){return function(e){return e>=t}},even:function(){return function(t){return t%2===0}},odd:function(){return function(t){return t%2!==0}},includes:function(t){return function(e){return~e.indexOf(t)}},schema:function(t){return Bge(t)},passesAnyOf:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function(n){return t.some(function(r){return r.test(n)})}},optional:Fge};function xp(t){return function(e){return Array.isArray(e)&&t==="array"||e===null&&t==="null"||typeof e===t}}function Uge(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function Bge(t){return{simple:function(e){var n=[];if(Object.keys(t).forEach(function(r){var i=t[r];try{i.check((e||{})[r])}catch(s){s.target=r,n.push(s)}}),n.length>0)throw n;return!0},async:function(e){var n=[],r=Object.keys(t).map(function(i){var s=t[i];return s.testAsync((e||{})[i]).catch(function(o){o.target=i,n.push(o)})});return Promise.all(r).then(function(){if(n.length>0)throw n;return!0})}}}var Gr="colors",yo="sizes",pn="space",zge={gap:pn,gridGap:pn,columnGap:pn,gridColumnGap:pn,rowGap:pn,gridRowGap:pn,inset:pn,insetBlock:pn,insetBlockEnd:pn,insetBlockStart:pn,insetInline:pn,insetInlineEnd:pn,insetInlineStart:pn,margin:pn,marginTop:pn,marginRight:pn,marginBottom:pn,marginLeft:pn,marginBlock:pn,marginBlockEnd:pn,marginBlockStart:pn,marginInline:pn,marginInlineEnd:pn,marginInlineStart:pn,padding:pn,paddingTop:pn,paddingRight:pn,paddingBottom:pn,paddingLeft:pn,paddingBlock:pn,paddingBlockEnd:pn,paddingBlockStart:pn,paddingInline:pn,paddingInlineEnd:pn,paddingInlineStart:pn,top:pn,right:pn,bottom:pn,left:pn,scrollMargin:pn,scrollMarginTop:pn,scrollMarginRight:pn,scrollMarginBottom:pn,scrollMarginLeft:pn,scrollMarginX:pn,scrollMarginY:pn,scrollMarginBlock:pn,scrollMarginBlockEnd:pn,scrollMarginBlockStart:pn,scrollMarginInline:pn,scrollMarginInlineEnd:pn,scrollMarginInlineStart:pn,scrollPadding:pn,scrollPaddingTop:pn,scrollPaddingRight:pn,scrollPaddingBottom:pn,scrollPaddingLeft:pn,scrollPaddingX:pn,scrollPaddingY:pn,scrollPaddingBlock:pn,scrollPaddingBlockEnd:pn,scrollPaddingBlockStart:pn,scrollPaddingInline:pn,scrollPaddingInlineEnd:pn,scrollPaddingInlineStart:pn,fontSize:"fontSizes",background:Gr,backgroundColor:Gr,backgroundImage:Gr,borderImage:Gr,border:Gr,borderBlock:Gr,borderBlockEnd:Gr,borderBlockStart:Gr,borderBottom:Gr,borderBottomColor:Gr,borderColor:Gr,borderInline:Gr,borderInlineEnd:Gr,borderInlineStart:Gr,borderLeft:Gr,borderLeftColor:Gr,borderRight:Gr,borderRightColor:Gr,borderTop:Gr,borderTopColor:Gr,caretColor:Gr,color:Gr,columnRuleColor:Gr,fill:Gr,outline:Gr,outlineColor:Gr,stroke:Gr,textDecorationColor:Gr,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:yo,minBlockSize:yo,maxBlockSize:yo,inlineSize:yo,minInlineSize:yo,maxInlineSize:yo,width:yo,minWidth:yo,maxWidth:yo,height:yo,minHeight:yo,maxHeight:yo,flexBasis:yo,gridTemplateColumns:yo,gridTemplateRows:yo,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},Hge=(t,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,qm=()=>{const t=Object.create(null);return(e,n,...r)=>{const i=(s=>JSON.stringify(s,Hge))(e);return i in t?t[i]:t[i]=n(e,...r)}},Id=Symbol.for("sxs.internal"),jC=(t,e)=>Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),uD=t=>{for(const e in t)return!0;return!1},{hasOwnProperty:Gge}=Object.prototype,D5=t=>t.includes("-")?t:t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),jge=/\s+(?![^()]*\))/,_p=t=>e=>t(...typeof e=="string"?String(e).split(jge):[e]),fD={appearance:t=>({WebkitAppearance:t,appearance:t}),backfaceVisibility:t=>({WebkitBackfaceVisibility:t,backfaceVisibility:t}),backdropFilter:t=>({WebkitBackdropFilter:t,backdropFilter:t}),backgroundClip:t=>({WebkitBackgroundClip:t,backgroundClip:t}),boxDecorationBreak:t=>({WebkitBoxDecorationBreak:t,boxDecorationBreak:t}),clipPath:t=>({WebkitClipPath:t,clipPath:t}),content:t=>({content:t.includes('"')||t.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(t)?t:`"${t}"`}),hyphens:t=>({WebkitHyphens:t,hyphens:t}),maskImage:t=>({WebkitMaskImage:t,maskImage:t}),maskSize:t=>({WebkitMaskSize:t,maskSize:t}),tabSize:t=>({MozTabSize:t,tabSize:t}),textSizeAdjust:t=>({WebkitTextSizeAdjust:t,textSizeAdjust:t}),userSelect:t=>({WebkitUserSelect:t,userSelect:t}),marginBlock:_p((t,e)=>({marginBlockStart:t,marginBlockEnd:e||t})),marginInline:_p((t,e)=>({marginInlineStart:t,marginInlineEnd:e||t})),maxSize:_p((t,e)=>({maxBlockSize:t,maxInlineSize:e||t})),minSize:_p((t,e)=>({minBlockSize:t,minInlineSize:e||t})),paddingBlock:_p((t,e)=>({paddingBlockStart:t,paddingBlockEnd:e||t})),paddingInline:_p((t,e)=>({paddingInlineStart:t,paddingInlineEnd:e||t}))},yT=/([\d.]+)([^]*)/,Vge=(t,e)=>t.length?t.reduce((n,r)=>(n.push(...e.map(i=>i.includes("&")?i.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(i)?`:is(${r})`:r):r+" "+i)),n),[]):e,Wge=(t,e)=>t in $ge&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(n,r,i,s)=>r+(i==="stretch"?`-moz-available${s};${D5(t)}:${r}-webkit-fill-available`:`-moz-fit-content${s};${D5(t)}:${r}fit-content`)+s):String(e),$ge={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},ou=t=>t?t+"-":"",tW=(t,e,n)=>t.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,i,s,o,a)=>o=="$"==!!s?r:(i||o=="--"?"calc(":"")+"var(--"+(o==="$"?ou(e)+(a.includes("$")?"":ou(n))+a.replace(/\$/g,"-"):a)+")"+(i||o=="--"?"*"+(i||"")+(s||"1")+")":"")),Xge=/\s*,\s*(?![^()]*\))/,qge=Object.prototype.toString,qp=(t,e,n,r,i)=>{let s,o,a;const l=(c,u,f)=>{let d,h;const p=m=>{for(d in m){const x=d.charCodeAt(0)===64,_=x&&Array.isArray(m[d])?m[d]:[m[d]];for(h of _){const w=/[A-Z]/.test(y=d)?y:y.replace(/-[^]/g,S=>S[1].toUpperCase()),T=typeof h=="object"&&h&&h.toString===qge&&(!r.utils[w]||!u.length);if(w in r.utils&&!T){const S=r.utils[w];if(S!==o){o=S,p(S(h)),o=null;continue}}else if(w in fD){const S=fD[w];if(S!==a){a=S,p(S(h)),a=null;continue}}if(x&&(g=d.slice(1)in r.media?"@media "+r.media[d.slice(1)]:d,d=g.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(S,C,A,R,M,D)=>{const k=yT.test(C),L=.0625*(k?-1:1),[N,z]=k?[R,C]:[C,R];return"("+(A[0]==="="?"":A[0]===">"===k?"max-":"min-")+N+":"+(A[0]!=="="&&A.length===1?z.replace(yT,(O,K,V)=>Number(K)+L*(A===">"?1:-1)+V):z)+(M?") and ("+(M[0]===">"?"min-":"max-")+N+":"+(M.length===1?D.replace(yT,(O,K,V)=>Number(K)+L*(M===">"?-1:1)+V):D):"")+")"})),T){const S=x?f.concat(d):[...f],C=x?[...u]:Vge(u,d.split(Xge));s!==void 0&&i(dD(...s)),s=void 0,l(h,C,S)}else s===void 0&&(s=[[],u,f]),d=x||d.charCodeAt(0)!==36?d:`--${ou(r.prefix)}${d.slice(1).replace(/\$/g,"-")}`,h=T?h:typeof h=="number"?h&&w in Yge?String(h)+"px":String(h):tW(Wge(w,h??""),r.prefix,r.themeMap[w]),s[0].push(`${x?`${d} `:`${D5(d)}:`}${h}`)}}var g,y};p(c),s!==void 0&&i(dD(...s)),s=void 0};l(t,e,n)},dD=(t,e,n)=>`${n.map(r=>`${r}{`).join("")}${e.length?`${e.join(",")}{`:""}${t.join(";")}${e.length?"}":""}${Array(n.length?n.length+1:0).join("}")}`,Yge={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},hD=t=>String.fromCharCode(t+(t>25?39:97)),Pd=t=>(e=>{let n,r="";for(n=Math.abs(e);n>52;n=n/52|0)r=hD(n%52)+r;return hD(n%52)+r})(((e,n)=>{let r=n.length;for(;r;)e=33*e^n.charCodeAt(--r);return e})(5381,JSON.stringify(t))>>>0),Zg=["themed","global","styled","onevar","resonevar","allvar","inline"],Kge=t=>{if(t.href&&!t.href.startsWith(location.origin))return!1;try{return!!t.cssRules}catch{return!1}},Zge=t=>{let e;const n=()=>{const{cssRules:i}=e.sheet;return[].map.call(i,(s,o)=>{const{cssText:a}=s;let l="";if(a.startsWith("--sxs"))return"";if(i[o-1]&&(l=i[o-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const c in e.rules)if(e.rules[c].group===s)return`--sxs{--sxs:${[...e.rules[c].cache].join(" ")}}${a}`;return s.cssRules.length?`${l}${a}`:""}return a}).join("")},r=()=>{if(e){const{rules:a,sheet:l}=e;if(!l.deleteRule){for(;Object(Object(l.cssRules)[0]).type===3;)l.cssRules.splice(0,1);l.cssRules=[]}for(const c in a)delete a[c]}const i=Object(t).styleSheets||[];for(const a of i)if(Kge(a)){for(let l=0,c=a.cssRules;c[l];++l){const u=Object(c[l]);if(u.type!==1)continue;const f=Object(c[l+1]);if(f.type!==4)continue;++l;const{cssText:d}=u;if(!d.startsWith("--sxs"))continue;const h=d.slice(14,-3).trim().split(/\s+/),p=Zg[h[0]];p&&(e||(e={sheet:a,reset:r,rules:{},toString:n}),e.rules[p]={group:f,index:l,cache:new Set(h)})}if(e)break}if(!e){const a=(l,c)=>({type:c,cssRules:[],insertRule(u,f){this.cssRules.splice(f,0,a(u,{import:3,undefined:1}[(u.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return l==="@media{}"?`@media{${[].map.call(this.cssRules,u=>u.cssText).join("")}}`:l}});e={sheet:t?(t.head||t).appendChild(document.createElement("style")).sheet:a("","text/css"),rules:{},reset:r,toString:n}}const{sheet:s,rules:o}=e;for(let a=Zg.length-1;a>=0;--a){const l=Zg[a];if(!o[l]){const c=Zg[a+1],u=o[c]?o[c].index:s.cssRules.length;s.insertRule("@media{}",u),s.insertRule(`--sxs{--sxs:${a}}`,u),o[l]={group:s.cssRules[u+1],index:u,cache:new Set([a])}}Qge(o[l])}};return r(),e},Qge=t=>{const e=t.group;let n=e.cssRules.length;t.apply=r=>{try{e.insertRule(r,n),++n}catch{}}},yg=Symbol(),Jge=qm(),pD=(t,e)=>Jge(t,()=>(...n)=>{let r={type:null,composers:new Set};for(const i of n)if(i!=null)if(i[Id]){r.type==null&&(r.type=i[Id].type);for(const s of i[Id].composers)r.composers.add(s)}else i.constructor!==Object||i.$$typeof?r.type==null&&(r.type=i):r.composers.add(e1e(i,t));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),t1e(t,r,e)}),e1e=({variants:t,compoundVariants:e,defaultVariants:n,...r},i)=>{const s=`${ou(i.prefix)}c-${Pd(r)}`,o=[],a=[],l=Object.create(null),c=[];for(const d in n)l[d]=String(n[d]);if(typeof t=="object"&&t)for(const d in t){u=l,f=d,Gge.call(u,f)||(l[d]="undefined");const h=t[d];for(const p in h){const m={[d]:String(p)};String(p)==="undefined"&&c.push(d);const g=h[p],y=[m,g,!uD(g)];o.push(y)}}var u,f;if(typeof e=="object"&&e)for(const d of e){let{css:h,...p}=d;h=typeof h=="object"&&h||{};for(const g in p)p[g]=String(p[g]);const m=[p,h,!uD(h)];a.push(m)}return[s,r,o,a,l,c]},t1e=(t,e,n)=>{const[r,i,s,o]=n1e(e.composers),a=typeof e.type=="function"||e.type.$$typeof?(f=>{function d(){for(let h=0;h<d[yg].length;h++){const[p,m]=d[yg][h];f.rules[p].apply(m)}return d[yg]=[],null}return d[yg]=[],d.rules={},Zg.forEach(h=>d.rules[h]={apply:p=>d[yg].push([h,p])}),d})(n):null,l=(a||n).rules,c=`.${r}${i.length>1?`:where(.${i.slice(1).join(".")})`:""}`,u=f=>{f=typeof f=="object"&&f||r1e;const{css:d,...h}=f,p={};for(const y in s)if(delete h[y],y in f){let x=f[y];typeof x=="object"&&x?p[y]={"@initial":s[y],...x}:(x=String(x),p[y]=x!=="undefined"||o.has(y)?x:s[y])}else p[y]=s[y];const m=new Set([...i]);for(const[y,x,_,w]of e.composers){n.rules.styled.cache.has(y)||(n.rules.styled.cache.add(y),qp(x,[`.${y}`],[],t,C=>{l.styled.apply(C)}));const T=mD(_,p,t.media),S=mD(w,p,t.media,!0);for(const C of T)if(C!==void 0)for(const[A,R,M]of C){const D=`${y}-${Pd(R)}-${A}`;m.add(D);const k=(M?n.rules.resonevar:n.rules.onevar).cache,L=M?l.resonevar:l.onevar;k.has(D)||(k.add(D),qp(R,[`.${D}`],[],t,N=>{L.apply(N)}))}for(const C of S)if(C!==void 0)for(const[A,R]of C){const M=`${y}-${Pd(R)}-${A}`;m.add(M),n.rules.allvar.cache.has(M)||(n.rules.allvar.cache.add(M),qp(R,[`.${M}`],[],t,D=>{l.allvar.apply(D)}))}}if(typeof d=="object"&&d){const y=`${r}-i${Pd(d)}-css`;m.add(y),n.rules.inline.cache.has(y)||(n.rules.inline.cache.add(y),qp(d,[`.${y}`],[],t,x=>{l.inline.apply(x)}))}for(const y of String(f.className||"").trim().split(/\s+/))y&&m.add(y);const g=h.className=[...m].join(" ");return{type:e.type,className:g,selector:c,props:h,toString:()=>g,deferredInjector:a}};return jC(u,{className:r,selector:c,[Id]:e,toString:()=>(n.rules.styled.cache.has(r)||u(),r)})},n1e=t=>{let e="";const n=[],r={},i=[];for(const[s,,,,o,a]of t){e===""&&(e=s),n.push(s),i.push(...a);for(const l in o){const c=o[l];(r[l]===void 0||c!=="undefined"||a.includes(c))&&(r[l]=c)}}return[e,n,r,new Set(i)]},mD=(t,e,n,r)=>{const i=[];e:for(let[s,o,a]of t){if(a)continue;let l,c=0,u=!1;for(l in s){const f=s[l];let d=e[l];if(d!==f){if(typeof d!="object"||!d)continue e;{let h,p,m=0;for(const g in d){if(f===String(d[g])){if(g!=="@initial"){const y=g.slice(1);(p=p||[]).push(y in n?n[y]:g.replace(/^@media ?/,"")),u=!0}c+=m,h=!0}++m}if(p&&p.length&&(o={["@media "+p.join(", ")]:o}),!h)continue e}}}(i[c]=i[c]||[]).push([r?"cv":`${l}-${s[l]}`,o,u])}return i},r1e={},i1e=qm(),s1e=(t,e)=>i1e(t,()=>(...n)=>{const r=()=>{for(let i of n){i=typeof i=="object"&&i||{};let s=Pd(i);if(!e.rules.global.cache.has(s)){if(e.rules.global.cache.add(s),"@import"in i){let o=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let a of[].concat(i["@import"]))a=a.includes('"')||a.includes("'")?a:`"${a}"`,e.sheet.insertRule(`@import ${a};`,o++);delete i["@import"]}qp(i,[],[],t,o=>{e.rules.global.apply(o)})}}return""};return jC(r,{toString:r})}),o1e=qm(),a1e=(t,e)=>o1e(t,()=>n=>{const r=`${ou(t.prefix)}k-${Pd(n)}`,i=()=>{if(!e.rules.global.cache.has(r)){e.rules.global.cache.add(r);const s=[];qp(n,[],[],t,a=>s.push(a));const o=`@keyframes ${r}{${s.join("")}}`;e.rules.global.apply(o)}return r};return jC(i,{get name(){return i()},toString:i})}),l1e=class{constructor(t,e,n,r){this.token=t==null?"":String(t),this.value=e==null?"":String(e),this.scale=n==null?"":String(n),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+ou(this.prefix)+ou(this.scale)+this.token}toString(){return this.computedValue}},c1e=qm(),u1e=(t,e)=>c1e(t,()=>(n,r)=>{r=typeof n=="object"&&n||Object(r);const i=`.${n=(n=typeof n=="string"?n:"")||`${ou(t.prefix)}t-${Pd(r)}`}`,s={},o=[];for(const l in r){s[l]={};for(const c in r[l]){const u=`--${ou(t.prefix)}${l}-${c}`,f=tW(String(r[l][c]),t.prefix,l);s[l][c]=new l1e(c,f,l,t.prefix),o.push(`${u}:${f}`)}}const a=()=>{if(o.length&&!e.rules.themed.cache.has(n)){e.rules.themed.cache.add(n);const l=`${r===t.theme?":root,":""}.${n}{${o.join(";")}}`;e.rules.themed.apply(l)}return n};return{...s,get className(){return a()},selector:i,toString:a}}),f1e=qm(),d1e=qm(),h1e=t=>{const e=(n=>{let r=!1;const i=f1e(n,s=>{r=!0;const o="prefix"in(s=typeof s=="object"&&s||{})?String(s.prefix):"",a=typeof s.media=="object"&&s.media||{},l=typeof s.root=="object"?s.root||null:globalThis.document||null,c=typeof s.theme=="object"&&s.theme||{},u={prefix:o,media:a,theme:c,themeMap:typeof s.themeMap=="object"&&s.themeMap||{...zge},utils:typeof s.utils=="object"&&s.utils||{}},f=Zge(l),d={css:pD(u,f),globalCss:s1e(u,f),keyframes:a1e(u,f),createTheme:u1e(u,f),reset(){f.reset(),d.theme.toString()},theme:{},sheet:f,config:u,prefix:o,getCssText:f.toString,toString:f.toString};return String(d.theme=d.createTheme(c)),d});return r||i.reset(),i})(t);return e.styled=(({config:n,sheet:r})=>d1e(n,()=>{const i=pD(n,r);return(...s)=>{const o=i(...s),a=o[Id].type,l=Ge.forwardRef((c,u)=>{const f=c&&c.as||a,{props:d,deferredInjector:h}=o(c);return delete d.as,d.ref=u,h?Ge.createElement(Ge.Fragment,null,Ge.createElement(f,d),Ge.createElement(h,null)):Ge.createElement(f,d)});return l.className=o.className,l.displayName=`Styled.${a.displayName||a.name||a}`,l.selector=o.selector,l.toString=()=>o.selector,l[Id]=o[Id],l}}))(e),e};function Bc(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function gD(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function nW(...t){return e=>{let n=!1;const r=t.map(i=>{const s=gD(i,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():gD(t[i],null)}}}}function dh(...t){return v.useCallback(nW(...t),t)}function rW(t,e=[]){let n=[];function r(s,o){const a=v.createContext(o),l=n.length;n=[...n,o];const c=f=>{var y;const{scope:d,children:h,...p}=f,m=((y=d==null?void 0:d[t])==null?void 0:y[l])||a,g=v.useMemo(()=>p,Object.values(p));return H.jsx(m.Provider,{value:g,children:h})};c.displayName=s+"Provider";function u(f,d){var m;const h=((m=d==null?void 0:d[t])==null?void 0:m[l])||a,p=v.useContext(h);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${s}\``)}return[c,u]}const i=()=>{const s=n.map(o=>v.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,p1e(i,...e)]}function p1e(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const f=l(s)[`__scope${c}`];return{...a,...f}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var iW=v.forwardRef((t,e)=>{const{children:n,...r}=t,i=v.Children.toArray(n),s=i.find(m1e);if(s){const o=s.props.children,a=i.map(l=>l===s?v.Children.count(o)>1?v.Children.only(null):v.isValidElement(o)?o.props.children:null:l);return H.jsx(N5,{...r,ref:e,children:v.isValidElement(o)?v.cloneElement(o,void 0,a):null})}return H.jsx(N5,{...r,ref:e,children:n})});iW.displayName="Slot";var N5=v.forwardRef((t,e)=>{const{children:n,...r}=t;if(v.isValidElement(n)){const i=y1e(n);return v.cloneElement(n,{...g1e(r,n.props),ref:e?nW(e,i):i})}return v.Children.count(n)>1?v.Children.only(null):null});N5.displayName="SlotClone";var sW=({children:t})=>H.jsx(H.Fragment,{children:t});function m1e(t){return v.isValidElement(t)&&t.type===sW}function g1e(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...a)=>{s(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}function y1e(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var v1e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],hh=v1e.reduce((t,e)=>{const n=v.forwardRef((r,i)=>{const{asChild:s,...o}=r,a=s?iW:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),H.jsx(a,{...o,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function x1e(t,e){t&&r6.flushSync(()=>t.dispatchEvent(e))}function Ym(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function _1e(t,e=globalThis==null?void 0:globalThis.document){const n=Ym(t);v.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var b1e="DismissableLayer",O5="dismissableLayer.update",E1e="dismissableLayer.pointerDownOutside",w1e="dismissableLayer.focusOutside",yD,oW=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),aW=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=t,c=v.useContext(oW),[u,f]=v.useState(null),d=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=v.useState({}),p=dh(e,C=>f(C)),m=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(g),x=u?m.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,w=x>=y,T=A1e(C=>{const A=C.target,R=[...c.branches].some(M=>M.contains(A));!w||R||(i==null||i(C),o==null||o(C),C.defaultPrevented||a==null||a())},d),S=M1e(C=>{const A=C.target;[...c.branches].some(M=>M.contains(A))||(s==null||s(C),o==null||o(C),C.defaultPrevented||a==null||a())},d);return _1e(C=>{x===c.layers.size-1&&(r==null||r(C),!C.defaultPrevented&&a&&(C.preventDefault(),a()))},d),v.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(yD=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),vD(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=yD)}},[u,d,n,c]),v.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),vD())},[u,c]),v.useEffect(()=>{const C=()=>h({});return document.addEventListener(O5,C),()=>document.removeEventListener(O5,C)},[]),H.jsx(hh.div,{...l,ref:p,style:{pointerEvents:_?w?"auto":"none":void 0,...t.style},onFocusCapture:Bc(t.onFocusCapture,S.onFocusCapture),onBlurCapture:Bc(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:Bc(t.onPointerDownCapture,T.onPointerDownCapture)})});aW.displayName=b1e;var S1e="DismissableLayerBranch",T1e=v.forwardRef((t,e)=>{const n=v.useContext(oW),r=v.useRef(null),i=dh(e,r);return v.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),H.jsx(hh.div,{...t,ref:i})});T1e.displayName=S1e;function A1e(t,e=globalThis==null?void 0:globalThis.document){const n=Ym(t),r=v.useRef(!1),i=v.useRef(()=>{});return v.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let l=function(){lW(E1e,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function M1e(t,e=globalThis==null?void 0:globalThis.document){const n=Ym(t),r=v.useRef(!1);return v.useEffect(()=>{const i=s=>{s.target&&!r.current&&lW(w1e,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function vD(){const t=new CustomEvent(O5);document.dispatchEvent(t)}function lW(t,e,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?x1e(i,s):i.dispatchEvent(s)}var _m=globalThis!=null&&globalThis.document?v.useLayoutEffect:()=>{},C1e=Ree.useId||(()=>{}),R1e=0;function I1e(t){const[e,n]=v.useState(C1e());return _m(()=>{n(r=>r??String(R1e++))},[t]),e?`radix-${e}`:""}const P1e=["top","right","bottom","left"],yf=Math.min,ca=Math.max,v_=Math.round,Ex=Math.floor,nc=t=>({x:t,y:t}),k1e={left:"right",right:"left",bottom:"top",top:"bottom"},L1e={start:"end",end:"start"};function F5(t,e,n){return ca(t,yf(e,n))}function au(t,e){return typeof t=="function"?t(e):t}function lu(t){return t.split("-")[0]}function Km(t){return t.split("-")[1]}function VC(t){return t==="x"?"y":"x"}function WC(t){return t==="y"?"height":"width"}function vf(t){return["top","bottom"].includes(lu(t))?"y":"x"}function $C(t){return VC(vf(t))}function D1e(t,e,n){n===void 0&&(n=!1);const r=Km(t),i=$C(t),s=WC(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=x_(o)),[o,x_(o)]}function N1e(t){const e=x_(t);return[U5(t),e,U5(e)]}function U5(t){return t.replace(/start|end/g,e=>L1e[e])}function O1e(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function F1e(t,e,n,r){const i=Km(t);let s=O1e(lu(t),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(U5)))),s}function x_(t){return t.replace(/left|right|bottom|top/g,e=>k1e[e])}function U1e(t){return{top:0,right:0,bottom:0,left:0,...t}}function cW(t){return typeof t!="number"?U1e(t):{top:t,right:t,bottom:t,left:t}}function __(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function xD(t,e,n){let{reference:r,floating:i}=t;const s=vf(e),o=$C(e),a=WC(o),l=lu(e),c=s==="y",u=r.x+r.width/2-i.width/2,f=r.y+r.height/2-i.height/2,d=r[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:f};break;case"left":h={x:r.x-i.width,y:f};break;default:h={x:r.x,y:r.y}}switch(Km(e)){case"start":h[o]-=d*(n&&c?-1:1);break;case"end":h[o]+=d*(n&&c?-1:1);break}return h}const B1e=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:f}=xD(c,r,l),d=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:y}=a[m],{x,y:_,data:w,reset:T}=await y({x:u,y:f,initialPlacement:r,placement:d,strategy:i,middlewareData:h,rects:c,platform:o,elements:{reference:t,floating:e}});u=x??u,f=_??f,h={...h,[g]:{...h[g],...w}},T&&p<=50&&(p++,typeof T=="object"&&(T.placement&&(d=T.placement),T.rects&&(c=T.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):T.rects),{x:u,y:f}=xD(c,d,l)),m=-1)}return{x:u,y:f,placement:d,strategy:i,middlewareData:h}};async function K1(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:d=!1,padding:h=0}=au(e,t),p=cW(h),g=a[d?f==="floating"?"reference":"floating":f],y=__(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(g)))==null||n?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=f==="floating"?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,_=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),w=await(s.isElement==null?void 0:s.isElement(_))?await(s.getScale==null?void 0:s.getScale(_))||{x:1,y:1}:{x:1,y:1},T=__(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:_,strategy:l}):x);return{top:(y.top-T.top+p.top)/w.y,bottom:(T.bottom-y.bottom+p.bottom)/w.y,left:(y.left-T.left+p.left)/w.x,right:(T.right-y.right+p.right)/w.x}}const z1e=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=au(t,e)||{};if(c==null)return{};const f=cW(u),d={x:n,y:r},h=$C(i),p=WC(h),m=await o.getDimensions(c),g=h==="y",y=g?"top":"left",x=g?"bottom":"right",_=g?"clientHeight":"clientWidth",w=s.reference[p]+s.reference[h]-d[h]-s.floating[p],T=d[h]-s.reference[h],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let C=S?S[_]:0;(!C||!await(o.isElement==null?void 0:o.isElement(S)))&&(C=a.floating[_]||s.floating[p]);const A=w/2-T/2,R=C/2-m[p]/2-1,M=yf(f[y],R),D=yf(f[x],R),k=M,L=C-m[p]-D,N=C/2-m[p]/2+A,z=F5(k,N,L),O=!l.arrow&&Km(i)!=null&&N!==z&&s.reference[p]/2-(N<k?M:D)-m[p]/2<0,K=O?N<k?N-k:N-L:0;return{[h]:d[h]+K,data:{[h]:z,centerOffset:N-z-K,...O&&{alignmentOffset:K}},reset:O}}}),H1e=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=au(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const y=lu(i),x=vf(a),_=lu(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),T=d||(_||!m?[x_(a)]:N1e(a)),S=p!=="none";!d&&S&&T.push(...F1e(a,m,p,w));const C=[a,...T],A=await K1(e,g),R=[];let M=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&R.push(A[y]),f){const N=D1e(i,o,w);R.push(A[N[0]],A[N[1]])}if(M=[...M,{placement:i,overflows:R}],!R.every(N=>N<=0)){var D,k;const N=(((D=s.flip)==null?void 0:D.index)||0)+1,z=C[N];if(z)return{data:{index:N,overflows:M},reset:{placement:z}};let O=(k=M.filter(K=>K.overflows[0]<=0).sort((K,V)=>K.overflows[1]-V.overflows[1])[0])==null?void 0:k.placement;if(!O)switch(h){case"bestFit":{var L;const K=(L=M.filter(V=>{if(S){const ne=vf(V.placement);return ne===x||ne==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(ne=>ne>0).reduce((ne,re)=>ne+re,0)]).sort((V,ne)=>V[1]-ne[1])[0])==null?void 0:L[0];K&&(O=K);break}case"initialPlacement":O=a;break}if(i!==O)return{reset:{placement:O}}}return{}}}};function _D(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function bD(t){return P1e.some(e=>t[e]>=0)}const G1e=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=au(t,e);switch(r){case"referenceHidden":{const s=await K1(e,{...i,elementContext:"reference"}),o=_D(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:bD(o)}}}case"escaped":{const s=await K1(e,{...i,altBoundary:!0}),o=_D(s,n.floating);return{data:{escapedOffsets:o,escaped:bD(o)}}}default:return{}}}}};async function j1e(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=lu(n),a=Km(n),l=vf(n)==="y",c=["left","top"].includes(o)?-1:1,u=s&&l?-1:1,f=au(e,t);let{mainAxis:d,crossAxis:h,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:d*c}:{x:d*c,y:h*u}}const V1e=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:o,middlewareData:a}=e,l=await j1e(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:o}}}}},W1e=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:y,y:x}=g;return{x:y,y:x}}},...l}=au(t,e),c={x:n,y:r},u=await K1(e,l),f=vf(lu(i)),d=VC(f);let h=c[d],p=c[f];if(s){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",x=h+u[g],_=h-u[y];h=F5(x,h,_)}if(o){const g=f==="y"?"top":"left",y=f==="y"?"bottom":"right",x=p+u[g],_=p-u[y];p=F5(x,p,_)}const m=a.fn({...e,[d]:h,[f]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[d]:s,[f]:o}}}}}},$1e=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=au(t,e),u={x:n,y:r},f=vf(i),d=VC(f);let h=u[d],p=u[f];const m=au(a,e),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const _=d==="y"?"height":"width",w=s.reference[d]-s.floating[_]+g.mainAxis,T=s.reference[d]+s.reference[_]-g.mainAxis;h<w?h=w:h>T&&(h=T)}if(c){var y,x;const _=d==="y"?"width":"height",w=["top","left"].includes(lu(i)),T=s.reference[f]-s.floating[_]+(w&&((y=o.offset)==null?void 0:y[f])||0)+(w?0:g.crossAxis),S=s.reference[f]+s.reference[_]+(w?0:((x=o.offset)==null?void 0:x[f])||0)-(w?g.crossAxis:0);p<T?p=T:p>S&&(p=S)}return{[d]:h,[f]:p}}}},X1e=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...c}=au(t,e),u=await K1(e,c),f=lu(i),d=Km(i),h=vf(i)==="y",{width:p,height:m}=s.floating;let g,y;f==="top"||f==="bottom"?(g=f,y=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=f,g=d==="end"?"top":"bottom");const x=m-u.top-u.bottom,_=p-u.left-u.right,w=yf(m-u[g],x),T=yf(p-u[y],_),S=!e.middlewareData.shift;let C=w,A=T;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(A=_),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(C=x),S&&!d){const M=ca(u.left,0),D=ca(u.right,0),k=ca(u.top,0),L=ca(u.bottom,0);h?A=p-2*(M!==0||D!==0?M+D:ca(u.left,u.right)):C=m-2*(k!==0||L!==0?k+L:ca(u.top,u.bottom))}await l({...e,availableWidth:A,availableHeight:C});const R=await o.getDimensions(a.floating);return p!==R.width||m!==R.height?{reset:{rects:!0}}:{}}}};function uE(){return typeof window<"u"}function Zm(t){return uW(t)?(t.nodeName||"").toLowerCase():"#document"}function pa(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function dc(t){var e;return(e=(uW(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function uW(t){return uE()?t instanceof Node||t instanceof pa(t).Node:!1}function _l(t){return uE()?t instanceof Element||t instanceof pa(t).Element:!1}function ac(t){return uE()?t instanceof HTMLElement||t instanceof pa(t).HTMLElement:!1}function ED(t){return!uE()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof pa(t).ShadowRoot}function Py(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=bl(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function q1e(t){return["table","td","th"].includes(Zm(t))}function fE(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function XC(t){const e=qC(),n=_l(t)?bl(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Y1e(t){let e=xf(t);for(;ac(e)&&!bm(e);){if(XC(e))return e;if(fE(e))return null;e=xf(e)}return null}function qC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function bm(t){return["html","body","#document"].includes(Zm(t))}function bl(t){return pa(t).getComputedStyle(t)}function dE(t){return _l(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function xf(t){if(Zm(t)==="html")return t;const e=t.assignedSlot||t.parentNode||ED(t)&&t.host||dc(t);return ED(e)?e.host:e}function fW(t){const e=xf(t);return bm(e)?t.ownerDocument?t.ownerDocument.body:t.body:ac(e)&&Py(e)?e:fW(e)}function Z1(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=fW(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),o=pa(i);if(s){const a=B5(o);return e.concat(o,o.visualViewport||[],Py(i)?i:[],a&&n?Z1(a):[])}return e.concat(i,Z1(i,[],n))}function B5(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function dW(t){const e=bl(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=ac(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=v_(n)!==s||v_(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function YC(t){return _l(t)?t:t.contextElement}function cm(t){const e=YC(t);if(!ac(e))return nc(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=dW(e);let o=(s?v_(n.width):n.width)/r,a=(s?v_(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const K1e=nc(0);function hW(t){const e=pa(t);return!qC()||!e.visualViewport?K1e:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Z1e(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==pa(t)?!1:e}function Xd(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=YC(t);let o=nc(1);e&&(r?_l(r)&&(o=cm(r)):o=cm(t));const a=Z1e(s,n,r)?hW(s):nc(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,u=i.width/o.x,f=i.height/o.y;if(s){const d=pa(s),h=r&&_l(r)?pa(r):r;let p=d,m=B5(p);for(;m&&r&&h!==p;){const g=cm(m),y=m.getBoundingClientRect(),x=bl(m),_=y.left+(m.clientLeft+parseFloat(x.paddingLeft))*g.x,w=y.top+(m.clientTop+parseFloat(x.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,f*=g.y,l+=_,c+=w,p=pa(m),m=B5(p)}}return __({width:u,height:f,x:l,y:c})}function KC(t,e){const n=dE(t).scrollLeft;return e?e.left+n:Xd(dc(t)).left+n}function pW(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:KC(t,r)),s=r.top+e.scrollTop;return{x:i,y:s}}function Q1e(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const s=i==="fixed",o=dc(r),a=e?fE(e.floating):!1;if(r===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=nc(1);const u=nc(0),f=ac(r);if((f||!f&&!s)&&((Zm(r)!=="body"||Py(o))&&(l=dE(r)),ac(r))){const h=Xd(r);c=cm(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}const d=o&&!f&&!s?pW(o,l,!0):nc(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:n.y*c.y-l.scrollTop*c.y+u.y+d.y}}function J1e(t){return Array.from(t.getClientRects())}function eye(t){const e=dc(t),n=dE(t),r=t.ownerDocument.body,i=ca(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=ca(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+KC(t);const a=-n.scrollTop;return bl(r).direction==="rtl"&&(o+=ca(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function tye(t,e){const n=pa(t),r=dc(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const c=qC();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}function nye(t,e){const n=Xd(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=ac(t)?cm(t):nc(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=i*s.x,c=r*s.y;return{width:o,height:a,x:l,y:c}}function wD(t,e,n){let r;if(e==="viewport")r=tye(t,n);else if(e==="document")r=eye(dc(t));else if(_l(e))r=nye(e,n);else{const i=hW(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return __(r)}function mW(t,e){const n=xf(t);return n===e||!_l(n)||bm(n)?!1:bl(n).position==="fixed"||mW(n,e)}function rye(t,e){const n=e.get(t);if(n)return n;let r=Z1(t,[],!1).filter(a=>_l(a)&&Zm(a)!=="body"),i=null;const s=bl(t).position==="fixed";let o=s?xf(t):t;for(;_l(o)&&!bm(o);){const a=bl(o),l=XC(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Py(o)&&!l&&mW(t,o))?r=r.filter(u=>u!==o):i=a,o=xf(o)}return e.set(t,r),r}function iye(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const o=[...n==="clippingAncestors"?fE(e)?[]:rye(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,u)=>{const f=wD(e,u,i);return c.top=ca(f.top,c.top),c.right=yf(f.right,c.right),c.bottom=yf(f.bottom,c.bottom),c.left=ca(f.left,c.left),c},wD(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function sye(t){const{width:e,height:n}=dW(t);return{width:e,height:n}}function oye(t,e,n){const r=ac(e),i=dc(e),s=n==="fixed",o=Xd(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=nc(0);if(r||!r&&!s)if((Zm(e)!=="body"||Py(i))&&(a=dE(e)),r){const d=Xd(e,!0,s,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else i&&(l.x=KC(i));const c=i&&!r&&!s?pW(i,a):nc(0),u=o.left+a.scrollLeft-l.x-c.x,f=o.top+a.scrollTop-l.y-c.y;return{x:u,y:f,width:o.width,height:o.height}}function vT(t){return bl(t).position==="static"}function SD(t,e){if(!ac(t)||bl(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return dc(t)===n&&(n=n.ownerDocument.body),n}function gW(t,e){const n=pa(t);if(fE(t))return n;if(!ac(t)){let i=xf(t);for(;i&&!bm(i);){if(_l(i)&&!vT(i))return i;i=xf(i)}return n}let r=SD(t,e);for(;r&&q1e(r)&&vT(r);)r=SD(r,e);return r&&bm(r)&&vT(r)&&!XC(r)?n:r||Y1e(t)||n}const aye=async function(t){const e=this.getOffsetParent||gW,n=this.getDimensions,r=await n(t.floating);return{reference:oye(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function lye(t){return bl(t).direction==="rtl"}const cye={convertOffsetParentRelativeRectToViewportRelativeRect:Q1e,getDocumentElement:dc,getClippingRect:iye,getOffsetParent:gW,getElementRects:aye,getClientRects:J1e,getDimensions:sye,getScale:cm,isElement:_l,isRTL:lye};function uye(t,e){let n=null,r;const i=dc(t);function s(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:c,top:u,width:f,height:d}=t.getBoundingClientRect();if(a||e(),!f||!d)return;const h=Ex(u),p=Ex(i.clientWidth-(c+f)),m=Ex(i.clientHeight-(u+d)),g=Ex(c),x={rootMargin:-h+"px "+-p+"px "+-m+"px "+-g+"px",threshold:ca(0,yf(1,l))||1};let _=!0;function w(T){const S=T[0].intersectionRatio;if(S!==l){if(!_)return o();S?o(!1,S):r=setTimeout(()=>{o(!1,1e-7)},1e3)}_=!1}try{n=new IntersectionObserver(w,{...x,root:i.ownerDocument})}catch{n=new IntersectionObserver(w,x)}n.observe(t)}return o(!0),s}function fye(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=YC(t),u=i||s?[...c?Z1(c):[],...Z1(e)]:[];u.forEach(y=>{i&&y.addEventListener("scroll",n,{passive:!0}),s&&y.addEventListener("resize",n)});const f=c&&a?uye(c,n):null;let d=-1,h=null;o&&(h=new ResizeObserver(y=>{let[x]=y;x&&x.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var _;(_=h)==null||_.observe(e)})),n()}),c&&!l&&h.observe(c),h.observe(e));let p,m=l?Xd(t):null;l&&g();function g(){const y=Xd(t);m&&(y.x!==m.x||y.y!==m.y||y.width!==m.width||y.height!==m.height)&&n(),m=y,p=requestAnimationFrame(g)}return n(),()=>{var y;u.forEach(x=>{i&&x.removeEventListener("scroll",n),s&&x.removeEventListener("resize",n)}),f==null||f(),(y=h)==null||y.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const dye=V1e,hye=W1e,pye=H1e,mye=X1e,gye=G1e,TD=z1e,yye=$1e,vye=(t,e,n)=>{const r=new Map,i={platform:cye,...n},s={...i.platform,_c:r};return B1e(t,e,{...i,platform:s})};var x3=typeof document<"u"?v.useLayoutEffect:v.useEffect;function b_(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!b_(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&t.$$typeof)&&!b_(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function yW(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function AD(t,e){const n=yW(t);return Math.round(e*n)/n}function xT(t){const e=v.useRef(t);return x3(()=>{e.current=t}),e}function xye(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,f]=v.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[d,h]=v.useState(r);b_(d,r)||h(r);const[p,m]=v.useState(null),[g,y]=v.useState(null),x=v.useCallback(V=>{V!==S.current&&(S.current=V,m(V))},[]),_=v.useCallback(V=>{V!==C.current&&(C.current=V,y(V))},[]),w=s||p,T=o||g,S=v.useRef(null),C=v.useRef(null),A=v.useRef(u),R=l!=null,M=xT(l),D=xT(i),k=xT(c),L=v.useCallback(()=>{if(!S.current||!C.current)return;const V={placement:e,strategy:n,middleware:d};D.current&&(V.platform=D.current),vye(S.current,C.current,V).then(ne=>{const re={...ne,isPositioned:k.current!==!1};N.current&&!b_(A.current,re)&&(A.current=re,r6.flushSync(()=>{f(re)}))})},[d,e,n,D,k]);x3(()=>{c===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,f(V=>({...V,isPositioned:!1})))},[c]);const N=v.useRef(!1);x3(()=>(N.current=!0,()=>{N.current=!1}),[]),x3(()=>{if(w&&(S.current=w),T&&(C.current=T),w&&T){if(M.current)return M.current(w,T,L);L()}},[w,T,L,M,R]);const z=v.useMemo(()=>({reference:S,floating:C,setReference:x,setFloating:_}),[x,_]),O=v.useMemo(()=>({reference:w,floating:T}),[w,T]),K=v.useMemo(()=>{const V={position:n,left:0,top:0};if(!O.floating)return V;const ne=AD(O.floating,u.x),re=AD(O.floating,u.y);return a?{...V,transform:"translate("+ne+"px, "+re+"px)",...yW(O.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ne,top:re}},[n,a,O.floating,u.x,u.y]);return v.useMemo(()=>({...u,update:L,refs:z,elements:O,floatingStyles:K}),[u,L,z,O,K])}const _ye=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?TD({element:r.current,padding:i}).fn(n):{}:r?TD({element:r,padding:i}).fn(n):{}}}},bye=(t,e)=>({...dye(t),options:[t,e]}),Eye=(t,e)=>({...hye(t),options:[t,e]}),wye=(t,e)=>({...yye(t),options:[t,e]}),Sye=(t,e)=>({...pye(t),options:[t,e]}),Tye=(t,e)=>({...mye(t),options:[t,e]}),Aye=(t,e)=>({...gye(t),options:[t,e]}),Mye=(t,e)=>({..._ye(t),options:[t,e]});var Cye="Arrow",vW=v.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...s}=t;return H.jsx(hh.svg,{...s,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:H.jsx("polygon",{points:"0,0 30,0 15,10"})})});vW.displayName=Cye;var Rye=vW;function Iye(t){const[e,n]=v.useState(void 0);return _m(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var ZC="Popper",[xW,_W]=rW(ZC),[Pye,bW]=xW(ZC),EW=t=>{const{__scopePopper:e,children:n}=t,[r,i]=v.useState(null);return H.jsx(Pye,{scope:e,anchor:r,onAnchorChange:i,children:n})};EW.displayName=ZC;var wW="PopperAnchor",SW=v.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,s=bW(wW,n),o=v.useRef(null),a=dh(e,o);return v.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:H.jsx(hh.div,{...i,ref:a})});SW.displayName=wW;var QC="PopperContent",[kye,Lye]=xW(QC),TW=v.forwardRef((t,e)=>{var J,oe,Ee,me,Te,_e;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:d=!1,updatePositionStrategy:h="optimized",onPlaced:p,...m}=t,g=bW(QC,n),[y,x]=v.useState(null),_=dh(e,Re=>x(Re)),[w,T]=v.useState(null),S=Iye(w),C=(S==null?void 0:S.width)??0,A=(S==null?void 0:S.height)??0,R=r+(s!=="center"?"-"+s:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},D=Array.isArray(c)?c:[c],k=D.length>0,L={padding:M,boundary:D.filter(Nye),altBoundary:k},{refs:N,floatingStyles:z,placement:O,isPositioned:K,middlewareData:V}=xye({strategy:"fixed",placement:R,whileElementsMounted:(...Re)=>fye(...Re,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[bye({mainAxis:i+A,alignmentAxis:o}),l&&Eye({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?wye():void 0,...L}),l&&Sye({...L}),Tye({...L,apply:({elements:Re,rects:ae,availableWidth:Ce,availableHeight:Pe})=>{const{width:Ve,height:ye}=ae.reference,ge=Re.floating.style;ge.setProperty("--radix-popper-available-width",`${Ce}px`),ge.setProperty("--radix-popper-available-height",`${Pe}px`),ge.setProperty("--radix-popper-anchor-width",`${Ve}px`),ge.setProperty("--radix-popper-anchor-height",`${ye}px`)}}),w&&Mye({element:w,padding:a}),Oye({arrowWidth:C,arrowHeight:A}),d&&Aye({strategy:"referenceHidden",...L})]}),[ne,re]=CW(O),P=Ym(p);_m(()=>{K&&(P==null||P())},[K,P]);const se=(J=V.arrow)==null?void 0:J.x,ue=(oe=V.arrow)==null?void 0:oe.y,te=((Ee=V.arrow)==null?void 0:Ee.centerOffset)!==0,[W,X]=v.useState();return _m(()=>{y&&X(window.getComputedStyle(y).zIndex)},[y]),H.jsx("div",{ref:N.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:K?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:W,"--radix-popper-transform-origin":[(me=V.transformOrigin)==null?void 0:me.x,(Te=V.transformOrigin)==null?void 0:Te.y].join(" "),...((_e=V.hide)==null?void 0:_e.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:H.jsx(kye,{scope:n,placedSide:ne,onArrowChange:T,arrowX:se,arrowY:ue,shouldHideArrow:te,children:H.jsx(hh.div,{"data-side":ne,"data-align":re,...m,ref:_,style:{...m.style,animation:K?void 0:"none"}})})})});TW.displayName=QC;var AW="PopperArrow",Dye={top:"bottom",right:"left",bottom:"top",left:"right"},MW=v.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,s=Lye(AW,r),o=Dye[s.placedSide];return H.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:H.jsx(Rye,{...i,ref:n,style:{...i.style,display:"block"}})})});MW.displayName=AW;function Nye(t){return t!==null}var Oye=t=>({name:"transformOrigin",options:t,fn(e){var g,y,x;const{placement:n,rects:r,middlewareData:i}=e,o=((g=i.arrow)==null?void 0:g.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=CW(n),f={start:"0%",center:"50%",end:"100%"}[u],d=(((y=i.arrow)==null?void 0:y.x)??0)+a/2,h=(((x=i.arrow)==null?void 0:x.y)??0)+l/2;let p="",m="";return c==="bottom"?(p=o?f:`${d}px`,m=`${-l}px`):c==="top"?(p=o?f:`${d}px`,m=`${r.floating.height+l}px`):c==="right"?(p=`${-l}px`,m=o?f:`${h}px`):c==="left"&&(p=`${r.floating.width+l}px`,m=o?f:`${h}px`),{data:{x:p,y:m}}}});function CW(t){const[e,n="center"]=t.split("-");return[e,n]}var Fye=EW,Uye=SW,Bye=TW,zye=MW;function Hye(t,e){return v.useReducer((n,r)=>e[n][r]??n,t)}var RW=t=>{const{present:e,children:n}=t,r=Gye(e),i=typeof n=="function"?n({present:r.isPresent}):v.Children.only(n),s=dh(r.ref,jye(i));return typeof n=="function"||r.isPresent?v.cloneElement(i,{ref:s}):null};RW.displayName="Presence";function Gye(t){const[e,n]=v.useState(),r=v.useRef({}),i=v.useRef(t),s=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=Hye(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const c=wx(r.current);s.current=a==="mounted"?c:"none"},[a]),_m(()=>{const c=r.current,u=i.current;if(u!==t){const d=s.current,h=wx(c);t?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&d!==h?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),_m(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,f=h=>{const m=wx(r.current).includes(h.animationName);if(h.target===e&&m&&(l("ANIMATION_END"),!i.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},d=h=>{h.target===e&&(s.current=wx(r.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function wx(t){return(t==null?void 0:t.animationName)||"none"}function jye(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Vye({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=Wye({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:r,a=Ym(n),l=v.useCallback(c=>{if(s){const f=typeof c=="function"?c(t):c;f!==t&&a(f)}else i(c)},[s,t,i,a]);return[o,l]}function Wye({defaultProp:t,onChange:e}){const n=v.useState(t),[r]=n,i=v.useRef(r),s=Ym(e);return v.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),n}var $ye="VisuallyHidden",IW=v.forwardRef((t,e)=>H.jsx(hh.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));IW.displayName=$ye;var Xye=IW,[hE,$$e]=rW("Tooltip",[_W]),pE=_W(),qye="TooltipProvider",z5="tooltip.open",[X$e,JC]=hE(qye),mE="Tooltip",[Yye,gE]=hE(mE),PW=t=>{const{__scopeTooltip:e,children:n,open:r,defaultOpen:i=!1,onOpenChange:s,disableHoverableContent:o,delayDuration:a}=t,l=JC(mE,t.__scopeTooltip),c=pE(e),[u,f]=v.useState(null),d=I1e(),h=v.useRef(0),p=o??l.disableHoverableContent,m=a??l.delayDuration,g=v.useRef(!1),[y=!1,x]=Vye({prop:r,defaultProp:i,onChange:C=>{C?(l.onOpen(),document.dispatchEvent(new CustomEvent(z5))):l.onClose(),s==null||s(C)}}),_=v.useMemo(()=>y?g.current?"delayed-open":"instant-open":"closed",[y]),w=v.useCallback(()=>{window.clearTimeout(h.current),h.current=0,g.current=!1,x(!0)},[x]),T=v.useCallback(()=>{window.clearTimeout(h.current),h.current=0,x(!1)},[x]),S=v.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{g.current=!0,x(!0),h.current=0},m)},[m,x]);return v.useEffect(()=>()=>{h.current&&(window.clearTimeout(h.current),h.current=0)},[]),H.jsx(Fye,{...c,children:H.jsx(Yye,{scope:e,contentId:d,open:y,stateAttribute:_,trigger:u,onTriggerChange:f,onTriggerEnter:v.useCallback(()=>{l.isOpenDelayed?S():w()},[l.isOpenDelayed,S,w]),onTriggerLeave:v.useCallback(()=>{p?T():(window.clearTimeout(h.current),h.current=0)},[T,p]),onOpen:w,onClose:T,disableHoverableContent:p,children:n})})};PW.displayName=mE;var H5="TooltipTrigger",kW=v.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=gE(H5,n),s=JC(H5,n),o=pE(n),a=v.useRef(null),l=dh(e,a,i.onTriggerChange),c=v.useRef(!1),u=v.useRef(!1),f=v.useCallback(()=>c.current=!1,[]);return v.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),H.jsx(Uye,{asChild:!0,...o,children:H.jsx(hh.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:l,onPointerMove:Bc(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:Bc(t.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:Bc(t.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Bc(t.onFocus,()=>{c.current||i.onOpen()}),onBlur:Bc(t.onBlur,i.onClose),onClick:Bc(t.onClick,i.onClose)})})});kW.displayName=H5;var Kye="TooltipPortal",[q$e,Zye]=hE(Kye,{forceMount:void 0}),Em="TooltipContent",LW=v.forwardRef((t,e)=>{const n=Zye(Em,t.__scopeTooltip),{forceMount:r=n.forceMount,side:i="top",...s}=t,o=gE(Em,t.__scopeTooltip);return H.jsx(RW,{present:r||o.open,children:o.disableHoverableContent?H.jsx(DW,{side:i,...s,ref:e}):H.jsx(Qye,{side:i,...s,ref:e})})}),Qye=v.forwardRef((t,e)=>{const n=gE(Em,t.__scopeTooltip),r=JC(Em,t.__scopeTooltip),i=v.useRef(null),s=dh(e,i),[o,a]=v.useState(null),{trigger:l,onClose:c}=n,u=i.current,{onPointerInTransitChange:f}=r,d=v.useCallback(()=>{a(null),f(!1)},[f]),h=v.useCallback((p,m)=>{const g=p.currentTarget,y={x:p.clientX,y:p.clientY},x=tve(y,g.getBoundingClientRect()),_=nve(y,x),w=rve(m.getBoundingClientRect()),T=sve([..._,...w]);a(T),f(!0)},[f]);return v.useEffect(()=>()=>d(),[d]),v.useEffect(()=>{if(l&&u){const p=g=>h(g,u),m=g=>h(g,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",m)}}},[l,u,h,d]),v.useEffect(()=>{if(o){const p=m=>{const g=m.target,y={x:m.clientX,y:m.clientY},x=(l==null?void 0:l.contains(g))||(u==null?void 0:u.contains(g)),_=!ive(y,o);x?d():_&&(d(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,o,c,d]),H.jsx(DW,{...t,ref:s})}),[Jye,eve]=hE(mE,{isInside:!1}),DW=v.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:o,...a}=t,l=gE(Em,n),c=pE(n),{onClose:u}=l;return v.useEffect(()=>(document.addEventListener(z5,u),()=>document.removeEventListener(z5,u)),[u]),v.useEffect(()=>{if(l.trigger){const f=d=>{const h=d.target;h!=null&&h.contains(l.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,u]),H.jsx(aW,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:u,children:H.jsxs(Bye,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[H.jsx(sW,{children:r}),H.jsx(Jye,{scope:n,isInside:!0,children:H.jsx(Xye,{id:l.contentId,role:"tooltip",children:i||r})})]})})});LW.displayName=Em;var NW="TooltipArrow",OW=v.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=pE(n);return eve(NW,n).isInside?null:H.jsx(zye,{...i,...r,ref:e})});OW.displayName=NW;function tve(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),i=Math.abs(e.right-t.x),s=Math.abs(e.left-t.x);switch(Math.min(n,r,i,s)){case s:return"left";case i:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function nve(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function rve(t){const{top:e,right:n,bottom:r,left:i}=t;return[{x:i,y:e},{x:n,y:e},{x:n,y:r},{x:i,y:r}]}function ive(t,e){const{x:n,y:r}=t;let i=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,c=e[o].x,u=e[o].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function sve(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),ove(e)}function ove(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const i=t[r];for(;e.length>=2;){const s=e[e.length-1],o=e[e.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))e.pop();else break}e.push(i)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const i=t[r];for(;n.length>=2;){const s=n[n.length-1],o=n[n.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))n.pop();else break}n.push(i)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var ave=PW,lve=kW,cve=LW,uve=OW;function fve(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function $r(t,e){if(t==null)return{};var n=fve(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}let _i;(function(t){t[t.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",t[t.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",t[t.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",t[t.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",t[t.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",t[t.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",t[t.THEME_ERROR=6]="THEME_ERROR",t[t.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",t[t.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",t[t.EMPTY_KEY=9]="EMPTY_KEY"})(_i||(_i={}));const dve={[_i.UNSUPPORTED_INPUT]:(t,e)=>[`An input with type \`${t}\` input was found at path \`${e}\` but it's not supported yet.`],[_i.NO_COMPONENT_FOR_TYPE]:(t,e)=>[`Type \`${t}\` found at path \`${e}\` can't be displayed in panel because no component supports it yet.`],[_i.UNKNOWN_INPUT]:(t,e)=>[`input at path \`${t}\` is not recognized.`,e],[_i.DUPLICATE_KEYS]:(t,e,n)=>[`Key \`${t}\` of path \`${e}\` already exists at path \`${n}\`. Even nested keys need to be unique. Rename one of the keys.`],[_i.ALREADY_REGISTERED_TYPE]:t=>[`Type ${t} has already been registered. You can't register a component with the same type.`],[_i.CLIPBOARD_ERROR]:t=>["Error copying the value",t],[_i.THEME_ERROR]:(t,e)=>[`Error accessing the theme \`${t}.${e}\` value.`],[_i.PATH_DOESNT_EXIST]:t=>[`Error getting the value at path \`${t}\`. There is probably an error in your \`render\` function.`],[_i.PATH_DOESNT_EXIST]:t=>[`Error accessing the value at path \`${t}\``],[_i.INPUT_TYPE_OVERRIDE]:(t,e,n)=>[`Input at path \`${t}\` already exists with type: \`${e}\`. Its type cannot be overridden with type \`${n}\`.`],[_i.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function FW(t,e,...n){const[r,...i]=dve[e](...n);console[t]("LEVA: "+r,...i)}const jc=FW.bind(null,"warn"),hve=FW.bind(null,"log"),pve=["value"],mve=["schema"],gve=["value"],UW=[],qd={};function MD(t){let{value:e}=t,n=$r(t,pve);for(let r of UW){const i=r(e,n);if(i)return i}}function pu(t,e){let{schema:n}=e,r=$r(e,mve);if(t in qd){jc(_i.ALREADY_REGISTERED_TYPE,t);return}UW.push((i,s)=>n(i,s)&&t),qd[t]=r}function _T(t,e,n,r){const{normalize:i}=qd[t];if(i)return i(e,n,r);if(typeof e!="object"||!("value"in e))return{value:e};const{value:s}=e,o=$r(e,gve);return{value:s,settings:o}}function yve(t,e,n,r,i,s){const{sanitize:o}=qd[t];return o?o(e,n,r,i,s):e}function CD(t,e,n){const{format:r}=qd[t];return r?r(e,n):e}function vve(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Dn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RD(Object(n),!0).forEach(function(r){vve(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const _f=(t,e,n)=>t>n?n:t<e?e:t,xve=t=>{if(t===""||typeof t=="number")return t;try{const e=ju(t);if(!isNaN(e))return e}catch{}return parseFloat(t)},_ve=Math.log(10);function ID(t){let e=Math.abs(+String(t).replace(".",""));if(e===0)return .01;for(;e!==0&&e%10===0;)e/=10;const n=Math.floor(Math.log(e)/_ve)+1,r=Math.floor(Math.log10(Math.abs(t))),i=Math.pow(10,r-n);return Math.max(i,.001)}const E_=(t,e,n)=>n===e?0:(_f(t,e,n)-e)/(n-e),w_=(t,e,n)=>t*(n-e)+e,bve=()=>"_"+Math.random().toString(36).substr(2,9),PD=/\(([0-9+\-*/^ .]+)\)/,kD=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,LD=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,DD=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,ND=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,OD=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function ju(t){if(isNaN(Number(t)))if(PD.test(t)){const e=t.replace(PD,(n,r)=>String(ju(r)));return ju(e)}else if(kD.test(t)){const e=t.replace(kD,(n,r,i)=>String(Math.pow(Number(r),Number(i))));return ju(e)}else if(LD.test(t)){const e=t.replace(LD,(n,r,i)=>String(Number(r)*Number(i)));return ju(e)}else if(DD.test(t)){const e=t.replace(DD,(n,r,i)=>{if(i!=0)return String(Number(r)/Number(i));throw new Error("Division by zero")});return ju(e)}else if(ND.test(t)){const e=t.replace(ND,(n,r,i)=>String(Number(r)+Number(i)));return ju(e)}else if(OD.test(t)){const e=t.replace(OD,(n,r,i)=>String(Number(r)-Number(i)));return ju(e)}else return Number(t);return Number(t)}function Eve(t,e){return e.reduce((n,r)=>(t&&t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}function wve(t,e){const n=Dn({},t);return e.forEach(r=>r in t&&delete n[r]),n}function Sve(t,e){return t.reduce((n,r,i)=>Object.assign(n,{[e[i]]:r}),{})}function BW(t){return Object.prototype.toString.call(t)==="[object Object]"}const Tve=t=>BW(t)&&Object.keys(t).length===0;let ma;(function(t){t.BUTTON="BUTTON",t.BUTTON_GROUP="BUTTON_GROUP",t.MONITOR="MONITOR",t.FOLDER="FOLDER"})(ma||(ma={}));let El;(function(t){t.SELECT="SELECT",t.IMAGE="IMAGE",t.NUMBER="NUMBER",t.COLOR="COLOR",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.INTERVAL="INTERVAL",t.VECTOR3D="VECTOR3D",t.VECTOR2D="VECTOR2D"})(El||(El={}));const Ave=["type","__customInput"],Mve=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],Cve=["type"];function zW(t,e,n={},r){var i,s;if(typeof t!="object"||Array.isArray(t))return{type:r,input:t,options:Dn({key:e,label:e,optional:!1,disabled:!1,order:0},n)};if("__customInput"in t){const{type:T,__customInput:S}=t,C=$r(t,Ave);return zW(S,e,C,T)}const{render:o,label:a,optional:l,order:c=0,disabled:u,hint:f,onChange:d,onEditStart:h,onEditEnd:p,transient:m}=t,g=$r(t,Mve),y=Dn({render:o,key:e,label:a??e,hint:f,transient:m??!!d,onEditStart:h,onEditEnd:p,disabled:u,optional:l,order:c},n);let{type:x}=g,_=$r(g,Cve);if(x=r??x,x in ma)return{type:x,input:_,options:y};let w;return r&&BW(_)&&"value"in _?w=_.value:w=Tve(_)?void 0:_,{type:x,input:w,options:Dn(Dn({},y),{},{onChange:d,optional:(i=y.optional)!==null&&i!==void 0?i:!1,disabled:(s=y.disabled)!==null&&s!==void 0?s:!1})}}function Rve(t,e,n,r){const i=zW(t,e),{type:s,input:o,options:a}=i;if(s)return s in ma?i:{type:s,input:_T(s,o,n,r),options:a};let l=MD(o);return l?{type:l,input:_T(l,o,n,r),options:a}:(l=MD({value:o}),l?{type:l,input:_T(l,{value:o},n,r),options:a}:!1)}function FD(t,e,n,r,i){const{value:s,type:o,settings:a}=t;t.value=HW({type:o,value:s,settings:a},e,n,r),t.fromPanel=i}const Ive=function(e,n,r){this.type="LEVA_ERROR",this.message="LEVA: "+e,this.previousValue=n,this.error=r};function HW({type:t,value:e,settings:n},r,i,s){const o=t!=="SELECT"&&typeof r=="function"?r(e):r;let a;try{a=yve(t,o,n,e,i,s)}catch(l){throw new Ive(`The value \`${r}\` did not result in a correct value.`,e,l)}return q1(a,e)?e:a}const GW=(t,e,n=!1)=>{let r=0;return function(){const i=arguments,s=n&&!r,o=()=>t.apply(this,i);window.clearTimeout(r),r=window.setTimeout(o,e),s&&o()}},jW=t=>t.shiftKey?5:t.altKey?1/5:1;function Pve(t,e){const n=console.error;console.error=()=>{},WB.render(t,e),console.error=n}const kve=["value"],Lve=["min","max"],Dve=t=>{if(typeof t=="number")return!0;if(typeof t=="string"){const e=parseFloat(t);return isNaN(e)?!1:t.substring((""+e).length).trim().length<4}return!1},VW=(t,{min:e=-1/0,max:n=1/0,suffix:r})=>{const i=parseFloat(t);if(t===""||isNaN(i))throw Error("Invalid number");const s=_f(i,e,n);return r?s+r:s},Nve=(t,{pad:e=0,suffix:n})=>{const r=parseFloat(t).toFixed(e);return n?r+n:r},WW=t=>{let{value:e}=t,n=$r(t,kve);const{min:r=-1/0,max:i=1/0}=n,s=$r(n,Lve);let o=parseFloat(e);const a=typeof e=="string"?e.substring((""+o).length):void 0;o=_f(o,r,i);let l=n.step;l||(Number.isFinite(r)?Number.isFinite(i)?l=+(Math.abs(i-r)/100).toPrecision(1):l=+(Math.abs(o-r)/100).toPrecision(1):Number.isFinite(i)&&(l=+(Math.abs(i-o)/100).toPrecision(1)));const c=l?ID(l)*10:ID(o);l=l||c/10;const u=Math.round(_f(Math.log10(1/c),0,2));return{value:a?o+a:o,settings:Dn({initialValue:o,step:l,pad:u,min:r,max:i,suffix:a},s)}},$W=(t,{step:e,initialValue:n})=>{const r=Math.round((t-n)/e);return n+r*e};var XW=Object.freeze({__proto__:null,schema:Dve,sanitize:VW,format:Nve,normalize:WW,sanitizeStep:$W});function Ri(){return Ri=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ri.apply(this,arguments)}const qW=v.createContext({});function oo(){return v.useContext(qW)}const e8=v.createContext(null),YW=v.createContext(null),KW=v.createContext(null);function ky(){return v.useContext(YW)}function Ove(){return v.useContext(KW)}const ZW=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function Sx(t,e){const[n,r]=t.split(" "),i={};return n!=="none"&&(i.boxShadow=`${e.inset?"inset ":""}0 0 0 $borderWidths${[e.key]} $colors${n!=="default"&&n||e.borderColor}`),r&&(i.backgroundColor=r),i}const vg={$inputStyle:()=>t=>Sx(t,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>t=>Sx(t,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>t=>Sx(t,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>t=>Sx(t,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:kn,css:Y$e,createTheme:Fve,globalCss:Uve,keyframes:K$e}=h1e({prefix:"leva",theme:ZW(),utils:Dn(Dn({},vg),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:t=>({"&:focus":vg.$focusStyle()(t)}),$focusWithin:t=>({"&:focus-within":vg.$focusStyle()(t)}),$hover:t=>({"&:hover":vg.$hoverStyle()(t)}),$active:t=>({"&:active":vg.$activeStyle()(t)})})}),Bve=Uve({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function zve(t){const e=ZW();if(!t)return{theme:e,className:""};Object.keys(t).forEach(r=>{Object.assign(e[r],t[r])});const n=Fve(e);return{theme:e,className:n.className}}function Jc(t,e){const{theme:n}=v.useContext(e8);if(!(t in n)||!(e in n[t]))return jc(_i.THEME_ERROR,t,e),"";let r=e;for(;;){let i=n[t][r];if(typeof i=="string"&&i.charAt(0)==="$")r=i.substr(1);else return i}}const QW=kn("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),JW=kn("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${QW}`]:{paddingLeft:0}}),Hve=kn(JW,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),Gve=kn("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),jve=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],Vve=["onUpdate"];function t8(t){let{innerLabel:e,value:n,onUpdate:r,onChange:i,onKeyDown:s,type:o,id:a,inputType:l="text",rows:c=0}=t,u=$r(t,jve);const{id:f,emitOnEditStart:d,emitOnEditEnd:h,disabled:p}=oo(),m=a||f,g=v.useRef(null),y=c>0,x=y?"textarea":"input",_=v.useCallback(S=>C=>{const A=C.currentTarget.value;S(A)},[]);Ge.useEffect(()=>{const S=g.current,C=_(A=>{r(A),h()});return S==null||S.addEventListener("blur",C),()=>S==null?void 0:S.removeEventListener("blur",C)},[_,r,h]);const w=v.useCallback(S=>{S.key==="Enter"&&_(r)(S)},[_,r]),T=Object.assign({as:x},y?{rows:c}:{},u);return Ge.createElement(Gve,{textArea:y},e&&typeof e=="string"?Ge.createElement(JW,null,e):e,Ge.createElement(QW,Ri({levaType:o,ref:g,id:m,type:l,autoComplete:"off",spellCheck:"false",value:n,onChange:_(i),onFocus:()=>d(),onKeyPress:w,onKeyDown:s,disabled:p},T)))}function Wve(t){let{onUpdate:e}=t,n=$r(t,Vve);const r=v.useCallback(s=>e(xve(s)),[e]),i=v.useCallback(s=>{const o=s.key==="ArrowUp"?1:s.key==="ArrowDown"?-1:0;if(o){s.preventDefault();const a=s.altKey?.1:s.shiftKey?10:1;e(l=>parseFloat(l)+o*a)}},[e]);return Ge.createElement(t8,Ri({},n,{onUpdate:r,onKeyDown:i,type:"number"}))}const S_=kn("div",{}),G5=kn("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),$ve=kn("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${G5}::after`]:{opacity:.6},[`${S_}:hover > & + ${G5}::after`]:{opacity:.6},[`${S_}:hover > & > svg`]:{opacity:1}}),e$=kn("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${S_}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),t$=kn("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${e$} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),n$=kn(t$,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),Xve=kn("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),qve=kn("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),j5=kn("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),Yve=kn("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${j5}`]:{pointerEvents:"auto"}}}}}),r$=kn("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),Kve=kn("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),Zve=kn(uve,{fill:"$toolTipBackground"});function n8({children:t}){const{className:e}=v.useContext(e8);return Ge.createElement(Nge,{className:e},t)}const Qve=["align"];function Jve(){const{id:t,disable:e,disabled:n}=oo();return Ge.createElement(Ge.Fragment,null,Ge.createElement(qve,{id:t+"__disable",type:"checkbox",checked:!n,onChange:()=>e(!n)}),Ge.createElement("label",{htmlFor:t+"__disable"}))}function e2e(t){const{id:e,optional:n,hint:r}=oo(),i=t.htmlFor||(e?{htmlFor:e}:null),s=!r&&typeof t.children=="string"?{title:t.children}:null;return Ge.createElement(Ge.Fragment,null,n&&Ge.createElement(Jve,null),r!==void 0?Ge.createElement(ave,null,Ge.createElement(lve,{asChild:!0},Ge.createElement(j5,Ri({},i,t))),Ge.createElement(cve,{side:"top",sideOffset:2},Ge.createElement(Kve,null,r,Ge.createElement(Zve,null)))):Ge.createElement(j5,Ri({},i,s,t)))}function Cl(t){let{align:e}=t,n=$r(t,Qve);const{value:r,label:i,key:s,disabled:o}=oo(),{hideCopyButton:a}=Ove(),l=!a&&s!==void 0,[c,u]=v.useState(!1),f=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[s]:r??""})),u(!0)}catch{jc(_i.CLIPBOARD_ERROR,{[s]:r})}};return Ge.createElement(Xve,{align:e,onPointerLeave:()=>u(!1)},Ge.createElement(e2e,n),l&&!o&&Ge.createElement("div",{title:`Click to copy ${typeof i=="string"?i:s} value`},c?Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},Ge.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),Ge.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):Ge.createElement("svg",{onClick:f,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},Ge.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),Ge.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const t2e=["toggled"],n2e=kn("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function r8(t){let{toggled:e}=t,n=$r(t,t2e);return Ge.createElement(n2e,Ri({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${e?0:-90}deg)`}},n),Ge.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const r2e=["input"];function tl(t){let{input:e}=t,n=$r(t,r2e);return e?Ge.createElement(n$,n):Ge.createElement(t$,n)}function i$({value:t,type:e,settings:n,setValue:r}){const[i,s]=v.useState(CD(e,t,n)),o=v.useRef(t),a=v.useRef(n);a.current=n;const l=v.useCallback(u=>s(CD(e,u,a.current)),[e]),c=v.useCallback(u=>{try{r(u)}catch(f){const{type:d,previousValue:h}=f;if(d!=="LEVA_ERROR")throw f;l(h)}},[l,r]);return v.useEffect(()=>{q1(t,o.current)||l(t),o.current=t},[t,l]),{displayValue:i,onChange:s,onUpdate:c}}function Ly(t,e){const{emitOnEditStart:n,emitOnEditEnd:r}=oo();return gue(i=>{i.first&&(document.body.classList.add("leva__panel__dragged"),n==null||n());const s=t(i);return i.last&&(document.body.classList.remove("leva__panel__dragged"),r==null||r()),s},e)}function i2e(t){const e=v.useRef(null),n=v.useRef(null),r=v.useRef(!1);return v.useEffect(()=>{const i=GW(()=>{e.current.width=e.current.offsetWidth*window.devicePixelRatio,e.current.height=e.current.offsetHeight*window.devicePixelRatio,t(e.current,n.current)},250);return window.addEventListener("resize",i),r.current||(i(),r.current=!0),()=>window.removeEventListener("resize",i)},[t]),v.useEffect(()=>{n.current=e.current.getContext("2d")},[]),[e,n]}function s$(){const t=v.useRef(null),e=v.useRef({x:0,y:0}),n=v.useCallback(r=>{Object.assign(e.current,r),t.current&&(t.current.style.transform=`translate3d(${e.current.x}px, ${e.current.y}px, 0)`)},[]);return[t,n]}const s2e=["__refCount"],bT=(t,e)=>{if(!t[e])return null;const n=t[e];return $r(n,s2e)};function o2e(t){const e=ky(),[n,r]=v.useState(bT(e.getData(),t)),i=v.useCallback(c=>e.setValueAtPath(t,c,!0),[t,e]),s=v.useCallback(c=>e.setSettingsAtPath(t,c),[t,e]),o=v.useCallback(c=>e.disableInputAtPath(t,c),[t,e]),a=v.useCallback(()=>e.emitOnEditStart(t),[t,e]),l=v.useCallback(()=>e.emitOnEditEnd(t),[t,e]);return v.useEffect(()=>{r(bT(e.getData(),t));const c=e.useStore.subscribe(u=>bT(u.data,t),r,{equalityFn:lE});return()=>c()},[e,t]),[n,{set:i,setSettings:s,disable:o,storeId:e.storeId,emitOnEditStart:a,emitOnEditEnd:l}]}const a2e=kn("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),o$=kn("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),V5=kn("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),a$=kn("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),l$=kn("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function l2e({value:t,min:e,max:n,onDrag:r,step:i,initialValue:s}){const o=v.useRef(null),a=v.useRef(null),l=v.useRef(0),c=Jc("sizes","scrubberWidth"),u=Ly(({event:d,first:h,xy:[p],movement:[m],memo:g})=>{if(h){const{width:x,left:_}=o.current.getBoundingClientRect();l.current=x-parseFloat(c),g=(d==null?void 0:d.target)===a.current?t:w_((p-_)/x,e,n)}const y=g+w_(m/l.current,0,n-e);return r($W(y,{step:i,initialValue:s})),g}),f=E_(t,e,n);return Ge.createElement(a$,Ri({ref:o},u()),Ge.createElement(o$,null,Ge.createElement(l$,{style:{left:0,right:`${(1-f)*100}%`}})),Ge.createElement(V5,{ref:a,style:{left:`calc(${f} * (100% - ${c}))`}}))}const c2e=Ge.memo(({label:t,onUpdate:e,step:n,innerLabelTrim:r})=>{const[i,s]=v.useState(!1),o=Ly(({active:a,delta:[l],event:c,memo:u=0})=>(s(a),u+=l/2,Math.abs(u)>=1&&(e(f=>parseFloat(f)+Math.floor(u)*n*jW(c)),u=0),u));return Ge.createElement(Hve,Ri({dragging:i,title:t.length>1?t:""},o()),t.slice(0,r))});function c$({label:t,id:e,displayValue:n,onUpdate:r,onChange:i,settings:s,innerLabelTrim:o=1}){const a=o>0&&Ge.createElement(c2e,{label:t,step:s.step,onUpdate:r,innerLabelTrim:o});return Ge.createElement(Wve,{id:e,value:String(n),onUpdate:r,onChange:i,innerLabel:a})}function u2e(){const t=oo(),{label:e,value:n,onUpdate:r,settings:i,id:s}=t,{min:o,max:a}=i,l=a!==1/0&&o!==-1/0;return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,e),Ge.createElement(a2e,{hasRange:l},l&&Ge.createElement(l2e,Ri({value:parseFloat(n),onDrag:r},i)),Ge.createElement(c$,Ri({},t,{id:s,label:"value",innerLabelTrim:l?0:1}))))}const{sanitizeStep:f2e}=XW,d2e=$r(XW,["sanitizeStep"]);var h2e=Dn({component:u2e},d2e);const p2e=(t,e)=>Vo().schema({options:Vo().passesAnyOf(Vo().object(),Vo().array())}).test(e),m2e=(t,{values:e})=>{if(e.indexOf(t)<0)throw Error("Selected value doesn't match Select options");return t},g2e=(t,{values:e})=>e.indexOf(t),y2e=t=>{let{value:e,options:n}=t,r,i;return Array.isArray(n)?(i=n,r=n.map(s=>String(s))):(i=Object.values(n),r=Object.keys(n)),"value"in t?i.includes(e)||(r.unshift(String(e)),i.unshift(e)):e=i[0],Object.values(n).includes(e)||(n[String(e)]=e),{value:e,settings:{keys:r,values:i}}};var v2e=Object.freeze({__proto__:null,schema:p2e,sanitize:m2e,format:g2e,normalize:y2e});const x2e=kn("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),W5=kn("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),_2e=kn("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${W5}:focus + &`]:{$focusStyle:""},[`${W5}:hover + &`]:{$hoverStyle:""}});function b2e({displayValue:t,value:e,onUpdate:n,id:r,settings:i,disabled:s}){const{keys:o,values:a}=i,l=v.useRef();return e===a[t]&&(l.current=o[t]),Ge.createElement(x2e,null,Ge.createElement(W5,{id:r,value:t,onChange:c=>n(a[Number(c.currentTarget.value)]),disabled:s},o.map((c,u)=>Ge.createElement("option",{key:c,value:u},c))),Ge.createElement(_2e,null,l.current),Ge.createElement(r8,{toggled:!0}))}function E2e(){const{label:t,value:e,displayValue:n,onUpdate:r,id:i,disabled:s,settings:o}=oo();return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,t),Ge.createElement(b2e,{id:i,value:e,displayValue:n,onUpdate:r,settings:o,disabled:s}))}var w2e=Dn({component:E2e},v2e);const S2e=t=>Vo().string().test(t),T2e=t=>{if(typeof t!="string")throw Error("Invalid string");return t},A2e=({value:t,editable:e=!0,rows:n=!1})=>({value:t,settings:{editable:e,rows:typeof n=="number"?n:n?5:0}});var M2e=Object.freeze({__proto__:null,schema:S2e,sanitize:T2e,normalize:A2e});const C2e=["displayValue","onUpdate","onChange","editable"],R2e=kn("div",{whiteSpace:"pre-wrap"});function I2e(t){let{displayValue:e,onUpdate:n,onChange:r,editable:i=!0}=t,s=$r(t,C2e);return i?Ge.createElement(t8,Ri({value:e,onUpdate:n,onChange:r},s)):Ge.createElement(R2e,null,e)}function P2e(){const{label:t,settings:e,displayValue:n,onUpdate:r,onChange:i}=oo();return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,t),Ge.createElement(I2e,Ri({displayValue:n,onUpdate:r,onChange:i},e)))}var k2e=Dn({component:P2e},M2e);const L2e=t=>Vo().boolean().test(t),D2e=t=>{if(typeof t!="boolean")throw Error("Invalid boolean");return t};var N2e=Object.freeze({__proto__:null,schema:L2e,sanitize:D2e});const O2e=kn("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function F2e({value:t,onUpdate:e,id:n,disabled:r}){return Ge.createElement(O2e,null,Ge.createElement("input",{id:n,type:"checkbox",checked:t,onChange:i=>e(i.currentTarget.checked),disabled:r}),Ge.createElement("label",{htmlFor:n},Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ge.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function U2e(){const{label:t,value:e,onUpdate:n,disabled:r,id:i}=oo();return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,t),Ge.createElement(F2e,{value:e,onUpdate:n,id:i,disabled:r}))}var B2e=Dn({component:U2e},N2e);const z2e=["locked"];function H2e({value:t,id:e,valueKey:n,settings:r,onUpdate:i,innerLabelTrim:s}){const o=v.useRef(t[n]);o.current=t[n];const a=v.useCallback(c=>i({[n]:HW({type:"NUMBER",value:o.current,settings:r},c)}),[i,r,n]),l=i$({type:"NUMBER",value:t[n],settings:r,setValue:a});return Ge.createElement(c$,{id:e,label:n,value:t[n],displayValue:l.displayValue,onUpdate:l.onUpdate,onChange:l.onChange,settings:r,innerLabelTrim:s})}const G2e=kn("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function j2e(t){let{locked:e}=t,n=$r(t,z2e);return Ge.createElement("svg",Ri({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),e?Ge.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):Ge.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function i8({value:t,onUpdate:e,settings:n,innerLabelTrim:r}){const{id:i,setSettings:s}=oo(),{lock:o,locked:a}=n;return Ge.createElement(G2e,{withLock:o},o&&Ge.createElement(j2e,{locked:a,onClick:()=>s({locked:!a})}),Object.keys(t).map((l,c)=>Ge.createElement(H2e,{id:c===0?i:`${i}.${l}`,key:l,valueKey:l,value:t,settings:n[l],onUpdate:e,innerLabelTrim:r})))}const u$=(t,e)=>{const n={};let r=0,i=1/0;Object.entries(t).forEach(([s,o])=>{n[s]=WW(Dn({value:o},e[s])).settings,r=Math.max(r,n[s].step),i=Math.min(i,n[s].pad)});for(let s in n){const{step:o,min:a,max:l}=e[s]||{};!isFinite(o)&&(!isFinite(a)||!isFinite(l))&&(n[s].step=r,n[s].pad=i)}return n},V2e=["lock"],W2e=["value"];function $2e(t){const e=Vo().array().length(t).every.number(),n=r=>{if(!r||typeof r!="object")return!1;const i=Object.values(r);return i.length===t&&i.every(s=>isFinite(s))};return r=>e.test(r)||n(r)}function X2e(t){return Array.isArray(t)?"array":"object"}function _1(t,e,n){return X2e(t)===e?t:e==="array"?Object.values(t):Sve(t,n)}const q2e=(t,e,n)=>{const r=_1(t,"object",e.keys);for(let o in r)r[o]=VW(r[o],e[o]);const i=Object.keys(r);let s={};if(i.length===e.keys.length)s=r;else{const o=_1(n,"object",e.keys);if(i.length===1&&e.locked){const a=i[0],l=r[a],c=o[a],u=c!==0?l/c:1;for(let f in o)f===a?s[a]=l:s[f]=o[f]*u}else s=Dn(Dn({},o),r)}return _1(s,e.format,e.keys)},Y2e=(t,e)=>_1(t,"object",e.keys),K2e=t=>!!t&&("step"in t||"min"in t||"max"in t);function Z2e(t,e,n=[]){const{lock:r=!1}=e,i=$r(e,V2e),s=Array.isArray(t)?"array":"object",o=s==="object"?Object.keys(t):n,a=_1(t,"object",o),l=K2e(i)?o.reduce((u,f)=>Object.assign(u,{[f]:i}),{}):i,c=u$(a,l);return{value:s==="array"?t:a,settings:Dn(Dn({},c),{},{format:s,keys:o,lock:r,locked:!1})}}function f$(t){return{schema:$2e(t.length),normalize:e=>{let{value:n}=e,r=$r(e,W2e);return Z2e(n,r,t)},format:(e,n)=>Y2e(e,n),sanitize:(e,n,r)=>q2e(e,n,r)}}var Q2e={grad:.9,turn:360,rad:360/(2*Math.PI)},Cc=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Es=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},Va=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),t>n?n:t>e?t:e},d$=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},UD=function(t){return{r:Va(t.r,0,255),g:Va(t.g,0,255),b:Va(t.b,0,255),a:Va(t.a)}},ET=function(t){return{r:Es(t.r),g:Es(t.g),b:Es(t.b),a:Es(t.a,3)}},J2e=/^#([0-9a-f]{3,8})$/i,Tx=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},h$=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},p$=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var s=Math.floor(e),o=r*(1-n),a=r*(1-(e-s)*n),l=r*(1-(1-e+s)*n),c=s%6;return{r:255*[r,a,o,o,l,r][c],g:255*[l,r,r,a,o,o][c],b:255*[o,o,l,r,r,a][c],a:i}},BD=function(t){return{h:d$(t.h),s:Va(t.s,0,100),l:Va(t.l,0,100),a:Va(t.a)}},zD=function(t){return{h:Es(t.h),s:Es(t.s),l:Es(t.l),a:Es(t.a,3)}},HD=function(t){return p$((n=(e=t).s,{h:e.h,s:(n*=((r=e.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:e.a}));var e,n,r},b1=function(t){return{h:(e=h$(t)).h,s:(i=(200-(n=e.s))*(r=e.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,r,i},exe=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,txe=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,nxe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rxe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$5={string:[[function(t){var e=J2e.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Es(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Es(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=nxe.exec(t)||rxe.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:UD({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=exe.exec(t)||txe.exec(t);if(!e)return null;var n,r,i=BD({h:(n=e[1],r=e[2],r===void 0&&(r="deg"),Number(n)*(Q2e[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return HD(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=i===void 0?1:i;return Cc(e)&&Cc(n)&&Cc(r)?UD({r:Number(e),g:Number(n),b:Number(r),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,n=t.s,r=t.l,i=t.a,s=i===void 0?1:i;if(!Cc(e)||!Cc(n)||!Cc(r))return null;var o=BD({h:Number(e),s:Number(n),l:Number(r),a:Number(s)});return HD(o)},"hsl"],[function(t){var e=t.h,n=t.s,r=t.v,i=t.a,s=i===void 0?1:i;if(!Cc(e)||!Cc(n)||!Cc(r))return null;var o=function(a){return{h:d$(a.h),s:Va(a.s,0,100),v:Va(a.v,0,100),a:Va(a.a)}}({h:Number(e),s:Number(n),v:Number(r),a:Number(s)});return p$(o)},"hsv"]]},GD=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0](t);if(r)return[r,e[n][1]]}return[null,void 0]},m$=function(t){return typeof t=="string"?GD(t.trim(),$5.string):typeof t=="object"&&t!==null?GD(t,$5.object):[null,void 0]},ixe=function(t){return m$(t)[1]},wT=function(t,e){var n=b1(t);return{h:n.h,s:Va(n.s+100*e,0,100),l:n.l,a:n.a}},ST=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},jD=function(t,e){var n=b1(t);return{h:n.h,s:n.s,l:Va(n.l+100*e,0,100),a:n.a}},X5=function(){function t(e){this.parsed=m$(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Es(ST(this.rgba),2)},t.prototype.isDark=function(){return ST(this.rgba)<.5},t.prototype.isLight=function(){return ST(this.rgba)>=.5},t.prototype.toHex=function(){return e=ET(this.rgba),n=e.r,r=e.g,i=e.b,o=(s=e.a)<1?Tx(Es(255*s)):"","#"+Tx(n)+Tx(r)+Tx(i)+o;var e,n,r,i,s,o},t.prototype.toRgb=function(){return ET(this.rgba)},t.prototype.toRgbString=function(){return e=ET(this.rgba),n=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+n+", "+r+", "+i+", "+s+")":"rgb("+n+", "+r+", "+i+")";var e,n,r,i,s},t.prototype.toHsl=function(){return zD(b1(this.rgba))},t.prototype.toHslString=function(){return e=zD(b1(this.rgba)),n=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+n+", "+r+"%, "+i+"%, "+s+")":"hsl("+n+", "+r+"%, "+i+"%)";var e,n,r,i,s},t.prototype.toHsv=function(){return e=h$(this.rgba),{h:Es(e.h),s:Es(e.s),v:Es(e.v),a:Es(e.a,3)};var e},t.prototype.invert=function(){return Eo({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),Eo(wT(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),Eo(wT(this.rgba,-e))},t.prototype.grayscale=function(){return Eo(wT(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),Eo(jD(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),Eo(jD(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?Eo({r:(n=this.rgba).r,g:n.g,b:n.b,a:e}):Es(this.rgba.a,3);var n},t.prototype.hue=function(e){var n=b1(this.rgba);return typeof e=="number"?Eo({h:e,s:n.s,l:n.l,a:n.a}):Es(n.h)},t.prototype.isEqual=function(e){return this.toHex()===Eo(e).toHex()},t}(),Eo=function(t){return t instanceof X5?t:new X5(t)},VD=[],sxe=function(t){t.forEach(function(e){VD.indexOf(e)<0&&(e(X5,$5),VD.push(e))})};function oxe(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=r[this.toHex()];if(c)return c;if(o!=null&&o.closest){var u=this.toRgb(),f=1/0,d="black";if(!s.length)for(var h in n)s[h]=new t(n[h]).toRgb();for(var p in n){var m=(a=u,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<f&&(f=m,d=p)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":n[a];return l?new t(l).toRgb():null},"name"])}function Qm(){return(Qm=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function s8(t,e){if(t==null)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)e.indexOf(n=s[r])>=0||(i[n]=t[n]);return i}function q5(t){var e=v.useRef(t),n=v.useRef(function(r){e.current&&e.current(r)});return e.current=t,n.current}var wm=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),t>n?n:t<e?e:t},E1=function(t){return"touches"in t},Y5=function(t){return t&&t.ownerDocument.defaultView||self},WD=function(t,e,n){var r=t.getBoundingClientRect(),i=E1(e)?function(s,o){for(var a=0;a<s.length;a++)if(s[a].identifier===o)return s[a];return s[0]}(e.touches,n):e;return{left:wm((i.pageX-(r.left+Y5(t).pageXOffset))/r.width),top:wm((i.pageY-(r.top+Y5(t).pageYOffset))/r.height)}},$D=function(t){!E1(t)&&t.preventDefault()},o8=Ge.memo(function(t){var e=t.onMove,n=t.onKey,r=s8(t,["onMove","onKey"]),i=v.useRef(null),s=q5(e),o=q5(n),a=v.useRef(null),l=v.useRef(!1),c=v.useMemo(function(){var h=function(g){$D(g),(E1(g)?g.touches.length>0:g.buttons>0)&&i.current?s(WD(i.current,g,a.current)):m(!1)},p=function(){return m(!1)};function m(g){var y=l.current,x=Y5(i.current),_=g?x.addEventListener:x.removeEventListener;_(y?"touchmove":"mousemove",h),_(y?"touchend":"mouseup",p)}return[function(g){var y=g.nativeEvent,x=i.current;if(x&&($D(y),!function(w,T){return T&&!E1(w)}(y,l.current)&&x)){if(E1(y)){l.current=!0;var _=y.changedTouches||[];_.length&&(a.current=_[0].identifier)}x.focus(),s(WD(x,y,a.current)),m(!0)}},function(g){var y=g.which||g.keyCode;y<37||y>40||(g.preventDefault(),o({left:y===39?.05:y===37?-.05:0,top:y===40?.05:y===38?-.05:0}))},m]},[o,s]),u=c[0],f=c[1],d=c[2];return v.useEffect(function(){return d},[d]),Ge.createElement("div",Qm({},r,{onTouchStart:u,onMouseDown:u,className:"react-colorful__interactive",ref:i,onKeyDown:f,tabIndex:0,role:"slider"}))}),Dy=function(t){return t.filter(Boolean).join(" ")},a8=function(t){var e=t.color,n=t.left,r=t.top,i=r===void 0?.5:r,s=Dy(["react-colorful__pointer",t.className]);return Ge.createElement("div",{className:s,style:{top:100*i+"%",left:100*n+"%"}},Ge.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Co=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*t)/n},g$=function(t){var e=t.s,n=t.v,r=t.a,i=(200-e)*n/100;return{h:Co(t.h),s:Co(i>0&&i<200?e*n/100/(i<=100?i:200-i)*100:0),l:Co(i/2),a:Co(r,2)}},K5=function(t){var e=g$(t);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},TT=function(t){var e=g$(t);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},y$=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var s=Math.floor(e),o=r*(1-n),a=r*(1-(e-s)*n),l=r*(1-(1-e+s)*n),c=s%6;return{r:Co(255*[r,a,o,o,l,r][c]),g:Co(255*[l,r,r,a,o,o][c]),b:Co(255*[o,o,l,r,r,a][c]),a:Co(i,2)}},v$=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:Co(60*(a<0?a+6:a)),s:Co(s?o/s*100:0),v:Co(s/255*100),a:i}},x$=Ge.memo(function(t){var e=t.hue,n=t.onChange,r=Dy(["react-colorful__hue",t.className]);return Ge.createElement("div",{className:r},Ge.createElement(o8,{onMove:function(i){n({h:360*i.left})},onKey:function(i){n({h:wm(e+360*i.left,0,360)})},"aria-label":"Hue","aria-valuenow":Co(e),"aria-valuemax":"360","aria-valuemin":"0"},Ge.createElement(a8,{className:"react-colorful__hue-pointer",left:e/360,color:K5({h:e,s:100,v:100,a:1})})))}),_$=Ge.memo(function(t){var e=t.hsva,n=t.onChange,r={backgroundColor:K5({h:e.h,s:100,v:100,a:1})};return Ge.createElement("div",{className:"react-colorful__saturation",style:r},Ge.createElement(o8,{onMove:function(i){n({s:100*i.left,v:100-100*i.top})},onKey:function(i){n({s:wm(e.s+100*i.left,0,100),v:wm(e.v-100*i.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Co(e.s)+"%, Brightness "+Co(e.v)+"%"},Ge.createElement(a8,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:K5(e)})))}),l8=function(t,e){if(t===e)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0};function b$(t,e,n){var r=q5(n),i=v.useState(function(){return t.toHsva(e)}),s=i[0],o=i[1],a=v.useRef({color:e,hsva:s});v.useEffect(function(){if(!t.equal(e,a.current.color)){var c=t.toHsva(e);a.current={hsva:c,color:e},o(c)}},[e,t]),v.useEffect(function(){var c;l8(s,a.current.hsva)||t.equal(c=t.fromHsva(s),a.current.color)||(a.current={hsva:s,color:c},r(c))},[s,t,r]);var l=v.useCallback(function(c){o(function(u){return Object.assign({},u,c)})},[]);return[s,l]}var axe=typeof window<"u"?v.useLayoutEffect:v.useEffect,lxe=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},XD=new Map,E$=function(t){axe(function(){var e=t.current?t.current.ownerDocument:document;if(e!==void 0&&!XD.has(e)){var n=e.createElement("style");n.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,XD.set(e,n);var r=lxe();r&&n.setAttribute("nonce",r),e.head.appendChild(n)}},[])},cxe=function(t){var e=t.className,n=t.colorModel,r=t.color,i=r===void 0?n.defaultColor:r,s=t.onChange,o=s8(t,["className","colorModel","color","onChange"]),a=v.useRef(null);E$(a);var l=b$(n,i,s),c=l[0],u=l[1],f=Dy(["react-colorful",e]);return Ge.createElement("div",Qm({},o,{ref:a,className:f}),Ge.createElement(_$,{hsva:c,onChange:u}),Ge.createElement(x$,{hue:c.h,onChange:u,className:"react-colorful__last-control"}))},uxe=function(t){var e=t.className,n=t.hsva,r=t.onChange,i={backgroundImage:"linear-gradient(90deg, "+TT(Object.assign({},n,{a:0}))+", "+TT(Object.assign({},n,{a:1}))+")"},s=Dy(["react-colorful__alpha",e]),o=Co(100*n.a);return Ge.createElement("div",{className:s},Ge.createElement("div",{className:"react-colorful__alpha-gradient",style:i}),Ge.createElement(o8,{onMove:function(a){r({a:a.left})},onKey:function(a){r({a:wm(n.a+a.left)})},"aria-label":"Alpha","aria-valuetext":o+"%","aria-valuenow":o,"aria-valuemin":"0","aria-valuemax":"100"},Ge.createElement(a8,{className:"react-colorful__alpha-pointer",left:n.a,color:TT(n)})))},fxe=function(t){var e=t.className,n=t.colorModel,r=t.color,i=r===void 0?n.defaultColor:r,s=t.onChange,o=s8(t,["className","colorModel","color","onChange"]),a=v.useRef(null);E$(a);var l=b$(n,i,s),c=l[0],u=l[1],f=Dy(["react-colorful",e]);return Ge.createElement("div",Qm({},o,{ref:a,className:f}),Ge.createElement(_$,{hsva:c,onChange:u}),Ge.createElement(x$,{hue:c.h,onChange:u}),Ge.createElement(uxe,{hsva:c,onChange:u,className:"react-colorful__last-control"}))},dxe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:v$,fromHsva:y$,equal:l8},hxe=function(t){return Ge.createElement(fxe,Qm({},t,{colorModel:dxe}))},pxe={defaultColor:{r:0,g:0,b:0},toHsva:function(t){return v$({r:t.r,g:t.g,b:t.b,a:1})},fromHsva:function(t){return{r:(e=y$(t)).r,g:e.g,b:e.b};var e},equal:l8},mxe=function(t){return Ge.createElement(cxe,Qm({},t,{colorModel:pxe}))};function Jm(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function e0(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function gxe(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function yxe(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(gxe(arguments[e]));return t}var vxe=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Ny(t,e){var n=xxe(t);if(typeof n.path!="string"){var r=t.webkitRelativePath;Object.defineProperty(n,"path",{value:typeof e=="string"?e:typeof r=="string"&&r.length>0?r:t.name,writable:!1,configurable:!1,enumerable:!0})}return n}function xxe(t){var e=t.name,n=e&&e.lastIndexOf(".")!==-1;if(n&&!t.type){var r=e.split(".").pop().toLowerCase(),i=vxe.get(r);i&&Object.defineProperty(t,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return t}var _xe=[".DS_Store","Thumbs.db"];function bxe(t){return Jm(this,void 0,void 0,function(){return e0(this,function(e){return T_(t)&&Exe(t)?[2,Axe(t.dataTransfer,t.type)]:wxe(t)?[2,Sxe(t)]:Array.isArray(t)&&t.every(function(n){return"getFile"in n&&typeof n.getFile=="function"})?[2,Txe(t)]:[2,[]]})})}function Exe(t){return T_(t.dataTransfer)}function wxe(t){return T_(t)&&T_(t.target)}function T_(t){return typeof t=="object"&&t!==null}function Sxe(t){return Z5(t.target.files).map(function(e){return Ny(e)})}function Txe(t){return Jm(this,void 0,void 0,function(){var e;return e0(this,function(n){switch(n.label){case 0:return[4,Promise.all(t.map(function(r){return r.getFile()}))];case 1:return e=n.sent(),[2,e.map(function(r){return Ny(r)})]}})})}function Axe(t,e){return Jm(this,void 0,void 0,function(){var n,r;return e0(this,function(i){switch(i.label){case 0:return t===null?[2,[]]:t.items?(n=Z5(t.items).filter(function(s){return s.kind==="file"}),e!=="drop"?[2,n]:[4,Promise.all(n.map(Mxe))]):[3,2];case 1:return r=i.sent(),[2,qD(w$(r))];case 2:return[2,qD(Z5(t.files).map(function(s){return Ny(s)}))]}})})}function qD(t){return t.filter(function(e){return _xe.indexOf(e.name)===-1})}function Z5(t){if(t===null)return[];for(var e=[],n=0;n<t.length;n++){var r=t[n];e.push(r)}return e}function Mxe(t){if(typeof t.webkitGetAsEntry!="function")return YD(t);var e=t.webkitGetAsEntry();return e&&e.isDirectory?S$(e):YD(t)}function w$(t){return t.reduce(function(e,n){return yxe(e,Array.isArray(n)?w$(n):[n])},[])}function YD(t){var e=t.getAsFile();if(!e)return Promise.reject(t+" is not a File");var n=Ny(e);return Promise.resolve(n)}function Cxe(t){return Jm(this,void 0,void 0,function(){return e0(this,function(e){return[2,t.isDirectory?S$(t):Rxe(t)]})})}function S$(t){var e=t.createReader();return new Promise(function(n,r){var i=[];function s(){var o=this;e.readEntries(function(a){return Jm(o,void 0,void 0,function(){var l,c,u;return e0(this,function(f){switch(f.label){case 0:if(a.length)return[3,5];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return l=f.sent(),n(l),[3,4];case 3:return c=f.sent(),r(c),[3,4];case 4:return[3,6];case 5:u=Promise.all(a.map(Cxe)),i.push(u),s(),f.label=6;case 6:return[2]}})})},function(a){r(a)})}s()})}function Rxe(t){return Jm(this,void 0,void 0,function(){return e0(this,function(e){return[2,new Promise(function(n,r){t.file(function(i){var s=Ny(i,t.fullPath);n(s)},function(i){r(i)})})]})})}var Ixe=function(t,e){if(t&&e){var n=Array.isArray(e)?e:e.split(",");if(n.length===0)return!0;var r=t.name||"",i=(t.type||"").toLowerCase(),s=i.replace(/\/.*$/,"");return n.some(function(o){var a=o.trim().toLowerCase();return a.charAt(0)==="."?r.toLowerCase().endsWith(a):a.endsWith("/*")?s===a.replace(/\/.*$/,""):i===a})}return!0};function KD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ZD(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KD(Object(n),!0).forEach(function(r){T$(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function T$(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QD(t,e){return Dxe(t)||Lxe(t,e)||kxe(t,e)||Pxe()}function Pxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kxe(t,e){if(t){if(typeof t=="string")return JD(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JD(t,e)}}function JD(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Lxe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],i=!0,s=!1,o,a;try{for(n=n.call(t);!(i=(o=n.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&n.return!=null&&n.return()}finally{if(s)throw a}}return r}}function Dxe(t){if(Array.isArray(t))return t}var Nxe="file-invalid-type",Oxe="file-too-large",Fxe="file-too-small",Uxe="too-many-files",Bxe=function(e){e=Array.isArray(e)&&e.length===1?e[0]:e;var n=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:Nxe,message:"File type must be ".concat(n)}},eN=function(e){return{code:Oxe,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},tN=function(e){return{code:Fxe,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},zxe={code:Uxe,message:"Too many files"};function A$(t,e){var n=t.type==="application/x-moz-file"||Ixe(t,e);return[n,n?null:Bxe(e)]}function M$(t,e,n){if(xg(t.size))if(xg(e)&&xg(n)){if(t.size>n)return[!1,eN(n)];if(t.size<e)return[!1,tN(e)]}else{if(xg(e)&&t.size<e)return[!1,tN(e)];if(xg(n)&&t.size>n)return[!1,eN(n)]}return[!0,null]}function xg(t){return t!=null}function Hxe(t){var e=t.files,n=t.accept,r=t.minSize,i=t.maxSize,s=t.multiple,o=t.maxFiles;return!s&&e.length>1||s&&o>=1&&e.length>o?!1:e.every(function(a){var l=A$(a,n),c=QD(l,1),u=c[0],f=M$(a,r,i),d=QD(f,1),h=d[0];return u&&h})}function A_(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble<"u"?t.cancelBubble:!1}function Ax(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!t.target&&!!t.target.files}function nN(t){t.preventDefault()}function Gxe(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function jxe(t){return t.indexOf("Edge/")!==-1}function Vxe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Gxe(t)||jxe(t)}function Bl(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return e.some(function(a){return!A_(r)&&a&&a.apply(void 0,[r].concat(s)),A_(r)})}}function Wxe(){return"showOpenFilePicker"in window}function $xe(t){return t=typeof t=="string"?t.split(","):t,[{description:"everything",accept:Array.isArray(t)?t.filter(function(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}).reduce(function(e,n){return ZD(ZD({},e),{},T$({},n,[]))},{}):{}}]}function Xxe(t){return t instanceof DOMException&&(t.name==="AbortError"||t.code===t.ABORT_ERR)}function qxe(t){return t instanceof DOMException&&(t.name==="SecurityError"||t.code===t.SECURITY_ERR)}var Yxe=["children"],Kxe=["open"],Zxe=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Qxe=["refKey","onChange","onClick"];function Jxe(t){return n3e(t)||t3e(t)||C$(t)||e3e()}function e3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function n3e(t){if(Array.isArray(t))return Q5(t)}function AT(t,e){return s3e(t)||i3e(t,e)||C$(t,e)||r3e()}function r3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C$(t,e){if(t){if(typeof t=="string")return Q5(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q5(t,e)}}function Q5(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i3e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],i=!0,s=!1,o,a;try{for(n=n.call(t);!(i=(o=n.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&n.return!=null&&n.return()}finally{if(s)throw a}}return r}}function s3e(t){if(Array.isArray(t))return t}function rN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function xi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rN(Object(n),!0).forEach(function(r){J5(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function J5(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M_(t,e){if(t==null)return{};var n=o3e(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function o3e(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var c8=v.forwardRef(function(t,e){var n=t.children,r=M_(t,Yxe),i=I$(r),s=i.open,o=M_(i,Kxe);return v.useImperativeHandle(e,function(){return{open:s}},[s]),Ge.createElement(v.Fragment,null,n(xi(xi({},o),{},{open:s})))});c8.displayName="Dropzone";var R$={disabled:!1,getFilesFromEvent:bxe,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};c8.defaultProps=R$;c8.propTypes={children:Sr.func,accept:Sr.oneOfType([Sr.string,Sr.arrayOf(Sr.string)]),multiple:Sr.bool,preventDropOnDocument:Sr.bool,noClick:Sr.bool,noKeyboard:Sr.bool,noDrag:Sr.bool,noDragEventsBubbling:Sr.bool,minSize:Sr.number,maxSize:Sr.number,maxFiles:Sr.number,disabled:Sr.bool,getFilesFromEvent:Sr.func,onFileDialogCancel:Sr.func,onFileDialogOpen:Sr.func,useFsAccessApi:Sr.bool,onDragEnter:Sr.func,onDragLeave:Sr.func,onDragOver:Sr.func,onDrop:Sr.func,onDropAccepted:Sr.func,onDropRejected:Sr.func,validator:Sr.func};var eM={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function I$(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=xi(xi({},R$),t),n=e.accept,r=e.disabled,i=e.getFilesFromEvent,s=e.maxSize,o=e.minSize,a=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,f=e.onDragOver,d=e.onDrop,h=e.onDropAccepted,p=e.onDropRejected,m=e.onFileDialogCancel,g=e.onFileDialogOpen,y=e.useFsAccessApi,x=e.preventDropOnDocument,_=e.noClick,w=e.noKeyboard,T=e.noDrag,S=e.noDragEventsBubbling,C=e.validator,A=v.useMemo(function(){return typeof g=="function"?g:iN},[g]),R=v.useMemo(function(){return typeof m=="function"?m:iN},[m]),M=v.useRef(null),D=v.useRef(null),k=v.useReducer(a3e,eM),L=AT(k,2),N=L[0],z=L[1],O=N.isFocused,K=N.isFileDialogActive,V=N.draggedFiles,ne=v.useRef(typeof window<"u"&&window.isSecureContext&&y&&Wxe()),re=function(){!ne.current&&K&&setTimeout(function(){if(D.current){var Me=D.current.files;Me.length||(z({type:"closeDialog"}),R())}},300)};v.useEffect(function(){return window.addEventListener("focus",re,!1),function(){window.removeEventListener("focus",re,!1)}},[D,K,R,ne]);var P=v.useRef([]),se=function(Me){M.current&&M.current.contains(Me.target)||(Me.preventDefault(),P.current=[])};v.useEffect(function(){return x&&(document.addEventListener("dragover",nN,!1),document.addEventListener("drop",se,!1)),function(){x&&(document.removeEventListener("dragover",nN),document.removeEventListener("drop",se))}},[M,x]);var ue=v.useCallback(function(ve){ve.preventDefault(),ve.persist(),Pe(ve),P.current=[].concat(Jxe(P.current),[ve.target]),Ax(ve)&&Promise.resolve(i(ve)).then(function(Me){A_(ve)&&!S||(z({draggedFiles:Me,isDragActive:!0,type:"setDraggedFiles"}),c&&c(ve))})},[i,c,S]),te=v.useCallback(function(ve){ve.preventDefault(),ve.persist(),Pe(ve);var Me=Ax(ve);if(Me&&ve.dataTransfer)try{ve.dataTransfer.dropEffect="copy"}catch{}return Me&&f&&f(ve),!1},[f,S]),W=v.useCallback(function(ve){ve.preventDefault(),ve.persist(),Pe(ve);var Me=P.current.filter(function(Ze){return M.current&&M.current.contains(Ze)}),Be=Me.indexOf(ve.target);Be!==-1&&Me.splice(Be,1),P.current=Me,!(Me.length>0)&&(z({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),Ax(ve)&&u&&u(ve))},[M,u,S]),X=v.useCallback(function(ve,Me){var Be=[],Ze=[];ve.forEach(function(F){var Z=A$(F,n),q=AT(Z,2),xe=q[0],be=q[1],De=M$(F,o,s),$e=AT(De,2),st=$e[0],it=$e[1],Ie=C?C(F):null;if(xe&&st&&!Ie)Be.push(F);else{var Ye=[be,it];Ie&&(Ye=Ye.concat(Ie)),Ze.push({file:F,errors:Ye.filter(function(at){return at})})}}),(!a&&Be.length>1||a&&l>=1&&Be.length>l)&&(Be.forEach(function(F){Ze.push({file:F,errors:[zxe]})}),Be.splice(0)),z({acceptedFiles:Be,fileRejections:Ze,type:"setFiles"}),d&&d(Be,Ze,Me),Ze.length>0&&p&&p(Ze,Me),Be.length>0&&h&&h(Be,Me)},[z,a,n,o,s,l,d,h,p,C]),J=v.useCallback(function(ve){ve.preventDefault(),ve.persist(),Pe(ve),P.current=[],Ax(ve)&&Promise.resolve(i(ve)).then(function(Me){A_(ve)&&!S||X(Me,ve)}),z({type:"reset"})},[i,X,S]),oe=v.useCallback(function(){if(ne.current){z({type:"openDialog"}),A();var ve={multiple:a,types:$xe(n)};window.showOpenFilePicker(ve).then(function(Me){return i(Me)}).then(function(Me){X(Me,null),z({type:"closeDialog"})}).catch(function(Me){Xxe(Me)?(R(Me),z({type:"closeDialog"})):qxe(Me)&&(ne.current=!1,D.current&&(D.current.value=null,D.current.click()))});return}D.current&&(z({type:"openDialog"}),A(),D.current.value=null,D.current.click())},[z,A,R,y,X,n,a]),Ee=v.useCallback(function(ve){!M.current||!M.current.isEqualNode(ve.target)||(ve.key===" "||ve.key==="Enter"||ve.keyCode===32||ve.keyCode===13)&&(ve.preventDefault(),oe())},[M,oe]),me=v.useCallback(function(){z({type:"focus"})},[]),Te=v.useCallback(function(){z({type:"blur"})},[]),_e=v.useCallback(function(){_||(Vxe()?setTimeout(oe,0):oe())},[_,oe]),Re=function(Me){return r?null:Me},ae=function(Me){return w?null:Re(Me)},Ce=function(Me){return T?null:Re(Me)},Pe=function(Me){S&&Me.stopPropagation()},Ve=v.useMemo(function(){return function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Me=ve.refKey,Be=Me===void 0?"ref":Me,Ze=ve.role,F=ve.onKeyDown,Z=ve.onFocus,q=ve.onBlur,xe=ve.onClick,be=ve.onDragEnter,De=ve.onDragOver,$e=ve.onDragLeave,st=ve.onDrop,it=M_(ve,Zxe);return xi(xi(J5({onKeyDown:ae(Bl(F,Ee)),onFocus:ae(Bl(Z,me)),onBlur:ae(Bl(q,Te)),onClick:Re(Bl(xe,_e)),onDragEnter:Ce(Bl(be,ue)),onDragOver:Ce(Bl(De,te)),onDragLeave:Ce(Bl($e,W)),onDrop:Ce(Bl(st,J)),role:typeof Ze=="string"&&Ze!==""?Ze:"button"},Be,M),!r&&!w?{tabIndex:0}:{}),it)}},[M,Ee,me,Te,_e,ue,te,W,J,w,T,r]),ye=v.useCallback(function(ve){ve.stopPropagation()},[]),ge=v.useMemo(function(){return function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Me=ve.refKey,Be=Me===void 0?"ref":Me,Ze=ve.onChange,F=ve.onClick,Z=M_(ve,Qxe),q=J5({accept:n,multiple:a,type:"file",style:{display:"none"},onChange:Re(Bl(Ze,J)),onClick:Re(Bl(F,ye)),tabIndex:-1},Be,D);return xi(xi({},q),Z)}},[D,n,a,J,r]),ze=V.length,fe=ze>0&&Hxe({files:V,accept:n,minSize:o,maxSize:s,multiple:a,maxFiles:l}),ie=ze>0&&!fe;return xi(xi({},N),{},{isDragAccept:fe,isDragReject:ie,isFocused:O&&!r,getRootProps:Ve,getInputProps:ge,rootRef:M,inputRef:D,open:Re(oe)})}function a3e(t,e){switch(e.type){case"focus":return xi(xi({},t),{},{isFocused:!0});case"blur":return xi(xi({},t),{},{isFocused:!1});case"openDialog":return xi(xi({},eM),{},{isFileDialogActive:!0});case"closeDialog":return xi(xi({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":var n=e.isDragActive,r=e.draggedFiles;return xi(xi({},t),{},{draggedFiles:r,isDragActive:n});case"setFiles":return xi(xi({},t),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections});case"reset":return xi({},eM);default:return t}}function iN(){}function l3e(t){let e;const n=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(f!==e){const d=e;e=u?f:Object.assign({},e,f),n.forEach(h=>h(e,d))}},i=()=>e,s=(c,u=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=u(e);function h(){const p=u(e);if(!f(d,p)){const m=d;c(d=p,m)}}return n.add(h),()=>n.delete(h)},l={setState:r,getState:i,subscribe:(c,u,f)=>u||f?s(c,u,f):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(r,i,l),l}const c3e=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),sN=c3e?v.useEffect:v.useLayoutEffect;function u3e(t){const e=typeof t=="function"?l3e(t):t,n=(r=e.getState,i=Object.is)=>{const[,s]=v.useReducer(g=>g+1,0),o=e.getState(),a=v.useRef(o),l=v.useRef(r),c=v.useRef(i),u=v.useRef(!1),f=v.useRef();f.current===void 0&&(f.current=r(o));let d,h=!1;(a.current!==o||l.current!==r||c.current!==i||u.current)&&(d=r(o),h=!i(f.current,d)),sN(()=>{h&&(f.current=d),a.current=o,l.current=r,c.current=i,u.current=!1});const p=v.useRef(o);sN(()=>{const g=()=>{try{const x=e.getState(),_=l.current(x);c.current(f.current,_)||(a.current=x,f.current=_,s())}catch{u.current=!0,s()}},y=e.subscribe(g);return e.getState()!==p.current&&g(),y},[]);const m=h?d:f.current;return v.useDebugValue(m),m};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}const f3e=t=>(e,n,r)=>{const i=r.subscribe;return r.subscribe=(o,a,l)=>{let c=o;if(a){const u=(l==null?void 0:l.equalityFn)||Object.is;let f=o(r.getState());c=d=>{const h=o(d);if(!u(f,h)){const p=f;a(f=h,p)}},l!=null&&l.fireImmediately&&a(f,f)}return i(c)},t(e,n,r)};/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var d3e=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var h3e=d3e;function oN(t){return h3e(t)===!0&&Object.prototype.toString.call(t)==="[object Object]"}var P$=function(e){var n,r;return!(oN(e)===!1||(n=e.constructor,typeof n!="function")||(r=n.prototype,oN(r)===!1)||r.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var p3e=P$,u8=function(e){return p3e(e)||typeof e=="function"||Array.isArray(e)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var m3e=function(e,n,r){for(var i in e)if(n.call(r,e[i],i,e)===!1)break},g3e=u8,y3e=m3e;function k$(t,e){for(var n=arguments.length,r=0;++r<n;){var i=arguments[r];tM(i)&&y3e(i,v3e,t)}return t}function v3e(t,e){if(x3e(e)){var n=this[e];tM(t)&&tM(n)?k$(n,t):this[e]=t}}function tM(t){return g3e(t)&&!Array.isArray(t)}function x3e(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}var _3e=k$;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var b3e=function(t,e,n,r,i){if(!E3e(t)||!e)return t;if(e=Mx(e),n&&(e+="."+Mx(n)),r&&(e+="."+Mx(r)),i&&(e+="."+Mx(i)),e in t)return t[e];for(var s=e.split("."),o=s.length,a=-1;t&&++a<o;){for(var l=s[a];l[l.length-1]==="\\";)l=l.slice(0,-1)+"."+s[++a];t=t[l]}return t};function E3e(t){return t!==null&&(typeof t=="object"||typeof t=="function")}function Mx(t){return t?Array.isArray(t)?t.join("."):t:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var w3e=function(t,e){if(t===null||typeof t>"u")throw new TypeError("expected first argument to be an object.");if(typeof e>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return t;for(var n=Object.prototype.propertyIsEnumerable,r=Object(t),i=arguments.length,s=0;++s<i;)for(var o=Object(arguments[s]),a=Object.getOwnPropertySymbols(o),l=0;l<a.length;l++){var c=a[l];n.call(o,c)&&(r[c]=o[c])}return r},S3e=u8,T3e=w3e,A3e=Object.assign||function(t){if(t===null||typeof t>"u")throw new TypeError("Cannot convert undefined or null to object");aN(t)||(t={});for(var e=1;e<arguments.length;e++){var n=arguments[e];C3e(n)&&(n=R3e(n)),aN(n)&&(M3e(t,n),T3e(t,n))}return t};function M3e(t,e){for(var n in e)I3e(e,n)&&(t[n]=e[n])}function C3e(t){return t&&typeof t=="string"}function R3e(t){var e={};for(var n in t)e[n]=t[n];return e}function aN(t){return t&&typeof t=="object"||S3e(t)}function I3e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var P3e=A3e,k3e=function(t,e,n){if(typeof t!="string")throw new TypeError("expected a string");typeof e=="function"&&(n=e,e=null),typeof e=="string"&&(e={sep:e});var r=P3e({sep:"."},e),i=r.quotes||['"',"'","`"],s;r.brackets===!0?s={"<":">","(":")","[":"]","{":"}"}:r.brackets&&(s=r.brackets);var o=[],a=[],l=[""],c=r.sep,u=t.length,f=-1,d;function h(){if(s&&a.length)return s[a[a.length-1]]}for(;++f<u;){var p=t[f],m=t[f+1],g={val:p,idx:f,arr:l,str:t};if(o.push(g),p==="\\"){g.val=D3e(r,t,f)===!0?p+m:m,g.escaped=!0,typeof n=="function"&&n(g),l[l.length-1]+=g.val,f++;continue}if(s&&s[p]){a.push(p);var y=h(),x=f+1;if(t.indexOf(y,x+1)!==-1)for(;a.length&&x<u;){var _=t[++x];if(_==="\\"){_++;continue}if(i.indexOf(_)!==-1){x=nM(t,_,x+1);continue}if(y=h(),a.length&&t.indexOf(y,x+1)===-1)break;if(s[_]){a.push(_);continue}y===_&&a.pop()}if(d=x,d===-1){l[l.length-1]+=p;continue}p=t.slice(f,d+1),g.val=p,g.idx=f=d}if(i.indexOf(p)!==-1){if(d=nM(t,p,f+1),d===-1){l[l.length-1]+=p;continue}L3e(p,r)===!0?p=t.slice(f,d+1):p=t.slice(f+1,d),g.val=p,g.idx=f=d}if(typeof n=="function"&&(n(g,o),p=g.val,f=g.idx),g.val===c&&g.split!==!1){l.push("");continue}l[l.length-1]+=g.val}return l};function nM(t,e,n,r){var i=t.indexOf(e,n);return t.charAt(i-1)==="\\"?nM(t,e,i+1):i}function L3e(t,e){return e.keepDoubleQuotes===!0&&t==='"'||e.keepSingleQuotes===!0&&t==="'"?!0:e.keepQuotes}function D3e(t,e,n){return typeof t.keepEscaping=="function"?t.keepEscaping(e,n):t.keepEscaping===!0||e[n+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var N3e=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")},lN=N3e,O3e=function(e){lN(e)||(e={});for(var n=arguments.length,r=1;r<n;r++){var i=arguments[r];lN(i)&&F3e(e,i)}return e};function F3e(t,e){for(var n in e)U3e(e,n)&&(t[n]=e[n])}function U3e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var B3e=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var z3e=k3e,H3e=O3e,cN=P$,uN=B3e,G3e=function(t,e,n){if(!uN(t)||(Array.isArray(e)&&(e=[].concat.apply([],e).join(".")),typeof e!="string"))return t;for(var r=z3e(e,{sep:".",brackets:!0}).filter(j3e),i=r.length,s=-1,o=t;++s<i;){var a=r[s];if(s!==i-1){uN(o[a])||(o[a]={}),o=o[a];continue}cN(o[a])&&cN(n)?o[a]=H3e({},o[a],n):o[a]=n}return t};function j3e(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}var MT=u8,fN=_3e,V3e=b3e,dN=G3e,W3e=function(e,n,r){if(!MT(e))throw new TypeError("expected an object");if(typeof n!="string"||r==null)return fN.apply(null,arguments);if(typeof r=="string")return dN(e,n,r),e;var i=V3e(e,n);return MT(r)&&MT(i)&&(r=fN({},i,r)),dN(e,n,r),e};const $3e=Zd(W3e),f8=(...t)=>t.filter(Boolean).join(".");function X3e(t){const e=t.split(".");return[e.pop(),e.join(".")||void 0]}function q3e(t,e){return Object.entries(Eve(t,e)).reduce((n,[,{value:r,disabled:i,key:s}])=>(n[s]=i?void 0:r,n),{})}function Y3e(t,e){const n=v.useRef();return q1(t,n.current)||(n.current=t),n.current}function L$(t,e){return v.useMemo(t,Y3e(e))}function K3e(t){const e=v.useRef(null),n=v.useRef(null),r=v.useRef(!0);return v.useLayoutEffect(()=>{t||(e.current.style.height="0px",e.current.style.overflow="hidden")},[]),v.useEffect(()=>{if(r.current){r.current=!1;return}let i;const s=e.current,o=()=>{t&&(s.style.removeProperty("height"),s.style.removeProperty("overflow"),n.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};s.addEventListener("transitionend",o,{once:!0});const{height:a}=n.current.getBoundingClientRect();return s.style.height=a+"px",t||(s.style.overflow="hidden",i=window.setTimeout(()=>s.style.height="0px",50)),()=>{s.removeEventListener("transitionend",o),clearTimeout(i)}},[t]),{wrapperRef:e,contentRef:n}}const Z3e=t=>{const[e,n]=v.useState(t.getVisiblePaths());return v.useEffect(()=>{n(t.getVisiblePaths());const r=t.useStore.subscribe(t.getVisiblePaths,n,{equalityFn:lE});return()=>r()},[t]),e};function Q3e(t,e,n){return t.useStore(i=>{const s=Dn(Dn({},n),i.data);return q3e(s,e)},lE)}function D$(t=3){const e=v.useRef(null),n=v.useRef(null),[r,i]=v.useState(!1),s=v.useCallback(()=>i(!0),[]),o=v.useCallback(()=>i(!1),[]);return v.useLayoutEffect(()=>{if(r){const{bottom:a,top:l,left:c}=e.current.getBoundingClientRect(),{height:u}=n.current.getBoundingClientRect(),f=a+u>window.innerHeight-40?"up":"down";n.current.style.position="fixed",n.current.style.zIndex="10000",n.current.style.left=c+"px",f==="down"?n.current.style.top=a+t+"px":n.current.style.bottom=window.innerHeight-l+t+"px"}},[t,r]),{popinRef:e,wrapperRef:n,shown:r,show:s,hide:o}}sxe([oxe]);const J3e={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};Vo.extend({color:()=>t=>Eo(t).isValid()});const e_e=t=>Vo().color().test(t);function N$(t,{format:e,hasAlpha:n,isString:r}){const i=J3e[e]+(r&&e!=="hex"?"String":""),s=t[i]();return typeof s=="object"&&!n?wve(s,["a"]):s}const O$=(t,e)=>{const n=Eo(t);if(!n.isValid())throw Error("Invalid color");return N$(n,e)},t_e=(t,e)=>N$(Eo(t),Dn(Dn({},e),{},{isString:!0,format:"hex"})),n_e=({value:t})=>{const e=ixe(t),n=e==="name"?"hex":e,r=typeof t=="object"?"a"in t:e==="hex"&&t.length===8||/^(rgba)|(hsla)|(hsva)/.test(t),i={format:n,hasAlpha:r,isString:typeof t=="string"};return{value:O$(t,i),settings:i}};var r_e=Object.freeze({__proto__:null,schema:e_e,sanitize:O$,format:t_e,normalize:n_e});const i_e=kn("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),s_e=kn("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),o_e=kn("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function hN(t,e){return e!=="rgb"?Eo(t).toRgb():t}function a_e({value:t,displayValue:e,settings:n,onUpdate:r}){const{emitOnEditStart:i,emitOnEditEnd:s}=oo(),{format:o,hasAlpha:a}=n,{popinRef:l,wrapperRef:c,shown:u,show:f,hide:d}=D$(),h=v.useRef(0),[p,m]=v.useState(()=>hN(t,o)),g=a?hxe:mxe,y=()=>{m(hN(t,o)),f(),i()},x=()=>{d(),s(),window.clearTimeout(h.current)},_=()=>{h.current=window.setTimeout(x,500)};return v.useEffect(()=>()=>window.clearTimeout(h.current),[]),Ge.createElement(Ge.Fragment,null,Ge.createElement(i_e,{ref:l,active:u,onClick:()=>y(),style:{color:e}}),u&&Ge.createElement(n8,null,Ge.createElement(r$,{onPointerUp:x}),Ge.createElement(o_e,{ref:c,onMouseEnter:()=>window.clearTimeout(h.current),onMouseLeave:w=>w.buttons===0&&_()},Ge.createElement(g,{color:p,onChange:r}))))}function l_e(){const{value:t,displayValue:e,label:n,onChange:r,onUpdate:i,settings:s}=oo();return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,n),Ge.createElement(s_e,null,Ge.createElement(a_e,{value:t,displayValue:e,onChange:r,onUpdate:i,settings:s}),Ge.createElement(t8,{value:e,onChange:r,onUpdate:i})))}var c_e=Dn({component:l_e},r_e);function u_e(){const{label:t,displayValue:e,onUpdate:n,settings:r}=oo();return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,t),Ge.createElement(i8,{value:e,settings:r,onUpdate:n}))}var f_e=Dn({component:u_e},f$(["x","y","z"]));const d_e=kn("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),h_e=kn("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function p_e({value:t,settings:e,onUpdate:n}){const r=v.useRef(),i=v.useRef(0),s=v.useRef(0),o=v.useRef(1),[a,l]=v.useState(!1),[c,u]=v.useState(!1),[f,d]=s$(),h=v.useRef(null),p=v.useRef(null);v.useLayoutEffect(()=>{if(a){const{top:k,left:L,width:N,height:z}=h.current.getBoundingClientRect();p.current.style.left=L+N/2+"px",p.current.style.top=k+z/2+"px"}},[a]);const{keys:[m,g],joystick:y}=e,x=y==="invertY"?1:-1,{[m]:{step:_},[g]:{step:w}}=e,T=Jc("sizes","joystickWidth"),S=Jc("sizes","joystickHeight"),C=parseFloat(T)*.8/2,A=parseFloat(S)*.8/2,R=v.useCallback(()=>{r.current||(u(!0),i.current&&d({x:i.current*C}),s.current&&d({y:s.current*-A}),r.current=window.setInterval(()=>{n(k=>{const L=_*i.current*o.current,N=x*w*s.current*o.current;return Array.isArray(k)?{[m]:k[0]+L,[g]:k[1]+N}:{[m]:k[m]+L,[g]:k[g]+N}})},16))},[C,A,n,d,_,w,m,g,x]),M=v.useCallback(()=>{window.clearTimeout(r.current),r.current=void 0,u(!1)},[]);v.useEffect(()=>{function k(L){o.current=jW(L)}return window.addEventListener("keydown",k),window.addEventListener("keyup",k),()=>{window.clearTimeout(r.current),window.removeEventListener("keydown",k),window.removeEventListener("keyup",k)}},[]);const D=Ly(({first:k,active:L,delta:[N,z],movement:[O,K]})=>{k&&l(!0);const V=_f(O,-C,C),ne=_f(K,-A,A);i.current=Math.abs(O)>Math.abs(V)?Math.sign(O-V):0,s.current=Math.abs(K)>Math.abs(ne)?Math.sign(ne-K):0;let re=t[m],P=t[g];L?(i.current||(re+=N*_*o.current,d({x:V})),s.current||(P-=x*z*w*o.current,d({y:ne})),i.current||s.current?R():M(),n({[m]:re,[g]:P})):(l(!1),i.current=0,s.current=0,d({x:0,y:0}),M())});return Ge.createElement(d_e,Ri({ref:h},D()),a&&Ge.createElement(n8,null,Ge.createElement(h_e,{ref:p,isOutOfBounds:c},Ge.createElement("div",null),Ge.createElement("span",{ref:f}))))}const m_e=kn("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function g_e(){const{label:t,displayValue:e,onUpdate:n,settings:r}=oo();return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,t),Ge.createElement(m_e,{withJoystick:!!r.joystick},r.joystick&&Ge.createElement(p_e,{value:e,settings:r,onUpdate:n}),Ge.createElement(i8,{value:e,settings:r,onUpdate:n})))}const y_e=["joystick"],F$=f$(["x","y"]),v_e=t=>{let{joystick:e=!0}=t,n=$r(t,y_e);const{value:r,settings:i}=F$.normalize(n);return{value:r,settings:Dn(Dn({},i),{},{joystick:e})}};var x_e=Dn(Dn({component:g_e},F$),{},{normalize:v_e});const __e=t=>{if(t!==void 0){if(t instanceof File)try{return URL.createObjectURL(t)}catch{return}if(typeof t=="string"&&t.indexOf("blob:")===0)return t;throw Error("Invalid image format [undefined | blob |File].")}},b_e=(t,e)=>typeof e=="object"&&"image"in e,E_e=({image:t})=>({value:t});var w_e=Object.freeze({__proto__:null,sanitize:__e,schema:b_e,normalize:E_e});const S_e=kn("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),T_e=kn("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),A_e=kn("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),M_e=kn("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),C_e=kn("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),R_e=kn("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function I_e(){const{label:t,value:e,onUpdate:n,disabled:r}=oo(),{popinRef:i,wrapperRef:s,shown:o,show:a,hide:l}=D$(),c=v.useCallback(p=>{p.length&&n(p[0])},[n]),u=v.useCallback(p=>{p.stopPropagation(),n(void 0)},[n]),{getRootProps:f,getInputProps:d,isDragAccept:h}=I$({maxFiles:1,accept:"image/*",onDrop:c,disabled:r});return Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,t),Ge.createElement(S_e,null,Ge.createElement(A_e,{ref:i,hasImage:!!e,onPointerDown:()=>!!e&&a(),onPointerUp:l,style:{backgroundImage:e?`url(${e})`:"none"}}),o&&!!e&&Ge.createElement(n8,null,Ge.createElement(r$,{onPointerUp:l,style:{cursor:"pointer"}}),Ge.createElement(M_e,{ref:s,style:{backgroundImage:`url(${e})`}})),Ge.createElement(T_e,f({isDragAccept:h}),Ge.createElement("input",d()),Ge.createElement(C_e,null,h?"drop image":"click or drop")),Ge.createElement(R_e,{onClick:u,disabled:!e})))}var P_e=Dn({component:I_e},w_e);const pN=Vo().number(),k_e=(t,e)=>Vo().array().length(2).every.number().test(t)&&Vo().schema({min:pN,max:pN}).test(e),C_=t=>({min:t[0],max:t[1]}),U$=(t,{bounds:[e,n]},r)=>{const i=Array.isArray(t)?C_(t):t,s={min:r[0],max:r[1]},{min:o,max:a}=Dn(Dn({},s),i);return[_f(Number(o),e,Math.max(e,a)),_f(Number(a),Math.min(n,o),n)]},L_e=({value:t,min:e,max:n})=>{const r={min:e,max:n},i=u$(C_(t),{min:r,max:r}),s=[e,n],o=Dn(Dn({},i),{},{bounds:s});return{value:U$(C_(t),o,t),settings:o}};var D_e=Object.freeze({__proto__:null,schema:k_e,format:C_,sanitize:U$,normalize:L_e});const N_e=["value","bounds","onDrag"],O_e=["bounds"],F_e=kn("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function U_e(t){let{value:e,bounds:[n,r],onDrag:i}=t,s=$r(t,N_e);const o=v.useRef(null),a=v.useRef(null),l=v.useRef(null),c=v.useRef(0),u=Jc("sizes","scrubberWidth"),f=Ly(({event:p,first:m,xy:[g],movement:[y],memo:x={}})=>{if(m){const{width:w,left:T}=o.current.getBoundingClientRect();c.current=w-parseFloat(u);const S=(p==null?void 0:p.target)===a.current||(p==null?void 0:p.target)===l.current;x.pos=w_((g-T)/w,n,r);const C=Math.abs(x.pos-e.min)-Math.abs(x.pos-e.max);x.key=C<0||C===0&&x.pos<=e.min?"min":"max",S&&(x.pos=e[x.key])}const _=x.pos+w_(y/c.current,0,r-n);return i({[x.key]:f2e(_,s[x.key])}),x}),d=`calc(${E_(e.min,n,r)} * (100% - ${u} - 8px) + 4px)`,h=`calc(${1-E_(e.max,n,r)} * (100% - ${u} - 8px) + 4px)`;return Ge.createElement(a$,Ri({ref:o},f()),Ge.createElement(o$,null,Ge.createElement(l$,{style:{left:d,right:h}})),Ge.createElement(V5,{position:"left",ref:a,style:{left:d}}),Ge.createElement(V5,{position:"right",ref:l,style:{right:h}}))}function B_e(){const{label:t,displayValue:e,onUpdate:n,settings:r}=oo(),i=$r(r,O_e);return Ge.createElement(Ge.Fragment,null,Ge.createElement(tl,{input:!0},Ge.createElement(Cl,null,t),Ge.createElement(F_e,null,Ge.createElement(U_e,Ri({value:e},r,{onDrag:n})),Ge.createElement(i8,{value:e,settings:i,onUpdate:n,innerLabelTrim:0}))))}var z_e=Dn({component:B_e},D_e);const H_e=()=>{const t=new Map;return{on:(e,n)=>{let r=t.get(e);r===void 0&&(r=new Set,t.set(e,r)),r.add(n)},off:(e,n)=>{const r=t.get(e);r!==void 0&&(r.delete(n),r.size===0&&t.delete(e))},emit:(e,...n)=>{const r=t.get(e);if(r!==void 0)for(const i of r)i(...n)}}},G_e=["type","value"],j_e=["onChange","transient","onEditStart","onEditEnd"],V_e=function(){const e=u3e(f3e(()=>({data:{}}))),n=H_e();this.storeId=bve(),this.useStore=e;const r={},i=new Set;this.getVisiblePaths=()=>{const o=this.getData(),a=Object.keys(o),l=[];Object.entries(r).forEach(([u,f])=>{f.render&&a.some(d=>d.indexOf(u)===0)&&!f.render(this.get)&&l.push(u+".")});const c=[];return i.forEach(u=>{u in o&&o[u].__refCount>0&&l.every(f=>u.indexOf(f)===-1)&&(!o[u].render||o[u].render(this.get))&&c.push(u)}),c},this.setOrderedPaths=o=>{o.forEach(a=>i.add(a))},this.orderPaths=o=>(this.setOrderedPaths(o),o),this.disposePaths=o=>{e.setState(a=>{const l=a.data;return o.forEach(c=>{if(c in l){const u=l[c];u.__refCount--,u.__refCount===0&&u.type in ma&&delete l[c]}}),{data:l}})},this.dispose=()=>{e.setState(()=>({data:{}}))},this.getFolderSettings=o=>r[o]||{},this.getData=()=>e.getState().data,this.addData=(o,a)=>{e.setState(l=>{const c=l.data;return Object.entries(o).forEach(([u,f])=>{let d=c[u];if(d){const{type:h,value:p}=f,m=$r(f,G_e);h!==d.type?jc(_i.INPUT_TYPE_OVERRIDE,h):((d.__refCount===0||a)&&Object.assign(d,m),d.__refCount++)}else c[u]=Dn(Dn({},f),{},{__refCount:1})}),{data:c}})},this.setValueAtPath=(o,a,l)=>{e.setState(c=>{const u=c.data;return FD(u[o],a,o,this,l),{data:u}})},this.setSettingsAtPath=(o,a)=>{e.setState(l=>{const c=l.data;return c[o].settings=Dn(Dn({},c[o].settings),a),{data:c}})},this.disableInputAtPath=(o,a)=>{e.setState(l=>{const c=l.data;return c[o].disabled=a,{data:c}})},this.set=(o,a)=>{e.setState(l=>{const c=l.data;return Object.entries(o).forEach(([u,f])=>{try{FD(c[u],f,void 0,void 0,a)}catch{}}),{data:c}})},this.getInput=o=>{try{return this.getData()[o]}catch{jc(_i.PATH_DOESNT_EXIST,o)}},this.get=o=>{var a;return(a=this.getInput(o))===null||a===void 0?void 0:a.value},this.emitOnEditStart=o=>{n.emit(`onEditStart:${o}`,this.get(o),o,Dn(Dn({},this.getInput(o)),{},{get:this.get}))},this.emitOnEditEnd=o=>{n.emit(`onEditEnd:${o}`,this.get(o),o,Dn(Dn({},this.getInput(o)),{},{get:this.get}))},this.subscribeToEditStart=(o,a)=>{const l=`onEditStart:${o}`;return n.on(l,a),()=>n.off(l,a)},this.subscribeToEditEnd=(o,a)=>{const l=`onEditEnd:${o}`;return n.on(l,a),()=>n.off(l,a)};const s=(o,a,l)=>{const c={};return Object.entries(o).forEach(([u,f])=>{if(u==="")return jc(_i.EMPTY_KEY);let d=f8(a,u);if(f.type===ma.FOLDER){const h=s(f.schema,d,l);Object.assign(c,h),d in r||(r[d]=f.settings)}else if(u in l)jc(_i.DUPLICATE_KEYS,u,d,l[u].path);else{const h=Rve(f,u,d,c);if(h){const{type:p,options:m,input:g}=h,{onChange:y,transient:x,onEditStart:_,onEditEnd:w}=m,T=$r(m,j_e);c[d]=Dn(Dn(Dn({type:p},T),g),{},{fromPanel:!0}),l[u]={path:d,onChange:y,transient:x,onEditStart:_,onEditEnd:w}}else jc(_i.UNKNOWN_INPUT,d,f)}}),c};this.getDataFromSchema=o=>{const a={};return[s(o,"",a),a]}},B$=new V_e,W_e={collapsed:!1};function Yp(t,e){return{type:ma.FOLDER,schema:t,settings:Dn(Dn({},W_e),e)}}const $_e={disabled:!1};function Oy(t,e){return{type:ma.BUTTON,onClick:t,settings:Dn(Dn({},$_e),e)}}function mN(t){return{type:ma.BUTTON_GROUP,opts:t}}const gN=t=>"__levaInput"in t,X_e=(t,e)=>{const n={},r=e?e.toLowerCase():null;return t.forEach(i=>{const[s,o]=X3e(i);(!r||s.toLowerCase().indexOf(r)>-1)&&$3e(n,o,{[s]:{__levaInput:!0,path:i}})}),n},q_e=["type","label","path","valueKey","value","settings","setValue","disabled"];function Y_e(t){let{type:e,label:n,path:r,valueKey:i,value:s,settings:o,setValue:a,disabled:l}=t,c=$r(t,q_e);const{displayValue:u,onChange:f,onUpdate:d}=i$({type:e,value:s,settings:o,setValue:a}),h=qd[e].component;return h?Ge.createElement(qW.Provider,{value:Dn({key:i,path:r,id:""+r,label:n,displayValue:u,value:s,onChange:f,onUpdate:d,settings:o,setValue:a,disabled:l},c)},Ge.createElement(Yve,{disabled:l},Ge.createElement(h,null))):(jc(_i.NO_COMPONENT_FOR_TYPE,e,r),null)}const K_e=kn("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function Z_e({onClick:t,settings:e,label:n}){const r=ky();return Ge.createElement(tl,null,Ge.createElement(K_e,{disabled:e.disabled,onClick:()=>t(r.get)},n))}const Q_e=kn("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),J_e=kn("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),ebe=({label:t,opts:e})=>{let n=typeof t=="string"&&t.trim()===""?null:t,r=e;return typeof e.opts=="object"&&(r.label!==void 0&&(n=e.label),r=e.opts),{label:n,opts:r}};function tbe(t){const{label:e,opts:n}=ebe(t),r=ky();return Ge.createElement(tl,{input:!!e},e&&Ge.createElement(Cl,null,e),Ge.createElement(Q_e,null,Object.entries(n).map(([i,s])=>Ge.createElement(J_e,{key:i,onClick:()=>s(r.get)},i))))}const nbe=kn("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),z$=100;function rbe(t,e){t.push(e),t.length>z$&&t.shift()}const ibe=v.forwardRef(function({initialValue:t},e){const n=Jc("colors","highlight3"),r=Jc("colors","elevation2"),i=Jc("colors","highlight1"),[s,o]=v.useMemo(()=>[Eo(i).alpha(.4).toRgbString(),Eo(i).alpha(.1).toRgbString()],[i]),a=v.useRef([t]),l=v.useRef(t),c=v.useRef(t),u=v.useRef(),f=v.useCallback((p,m)=>{if(!p)return;const{width:g,height:y}=p,x=new Path2D,_=g/z$,w=y*.05;for(let C=0;C<a.current.length;C++){const A=E_(a.current[C],l.current,c.current),R=_*C,M=y-A*(y-w*2)-w;x.lineTo(R,M)}m.clearRect(0,0,g,y);const T=new Path2D(x);T.lineTo(_*(a.current.length+1),y),T.lineTo(0,y),T.lineTo(0,0);const S=m.createLinearGradient(0,0,0,y);S.addColorStop(0,s),S.addColorStop(1,o),m.fillStyle=S,m.fill(T),m.strokeStyle=r,m.lineJoin="round",m.lineWidth=14,m.stroke(x),m.strokeStyle=n,m.lineWidth=2,m.stroke(x)},[n,r,s,o]),[d,h]=i2e(f);return v.useImperativeHandle(e,()=>({frame:p=>{(l.current===void 0||p<l.current)&&(l.current=p),(c.current===void 0||p>c.current)&&(c.current=p),rbe(a.current,p),u.current=requestAnimationFrame(()=>f(d.current,h.current))}}),[d,h,f]),v.useEffect(()=>()=>cancelAnimationFrame(u.current),[]),Ge.createElement(nbe,{ref:d})}),yN=t=>Number.isFinite(t)?t.toPrecision(2):t.toString(),sbe=v.forwardRef(function({initialValue:t},e){const[n,r]=v.useState(yN(t));return v.useImperativeHandle(e,()=>({frame:i=>r(yN(i))}),[]),Ge.createElement("div",null,n)});function vN(t){return typeof t=="function"?t():t.current}function obe({label:t,objectOrFn:e,settings:n}){const r=v.useRef(),i=v.useRef(vN(e));return v.useEffect(()=>{const s=window.setInterval(()=>{var o;document.hidden||(o=r.current)===null||o===void 0||o.frame(vN(e))},n.interval);return()=>window.clearInterval(s)},[e,n.interval]),Ge.createElement(tl,{input:!0},Ge.createElement(Cl,{align:"top"},t),n.graph?Ge.createElement(ibe,{ref:r,initialValue:i.current}):Ge.createElement(sbe,{ref:r,initialValue:i.current}))}const abe=["type","label","key"],lbe={[ma.BUTTON]:Z_e,[ma.BUTTON_GROUP]:tbe,[ma.MONITOR]:obe},cbe=Ge.memo(({path:t})=>{const[e,{set:n,setSettings:r,disable:i,storeId:s,emitOnEditStart:o,emitOnEditEnd:a}]=o2e(t);if(!e)return null;const{type:l,label:c,key:u}=e,f=$r(e,abe);if(l in ma){const d=lbe[l];return Ge.createElement(d,Ri({label:c,path:t},f))}return l in qd?Ge.createElement(Y_e,Ri({key:s+t,type:l,label:c,storeId:s,path:t,valueKey:u,setValue:n,setSettings:r,disable:i,emitOnEditStart:o,emitOnEditEnd:a},f)):(hve(_i.UNSUPPORTED_INPUT,l,t),null)});function ube({toggle:t,toggled:e,name:n}){return Ge.createElement($ve,{onClick:()=>t()},Ge.createElement(r8,{toggled:e}),Ge.createElement("div",null,n))}const fbe=({name:t,path:e,tree:n})=>{const r=ky(),i=f8(e,t),{collapsed:s,color:o}=r.getFolderSettings(i),[a,l]=v.useState(!s),c=v.useRef(null),u=Jc("colors","folderWidgetColor"),f=Jc("colors","folderTextColor");return v.useLayoutEffect(()=>{c.current.style.setProperty("--leva-colors-folderWidgetColor",o||u),c.current.style.setProperty("--leva-colors-folderTextColor",o||f)},[o,u,f]),Ge.createElement(S_,{ref:c},Ge.createElement(ube,{name:t,toggled:a,toggle:()=>l(d=>!d)}),Ge.createElement(H$,{parent:i,tree:n,toggled:a}))},H$=Ge.memo(({isRoot:t=!1,fill:e=!1,flat:n=!1,parent:r,tree:i,toggled:s})=>{const{wrapperRef:o,contentRef:a}=K3e(s),l=ky(),c=([f,d])=>{var h;return(gN(d)?(h=l.getInput(d.path))===null||h===void 0?void 0:h.order:l.getFolderSettings(f8(r,f)).order)||0},u=Object.entries(i).sort((f,d)=>c(f)-c(d));return Ge.createElement(G5,{ref:o,isRoot:t,fill:e,flat:n},Ge.createElement(e$,{ref:a,isRoot:t,toggled:s},u.map(([f,d])=>gN(d)?Ge.createElement(cbe,{key:d.path,valueKey:d.valueKey,path:d.path}):Ge.createElement(fbe,{key:f,name:f,path:r,tree:d}))))}),dbe=kn("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${n$}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),G$=40,R_=kn("i",{$flexCenter:"",width:G$,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),hbe=kn("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),pbe=kn("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${R_}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),mbe=kn("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),gbe=kn("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:G$}}}}),ybe=Ge.forwardRef(({setFilter:t,toggle:e},n)=>{const[r,i]=v.useState(""),s=v.useMemo(()=>GW(t,250),[t]),o=()=>{t(""),i("")},a=l=>{const c=l.currentTarget.value;e(!0),i(c)};return v.useEffect(()=>{s(r)},[r,s]),Ge.createElement(Ge.Fragment,null,Ge.createElement(mbe,{ref:n,value:r,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:l=>l.stopPropagation(),onChange:a}),Ge.createElement(R_,{onClick:()=>o(),style:{visibility:r?"visible":"hidden"}},Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},Ge.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function vbe({setFilter:t,onDrag:e,onDragStart:n,onDragEnd:r,toggle:i,toggled:s,title:o,drag:a,filterEnabled:l,from:c}){const[u,f]=v.useState(!1),d=v.useRef(null);v.useEffect(()=>{var p,m;u?(p=d.current)===null||p===void 0||p.focus():(m=d.current)===null||m===void 0||m.blur()},[u]);const h=Ly(({offset:[p,m],first:g,last:y})=>{e({x:p,y:m}),g&&n({x:p,y:m}),y&&r({x:p,y:m})},{filterTaps:!0,from:({offset:[p,m]})=>[(c==null?void 0:c.x)||p,(c==null?void 0:c.y)||m]});return v.useEffect(()=>{const p=m=>{m.key==="L"&&m.shiftKey&&m.metaKey&&f(g=>!g)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[]),Ge.createElement(Ge.Fragment,null,Ge.createElement(hbe,{mode:a?"drag":void 0},Ge.createElement(R_,{active:!s,onClick:()=>i()},Ge.createElement(r8,{toggled:s,width:12,height:8})),Ge.createElement(gbe,Ri({},a?h():{},{drag:a,filterEnabled:l}),o===void 0&&a?Ge.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},Ge.createElement("circle",{cx:"2",cy:"2",r:"2"}),Ge.createElement("circle",{cx:"14",cy:"2",r:"2"}),Ge.createElement("circle",{cx:"26",cy:"2",r:"2"}),Ge.createElement("circle",{cx:"2",cy:"12",r:"2"}),Ge.createElement("circle",{cx:"14",cy:"12",r:"2"}),Ge.createElement("circle",{cx:"26",cy:"12",r:"2"})):o),l&&Ge.createElement(R_,{active:u,onClick:()=>f(p=>!p)},Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},Ge.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),Ge.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),Ge.createElement(pbe,{toggled:u},Ge.createElement(ybe,{ref:d,setFilter:t,toggle:i})))}const xbe=["store","hidden","theme","collapsed"];function _be(t){let{store:e,hidden:n=!1,theme:r,collapsed:i=!1}=t,s=$r(t,xbe);const o=L$(()=>zve(r),[r]),[a,l]=v.useState(!i),c=typeof i=="object"?!i.collapsed:a,u=v.useMemo(()=>typeof i=="object"?f=>{typeof f=="function"?i.onChange(!f(!i.collapsed)):i.onChange(!f)}:l,[i]);return!e||n?null:Ge.createElement(e8.Provider,{value:o},Ge.createElement(bbe,Ri({store:e},s,{toggled:c,setToggle:u,rootClass:o.className})))}const bbe=Ge.memo(({store:t,rootClass:e,fill:n=!1,flat:r=!1,neverHide:i=!1,oneLineLabels:s=!1,titleBar:o={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:a=!1,toggled:l,setToggle:c})=>{var u,f;const d=Z3e(t),[h,p]=v.useState(""),m=v.useMemo(()=>X_e(d,h),[d,h]),[g,y]=s$(),x=i||d.length>0,_=typeof o=="object"&&o.title||void 0,w=typeof o=="object"&&(u=o.drag)!==null&&u!==void 0?u:!0,T=typeof o=="object"&&(f=o.filter)!==null&&f!==void 0?f:!0,S=typeof o=="object"&&o.position||void 0,C=typeof o=="object"&&o.onDrag||void 0,A=typeof o=="object"&&o.onDragStart||void 0,R=typeof o=="object"&&o.onDragEnd||void 0;return Ge.useEffect(()=>{y({x:S==null?void 0:S.x,y:S==null?void 0:S.y})},[S,y]),Bve(),Ge.createElement(KW.Provider,{value:{hideCopyButton:a}},Ge.createElement(dbe,{ref:g,className:e,fill:n,flat:r,oneLineLabels:s,hideTitleBar:!o,style:{display:x?"block":"none"}},o&&Ge.createElement(vbe,{onDrag:M=>{y(M),C==null||C(M)},onDragStart:M=>A==null?void 0:A(M),onDragEnd:M=>R==null?void 0:R(M),setFilter:p,toggle:M=>c(D=>M??!D),toggled:l,title:_,drag:w,filterEnabled:T,from:S}),x&&Ge.createElement(YW.Provider,{value:t},Ge.createElement(H$,{isRoot:!0,fill:n,flat:r,tree:m,toggled:l}))))}),Ebe=["isRoot"];let I_=!1,wd=null;function j$(t){let{isRoot:e=!1}=t,n=$r(t,Ebe);return v.useEffect(()=>(I_=!0,!e&&wd&&(wd.remove(),wd=null),()=>{e||(I_=!1)}),[e]),Ge.createElement(_be,Ri({store:B$},n))}function wbe(t){v.useEffect(()=>{t&&!I_&&(wd||(wd=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(wd),Pve(Ge.createElement(j$,{isRoot:!0}),wd))),I_=!0)},[t])}function Sbe(t,e,n,r,i){let s,o,a,l,c;return typeof t=="string"?(o=t,s=e,Array.isArray(n)?c=n:n&&("store"in n?(l=n,c=r):(a=n,Array.isArray(r)?c=r:(l=r,c=i)))):(s=t,Array.isArray(e)?c=e:(l=e,c=n)),{schema:s,folderName:o,folderSettings:a,hookSettings:l,deps:c||[]}}function vr(t,e,n,r,i){const{folderName:s,schema:o,folderSettings:a,hookSettings:l,deps:c}=Sbe(t,e,n,r,i),u=typeof o=="function",f=v.useRef(!1),d=v.useRef(!0),h=L$(()=>{f.current=!0;const D=typeof o=="function"?o():o;return s?{[s]:Yp(D,a)}:D},c),p=!(l!=null&&l.store);wbe(p);const[m]=v.useState(()=>(l==null?void 0:l.store)||B$),[g,y]=v.useMemo(()=>m.getDataFromSchema(h),[m,h]),[x,_,w,T,S]=v.useMemo(()=>{const D=[],k=[],L={},N={},z={};return Object.values(y).forEach(({path:O,onChange:K,onEditStart:V,onEditEnd:ne,transient:re})=>{D.push(O),K?(L[O]=K,re||k.push(O)):k.push(O),V&&(N[O]=V),ne&&(z[O]=ne)}),[D,k,L,N,z]},[y]),C=v.useMemo(()=>m.orderPaths(x),[x,m]),A=Q3e(m,_,g),R=v.useCallback(D=>{const k=Object.entries(D).reduce((L,[N,z])=>Object.assign(L,{[y[N].path]:z}),{});m.set(k,!1)},[m,y]),M=v.useCallback(D=>m.get(y[D].path),[m,y]);return v.useEffect(()=>{const D=!d.current&&f.current;return m.addData(g,D),d.current=!1,f.current=!1,()=>m.disposePaths(C)},[m,C,g]),v.useEffect(()=>{const D=[];return Object.entries(w).forEach(([k,L])=>{L(m.get(k),k,Dn({initial:!0,get:m.get},m.getInput(k)));const N=m.useStore.subscribe(z=>{const O=z.data[k];return[O.disabled?void 0:O.value,O]},([z,O])=>L(z,k,Dn({initial:!1,get:m.get},O)),{equalityFn:lE});D.push(N)}),()=>D.forEach(k=>k())},[m,w]),v.useEffect(()=>{const D=[];return Object.entries(T).forEach(([k,L])=>D.push(m.subscribeToEditStart(k,L))),Object.entries(S).forEach(([k,L])=>D.push(m.subscribeToEditEnd(k,L))),()=>D.forEach(k=>k())},[T,S,m]),u?[A,R,M]:A}pu(El.SELECT,w2e);pu(El.IMAGE,P_e);pu(El.NUMBER,h2e);pu(El.COLOR,c_e);pu(El.STRING,k2e);pu(El.BOOLEAN,B2e);pu(El.INTERVAL,z_e);pu(El.VECTOR3D,f_e);pu(El.VECTOR2D,x_e);var CT=v,Tbe=function(t){return typeof t=="function"},Abe=function(t){var e=CT.useState(t),n=e[0],r=e[1],i=CT.useRef(n),s=CT.useCallback(function(o){i.current=Tbe(o)?o(i.current):o,r(i.current)},[]);return[n,s,i]},Mbe=Abe;const V$=Zd(Mbe);var W$={},t0={},Rl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isEventSourceSupported=t.isReactNative=t.ReadyState=t.DEFAULT_HEARTBEAT=t.UNPARSABLE_JSON_OBJECT=t.DEFAULT_RECONNECT_INTERVAL_MS=t.DEFAULT_RECONNECT_LIMIT=t.SOCKET_IO_PING_CODE=t.SOCKET_IO_PATH=t.SOCKET_IO_PING_INTERVAL=t.DEFAULT_EVENT_SOURCE_OPTIONS=t.EMPTY_EVENT_HANDLERS=t.DEFAULT_OPTIONS=void 0;var e=1,n=1e3*e;t.DEFAULT_OPTIONS={},t.EMPTY_EVENT_HANDLERS={},t.DEFAULT_EVENT_SOURCE_OPTIONS={withCredentials:!1,events:t.EMPTY_EVENT_HANDLERS},t.SOCKET_IO_PING_INTERVAL=25*n,t.SOCKET_IO_PATH="/socket.io/?EIO=3&transport=websocket",t.SOCKET_IO_PING_CODE="2",t.DEFAULT_RECONNECT_LIMIT=20,t.DEFAULT_RECONNECT_INTERVAL_MS=5e3,t.UNPARSABLE_JSON_OBJECT={},t.DEFAULT_HEARTBEAT={message:"ping",timeout:6e4,interval:25e3};var r;(function(s){s[s.UNINSTANTIATED=-1]="UNINSTANTIATED",s[s.CONNECTING=0]="CONNECTING",s[s.OPEN=1]="OPEN",s[s.CLOSING=2]="CLOSING",s[s.CLOSED=3]="CLOSED"})(r||(t.ReadyState=r={}));var i=function(){try{return"EventSource"in globalThis}catch{return!1}};t.isReactNative=typeof navigator<"u"&&navigator.product==="ReactNative",t.isEventSourceSupported=!t.isReactNative&&i()})(Rl);var yE={},vE={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.resetWebSockets=t.sharedWebSockets=void 0,t.sharedWebSockets={};var e=function(n){if(n&&t.sharedWebSockets.hasOwnProperty(n))delete t.sharedWebSockets[n];else for(var r in t.sharedWebSockets)t.sharedWebSockets.hasOwnProperty(r)&&delete t.sharedWebSockets[r]};t.resetWebSockets=e})(vE);var xE={},rc={};Object.defineProperty(rc,"__esModule",{value:!0});rc.setUpSocketIOPing=rc.appendQueryParams=rc.parseSocketIOUrl=void 0;var P_=Rl,Cbe=function(t){if(t){var e=/^https|wss/.test(t),n=t.replace(/^(https?|wss?)(:\/\/)?/,""),r=n.replace(/\/$/,""),i=e?"wss":"ws";return"".concat(i,"://").concat(r).concat(P_.SOCKET_IO_PATH)}else if(t===""){var e=/^https/.test(window.location.protocol),i=e?"wss":"ws",s=window.location.port?":".concat(window.location.port):"";return"".concat(i,"://").concat(window.location.hostname).concat(s).concat(P_.SOCKET_IO_PATH)}return t};rc.parseSocketIOUrl=Cbe;var Rbe=function(t,e){e===void 0&&(e={});var n=/\?([\w]+=[\w]+)/,r=n.test(t),i="".concat(Object.entries(e).reduce(function(s,o){var a=o[0],l=o[1];return s+"".concat(a,"=").concat(l,"&")},"").slice(0,-1));return"".concat(t).concat(r?"&":"?").concat(i)};rc.appendQueryParams=Rbe;var Ibe=function(t,e){e===void 0&&(e=P_.SOCKET_IO_PING_INTERVAL);var n=function(){return t(P_.SOCKET_IO_PING_CODE)};return window.setInterval(n,e)};rc.setUpSocketIOPing=Ibe;var _E={};Object.defineProperty(_E,"__esModule",{value:!0});_E.heartbeat=Pbe;var RT=Rl;function Pbe(t,e,n){var r=n||{},i=r.interval,s=i===void 0?RT.DEFAULT_HEARTBEAT.interval:i,o=r.timeout,a=o===void 0?RT.DEFAULT_HEARTBEAT.timeout:o,l=r.message,c=l===void 0?RT.DEFAULT_HEARTBEAT.message:l,u=setInterval(function(){if(e.current+a<=Date.now())console.warn("Heartbeat timed out, closing connection, last message was seen ".concat(Date.now()-e.current,"ms ago")),t.close();else if(e.current+s<=Date.now())try{typeof c=="function"?t.send(c()):t.send(c)}catch(f){console.error("Heartbeat failed, closing connection",f instanceof Error?f.message:f),t.close()}},s);return t.addEventListener("close",function(){clearInterval(u)}),function(){}}var n0={},bE={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.resetSubscribers=t.removeSubscriber=t.addSubscriber=t.hasSubscribers=t.getSubscribers=void 0;var e={},n=[],r=function(l){return(0,t.hasSubscribers)(l)?Array.from(e[l]):n};t.getSubscribers=r;var i=function(l){var c;return((c=e[l])===null||c===void 0?void 0:c.size)>0};t.hasSubscribers=i;var s=function(l,c){e[l]=e[l]||new Set,e[l].add(c)};t.addSubscriber=s;var o=function(l,c){e[l].delete(c)};t.removeSubscriber=o;var a=function(l){if(l&&e.hasOwnProperty(l))delete e[l];else for(var c in e)e.hasOwnProperty(c)&&delete e[c]};t.resetSubscribers=a})(bE);Object.defineProperty(n0,"__esModule",{value:!0});n0.assertIsWebSocket=Dbe;n0.resetGlobalState=Nbe;var kbe=vE,Lbe=bE;function Dbe(t,e){if(!e&&!(t instanceof WebSocket))throw new Error("")}function Nbe(t){(0,Lbe.resetSubscribers)(t),(0,kbe.resetWebSockets)(t)}var k_=pi&&pi.__assign||function(){return k_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},k_.apply(this,arguments)};Object.defineProperty(xE,"__esModule",{value:!0});xE.attachListeners=void 0;var Obe=rc,Fbe=_E,Jl=Rl,Ube=n0,Bbe=function(t,e,n,r){t.onmessage=function(i){var s;e.current.onMessage&&e.current.onMessage(i),typeof(r==null?void 0:r.current)=="number"&&(r.current=Date.now()),!(typeof e.current.filter=="function"&&e.current.filter(i)!==!0)&&(e.current.heartbeat&&typeof e.current.heartbeat!="boolean"&&((s=e.current.heartbeat)===null||s===void 0?void 0:s.returnMessage)===i.data||n(i))}},zbe=function(t,e,n,r,i){t.onopen=function(s){if(e.current.onOpen&&e.current.onOpen(s),r.current=0,n(Jl.ReadyState.OPEN),e.current.heartbeat&&t instanceof WebSocket){var o=typeof e.current.heartbeat=="boolean"?void 0:e.current.heartbeat;i.current=Date.now(),(0,Fbe.heartbeat)(t,i,o)}}},Hbe=function(t,e,n,r,i){if(Jl.isEventSourceSupported&&t instanceof EventSource)return function(){};(0,Ube.assertIsWebSocket)(t,e.current.skipAssert);var s;return t.onclose=function(o){var a;if(e.current.onClose&&e.current.onClose(o),n(Jl.ReadyState.CLOSED),e.current.shouldReconnect&&e.current.shouldReconnect(o)){var l=(a=e.current.reconnectAttempts)!==null&&a!==void 0?a:Jl.DEFAULT_RECONNECT_LIMIT;if(i.current<l){var c=typeof e.current.reconnectInterval=="function"?e.current.reconnectInterval(i.current):e.current.reconnectInterval;s=window.setTimeout(function(){i.current++,r()},c??Jl.DEFAULT_RECONNECT_INTERVAL_MS)}else e.current.onReconnectStop&&e.current.onReconnectStop(l),console.warn("Max reconnect attempts of ".concat(l," exceeded"))}},function(){return s&&window.clearTimeout(s)}},Gbe=function(t,e,n,r,i){var s;return t.onerror=function(o){var a;if(e.current.onError&&e.current.onError(o),Jl.isEventSourceSupported&&t instanceof EventSource&&(e.current.onClose&&e.current.onClose(k_(k_({},o),{code:1006,reason:"An error occurred with the EventSource: ".concat(o),wasClean:!1})),n(Jl.ReadyState.CLOSED),t.close()),e.current.retryOnError)if(i.current<((a=e.current.reconnectAttempts)!==null&&a!==void 0?a:Jl.DEFAULT_RECONNECT_LIMIT)){var l=typeof e.current.reconnectInterval=="function"?e.current.reconnectInterval(i.current):e.current.reconnectInterval;s=window.setTimeout(function(){i.current++,r()},l??Jl.DEFAULT_RECONNECT_INTERVAL_MS)}else e.current.onReconnectStop&&e.current.onReconnectStop(e.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(e.current.reconnectAttempts," exceeded"))},function(){return s&&window.clearTimeout(s)}},jbe=function(t,e,n,r,i,s,o){var a=e.setLastMessage,l=e.setReadyState,c,u,f;return n.current.fromSocketIO&&(c=(0,Obe.setUpSocketIOPing)(o)),Bbe(t,n,a,s),zbe(t,n,l,i,s),u=Hbe(t,n,l,r,i),f=Gbe(t,n,l,r,i),function(){l(Jl.ReadyState.CLOSING),u(),f(),t.close(),c&&clearInterval(c)}};xE.attachListeners=jbe;var EE={},L_=pi&&pi.__assign||function(){return L_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},L_.apply(this,arguments)};Object.defineProperty(EE,"__esModule",{value:!0});EE.attachSharedListeners=void 0;var Vbe=vE,kd=Rl,Q1=bE,Wbe=rc,$be=_E,Xbe=function(t,e,n){t.onmessage=function(r){(0,Q1.getSubscribers)(e).forEach(function(i){var s;i.optionsRef.current.onMessage&&i.optionsRef.current.onMessage(r),typeof((s=i==null?void 0:i.lastMessageTime)===null||s===void 0?void 0:s.current)=="number"&&(i.lastMessageTime.current=Date.now()),!(typeof i.optionsRef.current.filter=="function"&&i.optionsRef.current.filter(r)!==!0)&&(n&&typeof n!="boolean"&&(n==null?void 0:n.returnMessage)===r.data||i.setLastMessage(r))})}},qbe=function(t,e,n){t.onopen=function(r){(0,Q1.getSubscribers)(e).forEach(function(i){i.reconnectCount.current=0,i.optionsRef.current.onOpen&&i.optionsRef.current.onOpen(r),i.setReadyState(kd.ReadyState.OPEN),n&&t instanceof WebSocket&&(i.lastMessageTime.current=Date.now(),(0,$be.heartbeat)(t,i.lastMessageTime,typeof n=="boolean"?void 0:n))})}},Ybe=function(t,e){t instanceof WebSocket&&(t.onclose=function(n){(0,Q1.getSubscribers)(e).forEach(function(r){r.optionsRef.current.onClose&&r.optionsRef.current.onClose(n),r.setReadyState(kd.ReadyState.CLOSED)}),delete Vbe.sharedWebSockets[e],(0,Q1.getSubscribers)(e).forEach(function(r){var i;if(r.optionsRef.current.shouldReconnect&&r.optionsRef.current.shouldReconnect(n)){var s=(i=r.optionsRef.current.reconnectAttempts)!==null&&i!==void 0?i:kd.DEFAULT_RECONNECT_LIMIT;if(r.reconnectCount.current<s){var o=typeof r.optionsRef.current.reconnectInterval=="function"?r.optionsRef.current.reconnectInterval(r.reconnectCount.current):r.optionsRef.current.reconnectInterval;setTimeout(function(){r.reconnectCount.current++,r.reconnect.current()},o??kd.DEFAULT_RECONNECT_INTERVAL_MS)}else r.optionsRef.current.onReconnectStop&&r.optionsRef.current.onReconnectStop(r.optionsRef.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(s," exceeded"))}})})},Kbe=function(t,e){t.onerror=function(n){(0,Q1.getSubscribers)(e).forEach(function(r){r.optionsRef.current.onError&&r.optionsRef.current.onError(n),kd.isEventSourceSupported&&t instanceof EventSource&&(r.optionsRef.current.onClose&&r.optionsRef.current.onClose(L_(L_({},n),{code:1006,reason:"An error occurred with the EventSource: ".concat(n),wasClean:!1})),r.setReadyState(kd.ReadyState.CLOSED))}),kd.isEventSourceSupported&&t instanceof EventSource&&t.close()}},Zbe=function(t,e,n,r){var i;return n.current.fromSocketIO&&(i=(0,Wbe.setUpSocketIOPing)(r)),Xbe(t,e,n.current.heartbeat),Ybe(t,e),qbe(t,e,n.current.heartbeat),Kbe(t,e),function(){i&&clearInterval(i)}};EE.attachSharedListeners=Zbe;Object.defineProperty(yE,"__esModule",{value:!0});yE.createOrJoinSocket=void 0;var Xu=vE,Qg=Rl,Qbe=xE,Jbe=EE,rM=bE,eEe=function(t,e,n,r,i){return function(){if((0,rM.removeSubscriber)(t,e),!(0,rM.hasSubscribers)(t)){try{var s=Xu.sharedWebSockets[t];s instanceof WebSocket&&(s.onclose=function(o){n.current.onClose&&n.current.onClose(o),r(Qg.ReadyState.CLOSED)}),s.close()}catch{}i&&i(),delete Xu.sharedWebSockets[t]}}},tEe=function(t,e,n,r,i,s,o,a,l){if(!Qg.isEventSourceSupported&&r.current.eventSourceOptions)throw Qg.isReactNative?new Error("EventSource is not supported in ReactNative"):new Error("EventSource is not supported");if(r.current.share){var c=null;Xu.sharedWebSockets[e]===void 0?(Xu.sharedWebSockets[e]=r.current.eventSourceOptions?new EventSource(e,r.current.eventSourceOptions):new WebSocket(e,r.current.protocols),t.current=Xu.sharedWebSockets[e],n(Qg.ReadyState.CONNECTING),c=(0,Jbe.attachSharedListeners)(Xu.sharedWebSockets[e],e,r,l)):(t.current=Xu.sharedWebSockets[e],n(Xu.sharedWebSockets[e].readyState));var u={setLastMessage:i,setReadyState:n,optionsRef:r,reconnectCount:o,lastMessageTime:a,reconnect:s};return(0,rM.addSubscriber)(e,u),eEe(e,u,r,n,c)}else{if(t.current=r.current.eventSourceOptions?new EventSource(e,r.current.eventSourceOptions):new WebSocket(e,r.current.protocols),n(Qg.ReadyState.CONNECTING),!t.current)throw new Error("WebSocket failed to be created");return(0,Qbe.attachListeners)(t.current,{setLastMessage:i,setReadyState:n},r,s.current,o,a,l)}};yE.createOrJoinSocket=tEe;var $$={};(function(t){var e=pi&&pi.__awaiter||function(l,c,u,f){function d(h){return h instanceof u?h:new u(function(p){p(h)})}return new(u||(u=Promise))(function(h,p){function m(x){try{y(f.next(x))}catch(_){p(_)}}function g(x){try{y(f.throw(x))}catch(_){p(_)}}function y(x){x.done?h(x.value):d(x.value).then(m,g)}y((f=f.apply(l,c||[])).next())})},n=pi&&pi.__generator||function(l,c){var u={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},f,d,h,p=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return p.next=m(0),p.throw=m(1),p.return=m(2),typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function m(y){return function(x){return g([y,x])}}function g(y){if(f)throw new TypeError("Generator is already executing.");for(;p&&(p=0,y[0]&&(u=0)),u;)try{if(f=1,d&&(h=y[0]&2?d.return:y[0]?d.throw||((h=d.return)&&h.call(d),0):d.next)&&!(h=h.call(d,y[1])).done)return h;switch(d=0,h&&(y=[y[0]&2,h.value]),y[0]){case 0:case 1:h=y;break;case 4:return u.label++,{value:y[1],done:!1};case 5:u.label++,d=y[1],y=[0];continue;case 7:y=u.ops.pop(),u.trys.pop();continue;default:if(h=u.trys,!(h=h.length>0&&h[h.length-1])&&(y[0]===6||y[0]===2)){u=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){u.label=y[1];break}if(y[0]===6&&u.label<h[1]){u.label=h[1],h=y;break}if(h&&u.label<h[2]){u.label=h[2],u.ops.push(y);break}h[2]&&u.ops.pop(),u.trys.pop();continue}y=c.call(l,u)}catch(x){y=[6,x],d=0}finally{f=h=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},r=pi&&pi.__spreadArray||function(l,c,u){if(u||arguments.length===2)for(var f=0,d=c.length,h;f<d;f++)(h||!(f in c))&&(h||(h=Array.prototype.slice.call(c,0,f)),h[f]=c[f]);return l.concat(h||Array.prototype.slice.call(c))};Object.defineProperty(t,"__esModule",{value:!0}),t.getUrl=void 0;var i=rc,s=Rl,o=function(l){return new Promise(function(c){return window.setTimeout(c,l)})},a=function(l,c){for(var u=[],f=2;f<arguments.length;f++)u[f-2]=arguments[f];return e(void 0,r([l,c],u,!0),void 0,function(d,h,p){var m,g,y,x,_,w,T,S;return p===void 0&&(p=0),n(this,function(C){switch(C.label){case 0:if(typeof d!="function")return[3,10];C.label=1;case 1:return C.trys.push([1,3,,9]),[4,d()];case 2:return m=C.sent(),[3,9];case 3:return C.sent(),h.current.retryOnError?(g=(w=h.current.reconnectAttempts)!==null&&w!==void 0?w:s.DEFAULT_RECONNECT_LIMIT,p<g?(y=typeof h.current.reconnectInterval=="function"?h.current.reconnectInterval(p):h.current.reconnectInterval,[4,o(y??s.DEFAULT_RECONNECT_INTERVAL_MS)]):[3,5]):[3,7];case 4:return C.sent(),[2,(0,t.getUrl)(d,h,p+1)];case 5:return(S=(T=h.current).onReconnectStop)===null||S===void 0||S.call(T,p),[2,null];case 6:return[3,8];case 7:return[2,null];case 8:return[3,9];case 9:return[3,11];case 10:m=d,C.label=11;case 11:return x=h.current.fromSocketIO?(0,i.parseSocketIOUrl)(m):m,_=h.current.queryParams?(0,i.appendQueryParams)(x,h.current.queryParams):x,[2,_]}})})};t.getUrl=a})($$);var X$={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.websocketWrapper=void 0;var e=function(n,r){return new Proxy(n,{get:function(i,s){var o=i[s];return s==="reconnect"?r:typeof o=="function"?(console.error("Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket."),function(){}):o},set:function(i,s,o){return/^on/.test(s)?(console.warn("The websocket's event handlers should be defined through the options object passed into useWebSocket."),!1):(i[s]=o,!0)}})};t.websocketWrapper=e,t.default=t.websocketWrapper})(X$);var qu=pi&&pi.__assign||function(){return qu=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},qu.apply(this,arguments)},nEe=pi&&pi.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})},rEe=pi&&pi.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},iEe=pi&&pi.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t0,"__esModule",{value:!0});t0.useWebSocket=void 0;var Qs=v,IT=r6,zl=Rl,sEe=yE,oEe=$$,aEe=iEe(X$),xN=n0,lEe=function(t,e,n){e===void 0&&(e=zl.DEFAULT_OPTIONS),n===void 0&&(n=!0);var r=(0,Qs.useState)(null),i=r[0],s=r[1],o=(0,Qs.useState)({}),a=o[0],l=o[1],c=(0,Qs.useMemo)(function(){if(i)try{return JSON.parse(i.data)}catch{return zl.UNPARSABLE_JSON_OBJECT}return null},[i]),u=(0,Qs.useRef)(null),f=(0,Qs.useRef)(null),d=(0,Qs.useRef)(function(){}),h=(0,Qs.useRef)(0),p=(0,Qs.useRef)(Date.now()),m=(0,Qs.useRef)([]),g=(0,Qs.useRef)(null),y=(0,Qs.useRef)(e);y.current=e;var x=u.current&&a[u.current]!==void 0?a[u.current]:t!==null&&n===!0?zl.ReadyState.CONNECTING:zl.ReadyState.UNINSTANTIATED,_=e.queryParams?JSON.stringify(e.queryParams):null,w=(0,Qs.useCallback)(function(C,A){var R;if(A===void 0&&(A=!0),zl.isEventSourceSupported&&f.current instanceof EventSource){console.warn("Unable to send a message from an eventSource");return}((R=f.current)===null||R===void 0?void 0:R.readyState)===zl.ReadyState.OPEN?((0,xN.assertIsWebSocket)(f.current,y.current.skipAssert),f.current.send(C)):A&&m.current.push(C)},[]),T=(0,Qs.useCallback)(function(C,A){A===void 0&&(A=!0),w(JSON.stringify(C),A)},[w]),S=(0,Qs.useCallback)(function(){return y.current.share!==!0||zl.isEventSourceSupported&&f.current instanceof EventSource?f.current:(g.current===null&&f.current&&((0,xN.assertIsWebSocket)(f.current,y.current.skipAssert),g.current=(0,aEe.default)(f.current,d)),g.current)},[]);return(0,Qs.useEffect)(function(){if(t!==null&&n===!0){var C,A=!1,R=!0,M=function(){return nEe(void 0,void 0,void 0,function(){var D,k,L;return rEe(this,function(N){switch(N.label){case 0:return D=u,[4,(0,oEe.getUrl)(t,y)];case 1:return D.current=N.sent(),u.current===null?(console.error("Failed to get a valid URL. WebSocket connection aborted."),u.current="ABORTED",(0,IT.flushSync)(function(){return l(function(z){return qu(qu({},z),{ABORTED:zl.ReadyState.CLOSED})})}),[2]):(k=function(z){A||(0,IT.flushSync)(function(){return s(z)})},L=function(z){A||(0,IT.flushSync)(function(){return l(function(O){var K;return qu(qu({},O),u.current&&(K={},K[u.current]=z,K))})})},R&&(C=(0,sEe.createOrJoinSocket)(f,u.current,L,y,k,d,h,p,w)),[2])}})})};return d.current=function(){A||(g.current&&(g.current=null),C==null||C(),M())},M(),function(){A=!0,R=!1,g.current&&(g.current=null),C==null||C(),s(null)}}else(t===null||n===!1)&&(h.current=0,l(function(D){var k;return qu(qu({},D),u.current&&(k={},k[u.current]=zl.ReadyState.CLOSED,k))}))},[t,n,_,w]),(0,Qs.useEffect)(function(){x===zl.ReadyState.OPEN&&m.current.splice(0).forEach(function(C){w(C)})},[x]),{sendMessage:w,sendJsonMessage:T,lastMessage:i,lastJsonMessage:c,readyState:x,getWebSocket:S}};t0.useWebSocket=lEe;var wE={},D_=pi&&pi.__assign||function(){return D_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},D_.apply(this,arguments)};Object.defineProperty(wE,"__esModule",{value:!0});wE.useSocketIO=void 0;var _N=v,cEe=t0,uEe=Rl,PT={type:"empty",payload:null},fEe=function(t){if(!t||!t.data)return PT;var e=t.data.match(/\[.*]/);if(!e)return PT;var n=JSON.parse(e);return!Array.isArray(n)||!n[1]?PT:{type:n[0],payload:n[1]}},dEe=function(t,e,n){e===void 0&&(e=uEe.DEFAULT_OPTIONS),n===void 0&&(n=!0);var r=(0,_N.useMemo)(function(){return D_(D_({},e),{fromSocketIO:!0})},[]),i=(0,cEe.useWebSocket)(t,r,n),s=i.sendMessage,o=i.sendJsonMessage,a=i.lastMessage,l=i.readyState,c=i.getWebSocket,u=(0,_N.useMemo)(function(){return fEe(a)},[a]);return{sendMessage:s,sendJsonMessage:o,lastMessage:u,lastJsonMessage:u,readyState:l,getWebSocket:c}};wE.useSocketIO=dEe;var SE={},N_=pi&&pi.__assign||function(){return N_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},N_.apply(this,arguments)},hEe=pi&&pi.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};Object.defineProperty(SE,"__esModule",{value:!0});SE.useEventSource=void 0;var bN=v,pEe=t0,EN=Rl,mEe=function(t,e,n){e===void 0&&(e=EN.DEFAULT_EVENT_SOURCE_OPTIONS);var r=e.withCredentials,i=e.events,s=hEe(e,["withCredentials","events"]);n===void 0&&(n=!0);var o=N_(N_({},s),{eventSourceOptions:{withCredentials:r}}),a=(0,bN.useRef)(EN.EMPTY_EVENT_HANDLERS);i&&(a.current=i);var l=(0,pEe.useWebSocket)(t,o,n),c=l.lastMessage,u=l.readyState,f=l.getWebSocket;return(0,bN.useEffect)(function(){c!=null&&c.type&&Object.entries(a.current).forEach(function(d){var h=d[0],p=d[1];h===c.type&&p(c)})},[c]),{lastEvent:c,readyState:u,getEventSource:f}};SE.useEventSource=mEe;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.resetGlobalState=t.useEventSource=t.ReadyState=t.useSocketIO=t.default=void 0;var e=t0;Object.defineProperty(t,"default",{enumerable:!0,get:function(){return e.useWebSocket}});var n=wE;Object.defineProperty(t,"useSocketIO",{enumerable:!0,get:function(){return n.useSocketIO}});var r=Rl;Object.defineProperty(t,"ReadyState",{enumerable:!0,get:function(){return r.ReadyState}});var i=SE;Object.defineProperty(t,"useEventSource",{enumerable:!0,get:function(){return i.useEventSource}});var s=n0;Object.defineProperty(t,"resetGlobalState",{enumerable:!0,get:function(){return s.resetGlobalState}})})(W$);const gEe=Zd(W$);function _3(t,e,n){return Math.max(e,Math.min(n,t))}const yEe=.05,wN=.1;function q$(t,e,n){const r=e.gamepad;if(r==null)return;const i=n.components;for(const s in i){let o=t[s];o==null&&(t[s]=o={});const{gamepadIndices:a}=i[s];let l=!1,c=!1;if(a.button!=null&&a.button<r.buttons.length){const u=r.buttons[a.button];o.button=_3(u.value,0,1),l||(l=u.pressed||o.button===1),c||(c=u.touched||o.button>yEe)}a.xAxis!=null&&a.xAxis<r.axes.length&&(o.xAxis=_3(r.axes[a.xAxis],-1,1),c||(c=Math.abs(o.xAxis)>wN)),a.yAxis!=null&&a.yAxis<r.axes.length&&(o.yAxis=_3(r.axes[a.yAxis],-1,1),c||(c=Math.abs(o.yAxis)>wN)),o.state=l?"pressed":c?"touched":"default"}}function SN(t,e){if(e===m6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===jd||e===py){let n=t.getIndex();if(n===null){const o=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);t.setIndex(o),n=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const r=n.count-2,i=[];if(e===jd)for(let o=1;o<=r;o++)i.push(n.getX(0)),i.push(n.getX(o)),i.push(n.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(n.getX(o)),i.push(n.getX(o+1)),i.push(n.getX(o+2))):(i.push(n.getX(o+2)),i.push(n.getX(o+1)),i.push(n.getX(o)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}class Y$ extends Br{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new EEe(n)}),this.register(function(n){return new wEe(n)}),this.register(function(n){return new kEe(n)}),this.register(function(n){return new LEe(n)}),this.register(function(n){return new DEe(n)}),this.register(function(n){return new TEe(n)}),this.register(function(n){return new AEe(n)}),this.register(function(n){return new MEe(n)}),this.register(function(n){return new CEe(n)}),this.register(function(n){return new bEe(n)}),this.register(function(n){return new REe(n)}),this.register(function(n){return new SEe(n)}),this.register(function(n){return new PEe(n)}),this.register(function(n){return new IEe(n)}),this.register(function(n){return new xEe(n)}),this.register(function(n){return new NEe(n)}),this.register(function(n){return new OEe(n)})}load(e,n,r,i){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const c=Ms.extractUrlBase(e);o=Ms.resolveURL(c,this.path)}else o=Ms.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){i?i(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new qr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){n(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,r,i){let s;const o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===K$){try{o[cr.KHR_BINARY_GLTF]=new FEe(e)}catch(f){i&&i(f);return}s=JSON.parse(o[cr.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new KEe(s,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const f=this.pluginCallbacks[u](c);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[f.name]=f,o[f.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const f=s.extensionsUsed[u],d=s.extensionsRequired||[];switch(f){case cr.KHR_MATERIALS_UNLIT:o[f]=new _Ee;break;case cr.KHR_DRACO_MESH_COMPRESSION:o[f]=new UEe(s,this.dracoLoader);break;case cr.KHR_TEXTURE_TRANSFORM:o[f]=new BEe;break;case cr.KHR_MESH_QUANTIZATION:o[f]=new zEe;break;default:d.indexOf(f)>=0&&a[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(r,i)}parseAsync(e,n){const r=this;return new Promise(function(i,s){r.parse(e,n,i,s)})}}function vEe(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const cr={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class xEe{constructor(e){this.parser=e,this.name=cr.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let r=0,i=n.length;r<i;r++){const s=n[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const n=this.parser,r="light:"+e;let i=n.cache.get(r);if(i)return i;const s=n.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new wt(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],as);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new jm(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Gm(u),c.distance=f;break;case"spot":c=new Hm(u),c.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Oc(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=n.createUniqueName(l.name||"light_"+e),i=Promise.resolve(c),n.cache.add(r,i),i}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,r=this.parser,s=r.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return r._getNodeRef(n.cache,a,l)})}}class _Ee{constructor(){this.name=cr.KHR_MATERIALS_UNLIT}getMaterialType(){return Fr}extendParams(e,n,r){const i=[];e.color=new wt(1,1,1),e.opacity=1;const s=n.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],as),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,Er))}return Promise.all(i)}}class bEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(n.emissiveIntensity=s),Promise.resolve()}}class EEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(n.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(r.assignTexture(n,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(n,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(n,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new Ke(a,a)}return Promise.all(s)}}class wEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return n.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class SEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(n.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(r.assignTexture(n,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(n.iridescenceIOR=o.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(n,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class TEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];n.sheenColor=new wt(0,0,0),n.sheenRoughness=0,n.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;n.sheenColor.setRGB(a[0],a[1],a[2],as)}return o.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(r.assignTexture(n,"sheenColorMap",o.sheenColorTexture,Er)),o.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(n,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class AEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(n.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(r.assignTexture(n,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class MEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];n.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(r.assignTexture(n,"thicknessMap",o.thicknessTexture)),n.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return n.attenuationColor=new wt().setRGB(a[0],a[1],a[2],as),Promise.all(s)}}class CEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return n.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class REe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];n.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(r.assignTexture(n,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return n.specularColor=new wt().setRGB(a[0],a[1],a[2],as),o.specularColorTexture!==void 0&&s.push(r.assignTexture(n,"specularColorMap",o.specularColorTexture,Er)),Promise.all(s)}}class IEe{constructor(e){this.parser=e,this.name=cr.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return n.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(r.assignTexture(n,"bumpMap",o.bumpTexture)),Promise.all(s)}}class PEe{constructor(e){this.parser=e,this.name=cr.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Ur}extendMaterialParams(e,n){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(n.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(n.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(r.assignTexture(n,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class kEe{constructor(e){this.parser=e,this.name=cr.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=n.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,s.source,o)}}class LEe{constructor(e){this.parser=e,this.name=cr.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class DEe{constructor(e){this.parser=e,this.name=cr.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class NEe{constructor(e){this.name=cr.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,r=n.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=i.byteOffset||0,c=i.byteLength||0,u=i.count,f=i.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,f,d,i.mode,i.filter).then(function(h){return h.buffer}):o.ready.then(function(){const h=new ArrayBuffer(u*f);return o.decodeGltfBuffer(new Uint8Array(h),u,f,d,i.mode,i.filter),h})})}else return null}}class OEe{constructor(e){this.name=cr.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,r=n.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=n.meshes[r.mesh];for(const c of i.primitives)if(c.mode!==La.TRIANGLES&&c.mode!==La.TRIANGLE_STRIP&&c.mode!==La.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=r.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),f=u.isGroup?u.children:[u],d=c[0].count,h=[];for(const p of f){const m=new et,g=new $,y=new bn,x=new $(1,1,1),_=new eh(p.geometry,p.material,d);for(let w=0;w<d;w++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,w),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,w),l.SCALE&&x.fromBufferAttribute(l.SCALE,w),_.setMatrixAt(w,m.compose(g,y,x));for(const w in l)if(w==="_COLOR_0"){const T=l[w];_.instanceColor=new Ya(T.array,T.itemSize,T.normalized)}else w!=="TRANSLATION"&&w!=="ROTATION"&&w!=="SCALE"&&p.geometry.setAttribute(w,l[w]);yn.prototype.copy.call(_,p),this.parser.assignFinalMaterial(_),h.push(_)}return u.isGroup?(u.clear(),u.add(...h),u):h[0]}))}}const K$="glTF",_g=12,TN={JSON:1313821514,BIN:5130562};class FEe{constructor(e){this.name=cr.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,_g),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==K$)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-_g,s=new DataView(e,_g);let o=0;for(;o<i;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,l===TN.JSON){const c=new Uint8Array(e,_g+o,a);this.content=r.decode(c)}else if(l===TN.BIN){const c=_g+o;this.body=e.slice(c,c+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class UEe{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=cr.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const f=iM[u]||u.toLowerCase();a[f]=o[u]}for(const u in e.attributes){const f=iM[u]||u.toLowerCase();if(o[u]!==void 0){const d=r.accessors[e.attributes[u]],h=um[d.componentType];c[f]=h.name,l[f]=d.normalized===!0}}return n.getDependency("bufferView",s).then(function(u){return new Promise(function(f,d){i.decodeDracoFile(u,function(h){for(const p in h.attributes){const m=h.attributes[p],g=l[p];g!==void 0&&(m.normalized=g)}f(h)},a,c,as,d)})})}}class BEe{constructor(){this.name=cr.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class zEe{constructor(){this.name=cr.KHR_MESH_QUANTIZATION}}class Z$ extends rh{constructor(e,n,r,i){super(e,n,r,i)}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)n[o]=r[s+o];return n}interpolate_(e,n,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=i-n,f=(r-n)/u,d=f*f,h=d*f,p=e*c,m=p-c,g=-2*h+3*d,y=h-d,x=1-g,_=y-d+f;for(let w=0;w!==a;w++){const T=o[m+w+a],S=o[m+w+l]*u,C=o[p+w+a],A=o[p+w]*u;s[w]=x*T+_*S+g*C+y*A}return s}}const HEe=new bn;class GEe extends Z${interpolate_(e,n,r,i){const s=super.interpolate_(e,n,r,i);return HEe.fromArray(s).normalize().toArray(s),s}}const La={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},um={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},AN={9728:zn,9729:Pn,9984:dy,9985:Td,9986:Zu,9987:Ts},MN={33071:ei,33648:Bd,10497:Or},kT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},iM={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Bu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},jEe={CUBICSPLINE:void 0,LINEAR:pf,STEP:Gd},LT={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function VEe(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new Ka({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Cs})),t.DefaultMaterial}function ad(t,e,n){for(const r in n.extensions)t[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function Oc(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function WEe(t,e,n){let r=!1,i=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const f=e[c];if(f.POSITION!==void 0&&(r=!0),f.NORMAL!==void 0&&(i=!0),f.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const f=e[c];if(r){const d=f.POSITION!==void 0?n.getDependency("accessor",f.POSITION):t.attributes.position;o.push(d)}if(i){const d=f.NORMAL!==void 0?n.getDependency("accessor",f.NORMAL):t.attributes.normal;a.push(d)}if(s){const d=f.COLOR_0!==void 0?n.getDependency("accessor",f.COLOR_0):t.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],f=c[1],d=c[2];return r&&(t.morphAttributes.position=u),i&&(t.morphAttributes.normal=f),s&&(t.morphAttributes.color=d),t.morphTargetsRelative=!0,t})}function $Ee(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let n=0,r=e.weights.length;n<r;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let r=0,i=n.length;r<i;r++)t.morphTargetDictionary[n[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function XEe(t){let e;const n=t.extensions&&t.extensions[cr.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+DT(n.attributes):e=t.indices+":"+DT(t.attributes)+":"+t.mode,t.targets!==void 0)for(let r=0,i=t.targets.length;r<i;r++)e+=":"+DT(t.targets[r]);return e}function DT(t){let e="";const n=Object.keys(t).sort();for(let r=0,i=n.length;r<i;r++)e+=n[r]+":"+t[n[r]]+";";return e}function sM(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function qEe(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":t.search(/\.ktx2($|\?)/i)>0||t.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const YEe=new et;class KEe{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new vEe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=-1,s=!1,o=-1;if(typeof navigator<"u"){const a=navigator.userAgent;r=/^((?!chrome|android).)*safari/i.test(a)===!0;const l=a.match(/Version\/(\d+)/);i=r&&l?parseInt(l[1],10):-1,s=a.indexOf("Firefox")>-1,o=s?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||r&&i<17||s&&o<98?this.textureLoader=new ns(this.options.manager):this.textureLoader=new z6(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new qr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(o){const a={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:r,userData:{}};return ad(s,a,i),Oc(a,i),Promise.all(r._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=n.length;i<s;i++){const o=n[i].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(r[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,r){if(e.refs[n]<=1)return r;const i=r.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(r,i),i.name+="_instance_"+e.uses[n]++,i}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let r=0;r<n.length;r++){const i=e(n[r]);if(i)return i}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const r=[];for(let i=0;i<n.length;i++){const s=e(n[i]);s&&r.push(s)}return r}getDependency(e,n){const r=e+":"+n;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(n);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(n)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(n)});break;case"accessor":i=this.loadAccessor(n);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(n)});break;case"buffer":i=this.loadBuffer(n);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(n)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(n)});break;case"skin":i=this.loadSkin(n);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(n)});break;case"camera":i=this.loadCamera(n);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,n)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let n=this.cache.get(e);if(!n){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(i.map(function(s,o){return r.getDependency(e,o)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],r=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[cr.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){r.load(Ms.resolveURL(n.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(r){const i=n.byteLength||0,s=n.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const n=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=kT[i.type],a=um[i.componentType],l=i.normalized===!0,c=new a(i.count*o);return Promise.resolve(new fn(c,o,l))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=kT[i.type],c=um[i.componentType],u=c.BYTES_PER_ELEMENT,f=u*l,d=i.byteOffset||0,h=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,p=i.normalized===!0;let m,g;if(h&&h!==f){const y=Math.floor(d/h),x="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+y+":"+i.count;let _=n.cache.get(x);_||(m=new c(a,y*h,i.count*h/u),_=new Um(m,h/u),n.cache.add(x,_)),g=new Ao(_,l,d%h/u,p)}else a===null?m=new c(i.count*l):m=new c(a,d,i.count*l),g=new fn(m,l,p);if(i.sparse!==void 0){const y=kT.SCALAR,x=um[i.sparse.indices.componentType],_=i.sparse.indices.byteOffset||0,w=i.sparse.values.byteOffset||0,T=new x(o[1],_,i.sparse.count*y),S=new c(o[2],w,i.sparse.count*l);a!==null&&(g=new fn(g.array.slice(),g.itemSize,g.normalized)),g.normalized=!1;for(let C=0,A=T.length;C<A;C++){const R=T[C];if(g.setX(R,S[C*l]),l>=2&&g.setY(R,S[C*l+1]),l>=3&&g.setZ(R,S[C*l+2]),l>=4&&g.setW(R,S[C*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}g.normalized=p}return g})}loadTexture(e){const n=this.json,r=this.options,s=n.textures[e].source,o=n.images[s];let a=this.textureLoader;if(o.uri){const l=r.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,n,r){const i=this,s=this.json,o=s.textures[e],a=s.images[n],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(n,r).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=AN[d.magFilter]||Pn,u.minFilter=AN[d.minFilter]||Ts,u.wrapS=MN[d.wrapS]||Or,u.wrapT=MN[d.wrapT]||Or,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==zn&&u.minFilter!==Pn,i.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,n){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=i.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=r.getDependency("bufferView",o.bufferView).then(function(f){c=!0;const d=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(f){return new Promise(function(d,h){let p=d;n.isImageBitmapLoader===!0&&(p=function(m){const g=new tr(m);g.needsUpdate=!0,d(g)}),n.load(Ms.resolveURL(f,s.path),p,void 0,h)})}).then(function(f){return c===!0&&a.revokeObjectURL(l),Oc(f,o),f.userData.mimeType=o.mimeType||qEe(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=u,u}assignTexture(e,n,r,i){const s=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(o=o.clone(),o.channel=r.texCoord),s.extensions[cr.KHR_TEXTURE_TRANSFORM]){const a=r.extensions!==void 0?r.extensions[cr.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[cr.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return i!==void 0&&(o.colorSpace=i),e[n]=o,o})}assignFinalMaterial(e){const n=e.geometry;let r=e.material;const i=n.attributes.tangent===void 0,s=n.attributes.color!==void 0,o=n.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new Ha,Wr.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,l.sizeAttenuation=!1,this.cache.add(a,l)),r=l}else if(e.isLine){const a="LineBasicMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new oi,Wr.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,this.cache.add(a,l)),r=l}if(i||s||o){let a="ClonedMaterial:"+r.uuid+":";i&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=r.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(r))),r=l}e.material=r}getMaterialType(){return Ka}loadMaterial(e){const n=this,r=this.json,i=this.extensions,s=r.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[cr.KHR_MATERIALS_UNLIT]){const f=i[cr.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),c.push(f.extendParams(a,s,n))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new wt(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const d=f.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],as),a.opacity=d[3]}f.baseColorTexture!==void 0&&c.push(n.assignTexture(a,"map",f.baseColorTexture,Er)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(c.push(n.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),c.push(n.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Nr);const u=s.alphaMode||LT.OPAQUE;if(u===LT.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===LT.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Fr&&(c.push(n.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ke(1,1),s.normalTexture.scale!==void 0)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}if(s.occlusionTexture!==void 0&&o!==Fr&&(c.push(n.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Fr){const f=s.emissiveFactor;a.emissive=new wt().setRGB(f[0],f[1],f[2],as)}return s.emissiveTexture!==void 0&&o!==Fr&&c.push(n.assignTexture(a,"emissiveMap",s.emissiveTexture,Er)),Promise.all(c).then(function(){const f=new o(a);return s.name&&(f.name=s.name),Oc(f,s),n.associations.set(f,{materials:e}),s.extensions&&ad(i,f,s),f})}createUniqueName(e){const n=dr.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,r=this.extensions,i=this.primitiveCache;function s(a){return r[cr.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,n).then(function(l){return CN(l,a,n)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=XEe(c),f=i[u];if(f)o.push(f.promise);else{let d;c.extensions&&c.extensions[cr.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=CN(new gn,c,n),i[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const n=this,r=this.json,i=this.extensions,s=r.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=o[l].material===void 0?VEe(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(n.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],f=[];for(let h=0,p=u.length;h<p;h++){const m=u[h],g=o[h];let y;const x=c[h];if(g.mode===La.TRIANGLES||g.mode===La.TRIANGLE_STRIP||g.mode===La.TRIANGLE_FAN||g.mode===void 0)y=s.isSkinnedMesh===!0?new Qd(m,x):new ln(m,x),y.isSkinnedMesh===!0&&y.normalizeSkinWeights(),g.mode===La.TRIANGLE_STRIP?y.geometry=SN(y.geometry,py):g.mode===La.TRIANGLE_FAN&&(y.geometry=SN(y.geometry,jd));else if(g.mode===La.LINES)y=new so(m,x);else if(g.mode===La.LINE_STRIP)y=new $o(m,x);else if(g.mode===La.LINE_LOOP)y=new Cb(m,x);else if(g.mode===La.POINTS)y=new Zc(m,x);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(y.geometry.morphAttributes).length>0&&$Ee(y,s),y.name=n.createUniqueName(s.name||"mesh_"+e),Oc(y,s),g.extensions&&ad(i,y,g),n.assignFinalMaterial(y),f.push(y)}for(let h=0,p=f.length;h<p;h++)n.associations.set(f[h],{meshes:e,primitives:h});if(f.length===1)return s.extensions&&ad(i,f[0],s),f[0];const d=new es;s.extensions&&ad(i,d,s),n.associations.set(d,{meshes:e});for(let h=0,p=f.length;h<p;h++)d.add(f[h]);return d})}loadCamera(e){let n;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?n=new Ar(ri.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(n=new Hi(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(n.name=this.createUniqueName(r.name)),Oc(n,r),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],r=[];for(let i=0,s=n.joints.length;i<s;i++)r.push(this._loadNodeShallow(n.joints[i]));return n.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",n.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),o=i,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const f=o[c];if(f){a.push(f);const d=new et;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[c])}return new wf(a,l)})}loadAnimation(e){const n=this.json,r=this,i=n.animations[e],s=i.name?i.name:"animation_"+e,o=[],a=[],l=[],c=[],u=[];for(let f=0,d=i.channels.length;f<d;f++){const h=i.channels[f],p=i.samplers[h.sampler],m=h.target,g=m.node,y=i.parameters!==void 0?i.parameters[p.input]:p.input,x=i.parameters!==void 0?i.parameters[p.output]:p.output;m.node!==void 0&&(o.push(this.getDependency("node",g)),a.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",x)),c.push(p),u.push(m))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(f){const d=f[0],h=f[1],p=f[2],m=f[3],g=f[4],y=[];for(let x=0,_=d.length;x<_;x++){const w=d[x],T=h[x],S=p[x],C=m[x],A=g[x];if(w===void 0)continue;w.updateMatrix&&w.updateMatrix();const R=r._createAnimationTracks(w,T,S,C,A);if(R)for(let M=0;M<R.length;M++)y.push(R[M])}return new Qa(s,void 0,y)})}createNodeMesh(e){const n=this.json,r=this,i=n.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const o=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=i.weights.length;l<c;l++)a.morphTargetInfluences[l]=i.weights[l]}),o})}loadNode(e){const n=this.json,r=this,i=n.nodes[e],s=r._loadNodeShallow(e),o=[],a=i.children||[];for(let c=0,u=a.length;c<u;c++)o.push(r.getDependency("node",a[c]));const l=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],f=c[1],d=c[2];d!==null&&u.traverse(function(h){h.isSkinnedMesh&&h.bind(d,YEe)});for(let h=0,p=f.length;h<p;h++)u.add(f[h]);return u})}_loadNodeShallow(e){const n=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=n.nodes[e],o=s.name?i.createUniqueName(s.name):"",a=[],l=i._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(i.getDependency("camera",s.camera).then(function(c){return i._getNodeRef(i.cameraCache,s.camera,c)})),i._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(s.isBone===!0?u=new Jd:c.length>1?u=new es:c.length===1?u=c[0]:u=new yn,u!==c[0])for(let f=0,d=c.length;f<d;f++)u.add(c[f]);if(s.name&&(u.userData.name=s.name,u.name=o),Oc(u,s),s.extensions&&ad(r,u,s),s.matrix!==void 0){const f=new et;f.fromArray(s.matrix),u.applyMatrix4(f)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return i.associations.has(u)||i.associations.set(u,{}),i.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const n=this.extensions,r=this.json.scenes[e],i=this,s=new es;r.name&&(s.name=i.createUniqueName(r.name)),Oc(s,r),r.extensions&&ad(n,s,r);const o=r.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(i.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,f=l.length;u<f;u++)s.add(l[u]);const c=u=>{const f=new Map;for(const[d,h]of i.associations)(d instanceof Wr||d instanceof tr)&&f.set(d,h);return u.traverse(d=>{const h=i.associations.get(d);h!=null&&f.set(d,h)}),f};return i.associations=c(s),s})}_createAnimationTracks(e,n,r,i,s){const o=[],a=e.name?e.name:e.uuid,l=[];Bu[s.path]===Bu.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let c;switch(Bu[s.path]){case Bu.weights:c=ru;break;case Bu.rotation:c=Za;break;case Bu.position:case Bu.scale:c=Xo;break;default:switch(r.itemSize){case 1:c=ru;break;case 2:case 3:default:c=Xo;break}break}const u=i.interpolation!==void 0?jEe[i.interpolation]:pf,f=this._getArrayFromAccessor(r);for(let d=0,h=l.length;d<h;d++){const p=new c(l[d]+"."+Bu[s.path],n.array,f,u);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const r=sM(n.constructor),i=new Float32Array(n.length);for(let s=0,o=n.length;s<o;s++)i[s]=n[s]*r;n=i}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof Za?GEe:Z$;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ZEe(t,e,n){const r=e.attributes,i=new Kn;if(r.POSITION!==void 0){const a=n.json.accessors[r.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(i.set(new $(l[0],l[1],l[2]),new $(c[0],c[1],c[2])),a.normalized){const u=sM(um[a.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new $,l=new $;for(let c=0,u=s.length;c<u;c++){const f=s[c];if(f.POSITION!==void 0){const d=n.json.accessors[f.POSITION],h=d.min,p=d.max;if(h!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(h[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(h[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(h[2]),Math.abs(p[2]))),d.normalized){const m=sM(um[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}t.boundingBox=i;const o=new wr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=o}function CN(t,e,n){const r=e.attributes,i=[];function s(o,a){return n.getDependency("accessor",o).then(function(l){t.setAttribute(a,l)})}for(const o in r){const a=iM[o]||o.toLowerCase();a in t.attributes||i.push(s(r[o],a))}if(e.indices!==void 0&&!t.index){const o=n.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});i.push(o)}return er.workingColorSpace!==as&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${er.workingColorSpace}" not supported.`),Oc(t,e),ZEe(t,e,n),Promise.all(i).then(function(){return e.targets!==void 0?WEe(t,e.targets,n):t})}function QEe(t){return{data:new Float32Array(t.size*16)}}function JEe(t,e,n,r,i){const s=r.getReferenceSpace();s==null||e==null||e.session.visibilityState==="visible-blurred"||e.session.visibilityState==="hidden"||ewe(e,s,n,t.data)}const NT=new et,OT=new et;function ewe(t,e,n,r){if(!t.fillPoses(n.values(),e,r))return!1;NT.fromArray(r,0),NT.invert();for(let s=0;s<r.length;s+=16)OT.fromArray(r,s),OT.premultiply(NT),OT.toArray(r,s);return!0}new et;new et;function twe(t){const e=new Map,n=new Map,r=t.clone();return Q$(t,r,function(i,s){e.set(s,i),n.set(i,s)}),r.traverse(function(i){if(!i.isSkinnedMesh)return;const s=i,o=e.get(i),a=o.skeleton.bones;s.skeleton=o.skeleton.clone(),s.bindMatrix.copy(o.bindMatrix),s.skeleton.bones=a.map(function(l){return n.get(l)}),s.bind(s.skeleton,s.bindMatrix)}),r}function Q$(t,e,n){n(t,e);for(let r=0;r<t.children.length;r++)Q$(t.children[r],e.children[r],n)}const nwe="generic-hand";function rwe(t,e){const n=(e==null?void 0:e.baseAssetPath)??xX,r=(e==null?void 0:e.defaultXRHandProfileId)??nwe;return new URL(`${r}/${t}.glb`,n).href}function iwe({scene:t}){const e=twe(t),n=e.getObjectByProperty("type","SkinnedMesh");if(n==null)throw new Error("missing SkinnedMesh in loaded XRHand model");return n.frustumCulled=!1,e}function swe(t,e){t.renderOrder=(e==null?void 0:e.renderOrder)??0,t.traverse(n=>{n instanceof ln&&n.material instanceof Wr&&(n.material.colorWrite=(e==null?void 0:e.colorWrite)??!0)})}function owe(t,e,n,r,i){return{id:t,isPrimary:i,type:"hand",inputSource:e,pose:QEe(e.hand),assetPath:rwe(e.handedness,n),events:r}}function awe({inputSource:t,pose:e},n,r){JEe(e,n,t.hand,r,t.handedness)}const lwe=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"];function cwe(t,e,n){const r=new Float32Array(t.size*16),i=lwe.map(s=>{const o=e.getObjectByName(s);if(o==null)throw new Error(`missing joint "${s}" in hand model`);return o.matrixAutoUpdate=!1,o});return s=>{const o=typeof n=="function"?n():n;if(s==null||o==null)return;s.fillPoses(t.values(),o,r);const a=i.length;for(let l=0;l<a;l++)i[l].matrix.fromArray(r,l*16)}}function uwe(t){return t!=null&&typeof t=="object"&&"inputSource"in t}function fwe(t,e){const n=r=>e.push(r);return t.addEventListener("selectstart",n),t.addEventListener("selectend",n),t.addEventListener("select",n),t.addEventListener("squeeze",n),t.addEventListener("squeezestart",n),t.addEventListener("squeezeend",n),()=>{t.removeEventListener("selectstart",n),t.removeEventListener("selectend",n),t.removeEventListener("select",n),t.removeEventListener("squeeze",n),t.removeEventListener("squeezestart",n),t.removeEventListener("squeezeend",n)}}let dwe=0;function hwe(t,e){const n=new Map,r=new _X(e),i=new Map;return(s,o,a)=>{var c;if(a==="remove-all"){for(const u of n.values())u();return o}const l=[...o];for(const{added:u,isPrimary:f,removed:d}of a){if(d!=null)for(const h of d){const p=l.findIndex(({inputSource:m,isPrimary:g})=>g===f&&m===h);p!==-1&&(l.splice(p,1),(c=n.get(h))==null||c(),n.delete(h))}if(u!=null)for(const h of u){const p=[];let m=fwe(s,p);const g=`${h.handedness}-${h.hand?"hand":"nohand"}-${h.targetRayMode}-${h.profiles.join(",")}`;let y;if((y=i.get(g))==null&&i.set(g,y=`${dwe++}`),h.hand!=null)l.push(owe(y,h,e,p,f));else switch(h.targetRayMode){case"gaze":l.push({id:y,isPrimary:f,type:"gaze",inputSource:h,events:p});break;case"screen":l.push({id:y,isPrimary:f,type:"screenInput",inputSource:h,events:p});break;case"transient-pointer":l.push({id:y,isPrimary:f,type:"transientPointer",inputSource:h,events:p});break;case"tracked-pointer":let x=!1;const _=m;m=()=>{_(),x=!0};const w=KSe(y,h,r,p,f);w instanceof Promise?w.then(T=>!x&&t(T)).catch(console.error):l.push(w);break}n.set(h,m)}}return l}}function pwe(t,e){const n=(r,i)=>{i!=null&&r.visibilityState===i.visibilityState||e(r.visibilityState==="visible")};return n(t.getState()),t.subscribe(n)}class mwe extends Fr{constructor(){super({transparent:!0,toneMapped:!1,depthWrite:!1})}onBeforeCompile(e,n){super.onBeforeCompile(e,n),e.vertexShader=`varying vec2 vLocalPosition;
`+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>",`#include <color_vertex>
        vLocalPosition = position.xy * 2.0;`),e.fragmentShader=`varying vec2 vLocalPosition;
`+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>",`#include <color_fragment>
          float value = max(0.0, 1.0 - sqrt(dot(vLocalPosition, vLocalPosition)));
          diffuseColor.a = diffuseColor.a * value * value;`)}}const gwe=new $(0,0,1),RN=new bn,FT=new $;function ywe(t,e,n,r,i){const s=r.getIntersection();if(s==null||!r.getEnabled()||s.object.isVoidObject===!0||!J$(t)){e.visible=!1;return}e.visible=!0;const o=typeof i.color=="function"?i.color(r):i.color;Array.isArray(o)?n.color.set(...o):n.color.set(o??"white"),n.opacity=typeof i.opacity=="function"?i.opacity(r):i.opacity??.4,e.position.copy(s.pointOnFace),e.scale.setScalar(i.size??.1),s.normal!=null&&(RN.setFromUnitVectors(gwe,s.normal),s.object.getWorldQuaternion(e.quaternion),e.quaternion.multiply(RN),FT.set(0,0,i.cursorOffset??.01),FT.applyQuaternion(e.quaternion),e.position.add(FT)),e.updateMatrix()}function J$({visible:t,parent:e}){return t?e==null?!0:J$(e):!1}class vwe extends Fr{constructor(){super({transparent:!0,toneMapped:!1})}onBeforeCompile(e,n){super.onBeforeCompile(e,n),e.vertexShader=`varying float vFade;
`+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>",`#include <color_vertex>
            vFade = position.z + 0.5;`),e.fragmentShader=`varying float vFade;
`+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>",`#include <color_fragment>
              diffuseColor.a *= vFade;`)}}function xwe(t,e,n,r){const i=n.getIntersection();if(!n.getEnabled()||i==null){t.visible=!1;return}t.visible=!0;const s=typeof r.color=="function"?r.color(n):r.color;Array.isArray(s)?e.color.set(...s):e.color.set(s??"white"),e.opacity=typeof r.opacity=="function"?r.opacity(n):r.opacity??.4;const o=Math.min(r.maxLength??1,i.distance);t.position.z=-o/2;const a=r.size??.005;t.scale.set(a,a,o),t.updateMatrix()}function _we(t,e,n,r){const i=s=>{e!="all"&&s.inputSource!=e||r(s)};return t.addEventListener(n,i),()=>t.removeEventListener(n,i)}function bwe(t,e,n,r,i,s={}){const o=f=>{f.inputSource===n&&t.down(Object.assign(f,{button:s.button??0}))},a=f=>{f.inputSource===n&&t.up(Object.assign(f,{button:s.button??0}))},l=`${r}start`,c=`${r}end`,u=i.length;for(let f=0;f<u;f++){const d=i[f];switch(d.type){case l:o(d);break;case c:a(d);break}}return e.addEventListener(l,o),e.addEventListener(c,a),()=>{e.removeEventListener(l,o),e.removeEventListener(c,a)}}function Ewe(t){var e;return t.getButtonsDown().size>0?.6:eX(((e=t.getIntersection())==null?void 0:e.distance)??1/0,.07,0,.2,.4)}function O_(t){return t.getButtonsDown().size>0?.6:.4}function wwe(t){var e;return eX(((e=t.getIntersection())==null?void 0:e.distance)??1/0,.1,.03,.2,.6)}function eX(t,e,n,r,i){return r+Math.max(0,Math.min(1,(t-e)/(n-e)))*(i-r)}function Swe(t,e){return(n,r)=>{if(t===e)return n.identity(),!0;const i=typeof e=="function"?e():e;if(i==null)return!1;const s=r==null?void 0:r.getPose(t,i);return s==null?!1:(n.fromArray(s.transform.matrix),!0)}}function TE(t,e,n,r){r==null||r.copy(t.matrix);const i=tX(t.parent,r);return i??(r!=null&&Twe(t,e,r),n)}function Twe(t,e,n){if(t.updateWorldMatrix(!0,!1),e==null){n.copy(t.matrixWorld);return}e.updateWorldMatrix(!0,!1),n.copy(e.matrixWorld).invert().multiply(t.matrixWorld)}function tX(t,e){if(t!=null)return t.xrSpace!=null?t.xrSpace:(e==null||e.premultiply(t.matrix),tX(t.parent,e))}function Awe(t,e,{anchors:n=!0,handTracking:r=!0,layers:i=!0,meshDetection:s=!0,planeDetection:o=!0,customSessionInit:a,depthSensing:l=!1,hitTest:c=!0,domOverlay:u=!0,bounded:f}={}){if(a!=null)return a;const d=f==null?["local-floor"]:f?["bounded-floor"]:["unbounded","local-floor"],h=[];u instanceof Element&&(u=!0),zu(n,"anchors",d,h),zu(r,"hand-tracking",d,h),zu(i,"layers",d,h),zu(s,"mesh-detection",d,h),zu(o,"plane-detection",d,h),zu(l,"depth-sensing",d,h),zu(u,"dom-overlay",d,h),zu(c,"hit-test",d,h);const p={requiredFeatures:d,optionalFeatures:h};return e!=null&&(p.domOverlay={root:e}),l&&Object.assign(p,{depthSensing:{usagePreference:["gpu-optimized"],dataFormatPreference:[]}}),p}function zu(t,e,n,r){if(t!==!1){if(t===!0){r.push(e);return}n.push(e)}}function fm(t,e,n){return typeof t=="function"?t:(typeof t=="object"&&(e!=null&&Mwe(t,e)?t=t[e]:"default"in t&&(t=t.default)),t===!1?!1:t===!0?n:t??n)}function Mwe(t,e){return e in t}const nX={session:void 0,mediaBinding:void 0,originReferenceSpace:void 0,visibilityState:void 0,mode:null,frameRate:void 0,inputSourceStates:[],detectedMeshes:[],detectedPlanes:[],layerEntries:[]};function IN(t,e,n){var r,i;typeof navigator>"u"||Promise.all([(r=navigator.xr)==null?void 0:r.isSessionSupported("immersive-vr").catch(s=>(console.error(s),!1)),(i=navigator.xr)==null?void 0:i.isSessionSupported("immersive-ar").catch(s=>(console.error(s),!1))]).then(([s,o])=>!o&&!s?t6(()=>import("./chunk-Dhe4rJMi.js"),__vite__mapDeps([0,1,2,3])):void 0).then(s=>{if(s==null)return;n&&window.alert("emulator started");const o=s.emulate(e===!0?"metaQuest3":e);o!=null&&t.setState({emulator:o})})}function Cwe(t){const e=typeof HTMLElement>"u"?void 0:(t==null?void 0:t.domOverlay)instanceof HTMLElement?t.domOverlay:document.createElement("div"),n=BV(()=>({...nX,controller:t==null?void 0:t.controller,hand:t==null?void 0:t.hand,gaze:t==null?void 0:t.gaze,screenInput:t==null?void 0:t.screenInput,transientPointer:t==null?void 0:t.transientPointer,domOverlayRoot:e})),r=(t==null?void 0:t.emulate)??"metaQuest3";let i;if(typeof window<"u"&&r!=!1){const f=(typeof r=="object"?r.inject:void 0)??{hostname:"localhost"};(f===!0||typeof f!="boolean"&&window.location.hostname===f.hostname)&&IN(n,r,!1);const d=h=>{h.altKey&&h.metaKey&&h.code==="KeyE"&&IN(n,r,!0)};window.addEventListener("keydown",d),i=()=>window.removeEventListener("keydown",d)}let s;if(e!=null){if(e.parentNode==null){const f=h=>{e.style.display=h.session!=null?"block":"none"},d=n.subscribe(f);f(n.getState()),document.body.appendChild(e),s=()=>{e.remove(),d()}}document.body.append(e)}const o=hwe(f=>n.setState({inputSourceStates:[...n.getState().inputSourceStates,f]}),t),a=Pwe(n,o,(t==null?void 0:t.secondaryInputSources)??!1),l=Iwe(t==null?void 0:t.enterGrantedSession,f=>Cx(e,f,t,u)),c=[];let u;return Object.assign(n,{addLayerEntry(f){n.getState().session!=null&&n.setState({layerEntries:[...n.getState().layerEntries,f]})},removeLayerEntry(f){n.getState().session!=null&&n.setState({layerEntries:n.getState().layerEntries.filter(d=>d!=f)})},requestFrame(){return new Promise(f=>c.push(f))},setWebXRManager(f){if(u===f)return;u=f;const{foveation:d,bounded:h}=t??{};f.setReferenceSpaceType(h?"bounded-floor":"local-floor"),d!=null&&f.setFoveation(d)},setFrameRate(f){const{session:d}=n.getState();d!=null&&rX(d,f)},setHand(f,d){if(d==null){n.setState({hand:f});return}const h=n.getState().hand,p={};typeof h=="object"&&Object.assign(p,h),Object.assign(p,{default:fm(h,void 0,{}),[d]:f}),n.setState({hand:p})},setController(f,d){if(d==null){n.setState({controller:f});return}const h=n.getState().controller,p={};typeof h=="object"&&Object.assign(p,h),Object.assign(p,{default:fm(h,void 0,{}),[d]:f}),n.setState({controller:p})},setTransientPointer(f,d){if(d==null){n.setState({transientPointer:f});return}const h=n.getState().transientPointer,p={};typeof h=="object"&&Object.assign(p,h),Object.assign(p,{default:fm(h,void 0,{}),[d]:f}),n.setState({transientPointer:p})},setGaze(f){n.setState({gaze:f})},setScreenInput(f){n.setState({screenInput:f})},destroy(){i==null||i(),s==null||s(),l==null||l(),a(void 0)},enterXR:f=>Cx(e,f,t,u),enterAR:()=>Cx(e,"immersive-ar",t,u),enterVR:()=>Cx(e,"immersive-vr",t,u),onBeforeFrame(f,d,h){let p;const m=(u==null?void 0:u.getReferenceSpace())??void 0,g=n.getState(),y=d.parent??f;if(g.origin!=y&&(p??(p={}),p.origin=y),m!=g.originReferenceSpace&&(p??(p={}),p.originReferenceSpace=m),y.xrSpace=m,g.origin!=y&&g.origin!=null&&(g.origin.xrSpace=void 0),h!=null&&(u!=null&&kwe(n,h,u),g.session==null&&m!=null&&h.session!=null&&(p??(p={}),Object.assign(p,a(h.session)))),p!=null&&n.setState(p),h!=null){const x=c.length;for(let _=0;_<x;_++)c[_](h);c.length=0}},onBeforeRender(){const{session:f,layerEntries:d}=n.getState();if(f==null||u==null)return;const h=f==null?void 0:f.renderState.layers;if(h==null)return;d.sort((g,y)=>g.renderOrder-y.renderOrder);let p=!1;const m=d.map(({layer:g},y)=>(g!=h[y]&&(p=!0),g));p&&(m.push(u.getBaseLayer()),f.updateRenderState({layers:m}))}})}async function rX(t,e){if(e===!1)return;const{supportedFrameRates:n}=t;if(n==null||n.length===0)return;if(typeof e=="function"){const i=e(n);return i===!1?void 0:t.updateTargetFrameRate(i)}const r=e==="high"?1:e==="mid"?.5:0;return t.updateTargetFrameRate(n[Math.ceil((n.length-1)*r)])}async function Cx(t,e,n,r){if(typeof navigator>"u"||navigator.xr==null)return Promise.reject(new Error("WebXR not supported"));if(r==null)return Promise.reject(new Error("not connected to three.js. Missing are <XR> component?"));const i=await navigator.xr.requestSession(e,Awe(e,t,n));return rX(i,(n==null?void 0:n.frameRate)??"high"),Rwe(r,i,n),i}function Rwe(t,e,n){if(t==null)return;const r=XRWebGLLayer.getNativeFramebufferScaleFactor(e);let i=n==null?void 0:n.frameBufferScaling;typeof i=="function"&&(i=i(r)),typeof i=="string"&&(i=i==="high"?r:i==="mid"?1:.5),i!=null&&(t==null||t.setFramebufferScaleFactor(i)),t==null||t.setSession(e)}const PN=["immersive-ar","immersive-vr","inline"];function Iwe(t=PN,e){var r;if(typeof navigator>"u"||t===!1)return;t===!0&&(t=PN);const n=async()=>{var i;for(const s of t)await((i=navigator.xr)==null?void 0:i.isSessionSupported(s))&&e(s)};return(r=navigator.xr)==null||r.addEventListener("sessiongranted",n),()=>{var i;return(i=navigator.xr)==null?void 0:i.removeEventListener("sessiongranted",n)}}function Pwe(t,e,n){let r;return i=>{if(r==null||r(),i==null)return{};const s=[];let o;const a=()=>{o=void 0,t.setState({inputSourceStates:e(i,t.getState().inputSourceStates,s)}),s.length=0},l=(m,g)=>{s.push({isPrimary:m,added:g.added,removed:g.removed}),o==null&&(n?o=setTimeout(a,100):a())},c=l.bind(null,!0);i.addEventListener("inputsourceschange",c);let u;if(n){const m=l.bind(null,!1);i.addEventListener("trackedsourceschange",m),u=()=>i.removeEventListener("trackedsourceschange",m)}const f=()=>t.setState({frameRate:i.frameRate,visibilityState:i.visibilityState});i.addEventListener("frameratechange",f),i.addEventListener("visibilitychange",f);const d=()=>{r==null||r(),r=void 0,t.setState({emulator:t.getState().emulator,...nX})};i.addEventListener("end",d);const h=[{isPrimary:!0,added:i.inputSources}];n&&h.push({isPrimary:!1,added:i.trackedSources});const p=e(i,[],h);return r=()=>{u==null||u(),clearTimeout(o),e(i,t.getState().inputSourceStates,"remove-all"),i.removeEventListener("end",d),i.removeEventListener("frameratechange",f),i.removeEventListener("visibilitychange",f),i.removeEventListener("inputsourceschange",c)},{inputSourceStates:p,frameRate:i.frameRate,visibilityState:i.visibilityState,detectedMeshes:[],detectedPlanes:[],mode:i.environmentBlendMode==="opaque"?"immersive-vr":"immersive-ar",session:i,mediaBinding:typeof XRMediaBinding>"u"?void 0:new XRMediaBinding(i)}}}function kwe(t,e,n){const r=n.getReferenceSpace(),{detectedMeshes:i,detectedPlanes:s,session:o,inputSourceStates:a}=t.getState();if(r==null||o==null)return;const l=kN(s,e.detectedPlanes),c=kN(i,e.detectedMeshes);(s!=l||i!=c)&&t.setState({detectedPlanes:l,detectedMeshes:c});const u=a.length;for(let f=0;f<u;f++){const d=a[f];switch(d.type){case"controller":ZSe(d);break;case"hand":awe(d,e,n);break}}}const Lwe=[];function kN(t,e){return e==null?Lwe:t!=null&&Dwe(e,t)?t:Array.from(e)}function Dwe(t,e){if(t.size!=e.length)return!1;for(const n of e)if(!t.has(n))return!1;return!0}new fc;new Ps;async function iX(t,e=qSe){const{scene:n}=await e.loadAsync(t.assetPath);return n.clone(!0)}function Nwe(t,e){t.renderOrder=(e==null?void 0:e.renderOrder)??0,t.traverse(n=>{n instanceof ln&&n.material instanceof Wr&&(n.material.colorWrite=(e==null?void 0:e.colorWrite)??!0)})}function Owe(t,e,n){const r=[];for(const i in e.components){const s=e.components[i];let o=n[i];o==null&&(n[i]=o={state:"default"}),r.push(...Object.values(s.visualResponses).map(a=>Fwe(t,o,a)))}return()=>{const i=r.length;for(let s=0;s<i;s++)r[s]()}}function Fwe(t,e,n){const r=t.getObjectByName(n.valueNodeName);if(e.object=r,r==null)return()=>{};if(n.valueNodeProperty==="visibility")return()=>r.visible=n.states.includes(e.state);const i=t.getObjectByName(n.minNodeName),s=t.getObjectByName(n.maxNodeName);return i==null||s==null?()=>{}:()=>{const o=Uwe(e,n);r.quaternion.slerpQuaternions(i.quaternion,s.quaternion,o),r.position.lerpVectors(i.position,s.position,o),r.updateMatrix()}}function Uwe(t,{componentProperty:e,states:n}){const r=n.includes(t.state);switch(e){case"xAxis":return r?LN(t).x:.5;case"yAxis":return r?LN(t).y:.5;case"button":return r?t.button??0:0;case"state":return r?1:0}}const bg=new Ke;function LN({xAxis:t=0,yAxis:e=0}){if(bg.lengthSq()>1){const r=Math.atan2(e,t);bg.set(Math.cos(r),Math.sin(r))}else bg.set(t,e);return bg.multiplyScalar(.5).addScalar(.5),bg}class Bwe{constructor(e){$t(this,"nativeEvent");$t(this,"NONE",0);$t(this,"CAPTURING_PHASE",1);$t(this,"AT_TARGET",2);$t(this,"BUBBLING_PHASE",3);$t(this,"relatedTarget",null);this.nativeEvent=e}get altKey(){return this.getFromNative("altKey",!1)}get button(){return this.getFromNative("button",0)}get buttons(){return this.getFromNative("buttons",0)}get clientX(){return this.getFromNative("clientX",0)}get clientY(){return this.getFromNative("clientY",0)}get ctrlKey(){return this.getFromNative("ctrlKey",!1)}get layerX(){return this.getFromNative("layerX",0)}get layerY(){return this.getFromNative("layerY",0)}get metaKey(){return this.getFromNative("metaKey",!1)}get movementX(){return this.getFromNative("movementX",0)}get movementY(){return this.getFromNative("movementY",0)}get offsetX(){return this.getFromNative("offsetX",0)}get offsetY(){return this.getFromNative("offsetY",0)}get pageX(){return this.getFromNative("pageX",0)}get pageY(){return this.getFromNative("pageY",0)}get screenX(){return this.getFromNative("screenX",0)}get screenY(){return this.getFromNative("screenY",0)}get shiftKey(){return this.getFromNative("shiftKey",!1)}get x(){return this.getFromNative("x",0)}get y(){return this.getFromNative("y",0)}get detail(){return this.getFromNative("detail",0)}get view(){return this.getFromNative("view",null)}get which(){return this.getFromNative("which",0)}get cancelBubble(){return this.getFromNative("cancelBubble",!1)}get composed(){return this.getFromNative("composed",!1)}get eventPhase(){return this.getFromNative("eventPhase",0)}get isTrusted(){return this.getFromNative("isTrusted",!1)}get returnValue(){return this.getFromNative("returnValue",!1)}get timeStamp(){return this.getFromNative("timeStamp",0)}get cancelable(){return this.getFromNative("cancelable",!1)}get defaultPrevented(){return this.getFromNative("defaultPrevented",!1)}getFromNative(e,n){return e in this.nativeEvent?this.nativeEvent[e]:n}}const UT=new $;class Hs extends Bwe{constructor(n,r,i,s,o,a,l=o.object,c=l,u={stopped:!r,stoppedImmediate:!1}){super(i);$t(this,"type");$t(this,"bubbles");$t(this,"internalPointer");$t(this,"intersection");$t(this,"camera");$t(this,"currentObject");$t(this,"object");$t(this,"propagationState");$t(this,"_pointer");$t(this,"_ray");$t(this,"_intersections",[]);$t(this,"_unprojectedPoint");this.type=n,this.bubbles=r,this.internalPointer=s,this.intersection=o,this.camera=a,this.currentObject=l,this.object=c,this.propagationState=u}get pointerId(){return this.internalPointer.id}get pointerType(){return this.internalPointer.type}get pointerState(){return this.internalPointer.state}get distance(){return this.intersection.distance}get distanceToRay(){return this.intersection.distanceToRay}get point(){return this.intersection.point}get index(){return this.intersection.index}get face(){return this.intersection.face}get faceIndex(){return this.intersection.faceIndex}get uv(){return this.intersection.uv}get uv1(){return this.intersection.uv1}get normal(){return this.intersection.normal}get instanceId(){return this.intersection.instanceId}get pointOnLine(){return this.intersection.pointOnLine}get batchId(){return this.intersection.batchId}get pointerPosition(){return this.intersection.pointerPosition}get pointerQuaternion(){return this.intersection.pointerQuaternion}get pointOnFace(){return this.intersection.pointOnFace}get localPoint(){return this.intersection.localPoint}get details(){return this.intersection.details}get target(){return this.object}get currentTarget(){return this.currentObject}get eventObject(){return this.currentObject}get srcElement(){return this.currentObject}get pointer(){return this._pointer==null&&(UT.copy(this.intersection.point).project(this.camera),this._pointer=new Ke(UT.x,UT.y)),this._pointer}get ray(){return this._ray==null&&(this._ray=new Yo,this._ray.origin.setFromMatrixPosition(this.camera.matrixWorld),this._ray.lookAt(this.point)),this._ray}get intersections(){return this._intersections==null&&(this._intersections=[{...this.intersection,eventObject:this.currentObject}]),this._intersections}get unprojectedPoint(){if(this._unprojectedPoint==null){const n=this.pointer;this._unprojectedPoint=new $(n.x,n.y,0).unproject(this.camera)}return this._unprojectedPoint}get stopped(){return this.propagationState.stoppedImmediate||this.propagationState.stopped}get stoppedImmediate(){return this.propagationState.stoppedImmediate}get delta(){throw new Error("not supported")}stopPropagation(){this.propagationState.stopped=!0}stopImmediatePropagation(){this.propagationState.stoppedImmediate=!0}retarget(n){return new Hs(this.type,this.bubbles,this.nativeEvent,this.internalPointer,this.intersection,this.camera,n,this.target,this.propagationState)}}class F_ extends Hs{get deltaX(){return this.nativeEvent.deltaX}get deltaY(){return this.nativeEvent.deltaY}get deltaZ(){return this.nativeEvent.deltaZ}constructor(e,n,r,i,s,o){super("wheel",!0,e,n,r,i,s,o)}retarget(e){return new F_(this.nativeEvent,this.internalPointer,this.intersection,this.camera,e,this.target)}}function Oo(t){sX(t,t.currentObject)}function sX(t,e){if(e==null)return;const n=Hwe(e,t.type);if(n!=null&&n.length>0){const r=t.retarget(e),i=n.length;for(let s=0;s<i&&!r.stoppedImmediate;s++)n[s](r)}t.stopped||sX(t,e.parent)}const oX={click:"onClick",contextmenu:"onContextMenu",dblclick:"onDoubleClick",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",pointerup:"onPointerUp",wheel:"onWheel"},zwe=Object.keys(oX);function Hwe(t,e){var r;if(t._listeners!=null&&e in t._listeners)return t._listeners[e];let n;if(t.isVoidObject&&e==="click"&&((r=t.parent)==null?void 0:r.__r3f)!=null&&(n=t.parent.__r3f.root.getState().onPointerMissed),t.__r3f!=null&&(n=t.__r3f.handlers[oX[e]]),n!=null)return[n]}const Gwe=1e10,jwe=new Tf(Gwe),DN=new Map;function aX(t){let e=DN.get(t);return e==null&&(e=new ln(jwe),e.isVoidObject=!0,e.parent=t,e.pointerEventsOrder=-1/0,DN.set(t,e)),e}function AE(t,e,n){var i;const r=e.normal??((i=e.face)==null?void 0:i.normal);return r==null?!1:(t.setFromNormalAndCoplanarPoint(r,e.localPoint),t.applyMatrix4(n),!0)}function Vwe(t,e,n){if(e==="none"||e==="listener"&&!t)return!1;if(n==="all")return!0;if(typeof n=="function")return({id:s,type:o,state:a})=>n(s,o,a);let r,i;return"deny"in n?(i=!0,r=n.deny):(i=!1,r=n.allow),Array.isArray(r)?s=>NN(r.includes(s.type),i):s=>NN(r===s.type,i)}function NN(t,e){return e?!t:t}function d8(t,e,n=!1,r,i,s){const o=n||Wwe(t),a=t.pointerEvents??r,l=a??t.defaultPointerEvents??"listener",c=t.pointerEventsType??i??"all",u=t.pointerEventsOrder??s??0,f=Vwe(o,l,c),d=e.length;if(d===1)(f===!0||typeof f=="function"&&f(e[0]))&&BT(e[0],t,l,c,u);else if(f===!0)for(let m=0;m<d;m++)BT(e[m],t,l,c,u);else if(typeof f=="function")for(let m=0;m<d;m++){const g=e[m];f(g)&&BT(g,t,l,c,u)}if(t.children.length===0||t.intersectChildren===!1)return;const h=t.interactableDescendants??t.children,p=h.length;for(let m=0;m<p;m++)d8(h[m],e,o,a,c,u)}function Wwe(t){var r;if(t.ancestorsHaveListeners||t.__r3f!=null&&((r=t.__r3f)==null?void 0:r.eventCount)>0)return!0;if(t._listeners==null)return!1;const e=Object.entries(t._listeners),n=e.length;for(let i=0;i<n;i++){const s=e[i];if(zwe.includes(s[0])&&s[1]!=null&&s[1].length>0)return!0}return!1}function BT({intersector:t,options:e},n,r,i,s){var o;((o=e.filter)==null?void 0:o.call(e,n,r,i,s))!==!1&&t.executeIntersection(n,s)}function ME(t,e,{customSort:n=$we}={},r){let i,s,o;const a=t.length;for(let l=0;l<a;l++){const c=t[l];if((r==null?void 0:r(c))===!1)continue;const u=e[l];(i==null||n(c,u,i,s)<0)&&(o=l,i=c,s=u)}return o}function $we(t,e=0,n,r=0){return e!=r?r-e:t.distance-n.distance}const ON=1e7;function h8(t,e,n,r,i,s=0){const o=e.direction.clone().multiplyScalar(ON),a=ON;return{distance:a+s,object:aX(t),point:o,normal:e.origin.clone().sub(o).normalize(),details:n(a),pointerPosition:r,pointerQuaternion:i,pointOnFace:o,localPoint:o}}function J1(t,e,n){for(;n>0;)t.push(e),--n}const Eg=Symbol("buttonsDownTime"),zT=Symbol("buttonsClickTime"),lX=new Map;yn.prototype.setPointerCapture=function(t){var e;(e=p8(t))==null||e.setCapture(this)};yn.prototype.releasePointerCapture=function(t){const e=p8(t);e==null||!e.hasCaptured(this)||e.setCapture(void 0)};yn.prototype.hasPointerCapture=function(t){var e;return((e=p8(t))==null?void 0:e.hasCaptured(this))??!1};function p8(t){return lX.get(t)}class r0{constructor(e,n,r,i,s,o,a,l,c={}){$t(this,"id");$t(this,"type");$t(this,"state");$t(this,"intersector");$t(this,"getCamera");$t(this,"onMoveCommited");$t(this,"parentSetPointerCapture");$t(this,"parentReleasePointerCapture");$t(this,"options");$t(this,"prevIntersection");$t(this,"intersection");$t(this,"prevEnabled",!0);$t(this,"enabled",!0);$t(this,"wheelIntersection");$t(this,"pointerEntered",[]);$t(this,"pointerEnteredHelper",[]);$t(this,"pointerCapture");$t(this,"buttonsDownTime",new Map);$t(this,"buttonsDown",new Set);$t(this,"wasMoved",!1);$t(this,"onFirstMove",[]);this.id=e,this.type=n,this.state=r,this.intersector=i,this.getCamera=s,this.onMoveCommited=o,this.parentSetPointerCapture=a,this.parentReleasePointerCapture=l,this.options=c,lX.set(e,this)}getPointerCapture(){return this.pointerCapture}hasCaptured(e){var n;return((n=this.pointerCapture)==null?void 0:n.object)===e}setCapture(e){var n,r,i;((n=this.pointerCapture)==null?void 0:n.object)!==e&&(this.pointerCapture!=null&&((r=this.parentReleasePointerCapture)==null||r.call(this),this.pointerCapture=void 0),e!=null&&this.intersection!=null&&(this.pointerCapture={object:e,intersection:this.intersection},(i=this.parentSetPointerCapture)==null||i.call(this)))}getButtonsDown(){return this.buttonsDown}getIntersection(){return this.intersection}getEnabled(){return this.enabled}setEnabled(e,n,r=!0){var i;this.enabled!==e&&(!e&&this.pointerCapture!=null&&((i=this.parentReleasePointerCapture)==null||i.call(this),this.pointerCapture=void 0),this.enabled=e,r&&this.commit(n,!1))}computeIntersection(e,n){return this.pointerCapture!=null?this.intersector.intersectPointerCapture(this.pointerCapture,n):(this.intersector.startIntersection(n),d8(e,[this]),this.intersector.finalizeIntersection(e))}setIntersection(e){this.intersection=e}commit(e,n){var l;const r=this.getCamera(),i=this.prevEnabled?this.prevIntersection:void 0,s=this.enabled?this.intersection:void 0;i!=null&&i.object!=(s==null?void 0:s.object)&&Oo(new Hs("pointerout",!0,e,this,i,r));const o=this.pointerEntered;this.pointerEntered=[],this.pointerEnteredHelper.length=0,cX(s==null?void 0:s.object,this.pointerEntered,o,this.pointerEnteredHelper);const a=o.length;for(let c=0;c<a;c++){const u=o[c];Oo(new Hs("pointerleave",!1,e,this,i,r,u))}s!=null&&(i==null?void 0:i.object)!=s.object&&Oo(new Hs("pointerover",!0,e,this,s,r));for(let c=this.pointerEnteredHelper.length-1;c>=0;c--){const u=this.pointerEnteredHelper[c];Oo(new Hs("pointerenter",!1,e,this,s,r,u))}if(n&&s!=null&&Oo(new Hs("pointermove",!0,e,this,s,r)),this.prevIntersection=this.intersection,this.prevEnabled=this.enabled,!this.wasMoved&&this.intersector.isReady()){this.wasMoved=!0;const c=this.onFirstMove.length;for(let u=0;u<c;u++)this.onFirstMove[u](r);this.onFirstMove.length=0}(l=this.onMoveCommited)==null||l.call(this,this)}move(e,n){this.intersection=this.computeIntersection(e,n),this.commit(n,!0)}emitMove(e){this.intersection!=null&&Oo(new Hs("pointermove",!0,e,this,this.intersection,this.getCamera()))}down(e){if(this.buttonsDown.add(e.button),!this.enabled)return;if(!this.wasMoved){this.onFirstMove.push(this.down.bind(this,e));return}if(this.intersection==null)return;Oo(new Hs("pointerdown",!0,e,this,this.intersection,this.getCamera()));const{object:n}=this.intersection;n[Eg]??(n[Eg]=new Map),n[Eg].set(e.button,e.timeStamp),this.buttonsDownTime.set(e.button,e.timeStamp)}up(e){if(this.buttonsDown.delete(e.button),!this.enabled)return;if(!this.wasMoved){this.onFirstMove.push(this.up.bind(this,e));return}if(this.intersection==null)return;const{contextMenuButton:n=2,dblClickThresholdMs:r=500,clickThesholdMs:i=300}=this.options;this.pointerCapture=void 0;const s=Xwe(this.buttonsDownTime,this.intersection.object[Eg],e.button,e.timeStamp,i),o=this.getCamera();if(s&&e.button===n&&Oo(new Hs("contextmenu",!0,e,this,this.intersection,o)),Oo(new Hs("pointerup",!0,e,this,this.intersection,o)),!s||e.button===n)return;Oo(new Hs("click",!0,e,this,this.intersection,o));const{object:a}=this.intersection,l=a[zT]??(a[zT]=new Map),c=l.get(e.button);if(c==null||e.timeStamp-c>r){l.set(e.button,e.timeStamp);return}Oo(new Hs("dblclick",!0,e,this,this.intersection,o)),l.delete(e.button)}cancel(e){if(this.enabled){if(!this.wasMoved){this.onFirstMove.push(this.cancel.bind(this,e));return}this.intersection!=null&&Oo(new Hs("pointercancel",!0,e,this,this.intersection,this.getCamera()))}}wheel(e,n,r=!1){if(!this.enabled)return;if(!this.wasMoved&&r){this.onFirstMove.push(this.wheel.bind(this,e,n,r));return}r||(this.wheelIntersection=this.computeIntersection(e,n));const i=r?this.intersection:this.wheelIntersection;i!=null&&Oo(new F_(n,this,i,this.getCamera()))}emitWheel(e,n=!1){if(!this.enabled)return;if(!this.wasMoved&&n){this.onFirstMove.push(this.emitWheel.bind(this,e,n));return}const r=n?this.intersection:this.wheelIntersection;r!=null&&Oo(new F_(e,this,r,this.getCamera()))}exit(e){var n;this.wasMoved&&(this.pointerCapture!=null&&((n=this.parentReleasePointerCapture)==null||n.call(this),this.pointerCapture=void 0),this.intersection=void 0,this.commit(e,!1)),this.onFirstMove.length=0,this.wasMoved=!1}}function cX(t,e,n,r){if(t==null)return;const i=n.indexOf(t);i!=-1?n.splice(i,1):r.push(t),e.push(t),cX(t.parent,e,n,r)}function Xwe(t,e,n,r,i){if(e==null)return!1;const s=e.get(n);return!(s==null||r-s>i||s!=t.get(n))}function CE(t){return t.transformReady===!1?!1:t.parent==null?(t.matrixWorld.copy(t.matrix),!0):CE(t.parent)?(t.matrixWorld.multiplyMatrices(t.parent.matrixWorld,t.matrix),!0):!1}const wg=new Ci,HT=new Ci,FN=new Ke,UN=new Ke,BN=new Ke,GT=new $,qwe=new et,Rx=new $;function RE(t,e,n){Rx.copy(e).applyMatrix4(qwe.copy(n.matrixWorld).invert());const r=n.geometry.attributes.uv;if(r==null||!(r instanceof fn))return!1;let i;return Ywe(n,(s,o,a)=>{n.getVertexPosition(s,wg.a),n.getVertexPosition(o,wg.b),n.getVertexPosition(a,wg.c);const l=wg.closestPointToPoint(Rx,GT).distanceTo(Rx);i!=null&&l>=i||(i=l,HT.copy(wg),FN.fromBufferAttribute(r,s),UN.fromBufferAttribute(r,o),BN.fromBufferAttribute(r,a))}),i==null?!1:(HT.closestPointToPoint(Rx,GT),HT.getInterpolation(GT,FN,UN,BN,t),!0)}function Ywe(t,e){const n=t.geometry.drawRange;if(t.geometry.index!=null){const o=t.geometry.index,a=Math.max(0,n.start),l=Math.min(o.count,n.start+n.count);for(let c=a;c<l;c+=3)e(o.getX(c),o.getX(c+1),o.getX(c+2));return}const r=t.geometry.attributes.position;if(r==null)return;const i=Math.max(0,n.start),s=Math.min(r.count,n.start+n.count);for(let o=i;o<s;o+=3)e(o,o+1,o+2)}const Kwe=new et,jT=new qa,zN=new Oi,Zwe=new Yo,HN=new Ke,GN=[new $(0,0,0),new $(0,0,1)];class Qwe{constructor(e,n){$t(this,"space");$t(this,"options");$t(this,"raycasters",[]);$t(this,"fromMatrixWorld",new et);$t(this,"ready");$t(this,"intersects",[]);$t(this,"pointerEventsOrders",[]);$t(this,"raycasterIndices",[]);this.space=e,this.options=n}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){const e=this.space.current;return e==null?this.ready=!1:(this.ready=CE(e),this.ready?(this.fromMatrixWorld.copy(e.matrixWorld),!0):!1)}intersectPointerCapture({intersection:e,object:n}){const r=e.details;if(r.type!="lines")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a lines intersector`);if(!this.prepareTransformation())return e;const i=this.options.linePoints??GN;jT.set(i[r.lineIndex],i[r.lineIndex+1]).applyMatrix4(this.fromMatrixWorld);const s=jT.at(r.distanceOnLine/jT.distance(),new $);e.object.updateWorldMatrix(!0,!1),AE(zN,e,e.object.matrixWorld);const o=Zwe.intersectPlane(zN,new $)??s;let a=e.uv;return e.object instanceof ln&&RE(HN,s,e.object)&&(a=HN.clone()),{...e,object:n,uv:a,pointOnFace:o,point:s,pointerPosition:new $().setFromMatrixPosition(this.fromMatrixWorld),pointerQuaternion:new bn().setFromRotationMatrix(this.fromMatrixWorld)}}startIntersection(){if(!this.prepareTransformation())return;const e=this.options.linePoints??GN,n=e.length-1;for(let r=0;r<n;r++){const i=e[r],s=e[r+1],o=this.raycasters[r]??(this.raycasters[r]=new oh);o.ray.origin.copy(i).applyMatrix4(this.fromMatrixWorld),o.ray.direction.copy(s).applyMatrix4(this.fromMatrixWorld),o.ray.direction.sub(o.ray.origin);const a=o.ray.direction.length();o.ray.direction.divideScalar(a),o.far=a}this.raycasters.length=n}executeIntersection(e,n){if(!this.isReady())return;const r=this.intersects.length,i=this.raycasters.length;for(let s=0;s<i;s++){const o=this.raycasters[s],a=this.intersects.length;e.raycast(o,this.intersects),J1(this.raycasterIndices,s,this.intersects.length-a)}J1(this.pointerEventsOrders,n,this.intersects.length-r)}finalizeIntersection(e){const n=new $().setFromMatrixPosition(this.fromMatrixWorld),r=new bn().setFromRotationMatrix(this.fromMatrixWorld),i=ME(this.intersects,this.pointerEventsOrders,this.options),s=i==null?void 0:this.intersects[i],o=i==null?void 0:this.raycasterIndices[i];if(this.intersects.length=0,this.raycasterIndices.length=0,this.pointerEventsOrders.length=0,s==null||o==null){const l=this.raycasters.length-1,c=this.raycasters.reduce((f,d,h)=>h===l?f:f+d.far,0),u=this.raycasters[l];return h8(e,u.ray,f=>({lineIndex:this.raycasters.length-1,distanceOnLine:f,type:"lines"}),n,r,c)}let a=s.distance;for(let l=0;l<o;l++)a+=this.raycasters[l].far;return s.object.updateWorldMatrix(!0,!1),Object.assign(s,{details:{lineIndex:o,distanceOnLine:s.distance,type:"lines"},distance:a,pointerPosition:n,pointerQuaternion:r,pointOnFace:s.point,localPoint:s.point.clone().applyMatrix4(Kwe.copy(s.object.matrixWorld).invert())})}}const oM=new et,aM=new $,Jwe=new $(0,0,-1),eSe=new $,jN=new Oi,U_=new Ke;class tSe{constructor(e,n){$t(this,"space");$t(this,"options");$t(this,"raycaster",new oh);$t(this,"raycasterQuaternion",new bn);$t(this,"worldScale",0);$t(this,"ready");$t(this,"intersects",[]);$t(this,"pointerEventsOrders",[]);this.space=e,this.options=n}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){var n;const e=this.space.current;return e==null?this.ready=!1:(this.ready=CE(e),this.ready?(e.matrixWorld.decompose(this.raycaster.ray.origin,this.raycasterQuaternion,aM),this.worldScale=aM.x,this.raycaster.ray.direction.copy(((n=this.options)==null?void 0:n.direction)??Jwe).applyQuaternion(this.raycasterQuaternion),!0):!1)}intersectPointerCapture({intersection:e,object:n}){if(e.details.type!="ray")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a ray intersector`);if(!this.prepareTransformation())return e;e.object.updateWorldMatrix(!0,!1),AE(jN,e,e.object.matrixWorld);const{ray:r}=this.raycaster,i=r.intersectPlane(jN,new $)??e.point,s=r.direction.clone().multiplyScalar(e.distance).add(r.origin);let o=e.uv;return e.object instanceof ln&&RE(U_,s,e.object)&&(o=U_.clone()),{...e,uv:o,object:n,pointOnFace:i,point:s,pointerPosition:r.origin.clone(),pointerQuaternion:this.raycasterQuaternion.clone()}}startIntersection(){this.prepareTransformation()}executeIntersection(e,n){if(!this.isReady())return;const r=this.intersects.length;e.raycast(this.raycaster,this.intersects),J1(this.pointerEventsOrders,n,this.intersects.length-r)}finalizeIntersection(e){const n=this.raycaster.ray.origin.clone(),r=this.raycasterQuaternion.clone();let i;if(this.options.minDistance!=null){const a=this.options.minDistance/this.worldScale;i=l=>l.distance>=a}const s=ME(this.intersects,this.pointerEventsOrders,this.options,i),o=s==null?void 0:this.intersects[s];return this.intersects.length=0,this.pointerEventsOrders.length=0,o==null?h8(e,this.raycaster.ray,()=>({type:"ray"}),n,r):(o.object.updateWorldMatrix(!0,!1),Object.assign(o,{details:{type:"ray"},pointerPosition:n,pointerQuaternion:r,pointOnFace:o.point,localPoint:o.point.clone().applyMatrix4(oM.copy(o.object.matrixWorld).invert())}))}}class nSe{constructor(e,n){$t(this,"prepareTransformation");$t(this,"options");$t(this,"raycaster",new oh);$t(this,"fromPosition",new $);$t(this,"fromQuaternion",new bn);$t(this,"coords",new Ke);$t(this,"viewPlane",new Oi);$t(this,"intersects",[]);$t(this,"pointerEventsOrders",[]);this.prepareTransformation=e,this.options=n}isReady(){return!0}intersectPointerCapture({intersection:e,object:n},r){const i=e.details;if(i.type!="screen-ray")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a camera ray intersector`);if(!this.startIntersection(r))return e;this.viewPlane.constant-=i.distanceViewPlane;const s=this.raycaster.ray.intersectPlane(this.viewPlane,new $);if(s==null)return e;e.object.updateWorldMatrix(!0,!1),AE(this.viewPlane,e,e.object.matrixWorld);let o=e.uv;return e.object instanceof ln&&RE(U_,s,e.object)&&(o=U_.clone()),{...e,details:{...i,screenPoint:this.coords.clone()},uv:o,object:n,point:s,pointOnFace:s,pointerPosition:this.fromPosition.clone(),pointerQuaternion:this.fromQuaternion.clone()}}startIntersection(e){const n=this.prepareTransformation(e,this.coords);return n==null?!1:(n.updateWorldMatrix(!0,!1),n.matrixWorld.decompose(this.fromPosition,this.fromQuaternion,aM),this.raycaster.setFromCamera(this.coords,n),this.viewPlane.setFromNormalAndCoplanarPoint(n.getWorldDirection(eSe),this.raycaster.ray.origin),!0)}executeIntersection(e,n){const r=this.intersects.length;e.raycast(this.raycaster,this.intersects),J1(this.pointerEventsOrders,n,this.intersects.length-r)}finalizeIntersection(e){const n=this.fromPosition.clone(),r=this.fromQuaternion.clone(),i=ME(this.intersects,this.pointerEventsOrders,this.options),s=i==null?void 0:this.intersects[i];return this.intersects.length=0,this.pointerEventsOrders.length=0,s==null?h8(e,this.raycaster.ray,o=>({type:"screen-ray",distanceViewPlane:o,screenPoint:this.coords.clone()}),n,r):(s.object.updateWorldMatrix(!0,!1),oM.copy(s.object.matrixWorld).invert(),Object.assign(s,{details:{type:"screen-ray",distanceViewPlane:this.viewPlane.distanceToPoint(s.point),screenPoint:this.coords.clone()},pointOnFace:s.point,pointerPosition:n,pointerQuaternion:r,localPoint:s.point.clone().applyMatrix4(oM)}))}}const rSe=new $,VN=new Ke;class uX{constructor(e,n,r){$t(this,"space");$t(this,"getSphereRadius");$t(this,"options");$t(this,"fromPosition",new $);$t(this,"fromQuaternion",new bn);$t(this,"collisionSphere",new wr);$t(this,"ready");$t(this,"intersects",[]);$t(this,"pointerEventsOrders",[]);this.space=e,this.getSphereRadius=n,this.options=r}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){const e=this.space.current;return e==null?this.ready=!1:(this.ready=CE(e),this.ready?(e.matrixWorld.decompose(this.fromPosition,this.fromQuaternion,rSe),!0):!1)}intersectPointerCapture({intersection:e,object:n}){if(e.details.type!="sphere")throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a sphere intersector`);if(!this.prepareTransformation())return e;WN.copy(e.point).sub(e.pointerPosition),$N.copy(e.pointerQuaternion).invert().multiply(this.fromQuaternion);const r=WN.clone().applyQuaternion($N).add(this.fromPosition);e.object.updateWorldMatrix(!0,!1),AE(XN,e,e.object.matrixWorld);const i=XN.projectPoint(this.fromPosition,new $);let s=e.uv;return e.object instanceof ln&&RE(VN,r,e.object)&&(s=VN.clone()),{details:{type:"sphere"},uv:s,distance:e.distance,pointerPosition:this.fromPosition.clone(),pointerQuaternion:this.fromQuaternion.clone(),object:n,point:r,pointOnFace:i,face:e.face,localPoint:e.localPoint}}startIntersection(){this.prepareTransformation()&&(this.collisionSphere.center.copy(this.fromPosition),this.collisionSphere.radius=this.getSphereRadius())}executeIntersection(e,n){if(!this.isReady())return;const r=this.intersects.length;sSe(this.collisionSphere,e,this.intersects),J1(this.pointerEventsOrders,n,this.intersects.length-r)}finalizeIntersection(e){const n=this.fromPosition.clone(),r=this.fromQuaternion.clone(),i=ME(this.intersects,this.pointerEventsOrders,this.options),s=i==null?void 0:this.intersects[i];return this.intersects.length=0,this.pointerEventsOrders.length=0,s==null?{details:{type:"sphere"},distance:0,point:n,object:aX(e),pointerPosition:n,pointerQuaternion:r,pointOnFace:n,localPoint:n}:(s.object.updateWorldMatrix(!0,!1),Object.assign(s,{details:{type:"sphere"},pointOnFace:s.point,pointerPosition:this.fromPosition.clone(),pointerQuaternion:this.fromQuaternion.clone(),localPoint:s.point.clone().applyMatrix4(B_.copy(s.object.matrixWorld).invert())}))}}const Ix=new et;function iSe(t){return"spherecast"in t}function sSe(t,e,n){if(e.updateWorldMatrix(!0,!1),iSe(e)){e.spherecast(t,n);return}if(e instanceof eh){e.geometry.boundingSphere==null&&e.geometry.computeBoundingSphere(),e.geometry.boundingBox==null&&e.geometry.computeBoundingBox();for(let i=0;i<e.count;i++){if(e.getMatrixAt(i,Ix),Ix.premultiply(e.matrixWorld),!qN(t,e,Ix))continue;const s=KN(t,e,Ix,i);s!=null&&n.push(s)}}if(!(e instanceof ln)||!qN(t,e,e.matrixWorld))return;B_.copy(e.matrixWorld).invert();const r=KN(t,e,e.matrixWorld);r!=null&&n.push(r)}const WN=new $,$N=new bn,XN=new Oi,dm=new wr;function qN(t,{geometry:e},n){return e.boundingSphere==null&&e.computeBoundingSphere(),dm.copy(e.boundingSphere).applyMatrix4(n),dm.center.distanceToSquared(t.center)<(t.radius+dm.radius)**2}const Px=new $,VT=new $,YN=new $,oSe=new $(1e-4,1e-4,1e-4),B_=new et;function KN(t,e,n,r){B_.copy(n).invert(),dm.copy(t).applyMatrix4(B_);const{geometry:i}=e;i.boundingBox==null&&i.computeBoundingBox(),i.boundingBox.getSize(VT),i.boundingBox.getCenter(YN),i.boundingBox.clampPoint(dm.center,Px),Px.applyMatrix4(n);const s=Px.distanceToSquared(t.center);if(s>t.radius*t.radius)return;VT.max(oSe);const o=dm.center.clone().sub(YN);o.divide(VT),aSe(o);const a=Px.clone();return{distance:Math.sqrt(s),face:{a:0,b:0,c:0,materialIndex:0,normal:o},normal:o,point:a,instanceId:r,object:e}}function aSe(t){const e=Math.abs(t.x),n=Math.abs(t.y),r=Math.abs(t.z);if(e>=n&&e>=r){t.set(t.x<0?-1:1,0,0);return}if(n>=e&&n>=r){t.set(0,t.y<0?-1:1,0);return}t.set(0,0,t.z<0?-1:1)}function lSe(t,e,n,r={},i="grab"){return new r0(Fy(),i,n,new uX(e,()=>r.radius??.07,r),t,void 0,void 0,void 0,r)}function cSe(t,e,n,r={},i="ray"){return new r0(Fy(),i,n,new tSe(e,r),t,void 0,void 0,void 0,r)}function uSe(t,e,n,r={},i="lines"){return new r0(Fy(),i,n,new Qwe(e,r),t,void 0,void 0,void 0,r)}function fSe(t,e,n,r={},i="touch"){return new r0(Fy(),i,n,new uX(e,()=>r.hoverRadius??.1,r),t,dSe(r),void 0,void 0,r)}function dSe(t){let e=!1;return n=>{if(!n.getEnabled())return;const r=n.getIntersection(),i=hSe(r,t.downRadius??.03);if(i===e)return;const s={timeStamp:performance.now(),button:t.button??0};i?n.down(s):n.up(s),e=i}}function hSe(t,e){return t==null?!1:t.distance<=e}let pSe=23412;function Fy(){return pSe++}function mSe(t,e,n){if(!(e instanceof globalThis.MouseEvent))return n.set(0,0);const{width:r,height:i,top:s,left:o}=t.getBoundingClientRect(),a=e.pageX-o,l=e.pageY-s;return n.set(a/r*2-1,-(l/i)*2+1)}function Z$e(t,e,n,r){return fX(t,typeof e=="function"?e:()=>e,n,mSe.bind(null,t),t.setPointerCapture.bind(t),t.releasePointerCapture.bind(t),{pointerTypePrefix:"screen-",...r})}function gSe(t,e){return!(t instanceof Hs)||t.uv==null?e.set(0,0):e.copy(t.uv).multiplyScalar(2).addScalar(-1)}function ySe(t,e,n,r){return fX(t,e,n,gSe,t.setPointerCapture.bind(t),t.releasePointerCapture.bind(t),r)}function fX(t,e,n,r,i,s,o={}){const a=(o==null?void 0:o.forwardPointerCapture)??!0,l=new Map,c=o.pointerTypePrefix??"forward-",u=(C,A)=>{let R=l.get(C.pointerId);return R!=null||(R=new r0(Fy(),`${c}${C.pointerType}`,C.pointerState,new nSe((M,D)=>(r(M,D),e()),o),e,void 0,a?i.bind(null,C.pointerId):void 0,a?s.bind(null,C.pointerId):void 0,o),A!="move"&&A!="wheel"&&(R.setIntersection(R.computeIntersection(n,C)),R.commit(C,!1)),l.set(C.pointerId,R)),R},f=new Map,d=new Map,h=[],p=[],m=(C,A,R)=>{switch(C){case"move":R.move(n,A);return;case"wheel":R.wheel(n,A);return;case"cancel":R.cancel(A);return;case"down":if(!ZN(A))return;R.down(A);return;case"up":if(!ZN(A))return;R.up(A);return;case"exit":d.delete(R),f.delete(R),R.exit(A);return}},g=(C,A)=>{const R=u(A,C);C==="move"&&d.set(R,A),C==="wheel"&&f.set(R,A),o.batchEvents??!0?p.push({type:C,event:A}):m(C,A,R)},y=g.bind(null,"move"),x=g.bind(null,"cancel"),_=g.bind(null,"down"),w=g.bind(null,"up"),T=g.bind(null,"wheel"),S=g.bind(null,"exit");return t.addEventListener("pointermove",y),t.addEventListener("pointercancel",x),t.addEventListener("pointerdown",_),t.addEventListener("pointerup",w),t.addEventListener("wheel",T),t.addEventListener("pointerleave",S),{destroy(){t.removeEventListener("pointermove",y),t.removeEventListener("pointercancel",x),t.removeEventListener("pointerdown",_),t.removeEventListener("pointerup",w),t.removeEventListener("wheel",T),t.removeEventListener("pointerleave",S),d.clear(),f.clear()},update(){const C=p.length;for(let A=0;A<C;A++){const{type:R,event:M}=p[A],D=u(M,R);if(R==="move"&&(h.push(D),d.get(D)!=M)){D.emitMove(M);continue}if(R==="wheel"&&f.get(D)!=M){D.emitWheel(M);continue}m(R,M,D)}if(p.length=0,o.intersectEveryFrame??!1)for(const[A,R]of d.entries())h.includes(A)||A.move(n,R);h.length=0}}}function ZN(t){return t.button!=null}let dX=class lM{constructor(e){$t(this,"enableMultiplePointers");$t(this,"pointers",[]);$t(this,"isDefaults",[]);$t(this,"enabled",!0);$t(this,"activePointer");$t(this,"nonCapturedPointers",[]);this.enableMultiplePointers=e}register(e,n=!1){return this.pointers.push(e),this.isDefaults.push(n),this.unregister.bind(this,e)}unregister(e){const n=this.pointers.indexOf(e);n!==-1&&(this.isDefaults.splice(n,1),this.pointers.splice(n,1))}startIntersection(e,n){const r=this.pointers.length;let i=!1;for(let s=0;s<r;s++){const o=this.pointers[s];if(o instanceof lM){o.startIntersection(e,n);continue}const a=o.getPointerCapture();if(a!=null){i=!0,o.setIntersection(o.intersector.intersectPointerCapture(a,n));continue}e.push(o),o.intersector.startIntersection(n)}return i}getIntersection(){var e;return(e=this.activePointer)==null?void 0:e.getIntersection()}getPointerCapture(){var e;return(e=this.activePointer)==null?void 0:e.getPointerCapture()}computeActivePointer(){let e;this.activePointer=void 0;const n=this.pointers.length;for(let r=0;r<n;r++){const i=this.pointers[r];i instanceof lM&&i.computeActivePointer();const s=i.getIntersection(),o=i.getPointerCapture()!=null?-1/0:s!=null&&s.object.isVoidObject?1/0:(s==null?void 0:s.distance)??1/0,a=this.isDefaults[r];(e==null||a&&o===e||o<e)&&(this.activePointer=i,e=o)}}commit(e,n,r=!0){if(this.enableMultiplePointers){const s=this.pointers.length;for(let o=0;o<s;o++)this.pointers[o].commit(e,n);return}r&&this.computeActivePointer();const i=this.pointers.length;for(let s=0;s<i;s++){const o=this.pointers[s];o.setEnabled(o===this.activePointer,e,!1),o.commit(e,n,!1)}}move(e,n){if(!this.enabled)return;if(this.nonCapturedPointers.length=0,!this.startIntersection(this.nonCapturedPointers,n)||this.enableMultiplePointers){d8(e,this.nonCapturedPointers);const i=this.nonCapturedPointers.length;for(let s=0;s<i;s++){const o=this.nonCapturedPointers[s];o.setIntersection(o.intersector.finalizeIntersection(e))}}this.commit(n,!0)}setEnabled(e,n){this.enabled=e;const r=this.pointers.length;for(let i=0;i<r;i++){const s=this.pointers[i];s.setEnabled(e&&(this.enableMultiplePointers||s==this.activePointer),n)}}};function QN(t,e){if(e!=null&&e.createdAt!=null&&e.createdAt>=t.lastChangedTime)return e;const n=new gn;return n.setIndex(new fn(t.indices,1)),n.setAttribute("position",new fn(t.vertices,3)),Object.assign(n,{creationTime:t.lastChangedTime})}function JN(t,e){return e!=null&&e.createdAt!=null&&e.createdAt>=t.lastChangedTime?e:Object.assign(vSe(t.polygon),{createdAt:t.lastChangedTime})}const Sg=new W6,kx=new Ke;function vSe(t){if(t.length===0)return new gn;const e=new tc,n=t.map(({x:i,z:s})=>new Ke(i,s));Sg.setFromPoints(n),Sg.getSize(kx);for(const i of n)i.sub(Sg.min),i.divide(kx);e.setFromPoints(n);const r=new by(e);return r.scale(kx.x,kx.y,1),r.translate(Sg.min.x,Sg.min.y,0),r.rotateX(Math.PI/2),r}function ef(t,e=1){if(t!=null)return{x:t.x,y:t.y,z:t.z,w:"w"in t?t.w:e}}const m8=60/180*Math.PI,hX=60/180*Math.PI,pX=-30/180*Math.PI,mX=30/180*Math.PI;function xSe(t,e,n,r,i,s){return t instanceof HTMLVideoElement?_Se(t,e,r,i,s):bSe(t,e,n,r,i,s)}function _Se(t,e,n,{invertStereo:r,layout:i,shape:s="quad"},o={}){var d;const a=TE(n,e.origin,e.originReferenceSpace,Sm);if(a==null)return;const l=g8(Sm,Yd),c={invertStereo:r,layout:i,space:a,transform:l};v8(s,c,o.centralAngle,Yd);const u=`create${gX(s)}Layer`,f=(d=e.mediaBinding)==null?void 0:d[u](t,c);if(f!=null)return y8(f,o),f}function bSe(t,e,n,r,{shape:i="quad",...s},o={}){var d;const a=TE(r,e.origin,e.originReferenceSpace,Sm);if(a==null)return;const l=g8(Sm,Yd),c={...s,isStatic:!(t instanceof fr),textureType:"texture",viewPixelWidth:s.layout==="stereo-left-right"?t.width/2:t.width,viewPixelHeight:s.layout==="stereo-top-bottom"?t.height/2:t.height,space:a,transform:l};v8(i,c,o.centralAngle,Yd);const u=`create${gX(i)}Layer`,f=(d=n.getBinding())==null?void 0:d[u](c);if(f!=null)return y8(f,o),f}const Sm=new et,eO=new $,tO=new bn,Yd=new $;function g8(t,e=Yd){return t.decompose(eO,tO,e),new XRRigidTransform(ef(eO),ef(tO))}function ESe(t,e,n,r){if(n!=null&&r!=null){const i=t.xr.getBinding().getSubImage(n.layer,r);t.setRenderTargetTextures(e,i.colorTexture)}t.setRenderTarget(e)}function wSe(t,e){switch(t){case"cylinder":const n=e.centralAngle??m8;return new hu(1,1,1,32,1,!0,Math.PI-n/2,n).scale(-1,1,1);case"equirect":{const r=e.centralHorizontalAngle??hX,i=e.upperVerticalAngle??mX;return new Tf(1,32,16,-Math.PI/2-r/2,r,Math.PI/2-i,i-(e.lowerVerticalAngle??pX)).scale(-1,1,1)}case"quad":return new Ps}}function gX(t){return`${t[0].toUpperCase()}${t.slice(1)}`}function y8(t,e={}){if(t.chromaticAberrationCorrection=e.chromaticAberrationCorrection,t.quality=e.quality??"default",t.blendTextureSourceAlpha=e.blendTextureSourceAlpha??!1,t instanceof XRCylinderLayer){t.centralAngle=(e==null?void 0:e.centralAngle)??m8;return}t instanceof XREquirectLayer&&(t.centralHorizontalAngle=(e==null?void 0:e.centralHorizontalAngle)??hX,t.lowerVerticalAngle=(e==null?void 0:e.lowerVerticalAngle)??pX,t.upperVerticalAngle=(e==null?void 0:e.upperVerticalAngle)??mX)}function SSe(t,e,n,r){let i=!1;const s=async()=>{const o=await e.requestFrame();i||MSe(t,n,o,r)};return n.addEventListener("redraw",s),s(),()=>{i=!0,n.removeEventListener("redraw",s)}}async function TSe(t){if(t instanceof HTMLImageElement&&!t.complete&&await new Promise(e=>{const n=()=>{e(),t.removeEventListener("load",n)};t.addEventListener("load",n)}),t instanceof HTMLVideoElement&&t.readyState<1)return new Promise(e=>{const n=()=>{e(),t.removeEventListener("loadedmetadata",n)};t.addEventListener("loadedmetadata",n)})}function ASe(t){if(t instanceof fr)return t.texture;const e=t instanceof HTMLVideoElement?new E6(t):new tr(t);return e.colorSpace=Er,e.needsUpdate=!0,e}function MSe(t,e,n,r){const i=t.getContext(),s=t.xr.getBinding().getSubImage(e,n);t.state.bindTexture(i.TEXTURE_2D,s.colorTexture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texSubImage2D(i.TEXTURE_2D,0,0,0,r.width,r.height,i.RGBA,i.UNSIGNED_BYTE,r)}function CSe(t,e,n,r){t.originReferenceSpace!=null&&(e.space=TE(r,t.origin,t.originReferenceSpace,Sm),e.transform=g8(Sm,Yd),v8(RSe(e),e,n,Yd))}function v8(t,e,n,r){if(t==="cylinder"){const s=(r.x+r.z)/2,o=s*(n??m8);e.radius=s,e.aspectRatio=o/r.y}else t==="quad"?(e.width=r.x/2,e.height=r.y/2):e.radius=(r.x+r.y+r.z)/3}function RSe(t){return t instanceof XRCylinderLayer?"cylinder":t instanceof XREquirectLayer?"equirect":"quad"}function yX(t,e,n){return new fr(t*n,e*n,{minFilter:Pn,magFilter:Pn,type:ti,depthTexture:new Bm(t,e)})}const WT=new $,nO=new $,rO=new $,iO=new bn;function Q$e(t,e,n,r){return e.getWorldQuaternion(iO),nO.copy(n).applyQuaternion(iO),e.getWorldPosition(rO),t.getWorldPosition(WT),WT.sub(rO),WT.angleTo(nO)<r/2}function ISe(t,e,n){t.traverse(i=>i.userData.teleportTarget=!0);const r=i=>{if("point"in i&&i.point instanceof $){const s=typeof e=="function"?e():e,o=new $().setFromMatrixPosition(s.matrix).negate().setComponent(1,0).add(i.point);n(o,i)}};return t.addEventListener("pointerup",r),()=>{t.traverse(i=>i.userData.teleportTarget=!1),t.removeEventListener("pointerup",r)}}const Tg=new xr(0,0,0,"YXZ"),Lx=new bn;function PSe(t,e,n){t.updateWorldMatrix(!0,!1),t.matrixWorld.decompose(e.position,Lx,e.scale),Tg.setFromQuaternion(Lx),Tg.z=0,Tg.x=_3(Tg.x-10*Math.PI/180,-Math.PI/2,1.1*Math.PI/4),Lx.setFromEuler(Tg),e.quaternion.slerp(Lx,n/100)}function kSe(t){return t.userData.teleportTarget===!0}function LSe(t={}){return(e,n,r,i)=>!(!kSe(e)||t.filter!=null&&!t.filter(e,n,r,i))}function DSe(){return new gy(new $(0,0,0),new $(0,0,-8),new $(0,-20,-15)).getPoints(20)}let NSe=class extends ln{constructor(n){const r=new lj,i=new Float32Array(n.length*3);for(let a=0;a<n.length;a++)n[a].toArray(i,a*3);r.setPoints(i);const s=(n.length*3-3)/(n.length*3-1),o=new cj({lineWidth:.1,resolution:void 0,visibility:s});super(r,o);$t(this,"multiplier");$t(this,"lineLengths");$t(this,"options",{});this.material.transparent=!0,this.multiplier=s,this.material=o,this.lineLengths=n.slice(0,-1).map((a,l)=>a.distanceTo(n[l+1]))}update(n){const r=n.getEnabled(),i=n.getIntersection();if(!r||n.getButtonsDown().size===0||i==null){this.visible=!1;return}if(this.visible=!0,i.details.type!="lines"){this.material.visibility=this.multiplier;return}const{distanceOnLine:s,lineIndex:o}=i.details,a=this.lineLengths[o];this.material.visibility=this.multiplier*(o+s/a)/this.lineLengths.length;const{color:l="white",opacity:c=.4,size:u=.01}=this.options;this.material.lineWidth=u,this.material.opacity=typeof c=="function"?c(n):c;const f=typeof l=="function"?l(n):l;Array.isArray(f)?this.material.color.set(...f):this.material.color.set(f)}};const $T=new et,Dx=new $,sO=new bn;async function vX(t,e,n=["point","plane","mesh"]){var c,u;const r=t.getState();if(typeof e=="string"){if(r.session==null)return;e=await r.session.requestReferenceSpace(e)}const i=Array.isArray(n)?n:[n];let s,o,a;if(e instanceof XRSpace)s={space:e,entityTypes:i},a=r.origin;else{const f=TE(e,r.origin,r.originReferenceSpace,$T);if(f==null)return;Dx.setFromMatrixPosition($T);const d=ef(Dx);sO.setFromRotationMatrix($T),Dx.set(0,0,-1).applyQuaternion(sO);const h=new XRRay(d,ef(Dx,0));a=e,s={space:f,offsetRay:h,entityTypes:i},o=f}const l=await((u=(c=t.getState().session)==null?void 0:c.requestHitTestSource)==null?void 0:u.call(c,s));if(l!=null)return{source:l,getWorldMatrix:FSe.bind(null,t,o,a)}}async function OSe(t,e,n){var l;const r=await vX(t,e,n);if(r==null)return;const{source:i,getWorldMatrix:s}=r,o=await t.requestFrame(),a=((l=o.getHitTestResults)==null?void 0:l.call(o,i))??[];if(i.cancel(),a!=null)return{results:a,getWorldMatrix:s}}function FSe(t,e,n,r,i){if(e??(e=t.getState().originReferenceSpace),e==null)return!1;const s=i.getPose(e);return s==null?!1:(r.fromArray(s.transform.matrix),n!=null&&(n.updateWorldMatrix(!0,!1),r.premultiply(n.matrixWorld)),!0)}const USe=new $(1,1,1),BSe=new $(0,0,0),zSe=new bn,oO=new et,XT=new et,Ag=new bn,Nx=new $,HSe=new $;async function eXe(t,e){var i,s,o;if(e.relativeTo==="hit-test-result")return(s=(i=e.hitTestResult).createAnchor)==null?void 0:s.call(i,new XRRigidTransform(ef(e.offsetPosition),ef(e.offsetQuaternion)));let n,r;if(e.relativeTo==="world"){n=e.frame??await t.requestFrame();const{origin:a,originReferenceSpace:l}=t.getState();if(l==null)return;r=l;const{worldPosition:c,worldQuaternion:u}=e;a!=null?(a.updateWorldMatrix(!0,!1),oO.copy(a.matrixWorld).invert(),XT.compose(c,u,USe).multiply(oO),XT.decompose(Nx,Ag,HSe),Ag.setFromRotationMatrix(XT)):(Nx.copy(c),Ag.copy(u))}else{n=e.frame??await t.requestFrame(),r=e.space;const{offsetPosition:a,offsetQuaternion:l}=e;Nx.copy(a??BSe),Ag.copy(l??zSe)}return(o=n.createAnchor)==null?void 0:o.call(n,new XRRigidTransform(ef(Nx),ef(Ag)),r)}const GSe=2,jSe=2,VSe=45,aO=.5,lO="xr-standard-thumbstick",bp=new $,cO=new bn,WSe=new xr,$Se=new $,XSe=new $;function tXe(){let t=!0;return(e,n,r,i,s={},o={},a="left",...l)=>{var _;const{inputSourceStates:c}=n.getState(),u=a==="left"?"right":"left",f=c.find(w=>uO(w,a)),d=c.find(w=>uO(w,u));if(f==null||d==null)return;const h=f.gamepad[lO],p=(h==null?void 0:h.xAxis)??0,m=(h==null?void 0:h.yAxis)??0,g=((_=d.gamepad[lO])==null?void 0:_.xAxis)??0;let y;o!==!1&&(o===!0&&(o={}),o.type==="smooth"?Math.abs(g)>(o.deadZone??aO)&&(y=(g<0?-1:1)*i*(o.speed??jSe)):Math.abs(g)<(o.deadZone??aO)?t=!0:t&&(t=!1,y=(g>0?-1:1)*ri.degToRad(o.degrees??VSe)));const x=p!=0||m!=0;if(s!==!1&&x){s===!0&&(s={});const{speed:w=GSe}=s;bp.set(p*w,0,m*w),r.matrixWorld.decompose($Se,cO,XSe),bp.applyQuaternion(cO),y&&bp.applyEuler(WSe.set(0,y,0,"YXZ"))}if(!(!x&&y==null)){if(typeof e=="function"){e(bp,y??0,...l);return}e!=null&&(e.position.x+=bp.x*i,e.position.z+=bp.z*i,e.rotation.y+=y??0)}}}function uO(t,e){return t.type==="controller"&&t.inputSource.handedness===e}const qSe=new Y$,xX="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/";function cM(t,...e){let n=t();for(const r of e)n instanceof Promise?n=n.then(r):n=r(n);return n}const YSe="generic-trigger";class _X{constructor(e){$t(this,"baseAssetPath");$t(this,"defaultProfileId");$t(this,"profilesListCache");$t(this,"profileCacheMap",new Map);$t(this,"loadAsync",this.load);this.baseAssetPath=(e==null?void 0:e.baseAssetPath)??xX,this.defaultProfileId=(e==null?void 0:e.defaultControllerProfileId)??YSe}load(e,n){return cM(()=>this.loadProfile(e),r=>{for(const i in r.layouts)if(i.includes(n))return r.layouts[i];throw new Error(`No matching layout for "${n}", in profile ${r.profileId} with layouts ${Object.keys(r.layouts).join(", ")}.`)})}loadProfile(e){return cM(()=>this.profilesListCache??fO(new URL("profilesList.json",this.baseAssetPath).href).then(n=>this.profilesListCache=n),n=>{const r=e.length;let i;for(let s=0;s<r&&(i=n[e[s]],i==null);s++);if(i??(i=n[this.defaultProfileId]),i==null)throw new Error(`no matching profile found for profiles "${e.join(", ")}" in profile list ${JSON.stringify(n)}`);return this.loadProfileFromPath(i.path)})}loadProfileFromPath(e){const n=this.profileCacheMap.get(e);if(n!=null)return n;const r=new URL(e,this.baseAssetPath).href;return fO(r).then(i=>{for(const s in i.layouts){const o=i.layouts[s];o!=null&&(o.assetPath=new URL(o.assetPath,r).href)}return this.profileCacheMap.set(e,i),i})}}async function fO(t){let e=await fetch(t);return e.ok?e.json():Promise.reject(new Error(e.statusText))}function KSe(t,e,n,r,i){return cM(()=>n.load(e.profiles,e.handedness),s=>{const o={};return q$(o,e,s),{id:t,isPrimary:i,events:r,type:"controller",inputSource:e,gamepad:o,layout:s}})}function ZSe({gamepad:t,inputSource:e,layout:n}){q$(t,e,n)}const bX=v.createContext(void 0),Mf=v.createContext(void 0),Uy=v.createContext(void 0),x8=v.createContext(void 0);let QSe=0;const dO=new Map;function IE(t){let e=dO.get(t);return e==null&&dO.set(t,e=QSe++),e}function nXe(t,e){let n,r;if(e==null){const[i,s]=v.useState(!1);n=s,r=i}else n=e;return v.useEffect(()=>{const{current:i}=t;if(i==null)return;const s=new Set,o=l=>{s.size===0&&n(!0),s.add(l.pointerId)},a=l=>{s.delete(l.pointerId),s.size===0&&n(!1)};return i.addEventListener("pointerenter",o),i.addEventListener("pointerleave",a),()=>{i.removeEventListener("pointerenter",o),i.removeEventListener("pointerleave",a)}},[t,n]),r}function JSe(){return nr(t=>t.visibilityState)}function rXe(){return nr(t=>{var e,n;return(n=(e=t.session)==null?void 0:e.initiateRoomCapture)==null?void 0:n.bind(t.session)})}function e4e(t,e){const n=v.useRef(e);n.current=e;const[r,i]=v.useMemo(()=>{let s;return[o=>{let a=!1;return typeof navigator>"u"||navigator.xr==null?(s=!1,()=>{}):(navigator.xr.isSessionSupported(t).then(l=>{s=l,!a&&o()}).catch(l=>{var c;a||(c=n.current)==null||c.call(n,l)}),()=>a=!0)},()=>s]},[t]);return v.useSyncExternalStore(r,i)}function t4e(t){return nr(({session:e})=>{var n;return((n=e==null?void 0:e.enabledFeatures)==null?void 0:n.includes(t))??!1})}function iXe(){return nr(t=>t.inputSourceStates)}function _8(t,e){return nr(n=>n.inputSourceStates.find(r=>r.type===t&&(e==null||r.inputSource.handedness===e)))}function ga(t){const e=v.useContext(Mf);if(e==null)throw new Error("useXRInputSourceStateContext() can only be used inside the xr store config");if(t!=null&&e.type!=t)throw new Error(`useXRInputSourceStateContext(${t}) can not be used inside a component for input type "${e.type}"`);return e}function sXe(t,e,n,r){const i=nr(s=>s.session);v.useEffect(()=>{if(!(i==null||t==null))return _we(i,t,e,n)},[e,t,i,...r])}const oXe=v.forwardRef(({id:t,children:e,onPress:n,onRelease:r},i)=>{const s=ga("controller"),[o,a]=v.useState(void 0);if(v.useImperativeHandle(i,()=>o,[o]),n4e(s,t,l=>l==="pressed"?n==null?void 0:n():r==null?void 0:r()),Yt(()=>{var l;return a((l=s.gamepad[t])==null?void 0:l.object)}),o!=null)return Al(e,o)});function n4e(t,e,n){const r=v.useRef();Yt(()=>{var s;const i=(s=t==null?void 0:t.gamepad[e])==null?void 0:s.state;i!=null&&i!=r.current&&n(i),r.current=i})}const EX=Symbol("loadXRControllerModel"),r4e=v.forwardRef((t,e)=>{const n=ga("controller"),r=ah(iX,[n.layout,void 0,EX]);Nwe(r,t),n.object=r,v.useImperativeHandle(e,()=>r,[r]);const i=v.useMemo(()=>Owe(r,n.layout,n.gamepad),[r,n.layout,n.gamepad]);return Yt(i),H.jsx(Il,{space:"grip-space",children:H.jsx("primitive",{object:r})})}),i4e=Symbol("loadXRControllerLayout");function aXe(t,e,{baseAssetPath:n,defaultControllerProfileId:r}={}){const i=v.useMemo(()=>new _X({baseAssetPath:n,defaultControllerProfileId:r}),[n,r]);return ah(()=>{const s=i.loadAsync(t,e);return s instanceof Promise?s:Promise.resolve(s)},[i4e,e,...t])}function lXe(t){return ah(iX,[t,void 0,EX])}const s4e=v.forwardRef((t,e)=>{const n=ga("hand"),r=rs(Y$,n.assetPath),i=v.useMemo(()=>iwe(r),[r]);swe(i,t),n.object=i,v.useImperativeHandle(e,()=>i,[i]);const s=E8(),o=v.useMemo(()=>cwe(n.inputSource.hand,i,s),[n.inputSource,i,s]);return Yt((a,l,c)=>o(c)),H.jsx("primitive",{object:i})}),cXe=v.forwardRef(({joint:t,children:e},n)=>H.jsx(Il,{ref:n,space:t,children:e}));function wX({children:t}){const e=v.useMemo(()=>new dX(!1),[]);return By(e),H.jsx(x8.Provider,{value:e,children:t})}function PE(t){for(const e of Object.keys(t))delete t[e]}function o4e(t,e,n,r){const i=v.useMemo(()=>({}),[]);PE(i),Object.assign(i,n);const s=el(),o=v.useMemo(()=>lSe(()=>s.getState().camera,t,e,i,r),[s,t,e,i,r]);return By(o,n==null?void 0:n.makeDefault),o}function a4e(t,e,n,r){const i=v.useMemo(()=>({}),[]);PE(i),Object.assign(i,n);const s=el(),o=v.useMemo(()=>cSe(()=>s.getState().camera,t,e,i,r),[s,t,e,i,r]);return By(o,n==null?void 0:n.makeDefault),o}function l4e(t,e,n,r){const i=v.useMemo(()=>({}),[]);PE(i),Object.assign(i,n);const s=el(),o=v.useMemo(()=>uSe(()=>s.getState().camera,t,e,i,r),[s,t,e,i,r]);return By(o,n==null?void 0:n.makeDefault),o}function c4e(t,e,n,r){const i=v.useMemo(()=>({}),[]);PE(i),Object.assign(i,n);const s=el(),o=v.useMemo(()=>fSe(()=>s.getState().camera,t,e,i,r),[s,t,e,i,r]);return By(o,n==null?void 0:n.makeDefault),o}const u4e=v.forwardRef((t,e)=>{const n=v.useMemo(()=>new vwe,[]),r=v.useRef(null);return v.useImperativeHandle(e,()=>r.current,[]),Yt(()=>r.current!=null&&xwe(r.current,n,t.pointer,t)),H.jsx("mesh",{matrixAutoUpdate:!1,renderOrder:t.renderOrder??2,ref:r,material:n,children:H.jsx("boxGeometry",{})})}),kE=v.forwardRef((t,e)=>{const n=v.useMemo(()=>new mwe,[]),r=v.useRef(null),i=v.useRef(null);v.useImperativeHandle(e,()=>r.current,[]),Yt(()=>r.current!=null&&i.current!=null&&ywe(i.current,r.current,n,t.pointer,t));const s=At(o=>o.scene);return H.jsxs(H.Fragment,{children:[H.jsx("group",{ref:i}),Al(H.jsx("mesh",{renderOrder:t.renderOrder??1,ref:r,matrixAutoUpdate:!1,material:n,children:H.jsx("planeGeometry",{})}),s)]})});function b8(t,e,n,r){const i=nr(s=>s.session);v.useEffect(()=>{if(i!=null)return bwe(t,i,e,n,r)},[n,e,t,i,r])}function By(t,e=!1){const n=v.useContext(x8);if(n==null)throw new Error("xr pointers can only be used inside the XR component");v.useEffect(()=>{const r=n.register(t,e);return()=>{r()}},[n,t,e]),v.useEffect(()=>{if(t instanceof r0)return()=>t.exit({timeStamp:performance.now()})},[t])}function uXe({children:t,onTeleport:e}){const n=v.useRef(null),r=v.useRef(e);r.current=e;const i=el();return v.useEffect(()=>{if(n.current!=null)return ISe(n.current,()=>i.getState().camera,(s,o)=>{var a;return(a=r.current)==null?void 0:a.call(r,s,o)})},[i]),H.jsx("group",{pointerEventsType:{allow:"teleport"},ref:n,children:t})}const f4e=v.forwardRef(({pointer:t,linePoints:e,...n},r)=>{const i=v.useMemo(()=>new NSe(e),[e]);return v.useImperativeHandle(r,()=>i,[i]),i.options=n,Yt(()=>i.update(t)),H.jsx("primitive",{object:i})});function SX(t,e,n){const r=v.useContext(Mf);if(r==null)throw new Error("DefaultXRInputSourceGrabPointer can only be used inside a XRInputSource");const i=v.useRef(null),s=o4e(i,r,n);b8(s,r.inputSource,t,r.events);const o=n.cursorModel;return H.jsx(Il,{ref:i,space:e,children:o!==!1&&H.jsx(kE,{pointer:s,opacity:Ewe,...Gs(o)})})}const d4e=SX.bind(null,"select","index-finger-tip"),h4e=SX.bind(null,"squeeze","grip-space");function zy(t){const e=ga(),n=v.useRef(null),r=a4e(n,e,t);b8(r,e.inputSource,"select",e.events);const i=t.rayModel,s=t.cursorModel;return H.jsxs(Il,{ref:n,space:"target-ray-space",children:[i!==!1&&H.jsx(u4e,{pointer:r,opacity:O_,...Gs(i)}),s!==!1&&H.jsx(kE,{pointer:r,opacity:O_,...Gs(s)})]})}function p4e(t){const e=ga("hand"),n=v.useRef(null),r=c4e(n,e,t),i=t.cursorModel;return H.jsx(Il,{ref:n,space:e.inputSource.hand.get("index-finger-tip"),children:i!==!1&&H.jsx(kE,{pointer:r,opacity:wwe,...Gs(i)})})}function m4e(t){const e=t.model,n=t.grabPointer,r=t.rayPointer,i=t.teleportPointer??!1;return H.jsxs(H.Fragment,{children:[e!==!1&&H.jsx(v.Suspense,{children:H.jsx(r4e,{...Gs(e)})}),H.jsxs(wX,{children:[n!==!1&&H.jsx(h4e,{...Gs(n)}),r!==!1&&H.jsx(zy,{makeDefault:!0,minDistance:.2,...Gs(r)}),i!==!1&&H.jsx(TX,{...Gs(i)})]})]})}function g4e(t){var a;const e=t.model,n=t.grabPointer,r=t.rayPointer,i=t.touchPointer,s=t.teleportPointer??!1,o=r===!1?!1:(a=Gs(r))==null?void 0:a.rayModel;return H.jsxs(H.Fragment,{children:[e!==!1&&H.jsx(v.Suspense,{children:H.jsx(s4e,{...Gs(e)})}),H.jsxs(wX,{children:[n!==!1&&H.jsx(d4e,{...Gs(n)}),i!==!1&&H.jsx(p4e,{...Gs(i)}),r!==!1&&H.jsx(zy,{makeDefault:!0,minDistance:.2,...Gs(r),rayModel:o===!1?!1:{maxLength:.2,...Gs(o)}}),s!==!1&&H.jsx(TX,{...Gs(s)})]})]})}function y4e(t){return H.jsx(zy,{...t,rayModel:!1})}function v4e(t){return H.jsx(zy,{...t,rayModel:!1})}function x4e(t){return H.jsx(zy,{...t,cursorModel:!1,rayModel:!1})}function TX(t){const e=v.useContext(Mf);if(e==null)throw new Error("DefaultXRInputSourceRayPointer can only be used inside a XRInputSource");const n=v.useRef(null),r=v.useRef(null),i=v.useMemo(()=>DSe(),[]),s=l4e(r,e,{...t,linePoints:i,filter:LSe(t)},"teleport");b8(s,e.inputSource,"select",e.events);const o=t.rayModel,a=t.cursorModel,l=At(u=>u.scene),c=v.useRef(null);return Yt((u,f)=>{c.current!=null&&(c.current.visible=s.getEnabled()&&s.getButtonsDown().size>0);const d=r.current,h=n.current;d==null||h==null||PSe(h,d,f*1e3)}),H.jsxs(H.Fragment,{children:[H.jsx(Il,{ref:n,space:"target-ray-space"}),Al(H.jsxs("group",{ref:r,children:[o!==!1&&H.jsx(f4e,{linePoints:i,pointer:s,opacity:O_,...Gs(o)}),a!==!1&&H.jsx(kE,{ref:c,pointer:s,opacity:O_,...Gs(a)})]}),l)]})}function Gs(t){if(t!==!0)return t}function Hy(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}function _4e({children:t}){const e=nr(o=>o.originReferenceSpace),n=nr(o=>o.origin),r=JSe()==="visible",i=el(),s=v.useMemo(()=>Object.assign({},i,{getState(){return{...i.getState(),scene:n}}}),[n,i]);return n==null||e==null?null:H.jsx(H.Fragment,{children:iu.createPortal(H.jsx(lh.Provider,{value:i,children:H.jsxs(Uy.Provider,{value:e,children:[H.jsxs("group",{matrixAutoUpdate:!1,visible:r,children:[H.jsx(b4e,{}),H.jsx(E4e,{}),H.jsx(w4e,{}),H.jsx(S4e,{}),H.jsx(T4e,{})]}),t]})}),s,null)})}function b4e(){const t=nr(n=>n.inputSourceStates.filter(r=>r.type==="controller"),Hy);let e=nr(n=>n.controller);return e===!1?null:H.jsx(H.Fragment,{children:t.map(n=>{const r=fm(e,n.inputSource.handedness,{});return r===!1?null:H.jsx(Mf.Provider,{value:n,children:H.jsx(Il,{space:"target-ray-space",children:H.jsx(v.Suspense,{children:typeof r=="function"?H.jsx(r,{}):H.jsx(m4e,{...r})})})},n.id)})})}function E4e(){const t=nr(n=>n.inputSourceStates.filter(r=>r.type==="hand"),Hy),e=nr(n=>n.hand);return e===!1?null:H.jsx(H.Fragment,{children:t.map(n=>{const r=fm(e,n.inputSource.handedness,{});return r===!1?null:H.jsx(Mf.Provider,{value:n,children:H.jsx(Il,{space:"target-ray-space",children:H.jsx(v.Suspense,{children:typeof r=="function"?H.jsx(r,{}):H.jsx(g4e,{...r})})})},IE(n))})})}function w4e(){const t=nr(n=>n.inputSourceStates.filter(r=>r.type==="transientPointer"),Hy),e=nr(n=>n.transientPointer);return e===!1?null:H.jsx(H.Fragment,{children:t.map(n=>{const r=fm(e,n.inputSource.handedness,{});return r===!1?null:H.jsx(Mf.Provider,{value:n,children:H.jsx(Il,{space:"target-ray-space",children:H.jsx(v.Suspense,{children:typeof r=="function"?H.jsx(r,{}):H.jsx(y4e,{...r})})})},IE(n))})})}function S4e(){const t=nr(n=>n.inputSourceStates.filter(r=>r.type==="gaze"),Hy),e=nr(n=>n.gaze);return e===!1?null:H.jsx(H.Fragment,{children:t.map(n=>H.jsx(Mf.Provider,{value:n,children:H.jsx(Il,{space:"target-ray-space",children:H.jsx(v.Suspense,{children:typeof e=="function"?H.jsx(e,{}):H.jsx(v4e,{...AX(e)})})})},IE(n)))})}function T4e(){const t=nr(n=>n.inputSourceStates.filter(r=>r.type==="screenInput"),Hy),e=nr(n=>n.screenInput);return e===!1?null:H.jsx(H.Fragment,{children:t.map(n=>H.jsx(Mf.Provider,{value:n,children:H.jsx(Il,{space:"target-ray-space",children:H.jsx(v.Suspense,{children:typeof e=="function"?H.jsx(e,{}):H.jsx(x4e,{...AX(e)})})})},IE(n)))})}function AX(t){if(t!==!0)return t}function A4e(t){return Cwe(t)}function M4e({children:t,store:e}){e.setWebXRManager(At(r=>r.gl.xr));const n=el();return v.useEffect(()=>{let r;return e.subscribe((i,s)=>{if(i.session!==s.session){if(i.session!=null){const{camera:o,gl:a}=n.getState();r=o,n.setState({camera:a.xr.getCamera()});return}r!=null&&n.setState({camera:r})}})},[n,e]),Yt((r,i,s)=>e.onBeforeFrame(r.scene,r.camera,s),-1e3),Yt(()=>e.onBeforeRender()),H.jsx(bX.Provider,{value:e,children:H.jsxs(C4e,{children:[H.jsx(_4e,{}),t]})})}function C4e({children:t}){const e=Gy(),n=v.useMemo(()=>new dX(!0),[]);return v.useEffect(()=>pwe(e,r=>n.setEnabled(r,{timeStamp:performance.now()})),[e,n]),Yt(r=>n.move(r.scene,{timeStamp:performance.now()}),-50),H.jsx(x8.Provider,{value:n,children:t})}function Gy(){const t=v.useContext(bX);if(t==null)throw new Error("XR features can only be used inside the <XR> component");return t}function nr(t=n=>n,e){return zC(Gy(),t,e)}const Il=v.forwardRef(({space:t,children:e},n)=>{const r=v.useRef(null),i=typeof t=="string"?E8(t):t;v.useImperativeHandle(n,()=>r.current,[]),I4e(r,i);const s=v.useCallback(o=>{o!=null&&(o.transformReady=!1,o.visible=!1),r.current=o},[]);return H.jsx("group",{xrSpace:i,matrixAutoUpdate:!1,ref:s,children:i&&H.jsx(Uy.Provider,{value:i,children:e})})});function E8(t){switch(t){case"grip-space":return ga().inputSource.gripSpace;case"target-ray-space":return ga().inputSource.targetRaySpace;case"wrist":case"thumb-metacarpal":case"thumb-phalanx-proximal":case"thumb-phalanx-distal":case"thumb-tip":case"index-finger-metacarpal":case"index-finger-phalanx-proximal":case"index-finger-phalanx-intermediate":case"index-finger-phalanx-distal":case"index-finger-tip":case"middle-finger-metacarpal":case"middle-finger-phalanx-proximal":case"middle-finger-phalanx-intermediate":case"middle-finger-phalanx-distal":case"middle-finger-tip":case"ring-finger-metacarpal":case"ring-finger-phalanx-proximal":case"ring-finger-phalanx-intermediate":case"ring-finger-phalanx-distal":case"ring-finger-tip":case"pinky-finger-metacarpal":case"pinky-finger-phalanx-proximal":case"pinky-finger-phalanx-intermediate":case"pinky-finger-phalanx-distal":case"pinky-finger-tip":return ga("hand").inputSource.hand.get(t)}if(t==null){const i=v.useContext(Uy);if(i==null)throw new Error("XR objects must be placed inside the XROrigin");return i}const[e,n]=v.useState(void 0),r=nr(i=>i.session);return v.useEffect(()=>{if(r==null)return;let i=!1;return r.requestReferenceSpace(t).then(s=>{i||n(s)}),()=>void(i=!0)},[r,t]),e}function R4e(t){const e=v.useContext(Uy),n=nr(r=>e??r.originReferenceSpace);return v.useMemo(()=>t==null||n==null?void 0:Swe(t,n),[t,n])}function I4e(t,e,n){const r=R4e(e);Yt((i,s,o)=>{t.current!=null&&(t.current.visible=t.current.transformReady=(r==null?void 0:r(t.current.matrix,o))??!1),n==null||n(i,s,o)},-100)}const fXe=v.forwardRef(({mesh:t,...e},n)=>{const r=P4e(t);return H.jsx("mesh",{ref:n,geometry:r,...e})});function dXe(t){const e=nr(n=>n.detectedMeshes);return v.useMemo(()=>t==null?e:e.filter(n=>n.semanticLabel===t),[e,t])}function P4e(t,e=!0){const[n,r]=v.useState(QN(t,void 0));return Yt(()=>r(i=>QN(t,i))),v.useEffect(()=>{if(e)return()=>n.dispose()},[n]),n}const hXe=v.forwardRef(({plane:t,...e},n)=>{const r=k4e(t);return H.jsx("mesh",{ref:n,geometry:r,...e})});function pXe(t){const e=nr(n=>n.detectedPlanes);return v.useMemo(()=>t==null?e:e.filter(n=>n.semanticLabel===t),[e,t])}function k4e(t,e=!0){const[n,r]=v.useState(JN(t,void 0));return Yt(()=>r(i=>JN(t,i))),v.useEffect(()=>{if(e)return()=>n.dispose()},[n]),n}const mXe=v.forwardRef(({children:t,...e},n)=>{const r=At(o=>o.gl.xr.getCamera()),i=v.useRef(null);v.useImperativeHandle(n,()=>i.current,[]);const s=nr(o=>o.originReferenceSpace);return v.useEffect(()=>{const o=i.current;if(o!=null)return o.add(r),()=>void o.remove(r)},[r]),H.jsx("group",{ref:i,...e,children:s!=null&&H.jsx(Uy.Provider,{value:s,children:t})})});function gXe(t,e){const[n,r]=v.useState();return MX(t,e,r),n}function L4e(t,e,n){const r=v.useRef(void 0);MX(e,n,v.useCallback(i=>r.current=i,[])),Yt((i,s,o)=>{t==null||o==null||r.current==null||t(o.getHitTestResults(r.current.source),r.current.getWorldMatrix)})}function MX(t,e,n){const r=Gy();v.useEffect(()=>{let i,s=!1;const o=t instanceof XRSpace||typeof t=="string"?t:t==null?void 0:t.current;if(o!=null)return vX(r,o,e).then(a=>{s||(i=a,n(a))}),()=>{n(void 0),s=!0,i==null||i.source.cancel()}},[r,t,e,n])}function yXe(){const t=Gy();return v.useCallback((e,n)=>{const r=e instanceof XRSpace||typeof e=="string"?e:e.current;if(r!=null)return OSe(t,r,n)},[t])}const vXe=v.forwardRef(({trackableType:t,onResults:e,space:n,...r},i)=>{const s=v.useRef(null);return v.useImperativeHandle(i,()=>s.current),L4e(e,n??s,t),H.jsx("group",{...r,ref:s})}),xXe=v.forwardRef((t,e)=>{const n=nr(s=>s.domOverlayRoot),{In:r,Out:i}=v.useMemo(jV,[]);return v.useEffect(()=>{if(n==null)return;const s=n6(n);return s.render(H.jsx(i,{})),()=>s.unmount()},[n,i]),H.jsx(r,{children:H.jsx("div",{...t,ref:e})})});function _Xe({src:t,pixelWidth:e=1024,pixelHeight:n=1024,dpr:r=1,renderPriority:i=0,children:s,...o}){const[a,l]=v.useState(!1),c=v.useRef(null),u=v.useRef(void 0),f=v.useRef(void 0);v.useEffect(()=>{l(!1);let m=!1;return TSe(t).then(()=>!m&&l(!0)),()=>void(m=!0)},[t]);const d=t4e("layers"),h=v.useMemo(()=>wSe(o.shape??"quad",{centralAngle:o.centralAngle,centralHorizontalAngle:o.centralHorizontalAngle,lowerVerticalAngle:o.lowerVerticalAngle,upperVerticalAngle:o.upperVerticalAngle}),[o.centralAngle,o.centralHorizontalAngle,o.lowerVerticalAngle,o.shape,o.upperVerticalAngle]),p=U4e(e,n,r);return O4e(p,c,[a,d]),a?H.jsxs(H.Fragment,{children:[t==null&&H.jsx(B4e,{store:p,renderPriority:i,renderTargetRef:u,layerEntryRef:d?f:void 0,children:s}),d?H.jsx(D4e,{renderTargetRef:u,layerEntryRef:f,pixelWidth:e,pixelHeight:n,dpr:r,ref:c,...o,src:t,geometry:h}):H.jsx(N4e,{renderTargetRef:u,ref:c,...o,src:t,pixelWidth:e,pixelHeight:n,dpr:r,geometry:h})]}):null}const D4e=v.forwardRef(({src:t,shape:e,colorFormat:n,depthFormat:r,layout:i,mipLevels:s,renderOrder:o=0,blendTextureSourceAlpha:a,centralAngle:l,centralHorizontalAngle:c,chromaticAberrationCorrection:u,lowerVerticalAngle:f,quality:d,upperVerticalAngle:h,invertStereo:p,pixelWidth:m,pixelHeight:g,dpr:y,renderTargetRef:x,layerEntryRef:_,...w},T)=>{const S=v.useRef(null),C=At(k=>k.gl),A=Gy(),R={blendTextureSourceAlpha:a,centralAngle:l,centralHorizontalAngle:c,chromaticAberrationCorrection:u,lowerVerticalAngle:f,quality:d,upperVerticalAngle:h},M=v.useRef(R);M.current=R;const D=v.useRef(o);return D.current=o,v.useEffect(()=>{if(S.current==null)return;const k=t??(x.current=yX(m,g,y)),L=xSe(k,A.getState(),C.xr,S.current,{colorFormat:n,depthFormat:r,invertStereo:p,layout:i,mipLevels:s,shape:e},M.current);if(L==null)return;const N=_.current={layer:L,renderOrder:D.current};if(A.addLayerEntry(N),k instanceof HTMLVideoElement||k instanceof fr)return()=>{A.removeLayerEntry(N),L.destroy()};const z=SSe(C,A,L,k);return()=>{A.removeLayerEntry(N),z(),L.destroy()}},[n,r,p,_,i,s,g,m,y,x,C,e,t,A]),_.current!=null&&(_.current.renderOrder=o),_.current!=null&&y8(_.current.layer,M.current),Yt(()=>{_.current==null||S.current==null||CSe(A.getState(),_.current.layer,M.current.centralAngle,S.current)}),v.useImperativeHandle(T,()=>S.current,[]),H.jsx("mesh",{...w,renderOrder:-1/0,ref:S,children:H.jsx("meshBasicMaterial",{colorWrite:!1})})}),N4e=v.forwardRef(({src:t,renderTargetRef:e,dpr:n,renderOrder:r,pixelWidth:i,pixelHeight:s,...o},a)=>{const l=v.useRef(null);return v.useEffect(()=>{if(l.current==null)return;const c=t??(e.current=yX(i,s,n)),u=ASe(c);return l.current.map=u,l.current.needsUpdate=!0,()=>{if(c instanceof fr){c.dispose();return}u.dispose()}},[t,i,s,n,e]),H.jsx("mesh",{ref:a,...o,children:H.jsx("meshBasicMaterial",{ref:l,toneMapped:!1})})});function O4e(t,e,n){v.useEffect(()=>{const{current:r}=e;if(r==null)return;let i;const s=(a,l)=>{if(a.camera===(l==null?void 0:l.camera)&&a.scene===l.scene)return;i==null||i();const{destroy:c,update:u}=ySe(r,()=>a.camera,a.scene),f=Kb(u);i=()=>{c(),f()}};s(t.getState());const o=t.subscribe(s);return()=>{o(),i==null||i()}},[t,e,...n])}const F4e=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"];function U4e(t,e,n){const r=el(),i=v.useMemo(()=>{let s=r.getState();const o=new Ar(50,1,.1,1e3);o.position.set(0,0,5);const a=new Ke;let l={events:{enabled:!1,priority:0},size:{width:1,height:1,left:0,top:0},camera:o,scene:new ls,raycaster:new oh,pointer:a,mouse:a,previousRoot:r};const c=GV((u,f)=>{const d=()=>{const p={};for(const m in s)F4e.includes(m)||(p[m]=s[m]);return Object.assign(p,l,{events:{...s.events,...l.events},viewport:Object.assign({},s.viewport,s.viewport.getCurrentViewport(o,new $,l.size))})},h=()=>u(d());return{...s,set(p){typeof p=="function"&&(p=p(f())),Object.assign(l,p),h()},setPreviousState(p){s=p,h()},get:f,setEvents(){},...d()}});return Object.assign(c,{setState(u){c.getState().set(u)}})},[r]);return v.useEffect(()=>r.subscribe(i.getState().setPreviousState),[r,i]),v.useEffect(()=>{const s={factor:1,distance:0,dpr:n,initialDpr:n,left:0,top:0,getCurrentViewport:()=>s,width:t,height:e,aspect:t/e};i.setState({size:{width:t,height:e,top:0,left:0},viewport:s})},[t,e,n,i,r]),i}function B4e({renderPriority:t,children:e,layerEntryRef:n,renderTargetRef:r,store:i}){v.useEffect(()=>{const c=(u,f)=>{const{size:d,camera:h}=u;h instanceof Hi?(h.left=d.width/-2,h.right=d.width/2,h.top=d.height/2,h.bottom=d.height/-2):h.aspect=d.width/d.height,(d!==(f==null?void 0:f.size)||h!==f.camera)&&(h.updateProjectionMatrix(),h.updateMatrixWorld())};return c(i.getState()),i.subscribe(c)},[i]);let s,o,a,l;return Yt((c,u,f)=>{if(r.current==null||n!=null&&(n.current==null||f==null))return;const{gl:d,scene:h,camera:p}=i.getState();s=d.autoClear,o=d.xr.enabled,a=d.xr.isPresenting,l=d.getRenderTarget(),d.autoClear=!0,d.xr.enabled=!1,d.xr.isPresenting=!1;const m=r.current;ESe(d,m,n==null?void 0:n.current,f),d.render(h,p),d.setRenderTarget(l),d.autoClear=s,d.xr.enabled=o,d.xr.isPresenting=a},t),H.jsx(H.Fragment,{children:iu.createPortal(H.jsx(lh.Provider,{value:i,children:e}),i,null)})}const CX=v.forwardRef(({store:t,mode:e,onError:n,children:r,...i},s)=>{const o=zC(t,l=>l.session),a=e4e(e,n);return H.jsx("button",{ref:s,...i,onClick:()=>o!=null?o.end():t.enterXR(e).catch(n),children:typeof r=="function"?r(a?o!=null?"entered":"exited":"unsupported"):r})}),bXe=v.forwardRef((t,e)=>H.jsx(CX,{ref:e,mode:"immersive-ar",...t})),EXe=v.forwardRef((t,e)=>H.jsx(CX,{ref:e,mode:"immersive-vr",...t})),z4e={onBlur:"pointerleave",onHover:"pointerenter",onMove:"pointermove",onSelect:{type:"click",filter:t=>t.pointerType==="ray"},onSelectEnd:{type:"pointerup",filter:t=>t.pointerType==="ray"},onSelectStart:{type:"pointerdown",filter:t=>t.pointerType==="ray"},onSqueeze:{type:"click",filter:t=>t.pointerType==="grab"},onSqueezeEnd:{type:"pointerup",filter:t=>t.pointerType==="grab"},onSqueezeStart:{type:"pointerdown",filter:t=>t.pointerType==="grab"}};function Rc(t,e,n){const r=v.useRef(n);r.current=n,v.useEffect(()=>{const{current:i}=t;if(i==null)return;const s=z4e[e],o=typeof s=="string"?l=>{var c;return(c=r.current)==null?void 0:c.call(r,{intersection:l,intersections:[l],target:l.pointerState})}:l=>{var c;l instanceof Hs&&!s.filter(l)||(c=r.current)==null||c.call(r,{intersection:l,intersections:[l],target:l.pointerState})},a=typeof s=="string"?s:s.type;return i.addEventListener(a,o),()=>i.removeEventListener(a,o)},[t,e])}function wXe(t,e,{handedness:n}={}){const r=nr(s=>s.session),i=v.useRef(e);i.current=e,v.useEffect(()=>{if(r==null)return;const s=o=>{var a;(a=i.current)==null||a.call(i,{type:o.type,data:o.inputSource})};return r.addEventListener(t,s),r.removeEventListener(t,s)},[r,n,t])}function SXe(t){return t==null?ga("transientPointer"):_8("transientPointer",t)}function TXe(){return ga("gaze")}function AXe(){return ga("screenInput")}function MXe(t){return t==null?ga("hand"):_8("hand",t)}function CXe(t){return t==null?ga("controller"):_8("controller",t)}const RXe=E8,H4e=v.forwardRef(({onHover:t,onBlur:e,onSelectStart:n,onSelectEnd:r,onSelect:i,onSqueezeStart:s,onSqueezeEnd:o,onSqueeze:a,onMove:l,children:c},u)=>{const f=v.useRef(null);return v.useImperativeHandle(u,()=>f.current),Rc(f,"onHover",t),Rc(f,"onBlur",e),Rc(f,"onSelectStart",n),Rc(f,"onSelectEnd",r),Rc(f,"onSelect",i),Rc(f,"onSqueezeStart",s),Rc(f,"onSqueezeEnd",o),Rc(f,"onSqueeze",a),Rc(f,"onMove",l),H.jsx("group",{ref:f,children:c})}),IXe=v.forwardRef(function({onSelectStart:e,onSelectEnd:n,children:r,...i},s){const o=v.useRef(),a=v.useRef(null),l=v.useMemo(()=>new et,[]);return v.useImperativeHandle(s,()=>a.current),Yt(()=>{const c=o.current,u=a.current;!u||!c||(u.applyMatrix4(l),c.updateWorldMatrix(!0,!1),u.applyMatrix4(c.matrixWorld),u.updateMatrixWorld(),l.copy(c.matrixWorld).invert())}),H.jsx(H4e,{ref:a,onSelectStart:c=>{uwe(c.target)&&(c.target.type==="controller"||c.target.type==="hand")&&c.target.object!=null&&(o.current=c.target.object,c.target.object.updateWorldMatrix(!0,!1),l.copy(c.target.object.matrixWorld).invert(),e==null||e(c))},onSelectEnd:c=>{c.target.controller===o.current&&(o.current=void 0),n==null||n(c)},...i,children:r})});(function(){try{if(typeof document<"u"){var t=document.createElement("style");t.appendChild(document.createTextNode(`@import"https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap";@import"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap";._panel_1frsq_1 ._folder_1frsq_1 ._item_1frsq_1{cursor:pointer;width:100%;border-radius:7px;margin:0}._panel_1frsq_1{display:flex;flex-direction:column;padding:18px 16px}._folder_1frsq_1{padding-left:12px;overflow:hidden}._item_1frsq_1{width:100%;padding:4px 14px;line-height:14px;font-size:14px;height:22px;white-space:nowrap;overflow:hidden}._item_1frsq_1:hover{background-color:var(--surface-color)}._style_17sb9_1{position:absolute;bottom:24px;left:50%;transform:translate(-50%);z-index:99999}._style_17sb9_1 button:first-of-type{border-top-left-radius:4px;border-bottom-left-radius:4px;border-left:1px solid white;border-top:1px solid white;border-bottom:1px solid white}._style_17sb9_1 button:last-of-type{border-top-right-radius:4px;border-bottom-right-radius:4px;border-right:1px solid white;border-top:1px solid white;border-bottom:1px solid white}._style_17sb9_1 button:not(:last-of-type){border-right:1px solid white}._buttonStyle_17sb9_26{cursor:pointer;border-radius:0;background:#0000001a;color:#fff;font: .8125rem sans-serif;padding:12px 24px;outline:none;user-select:none;-webkit-user-select:none}._buttonStyle_17sb9_26 :hover{background:#ffffff1a}._buttonStyle_17sb9_26 :active{background:#0003}._iframeVuerLinkButton_1utdl_1{position:fixed;display:block;bottom:24px;left:auto;right:auto;height:36px;text-decoration:none;vertical-align:middle;padding:10px;line-height:16px;color:#fff;border:1px solid #fff;border-radius:5px;background-color:transparent;z-index:20}._vuerRoot_evnl7_1{position:absolute;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;color:#fff}._dropContainer_evnl7_12{width:100%;height:100%}._dropPrompt_evnl7_17{position:absolute;display:flex;justify-content:center;align-items:center;width:100%;height:100%}._dropPrompt_evnl7_17:after{max-width:calc(100% - 100px);max-height:calc(100% - 100px);margin:100px;width:300px;height:200px;border:2px dashed white;border-radius:24px;content:attr(data-text);display:flex;justify-content:center;align-items:center}._dropContainer_nq8kl_1{position:relative;width:100%;height:100%}._fadeContainer_nq8kl_7{transition:opacity .5s;width:100%;height:100%}._dropPrompt_nq8kl_13{position:absolute;display:flex;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0}._dropPrompt_nq8kl_13:after{max-width:300px;max-height:200px;margin:40px;width:calc(100% - 80px);height:calc(100% - 80px);border:2px dashed white;border-radius:24px;content:attr(data-text);display:flex;justify-content:center;align-items:center}:root{--theme: #33a6ff;--theme-light: #52bbff;--theme-overlay: rgba(51, 166, 255, .16);--background-color: #181818;--background-color-dark: #141414;--surface-color: #242424;--surface-color-light: #444444;--surface-color-hover: #333333;--border-color: var(--background-color-dark);--scrollbar-background: var(--surface-color);--input-background: var(--surface-color-light);--input-background-hover: var(--surface-color-hover);--radius: 4px;--timing-ease-out: cubic-bezier(.33, 1, .68, 1);--timing-ease-in-out: cubic-bezier(.65, 0, .35, 1);--duration-normal: .2s;--duration-fast: .1s;--font-family: "Roboto", sans-serif;--font-family-mono: "JetBrains Mono", monospace;--font-size: 14px;--font-size-small: 12px;--font-size-big: 16px;--red: #e13238;--yellow: #e6a700;--blue: #4cb3d4}@media (prefers-reduced-motion){:root{--duration-normal: 0;--duration-fast: 0}}.wait *{cursor:wait!important}*{box-sizing:border-box;accent-color:var(--theme)}*::-webkit-scrollbar{width:16px;height:16px;background-color:var(--scrollbar-background)}*::-webkit-scrollbar-thumb{background:#ffffff3d;border:6px solid var(--scrollbar-background);border-radius:8px}*::-webkit-scrollbar-corner{background-color:transparent}html,body{font-family:var(--font-family);font-size:var(--font-size);line-height:24px;overflow:hidden;padding:0;margin:0;background-color:var(--background-color);color:#fff9}button,input,select{font-family:inherit;font-size:inherit;line-height:inherit}code,pre{font-family:var(--font-family-mono)}button{background:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;padding:0}.loading{--loading-stripe-color: var(--surface-color-hover);background-image:linear-gradient(45deg,var(--loading-stripe-color) 25%,rgba(0,0,0,0) 25%,rgba(0,0,0,0) 50%,var(--loading-stripe-color) 50%,var(--loading-stripe-color) 75%,rgba(0,0,0,0) 75%,rgba(0,0,0,0) 100%);background-size:22.63px 22.63px;animation:loading 1s linear infinite}@keyframes loading{0%{background-position:0 0}to{background-position:22.63px 0}}._playhead_at0ov_1{position:absolute;width:0;border-left:1px solid var(--theme);margin-left:-50%;top:6px;bottom:0;background-color:var(--theme);pointer-events:none;display:flex;align-items:flex-start;justify-content:center}._playhead_at0ov_1:before{display:block;padding:0 4px;border-radius:var(--radius);background-color:var(--theme);font-family:var(--font-family-mono);font-size:var(--font-size-small);line-height:20px;font-weight:700;color:#000}._playhead_at0ov_1:before{content:attr(data-seeking)}._tsStyle_skfcc_1{-webkit-user-select:none;user-select:none;pointer-events:none;position:absolute;top:32px;bottom:0;border-left:1px solid rgba(0,0,0,.2);border-right:1px solid rgba(0,0,0,.2);width:0;display:flex;justify-content:center}._tsStyle_skfcc_1:after{font-family:var(--font-family-mono);font-size:var(--font-size-small);line-height:32px;margin-top:-32px;text-align:center;color:#ffffff8a;content:attr(data-label)}._svg_ohgsw_1{width:18px;height:18px;vertical-align:middle}@keyframes _breathAnimation_1h8zr_1{0%{opacity:1}50%{opacity:.2}to{opacity:1}}._activeStyle_1h8zr_12{fill:red;stroke:transparent;stroke-width:0;animation:_breathAnimation_1h8zr_1 5s infinite}._activeStyle_1h8zr_12 :hover{animation:none;fill:transparent;stroke:#fff;stroke-width:10}._disabledStyle_1h8zr_25{fill:transparent;stroke:#ffffff8a;stroke-width:10}._disabledStyle_1h8zr_25 :hover{fill:red;stroke:#fff;opacity:1!important}._container_1ommy_1{height:32px;cursor:pointer;width:100%}._rangeStyle_1ommy_7{border-radius:var(--radius);cursor:move;position:absolute;height:32px;background-color:#24242400;border:2px solid rgba(255,255,255,.24);display:flex;align-items:center;justify-content:center;pointer-events:auto;max-width:100%;opacity:.4}._rangeStyle_1ommy_7 :hover{opacity:.8}._style_1ommy_25{flex-grow:1;flex-shrink:1}._dragIndStyle_1ommy_30{margin-top:2px;color:#fff;opacity:.5;z-index:auto;min-width:0;cursor:ew-resize}._dragIndStyle_1ommy_30 :hover{opacity:.9;z-index:1;min-width:24px}._dragIndStyle_1ommy_30 :active{opacity:1}._timelineContainer_udwj8_1{width:100%;height:100%;transition:opacity var(--duration-normal);display:flex;align-items:stretch;position:relative;background-color:var(--background-color)}._timeline_udwj8_1{overflow-x:scroll;overscroll-behavior-x:none;overflow-y:hidden;flex-grow:1;position:relative;background-color:transparent;--scrollbar-background: var(--background-color);height:100%;width:100%}._visibleContainer_udwj8_23{position:relative;overflow:hidden;height:100%}._scrollContainer_udwj8_29{position:relative;overflow:visible;height:calc(100% - 19px)}._playheadCursor_udwj8_35{position:absolute;width:2px;top:32px;bottom:0;background-color:#fff;pointer-events:none;box-sizing:border-box;border:1px solid #444;margin-left:-1.5px}._trackContainer_udwj8_47{width:100%;height:calc(100% - 32px);background-color:var(--surface-color)}._trackPlaceholder_udwj8_53{position:absolute;width:200px;left:calc(50% - 100px);bottom:50%;opacity:.8;font-size:1.5em;white-space:nowrap}._codeStyle_1tml4_1{height:24px;padding:0;background:transparent}._frameStyle_1tml4_7{color:#ffffff8a}._frameTimeStyle_1tml4_11{margin:0 8px;color:#ffffff52}._buttonStyle_db2ev_1{display:block;cursor:pointer;margin:0;color:#ffffff8a}._buttonStyle_db2ev_1:hover{color:#fff!important;accent-color:#fff!important}._buttonStyle_db2ev_1:active{color:#23aaff!important;accent-color:#23aaff!important}._disabledStyle_db2ev_16{cursor:default;pointer-events:none;color:#ffffff29}._buttonStyle_1so1p_1{display:block;cursor:pointer;margin:0;color:#ffffff8a}._buttonStyle_1so1p_1 :hover{color:#fff}._buttonStyle_1so1p_1 :active{color:var(--theme)}._disabledStyle_1so1p_14{cursor:default;pointer-events:none;color:#ffffff29}._containerStyle_cc36b_1{font-family:var(--font-family-mono);background-color:var(--input-background);color:#fff9;border-radius:var(--radius);border:0;padding:0 8px;height:24px;flex-shrink:1;flex-grow:1;min-width:0;display:inline-block;text-wrap:nowrap}._containerStyle_cc36b_1:before{content:attr(data-prefix);z-index:1;color:#fff9;display:inline}._containerStyle_cc36b_1:after{content:attr(data-postfix);z-index:1;color:#fff9;display:inline}._containerStyle_cc36b_1 :hover{background-color:var(--input-background-hover)}._containerStyle_cc36b_1._main_cc36b_30{--loading-stripe-color: var(--theme-light);background-color:var(--theme);color:#000000de;font-weight:700}._containerStyle_cc36b_1._main_cc36b_30:hover{box-shadow:0 0 0 2px #fff inset}._containerStyle_cc36b_1:disabled{pointer-events:none;opacity:.54}._inputStyle_cc36b_44{display:inline;border:0;margin:0;padding:0;height:24px;background-color:transparent;color:#fff9;padding-block:0;padding-inline:0;-moz-appearance:textfield}._inputStyle_cc36b_44 :focus{outline:none}._inputStyle_cc36b_44::-webkit-inner-spin-button,._inputStyle_cc36b_44::-webkit-outer-spin-button{-webkit-appearance:none;margin:0;width:0;height:0}._style_58es6_1{cursor:pointer;font-family:var(--font-family-mono);background-color:var(--input-background);color:#fff9;border:0;border-radius:var(--radius);padding:0 8px;height:24px;flex-shrink:1;flex-grow:1;min-width:0}._style_58es6_1 :hover{background-color:var(--input-background-hover)}._style_58es6_1 :disabled{pointer-events:none;opacity:.54}._style_26khi_1{height:16px;display:flex;justify-content:center;gap:16px}._playbackBar_1e43n_1{background:var(--surface-color);display:grid;grid-template-columns:1fr min-content 1fr;padding:10px 12px 12px;-webkit-user-select:none;user-select:none;opacity:.99}._progressBar_1e43n_10{margin-top:-12px;z-index:-1;content:"";position:absolute;left:0;height:48px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 304 304' width='150' height='150'%3E%3Cpath fill='%23333333' fill-opacity='0.8' d='M44.1 224a5 5 0 1 1 0 2H0v-2h44.1zm160 48a5 5 0 1 1 0 2H82v-2h122.1zm57.8-46a5 5 0 1 1 0-2H304v2h-42.1zm0 16a5 5 0 1 1 0-2H304v2h-42.1zm6.2-114a5 5 0 1 1 0 2h-86.2a5 5 0 1 1 0-2h86.2zm-256-48a5 5 0 1 1 0 2H0v-2h12.1zm185.8 34a5 5 0 1 1 0-2h86.2a5 5 0 1 1 0 2h-86.2zM258 12.1a5 5 0 1 1-2 0V0h2v12.1zm-64 208a5 5 0 1 1-2 0v-54.2a5 5 0 1 1 2 0v54.2zm48-198.2V80h62v2h-64V21.9a5 5 0 1 1 2 0zm16 16V64h46v2h-48V37.9a5 5 0 1 1 2 0zm-128 96V208h16v12.1a5 5 0 1 1-2 0V210h-16v-76.1a5 5 0 1 1 2 0zm-5.9-21.9a5 5 0 1 1 0 2H114v48H85.9a5 5 0 1 1 0-2H112v-48h12.1zm-6.2 130a5 5 0 1 1 0-2H176v-74.1a5 5 0 1 1 2 0V242h-60.1zm-16-64a5 5 0 1 1 0-2H114v48h10.1a5 5 0 1 1 0 2H112v-48h-10.1zM66 284.1a5 5 0 1 1-2 0V274H50v30h-2v-32h18v12.1zM236.1 176a5 5 0 1 1 0 2H226v94h48v32h-2v-30h-48v-98h12.1zm25.8-30a5 5 0 1 1 0-2H274v44.1a5 5 0 1 1-2 0V146h-10.1zm-64 96a5 5 0 1 1 0-2H208v-80h16v-14h-42.1a5 5 0 1 1 0-2H226v18h-16v80h-12.1zm86.2-210a5 5 0 1 1 0 2H272V0h2v32h10.1zM98 101.9V146H53.9a5 5 0 1 1 0-2H96v-42.1a5 5 0 1 1 2 0zM53.9 34a5 5 0 1 1 0-2H80V0h2v34H53.9zm60.1 3.9V66H82v64H69.9a5 5 0 1 1 0-2H80V64h32V37.9a5 5 0 1 1 2 0zM101.9 82a5 5 0 1 1 0-2H128V37.9a5 5 0 1 1 2 0V82h-28.1zm16-64a5 5 0 1 1 0-2H146v44.1a5 5 0 1 1-2 0V18h-26.1zm102.2 270a5 5 0 1 1 0 2H98v14h-2v-16h124.1zM242 149.9V160h16v34h-16v62h48v48h-2v-46h-48v-66h16v-30h-16v-12.1a5 5 0 1 1 2 0zM53.9 18a5 5 0 1 1 0-2H64V2H48V0h18v18H53.9zm112 32a5 5 0 1 1 0-2H192V0h50v2h-48v48h-28.1zm-48-48a5 5 0 0 1-9.8-2h2.07a3 3 0 1 0 5.66 0H178v34h-18V21.9a5 5 0 1 1 2 0V32h14V2h-58.1zm0 96a5 5 0 1 1 0-2H137l32-32h39V21.9a5 5 0 1 1 2 0V66h-40.17l-32 32H117.9zm28.1 90.1a5 5 0 1 1-2 0v-76.51L175.59 80H224V21.9a5 5 0 1 1 2 0V82h-49.59L146 112.41v75.69zm16 32a5 5 0 1 1-2 0v-99.51L184.59 96H300.1a5 5 0 0 1 3.9-3.9v2.07a3 3 0 0 0 0 5.66v2.07a5 5 0 0 1-3.9-3.9H185.41L162 121.41v98.69zm-144-64a5 5 0 1 1-2 0v-3.51l48-48V48h32V0h2v50H66v55.41l-48 48v2.69zM50 53.9v43.51l-48 48V208h26.1a5 5 0 1 1 0 2H0v-65.41l48-48V53.9a5 5 0 1 1 2 0zm-16 16V89.41l-34 34v-2.82l32-32V69.9a5 5 0 1 1 2 0zM12.1 32a5 5 0 1 1 0 2H9.41L0 43.41V40.6L8.59 32h3.51zm265.8 18a5 5 0 1 1 0-2h18.69l7.41-7.41v2.82L297.41 50H277.9zm-16 160a5 5 0 1 1 0-2H288v-71.41l16-16v2.82l-14 14V210h-28.1zm-208 32a5 5 0 1 1 0-2H64v-22.59L40.59 194H21.9a5 5 0 1 1 0-2H41.41L66 216.59V242H53.9zm150.2 14a5 5 0 1 1 0 2H96v-56.6L56.6 162H37.9a5 5 0 1 1 0-2h19.5L98 200.6V256h106.1zm-150.2 2a5 5 0 1 1 0-2H80v-46.59L48.59 178H21.9a5 5 0 1 1 0-2H49.41L82 208.59V258H53.9zM34 39.8v1.61L9.41 66H0v-2h8.59L32 40.59V0h2v39.8zM2 300.1a5 5 0 0 1 3.9 3.9H3.83A3 3 0 0 0 0 302.17V256h18v48h-2v-46H2v42.1zM34 241v63h-2v-62H0v-2h34v1zM17 18H0v-2h16V0h2v18h-1zm273-2h14v2h-16V0h2v16zm-32 273v15h-2v-14h-14v14h-2v-16h18v1zM0 92.1A5.02 5.02 0 0 1 6 97a5 5 0 0 1-6 4.9v-2.07a3 3 0 1 0 0-5.66V92.1zM80 272h2v32h-2v-32zm37.9 32h-2.07a3 3 0 0 0-5.66 0h-2.07a5 5 0 0 1 9.8 0zM5.9 0A5.02 5.02 0 0 1 0 5.9V3.83A3 3 0 0 0 3.83 0H5.9zm294.2 0h2.07A3 3 0 0 0 304 3.83V5.9a5 5 0 0 1-3.9-5.9zm3.9 300.1v2.07a3 3 0 0 0-1.83 1.83h-2.07a5 5 0 0 1 3.9-3.9zM97 100a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-48 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 96a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-144a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-96 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm96 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-32 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM49 36a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-32 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM33 68a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 240a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm80-176a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm112 176a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM17 180a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM17 84a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6z'%3E%3C/path%3E%3C/svg%3E")}._container_hv7nz_1{display:flex;position:relative;width:100%;height:100%;overflow:hidden;justify-content:stretch}._primaryStyle_hv7nz_10{flex-grow:0;overflow:hidden}._resizable_hv7nz_15{touch-action:none;flex-shrink:0;z-index:1;-webkit-user-select:none;user-select:none}._resizable_hv7nz_15:before{content:"";width:100%;height:100%;display:block;background-color:#25252536;z-index:10000}._resizable_hv7nz_15:hover:before{background-color:#23aaff}._resizable_hv7nz_15:active:before{background-color:#23aaff!important}._resizableInner_hv7nz_36{flex-grow:1;flex-shrink:1;overflow:hidden}._containerStyle_so8x0_1{display:flex;position:relative;width:10px;height:100%;overflow:hidden;justify-content:stretch}._primaryStyle_so8x0_10{flex-grow:0;overflow:hidden}._panelContainerStyle_so8x0_15{touch-action:none;flex-shrink:0;z-index:1;-webkit-user-select:none;user-select:none}._panelContainerStyle_so8x0_15:before{content:"";width:100%;height:100%;display:block;background-color:#25252536;z-index:1}._panelContainerStyle_so8x0_15:hover:before{background-color:#23aaff}._panelContainerStyle_so8x0_15:active:before{background-color:#23aaff!important}._shrunkStyle_so8x0_36,._panelStyle_so8x0_43{flex-grow:1;flex-shrink:1;overflow:hidden;-webkit-user-select:none;user-select:none}._listName_1s0ny_1{color:red;font-size:40px}`)),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();var G4e=Object.defineProperty,j4e=(t,e,n)=>e in t?G4e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,tn=(t,e,n)=>j4e(t,typeof e!="symbol"?e+"":e,n);function V4e(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}const W4e=Object.freeze(Object.defineProperty({__proto__:null,get AccumulativeShadows(){return NC},get AdaptiveDpr(){return kV},get AdaptiveEvents(){return LV},get AmbientLight(){return fR},get AmbientLightStage(){return vK},get Arrow(){return ZK},get AsciiRenderer(){return yj},get AutoScroll(){return hZ},get BBAnchor(){return Nj},get BBox(){return VE},get Backdrop(){return dV},get BakeShadows(){return PV},get Billboard(){return uC},get Bounds(){return TC},get Box(){return vq},get Button(){return pZ},get Bvh(){return Dj},get Camera(){return lq},get CameraShake(){return nV},get CameraView(){return pK},get Capsule(){return xq},get CatmullRomLine(){return HG},get Caustics(){return pV},get Center(){return bC},get Circle(){return _q},get Clone(){return m_},get Cloud(){return _V},get ComputedAttribute(){return hj},get Cone(){return bq},get ContactShadows(){return DC},get ContribLoader(){return bZ},get CoordsMarker(){return QK},get CubicBezierLine(){return zG},get CurveModifier(){return jj},get CycleRaycast(){return eG},get Cylinder(){return Eq},get Dae(){return sK},get Decal(){return mj},get Detailed(){return RV},get DirectionalLight(){return WE},get Div(){return xZ},get Dodecahedron(){return wq},get Edges(){return Sq},get Effects(){return rj},get Environment(){return LC},get Extrude(){return Tq},get FaceLandmarker(){return YV},get Facemesh(){return XV},get Fisheye(){return FV},get Float(){return rV},get Frustum(){return eb},get Gamepad(){return D8},get Glb(){return K_},get Gltf(){return K_},get GrabRender(){return JK},get GradientTexture(){return ij},get Grid(){return eZ},get Gripper(){return nZ},get HUDPlane(){return Ef},get HandleBox(){return uK},get Hands(){return lK},get HemisphereLight(){return uR},get HemisphereLightStage(){return xK},get Html(){return ch},get Hud(){return mC},get Icosahedron(){return Aq},get Image(){return oj},get ImageBackground(){return ER},get ImagePlane(){return I1},get ImageUpload(){return vZ},get Img(){return gZ},get Input(){return yZ},get Instances(){return Ry},get Lathe(){return Mq},get Lightformer(){return yV},get Line(){return Ni},get LumaSplats(){return qJ},get MarchingCubes(){return pj},get Markdown(){return $J},get Mask(){return OV},get Merged(){return zj},get MeshDiscardMaterial(){return Yj},get MeshDistortMaterial(){return Vj},get MeshPortalMaterial(){return UV},get MeshReflectorMaterial(){return $j},get MeshRefractionMaterial(){return Xj},get MeshTransmissionMaterial(){return qj},get MeshWobbleMaterial(){return Wj},get MotionControllers(){return cK},get Movable(){return lR},get Obj(){return QY},get Octahedron(){return Cq},get Outlines(){return hC},get Pcd(){return JY},get PerformanceMonitor(){return NV},get Pivot(){return oR},get PivotXR(){return aR},get Plane(){return Rq},get Playback(){return TR},get PlaybackBar(){return dZ},get PlaybackContext(){return QE},get PlaybackControls(){return MR},get PlaybackProvider(){return aZ},get PlaybackStateContext(){return JE},get PlaybackStateProvider(){return lZ},get Playhead(){return wR},get Ply(){return eK},get PointCloud(){return GK},get PointLight(){return yK},get PointMaterial(){return Kj},get Pointer(){return cR},get PointerControls(){return hK},get Points(){return AV},get Polyhedron(){return Iq},get PositionalAudio(){return GG},get Preload(){return IV},get QuadraticBezierLine(){return BG},get RandomizedLight(){return OC},get Range(){return SR},get RectAreaLight(){return mK},get Render(){return wZ},get RenderCubeTexture(){return BC},get RenderLayer(){return SZ},get RenderTexture(){return UC},get Resize(){return eV},get Ring(){return Pq},get RoundedBox(){return Qj},get Sampler(){return dj},get Scene(){return H8},get SceneBackground(){return WK},get ScreenQuad(){return Jj},get ScreenSpace(){return FG},get Segments(){return CV},get Select(){return OG},get Shadow(){return hV},get Shape(){return kq},get SkeletalGripper(){return G8},get Sky(){return vV},get Slider(){return mZ},get SoftShadows(){return Zj},get Sparkles(){return SV},get Sphere(){return Lq},get Splat(){return rZ},get SpotLight(){return gK},get SpotLightShadow(){return gV},get SpriteAnimator(){return Gj},get Stage(){return fV},get Stars(){return xV},get StereoVideoPlane(){return KK},get Stl(){return iK},get Svg(){return gj},get Tetrahedron(){return Dq},get Text(){return _Z},get Text3D(){return nj},get Timeline(){return uZ},get TimelineControls(){return XJ},get TimelineFileDrop(){return fZ},get TimelineStateContext(){return ew},get TimelineStateProvider(){return cZ},get Timestamp(){return ab},get Torus(){return Nq},get TorusKnot(){return Oq},get Trail(){return fj},get TriMesh(){return VK},get Tube(){return Fq},get Urdf(){return rK},get VideoMaterial(){return ZE},get VideoPlane(){return XK},get View(){return HC},get VuerGroup(){return ph},get WebRTCStereoVideoPlane(){return YK},get WebRTCVideoMaterial(){return bR},get WebRTCVideoPlane(){return qK},get Wireframe(){return Uq},get XrMovableAnchor(){return fK},get XrMovableLocal(){return sR},get controllerState(){return oa},get getLandmark(){return aK},get getState(){return J_},get handState(){return Jr},get l2(){return M1},get list2menu(){return tZ},get mat2Pos(){return Yu},get sentinel(){return oZ},get transposeTuple(){return oy},get useMotionControllerState(){return Q_},get usePlayback(){return mh},get usePlaybackStates(){return AR},get useSourceState(){return Z_},get useTimelineStates(){return tw}},Symbol.toStringTag,{value:"Module"}));function hO(t,e,n){return t===null?null:(t.point.applyMatrix4(e.matrixWorld),t.distance=t.point.distanceTo(n.ray.origin),t.object=e,t)}const pO=Mb||null,Ox=new Yo,mO=new $,gO=new et,$4e=ln.prototype.raycast,X4e=pO!==null?pO.prototype.raycast:null,yO=new $,Fs=new ln,Fx=[];function q4e(t,e){this.isBatchedMesh?Y4e.call(this,t,e):K4e.call(this,t,e)}function Y4e(t,e){if(this.boundsTrees){const n=this.boundsTrees,r=this._drawInfo,i=this._drawRanges,s=this.matrixWorld;Fs.material=this.material,Fs.geometry=this.geometry;const o=Fs.geometry.boundsTree,a=Fs.geometry.drawRange;Fs.geometry.boundingSphere===null&&(Fs.geometry.boundingSphere=new wr);for(let l=0,c=r.length;l<c;l++){if(!this.getVisibleAt(l))continue;const u=r[l].geometryIndex;if(Fs.geometry.boundsTree=n[u],this.getMatrixAt(l,Fs.matrixWorld).premultiply(s),!Fs.geometry.boundsTree){this.getBoundingBoxAt(u,Fs.geometry.boundingBox),this.getBoundingSphereAt(u,Fs.geometry.boundingSphere);const f=i[u];Fs.geometry.setDrawRange(f.start,f.count)}Fs.raycast(t,Fx);for(let f=0,d=Fx.length;f<d;f++){const h=Fx[f];h.object=this,h.batchId=l,e.push(h)}Fx.length=0}Fs.geometry.boundsTree=o,Fs.geometry.drawRange=a,Fs.material=null,Fs.geometry=null}else X4e.call(this,t,e)}function K4e(t,e){if(this.geometry.boundsTree){if(this.material===void 0)return;gO.copy(this.matrixWorld).invert(),Ox.copy(t.ray).applyMatrix4(gO),yO.setFromMatrixScale(this.matrixWorld),mO.copy(Ox.direction).multiply(yO);const n=mO.length(),r=t.near/n,i=t.far/n,s=this.geometry.boundsTree;if(t.firstHitOnly===!0){const o=hO(s.raycastFirst(Ox,this.material,r,i),this,t);o&&e.push(o)}else{const o=s.raycast(Ox,this.material,r,i);for(let a=0,l=o.length;a<l;a++){const c=hO(o[a],this,t);c&&e.push(c)}}}else $4e.call(this,t,e)}var vO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var RX={exports:{}},qT={},xO={exports:{}},YT={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _O;function Z4e(){if(_O)return YT;_O=1;var t=Ge;function e(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function a(f,d){var h=d(),p=r({inst:{value:h,getSnapshot:d}}),m=p[0].inst,g=p[1];return s(function(){m.value=h,m.getSnapshot=d,l(m)&&g({inst:m})},[f,h,d]),i(function(){return l(m)&&g({inst:m}),f(function(){l(m)&&g({inst:m})})},[f]),o(h),h}function l(f){var d=f.getSnapshot;f=f.value;try{var h=d();return!n(f,h)}catch{return!0}}function c(f,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return YT.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,YT}var bO;function Q4e(){return bO||(bO=1,xO.exports=Z4e()),xO.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EO;function J4e(){if(EO)return qT;EO=1;var t=Ge,e=Q4e();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,a=t.useMemo,l=t.useDebugValue;return qT.useSyncExternalStoreWithSelector=function(c,u,f,d,h){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=a(function(){function y(S){if(!x){if(x=!0,_=S,S=d(S),h!==void 0&&m.hasValue){var C=m.value;if(h(C,S))return w=C}return w=S}if(C=w,r(_,S))return C;var A=d(S);return h!==void 0&&h(C,A)?C:(_=S,w=A)}var x=!1,_,w,T=f===void 0?null:f;return[function(){return y(u())},T===null?void 0:function(){return y(T())}]},[u,f,d,h]);var g=i(c,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=g},[g]),l(g),g},qT}RX.exports=J4e();var eTe=RX.exports;const IX=mu(eTe),tTe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},wO=t=>{let e;const n=new Set,r=(a,l)=>{const c=typeof a=="function"?a(e):a;if(!Object.is(c,e)){const u=e;e=l??(typeof c!="object"||c===null)?c:Object.assign({},e,c),n.forEach(f=>f(e,u))}},i=()=>e,s={setState:r,getState:i,getInitialState:()=>o,subscribe:a=>(n.add(a),()=>n.delete(a)),destroy:()=>{(tTe?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},o=e=t(r,i,s);return s},w8=t=>t?wO(t):wO,{useDebugValue:nTe}=Ge,{useSyncExternalStoreWithSelector:rTe}=IX,iTe=t=>t;function sTe(t,e=iTe,n){const r=rTe(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return nTe(r),r}const SO=(t,e)=>{const n=w8(t),r=(i,s=e)=>sTe(n,i,s);return Object.assign(r,n),r},oTe=(t,e)=>t?SO(t,e):SO;function aTe(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}const S8=oTe((t,e)=>{function n(){var r;const{accumulated:i,startTime:s,infos:o}=e(),a=(r=e().log)==null?void 0:r.maxMemory,{totalFrames:l,log:c,gl:u,max:f}=i,d={calls:u.calls/l,triangles:u.triangles/l,points:u.points/l,lines:u.lines/l},h={gpu:c.gpu/l,cpu:c.cpu/l,mem:c.mem/l,fps:c.fps/l};return{sessionTime:(window.performance.now()-s)/1e3,infos:o,log:h,gl:d,max:f,maxMemory:a,totalFrames:l}}return{log:null,paused:!1,triggerProgramsUpdate:0,startTime:0,customData:0,fpsLimit:60,overclockingFps:!1,accumulated:{totalFrames:0,gl:{calls:0,triangles:0,points:0,lines:0,counts:0},log:{gpu:0,cpu:0,mem:0,fps:0},max:{gl:{calls:0,triangles:0,points:0,lines:0,counts:0},log:{gpu:0,cpu:0,mem:0,fps:0}}},chart:{data:{fps:[],cpu:[],gpu:[],mem:[]},circularId:0},gl:void 0,objectWithMaterials:null,scene:void 0,programs:new Map,sceneLength:void 0,tab:"infos",getReport:n}}),Ja=t=>S8(t,aTe);Object.assign(Ja,S8);const{getState:Wa,setState:la}=S8,Pa={value:0,fpsLimit:60,isOverLimit:0},Mg=t=>(t==null?void 0:t.reduce((e,n)=>e+n,0))/t.length;class lTe{constructor(e={}){this.names=[""],this.finished=[],this.paused=!1,this.overClock=!1,this.queryHasResult=!1,this.queryCreated=!1,this.isWebGL2=!0,this.memAccums=[],this.gpuAccums=[],this.activeAccums=[],this.logsAccums={mem:[],gpu:[],cpu:[],fps:[],fpsFixed:[]},this.fpsChart=[],this.gpuChart=[],this.cpuChart=[],this.memChart=[],this.paramLogger=()=>{},this.glFinish=()=>{},this.chartLogger=()=>{},this.chartLen=60,this.logsPerSecond=10,this.maxMemory=1500,this.chartHz=10,this.startCpuProfiling=!1,this.lastCalculateFixed=0,this.chartFrame=0,this.gpuTimeProcess=0,this.chartTime=0,this.activeQueries=0,this.circularId=0,this.detected=0,this.frameId=0,this.rafId=0,this.idleCbId=0,this.checkQueryId=0,this.uuid=void 0,this.currentCpu=0,this.currentMem=0,this.paramFrame=0,this.paramTime=0,this.now=()=>{},this.t0=0,window.GLPerf=window.GLPerf||{},Object.assign(this,e),this.fpsChart=new Array(this.chartLen).fill(0),this.gpuChart=new Array(this.chartLen).fill(0),this.cpuChart=new Array(this.chartLen).fill(0),this.memChart=new Array(this.chartLen).fill(0),this.now=()=>window.performance&&window.performance.now?window.performance.now():Date.now(),this.initGpu(),this.is120hz()}initGpu(){this.uuid=ri.generateUUID(),this.gl&&(this.isWebGL2=!0,this.extension||(this.extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")),this.extension===null&&(this.isWebGL2=!1))}is120hz(){let e=0;const n=r=>{++e<20?this.rafId=window.requestAnimationFrame(n):(this.detected=Math.ceil(1e3*e/(r-this.t0)/70),window.cancelAnimationFrame(this.rafId)),this.t0||(this.t0=r)};this.rafId=window.requestAnimationFrame(n)}addUI(e){this.names.indexOf(e)===-1&&(this.names.push(e),this.gpuAccums.push(0),this.activeAccums.push(!1))}nextFps(e){const n=16.666666666666668,r=n-e.timeRemaining(),i=n*Pa.fpsLimit/10/r;i<0||(Pa.value=i,Pa.isOverLimit<25?Pa.isOverLimit++:la({overclockingFps:!0}))}nextFrame(e){this.frameId++;const n=e||this.now();let r=n-this.paramTime,i=0;if(this.frameId<=1)this.paramFrame=this.frameId,this.paramTime=n;else if(n>=this.paramTime){this.maxMemory=window.performance.memory?window.performance.memory.jsHeapSizeLimit/1048576:0;const s=this.frameId-this.paramFrame,o=s*1e3/r,a=Wa().overclockingFps?Pa.value:o;if(i=this.isWebGL2?this.gpuAccums[0]:this.gpuAccums[0]/r,this.isWebGL2?this.gpuAccums[0]=0:Promise.all(this.finished).then(()=>{this.gpuAccums[0]=0,this.finished=[]}),this.currentMem=Math.round(window.performance&&window.performance.memory?window.performance.memory.usedJSHeapSize/1048576:0),window.performance&&this.startCpuProfiling){window.performance.mark("cpu-finished");const l=performance.measure("cpu-duration","cpu-started","cpu-finished");this.currentCpu=(l==null?void 0:l.duration)||0,this.logsAccums.cpu.push(this.currentCpu),this.startCpuProfiling=!1}this.logsAccums.mem.push(this.currentMem),this.logsAccums.fpsFixed.push(o),this.logsAccums.fps.push(a),this.logsAccums.gpu.push(i),this.overClock&&typeof window.requestIdleCallback<"u"&&(Pa.isOverLimit>0&&a>o?Pa.isOverLimit--:Wa().overclockingFps&&la({overclockingFps:!1})),n>=this.paramTime+1e3/this.logsPerSecond&&(this.paramLogger({cpu:Mg(this.logsAccums.cpu),gpu:Mg(this.logsAccums.gpu),mem:Mg(this.logsAccums.mem),fps:Mg(this.logsAccums.fps),duration:Math.round(r),maxMemory:this.maxMemory,frameCount:s}),this.logsAccums.mem=[],this.logsAccums.fps=[],this.logsAccums.gpu=[],this.logsAccums.cpu=[],this.paramFrame=this.frameId,this.paramTime=n),this.overClock&&n-this.lastCalculateFixed>=2*1e3&&(this.lastCalculateFixed=e,Pa.fpsLimit=Math.round(Mg(this.logsAccums.fpsFixed)/10)*100,la({fpsLimit:Pa.fpsLimit/10}),this.logsAccums.fpsFixed=[],this.paramFrame=this.frameId,this.paramTime=n)}if(!this.detected||!this.chartFrame)this.chartFrame=this.frameId,this.chartTime=n,this.circularId=0;else{const s=n-this.chartTime;let o=this.chartHz*s/1e3;for(;--o>0&&this.detected;){const a=(this.frameId-this.chartFrame)/s*1e3,l=Wa().overclockingFps?Pa.value:a;this.fpsChart[this.circularId%this.chartLen]=l;const c=1e3/this.currentMem,u=this.currentCpu,f=(this.isWebGL2?this.gpuAccums[1]*2:Math.round(this.gpuAccums[1]/r*100))+4;f>0&&(this.gpuChart[this.circularId%this.chartLen]=f),u>0&&(this.cpuChart[this.circularId%this.chartLen]=u),c>0&&(this.memChart[this.circularId%this.chartLen]=c);for(let d=0;d<this.names.length;d++)this.chartLogger({i:d,data:{fps:this.fpsChart,gpu:this.gpuChart,cpu:this.cpuChart,mem:this.memChart},circularId:this.circularId});this.circularId++,this.chartFrame=this.frameId,this.chartTime=n}}}startGpu(){const e=this.gl,n=this.extension;if(!(!e||!n)&&this.isWebGL2){let r=!1,i,s;if(this.query){this.queryHasResult=!1;let o=this.query;if(r=e.getQueryParameter(o,e.QUERY_RESULT_AVAILABLE),i=e.getParameter(n.GPU_DISJOINT_EXT),r&&!i){s=e.getQueryParameter(this.query,e.QUERY_RESULT);const a=s*1e-6;(r||i)&&(e.deleteQuery(this.query),o=null),r&&a>0&&(i||this.activeAccums.forEach((l,c)=>{this.gpuAccums[c]=a}))}}(r||!this.query)&&(this.queryCreated=!0,this.query=e.createQuery(),e.beginQuery(n.TIME_ELAPSED_EXT,this.query))}}endGpu(){const e=this.extension,n=this.gl;this.isWebGL2&&this.queryCreated&&n.getQuery(e.TIME_ELAPSED_EXT,n.CURRENT_QUERY)&&n.endQuery(e.TIME_ELAPSED_EXT)}begin(e){this.startGpu(),this.updateAccums(e)}end(e){this.endGpu(),this.updateAccums(e)}updateAccums(e){let n=this.names.indexOf(e);n===-1&&(n=this.names.length,this.addUI(e));const r=this.now();this.activeAccums[n]=!this.activeAccums[n],this.t0=r}}const cTe=t=>{t.forEach((e,n)=>{const{meshes:r}=e;if(!r)return;let i={total:0,type:"Triangle",data:[]};Object.keys(r).forEach(s=>{const o=r[s],{geometry:a,material:l}=o;let c=a.index;const u=a.attributes.position;if(!u)return;let f=1;l.wireframe===!0&&(f=0);const d=c!==null?c.count:u.count,h=a.drawRange.start*f,p=a.drawRange.count*f,m=h,g=Math.min(d,h+p)-1;let y=1;const x=o.count||1;let _="Triangle",w=0;o.isMesh?l.wireframe===!0?(_="Line",y=y/2):(_="Triangle",y=y/3):o.isLine?(_="Line",o.isLineSegments?y=y/2:o.isLineLoop?y=y:y=y-1):o.isPoints?(_="Point",y=y):o.isSprite&&(_="Triangle",y=y/3);const T=Math.round(Math.max(0,g-m+1)*(y*x));T>w&&(w=T,i.type=_),i.total+=T,i.data.push({drawCount:T,type:_}),o.userData.drawCount={type:_,count:T}}),e.drawCounts=i})};var PX={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,f,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,f||l,d),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)e.call(c,u)&&l.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=n?n+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,h=new Array(d);f<d;f++)h[f]=u[f].fn;return h},a.prototype.listenerCount=function(l){var c=n?n+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,f,d,h){var p=n?n+l:l;if(!this._events[p])return!1;var m=this._events[p],g=arguments.length,y,x;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),g){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,u),!0;case 4:return m.fn.call(m.context,c,u,f),!0;case 5:return m.fn.call(m.context,c,u,f,d),!0;case 6:return m.fn.call(m.context,c,u,f,d,h),!0}for(x=1,y=new Array(g-1);x<g;x++)y[x-1]=arguments[x];m.fn.apply(m.context,y)}else{var _=m.length,w;for(x=0;x<_;x++)switch(m[x].once&&this.removeListener(l,m[x].fn,void 0,!0),g){case 1:m[x].fn.call(m[x].context);break;case 2:m[x].fn.call(m[x].context,c);break;case 3:m[x].fn.call(m[x].context,c,u);break;case 4:m[x].fn.call(m[x].context,c,u,f);break;default:if(!y)for(w=1,y=new Array(g-1);w<g;w++)y[w-1]=arguments[w];m[x].fn.apply(m[x].context,y)}}return!0},a.prototype.on=function(l,c,u){return s(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return s(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,f){var d=n?n+l:l;if(!this._events[d])return this;if(!c)return o(this,d),this;var h=this._events[d];if(h.fn)h.fn===c&&(!f||h.once)&&(!u||h.context===u)&&o(this,d);else{for(var p=0,m=[],g=h.length;p<g;p++)(h[p].fn!==c||f&&!h[p].once||u&&h[p].context!==u)&&m.push(h[p]);m.length?this._events[d]=m.length===1?m[0]:m:o(this,d)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(PX);var uTe=PX.exports;const fTe=mu(uTe),T8=new fTe;function dTe(t,e,n){return T8.on(t,e)}function hTe(t,e,n){var r;T8.removeListener(t,e,(r=n==null?void 0:n.context)!=null?r:null,n==null?void 0:n.once)}function pTe(t,e){T8.emit(t,e)}function mTe(t,e,n=[],r){const i=v.useRef(e);v.useEffect(()=>void(i.current=e),[e]),v.useEffect(()=>{const s=a=>{var l;return(l=i.current)==null?void 0:l.call(i,a)},o=dTe(t,s);return()=>hTe(t,s,{...r,context:o})},[t,void 0,...n])}const gTe=yn.prototype.updateMatrixWorld,yTe=yn.prototype.updateWorldMatrix,TO=yn.prototype.updateMatrix,AO=["calls","triangles","points","lines"],MO=["gpu","cpu","mem","fps"];let Kp={value:0},da={value:0};const vTe=t=>{let e=""+t;return e=e.match("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"),e!==null},CO=(t,e)=>{t.defines||(t.defines={}),t.defines&&!t.defines.muiPerf&&(t.defines=Object.assign(t.defines||{},{muiPerf:t.uuid}));const n=t.uuid;return e[n]||(e[n]={meshes:{},material:t},t.needsUpdate=!0),t.needsUpdate=!1,n},xTe=t=>t==="muiPerf",_Te=({overClock:t,logsPerSecond:e,chart:n,deepAnalyze:r,matrixUpdate:i})=>{const{gl:s,scene:o}=At();la({gl:s,scene:o});const a=v.useMemo(()=>{const l=new lTe({trackGPU:!0,overClock:t,chartLen:n?n.length:120,chartHz:n?n.hz:60,logsPerSecond:e||10,gl:s.getContext(),chartLogger:g=>{la({chart:g})},paramLogger:g=>{const y={maxMemory:g.maxMemory,gpu:g.gpu,cpu:g.cpu,mem:g.mem,fps:g.fps,totalTime:g.duration,frameCount:g.frameCount};la({log:y});const{accumulated:x}=Wa(),_=s.info.render;x.totalFrames++,x.gl.calls+=_.calls,x.gl.triangles+=_.triangles,x.gl.points+=_.points,x.gl.lines+=_.lines,x.log.gpu+=g.gpu,x.log.cpu+=g.cpu,x.log.mem+=g.mem,x.log.fps+=g.fps;for(let w=0;w<AO.length;w++){const T=AO[w],S=_[T];S>x.max.gl[T]&&(x.max.gl[T]=S)}for(let w=0;w<MO.length;w++){const T=MO[w],S=g[T];S>x.max.log[T]&&(x.max.log[T]=S)}la({accumulated:x}),pTe("log",[y,s])}}),c=s.getContext();let u=null,f=null;const d=c.getExtension("WEBGL_debug_renderer_info"),h=c.getParameter(c.VERSION);d!=null&&(u=c.getParameter(d.UNMASKED_RENDERER_WEBGL),f=c.getParameter(d.UNMASKED_VENDOR_WEBGL)),f||(f="Unknown vendor"),u||(u=c.getParameter(c.RENDERER)),la({startTime:window.performance.now(),infos:{version:h,renderer:u,vendor:f}});const p=new Map,m=new Map;return Object.defineProperty(ls.prototype,"onBeforeRender",{get(){return(...g)=>{var y;l&&l.begin("profiler"),(y=p.get(this))==null||y(...g)}},set(g){p.set(this,g)},configurable:!0}),Object.defineProperty(ls.prototype,"onAfterRender",{get(){return(...g)=>{var y;l&&l.end("profiler"),(y=m.get(this))==null||y(...g)}},set(g){m.set(this,g)},configurable:!0}),l},[]);return v.useEffect(()=>{a&&(a.overClock=t||!1,t===!1&&(la({overclockingFps:!1}),Pa.value=0,Pa.isOverLimit=0),a.chartHz=(n==null?void 0:n.hz)||60,a.chartLen=(n==null?void 0:n.length)||120)},[t,a,n==null?void 0:n.length,n==null?void 0:n.hz]),v.useEffect(()=>{i&&(yn.prototype.updateMatrixWorld=function(){(this.matrixWorldNeedsUpdate||arguments[0])&&Kp.value++,gTe.apply(this,arguments)},yn.prototype.updateWorldMatrix=function(){Kp.value++,yTe.apply(this,arguments)},yn.prototype.updateMatrix=function(){da.value++,TO.apply(this,arguments)}),s.info.autoReset=!1;let l=null,c=null;if(s.info)return l=Kb(function(){Wa().paused&&la({paused:!1}),window.performance&&(window.performance.mark("cpu-started"),a.startCpuProfiling=!0),da.value-=1,Kp.value=0,da.value=0,s.info&&s.info.reset()}),c=Q6(function(){var u,f;if(a&&!a.paused&&(a.nextFrame(window.performance.now()),t&&typeof window.requestIdleCallback<"u"&&(a.idleCbId=requestIdleCallback(a.nextFps))),r){const d={},h=new Map;o.traverse(function(p){if((p instanceof ln||p instanceof Zc)&&p.material){let m=p.material.uuid;Array.isArray(p.material)&&p.material.length>1?m=CO(p.material[1],d):m=CO(p.material,d),d[m].meshes[p.uuid]=p}}),(f=(u=s==null?void 0:s.info)==null?void 0:u.programs)==null||f.forEach(p=>{const m=p.cacheKey.split(","),g=m[m.findIndex(xTe)+1];if(vTe(g)&&d[g]){const{material:y,meshes:x}=d[g];h.set(g,{program:p,material:y,meshes:x,drawCounts:{total:0,type:"triangle",data:[]},expand:!1,visible:!0})}}),h.size!==Wa().programs.size&&(cTe(h),la({programs:h,triggerProgramsUpdate:Wa().triggerProgramsUpdate++}))}}),()=>{a&&(typeof window.cancelIdleCallback<"u"&&window.cancelIdleCallback(a.idleCbId),window.cancelAnimationFrame(a.rafId),window.cancelAnimationFrame(a.checkQueryId)),i&&(yn.prototype.updateMatrixWorld=TO),l(),c()}},[a,s,n,i]),v.useEffect(()=>{const l=XH(function(){return a&&(a.paused=!0,da.value=0,Kp.value=0,la({paused:!0,log:{maxMemory:0,gpu:0,mem:0,cpu:0,fps:0,totalTime:0,frameCount:0}})),!1});return()=>{l()}},[]),null};var jr="colors",vo="sizes",mn="space",bTe={gap:mn,gridGap:mn,columnGap:mn,gridColumnGap:mn,rowGap:mn,gridRowGap:mn,inset:mn,insetBlock:mn,insetBlockEnd:mn,insetBlockStart:mn,insetInline:mn,insetInlineEnd:mn,insetInlineStart:mn,margin:mn,marginTop:mn,marginRight:mn,marginBottom:mn,marginLeft:mn,marginBlock:mn,marginBlockEnd:mn,marginBlockStart:mn,marginInline:mn,marginInlineEnd:mn,marginInlineStart:mn,padding:mn,paddingTop:mn,paddingRight:mn,paddingBottom:mn,paddingLeft:mn,paddingBlock:mn,paddingBlockEnd:mn,paddingBlockStart:mn,paddingInline:mn,paddingInlineEnd:mn,paddingInlineStart:mn,top:mn,right:mn,bottom:mn,left:mn,scrollMargin:mn,scrollMarginTop:mn,scrollMarginRight:mn,scrollMarginBottom:mn,scrollMarginLeft:mn,scrollMarginX:mn,scrollMarginY:mn,scrollMarginBlock:mn,scrollMarginBlockEnd:mn,scrollMarginBlockStart:mn,scrollMarginInline:mn,scrollMarginInlineEnd:mn,scrollMarginInlineStart:mn,scrollPadding:mn,scrollPaddingTop:mn,scrollPaddingRight:mn,scrollPaddingBottom:mn,scrollPaddingLeft:mn,scrollPaddingX:mn,scrollPaddingY:mn,scrollPaddingBlock:mn,scrollPaddingBlockEnd:mn,scrollPaddingBlockStart:mn,scrollPaddingInline:mn,scrollPaddingInlineEnd:mn,scrollPaddingInlineStart:mn,fontSize:"fontSizes",background:jr,backgroundColor:jr,backgroundImage:jr,borderImage:jr,border:jr,borderBlock:jr,borderBlockEnd:jr,borderBlockStart:jr,borderBottom:jr,borderBottomColor:jr,borderColor:jr,borderInline:jr,borderInlineEnd:jr,borderInlineStart:jr,borderLeft:jr,borderLeftColor:jr,borderRight:jr,borderRightColor:jr,borderTop:jr,borderTopColor:jr,caretColor:jr,color:jr,columnRuleColor:jr,fill:jr,outline:jr,outlineColor:jr,stroke:jr,textDecorationColor:jr,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:vo,minBlockSize:vo,maxBlockSize:vo,inlineSize:vo,minInlineSize:vo,maxInlineSize:vo,width:vo,minWidth:vo,maxWidth:vo,height:vo,minHeight:vo,maxHeight:vo,flexBasis:vo,gridTemplateColumns:vo,gridTemplateRows:vo,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},ETe=(t,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,i0=()=>{const t=Object.create(null);return(e,n,...r)=>{const i=(s=>JSON.stringify(s,ETe))(e);return i in t?t[i]:t[i]=n(e,...r)}},Ld=Symbol.for("sxs.internal"),A8=(t,e)=>Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),RO=t=>{for(const e in t)return!0;return!1},{hasOwnProperty:wTe}=Object.prototype,uM=t=>t.includes("-")?t:t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),STe=/\s+(?![^()]*\))/,Ep=t=>e=>t(...typeof e=="string"?String(e).split(STe):[e]),IO={appearance:t=>({WebkitAppearance:t,appearance:t}),backfaceVisibility:t=>({WebkitBackfaceVisibility:t,backfaceVisibility:t}),backdropFilter:t=>({WebkitBackdropFilter:t,backdropFilter:t}),backgroundClip:t=>({WebkitBackgroundClip:t,backgroundClip:t}),boxDecorationBreak:t=>({WebkitBoxDecorationBreak:t,boxDecorationBreak:t}),clipPath:t=>({WebkitClipPath:t,clipPath:t}),content:t=>({content:t.includes('"')||t.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(t)?t:`"${t}"`}),hyphens:t=>({WebkitHyphens:t,hyphens:t}),maskImage:t=>({WebkitMaskImage:t,maskImage:t}),maskSize:t=>({WebkitMaskSize:t,maskSize:t}),tabSize:t=>({MozTabSize:t,tabSize:t}),textSizeAdjust:t=>({WebkitTextSizeAdjust:t,textSizeAdjust:t}),userSelect:t=>({WebkitUserSelect:t,userSelect:t}),marginBlock:Ep((t,e)=>({marginBlockStart:t,marginBlockEnd:e||t})),marginInline:Ep((t,e)=>({marginInlineStart:t,marginInlineEnd:e||t})),maxSize:Ep((t,e)=>({maxBlockSize:t,maxInlineSize:e||t})),minSize:Ep((t,e)=>({minBlockSize:t,minInlineSize:e||t})),paddingBlock:Ep((t,e)=>({paddingBlockStart:t,paddingBlockEnd:e||t})),paddingInline:Ep((t,e)=>({paddingInlineStart:t,paddingInlineEnd:e||t}))},KT=/([\d.]+)([^]*)/,TTe=(t,e)=>t.length?t.reduce((n,r)=>(n.push(...e.map(i=>i.includes("&")?i.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(i)?`:is(${r})`:r):r+" "+i)),n),[]):e,ATe=(t,e)=>t in MTe&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(n,r,i,s)=>r+(i==="stretch"?`-moz-available${s};${uM(t)}:${r}-webkit-fill-available`:`-moz-fit-content${s};${uM(t)}:${r}fit-content`)+s):String(e),MTe={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},cu=t=>t?t+"-":"",kX=(t,e,n)=>t.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,i,s,o,a)=>o=="$"==!!s?r:(i||o=="--"?"calc(":"")+"var(--"+(o==="$"?cu(e)+(a.includes("$")?"":cu(n))+a.replace(/\$/g,"-"):a)+")"+(i||o=="--"?"*"+(i||"")+(s||"1")+")":"")),CTe=/\s*,\s*(?![^()]*\))/,RTe=Object.prototype.toString,Zp=(t,e,n,r,i)=>{let s,o,a;const l=(c,u,f)=>{let d,h;const p=m=>{for(d in m){const x=d.charCodeAt(0)===64,_=x&&Array.isArray(m[d])?m[d]:[m[d]];for(h of _){const w=/[A-Z]/.test(y=d)?y:y.replace(/-[^]/g,S=>S[1].toUpperCase()),T=typeof h=="object"&&h&&h.toString===RTe&&(!r.utils[w]||!u.length);if(w in r.utils&&!T){const S=r.utils[w];if(S!==o){o=S,p(S(h)),o=null;continue}}else if(w in IO){const S=IO[w];if(S!==a){a=S,p(S(h)),a=null;continue}}if(x&&(g=d.slice(1)in r.media?"@media "+r.media[d.slice(1)]:d,d=g.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(S,C,A,R,M,D)=>{const k=KT.test(C),L=.0625*(k?-1:1),[N,z]=k?[R,C]:[C,R];return"("+(A[0]==="="?"":A[0]===">"===k?"max-":"min-")+N+":"+(A[0]!=="="&&A.length===1?z.replace(KT,(O,K,V)=>Number(K)+L*(A===">"?1:-1)+V):z)+(M?") and ("+(M[0]===">"?"min-":"max-")+N+":"+(M.length===1?D.replace(KT,(O,K,V)=>Number(K)+L*(M===">"?-1:1)+V):D):"")+")"})),T){const S=x?f.concat(d):[...f],C=x?[...u]:TTe(u,d.split(CTe));s!==void 0&&i(PO(...s)),s=void 0,l(h,C,S)}else s===void 0&&(s=[[],u,f]),d=x||d.charCodeAt(0)!==36?d:`--${cu(r.prefix)}${d.slice(1).replace(/\$/g,"-")}`,h=T?h:typeof h=="number"?h&&w in ITe?String(h)+"px":String(h):kX(ATe(w,h??""),r.prefix,r.themeMap[w]),s[0].push(`${x?`${d} `:`${uM(d)}:`}${h}`)}}var g,y};p(c),s!==void 0&&i(PO(...s)),s=void 0};l(t,e,n)},PO=(t,e,n)=>`${n.map(r=>`${r}{`).join("")}${e.length?`${e.join(",")}{`:""}${t.join(";")}${e.length?"}":""}${Array(n.length?n.length+1:0).join("}")}`,ITe={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},kO=t=>String.fromCharCode(t+(t>25?39:97)),Dd=t=>(e=>{let n,r="";for(n=Math.abs(e);n>52;n=n/52|0)r=kO(n%52)+r;return kO(n%52)+r})(((e,n)=>{let r=n.length;for(;r;)e=33*e^n.charCodeAt(--r);return e})(5381,JSON.stringify(t))>>>0),Jg=["themed","global","styled","onevar","resonevar","allvar","inline"],PTe=t=>{if(t.href&&!t.href.startsWith(location.origin))return!1;try{return!!t.cssRules}catch{return!1}},kTe=t=>{let e;const n=()=>{const{cssRules:i}=e.sheet;return[].map.call(i,(s,o)=>{const{cssText:a}=s;let l="";if(a.startsWith("--sxs"))return"";if(i[o-1]&&(l=i[o-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const c in e.rules)if(e.rules[c].group===s)return`--sxs{--sxs:${[...e.rules[c].cache].join(" ")}}${a}`;return s.cssRules.length?`${l}${a}`:""}return a}).join("")},r=()=>{if(e){const{rules:a,sheet:l}=e;if(!l.deleteRule){for(;Object(Object(l.cssRules)[0]).type===3;)l.cssRules.splice(0,1);l.cssRules=[]}for(const c in a)delete a[c]}const i=Object(t).styleSheets||[];for(const a of i)if(PTe(a)){for(let l=0,c=a.cssRules;c[l];++l){const u=Object(c[l]);if(u.type!==1)continue;const f=Object(c[l+1]);if(f.type!==4)continue;++l;const{cssText:d}=u;if(!d.startsWith("--sxs"))continue;const h=d.slice(14,-3).trim().split(/\s+/),p=Jg[h[0]];p&&(e||(e={sheet:a,reset:r,rules:{},toString:n}),e.rules[p]={group:f,index:l,cache:new Set(h)})}if(e)break}if(!e){const a=(l,c)=>({type:c,cssRules:[],insertRule(u,f){this.cssRules.splice(f,0,a(u,{import:3,undefined:1}[(u.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return l==="@media{}"?`@media{${[].map.call(this.cssRules,u=>u.cssText).join("")}}`:l}});e={sheet:t?(t.head||t).appendChild(document.createElement("style")).sheet:a("","text/css"),rules:{},reset:r,toString:n}}const{sheet:s,rules:o}=e;for(let a=Jg.length-1;a>=0;--a){const l=Jg[a];if(!o[l]){const c=Jg[a+1],u=o[c]?o[c].index:s.cssRules.length;s.insertRule("@media{}",u),s.insertRule(`--sxs{--sxs:${a}}`,u),o[l]={group:s.cssRules[u+1],index:u,cache:new Set([a])}}LTe(o[l])}};return r(),e},LTe=t=>{const e=t.group;let n=e.cssRules.length;t.apply=r=>{try{e.insertRule(r,n),++n}catch{}}},Cg=Symbol(),DTe=i0(),LO=(t,e)=>DTe(t,()=>(...n)=>{let r={type:null,composers:new Set};for(const i of n)if(i!=null)if(i[Ld]){r.type==null&&(r.type=i[Ld].type);for(const s of i[Ld].composers)r.composers.add(s)}else i.constructor!==Object||i.$$typeof?r.type==null&&(r.type=i):r.composers.add(NTe(i,t));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),OTe(t,r,e)}),NTe=({variants:t,compoundVariants:e,defaultVariants:n,...r},i)=>{const s=`${cu(i.prefix)}c-${Dd(r)}`,o=[],a=[],l=Object.create(null),c=[];for(const d in n)l[d]=String(n[d]);if(typeof t=="object"&&t)for(const d in t){u=l,f=d,wTe.call(u,f)||(l[d]="undefined");const h=t[d];for(const p in h){const m={[d]:String(p)};String(p)==="undefined"&&c.push(d);const g=h[p],y=[m,g,!RO(g)];o.push(y)}}var u,f;if(typeof e=="object"&&e)for(const d of e){let{css:h,...p}=d;h=typeof h=="object"&&h||{};for(const g in p)p[g]=String(p[g]);const m=[p,h,!RO(h)];a.push(m)}return[s,r,o,a,l,c]},OTe=(t,e,n)=>{const[r,i,s,o]=FTe(e.composers),a=typeof e.type=="function"||e.type.$$typeof?(f=>{function d(){for(let h=0;h<d[Cg].length;h++){const[p,m]=d[Cg][h];f.rules[p].apply(m)}return d[Cg]=[],null}return d[Cg]=[],d.rules={},Jg.forEach(h=>d.rules[h]={apply:p=>d[Cg].push([h,p])}),d})(n):null,l=(a||n).rules,c=`.${r}${i.length>1?`:where(.${i.slice(1).join(".")})`:""}`,u=f=>{f=typeof f=="object"&&f||UTe;const{css:d,...h}=f,p={};for(const y in s)if(delete h[y],y in f){let x=f[y];typeof x=="object"&&x?p[y]={"@initial":s[y],...x}:(x=String(x),p[y]=x!=="undefined"||o.has(y)?x:s[y])}else p[y]=s[y];const m=new Set([...i]);for(const[y,x,_,w]of e.composers){n.rules.styled.cache.has(y)||(n.rules.styled.cache.add(y),Zp(x,[`.${y}`],[],t,C=>{l.styled.apply(C)}));const T=DO(_,p,t.media),S=DO(w,p,t.media,!0);for(const C of T)if(C!==void 0)for(const[A,R,M]of C){const D=`${y}-${Dd(R)}-${A}`;m.add(D);const k=(M?n.rules.resonevar:n.rules.onevar).cache,L=M?l.resonevar:l.onevar;k.has(D)||(k.add(D),Zp(R,[`.${D}`],[],t,N=>{L.apply(N)}))}for(const C of S)if(C!==void 0)for(const[A,R]of C){const M=`${y}-${Dd(R)}-${A}`;m.add(M),n.rules.allvar.cache.has(M)||(n.rules.allvar.cache.add(M),Zp(R,[`.${M}`],[],t,D=>{l.allvar.apply(D)}))}}if(typeof d=="object"&&d){const y=`${r}-i${Dd(d)}-css`;m.add(y),n.rules.inline.cache.has(y)||(n.rules.inline.cache.add(y),Zp(d,[`.${y}`],[],t,x=>{l.inline.apply(x)}))}for(const y of String(f.className||"").trim().split(/\s+/))y&&m.add(y);const g=h.className=[...m].join(" ");return{type:e.type,className:g,selector:c,props:h,toString:()=>g,deferredInjector:a}};return A8(u,{className:r,selector:c,[Ld]:e,toString:()=>(n.rules.styled.cache.has(r)||u(),r)})},FTe=t=>{let e="";const n=[],r={},i=[];for(const[s,,,,o,a]of t){e===""&&(e=s),n.push(s),i.push(...a);for(const l in o){const c=o[l];(r[l]===void 0||c!=="undefined"||a.includes(c))&&(r[l]=c)}}return[e,n,r,new Set(i)]},DO=(t,e,n,r)=>{const i=[];e:for(let[s,o,a]of t){if(a)continue;let l,c=0,u=!1;for(l in s){const f=s[l];let d=e[l];if(d!==f){if(typeof d!="object"||!d)continue e;{let h,p,m=0;for(const g in d){if(f===String(d[g])){if(g!=="@initial"){const y=g.slice(1);(p=p||[]).push(y in n?n[y]:g.replace(/^@media ?/,"")),u=!0}c+=m,h=!0}++m}if(p&&p.length&&(o={["@media "+p.join(", ")]:o}),!h)continue e}}}(i[c]=i[c]||[]).push([r?"cv":`${l}-${s[l]}`,o,u])}return i},UTe={},BTe=i0(),zTe=(t,e)=>BTe(t,()=>(...n)=>{const r=()=>{for(let i of n){i=typeof i=="object"&&i||{};let s=Dd(i);if(!e.rules.global.cache.has(s)){if(e.rules.global.cache.add(s),"@import"in i){let o=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let a of[].concat(i["@import"]))a=a.includes('"')||a.includes("'")?a:`"${a}"`,e.sheet.insertRule(`@import ${a};`,o++);delete i["@import"]}Zp(i,[],[],t,o=>{e.rules.global.apply(o)})}}return""};return A8(r,{toString:r})}),HTe=i0(),GTe=(t,e)=>HTe(t,()=>n=>{const r=`${cu(t.prefix)}k-${Dd(n)}`,i=()=>{if(!e.rules.global.cache.has(r)){e.rules.global.cache.add(r);const s=[];Zp(n,[],[],t,a=>s.push(a));const o=`@keyframes ${r}{${s.join("")}}`;e.rules.global.apply(o)}return r};return A8(i,{get name(){return i()},toString:i})}),jTe=class{constructor(t,e,n,r){this.token=t==null?"":String(t),this.value=e==null?"":String(e),this.scale=n==null?"":String(n),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+cu(this.prefix)+cu(this.scale)+this.token}toString(){return this.computedValue}},VTe=i0(),WTe=(t,e)=>VTe(t,()=>(n,r)=>{r=typeof n=="object"&&n||Object(r);const i=`.${n=(n=typeof n=="string"?n:"")||`${cu(t.prefix)}t-${Dd(r)}`}`,s={},o=[];for(const l in r){s[l]={};for(const c in r[l]){const u=`--${cu(t.prefix)}${l}-${c}`,f=kX(String(r[l][c]),t.prefix,l);s[l][c]=new jTe(c,f,l,t.prefix),o.push(`${u}:${f}`)}}const a=()=>{if(o.length&&!e.rules.themed.cache.has(n)){e.rules.themed.cache.add(n);const l=`${r===t.theme?":root,":""}.${n}{${o.join(";")}}`;e.rules.themed.apply(l)}return n};return{...s,get className(){return a()},selector:i,toString:a}}),$Te=i0(),NO,XTe=i0(),qTe=t=>{const e=(n=>{let r=!1;const i=$Te(n,s=>{r=!0;const o="prefix"in(s=typeof s=="object"&&s||{})?String(s.prefix):"",a=typeof s.media=="object"&&s.media||{},l=typeof s.root=="object"?s.root||null:globalThis.document||null,c=typeof s.theme=="object"&&s.theme||{},u={prefix:o,media:a,theme:c,themeMap:typeof s.themeMap=="object"&&s.themeMap||{...bTe},utils:typeof s.utils=="object"&&s.utils||{}},f=kTe(l),d={css:LO(u,f),globalCss:zTe(u,f),keyframes:GTe(u,f),createTheme:WTe(u,f),reset(){f.reset(),d.theme.toString()},theme:{},sheet:f,config:u,prefix:o,getCssText:f.toString,toString:f.toString};return String(d.theme=d.createTheme(c)),d});return r||i.reset(),i})(t);return e.styled=(({config:n,sheet:r})=>XTe(n,()=>{const i=LO(n,r);return(...s)=>{const o=i(...s),a=o[Ld].type,l=Ge.forwardRef((c,u)=>{const f=c&&c.as||a,{props:d,deferredInjector:h}=o(c);return delete d.as,d.ref=u,h?Ge.createElement(Ge.Fragment,null,Ge.createElement(f,d),Ge.createElement(h,null)):Ge.createElement(f,d)});return l.className=o.className,l.displayName=`Styled.${a.displayName||a.name||a}`,l.selector=o.selector,l.toString=()=>o.selector,l[Ld]=o[Ld],l}}))(e),e},YTe=()=>NO||(NO=qTe()),ds=(...t)=>YTe().styled(...t);const KTe=ds("div",{position:"fixed",top:0,right:0,zIndex:9999,fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif`,backgroundColor:"rgba(36, 36, 36, .9)",color:"#fff",margin:0,minHeight:"100px",padding:"4px 0","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",userSelect:"none","&.top-left":{right:"initial",left:0},"&.bottom-left":{right:"initial",top:"initial",bottom:0,left:0,".__perf_toggle":{top:"-20px",bottom:"initial"}},"&.bottom-right":{top:"initial",bottom:0,".__perf_toggle":{top:"-20px",bottom:"initial"}},"&.minimal":{backgroundColor:"rgba(36, 36, 36, .75)"},"*":{margin:"0",padding:"0",border:"0",fontSize:"100%",lineHeight:"1",verticalAlign:"baseline"}}),ZT=ds("small",{position:"absolute",right:0,fontSize:"10px"}),no=ds("div",{display:"inline-flex",fontStyle:"normal",padding:0,lineHeight:"13px",fontSize:"14px",width:"62px",position:"relative",pointerEvents:"auto",cursor:"default",fontWeight:500,letterSpacing:"0px",textAlign:"left",height:"29px",whiteSpace:"nowrap",justifyContent:"space-evenly",fontVariantNumeric:"tabular-nums",small:{paddingLeft:"12px"},svg:{padding:0,color:"rgba(145, 145, 145, 0.3)",fontSize:"40px",position:"absolute",zIndex:1,maxHeight:"20px",left:" 50%",marginLeft:"-23px",top:"4px"}}),Go=ds("span",{verticalAlign:"bottom",position:"absolute",bottom:"5px",color:"rgba(101, 197, 188, 1)",textAlign:"right",letterSpacing:"1px",fontSize:"8px",fontWeight:"500",width:"60px"}),ZTe=ds("div",{display:"flex"}),QTe=ds("div",{backgroundColor:"#404040",padding:"6px",display:"block",fontSize:"12px",marginBottom:"6px",cursor:"pointer","*":{cursor:"pointer !important"},"> span":{},small:{fontSize:"9px"},"> b":{marginRight:"4px",cursor:"pointer"}}),JTe=ds("div",{height:"66px",overflow:"hidden",position:"absolute",pointerEvents:"none",display:"flex",top:"0px",justifyContent:"center",width:"100%",minWidth:"310px",margin:"0 auto",canvas:{background:"transparent !important",position:"absolute !important"}}),eAe=ds("div",{textAlign:"center",fontWeight:700,fontSize:"12px",lineHeight:"12px",display:"flex",justifyContent:"center",alignItems:"center",verticalAlign:"middle",color:"#f1f1f1",padding:"7px",width:"100%",backgroundColor:"rgba(36, 36, 37, 0.8)",zIndex:1,position:"absolute",height:"100%"}),M8=ds("div",{pointerEvents:"auto",justifyContent:"center",cursor:"pointer",fontSize:"12px",backgroundColor:"rgb(41, 43, 45)",marginTop:"6px",width:"auto",margin:"0",color:"rgba(145, 145, 145, 1)",textAlign:"center",display:"inline-block",verticalAlign:"middle",padding:"4px 6px","&.__perf_toggle_tab_active":{backgroundColor:"rgb(31 31 31)"},svg:{width:"12px",height:"12px",float:"left"}}),tAe=ds("div",{pointerEvents:"auto",justifyContent:"center",cursor:"pointer",fontSize:"12px",float:"right",backgroundColor:"rgb(41, 43, 45)",width:"auto",margin:"0",color:"rgba(145, 145, 145, 1)",textAlign:"center",display:"inline-block",verticalAlign:"middle",padding:"4px 6px","&.__perf_toggle_tab_active":{backgroundColor:"rgb(31 31 31)"},svg:{width:"12px",height:"12px",float:"left"}}),nAe=ds("div",{padding:"4px 6px",fontSize:"12px",pointerEvents:"auto"}),rAe=ds("span",{fontWeight:"bold",letterSpacing:"0.08em",maxWidth:"145px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",verticalAlign:"middle",fontSize:"11px",marginRight:"10px"}),iAe=ds("div",{maxHeight:"50vh",overflowY:"auto",marginTop:"38px"}),sAe=ds("div",{marginTop:"0"}),OO=ds("div",{display:"flex",position:"relative",fontWeight:"bold",color:"#fff",lineHeight:"14px",svg:{marginRight:"4px",display:"inline-block"}}),LX=ds("ul",{display:"block",position:"relative",paddingLeft:"10px",margin:"6px 6px",img:{maxHeight:"60px",maxWidth:"100%",margin:"6px auto",display:"block"},"&:after":{content:"",position:"absolute",left:"0px",top:"0px",width:"1px",height:"100%",backgroundColor:"grey",transform:"translateX(-50%)",maxHeight:"50vh",overflowY:"auto"},li:{borderBottom:"1px solid #313131",display:"block",padding:"4px",margin:0,lineHeight:1,verticalAlign:"middle",height:"24px"},b:{fontWeight:"bold"},small:{textAlign:"revert",letterSpacing:"1px",fontSize:"10px",fontWeight:"500",marginLeft:"2px",color:"rgb(101, 197, 188)"}}),DX=ds("button",{fontWeight:"bold",letterSpacing:"0.02em",backgroundColor:"rgb(41, 43, 45)",color:"rgb(211, 211, 211)",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",display:"block",verticalAlign:"middle",fontSize:"11px",padding:"5px",margin:"4px auto"}),oAe=ds("div",{display:"flex",justifyContent:"center",cursor:"pointer",fontSize:"12px",backgroundColor:"rgb(41, 43, 45)",marginTop:"6px",width:"auto",margin:"0 auto",color:"rgba(145, 145, 145, 1)",textAlign:"center",position:"absolute",right:0,bottom:" -20px",svg:{width:"12px",height:"12px",float:"left"}}),aAe=ds("li",{display:"flex !important",height:"auto !important",span:{height:"40px",display:"block",position:"relative"},b:{paddingLeft:"12px"}});function ji(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var lAe=["color"],NX=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,lAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M0 1.5C0 1.22386 0.223858 1 0.5 1H2.5C2.77614 1 3 1.22386 3 1.5C3 1.77614 2.77614 2 2.5 2H0.5C0.223858 2 0 1.77614 0 1.5ZM4 1.5C4 1.22386 4.22386 1 4.5 1H14.5C14.7761 1 15 1.22386 15 1.5C15 1.77614 14.7761 2 14.5 2H4.5C4.22386 2 4 1.77614 4 1.5ZM4 4.5C4 4.22386 4.22386 4 4.5 4H11.5C11.7761 4 12 4.22386 12 4.5C12 4.77614 11.7761 5 11.5 5H4.5C4.22386 5 4 4.77614 4 4.5ZM0 7.5C0 7.22386 0.223858 7 0.5 7H2.5C2.77614 7 3 7.22386 3 7.5C3 7.77614 2.77614 8 2.5 8H0.5C0.223858 8 0 7.77614 0 7.5ZM4 7.5C4 7.22386 4.22386 7 4.5 7H14.5C14.7761 7 15 7.22386 15 7.5C15 7.77614 14.7761 8 14.5 8H4.5C4.22386 8 4 7.77614 4 7.5ZM4 10.5C4 10.2239 4.22386 10 4.5 10H11.5C11.7761 10 12 10.2239 12 10.5C12 10.7761 11.7761 11 11.5 11H4.5C4.22386 11 4 10.7761 4 10.5ZM0 13.5C0 13.2239 0.223858 13 0.5 13H2.5C2.77614 13 3 13.2239 3 13.5C3 13.7761 2.77614 14 2.5 14H0.5C0.223858 14 0 13.7761 0 13.5ZM4 13.5C4 13.2239 4.22386 13 4.5 13H14.5C14.7761 13 15 13.2239 15 13.5C15 13.7761 14.7761 14 14.5 14H4.5C4.22386 14 4 13.7761 4 13.5Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),cAe=["color"],uAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,cAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M11.5 1C11.7761 1 12 1.22386 12 1.5V13.5C12 13.7761 11.7761 14 11.5 14C11.2239 14 11 13.7761 11 13.5V1.5C11 1.22386 11.2239 1 11.5 1ZM9.5 3C9.77614 3 10 3.22386 10 3.5V13.5C10 13.7761 9.77614 14 9.5 14C9.22386 14 9 13.7761 9 13.5V3.5C9 3.22386 9.22386 3 9.5 3ZM13.5 3C13.7761 3 14 3.22386 14 3.5V13.5C14 13.7761 13.7761 14 13.5 14C13.2239 14 13 13.7761 13 13.5V3.5C13 3.22386 13.2239 3 13.5 3ZM5.5 4C5.77614 4 6 4.22386 6 4.5V13.5C6 13.7761 5.77614 14 5.5 14C5.22386 14 5 13.7761 5 13.5V4.5C5 4.22386 5.22386 4 5.5 4ZM1.5 5C1.77614 5 2 5.22386 2 5.5V13.5C2 13.7761 1.77614 14 1.5 14C1.22386 14 1 13.7761 1 13.5V5.5C1 5.22386 1.22386 5 1.5 5ZM7.5 5C7.77614 5 8 5.22386 8 5.5V13.5C8 13.7761 7.77614 14 7.5 14C7.22386 14 7 13.7761 7 13.5V5.5C7 5.22386 7.22386 5 7.5 5ZM3.5 7C3.77614 7 4 7.22386 4 7.5V13.5C4 13.7761 3.77614 14 3.5 14C3.22386 14 3 13.7761 3 13.5V7.5C3 7.22386 3.22386 7 3.5 7Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),fAe=["color"],dAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,fAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M2 5H13C13.5523 5 14 5.44772 14 6V9C14 9.55228 13.5523 10 13 10H2C1.44772 10 1 9.55228 1 9V6C1 5.44772 1.44772 5 2 5ZM0 6C0 4.89543 0.895431 4 2 4H13C14.1046 4 15 4.89543 15 6V9C15 10.1046 14.1046 11 13 11H2C0.89543 11 0 10.1046 0 9V6ZM4.5 6.75C4.08579 6.75 3.75 7.08579 3.75 7.5C3.75 7.91421 4.08579 8.25 4.5 8.25C4.91421 8.25 5.25 7.91421 5.25 7.5C5.25 7.08579 4.91421 6.75 4.5 6.75ZM6.75 7.5C6.75 7.08579 7.08579 6.75 7.5 6.75C7.91421 6.75 8.25 7.08579 8.25 7.5C8.25 7.91421 7.91421 8.25 7.5 8.25C7.08579 8.25 6.75 7.91421 6.75 7.5ZM10.5 6.75C10.0858 6.75 9.75 7.08579 9.75 7.5C9.75 7.91421 10.0858 8.25 10.5 8.25C10.9142 8.25 11.25 7.91421 11.25 7.5C11.25 7.08579 10.9142 6.75 10.5 6.75Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),hAe=["color"],pAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,hAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M7.28856 0.796908C7.42258 0.734364 7.57742 0.734364 7.71144 0.796908L13.7114 3.59691C13.8875 3.67906 14 3.85574 14 4.05V10.95C14 11.1443 13.8875 11.3209 13.7114 11.4031L7.71144 14.2031C7.57742 14.2656 7.42258 14.2656 7.28856 14.2031L1.28856 11.4031C1.11252 11.3209 1 11.1443 1 10.95V4.05C1 3.85574 1.11252 3.67906 1.28856 3.59691L7.28856 0.796908ZM2 4.80578L7 6.93078V12.9649L2 10.6316V4.80578ZM8 12.9649L13 10.6316V4.80578L8 6.93078V12.9649ZM7.5 6.05672L12.2719 4.02866L7.5 1.80176L2.72809 4.02866L7.5 6.05672Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),mAe=["color"],gAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,mAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M7.5 9.125C8.39746 9.125 9.125 8.39746 9.125 7.5C9.125 6.60254 8.39746 5.875 7.5 5.875C6.60254 5.875 5.875 6.60254 5.875 7.5C5.875 8.39746 6.60254 9.125 7.5 9.125ZM7.5 10.125C8.94975 10.125 10.125 8.94975 10.125 7.5C10.125 6.05025 8.94975 4.875 7.5 4.875C6.05025 4.875 4.875 6.05025 4.875 7.5C4.875 8.94975 6.05025 10.125 7.5 10.125Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),yAe=["color"],vAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,yAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M7.49999 3.09998C7.27907 3.09998 7.09999 3.27906 7.09999 3.49998C7.09999 3.72089 7.27907 3.89998 7.49999 3.89998H14.5C14.7209 3.89998 14.9 3.72089 14.9 3.49998C14.9 3.27906 14.7209 3.09998 14.5 3.09998H7.49999ZM7.49998 5.1C7.27907 5.1 7.09998 5.27908 7.09998 5.5C7.09998 5.72091 7.27907 5.9 7.49998 5.9H14.5C14.7209 5.9 14.9 5.72091 14.9 5.5C14.9 5.27908 14.7209 5.1 14.5 5.1H7.49998ZM7.1 7.5C7.1 7.27908 7.27909 7.1 7.5 7.1H14.5C14.7209 7.1 14.9 7.27908 14.9 7.5C14.9 7.72091 14.7209 7.9 14.5 7.9H7.5C7.27909 7.9 7.1 7.72091 7.1 7.5ZM7.49998 9.1C7.27907 9.1 7.09998 9.27908 7.09998 9.5C7.09998 9.72091 7.27907 9.9 7.49998 9.9H14.5C14.7209 9.9 14.9 9.72091 14.9 9.5C14.9 9.27908 14.7209 9.1 14.5 9.1H7.49998ZM7.09998 11.5C7.09998 11.2791 7.27907 11.1 7.49998 11.1H14.5C14.7209 11.1 14.9 11.2791 14.9 11.5C14.9 11.7209 14.7209 11.9 14.5 11.9H7.49998C7.27907 11.9 7.09998 11.7209 7.09998 11.5ZM2.5 9.25003L5 6.00003H0L2.5 9.25003Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),xAe=["color"],_Ae=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,xAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M13.3536 2.35355C13.5488 2.15829 13.5488 1.84171 13.3536 1.64645C13.1583 1.45118 12.8417 1.45118 12.6464 1.64645L10.6828 3.61012C9.70652 3.21671 8.63759 3 7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C0.902945 9.08812 2.02314 10.1861 3.36061 10.9323L1.64645 12.6464C1.45118 12.8417 1.45118 13.1583 1.64645 13.3536C1.84171 13.5488 2.15829 13.5488 2.35355 13.3536L4.31723 11.3899C5.29348 11.7833 6.36241 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C14.0971 5.9119 12.9769 4.81391 11.6394 4.06771L13.3536 2.35355ZM9.90428 4.38861C9.15332 4.1361 8.34759 4 7.5 4C4.80285 4 2.52952 5.37816 1.09622 7.50001C1.87284 8.6497 2.89609 9.58106 4.09974 10.1931L9.90428 4.38861ZM5.09572 10.6114L10.9003 4.80685C12.1039 5.41894 13.1272 6.35031 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11C6.65241 11 5.84668 10.8639 5.09572 10.6114Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),bAe=["color"],EAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,bAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M7.5 11C4.80285 11 2.52952 9.62184 1.09622 7.50001C2.52952 5.37816 4.80285 4 7.5 4C10.1971 4 12.4705 5.37816 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11ZM7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C1.65639 10.2936 4.30786 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C13.3436 4.70638 10.6921 3 7.5 3ZM7.5 9.5C8.60457 9.5 9.5 8.60457 9.5 7.5C9.5 6.39543 8.60457 5.5 7.5 5.5C6.39543 5.5 5.5 6.39543 5.5 7.5C5.5 8.60457 6.39543 9.5 7.5 9.5Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),wAe=["color"],fM=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,wAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M2.5 1H12.5C13.3284 1 14 1.67157 14 2.5V12.5C14 13.3284 13.3284 14 12.5 14H2.5C1.67157 14 1 13.3284 1 12.5V2.5C1 1.67157 1.67157 1 2.5 1ZM2.5 2C2.22386 2 2 2.22386 2 2.5V8.3636L3.6818 6.6818C3.76809 6.59551 3.88572 6.54797 4.00774 6.55007C4.12975 6.55216 4.24568 6.60372 4.32895 6.69293L7.87355 10.4901L10.6818 7.6818C10.8575 7.50607 11.1425 7.50607 11.3182 7.6818L13 9.3636V2.5C13 2.22386 12.7761 2 12.5 2H2.5ZM2 12.5V9.6364L3.98887 7.64753L7.5311 11.4421L8.94113 13H2.5C2.22386 13 2 12.7761 2 12.5ZM12.5 13H10.155L8.48336 11.153L11 8.6364L13 10.6364V12.5C13 12.7761 12.7761 13 12.5 13ZM6.64922 5.5C6.64922 5.03013 7.03013 4.64922 7.5 4.64922C7.96987 4.64922 8.35078 5.03013 8.35078 5.5C8.35078 5.96987 7.96987 6.35078 7.5 6.35078C7.03013 6.35078 6.64922 5.96987 6.64922 5.5ZM7.5 3.74922C6.53307 3.74922 5.74922 4.53307 5.74922 5.5C5.74922 6.46693 6.53307 7.25078 7.5 7.25078C8.46693 7.25078 9.25078 6.46693 9.25078 5.5C9.25078 4.53307 8.46693 3.74922 7.5 3.74922Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),SAe=["color"],TAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,SAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M5.49998 0.5C5.49998 0.223858 5.72383 0 5.99998 0H7.49998H8.99998C9.27612 0 9.49998 0.223858 9.49998 0.5C9.49998 0.776142 9.27612 1 8.99998 1H7.99998V2.11922C9.09832 2.20409 10.119 2.56622 10.992 3.13572C11.0116 3.10851 11.0336 3.08252 11.058 3.05806L12.058 2.05806C12.3021 1.81398 12.6978 1.81398 12.9419 2.05806C13.186 2.30214 13.186 2.69786 12.9419 2.94194L11.967 3.91682C13.1595 5.07925 13.9 6.70314 13.9 8.49998C13.9 12.0346 11.0346 14.9 7.49998 14.9C3.96535 14.9 1.09998 12.0346 1.09998 8.49998C1.09998 5.13361 3.69904 2.3743 6.99998 2.11922V1H5.99998C5.72383 1 5.49998 0.776142 5.49998 0.5ZM2.09998 8.49998C2.09998 5.51764 4.51764 3.09998 7.49998 3.09998C10.4823 3.09998 12.9 5.51764 12.9 8.49998C12.9 11.4823 10.4823 13.9 7.49998 13.9C4.51764 13.9 2.09998 11.4823 2.09998 8.49998ZM7.49998 8.49998V4.09998C5.06992 4.09998 3.09998 6.06992 3.09998 8.49998C3.09998 10.93 5.06992 12.9 7.49998 12.9C8.715 12.9 9.815 12.4075 10.6112 11.6112L7.49998 8.49998Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),AAe=["color"],MAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,AAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M7.75432 0.819537C7.59742 0.726821 7.4025 0.726821 7.24559 0.819537L1.74559 4.06954C1.59336 4.15949 1.49996 4.32317 1.49996 4.5C1.49996 4.67683 1.59336 4.84051 1.74559 4.93046L7.24559 8.18046C7.4025 8.27318 7.59742 8.27318 7.75432 8.18046L13.2543 4.93046C13.4066 4.84051 13.5 4.67683 13.5 4.5C13.5 4.32317 13.4066 4.15949 13.2543 4.06954L7.75432 0.819537ZM7.49996 7.16923L2.9828 4.5L7.49996 1.83077L12.0171 4.5L7.49996 7.16923ZM1.5695 7.49564C1.70998 7.2579 2.01659 7.17906 2.25432 7.31954L7.49996 10.4192L12.7456 7.31954C12.9833 7.17906 13.2899 7.2579 13.4304 7.49564C13.5709 7.73337 13.4921 8.03998 13.2543 8.18046L7.75432 11.4305C7.59742 11.5232 7.4025 11.5232 7.24559 11.4305L1.74559 8.18046C1.50786 8.03998 1.42901 7.73337 1.5695 7.49564ZM1.56949 10.4956C1.70998 10.2579 2.01658 10.1791 2.25432 10.3195L7.49996 13.4192L12.7456 10.3195C12.9833 10.1791 13.2899 10.2579 13.4304 10.4956C13.5709 10.7334 13.4921 11.04 13.2543 11.1805L7.75432 14.4305C7.59742 14.5232 7.4025 14.5232 7.24559 14.4305L1.74559 11.1805C1.50785 11.04 1.42901 10.7334 1.56949 10.4956Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),CAe=["color"],RAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,CAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M8.69667 0.0403541C8.90859 0.131038 9.03106 0.354857 8.99316 0.582235L8.0902 6.00001H12.5C12.6893 6.00001 12.8625 6.10701 12.9472 6.27641C13.0319 6.4458 13.0136 6.6485 12.8999 6.80001L6.89997 14.8C6.76167 14.9844 6.51521 15.0503 6.30328 14.9597C6.09135 14.869 5.96888 14.6452 6.00678 14.4178L6.90974 9H2.49999C2.31061 9 2.13748 8.893 2.05278 8.72361C1.96809 8.55422 1.98636 8.35151 2.09999 8.2L8.09997 0.200038C8.23828 0.0156255 8.48474 -0.0503301 8.69667 0.0403541ZM3.49999 8.00001H7.49997C7.64695 8.00001 7.78648 8.06467 7.88148 8.17682C7.97648 8.28896 8.01733 8.43723 7.99317 8.5822L7.33027 12.5596L11.5 7.00001H7.49997C7.353 7.00001 7.21347 6.93534 7.11846 6.8232C7.02346 6.71105 6.98261 6.56279 7.00678 6.41781L7.66968 2.44042L3.49999 8.00001Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),IAe=["color"],PAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,IAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M1.49988 2.00012C1.77602 2.00012 1.99988 1.77626 1.99988 1.50012C1.99988 1.22398 1.77602 1.00012 1.49988 1.00012C1.22374 1.00012 0.999878 1.22398 0.999878 1.50012C0.999878 1.77626 1.22374 2.00012 1.49988 2.00012ZM4.49988 2.00012C4.77602 2.00012 4.99988 1.77626 4.99988 1.50012C4.99988 1.22398 4.77602 1.00012 4.49988 1.00012C4.22374 1.00012 3.99988 1.22398 3.99988 1.50012C3.99988 1.77626 4.22374 2.00012 4.49988 2.00012ZM7.99988 1.50012C7.99988 1.77626 7.77602 2.00012 7.49988 2.00012C7.22374 2.00012 6.99988 1.77626 6.99988 1.50012C6.99988 1.22398 7.22374 1.00012 7.49988 1.00012C7.77602 1.00012 7.99988 1.22398 7.99988 1.50012ZM10.4999 2.00012C10.776 2.00012 10.9999 1.77626 10.9999 1.50012C10.9999 1.22398 10.776 1.00012 10.4999 1.00012C10.2237 1.00012 9.99988 1.22398 9.99988 1.50012C9.99988 1.77626 10.2237 2.00012 10.4999 2.00012ZM13.9999 1.50012C13.9999 1.77626 13.776 2.00012 13.4999 2.00012C13.2237 2.00012 12.9999 1.77626 12.9999 1.50012C12.9999 1.22398 13.2237 1.00012 13.4999 1.00012C13.776 1.00012 13.9999 1.22398 13.9999 1.50012ZM1.49988 14.0001C1.77602 14.0001 1.99988 13.7763 1.99988 13.5001C1.99988 13.224 1.77602 13.0001 1.49988 13.0001C1.22374 13.0001 0.999878 13.224 0.999878 13.5001C0.999878 13.7763 1.22374 14.0001 1.49988 14.0001ZM1.99988 10.5001C1.99988 10.7763 1.77602 11.0001 1.49988 11.0001C1.22374 11.0001 0.999878 10.7763 0.999878 10.5001C0.999878 10.224 1.22374 10.0001 1.49988 10.0001C1.77602 10.0001 1.99988 10.224 1.99988 10.5001ZM1.49988 8.00012C1.77602 8.00012 1.99988 7.77626 1.99988 7.50012C1.99988 7.22398 1.77602 7.00012 1.49988 7.00012C1.22374 7.00012 0.999878 7.22398 0.999878 7.50012C0.999878 7.77626 1.22374 8.00012 1.49988 8.00012ZM1.99988 4.50012C1.99988 4.77626 1.77602 5.00012 1.49988 5.00012C1.22374 5.00012 0.999878 4.77626 0.999878 4.50012C0.999878 4.22398 1.22374 4.00012 1.49988 4.00012C1.77602 4.00012 1.99988 4.22398 1.99988 4.50012ZM13.4999 11.0001C13.776 11.0001 13.9999 10.7763 13.9999 10.5001C13.9999 10.224 13.776 10.0001 13.4999 10.0001C13.2237 10.0001 12.9999 10.224 12.9999 10.5001C12.9999 10.7763 13.2237 11.0001 13.4999 11.0001ZM13.9999 7.50012C13.9999 7.77626 13.776 8.00012 13.4999 8.00012C13.2237 8.00012 12.9999 7.77626 12.9999 7.50012C12.9999 7.22398 13.2237 7.00012 13.4999 7.00012C13.776 7.00012 13.9999 7.22398 13.9999 7.50012ZM13.4999 5.00012C13.776 5.00012 13.9999 4.77626 13.9999 4.50012C13.9999 4.22398 13.776 4.00012 13.4999 4.00012C13.2237 4.00012 12.9999 4.22398 12.9999 4.50012C12.9999 4.77626 13.2237 5.00012 13.4999 5.00012ZM4.99988 13.5001C4.99988 13.7763 4.77602 14.0001 4.49988 14.0001C4.22374 14.0001 3.99988 13.7763 3.99988 13.5001C3.99988 13.224 4.22374 13.0001 4.49988 13.0001C4.77602 13.0001 4.99988 13.224 4.99988 13.5001ZM7.49988 14.0001C7.77602 14.0001 7.99988 13.7763 7.99988 13.5001C7.99988 13.224 7.77602 13.0001 7.49988 13.0001C7.22374 13.0001 6.99988 13.224 6.99988 13.5001C6.99988 13.7763 7.22374 14.0001 7.49988 14.0001ZM10.9999 13.5001C10.9999 13.7763 10.776 14.0001 10.4999 14.0001C10.2237 14.0001 9.99988 13.7763 9.99988 13.5001C9.99988 13.224 10.2237 13.0001 10.4999 13.0001C10.776 13.0001 10.9999 13.224 10.9999 13.5001ZM13.4999 14.0001C13.776 14.0001 13.9999 13.7763 13.9999 13.5001C13.9999 13.224 13.776 13.0001 13.4999 13.0001C13.2237 13.0001 12.9999 13.224 12.9999 13.5001C12.9999 13.7763 13.2237 14.0001 13.4999 14.0001ZM3.99988 5.00012C3.99988 4.44784 4.44759 4.00012 4.99988 4.00012H9.99988C10.5522 4.00012 10.9999 4.44784 10.9999 5.00012V10.0001C10.9999 10.5524 10.5522 11.0001 9.99988 11.0001H4.99988C4.44759 11.0001 3.99988 10.5524 3.99988 10.0001V5.00012ZM4.99988 5.00012H9.99988V10.0001H4.99988V5.00012Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),kAe=["color"],LAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,kAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M2.25 7.5C2.25 7.22386 2.47386 7 2.75 7H12.25C12.5261 7 12.75 7.22386 12.75 7.5C12.75 7.77614 12.5261 8 12.25 8H2.75C2.47386 8 2.25 7.77614 2.25 7.5Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),DAe=["color"],NAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,DAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M6.04995 2.74998C6.04995 2.44623 5.80371 2.19998 5.49995 2.19998C5.19619 2.19998 4.94995 2.44623 4.94995 2.74998V12.25C4.94995 12.5537 5.19619 12.8 5.49995 12.8C5.80371 12.8 6.04995 12.5537 6.04995 12.25V2.74998ZM10.05 2.74998C10.05 2.44623 9.80371 2.19998 9.49995 2.19998C9.19619 2.19998 8.94995 2.44623 8.94995 2.74998V12.25C8.94995 12.5537 9.19619 12.8 9.49995 12.8C9.80371 12.8 10.05 12.5537 10.05 12.25V2.74998Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),OAe=["color"],FAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,OAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),UAe=["color"],BAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,UAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M0.5 4C0.223858 4 0 4.22386 0 4.5V10.5C0 10.7761 0.223858 11 0.5 11H14.5C14.7761 11 15 10.7761 15 10.5V4.5C15 4.22386 14.7761 4 14.5 4H0.5ZM1 10V5H2.075V7.5C2.075 7.73472 2.26528 7.925 2.5 7.925C2.73472 7.925 2.925 7.73472 2.925 7.5V5H4.075V6.5C4.075 6.73472 4.26528 6.925 4.5 6.925C4.73472 6.925 4.925 6.73472 4.925 6.5V5H6.075V6.5C6.075 6.73472 6.26528 6.925 6.5 6.925C6.73472 6.925 6.925 6.73472 6.925 6.5V5H8.075V7.5C8.075 7.73472 8.26528 7.925 8.5 7.925C8.73472 7.925 8.925 7.73472 8.925 7.5V5H10.075V6.5C10.075 6.73472 10.2653 6.925 10.5 6.925C10.7347 6.925 10.925 6.73472 10.925 6.5V5H12.075V6.5C12.075 6.73472 12.2653 6.925 12.5 6.925C12.7347 6.925 12.925 6.73472 12.925 6.5V5H14V10H1Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),zAe=["color"],HAe=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,zAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M2.5 4C2.22386 4 2 4.22386 2 4.5C2 4.77614 2.22386 5 2.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H2.5ZM2 7.5C2 7.22386 2.22386 7 2.5 7H12.5C12.7761 7 13 7.22386 13 7.5C13 7.77614 12.7761 8 12.5 8H2.5C2.22386 8 2 7.77614 2 7.5ZM2 10.5C2 10.2239 2.22386 10 2.5 10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H2.5C2.22386 11 2 10.7761 2 10.5Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),GAe=["color"],OX=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,GAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M4 6H11L7.5 10.5L4 6Z",fill:r}))}),jAe=["color"],FX=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,jAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M4 9H11L7.5 4.5L4 9Z",fill:r}))}),VAe=["color"],UX=v.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=ji(t,VAe);return v.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),v.createElement("path",{d:"M7.49998 1L6.92321 2.00307L1.17498 12L0.599976 13H1.7535H13.2464H14.4L13.825 12L8.07674 2.00307L7.49998 1ZM7.49998 3.00613L2.3285 12H12.6714L7.49998 3.00613Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))});const FO="data:font/woff;base64,d09GRk9UVE8AAC6gAA0AAAAAQzgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABDRkYgAAAFIAAAIfMAAChRZFKn5EZGVE0AAC1EAAAAHAAAAByCRgjeR0RFRgAAJxQAAAArAAAANACwACRHUE9TAAAn9AAABU8AAA+MgotnaUdTVUIAACdAAAAAsQAAAWRlFnIQT1MvMgAAAZAAAABUAAAAYJf2spxjbWFwAAAEcAAAAJkAAAFCnGFvpGhlYWQAAAEwAAAANgAAADYNzYU0aGhlYQAAAWgAAAAgAAAAJA8QBSlobXR4AAAtYAAAAT8AAAGAjJsgS21heHAAAAGIAAAABgAAAAYAYFAAbmFtZQAAAeQAAAKJAAAFH4LLI15wb3N0AAAFDAAAABMAAAAg/20AZAABAAAAAiMSbAClT18PPPUACwgAAAAAAMTwES4AAAAA4yMHK/+1/jEG5QabAAAACAACAAAAAAAAeJxjYGRg4Cj+u5aBgV3j/9b/n9meMgBFUEACAKj9B0gAAFAAAGAAAHicY2BmUWT8wsDKwMI6i9WYgYFRHkIzX2RIY2JgYABhCHjAwPQ/gEEhGshUAPHd/f3dGRyA7Do2hn9APkcxU7ACA+N8kByLFesGoIwCAxMAY8AM0niclZS/TttQFMY/O5CIkiAQZUFVdSdUIWKTMEQCtWoUIYQEDKHqhKoa+5JYGN/IdojoC3Tt0k4dO1V9gj5Cxy59g459gg797BxCoHRoLF//7vlzz/E5xwHw2IphYfxz8VrYQg1fhG1U8E24RPkv4RmsWE+EZ7FsnQmXUbM+CFegrJ/CcyjbK8LzeGA3hatYtrVwDY79Q3gB66UT4UWUS++Fl8ifmYk1M8fdqyKrnC2s4p2wTe+vwiXKvwvPYB2/hWexZj0TLmPVeiNcwXPrk/AcqnZFeB4P7UfCVazZT4VrOLGvhBfwolQWXkS19FZ4ifwRHRgMcIUEIXroI4NCE5to8FLYo9ZQHkFzt48YPhxSm5KIz+7EKy12mk/Nsy65BrRExwyukrDXz1Rzs9FQe8b0Iq32Y99R7ShS3VyVqq5OdXKpAzp0Ge+Ud8Zb4bA4J8QQF1SZU5MZdaiDcJhvqetRE8FjRHR1bxh5yf+d8C9L9dfp055qEutl8bYpvQxrk1fOYd220MLOpI4tmukkDU2smk5jq7WTl6J1O3r9vjzr9+cZFrX2eGeM7dFL0yfP8pwyg7M7fXMm2Yep8lSWeIG+8JJzZc6kH7SYdsBYijun+OSLa6XjG3KHrU+KhDKuXlGCcbJ5WfKhyMuCTj8J0yz0YsVEdJKlhsIDevi0i4uRCeg5JAeFZ/5q/WLk2hxOj3bj3W2fDUrua8AmDw99Hac6UMM40InK+lq1B57Ph2g21E1PaJ9PcMZQ2/y/cTEqLoeBb4I7DJCwFi6rMZ1ESskBv4wOdnGEY6716yT6WTbYdt3RaOR4RXDHJD03GieQugf7nd2j4916kcB0i6VduD0TMgx/AIq26g8AAAB4nGNgYGBmgGAZBkYGELAB8hjBfBYGBSDNAoQgft3//0BS4f///w+hKhkY2RhgTJyAkYmZhZWNnYOTi5uHl49fQFBIWERUTFxCUkpaRlZOXkFRSVlFVU1dQ1NLW0dXT9/A0MjYxNTM3MLSytrG1s7ewdHJ2cXVzd3D08vbx9fPPyAwKDgkNCw8IjIqOiY2Lp6A7bQHAPlYGQAAAAB4nGNgZgCD/1kMKQxYAAAqHwHRAHiclXoHXFRX0/ddYXcvllVYF42uig07dkWpoiIWkKYodekKKEhbrPjkMWKcmKDJEyxBsSIgRUS6xqgIYsOuiA01diOJZu7uWfi+uWie8v7e7/u973KWPew9Zc7/zPxn5hwknLExJ5FIFJ6xIbGJsaNcw8OWJi3jJB04Ceci9OYEtUTo00HoayT0MGb+nY1+62zctyNnvGloP4B/VjrLHQ2hatkztWyXVM1d6armuG5qybemas5KPeShGWcsjtaZs+HcuYBxVmPHT7axGDdm7OTpsXEr45dGLkkU/xprMSs2NjIm3GL28lAri2kxMRae4qMEC8/whPD45PAwq08SWnySkL6OTIoJjv+PLzl6SbgOnBFnzEk5GSfnlnAmXEeuE03ehVNwXblunClnxim57pyKM+d6cD25L7heXG9OzfXh+nL9OAuuPzeAG8gN4gZzltwQbig3jBvOjeBGcqM4K240N4Yby43jxnMTuIncJG4yZ81N4abSwmw5O86ec+AcuTWcEzedm8HN5Jy5WZwLN5ubw83l5nGunBs3nwDw4Dw5L86bW8At5Hy4Rdxizpfz4/y5AC6QC+I0IlKDaOKvuArJqA5Ko+HGQ4znGVdLR0lXSfdKG6UtMmOZWlYmeyjX8GP5BBMTk59NnnZ83Wl/p986L+m8uXNe58tdtnX9ouv8rn9222FqZupgGmlmYjbVzNss1+yZ0li5WLmlu3P3fNUKVbN5hfnDHtY9gnvs6XG9p1HPET0Deqb0PNSzrufdnvjFuV6Ler3tnaruro7oM6LPyj63+wb23dm3pJ9jv20WIyxO9p/ff+sAvwE5AyUDBw8MGvj9wAeD5IO0g7YO5gdvYaHQoqtrkbS0CIYWoxZzXZ3+h9Y6WUublUpXJxha6+SK1nBFq/1a3KE2rtCa4UA8zDZjuPIR1eQqiMhYtj9+f3x+ahmUQX7G/gP7D2TkQBGvbICjqXnxB+IPRGVoQANRqfHxfHx8ajSE89vUUjvVvrYMDIf9+gypwnBBv0nIMnuPTswJ++GkT5/KrPf6TSrsB1LlKYuOyk34iyHr05/pFh0Vu7OSBSsch5dwvDBBK3ktWKlwNTgYrNAWbtOTxPa6TXv9OwAcx1ZADbX+kurjWRhI7woTmA3YGSawJPhX/SAAG49p4MEusR0gFaaZi50Sxb+lilW4SH9fGG/2G6ax+ZiGxjRSP5yA3TFN+eo3Yb4KWM+C/tdsrtm0+GPPNTxbiOPRR45dt78uabjacLXgV0Ap1H7588ryleUrjkXlR+WH5Pge8j3kcnhSLj8p1y0/soBX3oosWFUBNXAxs7qwoLDgxE8X4CKcSDjqd9RvtwtM5nGjDLBH9Md59+fdH1vF+J94jGMT2HI5k68brXGZ4TJj6RhgRsAm32XdcLR1ZfzF2IfLHi6rjSqMKIzIDABPHtxS/EIjQiM8VjqAPbjtC67gla+CK5IvwkNegQe1OEjogZa0wYMFc7SUvEN7zEW7B+0f9kbv9M9UYHXYsca7xvtW3DN4Dreyz9Ar+zo089fl8GvsTa8zXmccDlvBaJi23NPL0yt2Oozn0d5edVMOlRnFBw4fOJy/4zgchyNrDy4/uHx7BATwTnLwXRceHxsfu3RNCARD1M4V2Suy1xVBBX+xbbgKTafr/NTG8cz0upRtbtujgjHZTme9znrdjn0BLz6LcEgU4ZocXi6/5XHa47RT9hgYC9NiPbw9vJc7wTgSwU4UoXp78cHsg9lHdpRAiShC7MFYEsGfd5TD4nXhCbEJsVFrNRACS3auOLziMIlQzivuanEhG5WslkrQx+wxaUBXTMFajKzASGXpY6EPbX7XsiGPHR47oDwcB4FYuhX/cZdXLr8/HAuAReFW6UOUH8chgLN4FimDYdpxITY8y8dH765Lr548cTKXfnaehjp4vvTOrPOzzk/M6w/MBEYtdZ7tPHvJWGAyHvwz/PYu3ru42O3sDMbZT58V4cVHeK10BRdeWYpp36vg7rGGe3V87l68ZugkneFtHzcFnMAjS3Oc1xxPOg2XeaXVB52fCqp3HMvOy847uquSLLdw7eG4w3E7yDrBM9k/JIKPiWdGDlLnR0uvwhle0WaiTxe2m91HV+aK45VZ9/XpKhwvWuZBoTegKXMFMuMdZAkrjLC78JTAmJLFRpSwvlTqmOIe60Dlkf3TIL4Ke0sHPbDBLp44jkosugAG8t88lqajxxG0qUFLKrexw8trvB8OkI4LmuRgwyRU3JhpCOtLJZlZArPiFYatggRTjI6xJlUV6y19Vvq48QFKqdShaQn2pbIHBwAO5TfflW7EfgnYW4PmVNywo80Hmw/WNyeV8H5MnRsrfTX6Out6ko2kcoDZAXPlE+XANMvZHA82nooN6zjEnlewRrW0SGsmSHEWs8ZhyqxD+nIV1oxnoewAWg5GZ8xDF1aCgz8yf9yN9U8WoCM7weQE0078nc0ivLJ2sjfsNJpIFWOF2xgvERbieqMrwm2VYGaYieuFmUI3jDd0E4ax9YZhBjOZonUvaxJqJWiOy42y2bcq7GEnPV1Rfq7gWsG1zKvfXOO/wekslljLQ7rZf0PA2sC1gXE+YW6EzhkhExdJrgl7ja4JmSphLy4y7KXxhqzHPRLsjYVG9KuLqn9HhWGKuCzJFmaqQi8Qrqplo5gX7ScpvP45+kg+4EZhCaYZfRBeqLawoBI26t7AewOxow+OBZwA2OmXux/vfjyG4wDDeUyXf41BoTjKrsWuhXU+ycYDmwiss4/dALsBYYx0mNpsZPtU+EC+BbvveVlUW1R7LrcRmqA2pmhu0dzdQ4D14dl9+desh3Z4hGuEq8cyO5gK84+EXw6/nPIeUM0rssgOj2sltKiNRmirz1OhDhWgZrG4EYAexYDhIguXKoCWcJ2W0IRpQhgtoUn0KGkyeLD3UmlVaVXd/ka4BKeSizXFmt1e4AwL1/oso5/Fs2fa8YaVhoPAbPSR5DEWtloDCoKp9MX7K89K7pXc23MbbpDeh7ybcm3KNWZUwPrDMJigdQxzDPP0Dp3Bh85ItiG+ETEUlqG34Eak0UhCBBFxrMCNyg+NQi8ykm7lQ586PnVEeQRaAFoCmhQ/u/PsTvkfxPDQlHw1+FzwufmlNof4S4d/KTtewyuF4zV76sgfoHnIe+sb1jeYvIgNhvFgs3LG0hlLvf1C3ULdUmaBIy+usi6r6vjR40d/2X0RbsHplMLwwvDd3rTK6cneQeFB4e4pjpt5NpR540DZU7iSXB7CKz+Uh+xzJ5/gkOShCdWEztc6iuSxR3NMcyz5Z7ggIo930Edvp5XoZhCgPwsxqm1sqM6ENPAO+U2gp7Pptw+j33o79h1IDSZtdir8P8KNzDwwfGhXK+EBLsJSjJCgClOFWBoHVcSg21i3qqFPHJ44YIdw/AJwGOFR9ujJoyelaEJ2DDg8DDvZP7V/alHG+gE/CRxSXML4Y/heuENTRrTuA9vWeFzoJy3MP7I3NyM3o2hrGelV/YoKnwqffc4wDkYnOwUvDF7oGecIvAssyAw5GnJ0xS9fXhM3apHwlKQ6iQESNKGdisevjNBEqKVdcipn/Z9ZPLPATgtwMGB/QFlF8/Pm52XYqV2sgRFoMu3Xab8OLmcq4FkXGBJiN2UnflH9e9ONphsoKUL1Fj4HA+JlbC2wWdNZNzZYfM9j/sC+p61iJuSVsk4cOVaWU5ZTvfMUXIMzsaXepd5Z5DdhfPKM4AXBCzzjpgM/HdzzAi8EXkh8BMi124HxW9LvBvpQ6b4Cw101U+L3IBBTEXq92776ZMdCHPoILqSDf9BkEbS6oWSDkRS2/P6H0J9WqCwd3OzY7Ih8uLhA8lzyouZbzbdKWwC7w53kqyF1IXUe1Q4FfH3eibKiM7zyTdGZzHoSE7uFvrW5YXODcYWsDzA1MC7SxsnGKXQYKTfM2D2v0Isv9KoOqo92jPLwC3HlQ1yTZ4Idr/wd0zJUcCOr5njZ8bKze6+JS04qDSoN2usO02Ga1iOEXh7JTsA7gWdWcCkfXJp8Fq7RzEd0A1RwOfNUYXFhcfWe83AeqrVFIUUhmQthHrisXBgZFhm2WOsKvCss3hNZzEcWrzxFXk/xFQbgUfQU/iRWfIEbhEjijhd6f1q95VHW8fbY22Nbgmi1KIFXpU2Pv2QWmoH2LvYurMNSNvBrfgkLOCzD1C048yp2wr7i+xz6A+7ir8gB52pwyESUUGH8aTYERoF10gzNDI23W5hdmF3KBBjB44ZtKniSdeN4zfGa09lX4SqcjSqbUzZn7wSw4EfKE32jwjSxmtjAtb4wE7yyg88En0m+Cb/yitYZxNhCo8ja5iJrm7eztu6ZMYRtj6H4Or4gtRTKoWD7AXpl5MJRKE7NjT8Yf3DJ9kDgA2HpuvgV8StSYyCMxlqjo4HMUIKFbBMuV2ZV/E9cCv/ZpyhP1auNz6r+F/Pyf03MPPXNWkm9kK/S3TWQMacZmjFRaMYUqrbeNfBSxSQUaIMSMFCCg1FQ6X7HgNbfZZhgTLVAqinYFHEICjGmqHQfBB5wQav4wf4utDGtoY2tkSpYairu0H1MRhcMMqvFtBzMZj+iluJ15Z+1+rvt1H86s6wgryCv4qezUAvlq3OjcqN2+ZHm+K8LigtZFRcSNGceP2dekEfSwqSF62eKMaNW9s3rfTfKTvDYFbtI3384+aeoJKiIeOV4xfHKgHzWC5g5DFhq68zbOodabWYdeaUeD7aFUXb043+bHf17asRTpLsuPoGPT6DciJAS3hoW40iy4gAMwQHMAq11zjiaNHeYWQtOV0vVOEb5XYsQrdrAFh1itvWsfx1T/zoQu0wXi+UStANeOf8qNPzQsKth1+mskkNk1H2kmsRFK93W8cpCt3XuG7yA9QXG54yoG1E3/WkA8lRSsO/3OHErjjuC/c9hNypNL99f5N9fRPkRcka4lHz9nI+sB5Uq5r6ebU5jfOLIIKcgJ6/IWUSt4Ze2Y0/+Z6FW6lG26LBmh2aH7zYvch4zE+b4zfFb6BI8IXhC3LD1TJLKeu2xOGHDK/udsLkZ+gaqoXJ7+YHyA8eO5p8k+UoG3VuEXQCV8Fv1zdc3X5dgj+/R5nuctwInumMfKuP+YJ1viGVgEZtKfGsNbEgo6z6ViiUznsYseXqHMOu/s7m8rqOvajuqD7dUXq28WltwE3LhyFdH1vGBhr9Jtd4rgqKjSY7o6KVrImEBhO2Pr4yv/PuVH8jqsCd5uueo0Q/WSjLNcRdgR3wu1FG0w57jT2CoopiJaUE6rG2wCiOF9xhpeC9V0PNAwQ/dhFGoMcOhuFVIw3S2DNOVH3CouZAtw8mAZkVPbjy5UfoBsA88SLqmOac5N/+YbVbD4VPHC0+Riy88lVkLlykC0LydeGniJWZ6hE0B3pAmw61q1ktF45+W03ijN92hUHUEzEzyDgwLDHPV2hIW+TqViibfLG+G+tUltDihJDrLhxh1TtKioMigSNdV1ErxUUsLu47BkhbcpuuH6UYtur4U2vU6wDpWWVZZNtg+8X7i3RKHZGRTAb8o/a35t+azqNiJo3mWLls3MHra4sDFgY5JQ4FJwLrE64HXg1jsDDiWR5X8Gxydgx3P3Tt371EJdoBXcD2xOqA6IMchYwBFh7LVON4Tuw1rHtbMVGViaNgJ+seO8Rzj6WzjO8B3QAK5T4r/FGRjgfoC1EjaUbyN24xEACfLRFXks1vOtpxtvHf6w+kPh0Rd6cvfIBJWx2EX7w/eH+zvDzk75CyTHha9scHpM2w02Ew59X4X3GDdYJ0vTjOOnyrfzEZHss4zrGdYDw5hXxA2TuIWeqO/YPl5cnFi/TzioPmCt/AK/Q2vBEudC2raZsoU/bOShVZqP/Pf2pK4rRTgBBoeCDN1E6jdWJkCJ2uplQkFgvswSPKRULcg1D/qhhHqfQ6xLicHnRx03fal90tv5GIpkqXA4mPmi4IXBTd+PtXAC6cN1RSlnWJH5d7uo5fTslhHGF06u3l281Ls2g67MQXT43Kx07n75+4/LkEp4HRoGZ/NpvP4jSwFR3igfOS9kfeY6hibRMROFuM6gHWjspA5AIsjfU/MStb1xiDhd237StrVon01ut66fq29MV1U+HTD7639hN/ZVkok+otBOOUNOFlsOdn8cwuZYhStVW2s10rKMV3wooflwngSuU9J/wf2D+zRJBxHUsxEMUZJ8/3m+6VoBNiP129l6W3pcrDVuoYGhgZ6J84i7vDaHV4cXpxyDu7witq/pvsXzL4ynILThTmtJngKDA26n4Wjui/YOTDYG7YxCzYNdA5sKwVAjDAiiX79V2e9Je3nMPpKXIlw7tPQosGms3TU6oE+tahVPhLnSRcSZcob8TqVMK3tIwW3gpP+T6myLr7VHAyJmE5J3Q1x4ffkhslt7w3W+vesiebEhH+Tl8D87pPM+kyZrk9bJm4V05QiCo+hbW9rP/3edjlxrhbD9PUUF7dQH08StUVnr/qG9TvAup6wOGFxfcpzj+ceH2Oxo6ggH7Kf1zyvuXa/GjkqB9CUQOWb5JtxQDx2W/zn4j9n3h99dvTZAYfJwqgMiB3tMdpjpvViJqGygpkCI3vcOk31kCx2bB52Of/4/ONHx0XPZgzNmrqJdRNzKIRjE3kHyoWtY5jp/EnzJ03UMGPxcGlCmWuza3MMdiOvwCvukhkcJd1J/8te736yV6odxV9k5JKwx7GXjS8bK8TNpq3v54fGIx6NeMS6H2eTyUipzdZWfxUNcEH+cPOlhCr/Kv/988AWbBLc/IP9g52TxpJp/guf1+34bDN6/d/jYwKVUPpdyQ881rOv0RqHsm/RR9p4rq6p7H3Z+ywxbO/7H1DN+AuqzqJp/T+hekRQjfkM1cO/oAqum1Q3KVeEyvq/QiUVoZpY5vrU9WnMJ0NVVBJUNQTVmr+gOvxPda7BAhmWG2pwP8B2dk/4Q/qw4NLJykuVl/Y1wRvCLQAlY26NucXMjzJiccMPImguKhpqj/zJ5ktJZZoyzb75YAeOCe5+Gj+NS/IkAi1di/76Rgw0u4lbWRhNk49blS9uCvNUMOaATbVztXPDgidhT8LepJBDGk/eqfDF9RfXK18DEeut1Reiz/DRZxZXO5c6l44pZtJ8KlPyfQt55R3fwvgyOAX1e09UFFQUXMh8AGISWaWpEoVwEKkeHibeDmwIbJj3i22RbdGY3ZbARlFaED7CYYSD/3DxZIv1usQk+IU136B5GYomS6jcX1JOP3t9YS64JwaIPmv2yvEwGOz2eZfzyhfe5XEX4AGvyBBTn6cEovB3sq1yqquEhWqmxu+oKviiRs3WyhR//EVFaEp23CQSlamQQmQ0rpp1fTvu7TjsGYg2gFNIQSvePXv37IRIvqN5fTCxka+cBQ8fxHz6jgCng74nfU/G34I3vD6EpcsVLz9bdyb9Vgm71Xp3/BqELNGmc8EgU7Mthg5q4wSpQrjyuaUYMKjwqdgyDbBQX4U5bVW4EeirdiJgiW1NLFvfxJYAy21rZMn6Rqni4ufOJeZYCXhZyMVLhlysAsNCXbwwTxfByoGdM+xj54R9VBVcWyOkip8+9xE2kIFsa5dvbdtIMBzBbQDCEWGNfiQ7AuxJqzN7onOWKrb85WnvmesbiBZ3y3Qb9Y1k123HKAfQ6NZD61dtN6SK1nGU4XuoZT7oaYY9hZGGkRRWP8Ke7I5KGIkeMmUDm0JPZfTdFPQ0jJQpDJ3aBdnTLsMHte46bgDDB7Vs1H8OliFYsTRxrAzWW8U8BCu1/JrBinnKlQ1oo9blUOgvtA90SrdMhSGAzkIwzjIEYzCwk7pocmBE8bXMC70k35ozL/0w9JIrDFfUxlfxjKRaiDGqVss4Fe5jZzAQmA+eET2CFn2YVTIRzij8AV3NnlFObEkyVD/DM2QY+fYNrg2uT2I+mfirY3eaeOWa7/1/iPoxmRzqT7K4mrV3SReENfKvUR721PGC4wXLPKYEa3BYM2v5rOULQ8J8wny03uDefhBTmllQkF2QXbH9NFyAqlW5S3OX7goCL34GGyYXD8i6xkx05Se6BlNVTh0OqODsvvLy3PLcK7ueAY89mEaWHBYdHZzIK6uDEwNS/cAHQrbHZMdkry6CSl5hp0VfNjZZ3xv9BGfyY90oy0/DOGE1rSgZu5ljHGSgiVRZeW3M2wCKrCkM+uPErXe33hVhL0BbfgdFTzMoS3B86/h2YDXrKfqLUSEzrSnyYGlyTFMzB5XgKS99frPiAzRC7fIS9xL3LJLWhI+hCEqeNCnEM8TTPdYB+oNjpeYl5XvjtbhQtwJ9JOKpVwiuNGoUcsjuppWx3k+HPR2GnX1xBNyFGz9dzr+c/0tlcU1xTVb9t5d5tlK2ySc5KHRJ6JLFK93ABtyyg2uCa5KeAJrwxcS/fFZz6dnSs7XZjVAHJ7THQo+FZi361pXHlbI0VAS/m3pr6q0BRWKMNBJYZ9/xQ8cPDRJXNIVXOP4nTJ8kS2NxGKesbBQqqMv0Ytbv7uC7g39fJKLUBd6U3XjCK1dlMGOCUKoUFYmlGU7KZ9wbfYzJxbRv4CJ7S97eMoxiR2ZDe5esAjTNelV6vvR8bW4jvIPrmvIJvCFEHjDOKWgokfP8nODzweeTHgN2IJh6EkxYis6YSVDpCnGD0QPhHyTIxEqmej389XA09UUreAZNmdcLrxeeqy69yLMeaCqdOXZMIPkWW5h90Odnn59jrm14yut83soAHUPwC5uXNi+ZrJINASuYnODo7+jv4RI8KXhS8ghgHI9b3ql+fHDwYkllSeUv+y5TqnEq+Wjw0eC9bulT+ZVkOluykvW9KIfORn8JRmCaUbm+lwqntPXCNPo+Dl1Y3GsZdqqpRb5vAeRuOrSR34qeUr+MwK0awhysolzmuMyJsqI6P5RNkStmGuzRG6PQV7cU/bRas/u4UVhKyMdirLLpfjvyzsdYv3uW9yz/WCwibwIviq/eFa+EJiXO8w/yD5qXNFXMNUaXOT7lmZxZSosX1mhuR92OurOKqGo4YOeSJ/ef3C8ja8UBvLJRn89i5ZRsSpVvZjweXkoRIOsBAxbbDuFth4Sx3sBsedwo7lXXvS/L6svq6/PuwVu4HlIxhTfEyf0nOwUPI3Bd84LOB51PekT5Pq8YlfWX5kiwC6nOKPHYsos5pul2yKqab5S+gXqoXJ0Xkxfzkw848q1u9MRHvgl3MRMiydVAGYdlgO1oXmggm1K0LqLhLmtxGv5oRs4pm20nW32Ppmqp16djg4T9Cfnr2o8Ntu+nV/uxQVFqbsKBhANLM4KAD4KlqQnxfEL8+hiIIMe4U63PV9EGXWZpFJyHGGajv1o65PMEMppgG03wwpGlqJi3vGR96Vfl8BGaDp+uOV1ziBZoxKuNdzKy9AD51+NDgiivjobl38Zv5Uko4unJn256Sagj/3+hoj4JlSoKpWCT2hcpLG93wASXKcGFH2XIoRHeNIRhPhg8dJ0ES8FH9GQ/s2cOI0HfkaURo4sAkblRTwuxpwX1bLc+iterPu2E9hPTibwtvrurlU0i16XpDshKGhuOvRHPEC7O/ZYp+VZ/TJNv1q2S7qjaf7QgpyCnYudpaIATq3Oic6J3LgZnvtWb+vlRRKha9sbjkselsUfEqHkgsA7etsxoIRoNPc0GA/HIwCCHccTCG1DKVpKUo/8lymedUN75pBQ/yqqe3ih7S9ZVtTonKidq5yJxGg96EiRPwx+ZHFUsqf3gyM9mOK8s34Cm7SPO+XfizMSNRJyFZB925Uz9fPDzwahYjKPgN3i673bF7YpzF0seljzc8wr+5DeflW7A0YvRdMzLMS9Zx0pmCUNhQpJDgEOA+5zPxt//L4La97KyvpKUXrx2qY+unFs5d/8E0b5Y18RRAXMD5s6LngL8FJibG1AfUJ/4RFQPhZ2hX7JgQcIt+yf05GQShWTcqHyF3QwTSPuEf8iu2b0KEwPs7tBy4vZvt387Kp7k2/A7ycVMj0B1u4s5IRJyVxiumTGBV976G3ZgicSurzCtdZ9KSJSX3r9e8g7uwfno0nml87ImEmkBUyaNCnINcp0fbQ/8EJh+POghr5j1l0iEl/YToQeTVDEYo2xqFCpFWhEJ3fKu5R+LUCVevj8vunaLN6STOigb1dJGFiNfayFyxKORx8UTgZ7EEfZDefuh7Rxh9xmu7ntflZ0vO38+9w68gqthlba8Yb3cf8qMkBFgD/Nzg+qD6pOa2zEyfE9ZtIDrPuNDAUy7QqbIih/dEhPdfDiyKW8j/w2mSBN/iE1fAgNhqr/7KF5Z9BV2YWvEQMZJi3N0m3GO2S1cz/zxb4IS/658cQtfqmDO7vnFXsVevwQ1RDdEN65+KvrxDzlNtU21x+5RglCztnpFCb+iJLRgweEFhx32j8wamTU3KyaLYvWYrNWHyVRLdh3JP5B/oCzjFJyFijUFMQUxP4WBf3uM0hL6wOaCzYWBeaLr7AJDYmzn2c4LsyMPwozqJmEX99NxDUkPVvEPVp3TFiYWJv4UBRoIWxUVlRCV4Js6F2bDwp2huUREoblJ5ZvOEhaVWgzQhaOLBIkKjb4XfYizQSdjIS8G4fy+J+GX70/v5NFdvnxD7KZYCIblP6zOXJ35ZS6U8MJ79CI340XkmcZ2MWe5wuqz775MyHaifbYidMuxk2BK0prnDq11rnV+ulS8JuoBLcevPeSVKVv740oAkQ8BWjOlyvKQSTbBlN3xTObZgH366dxEHmbL2ylKsld/WSUo2i5jJAidqBMF5Ctbd7I1up2Ul5d9anOE2mA1tfEHTNGtxjWtq8VqFTX/GzDH1lSWpEtlc4HFt2rZdJ2WdjPgU89cc9wHGC3IMMYgwyxgr4QKfCjksH3AQpjAAlFgWYAPDDnUZx1xd5BaOkgryRCF6tZ2fomVdOXChIiYpJgk/1Q34AO+BeYuLU0t/qoAxGtX418v4RxecFIbP2AZwOJa49lKXbw4PZBxuOAiyX1zfQdcaLghE37WxQNatT6h2H6RUAiGitZoqcJQIhxEZwluoUDtjHBQhaoLjmx4P7ZUns5SsTMbjqmz+SrsL2XyovktaWTPuJQMeoTHn0xeh/K6Gsodh/MYI/8ObWpbUF7E+6GFlJlEjV0wf9r8aTHDv6ZQgC2RsxFzHZmqr6I1+NPZiBPaGKGTeBtso5adZDayf0oSiilGh1isqor1l2KX/Gdnam/X3j78G3EXj4vlOPziLVT1RWc5U825hcP7oT+J03XZe/fb7rfHnGZd8nk/ZiFFk/Dagd8ye56FUrA2ps4Cu3iyLp5u/cX/H2Bh8k3Mfv5AZhLOK9Bc6IFB+8TbBxNcoFuH7uLln50KF8jgTEb5wYKDBQU/lcMBOPDV3vV71xfFnQw4GVAZfTzleEr5l9XAv4LGovqb9Tfz3ohxKnOXgdda/9iI2IjIlEBYAfFbk35M+jEy26/MrywgL2hP0B6/H3yBHwq2kW5Obk7LRon/2qFQG3/TXW18RaXdo7+8B//cUwsyg/0/5NC5IwZ2RJ9tnTtjGun+Pzp3UXNWSq6DRNLZoUDoAdiHOYG003+5l8lov5fJa7+XyWu/l8n4dC+T2n4fJF42dPq/PLzfuwB4nGNgZGBi4GNgYJAAYgUgmxEI44GYBchnAmJGMMkDxAJANojPAAAadADVAHicY2BkYGDgYmhjWMDA4uLmE8IglVxZlMOgkV6Ums1glpNYksfgwsACVMPw/z8DE5BixMvTY2B3jHJVYNBzDgoBkm5BjkDS198HSPo5hgHJIH9fIBkS5A0kkfQxJSfnFjDwpRUlJjOIgEUYwCRQhoGNQQKIGYBYisGIwYshgaGMoQcswsgwgYEZTPMBsQhUhxdYN6a4N5q4ENQeaokyAt0JEgcBJiBLEOhesBwAlTAg4wAAAHicpVfrT1xFFP/dZSmw7MKyVrSIL6zYilYsAVo0jUGkmDQVRQrFplqxagqpiEbTpGn8oA3xo/+AJNpgYqQmpTE+SGmCjxZF2liF2IrQAgssIG35Zvb4m7l7dy+wy+7G2ZyzM+fMecyZM+fOwADgwj68A2dV9a7nkdd8pL0Vm15rP9iCstYDbx9GFZycAxE4+GckMXI0t73VhqyWg+2HsV5ToDE5WIcsPTbg07MdKHZUcORCKjaihmMne6nkpPFnIAd5pBXgMbhhGIPaUj4qObMGu+n/y2jDMXTgPIbwOy5jHv8aLiPf2GLUGnuMl4wPjU6j2+gxviH0U1+pKNyITKSgnN5tQyEqkEuaV9JJu0dOol4W0CijHLlkEjvkJvaT4sBOmSd9Bl54gvPIJhTIEyiSYpRSU6X8hSqZxVOEakINoZbwHKGOevZQskH8aCLQAzmr8c/E9YyJk56NolyuYZsEUCFXaL1UBkmZ42iII4Oe18kZylzgbBct7mB06mQc+3GLpmST4iZllpQspCONPDUvU34lx0f/Z8gd5vpmtIyyP8F1FXFdZQQXrXgp5w1p93E9fq7Hz/X4uR4/1+LXkqnkBMgJkBMgJ0BOgNI7KVePrYxvDrXX0r5Bmoc2PPI+sgnKWoDWAuTkE1JoL4MWC7j7hXgAD+FhPEoNJYxpOXengjv/OHXsQh01N1BzE3fd4T6qMiHTndlPqfthbz6rI1cZTavlYHnLsdPkGuOwqjGOVu9zucR9MPszhGnbrDE5Tryk6Ks1yJDclCXdX5JBWZAOOaRZbk1bJHQQRqRfftT+0Hs5pXnnmA/q/0oUvYu2/j/h3mcRj+305Jt8mcCcORPzZJjjSaL1MebG9MWK6jLa4moaqQvxfVolsxRNK/PCHr/rCWm6EZWagKwpaVqMvjLdsm0Se+WPODqX5Zp91xNrMiljxBNmHssUa0LisvsIn4RHZxjNYeIROSRnZUAC0sk89vHE/CDj3HdPaN60ym4VC9mg91Ll+eshXmf06K7hwwyrldkLROF28Tx3STG96pBG+Vq6SfSyvp+UHp6zyHk5paIuizIQDMoxZqJXvguSK0cJm1bvVbTdjtintb4Y3g5bJ+D/nMmwtll10ojnVGwZb6tyeZLWNClTWpPOH2bBWBwBq2ZmcfYrhAtrar+arD9aSsczmXyMqcmsT5c1Hoftu7CseW0SdTE03bCw7NYVJXRW5b3Q/y+WndD4jWCrdK3QUZOE50vx53BWn8bX+TUmlg/ELyXBaTUK8XlCgn+rsypfSW+YunWZDtYZ+V5n0Qn1JeJ9w8791Nb/MwGPAhGcaIu+02Ym8ss6x+/uqMpSmFk3EFPPm+Fef1ybE3Iu7hx/uBeqTfKbzoCLrC2niUesXZKemDo2h3vNa1hKunqvoet0VOqRWDbWPqPysXyxgtK3MnLyk8ZTya4jmEB1kHrpJbzK2lwiL3J8AOarANIixyPVhzeqVP3/UbBMsvUcBO/i2J2MR+GWRB2NdiexfRF65NsYcpcIvTIt3epkygm+Oczm09/Fi1FlzgfftfTJdkTuoOoOvRcbwhMjvXtDEL85eBdX74HUMMXFF9LtIf25IVoWqXfiDvroXnGfXseY38b/dD1yhulO/lLUfuDWECUD6paobvym35EbY6SXh7sJibR12ndrDardZ1uTCV6uRPmdS5/dkfqoWxrMd6n5Io20FP6U54ZeNRiXDL2GDNZ+g68U9WrxsF9Aexv5/ijEZjyIIv162YJHUMw3TCnK9Atmu37DVOJJvqir8TRfrc+gFs/yPdPA9Tfhhf8AO0d8HwAAAAABAAAAANoy8IQAAAAAxPARLgAAAADjIwcreJwdzs0rxFEUxvHv79xzjcwskGyGNAs11IgiLyklUiyYIUkp5SUvKzSJTKGJRKR+CwsLZcOGlX/A0grJxkYie8USh8Wnp3vvc++5CgTfINUcyBFT+sK47jHpn5nwlQwHo2TkhnW5J+l2iGuWruCaCjmhR9rZdrWI9WfNmUmbftNoNkzWdJsZMyZVbAbv1GkJHbrKoday7l5pjyRt3iClPkboW5n2bYS6ZaZsvcicvySUTk51gZSP2v4QYSSwswuzZf3K/xzXbzt7oFefrNdMzqcojRRR74up0WcieseANJB3I5RZxtw8Te4YJyEN9uaobrCm9fb/vOljUB5J6Q4Zm7siUXIS/FxpyjLKXsGXdZdY0X3r/t3bpV9uLRP0yTmFusiy+6Tcf5DQAqrcGzHLjFzSIsKFZdynyf4CCpdPRgA=",Ma=v.memo(({isPerf:t,color:e,colorBlind:n,customData:r,isMemory:i,isShadersInfo:s,metric:o,fontSize:a,offsetY:l=0,offsetX:c,round:u,hasInstance:f})=>{const{width:d,height:h}=At(g=>g.viewport),p=v.useRef(null),m=v.useRef(null);return mTe("log",function([g,y]){var x;if(!g||!p.current||(r&&(p.current.text=(Math.round(Wa().customData*Math.pow(10,u))/Math.pow(10,u)).toFixed(u)),!o))return;let _=g[o];if(s?_=(x=y.info.programs)==null?void 0:x.length:o==="matriceCount"?_=da.value:!t&&y.info.render&&(_=(i?y.info.memory:y.info.render)[o]),o==="fps"&&(p.current.color=Wa().overclockingFps?ro(n).overClock.toString():`rgb(${ro(n).fps.toString()})`),p.current.text=(Math.round(_*Math.pow(10,u))/Math.pow(10,u)).toFixed(u),f){const w=y.info.instance;if(typeof w>"u"&&o!=="matriceCount")return;let T;o==="matriceCount"?T=Kp.value:T=w[o],T>0?(p.current.fontSize=a/1.15,m.current.fontSize=_>0?a/1.4:a,p.current.position.y=h/2-l-a/1.9,m.current.text=" 	"+(Math.round(T*Math.pow(10,u))/Math.pow(10,u)).toFixed(u)):(m.current.text&&(m.current.text=""),p.current.position.y=h/2-l-a,p.current.fontSize=a)}da.value-=1,p.current.updateMatrix(),p.current.matrixWorld.copy(p.current.matrix)}),H.jsxs(v.Suspense,{fallback:null,children:[H.jsxs(Mk,{textAlign:"justify",matrixAutoUpdate:!1,ref:p,font:FO,fontSize:a,position:[-d/2+c+a,h/2-l-a,0],color:e,characters:"0123456789",onUpdate:g=>{g.updateMatrix(),da.value-=1,g.matrixWorld.copy(g.matrix)},children:[H.jsx("meshBasicMaterial",{blending:ec}),"0"]}),f&&H.jsx(Mk,{textAlign:"justify",matrixAutoUpdate:!1,ref:m,font:FO,fontSize:8,position:[-d/2+c+a,h/2-l-a*1.15,0],color:"lightgrey",characters:"0123456789",onUpdate:g=>{g.updateMatrix(),da.value-=1,g.matrixWorld.copy(g.matrix)},children:H.jsx("meshBasicMaterial",{blending:ec})})]})}),WAe=({colorBlind:t,customData:e,minimal:n,matrixUpdate:r})=>H.jsxs(H.Fragment,{children:[H.jsx(Ma,{colorBlind:t,color:`rgb(${ro(t).fps.toString()})`,isPerf:!0,metric:"fps",fontSize:14,offsetX:140,round:0}),H.jsx(Ma,{color:`rgb(${ro(t).cpu.toString()})`,isPerf:!0,metric:"cpu",fontSize:14,offsetX:72,round:3}),H.jsx(Ma,{color:`rgb(${ro(t).gpu.toString()})`,isPerf:!0,metric:"gpu",fontSize:14,offsetX:10,round:3}),n?null:H.jsxs(H.Fragment,{children:[H.jsx(Ma,{metric:"calls",fontSize:14,offsetX:200,round:0,hasInstance:!0}),H.jsx(Ma,{metric:"triangles",fontSize:14,offsetX:260,round:0,hasInstance:!0}),H.jsx(Ma,{isMemory:!0,metric:"geometries",fontSize:14,offsetY:30,offsetX:0,round:0}),H.jsx(Ma,{isMemory:!0,metric:"textures",fontSize:14,offsetY:30,offsetX:80,round:0}),H.jsx(Ma,{isShadersInfo:!0,metric:"programs",fontSize:14,offsetY:30,offsetX:140,round:0}),H.jsx(Ma,{metric:"lines",fontSize:14,offsetY:30,offsetX:200,round:0,hasInstance:!0}),H.jsx(Ma,{metric:"points",fontSize:14,offsetY:30,offsetX:260,round:0,hasInstance:!0}),r&&H.jsx(Ma,{isPerf:!0,metric:"matriceCount",fontSize:14,offsetY:30,offsetX:320,round:0,hasInstance:!0})]}),e&&H.jsx(Ma,{color:`rgb(${ro(t).custom.toString()})`,customData:e,fontSize:14,offsetY:0,offsetX:n?200:320,round:e.round||2})]}),$Ae=({colorBlind:t,minimal:e,chart:n={length:120,hz:60}})=>{const r=v.useMemo(()=>({fps:new Float32Array(n.length*3),cpu:new Float32Array(n.length*3),gpu:new Float32Array(n.length*3)}),[n]),i=v.useRef(null),s=v.useRef(null),o=v.useRef(null),a=v.useRef(null),l=v.useMemo(()=>new $(0,0,0),[]),c=(u,f=1,d,h)=>{let p=0;const{width:m,height:g}=h,y=Wa().chart.data[u];if(!y||y.length===0)return;const x=e?2:6,_=e?12:50;let w=y.length;for(let T=0;T<w;T++){let S=(Wa().chart.circularId+T+1)%w;y[S]!==void 0&&(y[S]>p&&(p=y[S]*f),l.set(x+T/(w-1)*(m-x*2)-m/2,Math.min(100,y[S])*f/100*(g-x*2-_)-g/2,0),l.toArray(d.attributes.position.array,T*3))}d.attributes.position.needsUpdate=!0};return Yt(function({viewport:u}){c("fps",1,i.current,u),s.current&&s.current.color.set(Wa().overclockingFps?ro(t).overClock.toString():`rgb(${ro(t).fps.toString()})`),c("gpu",5,o.current,u),c("cpu",5,a.current,u)}),H.jsxs(H.Fragment,{children:[H.jsxs("line",{onUpdate:u=>{u.updateMatrix(),da.value-=1,u.matrixWorld.copy(u.matrix)},children:[H.jsx("bufferGeometry",{ref:i,children:H.jsx("bufferAttribute",{attach:"attributes-position",count:n.length,array:r.fps,itemSize:3,usage:Ji,needsUpdate:!0})}),H.jsx("lineBasicMaterial",{ref:s,color:`rgb(${ro(t).fps.toString()})`,transparent:!0,opacity:.5})]}),H.jsxs("line",{onUpdate:u=>{u.updateMatrix(),da.value-=1,u.matrixWorld.copy(u.matrix)},children:[H.jsx("bufferGeometry",{ref:o,children:H.jsx("bufferAttribute",{attach:"attributes-position",count:n.length,array:r.gpu,itemSize:3,usage:Ji,needsUpdate:!0})}),H.jsx("lineBasicMaterial",{color:`rgb(${ro(t).gpu.toString()})`,transparent:!0,opacity:.5})]}),H.jsxs("line",{onUpdate:u=>{u.updateMatrix(),da.value-=1,u.matrixWorld.copy(u.matrix)},children:[H.jsx("bufferGeometry",{ref:a,children:H.jsx("bufferAttribute",{attach:"attributes-position",count:n.length,array:r.cpu,itemSize:3,usage:Ji,needsUpdate:!0})}),H.jsx("lineBasicMaterial",{color:`rgb(${ro(t).cpu.toString()})`,transparent:!0,opacity:.5})]})]})},XAe=({colorBlind:t,chart:e,customData:n,matrixUpdate:r,showGraph:i=!0,antialias:s=!0,minimal:o})=>{const a=v.useRef(void 0),l=Ja(c=>c.paused);return H.jsxs(JTe,{style:{display:"flex",position:"absolute",height:`${o?37:i?100:60}px`,minWidth:`${o?"100px":n?"370px":"310px"}`},children:[H.jsx(nC,{ref:a,orthographic:!0,camera:{rotation:[0,0,0]},dpr:s?[1,2]:1,gl:{antialias:!0,alpha:!0,stencil:!1,depth:!1},onCreated:({scene:c})=>{c.traverse(u=>{u.matrixWorldAutoUpdate=!1,u.matrixAutoUpdate=!1})},flat:!0,style:{marginBottom:"-42px",position:"relative",pointerEvents:"none",background:"transparent !important",height:`${o?37:i?100:60}px`},children:l?null:H.jsxs(H.Fragment,{children:[H.jsx(qAe,{}),H.jsx(WAe,{customData:n,minimal:o,matrixUpdate:r}),i&&H.jsx($Ae,{colorBlind:t,minimal:o,chart:e})]})}),l&&H.jsxs(eAe,{children:[H.jsx(NAe,{})," PAUSED"]})]})},qAe=()=>(Yt(function({gl:t,scene:e,camera:n}){n.updateMatrix(),da.value-=1,n.matrixWorld.copy(n.matrix),n.matrixWorldInverse.copy(n.matrixWorld).invert(),t.render(e,n),Kp.value=0,da.value=0},1/0),null),YAe=v.forwardRef(({portal:t,className:e,children:n,name:r,...i},s)=>{const o=At(u=>u.gl),a=v.useRef(null),l=v.useRef(null),c=(t==null?void 0:t.current)!=null?t.current:o.domElement.parentNode;return v.useLayoutEffect(()=>{if(!a.current||!c)return;const u=document.createElement("div"),f=l.current=n6(u);return c.appendChild(u),()=>{f.unmount(),l.current=null,c.removeChild(u)}},[c]),v.useLayoutEffect(()=>{const u=l.current;u&&u.render(H.jsx("div",{ref:s,className:e,children:n}))}),H.jsx("group",{name:r,...i,ref:a})});function KAe(t){let e=0;for(let r in t.attributes){const i=t.getAttribute(r);e+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}const n=t.getIndex();return e+=n?n.count*n.itemSize*n.array.BYTES_PER_ELEMENT:0,e}const UO=(t,e)=>{const n=i=>{switch(i){case 1e3:return"RepeatWrapping";case 1001:return"ClampToEdgeWrapping";case 1002:return"MirroredRepeatWrapping";default:return"ClampToEdgeWrapping"}},r=i=>{switch(i){case 3e3:return"LinearEncoding";case 3001:return"sRGBEncoding";case 3002:return"RGBEEncoding";case 3003:return"LogLuvEncoding";case 3004:return"RGBM7Encoding";case 3005:return"RGBM16Encoding";case 3006:return"RGBDEncoding";case 3007:return"GammaEncoding";default:return"ClampToEdgeWrapping"}};return{name:t,url:e.image.currentSrc,encoding:r(e.encoding),wrapT:n(e.wrapT),flipY:e.flipY.toString()}},ZAe=({program:t,material:e,setTexNumber:n})=>{const r=Ja(o=>o.gl),[i,s]=v.useState(null);return v.useEffect(()=>{if(r){const o=t==null?void 0:t.getUniforms();let a=0;const l=new Map;o.seq.forEach(c=>{if(!c.id.includes("uTroika")&&c.id!=="isOrthographic"&&c.id!=="uvTransform"&&c.id!=="lightProbe"&&c.id!=="projectionMatrix"&&c.id!=="viewMatrix"&&c.id!=="normalMatrix"&&c.id!=="modelMatrix"&&c.id!=="modelViewMatrix"){let u=[],f={name:c.id};c.cache&&(c.cache.forEach(d=>{typeof d<"u"&&u.push(d.toString().substring(0,4))}),f.value=u.join(),e[c.id]&&e[c.id].image&&e[c.id].image&&(a++,f.value=UO(c.id,e[c.id])),f.value||(f.value="empty"),l.set(c.id,f))}}),e.uniforms&&Object.keys(e.uniforms).forEach(c=>{const u=e.uniforms[c];if(u.value){const{value:f}=u;let d={name:c};if(c.includes("uTroika"))return;if(f.isTexture)a++,d.value=UO(c,f);else{let h=JSON.stringify(f);try{h=JSON.stringify(f)}catch{h=f.toString()}d.value=h}l.set(c,d)}}),a>0&&n(a),s(l)}},[]),H.jsx(LX,{children:i&&Array.from(i.values()).map(o=>H.jsx("span",{children:typeof o.value=="string"?H.jsx("li",{children:H.jsxs("span",{children:[o.name," :"," ",H.jsxs("b",{children:[o.value.substring(0,30),o.value.length>30?"...":""]})]})}):H.jsxs(H.Fragment,{children:[H.jsx("li",{children:H.jsxs("b",{children:[o.value.name,":"]})}),H.jsxs("div",{children:[Object.keys(o.value).map(a=>a!=="name"?H.jsx("div",{children:a==="url"?H.jsx("a",{href:o.value[a],target:"_blank",children:H.jsx("img",{src:o.value[a]})}):H.jsxs("li",{children:[a,": ",H.jsx("b",{children:o.value[a]})]})},a):null),H.jsxs(DX,{onClick:()=>{var a;console.info(e[o.value.name]||((a=e==null?void 0:e.uniforms[o.value.name])==null?void 0:a.value))},children:["console.info(",o.value.name,");"]})]})]})},o.name))})},QAe=({el:t})=>{Ja(r=>r.log);const e=Ja(r=>r.gl),n=r=>{if(!e)return 0;const i=Math.round(r.drawCounts.total/(e.info.render.triangles+e.info.render.lines+e.info.render.points)*100*10)/10;return isFinite(i)&&i||0};return H.jsx(H.Fragment,{children:t.drawCounts.total>0&&H.jsxs(no,{style:{height:"auto",width:"auto",margin:"0 4px"},children:[t.drawCounts.type==="Triangle"?H.jsx(UX,{style:{top:"-1px"}}):H.jsx(NX,{style:{top:"-1px"}}),t.drawCounts.total,H.jsxs("small",{children:[t.drawCounts.type,"s"]}),e&&H.jsxs(Go,{style:{bottom:"-10px",width:"40px",fontWeight:"bold"},children:[t.visible&&!t.material.wireframe?n(t):0,"%"]})]})})},JAe=({el:t})=>{const[e,n]=v.useState(t.visible),[r,i]=v.useState(t.expand),[s,o]=v.useState(0),{meshes:a,program:l,material:c}=t;return H.jsxs(nAe,{children:[H.jsxs(QTe,{onClick:()=>{t.expand=!r,Object.keys(a).forEach(u=>{const f=a[u];f.material.wireframe=!1}),i(!r)},children:[H.jsx(M8,{style:{marginRight:"6px"},children:r?H.jsx("span",{children:H.jsx(OX,{})}):H.jsx("span",{children:H.jsx(FX,{})})}),l&&H.jsxs("span",{children:[H.jsx(rAe,{children:l.name}),H.jsxs(no,{style:{height:"auto",width:"auto",margin:"0 4px"},children:[H.jsx(MAe,{style:{top:"-1px"}}),Object.keys(a).length,H.jsx("small",{children:Object.keys(a).length>1?"users":"user"})]}),s>0&&H.jsxs(no,{style:{height:"auto",width:"auto",margin:"0 4px"},children:[s>1?H.jsx(fM,{style:{top:"-1px"}}):H.jsx(fM,{style:{top:"-1px"}}),s,H.jsx("small",{children:"tex"})]}),H.jsx(QAe,{el:t}),c.glslVersion==="300 es"&&H.jsxs(no,{style:{height:"auto",width:"auto",margin:"0 4px"},children:[H.jsx(FAe,{style:{top:"-1px"}}),"300",H.jsx("small",{children:"es"}),H.jsx(Go,{style:{bottom:"-10px",width:"40px"},children:"glsl"})]})]}),H.jsx(tAe,{onPointerEnter:()=>{Object.keys(a).forEach(u=>{const f=a[u];f.material.wireframe=!0})},onPointerLeave:()=>{Object.keys(a).forEach(u=>{const f=a[u];f.material.wireframe=!1})},onClick:u=>{u.stopPropagation(),Object.keys(a).forEach(f=>{const d=a[f],h=!e;d.visible=h,t.visible=h,n(h)})},children:e?H.jsx(EAe,{}):H.jsx(_Ae,{})})]}),H.jsxs("div",{style:{maxHeight:r?"9999px":0,overflow:"hidden"},children:[H.jsxs(OO,{children:[H.jsx(dAe,{})," Uniforms:"]}),H.jsx(ZAe,{program:l,material:c,setTexNumber:o}),H.jsxs(OO,{children:[H.jsx(pAe,{})," Geometries:"]}),H.jsx(LX,{children:a&&Object.keys(a).map(u=>a[u]&&a[u].geometry&&H.jsxs(aAe,{children:[H.jsxs("span",{children:[a[u].geometry.type,": "]}),a[u].userData&&a[u].userData.drawCount&&H.jsxs("b",{children:[H.jsxs("div",{children:[a[u].userData.drawCount.count,H.jsxs("small",{children:[" ",a[u].userData.drawCount.type,"s"]})]}),H.jsx("br",{}),H.jsxs("div",{children:[Math.round(KAe(a[u].geometry)/1024*1e3)/1e3,"Kb",H.jsx("small",{children:" memory used"})]})]})]},u))}),H.jsxs(DX,{onClick:()=>{console.info(c)},children:["console.info(",c.type,")"]})]})]})},e5e=()=>{Ja(e=>e.triggerProgramsUpdate);const t=Ja(e=>e.programs);return H.jsx(sAe,{children:t&&Array.from(t.values()).map(e=>e&&e?H.jsx(JAe,{el:e},e.material.uuid):null)})},ro=t=>({overClock:"#ff6eff",fps:t?"100, 143, 255":"238,38,110",cpu:t?"254, 254, 98":"66,226,46",gpu:t?"254,254,254":"253,151,31",custom:t?"86,180,233":"40,255,255"}),t5e=({showGraph:t,colorBlind:e})=>{const n=Ja(i=>i.overclockingFps),r=Ja(i=>i.fpsLimit);return H.jsxs(Go,{style:t?{color:n?ro(e).overClock.toString():`rgb(${ro(e).fps})`}:{},children:["FPS ",n?`${r}`:""]})},n5e=({showGraph:t,colorBlind:e,customData:n,minimal:r})=>{const i=Ja(s=>s.gl);return i?H.jsxs(ZTe,{children:[H.jsxs(no,{children:[H.jsx(RAe,{}),H.jsx(Go,{style:t?{color:`rgb(${ro(e).gpu.toString()})`}:{},children:"GPU"}),H.jsx(ZT,{children:"ms"})]}),H.jsxs(no,{children:[H.jsx(BAe,{}),H.jsx(Go,{style:t?{color:`rgb(${ro(e).cpu.toString()})`}:{},children:"CPU"}),H.jsx(ZT,{children:"ms"})]}),H.jsxs(no,{children:[H.jsx(TAe,{}),H.jsx(t5e,{showGraph:t,colorBlind:e})]}),!r&&i&&H.jsxs(no,{children:[H.jsx(HAe,{}),H.jsx(Go,{children:i.info.render.calls===1?"call":"calls"})]}),!r&&i&&H.jsxs(no,{children:[H.jsx(UX,{}),H.jsx(Go,{children:"Triangles"})]}),n&&H.jsxs(no,{children:[H.jsx(uAe,{}),H.jsx(Go,{style:t?{color:`rgb(${ro(e).custom})`}:{},children:n.name}),n.info&&H.jsx(ZT,{children:n.info})]})]}):null},r5e=({showGraph:t,colorBlind:e,deepAnalyze:n,customData:r,matrixUpdate:i,openByDefault:s,minimal:o})=>H.jsxs(H.Fragment,{children:[H.jsx(n5e,{showGraph:t,colorBlind:e,customData:r,minimal:o}),!o&&H.jsx(s5e,{matrixUpdate:i,openByDefault:s,deepAnalyze:n,showGraph:t})]}),i5e=({matrixUpdate:t})=>H.jsxs("div",{children:[H.jsxs(no,{children:[H.jsx(PAe,{}),H.jsx(Go,{children:"Geometries"})]}),H.jsxs(no,{children:[H.jsx(fM,{}),H.jsx(Go,{children:"Textures"})]}),H.jsxs(no,{children:[H.jsx(NX,{}),H.jsx(Go,{children:"shaders"})]}),H.jsxs(no,{children:[H.jsx(LAe,{}),H.jsx(Go,{children:"Lines"})]}),H.jsxs(no,{children:[H.jsx(gAe,{}),H.jsx(Go,{children:"Points"})]}),t&&H.jsxs(no,{children:[H.jsx(vAe,{}),H.jsx(Go,{children:"Matrices"})]})]}),BO=({tab:t,title:e,set:n})=>{const r=Ja(i=>i.tab);return H.jsx(M8,{className:`${r===t?" __perf_toggle_tab_active":""}`,onClick:()=>{n(!0),la({tab:t})},children:H.jsx("span",{children:e})})},s5e=({openByDefault:t,showGraph:e,deepAnalyze:n,matrixUpdate:r})=>{const[i,s]=Ge.useState(t);return H.jsxs("span",{children:[H.jsx(o5e,{show:i,showGraph:e,matrixUpdate:r}),t&&!n?null:H.jsxs(oAe,{className:"__perf_toggle",children:[n&&H.jsx(BO,{tab:"programs",title:"Programs",set:s}),n&&H.jsx(BO,{tab:"infos",title:"Infos",set:s}),H.jsx(M8,{onClick:()=>{s(!i)},children:i?H.jsxs("span",{children:[H.jsx(OX,{})," Minimize"]}):H.jsxs("span",{children:[H.jsx(FX,{})," More"]})})]})]})},o5e=({show:t,showGraph:e,matrixUpdate:n})=>{const r=Ja(i=>i.tab);return H.jsxs(H.Fragment,{children:[H.jsx(i5e,{matrixUpdate:n}),t&&H.jsx("div",{children:H.jsx(iAe,{style:{marginTop:e?"38px":0},children:r==="programs"&&H.jsx(e5e,{})})})]})},a5e=({showGraph:t=!0,colorBlind:e=!1,openByDefault:n=!0,className:r,overClock:i=!1,style:s,position:o="top-right",chart:a,logsPerSecond:l,deepAnalyze:c=!1,antialias:u=!0,customData:f,matrixUpdate:d,minimal:h})=>{const p=v.useRef(null);return H.jsxs(H.Fragment,{children:[H.jsx(_Te,{logsPerSecond:l,chart:a,overClock:i,deepAnalyze:c,matrixUpdate:d}),H.jsx(YAe,{name:"r3f-perf",children:H.jsxs(KTe,{className:(r?" ".concat(r):" ")+` ${o||""} ${h?"minimal":""}`,style:{minHeight:h?"37px":t?"100px":"60px",...s},ref:p,children:[H.jsx(XAe,{perfContainerRef:p,colorBlind:e,chart:a,showGraph:t,antialias:u,customData:f,minimal:h,matrixUpdate:d}),H.jsx(r5e,{colorBlind:e,showGraph:t,deepAnalyze:c,openByDefault:n,customData:f,matrixUpdate:d,minimal:h})]})})]})},BX="%[a-f0-9]{2}",zO=new RegExp("("+BX+")|([^%]+?)","gi"),HO=new RegExp("("+BX+")+","gi");function dM(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;const n=t.slice(0,e),r=t.slice(e);return Array.prototype.concat.call([],dM(n),dM(r))}function l5e(t){try{return decodeURIComponent(t)}catch{let e=t.match(zO)||[];for(let n=1;n<e.length;n++)t=dM(e,n).join(""),e=t.match(zO)||[];return t}}function c5e(t){const e={"%FE%FF":"","%FF%FE":""};let n=HO.exec(t);for(;n;){try{e[n[0]]=decodeURIComponent(n[0])}catch{const i=l5e(n[0]);i!==n[0]&&(e[n[0]]=i)}n=HO.exec(t)}e["%C2"]="";const r=Object.keys(e);for(const i of r)t=t.replace(new RegExp(i,"g"),e[i]);return t}function u5e(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return c5e(t)}}function f5e(t,e){const n={};if(Array.isArray(e))for(const r of e){const i=Object.getOwnPropertyDescriptor(t,r);i!=null&&i.enumerable&&Object.defineProperty(n,r,i)}else for(const r of Reflect.ownKeys(t)){const i=Object.getOwnPropertyDescriptor(t,r);if(i.enumerable){const s=t[r];e(r,s,t)&&Object.defineProperty(n,r,i)}}return n}function zX(t,e){if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t===""||e==="")return[];const n=t.indexOf(e);return n===-1?[]:[t.slice(0,n),t.slice(n+e.length)]}const d5e=t=>t==null,h5e=t=>encodeURIComponent(t).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),hM=Symbol("encodeFragmentIdentifier");function p5e(t){switch(t.arrayFormat){case"index":return e=>(n,r)=>{const i=n.length;return r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,[Yi(e,t),"[",i,"]"].join("")]:[...n,[Yi(e,t),"[",Yi(i,t),"]=",Yi(r,t)].join("")]};case"bracket":return e=>(n,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,[Yi(e,t),"[]"].join("")]:[...n,[Yi(e,t),"[]=",Yi(r,t)].join("")];case"colon-list-separator":return e=>(n,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,[Yi(e,t),":list="].join("")]:[...n,[Yi(e,t),":list=",Yi(r,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return n=>(r,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?r:(i=i===null?"":i,r.length===0?[[Yi(n,t),e,Yi(i,t)].join("")]:[[r,Yi(i,t)].join(t.arrayFormatSeparator)])}default:return e=>(n,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,Yi(e,t)]:[...n,[Yi(e,t),"=",Yi(r,t)].join("")]}}function m5e(t){let e;switch(t.arrayFormat){case"index":return(n,r,i)=>{if(e=/\[(\d*)]$/.exec(n),n=n.replace(/\[\d*]$/,""),!e){i[n]=r;return}i[n]===void 0&&(i[n]={}),i[n][e[1]]=r};case"bracket":return(n,r,i)=>{if(e=/(\[])$/.exec(n),n=n.replace(/\[]$/,""),!e){i[n]=r;return}if(i[n]===void 0){i[n]=[r];return}i[n]=[...i[n],r]};case"colon-list-separator":return(n,r,i)=>{if(e=/(:list)$/.exec(n),n=n.replace(/:list$/,""),!e){i[n]=r;return}if(i[n]===void 0){i[n]=[r];return}i[n]=[...i[n],r]};case"comma":case"separator":return(n,r,i)=>{const s=typeof r=="string"&&r.includes(t.arrayFormatSeparator),o=typeof r=="string"&&!s&&zc(r,t).includes(t.arrayFormatSeparator);r=o?zc(r,t):r;const a=s||o?r.split(t.arrayFormatSeparator).map(l=>zc(l,t)):r===null?r:zc(r,t);i[n]=a};case"bracket-separator":return(n,r,i)=>{const s=/(\[])$/.test(n);if(n=n.replace(/\[]$/,""),!s){i[n]=r&&zc(r,t);return}const o=r===null?[]:zc(r,t).split(t.arrayFormatSeparator);if(i[n]===void 0){i[n]=o;return}i[n]=[...i[n],...o]};default:return(n,r,i)=>{if(i[n]===void 0){i[n]=r;return}i[n]=[...[i[n]].flat(),r]}}}function HX(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function Yi(t,e){return e.encode?e.strict?h5e(t):encodeURIComponent(t):t}function zc(t,e){return e.decode?u5e(t):t}function GX(t){return Array.isArray(t)?t.sort():typeof t=="object"?GX(Object.keys(t)).sort((e,n)=>Number(e)-Number(n)).map(e=>t[e]):t}function jX(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function g5e(t){let e="";const n=t.indexOf("#");return n!==-1&&(e=t.slice(n)),e}function GO(t,e,n){return n==="string"&&typeof t=="string"?t:typeof n=="function"&&typeof t=="string"?n(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")?t.toLowerCase()==="true":n==="number"&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""||e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?Number(t):t}function C8(t){t=jX(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function R8(t,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e},HX(e.arrayFormatSeparator);const n=m5e(e),r=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return r;for(const i of t.split("&")){if(i==="")continue;const s=e.decode?i.replaceAll("+"," "):i;let[o,a]=zX(s,"=");o===void 0&&(o=s),a=a===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?a:zc(a,e),n(zc(o,e),a,r)}for(const[i,s]of Object.entries(r))if(typeof s=="object"&&s!==null&&e.types[i]!=="string")for(const[o,a]of Object.entries(s)){const l=e.types[i]?e.types[i].replace("[]",""):void 0;s[o]=GO(a,e,l)}else typeof s=="object"&&s!==null&&e.types[i]==="string"?r[i]=Object.values(s).join(e.arrayFormatSeparator):r[i]=GO(s,e,e.types[i]);return e.sort===!1?r:(e.sort===!0?Object.keys(r).sort():Object.keys(r).sort(e.sort)).reduce((i,s)=>{const o=r[s];return i[s]=o&&typeof o=="object"&&!Array.isArray(o)?GX(o):o,i},Object.create(null))}function VX(t,e){if(!t)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},HX(e.arrayFormatSeparator);const n=o=>e.skipNull&&d5e(t[o])||e.skipEmptyString&&t[o]==="",r=p5e(e),i={};for(const[o,a]of Object.entries(t))n(o)||(i[o]=a);const s=Object.keys(i);return e.sort!==!1&&s.sort(e.sort),s.map(o=>{const a=t[o];return a===void 0?"":a===null?Yi(o,e):Array.isArray(a)?a.length===0&&e.arrayFormat==="bracket-separator"?Yi(o,e)+"[]":a.reduce(r(o),[]).join("&"):Yi(o,e)+"="+Yi(a,e)}).filter(o=>o.length>0).join("&")}function WX(t,e){var n;e={decode:!0,...e};let[r,i]=zX(t,"#");return r===void 0&&(r=t),{url:((n=r==null?void 0:r.split("?"))==null?void 0:n[0])??"",query:R8(C8(t),e),...e&&e.parseFragmentIdentifier&&i?{fragmentIdentifier:zc(i,e)}:{}}}function $X(t,e){e={encode:!0,strict:!0,[hM]:!0,...e};const n=jX(t.url).split("?")[0]||"",r=C8(t.url),i={...R8(r,{sort:!1}),...t.query};let s=VX(i,e);s&&(s=`?${s}`);let o=g5e(t.url);if(typeof t.fragmentIdentifier=="string"){const a=new URL(n);a.hash=t.fragmentIdentifier,o=e[hM]?a.hash:`#${t.fragmentIdentifier}`}return`${n}${s}${o}`}function XX(t,e,n){n={parseFragmentIdentifier:!0,[hM]:!1,...n};const{url:r,query:i,fragmentIdentifier:s}=WX(t,n);return $X({url:r,query:f5e(i,e),fragmentIdentifier:s},n)}function y5e(t,e,n){const r=Array.isArray(e)?i=>!e.includes(i):(i,s)=>!e(i,s);return XX(t,r,n)}const gu=Object.freeze(Object.defineProperty({__proto__:null,exclude:y5e,extract:C8,parse:R8,parseUrl:WX,pick:XX,stringify:VX,stringifyUrl:$X},Symbol.toStringTag,{value:"Module"}));var Rg,z_=((Rg=function(){return z_}).toString=Rg.toLocaleString=Rg[Symbol.toPrimitive]=function(){return""},Rg.valueOf=function(){return!1},new Proxy(Object.freeze(Rg),{get:function(t,e){return t.hasOwnProperty(e)?t[e]:z_}}));const H_=typeof globalThis.window<"u"?globalThis.window:z_,eu=typeof H_.document<"u"?H_.document:z_;typeof H_.navigator<"u"&&H_.navigator;var pM;try{pM=new TextDecoder}catch{}var en,Ba,tt=0,Qr={},hr,tf,Na=0,Kl=0,ws,tu,qo=[],ur,jO={useRecords:!1,mapsAsObjects:!0};class qX{}const YX=new qX;YX.name="MessagePack 0xC1";var lf=!1,KX=2,VO;try{new Function("")}catch{KX=1/0}class ey{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,n){if(en)return nq(()=>(gM(),this?this.unpack(e,n):ey.prototype.unpack.call(jO,e,n)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Buffer<"u"?Buffer.from(e):new Uint8Array(e)),typeof n=="object"?(Ba=n.end||e.length,tt=n.start||0):(tt=0,Ba=n>-1?n:e.length),Kl=0,tf=null,ws=null,en=e;try{ur=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw en=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof ey){if(Qr=this,this.structures)return hr=this.structures,Ux(n);(!hr||hr.length>0)&&(hr=[])}else Qr=jO,(!hr||hr.length>0)&&(hr=[]);return Ux(n)}unpackMultiple(e,n){let r,i=0;try{lf=!0;let s=e.length,o=this?this.unpack(e,s):LE.unpack(e,s);if(n){if(n(o,i,tt)===!1)return;for(;tt<s;)if(i=tt,n(Ux(),i,tt)===!1)return}else{for(r=[o];tt<s;)i=tt,r.push(Ux());return r}}catch(s){throw s.lastPosition=i,s.values=r,s}finally{lf=!1,gM()}}_mergeStructures(e,n){e=e||[],Object.isFrozen(e)&&(e=e.map(r=>r.slice(0)));for(let r=0,i=e.length;r<i;r++){let s=e[r];s&&(s.isShared=!0,r>=32&&(s.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in n||[])if(r>=0){let i=e[r],s=n[r];s&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=s)}return this.structures=e}decode(e,n){return this.unpack(e,n)}}function Ux(t){try{if(!Qr.trusted&&!lf){let n=hr.sharedLength||0;n<hr.length&&(hr.length=n)}let e;if(Qr.randomAccessStructure&&en[tt]<64&&en[tt]>=32&&VO?(e=VO(en,tt,Ba,Qr),en=null,!(t&&t.lazy)&&e&&(e=e.toJSON()),tt=Ba):e=Fi(),ws&&(tt=ws.postBundlePosition,ws=null),lf&&(hr.restoreStructures=null),tt==Ba)hr&&hr.restoreStructures&&WO(),hr=null,en=null,tu&&(tu=null);else{if(tt>Ba)throw new Error("Unexpected end of MessagePack data");if(!lf){let n;try{n=JSON.stringify(e,(r,i)=>typeof i=="bigint"?`${i}n`:i).slice(0,100)}catch(r){n="(JSON view not available "+r+")"}throw new Error("Data read, but end of buffer not reached "+n)}}return e}catch(e){throw hr&&hr.restoreStructures&&WO(),gM(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||tt>Ba)&&(e.incomplete=!0),e}}function WO(){for(let t in hr.restoreStructures)hr[t]=hr.restoreStructures[t];hr.restoreStructures=null}function Fi(){let t=en[tt++];if(t<160)if(t<128){if(t<64)return t;{let e=hr[t&63]||Qr.getStructures&&ZX()[t&63];return e?(e.read||(e.read=I8(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,Qr.mapsAsObjects){let e={};for(let n=0;n<t;n++){let r=JX();r==="__proto__"&&(r="__proto_"),e[r]=Fi()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Fi(),Fi());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Fi();return Qr.freezeData?Object.freeze(e):e}else if(t<192){let e=t-160;if(Kl>=tt)return tf.slice(tt-Na,(tt+=e)-Na);if(Kl==0&&Ba<140){let n=e<16?P8(e):QX(e);if(n!=null)return n}return mM(e)}else{let e;switch(t){case 192:return null;case 193:return ws?(e=Fi(),e>0?ws[1].slice(ws.position1,ws.position1+=e):ws[0].slice(ws.position0,ws.position0-=e)):YX;case 194:return!1;case 195:return!0;case 196:if(e=en[tt++],e===void 0)throw new Error("Unexpected end of buffer");return QT(e);case 197:return e=ur.getUint16(tt),tt+=2,QT(e);case 198:return e=ur.getUint32(tt),tt+=4,QT(e);case 199:return ld(en[tt++]);case 200:return e=ur.getUint16(tt),tt+=2,ld(e);case 201:return e=ur.getUint32(tt),tt+=4,ld(e);case 202:if(e=ur.getFloat32(tt),Qr.useFloat32>2){let n=k8[(en[tt]&127)<<1|en[tt+1]>>7];return tt+=4,(n*e+(e>0?.5:-.5)>>0)/n}return tt+=4,e;case 203:return e=ur.getFloat64(tt),tt+=8,e;case 204:return en[tt++];case 205:return e=ur.getUint16(tt),tt+=2,e;case 206:return e=ur.getUint32(tt),tt+=4,e;case 207:return Qr.int64AsType==="number"?(e=ur.getUint32(tt)*4294967296,e+=ur.getUint32(tt+4)):Qr.int64AsType==="string"?e=ur.getBigUint64(tt).toString():Qr.int64AsType==="auto"?(e=ur.getBigUint64(tt),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=ur.getBigUint64(tt),tt+=8,e;case 208:return ur.getInt8(tt++);case 209:return e=ur.getInt16(tt),tt+=2,e;case 210:return e=ur.getInt32(tt),tt+=4,e;case 211:return Qr.int64AsType==="number"?(e=ur.getInt32(tt)*4294967296,e+=ur.getUint32(tt+4)):Qr.int64AsType==="string"?e=ur.getBigInt64(tt).toString():Qr.int64AsType==="auto"?(e=ur.getBigInt64(tt),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=ur.getBigInt64(tt),tt+=8,e;case 212:if(e=en[tt++],e==114)return ZO(en[tt++]&63);{let n=qo[e];if(n)return n.read?(tt++,n.read(Fi())):n.noBuffer?(tt++,n()):n(en.subarray(tt,++tt));throw new Error("Unknown extension "+e)}case 213:return e=en[tt],e==114?(tt++,ZO(en[tt++]&63,en[tt++])):ld(2);case 214:return ld(4);case 215:return ld(8);case 216:return ld(16);case 217:return e=en[tt++],Kl>=tt?tf.slice(tt-Na,(tt+=e)-Na):x5e(e);case 218:return e=ur.getUint16(tt),tt+=2,Kl>=tt?tf.slice(tt-Na,(tt+=e)-Na):_5e(e);case 219:return e=ur.getUint32(tt),tt+=4,Kl>=tt?tf.slice(tt-Na,(tt+=e)-Na):b5e(e);case 220:return e=ur.getUint16(tt),tt+=2,XO(e);case 221:return e=ur.getUint32(tt),tt+=4,XO(e);case 222:return e=ur.getUint16(tt),tt+=2,qO(e);case 223:return e=ur.getUint32(tt),tt+=4,qO(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}const v5e=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function I8(t,e){function n(){if(n.count++>KX){let i=t.read=new Function("r","return function(){return "+(Qr.freezeData?"Object.freeze":"")+"({"+t.map(s=>s==="__proto__"?"__proto_:r()":v5e.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(Fi);return t.highByte===0&&(t.read=$O(e,t.read)),i()}let r={};for(let i=0,s=t.length;i<s;i++){let o=t[i];o==="__proto__"&&(o="__proto_"),r[o]=Fi()}return Qr.freezeData?Object.freeze(r):r}return n.count=0,t.highByte===0?$O(e,n):n}const $O=(t,e)=>function(){let n=en[tt++];if(n===0)return e();let r=t<32?-(t+(n<<5)):t+(n<<5),i=hr[r]||ZX()[r];if(!i)throw new Error("Record id is not defined for "+r);return i.read||(i.read=I8(i,t)),i.read()};function ZX(){let t=nq(()=>(en=null,Qr.getStructures()));return hr=Qr._mergeStructures(t,hr)}var mM=jy,x5e=jy,_5e=jy,b5e=jy;function jy(t){let e;if(t<16&&(e=P8(t)))return e;if(t>64&&pM)return pM.decode(en.subarray(tt,tt+=t));const n=tt+t,r=[];for(e="";tt<n;){const i=en[tt++];if(!(i&128))r.push(i);else if((i&224)===192){const s=en[tt++]&63;r.push((i&31)<<6|s)}else if((i&240)===224){const s=en[tt++]&63,o=en[tt++]&63;r.push((i&31)<<12|s<<6|o)}else if((i&248)===240){const s=en[tt++]&63,o=en[tt++]&63,a=en[tt++]&63;let l=(i&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l)}else r.push(i);r.length>=4096&&(e+=bs.apply(String,r),r.length=0)}return r.length>0&&(e+=bs.apply(String,r)),e}function XO(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Fi();return Qr.freezeData?Object.freeze(e):e}function qO(t){if(Qr.mapsAsObjects){let e={};for(let n=0;n<t;n++){let r=JX();r==="__proto__"&&(r="__proto_"),e[r]=Fi()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Fi(),Fi());return e}}var bs=String.fromCharCode;function QX(t){let e=tt,n=new Array(t);for(let r=0;r<t;r++){const i=en[tt++];if((i&128)>0){tt=e;return}n[r]=i}return bs.apply(String,n)}function P8(t){if(t<4)if(t<2){if(t===0)return"";{let e=en[tt++];if((e&128)>1){tt-=1;return}return bs(e)}}else{let e=en[tt++],n=en[tt++];if((e&128)>0||(n&128)>0){tt-=2;return}if(t<3)return bs(e,n);let r=en[tt++];if((r&128)>0){tt-=3;return}return bs(e,n,r)}else{let e=en[tt++],n=en[tt++],r=en[tt++],i=en[tt++];if((e&128)>0||(n&128)>0||(r&128)>0||(i&128)>0){tt-=4;return}if(t<6){if(t===4)return bs(e,n,r,i);{let s=en[tt++];if((s&128)>0){tt-=5;return}return bs(e,n,r,i,s)}}else if(t<8){let s=en[tt++],o=en[tt++];if((s&128)>0||(o&128)>0){tt-=6;return}if(t<7)return bs(e,n,r,i,s,o);let a=en[tt++];if((a&128)>0){tt-=7;return}return bs(e,n,r,i,s,o,a)}else{let s=en[tt++],o=en[tt++],a=en[tt++],l=en[tt++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){tt-=8;return}if(t<10){if(t===8)return bs(e,n,r,i,s,o,a,l);{let c=en[tt++];if((c&128)>0){tt-=9;return}return bs(e,n,r,i,s,o,a,l,c)}}else if(t<12){let c=en[tt++],u=en[tt++];if((c&128)>0||(u&128)>0){tt-=10;return}if(t<11)return bs(e,n,r,i,s,o,a,l,c,u);let f=en[tt++];if((f&128)>0){tt-=11;return}return bs(e,n,r,i,s,o,a,l,c,u,f)}else{let c=en[tt++],u=en[tt++],f=en[tt++],d=en[tt++];if((c&128)>0||(u&128)>0||(f&128)>0||(d&128)>0){tt-=12;return}if(t<14){if(t===12)return bs(e,n,r,i,s,o,a,l,c,u,f,d);{let h=en[tt++];if((h&128)>0){tt-=13;return}return bs(e,n,r,i,s,o,a,l,c,u,f,d,h)}}else{let h=en[tt++],p=en[tt++];if((h&128)>0||(p&128)>0){tt-=14;return}if(t<15)return bs(e,n,r,i,s,o,a,l,c,u,f,d,h,p);let m=en[tt++];if((m&128)>0){tt-=15;return}return bs(e,n,r,i,s,o,a,l,c,u,f,d,h,p,m)}}}}}function YO(){let t=en[tt++],e;if(t<192)e=t-160;else switch(t){case 217:e=en[tt++];break;case 218:e=ur.getUint16(tt),tt+=2;break;case 219:e=ur.getUint32(tt),tt+=4;break;default:throw new Error("Expected string")}return jy(e)}function QT(t){return Qr.copyBuffers?Uint8Array.prototype.slice.call(en,tt,tt+=t):en.subarray(tt,tt+=t)}function ld(t){let e=en[tt++];if(qo[e]){let n;return qo[e](en.subarray(tt,n=tt+=t),r=>{tt=r;try{return Fi()}finally{tt=n}})}else throw new Error("Unknown extension type "+e)}var KO=new Array(4096);function JX(){let t=en[tt++];if(t>=160&&t<192){if(t=t-160,Kl>=tt)return tf.slice(tt-Na,(tt+=t)-Na);if(!(Kl==0&&Ba<180))return mM(t)}else return tt--,eq(Fi());let e=(t<<5^(t>1?ur.getUint16(tt):t>0?en[tt]:0))&4095,n=KO[e],r=tt,i=tt+t-3,s,o=0;if(n&&n.bytes==t){for(;r<i;){if(s=ur.getUint32(r),s!=n[o++]){r=1879048192;break}r+=4}for(i+=3;r<i;)if(s=en[r++],s!=n[o++]){r=1879048192;break}if(r===i)return tt=r,n.string;i-=3,r=tt}for(n=[],KO[e]=n,n.bytes=t;r<i;)s=ur.getUint32(r),n.push(s),r+=4;for(i+=3;r<i;)s=en[r++],n.push(s);let a=t<16?P8(t):QX(t);return a!=null?n.string=a:n.string=mM(t)}function eq(t){if(typeof t=="string")return t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";throw new Error("Invalid property type for record",typeof t)}const ZO=(t,e)=>{let n=Fi().map(eq),r=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let i=hr[t];return i&&(i.isShared||lf)&&((hr.restoreStructures||(hr.restoreStructures=[]))[t]=i),hr[t]=n,n.read=I8(n,r),n.read()};qo[0]=()=>{};qo[0].noBuffer=!0;qo[66]=t=>{let e=t.length,n=BigInt(t[0]&128?t[0]-256:t[0]);for(let r=1;r<e;r++)n<<=BigInt(8),n+=BigInt(t[r]);return n};let E5e={Error,TypeError,ReferenceError};qo[101]=()=>{let t=Fi();return(E5e[t[0]]||Error)(t[1],{cause:t[2]})};qo[105]=t=>{if(Qr.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=ur.getUint32(tt-4);tu||(tu=new Map);let n=en[tt],r;n>=144&&n<160||n==220||n==221?r=[]:r={};let i={target:r};tu.set(e,i);let s=Fi();return i.used?Object.assign(r,s):(i.target=s,s)};qo[112]=t=>{if(Qr.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=ur.getUint32(tt-4),n=tu.get(e);return n.used=!0,n.target};qo[115]=()=>new Set(Fi());const tq=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let w5e=typeof globalThis=="object"?globalThis:window;qo[116]=t=>{let e=t[0],n=tq[e];if(!n){if(e===16){let r=new ArrayBuffer(t.length-1);return new Uint8Array(r).set(t.subarray(1)),r}throw new Error("Could not find typed array for code "+e)}return new w5e[n](Uint8Array.prototype.slice.call(t,1).buffer)};qo[120]=()=>{let t=Fi();return new RegExp(t[0],t[1])};const S5e=[];qo[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=tt;return tt+=e-t.length,ws=S5e,ws=[YO(),YO()],ws.position0=0,ws.position1=0,ws.postBundlePosition=tt,tt=n,Fi()};qo[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function nq(t){let e=Ba,n=tt,r=Na,i=Kl,s=tf,o=tu,a=ws,l=new Uint8Array(en.slice(0,Ba)),c=hr,u=hr.slice(0,hr.length),f=Qr,d=lf,h=t();return Ba=e,tt=n,Na=r,Kl=i,tf=s,tu=o,ws=a,en=l,lf=d,hr=c,hr.splice(0,hr.length,...u),Qr=f,ur=new DataView(en.buffer,en.byteOffset,en.byteLength),h}function gM(){en=null,tu=null,hr=null}const k8=new Array(147);for(let t=0;t<256;t++)k8[t]=+("1e"+Math.floor(45.15-t*.30103));var LE=new ey({useRecords:!1});const rq=LE.unpack;LE.unpackMultiple;LE.unpack;let T5e=new Float32Array(1);new Uint8Array(T5e.buffer,0,4);let b3;try{b3=new TextEncoder}catch{}let yM,iq;const DE=typeof Buffer<"u",Bx=DE?function(t){return Buffer.allocUnsafeSlow(t)}:Uint8Array,sq=DE?Buffer:Uint8Array,QO=DE?4294967296:2144337920;let ft,Ig,Yr,rt=0,xo,vi=null,A5e;const M5e=21760,C5e=/[\u0080-\uFFFF]/,wp=Symbol("record-id");class R5e extends ey{constructor(e){super(e),this.offset=0;let n,r,i,s,o=sq.prototype.utf8Write?function(L,N){return ft.utf8Write(L,N,ft.byteLength-N)}:b3&&b3.encodeInto?function(L,N){return b3.encodeInto(L,ft.subarray(N)).written}:!1,a=this;e||(e={});let l=e&&e.sequential,c=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=c?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let f=e.maxOwnStructures;f==null&&(f=c?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let d=u>32||f+u>64,h=u+64,p=u+f+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let m=[],g=0,y=0;this.pack=this.encode=function(L,N){if(ft||(ft=new Bx(8192),Yr=ft.dataView||(ft.dataView=new DataView(ft.buffer,0,8192)),rt=0),xo=ft.length-10,xo-rt<2048?(ft=new Bx(ft.length),Yr=ft.dataView||(ft.dataView=new DataView(ft.buffer,0,ft.length)),xo=ft.length-10,rt=0):rt=rt+7&2147483640,n=rt,N&N5e&&(rt+=N&255),s=a.structuredClone?new Map:null,a.bundleStrings&&typeof L!="string"?(vi=[],vi.size=1/0):vi=null,i=a.structures,i){i.uninitialized&&(i=a._mergeStructures(a.getStructures()));let O=i.sharedLength||0;if(O>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let K=0;K<O;K++){let V=i[K];if(!V)continue;let ne,re=i.transitions;for(let P=0,se=V.length;P<se;P++){let ue=V[P];ne=re[ue],ne||(ne=re[ue]=Object.create(null)),re=ne}re[wp]=K+64}this.lastNamedStructuresLength=O}l||(i.nextId=O+64)}r&&(r=!1);let z;try{a.randomAccessStructure&&L&&L.constructor&&L.constructor===Object?k(L):w(L);let O=vi;if(vi&&tF(n,w,0),s&&s.idsToInsert){let K=s.idsToInsert.sort((P,se)=>P.offset>se.offset?1:-1),V=K.length,ne=-1;for(;O&&V>0;){let P=K[--V].offset+n;P<O.stringsPosition+n&&ne===-1&&(ne=0),P>O.position+n?ne>=0&&(ne+=6):(ne>=0&&(Yr.setUint32(O.position+n,Yr.getUint32(O.position+n)+ne),ne=-1),O=O.previous,V++)}ne>=0&&O&&Yr.setUint32(O.position+n,Yr.getUint32(O.position+n)+ne),rt+=K.length*6,rt>xo&&R(rt),a.offset=rt;let re=P5e(ft.subarray(n,rt),K);return s=null,re}return a.offset=rt,N&L5e?(ft.start=n,ft.end=rt,ft):ft.subarray(n,rt)}catch(O){throw z=O,O}finally{if(i&&(x(),r&&a.saveStructures)){let O=i.sharedLength||0,K=ft.subarray(n,rt),V=k5e(i,a);if(!z)return a.saveStructures(V,V.isCompatible)===!1?a.pack(L,N):(a.lastNamedStructuresLength=O,ft.length>1073741824&&(ft=null),K)}ft.length>1073741824&&(ft=null),N&D5e&&(rt=n)}};const x=()=>{y<10&&y++;let L=i.sharedLength||0;if(i.length>L&&!l&&(i.length=L),g>1e4)i.transitions=null,y=0,g=0,m.length>0&&(m=[]);else if(m.length>0&&!l){for(let N=0,z=m.length;N<z;N++)m[N][wp]=0;m=[]}},_=L=>{var N=L.length;N<16?ft[rt++]=144|N:N<65536?(ft[rt++]=220,ft[rt++]=N>>8,ft[rt++]=N&255):(ft[rt++]=221,Yr.setUint32(rt,N),rt+=4);for(let z=0;z<N;z++)w(L[z])},w=L=>{rt>xo&&(ft=R(rt));var N=typeof L,z;if(N==="string"){let O=L.length;if(vi&&O>=4&&O<4096){if((vi.size+=O)>M5e){let re,P=(vi[0]?vi[0].length*3+vi[1].length:0)+10;rt+P>xo&&(ft=R(rt+P));let se;vi.position?(se=vi,ft[rt]=200,rt+=3,ft[rt++]=98,re=rt-n,rt+=4,tF(n,w,0),Yr.setUint16(re+n-3,rt-n-re)):(ft[rt++]=214,ft[rt++]=98,re=rt-n,rt+=4),vi=["",""],vi.previous=se,vi.size=0,vi.position=re}let ne=C5e.test(L);vi[ne?0:1]+=L,ft[rt++]=193,w(ne?-O:O);return}let K;O<32?K=1:O<256?K=2:O<65536?K=3:K=5;let V=O*3;if(rt+V>xo&&(ft=R(rt+V)),O<64||!o){let ne,re,P,se=rt+K;for(ne=0;ne<O;ne++)re=L.charCodeAt(ne),re<128?ft[se++]=re:re<2048?(ft[se++]=re>>6|192,ft[se++]=re&63|128):(re&64512)===55296&&((P=L.charCodeAt(ne+1))&64512)===56320?(re=65536+((re&1023)<<10)+(P&1023),ne++,ft[se++]=re>>18|240,ft[se++]=re>>12&63|128,ft[se++]=re>>6&63|128,ft[se++]=re&63|128):(ft[se++]=re>>12|224,ft[se++]=re>>6&63|128,ft[se++]=re&63|128);z=se-rt-K}else z=o(L,rt+K);z<32?ft[rt++]=160|z:z<256?(K<2&&ft.copyWithin(rt+2,rt+1,rt+1+z),ft[rt++]=217,ft[rt++]=z):z<65536?(K<3&&ft.copyWithin(rt+3,rt+2,rt+2+z),ft[rt++]=218,ft[rt++]=z>>8,ft[rt++]=z&255):(K<5&&ft.copyWithin(rt+5,rt+3,rt+3+z),ft[rt++]=219,Yr.setUint32(rt,z),rt+=4),rt+=z}else if(N==="number")if(L>>>0===L)L<32||L<128&&this.useRecords===!1||L<64&&!this.randomAccessStructure?ft[rt++]=L:L<256?(ft[rt++]=204,ft[rt++]=L):L<65536?(ft[rt++]=205,ft[rt++]=L>>8,ft[rt++]=L&255):(ft[rt++]=206,Yr.setUint32(rt,L),rt+=4);else if(L>>0===L)L>=-32?ft[rt++]=256+L:L>=-128?(ft[rt++]=208,ft[rt++]=L+256):L>=-32768?(ft[rt++]=209,Yr.setInt16(rt,L),rt+=2):(ft[rt++]=210,Yr.setInt32(rt,L),rt+=4);else{let O;if((O=this.useFloat32)>0&&L<4294967296&&L>=-2147483648){ft[rt++]=202,Yr.setFloat32(rt,L);let K;if(O<4||(K=L*k8[(ft[rt]&127)<<1|ft[rt+1]>>7])>>0===K){rt+=4;return}else rt--}ft[rt++]=203,Yr.setFloat64(rt,L),rt+=8}else if(N==="object"||N==="function")if(!L)ft[rt++]=192;else{if(s){let K=s.get(L);if(K){if(!K.id){let V=s.idsToInsert||(s.idsToInsert=[]);K.id=V.push(K)}ft[rt++]=214,ft[rt++]=112,Yr.setUint32(rt,K.id),rt+=4;return}else s.set(L,{offset:rt-n})}let O=L.constructor;if(O===Object)A(L);else if(O===Array)_(L);else if(O===Map)if(this.mapAsEmptyObject)ft[rt++]=128;else{z=L.size,z<16?ft[rt++]=128|z:z<65536?(ft[rt++]=222,ft[rt++]=z>>8,ft[rt++]=z&255):(ft[rt++]=223,Yr.setUint32(rt,z),rt+=4);for(let[K,V]of L)w(K),w(V)}else{for(let K=0,V=yM.length;K<V;K++){let ne=iq[K];if(L instanceof ne){let re=yM[K];if(re.write){re.type&&(ft[rt++]=212,ft[rt++]=re.type,ft[rt++]=0);let W=re.write.call(this,L);W===L?Array.isArray(L)?_(L):A(L):w(W);return}let P=ft,se=Yr,ue=rt;ft=null;let te;try{te=re.pack.call(this,L,W=>(ft=P,P=null,rt+=W,rt>xo&&R(rt),{target:ft,targetView:Yr,position:rt-W}),w)}finally{P&&(ft=P,Yr=se,rt=ue,xo=ft.length-10)}te&&(te.length+rt>xo&&R(te.length+rt),rt=I5e(te,ft,rt,re.type));return}}if(Array.isArray(L))_(L);else{if(L.toJSON){const K=L.toJSON();if(K!==L)return w(K)}if(N==="function")return w(this.writeFunction&&this.writeFunction(L));A(L)}}}else if(N==="boolean")ft[rt++]=L?195:194;else if(N==="bigint"){if(L<BigInt(1)<<BigInt(63)&&L>=-(BigInt(1)<<BigInt(63)))ft[rt++]=211,Yr.setBigInt64(rt,L);else if(L<BigInt(1)<<BigInt(64)&&L>0)ft[rt++]=207,Yr.setBigUint64(rt,L);else if(this.largeBigIntToFloat)ft[rt++]=203,Yr.setFloat64(rt,Number(L));else{if(this.largeBigIntToString)return w(L.toString());if(this.useBigIntExtension&&L<BigInt(2)**BigInt(1023)&&L>-(BigInt(2)**BigInt(1023))){ft[rt++]=199,rt++,ft[rt++]=66;let O=[],K;do{let V=L&BigInt(255);K=(V&BigInt(128))===(L<BigInt(0)?BigInt(128):BigInt(0)),O.push(V),L>>=BigInt(8)}while(!((L===BigInt(0)||L===BigInt(-1))&&K));ft[rt-2]=O.length;for(let V=O.length;V>0;)ft[rt++]=Number(O[--V]);return}else throw new RangeError(L+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}rt+=8}else if(N==="undefined")this.encodeUndefinedAsNil?ft[rt++]=192:(ft[rt++]=212,ft[rt++]=0,ft[rt++]=0);else throw new Error("Unknown type: "+N)},T=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?L=>{let N;if(this.skipValues){N=[];for(let K in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(K))&&!this.skipValues.includes(L[K])&&N.push(K)}else N=Object.keys(L);let z=N.length;z<16?ft[rt++]=128|z:z<65536?(ft[rt++]=222,ft[rt++]=z>>8,ft[rt++]=z&255):(ft[rt++]=223,Yr.setUint32(rt,z),rt+=4);let O;if(this.coercibleKeyAsNumber)for(let K=0;K<z;K++){O=N[K];let V=Number(O);w(isNaN(V)?O:V),w(L[O])}else for(let K=0;K<z;K++)w(O=N[K]),w(L[O])}:L=>{ft[rt++]=222;let N=rt-n;rt+=2;let z=0;for(let O in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(O))&&(w(O),w(L[O]),z++);if(z>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');ft[N+++n]=z>>8,ft[N+n]=z&255},S=this.useRecords===!1?T:e.progressiveRecords&&!d?L=>{let N,z=i.transitions||(i.transitions=Object.create(null)),O=rt++-n,K;for(let V in L)if(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(V)){if(N=z[V],N)z=N;else{let ne=Object.keys(L),re=z;z=i.transitions;let P=0;for(let se=0,ue=ne.length;se<ue;se++){let te=ne[se];N=z[te],N||(N=z[te]=Object.create(null),P++),z=N}O+n+1==rt?(rt--,M(z,ne,P)):D(z,ne,O,P),K=!0,z=re[V]}w(L[V])}if(!K){let V=z[wp];V?ft[O+n]=V:D(z,Object.keys(L),O,0)}}:L=>{let N,z=i.transitions||(i.transitions=Object.create(null)),O=0;for(let V in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(V))&&(N=z[V],N||(N=z[V]=Object.create(null),O++),z=N);let K=z[wp];K?K>=96&&d?(ft[rt++]=((K-=96)&31)+96,ft[rt++]=K>>5):ft[rt++]=K:M(z,z.__keys__||Object.keys(L),O);for(let V in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(V))&&w(L[V])},C=typeof this.useRecords=="function"&&this.useRecords,A=C?L=>{C(L)?S(L):T(L)}:S,R=L=>{let N;if(L>16777216){if(L-n>QO)throw new Error("Packed buffer would be larger than maximum buffer size");N=Math.min(QO,Math.round(Math.max((L-n)*(L>67108864?1.25:2),4194304)/4096)*4096)}else N=(Math.max(L-n<<2,ft.length-1)>>12)+1<<12;let z=new Bx(N);return Yr=z.dataView||(z.dataView=new DataView(z.buffer,0,N)),L=Math.min(L,ft.length),ft.copy?ft.copy(z,0,n,L):z.set(ft.slice(n,L)),rt-=n,n=0,xo=z.length-10,ft=z},M=(L,N,z)=>{let O=i.nextId;O||(O=64),O<h&&this.shouldShareStructure&&!this.shouldShareStructure(N)?(O=i.nextOwnId,O<p||(O=h),i.nextOwnId=O+1):(O>=p&&(O=h),i.nextId=O+1);let K=N.highByte=O>=96&&d?O-96>>5:-1;L[wp]=O,L.__keys__=N,i[O-64]=N,O<h?(N.isShared=!0,i.sharedLength=O-63,r=!0,K>=0?(ft[rt++]=(O&31)+96,ft[rt++]=K):ft[rt++]=O):(K>=0?(ft[rt++]=213,ft[rt++]=114,ft[rt++]=(O&31)+96,ft[rt++]=K):(ft[rt++]=212,ft[rt++]=114,ft[rt++]=O),z&&(g+=y*z),m.length>=f&&(m.shift()[wp]=0),m.push(L),w(N))},D=(L,N,z,O)=>{let K=ft,V=rt,ne=xo,re=n;ft=Ig,rt=0,n=0,ft||(Ig=ft=new Bx(8192)),xo=ft.length-10,M(L,N,O),Ig=ft;let P=rt;if(ft=K,rt=V,xo=ne,n=re,P>1){let se=rt+P-1;se>xo&&R(se);let ue=z+n;ft.copyWithin(ue+P,ue+1,rt),ft.set(Ig.slice(0,P),ue),rt=se}else ft[z+n]=Ig[0]},k=L=>{let N=A5e(L,ft,n,rt,i,R,(z,O,K)=>{if(K)return r=!0;rt=O;let V=ft;return w(z),x(),V!==ft?{position:rt,targetView:Yr,target:ft}:rt},this);if(N===0)return A(L);rt=N}}useBuffer(e){ft=e,ft.dataView||(ft.dataView=new DataView(ft.buffer,ft.byteOffset,ft.byteLength)),rt=0}set position(e){rt=e}get position(){return rt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}iq=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,qX];yM=[{pack(t,e,n){let r=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:i,targetView:s,position:o}=e(6);i[o++]=214,i[o++]=255,s.setUint32(o,r)}else if(r>0&&r<4294967296){let{target:i,targetView:s,position:o}=e(10);i[o++]=215,i[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),s.setUint32(o+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:i,targetView:s,position:o}=e(3);i[o++]=212,i[o++]=255,i[o++]=255}else{let{target:i,targetView:s,position:o}=e(15);i[o++]=199,i[o++]=12,i[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(r)))}}},{pack(t,e,n){if(this.setAsEmptyObject)return e(0),n({});let r=Array.from(t),{target:i,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),n(r)}},{pack(t,e,n){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=101,r[i++]=0),n([t.name,t.message,t.cause])}},{pack(t,e,n){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=120,r[i++]=0),n([t.source,t.flags])}},{pack(t,e){this.moreTypes?JO(t,16,e):eF(DE?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==sq&&this.moreTypes?JO(t,tq.indexOf(n.name),e):eF(t,e)}},{pack(t,e){let{target:n,position:r}=e(1);n[r]=193}}];function JO(t,e,n,r){let i=t.byteLength;if(i+1<256){var{target:s,position:o}=n(4+i);s[o++]=199,s[o++]=i+1}else if(i+1<65536){var{target:s,position:o}=n(5+i);s[o++]=200,s[o++]=i+1>>8,s[o++]=i+1&255}else{var{target:s,position:o,targetView:a}=n(7+i);s[o++]=201,a.setUint32(o,i+1),o+=4}s[o++]=116,s[o++]=e,t.buffer||(t=new Uint8Array(t)),s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function eF(t,e){let n=t.byteLength;var r,i;if(n<256){var{target:r,position:i}=e(n+2);r[i++]=196,r[i++]=n}else if(n<65536){var{target:r,position:i}=e(n+3);r[i++]=197,r[i++]=n>>8,r[i++]=n&255}else{var{target:r,position:i,targetView:s}=e(n+5);r[i++]=198,s.setUint32(i,n),i+=4}r.set(t,i)}function I5e(t,e,n,r){let i=t.length;switch(i){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:i<256?(e[n++]=199,e[n++]=i):i<65536?(e[n++]=200,e[n++]=i>>8,e[n++]=i&255):(e[n++]=201,e[n++]=i>>24,e[n++]=i>>16&255,e[n++]=i>>8&255,e[n++]=i&255)}return e[n++]=r,e.set(t,n),n+=i,n}function P5e(t,e){let n,r=e.length*6,i=t.length-r;for(;n=e.pop();){let s=n.offset,o=n.id;t.copyWithin(s+r,s,i),r-=6;let a=s+r;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,i=s}return t}function tF(t,e,n){if(vi.length>0){Yr.setUint32(vi.position+t,rt+n-vi.position-t),vi.stringsPosition=rt-t;let r=vi;vi=null,e(r[0]),e(r[1])}}function k5e(t,e){return t.isCompatible=n=>{let r=!n||(e.lastNamedStructuresLength||0)===n.length;return r||e._mergeStructures(n),r},t}let oq=new R5e({useRecords:!1});const aq=oq.pack;oq.pack;const L5e=512,D5e=1024,N5e=2048,O5e=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function F5e(t){return O5e.test(t)}function vM(){var t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.split(/[:\/]/g).pop().toLowerCase()}vM.valid=F5e;class Tm{constructor(){tn(this,"reducers"),tn(this,"subscribers"),this.reducers={},this.subscribers={}}addReducer(e,n,r){const i=r||vM();return this.reducers[e]||(this.reducers[e]={}),this.reducers[e][i]=n,()=>{delete this.reducers[e][i]}}subscribe(e,n,r){const i=r||vM();return this.subscribers[e]||(this.subscribers[e]={}),this.subscribers[e][i]=n,()=>{delete this.subscribers[e][i]}}publish(e){if(!e)return;const n=e.etype,r=this.reducers[n]||{};for(const o in r){const a=this.reducers[n][o];e=a(e)}const i=this.subscribers[n]||{};for(const o in i){const a=this.subscribers[n][o];setTimeout(()=>{a(e)},0)}const s=this.subscribers["*"]||{};for(const o in s){const a=s[o];setTimeout(()=>{a(e)},0)}return e}}const nF=V$,U5e=gEe,L8=v.createContext(void 0),Mr=()=>{const t=v.useContext(L8);if(t===void 0)throw new Error("useSocket must be used within a SocketProvider");return t},rF=8012;function B5e(t){return t||(window.location.hostname=="vuer.ai"?`ws://localhost:${rF}`:window.location.protocol=="https:"?`wss://${window.location.hostname}`:`ws://${window.location.hostname}:${window.location.port||rF}`)}function z5e({onMessage:t,children:e}){const[n,r]=nF(!1),[i,s]=v.useState(!0),[o,a]=v.useState(!0),[,,l]=nF(!0),c=v.useMemo(()=>gu.parse(eu.location.search),[]),u=v.useMemo(()=>new Tm,[]),f=v.useMemo(()=>new Tm,[]),{socketURI:d}=vr("Connection",{socketURI:{value:B5e(c.ws),order:0,label:"Socket URI"},reconnect:Oy(()=>{s(!1),a(!1),setTimeout(()=>{s(!0)},100)},{disabled:!o,label:n?"Reconnect":"Disconnected",order:-10})},[]),h=v.useCallback(({data:C})=>{C!=null&&C.arrayBuffer&&C.arrayBuffer().then(A=>{const R=rq(A);typeof t=="function"&&t(R),f.publish(R)})},[d]);function p(){T({etype:"INIT"}),r(!0),a(!0)}function m(){r(!1),a(!1)}function g(){r(!1),a(!1)}function y(){a(!0)}const x=v.useMemo(()=>({onOpen:p,onError:g,onClose:m,onMessage:h,onReconnectStop:y,share:!0,retryOnError:!0,shouldReconnect(){return l.current},reconnectAttempts:c.reconnect?parseInt(c.reconnect):3,reconnectInterval:c.interval?parseInt(c.interval):3e3}),[c.reconnect,c.interval,l.current]),{sendMessage:_,readyState:w}=U5e(d,x,!!d&&i),T=v.useCallback(C=>{if(!w)return;const A=aq(C);C&&_(A)},[w]),S=v.useMemo(()=>({sendMsg:T,uplink:u,downlink:f}),[w]);return v.useEffect(()=>u.subscribe("*",T),[T,u]),H.jsx(L8.Provider,{value:S,children:e})}const H5e=t=>t;function iF(t,e=H5e){if(t)return t.split(",").map(parseFloat).map(e)}const G5e={PerspectiveCamera:vj,OrthographicCamera:nE,CubeCamera:epe};function lq({_ref:t,animate:e,type:n="PerspectiveCamera",label:r,near:i=.1,far:s=.2,fov:o=75,position:a,rotation:l,matrix:c,makeDefault:u=!1,helper:f=!1,...d}){const h=v.useRef();fh(f?h:null,$6);const p=v.useMemo(()=>new $(0,0,0),[]),m=v.useMemo(()=>({matrix:new et,position:new $(0,0,0),rotation:new xr(0,0,0),quaternion:new bn(0,0,0,0),scale:new $(0,0,0)}),[]);v.useEffect(()=>{if(h.current&&c){const y=h.current;m.matrix.fromArray(c),m.matrix.decompose(y.position,m.quaternion,y.scale),y.rotation.setFromQuaternion(m.quaternion),y.updateMatrixWorld(!0),y.updateWorldMatrix(!0,!0),vm()}},[h.current,c]),v.useEffect(()=>{if(!h.current)return;const y=h.current;y.near=i,y.far=s,y.fov=o},[h.current,o,i,s]),Yt(y=>{e&&h.current&&(typeof e=="function"?(e(h.current,y),h.current.lookAt(p)):console.log("animated camera motion is not implemented yet"))});const g=G5e[n];return H.jsxs(H.Fragment,{children:[H.jsx(g,{ref:h,position:a||void 0,rotation:l||void 0,makeDefault:u,...d}),r&&r.length?H.jsxs(ch,{wrapperClass:"label",as:"span",style:{display:"inline-block",borderRadius:"0.25rem",padding:"0.25rem 0.5rem 0.25rem 0.5rem ",background:"white",color:"black",width:"max-content",maxWidth:"200px",height:"fit-content"},children:[" ",r," "]}):null]})}function j5e(t,e,n){const r=n/t;return 360/Math.PI*Math.atan(r/(2*e))}function V5e(t,e,n){const r=2*e*Math.tan(t/360*Math.PI);return n/r}function W5e({parent:t,controls:e,panSpeed:n=.016,viewHeight:r}){return v.useLayoutEffect(()=>{if(!e)return;const i=function(){const o=new $;return function(a){let l=!1;const c=e.object,u=n*r,f=Math.max(u,.001),d=a.shiftKey?f*10:f;a.code==="KeyW"&&(o.setFromMatrixColumn(e.object.matrix,0),o.crossVectors(e.object.up,o),o.normalize(),o.multiplyScalar(d),e.target.add(o),c.position.add(o),l=!0),a.code==="KeyS"&&(o.setFromMatrixColumn(e.object.matrix,0),o.crossVectors(e.object.up,o),o.normalize(),o.multiplyScalar(d),o.negate(),e.target.add(o),c.position.add(o),l=!0),a.code==="KeyA"&&(o.copy(e.target),o.sub(e.object.position),o.crossVectors(e.object.up,o),o.normalize(),o.multiplyScalar(d),e.target.add(o),c.position.add(o),l=!0),a.code==="KeyD"&&(o.copy(e.target),o.sub(e.object.position),o.crossVectors(e.object.up,o),o.normalize(),o.multiplyScalar(d),o.negate(),e.target.add(o),c.position.add(o),l=!0),a.code==="KeyE"&&(o.set(0,d,0),e.target.add(o),c.position.add(o),l=!0),a.code==="KeyQ"&&(o.set(0,-d,0),e.target.add(o),c.position.add(o),l=!0),l&&vm()}}(),s=()=>{};if(t){const o=t;return o.tabIndex=1,o.addEventListener("keydown",i),o.addEventListener("keyup",s),()=>{o.removeEventListener("keydown",i),o.removeEventListener("keyup",s)}}},[e,t,n,r]),H.jsx(H.Fragment,{})}function $5e(t){return t*Math.PI/180}function X5e({parent:t,ctrlRef:e,onChange:n,panSpeed:r=1,fov:i=75,zoom:s=1,near:o,far:a,enableOrbitControl:l=!0,initPosition:c=[-.5,.75,.8],initRotation:u=[0,0,0]}){var f,d;let h=v.useRef();h=e||h;const p=v.useRef(),m=v.useRef(),g=v.useRef();v.useLayoutEffect(()=>{m.current.up.copy(yn.DEFAULT_UP),g.current.up.copy(yn.DEFAULT_UP)},[yn.DEFAULT_UP]);const y=v.useMemo(()=>gu.parse(eu.location.search),[]),[x,_]=vr("Camera Control",()=>({zoom:{label:"Zoom (px)",value:Number(y.zoom)||s||1,step:.001,min:.001,pad:4},fov:{label:"Fov",value:Number(y.fov)||i||75,step:.1,min:.1,max:220},position:{value:iF(y.initCamPos)||c,step:.01,min:-100,max:100},rotation:{value:iF(y.initCamRot,$5e)||u,step:.01}}),[c,u]);vr("Camera Control",{enableControl:{value:!0,label:"lock upright"}},[l]);const{ctype:w,...T}=vr("Camera Control",{ctype:{value:"Perspective",options:["Perspective","Orthographic"],label:"Cam Type"},zoomSpeed:1,near:{label:"Near (cm)",value:parseFloat(y.near)||o||.01,min:.001,step:1e-4},far:{label:"Far (m)",value:parseFloat(y.far)||a||200,min:.001,step:.001},panSpeed:{value:Number(y.panSpeed)||r||1,pad:5,step:.01,min:.001,max:5}}),S=At(({set:L})=>L);At(({controls:L})=>L);const C=(f=t.current)==null?void 0:f.clientHeight,A=(d=t.current)==null?void 0:d.clientWidth;v.useLayoutEffect(()=>{var L,N,z;if(!S)return;let O,K,V;if(p.current){const{target:ne}=h.current;V=p.current.position.distanceTo(ne),O=p.current.position,K=p.current.rotation}else O=new $(...x.position),K=new xr(...x.rotation);if(w.toLowerCase()==="perspective"){const ne=(L=p==null?void 0:p.current)==null?void 0:L.zoom;g.current.position.copy(O),g.current.rotation.copy(K);const re=p.current=g.current;if(h.current.object=re,ne&&V){const P=j5e(ne,V,C);re.fov=P,re.updateProjectionMatrix(),_({fov:P})}}else if(w.toLowerCase()==="orthographic"){const ne=(N=p==null?void 0:p.current)==null?void 0:N.fov;m.current.position.copy(O),g.current.rotation.copy(K),(z=p.current)!=null&&z.far&&(m.current.far=p.current.far);const re=p.current=m.current;if(h.current.object=re,ne&&V){re.near=-re.far;const P=V5e(ne,V,C);re.zoom=P,re.updateProjectionMatrix(),_({zoom:C/P})}else console.warn(`camera tpe ${w} is not defined`)}p.current&&S({camera:p.current})},[w]);function R(){const L=h.current.object;if(!L)return;const N=L.position.distanceTo(h.current.target);if(typeof n=="function"){if(L.type==="PerspectiveCamera"){const{type:z,near:O,far:K,matrix:V,position:ne,rotation:re,up:P,fov:se,focus:ue,aspect:te}=L;n({type:z,near:O,far:K,matrix:V.elements,position:ne.toArray(),rotation:re.toArray(),up:P.toArray(),fov:se,focus:ue,aspect:te,orbit_distance:N})}else if(L.type==="OrthographicCamera"){const{type:z,near:O,far:K,matrix:V,position:ne,rotation:re,up:P,zoom:se,left:ue,top:te,bottom:W,right:X}=L;n({type:z,near:O,far:K,matrix:V.elements,position:ne.toArray(),rotation:re.toArray(),up:P.toArray(),aspect:(X-ue)/(te-W),zoom:C/se,left:ue,top:te,bottom:W,right:X,orbit_distance:N})}}}const{uplink:M}=Mr();v.useEffect(()=>M.subscribe("CAMERA_UPDATE",()=>R()),[]);const D=v.useMemo(()=>({matrix:""}),[]),k=v.useCallback(()=>{var L;const N=(L=h.current)==null?void 0:L.object;if(!N)return;const z=JSON.stringify([N.projectionMatrix.toArray(),N.position.toArray(),N.rotation.toArray(),N.fov]);D.matrix!==z&&R(),D.matrix=z},[p.current,n,C,_]);return v.useLayoutEffect(()=>R(),[h.current,T.near,T.far,x.fov,x.zoom,C,A,_,n]),H.jsxs(H.Fragment,{children:[H.jsx(tpe,{ref:h,makeDefault:!0,enableDamping:!1,enablePan:!0,screenSpacePanning:!0,onChange:k,maxPolarAngle:135/180*Math.PI,minPolarAngle:0/180*Math.PI,maxZoom:1/0,maxDistance:1/0,zoomSpeed:T.zoomSpeed}),H.jsx(vj,{makeDefault:!0,ref:g,fov:x.fov,near:T.near,far:T.far},"perspective"),H.jsx(nE,{makeDefault:!0,ref:m,zoom:C/x.zoom,near:T.near,far:T.far},"orthographic"),H.jsx(W5e,{parent:t.current,viewHeight:x.zoom,controls:h.current,panSpeed:T.panSpeed/600})]})}function xM(){return xM=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xM.apply(this,arguments)}function q5e(t){var e=v.useRef([]),n=v.useRef(),r="ongamepadconnected"in window,i=function(l){var c;e.current=xM({},e.current,(c={},c[l.index]=l,c)),t(e.current)},s=function(l){i(l.gamepad)},o=function(){for(var l=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],c=0;c<l.length;c++){var u=l[c];u&&u!==null&&i(u)}};v.useEffect(function(){return window.addEventListener("gamepadconnected",s),window.removeEventListener("gamepadconnected",s)});var a=function l(){r||o(),n.current=requestAnimationFrame(l)};return v.useEffect(function(){return n.current=requestAnimationFrame(a),function(){return cancelAnimationFrame(n.current)}}),e.current}function D8({_key:t,children:e}){const{sendMsg:n}=Mr();return q5e(r=>{const{axes:i,buttons:s}=r[0];n({ts:Date.now(),etype:"GAMEPADS",key:t,value:{axes:i,buttons:s.map(o=>o.value)}})}),H.jsx(H.Fragment,{children:e})}function Y5e({_key:t}){const{sendMsg:e}=Mr(),{gl:n}=At(),r=v.useCallback(()=>{const i=n.domElement.toDataURL("image/png");e({etype:"SNAPSHOT",key:t,value:{screen:i}});const s=document.createElement("a");s.setAttribute("download","canvas.png"),s.setAttribute("href",i.replace("image/png","image/octet-stream")),s.click()},[e]);return vr({"Take Screenshot":Oy(r,{disabled:!1})},[]),null}const N8={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},{useDebugValue:K5e}=Ge,{useSyncExternalStoreWithSelector:Z5e}=IX;let sF=!1;const Q5e=t=>t;function cq(t,e=Q5e,n){(N8?"production":void 0)!=="production"&&n&&!sF&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sF=!0);const r=Z5e(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return K5e(r),r}const oF=t=>{(N8?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?w8(t):t,n=(r,i)=>cq(e,r,i);return Object.assign(n,e),n},uq=t=>t?oF(t):oF;var fq=t=>((N8?"production":void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),uq(t));const J5e=Object.freeze(Object.defineProperty({__proto__:null,create:uq,createStore:w8,default:fq,useStore:cq},Symbol.toStringTag,{value:"Module"})),O8="children",Am=[O8,"rawChildren","bgChildren","htmlChildren"];function Vy(t,e,n=["children"]){if(t.key===e)return t;for(const r of n)if(t[r])for(const i of t[r]){const s=Vy(i,e);if(s)return s}}function dq(t,e,n=Am){for(const r of n)if(t[r])for(const i of t[r])return i.key===e?t[r]:!0;return!1}function hq(t,e,n){const r=Vy(t,e,Am);return r?(Object.assign(r,n),!0):!1}function pq(t,e,n){if(!t)throw"scene is undefined";if(Am.indexOf(n)>=0&&Array.isArray(t[n]))return t[n].push(e),!0;{const r=n?Vy(t,n,Am):t;return r.children||(r.children=[]),r.children.push(e),!0}}function mq(t,e,n){const r=n?[n]:Am,i=Vy(t,e.key,r);return i?Object.assign(i,e):t[n||O8].push(e),!0}const eMe="_panel_1frsq_1",tMe="_folder_1frsq_1",nMe="_item_1frsq_1",gq=(t,e)=>({ts:e||Date.now(),etype:"SET",data:t}),rMe=(t,e="children",n)=>({ts:n||Date.now(),etype:"ADD",data:{nodes:t,to:e}}),yq=(t,e)=>({ts:e||Date.now(),etype:"UPDATE",data:{nodes:t}}),NE=(t,e,n)=>({ts:e||Date.now(),etype:"UPSERT",data:{nodes:t,to:n}}),iMe=(t,e)=>({ts:e||Date.now(),etype:"REMOVE",data:{keys:t}}),F8=(t,e)=>t.map(n=>{if(typeof n=="string")return H.jsx(_M,{tag:"text",sceneOps:e,children:[n]});{const{key:r,...i}=n;return H.jsx(_M,{_key:r,sceneOps:e,...i},r)}}),_M=({tag:t,_key:e,sceneOps:n,children:r=[]})=>{const[i,s]=v.useState(!0),{show:o}=vr(`Scene.${e}`,{show:{value:!0,label:"Show in View"}});return v.useEffect(()=>{n.update(yq([{tag:t,key:e,hide:!o}]))},[o,n.update]),H.jsxs("div",{className:tMe,onClick:a=>{a.stopPropagation(),s(!i)},children:[H.jsxs("div",{className:nMe,children:[t," ",e]}),i&&F8(r,n)]})},sMe=({title:t,nodes:e,sceneOps:n})=>{const[r,i]=v.useState(!0);return H.jsxs("div",{className:eMe,onClick:s=>{s.stopPropagation(),i(!r)},children:[t&&H.jsx("h3",{children:t}),r&&F8(e,n)]})},OE=fq((t,e)=>({position:[0,0,0],rotation:[0,0,0,"XYZ"],scale:[1,1,1],up:[0,1,0],children:[],bgChildren:[],htmlChildren:[],rawChildren:[],ops:{rawUpdate(n){t(r=>({...r,...n}))},set({ts:n,etype:r,data:i}){delete i.key,i.tag!=="Scene"&&console.error(`
        The top level node of the SET operation must be a <Scene/> object, 
        got <${i.tag}/> instead.
      `),t(i)},add({ts:n,etype:r,data:{nodes:i,to:s}}){t(o=>{let a;for(const l of i)try{a=pq(o,l,s)||a}catch(c){console.error(`Failed to add node ${l.key} to ${s}. ${c}`)}return a?{...o}:o})},update({ts:n,etype:r,data:{nodes:i}}){t(s=>{let o;for(const{key:a,...l}of i)o=hq(s,a,l)||o;return o?{...s}:s})},upsert({ts:n,etype:r,data:{nodes:i,to:s}}){t(o=>{let a;for(const l of i)a=mq(o,l,s);return a?{...o}:o})},removeByKey({ts:n,etype:r,data:{keys:i}}){t(s=>{let o;for(const a of i){const l=dq(s,a);o=o||!!l}return o?{...s}:s})}}}));function oMe(t){return{x:t.x*Math.PI/180,y:t.y*Math.PI/180,z:t.z*Math.PI/180,order:t.order||"XYZ"}}const FE=({x:t,y:e,z:n})=>[t,e,n],aMe=({x:t,y:e,z:n,order:r=void 0})=>typeof r>"u"?[t,e,n]:[t,e,n,r],U8=t=>aMe(oMe(t)),B8=t=>typeof t=="number"?[t,t,t]:FE(t);function lMe({levaPrefix:t="Scene.World Transform",position:e,rotation:n,scale:r,children:i}){const{uplink:s}=Mr(),o=OE(({ops:f})=>f),a=v.useMemo(()=>{const f=gu.parse(eu.location.search);let d,h,p;if(f.rotation){const[m,g,y]=f.rotation.split(",").filter(x=>x&&x===x).map(parseFloat);d={x:m,y:g,z:y}}if(f.position){const[m,g,y]=f.position.split(",").filter(x=>x&&x===x).map(parseFloat);h={x:m,y:g,z:y}}return f.scale&&(p=parseFloat(f.scale)),{rotation:d,position:h,scale:p}},[]),{position:l,rotation:c,scale:u}=vr(t,{rotation:{value:n||a.rotation||{x:0,y:0,z:0},order:1,lock:!0},position:{value:e||a.position||{x:0,y:0,z:0},order:-1,lock:!0},scale:{value:r||a.scale||1,min:1e-4,step:.01,label:"Scale",order:2,pad:4}},{collapsed:!1});return v.useEffect(()=>(setTimeout(()=>s==null?void 0:s.publish({etype:"CAMERA_UPDATE"}),0),o.rawUpdate({position:l,rotation:c,scale:u}),s.addReducer("CAMERA_MOVE",f=>{var d;return{...f,value:{...f.value,world:{...(d=f.value)==null?void 0:d.world,position:l,rotation:c,scale:u}}}})),[s,l,c,u]),H.jsx("group",{position:FE(l)||[0,0,0],rotation:U8(c)||[0,0,0],scale:B8(u||1),children:i})}function z8({children:t}){const{position:e,rotation:n,scale:r}=OE(({position:i,rotation:s,scale:o})=>({position:i,rotation:s,scale:o}));return H.jsx("group",{position:FE(e)||[0,0,0],rotation:U8(n)||[0,0,0],scale:B8(r||1),children:t})}const cMe=()=>{var t,e;return(e=(t=window==null?void 0:window.matchMedia)==null?void 0:t.call(window,"(prefers-color-scheme:dark)"))!=null&&e.matches?"dark":"light"};function uMe({levaPrefix:t="Scene",color:e=1250326}){const n=v.useMemo(()=>gu.parse(document.location.search),[document.location.search]),r=v.useMemo(()=>{let o,a;n.background&&([o,a]=n.background.split(",")),n.darkBg&&(o=n.darkBg),n.lightBg&&(a=n.lightBg);const l=cMe();let c;return l==="dark"?c=o||a:l==="light"?c=a||o:console.warn("Unknown theme",l),c?`#${c}`:e},[e,document.location.search]),{background:i}=vr(t,{background:{value:r,label:"Background Color"}},{collapsed:!0},[e]),{uplink:s}=Mr();return v.useEffect(()=>s.addReducer("CAMERA_MOVE",({value:{world:o,...a},...l})=>({...l,value:{...a,world:{...o,background:i}}})),[s,i]),H.jsx("color",{attach:"background",args:[i]})}const fMe="_style_17sb9_1",aF="_buttonStyle_17sb9_26",dMe=({store:t})=>H.jsxs("div",{className:fMe,children:[H.jsx("button",{className:aF,onClick:()=>t.enterVR(),children:"Virtual Reality"}),H.jsx("button",{className:aF,onClick:()=>t.enterAR(),children:"Pass-through"})]}),hMe="_iframeVuerLinkButton_1utdl_1",pMe=t=>window.self!==window.top?H.jsx("a",{className:hMe,href:window.location.href,target:"_top",children:"Full Screen"}):null,mMe=()=>{const t=gu.parse(document.location.search,{parseBooleans:!0,parseNumbers:!0});return t.gizmo===!1?null:t.gizmo==="cube"?H.jsx(Bk,{alignment:"bottom-left",margin:[80,80],children:H.jsx(fpe,{})}):H.jsx(Bk,{alignment:"bottom-left",margin:[80,80],children:H.jsx(dpe,{axisColors:["#9d4b4b","#2f7f4f","#3b5b9d"],labelColor:"white"})})};ln.prototype.raycast=q4e;const H8=({containerRef:t,className:e,frameloop:n="demand",style:r,shadows:i=!0,children:s,bgChildren:o,rawChildren:a,htmlChildren:l,up:c=null,background:u="#131416",enableOrbitControl:f=!0,camPosition:d,camRotation:h,toneMapping:p="ACE Film",toneMappingExposure:m=1})=>{const g=v.useRef(null),{sendMsg:y,uplink:x}=Mr(),_=v.useMemo(()=>gu.parse(eu.location.search),[]);v.useEffect(()=>{c&&yn.DEFAULT_UP.copy(new $(...c))},[c]);const w=v.useCallback(K=>{var V,ne;x==null||x.publish({etype:"CAMERA_MOVE",key:"defaultCamera",value:{camera:{...K,height:(V=g.current)==null?void 0:V.clientHeight,width:(ne=g.current)==null?void 0:ne.clientWidth}}})},[y,x]),T=v.useMemo(()=>({position:"relative",overflow:"hidden",...r||{height:"100%",width:"100%",margin:"0px",border:"0px"}}),[r]),S=v.useRef(null),C=v.useMemo(()=>A4e({hand:!1,emulate:!1}),[]),{alpha:A,legacy:R,linear:M,flat:D}=vr("Scene.Graphics",{flat:!1,legacy:!1,linear:!1,alpha:!0},{collapsed:!0},[]),k={none:Xa,linear:i6,Reinhard:s6,Cineon:o6,"ACE Film":yb,custom:a6},[{toneMapping:L,toneMappingExposure:N},z]=vr("Scene",()=>({toneMapping:{value:k[p],options:k},toneMappingExposure:{value:m}}),[]);v.useEffect(()=>z({toneMapping:k[p],toneMappingExposure:m}),[p,m]);const O=window.self!==window.top;return H.jsxs(H.Fragment,{children:[H.jsxs("div",{style:T,className:e,ref:t,children:[O?H.jsx(pMe,{}):H.jsx(dMe,{store:C}),H.jsx(nC,{ref:g,shadows:i,linear:M,flat:D,legacy:R,gl:{alpha:A,antialias:!0,toneMapping:L,toneMappingExposure:N,preserveDrawingBuffer:!0},frameloop:n,tabIndex:1,children:H.jsxs(M4e,{store:C,children:[_.debug||_.perf?H.jsx(a5e,{position:"top-left"}):null,H.jsx(D8,{}),H.jsx(lMe,{}),H.jsx(uMe,{color:u}),H.jsx(X5e,{ctrlRef:S,parent:g,onChange:w,panSpeed:1,enableOrbitControl:f,initPosition:d,initRotation:h}),o,H.jsx(v.Suspense,{children:H.jsx(z8,{children:s})}),a,H.jsx(Y5e,{}),H.jsx(mMe,{})]})})]}),l]})};function gMe(t,e){const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");if(r)return r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height,{colorSpace:e})}function yMe(t,e,n=!1){const{width:r}=t,{height:i}=t,s=gMe(t,"srgb");if(!s)return;const o=s.data;for(let a=0,l=r*i*4;a<l;a+=4){let c,u,f,d;a%(r*4)===0?(c=o[a],u=o[a+4]):a%(r*4)===(r-1)*4?(c=o[a-4],u=o[a]):(c=o[a-4],u=o[a+4]),a<r*2?(f=o[a],d=o[a+r*4]):a>r*(i-1)*4?(f=o[a-r*4],d=o[a]):(f=o[a-r*4],d=o[a+r*4]),e[a+0]=c-u+127,n?e[a+1]=d-f+127:e[a+1]=f-d+127,e[a+2]=255,e[a+3]=255}return e}const vMe=t=>(t==null?void 0:t.complete)&&t.naturalHeight!==0;function xMe({_key:t,_ref:e,type:n="standard",normalMap:r,displacementMap:i,normalScale:s=[1,1],displacementScale:o=1,...a}){var l,c;const u=`mesh${n.charAt(0).toUpperCase()}${n.slice(1)}Material`,f=rs(ns,i||[]);f&&(f.colorSpace=ss);const d=(l=f.image)==null?void 0:l.width,h=(c=f.image)==null?void 0:c.height,p=rs(ns,r||[]);p&&(p.colorSpace=ss);const m=v.useMemo(()=>{const w=new Uint8ClampedArray(4*d*h);return w.fill(255),w},[d,h]),g=v.useMemo(()=>{if(r||r===!1)return null;const w=new As(m,d,h);return w.flipY=!0,w.colorSpace=ss,w},[r,d,h]);v.useLayoutEffect(()=>{r||r===!1||vMe(f.image)&&(!g||!g.image||(yMe(f.image,m,g.flipY),g.image={data:m,width:d,height:h},g.colorSpace=ss,g.needsUpdate=!0))},[r,f.image,d,h]);const y=`${t} Height Map`,x=vr(y,{displacementScale:{value:o,render:()=>!!i,options:{min:0,step:.01}},normalScale:{value:s,render:()=>!!i&&r!==!1,options:{min:0,step:.01}}},[i,o,r,s]),_={};return i&&(_.displacementMap=f,_["displacementMap-colorSpace"]=ss),r?_.normalMap=p:i&&(_.normalMap=g),_.normalMap&&(_.normalMapType=du,_["normalMap-colorSpace"]=ss),H.jsx(u,{ref:e,attach:"material",..._,...x,...a},t)}function Vi({_ref:t,_key:e="Box",geometry:n,hide:r,args:i,materialType:s="basic",material:{map:o,mapRepeat:a,displacementMap:l,normalMap:c,...u}={},outlines:f,...d}){const h=v.useRef(),p=t||h,m=Object.keys(u).join(","),g=v.useRef(1);v.useLayoutEffect(()=>{g.current+=1},[s,m]);const y=rs(ns,o||[]);return o&&a&&(y.wrapS=y.wrapT=Or,y.repeat.set(...a)),r?null:H.jsxs("mesh",{ref:p,...d,children:[H.jsx(n,{attach:"geometry",args:i}),H.jsx(xMe,{_key:`${g.current}`,type:s,displacementMap:l,normalMap:c,normalScale:[1,1],displacementScale:1,map:o&&y,...u}),f?H.jsx(hC,{...f}):null]},e)}function vq(t){return H.jsx(Vi,{geometry:"boxGeometry",...t})}function xq(t){return H.jsx(Vi,{geometry:"capsuleGeometry",...t})}function _q(t){return H.jsx(Vi,{geometry:"circleGeometry",...t})}function bq(t){return H.jsx(Vi,{geometry:"coneGeometry",...t})}function Eq(t){return H.jsx(Vi,{geometry:"cylinderGeometry",...t})}function wq(t){return H.jsx(Vi,{geometry:"dodecahedronGeometry",...t})}function Sq(t){return H.jsx(Vi,{geometry:"edgesGeometry",...t})}function Tq(t){return H.jsx(Vi,{geometry:"extrudeGeometry",...t})}function Aq(t){return H.jsx(Vi,{geometry:"icosahedronGeometry",...t})}function Mq(t){return H.jsx(Vi,{geometry:"latheGeometry",...t})}function Cq(t){return H.jsx(Vi,{geometry:"octahedronGeometry",...t})}function Rq(t){return H.jsx(Vi,{geometry:"planeGeometry",...t})}function Iq(t){return H.jsx(Vi,{geometry:"polyhedronGeometry",...t})}function Pq(t){return H.jsx(Vi,{geometry:"ringGeometry",...t})}function kq(t){return H.jsx(Vi,{geometry:"shapeGeometry",...t})}function Lq(t){return H.jsx(Vi,{geometry:"sphereGeometry",...t})}function Dq(t){return H.jsx(Vi,{geometry:"tetrahedronGeometry",...t})}function Nq(t){return H.jsx(Vi,{geometry:"torusGeometry",...t})}function Oq(t){return H.jsx(Vi,{geometry:"torusKnotGeometry",...t})}function Fq(t){return H.jsx(Vi,{geometry:"tubeGeometry",...t})}function Uq(t){return H.jsx(Vi,{geometry:"wireframeGeometry",...t})}const ph=({_ref:t,_key:e,matrix:n,...r})=>{const i=v.useRef(null),s=t||i;return v.useLayoutEffect(()=>{const o=s.current;if(o)return n&&(o.matrix.fromArray(n),o.matrixAutoUpdate=!1),()=>{o.matrixAutoUpdate=!0}},[n,s.current]),H.jsx("group",{ref:s,...r},e)};function G8({_ref:t,color:e,pinchWidth:n=.07,opacity:r=.9,hide:i,...s}){const o=v.useRef(),a=t||o;return i?null:H.jsxs(ph,{_ref:a,scale:1,...s,children:[H.jsxs("mesh",{position:[0,.07,0],rotation:[Math.PI/2,0,0],scale:[1,1,1],children:[H.jsx("cylinderGeometry",{attach:"geometry",args:[.005,.005,n*2,32]}),H.jsx("meshBasicMaterial",{color:e||"#ffffff",transparent:!0,opacity:r})]}),H.jsxs("mesh",{position:[0,.02,n],scale:1,children:[H.jsx("cylinderGeometry",{attach:"geometry",args:[.005,.005,.1,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#23aaff",transparent:!0,opacity:r})]}),H.jsxs("mesh",{position:[0,.02,-n],scale:1,children:[H.jsx("cylinderGeometry",{attach:"geometry",args:[.005,.005,.1,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#ff5656",transparent:!0,opacity:r})]}),H.jsxs("mesh",{position:[0,.09,0],rotation:[0,0,0],scale:[.8,1,1],children:[H.jsx("cylinderGeometry",{attach:"geometry",args:[.01,.01,.06,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"gray",transparent:!0,opacity:r})]}),H.jsxs("mesh",{position:[0,0,0],rotation:[0,0,0],children:[H.jsx("sphereGeometry",{attach:"geometry",args:[.01,32,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"green",transparent:!0,opacity:r})]})]})}class _Me extends Tm{constructor(e,n){super(),this.reducers=this.fuse(this.reducers,e.reducers),this.reducers=this.fuse(this.reducers,n.reducers),this.subscribers=this.fuse(this.subscribers,e.subscribers),this.subscribers=this.fuse(this.subscribers,n.subscribers)}fuse(e,n){const r={...e};return Object.keys(n).forEach(i=>{if(!r[i])return r[i]={...n[i]};Object.keys(n[i]).forEach(s=>{if(!r[i][s])return r[i][s]=n[i][s];r[i][s]=n[i][s]})}),r}}class bMe extends Tm{constructor(e,n){super(),e.subscribe("*",r=>this.publish(r)),n.subscribe("*",r=>this.publish(r))}}class Bq{constructor(){tn(this,"listeners"),this.listeners={}}on(e,n){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(n),()=>{this.off(e,n)}}off(e,n){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(r=>r!==n))}emit(e,n){this.listeners[e]&&this.listeners[e].forEach(r=>r(n))}}function zq(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{e(r.result)},r.onerror=i=>{n(i)},r.readAsDataURL(t)})}var Hq={};(function(t){var e=vO&&vO.__assign||function(){return e=Object.assign||function(p){for(var m,g=1,y=arguments.length;g<y;g++){m=arguments[g];for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(p[x]=m[x])}return p},e.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n;(function(p){p.Browser="browser",p.Server="server",p.Native="native"})(n=t.Device||(t.Device={}));var r=n.Browser,i=n.Server,s=n.Native,o=!!(typeof window<"u"&&window.document&&window.document.createElement),a=typeof navigator<"u"&&navigator.product=="ReactNative",l=a?s:o?r:i,c={isBrowser:l===r,isServer:l===i,isNative:l===s,device:l,canUseWorkers:typeof Worker<"u",canUseEventListeners:l===r&&!!window.addEventListener,canUseViewport:l===r&&!!window.screen},u=function(){for(var p=[],m=0;m<arguments.length;m++)p[m]=arguments[m];return p.reduce(function(g,y){return e(e({},g),y)},{})},f=function(p){return Object.keys(p).map(function(m){return p[m]})},d=function(){return u((f(c),c))},h=d();t.weAreServer=function(){c.isServer=!0,h=d()},t.useSSR=function(){return h},t.default=t.useSSR})(Hq);const Gq=mu(Hq);var UE={};Object.defineProperty(UE,"__esModule",{value:!0});var w1=Ge;UE.isObject=function(t){return Object.prototype.toString.call(t)==="[object Object]"};var EMe=function(){var t=w1.useRef(!1);return w1.useEffect(function(){return t.current=!0,function(){t.current=!1}},[]),t};function jq(t,e){e===void 0&&(e=!0);var n=EMe(),r=w1.useState(t),i=r[0],s=r[1],o=w1.useRef(i),a=w1.useCallback(function(l){!n.current&&e||(o.current=typeof l=="function"?l(o.current):l,s(o.current))},[]);return[o,a]}UE.useRefState=jq;var wMe=UE.default=jq,eo;(function(t){t.DELETE="DELETE",t.GET="GET",t.HEAD="HEAD",t.OPTIONS="OPTIONS",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.CONNECT="CONNECT",t.TRACE="TRACE"})(eo||(eo={}));var Mm;(function(t){t.CACHE_FIRST="cache-first",t.CACHE_AND_NETWORK="cache-and-network",t.NETWORK_ONLY="network-only",t.CACHE_ONLY="cache-only",t.NO_CACHE="no-cache",t.EXACT_CACHE_AND_NETWORK="exact-cache-and-network"})(Mm||(Mm={}));var j8=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})},V8=function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},SMe=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r};function za(t,e,n,r,i,s,o,a){if(n===void 0&&(n=""),r===void 0&&(r=""),i===void 0&&(i=""),s===void 0&&(s=""),o===void 0&&(o=""),a===void 0&&(a=""),!t){var l=void 0;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,s,o,a],u=0;l=new Error(e.replace(/%s/g,function(){return c[u++]})),l.name="Invariant Violation"}throw l}}var S1=function(t){return typeof t=="string"},Qp=function(t){return Object.prototype.toString.call(t)==="[object Object]"},Sp=function(t){return Qp(t)||Array.isArray(t)},Vc=function(t){return typeof t=="function"},TMe=function(t){if(!t)return{};var e=["body","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];return e.reduce(function(n,r){return r in t&&(n[r]=t[r]),n},{})},lF=function(t){return t==null},ty;(function(t){t.Browser="browser",t.Server="server",t.Native="native"})(ty||(ty={}));var AMe=ty.Browser,Vq=ty.Server,MMe=ty.Native,CMe=!!(typeof window<"u"&&window.document&&window.document.createElement),RMe=typeof navigator<"u"&&navigator.product==="ReactNative",IMe=RMe?MMe:CMe?AMe:Vq,cF=IMe===Vq,PMe=function(t,e,n){return j8(void 0,void 0,void 0,function(){var r,i;return V8(this,function(s){switch(s.label){case 0:if(typeof t>"u")throw Error("Response cannot be undefined... ");if(typeof n>"u")throw Error("responseType cannot be undefined... ");if(r=Array.isArray(n)?n:[n],r[0]==null)throw Error("could not parse data from response ");return[4,Wq(t,r)];case 1:return i=s.sent(),[2,!lF(e)&&lF(i)?e:i]}})})},Wq=function(t,e,n){return n===void 0&&(n=0),j8(void 0,void 0,void 0,function(){var r;return V8(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t.clone()[e[n]]()];case 1:return[2,i.sent()];case 2:if(r=i.sent(),e.length-1===n)throw r;return[2,Wq(t.clone(),e,++n)];case 3:return[2]}})})},$q=["headers","ok","redirected","trailer","status","statusText","type","url","body","bodyUsed","data"],Xq=["clone","arrayBuffer","blob","formData","json","text"],kMe=SMe($q,Xq),qq=function(t,e){return Object.defineProperties({},kMe.reduce(function(n,r){return $q.includes(r)?n[r]={get:function(){var i=t instanceof Response?t:t&&t.current;if(i){if(r==="data")return e.current;var s="clone"in i?i.clone():{};return s[r]}},enumerable:!0}:Xq.includes(r)&&(n[r]={value:function(){var i=t instanceof Response?t:t&&t.current;if(i){var s="clone"in i?i.clone():{};return s[r]()}},enumerable:!0}),n},{}))};qq();var LMe=function(t){var e={};return t.forEach(function(n,r){e[r]=n}),e},DMe=function(t){return j8(void 0,void 0,void 0,function(){var e,n,r,i;return V8(this,function(s){switch(s.label){case 0:return[4,t.text()];case 1:return e=s.sent(),n=t.status,r=t.statusText,i=LMe(t.headers),[2,{body:e,status:n,statusText:r,headers:i}]}})})};function NMe(t){var e=v.useRef();return JSON.stringify(t)!==JSON.stringify(e.current)&&(e.current=t),e.current}var OMe=function(t,e){return v.useCallback(t,NMe(e))},FMe=function(t){return new Promise(function(e){return setTimeout(e,t)})},UMe=function(t){return Number.isInteger(t)&&t>0},uF=function(t,e){var n=new Error(e);return n.name=t+"",n},fF=function(t,e){return t?e?e.endsWith("/")&&t.startsWith("/")?t.substr(1):!e.endsWith("/")&&!t.startsWith("/")&&!t.startsWith("?")&&!t.startsWith("&")&&!e.includes("?")?"/"+t:t:t.startsWith("?")||t.startsWith("&")||t.startsWith("/")?t:"/"+t:""},BMe=v.createContext({url:"",options:{},graphql:!1}),Jp=function(){return Jp=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Jp.apply(this,arguments)},Yq={host:"",path:void 0,customOptions:{cacheLife:0,cachePolicy:Mm.CACHE_FIRST,interceptors:{},onAbort:function(){},onError:function(){},onNewData:function(t,e){return e},onTimeout:function(){},perPage:0,persist:!1,responseType:["json","text","blob","arrayBuffer"],retries:0,retryDelay:1e3,retryOn:[],suspense:!1,timeout:0,data:void 0,loading:!1},requestInit:{headers:{Accept:"application/json, text/plain, */*"}},dependencies:void 0};const Pg=Object.entries(Yq).reduce(function(t,e){var n,r=e[0],i=e[1];return Qp(i)?Jp(Jp({},t),i):Jp(Jp({},t),(n={},n[r]=i,n))},{});var zo=function(){return zo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},zo.apply(this,arguments)};function zMe(t,e,n){za(!(Qp(t)&&Qp(e)),"You cannot have a 2nd parameter of useFetch as object when your first argument is an object.");var r=v.useContext(BMe),i=v.useMemo(function(){var x=t;return S1(x)&&x.includes("://")?x:r.url?r.url:Pg.host},[r.url,t]),s=v.useMemo(function(){var x=t;if(S1(x)&&!x.includes("://"))return x},[t]),o=v.useMemo(function(){if(Vc(t))return t;if(Vc(e))return e},[]),a=v.useMemo(function(){var x={headers:{}};Qp(t)?x=t:Qp(e)&&(x=e);var _=r.options,w=zo(zo(zo(zo({},Pg),_),x),{headers:zo(zo(zo({},Pg.headers),_.headers),x.headers),interceptors:zo(zo(zo({},Pg.interceptors),_.interceptors),x.interceptors)});return o?o(w):w},[t,o,r.options]),l=v.useMemo(function(){return TMe(a)},[a]),c=v.useMemo(function(){return Array.isArray(e)?e:Array.isArray(n)?n:Pg.dependencies},[e,n]),u=a.cacheLife,f=a.retries,d=a.retryDelay,h=a.retryOn;za(Number.isInteger(u)&&u>=0,"`cacheLife` must be a number >= 0"),za(Number.isInteger(f)&&f>=0,"`retries` must be a number >= 0"),za(Vc(d)||Number.isInteger(d)&&d>=0,"`retryDelay` must be a positive number or a function returning a positive number.");var p=Vc(h)||Array.isArray(h)&&h.every(UMe);za(p,"`retryOn` must be an array of positive numbers or a function returning a boolean.");var m=a.loading||Array.isArray(c),g=v.useMemo(function(){var x={};return"request"in a.interceptors&&(x.request=a.interceptors.request),"response"in a.interceptors&&(x.response=a.interceptors.response),x},[a]),y=v.useMemo(function(){var x=Object.keys(Yq.customOptions),_=x.reduce(function(w,T){return w[T]=a[T],w},{});return zo(zo({},_),{interceptors:g,loading:m})},[g,m]);return{host:i,path:s,customOptions:y,requestInit:l,dependencies:c}}var T1=function(){return T1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},T1.apply(this,arguments)},dF=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})},hF=function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},pF=eo.GET;function HMe(t,e,n,r,i,s,o,a,l,c){return dF(this,void 0,void 0,function(){var u,f,d,h,p,m,g,y,x=this;return hF(this,function(_){switch(_.label){case 0:return za(!(Sp(a)&&Sp(l)),"If first argument of "+e.toLowerCase()+"() is an object, you cannot have a 2nd argument. "),za(!(e===pF&&Sp(a)),"You can only have query params as 1st argument of request.get()"),za(!(e===pF&&l!==void 0),"You can only have query params as 1st argument of request.get()"),u=function(){return!cF&&a instanceof URLSearchParams?"?"+a:S1(a)?a:""}(),f=""+s+fF(o,s)+fF(u),d=function(){return a instanceof FormData?a:Sp(a)?JSON.stringify(a):!cF&&(l instanceof FormData||l instanceof URLSearchParams)?l:Sp(l)||S1(l)?JSON.stringify(l):Sp(t.body)||S1(l)?JSON.stringify(t.body):null}(),h=function(){var w=(t.headers||{})["Content-Type"],T=!!w||[eo.POST,eo.PUT,eo.PATCH].includes(e)&&!(d instanceof FormData),S=T1({},t.headers);if(T)S["Content-Type"]=w||"application/json";else if(Object.keys(S).length===0)return null;return S}(),[4,function(){return dF(x,void 0,void 0,function(){var w,T;return hF(this,function(S){switch(S.label){case 0:return w=T1(T1({},t),{method:e,signal:n.signal}),h!==null?w.headers=h:delete w.headers,d!==null&&(w.body=d),c?[4,c({options:w,url:s,path:o,route:u})]:[3,2];case 1:return T=S.sent(),[2,T];case 2:return[2,w]}})})}()];case 1:return p=_.sent(),m=Object.entries({url:f,method:e,body:p.body||""}).map(function(w){var T=w[0],S=w[1];return T+":"+S}).join("||"),g={url:f,options:p},y={},[4,i.has(m)];case 2:return y.isCached=_.sent(),y.id=m,[4,i.get(m)];case 3:return[2,(g.response=(y.cached=_.sent(),y),g)]}})})}var kg=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})},Lg=function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},A1="useHTTPcache",Dg=function(){try{return JSON.parse(localStorage.getItem(A1)||"{}")}catch{return localStorage.removeItem(A1),{}}},GMe=function(t){var e=t.cacheLife,n=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return kg(void 0,void 0,void 0,function(){var u;return Lg(this,function(f){return u=Dg(),l.forEach(function(d){return delete u[d]}),localStorage.setItem(A1,JSON.stringify(u)),[2]})})},r=function(l){var c=Dg(),u=c[l]||{},f=u.expiration,d=u.response,h=f>0&&f<Date.now();return h&&n(l),h||!d},i=function(l){return kg(void 0,void 0,void 0,function(){return Lg(this,function(c){return[2,!r(l)]})})},s=function(l){return kg(void 0,void 0,void 0,function(){var c,u,f,d,h,p;return Lg(this,function(m){return r(l)?[2]:(c=Dg(),u=c[l].response,f=u.body,d=u.headers,h=u.status,p=u.statusText,[2,new Response(f,{status:h,statusText:p,headers:new Headers(d||{})})])})})},o=function(l,c){return kg(void 0,void 0,void 0,function(){var u,f,d,h;return Lg(this,function(p){switch(p.label){case 0:return u=Dg(),f=u,d=l,h={},[4,DMe(c)];case 1:return f[d]=(h.response=p.sent(),h.expiration=Date.now()+e,h),localStorage.setItem(A1,JSON.stringify(u)),[2]}})})},a=function(){return kg(void 0,void 0,void 0,function(){return Lg(this,function(l){return localStorage.setItem(A1,JSON.stringify({})),[2]})})};return Object.defineProperties(Dg(),{get:{value:s,writable:!1},set:{value:o,writable:!1},has:{value:i,writable:!1},delete:{value:n,writable:!1},clear:{value:a,writable:!1}})},Ng=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})},Og=function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},Ic={},jMe=function(t){var e=t.cacheLife,n=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return Ng(void 0,void 0,void 0,function(){var u,f,d;return Og(this,function(h){for(u=0,f=l;u<f.length;u++)d=f[u],delete Ic[d],delete Ic[d+":ts"];return[2]})})},r=function(l){var c=Ic[l+":ts"],u=c>0&&c<Date.now();return u&&n(l),u||!Ic[l]},i=function(l){return Ng(void 0,void 0,void 0,function(){return Og(this,function(c){return r(l)?[2]:[2,Ic[l]]})})},s=function(l,c){return Ng(void 0,void 0,void 0,function(){return Og(this,function(u){return Ic[l]=c,Ic[l+":ts"]=e>0?Date.now()+e:0,[2]})})},o=function(l){return Ng(void 0,void 0,void 0,function(){return Og(this,function(c){return[2,!r(l)]})})},a=function(){return Ng(void 0,void 0,void 0,function(){return Og(this,function(l){return Ic={},[2]})})};return Object.defineProperties(Ic,{get:{value:i,writable:!1,configurable:!0},set:{value:s,writable:!1,configurable:!0},has:{value:o,writable:!1,configurable:!0},delete:{value:n,writable:!1,configurable:!0},clear:{value:a,writable:!1,configurable:!0}})},VMe=Mm.NETWORK_ONLY,WMe=Mm.NO_CACHE,$Me=function(t){var e=t.persist,n=t.cacheLife,r=t.cachePolicy,i=Gq(),s=i.isNative,o=i.isServer;return za(!(o&&e),"There is no persistent storage on the Server currently! "),za(!(s&&e),"React Native support for persistent cache is not yet implemented. "),za(!(e&&[WMe,VMe].includes(r)),"You cannot use option 'persist' with cachePolicy: "+r+" "),e?GMe({cacheLife:n||24*36e5}):jMe({cacheLife:n})},G_=function(){return G_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},G_.apply(this,arguments)},JT=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})},eA=function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},XMe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},mF=Mm.CACHE_FIRST;function qMe(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=zMe.apply(void 0,e),i=r.host,s=r.path,o=r.customOptions,a=r.requestInit,l=r.dependencies,c=o.cacheLife,u=o.cachePolicy,f=o.interceptors,d=o.onAbort,h=o.onError,p=o.onNewData,m=o.onTimeout,g=o.perPage,y=o.persist,x=o.responseType,_=o.retries,w=o.retryDelay,T=o.retryOn,S=o.suspense,C=o.timeout,A=XMe(o,["cacheLife","cachePolicy","interceptors","onAbort","onError","onNewData","onTimeout","perPage","persist","responseType","retries","retryDelay","retryOn","suspense","timeout"]),R=$Me({persist:y,cacheLife:c,cachePolicy:u}),M=Gq().isServer,D=v.useRef(),k=v.useRef({}),L=v.useRef(A.data),N=v.useRef(!1),z=v.useRef(0),O=v.useRef(),K=v.useRef(!0),V=v.useRef("pending"),ne=v.useRef(),re=v.useRef(!1),P=wMe(A.loading),se=P[0],ue=P[1],te=v.useReducer(function(){return{}},[])[1],W=OMe(function(me){var Te=function(Re,ae){return JT(t,void 0,void 0,function(){var Ce,Pe,Ve,ye,ge,ze,fe,ie,ve,Me,Z,q,Be,Ze,De,F,Z,q,xe,be,De;return eA(this,function($e){switch($e.label){case 0:return M?[2]:(D.current=new AbortController,D.current.signal.onabort=d,Ce=D.current,[4,HMe(a,me,Ce,c,R,i,s,Re,ae,f.request)]);case 1:if(Pe=$e.sent(),Ve=Pe.url,ye=Pe.options,ge=Pe.response,O.current=void 0,g>0&&!K.current&&!O.current)return[2,L.current];S||ue(!0),ze=C&&setTimeout(function(){N.current=!0,Ce.abort(),m&&m()},C),$e.label=2;case 2:return $e.trys.push([2,17,23,24]),ge.isCached&&u===mF?(ie=ge.cached,[3,5]):[3,3];case 3:return[4,fetch(Ve,ye)];case 4:ie=$e.sent().clone(),$e.label=5;case 5:return k.current=ie.clone(),[4,PMe(ie,A.data,x)];case 6:return fe=$e.sent(),k.current.data=p(L.current,fe),ve=k,f.response?[4,f.response({response:k.current,request:a})]:[3,8];case 7:return Me=$e.sent(),[3,9];case 8:Me=k.current,$e.label=9;case 9:return ve.current=Me,za("data"in k.current,"You must have `data` field on the Response returned from your `interceptors.response`"),L.current=k.current.data,Z={attempt:z.current,response:ie},Be=!Vc(T)&&Array.isArray(T)&&T.length<1&&(ie==null?void 0:ie.ok)===!1||Array.isArray(T)&&T.includes(ie.status),Be?[3,12]:(Ze=Vc(T),Ze?[4,T(Z)]:[3,11]);case 10:Ze=$e.sent(),$e.label=11;case 11:Be=Ze,$e.label=12;case 12:return q=Be&&_>0&&_>z.current,q?[4,_e(Z,Re,ae)]:[3,14];case 13:return De=$e.sent(),[2,De];case 14:return u===mF&&!ge.isCached?[4,R.set(ge.id,ie.clone())]:[3,16];case 15:$e.sent(),$e.label=16;case 16:return Array.isArray(L.current)&&L.current.length%g&&(K.current=!1),[3,24];case 17:return F=$e.sent(),z.current>=_&&N.current&&(O.current=uF("AbortError","Timeout Error")),Z={attempt:z.current,error:F},xe=!Vc(T)&&Array.isArray(T)&&T.length<1,xe?[3,20]:(be=Vc(T),be?[4,T(Z)]:[3,19]);case 18:be=$e.sent(),$e.label=19;case 19:xe=be,$e.label=20;case 20:return q=xe&&_>0&&_>z.current,q?[4,_e(Z,Re,ae)]:[3,22];case 21:return De=$e.sent(),[2,De];case 22:return F.name!=="AbortError"&&(O.current=F),[3,24];case 23:return N.current=!1,ze&&clearTimeout(ze),D.current=void 0,[7];case 24:return ie&&!ie.ok&&!O.current&&(O.current=uF(ie.status,ie.statusText)),S||ue(!1),z.current===_&&(z.current=0),O.current&&h({error:O.current}),[2,L.current]}})})},_e=function(Re,ae,Ce){return JT(t,void 0,void 0,function(){var Pe,Ve;return eA(this,function(ye){switch(ye.label){case 0:return Pe=Vc(w)?w(Re):w,Number.isInteger(Pe)&&Pe>=0||console.error("retryDelay must be a number >= 0! If you're using it as a function, it must also return a number >= 0."),z.current++,Pe?[4,FMe(Pe)]:[3,2];case 1:ye.sent(),ye.label=2;case 2:return[4,Te(ae,Ce)];case 3:return Ve=ye.sent(),[2,Ve]}})})};return S?function(){for(var Re=[],ae=0;ae<arguments.length;ae++)Re[ae]=arguments[ae];return JT(t,void 0,void 0,function(){var Ce;return eA(this,function(Pe){switch(Pe.label){case 0:return ne.current=Te.apply(void 0,Re).then(function(Ve){return V.current="success",Ve},function(){V.current="error"}),te(),[4,ne.current];case 1:return Ce=Pe.sent(),[2,Ce]}})})}:Te},[M,d,a,i,s,f,u,g,C,y,c,m,A.data,p,te,S]),X=v.useCallback(W(eo.POST),[W]),J=v.useCallback(W(eo.DELETE),[W]),oe=v.useMemo(function(){return Object.defineProperties({get:W(eo.GET),post:X,patch:W(eo.PATCH),put:W(eo.PUT),options:W(eo.OPTIONS),head:W(eo.HEAD),connect:W(eo.CONNECT),trace:W(eo.TRACE),del:J,delete:J,abort:function(){return D.current&&D.current.abort()},query:function(me,Te){return X({query:me,variables:Te})},mutate:function(me,Te){return X({mutation:me,variables:Te})},cache:R},{loading:{get:function(){return se.current}},error:{get:function(){return O.current}},data:{get:function(){return L.current}}})},[W]),Ee=v.useMemo(function(){return qq(k,L)},[]);if(v.useEffect(function(){if(re.current=!0,Array.isArray(l)){var me=a.method||eo.GET,Te=me.toLowerCase(),_e=oe[Te];_e()}return function(){return re.current=!1}},l),v.useEffect(function(){return oe.abort},[]),S&&ne.current){if(M)throw new Error("Suspense on server side is not yet supported! ");switch(V.current){case"pending":throw ne.current;case"error":throw O.current}}return Object.assign([oe,Ee,se.current,O.current],G_(G_({request:oe,response:Ee},oe),{loading:se.current,data:L.current,error:O.current}))}/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function Kq(t){return typeof t>"u"||t===null}function YMe(t){return typeof t=="object"&&t!==null}function KMe(t){return Array.isArray(t)?t:Kq(t)?[]:[t]}function ZMe(t,e){var n,r,i,s;if(e)for(s=Object.keys(e),n=0,r=s.length;n<r;n+=1)i=s[n],t[i]=e[i];return t}function QMe(t,e){var n="",r;for(r=0;r<e;r+=1)n+=t;return n}function JMe(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}var e6e=Kq,t6e=YMe,n6e=KMe,r6e=QMe,i6e=JMe,s6e=ZMe,os={isNothing:e6e,isObject:t6e,toArray:n6e,repeat:r6e,isNegativeZero:i6e,extend:s6e};function Zq(t,e){var n="",r=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(n+='in "'+t.mark.name+'" '),n+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(n+=`

`+t.mark.snippet),r+" "+n):r}function ny(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=Zq(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ny.prototype=Object.create(Error.prototype);ny.prototype.constructor=ny;ny.prototype.toString=function(t){return this.name+": "+Zq(this,t)};var To=ny;function tA(t,e,n,r,i){var s="",o="",a=Math.floor(i/2)-1;return r-e>a&&(s=" ... ",e=r-a+s.length),n-r>a&&(o=" ...",n=r+a-o.length),{str:s+t.slice(e,n).replace(/\t/g,"")+o,pos:r-e+s.length}}function nA(t,e){return os.repeat(" ",e-t.length)+t}function o6e(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],i=[],s,o=-1;s=n.exec(t.buffer);)i.push(s.index),r.push(s.index+s[0].length),t.position<=s.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var a="",l,c,u=Math.min(t.line+e.linesAfter,i.length).toString().length,f=e.maxLength-(e.indent+u+3);for(l=1;l<=e.linesBefore&&!(o-l<0);l++)c=tA(t.buffer,r[o-l],i[o-l],t.position-(r[o]-r[o-l]),f),a=os.repeat(" ",e.indent)+nA((t.line-l+1).toString(),u)+" | "+c.str+`
`+a;for(c=tA(t.buffer,r[o],i[o],t.position,f),a+=os.repeat(" ",e.indent)+nA((t.line+1).toString(),u)+" | "+c.str+`
`,a+=os.repeat("-",e.indent+u+3+c.pos)+`^
`,l=1;l<=e.linesAfter&&!(o+l>=i.length);l++)c=tA(t.buffer,r[o+l],i[o+l],t.position-(r[o]-r[o+l]),f),a+=os.repeat(" ",e.indent)+nA((t.line+l+1).toString(),u)+" | "+c.str+`
`;return a.replace(/\n$/,"")}var a6e=o6e,l6e=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],c6e=["scalar","sequence","mapping"];function u6e(t){var e={};return t!==null&&Object.keys(t).forEach(function(n){t[n].forEach(function(r){e[String(r)]=n})}),e}function f6e(t,e){if(e=e||{},Object.keys(e).forEach(function(n){if(l6e.indexOf(n)===-1)throw new To('Unknown option "'+n+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(n){return n},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=u6e(e.styleAliases||null),c6e.indexOf(this.kind)===-1)throw new To('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}var js=f6e;function gF(t,e){var n=[];return t[e].forEach(function(r){var i=n.length;n.forEach(function(s,o){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(i=o)}),n[i]=r}),n}function d6e(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,n;function r(i){i.multi?(t.multi[i.kind].push(i),t.multi.fallback.push(i)):t[i.kind][i.tag]=t.fallback[i.tag]=i}for(e=0,n=arguments.length;e<n;e+=1)arguments[e].forEach(r);return t}function bM(t){return this.extend(t)}bM.prototype.extend=function(t){var e=[],n=[];if(t instanceof js)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(e=e.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new To("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.forEach(function(i){if(!(i instanceof js))throw new To("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new To("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new To("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(i){if(!(i instanceof js))throw new To("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(bM.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=gF(r,"implicit"),r.compiledExplicit=gF(r,"explicit"),r.compiledTypeMap=d6e(r.compiledImplicit,r.compiledExplicit),r};var Qq=bM,Jq=new js("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return t!==null?t:""}}),eY=new js("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return t!==null?t:[]}}),tY=new js("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return t!==null?t:{}}}),nY=new Qq({explicit:[Jq,eY,tY]});function h6e(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}function p6e(){return null}function m6e(t){return t===null}var rY=new js("tag:yaml.org,2002:null",{kind:"scalar",resolve:h6e,construct:p6e,predicate:m6e,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function g6e(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}function y6e(t){return t==="true"||t==="True"||t==="TRUE"}function v6e(t){return Object.prototype.toString.call(t)==="[object Boolean]"}var iY=new js("tag:yaml.org,2002:bool",{kind:"scalar",resolve:g6e,construct:y6e,predicate:v6e,represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function x6e(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function _6e(t){return 48<=t&&t<=55}function b6e(t){return 48<=t&&t<=57}function E6e(t){if(t===null)return!1;var e=t.length,n=0,r=!1,i;if(!e)return!1;if(i=t[n],(i==="-"||i==="+")&&(i=t[++n]),i==="0"){if(n+1===e)return!0;if(i=t[++n],i==="b"){for(n++;n<e;n++)if(i=t[n],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(n++;n<e;n++)if(i=t[n],i!=="_"){if(!x6e(t.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}if(i==="o"){for(n++;n<e;n++)if(i=t[n],i!=="_"){if(!_6e(t.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}}if(i==="_")return!1;for(;n<e;n++)if(i=t[n],i!=="_"){if(!b6e(t.charCodeAt(n)))return!1;r=!0}return!(!r||i==="_")}function w6e(t){var e=t,n=1,r;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),r=e[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),e=e.slice(1),r=e[0]),e==="0")return 0;if(r==="0"){if(e[1]==="b")return n*parseInt(e.slice(2),2);if(e[1]==="x")return n*parseInt(e.slice(2),16);if(e[1]==="o")return n*parseInt(e.slice(2),8)}return n*parseInt(e,10)}function S6e(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!os.isNegativeZero(t)}var sY=new js("tag:yaml.org,2002:int",{kind:"scalar",resolve:E6e,construct:w6e,predicate:S6e,represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),T6e=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function A6e(t){return!(t===null||!T6e.test(t)||t[t.length-1]==="_")}function M6e(t){var e,n;return e=t.replace(/_/g,"").toLowerCase(),n=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:n*parseFloat(e,10)}var C6e=/^[-+]?[0-9]+e/;function R6e(t,e){var n;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(os.isNegativeZero(t))return"-0.0";return n=t.toString(10),C6e.test(n)?n.replace("e",".e"):n}function I6e(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||os.isNegativeZero(t))}var oY=new js("tag:yaml.org,2002:float",{kind:"scalar",resolve:A6e,construct:M6e,predicate:I6e,represent:R6e,defaultStyle:"lowercase"}),aY=nY.extend({implicit:[rY,iY,sY,oY]}),lY=aY,cY=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),uY=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function P6e(t){return t===null?!1:cY.exec(t)!==null||uY.exec(t)!==null}function k6e(t){var e,n,r,i,s,o,a,l=0,c=null,u,f,d;if(e=cY.exec(t),e===null&&(e=uY.exec(t)),e===null)throw new Error("Date resolve error");if(n=+e[1],r=+e[2]-1,i=+e[3],!e[4])return new Date(Date.UTC(n,r,i));if(s=+e[4],o=+e[5],a=+e[6],e[7]){for(l=e[7].slice(0,3);l.length<3;)l+="0";l=+l}return e[9]&&(u=+e[10],f=+(e[11]||0),c=(u*60+f)*6e4,e[9]==="-"&&(c=-c)),d=new Date(Date.UTC(n,r,i,s,o,a,l)),c&&d.setTime(d.getTime()-c),d}function L6e(t){return t.toISOString()}var fY=new js("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:P6e,construct:k6e,instanceOf:Date,represent:L6e});function D6e(t){return t==="<<"||t===null}var dY=new js("tag:yaml.org,2002:merge",{kind:"scalar",resolve:D6e}),W8=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function N6e(t){if(t===null)return!1;var e,n,r=0,i=t.length,s=W8;for(n=0;n<i;n++)if(e=s.indexOf(t.charAt(n)),!(e>64)){if(e<0)return!1;r+=6}return r%8===0}function O6e(t){var e,n,r=t.replace(/[\r\n=]/g,""),i=r.length,s=W8,o=0,a=[];for(e=0;e<i;e++)e%4===0&&e&&(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)),o=o<<6|s.indexOf(r.charAt(e));return n=i%4*6,n===0?(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)):n===18?(a.push(o>>10&255),a.push(o>>2&255)):n===12&&a.push(o>>4&255),new Uint8Array(a)}function F6e(t){var e="",n=0,r,i,s=t.length,o=W8;for(r=0;r<s;r++)r%3===0&&r&&(e+=o[n>>18&63],e+=o[n>>12&63],e+=o[n>>6&63],e+=o[n&63]),n=(n<<8)+t[r];return i=s%3,i===0?(e+=o[n>>18&63],e+=o[n>>12&63],e+=o[n>>6&63],e+=o[n&63]):i===2?(e+=o[n>>10&63],e+=o[n>>4&63],e+=o[n<<2&63],e+=o[64]):i===1&&(e+=o[n>>2&63],e+=o[n<<4&63],e+=o[64],e+=o[64]),e}function U6e(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}var hY=new js("tag:yaml.org,2002:binary",{kind:"scalar",resolve:N6e,construct:O6e,predicate:U6e,represent:F6e}),B6e=Object.prototype.hasOwnProperty,z6e=Object.prototype.toString;function H6e(t){if(t===null)return!0;var e=[],n,r,i,s,o,a=t;for(n=0,r=a.length;n<r;n+=1){if(i=a[n],o=!1,z6e.call(i)!=="[object Object]")return!1;for(s in i)if(B6e.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}function G6e(t){return t!==null?t:[]}var pY=new js("tag:yaml.org,2002:omap",{kind:"sequence",resolve:H6e,construct:G6e}),j6e=Object.prototype.toString;function V6e(t){if(t===null)return!0;var e,n,r,i,s,o=t;for(s=new Array(o.length),e=0,n=o.length;e<n;e+=1){if(r=o[e],j6e.call(r)!=="[object Object]"||(i=Object.keys(r),i.length!==1))return!1;s[e]=[i[0],r[i[0]]]}return!0}function W6e(t){if(t===null)return[];var e,n,r,i,s,o=t;for(s=new Array(o.length),e=0,n=o.length;e<n;e+=1)r=o[e],i=Object.keys(r),s[e]=[i[0],r[i[0]]];return s}var mY=new js("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:V6e,construct:W6e}),$6e=Object.prototype.hasOwnProperty;function X6e(t){if(t===null)return!0;var e,n=t;for(e in n)if($6e.call(n,e)&&n[e]!==null)return!1;return!0}function q6e(t){return t!==null?t:{}}var gY=new js("tag:yaml.org,2002:set",{kind:"mapping",resolve:X6e,construct:q6e}),$8=lY.extend({implicit:[fY,dY],explicit:[hY,pY,mY,gY]}),bf=Object.prototype.hasOwnProperty,j_=1,yY=2,vY=3,V_=4,rA=1,Y6e=2,yF=3,K6e=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Z6e=/[\x85\u2028\u2029]/,Q6e=/[,\[\]\{\}]/,xY=/^(?:!|!!|![a-z\-]+!)$/i,_Y=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function vF(t){return Object.prototype.toString.call(t)}function ic(t){return t===10||t===13}function Nd(t){return t===9||t===32}function Wo(t){return t===9||t===32||t===10||t===13}function em(t){return t===44||t===91||t===93||t===123||t===125}function J6e(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}function eCe(t){return t===120?2:t===117?4:t===85?8:0}function tCe(t){return 48<=t&&t<=57?t-48:-1}function xF(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"":t===95?"":t===76?"\u2028":t===80?"\u2029":""}function nCe(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}var bY=new Array(256),EY=new Array(256);for(var Tp=0;Tp<256;Tp++)bY[Tp]=xF(Tp)?1:0,EY[Tp]=xF(Tp);function rCe(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||$8,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function wY(t,e){var n={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return n.snippet=a6e(n),new To(e,n)}function Mn(t,e){throw wY(t,e)}function W_(t,e){t.onWarning&&t.onWarning.call(null,wY(t,e))}var _F={YAML:function(t,e,n){var r,i,s;t.version!==null&&Mn(t,"duplication of %YAML directive"),n.length!==1&&Mn(t,"YAML directive accepts exactly one argument"),r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),r===null&&Mn(t,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),s=parseInt(r[2],10),i!==1&&Mn(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=s<2,s!==1&&s!==2&&W_(t,"unsupported YAML version of the document")},TAG:function(t,e,n){var r,i;n.length!==2&&Mn(t,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],xY.test(r)||Mn(t,"ill-formed tag handle (first argument) of the TAG directive"),bf.call(t.tagMap,r)&&Mn(t,'there is a previously declared suffix for "'+r+'" tag handle'),_Y.test(i)||Mn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{Mn(t,"tag prefix is malformed: "+i)}t.tagMap[r]=i}};function cf(t,e,n,r){var i,s,o,a;if(e<n){if(a=t.input.slice(e,n),r)for(i=0,s=a.length;i<s;i+=1)o=a.charCodeAt(i),o===9||32<=o&&o<=1114111||Mn(t,"expected valid JSON character");else K6e.test(a)&&Mn(t,"the stream contains non-printable characters");t.result+=a}}function bF(t,e,n,r){var i,s,o,a;for(os.isObject(n)||Mn(t,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(n),o=0,a=i.length;o<a;o+=1)s=i[o],bf.call(e,s)||(e[s]=n[s],r[s]=!0)}function tm(t,e,n,r,i,s,o,a,l){var c,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),c=0,u=i.length;c<u;c+=1)Array.isArray(i[c])&&Mn(t,"nested arrays are not supported inside keys"),typeof i=="object"&&vF(i[c])==="[object Object]"&&(i[c]="[object Object]");if(typeof i=="object"&&vF(i)==="[object Object]"&&(i="[object Object]"),i=String(i),e===null&&(e={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(c=0,u=s.length;c<u;c+=1)bF(t,e,s[c],n);else bF(t,e,s,n);else!t.json&&!bf.call(n,i)&&bf.call(e,i)&&(t.line=o||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,Mn(t,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(e,i,{configurable:!0,enumerable:!0,writable:!0,value:s}):e[i]=s,delete n[i];return e}function X8(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):Mn(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function Qi(t,e,n){for(var r=0,i=t.input.charCodeAt(t.position);i!==0;){for(;Nd(i);)i===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),i=t.input.charCodeAt(++t.position);if(e&&i===35)do i=t.input.charCodeAt(++t.position);while(i!==10&&i!==13&&i!==0);if(ic(i))for(X8(t),i=t.input.charCodeAt(t.position),r++,t.lineIndent=0;i===32;)t.lineIndent++,i=t.input.charCodeAt(++t.position);else break}return n!==-1&&r!==0&&t.lineIndent<n&&W_(t,"deficient indentation"),r}function BE(t){var e=t.position,n;return n=t.input.charCodeAt(e),!!((n===45||n===46)&&n===t.input.charCodeAt(e+1)&&n===t.input.charCodeAt(e+2)&&(e+=3,n=t.input.charCodeAt(e),n===0||Wo(n)))}function q8(t,e){e===1?t.result+=" ":e>1&&(t.result+=os.repeat(`
`,e-1))}function iCe(t,e,n){var r,i,s,o,a,l,c,u,f=t.kind,d=t.result,h;if(h=t.input.charCodeAt(t.position),Wo(h)||em(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(i=t.input.charCodeAt(t.position+1),Wo(i)||n&&em(i)))return!1;for(t.kind="scalar",t.result="",s=o=t.position,a=!1;h!==0;){if(h===58){if(i=t.input.charCodeAt(t.position+1),Wo(i)||n&&em(i))break}else if(h===35){if(r=t.input.charCodeAt(t.position-1),Wo(r))break}else{if(t.position===t.lineStart&&BE(t)||n&&em(h))break;if(ic(h))if(l=t.line,c=t.lineStart,u=t.lineIndent,Qi(t,!1,-1),t.lineIndent>=e){a=!0,h=t.input.charCodeAt(t.position);continue}else{t.position=o,t.line=l,t.lineStart=c,t.lineIndent=u;break}}a&&(cf(t,s,o,!1),q8(t,t.line-l),s=o=t.position,a=!1),Nd(h)||(o=t.position+1),h=t.input.charCodeAt(++t.position)}return cf(t,s,o,!1),t.result?!0:(t.kind=f,t.result=d,!1)}function sCe(t,e){var n,r,i;if(n=t.input.charCodeAt(t.position),n!==39)return!1;for(t.kind="scalar",t.result="",t.position++,r=i=t.position;(n=t.input.charCodeAt(t.position))!==0;)if(n===39)if(cf(t,r,t.position,!0),n=t.input.charCodeAt(++t.position),n===39)r=t.position,t.position++,i=t.position;else return!0;else ic(n)?(cf(t,r,i,!0),q8(t,Qi(t,!1,e)),r=i=t.position):t.position===t.lineStart&&BE(t)?Mn(t,"unexpected end of the document within a single quoted scalar"):(t.position++,i=t.position);Mn(t,"unexpected end of the stream within a single quoted scalar")}function oCe(t,e){var n,r,i,s,o,a;if(a=t.input.charCodeAt(t.position),a!==34)return!1;for(t.kind="scalar",t.result="",t.position++,n=r=t.position;(a=t.input.charCodeAt(t.position))!==0;){if(a===34)return cf(t,n,t.position,!0),t.position++,!0;if(a===92){if(cf(t,n,t.position,!0),a=t.input.charCodeAt(++t.position),ic(a))Qi(t,!1,e);else if(a<256&&bY[a])t.result+=EY[a],t.position++;else if((o=eCe(a))>0){for(i=o,s=0;i>0;i--)a=t.input.charCodeAt(++t.position),(o=J6e(a))>=0?s=(s<<4)+o:Mn(t,"expected hexadecimal character");t.result+=nCe(s),t.position++}else Mn(t,"unknown escape sequence");n=r=t.position}else ic(a)?(cf(t,n,r,!0),q8(t,Qi(t,!1,e)),n=r=t.position):t.position===t.lineStart&&BE(t)?Mn(t,"unexpected end of the document within a double quoted scalar"):(t.position++,r=t.position)}Mn(t,"unexpected end of the stream within a double quoted scalar")}function aCe(t,e){var n=!0,r,i,s,o=t.tag,a,l=t.anchor,c,u,f,d,h,p=Object.create(null),m,g,y,x;if(x=t.input.charCodeAt(t.position),x===91)u=93,h=!1,a=[];else if(x===123)u=125,h=!0,a={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=a),x=t.input.charCodeAt(++t.position);x!==0;){if(Qi(t,!0,e),x=t.input.charCodeAt(t.position),x===u)return t.position++,t.tag=o,t.anchor=l,t.kind=h?"mapping":"sequence",t.result=a,!0;n?x===44&&Mn(t,"expected the node content, but found ','"):Mn(t,"missed comma between flow collection entries"),g=m=y=null,f=d=!1,x===63&&(c=t.input.charCodeAt(t.position+1),Wo(c)&&(f=d=!0,t.position++,Qi(t,!0,e))),r=t.line,i=t.lineStart,s=t.position,Cm(t,e,j_,!1,!0),g=t.tag,m=t.result,Qi(t,!0,e),x=t.input.charCodeAt(t.position),(d||t.line===r)&&x===58&&(f=!0,x=t.input.charCodeAt(++t.position),Qi(t,!0,e),Cm(t,e,j_,!1,!0),y=t.result),h?tm(t,a,p,g,m,y,r,i,s):f?a.push(tm(t,null,p,g,m,y,r,i,s)):a.push(m),Qi(t,!0,e),x=t.input.charCodeAt(t.position),x===44?(n=!0,x=t.input.charCodeAt(++t.position)):n=!1}Mn(t,"unexpected end of the stream within a flow collection")}function lCe(t,e){var n,r,i=rA,s=!1,o=!1,a=e,l=0,c=!1,u,f;if(f=t.input.charCodeAt(t.position),f===124)r=!1;else if(f===62)r=!0;else return!1;for(t.kind="scalar",t.result="";f!==0;)if(f=t.input.charCodeAt(++t.position),f===43||f===45)rA===i?i=f===43?yF:Y6e:Mn(t,"repeat of a chomping mode identifier");else if((u=tCe(f))>=0)u===0?Mn(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?Mn(t,"repeat of an indentation width identifier"):(a=e+u-1,o=!0);else break;if(Nd(f)){do f=t.input.charCodeAt(++t.position);while(Nd(f));if(f===35)do f=t.input.charCodeAt(++t.position);while(!ic(f)&&f!==0)}for(;f!==0;){for(X8(t),t.lineIndent=0,f=t.input.charCodeAt(t.position);(!o||t.lineIndent<a)&&f===32;)t.lineIndent++,f=t.input.charCodeAt(++t.position);if(!o&&t.lineIndent>a&&(a=t.lineIndent),ic(f)){l++;continue}if(t.lineIndent<a){i===yF?t.result+=os.repeat(`
`,s?1+l:l):i===rA&&s&&(t.result+=`
`);break}for(r?Nd(f)?(c=!0,t.result+=os.repeat(`
`,s?1+l:l)):c?(c=!1,t.result+=os.repeat(`
`,l+1)):l===0?s&&(t.result+=" "):t.result+=os.repeat(`
`,l):t.result+=os.repeat(`
`,s?1+l:l),s=!0,o=!0,l=0,n=t.position;!ic(f)&&f!==0;)f=t.input.charCodeAt(++t.position);cf(t,n,t.position,!1)}return!0}function EF(t,e){var n,r=t.tag,i=t.anchor,s=[],o,a=!1,l;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=s),l=t.input.charCodeAt(t.position);l!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Mn(t,"tab characters must not be used in indentation")),!(l!==45||(o=t.input.charCodeAt(t.position+1),!Wo(o))));){if(a=!0,t.position++,Qi(t,!0,-1)&&t.lineIndent<=e){s.push(null),l=t.input.charCodeAt(t.position);continue}if(n=t.line,Cm(t,e,vY,!1,!0),s.push(t.result),Qi(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===n||t.lineIndent>e)&&l!==0)Mn(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return a?(t.tag=r,t.anchor=i,t.kind="sequence",t.result=s,!0):!1}function cCe(t,e,n){var r,i,s,o,a,l,c=t.tag,u=t.anchor,f={},d=Object.create(null),h=null,p=null,m=null,g=!1,y=!1,x;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=f),x=t.input.charCodeAt(t.position);x!==0;){if(!g&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Mn(t,"tab characters must not be used in indentation")),r=t.input.charCodeAt(t.position+1),s=t.line,(x===63||x===58)&&Wo(r))x===63?(g&&(tm(t,f,d,h,p,null,o,a,l),h=p=m=null),y=!0,g=!0,i=!0):g?(g=!1,i=!0):Mn(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,x=r;else{if(o=t.line,a=t.lineStart,l=t.position,!Cm(t,n,yY,!1,!0))break;if(t.line===s){for(x=t.input.charCodeAt(t.position);Nd(x);)x=t.input.charCodeAt(++t.position);if(x===58)x=t.input.charCodeAt(++t.position),Wo(x)||Mn(t,"a whitespace character is expected after the key-value separator within a block mapping"),g&&(tm(t,f,d,h,p,null,o,a,l),h=p=m=null),y=!0,g=!1,i=!1,h=t.tag,p=t.result;else if(y)Mn(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=c,t.anchor=u,!0}else if(y)Mn(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=c,t.anchor=u,!0}if((t.line===s||t.lineIndent>e)&&(g&&(o=t.line,a=t.lineStart,l=t.position),Cm(t,e,V_,!0,i)&&(g?p=t.result:m=t.result),g||(tm(t,f,d,h,p,m,o,a,l),h=p=m=null),Qi(t,!0,-1),x=t.input.charCodeAt(t.position)),(t.line===s||t.lineIndent>e)&&x!==0)Mn(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return g&&tm(t,f,d,h,p,null,o,a,l),y&&(t.tag=c,t.anchor=u,t.kind="mapping",t.result=f),y}function uCe(t){var e,n=!1,r=!1,i,s,o;if(o=t.input.charCodeAt(t.position),o!==33)return!1;if(t.tag!==null&&Mn(t,"duplication of a tag property"),o=t.input.charCodeAt(++t.position),o===60?(n=!0,o=t.input.charCodeAt(++t.position)):o===33?(r=!0,i="!!",o=t.input.charCodeAt(++t.position)):i="!",e=t.position,n){do o=t.input.charCodeAt(++t.position);while(o!==0&&o!==62);t.position<t.length?(s=t.input.slice(e,t.position),o=t.input.charCodeAt(++t.position)):Mn(t,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Wo(o);)o===33&&(r?Mn(t,"tag suffix cannot contain exclamation marks"):(i=t.input.slice(e-1,t.position+1),xY.test(i)||Mn(t,"named tag handle cannot contain such characters"),r=!0,e=t.position+1)),o=t.input.charCodeAt(++t.position);s=t.input.slice(e,t.position),Q6e.test(s)&&Mn(t,"tag suffix cannot contain flow indicator characters")}s&&!_Y.test(s)&&Mn(t,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{Mn(t,"tag name is malformed: "+s)}return n?t.tag=s:bf.call(t.tagMap,i)?t.tag=t.tagMap[i]+s:i==="!"?t.tag="!"+s:i==="!!"?t.tag="tag:yaml.org,2002:"+s:Mn(t,'undeclared tag handle "'+i+'"'),!0}function fCe(t){var e,n;if(n=t.input.charCodeAt(t.position),n!==38)return!1;for(t.anchor!==null&&Mn(t,"duplication of an anchor property"),n=t.input.charCodeAt(++t.position),e=t.position;n!==0&&!Wo(n)&&!em(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&Mn(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function dCe(t){var e,n,r;if(r=t.input.charCodeAt(t.position),r!==42)return!1;for(r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!Wo(r)&&!em(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&Mn(t,"name of an alias node must contain at least one character"),n=t.input.slice(e,t.position),bf.call(t.anchorMap,n)||Mn(t,'unidentified alias "'+n+'"'),t.result=t.anchorMap[n],Qi(t,!0,-1),!0}function Cm(t,e,n,r,i){var s,o,a,l=1,c=!1,u=!1,f,d,h,p,m,g;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,s=o=a=V_===n||vY===n,r&&Qi(t,!0,-1)&&(c=!0,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)),l===1)for(;uCe(t)||fCe(t);)Qi(t,!0,-1)?(c=!0,a=s,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)):a=!1;if(a&&(a=c||i),(l===1||V_===n)&&(j_===n||yY===n?m=e:m=e+1,g=t.position-t.lineStart,l===1?a&&(EF(t,g)||cCe(t,g,m))||aCe(t,m)?u=!0:(o&&lCe(t,m)||sCe(t,m)||oCe(t,m)?u=!0:dCe(t)?(u=!0,(t.tag!==null||t.anchor!==null)&&Mn(t,"alias node should not have any properties")):iCe(t,m,j_===n)&&(u=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):l===0&&(u=a&&EF(t,g))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&Mn(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),f=0,d=t.implicitTypes.length;f<d;f+=1)if(p=t.implicitTypes[f],p.resolve(t.result)){t.result=p.construct(t.result),t.tag=p.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(bf.call(t.typeMap[t.kind||"fallback"],t.tag))p=t.typeMap[t.kind||"fallback"][t.tag];else for(p=null,h=t.typeMap.multi[t.kind||"fallback"],f=0,d=h.length;f<d;f+=1)if(t.tag.slice(0,h[f].tag.length)===h[f].tag){p=h[f];break}p||Mn(t,"unknown tag !<"+t.tag+">"),t.result!==null&&p.kind!==t.kind&&Mn(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+p.kind+'", not "'+t.kind+'"'),p.resolve(t.result,t.tag)?(t.result=p.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):Mn(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||u}function hCe(t){var e=t.position,n,r,i,s=!1,o;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(o=t.input.charCodeAt(t.position))!==0&&(Qi(t,!0,-1),o=t.input.charCodeAt(t.position),!(t.lineIndent>0||o!==37));){for(s=!0,o=t.input.charCodeAt(++t.position),n=t.position;o!==0&&!Wo(o);)o=t.input.charCodeAt(++t.position);for(r=t.input.slice(n,t.position),i=[],r.length<1&&Mn(t,"directive name must not be less than one character in length");o!==0;){for(;Nd(o);)o=t.input.charCodeAt(++t.position);if(o===35){do o=t.input.charCodeAt(++t.position);while(o!==0&&!ic(o));break}if(ic(o))break;for(n=t.position;o!==0&&!Wo(o);)o=t.input.charCodeAt(++t.position);i.push(t.input.slice(n,t.position))}o!==0&&X8(t),bf.call(_F,r)?_F[r](t,r,i):W_(t,'unknown document directive "'+r+'"')}if(Qi(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,Qi(t,!0,-1)):s&&Mn(t,"directives end mark is expected"),Cm(t,t.lineIndent-1,V_,!1,!0),Qi(t,!0,-1),t.checkLineBreaks&&Z6e.test(t.input.slice(e,t.position))&&W_(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&BE(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,Qi(t,!0,-1));return}if(t.position<t.length-1)Mn(t,"end of the stream or a document separator is expected");else return}function SY(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var n=new rCe(t,e),r=t.indexOf("\0");for(r!==-1&&(n.position=r,Mn(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)hCe(n);return n.documents}function pCe(t,e,n){e!==null&&typeof e=="object"&&typeof n>"u"&&(n=e,e=null);var r=SY(t,n);if(typeof e!="function")return r;for(var i=0,s=r.length;i<s;i+=1)e(r[i])}function mCe(t,e){var n=SY(t,e);if(n.length!==0){if(n.length===1)return n[0];throw new To("expected a single document in the stream, but found more")}}var gCe=pCe,yCe=mCe,TY={loadAll:gCe,load:yCe},AY=Object.prototype.toString,MY=Object.prototype.hasOwnProperty,Y8=65279,vCe=9,ry=10,xCe=13,_Ce=32,bCe=33,ECe=34,EM=35,wCe=37,SCe=38,TCe=39,ACe=42,CY=44,MCe=45,$_=58,CCe=61,RCe=62,ICe=63,PCe=64,RY=91,IY=93,kCe=96,PY=123,LCe=124,kY=125,ao={};ao[0]="\\0";ao[7]="\\a";ao[8]="\\b";ao[9]="\\t";ao[10]="\\n";ao[11]="\\v";ao[12]="\\f";ao[13]="\\r";ao[27]="\\e";ao[34]='\\"';ao[92]="\\\\";ao[133]="\\N";ao[160]="\\_";ao[8232]="\\L";ao[8233]="\\P";var DCe=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],NCe=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function OCe(t,e){var n,r,i,s,o,a,l;if(e===null)return{};for(n={},r=Object.keys(e),i=0,s=r.length;i<s;i+=1)o=r[i],a=String(e[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),l=t.compiledTypeMap.fallback[o],l&&MY.call(l.styleAliases,a)&&(a=l.styleAliases[a]),n[o]=a;return n}function FCe(t){var e,n,r;if(e=t.toString(16).toUpperCase(),t<=255)n="x",r=2;else if(t<=65535)n="u",r=4;else if(t<=4294967295)n="U",r=8;else throw new To("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+os.repeat("0",r-e.length)+e}var UCe=1,iy=2;function BCe(t){this.schema=t.schema||$8,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=os.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=OCe(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType=t.quotingType==='"'?iy:UCe,this.forceQuotes=t.forceQuotes||!1,this.replacer=typeof t.replacer=="function"?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function wF(t,e){for(var n=os.repeat(" ",e),r=0,i=-1,s="",o,a=t.length;r<a;)i=t.indexOf(`
`,r),i===-1?(o=t.slice(r),r=a):(o=t.slice(r,i+1),r=i+1),o.length&&o!==`
`&&(s+=n),s+=o;return s}function wM(t,e){return`
`+os.repeat(" ",t.indent*e)}function zCe(t,e){var n,r,i;for(n=0,r=t.implicitTypes.length;n<r;n+=1)if(i=t.implicitTypes[n],i.resolve(e))return!0;return!1}function X_(t){return t===_Ce||t===vCe}function sy(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==Y8||65536<=t&&t<=1114111}function SF(t){return sy(t)&&t!==Y8&&t!==xCe&&t!==ry}function TF(t,e,n){var r=SF(t),i=r&&!X_(t);return(n?r:r&&t!==CY&&t!==RY&&t!==IY&&t!==PY&&t!==kY)&&t!==EM&&!(e===$_&&!i)||SF(e)&&!X_(e)&&t===EM||e===$_&&i}function HCe(t){return sy(t)&&t!==Y8&&!X_(t)&&t!==MCe&&t!==ICe&&t!==$_&&t!==CY&&t!==RY&&t!==IY&&t!==PY&&t!==kY&&t!==EM&&t!==SCe&&t!==ACe&&t!==bCe&&t!==LCe&&t!==CCe&&t!==RCe&&t!==TCe&&t!==ECe&&t!==wCe&&t!==PCe&&t!==kCe}function GCe(t){return!X_(t)&&t!==$_}function e1(t,e){var n=t.charCodeAt(e),r;return n>=55296&&n<=56319&&e+1<t.length&&(r=t.charCodeAt(e+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function LY(t){var e=/^\n* /;return e.test(t)}var DY=1,SM=2,NY=3,OY=4,Gp=5;function jCe(t,e,n,r,i,s,o,a){var l,c=0,u=null,f=!1,d=!1,h=r!==-1,p=-1,m=HCe(e1(t,0))&&GCe(e1(t,t.length-1));if(e||o)for(l=0;l<t.length;c>=65536?l+=2:l++){if(c=e1(t,l),!sy(c))return Gp;m=m&&TF(c,u,a),u=c}else{for(l=0;l<t.length;c>=65536?l+=2:l++){if(c=e1(t,l),c===ry)f=!0,h&&(d=d||l-p-1>r&&t[p+1]!==" ",p=l);else if(!sy(c))return Gp;m=m&&TF(c,u,a),u=c}d=d||h&&l-p-1>r&&t[p+1]!==" "}return!f&&!d?m&&!o&&!i(t)?DY:s===iy?Gp:SM:n>9&&LY(t)?Gp:o?s===iy?Gp:SM:d?OY:NY}function VCe(t,e,n,r,i){t.dump=function(){if(e.length===0)return t.quotingType===iy?'""':"''";if(!t.noCompatMode&&(DCe.indexOf(e)!==-1||NCe.test(e)))return t.quotingType===iy?'"'+e+'"':"'"+e+"'";var s=t.indent*Math.max(1,n),o=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-s),a=r||t.flowLevel>-1&&n>=t.flowLevel;function l(c){return zCe(t,c)}switch(jCe(e,a,t.indent,o,l,t.quotingType,t.forceQuotes&&!r,i)){case DY:return e;case SM:return"'"+e.replace(/'/g,"''")+"'";case NY:return"|"+AF(e,t.indent)+MF(wF(e,s));case OY:return">"+AF(e,t.indent)+MF(wF(WCe(e,o),s));case Gp:return'"'+$Ce(e)+'"';default:throw new To("impossible error: invalid scalar style")}}()}function AF(t,e){var n=LY(t)?String(e):"",r=t[t.length-1]===`
`,i=r&&(t[t.length-2]===`
`||t===`
`),s=i?"+":r?"":"-";return n+s+`
`}function MF(t){return t[t.length-1]===`
`?t.slice(0,-1):t}function WCe(t,e){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=t.indexOf(`
`);return c=c!==-1?c:t.length,n.lastIndex=c,CF(t.slice(0,c),e)}(),i=t[0]===`
`||t[0]===" ",s,o;o=n.exec(t);){var a=o[1],l=o[2];s=l[0]===" ",r+=a+(!i&&!s&&l!==""?`
`:"")+CF(l,e),i=s}return r}function CF(t,e){if(t===""||t[0]===" ")return t;for(var n=/ [^ ]/g,r,i=0,s,o=0,a=0,l="";r=n.exec(t);)a=r.index,a-i>e&&(s=o>i?o:a,l+=`
`+t.slice(i,s),i=s+1),o=a;return l+=`
`,t.length-i>e&&o>i?l+=t.slice(i,o)+`
`+t.slice(o+1):l+=t.slice(i),l.slice(1)}function $Ce(t){for(var e="",n=0,r,i=0;i<t.length;n>=65536?i+=2:i++)n=e1(t,i),r=ao[n],!r&&sy(n)?(e+=t[i],n>=65536&&(e+=t[i+1])):e+=r||FCe(n);return e}function XCe(t,e,n){var r="",i=t.tag,s,o,a;for(s=0,o=n.length;s<o;s+=1)a=n[s],t.replacer&&(a=t.replacer.call(n,String(s),a)),(uu(t,e,a,!1,!1)||typeof a>"u"&&uu(t,e,null,!1,!1))&&(r!==""&&(r+=","+(t.condenseFlow?"":" ")),r+=t.dump);t.tag=i,t.dump="["+r+"]"}function RF(t,e,n,r){var i="",s=t.tag,o,a,l;for(o=0,a=n.length;o<a;o+=1)l=n[o],t.replacer&&(l=t.replacer.call(n,String(o),l)),(uu(t,e+1,l,!0,!0,!1,!0)||typeof l>"u"&&uu(t,e+1,null,!0,!0,!1,!0))&&((!r||i!=="")&&(i+=wM(t,e)),t.dump&&ry===t.dump.charCodeAt(0)?i+="-":i+="- ",i+=t.dump);t.tag=s,t.dump=i||"[]"}function qCe(t,e,n){var r="",i=t.tag,s=Object.keys(n),o,a,l,c,u;for(o=0,a=s.length;o<a;o+=1)u="",r!==""&&(u+=", "),t.condenseFlow&&(u+='"'),l=s[o],c=n[l],t.replacer&&(c=t.replacer.call(n,l,c)),uu(t,e,l,!1,!1)&&(t.dump.length>1024&&(u+="? "),u+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),uu(t,e,c,!1,!1)&&(u+=t.dump,r+=u));t.tag=i,t.dump="{"+r+"}"}function YCe(t,e,n,r){var i="",s=t.tag,o=Object.keys(n),a,l,c,u,f,d;if(t.sortKeys===!0)o.sort();else if(typeof t.sortKeys=="function")o.sort(t.sortKeys);else if(t.sortKeys)throw new To("sortKeys must be a boolean or a function");for(a=0,l=o.length;a<l;a+=1)d="",(!r||i!=="")&&(d+=wM(t,e)),c=o[a],u=n[c],t.replacer&&(u=t.replacer.call(n,c,u)),uu(t,e+1,c,!0,!0,!0)&&(f=t.tag!==null&&t.tag!=="?"||t.dump&&t.dump.length>1024,f&&(t.dump&&ry===t.dump.charCodeAt(0)?d+="?":d+="? "),d+=t.dump,f&&(d+=wM(t,e)),uu(t,e+1,u,!0,f)&&(t.dump&&ry===t.dump.charCodeAt(0)?d+=":":d+=": ",d+=t.dump,i+=d));t.tag=s,t.dump=i||"{}"}function IF(t,e,n){var r,i,s,o,a,l;for(i=n?t.explicitTypes:t.implicitTypes,s=0,o=i.length;s<o;s+=1)if(a=i[s],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof e=="object"&&e instanceof a.instanceOf)&&(!a.predicate||a.predicate(e))){if(n?a.multi&&a.representName?t.tag=a.representName(e):t.tag=a.tag:t.tag="?",a.represent){if(l=t.styleMap[a.tag]||a.defaultStyle,AY.call(a.represent)==="[object Function]")r=a.represent(e,l);else if(MY.call(a.represent,l))r=a.represent[l](e,l);else throw new To("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');t.dump=r}return!0}return!1}function uu(t,e,n,r,i,s,o){t.tag=null,t.dump=n,IF(t,n,!1)||IF(t,n,!0);var a=AY.call(t.dump),l=r,c;r&&(r=t.flowLevel<0||t.flowLevel>e);var u=a==="[object Object]"||a==="[object Array]",f,d;if(u&&(f=t.duplicates.indexOf(n),d=f!==-1),(t.tag!==null&&t.tag!=="?"||d||t.indent!==2&&e>0)&&(i=!1),d&&t.usedDuplicates[f])t.dump="*ref_"+f;else{if(u&&d&&!t.usedDuplicates[f]&&(t.usedDuplicates[f]=!0),a==="[object Object]")r&&Object.keys(t.dump).length!==0?(YCe(t,e,t.dump,i),d&&(t.dump="&ref_"+f+t.dump)):(qCe(t,e,t.dump),d&&(t.dump="&ref_"+f+" "+t.dump));else if(a==="[object Array]")r&&t.dump.length!==0?(t.noArrayIndent&&!o&&e>0?RF(t,e-1,t.dump,i):RF(t,e,t.dump,i),d&&(t.dump="&ref_"+f+t.dump)):(XCe(t,e,t.dump),d&&(t.dump="&ref_"+f+" "+t.dump));else if(a==="[object String]")t.tag!=="?"&&VCe(t,t.dump,e,s,l);else{if(a==="[object Undefined]"||t.skipInvalid)return!1;throw new To("unacceptable kind of an object to dump "+a)}t.tag!==null&&t.tag!=="?"&&(c=encodeURI(t.tag[0]==="!"?t.tag.slice(1):t.tag).replace(/!/g,"%21"),t.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",t.dump=c+" "+t.dump)}return!0}function KCe(t,e){var n=[],r=[],i,s;for(TM(t,n,r),i=0,s=r.length;i<s;i+=1)e.duplicates.push(n[r[i]]);e.usedDuplicates=new Array(s)}function TM(t,e,n){var r,i,s;if(t!==null&&typeof t=="object")if(i=e.indexOf(t),i!==-1)n.indexOf(i)===-1&&n.push(i);else if(e.push(t),Array.isArray(t))for(i=0,s=t.length;i<s;i+=1)TM(t[i],e,n);else for(r=Object.keys(t),i=0,s=r.length;i<s;i+=1)TM(t[r[i]],e,n)}function ZCe(t,e){e=e||{};var n=new BCe(e);n.noRefs||KCe(t,n);var r=t;return n.replacer&&(r=n.replacer.call({"":r},"",r)),uu(n,0,r,!0,!0)?n.dump+`
`:""}var QCe=ZCe,JCe={dump:QCe};function K8(t,e){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}var e8e=js,t8e=Qq,n8e=nY,r8e=aY,i8e=lY,s8e=$8,o8e=TY.load,a8e=TY.loadAll,l8e=JCe.dump,c8e=To,u8e={binary:hY,float:oY,map:tY,null:rY,pairs:mY,set:gY,timestamp:fY,bool:iY,int:sY,merge:dY,omap:pY,seq:eY,str:Jq},f8e=K8("safeLoad","load"),d8e=K8("safeLoadAll","loadAll"),h8e=K8("safeDump","dump"),p8e={Type:e8e,Schema:t8e,FAILSAFE_SCHEMA:n8e,JSON_SCHEMA:r8e,CORE_SCHEMA:i8e,DEFAULT_SCHEMA:s8e,load:o8e,loadAll:a8e,dump:l8e,YAMLException:c8e,types:u8e,safeLoad:f8e,safeLoadAll:d8e,safeDump:h8e},Z8={},zE={};zE.byteLength=y8e;zE.toByteArray=x8e;zE.fromByteArray=E8e;var Zl=[],Da=[],m8e=typeof Uint8Array<"u"?Uint8Array:Array,iA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ap=0,g8e=iA.length;Ap<g8e;++Ap)Zl[Ap]=iA[Ap],Da[iA.charCodeAt(Ap)]=Ap;Da[45]=62;Da[95]=63;function FY(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function y8e(t){var e=FY(t),n=e[0],r=e[1];return(n+r)*3/4-r}function v8e(t,e,n){return(e+n)*3/4-n}function x8e(t){var e,n=FY(t),r=n[0],i=n[1],s=new m8e(v8e(t,r,i)),o=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)e=Da[t.charCodeAt(l)]<<18|Da[t.charCodeAt(l+1)]<<12|Da[t.charCodeAt(l+2)]<<6|Da[t.charCodeAt(l+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Da[t.charCodeAt(l)]<<2|Da[t.charCodeAt(l+1)]>>4,s[o++]=e&255),i===1&&(e=Da[t.charCodeAt(l)]<<10|Da[t.charCodeAt(l+1)]<<4|Da[t.charCodeAt(l+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function _8e(t){return Zl[t>>18&63]+Zl[t>>12&63]+Zl[t>>6&63]+Zl[t&63]}function b8e(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(_8e(r));return i.join("")}function E8e(t){for(var e,n=t.length,r=n%3,i=[],s=16383,o=0,a=n-r;o<a;o+=s)i.push(b8e(t,o,o+s>a?a:o+s));return r===1?(e=t[n-1],i.push(Zl[e>>2]+Zl[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(Zl[e>>10]+Zl[e>>4&63]+Zl[e<<2&63]+"=")),i.join("")}var Q8={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Q8.read=function(t,e,n,r,i){var s,o,a=i*8-r-1,l=(1<<a)-1,c=l>>1,u=-7,f=n?i-1:0,d=n?-1:1,h=t[e+f];for(f+=d,s=h&(1<<-u)-1,h>>=-u,u+=a;u>0;s=s*256+t[e+f],f+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=o*256+t[e+f],f+=d,u-=8);if(s===0)s=1-c;else{if(s===l)return o?NaN:(h?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-c}return(h?-1:1)*o*Math.pow(2,s-r)};Q8.write=function(t,e,n,r,i,s){var o,a,l,c=s*8-i-1,u=(1<<c)-1,f=u>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:s-1,p=r?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+f>=1?e+=d/l:e+=d*Math.pow(2,1-f),e*l>=2&&(o++,l/=2),o+f>=u?(a=0,o=u):o+f>=1?(a=(e*l-1)*Math.pow(2,i),o=o+f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;t[n+h]=o&255,h+=p,o/=256,c-=8);t[n+h-p]|=m*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=zE,n=Q8,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=x,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const F=new Uint8Array(1),Z={foo:function(){return 42}};return Object.setPrototypeOf(Z,Uint8Array.prototype),Object.setPrototypeOf(F,Z),F.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(F){if(F>i)throw new RangeError('The value "'+F+'" is invalid for option "size"');const Z=new Uint8Array(F);return Object.setPrototypeOf(Z,a.prototype),Z}function a(F,Z,q){if(typeof F=="number"){if(typeof Z=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(F)}return l(F,Z,q)}a.poolSize=8192;function l(F,Z,q){if(typeof F=="string")return d(F,Z);if(ArrayBuffer.isView(F))return p(F);if(F==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof F);if(ie(F,ArrayBuffer)||F&&ie(F.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ie(F,SharedArrayBuffer)||F&&ie(F.buffer,SharedArrayBuffer)))return m(F,Z,q);if(typeof F=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const xe=F.valueOf&&F.valueOf();if(xe!=null&&xe!==F)return a.from(xe,Z,q);const be=g(F);if(be)return be;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof F[Symbol.toPrimitive]=="function")return a.from(F[Symbol.toPrimitive]("string"),Z,q);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof F)}a.from=function(F,Z,q){return l(F,Z,q)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(F){if(typeof F!="number")throw new TypeError('"size" argument must be of type number');if(F<0)throw new RangeError('The value "'+F+'" is invalid for option "size"')}function u(F,Z,q){return c(F),F<=0?o(F):Z!==void 0?typeof q=="string"?o(F).fill(Z,q):o(F).fill(Z):o(F)}a.alloc=function(F,Z,q){return u(F,Z,q)};function f(F){return c(F),o(F<0?0:y(F)|0)}a.allocUnsafe=function(F){return f(F)},a.allocUnsafeSlow=function(F){return f(F)};function d(F,Z){if((typeof Z!="string"||Z==="")&&(Z="utf8"),!a.isEncoding(Z))throw new TypeError("Unknown encoding: "+Z);const q=_(F,Z)|0;let xe=o(q);const be=xe.write(F,Z);return be!==q&&(xe=xe.slice(0,be)),xe}function h(F){const Z=F.length<0?0:y(F.length)|0,q=o(Z);for(let xe=0;xe<Z;xe+=1)q[xe]=F[xe]&255;return q}function p(F){if(ie(F,Uint8Array)){const Z=new Uint8Array(F);return m(Z.buffer,Z.byteOffset,Z.byteLength)}return h(F)}function m(F,Z,q){if(Z<0||F.byteLength<Z)throw new RangeError('"offset" is outside of buffer bounds');if(F.byteLength<Z+(q||0))throw new RangeError('"length" is outside of buffer bounds');let xe;return Z===void 0&&q===void 0?xe=new Uint8Array(F):q===void 0?xe=new Uint8Array(F,Z):xe=new Uint8Array(F,Z,q),Object.setPrototypeOf(xe,a.prototype),xe}function g(F){if(a.isBuffer(F)){const Z=y(F.length)|0,q=o(Z);return q.length===0||F.copy(q,0,0,Z),q}if(F.length!==void 0)return typeof F.length!="number"||ve(F.length)?o(0):h(F);if(F.type==="Buffer"&&Array.isArray(F.data))return h(F.data)}function y(F){if(F>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return F|0}function x(F){return+F!=F&&(F=0),a.alloc(+F)}a.isBuffer=function(F){return F!=null&&F._isBuffer===!0&&F!==a.prototype},a.compare=function(F,Z){if(ie(F,Uint8Array)&&(F=a.from(F,F.offset,F.byteLength)),ie(Z,Uint8Array)&&(Z=a.from(Z,Z.offset,Z.byteLength)),!a.isBuffer(F)||!a.isBuffer(Z))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(F===Z)return 0;let q=F.length,xe=Z.length;for(let be=0,De=Math.min(q,xe);be<De;++be)if(F[be]!==Z[be]){q=F[be],xe=Z[be];break}return q<xe?-1:xe<q?1:0},a.isEncoding=function(F){switch(String(F).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(F,Z){if(!Array.isArray(F))throw new TypeError('"list" argument must be an Array of Buffers');if(F.length===0)return a.alloc(0);let q;if(Z===void 0)for(Z=0,q=0;q<F.length;++q)Z+=F[q].length;const xe=a.allocUnsafe(Z);let be=0;for(q=0;q<F.length;++q){let De=F[q];if(ie(De,Uint8Array))be+De.length>xe.length?(a.isBuffer(De)||(De=a.from(De)),De.copy(xe,be)):Uint8Array.prototype.set.call(xe,De,be);else if(a.isBuffer(De))De.copy(xe,be);else throw new TypeError('"list" argument must be an Array of Buffers');be+=De.length}return xe};function _(F,Z){if(a.isBuffer(F))return F.length;if(ArrayBuffer.isView(F)||ie(F,ArrayBuffer))return F.byteLength;if(typeof F!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof F);const q=F.length,xe=arguments.length>2&&arguments[2]===!0;if(!xe&&q===0)return 0;let be=!1;for(;;)switch(Z){case"ascii":case"latin1":case"binary":return q;case"utf8":case"utf-8":return Ve(F).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q*2;case"hex":return q>>>1;case"base64":return ze(F).length;default:if(be)return xe?-1:Ve(F).length;Z=(""+Z).toLowerCase(),be=!0}}a.byteLength=_;function w(F,Z,q){let xe=!1;if((Z===void 0||Z<0)&&(Z=0),Z>this.length||((q===void 0||q>this.length)&&(q=this.length),q<=0)||(q>>>=0,Z>>>=0,q<=Z))return"";for(F||(F="utf8");;)switch(F){case"hex":return ne(this,Z,q);case"utf8":case"utf-8":return N(this,Z,q);case"ascii":return K(this,Z,q);case"latin1":case"binary":return V(this,Z,q);case"base64":return L(this,Z,q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,Z,q);default:if(xe)throw new TypeError("Unknown encoding: "+F);F=(F+"").toLowerCase(),xe=!0}}a.prototype._isBuffer=!0;function T(F,Z,q){const xe=F[Z];F[Z]=F[q],F[q]=xe}a.prototype.swap16=function(){const F=this.length;if(F%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Z=0;Z<F;Z+=2)T(this,Z,Z+1);return this},a.prototype.swap32=function(){const F=this.length;if(F%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Z=0;Z<F;Z+=4)T(this,Z,Z+3),T(this,Z+1,Z+2);return this},a.prototype.swap64=function(){const F=this.length;if(F%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Z=0;Z<F;Z+=8)T(this,Z,Z+7),T(this,Z+1,Z+6),T(this,Z+2,Z+5),T(this,Z+3,Z+4);return this},a.prototype.toString=function(){const F=this.length;return F===0?"":arguments.length===0?N(this,0,F):w.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(F){if(!a.isBuffer(F))throw new TypeError("Argument must be a Buffer");return this===F?!0:a.compare(this,F)===0},a.prototype.inspect=function(){let F="";const Z=t.INSPECT_MAX_BYTES;return F=this.toString("hex",0,Z).replace(/(.{2})/g,"$1 ").trim(),this.length>Z&&(F+=" ... "),"<Buffer "+F+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(F,Z,q,xe,be){if(ie(F,Uint8Array)&&(F=a.from(F,F.offset,F.byteLength)),!a.isBuffer(F))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof F);if(Z===void 0&&(Z=0),q===void 0&&(q=F?F.length:0),xe===void 0&&(xe=0),be===void 0&&(be=this.length),Z<0||q>F.length||xe<0||be>this.length)throw new RangeError("out of range index");if(xe>=be&&Z>=q)return 0;if(xe>=be)return-1;if(Z>=q)return 1;if(Z>>>=0,q>>>=0,xe>>>=0,be>>>=0,this===F)return 0;let De=be-xe,$e=q-Z;const st=Math.min(De,$e),it=this.slice(xe,be),Ie=F.slice(Z,q);for(let Ye=0;Ye<st;++Ye)if(it[Ye]!==Ie[Ye]){De=it[Ye],$e=Ie[Ye];break}return De<$e?-1:$e<De?1:0};function S(F,Z,q,xe,be){if(F.length===0)return-1;if(typeof q=="string"?(xe=q,q=0):q>2147483647?q=2147483647:q<-2147483648&&(q=-2147483648),q=+q,ve(q)&&(q=be?0:F.length-1),q<0&&(q=F.length+q),q>=F.length){if(be)return-1;q=F.length-1}else if(q<0)if(be)q=0;else return-1;if(typeof Z=="string"&&(Z=a.from(Z,xe)),a.isBuffer(Z))return Z.length===0?-1:C(F,Z,q,xe,be);if(typeof Z=="number")return Z=Z&255,typeof Uint8Array.prototype.indexOf=="function"?be?Uint8Array.prototype.indexOf.call(F,Z,q):Uint8Array.prototype.lastIndexOf.call(F,Z,q):C(F,[Z],q,xe,be);throw new TypeError("val must be string, number or Buffer")}function C(F,Z,q,xe,be){let De=1,$e=F.length,st=Z.length;if(xe!==void 0&&(xe=String(xe).toLowerCase(),xe==="ucs2"||xe==="ucs-2"||xe==="utf16le"||xe==="utf-16le")){if(F.length<2||Z.length<2)return-1;De=2,$e/=2,st/=2,q/=2}function it(Ye,at){return De===1?Ye[at]:Ye.readUInt16BE(at*De)}let Ie;if(be){let Ye=-1;for(Ie=q;Ie<$e;Ie++)if(it(F,Ie)===it(Z,Ye===-1?0:Ie-Ye)){if(Ye===-1&&(Ye=Ie),Ie-Ye+1===st)return Ye*De}else Ye!==-1&&(Ie-=Ie-Ye),Ye=-1}else for(q+st>$e&&(q=$e-st),Ie=q;Ie>=0;Ie--){let Ye=!0;for(let at=0;at<st;at++)if(it(F,Ie+at)!==it(Z,at)){Ye=!1;break}if(Ye)return Ie}return-1}a.prototype.includes=function(F,Z,q){return this.indexOf(F,Z,q)!==-1},a.prototype.indexOf=function(F,Z,q){return S(this,F,Z,q,!0)},a.prototype.lastIndexOf=function(F,Z,q){return S(this,F,Z,q,!1)};function A(F,Z,q,xe){q=Number(q)||0;const be=F.length-q;xe?(xe=Number(xe),xe>be&&(xe=be)):xe=be;const De=Z.length;xe>De/2&&(xe=De/2);let $e;for($e=0;$e<xe;++$e){const st=parseInt(Z.substr($e*2,2),16);if(ve(st))return $e;F[q+$e]=st}return $e}function R(F,Z,q,xe){return fe(Ve(Z,F.length-q),F,q,xe)}function M(F,Z,q,xe){return fe(ye(Z),F,q,xe)}function D(F,Z,q,xe){return fe(ze(Z),F,q,xe)}function k(F,Z,q,xe){return fe(ge(Z,F.length-q),F,q,xe)}a.prototype.write=function(F,Z,q,xe){if(Z===void 0)xe="utf8",q=this.length,Z=0;else if(q===void 0&&typeof Z=="string")xe=Z,q=this.length,Z=0;else if(isFinite(Z))Z=Z>>>0,isFinite(q)?(q=q>>>0,xe===void 0&&(xe="utf8")):(xe=q,q=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const be=this.length-Z;if((q===void 0||q>be)&&(q=be),F.length>0&&(q<0||Z<0)||Z>this.length)throw new RangeError("Attempt to write outside buffer bounds");xe||(xe="utf8");let De=!1;for(;;)switch(xe){case"hex":return A(this,F,Z,q);case"utf8":case"utf-8":return R(this,F,Z,q);case"ascii":case"latin1":case"binary":return M(this,F,Z,q);case"base64":return D(this,F,Z,q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,F,Z,q);default:if(De)throw new TypeError("Unknown encoding: "+xe);xe=(""+xe).toLowerCase(),De=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(F,Z,q){return Z===0&&q===F.length?e.fromByteArray(F):e.fromByteArray(F.slice(Z,q))}function N(F,Z,q){q=Math.min(F.length,q);const xe=[];let be=Z;for(;be<q;){const De=F[be];let $e=null,st=De>239?4:De>223?3:De>191?2:1;if(be+st<=q){let it,Ie,Ye,at;switch(st){case 1:De<128&&($e=De);break;case 2:it=F[be+1],(it&192)===128&&(at=(De&31)<<6|it&63,at>127&&($e=at));break;case 3:it=F[be+1],Ie=F[be+2],(it&192)===128&&(Ie&192)===128&&(at=(De&15)<<12|(it&63)<<6|Ie&63,at>2047&&(at<55296||at>57343)&&($e=at));break;case 4:it=F[be+1],Ie=F[be+2],Ye=F[be+3],(it&192)===128&&(Ie&192)===128&&(Ye&192)===128&&(at=(De&15)<<18|(it&63)<<12|(Ie&63)<<6|Ye&63,at>65535&&at<1114112&&($e=at))}}$e===null?($e=65533,st=1):$e>65535&&($e-=65536,xe.push($e>>>10&1023|55296),$e=56320|$e&1023),xe.push($e),be+=st}return O(xe)}const z=4096;function O(F){const Z=F.length;if(Z<=z)return String.fromCharCode.apply(String,F);let q="",xe=0;for(;xe<Z;)q+=String.fromCharCode.apply(String,F.slice(xe,xe+=z));return q}function K(F,Z,q){let xe="";q=Math.min(F.length,q);for(let be=Z;be<q;++be)xe+=String.fromCharCode(F[be]&127);return xe}function V(F,Z,q){let xe="";q=Math.min(F.length,q);for(let be=Z;be<q;++be)xe+=String.fromCharCode(F[be]);return xe}function ne(F,Z,q){const xe=F.length;(!Z||Z<0)&&(Z=0),(!q||q<0||q>xe)&&(q=xe);let be="";for(let De=Z;De<q;++De)be+=Me[F[De]];return be}function re(F,Z,q){const xe=F.slice(Z,q);let be="";for(let De=0;De<xe.length-1;De+=2)be+=String.fromCharCode(xe[De]+xe[De+1]*256);return be}a.prototype.slice=function(F,Z){const q=this.length;F=~~F,Z=Z===void 0?q:~~Z,F<0?(F+=q,F<0&&(F=0)):F>q&&(F=q),Z<0?(Z+=q,Z<0&&(Z=0)):Z>q&&(Z=q),Z<F&&(Z=F);const xe=this.subarray(F,Z);return Object.setPrototypeOf(xe,a.prototype),xe};function P(F,Z,q){if(F%1!==0||F<0)throw new RangeError("offset is not uint");if(F+Z>q)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(F,Z,q){F=F>>>0,Z=Z>>>0,q||P(F,Z,this.length);let xe=this[F],be=1,De=0;for(;++De<Z&&(be*=256);)xe+=this[F+De]*be;return xe},a.prototype.readUintBE=a.prototype.readUIntBE=function(F,Z,q){F=F>>>0,Z=Z>>>0,q||P(F,Z,this.length);let xe=this[F+--Z],be=1;for(;Z>0&&(be*=256);)xe+=this[F+--Z]*be;return xe},a.prototype.readUint8=a.prototype.readUInt8=function(F,Z){return F=F>>>0,Z||P(F,1,this.length),this[F]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(F,Z){return F=F>>>0,Z||P(F,2,this.length),this[F]|this[F+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(F,Z){return F=F>>>0,Z||P(F,2,this.length),this[F]<<8|this[F+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(F,Z){return F=F>>>0,Z||P(F,4,this.length),(this[F]|this[F+1]<<8|this[F+2]<<16)+this[F+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(F,Z){return F=F>>>0,Z||P(F,4,this.length),this[F]*16777216+(this[F+1]<<16|this[F+2]<<8|this[F+3])},a.prototype.readBigUInt64LE=Be(function(F){F=F>>>0,Re(F,"offset");const Z=this[F],q=this[F+7];(Z===void 0||q===void 0)&&ae(F,this.length-8);const xe=Z+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24,be=this[++F]+this[++F]*2**8+this[++F]*2**16+q*2**24;return BigInt(xe)+(BigInt(be)<<BigInt(32))}),a.prototype.readBigUInt64BE=Be(function(F){F=F>>>0,Re(F,"offset");const Z=this[F],q=this[F+7];(Z===void 0||q===void 0)&&ae(F,this.length-8);const xe=Z*2**24+this[++F]*2**16+this[++F]*2**8+this[++F],be=this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+q;return(BigInt(xe)<<BigInt(32))+BigInt(be)}),a.prototype.readIntLE=function(F,Z,q){F=F>>>0,Z=Z>>>0,q||P(F,Z,this.length);let xe=this[F],be=1,De=0;for(;++De<Z&&(be*=256);)xe+=this[F+De]*be;return be*=128,xe>=be&&(xe-=Math.pow(2,8*Z)),xe},a.prototype.readIntBE=function(F,Z,q){F=F>>>0,Z=Z>>>0,q||P(F,Z,this.length);let xe=Z,be=1,De=this[F+--xe];for(;xe>0&&(be*=256);)De+=this[F+--xe]*be;return be*=128,De>=be&&(De-=Math.pow(2,8*Z)),De},a.prototype.readInt8=function(F,Z){return F=F>>>0,Z||P(F,1,this.length),this[F]&128?(255-this[F]+1)*-1:this[F]},a.prototype.readInt16LE=function(F,Z){F=F>>>0,Z||P(F,2,this.length);const q=this[F]|this[F+1]<<8;return q&32768?q|4294901760:q},a.prototype.readInt16BE=function(F,Z){F=F>>>0,Z||P(F,2,this.length);const q=this[F+1]|this[F]<<8;return q&32768?q|4294901760:q},a.prototype.readInt32LE=function(F,Z){return F=F>>>0,Z||P(F,4,this.length),this[F]|this[F+1]<<8|this[F+2]<<16|this[F+3]<<24},a.prototype.readInt32BE=function(F,Z){return F=F>>>0,Z||P(F,4,this.length),this[F]<<24|this[F+1]<<16|this[F+2]<<8|this[F+3]},a.prototype.readBigInt64LE=Be(function(F){F=F>>>0,Re(F,"offset");const Z=this[F],q=this[F+7];(Z===void 0||q===void 0)&&ae(F,this.length-8);const xe=this[F+4]+this[F+5]*2**8+this[F+6]*2**16+(q<<24);return(BigInt(xe)<<BigInt(32))+BigInt(Z+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24)}),a.prototype.readBigInt64BE=Be(function(F){F=F>>>0,Re(F,"offset");const Z=this[F],q=this[F+7];(Z===void 0||q===void 0)&&ae(F,this.length-8);const xe=(Z<<24)+this[++F]*2**16+this[++F]*2**8+this[++F];return(BigInt(xe)<<BigInt(32))+BigInt(this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+q)}),a.prototype.readFloatLE=function(F,Z){return F=F>>>0,Z||P(F,4,this.length),n.read(this,F,!0,23,4)},a.prototype.readFloatBE=function(F,Z){return F=F>>>0,Z||P(F,4,this.length),n.read(this,F,!1,23,4)},a.prototype.readDoubleLE=function(F,Z){return F=F>>>0,Z||P(F,8,this.length),n.read(this,F,!0,52,8)},a.prototype.readDoubleBE=function(F,Z){return F=F>>>0,Z||P(F,8,this.length),n.read(this,F,!1,52,8)};function se(F,Z,q,xe,be,De){if(!a.isBuffer(F))throw new TypeError('"buffer" argument must be a Buffer instance');if(Z>be||Z<De)throw new RangeError('"value" argument is out of bounds');if(q+xe>F.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(F,Z,q,xe){if(F=+F,Z=Z>>>0,q=q>>>0,!xe){const $e=Math.pow(2,8*q)-1;se(this,F,Z,q,$e,0)}let be=1,De=0;for(this[Z]=F&255;++De<q&&(be*=256);)this[Z+De]=F/be&255;return Z+q},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(F,Z,q,xe){if(F=+F,Z=Z>>>0,q=q>>>0,!xe){const $e=Math.pow(2,8*q)-1;se(this,F,Z,q,$e,0)}let be=q-1,De=1;for(this[Z+be]=F&255;--be>=0&&(De*=256);)this[Z+be]=F/De&255;return Z+q},a.prototype.writeUint8=a.prototype.writeUInt8=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,1,255,0),this[Z]=F&255,Z+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,2,65535,0),this[Z]=F&255,this[Z+1]=F>>>8,Z+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,2,65535,0),this[Z]=F>>>8,this[Z+1]=F&255,Z+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,4,4294967295,0),this[Z+3]=F>>>24,this[Z+2]=F>>>16,this[Z+1]=F>>>8,this[Z]=F&255,Z+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,4,4294967295,0),this[Z]=F>>>24,this[Z+1]=F>>>16,this[Z+2]=F>>>8,this[Z+3]=F&255,Z+4};function ue(F,Z,q,xe,be){_e(Z,xe,be,F,q,7);let De=Number(Z&BigInt(4294967295));F[q++]=De,De=De>>8,F[q++]=De,De=De>>8,F[q++]=De,De=De>>8,F[q++]=De;let $e=Number(Z>>BigInt(32)&BigInt(4294967295));return F[q++]=$e,$e=$e>>8,F[q++]=$e,$e=$e>>8,F[q++]=$e,$e=$e>>8,F[q++]=$e,q}function te(F,Z,q,xe,be){_e(Z,xe,be,F,q,7);let De=Number(Z&BigInt(4294967295));F[q+7]=De,De=De>>8,F[q+6]=De,De=De>>8,F[q+5]=De,De=De>>8,F[q+4]=De;let $e=Number(Z>>BigInt(32)&BigInt(4294967295));return F[q+3]=$e,$e=$e>>8,F[q+2]=$e,$e=$e>>8,F[q+1]=$e,$e=$e>>8,F[q]=$e,q+8}a.prototype.writeBigUInt64LE=Be(function(F,Z=0){return ue(this,F,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Be(function(F,Z=0){return te(this,F,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(F,Z,q,xe){if(F=+F,Z=Z>>>0,!xe){const st=Math.pow(2,8*q-1);se(this,F,Z,q,st-1,-st)}let be=0,De=1,$e=0;for(this[Z]=F&255;++be<q&&(De*=256);)F<0&&$e===0&&this[Z+be-1]!==0&&($e=1),this[Z+be]=(F/De>>0)-$e&255;return Z+q},a.prototype.writeIntBE=function(F,Z,q,xe){if(F=+F,Z=Z>>>0,!xe){const st=Math.pow(2,8*q-1);se(this,F,Z,q,st-1,-st)}let be=q-1,De=1,$e=0;for(this[Z+be]=F&255;--be>=0&&(De*=256);)F<0&&$e===0&&this[Z+be+1]!==0&&($e=1),this[Z+be]=(F/De>>0)-$e&255;return Z+q},a.prototype.writeInt8=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,1,127,-128),F<0&&(F=255+F+1),this[Z]=F&255,Z+1},a.prototype.writeInt16LE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,2,32767,-32768),this[Z]=F&255,this[Z+1]=F>>>8,Z+2},a.prototype.writeInt16BE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,2,32767,-32768),this[Z]=F>>>8,this[Z+1]=F&255,Z+2},a.prototype.writeInt32LE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,4,2147483647,-2147483648),this[Z]=F&255,this[Z+1]=F>>>8,this[Z+2]=F>>>16,this[Z+3]=F>>>24,Z+4},a.prototype.writeInt32BE=function(F,Z,q){return F=+F,Z=Z>>>0,q||se(this,F,Z,4,2147483647,-2147483648),F<0&&(F=4294967295+F+1),this[Z]=F>>>24,this[Z+1]=F>>>16,this[Z+2]=F>>>8,this[Z+3]=F&255,Z+4},a.prototype.writeBigInt64LE=Be(function(F,Z=0){return ue(this,F,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Be(function(F,Z=0){return te(this,F,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function W(F,Z,q,xe,be,De){if(q+xe>F.length)throw new RangeError("Index out of range");if(q<0)throw new RangeError("Index out of range")}function X(F,Z,q,xe,be){return Z=+Z,q=q>>>0,be||W(F,Z,q,4),n.write(F,Z,q,xe,23,4),q+4}a.prototype.writeFloatLE=function(F,Z,q){return X(this,F,Z,!0,q)},a.prototype.writeFloatBE=function(F,Z,q){return X(this,F,Z,!1,q)};function J(F,Z,q,xe,be){return Z=+Z,q=q>>>0,be||W(F,Z,q,8),n.write(F,Z,q,xe,52,8),q+8}a.prototype.writeDoubleLE=function(F,Z,q){return J(this,F,Z,!0,q)},a.prototype.writeDoubleBE=function(F,Z,q){return J(this,F,Z,!1,q)},a.prototype.copy=function(F,Z,q,xe){if(!a.isBuffer(F))throw new TypeError("argument should be a Buffer");if(q||(q=0),!xe&&xe!==0&&(xe=this.length),Z>=F.length&&(Z=F.length),Z||(Z=0),xe>0&&xe<q&&(xe=q),xe===q||F.length===0||this.length===0)return 0;if(Z<0)throw new RangeError("targetStart out of bounds");if(q<0||q>=this.length)throw new RangeError("Index out of range");if(xe<0)throw new RangeError("sourceEnd out of bounds");xe>this.length&&(xe=this.length),F.length-Z<xe-q&&(xe=F.length-Z+q);const be=xe-q;return this===F&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Z,q,xe):Uint8Array.prototype.set.call(F,this.subarray(q,xe),Z),be},a.prototype.fill=function(F,Z,q,xe){if(typeof F=="string"){if(typeof Z=="string"?(xe=Z,Z=0,q=this.length):typeof q=="string"&&(xe=q,q=this.length),xe!==void 0&&typeof xe!="string")throw new TypeError("encoding must be a string");if(typeof xe=="string"&&!a.isEncoding(xe))throw new TypeError("Unknown encoding: "+xe);if(F.length===1){const De=F.charCodeAt(0);(xe==="utf8"&&De<128||xe==="latin1")&&(F=De)}}else typeof F=="number"?F=F&255:typeof F=="boolean"&&(F=Number(F));if(Z<0||this.length<Z||this.length<q)throw new RangeError("Out of range index");if(q<=Z)return this;Z=Z>>>0,q=q===void 0?this.length:q>>>0,F||(F=0);let be;if(typeof F=="number")for(be=Z;be<q;++be)this[be]=F;else{const De=a.isBuffer(F)?F:a.from(F,xe),$e=De.length;if($e===0)throw new TypeError('The value "'+F+'" is invalid for argument "value"');for(be=0;be<q-Z;++be)this[be+Z]=De[be%$e]}return this};const oe={};function Ee(F,Z,q){oe[F]=class extends q{constructor(){super(),Object.defineProperty(this,"message",{value:Z.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${F}]`,this.stack,delete this.name}get code(){return F}set code(xe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:xe,writable:!0})}toString(){return`${this.name} [${F}]: ${this.message}`}}}Ee("ERR_BUFFER_OUT_OF_BOUNDS",function(F){return F?`${F} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ee("ERR_INVALID_ARG_TYPE",function(F,Z){return`The "${F}" argument must be of type number. Received type ${typeof Z}`},TypeError),Ee("ERR_OUT_OF_RANGE",function(F,Z,q){let xe=`The value of "${F}" is out of range.`,be=q;return Number.isInteger(q)&&Math.abs(q)>2**32?be=me(String(q)):typeof q=="bigint"&&(be=String(q),(q>BigInt(2)**BigInt(32)||q<-(BigInt(2)**BigInt(32)))&&(be=me(be)),be+="n"),xe+=` It must be ${Z}. Received ${be}`,xe},RangeError);function me(F){let Z="",q=F.length;const xe=F[0]==="-"?1:0;for(;q>=xe+4;q-=3)Z=`_${F.slice(q-3,q)}${Z}`;return`${F.slice(0,q)}${Z}`}function Te(F,Z,q){Re(Z,"offset"),(F[Z]===void 0||F[Z+q]===void 0)&&ae(Z,F.length-(q+1))}function _e(F,Z,q,xe,be,De){if(F>q||F<Z){const $e=typeof Z=="bigint"?"n":"";let st;throw Z===0||Z===BigInt(0)?st=`>= 0${$e} and < 2${$e} ** ${(De+1)*8}${$e}`:st=`>= -(2${$e} ** ${(De+1)*8-1}${$e}) and < 2 ** ${(De+1)*8-1}${$e}`,new oe.ERR_OUT_OF_RANGE("value",st,F)}Te(xe,be,De)}function Re(F,Z){if(typeof F!="number")throw new oe.ERR_INVALID_ARG_TYPE(Z,"number",F)}function ae(F,Z,q){throw Math.floor(F)!==F?(Re(F,q),new oe.ERR_OUT_OF_RANGE("offset","an integer",F)):Z<0?new oe.ERR_BUFFER_OUT_OF_BOUNDS:new oe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${Z}`,F)}const Ce=/[^+/0-9A-Za-z-_]/g;function Pe(F){if(F=F.split("=")[0],F=F.trim().replace(Ce,""),F.length<2)return"";for(;F.length%4!==0;)F=F+"=";return F}function Ve(F,Z){Z=Z||1/0;let q;const xe=F.length;let be=null;const De=[];for(let $e=0;$e<xe;++$e){if(q=F.charCodeAt($e),q>55295&&q<57344){if(!be){if(q>56319){(Z-=3)>-1&&De.push(239,191,189);continue}else if($e+1===xe){(Z-=3)>-1&&De.push(239,191,189);continue}be=q;continue}if(q<56320){(Z-=3)>-1&&De.push(239,191,189),be=q;continue}q=(be-55296<<10|q-56320)+65536}else be&&(Z-=3)>-1&&De.push(239,191,189);if(be=null,q<128){if((Z-=1)<0)break;De.push(q)}else if(q<2048){if((Z-=2)<0)break;De.push(q>>6|192,q&63|128)}else if(q<65536){if((Z-=3)<0)break;De.push(q>>12|224,q>>6&63|128,q&63|128)}else if(q<1114112){if((Z-=4)<0)break;De.push(q>>18|240,q>>12&63|128,q>>6&63|128,q&63|128)}else throw new Error("Invalid code point")}return De}function ye(F){const Z=[];for(let q=0;q<F.length;++q)Z.push(F.charCodeAt(q)&255);return Z}function ge(F,Z){let q,xe,be;const De=[];for(let $e=0;$e<F.length&&!((Z-=2)<0);++$e)q=F.charCodeAt($e),xe=q>>8,be=q%256,De.push(be),De.push(xe);return De}function ze(F){return e.toByteArray(Pe(F))}function fe(F,Z,q,xe){let be;for(be=0;be<xe&&!(be+q>=Z.length||be>=F.length);++be)Z[be+q]=F[be];return be}function ie(F,Z){return F instanceof Z||F!=null&&F.constructor!=null&&F.constructor.name!=null&&F.constructor.name===Z.name}function ve(F){return F!==F}const Me=function(){const F="0123456789abcdef",Z=new Array(256);for(let q=0;q<16;++q){const xe=q*16;for(let be=0;be<16;++be)Z[xe+be]=F[q]+F[be]}return Z}();function Be(F){return typeof BigInt>"u"?Ze:F}function Ze(){throw new Error("BigInt not supported")}})(Z8);const w8e=mu(Z8),S8e=V4e({__proto__:null,default:w8e},[Z8]),T8e="_vuerRoot_evnl7_1";var Wy={};const jl="\\\\/",PF=`[^${jl}]`,Wc="\\.",A8e="\\+",M8e="\\?",HE="\\/",C8e="(?=.)",UY="[^/]",J8=`(?:${HE}|$)`,BY=`(?:^|${HE})`,eR=`${Wc}{1,2}${J8}`,R8e=`(?!${Wc})`,I8e=`(?!${BY}${eR})`,P8e=`(?!${Wc}{0,1}${J8})`,k8e=`(?!${eR})`,L8e=`[^.${HE}]`,D8e=`${UY}*?`,N8e="/",zY={DOT_LITERAL:Wc,PLUS_LITERAL:A8e,QMARK_LITERAL:M8e,SLASH_LITERAL:HE,ONE_CHAR:C8e,QMARK:UY,END_ANCHOR:J8,DOTS_SLASH:eR,NO_DOT:R8e,NO_DOTS:I8e,NO_DOT_SLASH:P8e,NO_DOTS_SLASH:k8e,QMARK_NO_DOT:L8e,STAR:D8e,START_ANCHOR:BY,SEP:N8e},O8e={...zY,SLASH_LITERAL:`[${jl}]`,QMARK:PF,STAR:`${PF}*?`,DOTS_SLASH:`${Wc}{1,2}(?:[${jl}]|$)`,NO_DOT:`(?!${Wc})`,NO_DOTS:`(?!(?:^|[${jl}])${Wc}{1,2}(?:[${jl}]|$))`,NO_DOT_SLASH:`(?!${Wc}{0,1}(?:[${jl}]|$))`,NO_DOTS_SLASH:`(?!${Wc}{1,2}(?:[${jl}]|$))`,QMARK_NO_DOT:`[^.${jl}]`,START_ANCHOR:`(?:^|[${jl}])`,END_ANCHOR:`(?:[${jl}]|$)`,SEP:"\\"},F8e={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};var GE={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:F8e,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?O8e:zY}};(function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:r,REGEX_SPECIAL_CHARS_GLOBAL:i}=GE;t.isObject=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t.hasRegexChars=s=>r.test(s),t.isRegexChar=s=>s.length===1&&t.hasRegexChars(s),t.escapeRegex=s=>s.replace(i,"\\$1"),t.toPosixSlashes=s=>s.replace(e,"/"),t.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){const s=navigator.platform.toLowerCase();return s==="win32"||s==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1},t.removeBackslashes=s=>s.replace(n,o=>o==="\\"?"":o),t.escapeLast=(s,o,a)=>{const l=s.lastIndexOf(o,a);return l===-1?s:s[l-1]==="\\"?t.escapeLast(s,o,l-1):`${s.slice(0,l)}\\${s.slice(l)}`},t.removePrefix=(s,o={})=>{let a=s;return a.startsWith("./")&&(a=a.slice(2),o.prefix="./"),a},t.wrapOutput=(s,o={},a={})=>{const l=a.contains?"":"^",c=a.contains?"":"$";let u=`${l}(?:${s})${c}`;return o.negated===!0&&(u=`(?:^(?!${u}).*$)`),u},t.basename=(s,{windows:o}={})=>{const a=s.split(o?/[\\/]/:"/"),l=a[a.length-1];return l===""?a[a.length-2]:l}})(Wy);const kF=Wy,{CHAR_ASTERISK:sA,CHAR_AT:U8e,CHAR_BACKWARD_SLASH:t1,CHAR_COMMA:B8e,CHAR_DOT:oA,CHAR_EXCLAMATION_MARK:aA,CHAR_FORWARD_SLASH:HY,CHAR_LEFT_CURLY_BRACE:lA,CHAR_LEFT_PARENTHESES:cA,CHAR_LEFT_SQUARE_BRACKET:z8e,CHAR_PLUS:H8e,CHAR_QUESTION_MARK:LF,CHAR_RIGHT_CURLY_BRACE:G8e,CHAR_RIGHT_PARENTHESES:DF,CHAR_RIGHT_SQUARE_BRACKET:j8e}=GE,NF=t=>t===HY||t===t1,OF=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?1/0:1)},V8e=(t,e)=>{const n=e||{},r=t.length-1,i=n.parts===!0||n.scanToEnd===!0,s=[],o=[],a=[];let l=t,c=-1,u=0,f=0,d=!1,h=!1,p=!1,m=!1,g=!1,y=!1,x=!1,_=!1,w=!1,T=!1,S=0,C,A,R={value:"",depth:0,isGlob:!1};const M=()=>c>=r,D=()=>l.charCodeAt(c+1),k=()=>(C=A,l.charCodeAt(++c));for(;c<r;){A=k();let K;if(A===t1){x=R.backslashes=!0,A=k(),A===lA&&(y=!0);continue}if(y===!0||A===lA){for(S++;M()!==!0&&(A=k());){if(A===t1){x=R.backslashes=!0,k();continue}if(A===lA){S++;continue}if(y!==!0&&A===oA&&(A=k())===oA){if(d=R.isBrace=!0,p=R.isGlob=!0,T=!0,i===!0)continue;break}if(y!==!0&&A===B8e){if(d=R.isBrace=!0,p=R.isGlob=!0,T=!0,i===!0)continue;break}if(A===G8e&&(S--,S===0)){y=!1,d=R.isBrace=!0,T=!0;break}}if(i===!0)continue;break}if(A===HY){if(s.push(c),o.push(R),R={value:"",depth:0,isGlob:!1},T===!0)continue;if(C===oA&&c===u+1){u+=2;continue}f=c+1;continue}if(n.noext!==!0&&(A===H8e||A===U8e||A===sA||A===LF||A===aA)&&D()===cA){if(p=R.isGlob=!0,m=R.isExtglob=!0,T=!0,A===aA&&c===u&&(w=!0),i===!0){for(;M()!==!0&&(A=k());){if(A===t1){x=R.backslashes=!0,A=k();continue}if(A===DF){p=R.isGlob=!0,T=!0;break}}continue}break}if(A===sA){if(C===sA&&(g=R.isGlobstar=!0),p=R.isGlob=!0,T=!0,i===!0)continue;break}if(A===LF){if(p=R.isGlob=!0,T=!0,i===!0)continue;break}if(A===z8e){for(;M()!==!0&&(K=k());){if(K===t1){x=R.backslashes=!0,k();continue}if(K===j8e){h=R.isBracket=!0,p=R.isGlob=!0,T=!0;break}}if(i===!0)continue;break}if(n.nonegate!==!0&&A===aA&&c===u){_=R.negated=!0,u++;continue}if(n.noparen!==!0&&A===cA){if(p=R.isGlob=!0,i===!0){for(;M()!==!0&&(A=k());){if(A===cA){x=R.backslashes=!0,A=k();continue}if(A===DF){T=!0;break}}continue}break}if(p===!0){if(T=!0,i===!0)continue;break}}n.noext===!0&&(m=!1,p=!1);let L=l,N="",z="";u>0&&(N=l.slice(0,u),l=l.slice(u),f-=u),L&&p===!0&&f>0?(L=l.slice(0,f),z=l.slice(f)):p===!0?(L="",z=l):L=l,L&&L!==""&&L!=="/"&&L!==l&&NF(L.charCodeAt(L.length-1))&&(L=L.slice(0,-1)),n.unescape===!0&&(z&&(z=kF.removeBackslashes(z)),L&&x===!0&&(L=kF.removeBackslashes(L)));const O={prefix:N,input:t,start:u,base:L,glob:z,isBrace:d,isBracket:h,isGlob:p,isExtglob:m,isGlobstar:g,negated:_,negatedExtglob:w};if(n.tokens===!0&&(O.maxDepth=0,NF(A)||o.push(R),O.tokens=o),n.parts===!0||n.tokens===!0){let K;for(let V=0;V<s.length;V++){const ne=K?K+1:u,re=s[V],P=t.slice(ne,re);n.tokens&&(V===0&&u!==0?(o[V].isPrefix=!0,o[V].value=N):o[V].value=P,OF(o[V]),O.maxDepth+=o[V].depth),(V!==0||P!=="")&&a.push(P),K=re}if(K&&K+1<t.length){const V=t.slice(K+1);a.push(V),n.tokens&&(o[o.length-1].value=V,OF(o[o.length-1]),O.maxDepth+=o[o.length-1].depth)}O.slashes=s,O.parts=a}return O};var W8e=V8e;const q_=GE,Vl=Wy,{MAX_LENGTH:Y_,POSIX_REGEX_SOURCE:$8e,REGEX_NON_SPECIAL_CHARS:X8e,REGEX_SPECIAL_CHARS_BACKREF:q8e,REPLACEMENTS:GY}=q_,Y8e=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();const n=`[${t.join("-")}]`;try{new RegExp(n)}catch{return t.map(r=>Vl.escapeRegex(r)).join("..")}return n},Mp=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,tR=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=GY[t]||t;const n={...e},r=typeof n.maxLength=="number"?Math.min(Y_,n.maxLength):Y_;let i=t.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);const s={type:"bos",value:"",output:n.prepend||""},o=[s],a=n.capture?"":"?:",l=q_.globChars(n.windows),c=q_.extglobChars(l),{DOT_LITERAL:u,PLUS_LITERAL:f,SLASH_LITERAL:d,ONE_CHAR:h,DOTS_SLASH:p,NO_DOT:m,NO_DOT_SLASH:g,NO_DOTS_SLASH:y,QMARK:x,QMARK_NO_DOT:_,STAR:w,START_ANCHOR:T}=l,S=oe=>`(${a}(?:(?!${T}${oe.dot?p:u}).)*?)`,C=n.dot?"":m,A=n.dot?x:_;let R=n.bash===!0?S(n):w;n.capture&&(R=`(${R})`),typeof n.noext=="boolean"&&(n.noextglob=n.noext);const M={input:t,index:-1,start:0,dot:n.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:o};t=Vl.removePrefix(t,M),i=t.length;const D=[],k=[],L=[];let N=s,z;const O=()=>M.index===i-1,K=M.peek=(oe=1)=>t[M.index+oe],V=M.advance=()=>t[++M.index]||"",ne=()=>t.slice(M.index+1),re=(oe="",Ee=0)=>{M.consumed+=oe,M.index+=Ee},P=oe=>{M.output+=oe.output!=null?oe.output:oe.value,re(oe.value)},se=()=>{let oe=1;for(;K()==="!"&&(K(2)!=="("||K(3)==="?");)V(),M.start++,oe++;return oe%2===0?!1:(M.negated=!0,M.start++,!0)},ue=oe=>{M[oe]++,L.push(oe)},te=oe=>{M[oe]--,L.pop()},W=oe=>{if(N.type==="globstar"){const Ee=M.braces>0&&(oe.type==="comma"||oe.type==="brace"),me=oe.extglob===!0||D.length&&(oe.type==="pipe"||oe.type==="paren");oe.type!=="slash"&&oe.type!=="paren"&&!Ee&&!me&&(M.output=M.output.slice(0,-N.output.length),N.type="star",N.value="*",N.output=R,M.output+=N.output)}if(D.length&&oe.type!=="paren"&&(D[D.length-1].inner+=oe.value),(oe.value||oe.output)&&P(oe),N&&N.type==="text"&&oe.type==="text"){N.output=(N.output||N.value)+oe.value,N.value+=oe.value;return}oe.prev=N,o.push(oe),N=oe},X=(oe,Ee)=>{const me={...c[Ee],conditions:1,inner:""};me.prev=N,me.parens=M.parens,me.output=M.output;const Te=(n.capture?"(":"")+me.open;ue("parens"),W({type:oe,value:Ee,output:M.output?"":h}),W({type:"paren",extglob:!0,value:V(),output:Te}),D.push(me)},J=oe=>{let Ee=oe.close+(n.capture?")":""),me;if(oe.type==="negate"){let Te=R;if(oe.inner&&oe.inner.length>1&&oe.inner.includes("/")&&(Te=S(n)),(Te!==R||O()||/^\)+$/.test(ne()))&&(Ee=oe.close=`)$))${Te}`),oe.inner.includes("*")&&(me=ne())&&/^\.[^\\/.]+$/.test(me)){const _e=tR(me,{...e,fastpaths:!1}).output;Ee=oe.close=`)${_e})${Te})`}oe.prev.type==="bos"&&(M.negatedExtglob=!0)}W({type:"paren",extglob:!0,value:z,output:Ee}),te("parens")};if(n.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let oe=!1,Ee=t.replace(q8e,(me,Te,_e,Re,ae,Ce)=>Re==="\\"?(oe=!0,me):Re==="?"?Te?Te+Re+(ae?x.repeat(ae.length):""):Ce===0?A+(ae?x.repeat(ae.length):""):x.repeat(_e.length):Re==="."?u.repeat(_e.length):Re==="*"?Te?Te+Re+(ae?R:""):R:Te?me:`\\${me}`);return oe===!0&&(n.unescape===!0?Ee=Ee.replace(/\\/g,""):Ee=Ee.replace(/\\+/g,me=>me.length%2===0?"\\\\":me?"\\":"")),Ee===t&&n.contains===!0?(M.output=t,M):(M.output=Vl.wrapOutput(Ee,M,e),M)}for(;!O();){if(z=V(),z==="\0")continue;if(z==="\\"){const me=K();if(me==="/"&&n.bash!==!0||me==="."||me===";")continue;if(!me){z+="\\",W({type:"text",value:z});continue}const Te=/^\\+/.exec(ne());let _e=0;if(Te&&Te[0].length>2&&(_e=Te[0].length,M.index+=_e,_e%2!==0&&(z+="\\")),n.unescape===!0?z=V():z+=V(),M.brackets===0){W({type:"text",value:z});continue}}if(M.brackets>0&&(z!=="]"||N.value==="["||N.value==="[^")){if(n.posix!==!1&&z===":"){const me=N.value.slice(1);if(me.includes("[")&&(N.posix=!0,me.includes(":"))){const Te=N.value.lastIndexOf("["),_e=N.value.slice(0,Te),Re=N.value.slice(Te+2),ae=$8e[Re];if(ae){N.value=_e+ae,M.backtrack=!0,V(),!s.output&&o.indexOf(N)===1&&(s.output=h);continue}}}(z==="["&&K()!==":"||z==="-"&&K()==="]")&&(z=`\\${z}`),z==="]"&&(N.value==="["||N.value==="[^")&&(z=`\\${z}`),n.posix===!0&&z==="!"&&N.value==="["&&(z="^"),N.value+=z,P({value:z});continue}if(M.quotes===1&&z!=='"'){z=Vl.escapeRegex(z),N.value+=z,P({value:z});continue}if(z==='"'){M.quotes=M.quotes===1?0:1,n.keepQuotes===!0&&W({type:"text",value:z});continue}if(z==="("){ue("parens"),W({type:"paren",value:z});continue}if(z===")"){if(M.parens===0&&n.strictBrackets===!0)throw new SyntaxError(Mp("opening","("));const me=D[D.length-1];if(me&&M.parens===me.parens+1){J(D.pop());continue}W({type:"paren",value:z,output:M.parens?")":"\\)"}),te("parens");continue}if(z==="["){if(n.nobracket===!0||!ne().includes("]")){if(n.nobracket!==!0&&n.strictBrackets===!0)throw new SyntaxError(Mp("closing","]"));z=`\\${z}`}else ue("brackets");W({type:"bracket",value:z});continue}if(z==="]"){if(n.nobracket===!0||N&&N.type==="bracket"&&N.value.length===1){W({type:"text",value:z,output:`\\${z}`});continue}if(M.brackets===0){if(n.strictBrackets===!0)throw new SyntaxError(Mp("opening","["));W({type:"text",value:z,output:`\\${z}`});continue}te("brackets");const me=N.value.slice(1);if(N.posix!==!0&&me[0]==="^"&&!me.includes("/")&&(z=`/${z}`),N.value+=z,P({value:z}),n.literalBrackets===!1||Vl.hasRegexChars(me))continue;const Te=Vl.escapeRegex(N.value);if(M.output=M.output.slice(0,-N.value.length),n.literalBrackets===!0){M.output+=Te,N.value=Te;continue}N.value=`(${a}${Te}|${N.value})`,M.output+=N.value;continue}if(z==="{"&&n.nobrace!==!0){ue("braces");const me={type:"brace",value:z,output:"(",outputIndex:M.output.length,tokensIndex:M.tokens.length};k.push(me),W(me);continue}if(z==="}"){const me=k[k.length-1];if(n.nobrace===!0||!me){W({type:"text",value:z,output:z});continue}let Te=")";if(me.dots===!0){const _e=o.slice(),Re=[];for(let ae=_e.length-1;ae>=0&&(o.pop(),_e[ae].type!=="brace");ae--)_e[ae].type!=="dots"&&Re.unshift(_e[ae].value);Te=Y8e(Re,n),M.backtrack=!0}if(me.comma!==!0&&me.dots!==!0){const _e=M.output.slice(0,me.outputIndex),Re=M.tokens.slice(me.tokensIndex);me.value=me.output="\\{",z=Te="\\}",M.output=_e;for(const ae of Re)M.output+=ae.output||ae.value}W({type:"brace",value:z,output:Te}),te("braces"),k.pop();continue}if(z==="|"){D.length>0&&D[D.length-1].conditions++,W({type:"text",value:z});continue}if(z===","){let me=z;const Te=k[k.length-1];Te&&L[L.length-1]==="braces"&&(Te.comma=!0,me="|"),W({type:"comma",value:z,output:me});continue}if(z==="/"){if(N.type==="dot"&&M.index===M.start+1){M.start=M.index+1,M.consumed="",M.output="",o.pop(),N=s;continue}W({type:"slash",value:z,output:d});continue}if(z==="."){if(M.braces>0&&N.type==="dot"){N.value==="."&&(N.output=u);const me=k[k.length-1];N.type="dots",N.output+=z,N.value+=z,me.dots=!0;continue}if(M.braces+M.parens===0&&N.type!=="bos"&&N.type!=="slash"){W({type:"text",value:z,output:u});continue}W({type:"dot",value:z,output:u});continue}if(z==="?"){if(!(N&&N.value==="(")&&n.noextglob!==!0&&K()==="("&&K(2)!=="?"){X("qmark",z);continue}if(N&&N.type==="paren"){const me=K();let Te=z;(N.value==="("&&!/[!=<:]/.test(me)||me==="<"&&!/<([!=]|\w+>)/.test(ne()))&&(Te=`\\${z}`),W({type:"text",value:z,output:Te});continue}if(n.dot!==!0&&(N.type==="slash"||N.type==="bos")){W({type:"qmark",value:z,output:_});continue}W({type:"qmark",value:z,output:x});continue}if(z==="!"){if(n.noextglob!==!0&&K()==="("&&(K(2)!=="?"||!/[!=<:]/.test(K(3)))){X("negate",z);continue}if(n.nonegate!==!0&&M.index===0){se();continue}}if(z==="+"){if(n.noextglob!==!0&&K()==="("&&K(2)!=="?"){X("plus",z);continue}if(N&&N.value==="("||n.regex===!1){W({type:"plus",value:z,output:f});continue}if(N&&(N.type==="bracket"||N.type==="paren"||N.type==="brace")||M.parens>0){W({type:"plus",value:z});continue}W({type:"plus",value:f});continue}if(z==="@"){if(n.noextglob!==!0&&K()==="("&&K(2)!=="?"){W({type:"at",extglob:!0,value:z,output:""});continue}W({type:"text",value:z});continue}if(z!=="*"){(z==="$"||z==="^")&&(z=`\\${z}`);const me=X8e.exec(ne());me&&(z+=me[0],M.index+=me[0].length),W({type:"text",value:z});continue}if(N&&(N.type==="globstar"||N.star===!0)){N.type="star",N.star=!0,N.value+=z,N.output=R,M.backtrack=!0,M.globstar=!0,re(z);continue}let oe=ne();if(n.noextglob!==!0&&/^\([^?]/.test(oe)){X("star",z);continue}if(N.type==="star"){if(n.noglobstar===!0){re(z);continue}const me=N.prev,Te=me.prev,_e=me.type==="slash"||me.type==="bos",Re=Te&&(Te.type==="star"||Te.type==="globstar");if(n.bash===!0&&(!_e||oe[0]&&oe[0]!=="/")){W({type:"star",value:z,output:""});continue}const ae=M.braces>0&&(me.type==="comma"||me.type==="brace"),Ce=D.length&&(me.type==="pipe"||me.type==="paren");if(!_e&&me.type!=="paren"&&!ae&&!Ce){W({type:"star",value:z,output:""});continue}for(;oe.slice(0,3)==="/**";){const Pe=t[M.index+4];if(Pe&&Pe!=="/")break;oe=oe.slice(3),re("/**",3)}if(me.type==="bos"&&O()){N.type="globstar",N.value+=z,N.output=S(n),M.output=N.output,M.globstar=!0,re(z);continue}if(me.type==="slash"&&me.prev.type!=="bos"&&!Re&&O()){M.output=M.output.slice(0,-(me.output+N.output).length),me.output=`(?:${me.output}`,N.type="globstar",N.output=S(n)+(n.strictSlashes?")":"|$)"),N.value+=z,M.globstar=!0,M.output+=me.output+N.output,re(z);continue}if(me.type==="slash"&&me.prev.type!=="bos"&&oe[0]==="/"){const Pe=oe[1]!==void 0?"|$":"";M.output=M.output.slice(0,-(me.output+N.output).length),me.output=`(?:${me.output}`,N.type="globstar",N.output=`${S(n)}${d}|${d}${Pe})`,N.value+=z,M.output+=me.output+N.output,M.globstar=!0,re(z+V()),W({type:"slash",value:"/",output:""});continue}if(me.type==="bos"&&oe[0]==="/"){N.type="globstar",N.value+=z,N.output=`(?:^|${d}|${S(n)}${d})`,M.output=N.output,M.globstar=!0,re(z+V()),W({type:"slash",value:"/",output:""});continue}M.output=M.output.slice(0,-N.output.length),N.type="globstar",N.output=S(n),N.value+=z,M.output+=N.output,M.globstar=!0,re(z);continue}const Ee={type:"star",value:z,output:R};if(n.bash===!0){Ee.output=".*?",(N.type==="bos"||N.type==="slash")&&(Ee.output=C+Ee.output),W(Ee);continue}if(N&&(N.type==="bracket"||N.type==="paren")&&n.regex===!0){Ee.output=z,W(Ee);continue}(M.index===M.start||N.type==="slash"||N.type==="dot")&&(N.type==="dot"?(M.output+=g,N.output+=g):n.dot===!0?(M.output+=y,N.output+=y):(M.output+=C,N.output+=C),K()!=="*"&&(M.output+=h,N.output+=h)),W(Ee)}for(;M.brackets>0;){if(n.strictBrackets===!0)throw new SyntaxError(Mp("closing","]"));M.output=Vl.escapeLast(M.output,"["),te("brackets")}for(;M.parens>0;){if(n.strictBrackets===!0)throw new SyntaxError(Mp("closing",")"));M.output=Vl.escapeLast(M.output,"("),te("parens")}for(;M.braces>0;){if(n.strictBrackets===!0)throw new SyntaxError(Mp("closing","}"));M.output=Vl.escapeLast(M.output,"{"),te("braces")}if(n.strictSlashes!==!0&&(N.type==="star"||N.type==="bracket")&&W({type:"maybe_slash",value:"",output:`${d}?`}),M.backtrack===!0){M.output="";for(const oe of M.tokens)M.output+=oe.output!=null?oe.output:oe.value,oe.suffix&&(M.output+=oe.suffix)}return M};tR.fastpaths=(t,e)=>{const n={...e},r=typeof n.maxLength=="number"?Math.min(Y_,n.maxLength):Y_,i=t.length;if(i>r)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${r}`);t=GY[t]||t;const{DOT_LITERAL:s,SLASH_LITERAL:o,ONE_CHAR:a,DOTS_SLASH:l,NO_DOT:c,NO_DOTS:u,NO_DOTS_SLASH:f,STAR:d,START_ANCHOR:h}=q_.globChars(n.windows),p=n.dot?u:c,m=n.dot?f:c,g=n.capture?"":"?:",y={negated:!1,prefix:""};let x=n.bash===!0?".*?":d;n.capture&&(x=`(${x})`);const _=C=>C.noglobstar===!0?x:`(${g}(?:(?!${h}${C.dot?l:s}).)*?)`,w=C=>{switch(C){case"*":return`${p}${a}${x}`;case".*":return`${s}${a}${x}`;case"*.*":return`${p}${x}${s}${a}${x}`;case"*/*":return`${p}${x}${o}${a}${m}${x}`;case"**":return p+_(n);case"**/*":return`(?:${p}${_(n)}${o})?${m}${a}${x}`;case"**/*.*":return`(?:${p}${_(n)}${o})?${m}${x}${s}${a}${x}`;case"**/.*":return`(?:${p}${_(n)}${o})?${s}${a}${x}`;default:{const A=/^(.*?)\.(\w+)$/.exec(C);if(!A)return;const R=w(A[1]);return R?R+s+A[2]:void 0}}},T=Vl.removePrefix(t,y);let S=w(T);return S&&n.strictSlashes!==!0&&(S+=`${o}?`),S};var K8e=tR;const Z8e=W8e,AM=K8e,jY=Wy,Q8e=GE,J8e=t=>t&&typeof t=="object"&&!Array.isArray(t),Ui=(t,e,n=!1)=>{if(Array.isArray(t)){const u=t.map(f=>Ui(f,e,n));return f=>{for(const d of u){const h=d(f);if(h)return h}return!1}}const r=J8e(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");const i=e||{},s=i.windows,o=r?Ui.compileRe(t,e):Ui.makeRe(t,e,!1,!0),a=o.state;delete o.state;let l=()=>!1;if(i.ignore){const u={...e,ignore:null,onMatch:null,onResult:null};l=Ui(i.ignore,u,n)}const c=(u,f=!1)=>{const{isMatch:d,match:h,output:p}=Ui.test(u,o,e,{glob:t,posix:s}),m={glob:t,state:a,regex:o,posix:s,input:u,output:p,match:h,isMatch:d};return typeof i.onResult=="function"&&i.onResult(m),d===!1?(m.isMatch=!1,f?m:!1):l(u)?(typeof i.onIgnore=="function"&&i.onIgnore(m),m.isMatch=!1,f?m:!1):(typeof i.onMatch=="function"&&i.onMatch(m),f?m:!0)};return n&&(c.state=a),c};Ui.test=(t,e,n,{glob:r,posix:i}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};const s=n||{},o=s.format||(i?jY.toPosixSlashes:null);let a=t===r,l=a&&o?o(t):t;return a===!1&&(l=o?o(t):t,a=l===r),(a===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?a=Ui.matchBase(t,e,n,i):a=e.exec(l)),{isMatch:!!a,match:a,output:l}};Ui.matchBase=(t,e,n)=>(e instanceof RegExp?e:Ui.makeRe(e,n)).test(jY.basename(t));Ui.isMatch=(t,e,n)=>Ui(e,n)(t);Ui.parse=(t,e)=>Array.isArray(t)?t.map(n=>Ui.parse(n,e)):AM(t,{...e,fastpaths:!1});Ui.scan=(t,e)=>Z8e(t,e);Ui.compileRe=(t,e,n=!1,r=!1)=>{if(n===!0)return t.output;const i=e||{},s=i.contains?"":"^",o=i.contains?"":"$";let a=`${s}(?:${t.output})${o}`;t&&t.negated===!0&&(a=`^(?!${a}).*$`);const l=Ui.toRegex(a,e);return r===!0&&(l.state=t),l};Ui.makeRe=(t,e={},n=!1,r=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(i.output=AM.fastpaths(t,e)),i.output||(i=AM(t,e)),Ui.compileRe(i,e,n,r)};Ui.toRegex=(t,e)=>{try{const n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(n){if(e&&e.debug===!0)throw n;return/$^/}};Ui.constants=Q8e;var eRe=Ui;const VY=eRe,tRe=Wy;function WY(t,e,n=!1){return e&&(e.windows===null||e.windows===void 0)&&(e={...e,windows:tRe.isWindows()}),VY(t,e,n)}Object.assign(WY,VY);var nRe=WY;const MM=mu(nRe);function $Y(t,e,n=""){if(!t)return;const r=n?`${n}/${t.name}`:t.name;if(t.isDirectory){let i=function(o,a){o.readEntries(l=>{l.length&&(a(l),i(o,a))})};const s=t.createReader();i(s,o=>{o.forEach(a=>{a&&$Y(a,e,r)})})}else if(t.isFile){const i=t;e(r,null),i.file(s=>{const o=URL.createObjectURL(s);e(r,o)})}}function rRe(t,e=null,n="**/.DS_Store"){const r=v.useRef(null),[i,s]=v.useState(!1),[o,a]=v.useState({}),{isIncluded:l,shouldIgnore:c}=v.useMemo(()=>({isIncluded:e?MM(e):null,shouldIgnore:MM(n)}),[e,n]),u=v.useCallback((g,y)=>{c(g)||e&&!l(g)||a(x=>({...x,[g]:y}))},[o,l,c]),f=v.useCallback((g=!1)=>a(y=>y?g?(Object.keys(y).filter(x=>y[x]!==null).forEach(x=>{URL.revokeObjectURL(y[x])}),{}):{}:{}),[]),d=v.useCallback(g=>{g.preventDefault(),g.stopPropagation(),s(!0)},[]),h=v.useCallback(g=>{g.preventDefault(),g.stopPropagation(),s(!1)},[]),p=v.useCallback(g=>{g.preventDefault(),g.stopPropagation()},[]),m=v.useCallback(g=>{var y;g.preventDefault(),g.stopPropagation();const x=(y=g.dataTransfer)==null?void 0:y.items;(Array.from(x)||[]).map(_=>{const w=_.webkitGetAsEntry();w&&$Y(w,u)}),s(!1)},[u]);return v.useEffect(()=>{t&&Object.values(o||{}).length!==0&&Object.values(o).indexOf(null)===-1&&t(o,f)},[o]),v.useEffect(()=>{if(!r.current)return;r.current.addEventListener("dragenter",d),r.current.addEventListener("dragleave",h),r.current.addEventListener("dragover",p),r.current.addEventListener("drop",m);const g=r.current;return()=>{g==null||g.removeEventListener("dragenter",d),g==null||g.removeEventListener("dragleave",h),g==null||g.removeEventListener("dragover",p),g==null||g.removeEventListener("drop",m)}},[r.current,d,h,p,m]),{ref:r,files:o,isDragActive:i}}const iRe="_dropContainer_nq8kl_1",sRe="_fadeContainer_nq8kl_7",oRe="_dropPrompt_nq8kl_13",nR=({onLoad:t,prompt:e="Drop files here",children:n,innerStyle:r={},...i})=>{const{ref:s,files:o,isDragActive:a}=rRe(t);return H.jsxs("div",{ref:s,className:iRe,...i,children:[a&&H.jsx("div",{className:oRe,"data-text":e}),H.jsx("div",{className:sRe,style:{opacity:a?.1:null,...r},children:n})]})},XY={},CM={},qY=[-90,0,0].map(t=>t*Math.PI/180);function aRe(t,e,{scale:n=1,rotation:r=qY,...i}={}){const s=[];return Object.keys(t).forEach(o=>{o.toLowerCase().split(".").pop()==="urdf"&&s.push(o)}),s.forEach(o=>{e.publish(NE([{tag:"Urdf",src:o,key:o,assets:t,scale:n,rotation:r,...i}]))}),s.length<=0?t:{}}function lRe(t,e,{scale:n=1,rotation:r=qY,...i}={}){const s=[],o=/\.(mjcf|mjcf\.xml)$/;return Object.keys(t).forEach(a=>{o.test(a.toLowerCase())&&s.push(a)}),s.forEach(a=>{e.publish(NE([{tag:"MuJoCo",src:a,key:a,assets:t,scale:n,rotation:r,...i}]))}),s.length<=0?t:{}}const YY=({stream:t,children:e,...n})=>{const r=v.useCallback((i,s)=>{i=aRe(i,t,n),i=lRe(i,t,n),Object.keys(i).forEach((o,a)=>{const l=o.toLowerCase().split(".").pop();let c,u,f=[0,0,0];if(l==="obj")c="Obj",u=i[o];else if(l==="dae")c="Dae",u=i[o];else if(l==="stl")c="Stl",u=i[o];else if(l==="pcd")c="Pcd",u=i[o];else if(l==="ply")c="Ply",u=i[o];else if(l==="splat")c="Splat",u=i[o],f=[-90,0,-90].map(d=>d*Math.PI/180);else if(l==="glb")c="Glb",u=i[o];else if(l==="gltf")c="Glb",u=i[o];else for(const d of Object.keys(CM)){const h=CM[d];if(MM(h.pattern)(o)){c=h.tag,u=i[o];break}}if(!c){console.warn(`Unsupported file type: ${l}`);return}t.publish(NE([{tag:c,src:u,key:`${o}`,assets:i,rotation:f}]))}),s()},[t]);return H.jsx(nR,{onLoad:r,...n,children:e})},$y=v.createContext({showError:t=>console.error(t),showInfo:t=>console.info(t),showSuccess:t=>console.log(t),showWarning:t=>console.warn(t),showModal:t=>{console.log(t)}}),cRe=$y.Provider,uRe=({style:t={display:"flex",flexDirection:"row"},...e})=>{const n=v.useMemo(()=>{const s=gu.parse(eu.location.search);return typeof s.collapseMenu=="string"&&(s.collapseMenu=s.collapseMenu.toLowerCase()),s},[]),r=v.useMemo(()=>n.collapseMenu==="true",[n.collapseMenu]),{downlink:i}=Mr();return H.jsxs(H.Fragment,{children:[H.jsx(YY,{stream:i,style:t,innerStyle:{display:"flex",flexDirection:"row"},children:H.jsx(ZY,{className:T8e,stream:i,...e})}),H.jsx(j$,{theme:{sizes:{rootWidth:"380px",controlWidth:"200px",numberInputMinWidth:"56px"}},collapsed:r})]})};function zx(t){return!t||t.length===0?null:(Array.isArray(t)?t:[t]).filter(e=>e!==null).filter(e=>!(e!=null&&e.hide)).map(e=>{if(typeof e=="string")return e;{const{key:n,...r}=e;return H.jsx(KY,{_key:n,...r},n)}})}function KY({_key:t,tag:e,children:n,className:r,...i}){const s=W4e[e]||XY[e]||e,{showWarning:o}=v.useContext($y);if(!e)return o(`No tag provided for component <${e} ${t} className="${r}">${n} </...>`),n;const a=(n||[]).map(l=>{if(typeof l=="string")return l;const{key:c,...u}=l;return H.jsx(KY,{_key:c,...u},c)});return typeof s=="string"?H.jsx(s,{className:r,...i,children:a},t):H.jsx(s,{_key:t,className:r,...i,children:a},t)}const{Buffer:fRe}=S8e;function ZY({stream:t,children:e,rawChildren:n,htmlChildren:r,bgChildren:i,...s}){const{children:o,rawChildren:a,bgChildren:l,htmlChildren:c,ops:u,...f}=OE(),d=v.useMemo(()=>gu.parse(eu.location.search),[]),{response:h}=qMe(d.scene,[]);v.useEffect(()=>{u.rawUpdate(m=>({...m,frameloop:d.frameloop||"demand"}))},[d.frameloop]),v.useEffect(()=>{const m=[t.subscribe("SET",u.set),t.subscribe("ADD",u.add),t.subscribe("UPDATE",u.update),t.subscribe("UPSERT",u.upsert),t.subscribe("REMOVE",u.removeByKey)];return()=>m.forEach(g=>g())},[t]);const{showError:p}=v.useContext($y);return v.useEffect(()=>{if(!d.scene)return;const m=d.scene.toLowerCase();let g;if(m.endsWith(".json"))g=h.data;else if(m.endsWith(".yml")||m.endsWith(".yaml"))g=p8e.load(h.data);else if(d.scene)try{const y=new fRe(d.scene,"base64");g=rq(y)}catch(y){console.warn("Failed to parse scene",y)}else return;g&&u.set(gq({tag:"Scene",...g}))},[d.scene,h.data]),vr(()=>({"Camera Control":Yp({show_cameras:{value:!1,label:"Show Cameras"}},{collapsed:!0}),Share:Oy(()=>{const m=aq({children:o,rawChildren:a,bgChildren:l,htmlChildren:c,scene:f});if(m.length>1e4)return p(`
              The scene likely contains a large amount of data. To share, please replace 
              geometry data with an URI. Length is ${m.length} bytes.
            `);const g=String.fromCharCode.apply(null,m),y=btoa(g),x=new URL(eu.location);x.searchParams.set("scene",y),eu.location.href=x.toString()},{label:"Share Scene"}),Scene:Yp({}),Render:Yp({},{collapsed:!0}),"Scene.Options":Yp({},{collapsed:!0})}),[f]),H.jsx(H8,{rawChildren:zx(a)||n,bgChildren:zx(l)||i,htmlChildren:zx(c)||r,...f,...s,children:zx(o)||e})}function dRe({data:t,_ref:e,color:n,matrix:r,hide:i,...s}){At();const o=v.useRef(),a=e||o;return v.useLayoutEffect(()=>{const l=a.current;r&&r.length===16&&(l.matrix.fromArray(r),l.matrix.decompose(l.position,l.quaternion,l.scale),l.rotation.setFromQuaternion(l.quaternion))},[a.current,r]),i?null:(v.useEffect(()=>()=>t.dispose(),[t]),H.jsx("mesh",{ref:a,geometry:t,...s,children:H.jsx("meshPhysicalMaterial",{color:n||"#ffffff",roughness:0})}))}function hRe({data:t,_ref:e,matrix:n,color:r,hide:i,...s}){const{scene:o}=At(),a=v.useRef(),l=e||a;return v.useLayoutEffect(()=>{n&&n.length===16&&(t.matrix.fromArray(n),t.matrix.decompose(t.position,t.quaternion,t.scale),t.rotation.setFromQuaternion(t.quaternion))},[t,n]),v.useLayoutEffect(()=>{r&&t.traverse(c=>{c.isMesh&&c.material.color.set(r)})},[t,r]),v.useEffect(()=>()=>{o.remove(t)},[t]),i?null:H.jsx("primitive",{ref:l,object:t,...s})}const rR={basic:Fr,phong:nu,lambert:nh,standard:Ka,normal:Hb,depth:zm,physical:Ur,points:Ha,line:oi,lineDashed:N6,sprite:Ab,shadow:L6,rawShader:D6};function pRe({data:t,_ref:e,wireframe:n=!1,color:r=null,matrix:i,material:s,materialType:o,hide:a,...l}){const c=v.useRef(),u=e||c;v.useLayoutEffect(()=>{const d=u.current;d&&i&&(d.matrix.fromArray(i),d.matrix.decompose(d.position,d.quaternion,d.scale),d.rotation.setFromQuaternion(d.quaternion))},[i,u.current]);const{scene:f}=At();return v.useLayoutEffect(()=>{let d;if(o){const h=rR[o];d=new h({color:r,...s})}return t==null||t.traverse(h=>{h.castShadow=!0,h.receiveShadow=!0,d&&(h.material=d),h.material&&(h.material.wireframe=n,h.material.needsUpdate=!0)}),()=>{f.remove(t),d==null||d.dispose()}},[t,r,n,o,s]),!t||a?null:H.jsx("primitive",{ref:u,receiveShadow:!0,castShadow:!0,object:t,...l})}function mRe({data:t,_ref:e,size:n=.005,color:r,matrix:i,hide:s,...o}){const a=v.useRef(),l=e||a;return v.useLayoutEffect(()=>{const c=l.current;c&&i&&(c.matrix.fromArray(i),c.matrix.decompose(c.position,c.quaternion,c.scale),c.rotation.setFromQuaternion(c.quaternion))},[i,l.current]),!t||s?null:(t.attributes.normal||console.log("data.attributes.normal is missing"),t&&!t.attributes.normal&&(t.index?(console.log("compute normals for data. "),t.computeVertexNormals()):console.log("Both data.index and data.attributes.normal are missing. Won't be able to compute surface normals.")),t.attributes.normal?H.jsx("mesh",{ref:l,geometry:t,castShadow:!0,receiveShadow:!0,...o,children:H.jsx("meshStandardMaterial",{vertexColors:!0})}):r?H.jsxs("points",{ref:l,...o,children:[H.jsx("bufferGeometry",{...t}),H.jsx("pointsMaterial",{size:n,vertexColors:!0,color:r,sizeAttenuation:!0})]}):H.jsx("points",{ref:l,geometry:t,...o,children:H.jsx("pointsMaterial",{attach:"material",vertexColors:!0,size:n,sizeAttenuation:!0,opacity:1})}))}function gRe({data:t,_ref:e,size:n=.0015,hide:r,matrix:i,...s}){const o=v.useRef(),a=e||o;return v.useLayoutEffect(()=>{const l=a.current;l&&i&&(l.matrix.fromArray(i),l.matrix.decompose(l.position,l.quaternion,l.scale),l.rotation.setFromQuaternion(l.quaternion))},[i,a.current]),!t||r?null:(t==null||t.material,H.jsx("points",{ref:a,...s,geometry:t.geometry,children:H.jsx("pointsMaterial",{attach:"material",vertexColors:!0,size:n,sizeAttenuation:!0,transparent:!0,alphaTest:1,opacity:1})}))}function yRe({robot:t,_ref:e,jointValues:n={},matrix:r,materialType:i="physical",material:s,hide:o,...a}){const{scene:l}=At();return v.useEffect(()=>{r&&r.length===16&&(t.matrix.fromArray(r),t.matrix.decompose(t.position,t.quaternion,t.scale),t.rotation.setFromQuaternion(t.quaternion))},[t,r]),v.useEffect(()=>{if(!i)return;const c=rR[i];return t.traverseVisible(u=>{u.isMesh&&u.material&&(u.material=new c(s),u.material.needsUpdate=!0)}),()=>{}},[t,i]),v.useEffect(()=>{if(i)return t.traverseVisible(c=>{!c.isMesh||!c.material||(Array.isArray(c.material)?c.material.forEach((u,f)=>{Object.assign(u,s),c.material[f].needsUpdate=!0}):(Object.assign(c.material,s),c.material.needsUpdate=!0))}),()=>{}},[t,JSON.stringify(s)]),v.useEffect(()=>(n&&(t==null||t.setJointValues(n)),()=>{l.remove(t)}),[t,n]),o?null:H.jsx("primitive",{ref:e,object:t,...a})}function vRe({data:t,_ref:e,matrix:n,color:r,materialType:i,material:s,hide:o,...a}){const{scene:l}=At();return v.useLayoutEffect(()=>{n&&n.length===16&&(t.scene.matrix.fromArray(n),t.scene.matrix.decompose(t.scene.position,t.scene.quaternion,t.scene.scale),t.scene.rotation.setFromQuaternion(t.scene.quaternion))},[t,n]),v.useLayoutEffect(()=>{if(i){const c=rR[i],u=new c({color:r,...s});return t.scene.traverse(f=>{f.material=u}),()=>u.dispose()}else r&&t.scene.traverse(c=>{var u,f;c!=null&&c.isMesh&&((f=(u=c.material)==null?void 0:u.color)==null||f.set(r))})},[t,r,i,s]),v.useEffect(()=>()=>{l.remove(t.scene)},[t]),o?null:H.jsx("primitive",{ref:e,object:t.scene,...a})}function K_({_key:t,src:e,text:n,buff:r,hide:i,encoding:s="ascii",onLoad:o,...a}){const[l,c]=v.useState();v.useEffect(()=>{if(!l&&i)return;const f=new m5;r&&(n=new TextDecoder(s).decode(r)),n?f.parse(n,"",c):e&&f.load(e,c)},[e,i]);const{sendMsg:u}=Mr();return v.useEffect(()=>{l&&(typeof o=="function"&&o(),typeof o=="string"&&u({ts:Date.now(),etype:"LOAD",key:t,value:o}))},[l]),l?H.jsx(vRe,{data:l,hide:i,...a}):null}function QY({_key:t,src:e,text:n,buff:r,mtl:i,hide:s,encoding:o="ascii",onLoad:a,...l}){const[c,u]=v.useState();v.useEffect(()=>{if(!c&&s)return;const d=new IG;i?new fde().load(i,h=>{h.preload(),d.setMaterials(h),r&&(n=new TextDecoder(o).decode(r)),n?u(d.parse(n)):e&&d.load(e,u)}):(r&&(n=new TextDecoder(o).decode(r)),n?u(d.parse(n)):e&&d.load(e,u))},[e,s]);const{sendMsg:f}=Mr();return v.useEffect(()=>{c&&(typeof a=="function"&&a(),typeof a=="string"&&f({ts:Date.now(),etype:"LOAD",key:t,value:a}))},[c]),c?H.jsx(pRe,{data:c,hide:s,...l}):null}function JY({_key:t,src:e,text:n,buff:r,hide:i,encoding:s="ascii",onLoad:o,...a}){const[l,c]=v.useState();v.useEffect(()=>{if(!l&&i)return;const f=new PG;r&&(n=new TextDecoder(s).decode(r)),n?c(f.parse(n,"")):e&&f.load(e,c)},[e,i]);const{sendMsg:u}=Mr();return v.useEffect(()=>{l&&(typeof o=="function"&&o(),typeof o=="string"&&u({ts:Date.now(),etype:"LOAD",key:t,value:o}))},[l]),l?H.jsx(gRe,{data:l,hide:i,...a}):null}function eK({_key:t,src:e,text:n,buff:r,hide:i,encoding:s="ascii",onLoad:o,...a}){const[l,c]=v.useState();v.useEffect(()=>{if(!l&&i)return;const f=new bde;if(r&&(n=new TextDecoder(s).decode(r)),n){const d=f.parse(n);c(d)}else e&&f.load(e,c)},[e,i]);const{sendMsg:u}=Mr();return v.useEffect(()=>{l&&(typeof o=="function"&&o(),typeof o=="string"&&u({ts:Date.now(),etype:"LOAD",key:t,value:o}))},[l]),l?H.jsx(mRe,{data:l,hide:i,...a}):null}const FF=new $,xRe=new xr,Hx=new et,Hu=new et,Gx=new bn,jx=new $(1,1,1),Vx=new $;class jE extends yn{constructor(){super(),tn(this,"urdfNode"),tn(this,"urdfName"),this.urdfNode=null,this.urdfName=""}copy(e,n=!1){return super.copy(e,n),this.urdfNode=e.urdfNode,this.urdfName=e.urdfName,this}}class tK extends jE{constructor(){super(),tn(this,"isURDFCollider"),this.isURDFCollider=!0,this.type="URDFCollider"}}class nK extends jE{constructor(){super(),tn(this,"isURDFVisual"),this.isURDFVisual=!0,this.type="URDFVisual"}}class RM extends jE{constructor(){super(),tn(this,"isURDFLink"),this.isURDFLink=!0,this.type="URDFLink"}}class iR extends jE{constructor(){super(),tn(this,"isURDFJoint"),tn(this,"_jointType"),tn(this,"jointValue"),tn(this,"axis"),tn(this,"limit"),tn(this,"ignoreLimits"),tn(this,"origPosition"),tn(this,"origQuaternion"),tn(this,"mimicJoints"),this.isURDFJoint=!0,this.type="URDFJoint",this.jointValue=null,this._jointType="fixed",this.axis=new $(1,0,0),this.limit={lower:0,upper:0},this.ignoreLimits=!1,this.origPosition=null,this.origQuaternion=null,this.mimicJoints=[]}get jointType(){return this._jointType}set jointType(e){if(this.jointType!==e)switch(this._jointType=e,this.matrixWorldNeedsUpdate=!0,e){case"fixed":this.jointValue=[];break;case"continuous":case"revolute":case"prismatic":this.jointValue=new Array(1).fill(0);break;case"planar":this.jointValue=new Array(3).fill(0),this.axis=new $(0,0,1);break;case"floating":this.jointValue=new Array(6).fill(0);break}}get angle(){return this.jointValue?this.jointValue[0]:0}copy(e,n=!1){return super.copy(e,n),this.jointType=e.jointType,this.axis=e.axis.clone(),this.limit.lower=e.limit.lower,this.limit.upper=e.limit.upper,this.ignoreLimits=e.ignoreLimits,this.jointValue=e.jointValue?[...e.jointValue]:null,this.origPosition=e.origPosition?e.origPosition.clone():null,this.origQuaternion=e.origQuaternion?e.origQuaternion.clone():null,this.mimicJoints=e.mimicJoints?[...e.mimicJoints]:[],this}setJointValue(...e){e=e.map(r=>r===null?null:parseFloat(r)),(!this.origPosition||!this.origQuaternion)&&(this.origPosition=this.position.clone(),this.origQuaternion=this.quaternion.clone());let n=!1;switch(this.mimicJoints.forEach(r=>{n=r.updateFromMimickedJoint(...e)||n}),this.jointType){case"fixed":return n;case"continuous":case"revolute":{let r=e[0];return r==null||r===this.jointValue[0]?n:(!this.ignoreLimits&&this.jointType==="revolute"&&(r=Math.min(this.limit.upper,r),r=Math.max(this.limit.lower,r)),this.quaternion.setFromAxisAngle(this.axis,r).premultiply(this.origQuaternion),this.jointValue[0]!==r?(this.jointValue[0]=r,this.matrixWorldNeedsUpdate=!0,!0):n)}case"prismatic":{let r=e[0];return r==null||r===this.jointValue[0]?n:(this.ignoreLimits||(r=Math.min(this.limit.upper,r),r=Math.max(this.limit.lower,r)),this.position.copy(this.origPosition),FF.copy(this.axis).applyEuler(this.rotation),this.position.addScaledVector(FF,r),this.jointValue[0]!==r?(this.jointValue[0]=r,this.matrixWorldNeedsUpdate=!0,!0):n)}case"floating":return this.jointValue.every((r,i)=>e[i]===r||e[i]===null)?n:(this.jointValue[0]=e[0]!==null?e[0]:this.jointValue[0],this.jointValue[1]=e[1]!==null?e[1]:this.jointValue[1],this.jointValue[2]=e[2]!==null?e[2]:this.jointValue[2],this.jointValue[3]=e[3]!==null?e[3]:this.jointValue[3],this.jointValue[4]=e[4]!==null?e[4]:this.jointValue[4],this.jointValue[5]=e[5]!==null?e[5]:this.jointValue[5],Hu.compose(this.origPosition,this.origQuaternion,jx),Gx.setFromEuler(xRe.set(this.jointValue[3],this.jointValue[4],this.jointValue[5],"XYZ")),Vx.set(this.jointValue[0],this.jointValue[1],this.jointValue[2]),Hx.compose(Vx,Gx,jx),Hu.premultiply(Hx),this.position.setFromMatrixPosition(Hu),this.rotation.setFromRotationMatrix(Hu),this.matrixWorldNeedsUpdate=!0,!0);case"planar":return this.jointValue.every((r,i)=>e[i]===r||e[i]===null)?n:(this.jointValue[0]=e[0]!==null?e[0]:this.jointValue[0],this.jointValue[1]=e[1]!==null?e[1]:this.jointValue[1],this.jointValue[2]=e[2]!==null?e[2]:this.jointValue[2],Hu.compose(this.origPosition,this.origQuaternion,jx),Gx.setFromAxisAngle(this.axis,this.jointValue[2]),Vx.set(this.jointValue[0],this.jointValue[1],0),Hx.compose(Vx,Gx,jx),Hu.premultiply(Hx),this.position.setFromMatrixPosition(Hu),this.rotation.setFromRotationMatrix(Hu),this.matrixWorldNeedsUpdate=!0,!0);default:return n}}}class UF extends iR{constructor(){super(),tn(this,"mimicJoint"),tn(this,"offset"),tn(this,"multiplier"),this.type="URDFMimicJoint",this.mimicJoint=null,this.offset=0,this.multiplier=1}updateFromMimickedJoint(...e){const n=e.map(r=>r*this.multiplier+this.offset);return super.setJointValue(...n)}copy(e,n=!1){return super.copy(e,n),this.mimicJoint=e.mimicJoint,this.offset=e.offset,this.multiplier=e.multiplier,this}}class _Re extends RM{constructor(){super(),tn(this,"isURDFRobot"),tn(this,"urdfRobotNode"),tn(this,"robotName"),tn(this,"links"),tn(this,"joints"),tn(this,"colliders"),tn(this,"visual"),tn(this,"frames"),this.isURDFRobot=!0,this.urdfNode=null,this.urdfRobotNode=null,this.robotName=null,this.links={},this.joints={},this.colliders={},this.visual={},this.frames={}}copy(e,n=!1){super.copy(e,n),this.urdfRobotNode=e.urdfRobotNode,this.robotName=e.robotName,this.links={},this.joints={},this.colliders={},this.visual={},this.traverse(r=>{r instanceof iR&&r.urdfName in e.joints&&(this.joints[r.urdfName]=r),r instanceof RM&&r.urdfName in e.links&&(this.links[r.urdfName]=r),r instanceof tK&&r.urdfName in e.colliders&&(this.colliders[r.urdfName]=r),r instanceof nK&&r.urdfName in e.visual&&(this.visual[r.urdfName]=r)});for(const r in this.joints){const i=this.joints[r];i.mimicJoints=i.mimicJoints.map(s=>this.joints[s.urdfName])}return this.frames={...this.colliders,...this.visual,...this.links,...this.joints},this}getFrame(e){return this.frames[e]}setJointValue(e,...n){const r=this.joints?this.joints[e]:null;return r?r.setJointValue(...n):!1}setJointValues(e){let n=!1;for(const r in e){const i=e[r];Array.isArray(i)?n=this.setJointValue(r,...i)||n:n=this.setJointValue(r,i)||n}return n}}new $;new $;new $;new $;new $;new $;new $;new Oi;class bRe extends Br{constructor(e){super(e)}load(e,n,r,i){const s=this,o=new qr(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(a))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){function n(c){const u=new DataView(c),f=32/8*3+32/8*3*3+16/8,d=u.getUint32(80,!0);if(80+32/8+d*f===u.byteLength)return!0;const h=[115,111,108,105,100];for(let p=0;p<5;p++)if(r(h,u,p))return!1;return!0}function r(c,u,f){for(let d=0,h=c.length;d<h;d++)if(c[d]!==u.getUint8(f+d))return!1;return!0}function i(c){const u=new DataView(c),f=u.getUint32(80,!0);let d,h,p,m=!1,g,y,x,_,w;for(let D=0;D<70;D++)u.getUint32(D,!1)==1129270351&&u.getUint8(D+4)==82&&u.getUint8(D+5)==61&&(m=!0,g=new Float32Array(f*3*3),y=u.getUint8(D+6)/255,x=u.getUint8(D+7)/255,_=u.getUint8(D+8)/255,w=u.getUint8(D+9)/255);const T=84,S=12*4+2,C=new gn,A=new Float32Array(f*3*3),R=new Float32Array(f*3*3),M=new wt;for(let D=0;D<f;D++){const k=T+D*S,L=u.getFloat32(k,!0),N=u.getFloat32(k+4,!0),z=u.getFloat32(k+8,!0);if(m){const O=u.getUint16(k+48,!0);O&32768?(d=y,h=x,p=_):(d=(O&31)/31,h=(O>>5&31)/31,p=(O>>10&31)/31)}for(let O=1;O<=3;O++){const K=k+O*12,V=D*3*3+(O-1)*3;A[V]=u.getFloat32(K,!0),A[V+1]=u.getFloat32(K+4,!0),A[V+2]=u.getFloat32(K+8,!0),R[V]=L,R[V+1]=N,R[V+2]=z,m&&(M.setRGB(d,h,p,Er),g[V]=M.r,g[V+1]=M.g,g[V+2]=M.b)}}return C.setAttribute("position",new fn(A,3)),C.setAttribute("normal",new fn(R,3)),m&&(C.setAttribute("color",new fn(g,3)),C.hasColors=!0,C.alpha=w),C}function s(c){const u=new gn,f=/solid([\s\S]*?)endsolid/g,d=/facet([\s\S]*?)endfacet/g,h=/solid\s(.+)/;let p=0;const m=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,g=new RegExp("vertex"+m+m+m,"g"),y=new RegExp("normal"+m+m+m,"g"),x=[],_=[],w=[],T=new $;let S,C=0,A=0,R=0;for(;(S=f.exec(c))!==null;){A=R;const M=S[0],D=(S=h.exec(M))!==null?S[1]:"";for(w.push(D);(S=d.exec(M))!==null;){let N=0,z=0;const O=S[0];for(;(S=y.exec(O))!==null;)T.x=parseFloat(S[1]),T.y=parseFloat(S[2]),T.z=parseFloat(S[3]),z++;for(;(S=g.exec(O))!==null;)x.push(parseFloat(S[1]),parseFloat(S[2]),parseFloat(S[3])),_.push(T.x,T.y,T.z),N++,R++;z!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+p),N!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+p),p++}const k=A,L=R-A;u.userData.groupNames=w,u.addGroup(k,L,C),C++}return u.setAttribute("position",new Dt(x,3)),u.setAttribute("normal",new Dt(_,3)),u}function o(c){return typeof c!="string"?new TextDecoder().decode(c):c}function a(c){if(typeof c=="string"){const u=new Uint8Array(c.length);for(let f=0;f<c.length;f++)u[f]=c.charCodeAt(f)&255;return u.buffer||u}else return c}const l=a(e);return n(l)?i(l):s(o(e))}}class BF extends Ey{constructor(e){super(e)}parse(e){function n(O){switch(O.image_type){case d:case m:if(O.colormap_length>256||O.colormap_size!==24||O.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case h:case p:case g:case y:if(O.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case f:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+O.image_type)}if(O.width<=0||O.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(O.pixel_size!==8&&O.pixel_size!==16&&O.pixel_size!==24&&O.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+O.pixel_size)}function r(O,K,V,ne,re){let P,se;const ue=V.pixel_size>>3,te=V.width*V.height*ue;if(K&&(se=re.subarray(ne,ne+=V.colormap_length*(V.colormap_size>>3))),O){P=new Uint8Array(te);let W,X,J,oe=0;const Ee=new Uint8Array(ue);for(;oe<te;)if(W=re[ne++],X=(W&127)+1,W&128){for(J=0;J<ue;++J)Ee[J]=re[ne++];for(J=0;J<X;++J)P.set(Ee,oe+J*ue);oe+=ue*X}else{for(X*=ue,J=0;J<X;++J)P[oe+J]=re[ne++];oe+=X}}else P=re.subarray(ne,ne+=K?V.width*V.height:te);return{pixel_data:P,palettes:se}}function i(O,K,V,ne,re,P,se,ue,te){const W=te;let X,J=0,oe,Ee;const me=M.width;for(Ee=K;Ee!==ne;Ee+=V)for(oe=re;oe!==se;oe+=P,J++)X=ue[J],O[(oe+me*Ee)*4+3]=255,O[(oe+me*Ee)*4+2]=W[X*3+0],O[(oe+me*Ee)*4+1]=W[X*3+1],O[(oe+me*Ee)*4+0]=W[X*3+2];return O}function s(O,K,V,ne,re,P,se,ue){let te,W=0,X,J;const oe=M.width;for(J=K;J!==ne;J+=V)for(X=re;X!==se;X+=P,W+=2)te=ue[W+0]+(ue[W+1]<<8),O[(X+oe*J)*4+0]=(te&31744)>>7,O[(X+oe*J)*4+1]=(te&992)>>2,O[(X+oe*J)*4+2]=(te&31)<<3,O[(X+oe*J)*4+3]=te&32768?0:255;return O}function o(O,K,V,ne,re,P,se,ue){let te=0,W,X;const J=M.width;for(X=K;X!==ne;X+=V)for(W=re;W!==se;W+=P,te+=3)O[(W+J*X)*4+3]=255,O[(W+J*X)*4+2]=ue[te+0],O[(W+J*X)*4+1]=ue[te+1],O[(W+J*X)*4+0]=ue[te+2];return O}function a(O,K,V,ne,re,P,se,ue){let te=0,W,X;const J=M.width;for(X=K;X!==ne;X+=V)for(W=re;W!==se;W+=P,te+=4)O[(W+J*X)*4+2]=ue[te+0],O[(W+J*X)*4+1]=ue[te+1],O[(W+J*X)*4+0]=ue[te+2],O[(W+J*X)*4+3]=ue[te+3];return O}function l(O,K,V,ne,re,P,se,ue){let te,W=0,X,J;const oe=M.width;for(J=K;J!==ne;J+=V)for(X=re;X!==se;X+=P,W++)te=ue[W],O[(X+oe*J)*4+0]=te,O[(X+oe*J)*4+1]=te,O[(X+oe*J)*4+2]=te,O[(X+oe*J)*4+3]=255;return O}function c(O,K,V,ne,re,P,se,ue){let te=0,W,X;const J=M.width;for(X=K;X!==ne;X+=V)for(W=re;W!==se;W+=P,te+=2)O[(W+J*X)*4+0]=ue[te+0],O[(W+J*X)*4+1]=ue[te+0],O[(W+J*X)*4+2]=ue[te+0],O[(W+J*X)*4+3]=ue[te+1];return O}function u(O,K,V,ne,re){let P,se,ue,te,W,X;switch((M.flags&x)>>_){default:case S:P=0,ue=1,W=K,se=0,te=1,X=V;break;case w:P=0,ue=1,W=K,se=V-1,te=-1,X=-1;break;case C:P=K-1,ue=-1,W=-1,se=0,te=1,X=V;break;case T:P=K-1,ue=-1,W=-1,se=V-1,te=-1,X=-1;break}if(L)switch(M.pixel_size){case 8:l(O,se,te,X,P,ue,W,ne);break;case 16:c(O,se,te,X,P,ue,W,ne);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(M.pixel_size){case 8:i(O,se,te,X,P,ue,W,ne,re);break;case 16:s(O,se,te,X,P,ue,W,ne);break;case 24:o(O,se,te,X,P,ue,W,ne);break;case 32:a(O,se,te,X,P,ue,W,ne);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return O}const f=0,d=1,h=2,p=3,m=9,g=10,y=11,x=48,_=4,w=0,T=1,S=2,C=3;if(e.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let A=0;const R=new Uint8Array(e),M={id_length:R[A++],colormap_type:R[A++],image_type:R[A++],colormap_index:R[A++]|R[A++]<<8,colormap_length:R[A++]|R[A++]<<8,colormap_size:R[A++],origin:[R[A++]|R[A++]<<8,R[A++]|R[A++]<<8],width:R[A++]|R[A++]<<8,height:R[A++]|R[A++]<<8,pixel_size:R[A++],flags:R[A++]};if(n(M),M.id_length+A>e.length)throw new Error("THREE.TGALoader: No data.");A+=M.id_length;let D=!1,k=!1,L=!1;switch(M.image_type){case m:D=!0,k=!0;break;case d:k=!0;break;case g:D=!0;break;case h:break;case y:D=!0,L=!0;break;case p:L=!0;break}const N=new Uint8Array(M.width*M.height*4),z=r(D,k,M,A,R);return u(N,M.width,M.height,z.pixel_data,z.palettes),{data:N,width:M.width,height:M.height,flipY:!0,generateMipmaps:!0,minFilter:Ts}}}class ERe extends Br{load(e,n,r,i){const s=this,o=s.path===""?Ms.extractUrlBase(e):s.path,a=new qr(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{n(s.parse(l,o))}catch(c){i?i(c):console.error(c),s.manager.itemError(e)}},r,i)}parse(e,n){function r(U,j){const Q=[],Y=U.childNodes;for(let ce=0,Fe=Y.length;ce<Fe;ce++){const je=Y[ce];je.nodeName===j&&Q.push(je)}return Q}function i(U){if(U.length===0)return[];const j=U.trim().split(/\s+/),Q=new Array(j.length);for(let Y=0,ce=j.length;Y<ce;Y++)Q[Y]=j[Y];return Q}function s(U){if(U.length===0)return[];const j=U.trim().split(/\s+/),Q=new Array(j.length);for(let Y=0,ce=j.length;Y<ce;Y++)Q[Y]=parseFloat(j[Y]);return Q}function o(U){if(U.length===0)return[];const j=U.trim().split(/\s+/),Q=new Array(j.length);for(let Y=0,ce=j.length;Y<ce;Y++)Q[Y]=parseInt(j[Y]);return Q}function a(U){return U.substring(1)}function l(){return"three_default_"+_n++}function c(U){return Object.keys(U).length===0}function u(U){return{unit:f(r(U,"unit")[0]),upAxis:d(r(U,"up_axis")[0])}}function f(U){return U!==void 0&&U.hasAttribute("meter")===!0?parseFloat(U.getAttribute("meter")):1}function d(U){return U!==void 0?U.textContent:"Y_UP"}function h(U,j,Q,Y){const ce=r(U,j)[0];if(ce!==void 0){const Fe=r(ce,Q);for(let je=0;je<Fe.length;je++)Y(Fe[je])}}function p(U,j){for(const Q in U){const Y=U[Q];Y.build=j(U[Q])}}function m(U,j){return U.build!==void 0||(U.build=j(U)),U.build}function g(U){const j={sources:{},samplers:{},channels:{}};let Q=!1;for(let Y=0,ce=U.childNodes.length;Y<ce;Y++){const Fe=U.childNodes[Y];if(Fe.nodeType!==1)continue;let je;switch(Fe.nodeName){case"source":je=Fe.getAttribute("id"),j.sources[je]=Qe(Fe);break;case"sampler":je=Fe.getAttribute("id"),j.samplers[je]=y(Fe);break;case"channel":je=Fe.getAttribute("target"),j.channels[je]=x(Fe);break;case"animation":g(Fe),Q=!0;break;default:console.log(Fe)}}Q===!1&&(vn.animations[U.getAttribute("id")||ri.generateUUID()]=j)}function y(U){const j={inputs:{}};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"input":const Fe=a(ce.getAttribute("source")),je=ce.getAttribute("semantic");j.inputs[je]=Fe;break}}return j}function x(U){const j={};let Q=U.getAttribute("target").split("/");const Y=Q.shift();let ce=Q.shift();const Fe=ce.indexOf("(")!==-1,je=ce.indexOf(".")!==-1;if(je)Q=ce.split("."),ce=Q.shift(),j.member=Q.shift();else if(Fe){const gt=ce.split("(");ce=gt.shift();for(let lt=0;lt<gt.length;lt++)gt[lt]=parseInt(gt[lt].replace(/\)/,""));j.indices=gt}return j.id=Y,j.sid=ce,j.arraySyntax=Fe,j.memberSyntax=je,j.sampler=a(U.getAttribute("source")),j}function _(U){const j=[],Q=U.channels,Y=U.samplers,ce=U.sources;for(const Fe in Q)if(Q.hasOwnProperty(Fe)){const je=Q[Fe],gt=Y[je.sampler],lt=gt.inputs.INPUT,pt=gt.inputs.OUTPUT,mt=ce[lt],ct=ce[pt],dt=T(je,mt,ct);M(dt,j)}return j}function w(U){return m(vn.animations[U],_)}function T(U,j,Q){const Y=vn.nodes[U.id],ce=Gt(Y.id),Fe=Y.transforms[U.sid],je=Y.matrix.clone().transpose();let gt,lt,pt,mt,ct,dt;const Rt={};switch(Fe){case"matrix":for(pt=0,mt=j.array.length;pt<mt;pt++)if(gt=j.array[pt],lt=pt*Q.stride,Rt[gt]===void 0&&(Rt[gt]={}),U.arraySyntax===!0){const jt=Q.array[lt],xn=U.indices[0]+4*U.indices[1];Rt[gt][xn]=jt}else for(ct=0,dt=Q.stride;ct<dt;ct++)Rt[gt][ct]=Q.array[lt+ct];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Fe);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Fe);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Fe);break}const Nt=S(Rt,je);return{name:ce.uuid,keyframes:Nt}}function S(U,j){const Q=[];for(const ce in U)Q.push({time:parseFloat(ce),value:U[ce]});Q.sort(Y);for(let ce=0;ce<16;ce++)D(Q,ce,j.elements[ce]);return Q;function Y(ce,Fe){return ce.time-Fe.time}}const C=new $,A=new $,R=new bn;function M(U,j){const Q=U.keyframes,Y=U.name,ce=[],Fe=[],je=[],gt=[];for(let lt=0,pt=Q.length;lt<pt;lt++){const mt=Q[lt],ct=mt.time,dt=mt.value;Ue.fromArray(dt).transpose(),Ue.decompose(C,R,A),ce.push(ct),Fe.push(C.x,C.y,C.z),je.push(R.x,R.y,R.z,R.w),gt.push(A.x,A.y,A.z)}return Fe.length>0&&j.push(new Xo(Y+".position",ce,Fe)),je.length>0&&j.push(new Za(Y+".quaternion",ce,je)),gt.length>0&&j.push(new Xo(Y+".scale",ce,gt)),j}function D(U,j,Q){let Y,ce=!0,Fe,je;for(Fe=0,je=U.length;Fe<je;Fe++)Y=U[Fe],Y.value[j]===void 0?Y.value[j]=null:ce=!1;if(ce===!0)for(Fe=0,je=U.length;Fe<je;Fe++)Y=U[Fe],Y.value[j]=Q;else k(U,j)}function k(U,j){let Q,Y;for(let ce=0,Fe=U.length;ce<Fe;ce++){const je=U[ce];if(je.value[j]===null){if(Q=L(U,ce,j),Y=N(U,ce,j),Q===null){je.value[j]=Y.value[j];continue}if(Y===null){je.value[j]=Q.value[j];continue}z(je,Q,Y,j)}}}function L(U,j,Q){for(;j>=0;){const Y=U[j];if(Y.value[Q]!==null)return Y;j--}return null}function N(U,j,Q){for(;j<U.length;){const Y=U[j];if(Y.value[Q]!==null)return Y;j++}return null}function z(U,j,Q,Y){if(Q.time-j.time===0){U.value[Y]=j.value[Y];return}U.value[Y]=(U.time-j.time)*(Q.value[Y]-j.value[Y])/(Q.time-j.time)+j.value[Y]}function O(U){const j={name:U.getAttribute("id")||"default",start:parseFloat(U.getAttribute("start")||0),end:parseFloat(U.getAttribute("end")||0),animations:[]};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"instance_animation":j.animations.push(a(ce.getAttribute("url")));break}}vn.clips[U.getAttribute("id")]=j}function K(U){const j=[],Q=U.name,Y=U.end-U.start||-1,ce=U.animations;for(let Fe=0,je=ce.length;Fe<je;Fe++){const gt=w(ce[Fe]);for(let lt=0,pt=gt.length;lt<pt;lt++)j.push(gt[lt])}return new Qa(Q,Y,j)}function V(U){return m(vn.clips[U],K)}function ne(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"skin":j.id=a(ce.getAttribute("source")),j.skin=re(ce);break;case"morph":j.id=a(ce.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}vn.controllers[U.getAttribute("id")]=j}function re(U){const j={sources:{}};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"bind_shape_matrix":j.bindShapeMatrix=s(ce.textContent);break;case"source":const Fe=ce.getAttribute("id");j.sources[Fe]=Qe(ce);break;case"joints":j.joints=P(ce);break;case"vertex_weights":j.vertexWeights=se(ce);break}}return j}function P(U){const j={inputs:{}};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"input":const Fe=ce.getAttribute("semantic"),je=a(ce.getAttribute("source"));j.inputs[Fe]=je;break}}return j}function se(U){const j={inputs:{}};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"input":const Fe=ce.getAttribute("semantic"),je=a(ce.getAttribute("source")),gt=parseInt(ce.getAttribute("offset"));j.inputs[Fe]={id:je,offset:gt};break;case"vcount":j.vcount=o(ce.textContent);break;case"v":j.v=o(ce.textContent);break}}return j}function ue(U){const j={id:U.id},Q=vn.geometries[j.id];return U.skin!==void 0&&(j.skin=te(U.skin),Q.sources.skinIndices=j.skin.indices,Q.sources.skinWeights=j.skin.weights),j}function te(U){const j={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},Q=U.sources,Y=U.vertexWeights,ce=Y.vcount,Fe=Y.v,je=Y.inputs.JOINT.offset,gt=Y.inputs.WEIGHT.offset,lt=U.sources[U.joints.inputs.JOINT],pt=U.sources[U.joints.inputs.INV_BIND_MATRIX],mt=Q[Y.inputs.WEIGHT.id].array;let ct=0,dt,Rt,Nt;for(dt=0,Nt=ce.length;dt<Nt;dt++){const xn=ce[dt],un=[];for(Rt=0;Rt<xn;Rt++){const nn=Fe[ct+je],Vn=Fe[ct+gt],Lr=mt[Vn];un.push({index:nn,weight:Lr}),ct+=2}for(un.sort(jt),Rt=0;Rt<4;Rt++){const nn=un[Rt];nn!==void 0?(j.indices.array.push(nn.index),j.weights.array.push(nn.weight)):(j.indices.array.push(0),j.weights.array.push(0))}}for(U.bindShapeMatrix?j.bindMatrix=new et().fromArray(U.bindShapeMatrix).transpose():j.bindMatrix=new et().identity(),dt=0,Nt=lt.array.length;dt<Nt;dt++){const xn=lt.array[dt],un=new et().fromArray(pt.array,dt*pt.stride).transpose();j.joints.push({name:xn,boneInverse:un})}return j;function jt(xn,un){return un.weight-xn.weight}}function W(U){return m(vn.controllers[U],ue)}function X(U){const j={init_from:r(U,"init_from")[0].textContent};vn.images[U.getAttribute("id")]=j}function J(U){return U.build!==void 0?U.build:U.init_from}function oe(U){const j=vn.images[U];return j!==void 0?m(j,J):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",U),null)}function Ee(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"profile_COMMON":j.profile=me(ce);break}}vn.effects[U.getAttribute("id")]=j}function me(U){const j={surfaces:{},samplers:{}};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"newparam":Te(ce,j);break;case"technique":j.technique=ae(ce);break;case"extra":j.extra=ze(ce);break}}return j}function Te(U,j){const Q=U.getAttribute("sid");for(let Y=0,ce=U.childNodes.length;Y<ce;Y++){const Fe=U.childNodes[Y];if(Fe.nodeType===1)switch(Fe.nodeName){case"surface":j.surfaces[Q]=_e(Fe);break;case"sampler2D":j.samplers[Q]=Re(Fe);break}}}function _e(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"init_from":j.init_from=ce.textContent;break}}return j}function Re(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"source":j.source=ce.textContent;break}}return j}function ae(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"constant":case"lambert":case"blinn":case"phong":j.type=ce.nodeName,j.parameters=Ce(ce);break;case"extra":j.extra=ze(ce);break}}return j}function Ce(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":j[ce.nodeName]=Pe(ce);break;case"transparent":j[ce.nodeName]={opaque:ce.hasAttribute("opaque")?ce.getAttribute("opaque"):"A_ONE",data:Pe(ce)};break}}return j}function Pe(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"color":j[ce.nodeName]=s(ce.textContent);break;case"float":j[ce.nodeName]=parseFloat(ce.textContent);break;case"texture":j[ce.nodeName]={id:ce.getAttribute("texture"),extra:Ve(ce)};break}}return j}function Ve(U){const j={technique:{}};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"extra":ye(ce,j);break}}return j}function ye(U,j){for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"technique":ge(ce,j);break}}}function ge(U,j){for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":j.technique[ce.nodeName]=parseFloat(ce.textContent);break;case"wrapU":case"wrapV":ce.textContent.toUpperCase()==="TRUE"?j.technique[ce.nodeName]=1:ce.textContent.toUpperCase()==="FALSE"?j.technique[ce.nodeName]=0:j.technique[ce.nodeName]=parseInt(ce.textContent);break;case"bump":j[ce.nodeName]=ie(ce);break}}}function ze(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"technique":j.technique=fe(ce);break}}return j}function fe(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"double_sided":j[ce.nodeName]=parseInt(ce.textContent);break;case"bump":j[ce.nodeName]=ie(ce);break}}return j}function ie(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"texture":j[ce.nodeName]={id:ce.getAttribute("texture"),texcoord:ce.getAttribute("texcoord"),extra:Ve(ce)};break}}return j}function ve(U){return U}function Me(U){return m(vn.effects[U],ve)}function Be(U){const j={name:U.getAttribute("name")};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"instance_effect":j.url=a(ce.getAttribute("url"));break}}vn.materials[U.getAttribute("id")]=j}function Ze(U){let j,Q=U.slice((U.lastIndexOf(".")-1>>>0)+2);switch(Q=Q.toLowerCase(),Q){case"tga":j=Bn;break;default:j=mr}return j}function F(U){const j=Me(U.url),Q=j.profile.technique;let Y;switch(Q.type){case"phong":case"blinn":Y=new nu;break;case"lambert":Y=new nh;break;default:Y=new Fr;break}Y.name=U.name||"";function ce(lt,pt=null){const mt=j.profile.samplers[lt.id];let ct=null;if(mt!==void 0){const dt=j.profile.surfaces[mt.source];ct=oe(dt.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),ct=oe(lt.id);if(ct!==null){const dt=Ze(ct);if(dt!==void 0){const Rt=dt.load(ct),Nt=lt.extra;if(Nt!==void 0&&Nt.technique!==void 0&&c(Nt.technique)===!1){const jt=Nt.technique;Rt.wrapS=jt.wrapU?Or:ei,Rt.wrapT=jt.wrapV?Or:ei,Rt.offset.set(jt.offsetU||0,jt.offsetV||0),Rt.repeat.set(jt.repeatU||1,jt.repeatV||1)}else Rt.wrapS=Or,Rt.wrapT=Or;return pt!==null&&(Rt.colorSpace=pt),Rt}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",ct),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",lt.id),null}const Fe=Q.parameters;for(const lt in Fe){const pt=Fe[lt];switch(lt){case"diffuse":pt.color&&Y.color.fromArray(pt.color),pt.texture&&(Y.map=ce(pt.texture,Er));break;case"specular":pt.color&&Y.specular&&Y.specular.fromArray(pt.color),pt.texture&&(Y.specularMap=ce(pt.texture));break;case"bump":pt.texture&&(Y.normalMap=ce(pt.texture));break;case"ambient":pt.texture&&(Y.lightMap=ce(pt.texture,Er));break;case"shininess":pt.float&&Y.shininess&&(Y.shininess=pt.float);break;case"emission":pt.color&&Y.emissive&&Y.emissive.fromArray(pt.color),pt.texture&&(Y.emissiveMap=ce(pt.texture,Er));break}}er.toWorkingColorSpace(Y.color,Er),Y.specular&&er.toWorkingColorSpace(Y.specular,Er),Y.emissive&&er.toWorkingColorSpace(Y.emissive,Er);let je=Fe.transparent,gt=Fe.transparency;if(gt===void 0&&je&&(gt={float:1}),je===void 0&&gt&&(je={opaque:"A_ONE",data:{color:[1,1,1,1]}}),je&&gt)if(je.data.texture)Y.transparent=!0;else{const lt=je.data.color;switch(je.opaque){case"A_ONE":Y.opacity=lt[3]*gt.float;break;case"RGB_ZERO":Y.opacity=1-lt[0]*gt.float;break;case"A_ZERO":Y.opacity=1-lt[3]*gt.float;break;case"RGB_ONE":Y.opacity=lt[0]*gt.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',je.opaque)}Y.opacity<1&&(Y.transparent=!0)}if(Q.extra!==void 0&&Q.extra.technique!==void 0){const lt=Q.extra.technique;for(const pt in lt){const mt=lt[pt];switch(pt){case"double_sided":Y.side=mt===1?Nr:Cs;break;case"bump":Y.normalMap=ce(mt.texture),Y.normalScale=new Ke(1,1);break}}}return Y}function Z(U){return m(vn.materials[U],F)}function q(U){const j={name:U.getAttribute("name")};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"optics":j.optics=xe(ce);break}}vn.cameras[U.getAttribute("id")]=j}function xe(U){for(let j=0;j<U.childNodes.length;j++){const Q=U.childNodes[j];switch(Q.nodeName){case"technique_common":return be(Q)}}return{}}function be(U){const j={};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];switch(Y.nodeName){case"perspective":case"orthographic":j.technique=Y.nodeName,j.parameters=De(Y);break}}return j}function De(U){const j={};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];switch(Y.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":j[Y.nodeName]=parseFloat(Y.textContent);break}}return j}function $e(U){let j;switch(U.optics.technique){case"perspective":j=new Ar(U.optics.parameters.yfov,U.optics.parameters.aspect_ratio,U.optics.parameters.znear,U.optics.parameters.zfar);break;case"orthographic":let Q=U.optics.parameters.ymag,Y=U.optics.parameters.xmag;const ce=U.optics.parameters.aspect_ratio;Y=Y===void 0?Q*ce:Y,Q=Q===void 0?Y/ce:Q,Y*=.5,Q*=.5,j=new Hi(-Y,Y,Q,-Q,U.optics.parameters.znear,U.optics.parameters.zfar);break;default:j=new Ar;break}return j.name=U.name||"",j}function st(U){const j=vn.cameras[U];return j!==void 0?m(j,$e):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",U),null)}function it(U){let j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"technique_common":j=Ie(ce);break}}vn.lights[U.getAttribute("id")]=j}function Ie(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"directional":case"point":case"spot":case"ambient":j.technique=ce.nodeName,j.parameters=Ye(ce)}}return j}function Ye(U){const j={};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"color":const Fe=s(ce.textContent);j.color=new wt().fromArray(Fe),er.toWorkingColorSpace(j.color,Er);break;case"falloff_angle":j.falloffAngle=parseFloat(ce.textContent);break;case"quadratic_attenuation":const je=parseFloat(ce.textContent);j.distance=je?Math.sqrt(1/je):0;break}}return j}function at(U){let j;switch(U.technique){case"directional":j=new jm;break;case"point":j=new Gm;break;case"spot":j=new Hm;break;case"ambient":j=new Wb;break}return U.parameters.color&&j.color.copy(U.parameters.color),U.parameters.distance&&(j.distance=U.parameters.distance),j}function ke(U){const j=vn.lights[U];return j!==void 0?m(j,at):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",U),null)}function Xe(U){const j={name:U.getAttribute("name"),sources:{},vertices:{},primitives:[]},Q=r(U,"mesh")[0];if(Q!==void 0){for(let Y=0;Y<Q.childNodes.length;Y++){const ce=Q.childNodes[Y];if(ce.nodeType!==1)continue;const Fe=ce.getAttribute("id");switch(ce.nodeName){case"source":j.sources[Fe]=Qe(ce);break;case"vertices":j.vertices=_t(ce);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",ce.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":j.primitives.push(kt(ce));break;default:console.log(ce)}}vn.geometries[U.getAttribute("id")]=j}}function Qe(U){const j={array:[],stride:3};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"float_array":j.array=s(Y.textContent);break;case"Name_array":j.array=i(Y.textContent);break;case"technique_common":const ce=r(Y,"accessor")[0];ce!==void 0&&(j.stride=parseInt(ce.getAttribute("stride")));break}}return j}function _t(U){const j={};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];Y.nodeType===1&&(j[Y.getAttribute("semantic")]=a(Y.getAttribute("source")))}return j}function kt(U){const j={type:U.nodeName,material:U.getAttribute("material"),count:parseInt(U.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let Q=0,Y=U.childNodes.length;Q<Y;Q++){const ce=U.childNodes[Q];if(ce.nodeType===1)switch(ce.nodeName){case"input":const Fe=a(ce.getAttribute("source")),je=ce.getAttribute("semantic"),gt=parseInt(ce.getAttribute("offset")),lt=parseInt(ce.getAttribute("set")),pt=lt>0?je+lt:je;j.inputs[pt]={id:Fe,offset:gt},j.stride=Math.max(j.stride,gt+1),je==="TEXCOORD"&&(j.hasUV=!0);break;case"vcount":j.vcount=o(ce.textContent);break;case"p":j.p=o(ce.textContent);break}}return j}function Ct(U){const j={};for(let Q=0;Q<U.length;Q++){const Y=U[Q];j[Y.type]===void 0&&(j[Y.type]=[]),j[Y.type].push(Y)}return j}function Kt(U){let j=0;for(let Q=0,Y=U.length;Q<Y;Q++)U[Q].hasUV===!0&&j++;j>0&&j<U.length&&(U.uvsNeedsFix=!0)}function cn(U){const j={},Q=U.sources,Y=U.vertices,ce=U.primitives;if(ce.length===0)return{};const Fe=Ct(ce);for(const je in Fe){const gt=Fe[je];Kt(gt),j[je]=sn(gt,Q,Y)}return j}function sn(U,j,Q){const Y={},ce={array:[],stride:0},Fe={array:[],stride:0},je={array:[],stride:0},gt={array:[],stride:0},lt={array:[],stride:0},pt={array:[],stride:4},mt={array:[],stride:4},ct=new gn,dt=[];let Rt=0;for(let Nt=0;Nt<U.length;Nt++){const jt=U[Nt],xn=jt.inputs;let un=0;switch(jt.type){case"lines":case"linestrips":un=jt.count*2;break;case"triangles":un=jt.count*3;break;case"polylist":for(let nn=0;nn<jt.count;nn++){const Vn=jt.vcount[nn];switch(Vn){case 3:un+=3;break;case 4:un+=6;break;default:un+=(Vn-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",jt.type)}ct.addGroup(Rt,un,Nt),Rt+=un,jt.material&&dt.push(jt.material);for(const nn in xn){const Vn=xn[nn];switch(nn){case"VERTEX":for(const Lr in Q){const gr=Q[Lr];switch(Lr){case"POSITION":const ci=ce.array.length;if(Vt(jt,j[gr],Vn.offset,ce.array),ce.stride=j[gr].stride,j.skinWeights&&j.skinIndices&&(Vt(jt,j.skinIndices,Vn.offset,pt.array),Vt(jt,j.skinWeights,Vn.offset,mt.array)),jt.hasUV===!1&&U.uvsNeedsFix===!0){const co=(ce.array.length-ci)/ce.stride;for(let uo=0;uo<co;uo++)je.array.push(0,0)}break;case"NORMAL":Vt(jt,j[gr],Vn.offset,Fe.array),Fe.stride=j[gr].stride;break;case"COLOR":Vt(jt,j[gr],Vn.offset,lt.array),lt.stride=j[gr].stride;break;case"TEXCOORD":Vt(jt,j[gr],Vn.offset,je.array),je.stride=j[gr].stride;break;case"TEXCOORD1":Vt(jt,j[gr],Vn.offset,gt.array),je.stride=j[gr].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Lr)}}break;case"NORMAL":Vt(jt,j[Vn.id],Vn.offset,Fe.array),Fe.stride=j[Vn.id].stride;break;case"COLOR":Vt(jt,j[Vn.id],Vn.offset,lt.array,!0),lt.stride=j[Vn.id].stride;break;case"TEXCOORD":Vt(jt,j[Vn.id],Vn.offset,je.array),je.stride=j[Vn.id].stride;break;case"TEXCOORD1":Vt(jt,j[Vn.id],Vn.offset,gt.array),gt.stride=j[Vn.id].stride;break}}}return ce.array.length>0&&ct.setAttribute("position",new Dt(ce.array,ce.stride)),Fe.array.length>0&&ct.setAttribute("normal",new Dt(Fe.array,Fe.stride)),lt.array.length>0&&ct.setAttribute("color",new Dt(lt.array,lt.stride)),je.array.length>0&&ct.setAttribute("uv",new Dt(je.array,je.stride)),gt.array.length>0&&ct.setAttribute("uv1",new Dt(gt.array,gt.stride)),pt.array.length>0&&ct.setAttribute("skinIndex",new Dt(pt.array,pt.stride)),mt.array.length>0&&ct.setAttribute("skinWeight",new Dt(mt.array,mt.stride)),Y.data=ct,Y.type=U[0].type,Y.materialKeys=dt,Y}function Vt(U,j,Q,Y,ce=!1){const Fe=U.p,je=U.stride,gt=U.vcount;function lt(ct){let dt=Fe[ct+Q]*mt;const Rt=dt+mt;for(;dt<Rt;dt++)Y.push(pt[dt]);if(ce){const Nt=Y.length-mt-1;sr.setRGB(Y[Nt+0],Y[Nt+1],Y[Nt+2],Er),Y[Nt+0]=sr.r,Y[Nt+1]=sr.g,Y[Nt+2]=sr.b}}const pt=j.array,mt=j.stride;if(U.vcount!==void 0){let ct=0;for(let dt=0,Rt=gt.length;dt<Rt;dt++){const Nt=gt[dt];if(Nt===4){const jt=ct+je*0,xn=ct+je*1,un=ct+je*2,nn=ct+je*3;lt(jt),lt(xn),lt(nn),lt(xn),lt(un),lt(nn)}else if(Nt===3){const jt=ct+je*0,xn=ct+je*1,un=ct+je*2;lt(jt),lt(xn),lt(un)}else if(Nt>4)for(let jt=1,xn=Nt-2;jt<=xn;jt++){const un=ct+je*0,nn=ct+je*jt,Vn=ct+je*(jt+1);lt(un),lt(nn),lt(Vn)}ct+=je*Nt}}else for(let ct=0,dt=Fe.length;ct<dt;ct+=je)lt(ct)}function Gn(U){return m(vn.geometries[U],cn)}function rr(U){const j={name:U.getAttribute("name")||"",joints:{},links:[]};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"technique_common":zr(Y,j);break}}vn.kinematicsModels[U.getAttribute("id")]=j}function Cr(U){return U.build!==void 0?U.build:U}function wi(U){return m(vn.kinematicsModels[U],Cr)}function zr(U,j){for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"joint":j.joints[Y.getAttribute("sid")]=mi(Y);break;case"link":j.links.push(Hr(Y));break}}}function mi(U){let j;for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"prismatic":case"revolute":j=gi(Y);break}}return j}function gi(U){const j={sid:U.getAttribute("sid"),name:U.getAttribute("name")||"",axis:new $,limits:{min:0,max:0},type:U.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"axis":const ce=s(Y.textContent);j.axis.fromArray(ce);break;case"limits":const Fe=Y.getElementsByTagName("max")[0],je=Y.getElementsByTagName("min")[0];j.limits.max=parseFloat(Fe.textContent),j.limits.min=parseFloat(je.textContent);break}}return j.limits.min>=j.limits.max&&(j.static=!0),j.middlePosition=(j.limits.min+j.limits.max)/2,j}function Hr(U){const j={sid:U.getAttribute("sid"),name:U.getAttribute("name")||"",attachments:[],transforms:[]};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"attachment_full":j.attachments.push(An(Y));break;case"matrix":case"translate":case"rotate":j.transforms.push(kr(Y));break}}return j}function An(U){const j={joint:U.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"link":j.links.push(Hr(Y));break;case"matrix":case"translate":case"rotate":j.transforms.push(kr(Y));break}}return j}function kr(U){const j={type:U.nodeName},Q=s(U.textContent);switch(j.type){case"matrix":j.obj=new et,j.obj.fromArray(Q).transpose();break;case"translate":j.obj=new $,j.obj.fromArray(Q);break;case"rotate":j.obj=new $,j.obj.fromArray(Q),j.angle=ri.degToRad(Q[3]);break}return j}function Wi(U){const j={name:U.getAttribute("name")||"",rigidBodies:{}};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"rigid_body":j.rigidBodies[Y.getAttribute("name")]={},pe(Y,j.rigidBodies[Y.getAttribute("name")]);break}}vn.physicsModels[U.getAttribute("id")]=j}function pe(U,j){for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"technique_common":we(Y,j);break}}}function we(U,j){for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"inertia":j.inertia=s(Y.textContent);break;case"mass":j.mass=s(Y.textContent)[0];break}}}function qe(U){const j={bindJointAxis:[]};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"bind_joint_axis":j.bindJointAxis.push(ut(Y));break}}vn.kinematicsScenes[a(U.getAttribute("url"))]=j}function ut(U){const j={target:U.getAttribute("target").split("/").pop()};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType===1)switch(Y.nodeName){case"axis":const ce=Y.getElementsByTagName("param")[0];j.axis=ce.textContent;const Fe=j.axis.split("inst_").pop().split("axis")[0];j.jointIndex=Fe.substring(0,Fe.length-1);break}}return j}function yt(U){return U.build!==void 0?U.build:U}function vt(U){return m(vn.kinematicsScenes[U],yt)}function Ft(){const U=Object.keys(vn.kinematicsModels)[0],j=Object.keys(vn.kinematicsScenes)[0],Q=Object.keys(vn.visualScenes)[0];if(U===void 0||j===void 0)return;const Y=wi(U),ce=vt(j),Fe=qt(Q),je=ce.bindJointAxis,gt={};for(let mt=0,ct=je.length;mt<ct;mt++){const dt=je[mt],Rt=Jt.querySelector('[sid="'+dt.target+'"]');if(Rt){const Nt=Rt.parentElement;lt(dt.jointIndex,Nt)}}function lt(mt,ct){const dt=ct.getAttribute("name"),Rt=Y.joints[mt];Fe.traverse(function(Nt){Nt.name===dt&&(gt[mt]={object:Nt,transforms:de(ct),joint:Rt,position:Rt.zeroPosition})})}const pt=new et;Si={joints:Y&&Y.joints,getJointValue:function(mt){const ct=gt[mt];if(ct)return ct.position;console.warn("THREE.ColladaLoader: Joint "+mt+" doesn't exist.")},setJointValue:function(mt,ct){const dt=gt[mt];if(dt){const Rt=dt.joint;if(ct>Rt.limits.max||ct<Rt.limits.min)console.warn("THREE.ColladaLoader: Joint "+mt+" value "+ct+" outside of limits (min: "+Rt.limits.min+", max: "+Rt.limits.max+").");else if(Rt.static)console.warn("THREE.ColladaLoader: Joint "+mt+" is static.");else{const Nt=dt.object,jt=Rt.axis,xn=dt.transforms;Ue.identity();for(let un=0;un<xn.length;un++){const nn=xn[un];if(nn.sid&&nn.sid.indexOf(mt)!==-1)switch(Rt.type){case"revolute":Ue.multiply(pt.makeRotationAxis(jt,ri.degToRad(ct)));break;case"prismatic":Ue.multiply(pt.makeTranslation(jt.x*ct,jt.y*ct,jt.z*ct));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+Rt.type);break}else switch(nn.type){case"matrix":Ue.multiply(nn.obj);break;case"translate":Ue.multiply(pt.makeTranslation(nn.obj.x,nn.obj.y,nn.obj.z));break;case"scale":Ue.scale(nn.obj);break;case"rotate":Ue.multiply(pt.makeRotationAxis(nn.obj,nn.angle));break}}Nt.matrix.copy(Ue),Nt.matrix.decompose(Nt.position,Nt.quaternion,Nt.scale),gt[mt].position=ct}}else console.log("THREE.ColladaLoader: "+mt+" does not exist.")}}}function de(U){const j=[],Q=Jt.querySelector('[id="'+U.id+'"]');for(let Y=0;Y<Q.childNodes.length;Y++){const ce=Q.childNodes[Y];if(ce.nodeType!==1)continue;let Fe,je;switch(ce.nodeName){case"matrix":Fe=s(ce.textContent);const gt=new et().fromArray(Fe).transpose();j.push({sid:ce.getAttribute("sid"),type:ce.nodeName,obj:gt});break;case"translate":case"scale":Fe=s(ce.textContent),je=new $().fromArray(Fe),j.push({sid:ce.getAttribute("sid"),type:ce.nodeName,obj:je});break;case"rotate":Fe=s(ce.textContent),je=new $().fromArray(Fe);const lt=ri.degToRad(Fe[3]);j.push({sid:ce.getAttribute("sid"),type:ce.nodeName,obj:je,angle:lt});break}}return j}function Le(U){const j=U.getElementsByTagName("node");for(let Q=0;Q<j.length;Q++){const Y=j[Q];Y.hasAttribute("id")===!1&&Y.setAttribute("id",l())}}const Ue=new et,He=new $;function Se(U){const j={name:U.getAttribute("name")||"",type:U.getAttribute("type"),id:U.getAttribute("id"),sid:U.getAttribute("sid"),matrix:new et,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];if(Y.nodeType!==1)continue;let ce;switch(Y.nodeName){case"node":j.nodes.push(Y.getAttribute("id")),Se(Y);break;case"instance_camera":j.instanceCameras.push(a(Y.getAttribute("url")));break;case"instance_controller":j.instanceControllers.push(Tt(Y));break;case"instance_light":j.instanceLights.push(a(Y.getAttribute("url")));break;case"instance_geometry":j.instanceGeometries.push(Tt(Y));break;case"instance_node":j.instanceNodes.push(a(Y.getAttribute("url")));break;case"matrix":ce=s(Y.textContent),j.matrix.multiply(Ue.fromArray(ce).transpose()),j.transforms[Y.getAttribute("sid")]=Y.nodeName;break;case"translate":ce=s(Y.textContent),He.fromArray(ce),j.matrix.multiply(Ue.makeTranslation(He.x,He.y,He.z)),j.transforms[Y.getAttribute("sid")]=Y.nodeName;break;case"rotate":ce=s(Y.textContent);const Fe=ri.degToRad(ce[3]);j.matrix.multiply(Ue.makeRotationAxis(He.fromArray(ce),Fe)),j.transforms[Y.getAttribute("sid")]=Y.nodeName;break;case"scale":ce=s(Y.textContent),j.matrix.scale(He.fromArray(ce)),j.transforms[Y.getAttribute("sid")]=Y.nodeName;break;case"extra":break;default:console.log(Y)}}return Ht(j.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",j.id):vn.nodes[j.id]=j,j}function Tt(U){const j={id:a(U.getAttribute("url")),materials:{},skeletons:[]};for(let Q=0;Q<U.childNodes.length;Q++){const Y=U.childNodes[Q];switch(Y.nodeName){case"bind_material":const ce=Y.getElementsByTagName("instance_material");for(let Fe=0;Fe<ce.length;Fe++){const je=ce[Fe],gt=je.getAttribute("symbol"),lt=je.getAttribute("target");j.materials[gt]=a(lt)}break;case"skeleton":j.skeletons.push(a(Y.textContent));break}}return j}function xt(U,j){const Q=[],Y=[];let ce,Fe,je;for(ce=0;ce<U.length;ce++){const pt=U[ce];let mt;if(Ht(pt))mt=Gt(pt),bt(mt,j,Q);else if(Zt(pt)){const ct=vn.visualScenes[pt].children;for(let dt=0;dt<ct.length;dt++){const Rt=ct[dt];if(Rt.type==="JOINT"){const Nt=Gt(Rt.id);bt(Nt,j,Q)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",pt)}for(ce=0;ce<j.length;ce++)for(Fe=0;Fe<Q.length;Fe++)if(je=Q[Fe],je.bone.name===j[ce].name){Y[ce]=je,je.processed=!0;break}for(ce=0;ce<Q.length;ce++)je=Q[ce],je.processed===!1&&(Y.push(je),je.processed=!0);const gt=[],lt=[];for(ce=0;ce<Y.length;ce++)je=Y[ce],gt.push(je.bone),lt.push(je.boneInverse);return new wf(gt,lt)}function bt(U,j,Q){U.traverse(function(Y){if(Y.isBone===!0){let ce;for(let Fe=0;Fe<j.length;Fe++){const je=j[Fe];if(je.name===Y.name){ce=je.boneInverse;break}}ce===void 0&&(ce=new et),Q.push({bone:Y,boneInverse:ce,processed:!1})}})}function Pt(U){const j=[],Q=U.matrix,Y=U.nodes,ce=U.type,Fe=U.instanceCameras,je=U.instanceControllers,gt=U.instanceLights,lt=U.instanceGeometries,pt=U.instanceNodes;for(let ct=0,dt=Y.length;ct<dt;ct++)j.push(Gt(Y[ct]));for(let ct=0,dt=Fe.length;ct<dt;ct++){const Rt=st(Fe[ct]);Rt!==null&&j.push(Rt.clone())}for(let ct=0,dt=je.length;ct<dt;ct++){const Rt=je[ct],Nt=W(Rt.id),jt=Gn(Nt.id),xn=Ot(jt,Rt.materials),un=Rt.skeletons,nn=Nt.skin.joints,Vn=xt(un,nn);for(let Lr=0,gr=xn.length;Lr<gr;Lr++){const ci=xn[Lr];ci.isSkinnedMesh&&(ci.bind(Vn,Nt.skin.bindMatrix),ci.normalizeSkinWeights()),j.push(ci)}}for(let ct=0,dt=gt.length;ct<dt;ct++){const Rt=ke(gt[ct]);Rt!==null&&j.push(Rt.clone())}for(let ct=0,dt=lt.length;ct<dt;ct++){const Rt=lt[ct],Nt=Gn(Rt.id),jt=Ot(Nt,Rt.materials);for(let xn=0,un=jt.length;xn<un;xn++)j.push(jt[xn])}for(let ct=0,dt=pt.length;ct<dt;ct++)j.push(Gt(pt[ct]).clone());let mt;if(Y.length===0&&j.length===1)mt=j[0];else{mt=ce==="JOINT"?new Jd:new es;for(let ct=0;ct<j.length;ct++)mt.add(j[ct])}return mt.name=ce==="JOINT"?U.sid:U.name,mt.matrix.copy(Q),mt.matrix.decompose(mt.position,mt.quaternion,mt.scale),mt}const Bt=new Fr({name:Br.DEFAULT_MATERIAL_NAME,color:16711935});function Xt(U,j){const Q=[];for(let Y=0,ce=U.length;Y<ce;Y++){const Fe=j[U[Y]];Fe===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",U[Y]),Q.push(Bt)):Q.push(Z(Fe))}return Q}function Ot(U,j){const Q=[];for(const Y in U){const ce=U[Y],Fe=Xt(ce.materialKeys,j);if(Fe.length===0&&(Y==="lines"||Y==="linestrips"?Fe.push(new oi):Fe.push(new nu)),Y==="lines"||Y==="linestrips")for(let pt=0,mt=Fe.length;pt<mt;pt++){const ct=Fe[pt];if(ct.isMeshPhongMaterial===!0||ct.isMeshLambertMaterial===!0){const dt=new oi;dt.color.copy(ct.color),dt.opacity=ct.opacity,dt.transparent=ct.transparent,Fe[pt]=dt}}const je=ce.data.attributes.skinIndex!==void 0,gt=Fe.length===1?Fe[0]:Fe;let lt;switch(Y){case"lines":lt=new so(ce.data,gt);break;case"linestrips":lt=new $o(ce.data,gt);break;case"triangles":case"polylist":je?lt=new Qd(ce.data,gt):lt=new ln(ce.data,gt);break}Q.push(lt)}return Q}function Ht(U){return vn.nodes[U]!==void 0}function Gt(U){return m(vn.nodes[U],Pt)}function dn(U){const j={name:U.getAttribute("name"),children:[]};Le(U);const Q=r(U,"node");for(let Y=0;Y<Q.length;Y++)j.children.push(Se(Q[Y]));vn.visualScenes[U.getAttribute("id")]=j}function En(U){const j=new es;j.name=U.name;const Q=U.children;for(let Y=0;Y<Q.length;Y++){const ce=Q[Y];j.add(Gt(ce.id))}return j}function Zt(U){return vn.visualScenes[U]!==void 0}function qt(U){return m(vn.visualScenes[U],En)}function jn(U){const j=r(U,"instance_visual_scene")[0];return qt(a(j.getAttribute("url")))}function wn(){const U=vn.clips;if(c(U)===!0){if(c(vn.animations)===!1){const j=[];for(const Q in vn.animations){const Y=w(Q);for(let ce=0,Fe=Y.length;ce<Fe;ce++)j.push(Y[ce])}Ii.push(new Qa("default",-1,j))}}else for(const j in U)Ii.push(V(j))}function Zn(U){let j="";const Q=[U];for(;Q.length;){const Y=Q.shift();Y.nodeType===Node.TEXT_NODE?j+=Y.textContent:(j+=`
`,Q.push.apply(Q,Y.childNodes))}return j.trim()}if(e.length===0)return{scene:new ls};const Nn=new DOMParser().parseFromString(e,"application/xml"),Jt=r(Nn,"COLLADA")[0],On=Nn.getElementsByTagName("parsererror")[0];if(On!==void 0){const U=r(On,"div")[0];let j;return U?j=U.textContent:j=Zn(On),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,j),null}const on=Jt.getAttribute("version");console.debug("THREE.ColladaLoader: File version",on);const Un=u(r(Jt,"asset")[0]),mr=new ns(this.manager);mr.setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);let Bn;BF&&(Bn=new BF(this.manager),Bn.setPath(this.resourcePath||n));const sr=new wt,Ii=[];let Si={},_n=0;const vn={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};h(Jt,"library_animations","animation",g),h(Jt,"library_animation_clips","animation_clip",O),h(Jt,"library_controllers","controller",ne),h(Jt,"library_images","image",X),h(Jt,"library_effects","effect",Ee),h(Jt,"library_materials","material",Be),h(Jt,"library_cameras","camera",q),h(Jt,"library_lights","light",it),h(Jt,"library_geometries","geometry",Xe),h(Jt,"library_nodes","node",Se),h(Jt,"library_visual_scenes","visual_scene",dn),h(Jt,"library_kinematics_models","kinematics_model",rr),h(Jt,"library_physics_models","physics_model",Wi),h(Jt,"scene","instance_kinematics_scene",qe),p(vn.animations,_),p(vn.clips,K),p(vn.controllers,ue),p(vn.images,J),p(vn.effects,ve),p(vn.materials,F),p(vn.cameras,$e),p(vn.lights,at),p(vn.geometries,cn),p(vn.visualScenes,En),wn(),Ft();const he=jn(r(Jt,"scene")[0]);return he.animations=Ii,Un.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),he.rotation.set(-Math.PI/2,0,0)),he.scale.multiplyScalar(Un.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Ii},kinematics:Si,library:vn,scene:he}}}const uA=new bn,zF=new xr;function cd(t){if(!t)return[0,0,0];const e=t.trim().split(/\s+/g).map(Number);return[e[0]||0,e[1]||0,e[2]||0]}function HF(t,e,n=!1){n||t.rotation.set(0,0,0),zF.set(e[0],e[1],e[2],"ZYX"),uA.setFromEuler(zF),uA.multiply(t.quaternion),t.quaternion.copy(uA)}class wRe{constructor(e){tn(this,"manager"),tn(this,"loadMeshCb"),tn(this,"parseVisual"),tn(this,"parseCollision"),tn(this,"packages"),tn(this,"workingPath"),tn(this,"fetchOptions"),this.manager=e||Vb,this.loadMeshCb=this.defaultMeshLoader.bind(this),this.parseVisual=!0,this.parseCollision=!1,this.packages="",this.workingPath="",this.fetchOptions={}}loadAsync(e){return new Promise((n,r)=>{this.load(e,n,void 0,r)})}load(e,n,r,i){const s=this.manager,o=Ms.extractUrlBase(e),a=this.manager.resolveURL(e);s.itemStart(a),fetch(a,this.fetchOptions).then(l=>{if(l.ok)return r&&r(null),l.text();throw new Error(`URDFLoader: Failed to load url '${a}' with error code ${l.status} : ${l.statusText}.`)}).then(l=>{this.workingPath===""&&(this.workingPath=o);const c=this.parse(l);n(c),s.itemEnd(a)}).catch(l=>{i?i(l):console.error("URDFLoader: Error loading file.",l),s.itemError(a),s.itemEnd(a)})}parse(e){const n=this.packages,r=this.loadMeshCb,i=this.parseVisual,s=this.parseCollision,o=this.workingPath,a=this.manager,l={},c={},u={};function f(x){if(!/^package:\/\//.test(x))return o?Ms.resolveURL(x,o):x;const[_,w]=x.replace(/^package:\/\//,"").split(/\/(.+)/);return typeof n=="string"?n.endsWith(_)?`${n}/${w}`:`${n}/${_}/${w}`:typeof n=="function"?`${n(_)}/${w}`:typeof n=="object"?_ in n?`${n[_]}/${w}`:(console.error(`URDFLoader : ${_} not found in provided package list.`),null):(console.error("URDFLoader: Invalid packages configuration."),null)}function d(x){let _;if(x instanceof Document)_=Array.from(x.children);else if(x instanceof Element)_=[x];else{const T=new DOMParser().parseFromString(x,"text/xml");_=Array.from(T.children)}const w=_.find(T=>T.nodeName==="robot");if(!w)throw new Error("URDFLoader: No <robot> element found in URDF.");return h(w)}function h(x){const _=Array.from(x.children),w=_.filter(D=>D.nodeName.toLowerCase()==="link"),T=_.filter(D=>D.nodeName.toLowerCase()==="joint"),S=_.filter(D=>D.nodeName.toLowerCase()==="material"),C=new _Re;C.robotName=x.getAttribute("name")||"",C.urdfRobotNode=x,S.forEach(D=>{const k=D.getAttribute("name")||"";u[k]=g(D)});const A={},R={};w.forEach(D=>{const k=D.getAttribute("name")||"",L=x.querySelector(`child[link="${k}"]`)===null;l[k]=m(D,A,R,L?C:void 0)}),T.forEach(D=>{const k=D.getAttribute("name")||"";c[k]=p(D)}),C.joints=c,C.links=l,C.colliders=R,C.visual=A;const M=Object.values(c);return M.forEach(D=>{if(D instanceof UF){const k=c[D.mimicJoint];k?k.mimicJoints.push(D):console.warn(`URDFLoader: Mimic joint '${D.mimicJoint}' not found.`)}}),M.forEach(D=>{const k=new Set,L=N=>{if(k.has(N))throw new Error("URDFLoader: Detected an infinite loop of mimic joints.");k.add(N),N.mimicJoints.forEach(z=>{L(z)})};L(D)}),C.frames={...R,...A,...l,...c},C}function p(x){const _=Array.from(x.children),w=x.getAttribute("type")||"";let T;const S=_.find(k=>k.nodeName.toLowerCase()==="mimic");if(S){const k=new UF;k.mimicJoint=S.getAttribute("joint")||"",k.multiplier=parseFloat(S.getAttribute("multiplier")||"1.0"),k.offset=parseFloat(S.getAttribute("offset")||"0.0"),T=k}else T=new iR;T.urdfNode=x,T.name=x.getAttribute("name")||"",T.urdfName=T.name,T.jointType=w;let C=null,A=null,R=[0,0,0],M=[0,0,0];_.forEach(k=>{const L=k.nodeName.toLowerCase();if(L==="origin")R=cd(k.getAttribute("xyz")),M=cd(k.getAttribute("rpy"));else if(L==="child"){const N=k.getAttribute("link")||"";A=l[N]||null}else if(L==="parent"){const N=k.getAttribute("link")||"";C=l[N]||null}else if(L==="limit"){const N=k.getAttribute("lower"),z=k.getAttribute("upper");N!==null&&(T.limit.lower=parseFloat(N)),z!==null&&(T.limit.upper=parseFloat(z))}}),C?C.add(T):console.warn(`URDFLoader: Joint '${T.name}' has no parent.`),A?T.add(A):console.warn(`URDFLoader: Joint '${T.name}' has no child.`),HF(T,M),T.position.set(R[0],R[1],R[2]);const D=_.find(k=>k.nodeName.toLowerCase()==="axis");if(D){const k=D.getAttribute("xyz");if(k){const L=cd(k);T.axis=new $(L[0],L[1],L[2]),T.axis.normalize()}}return T}function m(x,_,w,T){const S=T||new RM,C=Array.from(x.children);return S.name=x.getAttribute("name")||"",S.urdfName=S.name,S.urdfNode=x,i&&C.filter(A=>A.nodeName.toLowerCase()==="visual").forEach(A=>{const R=y(A,u);if(S.add(R),A.hasAttribute("name")){const M=A.getAttribute("name")||"";R.name=M,R.urdfName=M,_[M]=R}}),s&&C.filter(A=>A.nodeName.toLowerCase()==="collision").forEach(A=>{const R=y(A);if(S.add(R),A.hasAttribute("name")){const M=A.getAttribute("name")||"";R.name=M,R.urdfName=M,w[M]=R}}),S}function g(x){const _=Array.from(x.children),w=new Ur;return w.name=x.getAttribute("name")||"",w.roughness=0,w.metalness=.4,w.ior=1.6,_.forEach(T=>{const S=T.nodeName.toLowerCase();if(S==="color"){const C=(T.getAttribute("rgba")||"1 1 1 1").split(/\s/g).map(Number);w.color.setRGB(C[0],C[1],C[2]),w.opacity=C[3],w.transparent=C[3]<1,w.depthWrite=!w.transparent}else if(S==="texture"){const C=T.getAttribute("filename");if(C){const A=new ns(a),R=f(C);R&&(w.map=A.load(R),w.map.colorSpace=Er)}}}),w}function y(x,_={}){const w=x.nodeName.toLowerCase()==="collision",T=Array.from(x.children);let S=null;const C=T.find(R=>R.nodeName.toLowerCase()==="material");if(C){const R=C.getAttribute("name")||"";R&&R in _?S=_[R]:S=g(C)}else S=new Ur;const A=w?new tK:new nK;return A.urdfNode=x,T.forEach(R=>{const M=R.nodeName.toLowerCase();if(M==="geometry"){const D=R.firstElementChild;if(!D)return;const k=D.nodeName.toLowerCase();if(k==="mesh"){const L=D.getAttribute("filename");if(!L)return;const N=f(L);if(N!==null){const z=D.getAttribute("scale");if(z){const O=cd(z);A.scale.set(O[0],O[1],O[2])}r(N,a,(O,K)=>{K?console.error("URDFLoader: Error loading mesh.",K):O&&(O instanceof ln&&(O.material=S),O.position.set(0,0,0),O.quaternion.identity(),A.add(O))})}}else if(k==="box"){const L=new ln;L.geometry=new fc(1,1,1),L.material=S;const N=D.getAttribute("size")||"1 1 1",z=cd(N);L.scale.set(z[0],z[1],z[2]),A.add(L)}else if(k==="sphere"){const L=new ln;L.geometry=new Tf(1,30,30),L.material=S;const N=parseFloat(D.getAttribute("radius")||"1");L.scale.set(N,N,N),A.add(L)}else if(k==="cylinder"){const L=new ln;L.geometry=new hu(1,1,1,30),L.material=S;const N=parseFloat(D.getAttribute("radius")||"1"),z=parseFloat(D.getAttribute("length")||"1");L.scale.set(N,z,N),L.rotation.set(Math.PI/2,0,0),A.add(L)}}else if(M==="origin"){const D=cd(R.getAttribute("xyz")),k=cd(R.getAttribute("rpy"));A.position.set(D[0],D[1],D[2]),A.rotation.set(0,0,0),HF(A,k)}}),A}return d(e)}defaultMeshLoader(e,n,r){/\.stl$/i.test(e)?new bRe(n).load(e,i=>{const s=new ln(i,new Ur);r(s)},void 0,i=>{console.error("URDFLoader: STLLoader error:",i),r(null,i)}):/\.dae$/i.test(e)?new ERe(n).load(e,i=>{r(i.scene)},void 0,i=>{console.error("URDFLoader: ColladaLoader error:",i),r(null,i)}):(console.warn(`URDFLoader: Could not load model at ${e}.
No loader available`),r(null,new Error(`No loader available for ${e}`)))}}function GF(t){const e=t.split("/"),n=[];for(const r of e)r===".."?n.pop():r!=="."&&n.push(r);return n.join("/")}const SRe={roughness:.01,metalness:.2,ior:1.6,reflectivity:1};function rK({_key:t,src:e,text:n,buff:r,assets:i,hide:s,encoding:o="ascii",jointValues:a,workingPath:l,fetchOptions:c,parseVisual:u,parseCollision:f,packages:d,onLoad:h,color:p,material:m,materialType:g,...y}){const[x,_]=v.useState(),{showError:w,showInfo:T}=v.useContext($y);m=m||SRe;const S=v.useMemo(()=>{const A=new wRe;return l?A.workingPath=l:e&&(A.workingPath=e.split("/").slice(0,-1).join("/")+"/"),c&&(A.fetchOptions=c),u&&(A.parseVisual=u),f&&(A.parseCollision=f),d&&d.length&&(A.packages=d),A.manager.setURLModifier(R=>{if(R.startsWith("blob:"))return R;const M=GF(R);return i!=null&&i[M]?i[M]:M}),A.loadMeshCb=function(R,M,D){if(typeof R!="string")return;const k=GF(R),L=k.split("/").slice(0,-1).join("/")+"/",N=k.toLowerCase().split(".").pop(),z=k,O=K=>{w(`Failed to load mesh: ${z}`),D(void 0,K)};if(N==="obj"){const K=new IG(M);K.setResourcePath(L),K.load(z,D,void 0,O)}else if(N==="stl"){const K=new CG(M);K.setResourcePath(L),K.load(z,V=>{const ne=new Ur({emissive:5526612,roughness:.01,metalness:.4,reflectivity:.5,ior:1.6}),re=new ln(V,ne);D(re)},void 0,O)}else if(N==="glb"){const K=new m5(M);K.setResourcePath(L),K.load(z,V=>D(V.scene),void 0,O)}else if(N==="gltf"){const K=new m5(M);K.setResourcePath(L),K.load(z,V=>D(V.scene),void 0,O)}else if(N==="pcd")new PG(M).load(z,D,void 0,O);else if(N==="dae"){const K=new RG(M);K.setResourcePath(L),K.load(z,V=>D(V.scene),void 0,O)}else T(`Unknown mesh type: ${z}`)},A},[e,l,c,u,f,d]);v.useEffect(()=>{!x&&s||(r&&(n=new TextDecoder(o).decode(r)),n?_(S.parse(n)):e!=null&&e.length&&(i!=null&&i[e]&&(e=i[e]),S.load(e,_)))},[S,e,s]);const{sendMsg:C}=Mr();return v.useEffect(()=>{x&&(typeof h=="function"?h():C({ts:Date.now(),etype:"LOAD",key:t,value:h}))},[x]),x?H.jsx(yRe,{robot:x,jointValues:a,hide:s,materialType:g,material:m,...y}):null}function iK({_key:t,src:e,text:n,buff:r,hide:i,encoding:s="ascii",onLoad:o,...a}){const[l,c]=v.useState();v.useEffect(()=>{if(!l&&i)return;const f=new CG;if(r&&(n=new TextDecoder(s).decode(r)),n){const d=f.parse(n);c(d)}else e&&f.load(e,c)},[e,i]);const{sendMsg:u}=Mr();return v.useEffect(()=>{l&&(typeof o=="function"&&o(),typeof o=="string"&&u({ts:Date.now(),etype:"LOAD",key:t,value:o}))},[l]),console.log(l),l?H.jsx(dRe,{data:l,hide:i,...a}):null}function sK({_key:t,src:e,text:n,buff:r,hide:i,encoding:s="utf8",onLoad:o,...a}){const[l,c]=v.useState();v.useEffect(()=>{if(!l&&i)return;const f=new RG;if(r&&(n=new TextDecoder(s).decode(r)),n){const d=f.parse(n,"");c(d.scene)}else e&&f.load(e,d=>c(d.scene))},[e,i]);const{sendMsg:u}=Mr();return v.useEffect(()=>{l&&(typeof o=="function"&&o(),typeof o=="string"&&u({ts:Date.now(),etype:"LOAD",key:t,value:o}))},[l]),l?H.jsx(hRe,{data:l,hide:i,...a}):null}const Z_=(t,e)=>nr(({session:n})=>{const r=n==null?void 0:n.inputSources;if(r){for(const i of r)if((i==null?void 0:i.handedness)===e&&i[t])return i[t]}}),M1=(t=null,e=null)=>{if(!t||!e)return null;try{return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}catch{return null}},Yu=(t=null)=>t?[t[12],t[13],t[14]]:null,TRe=[0,4,8,12,1,5,9,13,2,6,10,14,3,7,11,15];function oy(t){return TRe.map(e=>t[e])}const IM=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],Jr={};function oK(t,e,n){if(!t)return[null,null];let r=e.getJointPose(t,n),i=r==null?void 0:r.transform,s=(r==null?void 0:r.emulatedPosition)||!!i;return[i==null?void 0:i.matrix,s]}function aK(t,e,n,r){if(!e||!n)return null;const i=e.get(n),[s,o]=oK(i,t,r);return s}function jF(t,e,n,r){if(!e)return;const i=[],s={};IM.forEach((c,u)=>{const f=e.get(c),[d,h]=oK(f,t,r);if(i.push(...d),!n)return;const p=n==null?void 0:n.children[u];s[c]=d,p.visible=h,p.matrix.set(...oy(d))});const o=M1(Yu(s["thumb-tip"]),Yu(s["index-finger-tip"])),a=M1(Yu(s["middle-finger-tip"]),Yu(s["middle-finger-phalanx-proximal"])),l=M1(Yu(s["thumb-tip"]),Yu(s["index-finger-tip"]));return{poses:i,landmarks:s,pinch:o<.01,pinchValue:o,squeeze:a<.07,squeezeValue:a,tap:l<.01,tapValue:l}}function lK({_key:t="hands",children:e,fps:n=30,left:r,right:i,showLeft:s=!0,showRight:o=!0,stream:a=!1,...l}){const{sendMsg:c}=Mr(),u=nr(({mode:y})=>y),f=nr(({originReferenceSpace:y})=>y),d=Z_("hand","left"),h=Z_("hand","right"),p=!!u,m=v.useRef(),g=v.useRef();return v.useEffect(()=>{const y=m.current;y&&(y.matrixAutoUpdate=!1,y==null||y.children.forEach(x=>x.matrixAutoUpdate=!1))},[m.current]),v.useEffect(()=>{const y=g.current;y&&(y.matrixAutoUpdate=!1,y==null||y.children.forEach(x=>x.matrixAutoUpdate=!1))},[g.current]),Yt(function(y,x,_){if(!p)return;const w=m.current,T=g.current,{poses:S,landmarks:C,...A}=jF(_,d,w,f)||{},{poses:R,landmarks:M,...D}=jF(_,h,T,f)||{};Jr.left=A,Jr.right=D,Jr.leftLandmarks=C,Jr.rightLandmarks=M,a&&c({ts:Date.now(),etype:"HAND_MOVE",key:t,value:{left:S,right:R,leftState:A,rightState:D}})}),!p||!d&&!h?null:H.jsxs("group",{children:[i||!s?null:H.jsx("group",{ref:m,castShadow:!0,children:IM.map((y,x)=>H.jsxs("mesh",{children:[H.jsx("boxGeometry",{args:[.01,.01,.01]}),H.jsx("meshStandardMaterial",{attach:"material",color:"#ff4444",roughness:.1})]},y))}),r||!o?null:H.jsx("group",{ref:g,castShadow:!0,children:IM.map((y,x)=>H.jsxs("mesh",{children:[H.jsx("boxGeometry",{args:[.01,.01,.01]}),H.jsx("meshStandardMaterial",{attach:"material",color:"#23aaff",roughness:.1})]},y))})]})}const Q_=(t,e)=>nr(({session:n})=>{const r=n==null?void 0:n.inputSources;if(r){for(const i of r)if((i==null?void 0:i.handedness)===e&&i[t]&&i.gamepad.buttons.length>=6)return i}}),VF=["trigger","squeeze","thumbstick","a-button","b-button"],oa={};function ARe(t,e,n){if(t.targetRayMode==="tracked-pointer"&&t.targetRaySpace){const r=e.getPose(t.targetRaySpace,n),i=r==null?void 0:r.transform,s=r!==null;return[i==null?void 0:i.matrix,s]}return[null,null]}function J_(t,e,n){var r,i,s,o,a,l,c,u,f,d;if(!e)return;const[h,p]=ARe(e,t,n);if(!h)return;const m=e.gamepad,g=(m==null?void 0:m.buttons)||[];return{transform:Array.from(h),trigger:((r=g[0])==null?void 0:r.pressed)||!1,squeeze:((i=g[1])==null?void 0:i.pressed)||!1,touchpad:((s=g[2])==null?void 0:s.pressed)||!1,thumbstick:((o=g[3])==null?void 0:o.pressed)||!1,aButton:((a=g[4])==null?void 0:a.pressed)||!1,bButton:((l=g[5])==null?void 0:l.pressed)||!1,triggerValue:((c=g[0])==null?void 0:c.value)||0,squeezeValue:((u=g[1])==null?void 0:u.value)||0,touchpadValue:[(m==null?void 0:m.axes[0])||0,(m==null?void 0:m.axes[1])||0],thumbstickValue:[(m==null?void 0:m.axes[2])||0,(m==null?void 0:m.axes[3])||0],aButtonValue:((f=g[4])==null?void 0:f.pressed)||!1,bButtonValue:((d=g[5])==null?void 0:d.pressed)||!1}}function cK({_key:t="motionControllers",children:e,fps:n=30,left:r,right:i,stream:s=!1,...o}){const{sendMsg:a}=Mr(),l=nr(({mode:_})=>_),c=nr(({originReferenceSpace:_})=>_),u=Q_("gamepad","left"),f=Q_("gamepad","right"),d=!!l,h=v.useRef(),p=v.useRef(),m=v.useRef(new Ka({color:"#ff4444"})),g=v.useRef(new Ka({color:"#23aaff"})),y=new oi({color:65280}),x=new gn().setFromPoints([new $(0,0,0),new $(0,0,-1)]);return v.useEffect(()=>{const _=h.current;_&&(_.matrixAutoUpdate=!1,_==null||_.children.forEach(w=>w.matrixAutoUpdate=!1))},[h.current]),v.useEffect(()=>{const _=p.current;_&&(_.matrixAutoUpdate=!1,_==null||_.children.forEach(w=>w.matrixAutoUpdate=!1))},[p.current]),Yt(function(_,w,T){if(!d)return;const S=h.current,C=p.current,A={},{transform:R,...M}=J_(T,u,c)||{},{transform:D,...k}=J_(T,f,c)||{};if(M&&S&&(A.left=R,A.leftState=M,m.current.color.set(M.trigger?"green":"#ff4444"),S.matrix.set(...oy(A.left)),S.visible=!0,!S.getObjectByName("rightRay"))){const L=new $o(x,y);L.name="leftRay",S.add(L)}if(k&&C&&(A.right=D,A.rightState=k,g.current.color.set(k.trigger?"green":"#23aaff"),C.matrix.set(...oy(A.right)),C.visible=!0,!C.getObjectByName("rightRay"))){const L=new $o(x,y);L.name="rightRay",C.add(L)}s&&a({ts:Date.now(),etype:"CONTROLLER_MOVE",key:t,value:A})}),!d||!u&&!f?null:H.jsxs("group",{children:[i?null:H.jsx("group",{ref:h,castShadow:!0,children:VF.map(_=>H.jsx("mesh",{material:m.current,children:H.jsx("boxGeometry",{args:[.1,.1,.1]})},_))}),r?null:H.jsx("group",{ref:p,castShadow:!0,children:VF.map(_=>H.jsx("mesh",{material:g.current,children:H.jsx("boxGeometry",{args:[.1,.1,.1]})},_))})]})}const sR=({position:t=[0,1,-1],quaternion:e,onMove:n,onMoveEnd:r,...i})=>{const s=v.useRef(null),o=v.useRef(null),a=v.useRef(null),l=v.useRef(null),c=v.useRef(null),u=v.useRef(null),f=!!nr(({mode:m})=>m);Yt((m,g,y)=>{var x,_,w,T,S,C,A,R,M,D,k,L,N,z,O,K,V,ne,re;if(f&&s.current){if(s.current==="right"&&Jr.rightLandmarks){const P=Jr.rightLandmarks.wrist;if((x=Jr.right)!=null&&x.squeeze&&l.current&&c.current){const se=new et().fromArray(c.current).invert(),ue=new et().fromArray(P).multiply(se),te=new et().extractRotation(ue);(_=o.current)==null||_.matrix.extractRotation(l.current),(w=o.current)==null||w.matrix.premultiply(te);const W=new $().setFromMatrixPosition(l.current),X=new et().fromArray(c.current),J=new $().setFromMatrixPosition(X),oe=new $(P[12],P[13],P[14]);oe.sub(J),oe.add(W);const Ee=new et().makeTranslation(oe);(T=o.current)==null||T.matrix.premultiply(Ee),o.current.matrixAutoUpdate=!1,typeof n=="function"&&n({world:o.current.matrix.clone()})}else l.current=(S=o.current)==null?void 0:S.matrix.clone(),c.current=P}if(s.current==="left"&&Jr.leftLandmarks){const P=(C=Jr.leftLandmarks)==null?void 0:C.wrist;if((A=Jr.left)!=null&&A.squeeze&&l.current&&c.current){const se=new et().fromArray(c.current).invert(),ue=new et().fromArray(P).multiply(se),te=new et().extractRotation(ue);(R=o.current)==null||R.matrix.extractRotation(l.current),(M=o.current)==null||M.matrix.premultiply(te);const W=new $().setFromMatrixPosition(l.current),X=new et().fromArray(c.current),J=new $().setFromMatrixPosition(X),oe=new $(P[12],P[13],P[14]);oe.sub(J),oe.add(W);const Ee=new et().makeTranslation(oe);(D=o.current)==null||D.matrix.premultiply(Ee),o.current.matrixAutoUpdate=!1,typeof n=="function"&&n({world:o.current.matrix.clone()})}else l.current=(k=o.current)==null?void 0:k.matrix.clone(),c.current=P}if(s.current==="rightController"&&oa.right){const P=oa.rightPose;if(oa.right.squeeze&&l.current&&u.current){const se=new et().fromArray(u.current).invert(),ue=new et().fromArray(P).multiply(se),te=new et().extractRotation(ue);(L=o.current)==null||L.matrix.extractRotation(l.current),(N=o.current)==null||N.matrix.premultiply(te);const W=new $().setFromMatrixPosition(l.current),X=new et().fromArray(u.current),J=new $().setFromMatrixPosition(X),oe=new $(P[12],P[13],P[14]);oe.sub(J),oe.add(W);const Ee=new et().makeTranslation(oe.x,oe.y,oe.z);(z=o.current)==null||z.matrix.premultiply(Ee),o.current.matrixAutoUpdate=!1,typeof n=="function"&&n({world:o.current.matrix.clone()})}else l.current=(O=o.current)==null?void 0:O.matrix.clone(),u.current=P}if(s.current==="leftController"&&oa.left){const P=oa.leftPose;if(oa.left.squeeze&&l.current&&u.current){const se=new et().fromArray(u.current).invert(),ue=new et().fromArray(P).multiply(se),te=new et().extractRotation(ue);(K=o.current)==null||K.matrix.extractRotation(l.current),(V=o.current)==null||V.matrix.premultiply(te);const W=new $().setFromMatrixPosition(l.current),X=new et().fromArray(u.current),J=new $().setFromMatrixPosition(X),oe=new $(P[12],P[13],P[14]);oe.sub(J),oe.add(W);const Ee=new et().makeTranslation(oe.x,oe.y,oe.z);(ne=o.current)==null||ne.matrix.premultiply(Ee),o.current.matrixAutoUpdate=!1,typeof n=="function"&&n({world:o.current.matrix.clone()})}else l.current=(re=o.current)==null?void 0:re.matrix.clone(),u.current=P}}});const[d,h]=v.useState(!1);let p=d?"#ffff88":"#777";return(s.current==="left"||s.current==="leftController")&&(p="#ff4444"),(s.current==="right"||s.current==="rightController")&&(p="#23aaff"),H.jsx("group",{ref:o,position:t,quaternion:e,...i,children:H.jsxs("mesh",{ref:a,onPointerEnter:()=>h(!0),onPointerLeave:()=>h(!1),onPointerMissed:()=>h(!1),onClick:m=>{var g,y,x,_,w,T,S,C,A,R;console.log("Clicked"),console.log("Right Trigger State:",(g=oa.right)==null?void 0:g.trigger),m.stopPropagation(),(y=Jr.left)!=null&&y.pinch&&!((x=Jr.right)!=null&&x.pinch)?s.current=s.current==="left"?null:"left":(_=Jr.right)!=null&&_.pinch&&!((w=Jr.left)!=null&&w.pinch)?s.current=s.current==="right"?null:"right":(T=oa.left)!=null&&T.trigger&&!((S=oa.right)!=null&&S.trigger)?s.current=s.current==="leftController"?null:"leftController":(C=oa.right)!=null&&C.trigger&&!((A=oa.left)!=null&&A.trigger)&&(s.current=s.current==="rightController"?null:"rightController"),l.current=(R=o.current)==null?void 0:R.matrix.clone()},children:[H.jsx("boxGeometry",{args:[.1,.1,.1]}),H.jsx("meshPhysicalMaterial",{transparent:!0,roughness:.1,color:p,wireframe:!0})]})})},uK=v.forwardRef(({size:t,children:e,opacity:n=1,...r},i)=>H.jsxs("mesh",{ref:i,...r,children:[H.jsx("boxGeometry",{args:t}),H.jsx("meshPhongMaterial",{opacity:n,transparent:n<1,color:16777207}),e]}));function oR({children:t,_key:e,_ref:n,anchor:r,offset:i,scale:s=.4,lineWidth:o=1,matrix:a,position:l,rotation:c,onMove:u,onMoveEnd:f,...d}){const[h,p]=v.useState({}),m=v.useRef(),g=n||m,{sendMsg:y}=Mr(),x=v.useMemo(()=>({position:new $(...l||[0,0,0]),rotation:new xr(...c||[0,0,0]),quaternion:new bn,scale:new $}),[]);v.useEffect(()=>{if(!g.current)return;const T=g.current;a&&(T.matrix.fromArray(a),T.matrix.decompose(T.position,T.quaternion,T.scale),T.rotation.setFromQuaternion(T.quaternion))},[a,g.current]),v.useEffect(()=>{if(!g.current)return;const T=g.current;if(a)return;let S=!1;l&&(T.position.fromArray(l),S=!0),c&&(T.rotation.fromArray(c),S=!0),S&&(T==null||T.updateMatrix())},[l,c,g.current]);function _(T,S,C,A){T.decompose(x.position,x.quaternion,x.scale),x.rotation.setFromQuaternion(x.quaternion);const R={matrix:T.toArray(),matrixWorld:C.toArray(),position:x.position.toArray(),rotation:x.rotation.toArray(),quaternion:x.quaternion.toArray()};y({ts:Date.now(),etype:"OBJECT_MOVE",key:e,value:R}),u&&u(R),p(R)}function w(){y({ts:Date.now(),etype:"OBJECT_MOVE_END",key:e,value:h})}return H.jsx(wge,{ref:g,anchor:r,offset:i,scale:s,onDrag:_,onDragEnd:w,lineWidth:o,...d,children:t})}function aR({_key:t,_ref:e,offset:n,scale:r,position:i,rotation:s,children:o=[],onMove:a,onMoveEnd:l}){const c=v.useRef(),u=e||c,{sendMsg:f}=Mr(),d=v.useMemo(()=>({position:new $,rotation:new xr,quaternion:new bn,scale:new $}),[]);v.useCallback(()=>{var p,m;const g=(p=u.current)==null?void 0:p.matrix,y=(m=u.current)==null?void 0:m.matrixWorld;y.decompose(d.position,d.quaternion,d.scale),d.rotation.setFromQuaternion(d.quaternion);const x={matrix:g.toArray(),matrixWorld:y.toArray(),position:d.position.toArray(),rotation:d.rotation.toArray(),quaternion:d.quaternion.toArray()};l&&l(x),f({ts:Date.now(),etype:"OBJECT_MOVE_END",key:t,value:x})},[]);const h=v.useCallback(({world:p})=>{p.decompose(d.position,d.quaternion,d.scale),d.rotation.setFromQuaternion(d.quaternion);const m={matrixWorld:p.toArray(),position:d.position.toArray(),rotation:d.rotation.toArray(),quaternion:d.quaternion.toArray()};a&&a(m),f({ts:Date.now(),etype:"OBJECT_MOVE",key:t,value:m})},[]);return H.jsx(sR,{position:i,rotation:s,onMove:h,children:o})}function lR({_key:t,_ref:e,children:n,anchor:r,offset:i,scale:s=.4,lineWidth:o=2,handleOffset:a=[0,0,0],hide:l,...c}){const{mode:u}=nr();return l?H.jsx(H.Fragment,{children:n}):u?H.jsx(aR,{_key:t,_ref:e,scale:s*.1,offset:a,...c,children:n}):H.jsx(oR,{_key:t,_ref:e,anchor:r,offset:i,scale:s,lineWidth:o,...c,children:n})}const fK=({position:t=[0,1,-1],rotation:e,onMove:n,onMoveEnd:r,...i})=>{const[s,o]=v.useState(!1),a=v.useRef(null),l=v.useRef(null),c=v.useRef(null),u=v.useRef(null),f=v.useRef(null),d=!!nr(({mode:p})=>p);Yt((p,m,g)=>{var y,x,_,w,T,S,C,A;if(d&&a.current){if(a.current==="right"&&Jr.rightLandmarks){const R=Jr.rightLandmarks.wrist;if((y=Jr.right)!=null&&y.squeeze&&u.current&&f.current){const M=new et().fromArray(f.current).invert(),D=new et().fromArray(R).multiply(M);(x=l.current)==null||x.matrix.copy(u.current),(_=l.current)==null||_.matrix.premultiply(D),l.current.matrixAutoUpdate=!1,n({world:l.current.matrix.clone()})}else u.current=(w=l.current)==null?void 0:w.matrix.clone(),f.current=R}if(a.current==="left"&&Jr.leftLandmarks){const R=Jr.leftLandmarks.wrist;if((T=Jr.left)!=null&&T.squeeze&&u.current&&f.current){const M=new et().fromArray(f.current).invert(),D=new et().fromArray(R).multiply(M);(S=l.current)==null||S.matrix.copy(u.current),(C=l.current)==null||C.matrix.premultiply(D),l.current.matrixAutoUpdate=!1,n({world:l.current.matrix.clone()})}else u.current=(A=l.current)==null?void 0:A.matrix.clone(),f.current=R}}});let h=s?"#ffff88":"#777";return a.current==="left"&&(h="#ff4444"),a.current==="right"&&(h="#23aaff"),H.jsx("group",{ref:l,position:t,rotation:e,...i,children:H.jsxs("mesh",{ref:c,onPointerEnter:()=>o(!0),onPointerLeave:()=>o(!1),onPointerMissed:()=>o(!1),onClick:p=>{var m,g;p.stopPropagation(),Jr.left.pinch&&!Jr.right.pinch&&(a.current==="left"?a.current=null:(a.current="left",u.current=(m=l.current)==null?void 0:m.matrix.clone())),Jr.right.pinch&&!Jr.left.pinch&&(a.current==="right"?a.current=null:(a.current="right",u.current=(g=l.current)==null?void 0:g.matrix.clone()))},children:[H.jsx("boxGeometry",{args:[.1,.1,.1]}),H.jsx("meshPhysicalMaterial",{transparent:!0,color:h,roughness:.1})]})})};function MRe(t,e,n,r,i){e.setFromCamera(n,t);const s=e.intersectObjects(r,!0);if(i){const o=s.slice(0,i);return o.reduce((a,{point:l})=>a.add(l),new $(0,0,0)).divideScalar(o.length)}if(s)return s[0].point}function dK(t){return t.reduce((e,n)=>n.type==="Group"?e.concat(dK(n.children)):e.concat(n),[])}function cR({parent:t,thres:e=.01,color:n="red",onClick:r,childSelector:i=({type:a})=>a==="Points",average:s,disable:o=!1}){const{scene:a,camera:l,raycaster:c,pointer:u}=At(),f=v.useRef();return v.useEffect(()=>{var d,h,p,m;c.params.Points.threshold=e;const g={is_down:!1},y=()=>{g.is_down=!0},x=()=>{g.is_down=!1},_=()=>{if(g.is_down)return;const T=dK(a.children).filter(i),S=MRe(l,c,u,T,s);g.pos=S,f.current.position.set(...S),vm()},w=T=>{if(typeof r!="function")return;const S=T.target;r({position:f.current.position.clone(),radius:e,x:T.offsetX/S.offsetWidth,y:T.offsetY/S.offsetHeight,offsetX:T.offsetX,offsetY:T.offsetY,offsetHeight:S.offsetHeight,offsetWidth:S.offsetWidth})};return(d=t.current)==null||d.addEventListener("mousedown",y),(h=t.current)==null||h.addEventListener("mouseup",x),(p=t.current)==null||p.addEventListener("mousemove",_),(m=t.current)==null||m.addEventListener("click",w),()=>{var T,S,C,A;(T=t.current)==null||T.removeEventListener("mousedown",y),(S=t.current)==null||S.removeEventListener("mouseup",x),(C=t.current)==null||C.removeEventListener("mousemove",_),(A=t.current)==null||A.removeEventListener("click",w)}},[e,r,o]),H.jsx(SC,{ref:f,args:[e],children:H.jsx("meshBasicMaterial",{color:n,opacity:1,transparent:!0})})}function hK({parentKey:t,parent:e}){const{gl:n}=At(),r=v.useRef();v.useLayoutEffect(()=>{e||(r.current=n.domElement)},[]);const i=e||r,{sendMsg:s}=Mr(),{enableMarker:o,markerSize:a,markerAvg:l,color:c}=vr("Scene.Pointer",{color:"red",enableMarker:{value:!1,label:"Enable"},markerSize:{value:10,min:.1,max:100,step:.1,pad:1,label:"Pointer Size"},markerAvg:{value:5,min:0,max:20,step:1,label:"Average k"}},{collapsed:!0}),u=({position:f,radius:d,x:h,y:p,...m})=>{let g;!f||f.x!==f.x||f.y!==f.y||f.z!==f.z?g={etype:"MOUSE_CLICK",key:t,value:{pointerX:h,pointerY:p,...m}}:g={etype:"ADD_MARKER",key:t,value:{position:f,radius:d,pointerX:h,pointerY:p,...m}},typeof s=="function"&&s(g)};return H.jsx(cR,{parent:i,thres:a/1e3,onClick:u,average:l,disable:!o,color:c})}function VE({min:t={x:-1,y:-1,z:-1},max:e={x:1,y:1,z:1},color:n="0xffffff",scale:r=1.01,...i}){const s=[e.x-t.x,e.y-t.y,e.z-t.z],o=[t.x+s[0]/2,t.y+s[1]/2,t.z+s[2]/2];return H.jsxs("mesh",{position:o,...i,children:[H.jsx("boxGeometry",{args:s}),H.jsx("meshBasicMaterial",{transparent:!0,depthWrite:!1,opacity:0}),H.jsx(aj,{scale:r,color:n})]})}function WF(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.filter(Boolean);if(n.length<=1){var r=n[0];return r||null}return function(i){n.forEach(function(s){typeof s=="function"?s(i):s&&(s.current=i)})}}const CRe=t=>typeof t=="function",RRe=v.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,makeDefault:r,children:i,...s},o)=>{const a=At(({set:m})=>m),l=At(({camera:m})=>m),c=v.useRef(null),u=v.useRef(null),f=Mo(e);let d=0,h=null;const p=CRe(i);if(Yt(m=>{p&&(n===1/0||d<n)&&(u.current.visible=!1,m.gl.setRenderTarget(f),h=m.scene.background,t&&(m.scene.background=t),m.gl.render(m.scene,c.current),m.scene.background=h,m.gl.setRenderTarget(null),u.current.visible=!0,d++)}),v.useLayoutEffect(()=>{if(r){const m=l;return a(()=>({camera:c.current})),()=>a(()=>({camera:m}))}},[c,r,a]),p){const m=i;return H.jsxs(H.Fragment,{children:[H.jsx("perspectiveCamera",{ref:WF(c,o),...s}),H.jsx("group",{ref:u,children:m(f.texture)})]})}else return H.jsx("perspectiveCamera",{ref:WF(c,o),...s,children:i})});function IRe(t,e){for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function eb({_key:t,_ref:e,position:n,rotation:r,matrix:i,aspect:s=4/3,focus:o=10,fov:a=50,near:l=.1,far:c=.2,scale:u=1,upScale:f=1,focalLength:d=.035,showUp:h=!0,showFrustum:p=!0,showFocalPlane:m=!0,showImagePlane:g=!1,colorFrustum:y=16755200,colorCone:x=16711680,colorFocalPlane:_="white",colorUp:w=43775,colorTarget:T="green",colorCross:S=3355443,children:C}){const A=v.useMemo(()=>({raw:null,matrix:new et,position:new $(0,0,0),rotation:new xr(0,0,0),quaternion:new bn(0,0,0,0),scale:new $(0,0,0)}),[]);let R=v.useRef();e&&(R=e),v.useLayoutEffect(()=>{if(R.current)if(i){if(A.raw&&IRe(A.raw,i))return;A.raw=i,A.matrix.fromArray(i),A.matrix.decompose(R.current.position,A.quaternion,A.scale),R.current.rotation.setFromQuaternion(A.quaternion)}else n&&r&&(R.current.position.set(...n),R.current.rotation.set(...r),R.current.updateMatrix())},[i,a,o,l,c]);const M=v.useMemo(()=>{const D=Math.tan(a/360*Math.PI),k=D*o,L=s*k,N=D*d,z=s*N,O=D*l,K=s*O,V=D*c,ne=s*V;return{up:[[-z*.6,N*1.05,-d],[z*.6,N*1.05,-d],[0,N+Math.max(N*.4,z*.25),-d],[-z*.6,N*1.05,-d]],imagePlaneCone:[[0,0,0],[-z,-N,-d],[0,0,0],[z,-N,-d],[0,0,0],[z,N,-d],[0,0,0],[-z,N,-d]],imagePlane:[[-z,-N,-d],[z,-N,-d],[z,N,-d],[-z,N,-d],[-z,-N,-d]],nearPlane:[[-K,-O,-l],[K,-O,-l],[K,O,-l],[-K,O,-l],[-K,-O,-l]],cone:[[0,0,0],[-K,-O,-l],[0,0,0],[K,-O,-l],[0,0,0],[K,O,-l],[0,0,0],[-K,O,-l],[0,0,0],[-K,-O,-l]],farPlane:[[-ne,-V,-c],[ne,-V,-c],[ne,V,-c],[-ne,V,-c],[-ne,-V,-c]],farPlaneFrustum:[[-K,-O,-l],[-ne,-V,-c],[K,-O,-l],[ne,-V,-c],[K,O,-l],[ne,V,-c],[-K,O,-l],[-ne,V,-c]],focalPlane:[[-L,-k,-o],[L,-k,-o],[L,k,-o],[-L,k,-o],[-L,-k,-o]],crossHair:[[0,k,-o],[0,-k,-o],[L,0,-o],[-L,0,-o]]}},[a,o,s,l,c]);return H.jsxs("group",{ref:R,position:n,rotation:r,children:[h?H.jsx(Ni,{scale:u*f,points:M.up,color:w,lineWidth:1},"up"):null,g?H.jsx(Ni,{scale:u,points:M.imagePlaneCone,color:x,lineWidth:2,segments:!0},"image-plane-cone"):null,g?H.jsx(Ni,{scale:u,points:M.imagePlane,color:_,lineWidth:2},"image-plane"):null,p?[H.jsx(Ni,{points:M.nearPlane,color:y,lineWidth:1},"near-plane"),H.jsx(Ni,{points:M.cone,color:x,lineWidth:1,segments:!0},"cone"),H.jsx(Ni,{points:M.farPlane,color:y,lineWidth:1},"far-plane"),H.jsx(Ni,{points:M.farPlaneFrustum,color:y,lineWidth:1,segments:!0},"far-plane-frustum")]:null,m?[H.jsx(SC,{position:[0,0,-o],"material-color":T,scale:.2},"focus"),H.jsx(Ni,{points:M.focalPlane,color:_,lineWidth:1},"focal-plane"),H.jsx(Ni,{points:M.crossHair,color:S,lineWidth:1,segments:!0},"cross-hair")]:null,C]},t)}const PRe=(t=!1)=>{const[e,n,r]=v.useMemo(()=>{if(t)return[null,null,null];const i=new Hi(-1,1,1,-1,0,1),s=new yr({vertexShader:`
      varying vec2 vUv;
      void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }`,fragmentShader:`
      #include <packing>
    
      varying vec2 vUv;
      uniform sampler2D tDepth;
      uniform float cameraNear;
      uniform float cameraFar;
      
      float readDepth( sampler2D depthSampler, vec2 coord ) {
        float fragCoordZ = texture2D( depthSampler, coord ).x;
        float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
        return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );
      }
      
      void main() {
        float depth = readDepth( tDepth, vUv );
        
        gl_FragColor.rgb = 1.0 - vec3( depth );
        gl_FragColor.a = 1.0;

        // this works. 
        // float d_normal = depth;
        // 
        // // Initialize the color as black
        // vec3 color = vec3(0.0);

        // // Calculate RGB values based on the normalized depth
        // if (d_normal <= 0.167) {
        //   color.r = 1.0;
        //   color.g = d_normal;
        // } else if (d_normal < 0.333) {
        //   color.r = 0.333 - d_normal;
        //   color.g = 1.0;
        // } else if (d_normal < 0.5) {
        //   color.g = 1.0;
        //   color.b = d_normal - 0.5;
        // } else if (d_normal < 0.667) {
        //   color.g = 0.667 - d_normal;
        //   color.b = 1.0;
        // } else if (d_normal < 0.833) {
        //   color.r = d_normal - 0.833;
        //   color.b = 1.0;
        // } else {
        //   color.r = 1.0;
        //   color.b = 1.0 - d_normal;
        // }

        // // Set the fragment's color
        // gl_FragColor.rgb = color;
        
      }`,uniforms:{cameraNear:{value:.1},cameraFar:{value:10},tDepth:{value:null}}}),o=new Ps(2,2),a=new ln(o,s),l=new ls;return l.add(a),[l,s,i]},[t]);return v.useCallback(({renderer:i,depthTexture:s,near:o,far:a})=>{n&&(n.uniforms.tDepth.value=s,n.uniforms.cameraNear.value=o,n.uniforms.cameraFar.value=a,i.setRenderTarget(null),i.render(e,r))},[t])},kRe=(t=!1)=>{const[e,n,r]=v.useMemo(()=>{if(t)return[null,null,null];const i=new Hi(-1,1,1,-1,0,1),s=new Fr,o=new Ps(2,2),a=new ln(o,s),l=new ls;return l.add(a),[l,s,i]},[]);return v.useCallback(({renderer:i,texture:s})=>{var o;n&&(n.map!==s&&((o=n.map)==null||o.dispose(),n.map=s,n.needsUpdate=!0),i.setRenderTarget(null),i.render(e,r))},[t])};async function $F({renderer:t,quality:e}){const n=t.getContext(),r=t.domElement.width,i=t.domElement.height,s=new Uint8Array(r*i*4);return n.readPixels(0,0,r,i,n.RGBA,n.UNSIGNED_BYTE,s),await(await t.domElement.convertToBlob({quality:e,type:"image/jpeg"})).arrayBuffer().then(o=>new Uint8Array(o))}function pK({_ref:t,_key:e,hide:n,width:r=640,height:i=480,matrix:s,fov:o=60,top:a=1,bottom:l=-1,left:c=-1,right:u=1,near:f=.1,far:d=20,renderDepth:h=!1,origin:p="top-left",distanceToCamera:m=.5,ctype:g="perspective",showCamera:y=!0,scale:x=10,showFrustum:_=!0,stream:w=null,fps:T=30,downsample:S=2,quality:C=1,monitor:A=!0,movable:R=!0,children:M=[],...D}){const k=v.useRef(),L=v.useRef(),N=v.useRef(),z=v.useRef(),O=v.useMemo(()=>({sinceLastFrame:0}),[]),{size:K,camera:V,scene:ne}=At(),re=window.devicePixelRatio||1,P=Mo(r*re,i*re,{depth:h}),se=v.useMemo(()=>new $,[]),{sendMsg:ue,downlink:te,uplink:W}=Mr(),X=vr(e?`Scene.Camera-${e}`:"Scene.Camera",{showCamera:{value:y,label:"Show"},camType:{value:g,options:["perspective","orthographic"]}},[y]),J=vr(e?`Scene.Camera-${e}`:"Scene.Camera",{near:{value:f,min:.001,step:.05},far:{value:d,min:.1,step:.1},showImagePlane:{value:!0,label:"Image Plane"},scale:{value:x,min:.1,step:.1},showFrustum:{value:_,label:"Frustum"}},[f,d,_]),oe=vr(e?`Scene.Camera-${e}`:"Scene.Camera",X.camType==="perspective"?{fov:{value:o,min:0,max:170},aspect:{value:r/i,min:.1,max:10}}:{},[X.camType,o,r,i]),Ee=vr(e?`Scene.Camera-${e}`:"Scene.Camera",X.camType==="orthographic"?{top:{value:a,min:-10,step:.1},bottom:{value:l,min:-10,step:.1},left:{value:c,min:-10,step:.1},right:{value:u,min:-10,step:.1}}:{},[X.camType,a,l,c,u]),me=v.useMemo(()=>{const Ce=new Yb({canvas:new OffscreenCanvas(r/S,i/S),antialias:!1,precision:"highp",preserveDrawingBuffer:!0,depth:!0});return Ce.autoClear=!1,Ce.setPixelRatio(re),Ce},[re,i,r,S]);v.useEffect(()=>{let Ce;X.camType==="perspective"?Ce=oe.aspect:Ce=(Ee.right-Ee.left)/(Ee.top-Ee.bottom),k.current.aspect=Ce,k.current.updateProjectionMatrix(),me.setSize(Math.floor(Ce*i/S),Math.floor(i/S),!1),me.setPixelRatio(re),P.setSize(Ce*i*re,i*re)},[re,i,r,S,oe.aspect,Ee.top,Ee.bottom,Ee.left,Ee.right,X.camType]),v.useLayoutEffect(()=>{if(!k.current||!s||s.length!==16)return;const Ce=k.current;Ce.matrix.fromArray(s),Ce.matrix.decompose(Ce.position,Ce.quaternion,Ce.scale),Ce.rotation.setFromQuaternion(Ce.quaternion);const Pe=R?z==null?void 0:z.current:N==null?void 0:N.current;Pe&&(Pe.matrix.fromArray(s),Pe.matrix.decompose(Pe.position,Pe.quaternion,Pe.scale),Pe.rotation.setFromQuaternion(Pe.quaternion))},[s,k.current]);const Te=v.useCallback(()=>{if(!z.current||!k.current)return;const Ce=k.current,Pe=z.current;Ce.matrix.copy(Pe.matrix),Ce.matrix.decompose(Ce.position,Ce.quaternion,Ce.scale),Ce.rotation.setFromQuaternion(Ce.quaternion),ue({ts:Date.now(),etype:"CAMERA_MOVE",key:e,value:{matrix:Ce.matrix.toArray()}})},[z.current,k.current,ue]),_e=v.useRef({});Yt(({gl:Ce,scene:Pe},Ve)=>{if(O.sinceLastFrame+=Ve,!k.current)return;let ye;if(X.camType==="perspective"?ye=oe.aspect:ye=(Ee.right-Ee.left)/(Ee.top-Ee.bottom),O.sinceLastFrame>1/T&&w==="frame"){O.sinceLastFrame=0;const ge=me.getContext(),ze=me.domElement.width,fe=me.domElement.height;L!=null&&L.current&&(L.current.visible=!1),N!=null&&N.current&&(N.current.visible=!1),me.render(Pe,k.current);const ie=new Uint8Array(ze*fe*4);ge.readPixels(0,0,ze,fe,ge.RGBA,ge.UNSIGNED_BYTE,ie),me.domElement.convertToBlob({quality:C,type:"image/jpeg"}).then(ve=>{ve.arrayBuffer().then(Me=>{const Be={ts:Date.now(),etype:"CAMERA_VIEW",key:e,value:{dpr:re,delta:_e,width:r,height:i,frame:new Uint8Array(Me)}};ue(Be)})})}if(A&&L!=null&&L.current){const ge=L.current;ge.visible=!1,N.current&&(N.current.visible=!1),Ce.setRenderTarget(P),Ce.render(Pe,k.current),Ce.setRenderTarget(null),P.texture.colorSpace=ss,ge.visible=!0,N.current&&(N.current.visible=!0);const ze=K.width/K.height,fe=new $(0,0,-1).applyEuler(V.rotation);let ie;switch(p){case"bottom-left":ie=[-1,-1];break;case"bottom-right":ie=[1,-1];break;case"top-left":ie=[-1,1];break;case"top-right":ie=[1,1];break}const ve=Math.tan(V.fov/360*Math.PI);se.set(ie[0]*(1-ye*i/K.width)*ze*ve,ie[1]*(1-i/K.height)*ve,0).applyEuler(V.rotation);const Me=2*ve*m,Be=ye*Me,Ze=i/K.height;ge.scale.set(Be*Ze,Me*Ze,1),ge.position.copy(V.position).addScaledVector(fe,m),ge.lookAt(V.position),ge.position.addScaledVector(se,m)}L!=null&&L.current&&(L.current.visible=!0),N!=null&&N.current&&(N.current.visible=!0)},1);const Re=kRe(),ae=PRe(!h);return v.useEffect(()=>{if(te&&w==="ondemand")return te.subscribe("GRAB_RENDER",async({key:Ce,rtype:Pe,data:{quality:Ve=1}})=>{if(!k.current||Ce!==e)return;L!=null&&L.current&&(L.current.visible=!1),N!=null&&N.current&&(N.current.visible=!1),me.setRenderTarget(P),me.render(ne,k.current);const ye={ts:Date.now(),etype:Pe||"GRAB_RENDER_RESPONSE",key:Ce,value:{dpr:re,width:r,height:i}};Re({renderer:me,texture:P.texture}),ye.value.frame=await $F({renderer:me,quality:Ve}),h&&(ae({renderer:me,depthTexture:P.depthTexture,near:f,far:d}),ye.value.depthFrame=await $F({renderer:me,quality:Ve})),ue(ye)})},[ue,te,W,S,me,me.domElement,P]),n?null:H.jsxs(H.Fragment,{children:[X.showCamera&&!R?H.jsx(eb,{_ref:N,...oe,...J,showFocalPlane:!1,...D,children:M}):null,X.showCamera&&R?H.jsxs(lR,{_ref:z,onMove:Te,matrix:s,...D,children:[H.jsx(eb,{_ref:N,...oe,...J,showFocalPlane:!1}),M]}):null,A?H.jsx(Qme,{ref:L,args:[1,1,r,i],renderOrder:1,children:H.jsx("meshBasicMaterial",{attach:"material",map:P.texture})},"rgb"):null,X.camType==="perspective"?H.jsx(RRe,{ref:k,near:J.near,far:J.far,...oe,...D}):null,X.camType==="orthographic"?H.jsx(nE,{ref:k,near:J.near,far:J.far,...Ee,...D}):null]})}function mK({_key:t,children:e,hide:n=!1,intensity:r=1,color:i="#ffffff",levaPrefix:s="Scene.",lookAt:o=[0,0,0],...a}){const l=v.useRef();let c=s?`${s}Rect Area Light`:"Rect Area Light";c=t?`${c}-[${t}]`:c;const u=vr(c,{intensity:{value:r,step:.05},color:i,hide:n},[r,i,n]);return v.useLayoutEffect(()=>{var f;(f=l.current)==null||f.lookAt(new $(...o))},[o]),u.hide?null:H.jsx("rectAreaLight",{ref:l,...u,...a},t)}function uR({_key:t,children:e,hide:n=!1,intensity:r=1,color:i="#ffffff",levaPrefix:s="Scene.",helper:o=!1,...a}){const l=v.useRef();let c=s?`${s}Hemisphere Light`:"Hemisphere Light";c=t?`${c}-[${t}]`:c;const u=vr(c,{useHelper:o,intensity:{value:r,step:.05},color:i,hide:n},[o,r,i,n]);return fh(u.useHelper?l:null,gH,1,"red"),u.hide?null:H.jsx("hemisphereLight",{ref:l,...u,...a},t)}function WE({_key:t,children:e,hide:n=!1,intensity:r=.5,color:i="#ffffff",levaPrefix:s="Scene.",helper:o=!1,...a}){const l=v.useRef();let c=s?`${s}Directional Light`:"Directional Light";c=t?`${c}-[${t}]`:c;const u=vr(c,{useHelper:o,intensity:{value:r,step:.05},color:i,hide:n},[o,r,i,n]);return fh(u.useHelper?l:null,yH,1,"red"),u.hide?null:H.jsx("directionalLight",{ref:l,...u,...a},t)}function fR({_key:t,children:e,hide:n=!1,intensity:r=.5,color:i="#ffffff",levaPrefix:s="Scene.",...o}){const a=v.useRef();let l=s?`${s}Ambient Light`:"Ambient Light";l=t?`${l}-[${t}]`:l;const c=vr(l,{intensity:{value:r,step:.05},color:i,hide:n},{collapsed:!0},[r,i,n]);return c.hide?null:H.jsx("ambientLight",{ref:a,...c,...o},t)}function gK({_key:t,children:e,hide:n=!1,intensity:r=.5,color:i="#ffffff",levaPrefix:s="Scene.",helper:o=!1,...a}){const l=v.useRef();fh(o?l:null,dH,1,"red");let c=s?`${s}Spot Light`:"Spot Light";c=t?`${c}-[${t}]`:c;const u=vr(c,{intensity:{value:r,step:.05},color:i,hide:n},[r,i,n]);return u.hide?null:H.jsx("spotLight",{ref:l,...u,...a},t)}function yK({_key:t,children:e,hide:n=!1,intensity:r=20,color:i="#ffffff",levaPrefix:s="Scene.",helper:o=!1,showSphere:a=!1,radius:l=.1,...c}){const u=v.useRef();fh(o?u:null,mH,1,"red");let f=s?`${s}Point Light`:"Point Light";f=t?`${f}-[${t}]`:f;const d=vr(f,{intensity:{value:r,step:.05},color:i,hide:n},[r,i,n]);return d.hide?null:H.jsxs("group",{children:[H.jsx("pointLight",{ref:u,...d,...c},t),a?H.jsx(SC,{args:[l,32,32],position:c.position,emissive:i,emissiveIntensity:r}):null]})}function vK({...t}){return H.jsxs(H.Fragment,{children:[H.jsx(WE,{castShadow:!0,intensity:1,position:[5,30,5],"shadow-mapSize":[1024,1024]}),H.jsx(fR,{intensity:.2,color:16777215})]})}function xK({}){return H.jsxs(H.Fragment,{children:[H.jsx(uR,{_key:"default-light-hemi",groundColor:"#000",intensity:1,position:[0,1,0]}),H.jsx(WE,{_key:"default-directional",color:"#fff",intensity:1,position:[4,10,1],castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-normalBias":.001})]})}const LRe="This is not an object",DRe="This is not a Float16Array object",XF="This constructor is not a subclass of Float16Array",_K="The constructor property value is not an object",NRe="Species constructor didn't return TypedArray object",ORe="Derived constructor created TypedArray object which was too small length",C1="Attempting to access detached ArrayBuffer",PM="Cannot convert undefined or null to object",kM="Cannot mix BigInt and other types, use explicit conversions",qF="@@iterator property is not callable",YF="Reduce of empty array with no initial value",FRe="The comparison function must be either a function or undefined",fA="Offset is out of bounds";function li(t){return(e,...n)=>Ho(t,e,n)}function s0(t,e){return li(Rm(t,e).get)}const{apply:Ho,construct:n1,defineProperty:URe,get:dA,getOwnPropertyDescriptor:Rm,getPrototypeOf:Xy,has:LM,ownKeys:bK,set:KF,setPrototypeOf:EK}=Reflect,BRe=Proxy,{EPSILON:zRe,MAX_SAFE_INTEGER:ZF,isFinite:wK,isNaN:Im}=Number,{iterator:lc,species:HRe,toStringTag:dR,for:GRe}=Symbol,Pm=Object,{create:$E,defineProperty:qy,freeze:jRe,is:QF}=Pm,DM=Pm.prototype,VRe=DM.__lookupGetter__?li(DM.__lookupGetter__):(t,e)=>{if(t==null)throw hi(PM);let n=Pm(t);do{const r=Rm(n,e);if(r!==void 0)return $c(r,"get")?r.get:void 0}while((n=Xy(n))!==null)},$c=Pm.hasOwn||li(DM.hasOwnProperty),SK=Array,TK=SK.isArray,XE=SK.prototype,WRe=li(XE.join),$Re=li(XE.push),XRe=li(XE.toLocaleString),hR=XE[lc],qRe=li(hR),{abs:YRe,trunc:AK}=Math,qE=ArrayBuffer,KRe=qE.isView,MK=qE.prototype,ZRe=li(MK.slice),QRe=s0(MK,"byteLength"),NM=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null,JRe=NM&&s0(NM.prototype,"byteLength"),pR=Xy(Uint8Array),e9e=pR.from,Is=pR.prototype,t9e=Is[lc],n9e=li(Is.keys),r9e=li(Is.values),i9e=li(Is.entries),s9e=li(Is.set),JF=li(Is.reverse),o9e=li(Is.fill),a9e=li(Is.copyWithin),eU=li(Is.sort),Fg=li(Is.slice),l9e=li(Is.subarray),xs=s0(Is,"buffer"),ud=s0(Is,"byteOffset"),Ir=s0(Is,"length"),CK=s0(Is,dR),c9e=Uint8Array,aa=Uint16Array,tU=(...t)=>Ho(e9e,aa,t),mR=Uint32Array,u9e=Float32Array,Kd=Xy([][lc]()),YE=li(Kd.next),f9e=li(function*(){}().next),d9e=Xy(Kd),hi=TypeError,hA=RangeError,RK=WeakSet,IK=RK.prototype,h9e=li(IK.add),p9e=li(IK.has),KE=WeakMap,gR=KE.prototype,tb=li(gR.get),m9e=li(gR.has),yR=li(gR.set),PK=new KE,g9e=$E(null,{next:{value:function(){const t=tb(PK,this);return YE(t)}},[lc]:{value:function(){return this}}});function Wx(t){if(t[lc]===hR&&Kd.next===YE)return t;const e=$E(g9e);return yR(PK,e,qRe(t)),e}const kK=new KE,LK=$E(d9e,{next:{value:function(){const t=tb(kK,this);return f9e(t)},writable:!0,configurable:!0}});for(const t of bK(Kd))t!=="next"&&qy(LK,t,Rm(Kd,t));function nU(t){const e=$E(LK);return yR(kK,e,t),e}function nb(t){return t!==null&&typeof t=="object"||typeof t=="function"}function rU(t){return t!==null&&typeof t=="object"}function rb(t){return CK(t)!==void 0}function OM(t){const e=CK(t);return e==="BigInt64Array"||e==="BigUint64Array"}function y9e(t){try{return TK(t)?!1:(QRe(t),!0)}catch{return!1}}function DK(t){if(NM===null)return!1;try{return JRe(t),!0}catch{return!1}}function v9e(t){return y9e(t)||DK(t)}function iU(t){return TK(t)?t[lc]===hR&&Kd.next===YE:!1}function x9e(t){return rb(t)?t[lc]===t9e&&Kd.next===YE:!1}function $x(t){if(typeof t!="string")return!1;const e=+t;return t!==e+""||!wK(e)?!1:e===AK(e)}const ib=GRe("__Float16Array__");function _9e(t){if(!rU(t))return!1;const e=Xy(t);if(!rU(e))return!1;const n=e.constructor;if(n===void 0)return!1;if(!nb(n))throw hi(_K);return LM(n,ib)}const FM=1/zRe;function b9e(t){return t+FM-FM}const NK=6103515625e-14,E9e=65504,OK=.0009765625,sU=OK*NK,w9e=OK*FM;function S9e(t){const e=+t;if(!wK(e)||e===0)return e;const n=e>0?1:-1,r=YRe(e);if(r<NK)return n*b9e(r/sU)*sU;const i=(1+w9e)*r,s=i-(i-r);return s>E9e||Im(s)?n*(1/0):n*s}const FK=new qE(4),UK=new u9e(FK),BK=new mR(FK),pl=new aa(512),ml=new c9e(512);for(let t=0;t<256;++t){const e=t-127;e<-24?(pl[t]=0,pl[t|256]=32768,ml[t]=24,ml[t|256]=24):e<-14?(pl[t]=1024>>-e-14,pl[t|256]=1024>>-e-14|32768,ml[t]=-e-1,ml[t|256]=-e-1):e<=15?(pl[t]=e+15<<10,pl[t|256]=e+15<<10|32768,ml[t]=13,ml[t|256]=13):e<128?(pl[t]=31744,pl[t|256]=64512,ml[t]=24,ml[t|256]=24):(pl[t]=31744,pl[t|256]=64512,ml[t]=13,ml[t|256]=13)}function Wl(t){UK[0]=S9e(t);const e=BK[0],n=e>>23&511;return pl[n]+((e&8388607)>>ml[n])}const vR=new mR(2048);for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;!(e&8388608);)e<<=1,n-=8388608;e&=-8388609,n+=947912704,vR[t]=e|n}for(let t=1024;t<2048;++t)vR[t]=939524096+(t-1024<<13);const o0=new mR(64);for(let t=1;t<31;++t)o0[t]=t<<23;o0[31]=1199570944;o0[32]=2147483648;for(let t=33;t<63;++t)o0[t]=2147483648+(t-32<<23);o0[63]=3347054592;const zK=new aa(64);for(let t=1;t<64;++t)t!==32&&(zK[t]=1024);function Vr(t){const e=t>>10;return BK[0]=vR[zK[e]+(t&1023)]+o0[e],UK[0]}function Lc(t){const e=+t;return Im(e)||e===0?0:AK(e)}function pA(t){const e=Lc(t);return e<0?0:e<ZF?e:ZF}function Xx(t,e){if(!nb(t))throw hi(LRe);const n=t.constructor;if(n===void 0)return e;if(!nb(n))throw hi(_K);return n[HRe]??e}function R1(t){if(DK(t))return!1;try{return ZRe(t,0,0),!1}catch{}return!0}function oU(t,e){const n=Im(t),r=Im(e);if(n&&r)return 0;if(n)return 1;if(r||t<e)return-1;if(t>e)return 1;if(t===0&&e===0){const i=QF(t,0),s=QF(e,0);if(!i&&s)return-1;if(i&&!s)return 1}return 0}const xR=2,sb=new KE;function nm(t){return m9e(sb,t)||!KRe(t)&&_9e(t)}function Rr(t){if(!nm(t))throw hi(DRe)}function qx(t,e){const n=nm(t),r=rb(t);if(!n&&!r)throw hi(NRe);if(typeof e=="number"){let i;if(n){const s=Jn(t);i=Ir(s)}else i=Ir(t);if(i<e)throw hi(ORe)}if(OM(t))throw hi(kM)}function Jn(t){const e=tb(sb,t);if(e!==void 0){const i=xs(e);if(R1(i))throw hi(C1);return e}const n=t.buffer;if(R1(n))throw hi(C1);const r=n1(di,[n,t.byteOffset,t.length],t.constructor);return tb(sb,r)}function aU(t){const e=Ir(t),n=[];for(let r=0;r<e;++r)n[r]=Vr(t[r]);return n}const HK=new RK;for(const t of bK(Is)){if(t===dR)continue;const e=Rm(Is,t);$c(e,"get")&&typeof e.get=="function"&&h9e(HK,e.get)}const T9e=jRe({get(t,e,n){return $x(e)&&$c(t,e)?Vr(dA(t,e)):p9e(HK,VRe(t,e))?dA(t,e):dA(t,e,n)},set(t,e,n,r){return $x(e)&&$c(t,e)?KF(t,e,Wl(n)):KF(t,e,n,r)},getOwnPropertyDescriptor(t,e){if($x(e)&&$c(t,e)){const n=Rm(t,e);return n.value=Vr(n.value),n}return Rm(t,e)},defineProperty(t,e,n){return $x(e)&&$c(t,e)&&$c(n,"value")&&(n.value=Wl(n.value)),URe(t,e,n)}});class di{constructor(e,n,r){let i;if(nm(e))i=n1(aa,[Jn(e)],new.target);else if(nb(e)&&!v9e(e)){let o,a;if(rb(e)){o=e,a=Ir(e);const l=xs(e);if(R1(l))throw hi(C1);if(OM(e))throw hi(kM);const c=new qE(a*xR);i=n1(aa,[c],new.target)}else{const l=e[lc];if(l!=null&&typeof l!="function")throw hi(qF);l!=null?iU(e)?(o=e,a=e.length):(o=[...e],a=o.length):(o=e,a=pA(o.length)),i=n1(aa,[a],new.target)}for(let l=0;l<a;++l)i[l]=Wl(o[l])}else i=n1(aa,arguments,new.target);const s=new BRe(i,T9e);return yR(sb,s,i),s}static from(e,...n){const r=this;if(!LM(r,ib))throw hi(XF);if(r===di){if(nm(e)&&n.length===0){const u=Jn(e),f=new aa(xs(u),ud(u),Ir(u));return new di(xs(Fg(f)))}if(n.length===0)return new di(xs(tU(e,Wl)));const l=n[0],c=n[1];return new di(xs(tU(e,function(u,...f){return Wl(Ho(l,this,[u,...Wx(f)]))},c)))}let i,s;const o=e[lc];if(o!=null&&typeof o!="function")throw hi(qF);if(o!=null)iU(e)?(i=e,s=e.length):x9e(e)?(i=e,s=Ir(e)):(i=[...e],s=i.length);else{if(e==null)throw hi(PM);i=Pm(e),s=pA(i.length)}const a=new r(s);if(n.length===0)for(let l=0;l<s;++l)a[l]=i[l];else{const l=n[0],c=n[1];for(let u=0;u<s;++u)a[u]=Ho(l,c,[i[u],u])}return a}static of(...e){const n=this;if(!LM(n,ib))throw hi(XF);const r=e.length;if(n===di){const s=new di(r),o=Jn(s);for(let a=0;a<r;++a)o[a]=Wl(e[a]);return s}const i=new n(r);for(let s=0;s<r;++s)i[s]=e[s];return i}keys(){Rr(this);const e=Jn(this);return n9e(e)}values(){Rr(this);const e=Jn(this);return nU(function*(){for(const n of r9e(e))yield Vr(n)}())}entries(){Rr(this);const e=Jn(this);return nU(function*(){for(const[n,r]of i9e(e))yield[n,Vr(r)]}())}at(e){Rr(this);const n=Jn(this),r=Ir(n),i=Lc(e),s=i>=0?i:r+i;if(!(s<0||s>=r))return Vr(n[s])}with(e,n){Rr(this);const r=Jn(this),i=Ir(r),s=Lc(e),o=s>=0?s:i+s,a=+n;if(o<0||o>=i)throw hA(fA);const l=new aa(xs(r),ud(r),Ir(r)),c=new di(xs(Fg(l))),u=Jn(c);return u[o]=Wl(a),c}map(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0],o=Xx(r,di);if(o===di){const l=new di(i),c=Jn(l);for(let u=0;u<i;++u){const f=Vr(r[u]);c[u]=Wl(Ho(e,s,[f,u,this]))}return l}const a=new o(i);qx(a,i);for(let l=0;l<i;++l){const c=Vr(r[l]);a[l]=Ho(e,s,[c,l,this])}return a}filter(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0],o=[];for(let c=0;c<i;++c){const u=Vr(r[c]);Ho(e,s,[u,c,this])&&$Re(o,u)}const a=Xx(r,di),l=new a(o);return qx(l),l}reduce(e,...n){Rr(this);const r=Jn(this),i=Ir(r);if(i===0&&n.length===0)throw hi(YF);let s,o;n.length===0?(s=Vr(r[0]),o=1):(s=n[0],o=0);for(let a=o;a<i;++a)s=e(s,Vr(r[a]),a,this);return s}reduceRight(e,...n){Rr(this);const r=Jn(this),i=Ir(r);if(i===0&&n.length===0)throw hi(YF);let s,o;n.length===0?(s=Vr(r[i-1]),o=i-2):(s=n[0],o=i-1);for(let a=o;a>=0;--a)s=e(s,Vr(r[a]),a,this);return s}forEach(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0];for(let o=0;o<i;++o)Ho(e,s,[Vr(r[o]),o,this])}find(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0];for(let o=0;o<i;++o){const a=Vr(r[o]);if(Ho(e,s,[a,o,this]))return a}}findIndex(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0];for(let o=0;o<i;++o){const a=Vr(r[o]);if(Ho(e,s,[a,o,this]))return o}return-1}findLast(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0];for(let o=i-1;o>=0;--o){const a=Vr(r[o]);if(Ho(e,s,[a,o,this]))return a}}findLastIndex(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0];for(let o=i-1;o>=0;--o){const a=Vr(r[o]);if(Ho(e,s,[a,o,this]))return o}return-1}every(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0];for(let o=0;o<i;++o)if(!Ho(e,s,[Vr(r[o]),o,this]))return!1;return!0}some(e,...n){Rr(this);const r=Jn(this),i=Ir(r),s=n[0];for(let o=0;o<i;++o)if(Ho(e,s,[Vr(r[o]),o,this]))return!0;return!1}set(e,...n){Rr(this);const r=Jn(this),i=Lc(n[0]);if(i<0)throw hA(fA);if(e==null)throw hi(PM);if(OM(e))throw hi(kM);if(nm(e))return s9e(Jn(this),Jn(e),i);if(rb(e)){const l=xs(e);if(R1(l))throw hi(C1)}const s=Ir(r),o=Pm(e),a=pA(o.length);if(i===1/0||a+i>s)throw hA(fA);for(let l=0;l<a;++l)r[l+i]=Wl(o[l])}reverse(){Rr(this);const e=Jn(this);return JF(e),this}toReversed(){Rr(this);const e=Jn(this),n=new aa(xs(e),ud(e),Ir(e)),r=new di(xs(Fg(n))),i=Jn(r);return JF(i),r}fill(e,...n){Rr(this);const r=Jn(this);return o9e(r,Wl(e),...Wx(n)),this}copyWithin(e,n,...r){Rr(this);const i=Jn(this);return a9e(i,e,n,...Wx(r)),this}sort(e){Rr(this);const n=Jn(this),r=e!==void 0?e:oU;return eU(n,(i,s)=>r(Vr(i),Vr(s))),this}toSorted(e){Rr(this);const n=Jn(this);if(e!==void 0&&typeof e!="function")throw new hi(FRe);const r=e!==void 0?e:oU,i=new aa(xs(n),ud(n),Ir(n)),s=new di(xs(Fg(i))),o=Jn(s);return eU(o,(a,l)=>r(Vr(a),Vr(l))),s}slice(e,n){Rr(this);const r=Jn(this),i=Xx(r,di);if(i===di){const p=new aa(xs(r),ud(r),Ir(r));return new di(xs(Fg(p,e,n)))}const s=Ir(r),o=Lc(e),a=n===void 0?s:Lc(n);let l;o===-1/0?l=0:o<0?l=s+o>0?s+o:0:l=s<o?s:o;let c;a===-1/0?c=0:a<0?c=s+a>0?s+a:0:c=s<a?s:a;const u=c-l>0?c-l:0,f=new i(u);if(qx(f,u),u===0)return f;const d=xs(r);if(R1(d))throw hi(C1);let h=0;for(;l<c;)f[h]=Vr(r[l]),++l,++h;return f}subarray(e,n){Rr(this);const r=Jn(this),i=Xx(r,di),s=new aa(xs(r),ud(r),Ir(r)),o=l9e(s,e,n),a=new i(xs(o),ud(o),Ir(o));return qx(a),a}indexOf(e,...n){Rr(this);const r=Jn(this),i=Ir(r);let s=Lc(n[0]);if(s===1/0)return-1;s<0&&(s+=i,s<0&&(s=0));for(let o=s;o<i;++o)if($c(r,o)&&Vr(r[o])===e)return o;return-1}lastIndexOf(e,...n){Rr(this);const r=Jn(this),i=Ir(r);let s=n.length>=1?Lc(n[0]):i-1;if(s===-1/0)return-1;s>=0?s=s<i-1?s:i-1:s+=i;for(let o=s;o>=0;--o)if($c(r,o)&&Vr(r[o])===e)return o;return-1}includes(e,...n){Rr(this);const r=Jn(this),i=Ir(r);let s=Lc(n[0]);if(s===1/0)return!1;s<0&&(s+=i,s<0&&(s=0));const o=Im(e);for(let a=s;a<i;++a){const l=Vr(r[a]);if(o&&Im(l)||l===e)return!0}return!1}join(e){Rr(this);const n=Jn(this),r=aU(n);return WRe(r,e)}toLocaleString(...e){Rr(this);const n=Jn(this),r=aU(n);return XRe(r,...Wx(e))}get[dR](){if(nm(this))return"Float16Array"}}qy(di,"BYTES_PER_ELEMENT",{value:xR});qy(di,ib,{});EK(di,pR);const ob=di.prototype;qy(ob,"BYTES_PER_ELEMENT",{value:xR});qy(ob,lc,{value:ob.values,writable:!0,configurable:!0});EK(ob,Is);function UM(t){const e=new di(t.buffer.slice(t.byteOffset),0,t.length/2),n=[];return e.forEach(r=>n.push(r)),new Float32Array(n)}function GK({_ref:t,_key:e,position:n=[0,0,0],rotation:r=[0,0,0],vertices:i,matrix:s,colors:o,size:a=.01,color:l,...c}){const u=v.useRef(null),f=t||u,d=v.useMemo(()=>({now:Date.now(),vertices:UM(i),colors:o&&Float32Array.from(o,h=>h/255)}),[i,o]);return v.useLayoutEffect(()=>{const h=f.current;h&&s&&(h.matrix.fromArray(s),h.matrix.decompose(h.position,h.quaternion,h.scale),h.rotation.setFromQuaternion(h.quaternion))},[s,f.current]),H.jsxs("points",{ref:t,position:n,rotation:r,castShadow:!0,receiveShadow:!0,...c,children:[H.jsxs("bufferGeometry",{children:[H.jsx("bufferAttribute",{attach:"attributes-position",array:d.vertices,count:d.vertices.length/3,itemSize:3}),d.colors&&H.jsx("bufferAttribute",{attach:"attributes-color",array:d.colors,count:d.colors.length/3,itemSize:3})]}),H.jsx("pointsMaterial",{attach:"material",vertexColors:o!==void 0,color:l,size:a})]},e+d.now)}var jK=(t=>(t[t.front=0]="front",t[t.back=1]="back",t[t.double=2]="double",t))(jK||{});function VK({position:t=[0,0,0],rotation:e=[0,0,0],vertices:n,faces:r,colors:i,color:s,uv:o,materialType:a="standard",wireframe:l,opacity:c,side:u="double",material:f,...d}){var h;const p=v.useMemo(()=>{const A=Uint8Array.BYTES_PER_ELEMENT/Float32Array.BYTES_PER_ELEMENT;return{vertices:UM(n),faces:new Uint32Array(r.buffer.slice(r.byteOffset),0,A*r.byteLength),colors:i&&Float32Array.from(i,R=>R/255),uv:o&&UM(o)}},[n,r,i,o]),[m,g]=v.useState({}),[y,x]=v.useState({}),_=v.useMemo(()=>new ns,[]),w=v.useRef(),T=v.useRef(!1),S=f?Object.values(f):[];if(v.useLayoutEffect(()=>{for(const A in f){const R=f[A],M=A.endsWith("map")||A.endsWith("Map");typeof R=="string"&&M?_&&_.load(R,D=>{const k=f[`${A}Repeat`];k&&(D.wrapS=D.wrapT=Or,D.repeat.set(...k)),x(L=>({...L,[A]:D})),T.current=!0}):(g(D=>({...D,[A]:R})),T.current=!0)}},S),T.current){T.current=!1;const A=(h=w==null?void 0:w.current)==null?void 0:h.material;A&&(A.needsUpdate=!0)}v.useLayoutEffect(()=>{var A;const R=(A=w==null?void 0:w.current)==null?void 0:A.geometry;!R||!p.uv||(R.attributes.uv=new fn(p.uv,2))},[p.uv]);const C=`mesh${a.charAt(0).toUpperCase()}${a.slice(1)}Material`;return H.jsxs("mesh",{ref:w,position:t,rotation:e,castShadow:!0,receiveShadow:!0,...d,children:[H.jsxs("bufferGeometry",{onUpdate:A=>A.computeVertexNormals(),children:[H.jsx("bufferAttribute",{attach:"attributes-position",array:p.vertices,count:p.vertices.length/3,itemSize:3}),p.colors&&H.jsx("bufferAttribute",{attach:"attributes-color",array:p.colors,count:p.colors.length/3,itemSize:3}),H.jsx("bufferAttribute",{attach:"index",array:p.faces,count:p.faces.length,itemSize:1})]}),H.jsx(C,{attach:"material",wireframe:l,vertexColors:!!i,color:s,transparent:!0,alphaTest:1,opacity:c,side:jK[u],...m,...y})]})}function WK({src:t}){const{scene:e}=At(),n=v.useMemo(()=>new ns,[]),[r,i]=v.useState(),s=typeof t=="string"&&(t==null?void 0:t.length)===0,{backgroundIntensity:o,backgroundBlurriness:a}=vr("Scene Background Image",{backgroundIntensity:-.5,backgroundBlurriness:0});return v.useEffect(()=>{if(!t||s)return i(void 0);if(typeof t=="string")n.load(t,i);else{const l=new Blob([t],{type:"image"}),c=new tr;createImageBitmap(l,{imageOrientation:"flipY"}).then(u=>{c.image=u,c.needsUpdate=!0,c.colorSpace=ss,i(c)})}},[t]),v.useEffect(()=>{e.backgroundIntensity=o,e.backgroundBlurriness=a},[o,a]),v.useEffect(()=>{r&&(e.background=r)},[r,r==null?void 0:r.needsUpdate]),null}function I1({matRef:t,rgb:e,alpha:n,depth:r,depthScale:i=1,depthBias:s=0,distanceToCamera:o=10,aspect:a,height:l,position:c,rotation:u,quaternion:f,matrix:d,opacity:h=1,fixed:p=!1,side:m=2,layers:g=null,wireframe:y=!1,material:x={}}){var _;const w=v.useRef(null),{camera:T}=At(),{mode:S}=nr();v.useEffect(()=>{!w.current||!S||typeof g=="number"&&S&&w.current.layers.set(g)},[g,w.current,S]),v.useLayoutEffect(()=>{if(!w.current||!p)return;const R=w.current;d?(R.matrix.fromArray(d),R.matrix.decompose(R.position,R.quaternion,R.scale),R.rotation.setFromQuaternion(R.quaternion)):(f?R.quaternion.fromArray(f):u&&R.rotation.set(...u),c&&R.position.set(...c))},[d,f,u,c,p]),Yt(()=>{const R=w.current;let M,D,k;if(typeof l=="number"&&typeof a=="number")R.scale.set(l*a,l,1);else if(T.type==="PerspectiveCamera"){const K=T;typeof l=="number"?M=l:M=2*Math.tan(K.fov/360*Math.PI)*o,typeof a=="number"?k=a:k=K.aspect,D=k*M,R.scale.set(D,M,1)}else if(T.type==="OrthographicCamera"){const K=T;M=(K.top-K.bottom)/T.zoom,D=(K.right-K.left)/T.zoom,R.scale.set(D,M,1)}else console.warn("Unsupported camera type",T.type);if(p)return;if(d){R.matrix.fromArray(d),R.matrix.premultiply(T.matrixWorld),R.matrix.decompose(R.position,R.quaternion,R.scale),R.rotation.setFromQuaternion(R.quaternion);return}T.matrixWorld.decompose(R.position,T.quaternion,[]),f?(R.quaternion.fromArray(f),R.quaternion.premultiply(T.quaternion)):u?(R.quaternion.setFromEuler(new xr().fromArray(u)),R.quaternion.premultiply(T.quaternion)):R.quaternion.copy(T.quaternion);const[L,N,z]=c||[0,0,0],O=new $(L,N,z-o).applyQuaternion(T.quaternion);R.position.add(O)});const C=v.useMemo(()=>r!=null&&r.image?{"displacementMap-colorSpace":ss,...x}:x,[r,x]),A=(_=e||r)==null?void 0:_.image;return r!=null&&r.image?H.jsxs("mesh",{ref:w,scale:[1,1,1],children:[H.jsx("planeGeometry",{args:[1,1,A==null?void 0:A.width,A==null?void 0:A.height]}),H.jsx("meshStandardMaterial",{attach:"material",ref:t,map:e,alphaMap:n,displacementMap:r,displacementScale:-i,displacementBias:s,wireframe:y,transparent:!!n||typeof h=="number",opacity:h,side:m,...C})]}):H.jsxs("mesh",{ref:w,scale:[1,1,1],children:[H.jsx("planeGeometry",{args:[1,1,A==null?void 0:A.width,A==null?void 0:A.height]}),H.jsx("meshBasicMaterial",{attach:"material",ref:t,map:e,alphaMap:n,displacementScale:-i,displacementBias:s,wireframe:y,transparent:!!n||typeof h=="number",opacity:h,side:m,...x})]})}function ay(t,{start:e=!1,repeat:n,offset:r}={}){const i=At(a=>a.gl),s=v.useMemo(()=>{if(!t)return null;const a=new E6(t);return"colorSpace"in a?a.colorSpace=i.outputColorSpace:a.encoding=i.outputEncoding,a},[t]),{mode:o}=nr();return Yt(()=>{s&&o&&!s.image.paused&&(s.needsUpdate=!0)}),v.useEffect(()=>{s&&(n&&(s.repeat=new Ke(...n)),r&&(s.offset=new Ke(...r)))},[n,r]),v.useEffect(()=>{if(s&&e)return s.image.play(),()=>s.image.pause()},[s,e,o]),s}function A9e(t,e){return t.addTransceiver("video",{direction:"recvonly"}),t.addTransceiver("audio",{direction:"recvonly"}),t.createOffer().then(n=>t.setLocalDescription(n)).then(()=>new Promise(n=>{if(t.iceGatheringState==="complete")n();else{const r=()=>{t.iceGatheringState==="complete"&&(t.removeEventListener("icegatheringstatechange",r),n())};t.addEventListener("icegatheringstatechange",r)}})).then(()=>{const n=t.localDescription;return fetch(e,{body:JSON.stringify({sdp:n.sdp,type:n.type}),headers:{"Content-Type":"application/json"},method:"POST"})}).then(n=>n.json()).then(n=>t.setRemoteDescription(n)).catch(n=>{alert(n)})}const M9e={urls:"stun:stun.l.google.com:19302"};function $K(t,{iceServer:e=M9e,iceServers:n=[],...r}){const[i,s]=v.useState(null);return v.useEffect(()=>{const o=e?[e,...n]:n,a=new RTCPeerConnection({iceServers:o,...r});return a.addEventListener("track",l=>{l.track.kind=="video"&&s(l.streams[0])}),A9e(a,t),()=>a.close()},[t]),i}const C9e=t=>typeof t=="object"&&typeof t.then=="function",Yx=[];function R9e(t,e,n=(r,i)=>r===i){if(t===e)return!0;if(!t||!e)return!1;const r=t.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!n(t[i],e[i]))return!1;return!0}function I9e(t,e=null,n=!1,r={}){e===null&&(e=[t]);for(const s of Yx)if(R9e(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!n)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=Yx.indexOf(i);s!==-1&&Yx.splice(s,1)},promise:(C9e(t)?t:t(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(Yx.push(i),!n)throw i.promise}const P9e=(t,e,n)=>I9e(t,e,!1,n);function _R(t,{unsuspend:e="loadedmetadata",crossOrigin:n="Anonymous",muted:r=!0,loop:i=!0,start:s=!0,playsInline:o=!0,...a}={}){const l=P9e(()=>new Promise((u,f)=>{if(!t)return u(null);const d=Object.assign(document.createElement("video"),{src:typeof t=="string"&&t||void 0,srcObject:t instanceof MediaStream&&t||void 0,autoplay:s,crossOrigin:n,loop:i,muted:r,playsInline:o,...a});d.addEventListener(e,()=>u(d)),d.addEventListener("error",()=>f(null))}),[t]),{mode:c}=nr();return v.useEffect(()=>{if(l&&s)return l.play(),()=>l.pause()},[l,s,c]),l}function ZE({src:t,start:e,textureRepeat:n,textureOffset:r,...i}){const s=_R(t),o=ay(s,{start:e});return v.useEffect(()=>{n&&(o.repeat=new Ke(...n)),r&&(o.offset=new Ke(...r))},[n,r]),o?H.jsx("meshBasicMaterial",{map:o,toneMapped:!1,...i}):null}function bR({src:t,iceServer:e={urls:"stun:stun.l.google.com:19302"},webRTCOptions:n,...r}){const i=$K(t,{iceServer:e,...n});if(!(!t||!i))return H.jsx(ZE,{src:i,...r})}function Ef({distanceToCamera:t=10,aspect:e,height:n,position:r,rotation:i,quaternion:s,matrix:o,fixed:a=!1,layers:l=null,children:c}){const u=v.useRef(null),{camera:f}=At(),{mode:d}=nr();return v.useEffect(()=>{u.current&&typeof l=="number"&&d&&u.current.layers.set(l)},[l,u.current,d]),v.useLayoutEffect(()=>{if(!u.current||!a)return;const h=u.current;o?(h.matrix.fromArray(o),h.matrix.decompose(h.position,h.quaternion,h.scale),h.rotation.setFromQuaternion(h.quaternion)):(s?h.quaternion.fromArray(s):i&&h.rotation.set(...i),r&&h.position.set(...r))},[o,s,i,r,a]),Yt(()=>{const h=u.current;let p,m,g;if(typeof n=="number"&&typeof e=="number")h.scale.set(n*e,n,1);else if(f.type==="PerspectiveCamera"){const T=f;typeof n=="number"?p=n:p=2*Math.tan(T.fov/360*Math.PI)*t,typeof e=="number"?g=e:g=T.aspect,m=g*p,h.scale.set(m,p,1)}else if(f.type==="OrthographicCamera"){const T=f;p=(T.top-T.bottom)/f.zoom,m=(T.right-T.left)/f.zoom,h.scale.set(m,p,1)}else console.warn("Unsupported camera type",f.type);if(a)return;if(o){h.matrix.fromArray(o),h.matrix.premultiply(f.matrixWorld),h.matrix.decompose(h.position,h.quaternion,h.scale),h.rotation.setFromQuaternion(h.quaternion);return}f.matrixWorld.decompose(h.position,f.quaternion,[]),s?(h.quaternion.fromArray(s),h.quaternion.premultiply(f.quaternion)):i?(h.quaternion.setFromEuler(new xr().fromArray(i)),h.quaternion.premultiply(f.quaternion)):h.quaternion.copy(f.quaternion);const[y,x,_]=r||[0,0,0],w=new $(y,x,_-t).applyQuaternion(f.quaternion);h.position.add(w)}),H.jsxs("mesh",{ref:u,scale:[1,1,1],children:[H.jsx("planeGeometry",{args:[1,1]}),c]})}function XK({src:t,start:e=!0,...n}){return H.jsx(Ef,{...n,children:H.jsx(ZE,{src:t,start:e,...n})})}function qK({src:t,start:e=!0,iceServer:n,webRTCOptions:r,...i}){return H.jsx(Ef,{...i,children:H.jsx(bR,{src:t,start:e,iceServer:n,webRTCOptions:r})})}const YK=({src:t,iceServer:e={urls:"stun:stun.l.google.com:19302"},side:n=2,rtcOptions:r,crossOrigin:i="Anonymous",muted:s=!0,loop:o=!0,start:a=!0,playsInline:l=!0,...c})=>{const u=$K(t,{iceServer:e,...r}),f=_R(u,{crossOrigin:i,muted:s,loop:o,start:a,playsInline:l}),d=ay(f,{repeat:[.5,1],offset:[0,0]}),h=ay(f,{repeat:[.5,1],offset:[.5,0]});return H.jsxs(H.Fragment,{children:[H.jsx(Ef,{layers:1,...c,children:d&&H.jsx("meshBasicMaterial",{map:d,toneMapped:!1,side:2,...c})}),H.jsx(Ef,{layers:2,...c,children:h&&H.jsx("meshBasicMaterial",{map:h,toneMapped:!1,side:2,...c})})]})},KK=({src:t,side:e=2,crossOrigin:n="Anonymous",muted:r=!0,loop:i=!0,start:s=!0,playsInline:o=!0,...a})=>{const l=_R(t,{crossOrigin:n,muted:r,loop:i,start:s,playsInline:o}),c=ay(l,{repeat:[.5,1],offset:[0,0]}),u=ay(l,{repeat:[.5,1],offset:[.5,0]});return H.jsxs(H.Fragment,{children:[H.jsx(Ef,{layers:1,...a,children:c&&H.jsx("meshBasicMaterial",{map:c,toneMapped:!1,side:2,...a})}),H.jsx(Ef,{layers:2,...a,children:u&&H.jsx("meshBasicMaterial",{map:u,toneMapped:!1,side:2,...a})})]})};function lU({matRef:t,rgb:e,alpha:n,depth:r,depthScale:i=1,depthBias:s=0,distanceToCamera:o=1,opacity:a=1,fixed:l=!1,layers:c=null,side:u=2,wireframe:f=!1,material:d={}}){const h=v.useRef(null),{camera:p}=At(),{mode:m}=nr();v.useEffect(()=>{h.current&&typeof c=="number"&&m&&h.current.layers.set(c)},[c,h.current,m]);const g=v.useMemo(()=>{var x;if(p.type!=="PerspectiveCamera"){console.warn("ImageSphere only works with perspective camera");return}const _=p,w=_.fov/360*Math.PI,T=Math.atan(Math.tan(w)*_.aspect),S=(x=e||r)==null?void 0:x.image;return[o,S==null?void 0:S.width,S==null?void 0:S.height,-.5*Math.PI-T,2*T,.5*Math.PI-w,2*w]},[p.fov,p.aspect]);Yt(()=>{if(!h.current||l)return;const x=h.current;p.matrixWorld.decompose(x.position,p.quaternion,[]),x.quaternion.copy(p.quaternion)});const y=v.useMemo(()=>r!=null&&r.image?{"displacementMap-colorSpace":ss,...d}:d,[r,d]);return r!=null&&r.image?H.jsxs("mesh",{ref:h,scale:[1,1,1],children:[H.jsx("sphereGeometry",{args:g}),H.jsx("meshStandardMaterial",{ref:t,attach:"material",map:e,alphaMap:n,displacementMap:r,displacementScale:i,displacementBias:s,wireframe:f,transparent:!!n||typeof a=="number",opacity:a,side:u,...y})]}):H.jsxs("mesh",{ref:h,scale:[1,1,1],children:[H.jsx("sphereGeometry",{args:g}),H.jsx("meshBasicMaterial",{ref:t,attach:"material",map:e,alphaMap:n,displacementScale:i,displacementBias:s,wireframe:f,transparent:!!n||typeof a=="number",opacity:a,side:u,...d})]})}function mA(t,e){t&&(e?(t.minFilter=Pn,t.magFilter=Pn):(t.minFilter=zn,t.magFilter=zn))}function ER({_key:t,geometry:e,src:n,alphaSrc:r,depthSrc:i,interpolate:s=!1,depthScale:o=1,depthBias:a=0,fixed:l=!1,levaPrefix:c="Scene.",...u}){const f=v.useRef(null),{camera:d}=At(),[h,p]=v.useState(),[m,g]=v.useState(),[y,x]=v.useState(),_=v.useMemo(()=>new ns,[]),w=v.useMemo(()=>y&&d.type==="PerspectiveCamera"?{}:{imageOrientation:"flipY"},[d.type,y]);v.useEffect(()=>{if(!n)p(void 0);else if(typeof n=="string")_.load(n,p);else{const C=new Blob([n],{type:"image"}),A=new tr;createImageBitmap(C,w).then(R=>{A.image=R,A.needsUpdate=!0,f.current&&(f.current.needsUpdate=!0),p(A)})}},[n,w]),v.useEffect(()=>{if(!r)g(void 0);else if(typeof r=="string")_.load(r,g);else{const C=new Blob([r],{type:"image"}),A=new tr;createImageBitmap(C,w).then(R=>{A.image=R,A.needsUpdate=!0,f.current&&(f.current.needsUpdate=!0),g(A)})}},[r,w]),v.useEffect(()=>{if(!i)x(void 0);else if(typeof i=="string")_.load(i,x);else{const C=new Blob([i],{type:"image"}),A=new tr;createImageBitmap(C,w).then(R=>{A.image=R,A.needsUpdate=!0,f.current&&(f.current.needsUpdate=!0),x(A)})}},[i,w]),v.useEffect(()=>{h&&mA(h,s),m&&mA(m,s),y&&mA(y,s)},[h,m,y,s]);let T=c?`${c}Image Background`:"Image Background";T=t?`${T}-[${t}]`:T;const S=vr(T,{fixed:l,depthScale:{value:o,step:.01,label:"Depth Scale"},depthBias:{value:a,step:.01,label:"Depth Offset"}},[l,o,a]);if(e==="plane")return H.jsx(I1,{matRef:f,rgb:h,alpha:m,depth:y,...S,...u});if(e==="sphere")return H.jsx(lU,{matRef:f,rgb:h,alpha:m,...S,depth:y,...u});if(y){if(d.type==="OrthographicCamera")return H.jsx(I1,{matRef:f,rgb:h,alpha:m,depth:y,...S,...u});if(d.type==="PerspectiveCamera")return H.jsx(lU,{matRef:f,rgb:h,alpha:m,...S,depth:y,...u})}else return H.jsx(I1,{matRef:f,rgb:h,alpha:m,...S,...u});return null}const cU=[{position:new $(1,0,0),rotation:new xr(0,0,-.5*Math.PI),color:new wt(16711680)},{position:new $(0,1,0),rotation:new xr(0,0,0),color:new wt(65280)},{position:new $(0,0,1),rotation:new xr(.5*Math.PI,0,0),color:new wt(255)}];function ZK({matrix:t,position:e,rotation:n,direction:r=[1,0,0],scale:i=1,headScale:s=1,lod:o=10,color:a="red",opacity:l=1,wireframe:c=!1}){const u=v.useRef(null),f=v.useRef(null),d=v.useRef(null),h=v.useMemo(()=>new wt(a),[a]),p=v.useMemo(()=>new yn,[]),m=v.useMemo(()=>new $(...r),[r]),g=v.useMemo(()=>new bn().setFromUnitVectors(new $(0,1,0),m.clone().normalize()),[m]);v.useLayoutEffect(()=>{const _=f.current;_&&(p.position.set(r[0],r[1],r[2]),p.rotation.setFromQuaternion(g),p.updateMatrix(),_.setMatrixAt(0,p.matrix));const w=d.current;w&&(p.position.set(r[0],r[1],r[2]).multiplyScalar(.5),p.rotation.setFromQuaternion(g),p.updateMatrix(),w.setMatrixAt(0,p.matrix))},[]),v.useLayoutEffect(()=>{var _,w;(_=f.current)==null||_.setColorAt(0,h),(w=d.current)==null||w.setColorAt(0,h)},[h]);const y={};(l==0||l<1)&&(y.transparent=!0,y.opacity=l);const x=c?H.jsx("meshStandardMaterial",{wireframe:!0,...y}):H.jsx("meshBasicMaterial",{...y});return H.jsxs(ph,{ref:u,position:e,rotation:n,scale:i,matrix:t,children:[H.jsxs("instancedMesh",{ref:f,args:[null,null,1],children:[H.jsx("coneGeometry",{args:[.05*s,.1*s,o,o]}),x]}),H.jsxs("instancedMesh",{ref:d,args:[null,null,1],children:[H.jsx("cylinderGeometry",{args:[.025,.025,m.length(),o,o]}),x]})]})}function QK({matrix:t,position:e,rotation:n,scale:r=1,headScale:i=1,lod:s=10,color:o,opacity:a=1,wireframe:l=!1}){const c=v.useRef(null),u=v.useRef(null),f=v.useRef(null),d=v.useMemo(()=>o&&new wt(o),[o]),h=v.useMemo(()=>new yn,[]);v.useLayoutEffect(()=>{const g=u.current;g&&cU.forEach(({position:y,rotation:x,color:_},w)=>{h.position.set(y.x,y.y,y.z),h.rotation.set(x.x,x.y,x.z),h.updateMatrix(),g.setMatrixAt(w,h.matrix),g.setColorAt(w,d||_)})},[]),v.useLayoutEffect(()=>{const g=f.current;g&&cU.forEach(({position:y,rotation:x,color:_},w)=>{h.position.set(y.x/2,y.y/2,y.z/2),h.rotation.set(x.x,x.y,x.z),h.updateMatrix(),g.setMatrixAt(w,h.matrix),g.setColorAt(w,d||_)})},[]);const p={};(a==0||a<1)&&(p.transparent=!0,p.opacity=a),o&&(p.color=d);const m=l?H.jsx("meshStandardMaterial",{wireframe:!0,...p}):H.jsx("meshBasicMaterial",{...p});return H.jsxs(ph,{ref:c,_ref:c,position:e,rotation:n,scale:r,matrix:t,children:[H.jsxs("instancedMesh",{ref:u,args:[null,null,3],children:[H.jsx("coneGeometry",{args:[.05*i,.1*i,s,s]}),m]}),H.jsxs("instancedMesh",{ref:f,args:[null,null,3],children:[H.jsx("cylinderGeometry",{args:[.025,.025,1,s,s]}),m]})]})}const JK=({_key:t="DEFAULT"})=>{const e=window.devicePixelRatio||1,{sendMsg:n,downlink:r,uplink:i}=Mr(),{gl:s}=At(),o=v.useMemo(()=>({lastFrame:Date.now()}),[]),a=v.useMemo(()=>new OffscreenCanvas(1,1),[]);return v.useEffect(()=>r?r.subscribe("GRAB_RENDER",({key:l,rtype:c,data:{downsample:u=1,quality:f=1}})=>{if(l!==t||!s.domElement)return;const{width:d,height:h}=s.domElement,p=Date.now(),m=p-o.lastFrame;o.lastFrame=p;const g=a.getContext("2d");a.width=d/u,a.height=h/u;const y=s.domElement;g.drawImage(y,0,0,y.width,y.height,0,0,a.width,a.height),a.convertToBlob({type:"image/jpeg",quality:f}).then(x=>x.arrayBuffer()).then(x=>{const _={ts:Date.now(),etype:c||"GRAB_RENDER_RESPONSE",key:l,value:{dpr:e,delta:m,width:d,height:h,frame:new Uint8Array(x)}};n(_)})}):void 0,[s.domElement,n,r,i,o]),null};function eZ({_key:t,far:e,levaPrefix:n="Scene.",hide:r}){var i;const s=v.useMemo(()=>gu.parse(eu.location.search),[]),{camera:o}=At(),a=((i=s.grid)==null?void 0:i.toLowerCase())!=="false";let l=n?`${n}Grid Plane`:"Grid Plane";l=t?`${l}-[${t}]`:l;const{showGrid:c,offset:u,fadeDistance:f,...d}=vr(l,{showGrid:{value:typeof r>"u"?a:r,label:"Show Grid"},offset:0,cellSize:.2,cellThickness:.6,cellColor:"#6f6f6f",sectionSize:1,sectionThickness:1.5,sectionColor:"#23aaff",fadeDistance:e||10,fadeStrength:1,followCamera:!0,infiniteGrid:!0},{collapsed:!0},[e,o.far]),{rot:h,pos:p}=v.useMemo(()=>{const m=new $(0,1,0),g=new bn;g.setFromUnitVectors(m,yn.DEFAULT_UP);const y=new xr;y.setFromQuaternion(g,"XYZ");const x=yn.DEFAULT_UP.clone().multiplyScalar(u);return{rot:y,pos:x}},[yn.DEFAULT_UP,u]);return c?H.jsx(ppe,{position:p,rotation:h,args:[10,10],fadeDistance:Math.min(o.far||5,f),...d}):H.jsx(H.Fragment,{})}function tZ(t,e){const n={};return t.forEach(r=>{const{label:i,color:s,threshold:o,hide:a,...l}=r;s?(n[`${i}`]=Yp({[`${i}_color`]:{value:s,label:"color"}},{collapsed:!e,color:s}),n[`${i}_show`]={value:!a,label:"show"}):n[`${i}_show`]={value:!a,label:i}}),n}function nZ({_ref:t,color:e,pinchWidth:n=.04,skeleton:r=!1,axes:i=!1,showOrigin:s=!0,hide:o,...a}){const l=v.useRef(),c=t||l;return o?null:r?H.jsx(G8,{_ref:t,color:e,pinchWidth:n,...a}):H.jsxs(ph,{_ref:c,...a,children:[i&&H.jsx("axesHelper",{args:[.1]}),H.jsxs("mesh",{position:[0,.07,0],rotation:[0,0,Math.PI/2],scale:[1,1,1],children:[H.jsx("cylinderGeometry",{attach:"geometry",args:[.015,.015,.12,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#cecece"})]}),H.jsxs("mesh",{position:[-n-.005,0,0],scale:1,children:[H.jsx("boxGeometry",{attach:"geometry",args:[.01,.02,.025,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#23aaff"})]}),H.jsxs("mesh",{position:[-n-.005,.0275+.01,0],scale:1,children:[H.jsx("boxGeometry",{attach:"geometry",args:[.01,.055,.025,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#8ed6ff"})]}),H.jsxs("mesh",{position:[n+.005,0,0],scale:1,children:[H.jsx("boxGeometry",{attach:"geometry",args:[.01,.02,.025,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#ff5656"})]}),H.jsxs("mesh",{position:[n+.005,.0275+.01,0],scale:1,children:[H.jsx("boxGeometry",{attach:"geometry",args:[.01,.055,.025,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#ff9595"})]}),H.jsxs("mesh",{position:[0,.075+.025,0],rotation:[0,0,0],scale:[1,1,1],children:[H.jsx("cylinderGeometry",{attach:"geometry",args:[.0125,.0125,.05,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:e||"#5b5b5b"})]}),s?H.jsxs("mesh",{position:[0,0,0],rotation:[0,0,0],children:[H.jsx("sphereGeometry",{attach:"geometry",args:[.0075,32,32]}),H.jsx("meshBasicMaterial",{attach:"material",color:"green"})]}):null]})}function rZ({_ref:t,matrix:e,flipCoords:n=!0,rotation:r,position:i,scale:s,...o}){return H.jsx(ph,{_ref:t,rotation:r,position:i,scale:s,matrix:e,children:n?H.jsx(Lk,{rotation:[Math.PI,0,0],...o}):H.jsx(Lk,{...o})})}const k9e="_playhead_at0ov_1";function wR({seeking:t,leftPos:e}){return H.jsx("div",{"data-seeking":t,className:k9e,style:{left:`calc(50% + ${e}px)`}})}const L9e="_tsStyle_skfcc_1";function D9e({start:t,end:e,firstVisibleFrame:n,lastVisibleFrame:r,segmentDensity:i=1}){const s=v.useMemo(()=>{const o=[],a=Math.max(1,i),l=Math.floor((n-t)/a)*a+t;for(let c=l;c<r;c+=a){const u=Math.max(e-t,1),f=i>0&&(c-t)/i%2!==0;o.push(H.jsx("div",{"data-label":f?"":c,"data-left":(c-t)/u*100,className:L9e,style:{left:(c-t)/u*100+"%",opacity:f?.5:1}},c))}return o},[n,r,i]);return H.jsx(H.Fragment,{children:s})}const yu="_svg_ohgsw_1";function N9e(){return H.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4L224 214.3V256v41.7L52.5 440.6zM256 352V256 128 96c0-12.4 7.2-23.7 18.4-29s24.5-3.6 34.1 4.4l192 160c7.3 6.1 11.5 15.1 11.5 24.6s-4.2 18.5-11.5 24.6l-192 160c-9.5 7.9-22.8 9.7-34.1 4.4s-18.4-16.6-18.4-29V352z"})})}function O9e(){return H.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M459.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4L288 214.3V256v41.7L459.5 440.6zM256 352V256 128 96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160C4.2 237.5 0 246.5 0 256s4.2 18.5 11.5 24.6l192 160c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V352z"})})}function F9e(){return H.jsx("svg",{viewBox:"0 0 320 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"})})}function U9e(){return H.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M149.1 64.8L138.7 96H64C28.7 96 0 124.7 0 160V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H373.3L362.9 64.8C356.4 45.2 338.1 32 317.4 32H194.6c-20.7 0-39 13.2-45.5 32.8zM256 192a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"})})}function B9e(){return H.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"})})}function z9e(){return H.jsx("svg",{viewBox:"0 0 320 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4l192 160L256 241V96c0-17.7 14.3-32 32-32s32 14.3 32 32V416c0 17.7-14.3 32-32 32s-32-14.3-32-32V271l-11.5 9.6-192 160z"})})}function H9e(){return H.jsx("svg",{fill:"currentColor",viewBox:"0 0 320 512",className:yu,children:H.jsx("path",{d:"M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"})})}function G9e(t){return H.jsx("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",...t,children:H.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})})}const j9e=()=>H.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"})}),V9e="_activeStyle_1h8zr_12",W9e="_breathAnimation_1h8zr_1",$9e="_disabledStyle_1h8zr_25",uU={activeStyle:V9e,breathAnimation:W9e,disabledStyle:$9e},X9e=({active:t})=>{const e=t?uU.activeStyle:uU.disabledStyle;return H.jsx("svg",{width:"24",height:"24",viewBox:"0 0 100 100",children:H.jsx("circle",{className:e,cx:"50",cy:"50",r:"30"})})};var ly=(t=>(t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t))(ly||{}),iZ=(t=>(t[t.None=0]="None",t[t.Primary=1]="Primary",t[t.Secondary=2]="Secondary",t[t.Auxiliary=4]="Auxiliary",t[t.Back=8]="Back",t[t.Forward=16]="Forward",t))(iZ||{});function Od(t,e,n){return t<e?e:t>n?n:t}const q9e="_container_1ommy_1",Y9e="_rangeStyle_1ommy_7",K9e="_style_1ommy_25",Z9e="_dragIndStyle_1ommy_30";function Q9e({rangeRef:t,viewWidth:e,playback:n}){const[r,i]=v.useState(n.range.start),[s,o]=v.useState(n.range.end);v.useEffect(()=>{i(n.range.start)},[n.range.start]),v.useEffect(()=>{o(n.range.end)},[n.range.end]);const a=v.useCallback(c=>{n.setRange({start:c}),i(c)},[n]),l=v.useCallback(c=>{n.setRange({end:c}),o(c)},[n]);return H.jsx("div",{className:q9e,children:H.jsxs("div",{ref:t,className:Y9e,style:{left:`${(r-n.start)/(n.end-n.start)*100}%`,right:`${(n.duration+n.end-s)%n.duration/(n.end-n.start)*100}%`},children:[H.jsx(fU,{onChange:a,roundUp:!0,start:n.start,end:n.end,viewWidth:e}),H.jsx("div",{className:K9e}),H.jsx(fU,{onChange:l,roundUp:!0,start:n.start,end:n.end,viewWidth:e})]})})}function fU({onChange:t,start:e,end:n,viewWidth:r,roundUp:i=!1}){return H.jsx(G9e,{className:Z9e,onPointerDown:s=>{s.button===ly.Left&&(s.preventDefault(),s.stopPropagation(),s.currentTarget.setPointerCapture(s.pointerId))},onPointerMove:s=>{if(!s.currentTarget.hasPointerCapture(s.pointerId))return;s.stopPropagation();const o=s.movementX/r*(n-e);t(a=>Od(a+o,e,n))},onPointerUp:s=>{if(s.button!==ly.Left)return;s.stopPropagation(),s.currentTarget.releasePointerCapture(s.pointerId);const o=s.movementX/r*(n-e);t(a=>{const l=Od(a+o,e,n);return i?Math.round(l):l})}})}function J9e(t){const[e,n]=v.useState(new DOMRect),r=v.useMemo(()=>new ResizeObserver(()=>n(t.current.getBoundingClientRect())),[]);return v.useLayoutEffect(()=>{if(t.current)return r.observe(t.current),()=>r.unobserve(t.current)},[t.current]),e}const dU=V$;function sZ(t,e=null,n="vuer-default"){const r=`${n}-${t}`,[i,s,o]=v.useMemo(()=>{const p=localStorage.getItem(r);if(p===null){const m=JSON.stringify(e);return localStorage.setItem(r,m),console.log("initialized",r,m),[e,m,!1]}else{const m=JSON.parse(p);return console.log("loaded",r,p),[m,p,!0]}},[r]),[a,l,c]=dU(i),[u,f,d]=dU(s),h=v.useCallback(p=>{typeof p=="function"&&(p=p(c.current));const m=JSON.stringify(p);m!==d.current&&r&&(localStorage.setItem(r,m),l(p),f(m),console.log("saved",r,[d.current]))},[r,l,d]);return[a,h,o]}const e7e=t=>{const e=v.useRef(),n=v.useRef(),r=i=>{if(n.current!=null){const s=i-n.current;t(s)}n.current=i,e.current=requestAnimationFrame(r)};v.useEffect(()=>{if(t)return e.current=requestAnimationFrame(r),()=>cancelAnimationFrame(e.current)},[t])};class gA{constructor(e,n){tn(this,"buffer"),tn(this,"maxlen"),tn(this,"head"),tn(this,"tail"),tn(this,"size"),this.buffer=new Array(n),this.maxlen=n,this.head=0,this.tail=0,this.size=0,e!=null&&e.length&&e.forEach(r=>this.push(r))}get(e,n){return e<0||e>=this.size?n:this.buffer[(this.head+e)%this.maxlen]}push(e){this.size===this.maxlen?this.head=(this.head+1)%this.maxlen:this.size++,this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.maxlen}prepend(e){this.size===this.maxlen?this.tail=(this.tail-1+this.maxlen)%this.maxlen:this.size++,this.head=(this.head-1+this.maxlen)%this.maxlen,this.buffer[this.head]=e}toArray(){const e=[];for(let n=0;n<this.size;n++)e.push(this.buffer[(this.head+n)%this.maxlen]);return e}clear(){this.buffer=new Array(this.maxlen),this.size=0,this.head=0,this.tail=0}}class SR{constructor(e,n){tn(this,"start"),tn(this,"end"),this.start=e,this.end=n}}function oZ(t){function e(n,r,i){const s=i.value;return i.value=function(...o){const a=s.call(this,...o);return this.signal.emit(t,{}),a},i}return e}class TR{constructor(e=1e3,n=60,r=1,i=[],s=0,o=0,a=0,l=0,c=0,u=!0,f=!1,d=!0){tn(this,"maxlen"),tn(this,"fps"),tn(this,"speed"),tn(this,"start"),tn(this,"end"),tn(this,"curr"),tn(this,"isPaused"),tn(this,"isRecording"),tn(this,"loop"),tn(this,"_keyFrames"),tn(this,"clips"),tn(this,"store"),tn(this,"range"),tn(this,"signal"),tn(this,"changeBufferLength",h=>{this._keyFrames=new gA(this.keyFrames.toArray(),h),this.maxlen=h}),tn(this,"setMaxlen",h=>{this.changeBufferLength(h),this.keyFrames.size===0?(this.start=this.end,this.curr=this.end,this.range.start=this.end,this.range.end=this.end):(this.start=this.end+1-this.keyFrames.size,this.range.start=Math.max(this.start,this.range.start),this.range.end=Math.min(this.end,this.range.end)),this.signal.emit("UPDATE_STATE",{}),this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"deltaTime",0),tn(this,"render",h=>{if(this.isPaused||(this.deltaTime+=h,this.deltaTime<1e3/this.fps))return;const p=this.step(this.speed);this.deltaTime-=1e3/this.fps,p&&(this.store.publish(p),this.signal.emit("UPDATE_TIMELINE",{}))}),tn(this,"addKeyFrame",h=>{this.isRecording&&(this.curr===this.end&&this.keyFrames.size&&(this.curr+=1),this.range.end===this.end&&this.keyFrames.size&&(this.range.end+=1),this.keyFrames.size&&(this.end+=1),this.keyFrames.push(h),this.end-this.start>=this.keyFrames.maxlen&&(this.range.start===this.start&&(this.range.start+=1),this.start+=1),this.signal.emit("UPDATE_TIMELINE",{}),this.signal.emit("UPDATE_FRAME_BUFFER",{}))}),tn(this,"addClip",({data:h})=>{const p=(h==null?void 0:h.name)||`clip-${Object.keys(this.clips).length}`;typeof h.start!="number"&&(h.start=0,h.end=h.frames.length),this.clips[p]=h,this.signal.emit("UPDATE_CLIPS",{})}),tn(this,"moveClip",(h,p,m)=>{const g=this.clips[h];g&&(typeof p=="number"&&(g.start=p),typeof m=="number"&&(g.end=m),this.signal.emit("UPDATE_CLIPS",{}))}),tn(this,"clear",()=>{this.keyFrames.clear(),this.start=0,this.end=0,this.range.start=this.start,this.range.end=this.end,this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"seekNext",()=>{this.step(),this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"seekPrevious",()=>{this.step(-1),this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"reset",()=>{this.curr=this.range.start,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"seekEnd",()=>{this.curr=this.range.end,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"emitSeek",h=>{this.curr=h,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"setFrameRate",h=>{this.fps=h,this.signal.emit("UPDATE_STATE",{})}),tn(this,"setSpeed",h=>{this.speed=h,this.signal.emit("UPDATE_STATE",{})}),tn(this,"setRange",({start:h,end:p})=>{typeof h=="number"&&(this.range.start=h),typeof h=="function"&&(this.range.start=h(this.range.start)),typeof p=="number"&&(this.range.end=p),typeof p=="function"&&(this.range.end=p(this.range.end)),this.signal.emit("UPDATE_TIMELINE",{})}),tn(this,"toggleRecording",()=>{this.isRecording=!this.isRecording,this.isPaused=!0,this.signal.emit("UPDATE_STATE",{})}),tn(this,"pausePlayback",()=>{const h=this.isPaused;this.isPaused=!0,h!==this.isPaused&&this.signal.emit("UPDATE_STATE",{})}),tn(this,"togglePlayback",()=>{const h=this.isPaused,p=this.isRecording;this.isPaused?(this.isRecording=!1,this.curr===this.range.end?(this.curr=this.range.start,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{}),this.loop&&(this.isPaused=!1)):this.isPaused=!1):this.isPaused=!0,(h!==this.isPaused||p!==this.isRecording)&&this.signal.emit("UPDATE_STATE",{})}),tn(this,"toggleLoop",()=>{this.loop=!this.loop,this.signal.emit("UPDATE_STATE",{})}),this.maxlen=e,this.fps=n,this.speed=r,this.start=s,this.end=o,this.curr=a,this.isPaused=u,this.isRecording=d,this.loop=f,this._keyFrames=new gA(i,e),this.store=new Tm,this.range=new SR(l,c),this.signal=new Bq}get keyFrames(){return this._keyFrames}loadFrameBuffer(e){this.maxlen=Math.max(this.maxlen,e.length),this._keyFrames=new gA(e,this.maxlen)}get duration(){return this.keyFrames.size}get progress(){const e=this.range.end-this.range.start;return 100*(this.curr-this.range.start)/Math.max(e,1)}step(e=1){const n=this.curr;let r=n+e;return e>0?(r>this.range.end&&(this.loop?r=this.range.start:(r=this.range.end,this.keyFrames.size&&(this.isPaused=!0,this.signal.emit("UPDATE_STATE",{})))),r<this.range.start&&(r=this.range.start)):e<0&&(r<this.range.start&&(this.loop?r=this.range.end:(r=this.range.start,this.keyFrames.size&&(this.isPaused=!0))),r>this.range.end&&(r=this.range.end)),n===r||!this.keyFrames.size?null:(this.curr=r,this.currentFrame)}get currentFrame(){return this.keyFrames.get(Math.round(this.curr)-this.start)}get firstFrame(){return this.keyFrames.get(0)}get lastFrame(){return this.keyFrames.get(this.keyFrames.size-1)}}const QE=v.createContext(null),JE=v.createContext(null),ew=v.createContext(null),aZ=({children:t})=>{const[e,n]=v.useState(null);return v.useEffect(()=>(n(new TR),()=>{console.log("cleanup"),n(null)}),[]),e7e(e==null?void 0:e.render),H.jsx(QE.Provider,{value:e,children:t})},mh=()=>v.useContext(QE),lZ=({children:t})=>{const e=mh(),[n,r]=v.useState(),[i,s]=sZ("vuer-frame-buffer",[]);return console.log("load: buffer",i),v.useEffect(()=>e?(r({fps:e.fps,speed:e.speed,maxlen:e.maxlen,recording:e.isRecording,loop:e.loop,paused:e.isPaused}),e.signal.on("UPDATE_STATE",()=>{r(o=>({...o,fps:e.fps,speed:e.speed,maxlen:e.maxlen,recording:e.isRecording,loop:e.loop,paused:e.isPaused}))})):void 0,[e]),v.useEffect(()=>e?e.signal.on("UPDATE_FRAME_BUFFER",()=>{}):void 0,[e]),H.jsx(JE.Provider,{value:n,children:t})},AR=()=>v.useContext(JE),cZ=({children:t})=>{const e=mh(),[n,r]=v.useState();return v.useEffect(()=>e?(r({curr:e.curr,start:e.start,end:e.end,rangeStart:e.range.start,rangeEnd:e.range.end}),e.signal.on("UPDATE_TIMELINE",()=>{r(i=>({...i,curr:e.curr,start:e.start,end:e.end,rangeStart:e.range.start,rangeEnd:e.range.end}))})):void 0,[e]),H.jsx(ew.Provider,{value:n,children:t})},tw=()=>v.useContext(ew),t7e="_timelineContainer_udwj8_1",n7e="_timeline_udwj8_1",r7e="_visibleContainer_udwj8_23",i7e="_scrollContainer_udwj8_29",s7e="_playheadCursor_udwj8_35",o7e="_trackContainer_udwj8_47",a7e="_trackPlaceholder_udwj8_53",l7e=25e-6,c7e=.05,u7e=.5,f7e=50;function uZ({children:t}){var e;const n=v.useRef(null),r=v.useRef(null),i=v.useRef(null),s=J9e(n),[{scale:o,offset:a},l]=sZ("timeline-scale-offset",{scale:1,offset:.5*s.width}),c=o*s.width;v.useEffect(()=>{n.current&&(n.current.scrollLeft=a)},[a,s.width>0]);const u=mh(),f=tw();if(!u||!f)return H.jsx("div",{children:"loading timeline"});const d=u.duration>0,h=(e=n.current)==null?void 0:e.scrollLeft,{start:p,end:m,rangeStart:g,rangeEnd:y,curr:x}=f;return H.jsxs("div",{className:t7e,children:[!d&&H.jsx("div",{className:a7e,children:"Playback buffer is empty"}),H.jsx("div",{ref:n,className:n7e,onWheel:_=>{var w;_.stopPropagation();const T=(w=n.current)==null?void 0:w.scrollLeft;if(Math.abs(_.deltaX)>Math.abs(_.deltaY))return l({offset:Od(a+_.deltaX,0,c),scale:o});if(!_.altKey)return l({offset:Od(a+_.deltaY,0,c),scale:o});const S=_.clientX-.5*s.width+T;r.current.style.left=`${S}px`;const C=Math.max(1,Math.abs(_.deltaY));let A=(1-Math.sign(_.deltaY)*Math.max(c7e,C*l7e))*o;A=Math.max(u7e,A),A=Math.min(f7e*Math.max(u.end-u.start,1)/s.width,A);const R=T+(A-o)/o*S;l({scale:A,offset:Od(R,0,c)})},onPointerDown:_=>{var w;if(_.button!==ly.Left)return;const T=(w=n.current)==null?void 0:w.scrollLeft;let S=_.clientX-.5*s.width+T;S=Math.max(0,S),S=Math.min(c,S),r.current.style.left=`${S}px`;const C=Math.round(S/c*(u.end-u.start)+u.start);u.emitSeek(C)},onPointerUp:_=>{_.button===ly.Left&&(n.current.style.cursor="",r.current.style.display="")},onPointerMove:_=>{var w;const T=(w=n.current)==null?void 0:w.scrollLeft;let S=_.clientX-.5*s.width+T;try{r.current.style.left=`${S}px`}catch(A){console.error(A)}S=Math.max(0,S),S=Math.min(c,S);const C=Math.round(S/c*Math.max(u.end-u.start,1)+u.start);_.buttons&iZ.Primary&&u.emitSeek(C)},children:H.jsx("div",{className:r7e,style:{width:`calc(100% + ${c}px)`},children:H.jsxs("div",{className:i7e,style:{width:`${c}px`,left:`calc((100% - ${c}px) * 0.5)`},children:[H.jsx(D9e,{start:p,end:m,firstVisibleFrame:p-(.5*s.width-h)/c*Math.max(m-p,1),lastVisibleFrame:p+(s.width-.5*s.width+h)/c*Math.max(m-p,1),segmentDensity:Math.floor(40*Math.max(m-p,1)/c)}),H.jsx("div",{ref:r,className:s7e}),H.jsx(wR,{seeking:x,leftPos:(x-p)/Math.max(m-p,1)*c}),u&&H.jsx(Q9e,{rangeRef:i,rangeStart:g,rangeEnd:y,viewWidth:c,playback:u}),H.jsx("div",{className:o7e,style:{opacity:d?1:0},children:t})]})})})]})}const fZ=({children:t})=>{const e=mh(),n=v.useCallback((r,i)=>{const s=Object.keys(r)[0],o=r[s];fetch(o).then(a=>a.text()).then(a=>{console.log("csv text",a);const l=a.split(`\r
`)[0].split(",");a.split(`\r
`).slice(1).filter(c=>c.length>0).map((c,u)=>{const f=c.split(",");console.log("csv line",[c],f);const{x:d=null,y:h=null,z:p=null,roll:m=null,pitch:g=null,yaw:y=null,...x}=l.reduce((w,T,S)=>(w[T]=Number(f[S]),w),{}),_={tag:"Urdf",key:"anymal/urdf/anymal.urdf",jointValues:x};return d!==null&&(_.position=[d,h,p]),m!==null&&(_.rotation=[m,g,y]),{ts:u/50,etype:"UPSERT",data:{nodes:[_]}}}).map(e.addKeyFrame),i()})},[e]);return H.jsx(nR,{onLoad:n,style:{height:"calc(100% - 47px)"},prompt:"timeline files supported: *.csv *.json",children:t})},d7e="_codeStyle_1tml4_1",hU="_frameStyle_1tml4_7",h7e="_frameTimeStyle_1tml4_11";function ab({title:t="Current Time",frame:e,frameTime:n,right:r=!1,fps:i,speed:s,...o}){const a=s%1!==0?2:0,l=e/i;return H.jsxs("code",{title:`${t} ${e} ${l}`,className:d7e,style:{textAlign:r?"right":"left"},...o,children:[!r&&H.jsxs("span",{className:hU,children:["[",e==null?void 0:e.toFixed(a),"]"]}),H.jsx("span",{title:`${t} [HH:MM:SS:FF]`,className:h7e,children:n==null?void 0:n.toFixed(a)}),r&&H.jsxs("span",{className:hU,children:["[",e==null?void 0:e.toFixed(a),"]"]})]})}const p7e="_buttonStyle_db2ev_1",m7e="_disabledStyle_db2ev_16";function Gu({children:t,onClick:e,title:n,disabled:r}){return H.jsx("button",{disabled:r,title:n,className:`${p7e} ${r&&m7e}`,type:"button",onClick:r?null:e,children:t})}const g7e="_buttonStyle_1so1p_1",y7e="_disabledStyle_1so1p_14";function v7e({children:t,title:e,titleOff:n,onChange:r,active:i,disabled:s}){Array.isArray(t)||(t=[t]);const[o,a,...l]=[...t,null];return H.jsx("button",{title:i?e:n,onClick:r,className:`${g7e} ${s&&y7e}`,style:{color:i&&"var(--theme) !important"},children:i?o:a||o})}const x7e="_containerStyle_cc36b_1",_7e="_inputStyle_cc36b_44";function pU({value:t,onChange:e,width:n,prefix:r,postfix:i,...s}){const o=v.useRef(null);v.useLayoutEffect(()=>{o.current&&(o.current.size=Math.max(o.current.value.length,1))},[t]);const a=v.useCallback(l=>{const c=l.target.value,u=parseFloat(c);Number.isNaN(u)||e(u)},[]);return H.jsx("div",{className:x7e,"data-postfix":i,"data-prefix":r,children:H.jsx("input",{ref:o,className:_7e,style:{width:`${n}`},value:t,onChange:a,onSubmit:a,...s})})}const b7e="_style_58es6_1";function E7e({title:t,options:e,width:n,value:r,onChange:i=null,disabled:s}){const o=v.useCallback(a=>{i&&(i(e[parseInt(a.target.value)].value),a.target.blur())},[i]);return H.jsx("select",{title:t,disabled:s,className:b7e,style:{width:typeof n=="number"?`${n}px`:n},value:e.findIndex(a=>a.value===r),onChange:o,children:e.map((a,l)=>H.jsx("option",{value:l,children:a.text},String(a.value)))})}function w7e(){return H.jsx("svg",{viewBox:"0 0 448 512",fill:"currentColor",className:yu,children:H.jsx("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"})})}const S7e="_style_26khi_1";function MR({playback:t,maxlen:e,speed:n,paused:r,loop:i,recording:s}){const o=v.useMemo(()=>[{value:.125,text:"12.5%"},{value:.25,text:"25%"},{value:.5,text:"50%"},{value:1,text:"1"},{value:1.5,text:"1.5"},{value:2,text:"2"},{value:4,text:"4"}],[]);return H.jsxs("div",{className:S7e,children:[H.jsx(E7e,{title:"Playback speed",width:60,options:o,value:n,onChange:a=>t.setSpeed(a)}),H.jsx(Gu,{title:"Start [Shift + Left arrow]",onClick:()=>t.reset(),children:H.jsx(H9e,{})}),H.jsx(Gu,{title:"Previous frame [Left arrow]",onClick:()=>t.seekPrevious(),children:H.jsx(O9e,{})}),H.jsx(Gu,{title:r?"Pause [Space]":"Play [Space]",onClick:()=>t.togglePlayback(),children:r?H.jsx(j9e,{}):H.jsx(F9e,{})}),H.jsx(Gu,{title:"Next frame [Right arrow]",onClick:()=>t.seekNext(),children:H.jsx(N9e,{})}),H.jsx(Gu,{title:"End [Shift + Right arrow]",onClick:()=>t.seekEnd(),children:H.jsx(z9e,{})}),H.jsx(v7e,{title:"Disable looping [L]",titleOff:"Enable looping [L]",active:i,onChange:()=>t.toggleLoop(),children:H.jsx(B9e,{})}),H.jsx(pU,{title:"Current framerate",value:t.fps,postfix:"FPS",onChange:a=>t.setFrameRate(a),type:"number",width:t.fps>=100?"33px":"25px"}),H.jsx(Gu,{title:"Save snapshot",children:H.jsx(U9e,{})}),H.jsx(pU,{title:"Current framerate",value:e,prefix:"Maxlen ",onChange:a=>t.setMaxlen(a),type:"number",width:"50px"}),H.jsx(Gu,{title:s?"Stop Recording":"Record",onClick:()=>t.toggleRecording(),children:H.jsx(X9e,{active:s})}),H.jsx(Gu,{title:"clear the key frames buffer",onClick:()=>t.clear(),children:H.jsx(w7e,{})})]})}const T7e="_playbackBar_1e43n_1",A7e="_progressBar_1e43n_10",dZ=({})=>{const t=mh(),e=AR(),n=tw();if(!e||!n)return null;const{fps:r,speed:i,paused:s,maxlen:o,recording:a,loop:l}=e,{start:c,end:u,rangeStart:f,rangeEnd:d}=n;return H.jsxs("div",{className:T7e,children:[H.jsx(ab,{title:"Current time",frame:f,frameTime:(f-c)/r,fps:r,speed:i}),H.jsx(MR,{playback:t,maxlen:o,speed:i,paused:s,loop:l,recording:a}),H.jsx(ab,{title:"Duration",frame:d,frameTime:(d-c)/r,right:!0,fps:r,speed:i}),H.jsx("div",{className:A7e,style:{width:`${t.progress||0}%`}})]})};function hZ({_key:t,children:e,...n}){const r=v.useRef(null),i=v.useMemo(()=>()=>{setTimeout(()=>{var s;(s=r.current)==null||s.scrollIntoView({behavior:"smooth"})},.016)},[]);return v.useEffect(()=>{i()},[e,i]),H.jsxs("div",{...n,children:[e,H.jsx("div",{ref:r})]},t)}function pZ({_key:t,value:e,...n}){const{sendMsg:r}=Mr();return H.jsx("button",{onClick:()=>r({etype:"CLICK",key:t}),...n,children:e})}function mZ({_key:t,value:e,children:n,...r}){const{sendMsg:i}=Mr(),[s,o]=v.useState(e||0);return H.jsxs(H.Fragment,{children:[H.jsx("input",{type:"range",value:s,onMouseUp:({target:a})=>{const{value:l}=a;i({etype:"SET",key:t,value:l})},onChange:({target:a})=>{o(Number(a.value))},...r}),H.jsx("span",{children:s})]})}function gZ({_key:t,children:e,alt:n,...r}){const{sendMsg:i}=Mr();return H.jsx("img",{alt:n||t,className:"input-image",onClick:s=>{console.log("click on image"),s.preventDefault(),s.stopPropagation();const o=s.target.getBoundingClientRect(),a=s.clientX-o.left,l=s.clientY-o.top;i({etype:"CLICK",key:t,value:{x:a,y:l,w:o.width,h:o.height}})},...r})}function yZ({_key:t,value:e,style:n,textareaStyle:r={},placeholder:i,defaultValue:s,clearOnSubmit:o,children:a,...l}){const[c,u]=v.useState(e),{sendMsg:f}=Mr(),d=v.useMemo(()=>({target:p})=>{u(p.value)},[]),h=v.useMemo(()=>p=>{if(p.keyCode==39&&!c){if(!s)return;p.preventDefault(),u(s)}p.keyCode==13&&!p.shiftKey&&(p.preventDefault(),f({etype:"INPUT",key:t,value:c}),o&&u(""))},[c]);return H.jsx("form",{style:{flex:"0 0 auto",height:"200px",display:"flex",flexDirection:"column",...n},...l,children:H.jsx("textarea",{placeholder:i||`"${s}" [ press  for default,  to submit ]`,value:c,onChange:d,onKeyUp:h,style:{flex:"1 1 auto",height:"100%",width:"100%",padding:"10px",marginTop:"5px",border:"1.5px solid #eee",borderRadius:"5px",...r}})})}function vZ({_key:t,label:e}){const{sendMsg:n}=Mr(),[r,i]=v.useState(null),s=v.useCallback(o=>{var a,l;const c=(l=(a=o==null?void 0:o.target)==null?void 0:a.files)==null?void 0:l[0];c&&i(c)},[]);return H.jsxs("form",{onSubmit:o=>{o.preventDefault(),r&&zq(r).then(a=>{const l=a.slice(22);n({etype:"UPLOAD",key:t,value:l})})},children:[H.jsxs("label",{htmlFor:"file",children:[e," "]}),H.jsx("input",{type:"file",onChange:s}),H.jsx("input",{type:"submit",value:"Submit"})]})}function xZ({_key:t,...e}){return H.jsx("div",{...e},t)}function _Z({_key:t,text:e,...n}){return H.jsx("span",{...n,children:e})}function M7e(t,e,n="latest",r="dist/index.js",i=!1){return i?`third_party/${r}?ts=${Date.now()}`:i?(console.warn(`loading third party scripts from ${t}`),t):`https://cdn.jsdelivr.net/npm/${e}@${n}/${r}`}const bZ=({_key:t="contrib-loader",url:e,library:n,version:r="latest",main:i="dist/index.js",dev:s=!1,onLoad:o,onError:a})=>{const l=e||M7e(e,n,r,i,s),{sendMsg:c}=Mr(),u=typeof o=="string"?o:"ON_CONTRIB_LOAD";return o=v.useCallback(()=>{typeof o=="function"&&o(),c({etype:u,key:t,value:{url:l,library:n,version:r,main:i}})},[e]),H.jsx($B,{children:H.jsx("script",{src:l,async:!0,type:"text/javascript",onLoad:o,onError:f=>{const d=`Failed to load script from library ${n} at ${l}: ${f}`;a&&a(new Error(d))}})})},C7e=v.createContext({});function EZ(t,{type:e,etype:n,...r},i){return e==="BUTTON"?Oy(()=>i({key:t,etype:n}),r):{type:e,...r}}function wZ({layers:t=[],settings:e={},children:n=[]}){let r,i;const s=v.useMemo(()=>({layers:new Set}),[]),{uplink:o}=Mr();[r,i]=vr("Render",()=>({renderHeight:{value:768,min:1,max:2304,step:1,pad:1,label:"Height"},"Res Presets":mN({opts:{384:()=>i({renderHeight:384}),480:()=>i({renderHeight:480}),768:()=>i({renderHeight:768}),960:()=>i({renderHeight:960}),1536:()=>i({renderHeight:1536})}}),progressive:{value:-2,min:-3,max:0,step:.5,label:"Progressive Scale"},Presets:mN({opts:{"-3":()=>i({progressive:-3}),"-2.5":()=>i({progressive:-2.5}),"-2":()=>i({progressive:-2}),"-1.5":()=>i({progressive:-1.5}),"-1":()=>i({progressive:-1}),"-1/2":()=>i({progressive:-.5}),"/":()=>i({progressive:0})}})}),[t]);const a=v.useMemo(()=>Object.entries(e||{}).reduce((d,[h,p])=>({...d,[h]:EZ(h,p,o.publish)}),{}),[e]),l=v.useMemo(()=>{const d=n.map(h=>[h.key,{value:t.indexOf(h.key)>=0,label:`[${h.key}]`}]);return Object.fromEntries(d)},[]),c=vr("Render.Layers",l,[t]),u=v.useMemo(()=>n.filter(d=>c[d.key]),[c]),f=vr("Render.more",a,{collapsed:!0});return v.useEffect(()=>(setTimeout(()=>o==null?void 0:o.publish({etype:"CAMERA_UPDATE",ts:Date.now()}),0),o.addReducer("CAMERA_MOVE",({value:{render:d,...h},...p})=>({...p,value:{...h,render:{...d,...r,...f,layers:u.map(m=>m.key)}}}))),[u,o,f,r]),H.jsxs(H.Fragment,{children:[f.use_aabb?H.jsx(z8,{children:H.jsx(VE,{min:f.aabb_min,max:f.aabb_max})}):null,H.jsx(C7e.Provider,{value:s,children:u})]})}function SZ({_key:t,title:e=`Render.Channel [${t}]`,channel:n,alphaChannel:r,settings:i,distance:s=10,interpolate:o=!1,opacity:a=1,folderOptions:l}){const[c,u]=v.useState(),[f,d]=v.useState(),{uplink:h,downlink:p}=Mr(),m=v.useMemo(()=>Object.entries(i||{}).reduce((_,[w,T])=>({..._,[w]:EZ(w,T,h.publish)}),{}),[i,h.publish]),g=vr(e,m,l,[i]);v.useLayoutEffect(()=>(setTimeout(()=>h==null?void 0:h.publish({etype:"CAMERA_UPDATE",ts:Date.now()}),0),h.addReducer("CAMERA_MOVE",({value:{render:_={},...w},...T})=>({...T,value:{...w,render:{..._,[t]:g}}}),n)),[h,g]);const y=vr(`${e}.more`,{interpolate:o,distance:s,opacity:{value:a||1,label:"Opacity",min:0,max:1}},{label:"Options",collapsed:!0},[]),x=v.useCallback(({etype:_,data:w})=>{if(_==="RENDER"){if(n in w){const T=w[g.channel||n];if(!T)return;u(T)}if(r in w){const T=w[g.alphaChannel||r];if(!T)return;d(T)}}},[g.useAlpha]);return v.useLayoutEffect(()=>p.subscribe("RENDER",x),[p]),H.jsxs(H.Fragment,{children:[g.use_aabb?H.jsx(z8,{children:H.jsx("group",{position:FE(g.position),rotation:U8(g.rotation),scale:B8(g.scale),children:H.jsx(VE,{min:g.aabb_min,max:g.aabb_max})})}):null,c?H.jsx(ER,{src:c,alphaSrc:g.useAlpha?f:void 0,distanceToCamera:y.distance,interpolate:y.interpolate,opacity:y.opacity}):null]})}const TZ=-1,nw=0,lb=1,cb=2,CR=3,RR=4,IR=5,PR=6,AZ=7,MZ=8,mU=typeof self=="object"?self:globalThis,R7e=(t,e)=>{const n=(i,s)=>(t.set(s,i),i),r=i=>{if(t.has(i))return t.get(i);const[s,o]=e[i];switch(s){case nw:case TZ:return n(o,i);case lb:{const a=n([],i);for(const l of o)a.push(r(l));return a}case cb:{const a=n({},i);for(const[l,c]of o)a[r(l)]=r(c);return a}case CR:return n(new Date(o),i);case RR:{const{source:a,flags:l}=o;return n(new RegExp(a,l),i)}case IR:{const a=n(new Map,i);for(const[l,c]of o)a.set(r(l),r(c));return a}case PR:{const a=n(new Set,i);for(const l of o)a.add(r(l));return a}case AZ:{const{name:a,message:l}=o;return n(new mU[a](l),i)}case MZ:return n(BigInt(o),i);case"BigInt":return n(Object(BigInt(o)),i)}return n(new mU[s](o),i)};return r},gU=t=>R7e(new Map,t)(0),Cp="",{toString:I7e}={},{keys:P7e}=Object,Ug=t=>{const e=typeof t;if(e!=="object"||!t)return[nw,e];const n=I7e.call(t).slice(8,-1);switch(n){case"Array":return[lb,Cp];case"Object":return[cb,Cp];case"Date":return[CR,Cp];case"RegExp":return[RR,Cp];case"Map":return[IR,Cp];case"Set":return[PR,Cp]}return n.includes("Array")?[lb,n]:n.includes("Error")?[AZ,n]:[cb,n]},Kx=([t,e])=>t===nw&&(e==="function"||e==="symbol"),k7e=(t,e,n,r)=>{const i=(o,a)=>{const l=r.push(o)-1;return n.set(a,l),l},s=o=>{if(n.has(o))return n.get(o);let[a,l]=Ug(o);switch(a){case nw:{let u=o;switch(l){case"bigint":a=MZ,u=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+l);u=null;break;case"undefined":return i([TZ],o)}return i([a,u],o)}case lb:{if(l)return i([l,[...o]],o);const u=[],f=i([a,u],o);for(const d of o)u.push(s(d));return f}case cb:{if(l)switch(l){case"BigInt":return i([l,o.toString()],o);case"Boolean":case"Number":case"String":return i([l,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const u=[],f=i([a,u],o);for(const d of P7e(o))(t||!Kx(Ug(o[d])))&&u.push([s(d),s(o[d])]);return f}case CR:return i([a,o.toISOString()],o);case RR:{const{source:u,flags:f}=o;return i([a,{source:u,flags:f}],o)}case IR:{const u=[],f=i([a,u],o);for(const[d,h]of o)(t||!(Kx(Ug(d))||Kx(Ug(h))))&&u.push([s(d),s(h)]);return f}case PR:{const u=[],f=i([a,u],o);for(const d of o)(t||!Kx(Ug(d)))&&u.push(s(d));return f}}const{message:c}=o;return i([a,{name:l,message:c}],o)};return s},yU=(t,{json:e,lossy:n}={})=>{const r=[];return k7e(!(e||n),!!e,new Map,r)(t),r},vU=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?gU(yU(t,e)):structuredClone(t):(t,e)=>gU(yU(t,e));let Yy=class{constructor(t,e,n){this.property=t,this.normal=e,n&&(this.space=n)}};Yy.prototype.property={};Yy.prototype.normal={};Yy.prototype.space=null;function CZ(t,e){const n={},r={};let i=-1;for(;++i<t.length;)Object.assign(n,t[i].property),Object.assign(r,t[i].normal);return new Yy(n,r,e)}function cy(t){return t.toLowerCase()}let nl=class{constructor(t,e){this.property=t,this.attribute=e}};nl.prototype.space=null;nl.prototype.boolean=!1;nl.prototype.booleanish=!1;nl.prototype.overloadedBoolean=!1;nl.prototype.number=!1;nl.prototype.commaSeparated=!1;nl.prototype.spaceSeparated=!1;nl.prototype.commaOrSpaceSeparated=!1;nl.prototype.mustUseProperty=!1;nl.prototype.defined=!1;let L7e=0;const qn=gh(),Ki=gh(),RZ=gh(),zt=gh(),Kr=gh(),hm=gh(),sa=gh();function gh(){return 2**++L7e}const BM=Object.freeze(Object.defineProperty({__proto__:null,boolean:qn,booleanish:Ki,commaOrSpaceSeparated:sa,commaSeparated:hm,number:zt,overloadedBoolean:RZ,spaceSeparated:Kr},Symbol.toStringTag,{value:"Module"})),yA=Object.keys(BM);let kR=class extends nl{constructor(t,e,n,r){let i=-1;if(super(t,e),xU(this,"space",r),typeof n=="number")for(;++i<yA.length;){const s=yA[i];xU(this,yA[i],(n&BM[s])===BM[s])}}};kR.prototype.defined=!0;function xU(t,e,n){n&&(t[e]=n)}const D7e={}.hasOwnProperty;function a0(t){const e={},n={};let r;for(r in t.properties)if(D7e.call(t.properties,r)){const i=t.properties[r],s=new kR(r,t.transform(t.attributes||{},r),i,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,n[cy(r)]=r,n[cy(s.attribute)]=r}return new Yy(e,n,t.space)}const IZ=a0({space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),PZ=a0({space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function kZ(t,e){return e in t?t[e]:e}function LZ(t,e){return kZ(t,e.toLowerCase())}const DZ=a0({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:LZ,properties:{xmlns:null,xmlnsXLink:null}}),NZ=a0({transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Ki,ariaAutoComplete:null,ariaBusy:Ki,ariaChecked:Ki,ariaColCount:zt,ariaColIndex:zt,ariaColSpan:zt,ariaControls:Kr,ariaCurrent:null,ariaDescribedBy:Kr,ariaDetails:null,ariaDisabled:Ki,ariaDropEffect:Kr,ariaErrorMessage:null,ariaExpanded:Ki,ariaFlowTo:Kr,ariaGrabbed:Ki,ariaHasPopup:null,ariaHidden:Ki,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Kr,ariaLevel:zt,ariaLive:null,ariaModal:Ki,ariaMultiLine:Ki,ariaMultiSelectable:Ki,ariaOrientation:null,ariaOwns:Kr,ariaPlaceholder:null,ariaPosInSet:zt,ariaPressed:Ki,ariaReadOnly:Ki,ariaRelevant:null,ariaRequired:Ki,ariaRoleDescription:Kr,ariaRowCount:zt,ariaRowIndex:zt,ariaRowSpan:zt,ariaSelected:Ki,ariaSetSize:zt,ariaSort:null,ariaValueMax:zt,ariaValueMin:zt,ariaValueNow:zt,ariaValueText:null,role:null}}),N7e=a0({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:LZ,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:hm,acceptCharset:Kr,accessKey:Kr,action:null,allow:null,allowFullScreen:qn,allowPaymentRequest:qn,allowUserMedia:qn,alt:null,as:null,async:qn,autoCapitalize:null,autoComplete:Kr,autoFocus:qn,autoPlay:qn,blocking:Kr,capture:null,charSet:null,checked:qn,cite:null,className:Kr,cols:zt,colSpan:null,content:null,contentEditable:Ki,controls:qn,controlsList:Kr,coords:zt|hm,crossOrigin:null,data:null,dateTime:null,decoding:null,default:qn,defer:qn,dir:null,dirName:null,disabled:qn,download:RZ,draggable:Ki,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:qn,formTarget:null,headers:Kr,height:zt,hidden:qn,high:zt,href:null,hrefLang:null,htmlFor:Kr,httpEquiv:Kr,id:null,imageSizes:null,imageSrcSet:null,inert:qn,inputMode:null,integrity:null,is:null,isMap:qn,itemId:null,itemProp:Kr,itemRef:Kr,itemScope:qn,itemType:Kr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:qn,low:zt,manifest:null,max:null,maxLength:zt,media:null,method:null,min:null,minLength:zt,multiple:qn,muted:qn,name:null,nonce:null,noModule:qn,noValidate:qn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:qn,optimum:zt,pattern:null,ping:Kr,placeholder:null,playsInline:qn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:qn,referrerPolicy:null,rel:Kr,required:qn,reversed:qn,rows:zt,rowSpan:zt,sandbox:Kr,scope:null,scoped:qn,seamless:qn,selected:qn,shadowRootClonable:qn,shadowRootDelegatesFocus:qn,shadowRootMode:null,shape:null,size:zt,sizes:null,slot:null,span:zt,spellCheck:Ki,src:null,srcDoc:null,srcLang:null,srcSet:null,start:zt,step:null,style:null,tabIndex:zt,target:null,title:null,translate:null,type:null,typeMustMatch:qn,useMap:null,value:Ki,width:zt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Kr,axis:null,background:null,bgColor:null,border:zt,borderColor:null,bottomMargin:zt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:qn,declare:qn,event:null,face:null,frame:null,frameBorder:null,hSpace:zt,leftMargin:zt,link:null,longDesc:null,lowSrc:null,marginHeight:zt,marginWidth:zt,noResize:qn,noHref:qn,noShade:qn,noWrap:qn,object:null,profile:null,prompt:null,rev:null,rightMargin:zt,rules:null,scheme:null,scrolling:Ki,standby:null,summary:null,text:null,topMargin:zt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:zt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:qn,disableRemotePlayback:qn,prefix:null,property:null,results:zt,security:null,unselectable:null}}),O7e=a0({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:kZ,properties:{about:sa,accentHeight:zt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:zt,amplitude:zt,arabicForm:null,ascent:zt,attributeName:null,attributeType:null,azimuth:zt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:zt,by:null,calcMode:null,capHeight:zt,className:Kr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:zt,diffuseConstant:zt,direction:null,display:null,dur:null,divisor:zt,dominantBaseline:null,download:qn,dx:null,dy:null,edgeMode:null,editable:null,elevation:zt,enableBackground:null,end:null,event:null,exponent:zt,externalResourcesRequired:null,fill:null,fillOpacity:zt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:hm,g2:hm,glyphName:hm,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:zt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:zt,horizOriginX:zt,horizOriginY:zt,id:null,ideographic:zt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:zt,k:zt,k1:zt,k2:zt,k3:zt,k4:zt,kernelMatrix:sa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:zt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:zt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:zt,overlineThickness:zt,paintOrder:null,panose1:null,path:null,pathLength:zt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Kr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:zt,pointsAtY:zt,pointsAtZ:zt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:sa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:sa,rev:sa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:sa,requiredFeatures:sa,requiredFonts:sa,requiredFormats:sa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:zt,specularExponent:zt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:zt,strikethroughThickness:zt,string:null,stroke:null,strokeDashArray:sa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:zt,strokeOpacity:zt,strokeWidth:null,style:null,surfaceScale:zt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:sa,tabIndex:zt,tableValues:null,target:null,targetX:zt,targetY:zt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:sa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:zt,underlineThickness:zt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:zt,values:null,vAlphabetic:zt,vMathematical:zt,vectorEffect:null,vHanging:zt,vIdeographic:zt,version:null,vertAdvY:zt,vertOriginX:zt,vertOriginY:zt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:zt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),F7e=/^data[-\w.:]+$/i,_U=/-[a-z]/g,U7e=/[A-Z]/g;function LR(t,e){const n=cy(e);let r=e,i=nl;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&F7e.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(_U,z7e);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!_U.test(s)){let o=s.replace(U7e,B7e);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}i=kR}return new i(r,e)}function B7e(t){return"-"+t.toLowerCase()}function z7e(t){return t.charAt(1).toUpperCase()}const rw=CZ([PZ,IZ,DZ,NZ,N7e],"html"),Ky=CZ([PZ,IZ,DZ,NZ,O7e],"svg");function bU(t){const e=[],n=String(t||"");let r=n.indexOf(","),i=0,s=!1;for(;!s;){r===-1&&(r=n.length,s=!0);const o=n.slice(i,r).trim();(o||!s)&&e.push(o),i=r+1,r=n.indexOf(",",i)}return e}function H7e(t,e){const n={};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const EU=/[#.]/g;function G7e(t,e){const n=t||"",r={};let i=0,s,o;for(;i<n.length;){EU.lastIndex=i;const a=EU.exec(n),l=n.slice(i,a?a.index:n.length);l&&(s?s==="#"?r.id=l:Array.isArray(r.className)?r.className.push(l):r.className=[l]:o=l,i+=l.length),a&&(s=a[0],i++)}return{type:"element",tagName:o||e||"div",properties:r,children:[]}}function wU(t){const e=String(t||"").trim();return e?e.split(/[ \t\n\r\f]+/g):[]}function j7e(t){return t.join(" ").trim()}const zM={}.hasOwnProperty;function OZ(t,e,n){const r=n&&X7e(n);function i(s,o,...a){let l=-1,c;if(s==null){c={type:"root",children:[]};const u=o;a.unshift(u)}else if(c=G7e(s,e),c.tagName=c.tagName.toLowerCase(),r&&zM.call(r,c.tagName)&&(c.tagName=r[c.tagName]),V7e(o))a.unshift(o);else{let u;for(u in o)zM.call(o,u)&&W7e(t,c.properties,u,o[u])}for(;++l<a.length;)HM(c.children,a[l]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return i}function V7e(t){if(t===null||typeof t!="object"||Array.isArray(t))return!0;if(typeof t.type!="string")return!1;const e=t,n=Object.keys(t);for(const r of n){const i=e[r];if(i&&typeof i=="object"){if(!Array.isArray(i))return!0;const s=i;for(const o of s)if(typeof o!="number"&&typeof o!="string")return!0}}return!!("children"in t&&Array.isArray(t.children))}function W7e(t,e,n,r){const i=LR(t,n);let s=-1,o;if(r!=null){if(typeof r=="number"){if(Number.isNaN(r))return;o=r}else typeof r=="boolean"?o=r:typeof r=="string"?i.spaceSeparated?o=wU(r):i.commaSeparated?o=bU(r):i.commaOrSpaceSeparated?o=wU(bU(r).join(" ")):o=SU(i,i.property,r):Array.isArray(r)?o=r.concat():o=i.property==="style"?$7e(r):String(r);if(Array.isArray(o)){const a=[];for(;++s<o.length;){const l=SU(i,i.property,o[s]);a[s]=l}o=a}if(i.property==="className"&&Array.isArray(e.className)){const a=o;o=e.className.concat(a)}e[i.property]=o}}function HM(t,e){let n=-1;if(e!=null)if(typeof e=="string"||typeof e=="number")t.push({type:"text",value:String(e)});else if(Array.isArray(e))for(;++n<e.length;)HM(t,e[n]);else if(typeof e=="object"&&"type"in e)e.type==="root"?HM(t,e.children):t.push(e);else throw new Error("Expected node, nodes, or string, got `"+e+"`")}function SU(t,e,n){if(typeof n=="string"){if(t.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((t.boolean||t.overloadedBoolean)&&(n===""||cy(n)===cy(e)))return!0}return n}function $7e(t){const e=[];let n;for(n in t)zM.call(t,n)&&e.push([n,t[n]].join(": "));return e.join("; ")}function X7e(t){const e={};let n=-1;for(;++n<t.length;)e[t[n].toLowerCase()]=t[n];return e}const q7e=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],Y7e=OZ(rw,"div"),K7e=OZ(Ky,"g",q7e);function Z7e(t){const e=String(t),n=[];return{toOffset:i,toPoint:r};function r(s){if(typeof s=="number"&&s>-1&&s<=e.length){let o=0;for(;;){let a=n[o];if(a===void 0){const l=TU(e,n[o-1]);a=l===-1?e.length+1:l+1,n[o]=a}if(a>s)return{line:o+1,column:s-(o>0?n[o-1]:0)+1,offset:s};o++}}}function i(s){if(s&&typeof s.line=="number"&&typeof s.column=="number"&&!Number.isNaN(s.line)&&!Number.isNaN(s.column)){for(;n.length<s.line;){const a=n[n.length-1],l=TU(e,a),c=l===-1?e.length+1:l+1;if(a===c)break;n.push(c)}const o=(s.line>1?n[s.line-2]:0)+s.column-1;if(o<n[s.line-1])return o}}}function TU(t,e){const n=t.indexOf("\r",e),r=t.indexOf(`
`,e);return r===-1?n:n===-1||n+1===r?r:n<r?n:r}const Sd={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},FZ={}.hasOwnProperty,Q7e=Object.prototype;function J7e(t,e){const n=e||{};return DR({file:n.file||void 0,location:!1,schema:n.space==="svg"?Ky:rw,verbose:n.verbose||!1},t)}function DR(t,e){let n;switch(e.nodeName){case"#comment":{const r=e;return n={type:"comment",value:r.data},E3(t,r,n),n}case"#document":case"#document-fragment":{const r=e,i="mode"in r?r.mode==="quirks"||r.mode==="limited-quirks":!1;if(n={type:"root",children:UZ(t,e.childNodes),data:{quirksMode:i}},t.file&&t.location){const s=String(t.file),o=Z7e(s),a=o.toPoint(0),l=o.toPoint(s.length);n.position={start:a,end:l}}return n}case"#documentType":{const r=e;return n={type:"doctype"},E3(t,r,n),n}case"#text":{const r=e;return n={type:"text",value:r.value},E3(t,r,n),n}default:return n=eIe(t,e),n}}function UZ(t,e){let n=-1;const r=[];for(;++n<e.length;){const i=DR(t,e[n]);r.push(i)}return r}function eIe(t,e){const n=t.schema;t.schema=e.namespaceURI===Sd.svg?Ky:rw;let r=-1;const i={};for(;++r<e.attrs.length;){const o=e.attrs[r],a=(o.prefix?o.prefix+":":"")+o.name;FZ.call(Q7e,a)||(i[a]=o.value)}const s=(t.schema.space==="svg"?K7e:Y7e)(e.tagName,i,UZ(t,e.childNodes));if(E3(t,e,s),s.tagName==="template"){const o=e,a=o.sourceCodeLocation,l=a&&a.startTag&&rm(a.startTag),c=a&&a.endTag&&rm(a.endTag),u=DR(t,o.content);l&&c&&t.file&&(u.position={start:l.end,end:c.start}),s.content=u}return t.schema=n,s}function E3(t,e,n){if("sourceCodeLocation"in e&&e.sourceCodeLocation&&t.file){const r=tIe(t,n,e.sourceCodeLocation);r&&(t.location=!0,n.position=r)}}function tIe(t,e,n){const r=rm(n);if(e.type==="element"){const i=e.children[e.children.length-1];if(r&&!n.endTag&&i&&i.position&&i.position.end&&(r.end=Object.assign({},i.position.end)),t.verbose){const s={};let o;if(n.attrs)for(o in n.attrs)FZ.call(n.attrs,o)&&(s[LR(t.schema,o).property]=rm(n.attrs[o]));n.startTag;const a=rm(n.startTag),l=n.endTag?rm(n.endTag):void 0,c={opening:a};l&&(c.closing=l),c.properties=s,e.data={position:c}}}return r}function rm(t){const e=AU({line:t.startLine,column:t.startCol,offset:t.startOffset}),n=AU({line:t.endLine,column:t.endCol,offset:t.endOffset});return e||n?{start:e,end:n}:void 0}function AU(t){return t.line&&t.column?t:void 0}const MU={}.hasOwnProperty;function BZ(t,e){const n=e||{};function r(i,...s){let o=r.invalid;const a=r.handlers;if(i&&MU.call(i,t)){const l=String(i[t]);o=MU.call(a,l)?a[l]:r.unknown}if(o)return o.call(this,i,...s)}return r.handlers=n.handlers||{},r.invalid=n.invalid,r.unknown=n.unknown,r}const nIe={},rIe={}.hasOwnProperty,zZ=BZ("type",{handlers:{root:sIe,element:uIe,text:lIe,comment:cIe,doctype:aIe}});function iIe(t,e){const n=(e||nIe).space;return zZ(t,n==="svg"?Ky:rw)}function sIe(t,e){const n={nodeName:"#document",mode:(t.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return n.childNodes=NR(t.children,n,e),l0(t,n),n}function oIe(t,e){const n={nodeName:"#document-fragment",childNodes:[]};return n.childNodes=NR(t.children,n,e),l0(t,n),n}function aIe(t){const e={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return l0(t,e),e}function lIe(t){const e={nodeName:"#text",value:t.value,parentNode:null};return l0(t,e),e}function cIe(t){const e={nodeName:"#comment",data:t.value,parentNode:null};return l0(t,e),e}function uIe(t,e){const n=e;let r=n;t.type==="element"&&t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(r=Ky);const i=[];let s;if(t.properties){for(s in t.properties)if(s!=="children"&&rIe.call(t.properties,s)){const l=fIe(r,s,t.properties[s]);l&&i.push(l)}}const o=r.space,a={nodeName:t.tagName,tagName:t.tagName,attrs:i,namespaceURI:Sd[o],childNodes:[],parentNode:null};return a.childNodes=NR(t.children,a,r),l0(t,a),t.tagName==="template"&&t.content&&(a.content=oIe(t.content,r)),a}function fIe(t,e,n){const r=LR(t,e);if(n===!1||n===null||n===void 0||typeof n=="number"&&Number.isNaN(n)||!n&&r.boolean)return;Array.isArray(n)&&(n=r.commaSeparated?H7e(n):j7e(n));const i={name:r.attribute,value:n===!0?"":String(n)};if(r.space&&r.space!=="html"&&r.space!=="svg"){const s=i.name.indexOf(":");s<0?i.prefix="":(i.name=i.name.slice(s+1),i.prefix=r.attribute.slice(0,s)),i.namespace=Sd[r.space]}return i}function NR(t,e,n){let r=-1;const i=[];if(t)for(;++r<t.length;){const s=zZ(t[r],n);s.parentNode=e,i.push(s)}return i}function l0(t,e){const n=t.position;n&&n.start&&n.end&&(n.start.offset,n.end.offset,e.sourceCodeLocation={startLine:n.start.line,startCol:n.start.column,startOffset:n.start.offset,endLine:n.end.line,endCol:n.end.column,endOffset:n.end.offset})}const dIe=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],hIe=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),fi="";var Ae;(function(t){t[t.EOF=-1]="EOF",t[t.NULL=0]="NULL",t[t.TABULATION=9]="TABULATION",t[t.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",t[t.LINE_FEED=10]="LINE_FEED",t[t.FORM_FEED=12]="FORM_FEED",t[t.SPACE=32]="SPACE",t[t.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",t[t.QUOTATION_MARK=34]="QUOTATION_MARK",t[t.AMPERSAND=38]="AMPERSAND",t[t.APOSTROPHE=39]="APOSTROPHE",t[t.HYPHEN_MINUS=45]="HYPHEN_MINUS",t[t.SOLIDUS=47]="SOLIDUS",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",t[t.EQUALS_SIGN=61]="EQUALS_SIGN",t[t.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",t[t.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",t[t.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",t[t.GRAVE_ACCENT=96]="GRAVE_ACCENT",t[t.LATIN_SMALL_A=97]="LATIN_SMALL_A",t[t.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(Ae||(Ae={}));const Fo={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function HZ(t){return t>=55296&&t<=57343}function pIe(t){return t>=56320&&t<=57343}function mIe(t,e){return(t-55296)*1024+9216+e}function GZ(t){return t!==32&&t!==10&&t!==13&&t!==9&&t!==12&&t>=1&&t<=31||t>=127&&t<=159}function jZ(t){return t>=64976&&t<=65007||hIe.has(t)}var St;(function(t){t.controlCharacterInInputStream="control-character-in-input-stream",t.noncharacterInInputStream="noncharacter-in-input-stream",t.surrogateInInputStream="surrogate-in-input-stream",t.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",t.endTagWithAttributes="end-tag-with-attributes",t.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",t.unexpectedSolidusInTag="unexpected-solidus-in-tag",t.unexpectedNullCharacter="unexpected-null-character",t.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",t.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",t.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",t.missingEndTagName="missing-end-tag-name",t.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",t.unknownNamedCharacterReference="unknown-named-character-reference",t.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",t.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",t.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",t.eofBeforeTagName="eof-before-tag-name",t.eofInTag="eof-in-tag",t.missingAttributeValue="missing-attribute-value",t.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",t.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",t.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",t.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",t.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",t.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",t.missingDoctypePublicIdentifier="missing-doctype-public-identifier",t.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",t.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",t.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",t.cdataInHtmlContent="cdata-in-html-content",t.incorrectlyOpenedComment="incorrectly-opened-comment",t.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",t.eofInDoctype="eof-in-doctype",t.nestedComment="nested-comment",t.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",t.eofInComment="eof-in-comment",t.incorrectlyClosedComment="incorrectly-closed-comment",t.eofInCdata="eof-in-cdata",t.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",t.nullCharacterReference="null-character-reference",t.surrogateCharacterReference="surrogate-character-reference",t.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",t.controlCharacterReference="control-character-reference",t.noncharacterCharacterReference="noncharacter-character-reference",t.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",t.missingDoctypeName="missing-doctype-name",t.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",t.duplicateAttribute="duplicate-attribute",t.nonConformingDoctype="non-conforming-doctype",t.missingDoctype="missing-doctype",t.misplacedDoctype="misplaced-doctype",t.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",t.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",t.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",t.openElementsLeftAfterEof="open-elements-left-after-eof",t.abandonedHeadElementChild="abandoned-head-element-child",t.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",t.nestedNoscriptInHead="nested-noscript-in-head",t.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(St||(St={}));const gIe=65536;class yIe{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=gIe,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e,n){const{line:r,col:i,offset:s}=this,o=i+n,a=s+n;return{code:e,startLine:r,endLine:r,startCol:o,endCol:o,startOffset:a,endOffset:a}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const n=this.html.charCodeAt(this.pos+1);if(pIe(n))return this.pos++,this._addGap(),mIe(e,n)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,Ae.EOF;return this._err(St.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,n){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=n}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,n){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(n)return this.html.startsWith(e,this.pos);for(let r=0;r<e.length;r++)if((this.html.charCodeAt(this.pos+r)|32)!==e.charCodeAt(r))return!1;return!0}peek(e){const n=this.pos+e;if(n>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,Ae.EOF;const r=this.html.charCodeAt(n);return r===Ae.CARRIAGE_RETURN?Ae.LINE_FEED:r}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,Ae.EOF;let e=this.html.charCodeAt(this.pos);return e===Ae.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,Ae.LINE_FEED):e===Ae.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,HZ(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===Ae.LINE_FEED||e===Ae.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){GZ(e)?this._err(St.controlCharacterInInputStream):jZ(e)&&this._err(St.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var ar;(function(t){t[t.CHARACTER=0]="CHARACTER",t[t.NULL_CHARACTER=1]="NULL_CHARACTER",t[t.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",t[t.START_TAG=3]="START_TAG",t[t.END_TAG=4]="END_TAG",t[t.COMMENT=5]="COMMENT",t[t.DOCTYPE=6]="DOCTYPE",t[t.EOF=7]="EOF",t[t.HIBERNATION=8]="HIBERNATION"})(ar||(ar={}));function VZ(t,e){for(let n=t.attrs.length-1;n>=0;n--)if(t.attrs[n].name===e)return t.attrs[n].value;return null}const WZ=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),vIe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var vA;const xIe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),_Ie=(vA=String.fromCodePoint)!==null&&vA!==void 0?vA:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function bIe(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=xIe.get(t))!==null&&e!==void 0?e:t}var Ss;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(Ss||(Ss={}));const EIe=32;var nf;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(nf||(nf={}));function GM(t){return t>=Ss.ZERO&&t<=Ss.NINE}function wIe(t){return t>=Ss.UPPER_A&&t<=Ss.UPPER_F||t>=Ss.LOWER_A&&t<=Ss.LOWER_F}function SIe(t){return t>=Ss.UPPER_A&&t<=Ss.UPPER_Z||t>=Ss.LOWER_A&&t<=Ss.LOWER_Z||GM(t)}function TIe(t){return t===Ss.EQUALS||SIe(t)}var _s;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(_s||(_s={}));var Xc;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(Xc||(Xc={}));class $Z{constructor(e,n,r){this.decodeTree=e,this.emitCodePoint=n,this.errors=r,this.state=_s.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Xc.Strict}startEntity(e){this.decodeMode=e,this.state=_s.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case _s.EntityStart:return e.charCodeAt(n)===Ss.NUM?(this.state=_s.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=_s.NamedEntity,this.stateNamedEntity(e,n));case _s.NumericStart:return this.stateNumericStart(e,n);case _s.NumericDecimal:return this.stateNumericDecimal(e,n);case _s.NumericHex:return this.stateNumericHex(e,n);case _s.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|EIe)===Ss.LOWER_X?(this.state=_s.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=_s.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,r,i){if(n!==r){const s=r-n;this.result=this.result*Math.pow(i,s)+parseInt(e.substr(n,s),i),this.consumed+=s}}stateNumericHex(e,n){const r=n;for(;n<e.length;){const i=e.charCodeAt(n);if(GM(i)||wIe(i))n+=1;else return this.addToNumericResult(e,r,n,16),this.emitNumericEntity(i,3)}return this.addToNumericResult(e,r,n,16),-1}stateNumericDecimal(e,n){const r=n;for(;n<e.length;){const i=e.charCodeAt(n);if(GM(i))n+=1;else return this.addToNumericResult(e,r,n,10),this.emitNumericEntity(i,2)}return this.addToNumericResult(e,r,n,10),-1}emitNumericEntity(e,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Ss.SEMI)this.consumed+=1;else if(this.decodeMode===Xc.Strict)return 0;return this.emitCodePoint(bIe(this.result),this.consumed),this.errors&&(e!==Ss.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:r}=this;let i=r[this.treeIndex],s=(i&nf.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const o=e.charCodeAt(n);if(this.treeIndex=AIe(r,i,this.treeIndex+Math.max(1,s),o),this.treeIndex<0)return this.result===0||this.decodeMode===Xc.Attribute&&(s===0||TIe(o))?0:this.emitNotTerminatedNamedEntity();if(i=r[this.treeIndex],s=(i&nf.VALUE_LENGTH)>>14,s!==0){if(o===Ss.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Xc.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:r}=this,i=(r[n]&nf.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,i,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,r){const{decodeTree:i}=this;return this.emitCodePoint(n===1?i[e]&~nf.VALUE_LENGTH:i[e+1],r),n===3&&this.emitCodePoint(i[e+2],r),r}end(){var e;switch(this.state){case _s.NamedEntity:return this.result!==0&&(this.decodeMode!==Xc.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case _s.NumericDecimal:return this.emitNumericEntity(0,2);case _s.NumericHex:return this.emitNumericEntity(0,3);case _s.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case _s.EntityStart:return 0}}}function XZ(t){let e="";const n=new $Z(t,r=>e+=_Ie(r));return function(r,i){let s=0,o=0;for(;(o=r.indexOf("&",o))>=0;){e+=r.slice(s,o),n.startEntity(i);const l=n.write(r,o+1);if(l<0){s=o+n.end();break}s=o+l,o=l===0?s+1:s}const a=e+r.slice(s);return e="",a}}function AIe(t,e,n,r){const i=(e&nf.BRANCH_LENGTH)>>7,s=e&nf.JUMP_TABLE;if(i===0)return s!==0&&r===s?n:-1;if(s){const l=r-s;return l<0||l>=i?-1:t[n+l]-1}let o=n,a=o+i-1;for(;o<=a;){const l=o+a>>>1,c=t[l];if(c<r)o=l+1;else if(c>r)a=l-1;else return t[l+i]}return-1}XZ(WZ);XZ(vIe);var Lt;(function(t){t.HTML="http://www.w3.org/1999/xhtml",t.MATHML="http://www.w3.org/1998/Math/MathML",t.SVG="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.XML="http://www.w3.org/XML/1998/namespace",t.XMLNS="http://www.w3.org/2000/xmlns/"})(Lt||(Lt={}));var Fd;(function(t){t.TYPE="type",t.ACTION="action",t.ENCODING="encoding",t.PROMPT="prompt",t.NAME="name",t.COLOR="color",t.FACE="face",t.SIZE="size"})(Fd||(Fd={}));var Fa;(function(t){t.NO_QUIRKS="no-quirks",t.QUIRKS="quirks",t.LIMITED_QUIRKS="limited-quirks"})(Fa||(Fa={}));var ot;(function(t){t.A="a",t.ADDRESS="address",t.ANNOTATION_XML="annotation-xml",t.APPLET="applet",t.AREA="area",t.ARTICLE="article",t.ASIDE="aside",t.B="b",t.BASE="base",t.BASEFONT="basefont",t.BGSOUND="bgsound",t.BIG="big",t.BLOCKQUOTE="blockquote",t.BODY="body",t.BR="br",t.BUTTON="button",t.CAPTION="caption",t.CENTER="center",t.CODE="code",t.COL="col",t.COLGROUP="colgroup",t.DD="dd",t.DESC="desc",t.DETAILS="details",t.DIALOG="dialog",t.DIR="dir",t.DIV="div",t.DL="dl",t.DT="dt",t.EM="em",t.EMBED="embed",t.FIELDSET="fieldset",t.FIGCAPTION="figcaption",t.FIGURE="figure",t.FONT="font",t.FOOTER="footer",t.FOREIGN_OBJECT="foreignObject",t.FORM="form",t.FRAME="frame",t.FRAMESET="frameset",t.H1="h1",t.H2="h2",t.H3="h3",t.H4="h4",t.H5="h5",t.H6="h6",t.HEAD="head",t.HEADER="header",t.HGROUP="hgroup",t.HR="hr",t.HTML="html",t.I="i",t.IMG="img",t.IMAGE="image",t.INPUT="input",t.IFRAME="iframe",t.KEYGEN="keygen",t.LABEL="label",t.LI="li",t.LINK="link",t.LISTING="listing",t.MAIN="main",t.MALIGNMARK="malignmark",t.MARQUEE="marquee",t.MATH="math",t.MENU="menu",t.META="meta",t.MGLYPH="mglyph",t.MI="mi",t.MO="mo",t.MN="mn",t.MS="ms",t.MTEXT="mtext",t.NAV="nav",t.NOBR="nobr",t.NOFRAMES="noframes",t.NOEMBED="noembed",t.NOSCRIPT="noscript",t.OBJECT="object",t.OL="ol",t.OPTGROUP="optgroup",t.OPTION="option",t.P="p",t.PARAM="param",t.PLAINTEXT="plaintext",t.PRE="pre",t.RB="rb",t.RP="rp",t.RT="rt",t.RTC="rtc",t.RUBY="ruby",t.S="s",t.SCRIPT="script",t.SEARCH="search",t.SECTION="section",t.SELECT="select",t.SOURCE="source",t.SMALL="small",t.SPAN="span",t.STRIKE="strike",t.STRONG="strong",t.STYLE="style",t.SUB="sub",t.SUMMARY="summary",t.SUP="sup",t.TABLE="table",t.TBODY="tbody",t.TEMPLATE="template",t.TEXTAREA="textarea",t.TFOOT="tfoot",t.TD="td",t.TH="th",t.THEAD="thead",t.TITLE="title",t.TR="tr",t.TRACK="track",t.TT="tt",t.U="u",t.UL="ul",t.SVG="svg",t.VAR="var",t.WBR="wbr",t.XMP="xmp"})(ot||(ot={}));var G;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.A=1]="A",t[t.ADDRESS=2]="ADDRESS",t[t.ANNOTATION_XML=3]="ANNOTATION_XML",t[t.APPLET=4]="APPLET",t[t.AREA=5]="AREA",t[t.ARTICLE=6]="ARTICLE",t[t.ASIDE=7]="ASIDE",t[t.B=8]="B",t[t.BASE=9]="BASE",t[t.BASEFONT=10]="BASEFONT",t[t.BGSOUND=11]="BGSOUND",t[t.BIG=12]="BIG",t[t.BLOCKQUOTE=13]="BLOCKQUOTE",t[t.BODY=14]="BODY",t[t.BR=15]="BR",t[t.BUTTON=16]="BUTTON",t[t.CAPTION=17]="CAPTION",t[t.CENTER=18]="CENTER",t[t.CODE=19]="CODE",t[t.COL=20]="COL",t[t.COLGROUP=21]="COLGROUP",t[t.DD=22]="DD",t[t.DESC=23]="DESC",t[t.DETAILS=24]="DETAILS",t[t.DIALOG=25]="DIALOG",t[t.DIR=26]="DIR",t[t.DIV=27]="DIV",t[t.DL=28]="DL",t[t.DT=29]="DT",t[t.EM=30]="EM",t[t.EMBED=31]="EMBED",t[t.FIELDSET=32]="FIELDSET",t[t.FIGCAPTION=33]="FIGCAPTION",t[t.FIGURE=34]="FIGURE",t[t.FONT=35]="FONT",t[t.FOOTER=36]="FOOTER",t[t.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",t[t.FORM=38]="FORM",t[t.FRAME=39]="FRAME",t[t.FRAMESET=40]="FRAMESET",t[t.H1=41]="H1",t[t.H2=42]="H2",t[t.H3=43]="H3",t[t.H4=44]="H4",t[t.H5=45]="H5",t[t.H6=46]="H6",t[t.HEAD=47]="HEAD",t[t.HEADER=48]="HEADER",t[t.HGROUP=49]="HGROUP",t[t.HR=50]="HR",t[t.HTML=51]="HTML",t[t.I=52]="I",t[t.IMG=53]="IMG",t[t.IMAGE=54]="IMAGE",t[t.INPUT=55]="INPUT",t[t.IFRAME=56]="IFRAME",t[t.KEYGEN=57]="KEYGEN",t[t.LABEL=58]="LABEL",t[t.LI=59]="LI",t[t.LINK=60]="LINK",t[t.LISTING=61]="LISTING",t[t.MAIN=62]="MAIN",t[t.MALIGNMARK=63]="MALIGNMARK",t[t.MARQUEE=64]="MARQUEE",t[t.MATH=65]="MATH",t[t.MENU=66]="MENU",t[t.META=67]="META",t[t.MGLYPH=68]="MGLYPH",t[t.MI=69]="MI",t[t.MO=70]="MO",t[t.MN=71]="MN",t[t.MS=72]="MS",t[t.MTEXT=73]="MTEXT",t[t.NAV=74]="NAV",t[t.NOBR=75]="NOBR",t[t.NOFRAMES=76]="NOFRAMES",t[t.NOEMBED=77]="NOEMBED",t[t.NOSCRIPT=78]="NOSCRIPT",t[t.OBJECT=79]="OBJECT",t[t.OL=80]="OL",t[t.OPTGROUP=81]="OPTGROUP",t[t.OPTION=82]="OPTION",t[t.P=83]="P",t[t.PARAM=84]="PARAM",t[t.PLAINTEXT=85]="PLAINTEXT",t[t.PRE=86]="PRE",t[t.RB=87]="RB",t[t.RP=88]="RP",t[t.RT=89]="RT",t[t.RTC=90]="RTC",t[t.RUBY=91]="RUBY",t[t.S=92]="S",t[t.SCRIPT=93]="SCRIPT",t[t.SEARCH=94]="SEARCH",t[t.SECTION=95]="SECTION",t[t.SELECT=96]="SELECT",t[t.SOURCE=97]="SOURCE",t[t.SMALL=98]="SMALL",t[t.SPAN=99]="SPAN",t[t.STRIKE=100]="STRIKE",t[t.STRONG=101]="STRONG",t[t.STYLE=102]="STYLE",t[t.SUB=103]="SUB",t[t.SUMMARY=104]="SUMMARY",t[t.SUP=105]="SUP",t[t.TABLE=106]="TABLE",t[t.TBODY=107]="TBODY",t[t.TEMPLATE=108]="TEMPLATE",t[t.TEXTAREA=109]="TEXTAREA",t[t.TFOOT=110]="TFOOT",t[t.TD=111]="TD",t[t.TH=112]="TH",t[t.THEAD=113]="THEAD",t[t.TITLE=114]="TITLE",t[t.TR=115]="TR",t[t.TRACK=116]="TRACK",t[t.TT=117]="TT",t[t.U=118]="U",t[t.UL=119]="UL",t[t.SVG=120]="SVG",t[t.VAR=121]="VAR",t[t.WBR=122]="WBR",t[t.XMP=123]="XMP"})(G||(G={}));const MIe=new Map([[ot.A,G.A],[ot.ADDRESS,G.ADDRESS],[ot.ANNOTATION_XML,G.ANNOTATION_XML],[ot.APPLET,G.APPLET],[ot.AREA,G.AREA],[ot.ARTICLE,G.ARTICLE],[ot.ASIDE,G.ASIDE],[ot.B,G.B],[ot.BASE,G.BASE],[ot.BASEFONT,G.BASEFONT],[ot.BGSOUND,G.BGSOUND],[ot.BIG,G.BIG],[ot.BLOCKQUOTE,G.BLOCKQUOTE],[ot.BODY,G.BODY],[ot.BR,G.BR],[ot.BUTTON,G.BUTTON],[ot.CAPTION,G.CAPTION],[ot.CENTER,G.CENTER],[ot.CODE,G.CODE],[ot.COL,G.COL],[ot.COLGROUP,G.COLGROUP],[ot.DD,G.DD],[ot.DESC,G.DESC],[ot.DETAILS,G.DETAILS],[ot.DIALOG,G.DIALOG],[ot.DIR,G.DIR],[ot.DIV,G.DIV],[ot.DL,G.DL],[ot.DT,G.DT],[ot.EM,G.EM],[ot.EMBED,G.EMBED],[ot.FIELDSET,G.FIELDSET],[ot.FIGCAPTION,G.FIGCAPTION],[ot.FIGURE,G.FIGURE],[ot.FONT,G.FONT],[ot.FOOTER,G.FOOTER],[ot.FOREIGN_OBJECT,G.FOREIGN_OBJECT],[ot.FORM,G.FORM],[ot.FRAME,G.FRAME],[ot.FRAMESET,G.FRAMESET],[ot.H1,G.H1],[ot.H2,G.H2],[ot.H3,G.H3],[ot.H4,G.H4],[ot.H5,G.H5],[ot.H6,G.H6],[ot.HEAD,G.HEAD],[ot.HEADER,G.HEADER],[ot.HGROUP,G.HGROUP],[ot.HR,G.HR],[ot.HTML,G.HTML],[ot.I,G.I],[ot.IMG,G.IMG],[ot.IMAGE,G.IMAGE],[ot.INPUT,G.INPUT],[ot.IFRAME,G.IFRAME],[ot.KEYGEN,G.KEYGEN],[ot.LABEL,G.LABEL],[ot.LI,G.LI],[ot.LINK,G.LINK],[ot.LISTING,G.LISTING],[ot.MAIN,G.MAIN],[ot.MALIGNMARK,G.MALIGNMARK],[ot.MARQUEE,G.MARQUEE],[ot.MATH,G.MATH],[ot.MENU,G.MENU],[ot.META,G.META],[ot.MGLYPH,G.MGLYPH],[ot.MI,G.MI],[ot.MO,G.MO],[ot.MN,G.MN],[ot.MS,G.MS],[ot.MTEXT,G.MTEXT],[ot.NAV,G.NAV],[ot.NOBR,G.NOBR],[ot.NOFRAMES,G.NOFRAMES],[ot.NOEMBED,G.NOEMBED],[ot.NOSCRIPT,G.NOSCRIPT],[ot.OBJECT,G.OBJECT],[ot.OL,G.OL],[ot.OPTGROUP,G.OPTGROUP],[ot.OPTION,G.OPTION],[ot.P,G.P],[ot.PARAM,G.PARAM],[ot.PLAINTEXT,G.PLAINTEXT],[ot.PRE,G.PRE],[ot.RB,G.RB],[ot.RP,G.RP],[ot.RT,G.RT],[ot.RTC,G.RTC],[ot.RUBY,G.RUBY],[ot.S,G.S],[ot.SCRIPT,G.SCRIPT],[ot.SEARCH,G.SEARCH],[ot.SECTION,G.SECTION],[ot.SELECT,G.SELECT],[ot.SOURCE,G.SOURCE],[ot.SMALL,G.SMALL],[ot.SPAN,G.SPAN],[ot.STRIKE,G.STRIKE],[ot.STRONG,G.STRONG],[ot.STYLE,G.STYLE],[ot.SUB,G.SUB],[ot.SUMMARY,G.SUMMARY],[ot.SUP,G.SUP],[ot.TABLE,G.TABLE],[ot.TBODY,G.TBODY],[ot.TEMPLATE,G.TEMPLATE],[ot.TEXTAREA,G.TEXTAREA],[ot.TFOOT,G.TFOOT],[ot.TD,G.TD],[ot.TH,G.TH],[ot.THEAD,G.THEAD],[ot.TITLE,G.TITLE],[ot.TR,G.TR],[ot.TRACK,G.TRACK],[ot.TT,G.TT],[ot.U,G.U],[ot.UL,G.UL],[ot.SVG,G.SVG],[ot.VAR,G.VAR],[ot.WBR,G.WBR],[ot.XMP,G.XMP]]);function c0(t){var e;return(e=MIe.get(t))!==null&&e!==void 0?e:G.UNKNOWN}const Ut=G,CIe={[Lt.HTML]:new Set([Ut.ADDRESS,Ut.APPLET,Ut.AREA,Ut.ARTICLE,Ut.ASIDE,Ut.BASE,Ut.BASEFONT,Ut.BGSOUND,Ut.BLOCKQUOTE,Ut.BODY,Ut.BR,Ut.BUTTON,Ut.CAPTION,Ut.CENTER,Ut.COL,Ut.COLGROUP,Ut.DD,Ut.DETAILS,Ut.DIR,Ut.DIV,Ut.DL,Ut.DT,Ut.EMBED,Ut.FIELDSET,Ut.FIGCAPTION,Ut.FIGURE,Ut.FOOTER,Ut.FORM,Ut.FRAME,Ut.FRAMESET,Ut.H1,Ut.H2,Ut.H3,Ut.H4,Ut.H5,Ut.H6,Ut.HEAD,Ut.HEADER,Ut.HGROUP,Ut.HR,Ut.HTML,Ut.IFRAME,Ut.IMG,Ut.INPUT,Ut.LI,Ut.LINK,Ut.LISTING,Ut.MAIN,Ut.MARQUEE,Ut.MENU,Ut.META,Ut.NAV,Ut.NOEMBED,Ut.NOFRAMES,Ut.NOSCRIPT,Ut.OBJECT,Ut.OL,Ut.P,Ut.PARAM,Ut.PLAINTEXT,Ut.PRE,Ut.SCRIPT,Ut.SECTION,Ut.SELECT,Ut.SOURCE,Ut.STYLE,Ut.SUMMARY,Ut.TABLE,Ut.TBODY,Ut.TD,Ut.TEMPLATE,Ut.TEXTAREA,Ut.TFOOT,Ut.TH,Ut.THEAD,Ut.TITLE,Ut.TR,Ut.TRACK,Ut.UL,Ut.WBR,Ut.XMP]),[Lt.MATHML]:new Set([Ut.MI,Ut.MO,Ut.MN,Ut.MS,Ut.MTEXT,Ut.ANNOTATION_XML]),[Lt.SVG]:new Set([Ut.TITLE,Ut.FOREIGN_OBJECT,Ut.DESC]),[Lt.XLINK]:new Set,[Lt.XML]:new Set,[Lt.XMLNS]:new Set},jM=new Set([Ut.H1,Ut.H2,Ut.H3,Ut.H4,Ut.H5,Ut.H6]);ot.STYLE,ot.SCRIPT,ot.XMP,ot.IFRAME,ot.NOEMBED,ot.NOFRAMES,ot.PLAINTEXT;var Ne;(function(t){t[t.DATA=0]="DATA",t[t.RCDATA=1]="RCDATA",t[t.RAWTEXT=2]="RAWTEXT",t[t.SCRIPT_DATA=3]="SCRIPT_DATA",t[t.PLAINTEXT=4]="PLAINTEXT",t[t.TAG_OPEN=5]="TAG_OPEN",t[t.END_TAG_OPEN=6]="END_TAG_OPEN",t[t.TAG_NAME=7]="TAG_NAME",t[t.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",t[t.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",t[t.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",t[t.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",t[t.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",t[t.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",t[t.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",t[t.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",t[t.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",t[t.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",t[t.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",t[t.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",t[t.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",t[t.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",t[t.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",t[t.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",t[t.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",t[t.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",t[t.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",t[t.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",t[t.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",t[t.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",t[t.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",t[t.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",t[t.BOGUS_COMMENT=40]="BOGUS_COMMENT",t[t.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",t[t.COMMENT_START=42]="COMMENT_START",t[t.COMMENT_START_DASH=43]="COMMENT_START_DASH",t[t.COMMENT=44]="COMMENT",t[t.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",t[t.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",t[t.COMMENT_END_DASH=49]="COMMENT_END_DASH",t[t.COMMENT_END=50]="COMMENT_END",t[t.COMMENT_END_BANG=51]="COMMENT_END_BANG",t[t.DOCTYPE=52]="DOCTYPE",t[t.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",t[t.DOCTYPE_NAME=54]="DOCTYPE_NAME",t[t.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",t[t.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",t[t.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",t[t.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",t[t.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",t[t.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",t[t.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",t[t.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",t[t.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",t[t.CDATA_SECTION=68]="CDATA_SECTION",t[t.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",t[t.CDATA_SECTION_END=70]="CDATA_SECTION_END",t[t.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",t[t.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(Ne||(Ne={}));const Bi={DATA:Ne.DATA,RCDATA:Ne.RCDATA,RAWTEXT:Ne.RAWTEXT,SCRIPT_DATA:Ne.SCRIPT_DATA,PLAINTEXT:Ne.PLAINTEXT,CDATA_SECTION:Ne.CDATA_SECTION};function RIe(t){return t>=Ae.DIGIT_0&&t<=Ae.DIGIT_9}function r1(t){return t>=Ae.LATIN_CAPITAL_A&&t<=Ae.LATIN_CAPITAL_Z}function IIe(t){return t>=Ae.LATIN_SMALL_A&&t<=Ae.LATIN_SMALL_Z}function Vu(t){return IIe(t)||r1(t)}function CU(t){return Vu(t)||RIe(t)}function Zx(t){return t+32}function qZ(t){return t===Ae.SPACE||t===Ae.LINE_FEED||t===Ae.TABULATION||t===Ae.FORM_FEED}function RU(t){return qZ(t)||t===Ae.SOLIDUS||t===Ae.GREATER_THAN_SIGN}function PIe(t){return t===Ae.NULL?St.nullCharacterReference:t>1114111?St.characterReferenceOutsideUnicodeRange:HZ(t)?St.surrogateCharacterReference:jZ(t)?St.noncharacterCharacterReference:GZ(t)||t===Ae.CARRIAGE_RETURN?St.controlCharacterReference:null}class kIe{constructor(e,n){this.options=e,this.handler=n,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=Ne.DATA,this.returnState=Ne.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new yIe(n),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new $Z(WZ,(r,i)=>{this.preprocessor.pos=this.entityStartPos+i-1,this._flushCodePointConsumedAsCharacterReference(r)},n.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(St.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:r=>{this._err(St.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+r)},validateNumericCharacterReference:r=>{const i=PIe(r);i&&this._err(i,1)}}:void 0)}_err(e,n=0){var r,i;(i=(r=this.handler).onParseError)===null||i===void 0||i.call(r,this.preprocessor.getError(e,n))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e==null||e())}write(e,n,r){this.active=!0,this.preprocessor.write(e,n),this._runParsingLoop(),this.paused||r==null||r()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let n=0;n<e;n++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,n){return this.preprocessor.startsWith(e,n)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:ar.START_TAG,tagName:"",tagID:G.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:ar.END_TAG,tagName:"",tagID:G.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:ar.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:ar.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,n){this.currentCharacterToken={type:e,chars:n,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,n;const r=this.currentToken;if(VZ(r,this.currentAttr.name)===null){if(r.attrs.push(this.currentAttr),r.location&&this.currentLocation){const i=(e=(n=r.location).attrs)!==null&&e!==void 0?e:n.attrs=Object.create(null);i[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(St.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=c0(e.tagName),e.type===ar.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(St.endTagWithAttributes),e.selfClosing&&this._err(St.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case ar.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case ar.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case ar.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:ar.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,n){if(this.currentCharacterToken)if(this.currentCharacterToken.type===e){this.currentCharacterToken.chars+=n;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(e,n)}_emitCodePoint(e){const n=qZ(e)?ar.WHITESPACE_CHARACTER:e===Ae.NULL?ar.NULL_CHARACTER:ar.CHARACTER;this._appendCharToCurrentCharacterToken(n,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(ar.CHARACTER,e)}_startCharacterReference(){this.returnState=this.state,this.state=Ne.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?Xc.Attribute:Xc.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===Ne.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===Ne.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===Ne.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case Ne.DATA:{this._stateData(e);break}case Ne.RCDATA:{this._stateRcdata(e);break}case Ne.RAWTEXT:{this._stateRawtext(e);break}case Ne.SCRIPT_DATA:{this._stateScriptData(e);break}case Ne.PLAINTEXT:{this._statePlaintext(e);break}case Ne.TAG_OPEN:{this._stateTagOpen(e);break}case Ne.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case Ne.TAG_NAME:{this._stateTagName(e);break}case Ne.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case Ne.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case Ne.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case Ne.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case Ne.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case Ne.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case Ne.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case Ne.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case Ne.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case Ne.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case Ne.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case Ne.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case Ne.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case Ne.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case Ne.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case Ne.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case Ne.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case Ne.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case Ne.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case Ne.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case Ne.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case Ne.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case Ne.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case Ne.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case Ne.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case Ne.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case Ne.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case Ne.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case Ne.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case Ne.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case Ne.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case Ne.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case Ne.BOGUS_COMMENT:{this._stateBogusComment(e);break}case Ne.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case Ne.COMMENT_START:{this._stateCommentStart(e);break}case Ne.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case Ne.COMMENT:{this._stateComment(e);break}case Ne.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case Ne.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case Ne.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case Ne.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case Ne.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case Ne.COMMENT_END:{this._stateCommentEnd(e);break}case Ne.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case Ne.DOCTYPE:{this._stateDoctype(e);break}case Ne.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case Ne.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case Ne.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case Ne.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case Ne.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case Ne.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case Ne.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case Ne.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case Ne.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case Ne.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case Ne.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case Ne.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case Ne.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case Ne.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case Ne.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case Ne.CDATA_SECTION:{this._stateCdataSection(e);break}case Ne.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case Ne.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case Ne.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case Ne.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case Ae.LESS_THAN_SIGN:{this.state=Ne.TAG_OPEN;break}case Ae.AMPERSAND:{this._startCharacterReference();break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._emitCodePoint(e);break}case Ae.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case Ae.AMPERSAND:{this._startCharacterReference();break}case Ae.LESS_THAN_SIGN:{this.state=Ne.RCDATA_LESS_THAN_SIGN;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._emitChars(fi);break}case Ae.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case Ae.LESS_THAN_SIGN:{this.state=Ne.RAWTEXT_LESS_THAN_SIGN;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._emitChars(fi);break}case Ae.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case Ae.LESS_THAN_SIGN:{this.state=Ne.SCRIPT_DATA_LESS_THAN_SIGN;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._emitChars(fi);break}case Ae.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._emitChars(fi);break}case Ae.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(Vu(e))this._createStartTagToken(),this.state=Ne.TAG_NAME,this._stateTagName(e);else switch(e){case Ae.EXCLAMATION_MARK:{this.state=Ne.MARKUP_DECLARATION_OPEN;break}case Ae.SOLIDUS:{this.state=Ne.END_TAG_OPEN;break}case Ae.QUESTION_MARK:{this._err(St.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=Ne.BOGUS_COMMENT,this._stateBogusComment(e);break}case Ae.EOF:{this._err(St.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(St.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=Ne.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(Vu(e))this._createEndTagToken(),this.state=Ne.TAG_NAME,this._stateTagName(e);else switch(e){case Ae.GREATER_THAN_SIGN:{this._err(St.missingEndTagName),this.state=Ne.DATA;break}case Ae.EOF:{this._err(St.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(St.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=Ne.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this.state=Ne.BEFORE_ATTRIBUTE_NAME;break}case Ae.SOLIDUS:{this.state=Ne.SELF_CLOSING_START_TAG;break}case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA,this.emitCurrentTagToken();break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.tagName+=fi;break}case Ae.EOF:{this._err(St.eofInTag),this._emitEOFToken();break}default:n.tagName+=String.fromCodePoint(r1(e)?Zx(e):e)}}_stateRcdataLessThanSign(e){e===Ae.SOLIDUS?this.state=Ne.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=Ne.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){Vu(e)?(this.state=Ne.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=Ne.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const n=this.currentToken;switch(n.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=Ne.BEFORE_ATTRIBUTE_NAME,!1;case Ae.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=Ne.SELF_CLOSING_START_TAG,!1;case Ae.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=Ne.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=Ne.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===Ae.SOLIDUS?this.state=Ne.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=Ne.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){Vu(e)?(this.state=Ne.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=Ne.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=Ne.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case Ae.SOLIDUS:{this.state=Ne.SCRIPT_DATA_END_TAG_OPEN;break}case Ae.EXCLAMATION_MARK:{this.state=Ne.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=Ne.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){Vu(e)?(this.state=Ne.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=Ne.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=Ne.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===Ae.HYPHEN_MINUS?(this.state=Ne.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=Ne.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===Ae.HYPHEN_MINUS?(this.state=Ne.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=Ne.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case Ae.LESS_THAN_SIGN:{this.state=Ne.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._emitChars(fi);break}case Ae.EOF:{this._err(St.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case Ae.LESS_THAN_SIGN:{this.state=Ne.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.state=Ne.SCRIPT_DATA_ESCAPED,this._emitChars(fi);break}case Ae.EOF:{this._err(St.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=Ne.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case Ae.HYPHEN_MINUS:{this._emitChars("-");break}case Ae.LESS_THAN_SIGN:{this.state=Ne.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case Ae.GREATER_THAN_SIGN:{this.state=Ne.SCRIPT_DATA,this._emitChars(">");break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.state=Ne.SCRIPT_DATA_ESCAPED,this._emitChars(fi);break}case Ae.EOF:{this._err(St.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=Ne.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===Ae.SOLIDUS?this.state=Ne.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:Vu(e)?(this._emitChars("<"),this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=Ne.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){Vu(e)?(this.state=Ne.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=Ne.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=Ne.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(Fo.SCRIPT,!1)&&RU(this.preprocessor.peek(Fo.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<Fo.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=Ne.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case Ae.LESS_THAN_SIGN:{this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._emitChars(fi);break}case Ae.EOF:{this._err(St.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case Ae.LESS_THAN_SIGN:{this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(fi);break}case Ae.EOF:{this._err(St.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case Ae.HYPHEN_MINUS:{this._emitChars("-");break}case Ae.LESS_THAN_SIGN:{this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case Ae.GREATER_THAN_SIGN:{this.state=Ne.SCRIPT_DATA,this._emitChars(">");break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(fi);break}case Ae.EOF:{this._err(St.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===Ae.SOLIDUS?(this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(Fo.SCRIPT,!1)&&RU(this.preprocessor.peek(Fo.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<Fo.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=Ne.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=Ne.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.SOLIDUS:case Ae.GREATER_THAN_SIGN:case Ae.EOF:{this.state=Ne.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case Ae.EQUALS_SIGN:{this._err(St.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=Ne.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=Ne.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:case Ae.SOLIDUS:case Ae.GREATER_THAN_SIGN:case Ae.EOF:{this._leaveAttrName(),this.state=Ne.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case Ae.EQUALS_SIGN:{this._leaveAttrName(),this.state=Ne.BEFORE_ATTRIBUTE_VALUE;break}case Ae.QUOTATION_MARK:case Ae.APOSTROPHE:case Ae.LESS_THAN_SIGN:{this._err(St.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.currentAttr.name+=fi;break}default:this.currentAttr.name+=String.fromCodePoint(r1(e)?Zx(e):e)}}_stateAfterAttributeName(e){switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.SOLIDUS:{this.state=Ne.SELF_CLOSING_START_TAG;break}case Ae.EQUALS_SIGN:{this.state=Ne.BEFORE_ATTRIBUTE_VALUE;break}case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA,this.emitCurrentTagToken();break}case Ae.EOF:{this._err(St.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=Ne.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.QUOTATION_MARK:{this.state=Ne.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case Ae.APOSTROPHE:{this.state=Ne.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case Ae.GREATER_THAN_SIGN:{this._err(St.missingAttributeValue),this.state=Ne.DATA,this.emitCurrentTagToken();break}default:this.state=Ne.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case Ae.QUOTATION_MARK:{this.state=Ne.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case Ae.AMPERSAND:{this._startCharacterReference();break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.currentAttr.value+=fi;break}case Ae.EOF:{this._err(St.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case Ae.APOSTROPHE:{this.state=Ne.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case Ae.AMPERSAND:{this._startCharacterReference();break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.currentAttr.value+=fi;break}case Ae.EOF:{this._err(St.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this._leaveAttrValue(),this.state=Ne.BEFORE_ATTRIBUTE_NAME;break}case Ae.AMPERSAND:{this._startCharacterReference();break}case Ae.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=Ne.DATA,this.emitCurrentTagToken();break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),this.currentAttr.value+=fi;break}case Ae.QUOTATION_MARK:case Ae.APOSTROPHE:case Ae.LESS_THAN_SIGN:case Ae.EQUALS_SIGN:case Ae.GRAVE_ACCENT:{this._err(St.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case Ae.EOF:{this._err(St.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this._leaveAttrValue(),this.state=Ne.BEFORE_ATTRIBUTE_NAME;break}case Ae.SOLIDUS:{this._leaveAttrValue(),this.state=Ne.SELF_CLOSING_START_TAG;break}case Ae.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=Ne.DATA,this.emitCurrentTagToken();break}case Ae.EOF:{this._err(St.eofInTag),this._emitEOFToken();break}default:this._err(St.missingWhitespaceBetweenAttributes),this.state=Ne.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case Ae.GREATER_THAN_SIGN:{const n=this.currentToken;n.selfClosing=!0,this.state=Ne.DATA,this.emitCurrentTagToken();break}case Ae.EOF:{this._err(St.eofInTag),this._emitEOFToken();break}default:this._err(St.unexpectedSolidusInTag),this.state=Ne.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const n=this.currentToken;switch(e){case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA,this.emitCurrentComment(n);break}case Ae.EOF:{this.emitCurrentComment(n),this._emitEOFToken();break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.data+=fi;break}default:n.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(Fo.DASH_DASH,!0)?(this._createCommentToken(Fo.DASH_DASH.length+1),this.state=Ne.COMMENT_START):this._consumeSequenceIfMatch(Fo.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Fo.DOCTYPE.length+1),this.state=Ne.DOCTYPE):this._consumeSequenceIfMatch(Fo.CDATA_START,!0)?this.inForeignNode?this.state=Ne.CDATA_SECTION:(this._err(St.cdataInHtmlContent),this._createCommentToken(Fo.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=Ne.BOGUS_COMMENT):this._ensureHibernation()||(this._err(St.incorrectlyOpenedComment),this._createCommentToken(2),this.state=Ne.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.COMMENT_START_DASH;break}case Ae.GREATER_THAN_SIGN:{this._err(St.abruptClosingOfEmptyComment),this.state=Ne.DATA;const n=this.currentToken;this.emitCurrentComment(n);break}default:this.state=Ne.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const n=this.currentToken;switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.COMMENT_END;break}case Ae.GREATER_THAN_SIGN:{this._err(St.abruptClosingOfEmptyComment),this.state=Ne.DATA,this.emitCurrentComment(n);break}case Ae.EOF:{this._err(St.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=Ne.COMMENT,this._stateComment(e)}}_stateComment(e){const n=this.currentToken;switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.COMMENT_END_DASH;break}case Ae.LESS_THAN_SIGN:{n.data+="<",this.state=Ne.COMMENT_LESS_THAN_SIGN;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.data+=fi;break}case Ae.EOF:{this._err(St.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const n=this.currentToken;switch(e){case Ae.EXCLAMATION_MARK:{n.data+="!",this.state=Ne.COMMENT_LESS_THAN_SIGN_BANG;break}case Ae.LESS_THAN_SIGN:{n.data+="<";break}default:this.state=Ne.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===Ae.HYPHEN_MINUS?this.state=Ne.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=Ne.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===Ae.HYPHEN_MINUS?this.state=Ne.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=Ne.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==Ae.GREATER_THAN_SIGN&&e!==Ae.EOF&&this._err(St.nestedComment),this.state=Ne.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const n=this.currentToken;switch(e){case Ae.HYPHEN_MINUS:{this.state=Ne.COMMENT_END;break}case Ae.EOF:{this._err(St.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=Ne.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const n=this.currentToken;switch(e){case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA,this.emitCurrentComment(n);break}case Ae.EXCLAMATION_MARK:{this.state=Ne.COMMENT_END_BANG;break}case Ae.HYPHEN_MINUS:{n.data+="-";break}case Ae.EOF:{this._err(St.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--",this.state=Ne.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const n=this.currentToken;switch(e){case Ae.HYPHEN_MINUS:{n.data+="--!",this.state=Ne.COMMENT_END_DASH;break}case Ae.GREATER_THAN_SIGN:{this._err(St.incorrectlyClosedComment),this.state=Ne.DATA,this.emitCurrentComment(n);break}case Ae.EOF:{this._err(St.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--!",this.state=Ne.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this.state=Ne.BEFORE_DOCTYPE_NAME;break}case Ae.GREATER_THAN_SIGN:{this.state=Ne.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case Ae.EOF:{this._err(St.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.missingWhitespaceBeforeDoctypeName),this.state=Ne.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(r1(e))this._createDoctypeToken(String.fromCharCode(Zx(e))),this.state=Ne.DOCTYPE_NAME;else switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.NULL:{this._err(St.unexpectedNullCharacter),this._createDoctypeToken(fi),this.state=Ne.DOCTYPE_NAME;break}case Ae.GREATER_THAN_SIGN:{this._err(St.missingDoctypeName),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.EOF:{this._err(St.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=Ne.DOCTYPE_NAME}}_stateDoctypeName(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this.state=Ne.AFTER_DOCTYPE_NAME;break}case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA,this.emitCurrentDoctype(n);break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.name+=fi;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.name+=String.fromCodePoint(r1(e)?Zx(e):e)}}_stateAfterDoctypeName(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA,this.emitCurrentDoctype(n);break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Fo.PUBLIC,!1)?this.state=Ne.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Fo.SYSTEM,!1)?this.state=Ne.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(St.invalidCharacterSequenceAfterDoctypeName),n.forceQuirks=!0,this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this.state=Ne.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case Ae.QUOTATION_MARK:{this._err(St.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=Ne.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case Ae.APOSTROPHE:{this._err(St.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=Ne.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case Ae.GREATER_THAN_SIGN:{this._err(St.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=Ne.DATA,this.emitCurrentDoctype(n);break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.QUOTATION_MARK:{n.publicId="",this.state=Ne.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case Ae.APOSTROPHE:{n.publicId="",this.state=Ne.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case Ae.GREATER_THAN_SIGN:{this._err(St.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=Ne.DATA,this.emitCurrentDoctype(n);break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const n=this.currentToken;switch(e){case Ae.QUOTATION_MARK:{this.state=Ne.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.publicId+=fi;break}case Ae.GREATER_THAN_SIGN:{this._err(St.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const n=this.currentToken;switch(e){case Ae.APOSTROPHE:{this.state=Ne.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.publicId+=fi;break}case Ae.GREATER_THAN_SIGN:{this._err(St.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this.state=Ne.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA,this.emitCurrentDoctype(n);break}case Ae.QUOTATION_MARK:{this._err(St.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Ae.APOSTROPHE:{this._err(St.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.QUOTATION_MARK:{n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Ae.APOSTROPHE:{n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:{this.state=Ne.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case Ae.QUOTATION_MARK:{this._err(St.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Ae.APOSTROPHE:{this._err(St.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Ae.GREATER_THAN_SIGN:{this._err(St.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=Ne.DATA,this.emitCurrentDoctype(n);break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.QUOTATION_MARK:{n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case Ae.APOSTROPHE:{n.systemId="",this.state=Ne.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case Ae.GREATER_THAN_SIGN:{this._err(St.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=Ne.DATA,this.emitCurrentDoctype(n);break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const n=this.currentToken;switch(e){case Ae.QUOTATION_MARK:{this.state=Ne.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.systemId+=fi;break}case Ae.GREATER_THAN_SIGN:{this._err(St.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const n=this.currentToken;switch(e){case Ae.APOSTROPHE:{this.state=Ne.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter),n.systemId+=fi;break}case Ae.GREATER_THAN_SIGN:{this._err(St.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const n=this.currentToken;switch(e){case Ae.SPACE:case Ae.LINE_FEED:case Ae.TABULATION:case Ae.FORM_FEED:break;case Ae.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.EOF:{this._err(St.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(St.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=Ne.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const n=this.currentToken;switch(e){case Ae.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=Ne.DATA;break}case Ae.NULL:{this._err(St.unexpectedNullCharacter);break}case Ae.EOF:{this.emitCurrentDoctype(n),this._emitEOFToken();break}}}_stateCdataSection(e){switch(e){case Ae.RIGHT_SQUARE_BRACKET:{this.state=Ne.CDATA_SECTION_BRACKET;break}case Ae.EOF:{this._err(St.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===Ae.RIGHT_SQUARE_BRACKET?this.state=Ne.CDATA_SECTION_END:(this._emitChars("]"),this.state=Ne.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case Ae.GREATER_THAN_SIGN:{this.state=Ne.DATA;break}case Ae.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=Ne.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(){let e=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(e<0)if(this.preprocessor.lastChunkWritten)e=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}e===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(Ae.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&CU(this.preprocessor.peek(1))?Ne.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(e){CU(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===Ae.SEMICOLON&&this._err(St.unknownNamedCharacterReference),this.state=this.returnState,this._callState(e))}}const YZ=new Set([G.DD,G.DT,G.LI,G.OPTGROUP,G.OPTION,G.P,G.RB,G.RP,G.RT,G.RTC]),IU=new Set([...YZ,G.CAPTION,G.COLGROUP,G.TBODY,G.TD,G.TFOOT,G.TH,G.THEAD,G.TR]),ub=new Set([G.APPLET,G.CAPTION,G.HTML,G.MARQUEE,G.OBJECT,G.TABLE,G.TD,G.TEMPLATE,G.TH]),LIe=new Set([...ub,G.OL,G.UL]),DIe=new Set([...ub,G.BUTTON]),PU=new Set([G.ANNOTATION_XML,G.MI,G.MN,G.MO,G.MS,G.MTEXT]),kU=new Set([G.DESC,G.FOREIGN_OBJECT,G.TITLE]),NIe=new Set([G.TR,G.TEMPLATE,G.HTML]),OIe=new Set([G.TBODY,G.TFOOT,G.THEAD,G.TEMPLATE,G.HTML]),FIe=new Set([G.TABLE,G.TEMPLATE,G.HTML]),UIe=new Set([G.TD,G.TH]);class BIe{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,n,r){this.treeAdapter=n,this.handler=r,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=G.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===G.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===Lt.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,n){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=n,this.currentTagId=n,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,n,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,n){const r=this._indexOf(e);this.items[r]=n,r===this.stackTop&&(this.current=n)}insertAfter(e,n,r){const i=this._indexOf(e)+1;this.items.splice(i,0,n),this.tagIDs.splice(i,0,r),this.stackTop++,i===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,i===this.stackTop)}popUntilTagNamePopped(e){let n=this.stackTop+1;do n=this.tagIDs.lastIndexOf(e,n-1);while(n>0&&this.treeAdapter.getNamespaceURI(this.items[n])!==Lt.HTML);this.shortenToLength(n<0?0:n)}shortenToLength(e){for(;this.stackTop>=e;){const n=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(n,this.stackTop<e)}}popUntilElementPopped(e){const n=this._indexOf(e);this.shortenToLength(n<0?0:n)}popUntilPopped(e,n){const r=this._indexOfTagNames(e,n);this.shortenToLength(r<0?0:r)}popUntilNumberedHeaderPopped(){this.popUntilPopped(jM,Lt.HTML)}popUntilTableCellPopped(){this.popUntilPopped(UIe,Lt.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,n){for(let r=this.stackTop;r>=0;r--)if(e.has(this.tagIDs[r])&&this.treeAdapter.getNamespaceURI(this.items[r])===n)return r;return-1}clearBackTo(e,n){const r=this._indexOfTagNames(e,n);this.shortenToLength(r+1)}clearBackToTableContext(){this.clearBackTo(FIe,Lt.HTML)}clearBackToTableBodyContext(){this.clearBackTo(OIe,Lt.HTML)}clearBackToTableRowContext(){this.clearBackTo(NIe,Lt.HTML)}remove(e){const n=this._indexOf(e);n>=0&&(n===this.stackTop?this.pop():(this.items.splice(n,1),this.tagIDs.splice(n,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===G.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const n=this._indexOf(e)-1;return n>=0?this.items[n]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===G.HTML}hasInDynamicScope(e,n){for(let r=this.stackTop;r>=0;r--){const i=this.tagIDs[r];switch(this.treeAdapter.getNamespaceURI(this.items[r])){case Lt.HTML:{if(i===e)return!0;if(n.has(i))return!1;break}case Lt.SVG:{if(kU.has(i))return!1;break}case Lt.MATHML:{if(PU.has(i))return!1;break}}}return!0}hasInScope(e){return this.hasInDynamicScope(e,ub)}hasInListItemScope(e){return this.hasInDynamicScope(e,LIe)}hasInButtonScope(e){return this.hasInDynamicScope(e,DIe)}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const n=this.tagIDs[e];switch(this.treeAdapter.getNamespaceURI(this.items[e])){case Lt.HTML:{if(jM.has(n))return!0;if(ub.has(n))return!1;break}case Lt.SVG:{if(kU.has(n))return!1;break}case Lt.MATHML:{if(PU.has(n))return!1;break}}}return!0}hasInTableScope(e){for(let n=this.stackTop;n>=0;n--)if(this.treeAdapter.getNamespaceURI(this.items[n])===Lt.HTML)switch(this.tagIDs[n]){case e:return!0;case G.TABLE:case G.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--)if(this.treeAdapter.getNamespaceURI(this.items[e])===Lt.HTML)switch(this.tagIDs[e]){case G.TBODY:case G.THEAD:case G.TFOOT:return!0;case G.TABLE:case G.HTML:return!1}return!0}hasInSelectScope(e){for(let n=this.stackTop;n>=0;n--)if(this.treeAdapter.getNamespaceURI(this.items[n])===Lt.HTML)switch(this.tagIDs[n]){case e:return!0;case G.OPTION:case G.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;YZ.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;IU.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==e&&IU.has(this.currentTagId);)this.pop()}}const xA=3;var Xl;(function(t){t[t.Marker=0]="Marker",t[t.Element=1]="Element"})(Xl||(Xl={}));const LU={type:Xl.Marker};class zIe{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,n){const r=[],i=n.length,s=this.treeAdapter.getTagName(e),o=this.treeAdapter.getNamespaceURI(e);for(let a=0;a<this.entries.length;a++){const l=this.entries[a];if(l.type===Xl.Marker)break;const{element:c}=l;if(this.treeAdapter.getTagName(c)===s&&this.treeAdapter.getNamespaceURI(c)===o){const u=this.treeAdapter.getAttrList(c);u.length===i&&r.push({idx:a,attrs:u})}}return r}_ensureNoahArkCondition(e){if(this.entries.length<xA)return;const n=this.treeAdapter.getAttrList(e),r=this._getNoahArkConditionCandidates(e,n);if(r.length<xA)return;const i=new Map(n.map(o=>[o.name,o.value]));let s=0;for(let o=0;o<r.length;o++){const a=r[o];a.attrs.every(l=>i.get(l.name)===l.value)&&(s+=1,s>=xA&&this.entries.splice(a.idx,1))}}insertMarker(){this.entries.unshift(LU)}pushElement(e,n){this._ensureNoahArkCondition(e),this.entries.unshift({type:Xl.Element,element:e,token:n})}insertElementAfterBookmark(e,n){const r=this.entries.indexOf(this.bookmark);this.entries.splice(r,0,{type:Xl.Element,element:e,token:n})}removeEntry(e){const n=this.entries.indexOf(e);n>=0&&this.entries.splice(n,1)}clearToLastMarker(){const e=this.entries.indexOf(LU);e>=0?this.entries.splice(0,e+1):this.entries.length=0}getElementEntryInScopeWithTagName(e){const n=this.entries.find(r=>r.type===Xl.Marker||this.treeAdapter.getTagName(r.element)===e);return n&&n.type===Xl.Element?n:null}getElementEntry(e){return this.entries.find(n=>n.type===Xl.Element&&n.element===e)}}const Wu={createDocument(){return{nodeName:"#document",mode:Fa.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(t,e,n){return{nodeName:t,tagName:t,attrs:n,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(t){return{nodeName:"#comment",data:t,parentNode:null}},createTextNode(t){return{nodeName:"#text",value:t,parentNode:null}},appendChild(t,e){t.childNodes.push(e),e.parentNode=t},insertBefore(t,e,n){const r=t.childNodes.indexOf(n);t.childNodes.splice(r,0,e),e.parentNode=t},setTemplateContent(t,e){t.content=e},getTemplateContent(t){return t.content},setDocumentType(t,e,n,r){const i=t.childNodes.find(s=>s.nodeName==="#documentType");if(i)i.name=e,i.publicId=n,i.systemId=r;else{const s={nodeName:"#documentType",name:e,publicId:n,systemId:r,parentNode:null};Wu.appendChild(t,s)}},setDocumentMode(t,e){t.mode=e},getDocumentMode(t){return t.mode},detachNode(t){if(t.parentNode){const e=t.parentNode.childNodes.indexOf(t);t.parentNode.childNodes.splice(e,1),t.parentNode=null}},insertText(t,e){if(t.childNodes.length>0){const n=t.childNodes[t.childNodes.length-1];if(Wu.isTextNode(n)){n.value+=e;return}}Wu.appendChild(t,Wu.createTextNode(e))},insertTextBefore(t,e,n){const r=t.childNodes[t.childNodes.indexOf(n)-1];r&&Wu.isTextNode(r)?r.value+=e:Wu.insertBefore(t,Wu.createTextNode(e),n)},adoptAttributes(t,e){const n=new Set(t.attrs.map(r=>r.name));for(let r=0;r<e.length;r++)n.has(e[r].name)||t.attrs.push(e[r])},getFirstChild(t){return t.childNodes[0]},getChildNodes(t){return t.childNodes},getParentNode(t){return t.parentNode},getAttrList(t){return t.attrs},getTagName(t){return t.tagName},getNamespaceURI(t){return t.namespaceURI},getTextNodeContent(t){return t.value},getCommentNodeContent(t){return t.data},getDocumentTypeNodeName(t){return t.name},getDocumentTypeNodePublicId(t){return t.publicId},getDocumentTypeNodeSystemId(t){return t.systemId},isTextNode(t){return t.nodeName==="#text"},isCommentNode(t){return t.nodeName==="#comment"},isDocumentTypeNode(t){return t.nodeName==="#documentType"},isElementNode(t){return Object.prototype.hasOwnProperty.call(t,"tagName")},setNodeSourceCodeLocation(t,e){t.sourceCodeLocation=e},getNodeSourceCodeLocation(t){return t.sourceCodeLocation},updateNodeSourceCodeLocation(t,e){t.sourceCodeLocation={...t.sourceCodeLocation,...e}}},KZ="html",HIe="about:legacy-compat",GIe="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",ZZ=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],jIe=[...ZZ,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],VIe=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),QZ=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],WIe=[...QZ,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function DU(t,e){return e.some(n=>t.startsWith(n))}function $Ie(t){return t.name===KZ&&t.publicId===null&&(t.systemId===null||t.systemId===HIe)}function XIe(t){if(t.name!==KZ)return Fa.QUIRKS;const{systemId:e}=t;if(e&&e.toLowerCase()===GIe)return Fa.QUIRKS;let{publicId:n}=t;if(n!==null){if(n=n.toLowerCase(),VIe.has(n))return Fa.QUIRKS;let r=e===null?jIe:ZZ;if(DU(n,r))return Fa.QUIRKS;if(r=e===null?QZ:WIe,DU(n,r))return Fa.LIMITED_QUIRKS}return Fa.NO_QUIRKS}const NU={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},qIe="definitionurl",YIe="definitionURL",KIe=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),ZIe=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:Lt.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:Lt.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:Lt.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:Lt.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:Lt.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:Lt.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:Lt.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:Lt.XML}],["xml:space",{prefix:"xml",name:"space",namespace:Lt.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:Lt.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:Lt.XMLNS}]]),QIe=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),JIe=new Set([G.B,G.BIG,G.BLOCKQUOTE,G.BODY,G.BR,G.CENTER,G.CODE,G.DD,G.DIV,G.DL,G.DT,G.EM,G.EMBED,G.H1,G.H2,G.H3,G.H4,G.H5,G.H6,G.HEAD,G.HR,G.I,G.IMG,G.LI,G.LISTING,G.MENU,G.META,G.NOBR,G.OL,G.P,G.PRE,G.RUBY,G.S,G.SMALL,G.SPAN,G.STRONG,G.STRIKE,G.SUB,G.SUP,G.TABLE,G.TT,G.U,G.UL,G.VAR]);function ePe(t){const e=t.tagID;return e===G.FONT&&t.attrs.some(({name:n})=>n===Fd.COLOR||n===Fd.SIZE||n===Fd.FACE)||JIe.has(e)}function JZ(t){for(let e=0;e<t.attrs.length;e++)if(t.attrs[e].name===qIe){t.attrs[e].name=YIe;break}}function eQ(t){for(let e=0;e<t.attrs.length;e++){const n=KIe.get(t.attrs[e].name);n!=null&&(t.attrs[e].name=n)}}function OR(t){for(let e=0;e<t.attrs.length;e++){const n=ZIe.get(t.attrs[e].name);n&&(t.attrs[e].prefix=n.prefix,t.attrs[e].name=n.name,t.attrs[e].namespace=n.namespace)}}function tPe(t){const e=QIe.get(t.tagName);e!=null&&(t.tagName=e,t.tagID=c0(t.tagName))}function nPe(t,e){return e===Lt.MATHML&&(t===G.MI||t===G.MO||t===G.MN||t===G.MS||t===G.MTEXT)}function rPe(t,e,n){if(e===Lt.MATHML&&t===G.ANNOTATION_XML){for(let r=0;r<n.length;r++)if(n[r].name===Fd.ENCODING){const i=n[r].value.toLowerCase();return i===NU.TEXT_HTML||i===NU.APPLICATION_XML}}return e===Lt.SVG&&(t===G.FOREIGN_OBJECT||t===G.DESC||t===G.TITLE)}function iPe(t,e,n,r){return(!r||r===Lt.HTML)&&rPe(t,e,n)||(!r||r===Lt.MATHML)&&nPe(t,e)}const sPe="hidden",oPe=8,aPe=3;var We;(function(t){t[t.INITIAL=0]="INITIAL",t[t.BEFORE_HTML=1]="BEFORE_HTML",t[t.BEFORE_HEAD=2]="BEFORE_HEAD",t[t.IN_HEAD=3]="IN_HEAD",t[t.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",t[t.AFTER_HEAD=5]="AFTER_HEAD",t[t.IN_BODY=6]="IN_BODY",t[t.TEXT=7]="TEXT",t[t.IN_TABLE=8]="IN_TABLE",t[t.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",t[t.IN_CAPTION=10]="IN_CAPTION",t[t.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",t[t.IN_TABLE_BODY=12]="IN_TABLE_BODY",t[t.IN_ROW=13]="IN_ROW",t[t.IN_CELL=14]="IN_CELL",t[t.IN_SELECT=15]="IN_SELECT",t[t.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",t[t.IN_TEMPLATE=17]="IN_TEMPLATE",t[t.AFTER_BODY=18]="AFTER_BODY",t[t.IN_FRAMESET=19]="IN_FRAMESET",t[t.AFTER_FRAMESET=20]="AFTER_FRAMESET",t[t.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",t[t.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(We||(We={}));const lPe={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},tQ=new Set([G.TABLE,G.TBODY,G.TFOOT,G.THEAD,G.TR]),OU={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Wu,onParseError:null};class FU{constructor(e,n,r=null,i=null){this.fragmentContext=r,this.scriptHandler=i,this.currentToken=null,this.stopped=!1,this.insertionMode=We.INITIAL,this.originalInsertionMode=We.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...OU,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=n??this.treeAdapter.createDocument(),this.tokenizer=new kIe(this.options,this),this.activeFormattingElements=new zIe(this.treeAdapter),this.fragmentContextID=r?c0(this.treeAdapter.getTagName(r)):G.UNKNOWN,this._setContextModes(r??this.document,this.fragmentContextID),this.openElements=new BIe(this.document,this.treeAdapter,this)}static parse(e,n){const r=new this(n);return r.tokenizer.write(e,!0),r.document}static getFragmentParser(e,n){const r={...OU,...n};e??(e=r.treeAdapter.createElement(ot.TEMPLATE,Lt.HTML,[]));const i=r.treeAdapter.createElement("documentmock",Lt.HTML,[]),s=new this(r,i,e);return s.fragmentContextID===G.TEMPLATE&&s.tmplInsertionModeStack.unshift(We.IN_TEMPLATE),s._initTokenizerForFragmentParsing(),s._insertFakeRootElement(),s._resetInsertionMode(),s._findFormInFragmentContext(),s}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),n=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,n),n}_err(e,n,r){var i;if(!this.onParseError)return;const s=(i=e.location)!==null&&i!==void 0?i:lPe,o={code:n,startLine:s.startLine,startCol:s.startCol,startOffset:s.startOffset,endLine:r?s.startLine:s.endLine,endCol:r?s.startCol:s.endCol,endOffset:r?s.startOffset:s.endOffset};this.onParseError(o)}onItemPush(e,n,r){var i,s;(s=(i=this.treeAdapter).onItemPush)===null||s===void 0||s.call(i,e),r&&this.openElements.stackTop>0&&this._setContextModes(e,n)}onItemPop(e,n){var r,i;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(i=(r=this.treeAdapter).onItemPop)===null||i===void 0||i.call(r,e,this.openElements.current),n){let s,o;this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,o=this.fragmentContextID):{current:s,currentTagId:o}=this.openElements,this._setContextModes(s,o)}}_setContextModes(e,n){const r=e===this.document||this.treeAdapter.getNamespaceURI(e)===Lt.HTML;this.currentNotInHTML=!r,this.tokenizer.inForeignNode=!r&&!this._isIntegrationPoint(n,e)}_switchToTextParsing(e,n){this._insertElement(e,Lt.HTML),this.tokenizer.state=n,this.originalInsertionMode=this.insertionMode,this.insertionMode=We.TEXT}switchToPlaintextParsing(){this.insertionMode=We.TEXT,this.originalInsertionMode=We.IN_BODY,this.tokenizer.state=Bi.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===ot.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==Lt.HTML))switch(this.fragmentContextID){case G.TITLE:case G.TEXTAREA:{this.tokenizer.state=Bi.RCDATA;break}case G.STYLE:case G.XMP:case G.IFRAME:case G.NOEMBED:case G.NOFRAMES:case G.NOSCRIPT:{this.tokenizer.state=Bi.RAWTEXT;break}case G.SCRIPT:{this.tokenizer.state=Bi.SCRIPT_DATA;break}case G.PLAINTEXT:{this.tokenizer.state=Bi.PLAINTEXT;break}}}_setDocumentType(e){const n=e.name||"",r=e.publicId||"",i=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,n,r,i),e.location){const s=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));s&&this.treeAdapter.setNodeSourceCodeLocation(s,e.location)}}_attachElementToTree(e,n){if(this.options.sourceCodeLocationInfo){const r=n&&{...n,startTag:n};this.treeAdapter.setNodeSourceCodeLocation(e,r)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const r=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(r,e)}}_appendElement(e,n){const r=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(r,e.location)}_insertElement(e,n){const r=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(r,e.location),this.openElements.push(r,e.tagID)}_insertFakeElement(e,n){const r=this.treeAdapter.createElement(e,Lt.HTML,[]);this._attachElementToTree(r,null),this.openElements.push(r,n)}_insertTemplate(e){const n=this.treeAdapter.createElement(e.tagName,Lt.HTML,e.attrs),r=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(n,r),this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(r,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(ot.HTML,Lt.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,G.HTML)}_appendCommentNode(e,n){const r=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(n,r),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(r,e.location)}_insertCharacters(e){let n,r;if(this._shouldFosterParentOnInsertion()?({parent:n,beforeElement:r}=this._findFosterParentingLocation(),r?this.treeAdapter.insertTextBefore(n,e.chars,r):this.treeAdapter.insertText(n,e.chars)):(n=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(n,e.chars)),!e.location)return;const i=this.treeAdapter.getChildNodes(n),s=r?i.lastIndexOf(r):i.length,o=i[s-1];if(this.treeAdapter.getNodeSourceCodeLocation(o)){const{endLine:a,endCol:l,endOffset:c}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(o,{endLine:a,endCol:l,endOffset:c})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}_adoptNodes(e,n){for(let r=this.treeAdapter.getFirstChild(e);r;r=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(r),this.treeAdapter.appendChild(n,r)}_setEndLocation(e,n){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&n.location){const r=n.location,i=this.treeAdapter.getTagName(e),s=n.type===ar.END_TAG&&i===n.tagName?{endTag:{...r},endLine:r.endLine,endCol:r.endCol,endOffset:r.endOffset}:{endLine:r.startLine,endCol:r.startCol,endOffset:r.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,s)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let n,r;return this.openElements.stackTop===0&&this.fragmentContext?(n=this.fragmentContext,r=this.fragmentContextID):{current:n,currentTagId:r}=this.openElements,e.tagID===G.SVG&&this.treeAdapter.getTagName(n)===ot.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(n)===Lt.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===G.MGLYPH||e.tagID===G.MALIGNMARK)&&!this._isIntegrationPoint(r,n,Lt.HTML)}_processToken(e){switch(e.type){case ar.CHARACTER:{this.onCharacter(e);break}case ar.NULL_CHARACTER:{this.onNullCharacter(e);break}case ar.COMMENT:{this.onComment(e);break}case ar.DOCTYPE:{this.onDoctype(e);break}case ar.START_TAG:{this._processStartTag(e);break}case ar.END_TAG:{this.onEndTag(e);break}case ar.EOF:{this.onEof(e);break}case ar.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,n,r){const i=this.treeAdapter.getNamespaceURI(n),s=this.treeAdapter.getAttrList(n);return iPe(e,i,s,r)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const n=this.activeFormattingElements.entries.findIndex(i=>i.type===Xl.Marker||this.openElements.contains(i.element)),r=n<0?e-1:n-1;for(let i=r;i>=0;i--){const s=this.activeFormattingElements.entries[i];this._insertElement(s.token,this.treeAdapter.getNamespaceURI(s.element)),s.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=We.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(G.P),this.openElements.popUntilTagNamePopped(G.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case G.TR:{this.insertionMode=We.IN_ROW;return}case G.TBODY:case G.THEAD:case G.TFOOT:{this.insertionMode=We.IN_TABLE_BODY;return}case G.CAPTION:{this.insertionMode=We.IN_CAPTION;return}case G.COLGROUP:{this.insertionMode=We.IN_COLUMN_GROUP;return}case G.TABLE:{this.insertionMode=We.IN_TABLE;return}case G.BODY:{this.insertionMode=We.IN_BODY;return}case G.FRAMESET:{this.insertionMode=We.IN_FRAMESET;return}case G.SELECT:{this._resetInsertionModeForSelect(e);return}case G.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case G.HTML:{this.insertionMode=this.headElement?We.AFTER_HEAD:We.BEFORE_HEAD;return}case G.TD:case G.TH:{if(e>0){this.insertionMode=We.IN_CELL;return}break}case G.HEAD:{if(e>0){this.insertionMode=We.IN_HEAD;return}break}}this.insertionMode=We.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let n=e-1;n>0;n--){const r=this.openElements.tagIDs[n];if(r===G.TEMPLATE)break;if(r===G.TABLE){this.insertionMode=We.IN_SELECT_IN_TABLE;return}}this.insertionMode=We.IN_SELECT}_isElementCausesFosterParenting(e){return tQ.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const n=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case G.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(n)===Lt.HTML)return{parent:this.treeAdapter.getTemplateContent(n),beforeElement:null};break}case G.TABLE:{const r=this.treeAdapter.getParentNode(n);return r?{parent:r,beforeElement:n}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const n=this._findFosterParentingLocation();n.beforeElement?this.treeAdapter.insertBefore(n.parent,e,n.beforeElement):this.treeAdapter.appendChild(n.parent,e)}_isSpecialElement(e,n){const r=this.treeAdapter.getNamespaceURI(e);return CIe[r].has(n)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Uke(this,e);return}switch(this.insertionMode){case We.INITIAL:{Bg(this,e);break}case We.BEFORE_HTML:{P1(this,e);break}case We.BEFORE_HEAD:{k1(this,e);break}case We.IN_HEAD:{L1(this,e);break}case We.IN_HEAD_NO_SCRIPT:{D1(this,e);break}case We.AFTER_HEAD:{N1(this,e);break}case We.IN_BODY:case We.IN_CAPTION:case We.IN_CELL:case We.IN_TEMPLATE:{rQ(this,e);break}case We.TEXT:case We.IN_SELECT:case We.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case We.IN_TABLE:case We.IN_TABLE_BODY:case We.IN_ROW:{_A(this,e);break}case We.IN_TABLE_TEXT:{cQ(this,e);break}case We.IN_COLUMN_GROUP:{fb(this,e);break}case We.AFTER_BODY:{db(this,e);break}case We.AFTER_AFTER_BODY:{w3(this,e);break}}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Fke(this,e);return}switch(this.insertionMode){case We.INITIAL:{Bg(this,e);break}case We.BEFORE_HTML:{P1(this,e);break}case We.BEFORE_HEAD:{k1(this,e);break}case We.IN_HEAD:{L1(this,e);break}case We.IN_HEAD_NO_SCRIPT:{D1(this,e);break}case We.AFTER_HEAD:{N1(this,e);break}case We.TEXT:{this._insertCharacters(e);break}case We.IN_TABLE:case We.IN_TABLE_BODY:case We.IN_ROW:{_A(this,e);break}case We.IN_COLUMN_GROUP:{fb(this,e);break}case We.AFTER_BODY:{db(this,e);break}case We.AFTER_AFTER_BODY:{w3(this,e);break}}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){VM(this,e);return}switch(this.insertionMode){case We.INITIAL:case We.BEFORE_HTML:case We.BEFORE_HEAD:case We.IN_HEAD:case We.IN_HEAD_NO_SCRIPT:case We.AFTER_HEAD:case We.IN_BODY:case We.IN_TABLE:case We.IN_CAPTION:case We.IN_COLUMN_GROUP:case We.IN_TABLE_BODY:case We.IN_ROW:case We.IN_CELL:case We.IN_SELECT:case We.IN_SELECT_IN_TABLE:case We.IN_TEMPLATE:case We.IN_FRAMESET:case We.AFTER_FRAMESET:{VM(this,e);break}case We.IN_TABLE_TEXT:{zg(this,e);break}case We.AFTER_BODY:{mPe(this,e);break}case We.AFTER_AFTER_BODY:case We.AFTER_AFTER_FRAMESET:{gPe(this,e);break}}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case We.INITIAL:{yPe(this,e);break}case We.BEFORE_HEAD:case We.IN_HEAD:case We.IN_HEAD_NO_SCRIPT:case We.AFTER_HEAD:{this._err(e,St.misplacedDoctype);break}case We.IN_TABLE_TEXT:{zg(this,e);break}}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,St.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?Bke(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case We.INITIAL:{Bg(this,e);break}case We.BEFORE_HTML:{vPe(this,e);break}case We.BEFORE_HEAD:{_Pe(this,e);break}case We.IN_HEAD:{Pl(this,e);break}case We.IN_HEAD_NO_SCRIPT:{wPe(this,e);break}case We.AFTER_HEAD:{TPe(this,e);break}case We.IN_BODY:{lo(this,e);break}case We.IN_TABLE:{km(this,e);break}case We.IN_TABLE_TEXT:{zg(this,e);break}case We.IN_CAPTION:{bke(this,e);break}case We.IN_COLUMN_GROUP:{BR(this,e);break}case We.IN_TABLE_BODY:{ow(this,e);break}case We.IN_ROW:{aw(this,e);break}case We.IN_CELL:{Ske(this,e);break}case We.IN_SELECT:{dQ(this,e);break}case We.IN_SELECT_IN_TABLE:{Ake(this,e);break}case We.IN_TEMPLATE:{Cke(this,e);break}case We.AFTER_BODY:{Ike(this,e);break}case We.IN_FRAMESET:{Pke(this,e);break}case We.AFTER_FRAMESET:{Lke(this,e);break}case We.AFTER_AFTER_BODY:{Nke(this,e);break}case We.AFTER_AFTER_FRAMESET:{Oke(this,e);break}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?zke(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case We.INITIAL:{Bg(this,e);break}case We.BEFORE_HTML:{xPe(this,e);break}case We.BEFORE_HEAD:{bPe(this,e);break}case We.IN_HEAD:{EPe(this,e);break}case We.IN_HEAD_NO_SCRIPT:{SPe(this,e);break}case We.AFTER_HEAD:{APe(this,e);break}case We.IN_BODY:{sw(this,e);break}case We.TEXT:{fke(this,e);break}case We.IN_TABLE:{uy(this,e);break}case We.IN_TABLE_TEXT:{zg(this,e);break}case We.IN_CAPTION:{Eke(this,e);break}case We.IN_COLUMN_GROUP:{wke(this,e);break}case We.IN_TABLE_BODY:{WM(this,e);break}case We.IN_ROW:{fQ(this,e);break}case We.IN_CELL:{Tke(this,e);break}case We.IN_SELECT:{hQ(this,e);break}case We.IN_SELECT_IN_TABLE:{Mke(this,e);break}case We.IN_TEMPLATE:{Rke(this,e);break}case We.AFTER_BODY:{mQ(this,e);break}case We.IN_FRAMESET:{kke(this,e);break}case We.AFTER_FRAMESET:{Dke(this,e);break}case We.AFTER_AFTER_BODY:{w3(this,e);break}}}onEof(e){switch(this.insertionMode){case We.INITIAL:{Bg(this,e);break}case We.BEFORE_HTML:{P1(this,e);break}case We.BEFORE_HEAD:{k1(this,e);break}case We.IN_HEAD:{L1(this,e);break}case We.IN_HEAD_NO_SCRIPT:{D1(this,e);break}case We.AFTER_HEAD:{N1(this,e);break}case We.IN_BODY:case We.IN_TABLE:case We.IN_CAPTION:case We.IN_COLUMN_GROUP:case We.IN_TABLE_BODY:case We.IN_ROW:case We.IN_CELL:case We.IN_SELECT:case We.IN_SELECT_IN_TABLE:{aQ(this,e);break}case We.TEXT:{dke(this,e);break}case We.IN_TABLE_TEXT:{zg(this,e);break}case We.IN_TEMPLATE:{pQ(this,e);break}case We.AFTER_BODY:case We.IN_FRAMESET:case We.AFTER_FRAMESET:case We.AFTER_AFTER_BODY:case We.AFTER_AFTER_FRAMESET:{UR(this,e);break}}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===Ae.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case We.IN_HEAD:case We.IN_HEAD_NO_SCRIPT:case We.AFTER_HEAD:case We.TEXT:case We.IN_COLUMN_GROUP:case We.IN_SELECT:case We.IN_SELECT_IN_TABLE:case We.IN_FRAMESET:case We.AFTER_FRAMESET:{this._insertCharacters(e);break}case We.IN_BODY:case We.IN_CAPTION:case We.IN_CELL:case We.IN_TEMPLATE:case We.AFTER_BODY:case We.AFTER_AFTER_BODY:case We.AFTER_AFTER_FRAMESET:{nQ(this,e);break}case We.IN_TABLE:case We.IN_TABLE_BODY:case We.IN_ROW:{_A(this,e);break}case We.IN_TABLE_TEXT:{lQ(this,e);break}}}}function cPe(t,e){let n=t.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return n?t.openElements.contains(n.element)?t.openElements.hasInScope(e.tagID)||(n=null):(t.activeFormattingElements.removeEntry(n),n=null):oQ(t,e),n}function uPe(t,e){let n=null,r=t.openElements.stackTop;for(;r>=0;r--){const i=t.openElements.items[r];if(i===e.element)break;t._isSpecialElement(i,t.openElements.tagIDs[r])&&(n=i)}return n||(t.openElements.shortenToLength(r<0?0:r),t.activeFormattingElements.removeEntry(e)),n}function fPe(t,e,n){let r=e,i=t.openElements.getCommonAncestor(e);for(let s=0,o=i;o!==n;s++,o=i){i=t.openElements.getCommonAncestor(o);const a=t.activeFormattingElements.getElementEntry(o),l=a&&s>=aPe;!a||l?(l&&t.activeFormattingElements.removeEntry(a),t.openElements.remove(o)):(o=dPe(t,a),r===e&&(t.activeFormattingElements.bookmark=a),t.treeAdapter.detachNode(r),t.treeAdapter.appendChild(o,r),r=o)}return r}function dPe(t,e){const n=t.treeAdapter.getNamespaceURI(e.element),r=t.treeAdapter.createElement(e.token.tagName,n,e.token.attrs);return t.openElements.replace(e.element,r),e.element=r,r}function hPe(t,e,n){const r=t.treeAdapter.getTagName(e),i=c0(r);if(t._isElementCausesFosterParenting(i))t._fosterParentElement(n);else{const s=t.treeAdapter.getNamespaceURI(e);i===G.TEMPLATE&&s===Lt.HTML&&(e=t.treeAdapter.getTemplateContent(e)),t.treeAdapter.appendChild(e,n)}}function pPe(t,e,n){const r=t.treeAdapter.getNamespaceURI(n.element),{token:i}=n,s=t.treeAdapter.createElement(i.tagName,r,i.attrs);t._adoptNodes(e,s),t.treeAdapter.appendChild(e,s),t.activeFormattingElements.insertElementAfterBookmark(s,i),t.activeFormattingElements.removeEntry(n),t.openElements.remove(n.element),t.openElements.insertAfter(e,s,i.tagID)}function FR(t,e){for(let n=0;n<oPe;n++){const r=cPe(t,e);if(!r)break;const i=uPe(t,r);if(!i)break;t.activeFormattingElements.bookmark=r;const s=fPe(t,i,r.element),o=t.openElements.getCommonAncestor(r.element);t.treeAdapter.detachNode(s),o&&hPe(t,o,s),pPe(t,i,r)}}function VM(t,e){t._appendCommentNode(e,t.openElements.currentTmplContentOrNode)}function mPe(t,e){t._appendCommentNode(e,t.openElements.items[0])}function gPe(t,e){t._appendCommentNode(e,t.document)}function UR(t,e){if(t.stopped=!0,e.location){const n=t.fragmentContext?0:2;for(let r=t.openElements.stackTop;r>=n;r--)t._setEndLocation(t.openElements.items[r],e);if(!t.fragmentContext&&t.openElements.stackTop>=0){const r=t.openElements.items[0],i=t.treeAdapter.getNodeSourceCodeLocation(r);if(i&&!i.endTag&&(t._setEndLocation(r,e),t.openElements.stackTop>=1)){const s=t.openElements.items[1],o=t.treeAdapter.getNodeSourceCodeLocation(s);o&&!o.endTag&&t._setEndLocation(s,e)}}}}function yPe(t,e){t._setDocumentType(e);const n=e.forceQuirks?Fa.QUIRKS:XIe(e);$Ie(e)||t._err(e,St.nonConformingDoctype),t.treeAdapter.setDocumentMode(t.document,n),t.insertionMode=We.BEFORE_HTML}function Bg(t,e){t._err(e,St.missingDoctype,!0),t.treeAdapter.setDocumentMode(t.document,Fa.QUIRKS),t.insertionMode=We.BEFORE_HTML,t._processToken(e)}function vPe(t,e){e.tagID===G.HTML?(t._insertElement(e,Lt.HTML),t.insertionMode=We.BEFORE_HEAD):P1(t,e)}function xPe(t,e){const n=e.tagID;(n===G.HTML||n===G.HEAD||n===G.BODY||n===G.BR)&&P1(t,e)}function P1(t,e){t._insertFakeRootElement(),t.insertionMode=We.BEFORE_HEAD,t._processToken(e)}function _Pe(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.HEAD:{t._insertElement(e,Lt.HTML),t.headElement=t.openElements.current,t.insertionMode=We.IN_HEAD;break}default:k1(t,e)}}function bPe(t,e){const n=e.tagID;n===G.HEAD||n===G.BODY||n===G.HTML||n===G.BR?k1(t,e):t._err(e,St.endTagWithoutMatchingOpenElement)}function k1(t,e){t._insertFakeElement(ot.HEAD,G.HEAD),t.headElement=t.openElements.current,t.insertionMode=We.IN_HEAD,t._processToken(e)}function Pl(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.BASE:case G.BASEFONT:case G.BGSOUND:case G.LINK:case G.META:{t._appendElement(e,Lt.HTML),e.ackSelfClosing=!0;break}case G.TITLE:{t._switchToTextParsing(e,Bi.RCDATA);break}case G.NOSCRIPT:{t.options.scriptingEnabled?t._switchToTextParsing(e,Bi.RAWTEXT):(t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_HEAD_NO_SCRIPT);break}case G.NOFRAMES:case G.STYLE:{t._switchToTextParsing(e,Bi.RAWTEXT);break}case G.SCRIPT:{t._switchToTextParsing(e,Bi.SCRIPT_DATA);break}case G.TEMPLATE:{t._insertTemplate(e),t.activeFormattingElements.insertMarker(),t.framesetOk=!1,t.insertionMode=We.IN_TEMPLATE,t.tmplInsertionModeStack.unshift(We.IN_TEMPLATE);break}case G.HEAD:{t._err(e,St.misplacedStartTagForHeadElement);break}default:L1(t,e)}}function EPe(t,e){switch(e.tagID){case G.HEAD:{t.openElements.pop(),t.insertionMode=We.AFTER_HEAD;break}case G.BODY:case G.BR:case G.HTML:{L1(t,e);break}case G.TEMPLATE:{yh(t,e);break}default:t._err(e,St.endTagWithoutMatchingOpenElement)}}function yh(t,e){t.openElements.tmplCount>0?(t.openElements.generateImpliedEndTagsThoroughly(),t.openElements.currentTagId!==G.TEMPLATE&&t._err(e,St.closingOfElementWithOpenChildElements),t.openElements.popUntilTagNamePopped(G.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode()):t._err(e,St.endTagWithoutMatchingOpenElement)}function L1(t,e){t.openElements.pop(),t.insertionMode=We.AFTER_HEAD,t._processToken(e)}function wPe(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.BASEFONT:case G.BGSOUND:case G.HEAD:case G.LINK:case G.META:case G.NOFRAMES:case G.STYLE:{Pl(t,e);break}case G.NOSCRIPT:{t._err(e,St.nestedNoscriptInHead);break}default:D1(t,e)}}function SPe(t,e){switch(e.tagID){case G.NOSCRIPT:{t.openElements.pop(),t.insertionMode=We.IN_HEAD;break}case G.BR:{D1(t,e);break}default:t._err(e,St.endTagWithoutMatchingOpenElement)}}function D1(t,e){const n=e.type===ar.EOF?St.openElementsLeftAfterEof:St.disallowedContentInNoscriptInHead;t._err(e,n),t.openElements.pop(),t.insertionMode=We.IN_HEAD,t._processToken(e)}function TPe(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.BODY:{t._insertElement(e,Lt.HTML),t.framesetOk=!1,t.insertionMode=We.IN_BODY;break}case G.FRAMESET:{t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_FRAMESET;break}case G.BASE:case G.BASEFONT:case G.BGSOUND:case G.LINK:case G.META:case G.NOFRAMES:case G.SCRIPT:case G.STYLE:case G.TEMPLATE:case G.TITLE:{t._err(e,St.abandonedHeadElementChild),t.openElements.push(t.headElement,G.HEAD),Pl(t,e),t.openElements.remove(t.headElement);break}case G.HEAD:{t._err(e,St.misplacedStartTagForHeadElement);break}default:N1(t,e)}}function APe(t,e){switch(e.tagID){case G.BODY:case G.HTML:case G.BR:{N1(t,e);break}case G.TEMPLATE:{yh(t,e);break}default:t._err(e,St.endTagWithoutMatchingOpenElement)}}function N1(t,e){t._insertFakeElement(ot.BODY,G.BODY),t.insertionMode=We.IN_BODY,iw(t,e)}function iw(t,e){switch(e.type){case ar.CHARACTER:{rQ(t,e);break}case ar.WHITESPACE_CHARACTER:{nQ(t,e);break}case ar.COMMENT:{VM(t,e);break}case ar.START_TAG:{lo(t,e);break}case ar.END_TAG:{sw(t,e);break}case ar.EOF:{aQ(t,e);break}}}function nQ(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e)}function rQ(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e),t.framesetOk=!1}function MPe(t,e){t.openElements.tmplCount===0&&t.treeAdapter.adoptAttributes(t.openElements.items[0],e.attrs)}function CPe(t,e){const n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t.openElements.tmplCount===0&&(t.framesetOk=!1,t.treeAdapter.adoptAttributes(n,e.attrs))}function RPe(t,e){const n=t.openElements.tryPeekProperlyNestedBodyElement();t.framesetOk&&n&&(t.treeAdapter.detachNode(n),t.openElements.popAllUpToHtmlElement(),t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_FRAMESET)}function IPe(t,e){t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._insertElement(e,Lt.HTML)}function PPe(t,e){t.openElements.hasInButtonScope(G.P)&&t._closePElement(),jM.has(t.openElements.currentTagId)&&t.openElements.pop(),t._insertElement(e,Lt.HTML)}function kPe(t,e){t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._insertElement(e,Lt.HTML),t.skipNextNewLine=!0,t.framesetOk=!1}function LPe(t,e){const n=t.openElements.tmplCount>0;(!t.formElement||n)&&(t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._insertElement(e,Lt.HTML),n||(t.formElement=t.openElements.current))}function DPe(t,e){t.framesetOk=!1;const n=e.tagID;for(let r=t.openElements.stackTop;r>=0;r--){const i=t.openElements.tagIDs[r];if(n===G.LI&&i===G.LI||(n===G.DD||n===G.DT)&&(i===G.DD||i===G.DT)){t.openElements.generateImpliedEndTagsWithExclusion(i),t.openElements.popUntilTagNamePopped(i);break}if(i!==G.ADDRESS&&i!==G.DIV&&i!==G.P&&t._isSpecialElement(t.openElements.items[r],i))break}t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._insertElement(e,Lt.HTML)}function NPe(t,e){t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._insertElement(e,Lt.HTML),t.tokenizer.state=Bi.PLAINTEXT}function OPe(t,e){t.openElements.hasInScope(G.BUTTON)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(G.BUTTON)),t._reconstructActiveFormattingElements(),t._insertElement(e,Lt.HTML),t.framesetOk=!1}function FPe(t,e){const n=t.activeFormattingElements.getElementEntryInScopeWithTagName(ot.A);n&&(FR(t,e),t.openElements.remove(n.element),t.activeFormattingElements.removeEntry(n)),t._reconstructActiveFormattingElements(),t._insertElement(e,Lt.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function UPe(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Lt.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function BPe(t,e){t._reconstructActiveFormattingElements(),t.openElements.hasInScope(G.NOBR)&&(FR(t,e),t._reconstructActiveFormattingElements()),t._insertElement(e,Lt.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function zPe(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Lt.HTML),t.activeFormattingElements.insertMarker(),t.framesetOk=!1}function HPe(t,e){t.treeAdapter.getDocumentMode(t.document)!==Fa.QUIRKS&&t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._insertElement(e,Lt.HTML),t.framesetOk=!1,t.insertionMode=We.IN_TABLE}function iQ(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,Lt.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function sQ(t){const e=VZ(t,Fd.TYPE);return e!=null&&e.toLowerCase()===sPe}function GPe(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,Lt.HTML),sQ(e)||(t.framesetOk=!1),e.ackSelfClosing=!0}function jPe(t,e){t._appendElement(e,Lt.HTML),e.ackSelfClosing=!0}function VPe(t,e){t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._appendElement(e,Lt.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function WPe(t,e){e.tagName=ot.IMG,e.tagID=G.IMG,iQ(t,e)}function $Pe(t,e){t._insertElement(e,Lt.HTML),t.skipNextNewLine=!0,t.tokenizer.state=Bi.RCDATA,t.originalInsertionMode=t.insertionMode,t.framesetOk=!1,t.insertionMode=We.TEXT}function XPe(t,e){t.openElements.hasInButtonScope(G.P)&&t._closePElement(),t._reconstructActiveFormattingElements(),t.framesetOk=!1,t._switchToTextParsing(e,Bi.RAWTEXT)}function qPe(t,e){t.framesetOk=!1,t._switchToTextParsing(e,Bi.RAWTEXT)}function UU(t,e){t._switchToTextParsing(e,Bi.RAWTEXT)}function YPe(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Lt.HTML),t.framesetOk=!1,t.insertionMode=t.insertionMode===We.IN_TABLE||t.insertionMode===We.IN_CAPTION||t.insertionMode===We.IN_TABLE_BODY||t.insertionMode===We.IN_ROW||t.insertionMode===We.IN_CELL?We.IN_SELECT_IN_TABLE:We.IN_SELECT}function KPe(t,e){t.openElements.currentTagId===G.OPTION&&t.openElements.pop(),t._reconstructActiveFormattingElements(),t._insertElement(e,Lt.HTML)}function ZPe(t,e){t.openElements.hasInScope(G.RUBY)&&t.openElements.generateImpliedEndTags(),t._insertElement(e,Lt.HTML)}function QPe(t,e){t.openElements.hasInScope(G.RUBY)&&t.openElements.generateImpliedEndTagsWithExclusion(G.RTC),t._insertElement(e,Lt.HTML)}function JPe(t,e){t._reconstructActiveFormattingElements(),JZ(e),OR(e),e.selfClosing?t._appendElement(e,Lt.MATHML):t._insertElement(e,Lt.MATHML),e.ackSelfClosing=!0}function eke(t,e){t._reconstructActiveFormattingElements(),eQ(e),OR(e),e.selfClosing?t._appendElement(e,Lt.SVG):t._insertElement(e,Lt.SVG),e.ackSelfClosing=!0}function BU(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Lt.HTML)}function lo(t,e){switch(e.tagID){case G.I:case G.S:case G.B:case G.U:case G.EM:case G.TT:case G.BIG:case G.CODE:case G.FONT:case G.SMALL:case G.STRIKE:case G.STRONG:{UPe(t,e);break}case G.A:{FPe(t,e);break}case G.H1:case G.H2:case G.H3:case G.H4:case G.H5:case G.H6:{PPe(t,e);break}case G.P:case G.DL:case G.OL:case G.UL:case G.DIV:case G.DIR:case G.NAV:case G.MAIN:case G.MENU:case G.ASIDE:case G.CENTER:case G.FIGURE:case G.FOOTER:case G.HEADER:case G.HGROUP:case G.DIALOG:case G.DETAILS:case G.ADDRESS:case G.ARTICLE:case G.SEARCH:case G.SECTION:case G.SUMMARY:case G.FIELDSET:case G.BLOCKQUOTE:case G.FIGCAPTION:{IPe(t,e);break}case G.LI:case G.DD:case G.DT:{DPe(t,e);break}case G.BR:case G.IMG:case G.WBR:case G.AREA:case G.EMBED:case G.KEYGEN:{iQ(t,e);break}case G.HR:{VPe(t,e);break}case G.RB:case G.RTC:{ZPe(t,e);break}case G.RT:case G.RP:{QPe(t,e);break}case G.PRE:case G.LISTING:{kPe(t,e);break}case G.XMP:{XPe(t,e);break}case G.SVG:{eke(t,e);break}case G.HTML:{MPe(t,e);break}case G.BASE:case G.LINK:case G.META:case G.STYLE:case G.TITLE:case G.SCRIPT:case G.BGSOUND:case G.BASEFONT:case G.TEMPLATE:{Pl(t,e);break}case G.BODY:{CPe(t,e);break}case G.FORM:{LPe(t,e);break}case G.NOBR:{BPe(t,e);break}case G.MATH:{JPe(t,e);break}case G.TABLE:{HPe(t,e);break}case G.INPUT:{GPe(t,e);break}case G.PARAM:case G.TRACK:case G.SOURCE:{jPe(t,e);break}case G.IMAGE:{WPe(t,e);break}case G.BUTTON:{OPe(t,e);break}case G.APPLET:case G.OBJECT:case G.MARQUEE:{zPe(t,e);break}case G.IFRAME:{qPe(t,e);break}case G.SELECT:{YPe(t,e);break}case G.OPTION:case G.OPTGROUP:{KPe(t,e);break}case G.NOEMBED:case G.NOFRAMES:{UU(t,e);break}case G.FRAMESET:{RPe(t,e);break}case G.TEXTAREA:{$Pe(t,e);break}case G.NOSCRIPT:{t.options.scriptingEnabled?UU(t,e):BU(t,e);break}case G.PLAINTEXT:{NPe(t,e);break}case G.COL:case G.TH:case G.TD:case G.TR:case G.HEAD:case G.FRAME:case G.TBODY:case G.TFOOT:case G.THEAD:case G.CAPTION:case G.COLGROUP:break;default:BU(t,e)}}function tke(t,e){if(t.openElements.hasInScope(G.BODY)&&(t.insertionMode=We.AFTER_BODY,t.options.sourceCodeLocationInfo)){const n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t._setEndLocation(n,e)}}function nke(t,e){t.openElements.hasInScope(G.BODY)&&(t.insertionMode=We.AFTER_BODY,mQ(t,e))}function rke(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n))}function ike(t){const e=t.openElements.tmplCount>0,{formElement:n}=t;e||(t.formElement=null),(n||e)&&t.openElements.hasInScope(G.FORM)&&(t.openElements.generateImpliedEndTags(),e?t.openElements.popUntilTagNamePopped(G.FORM):n&&t.openElements.remove(n))}function ske(t){t.openElements.hasInButtonScope(G.P)||t._insertFakeElement(ot.P,G.P),t._closePElement()}function oke(t){t.openElements.hasInListItemScope(G.LI)&&(t.openElements.generateImpliedEndTagsWithExclusion(G.LI),t.openElements.popUntilTagNamePopped(G.LI))}function ake(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTagsWithExclusion(n),t.openElements.popUntilTagNamePopped(n))}function lke(t){t.openElements.hasNumberedHeaderInScope()&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilNumberedHeaderPopped())}function cke(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker())}function uke(t){t._reconstructActiveFormattingElements(),t._insertFakeElement(ot.BR,G.BR),t.openElements.pop(),t.framesetOk=!1}function oQ(t,e){const n=e.tagName,r=e.tagID;for(let i=t.openElements.stackTop;i>0;i--){const s=t.openElements.items[i],o=t.openElements.tagIDs[i];if(r===o&&(r!==G.UNKNOWN||t.treeAdapter.getTagName(s)===n)){t.openElements.generateImpliedEndTagsWithExclusion(r),t.openElements.stackTop>=i&&t.openElements.shortenToLength(i);break}if(t._isSpecialElement(s,o))break}}function sw(t,e){switch(e.tagID){case G.A:case G.B:case G.I:case G.S:case G.U:case G.EM:case G.TT:case G.BIG:case G.CODE:case G.FONT:case G.NOBR:case G.SMALL:case G.STRIKE:case G.STRONG:{FR(t,e);break}case G.P:{ske(t);break}case G.DL:case G.UL:case G.OL:case G.DIR:case G.DIV:case G.NAV:case G.PRE:case G.MAIN:case G.MENU:case G.ASIDE:case G.BUTTON:case G.CENTER:case G.FIGURE:case G.FOOTER:case G.HEADER:case G.HGROUP:case G.DIALOG:case G.ADDRESS:case G.ARTICLE:case G.DETAILS:case G.SEARCH:case G.SECTION:case G.SUMMARY:case G.LISTING:case G.FIELDSET:case G.BLOCKQUOTE:case G.FIGCAPTION:{rke(t,e);break}case G.LI:{oke(t);break}case G.DD:case G.DT:{ake(t,e);break}case G.H1:case G.H2:case G.H3:case G.H4:case G.H5:case G.H6:{lke(t);break}case G.BR:{uke(t);break}case G.BODY:{tke(t,e);break}case G.HTML:{nke(t,e);break}case G.FORM:{ike(t);break}case G.APPLET:case G.OBJECT:case G.MARQUEE:{cke(t,e);break}case G.TEMPLATE:{yh(t,e);break}default:oQ(t,e)}}function aQ(t,e){t.tmplInsertionModeStack.length>0?pQ(t,e):UR(t,e)}function fke(t,e){var n;e.tagID===G.SCRIPT&&((n=t.scriptHandler)===null||n===void 0||n.call(t,t.openElements.current)),t.openElements.pop(),t.insertionMode=t.originalInsertionMode}function dke(t,e){t._err(e,St.eofInElementThatCanContainOnlyText),t.openElements.pop(),t.insertionMode=t.originalInsertionMode,t.onEof(e)}function _A(t,e){if(tQ.has(t.openElements.currentTagId))switch(t.pendingCharacterTokens.length=0,t.hasNonWhitespacePendingCharacterToken=!1,t.originalInsertionMode=t.insertionMode,t.insertionMode=We.IN_TABLE_TEXT,e.type){case ar.CHARACTER:{cQ(t,e);break}case ar.WHITESPACE_CHARACTER:{lQ(t,e);break}}else Zy(t,e)}function hke(t,e){t.openElements.clearBackToTableContext(),t.activeFormattingElements.insertMarker(),t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_CAPTION}function pke(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_COLUMN_GROUP}function mke(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(ot.COLGROUP,G.COLGROUP),t.insertionMode=We.IN_COLUMN_GROUP,BR(t,e)}function gke(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_TABLE_BODY}function yke(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(ot.TBODY,G.TBODY),t.insertionMode=We.IN_TABLE_BODY,ow(t,e)}function vke(t,e){t.openElements.hasInTableScope(G.TABLE)&&(t.openElements.popUntilTagNamePopped(G.TABLE),t._resetInsertionMode(),t._processStartTag(e))}function xke(t,e){sQ(e)?t._appendElement(e,Lt.HTML):Zy(t,e),e.ackSelfClosing=!0}function _ke(t,e){!t.formElement&&t.openElements.tmplCount===0&&(t._insertElement(e,Lt.HTML),t.formElement=t.openElements.current,t.openElements.pop())}function km(t,e){switch(e.tagID){case G.TD:case G.TH:case G.TR:{yke(t,e);break}case G.STYLE:case G.SCRIPT:case G.TEMPLATE:{Pl(t,e);break}case G.COL:{mke(t,e);break}case G.FORM:{_ke(t,e);break}case G.TABLE:{vke(t,e);break}case G.TBODY:case G.TFOOT:case G.THEAD:{gke(t,e);break}case G.INPUT:{xke(t,e);break}case G.CAPTION:{hke(t,e);break}case G.COLGROUP:{pke(t,e);break}default:Zy(t,e)}}function uy(t,e){switch(e.tagID){case G.TABLE:{t.openElements.hasInTableScope(G.TABLE)&&(t.openElements.popUntilTagNamePopped(G.TABLE),t._resetInsertionMode());break}case G.TEMPLATE:{yh(t,e);break}case G.BODY:case G.CAPTION:case G.COL:case G.COLGROUP:case G.HTML:case G.TBODY:case G.TD:case G.TFOOT:case G.TH:case G.THEAD:case G.TR:break;default:Zy(t,e)}}function Zy(t,e){const n=t.fosterParentingEnabled;t.fosterParentingEnabled=!0,iw(t,e),t.fosterParentingEnabled=n}function lQ(t,e){t.pendingCharacterTokens.push(e)}function cQ(t,e){t.pendingCharacterTokens.push(e),t.hasNonWhitespacePendingCharacterToken=!0}function zg(t,e){let n=0;if(t.hasNonWhitespacePendingCharacterToken)for(;n<t.pendingCharacterTokens.length;n++)Zy(t,t.pendingCharacterTokens[n]);else for(;n<t.pendingCharacterTokens.length;n++)t._insertCharacters(t.pendingCharacterTokens[n]);t.insertionMode=t.originalInsertionMode,t._processToken(e)}const uQ=new Set([G.CAPTION,G.COL,G.COLGROUP,G.TBODY,G.TD,G.TFOOT,G.TH,G.THEAD,G.TR]);function bke(t,e){const n=e.tagID;uQ.has(n)?t.openElements.hasInTableScope(G.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(G.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=We.IN_TABLE,km(t,e)):lo(t,e)}function Eke(t,e){const n=e.tagID;switch(n){case G.CAPTION:case G.TABLE:{t.openElements.hasInTableScope(G.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(G.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=We.IN_TABLE,n===G.TABLE&&uy(t,e));break}case G.BODY:case G.COL:case G.COLGROUP:case G.HTML:case G.TBODY:case G.TD:case G.TFOOT:case G.TH:case G.THEAD:case G.TR:break;default:sw(t,e)}}function BR(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.COL:{t._appendElement(e,Lt.HTML),e.ackSelfClosing=!0;break}case G.TEMPLATE:{Pl(t,e);break}default:fb(t,e)}}function wke(t,e){switch(e.tagID){case G.COLGROUP:{t.openElements.currentTagId===G.COLGROUP&&(t.openElements.pop(),t.insertionMode=We.IN_TABLE);break}case G.TEMPLATE:{yh(t,e);break}case G.COL:break;default:fb(t,e)}}function fb(t,e){t.openElements.currentTagId===G.COLGROUP&&(t.openElements.pop(),t.insertionMode=We.IN_TABLE,t._processToken(e))}function ow(t,e){switch(e.tagID){case G.TR:{t.openElements.clearBackToTableBodyContext(),t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_ROW;break}case G.TH:case G.TD:{t.openElements.clearBackToTableBodyContext(),t._insertFakeElement(ot.TR,G.TR),t.insertionMode=We.IN_ROW,aw(t,e);break}case G.CAPTION:case G.COL:case G.COLGROUP:case G.TBODY:case G.TFOOT:case G.THEAD:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=We.IN_TABLE,km(t,e));break}default:km(t,e)}}function WM(t,e){const n=e.tagID;switch(e.tagID){case G.TBODY:case G.TFOOT:case G.THEAD:{t.openElements.hasInTableScope(n)&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=We.IN_TABLE);break}case G.TABLE:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=We.IN_TABLE,uy(t,e));break}case G.BODY:case G.CAPTION:case G.COL:case G.COLGROUP:case G.HTML:case G.TD:case G.TH:case G.TR:break;default:uy(t,e)}}function aw(t,e){switch(e.tagID){case G.TH:case G.TD:{t.openElements.clearBackToTableRowContext(),t._insertElement(e,Lt.HTML),t.insertionMode=We.IN_CELL,t.activeFormattingElements.insertMarker();break}case G.CAPTION:case G.COL:case G.COLGROUP:case G.TBODY:case G.TFOOT:case G.THEAD:case G.TR:{t.openElements.hasInTableScope(G.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=We.IN_TABLE_BODY,ow(t,e));break}default:km(t,e)}}function fQ(t,e){switch(e.tagID){case G.TR:{t.openElements.hasInTableScope(G.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=We.IN_TABLE_BODY);break}case G.TABLE:{t.openElements.hasInTableScope(G.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=We.IN_TABLE_BODY,WM(t,e));break}case G.TBODY:case G.TFOOT:case G.THEAD:{(t.openElements.hasInTableScope(e.tagID)||t.openElements.hasInTableScope(G.TR))&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=We.IN_TABLE_BODY,WM(t,e));break}case G.BODY:case G.CAPTION:case G.COL:case G.COLGROUP:case G.HTML:case G.TD:case G.TH:break;default:uy(t,e)}}function Ske(t,e){const n=e.tagID;uQ.has(n)?(t.openElements.hasInTableScope(G.TD)||t.openElements.hasInTableScope(G.TH))&&(t._closeTableCell(),aw(t,e)):lo(t,e)}function Tke(t,e){const n=e.tagID;switch(n){case G.TD:case G.TH:{t.openElements.hasInTableScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=We.IN_ROW);break}case G.TABLE:case G.TBODY:case G.TFOOT:case G.THEAD:case G.TR:{t.openElements.hasInTableScope(n)&&(t._closeTableCell(),fQ(t,e));break}case G.BODY:case G.CAPTION:case G.COL:case G.COLGROUP:case G.HTML:break;default:sw(t,e)}}function dQ(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.OPTION:{t.openElements.currentTagId===G.OPTION&&t.openElements.pop(),t._insertElement(e,Lt.HTML);break}case G.OPTGROUP:{t.openElements.currentTagId===G.OPTION&&t.openElements.pop(),t.openElements.currentTagId===G.OPTGROUP&&t.openElements.pop(),t._insertElement(e,Lt.HTML);break}case G.HR:{t.openElements.currentTagId===G.OPTION&&t.openElements.pop(),t.openElements.currentTagId===G.OPTGROUP&&t.openElements.pop(),t._appendElement(e,Lt.HTML),e.ackSelfClosing=!0;break}case G.INPUT:case G.KEYGEN:case G.TEXTAREA:case G.SELECT:{t.openElements.hasInSelectScope(G.SELECT)&&(t.openElements.popUntilTagNamePopped(G.SELECT),t._resetInsertionMode(),e.tagID!==G.SELECT&&t._processStartTag(e));break}case G.SCRIPT:case G.TEMPLATE:{Pl(t,e);break}}}function hQ(t,e){switch(e.tagID){case G.OPTGROUP:{t.openElements.stackTop>0&&t.openElements.currentTagId===G.OPTION&&t.openElements.tagIDs[t.openElements.stackTop-1]===G.OPTGROUP&&t.openElements.pop(),t.openElements.currentTagId===G.OPTGROUP&&t.openElements.pop();break}case G.OPTION:{t.openElements.currentTagId===G.OPTION&&t.openElements.pop();break}case G.SELECT:{t.openElements.hasInSelectScope(G.SELECT)&&(t.openElements.popUntilTagNamePopped(G.SELECT),t._resetInsertionMode());break}case G.TEMPLATE:{yh(t,e);break}}}function Ake(t,e){const n=e.tagID;n===G.CAPTION||n===G.TABLE||n===G.TBODY||n===G.TFOOT||n===G.THEAD||n===G.TR||n===G.TD||n===G.TH?(t.openElements.popUntilTagNamePopped(G.SELECT),t._resetInsertionMode(),t._processStartTag(e)):dQ(t,e)}function Mke(t,e){const n=e.tagID;n===G.CAPTION||n===G.TABLE||n===G.TBODY||n===G.TFOOT||n===G.THEAD||n===G.TR||n===G.TD||n===G.TH?t.openElements.hasInTableScope(n)&&(t.openElements.popUntilTagNamePopped(G.SELECT),t._resetInsertionMode(),t.onEndTag(e)):hQ(t,e)}function Cke(t,e){switch(e.tagID){case G.BASE:case G.BASEFONT:case G.BGSOUND:case G.LINK:case G.META:case G.NOFRAMES:case G.SCRIPT:case G.STYLE:case G.TEMPLATE:case G.TITLE:{Pl(t,e);break}case G.CAPTION:case G.COLGROUP:case G.TBODY:case G.TFOOT:case G.THEAD:{t.tmplInsertionModeStack[0]=We.IN_TABLE,t.insertionMode=We.IN_TABLE,km(t,e);break}case G.COL:{t.tmplInsertionModeStack[0]=We.IN_COLUMN_GROUP,t.insertionMode=We.IN_COLUMN_GROUP,BR(t,e);break}case G.TR:{t.tmplInsertionModeStack[0]=We.IN_TABLE_BODY,t.insertionMode=We.IN_TABLE_BODY,ow(t,e);break}case G.TD:case G.TH:{t.tmplInsertionModeStack[0]=We.IN_ROW,t.insertionMode=We.IN_ROW,aw(t,e);break}default:t.tmplInsertionModeStack[0]=We.IN_BODY,t.insertionMode=We.IN_BODY,lo(t,e)}}function Rke(t,e){e.tagID===G.TEMPLATE&&yh(t,e)}function pQ(t,e){t.openElements.tmplCount>0?(t.openElements.popUntilTagNamePopped(G.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode(),t.onEof(e)):UR(t,e)}function Ike(t,e){e.tagID===G.HTML?lo(t,e):db(t,e)}function mQ(t,e){var n;if(e.tagID===G.HTML){if(t.fragmentContext||(t.insertionMode=We.AFTER_AFTER_BODY),t.options.sourceCodeLocationInfo&&t.openElements.tagIDs[0]===G.HTML){t._setEndLocation(t.openElements.items[0],e);const r=t.openElements.items[1];r&&!(!((n=t.treeAdapter.getNodeSourceCodeLocation(r))===null||n===void 0)&&n.endTag)&&t._setEndLocation(r,e)}}else db(t,e)}function db(t,e){t.insertionMode=We.IN_BODY,iw(t,e)}function Pke(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.FRAMESET:{t._insertElement(e,Lt.HTML);break}case G.FRAME:{t._appendElement(e,Lt.HTML),e.ackSelfClosing=!0;break}case G.NOFRAMES:{Pl(t,e);break}}}function kke(t,e){e.tagID===G.FRAMESET&&!t.openElements.isRootHtmlElementCurrent()&&(t.openElements.pop(),!t.fragmentContext&&t.openElements.currentTagId!==G.FRAMESET&&(t.insertionMode=We.AFTER_FRAMESET))}function Lke(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.NOFRAMES:{Pl(t,e);break}}}function Dke(t,e){e.tagID===G.HTML&&(t.insertionMode=We.AFTER_AFTER_FRAMESET)}function Nke(t,e){e.tagID===G.HTML?lo(t,e):w3(t,e)}function w3(t,e){t.insertionMode=We.IN_BODY,iw(t,e)}function Oke(t,e){switch(e.tagID){case G.HTML:{lo(t,e);break}case G.NOFRAMES:{Pl(t,e);break}}}function Fke(t,e){e.chars=fi,t._insertCharacters(e)}function Uke(t,e){t._insertCharacters(e),t.framesetOk=!1}function gQ(t){for(;t.treeAdapter.getNamespaceURI(t.openElements.current)!==Lt.HTML&&!t._isIntegrationPoint(t.openElements.currentTagId,t.openElements.current);)t.openElements.pop()}function Bke(t,e){if(ePe(e))gQ(t),t._startTagOutsideForeignContent(e);else{const n=t._getAdjustedCurrentElement(),r=t.treeAdapter.getNamespaceURI(n);r===Lt.MATHML?JZ(e):r===Lt.SVG&&(tPe(e),eQ(e)),OR(e),e.selfClosing?t._appendElement(e,r):t._insertElement(e,r),e.ackSelfClosing=!0}}function zke(t,e){if(e.tagID===G.P||e.tagID===G.BR){gQ(t),t._endTagOutsideForeignContent(e);return}for(let n=t.openElements.stackTop;n>0;n--){const r=t.openElements.items[n];if(t.treeAdapter.getNamespaceURI(r)===Lt.HTML){t._endTagOutsideForeignContent(e);break}const i=t.treeAdapter.getTagName(r);if(i.toLowerCase()===e.tagName){e.tagName=i,t.openElements.shortenToLength(n);break}}}ot.AREA,ot.BASE,ot.BASEFONT,ot.BGSOUND,ot.BR,ot.COL,ot.EMBED,ot.FRAME,ot.HR,ot.IMG,ot.INPUT,ot.KEYGEN,ot.LINK,ot.META,ot.PARAM,ot.SOURCE,ot.TRACK,ot.WBR;const yQ=vQ("end"),vh=vQ("start");function vQ(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}const xQ=function(t){if(t==null)return Vke;if(typeof t=="function")return lw(t);if(typeof t=="object")return Array.isArray(t)?Hke(t):Gke(t);if(typeof t=="string")return jke(t);throw new Error("Expected function, string, or object as test")};function Hke(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=xQ(t[n]);return lw(r);function r(...i){let s=-1;for(;++s<e.length;)if(e[s].apply(this,i))return!0;return!1}}function Gke(t){const e=t;return lw(n);function n(r){const i=r;let s;for(s in t)if(i[s]!==e[s])return!1;return!0}}function jke(t){return lw(e);function e(n){return n&&n.type===t}}function lw(t){return e;function e(n,r,i){return!!(Wke(n)&&t.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function Vke(){return!0}function Wke(t){return t!==null&&typeof t=="object"&&"type"in t}const _Q=[],$ke=!0,zU=!1,Xke="skip";function qke(t,e,n,r){let i;typeof e=="function"&&typeof n!="function"?(r=n,n=e):i=e;const s=xQ(i),o=r?-1:1;a(t,void 0,[])();function a(l,c,u){const f=l&&typeof l=="object"?l:{};if(typeof f.type=="string"){const h=typeof f.tagName=="string"?f.tagName:typeof f.name=="string"?f.name:void 0;Object.defineProperty(d,"name",{value:"node ("+(l.type+(h?"<"+h+">":""))+")"})}return d;function d(){let h=_Q,p,m,g;if((!e||s(l,c,u[u.length-1]||void 0))&&(h=Yke(n(l,u)),h[0]===zU))return h;if("children"in l&&l.children){const y=l;if(y.children&&h[0]!==Xke)for(m=(r?y.children.length:-1)+o,g=u.concat(y);m>-1&&m<y.children.length;){const x=y.children[m];if(p=a(x,m,g)(),p[0]===zU)return p;m=typeof p[1]=="number"?p[1]:m+o}}return h}}}function Yke(t){return Array.isArray(t)?t:typeof t=="number"?[$ke,t]:t==null?_Q:[t]}function Kke(t,e,n,r){let i,s,o;s=e,o=n,i=r,qke(t,s,a,i);function a(l,c){const u=c[c.length-1],f=u?u.children.indexOf(l):void 0;return o(l,f,u)}}const Zke=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,Qke=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),HU={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function bQ(t,e){const n=lLe(t),r=BZ("type",{handlers:{root:Jke,element:eLe,text:tLe,comment:wQ,doctype:nLe,raw:iLe},unknown:sLe}),i={parser:n?new FU(HU):FU.getFragmentParser(void 0,HU),handle(a){r(a,i)},stitches:!1,options:e||{}};r(t,i),u0(i,vh());const s=n?i.parser.document:i.parser.getFragment(),o=J7e(s,{file:i.options.file});return i.stitches&&Kke(o,"comment",function(a,l,c){const u=a;if(u.value.stitch&&c&&l!==void 0){const f=c.children;return f[l]=u.value.stitch,l}}),o.type==="root"&&o.children.length===1&&o.children[0].type===t.type?o.children[0]:o}function EQ(t,e){let n=-1;if(t)for(;++n<t.length;)e.handle(t[n])}function Jke(t,e){EQ(t.children,e)}function eLe(t,e){oLe(t,e),EQ(t.children,e),aLe(t,e)}function tLe(t,e){e.parser.tokenizer.state>4&&(e.parser.tokenizer.state=0);const n={type:ar.CHARACTER,chars:t.value,location:Qy(t)};u0(e,vh(t)),e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken)}function nLe(t,e){const n={type:ar.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:Qy(t)};u0(e,vh(t)),e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken)}function rLe(t,e){e.stitches=!0;const n=cLe(t);if("children"in t&&"children"in n){const r=bQ({type:"root",children:t.children},e.options);n.children=r.children}wQ({type:"comment",value:{stitch:n}},e)}function wQ(t,e){const n=t.value,r={type:ar.COMMENT,data:n,location:Qy(t)};u0(e,vh(t)),e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)}function iLe(t,e){if(e.parser.tokenizer.preprocessor.html="",e.parser.tokenizer.preprocessor.pos=-1,e.parser.tokenizer.preprocessor.lastGapPos=-2,e.parser.tokenizer.preprocessor.gapStack=[],e.parser.tokenizer.preprocessor.skipNextNewLine=!1,e.parser.tokenizer.preprocessor.lastChunkWritten=!1,e.parser.tokenizer.preprocessor.endOfChunkHit=!1,e.parser.tokenizer.preprocessor.isEol=!1,SQ(e,vh(t)),e.parser.tokenizer.write(e.options.tagfilter?t.value.replace(Zke,"&lt;$1$2"):t.value,!1),e.parser.tokenizer._runParsingLoop(),e.parser.tokenizer.state===72||e.parser.tokenizer.state===78){e.parser.tokenizer.preprocessor.lastChunkWritten=!0;const n=e.parser.tokenizer._consume();e.parser.tokenizer._callState(n)}}function sLe(t,e){const n=t;if(e.options.passThrough&&e.options.passThrough.includes(n.type))rLe(n,e);else{let r="";throw Qke.has(n.type)&&(r=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+n.type+"` node"+r)}}function u0(t,e){SQ(t,e);const n=t.parser.tokenizer.currentCharacterToken;n&&n.location&&(n.location.endLine=t.parser.tokenizer.preprocessor.line,n.location.endCol=t.parser.tokenizer.preprocessor.col+1,n.location.endOffset=t.parser.tokenizer.preprocessor.offset+1,t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)),t.parser.tokenizer.paused=!1,t.parser.tokenizer.inLoop=!1,t.parser.tokenizer.active=!1,t.parser.tokenizer.returnState=Bi.DATA,t.parser.tokenizer.charRefCode=-1,t.parser.tokenizer.consumedAfterSnapshot=-1,t.parser.tokenizer.currentLocation=null,t.parser.tokenizer.currentCharacterToken=null,t.parser.tokenizer.currentToken=null,t.parser.tokenizer.currentAttr={name:"",value:""}}function SQ(t,e){if(e&&e.offset!==void 0){const n={startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:-1,endCol:-1,endOffset:-1};t.parser.tokenizer.preprocessor.lineStartPos=-e.column+1,t.parser.tokenizer.preprocessor.droppedBufferSize=e.offset,t.parser.tokenizer.preprocessor.line=e.line,t.parser.tokenizer.currentLocation=n}}function oLe(t,e){const n=t.tagName.toLowerCase();if(e.parser.tokenizer.state===Bi.PLAINTEXT)return;u0(e,vh(t));const r=e.parser.openElements.current;let i="namespaceURI"in r?r.namespaceURI:Sd.html;i===Sd.html&&n==="svg"&&(i=Sd.svg);const s=iIe({...t,children:[]},{space:i===Sd.svg?"svg":"html"}),o={type:ar.START_TAG,tagName:n,tagID:c0(n),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in s?s.attrs:[],location:Qy(t)};e.parser.currentToken=o,e.parser._processToken(e.parser.currentToken),e.parser.tokenizer.lastStartTagName=n}function aLe(t,e){const n=t.tagName.toLowerCase();if(!e.parser.tokenizer.inForeignNode&&dIe.includes(n)||e.parser.tokenizer.state===Bi.PLAINTEXT)return;u0(e,yQ(t));const r={type:ar.END_TAG,tagName:n,tagID:c0(n),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:Qy(t)};e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken),n===e.parser.tokenizer.lastStartTagName&&(e.parser.tokenizer.state===Bi.RCDATA||e.parser.tokenizer.state===Bi.RAWTEXT||e.parser.tokenizer.state===Bi.SCRIPT_DATA)&&(e.parser.tokenizer.state=Bi.DATA)}function lLe(t){const e=t.type==="root"?t.children[0]:t;return!!(e&&(e.type==="doctype"||e.type==="element"&&e.tagName.toLowerCase()==="html"))}function Qy(t){const e=vh(t)||{line:void 0,column:void 0,offset:void 0},n=yQ(t)||{line:void 0,column:void 0,offset:void 0};return{startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:n.line,endCol:n.column,endOffset:n.offset}}function cLe(t){return"children"in t?vU({...t,children:[]}):vU(t)}function uLe(t){return function(e,n){return bQ(e,{...t,file:n})}}var fLe=dLe;function dLe(t){if(t)throw t}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var TQ=function(t){return t!=null&&t.constructor!=null&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)},S3=Object.prototype.hasOwnProperty,AQ=Object.prototype.toString,GU=Object.defineProperty,jU=Object.getOwnPropertyDescriptor,VU=function(t){return typeof Array.isArray=="function"?Array.isArray(t):AQ.call(t)==="[object Array]"},WU=function(t){if(!t||AQ.call(t)!=="[object Object]")return!1;var e=S3.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&S3.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!n)return!1;var r;for(r in t);return typeof r>"u"||S3.call(t,r)},$U=function(t,e){GU&&e.name==="__proto__"?GU(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},XU=function(t,e){if(e==="__proto__")if(S3.call(t,e)){if(jU)return jU(t,e).value}else return;return t[e]},hLe=function t(){var e,n,r,i,s,o,a=arguments[0],l=1,c=arguments.length,u=!1;for(typeof a=="boolean"&&(u=a,a=arguments[1]||{},l=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});l<c;++l)if(e=arguments[l],e!=null)for(n in e)r=XU(a,n),i=XU(e,n),a!==i&&(u&&i&&(WU(i)||(s=VU(i)))?(s?(s=!1,o=r&&VU(r)?r:[]):o=r&&WU(r)?r:{},$U(a,{name:n,newValue:t(u,o,i)})):typeof i<"u"&&$U(a,{name:n,newValue:i}));return a},pLe=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype},mLe=[].slice,gLe=yLe;function yLe(t,e){var n;return r;function r(){var o=mLe.call(arguments,0),a=t.length>o.length,l;a&&o.push(i);try{l=t.apply(null,o)}catch(c){if(a&&n)throw c;return i(c)}a||(l&&typeof l.then=="function"?l.then(s,i):l instanceof Error?i(l):s(l))}function i(){n||(n=!0,e.apply(null,arguments))}function s(o){i(null,o)}}var MQ=gLe,vLe=CQ;CQ.wrap=MQ;var qU=[].slice;function CQ(){var t=[],e={};return e.run=n,e.use=r,e;function n(){var i=-1,s=qU.call(arguments,0,-1),o=arguments[arguments.length-1];if(typeof o!="function")throw new Error("Expected function as last argument, not "+o);a.apply(null,[null].concat(s));function a(l){var c=t[++i],u=qU.call(arguments,0),f=u.slice(1),d=s.length,h=-1;if(l){o(l);return}for(;++h<d;)(f[h]===null||f[h]===void 0)&&(f[h]=s[h]);s=f,c?MQ(c,a).apply(null,s):o.apply(null,[null].concat(s))}}function r(i){if(typeof i!="function")throw new Error("Expected `fn` to be a function, not "+i);return t.push(i),e}}var Rp={}.hasOwnProperty,RQ=xLe;function xLe(t){return!t||typeof t!="object"?"":Rp.call(t,"position")||Rp.call(t,"type")?YU(t.position):Rp.call(t,"start")||Rp.call(t,"end")?YU(t):Rp.call(t,"line")||Rp.call(t,"column")?$M(t):""}function $M(t){return(!t||typeof t!="object")&&(t={}),KU(t.line)+":"+KU(t.column)}function YU(t){return(!t||typeof t!="object")&&(t={}),$M(t.start)+"-"+$M(t.end)}function KU(t){return t&&typeof t=="number"?t:1}var _Le=RQ,bLe=zR;function IQ(){}IQ.prototype=Error.prototype;zR.prototype=new IQ;var Cf=zR.prototype;Cf.file="";Cf.name="";Cf.reason="";Cf.message="";Cf.stack="";Cf.fatal=null;Cf.column=null;Cf.line=null;function zR(t,e,n){var r,i,s;typeof e=="string"&&(n=e,e=null),r=ELe(n),i=_Le(e)||"1:1",s={start:{line:null,column:null},end:{line:null,column:null}},e&&e.position&&(e=e.position),e&&(e.start?(s=e,e=e.start):s.start=e),t.stack&&(this.stack=t.stack,t=t.message),this.message=t,this.name=i,this.reason=t,this.line=e?e.line:null,this.column=e?e.column:null,this.location=s,this.source=r[0],this.ruleId=r[1]}function ELe(t){var e=[null,null],n;return typeof t=="string"&&(n=t.indexOf(":"),n===-1?e[1]=t:(e[0]=t.slice(0,n),e[1]=t.slice(n+1))),e}var f0={};f0.basename=wLe;f0.dirname=SLe;f0.extname=TLe;f0.join=ALe;f0.sep="/";function wLe(t,e){var n=0,r=-1,i,s,o,a;if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');if(Jy(t),i=t.length,e===void 0||!e.length||e.length>t.length){for(;i--;)if(t.charCodeAt(i)===47){if(o){n=i+1;break}}else r<0&&(o=!0,r=i+1);return r<0?"":t.slice(n,r)}if(e===t)return"";for(s=-1,a=e.length-1;i--;)if(t.charCodeAt(i)===47){if(o){n=i+1;break}}else s<0&&(o=!0,s=i+1),a>-1&&(t.charCodeAt(i)===e.charCodeAt(a--)?a<0&&(r=i):(a=-1,r=s));return n===r?r=s:r<0&&(r=t.length),t.slice(n,r)}function SLe(t){var e,n,r;if(Jy(t),!t.length)return".";for(e=-1,r=t.length;--r;)if(t.charCodeAt(r)===47){if(n){e=r;break}}else n||(n=!0);return e<0?t.charCodeAt(0)===47?"/":".":e===1&&t.charCodeAt(0)===47?"//":t.slice(0,e)}function TLe(t){var e=-1,n=0,r=-1,i=0,s,o,a;for(Jy(t),a=t.length;a--;){if(o=t.charCodeAt(a),o===47){if(s){n=a+1;break}continue}r<0&&(s=!0,r=a+1),o===46?e<0?e=a:i!==1&&(i=1):e>-1&&(i=-1)}return e<0||r<0||i===0||i===1&&e===r-1&&e===n+1?"":t.slice(e,r)}function ALe(){for(var t=-1,e;++t<arguments.length;)Jy(arguments[t]),arguments[t]&&(e=e===void 0?arguments[t]:e+"/"+arguments[t]);return e===void 0?".":MLe(e)}function MLe(t){var e,n;return Jy(t),e=t.charCodeAt(0)===47,n=CLe(t,!e),!n.length&&!e&&(n="."),n.length&&t.charCodeAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function CLe(t,e){for(var n="",r=0,i=-1,s=0,o=-1,a,l;++o<=t.length;){if(o<t.length)a=t.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(i===o-1||s===1))if(i!==o-1&&s===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=o,s=0;continue}}else if(n.length){n="",r=0,i=o,s=0;continue}}e&&(n=n.length?n+"/..":"..",r=2)}else n.length?n+="/"+t.slice(i+1,o):n=t.slice(i+1,o),r=o-i-1;i=o,s=0}else a===46&&s>-1?s++:s=-1}return n}function Jy(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}var PQ={};PQ.cwd=RLe;function RLe(){return"/"}var cc=f0,ILe=PQ,PLe=TQ,kLe=fu,LLe={}.hasOwnProperty,bA=["history","path","basename","stem","extname","dirname"];fu.prototype.toString=VLe;Object.defineProperty(fu.prototype,"path",{get:DLe,set:NLe});Object.defineProperty(fu.prototype,"dirname",{get:OLe,set:FLe});Object.defineProperty(fu.prototype,"basename",{get:ULe,set:BLe});Object.defineProperty(fu.prototype,"extname",{get:zLe,set:HLe});Object.defineProperty(fu.prototype,"stem",{get:GLe,set:jLe});function fu(t){var e,n;if(!t)t={};else if(typeof t=="string"||PLe(t))t={contents:t};else if("message"in t&&"messages"in t)return t;if(!(this instanceof fu))return new fu(t);for(this.data={},this.messages=[],this.history=[],this.cwd=ILe.cwd(),n=-1;++n<bA.length;)e=bA[n],LLe.call(t,e)&&(this[e]=t[e]);for(e in t)bA.indexOf(e)<0&&(this[e]=t[e])}function DLe(){return this.history[this.history.length-1]}function NLe(t){GR(t,"path"),this.path!==t&&this.history.push(t)}function OLe(){return typeof this.path=="string"?cc.dirname(this.path):void 0}function FLe(t){kQ(this.path,"dirname"),this.path=cc.join(t||"",this.basename)}function ULe(){return typeof this.path=="string"?cc.basename(this.path):void 0}function BLe(t){GR(t,"basename"),HR(t,"basename"),this.path=cc.join(this.dirname||"",t)}function zLe(){return typeof this.path=="string"?cc.extname(this.path):void 0}function HLe(t){if(HR(t,"extname"),kQ(this.path,"extname"),t){if(t.charCodeAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.indexOf(".",1)>-1)throw new Error("`extname` cannot contain multiple dots")}this.path=cc.join(this.dirname,this.stem+(t||""))}function GLe(){return typeof this.path=="string"?cc.basename(this.path,this.extname):void 0}function jLe(t){GR(t,"stem"),HR(t,"stem"),this.path=cc.join(this.dirname||"",t+(this.extname||""))}function VLe(t){return(this.contents||"").toString(t)}function HR(t,e){if(t&&t.indexOf(cc.sep)>-1)throw new Error("`"+e+"` cannot be a path: did not expect `"+cc.sep+"`")}function GR(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function kQ(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}var WLe=bLe,cw=kLe,$Le=cw;cw.prototype.message=XLe;cw.prototype.info=YLe;cw.prototype.fail=qLe;function XLe(t,e,n){var r=new WLe(t,e,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}function qLe(){var t=this.message.apply(this,arguments);throw t.fatal=!0,t}function YLe(){var t=this.message.apply(this,arguments);return t.fatal=null,t}var KLe=$Le,ZU=fLe,ZLe=TQ,Qx=hLe,QU=pLe,LQ=vLe,Hg=KLe,QLe=DQ().freeze(),JLe=[].slice,eDe={}.hasOwnProperty,tDe=LQ().use(nDe).use(rDe).use(iDe);function nDe(t,e){e.tree=t.parse(e.file)}function rDe(t,e,n){t.run(e.tree,e.file,r);function r(i,s,o){i?n(i):(e.tree=s,e.file=o,n())}}function iDe(t,e){var n=t.stringify(e.tree,e.file);n==null||(typeof n=="string"||ZLe(n)?("value"in e.file&&(e.file.value=n),e.file.contents=n):e.file.result=n)}function DQ(){var t=[],e=LQ(),n={},r=-1,i;return s.data=a,s.freeze=o,s.attachers=t,s.use=l,s.parse=u,s.stringify=h,s.run=f,s.runSync=d,s.process=p,s.processSync=m,s;function s(){for(var g=DQ(),y=-1;++y<t.length;)g.use.apply(null,t[y]);return g.data(Qx(!0,{},n)),g}function o(){var g,y;if(i)return s;for(;++r<t.length;)g=t[r],g[1]!==!1&&(g[1]===!0&&(g[1]=void 0),y=g[0].apply(s,g.slice(1)),typeof y=="function"&&e.use(y));return i=!0,r=1/0,s}function a(g,y){return typeof g=="string"?arguments.length===2?(SA("data",i),n[g]=y,s):eDe.call(n,g)&&n[g]||null:g?(SA("data",i),n=g,s):n}function l(g){var y;if(SA("use",i),g!=null)if(typeof g=="function")T.apply(null,arguments);else if(typeof g=="object")"length"in g?w(g):x(g);else throw new Error("Expected usable value, not `"+g+"`");return y&&(n.settings=Qx(n.settings||{},y)),s;function x(S){w(S.plugins),S.settings&&(y=Qx(y||{},S.settings))}function _(S){if(typeof S=="function")T(S);else if(typeof S=="object")"length"in S?T.apply(null,S):x(S);else throw new Error("Expected usable value, not `"+S+"`")}function w(S){var C=-1;if(S!=null)if(typeof S=="object"&&"length"in S)for(;++C<S.length;)_(S[C]);else throw new Error("Expected a list of plugins, not `"+S+"`")}function T(S,C){var A=c(S);A?(QU(A[1])&&QU(C)&&(C=Qx(!0,A[1],C)),A[1]=C):t.push(JLe.call(arguments))}}function c(g){for(var y=-1;++y<t.length;)if(t[y][0]===g)return t[y]}function u(g){var y=Hg(g),x;return o(),x=s.Parser,EA("parse",x),JU(x,"parse")?new x(String(y),y).parse():x(String(y),y)}function f(g,y,x){if(eB(g),o(),!x&&typeof y=="function"&&(x=y,y=null),!x)return new Promise(_);_(null,x);function _(w,T){e.run(g,Hg(y),S);function S(C,A,R){A=A||g,C?T(C):w?w(A):x(null,A,R)}}}function d(g,y){var x,_;return f(g,y,w),tB("runSync","run",_),x;function w(T,S){_=!0,x=S,ZU(T)}}function h(g,y){var x=Hg(y),_;return o(),_=s.Compiler,wA("stringify",_),eB(g),JU(_,"compile")?new _(g,x).compile():_(g,x)}function p(g,y){if(o(),EA("process",s.Parser),wA("process",s.Compiler),!y)return new Promise(x);x(null,y);function x(_,w){var T=Hg(g);tDe.run(s,{file:T},S);function S(C){C?w(C):_?_(T):y(null,T)}}}function m(g){var y,x;return o(),EA("processSync",s.Parser),wA("processSync",s.Compiler),y=Hg(g),p(y,_),tB("processSync","process",x),y;function _(w){x=!0,ZU(w)}}}function JU(t,e){return typeof t=="function"&&t.prototype&&(sDe(t.prototype)||e in t.prototype)}function sDe(t){var e;for(e in t)return!0;return!1}function EA(t,e){if(typeof e!="function")throw new Error("Cannot `"+t+"` without `Parser`")}function wA(t,e){if(typeof e!="function")throw new Error("Cannot `"+t+"` without `Compiler`")}function SA(t,e){if(e)throw new Error("Cannot invoke `"+t+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function eB(t){if(!t||typeof t.type!="string")throw new Error("Expected node, got `"+t+"`")}function tB(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}const oDe=mu(QLe);var aDe=NQ;function NQ(t){return t&&(t.value||t.alt||t.title||"children"in t&&nB(t.children)||"length"in t&&nB(t))||""}function nB(t){for(var e=[],n=-1;++n<t.length;)e[n]=NQ(t[n]);return e.join("")}var lDe=Object.assign,ev=lDe,cDe={}.hasOwnProperty,OQ=cDe;function uDe(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}var jR=uDe,fDe=String.fromCharCode,uw=fDe,dDe=uw;function hDe(t,e){var n=parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":dDe(n)}var pDe=hDe,VR={};function mDe(t){return t<-2}var hs=mDe;function gDe(t){return t===-2||t===-1||t===32}var vu=gDe,rB=vu;function yDe(t,e,n,r){var i=r?r-1:1/0,s=0;return o;function o(l){return rB(l)?(t.enter(n),a(l)):e(l)}function a(l){return rB(l)&&s++<i?(t.consume(l),a):(t.exit(n),e(l))}}var Vs=yDe;Object.defineProperty(VR,"__esModule",{value:!0});var vDe=hs,xDe=Vs,_De=bDe;function bDe(t){var e=t.attempt(this.parser.constructs.contentInitial,r,i),n;return e;function r(a){if(a===null){t.consume(a);return}return t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),xDe(t,e,"linePrefix")}function i(a){return t.enter("paragraph"),s(a)}function s(a){var l=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,o(a)}function o(a){if(a===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(a);return}return vDe(a)?(t.consume(a),t.exit("chunkText"),s):(t.consume(a),o)}}VR.tokenize=_De;var WR={},EDe=hs,wDe=Vs,SDe={tokenize:TDe,partial:!0};function TDe(t,e,n){return wDe(t,r,"linePrefix");function r(i){return i===null||EDe(i)?e(i):n(i)}}var fw=SDe;Object.defineProperty(WR,"__esModule",{value:!0});var ADe=hs,FQ=Vs,MDe=fw,CDe=IDe,TA={tokenize:PDe},RDe={tokenize:kDe};function IDe(t){var e=this,n=[],r=0,i={tokenize:y,partial:!0},s,o,a;return l;function l(x){return r<n.length?(e.containerState=n[r][1],t.attempt(n[r][0].continuation,c,u)(x)):u(x)}function c(x){return r++,l(x)}function u(x){return s&&s.flowContinue?d(x):(e.interrupt=o&&o.currentConstruct&&o.currentConstruct.interruptible,e.containerState={},t.attempt(TA,f,d)(x))}function f(x){return n.push([e.currentConstruct,e.containerState]),e.containerState=void 0,u(x)}function d(x){if(x===null){g(0,!0),t.consume(x);return}return o=o||e.parser.flow(e.now()),t.enter("chunkFlow",{contentType:"flow",previous:a,_tokenizer:o}),h(x)}function h(x){return x===null?(m(t.exit("chunkFlow")),d(x)):ADe(x)?(t.consume(x),m(t.exit("chunkFlow")),t.check(i,p)):(t.consume(x),h)}function p(x){return g(s.continued,s&&s.flowEnd),r=0,l(x)}function m(x){a&&(a.next=x),a=x,o.lazy=s&&s.lazy,o.defineSkip(x.start),o.write(e.sliceStream(x))}function g(x,_){var w=n.length;for(o&&_&&(o.write([null]),a=o=void 0);w-- >x;)e.containerState=n[w][1],n[w][0].exit.call(e,t);n.length=x}function y(x,_){var w=0;return s={},T;function T(D){return w<n.length?(e.containerState=n[w][1],x.attempt(n[w][0].continuation,S,C)(D)):o.currentConstruct&&o.currentConstruct.concrete?(s.flowContinue=!0,M(D)):(e.interrupt=o.currentConstruct&&o.currentConstruct.interruptible,e.containerState={},x.attempt(TA,R,M)(D))}function S(D){return w++,e.containerState._closeFlow?R(D):T(D)}function C(D){return o.currentConstruct&&o.currentConstruct.lazy?(e.containerState={},x.attempt(TA,R,x.attempt(RDe,R,x.check(MDe,R,A)))(D)):R(D)}function A(D){return w=n.length,s.lazy=!0,s.flowContinue=!0,M(D)}function R(D){return s.flowEnd=!0,M(D)}function M(D){return s.continued=w,e.interrupt=e.containerState=void 0,_(D)}}}function PDe(t,e,n){return FQ(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function kDe(t,e,n){return FQ(t,t.lazy(this.parser.constructs.flow,e,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}WR.tokenize=CDe;var $R={};function LDe(t){for(var e=-1,n=0;++e<t.length;)n+=typeof t[e]=="string"?t[e].length:1;return n}var UQ=LDe,DDe=UQ;function NDe(t,e){var n=t[t.length-1];return!n||n[1].type!==e?0:DDe(n[2].sliceStream(n[1]))}var dw=NDe,ODe=[].splice,FDe=ODe,AA=FDe;function UDe(t,e,n,r){var i=t.length,s=0,o;if(e<0?e=-e>i?0:i+e:e=e>i?i:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),AA.apply(t,o);else for(n&&AA.apply(t,[e,n]);s<r.length;)o=r.slice(s,s+1e4),o.unshift(e,0),AA.apply(t,o),s+=1e4,e+=1e4}var Rf=UDe,BDe=ev;function zDe(t){return BDe({},t)}var d0=zDe,HDe=ev,BQ=Rf,GDe=d0;function jDe(t){for(var e={},n=-1,r,i,s,o,a,l,c;++n<t.length;){for(;n in e;)n=e[n];if(r=t[n],n&&r[1].type==="chunkFlow"&&t[n-1][1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1].isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(HDe(e,VDe(t,n)),n=e[n],c=!0);else if(r[1]._container||r[1]._movePreviousLineEndings){for(s=n,i=void 0;s--&&(o=t[s],o[1].type==="lineEnding"||o[1].type==="lineEndingBlank");)o[0]==="enter"&&(i&&(t[i][1].type="lineEndingBlank"),o[1].type="lineEnding",i=s);i&&(r[1].end=GDe(t[i][1].start),a=t.slice(i,n),a.unshift(r),BQ(t,i,n-i+1,a))}}return!c}function VDe(t,e){for(var n=t[e][1],r=t[e][2],i=e-1,s=[],o=n._tokenizer||r.parser[n.contentType](n.start),a=o.events,l=[],c={},u,f,d,h,p,m;n;){for(;t[++i][1]!==n;);s.push(i),n._tokenizer||(u=r.sliceStream(n),n.next||u.push(null),f&&o.defineSkip(n.start),n.isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(u),n.isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),f=n,n=n.next}for(n=f,d=a.length;d--;)a[d][0]==="enter"?h=!0:h&&a[d][1].type===a[d-1][1].type&&a[d][1].start.line!==a[d][1].end.line&&(g(a.slice(d+1,p)),n._tokenizer=n.next=void 0,n=n.previous,p=d+1);for(o.events=n._tokenizer=n.next=void 0,g(a.slice(0,p)),d=-1,m=0;++d<l.length;)c[m+l[d][0]]=m+l[d][1],m+=l[d][1]-l[d][0]-1;return c;function g(y){var x=s.pop();l.unshift([x,x+y.length-1]),BQ(t,x,2,y)}}var zQ=jDe,HQ=hs,WDe=dw,$De=zQ,XDe=Vs,qDe={tokenize:ZDe,resolve:KDe,interruptible:!0,lazy:!0},YDe={tokenize:QDe,partial:!0};function KDe(t){return $De(t),t}function ZDe(t,e){var n;return r;function r(a){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),i(a)}function i(a){return a===null?s(a):HQ(a)?t.check(YDe,o,s)(a):(t.consume(a),i)}function s(a){return t.exit("chunkContent"),t.exit("content"),e(a)}function o(a){return t.consume(a),t.exit("chunkContent"),n=n.next=t.enter("chunkContent",{contentType:"content",previous:n}),i}}function QDe(t,e,n){var r=this;return i;function i(o){return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),XDe(t,s,"linePrefix")}function s(o){return o===null||HQ(o)?n(o):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||WDe(r.events,"linePrefix")<4?t.interrupt(r.parser.constructs.flow,n,e)(o):e(o)}}var JDe=qDe;Object.defineProperty($R,"__esModule",{value:!0});var eNe=JDe,tNe=Vs,nNe=fw,rNe=iNe;function iNe(t){var e=this,n=t.attempt(nNe,r,t.attempt(this.parser.constructs.flowInitial,i,tNe(t,t.attempt(this.parser.constructs.flow,i,t.attempt(eNe,i)),"linePrefix")));return n;function r(s){if(s===null){t.consume(s);return}return t.enter("lineEndingBlank"),t.consume(s),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function i(s){if(s===null){t.consume(s);return}return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),e.currentConstruct=void 0,n}}$R.tokenize=rNe;var h0={};Object.defineProperty(h0,"__esModule",{value:!0});var sNe=ev,iB=d0,oNe=GQ("text"),aNe=GQ("string"),lNe={resolveAll:jQ()};function GQ(t){return{tokenize:e,resolveAll:jQ(t==="text"?cNe:void 0)};function e(n){var r=this,i=this.parser.constructs[t],s=n.attempt(i,o,a);return o;function o(u){return c(u)?s(u):a(u)}function a(u){if(u===null){n.consume(u);return}return n.enter("data"),n.consume(u),l}function l(u){return c(u)?(n.exit("data"),s(u)):(n.consume(u),l)}function c(u){var f=i[u],d=-1;if(u===null)return!0;if(f){for(;++d<f.length;)if(!f[d].previous||f[d].previous.call(r,r.previous))return!0}}}}function jQ(t){return e;function e(n,r){for(var i=-1,s;++i<=n.length;)s===void 0?n[i]&&n[i][1].type==="data"&&(s=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==s+2&&(n[s][1].end=n[i-1][1].end,n.splice(s+2,i-s-2),i=s+2),s=void 0);return t?t(n,r):n}}function cNe(t,e){for(var n=-1,r,i,s,o,a,l,c,u;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){for(i=t[n-1][1],r=e.sliceStream(i),o=r.length,a=-1,l=0,c=void 0;o--;)if(s=r[o],typeof s=="string"){for(a=s.length;s.charCodeAt(a-1)===32;)l++,a--;if(a)break;a=-1}else if(s===-2)c=!0,l++;else if(s!==-1){o++;break}l&&(u={type:n===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{line:i.end.line,column:i.end.column-l,offset:i.end.offset-l,_index:i.start._index+o,_bufferIndex:o?a:i.start._bufferIndex+a},end:iB(i.end)},i.end=iB(u.start),i.start.offset===i.end.offset?sNe(i,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)),n++}return t}h0.resolver=lNe;h0.string=aNe;h0.text=oNe;function uNe(t){return t==null?[]:"length"in t?t:[t]}var XR=uNe,sB=OQ,fNe=Rf,dNe=XR;function hNe(t){for(var e={},n=-1;++n<t.length;)pNe(e,t[n]);return e}function pNe(t,e){var n,r,i,s;for(n in e){r=sB.call(t,n)?t[n]:t[n]={},i=e[n];for(s in i)r[s]=mNe(dNe(i[s]),sB.call(r,s)?r[s]:[])}}function mNe(t,e){for(var n=-1,r=[];++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);return fNe(e,0,0,r),e}var gNe=hNe,yNe=Rf;function vNe(t,e){return t.length?(yNe(t,t.length,0,e),t):e}var qR=vNe;function xNe(t,e,n){for(var r=[],i=-1,s;++i<t.length;)s=t[i].resolveAll,s&&r.indexOf(s)<0&&(e=s(e,n),r.push(s));return e}var YR=xNe,_Ne=uw;function bNe(t){for(var e=-1,n=[],r,i,s;++e<t.length;){if(r=t[e],typeof r=="string")i=r;else if(r===-5)i="\r";else if(r===-4)i=`
`;else if(r===-3)i=`\r
`;else if(r===-2)i="	";else if(r===-1){if(s)continue;i=" "}else i=_Ne(r);s=r===-2,n.push(i)}return n.join("")}var ENe=bNe;function wNe(t,e){var n=e.start._index,r=e.start._bufferIndex,i=e.end._index,s=e.end._bufferIndex,o;return n===i?o=[t[n].slice(r,s)]:(o=t.slice(n,i),r>-1&&(o[0]=o[0].slice(r)),s>0&&o.push(t[i].slice(0,s))),o}var SNe=wNe,TNe=ev,ANe=hs,MNe=qR,CNe=Rf,MA=XR,RNe=YR,INe=ENe,oB=d0,PNe=SNe;function kNe(t,e,n){var r=n?oB(n):{line:1,column:1,offset:0},i={},s=[],o=[],a=[],l={consume:x,enter:_,exit:w,attempt:C(T),check:C(S),interrupt:C(S,{interrupt:!0}),lazy:C(S,{lazy:!0})},c={previous:null,events:[],parser:t,sliceStream:h,sliceSerialize:d,now:p,defineSkip:m,write:f},u=e.tokenize.call(c,l);return e.resolveAll&&s.push(e),r._index=0,r._bufferIndex=-1,c;function f(D){return o=MNe(o,D),g(),o[o.length-1]!==null?[]:(A(e,0),c.events=RNe(s,c.events,c),c.events)}function d(D){return INe(h(D))}function h(D){return PNe(o,D)}function p(){return oB(r)}function m(D){i[D.line]=D.column,M()}function g(){for(var D,k;r._index<o.length;)if(k=o[r._index],typeof k=="string")for(D=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===D&&r._bufferIndex<k.length;)y(k.charCodeAt(r._bufferIndex));else y(k)}function y(D){u=u(D)}function x(D){ANe(D)?(r.line++,r.column=1,r.offset+=D===-3?2:1,M()):D!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),c.previous=D}function _(D,k){var L=k||{};return L.type=D,L.start=p(),c.events.push(["enter",L,c]),a.push(L),L}function w(D){var k=a.pop();return k.end=p(),c.events.push(["exit",k,c]),k}function T(D,k){A(D,k.from)}function S(D,k){k.restore()}function C(D,k){return L;function L(N,z,O){var K,V,ne,re;return N.tokenize||"length"in N?se(MA(N)):P;function P(X){return X in N||null in N?se(N.null?MA(N[X]).concat(MA(N.null)):N[X])(X):O(X)}function se(X){return K=X,V=0,ue(X[V])}function ue(X){return J;function J(oe){return re=R(),ne=X,X.partial||(c.currentConstruct=X),X.name&&c.parser.constructs.disable.null.indexOf(X.name)>-1?W():X.tokenize.call(k?TNe({},c,k):c,l,te,W)(oe)}}function te(X){return D(ne,re),z}function W(X){return re.restore(),++V<K.length?ue(K[V]):O}}}function A(D,k){D.resolveAll&&s.indexOf(D)<0&&s.push(D),D.resolve&&CNe(c.events,k,c.events.length-k,D.resolve(c.events.slice(k),c)),D.resolveTo&&(c.events=D.resolveTo(c.events,c))}function R(){var D=p(),k=c.previous,L=c.currentConstruct,N=c.events.length,z=Array.from(a);return{restore:O,from:N};function O(){r=D,c.previous=k,c.currentConstruct=L,c.events.length=N,a=z,M()}}function M(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}var LNe=kNe,hc={};function DNe(t){return t<0||t===32}var If=DNe,NNe=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,ONe=NNe,FNe=uw;function UNe(t){return e;function e(n){return t.test(FNe(n))}}var Pf=UNe,BNe=ONe,zNe=Pf,HNe=zNe(BNe),GNe=HNe,jNe=Pf,VNe=jNe(/\s/),WNe=VNe,$Ne=If,XNe=GNe,qNe=WNe;function YNe(t){if(t===null||$Ne(t)||qNe(t))return 1;if(XNe(t))return 2}var KNe=YNe;function ZNe(t,e){return t.column+=e,t.offset+=e,t._bufferIndex+=e,t}var QNe=ZNe,Gg=qR,JNe=Rf,aB=KNe,lB=QNe,eOe=YR,Hl=d0,tOe={name:"attention",tokenize:rOe,resolveAll:nOe};function nOe(t,e){for(var n=-1,r,i,s,o,a,l,c,u;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;l=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1,o={type:l>1?"strongSequence":"emphasisSequence",start:lB(Hl(t[r][1].end),-l),end:Hl(t[r][1].end)},a={type:l>1?"strongSequence":"emphasisSequence",start:Hl(t[n][1].start),end:lB(Hl(t[n][1].start),l)},s={type:l>1?"strongText":"emphasisText",start:Hl(t[r][1].end),end:Hl(t[n][1].start)},i={type:l>1?"strong":"emphasis",start:Hl(o.start),end:Hl(a.end)},t[r][1].end=Hl(o.start),t[n][1].start=Hl(a.end),c=[],t[r][1].end.offset-t[r][1].start.offset&&(c=Gg(c,[["enter",t[r][1],e],["exit",t[r][1],e]])),c=Gg(c,[["enter",i,e],["enter",o,e],["exit",o,e],["enter",s,e]]),c=Gg(c,eOe(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),c=Gg(c,[["exit",s,e],["enter",a,e],["exit",a,e],["exit",i,e]]),t[n][1].end.offset-t[n][1].start.offset?(u=2,c=Gg(c,[["enter",t[n][1],e],["exit",t[n][1],e]])):u=0,JNe(t,r-1,n-r+3,c),n=r+c.length-u-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function rOe(t,e){var n=aB(this.previous),r;return i;function i(o){return t.enter("attentionSequence"),r=o,s(o)}function s(o){var a,l,c,u;return o===r?(t.consume(o),s):(a=t.exit("attentionSequence"),l=aB(o),c=!l||l===2&&n,u=!n||n===2&&l,a._open=r===42?c:c&&(n||!u),a._close=r===42?u:u&&(l||!c),e(o))}}var iOe=tOe,sOe=Pf,oOe=sOe(/[A-Za-z]/),KR=oOe,aOe=Pf,lOe=aOe(/[\dA-Za-z]/),hw=lOe,cOe=Pf,uOe=cOe(/[#-'*+\--9=?A-Z^-~]/),fOe=uOe;function dOe(t){return t<32||t===127}var VQ=dOe,hOe=KR,Jx=hw,cB=fOe,pOe=VQ,mOe={name:"autolink",tokenize:gOe};function gOe(t,e,n){var r=1;return i;function i(p){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),s}function s(p){return hOe(p)?(t.consume(p),o):cB(p)?c(p):n(p)}function o(p){return p===43||p===45||p===46||Jx(p)?a(p):c(p)}function a(p){return p===58?(t.consume(p),l):(p===43||p===45||p===46||Jx(p))&&r++<32?(t.consume(p),a):c(p)}function l(p){return p===62?(t.exit("autolinkProtocol"),h(p)):p===32||p===60||pOe(p)?n(p):(t.consume(p),l)}function c(p){return p===64?(t.consume(p),r=0,u):cB(p)?(t.consume(p),c):n(p)}function u(p){return Jx(p)?f(p):n(p)}function f(p){return p===46?(t.consume(p),r=0,u):p===62?(t.exit("autolinkProtocol").type="autolinkEmail",h(p)):d(p)}function d(p){return(p===45||Jx(p))&&r++<63?(t.consume(p),p===45?d:f):n(p)}function h(p){return t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.exit("autolink"),e}}var yOe=mOe,vOe=vu,xOe=Vs,WQ={name:"blockQuote",tokenize:_Oe,continuation:{tokenize:bOe},exit:EOe};function _Oe(t,e,n){var r=this;return i;function i(o){return o===62?(r.containerState.open||(t.enter("blockQuote",{_container:!0}),r.containerState.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),s):n(o)}function s(o){return vOe(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function bOe(t,e,n){return xOe(t,t.attempt(WQ,e,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function EOe(t){t.exit("blockQuote")}var wOe=WQ,SOe=Pf,TOe=SOe(/[!-/:-@[-`{-~]/),AOe=TOe,MOe=AOe,COe={name:"characterEscape",tokenize:ROe};function ROe(t,e,n){return r;function r(s){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(s),t.exit("escapeMarker"),i}function i(s){return MOe(s)?(t.enter("characterEscapeValue"),t.consume(s),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(s)}}var IOe=COe,e3,POe=59,$Q=kOe;function kOe(t){var e="&"+t+";",n;return e3=e3||document.createElement("i"),e3.innerHTML=e,n=e3.textContent,n.charCodeAt(n.length-1)===POe&&t!=="semi"||n===e?!1:n}var LOe=Pf,DOe=LOe(/\d/),XQ=DOe,NOe=Pf,OOe=NOe(/[\dA-Fa-f]/),FOe=OOe,UOe=$Q,uB=hw,BOe=XQ,zOe=FOe;function HOe(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var GOe=HOe(UOe),jOe={name:"characterReference",tokenize:VOe};function VOe(t,e,n){var r=this,i=0,s,o;return a;function a(f){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(f),t.exit("characterReferenceMarker"),l}function l(f){return f===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(f),t.exit("characterReferenceMarkerNumeric"),c):(t.enter("characterReferenceValue"),s=31,o=uB,u(f))}function c(f){return f===88||f===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(f),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),s=6,o=zOe,u):(t.enter("characterReferenceValue"),s=7,o=BOe,u(f))}function u(f){var d;return f===59&&i?(d=t.exit("characterReferenceValue"),o===uB&&!GOe.default(r.sliceSerialize(d))?n(f):(t.enter("characterReferenceMarker"),t.consume(f),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)):o(f)&&i++<s?(t.consume(f),u):n(f)}}var WOe=jOe,Ip=hs,$Oe=If,XOe=dw,jg=Vs,qOe={name:"codeFenced",tokenize:YOe,concrete:!0};function YOe(t,e,n){var r=this,i={tokenize:x,partial:!0},s=XOe(this.events,"linePrefix"),o=0,a;return l;function l(_){return t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),a=_,c(_)}function c(_){return _===a?(t.consume(_),o++,c):(t.exit("codeFencedFenceSequence"),o<3?n(_):jg(t,u,"whitespace")(_))}function u(_){return _===null||Ip(_)?p(_):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(_))}function f(_){return _===null||$Oe(_)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),jg(t,d,"whitespace")(_)):_===96&&_===a?n(_):(t.consume(_),f)}function d(_){return _===null||Ip(_)?p(_):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),h(_))}function h(_){return _===null||Ip(_)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),p(_)):_===96&&_===a?n(_):(t.consume(_),h)}function p(_){return t.exit("codeFencedFence"),r.interrupt?e(_):m(_)}function m(_){return _===null?y(_):Ip(_)?(t.enter("lineEnding"),t.consume(_),t.exit("lineEnding"),t.attempt(i,y,s?jg(t,m,"linePrefix",s+1):m)):(t.enter("codeFlowValue"),g(_))}function g(_){return _===null||Ip(_)?(t.exit("codeFlowValue"),m(_)):(t.consume(_),g)}function y(_){return t.exit("codeFenced"),e(_)}function x(_,w,T){var S=0;return jg(_,C,"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function C(M){return _.enter("codeFencedFence"),_.enter("codeFencedFenceSequence"),A(M)}function A(M){return M===a?(_.consume(M),S++,A):S<o?T(M):(_.exit("codeFencedFenceSequence"),jg(_,R,"whitespace")(M))}function R(M){return M===null||Ip(M)?(_.exit("codeFencedFence"),w(M)):T(M)}}}var KOe=qOe,XM=hs,fB=Rf,ZOe=dw,dB=Vs,QOe={name:"codeIndented",tokenize:eFe,resolve:JOe},hB={tokenize:tFe,partial:!0};function JOe(t,e){var n={type:"codeIndented",start:t[0][1].start,end:t[t.length-1][1].end};return fB(t,0,0,[["enter",n,e]]),fB(t,t.length,0,[["exit",n,e]]),t}function eFe(t,e,n){return t.attempt(hB,r,n);function r(s){return s===null?e(s):XM(s)?t.attempt(hB,r,e)(s):(t.enter("codeFlowValue"),i(s))}function i(s){return s===null||XM(s)?(t.exit("codeFlowValue"),r(s)):(t.consume(s),i)}}function tFe(t,e,n){var r=this;return dB(t,i,"linePrefix",5);function i(s){return XM(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),dB(t,i,"linePrefix",5)):ZOe(r.events,"linePrefix")<4?n(s):e(s)}}var nFe=QOe,pB=hs,rFe={name:"codeText",tokenize:oFe,resolve:iFe,previous:sFe};function iFe(t){var e=t.length-4,n=3,r,i;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[e][1].type=t[n][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)i===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(i=r):(r===e||t[r][1].type==="lineEnding")&&(t[i][1].type="codeTextData",r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),e-=r-i-2,r=i+2),i=void 0);return t}function sFe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function oFe(t,e,n){var r=0,i,s;return o;function o(f){return t.enter("codeText"),t.enter("codeTextSequence"),a(f)}function a(f){return f===96?(t.consume(f),r++,a):(t.exit("codeTextSequence"),l(f))}function l(f){return f===null?n(f):f===96?(s=t.enter("codeTextSequence"),i=0,u(f)):f===32?(t.enter("space"),t.consume(f),t.exit("space"),l):pB(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),l):(t.enter("codeTextData"),c(f))}function c(f){return f===null||f===32||f===96||pB(f)?(t.exit("codeTextData"),l(f)):(t.consume(f),c)}function u(f){return f===96?(t.consume(f),i++,u):i===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(f)):(s.type="codeTextData",c(f))}}var aFe=rFe,mB=VQ,lFe=If,cFe=hs;function uFe(t,e,n,r,i,s,o,a,l){var c=l||1/0,u=0;return f;function f(y){return y===60?(t.enter(r),t.enter(i),t.enter(s),t.consume(y),t.exit(s),d):mB(y)||y===41?n(y):(t.enter(r),t.enter(o),t.enter(a),t.enter("chunkString",{contentType:"string"}),m(y))}function d(y){return y===62?(t.enter(s),t.consume(y),t.exit(s),t.exit(i),t.exit(r),e):(t.enter(a),t.enter("chunkString",{contentType:"string"}),h(y))}function h(y){return y===62?(t.exit("chunkString"),t.exit(a),d(y)):y===null||y===60||cFe(y)?n(y):(t.consume(y),y===92?p:h)}function p(y){return y===60||y===62||y===92?(t.consume(y),h):h(y)}function m(y){return y===40?++u>c?n(y):(t.consume(y),m):y===41?u--?(t.consume(y),m):(t.exit("chunkString"),t.exit(a),t.exit(o),t.exit(r),e(y)):y===null||lFe(y)?u?n(y):(t.exit("chunkString"),t.exit(a),t.exit(o),t.exit(r),e(y)):mB(y)?n(y):(t.consume(y),y===92?g:m)}function g(y){return y===40||y===41||y===92?(t.consume(y),m):m(y)}}var qQ=uFe,gB=hs,fFe=vu;function dFe(t,e,n,r,i,s){var o=this,a=0,l;return c;function c(h){return t.enter(r),t.enter(i),t.consume(h),t.exit(i),t.enter(s),u}function u(h){return h===null||h===91||h===93&&!l||h===94&&!a&&"_hiddenFootnoteSupport"in o.parser.constructs||a>999?n(h):h===93?(t.exit(s),t.enter(i),t.consume(h),t.exit(i),t.exit(r),e):gB(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),u):(t.enter("chunkString",{contentType:"string"}),f(h))}function f(h){return h===null||h===91||h===93||gB(h)||a++>999?(t.exit("chunkString"),u(h)):(t.consume(h),l=l||!fFe(h),h===92?d:f)}function d(h){return h===91||h===92||h===93?(t.consume(h),a++,f):f(h)}}var YQ=dFe,hFe=hs,pFe=vu,mFe=Vs;function gFe(t,e){var n;return r;function r(i){return hFe(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),n=!0,r):pFe(i)?mFe(t,r,n?"linePrefix":"lineSuffix")(i):e(i)}}var KQ=gFe,yB=hs,yFe=Vs;function vFe(t,e,n,r,i,s){var o;return a;function a(d){return t.enter(r),t.enter(i),t.consume(d),t.exit(i),o=d===40?41:d,l}function l(d){return d===o?(t.enter(i),t.consume(d),t.exit(i),t.exit(r),e):(t.enter(s),c(d))}function c(d){return d===o?(t.exit(s),l(o)):d===null?n(d):yB(d)?(t.enter("lineEnding"),t.consume(d),t.exit("lineEnding"),yFe(t,c,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),u(d))}function u(d){return d===o||d===null||yB(d)?(t.exit("chunkString"),c(d)):(t.consume(d),d===92?f:u)}function f(d){return d===o||d===92?(t.consume(d),u):u(d)}}var ZQ=vFe,QQ=hs,xFe=If,_Fe=jR,bFe=qQ,EFe=YQ,qM=Vs,JQ=KQ,wFe=ZQ,SFe={name:"definition",tokenize:AFe},TFe={tokenize:MFe,partial:!0};function AFe(t,e,n){var r=this,i;return s;function s(l){return t.enter("definition"),EFe.call(r,t,o,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(l)}function o(l){return i=_Fe(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),l===58?(t.enter("definitionMarker"),t.consume(l),t.exit("definitionMarker"),JQ(t,bFe(t,t.attempt(TFe,qM(t,a,"whitespace"),qM(t,a,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(l)}function a(l){return l===null||QQ(l)?(t.exit("definition"),r.parser.defined.indexOf(i)<0&&r.parser.defined.push(i),e(l)):n(l)}}function MFe(t,e,n){return r;function r(o){return xFe(o)?JQ(t,i)(o):n(o)}function i(o){return o===34||o===39||o===40?wFe(t,qM(t,s,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(o):n(o)}function s(o){return o===null||QQ(o)?e(o):n(o)}}var CFe=SFe,RFe=hs,IFe={name:"hardBreakEscape",tokenize:PFe};function PFe(t,e,n){return r;function r(s){return t.enter("hardBreakEscape"),t.enter("escapeMarker"),t.consume(s),i}function i(s){return RFe(s)?(t.exit("escapeMarker"),t.exit("hardBreakEscape"),e(s)):n(s)}}var kFe=IFe,LFe=hs,vB=If,DFe=vu,NFe=Rf,OFe=Vs,FFe={name:"headingAtx",tokenize:BFe,resolve:UFe};function UFe(t,e){var n=t.length-2,r=3,i,s;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},s={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},NFe(t,r,n-r+1,[["enter",i,e],["enter",s,e],["exit",s,e],["exit",i,e]])),t}function BFe(t,e,n){var r=this,i=0;return s;function s(u){return t.enter("atxHeading"),t.enter("atxHeadingSequence"),o(u)}function o(u){return u===35&&i++<6?(t.consume(u),o):u===null||vB(u)?(t.exit("atxHeadingSequence"),r.interrupt?e(u):a(u)):n(u)}function a(u){return u===35?(t.enter("atxHeadingSequence"),l(u)):u===null||LFe(u)?(t.exit("atxHeading"),e(u)):DFe(u)?OFe(t,a,"whitespace")(u):(t.enter("atxHeadingText"),c(u))}function l(u){return u===35?(t.consume(u),l):(t.exit("atxHeadingSequence"),a(u))}function c(u){return u===null||u===35||vB(u)?(t.exit("atxHeadingText"),a(u)):(t.consume(u),c)}}var zFe=FFe,HFe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],GFe=HFe,jFe=["pre","script","style","textarea"],VFe=jFe,Vg=KR,xB=hw,Pp=hs,_B=If,kp=vu,t3=uw,WFe=GFe,bB=VFe,$Fe=fw,XFe={name:"htmlFlow",tokenize:KFe,resolveTo:YFe,concrete:!0},qFe={tokenize:ZFe,partial:!0};function YFe(t){for(var e=t.length;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function KFe(t,e,n){var r=this,i,s,o,a,l;return c;function c(P){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(P),u}function u(P){return P===33?(t.consume(P),f):P===47?(t.consume(P),p):P===63?(t.consume(P),i=3,r.interrupt?e:V):Vg(P)?(t.consume(P),o=t3(P),s=!0,m):n(P)}function f(P){return P===45?(t.consume(P),i=2,d):P===91?(t.consume(P),i=5,o="CDATA[",a=0,h):Vg(P)?(t.consume(P),i=4,r.interrupt?e:V):n(P)}function d(P){return P===45?(t.consume(P),r.interrupt?e:V):n(P)}function h(P){return P===o.charCodeAt(a++)?(t.consume(P),a===o.length?r.interrupt?e:D:h):n(P)}function p(P){return Vg(P)?(t.consume(P),o=t3(P),m):n(P)}function m(P){return P===null||P===47||P===62||_B(P)?P!==47&&s&&bB.indexOf(o.toLowerCase())>-1?(i=1,r.interrupt?e(P):D(P)):WFe.indexOf(o.toLowerCase())>-1?(i=6,P===47?(t.consume(P),g):r.interrupt?e(P):D(P)):(i=7,r.interrupt?n(P):s?x(P):y(P)):P===45||xB(P)?(t.consume(P),o+=t3(P),m):n(P)}function g(P){return P===62?(t.consume(P),r.interrupt?e:D):n(P)}function y(P){return kp(P)?(t.consume(P),y):R(P)}function x(P){return P===47?(t.consume(P),R):P===58||P===95||Vg(P)?(t.consume(P),_):kp(P)?(t.consume(P),x):R(P)}function _(P){return P===45||P===46||P===58||P===95||xB(P)?(t.consume(P),_):w(P)}function w(P){return P===61?(t.consume(P),T):kp(P)?(t.consume(P),w):x(P)}function T(P){return P===null||P===60||P===61||P===62||P===96?n(P):P===34||P===39?(t.consume(P),l=P,S):kp(P)?(t.consume(P),T):(l=void 0,C(P))}function S(P){return P===l?(t.consume(P),A):P===null||Pp(P)?n(P):(t.consume(P),S)}function C(P){return P===null||P===34||P===39||P===60||P===61||P===62||P===96||_B(P)?w(P):(t.consume(P),C)}function A(P){return P===47||P===62||kp(P)?x(P):n(P)}function R(P){return P===62?(t.consume(P),M):n(P)}function M(P){return kp(P)?(t.consume(P),M):P===null||Pp(P)?D(P):n(P)}function D(P){return P===45&&i===2?(t.consume(P),N):P===60&&i===1?(t.consume(P),z):P===62&&i===4?(t.consume(P),ne):P===63&&i===3?(t.consume(P),V):P===93&&i===5?(t.consume(P),K):Pp(P)&&(i===6||i===7)?t.check(qFe,ne,k)(P):P===null||Pp(P)?k(P):(t.consume(P),D)}function k(P){return t.exit("htmlFlowData"),L(P)}function L(P){return P===null?re(P):Pp(P)?(t.enter("lineEnding"),t.consume(P),t.exit("lineEnding"),L):(t.enter("htmlFlowData"),D(P))}function N(P){return P===45?(t.consume(P),V):D(P)}function z(P){return P===47?(t.consume(P),o="",O):D(P)}function O(P){return P===62&&bB.indexOf(o.toLowerCase())>-1?(t.consume(P),ne):Vg(P)&&o.length<8?(t.consume(P),o+=t3(P),O):D(P)}function K(P){return P===93?(t.consume(P),V):D(P)}function V(P){return P===62?(t.consume(P),ne):D(P)}function ne(P){return P===null||Pp(P)?(t.exit("htmlFlowData"),re(P)):(t.consume(P),ne)}function re(P){return t.exit("htmlFlow"),e(P)}}function ZFe(t,e,n){return r;function r(i){return t.exit("htmlFlowData"),t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),t.attempt($Fe,e,n)}}var QFe=XFe,n3=KR,CA=hw,Pc=hs,RA=If,r3=vu,JFe=Vs,eUe={name:"htmlText",tokenize:tUe};function tUe(t,e,n){var r=this,i,s,o,a;return l;function l(P){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(P),c}function c(P){return P===33?(t.consume(P),u):P===47?(t.consume(P),C):P===63?(t.consume(P),T):n3(P)?(t.consume(P),M):n(P)}function u(P){return P===45?(t.consume(P),f):P===91?(t.consume(P),s="CDATA[",o=0,g):n3(P)?(t.consume(P),w):n(P)}function f(P){return P===45?(t.consume(P),d):n(P)}function d(P){return P===null||P===62?n(P):P===45?(t.consume(P),h):p(P)}function h(P){return P===null||P===62?n(P):p(P)}function p(P){return P===null?n(P):P===45?(t.consume(P),m):Pc(P)?(a=p,V(P)):(t.consume(P),p)}function m(P){return P===45?(t.consume(P),re):p(P)}function g(P){return P===s.charCodeAt(o++)?(t.consume(P),o===s.length?y:g):n(P)}function y(P){return P===null?n(P):P===93?(t.consume(P),x):Pc(P)?(a=y,V(P)):(t.consume(P),y)}function x(P){return P===93?(t.consume(P),_):y(P)}function _(P){return P===62?re(P):P===93?(t.consume(P),_):y(P)}function w(P){return P===null||P===62?re(P):Pc(P)?(a=w,V(P)):(t.consume(P),w)}function T(P){return P===null?n(P):P===63?(t.consume(P),S):Pc(P)?(a=T,V(P)):(t.consume(P),T)}function S(P){return P===62?re(P):T(P)}function C(P){return n3(P)?(t.consume(P),A):n(P)}function A(P){return P===45||CA(P)?(t.consume(P),A):R(P)}function R(P){return Pc(P)?(a=R,V(P)):r3(P)?(t.consume(P),R):re(P)}function M(P){return P===45||CA(P)?(t.consume(P),M):P===47||P===62||RA(P)?D(P):n(P)}function D(P){return P===47?(t.consume(P),re):P===58||P===95||n3(P)?(t.consume(P),k):Pc(P)?(a=D,V(P)):r3(P)?(t.consume(P),D):re(P)}function k(P){return P===45||P===46||P===58||P===95||CA(P)?(t.consume(P),k):L(P)}function L(P){return P===61?(t.consume(P),N):Pc(P)?(a=L,V(P)):r3(P)?(t.consume(P),L):D(P)}function N(P){return P===null||P===60||P===61||P===62||P===96?n(P):P===34||P===39?(t.consume(P),i=P,z):Pc(P)?(a=N,V(P)):r3(P)?(t.consume(P),N):(t.consume(P),i=void 0,K)}function z(P){return P===i?(t.consume(P),O):P===null?n(P):Pc(P)?(a=z,V(P)):(t.consume(P),z)}function O(P){return P===62||P===47||RA(P)?D(P):n(P)}function K(P){return P===null||P===34||P===39||P===60||P===61||P===96?n(P):P===62||RA(P)?D(P):(t.consume(P),K)}function V(P){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(P),t.exit("lineEnding"),JFe(t,ne,"linePrefix",r.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function ne(P){return t.enter("htmlTextData"),a(P)}function re(P){return P===62?(t.consume(P),t.exit("htmlTextData"),t.exit("htmlText"),e):n(P)}}var nUe=eUe,rUe=If,Lp=qR,iUe=Rf,eJ=jR,sUe=YR,Dp=d0,oUe=qQ,aUe=YQ,lUe=ZQ,IA=KQ,cUe={name:"labelEnd",tokenize:mUe,resolveTo:pUe,resolveAll:hUe},uUe={tokenize:gUe},fUe={tokenize:yUe},dUe={tokenize:vUe};function hUe(t){for(var e=-1,n;++e<t.length;)n=t[e][1],!n._used&&(n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd")&&(t.splice(e+1,n.type==="labelImage"?4:2),n.type="data",e++);return t}function pUe(t,e){for(var n=t.length,r=0,i,s,o,a,l,c,u;n--;)if(a=t[n][1],l){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;t[n][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(c){if(t[n][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(l=n,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(c=n);return i={type:t[l][1].type==="labelLink"?"link":"image",start:Dp(t[l][1].start),end:Dp(t[t.length-1][1].end)},s={type:"label",start:Dp(t[l][1].start),end:Dp(t[c][1].end)},o={type:"labelText",start:Dp(t[l+r+2][1].end),end:Dp(t[c-2][1].start)},u=[["enter",i,e],["enter",s,e]],u=Lp(u,t.slice(l+1,l+r+3)),u=Lp(u,[["enter",o,e]]),u=Lp(u,sUe(e.parser.constructs.insideSpan.null,t.slice(l+r+4,c-3),e)),u=Lp(u,[["exit",o,e],t[c-2],t[c-1],["exit",s,e]]),u=Lp(u,t.slice(c+1)),u=Lp(u,[["exit",i,e]]),iUe(t,l,t.length,u),t}function mUe(t,e,n){for(var r=this,i=r.events.length,s,o;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){s=r.events[i][1];break}return a;function a(u){return s?s._inactive?c(u):(o=r.parser.defined.indexOf(eJ(r.sliceSerialize({start:s.end,end:r.now()})))>-1,t.enter("labelEnd"),t.enter("labelMarker"),t.consume(u),t.exit("labelMarker"),t.exit("labelEnd"),l):n(u)}function l(u){return u===40?t.attempt(uUe,e,o?e:c)(u):u===91?t.attempt(fUe,e,o?t.attempt(dUe,e,c):c)(u):o?e(u):c(u)}function c(u){return s._balanced=!0,n(u)}}function gUe(t,e,n){return r;function r(l){return t.enter("resource"),t.enter("resourceMarker"),t.consume(l),t.exit("resourceMarker"),IA(t,i)}function i(l){return l===41?a(l):oUe(t,s,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(l)}function s(l){return rUe(l)?IA(t,o)(l):a(l)}function o(l){return l===34||l===39||l===40?lUe(t,IA(t,a),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(l):a(l)}function a(l){return l===41?(t.enter("resourceMarker"),t.consume(l),t.exit("resourceMarker"),t.exit("resource"),e):n(l)}}function yUe(t,e,n){var r=this;return i;function i(o){return aUe.call(r,t,s,n,"reference","referenceMarker","referenceString")(o)}function s(o){return r.parser.defined.indexOf(eJ(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))<0?n(o):e(o)}}function vUe(t,e,n){return r;function r(s){return t.enter("reference"),t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),i}function i(s){return s===93?(t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),t.exit("reference"),e):n(s)}}var ZR=cUe,xUe=ZR,_Ue={name:"labelStartImage",tokenize:bUe,resolveAll:xUe.resolveAll};function bUe(t,e,n){var r=this;return i;function i(a){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(a),t.exit("labelImageMarker"),s}function s(a){return a===91?(t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelImage"),o):n(a)}function o(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(a):e(a)}}var EUe=_Ue,wUe=ZR,SUe={name:"labelStartLink",tokenize:TUe,resolveAll:wUe.resolveAll};function TUe(t,e,n){var r=this;return i;function i(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}var AUe=SUe,MUe=Vs,CUe={name:"lineEnding",tokenize:RUe};function RUe(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),MUe(t,e,"linePrefix")}}var IUe=CUe,PUe=hs,kUe=vu,LUe=Vs,DUe={name:"thematicBreak",tokenize:NUe};function NUe(t,e,n){var r=0,i;return s;function s(l){return t.enter("thematicBreak"),i=l,o(l)}function o(l){return l===i?(t.enter("thematicBreakSequence"),a(l)):kUe(l)?LUe(t,o,"whitespace")(l):r<3||l!==null&&!PUe(l)?n(l):(t.exit("thematicBreak"),e(l))}function a(l){return l===i?(t.consume(l),r++,a):(t.exit("thematicBreakSequence"),o(l))}}var tJ=DUe,EB=XQ,QR=vu,JR=dw,OUe=UQ,hb=Vs,nJ=fw,FUe=tJ,rJ={name:"list",tokenize:zUe,continuation:{tokenize:HUe},exit:jUe},UUe={tokenize:VUe,partial:!0},BUe={tokenize:GUe,partial:!0};function zUe(t,e,n){var r=this,i=JR(r.events,"linePrefix"),s=0;return o;function o(d){var h=r.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(h==="listUnordered"?!r.containerState.marker||d===r.containerState.marker:EB(d)){if(r.containerState.type||(r.containerState.type=h,t.enter(h,{_container:!0})),h==="listUnordered")return t.enter("listItemPrefix"),d===42||d===45?t.check(FUe,n,l)(d):l(d);if(!r.interrupt||d===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),a(d)}return n(d)}function a(d){return EB(d)&&++s<10?(t.consume(d),a):(!r.interrupt||s<2)&&(r.containerState.marker?d===r.containerState.marker:d===41||d===46)?(t.exit("listItemValue"),l(d)):n(d)}function l(d){return t.enter("listItemMarker"),t.consume(d),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||d,t.check(nJ,r.interrupt?n:c,t.attempt(UUe,f,u))}function c(d){return r.containerState.initialBlankLine=!0,i++,f(d)}function u(d){return QR(d)?(t.enter("listItemPrefixWhitespace"),t.consume(d),t.exit("listItemPrefixWhitespace"),f):n(d)}function f(d){return r.containerState.size=i+OUe(r.sliceStream(t.exit("listItemPrefix"))),e(d)}}function HUe(t,e,n){var r=this;return r.containerState._closeFlow=void 0,t.check(nJ,i,s);function i(a){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,hb(t,e,"listItemIndent",r.containerState.size+1)(a)}function s(a){return r.containerState.furtherBlankLines||!QR(a)?(r.containerState.furtherBlankLines=r.containerState.initialBlankLine=void 0,o(a)):(r.containerState.furtherBlankLines=r.containerState.initialBlankLine=void 0,t.attempt(BUe,e,o)(a))}function o(a){return r.containerState._closeFlow=!0,r.interrupt=void 0,hb(t,t.attempt(rJ,e,n),"linePrefix",r.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(a)}}function GUe(t,e,n){var r=this;return hb(t,i,"listItemIndent",r.containerState.size+1);function i(s){return JR(r.events,"listItemIndent")===r.containerState.size?e(s):n(s)}}function jUe(t){t.exit(this.containerState.type)}function VUe(t,e,n){var r=this;return hb(t,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5);function i(s){return QR(s)||!JR(r.events,"listItemPrefixWhitespace")?n(s):e(s)}}var WUe=rJ,$Ue=hs,PA=d0,XUe=Vs,qUe={name:"setextUnderline",tokenize:KUe,resolveTo:YUe};function YUe(t,e){for(var n=t.length,r,i,s,o;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(i=n)}else t[n][1].type==="content"&&t.splice(n,1),!s&&t[n][1].type==="definition"&&(s=n);return o={type:"setextHeading",start:PA(t[i][1].start),end:PA(t[t.length-1][1].end)},t[i][1].type="setextHeadingText",s?(t.splice(i,0,["enter",o,e]),t.splice(s+1,0,["exit",t[r][1],e]),t[r][1].end=PA(t[s][1].end)):t[r][1]=o,t.push(["exit",o,e]),t}function KUe(t,e,n){for(var r=this,i=r.events.length,s,o;i--;)if(r.events[i][1].type!=="lineEnding"&&r.events[i][1].type!=="linePrefix"&&r.events[i][1].type!=="content"){o=r.events[i][1].type==="paragraph";break}return a;function a(u){return!r.lazy&&(r.interrupt||o)?(t.enter("setextHeadingLine"),t.enter("setextHeadingLineSequence"),s=u,l(u)):n(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),XUe(t,c,"lineSuffix")(u))}function c(u){return u===null||$Ue(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}var ZUe=qUe;Object.defineProperty(hc,"__esModule",{value:!0});var QUe=h0,YM=iOe,JUe=yOe,eBe=wOe,iJ=IOe,sJ=WOe,wB=KOe,kA=nFe,tBe=aFe,nBe=CFe,rBe=kFe,iBe=zFe,sBe=QFe,oBe=nUe,aBe=ZR,lBe=EUe,cBe=AUe,LA=IUe,ia=WUe,SB=ZUe,DA=tJ,uBe={42:ia,43:ia,45:ia,48:ia,49:ia,50:ia,51:ia,52:ia,53:ia,54:ia,55:ia,56:ia,57:ia,62:eBe},fBe={91:nBe},dBe={"-2":kA,"-1":kA,32:kA},hBe={35:iBe,42:DA,45:[SB,DA],60:sBe,61:SB,95:DA,96:wB,126:wB},pBe={38:sJ,92:iJ},mBe={"-5":LA,"-4":LA,"-3":LA,33:lBe,38:sJ,42:YM,60:[JUe,oBe],91:cBe,92:[rBe,iJ],93:aBe,95:YM,96:tBe},gBe={null:[YM,QUe.resolver]},yBe={null:[]};hc.contentInitial=fBe;hc.disable=yBe;hc.document=uBe;hc.flow=hBe;hc.flowInitial=dBe;hc.insideSpan=gBe;hc.string=pBe;hc.text=mBe;var vBe=VR,xBe=WR,_Be=$R,TB=h0,bBe=gNe,EBe=LNe,wBe=XR,SBe=hc;function TBe(t){var e=t||{},n={defined:[],constructs:bBe([SBe].concat(wBe(e.extensions))),content:r(vBe),document:r(xBe),flow:r(_Be),string:r(TB.string),text:r(TB.text)};return n;function r(i){return s;function s(o){return EBe(n,i,o)}}}var ABe=TBe,AB=/[\0\t\n\r]/g;function MBe(){var t=!0,e=1,n="",r;return i;function i(s,o,a){var l=[],c,u,f,d,h;for(s=n+s.toString(o),f=0,n="",t&&(s.charCodeAt(0)===65279&&f++,t=void 0);f<s.length;){if(AB.lastIndex=f,c=AB.exec(s),d=c?c.index:s.length,h=s.charCodeAt(d),!c){n=s.slice(f);break}if(h===10&&f===d&&r)l.push(-3),r=void 0;else if(r&&(l.push(-5),r=void 0),f<d&&(l.push(s.slice(f,d)),e+=d-f),h===0)l.push(65533),e++;else if(h===9)for(u=Math.ceil(e/4)*4,l.push(-2);e++<u;)l.push(-1);else h===10?(l.push(-4),e=1):(r=!0,e=1);f=d+1}return a&&(r&&l.push(-5),n&&l.push(n),l.push(null)),l}}var CBe=MBe,RBe=zQ;function IBe(t){for(;!RBe(t););return t}var PBe=IBe,kBe=zBe,LBe=aDe,DBe=ev,oJ=OQ,NA=jR,NBe=pDe,OBe=ABe,FBe=CBe,UBe=PBe,BBe=$Q,i3=RQ;function zBe(t,e,n){return typeof e!="string"&&(n=e,e=void 0),HBe(n)(UBe(OBe(n).document().write(FBe()(t,e,!0))))}function HBe(t){var e=t||{},n=GBe({transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:c(ie),autolinkProtocol:L,autolinkEmail:L,atxHeading:c(ye),blockQuote:c(Re),characterEscape:L,characterReference:L,codeFenced:c(ae),codeFencedFenceInfo:u,codeFencedFenceMeta:u,codeIndented:c(ae,u),codeText:c(Ce,u),codeTextData:L,data:L,codeFlowValue:L,definition:c(Pe),definitionDestinationString:u,definitionLabelString:u,definitionTitleString:u,emphasis:c(Ve),hardBreakEscape:c(ge),hardBreakTrailing:c(ge),htmlFlow:c(ze,u),htmlFlowData:L,htmlText:c(ze,u),htmlTextData:L,image:c(fe),label:u,link:c(ie),listItem:c(Me),listItemValue:g,listOrdered:c(ve,m),listUnordered:c(ve),paragraph:c(Be),reference:J,referenceString:u,resourceDestinationString:u,resourceTitleString:u,setextHeading:c(ye),strong:c(Ze),thematicBreak:c(Z)},exit:{atxHeading:d(),atxHeadingSequence:R,autolink:d(),autolinkEmail:_e,autolinkProtocol:Te,blockQuote:d(),characterEscapeValue:N,characterReferenceMarkerHexadecimal:Ee,characterReferenceMarkerNumeric:Ee,characterReferenceValue:me,codeFenced:d(w),codeFencedFence:_,codeFencedFenceInfo:y,codeFencedFenceMeta:x,codeFlowValue:N,codeIndented:d(T),codeText:d(ne),codeTextData:N,data:N,definition:d(),definitionDestinationString:A,definitionLabelString:S,definitionTitleString:C,emphasis:d(),hardBreakEscape:d(O),hardBreakTrailing:d(O),htmlFlow:d(K),htmlFlowData:N,htmlText:d(V),htmlTextData:N,image:d(P),label:ue,labelText:se,lineEnding:z,link:d(re),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:oe,resourceDestinationString:te,resourceTitleString:W,resource:X,setextHeading:d(k),setextHeadingLineSequence:D,setextHeadingText:M,strong:d(),thematicBreak:d()}},e.mdastExtensions||[]),r={};return i;function i(q){for(var xe={type:"root",children:[]},be=[xe],De=[],$e=[],st=-1,it,Ie,Ye={stack:be,tokenStack:De,config:n,enter:f,exit:h,buffer:u,resume:p,setData:o,getData:a};++st<q.length;)(q[st][1].type==="listOrdered"||q[st][1].type==="listUnordered")&&(q[st][0]==="enter"?$e.push(st):(Ie=$e.pop(st),st=s(q,Ie,st)));for(st=-1;++st<q.length;)it=n[q[st][0]],oJ.call(it,q[st][1].type)&&it[q[st][1].type].call(DBe({sliceSerialize:q[st][2].sliceSerialize},Ye),q[st][1]);if(De.length)throw new Error("Cannot close document, a token (`"+De[De.length-1].type+"`, "+i3({start:De[De.length-1].start,end:De[De.length-1].end})+") is still open");for(xe.position={start:l(q.length?q[0][1].start:{line:1,column:1,offset:0}),end:l(q.length?q[q.length-2][1].end:{line:1,column:1,offset:0})},st=-1;++st<n.transforms.length;)xe=n.transforms[st](xe)||xe;return xe}function s(q,xe,be){for(var De=xe-1,$e=-1,st=!1,it,Ie,Ye,at,ke,Xe,Qe;++De<=be;)if(ke=q[De],ke[1].type==="listUnordered"||ke[1].type==="listOrdered"||ke[1].type==="blockQuote"?(ke[0]==="enter"?$e++:$e--,Qe=void 0):ke[1].type==="lineEndingBlank"?ke[0]==="enter"&&(it&&!Qe&&!$e&&!Xe&&(Xe=De),Qe=void 0):ke[1].type==="linePrefix"||ke[1].type==="listItemValue"||ke[1].type==="listItemMarker"||ke[1].type==="listItemPrefix"||ke[1].type==="listItemPrefixWhitespace"||(Qe=void 0),!$e&&ke[0]==="enter"&&ke[1].type==="listItemPrefix"||$e===-1&&ke[0]==="exit"&&(ke[1].type==="listUnordered"||ke[1].type==="listOrdered")){if(it){for(Ie=De,Ye=void 0;Ie--;)if(at=q[Ie],at[1].type==="lineEnding"||at[1].type==="lineEndingBlank"){if(at[0]==="exit")continue;Ye&&(q[Ye][1].type="lineEndingBlank",st=!0),at[1].type="lineEnding",Ye=Ie}else if(!(at[1].type==="linePrefix"||at[1].type==="blockQuotePrefix"||at[1].type==="blockQuotePrefixWhitespace"||at[1].type==="blockQuoteMarker"||at[1].type==="listItemIndent"))break;Xe&&(!Ye||Xe<Ye)&&(it._spread=!0),it.end=l(Ye?q[Ye][1].start:ke[1].end),q.splice(Ye||De,0,["exit",it,ke[2]]),De++,be++}ke[1].type==="listItemPrefix"&&(it={type:"listItem",_spread:!1,start:l(ke[1].start)},q.splice(De,0,["enter",it,ke[2]]),De++,be++,Xe=void 0,Qe=!0)}return q[xe][1]._spread=st,be}function o(q,xe){r[q]=xe}function a(q){return r[q]}function l(q){return{line:q.line,column:q.column,offset:q.offset}}function c(q,xe){return be;function be(De){f.call(this,q(De),De),xe&&xe.call(this,De)}}function u(){this.stack.push({type:"fragment",children:[]})}function f(q,xe){return this.stack[this.stack.length-1].children.push(q),this.stack.push(q),this.tokenStack.push(xe),q.position={start:l(xe.start)},q}function d(q){return xe;function xe(be){q&&q.call(this,be),h.call(this,be)}}function h(q){var xe=this.stack.pop(),be=this.tokenStack.pop();if(be){if(be.type!==q.type)throw new Error("Cannot close `"+q.type+"` ("+i3({start:q.start,end:q.end})+"): a different token (`"+be.type+"`, "+i3({start:be.start,end:be.end})+") is open")}else throw new Error("Cannot close `"+q.type+"` ("+i3({start:q.start,end:q.end})+"): its not open");return xe.position.end=l(q.end),xe}function p(){return LBe(this.stack.pop())}function m(){o("expectingFirstListItemValue",!0)}function g(q){a("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(q),10),o("expectingFirstListItemValue"))}function y(){var q=this.resume();this.stack[this.stack.length-1].lang=q}function x(){var q=this.resume();this.stack[this.stack.length-1].meta=q}function _(){a("flowCodeInside")||(this.buffer(),o("flowCodeInside",!0))}function w(){var q=this.resume();this.stack[this.stack.length-1].value=q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),o("flowCodeInside")}function T(){var q=this.resume();this.stack[this.stack.length-1].value=q}function S(q){var xe=this.resume();this.stack[this.stack.length-1].label=xe,this.stack[this.stack.length-1].identifier=NA(this.sliceSerialize(q)).toLowerCase()}function C(){var q=this.resume();this.stack[this.stack.length-1].title=q}function A(){var q=this.resume();this.stack[this.stack.length-1].url=q}function R(q){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(q).length)}function M(){o("setextHeadingSlurpLineEnding",!0)}function D(q){this.stack[this.stack.length-1].depth=this.sliceSerialize(q).charCodeAt(0)===61?1:2}function k(){o("setextHeadingSlurpLineEnding")}function L(q){var xe=this.stack[this.stack.length-1].children,be=xe[xe.length-1];(!be||be.type!=="text")&&(be=F(),be.position={start:l(q.start)},this.stack[this.stack.length-1].children.push(be)),this.stack.push(be)}function N(q){var xe=this.stack.pop();xe.value+=this.sliceSerialize(q),xe.position.end=l(q.end)}function z(q){var xe=this.stack[this.stack.length-1];if(a("atHardBreak")){xe.children[xe.children.length-1].position.end=l(q.end),o("atHardBreak");return}!a("setextHeadingSlurpLineEnding")&&n.canContainEols.indexOf(xe.type)>-1&&(L.call(this,q),N.call(this,q))}function O(){o("atHardBreak",!0)}function K(){var q=this.resume();this.stack[this.stack.length-1].value=q}function V(){var q=this.resume();this.stack[this.stack.length-1].value=q}function ne(){var q=this.resume();this.stack[this.stack.length-1].value=q}function re(){var q=this.stack[this.stack.length-1];a("inReference")?(q.type+="Reference",q.referenceType=a("referenceType")||"shortcut",delete q.url,delete q.title):(delete q.identifier,delete q.label,delete q.referenceType),o("referenceType")}function P(){var q=this.stack[this.stack.length-1];a("inReference")?(q.type+="Reference",q.referenceType=a("referenceType")||"shortcut",delete q.url,delete q.title):(delete q.identifier,delete q.label,delete q.referenceType),o("referenceType")}function se(q){this.stack[this.stack.length-2].identifier=NA(this.sliceSerialize(q)).toLowerCase()}function ue(){var q=this.stack[this.stack.length-1],xe=this.resume();this.stack[this.stack.length-1].label=xe,o("inReference",!0),this.stack[this.stack.length-1].type==="link"?this.stack[this.stack.length-1].children=q.children:this.stack[this.stack.length-1].alt=xe}function te(){var q=this.resume();this.stack[this.stack.length-1].url=q}function W(){var q=this.resume();this.stack[this.stack.length-1].title=q}function X(){o("inReference")}function J(){o("referenceType","collapsed")}function oe(q){var xe=this.resume();this.stack[this.stack.length-1].label=xe,this.stack[this.stack.length-1].identifier=NA(this.sliceSerialize(q)).toLowerCase(),o("referenceType","full")}function Ee(q){o("characterReferenceType",q.type)}function me(q){var xe=this.sliceSerialize(q),be=a("characterReferenceType"),De,$e;be?(De=NBe(xe,be==="characterReferenceMarkerNumeric"?10:16),o("characterReferenceType")):De=BBe(xe),$e=this.stack.pop(),$e.value+=De,$e.position.end=l(q.end)}function Te(q){N.call(this,q),this.stack[this.stack.length-1].url=this.sliceSerialize(q)}function _e(q){N.call(this,q),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(q)}function Re(){return{type:"blockquote",children:[]}}function ae(){return{type:"code",lang:null,meta:null,value:""}}function Ce(){return{type:"inlineCode",value:""}}function Pe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ve(){return{type:"emphasis",children:[]}}function ye(){return{type:"heading",depth:void 0,children:[]}}function ge(){return{type:"break"}}function ze(){return{type:"html",value:""}}function fe(){return{type:"image",title:null,url:"",alt:null}}function ie(){return{type:"link",title:null,url:"",children:[]}}function ve(q){return{type:"list",ordered:q.type==="listOrdered",start:null,spread:q._spread,children:[]}}function Me(q){return{type:"listItem",spread:q._spread,checked:null,children:[]}}function Be(){return{type:"paragraph",children:[]}}function Ze(){return{type:"strong",children:[]}}function F(){return{type:"text",value:""}}function Z(){return{type:"thematicBreak"}}}function GBe(t,e){for(var n=-1;++n<e.length;)jBe(t,e[n]);return t}function jBe(t,e){var n,r;for(n in e)r=oJ.call(t,n)?t[n]:t[n]={},n==="canContainEols"||n==="transforms"?t[n]=[].concat(r,e[n]):Object.assign(r,e[n])}var VBe=kBe,WBe=XBe,$Be=VBe;function XBe(t){var e=this;this.Parser=n;function n(r){return $Be(r,Object.assign({},e.data("settings"),t,{extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]}))}}const qBe=mu(WBe);var rl=YBe;function YBe(t,e,n){var r;return n==null&&(typeof e!="object"||Array.isArray(e))&&(n=e,e={}),r=Object.assign({type:String(t)},e),Array.isArray(n)?r.children=n:n!=null&&(r.value=String(n)),r}var e9=aJ;function aJ(t){if(t==null)return JBe;if(typeof t=="string")return QBe(t);if(typeof t=="object")return"length"in t?ZBe(t):KBe(t);if(typeof t=="function")return t;throw new Error("Expected function, string, or object as test")}function KBe(t){return e;function e(n){var r;for(r in t)if(n[r]!==t[r])return!1;return!0}}function ZBe(t){for(var e=[],n=-1;++n<t.length;)e[n]=aJ(t[n]);return r;function r(){for(var i=-1;++i<e.length;)if(e[i].apply(this,arguments))return!0;return!1}}function QBe(t){return e;function e(n){return!!(n&&n.type===t)}}function JBe(){return!0}var eze=tze;function tze(t){return t}var nze=pw,rze=e9,ize=eze,lJ=!0,cJ="skip",KM=!1;pw.CONTINUE=lJ;pw.SKIP=cJ;pw.EXIT=KM;function pw(t,e,n,r){var i,s;typeof e=="function"&&typeof n!="function"&&(r=n,n=e,e=null),s=rze(e),i=r?-1:1,o(t,null,[])();function o(a,l,c){var u=typeof a=="object"&&a!==null?a:{},f;return typeof u.type=="string"&&(f=typeof u.tagName=="string"?u.tagName:typeof u.name=="string"?u.name:void 0,d.displayName="node ("+ize(u.type+(f?"<"+f+">":""))+")"),d;function d(){var h=c.concat(a),p=[],m,g;if((!e||s(a,l,c[c.length-1]||null))&&(p=sze(n(a,c)),p[0]===KM))return p;if(a.children&&p[0]!==cJ)for(g=(r?a.children.length:-1)+i;g>-1&&g<a.children.length;){if(m=o(a.children[g],g,h)(),m[0]===KM)return m;g=typeof m[1]=="number"?m[1]:g+i}return p}}}function sze(t){return t!==null&&typeof t=="object"&&"length"in t?t:typeof t=="number"?[lJ,t]:[t]}var oze=gw,mw=nze,aze=mw.CONTINUE,lze=mw.SKIP,cze=mw.EXIT;gw.CONTINUE=aze;gw.SKIP=lze;gw.EXIT=cze;function gw(t,e,n,r){typeof e=="function"&&typeof n!="function"&&(r=n,n=e,e=null),mw(t,e,i,r);function i(s,o){var a=o[o.length-1],l=a?a.children.indexOf(s):null;return n(s,l,a)}}var uJ=hJ("start"),fJ=hJ("end"),dJ=t9;t9.start=uJ;t9.end=fJ;function t9(t){return{start:uJ(t),end:fJ(t)}}function hJ(t){return e.displayName=t,e;function e(n){var r=n&&n.position&&n.position[t]||{};return{line:r.line||null,column:r.column||null,offset:isNaN(r.offset)?null:r.offset}}}var uze=fze;function fze(t){return!t||!t.position||!t.position.start||!t.position.start.line||!t.position.start.column||!t.position.end||!t.position.end.line||!t.position.end.column}var dze=hze;function hze(t){return t}var pze=yw,mze=e9,gze=dze,pJ=!0,mJ="skip",ZM=!1;yw.CONTINUE=pJ;yw.SKIP=mJ;yw.EXIT=ZM;function yw(t,e,n,r){var i,s;typeof e=="function"&&typeof n!="function"&&(r=n,n=e,e=null),s=mze(e),i=r?-1:1,o(t,null,[])();function o(a,l,c){var u=typeof a=="object"&&a!==null?a:{},f;return typeof u.type=="string"&&(f=typeof u.tagName=="string"?u.tagName:typeof u.name=="string"?u.name:void 0,d.displayName="node ("+gze(u.type+(f?"<"+f+">":""))+")"),d;function d(){var h=c.concat(a),p=[],m,g;if((!e||s(a,l,c[c.length-1]||null))&&(p=yze(n(a,c)),p[0]===ZM))return p;if(a.children&&p[0]!==mJ)for(g=(r?a.children.length:-1)+i;g>-1&&g<a.children.length;){if(m=o(a.children[g],g,h)(),m[0]===ZM)return m;g=typeof m[1]=="number"?m[1]:g+i}return p}}}function yze(t){return t!==null&&typeof t=="object"&&"length"in t?t:typeof t=="number"?[pJ,t]:[t]}var vze=xw,vw=pze,xze=vw.CONTINUE,_ze=vw.SKIP,bze=vw.EXIT;xw.CONTINUE=xze;xw.SKIP=_ze;xw.EXIT=bze;function xw(t,e,n,r){typeof e=="function"&&typeof n!="function"&&(r=n,n=e,e=null),vw(t,e,i,r);function i(s,o){var a=o[o.length-1],l=a?a.children.indexOf(s):null;return n(s,l,a)}}var Eze=vze,wze=Sze,gJ={}.hasOwnProperty;function Sze(t,e){return Aze(Tze(t))}function Tze(t){var e={};if(!t||!t.type)throw new Error("mdast-util-definitions expected node");return Eze(t,"definition",n),e;function n(r){var i=yJ(r.identifier);gJ.call(e,i)||(e[i]=r)}}function Aze(t){return e;function e(n){var r=n&&yJ(n);return r&&gJ.call(t,r)?t[r]:null}}function yJ(t){return t.toUpperCase()}var OA,MB;function Ko(){if(MB)return OA;MB=1,OA=e;var t=vJ();function e(n,r){for(var i=r.children||[],s=i.length,o=[],a=-1,l,c;++a<s;)l=t(n,i[a],r),l&&(a&&i[a-1].type==="break"&&(l.value&&(l.value=l.value.replace(/^\s+/,"")),c=l.children&&l.children[0],c&&c.value&&(c.value=c.value.replace(/^\s+/,""))),o=o.concat(l));return o}return OA}var FA,CB;function vJ(){if(CB)return FA;CB=1,FA=i;var t=rl,e=Ko(),n={}.hasOwnProperty;function r(a,l){return s(l)?a.augment(l,t("text",l.value)):a(l,"div",e(a,l))}function i(a,l,c){var u=l&&l.type,f;if(!u)throw new Error("Expected node, got `"+l+"`");return n.call(a.handlers,u)?f=a.handlers[u]:a.passThrough&&a.passThrough.indexOf(u)>-1?f=o:f=a.unknownHandler,(typeof f=="function"?f:r)(a,l,c)}function s(a){var l=a.data||{};return n.call(l,"hName")||n.call(l,"hProperties")||n.call(l,"hChildren")?!1:"value"in a}function o(a,l){var c;return l.children?(c=Object.assign({},l),c.children=e(a,l),c):l}return FA}var xJ=Mze;function Mze(t,e){return t(e,"hr")}var tv=Cze,UA=rl;function Cze(t,e){var n=[],r=-1,i=t.length;for(e&&n.push(UA("text",`
`));++r<i;)r&&n.push(UA("text",`
`)),n.push(t[r]);return e&&t.length>0&&n.push(UA("text",`
`)),n}var _J=Pze,Rze=tv,Ize=Ko();function Pze(t,e){var n={},r=e.ordered?"ol":"ul",i,s=-1,o;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start),i=Ize(t,e),o=i.length;++s<o;)if(i[s].properties.className&&i[s].properties.className.indexOf("task-list-item")!==-1){n.className=["contains-task-list"];break}return t(e,r,n,Rze(i,!0))}var kze=Oze,Lze=xJ,Dze=_J,Nze=tv;function Oze(t){for(var e=t.footnoteById,n=t.footnoteOrder,r=n.length,i=-1,s=[],o,a,l,c;++i<r;)o=e[n[i].toUpperCase()],o&&(l=o.children.concat(),c=l[l.length-1],a={type:"link",url:"#fnref-"+o.identifier,data:{hProperties:{className:["footnote-backref"]}},children:[{type:"text",value:""}]},(!c||c.type!=="paragraph")&&(c={type:"paragraph",children:[]},l.push(c)),c.children.push(a),s.push({type:"listItem",data:{hProperties:{id:"fn-"+o.identifier}},children:l,position:o.position}));return s.length===0?null:t(null,"div",{className:["footnotes"]},Nze([Lze(t),Dze(t,{type:"list",ordered:!0,children:s})],!0))}var Fze=zze,Uze=tv,Bze=Ko();function zze(t,e){return t(e,"blockquote",Uze(Bze(t,e),!0))}var Hze=jze,Gze=rl;function jze(t,e){return[t(e,"br"),Gze("text",`
`)]}var Vze=$ze,Wze=rl;function $ze(t,e){var n=e.value?e.value+`
`:"",r=e.lang&&e.lang.match(/^[^ \t]+(?=[ \t]|$)/),i={},s;return r&&(i.className=["language-"+r]),s=t(e,"code",i,[Wze("text",n)]),e.meta&&(s.data={meta:e.meta}),t(e.position,"pre",[s])}var Xze=Yze,qze=Ko();function Yze(t,e){return t(e,"del",qze(t,e))}var Kze=Qze,Zze=Ko();function Qze(t,e){return t(e,"em",Zze(t,e))}var bJ=eHe,Jze=rl;function eHe(t,e){var n=t.footnoteOrder,r=String(e.identifier);return n.indexOf(r)===-1&&n.push(r),t(e.position,"sup",{id:"fnref-"+r},[t(e,"a",{href:"#fn-"+r,className:["footnote-ref"]},[Jze("text",e.label||r)])])}var tHe=rHe,nHe=bJ;function rHe(t,e){for(var n=t.footnoteById,r=t.footnoteOrder,i=1;i in n;)i++;return i=String(i),r.push(i),n[i]={type:"footnoteDefinition",identifier:i,children:[{type:"paragraph",children:e.children}],position:e.position},nHe(t,{type:"footnoteReference",identifier:i,position:e.position})}var iHe=oHe,sHe=Ko();function oHe(t,e){return t(e,"h"+e.depth,sHe(t,e))}var aHe=cHe,lHe=rl;function cHe(t,e){return t.dangerous?t.augment(e,lHe("raw",e.value)):null}var RB={};function uHe(t){var e,n,r=RB[t];if(r)return r;for(r=RB[t]=[],e=0;e<128;e++)n=String.fromCharCode(e),/^[0-9a-z]$/i.test(n)?r.push(n):r.push("%"+("0"+e.toString(16).toUpperCase()).slice(-2));for(e=0;e<t.length;e++)r[t.charCodeAt(e)]=t[e];return r}function _w(t,e,n){var r,i,s,o,a,l="";for(typeof e!="string"&&(n=e,e=_w.defaultChars),typeof n>"u"&&(n=!0),a=uHe(e),r=0,i=t.length;r<i;r++){if(s=t.charCodeAt(r),n&&s===37&&r+2<i&&/^[0-9a-f]{2}$/i.test(t.slice(r+1,r+3))){l+=t.slice(r,r+3),r+=2;continue}if(s<128){l+=a[s];continue}if(s>=55296&&s<=57343){if(s>=55296&&s<=56319&&r+1<i&&(o=t.charCodeAt(r+1),o>=56320&&o<=57343)){l+=encodeURIComponent(t[r]+t[r+1]),r++;continue}l+="%EF%BF%BD";continue}l+=encodeURIComponent(t[r])}return l}_w.defaultChars=";/?:@&=+$,-_.!~*'()#";_w.componentChars="-_.!~*'()";var bw=_w,EJ=dHe,BA=rl,fHe=Ko();function dHe(t,e){var n=e.referenceType,r="]",i,s,o;return n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference"?BA("text","!["+e.alt+r):(i=fHe(t,e),s=i[0],s&&s.type==="text"?s.value="["+s.value:i.unshift(BA("text","[")),o=i[i.length-1],o&&o.type==="text"?o.value+=r:i.push(BA("text",r)),i)}var hHe=gHe,pHe=bw,mHe=EJ;function gHe(t,e){var n=t.definition(e.identifier),r;return n?(r={src:pHe(n.url||""),alt:e.alt},n.title!==null&&n.title!==void 0&&(r.title=n.title),t(e,"img",r)):mHe(t,e)}var yHe=bw,vHe=xHe;function xHe(t,e){var n={src:yHe(e.url),alt:e.alt};return e.title!==null&&e.title!==void 0&&(n.title=e.title),t(e,"img",n)}var _He=EHe,bHe=rl;function EHe(t,e){var n=e.value.replace(/\r?\n|\r/g," ");return t(e,"code",[bHe("text",n)])}var wHe=MHe,SHe=bw,THe=EJ,AHe=Ko();function MHe(t,e){var n=t.definition(e.identifier),r;return n?(r={href:SHe(n.url||"")},n.title!==null&&n.title!==void 0&&(r.title=n.title),t(e,"a",r,AHe(t,e))):THe(t,e)}var CHe=bw,RHe=Ko(),IHe=PHe;function PHe(t,e){var n={href:CHe(e.url)};return e.title!==null&&e.title!==void 0&&(n.title=e.title),t(e,"a",n,RHe(t,e))}var kHe=DHe,zA=rl,LHe=Ko();function DHe(t,e,n){var r=LHe(t,e),i=r[0],s=n?NHe(n):wJ(e),o={},a=[],l,c,u;for(typeof e.checked=="boolean"&&((!i||i.tagName!=="p")&&(i=t(null,"p",[]),r.unshift(i)),i.children.length>0&&i.children.unshift(zA("text"," ")),i.children.unshift(t(null,"input",{type:"checkbox",checked:e.checked,disabled:!0})),o.className=["task-list-item"]),l=r.length,c=-1;++c<l;)u=r[c],(s||c!==0||u.tagName!=="p")&&a.push(zA("text",`
`)),u.tagName==="p"&&!s?a=a.concat(u.children):a.push(u);return l&&(s||u.tagName!=="p")&&a.push(zA("text",`
`)),t(e,"li",o,a)}function NHe(t){for(var e=t.spread,n=t.children,r=n.length,i=-1;!e&&++i<r;)e=wJ(n[i]);return e}function wJ(t){var e=t.spread;return e??t.children.length>1}var OHe=UHe,FHe=Ko();function UHe(t,e){return t(e,"p",FHe(t,e))}var BHe=jHe,zHe=rl,HHe=tv,GHe=Ko();function jHe(t,e){return t.augment(e,zHe("root",HHe(GHe(t,e))))}var VHe=$He,WHe=Ko();function $He(t,e){return t(e,"strong",WHe(t,e))}var XHe=YHe,IB=dJ,s3=tv,qHe=Ko();function YHe(t,e){for(var n=e.children,r=n.length,i=e.align||[],s=i.length,o=[],a,l,c,u,f;r--;){for(l=n[r].children,u=r===0?"th":"td",a=s||l.length,c=[];a--;)f=l[a],c[a]=t(f,u,{align:i[a]},f?qHe(t,f):[]);o[r]=t(n[r],"tr",s3(c,!0))}return t(e,"table",s3([t(o[0].position,"thead",s3([o[0]],!0))].concat(o[1]?t({start:IB.start(o[1]),end:IB.end(o[o.length-1])},"tbody",s3(o.slice(1),!0)):[]),!0))}var KHe=QHe,ZHe=rl;function QHe(t,e){return t.augment(e,ZHe("text",String(e.value).replace(/[ \t]*(\r?\n|\r)[ \t]*/g,"$1")))}var JHe={blockquote:Fze,break:Hze,code:Vze,delete:Xze,emphasis:Kze,footnoteReference:bJ,footnote:tHe,heading:iHe,html:aHe,imageReference:hHe,image:vHe,inlineCode:_He,linkReference:wHe,link:IHe,listItem:kHe,list:_J,paragraph:OHe,root:BHe,strong:VHe,table:XHe,text:KHe,thematicBreak:xJ,toml:o3,yaml:o3,definition:o3,footnoteDefinition:o3};function o3(){return null}var eGe=uGe,tGe=rl,nGe=oze,PB=dJ,rGe=uze,iGe=wze,sGe=vJ(),oGe=kze,aGe=JHe,lGe={}.hasOwnProperty,kB=!1;function cGe(t,e){var n=e||{};n.allowDangerousHTML!==void 0&&!kB&&(kB=!0,console.warn("mdast-util-to-hast: deprecation: `allowDangerousHTML` is nonstandard, use `allowDangerousHtml` instead"));var r=n.allowDangerousHtml||n.allowDangerousHTML,i={};return o.dangerous=r,o.definition=iGe(t),o.footnoteById=i,o.footnoteOrder=[],o.augment=s,o.handlers=Object.assign({},aGe,n.handlers),o.unknownHandler=n.unknownHandler,o.passThrough=n.passThrough,nGe(t,"footnoteDefinition",a),o;function s(l,c){var u,f;return l&&l.data&&(u=l.data,u.hName&&(c.type!=="element"&&(c={type:"element",tagName:"",properties:{},children:[]}),c.tagName=u.hName),c.type==="element"&&u.hProperties&&(c.properties=Object.assign({},c.properties,u.hProperties)),c.children&&u.hChildren&&(c.children=u.hChildren)),f=l&&l.position?l:{position:l},rGe(f)||(c.position={start:PB.start(f),end:PB.end(f)}),c}function o(l,c,u,f){return f==null&&typeof u=="object"&&"length"in u&&(f=u,u={}),s(l,{type:"element",tagName:c,properties:u||{},children:f||[]})}function a(l){var c=String(l.identifier).toUpperCase();lGe.call(i,c)||(i[c]=l)}}function uGe(t,e){var n=cGe(t,e),r=sGe(n,t),i=oGe(n);return i&&(r.children=r.children.concat(tGe("text",`
`),i)),r}var fGe=eGe,SJ=fGe,dGe=hGe;function hGe(t,e){return t&&!t.process&&(e=t,t=null),t?pGe(t,e):mGe(e)}function pGe(t,e){return n;function n(r,i,s){t.run(SJ(r,e),i,o);function o(a){s(a)}}}function mGe(t){return e;function e(n){return SJ(n,t)}}const gGe=mu(dGe);var yGe=xGe,vGe=Object.prototype.hasOwnProperty;function xGe(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)vGe.call(n,r)&&(t[r]=n[r])}return t}var TJ=AJ,n9=AJ.prototype;n9.space=null;n9.normal={};n9.property={};function AJ(t,e,n){this.property=t,this.normal=e,n&&(this.space=n)}var LB=yGe,_Ge=TJ,MJ=bGe;function bGe(t){for(var e=t.length,n=[],r=[],i=-1,s,o;++i<e;)s=t[i],n.push(s.property),r.push(s.normal),o=s.space;return new _Ge(LB.apply(null,n),LB.apply(null,r),o)}var CJ=EGe;function EGe(t){return t.toLowerCase()}var RJ=IJ,il=IJ.prototype;il.space=null;il.attribute=null;il.property=null;il.boolean=!1;il.booleanish=!1;il.overloadedBoolean=!1;il.number=!1;il.commaSeparated=!1;il.spaceSeparated=!1;il.commaOrSpaceSeparated=!1;il.mustUseProperty=!1;il.defined=!1;function IJ(t,e){this.property=t,this.attribute=e}var kl={},wGe=0;kl.boolean=xh();kl.booleanish=xh();kl.overloadedBoolean=xh();kl.number=xh();kl.spaceSeparated=xh();kl.commaSeparated=xh();kl.commaOrSpaceSeparated=xh();function xh(){return Math.pow(2,++wGe)}var PJ=RJ,DB=kl,kJ=r9;r9.prototype=new PJ;r9.prototype.defined=!0;var LJ=["boolean","booleanish","overloadedBoolean","number","commaSeparated","spaceSeparated","commaOrSpaceSeparated"],SGe=LJ.length;function r9(t,e,n,r){var i=-1,s;for(NB(this,"space",r),PJ.call(this,t,e);++i<SGe;)s=LJ[i],NB(this,s,(n&DB[s])===DB[s])}function NB(t,e,n){n&&(t[e]=n)}var OB=CJ,TGe=TJ,AGe=kJ,p0=MGe;function MGe(t){var e=t.space,n=t.mustUseProperty||[],r=t.attributes||{},i=t.properties,s=t.transform,o={},a={},l,c;for(l in i)c=new AGe(l,s(r,l),i[l],e),n.indexOf(l)!==-1&&(c.mustUseProperty=!0),o[l]=c,a[OB(l)]=l,a[OB(c.attribute)]=l;return new TGe(o,a,e)}var CGe=p0,DJ=CGe({space:"xlink",transform:RGe,properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}});function RGe(t,e){return"xlink:"+e.slice(5).toLowerCase()}var IGe=p0,NJ=IGe({space:"xml",transform:PGe,properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function PGe(t,e){return"xml:"+e.slice(3).toLowerCase()}var OJ=kGe;function kGe(t,e){return e in t?t[e]:e}var LGe=OJ,FJ=DGe;function DGe(t,e){return LGe(t,e.toLowerCase())}var NGe=p0,OGe=FJ,UJ=NGe({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:OGe,properties:{xmlns:null,xmlnsXLink:null}}),i9=kl,FGe=p0,Uo=i9.booleanish,Ca=i9.number,fd=i9.spaceSeparated,BJ=FGe({transform:UGe,properties:{ariaActiveDescendant:null,ariaAtomic:Uo,ariaAutoComplete:null,ariaBusy:Uo,ariaChecked:Uo,ariaColCount:Ca,ariaColIndex:Ca,ariaColSpan:Ca,ariaControls:fd,ariaCurrent:null,ariaDescribedBy:fd,ariaDetails:null,ariaDisabled:Uo,ariaDropEffect:fd,ariaErrorMessage:null,ariaExpanded:Uo,ariaFlowTo:fd,ariaGrabbed:Uo,ariaHasPopup:null,ariaHidden:Uo,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:fd,ariaLevel:Ca,ariaLive:null,ariaModal:Uo,ariaMultiLine:Uo,ariaMultiSelectable:Uo,ariaOrientation:null,ariaOwns:fd,ariaPlaceholder:null,ariaPosInSet:Ca,ariaPressed:Uo,ariaReadOnly:Uo,ariaRelevant:null,ariaRequired:Uo,ariaRoleDescription:fd,ariaRowCount:Ca,ariaRowIndex:Ca,ariaRowSpan:Ca,ariaSelected:Uo,ariaSetSize:Ca,ariaSort:null,ariaValueMax:Ca,ariaValueMin:Ca,ariaValueNow:Ca,ariaValueText:null,role:null}});function UGe(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}var m0=kl,BGe=p0,zGe=FJ,or=m0.boolean,HGe=m0.overloadedBoolean,Wg=m0.booleanish,ni=m0.number,_o=m0.spaceSeparated,a3=m0.commaSeparated,GGe=BGe({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:zGe,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:a3,acceptCharset:_o,accessKey:_o,action:null,allow:null,allowFullScreen:or,allowPaymentRequest:or,allowUserMedia:or,alt:null,as:null,async:or,autoCapitalize:null,autoComplete:_o,autoFocus:or,autoPlay:or,capture:or,charSet:null,checked:or,cite:null,className:_o,cols:ni,colSpan:null,content:null,contentEditable:Wg,controls:or,controlsList:_o,coords:ni|a3,crossOrigin:null,data:null,dateTime:null,decoding:null,default:or,defer:or,dir:null,dirName:null,disabled:or,download:HGe,draggable:Wg,encType:null,enterKeyHint:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:or,formTarget:null,headers:_o,height:ni,hidden:or,high:ni,href:null,hrefLang:null,htmlFor:_o,httpEquiv:_o,id:null,imageSizes:null,imageSrcSet:a3,inputMode:null,integrity:null,is:null,isMap:or,itemId:null,itemProp:_o,itemRef:_o,itemScope:or,itemType:_o,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:or,low:ni,manifest:null,max:null,maxLength:ni,media:null,method:null,min:null,minLength:ni,multiple:or,muted:or,name:null,nonce:null,noModule:or,noValidate:or,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforePrint:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextMenu:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:or,optimum:ni,pattern:null,ping:_o,placeholder:null,playsInline:or,poster:null,preload:null,readOnly:or,referrerPolicy:null,rel:_o,required:or,reversed:or,rows:ni,rowSpan:ni,sandbox:_o,scope:null,scoped:or,seamless:or,selected:or,shape:null,size:ni,sizes:null,slot:null,span:ni,spellCheck:Wg,src:null,srcDoc:null,srcLang:null,srcSet:a3,start:ni,step:null,style:null,tabIndex:ni,target:null,title:null,translate:null,type:null,typeMustMatch:or,useMap:null,value:Wg,width:ni,wrap:null,align:null,aLink:null,archive:_o,axis:null,background:null,bgColor:null,border:ni,borderColor:null,bottomMargin:ni,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:or,declare:or,event:null,face:null,frame:null,frameBorder:null,hSpace:ni,leftMargin:ni,link:null,longDesc:null,lowSrc:null,marginHeight:ni,marginWidth:ni,noResize:or,noHref:or,noShade:or,noWrap:or,object:null,profile:null,prompt:null,rev:null,rightMargin:ni,rules:null,scheme:null,scrolling:Wg,standby:null,summary:null,text:null,topMargin:ni,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ni,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:or,disableRemotePlayback:or,prefix:null,property:null,results:ni,security:null,unselectable:null}}),jGe=MJ,VGe=DJ,WGe=NJ,$Ge=UJ,XGe=BJ,qGe=GGe,YGe=jGe([WGe,VGe,$Ge,XGe,qGe]),nv=kl,KGe=p0,ZGe=OJ,QGe=nv.boolean,Cn=nv.number,FB=nv.spaceSeparated,HA=nv.commaSeparated,Ra=nv.commaOrSpaceSeparated,JGe=KGe({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:ZGe,properties:{about:Ra,accentHeight:Cn,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Cn,amplitude:Cn,arabicForm:null,ascent:Cn,attributeName:null,attributeType:null,azimuth:Cn,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Cn,by:null,calcMode:null,capHeight:Cn,className:FB,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Cn,diffuseConstant:Cn,direction:null,display:null,dur:null,divisor:Cn,dominantBaseline:null,download:QGe,dx:null,dy:null,edgeMode:null,editable:null,elevation:Cn,enableBackground:null,end:null,event:null,exponent:Cn,externalResourcesRequired:null,fill:null,fillOpacity:Cn,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:HA,g2:HA,glyphName:HA,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Cn,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Cn,horizOriginX:Cn,horizOriginY:Cn,id:null,ideographic:Cn,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Cn,k:Cn,k1:Cn,k2:Cn,k3:Cn,k4:Cn,kernelMatrix:Ra,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Cn,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Cn,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Cn,overlineThickness:Cn,paintOrder:null,panose1:null,path:null,pathLength:Cn,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:FB,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Cn,pointsAtY:Cn,pointsAtZ:Cn,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ra,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ra,rev:Ra,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ra,requiredFeatures:Ra,requiredFonts:Ra,requiredFormats:Ra,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Cn,specularExponent:Cn,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Cn,strikethroughThickness:Cn,string:null,stroke:null,strokeDashArray:Ra,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Cn,strokeOpacity:Cn,strokeWidth:null,style:null,surfaceScale:Cn,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ra,tabIndex:Cn,tableValues:null,target:null,targetX:Cn,targetY:Cn,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ra,to:null,transform:null,u1:null,u2:null,underlinePosition:Cn,underlineThickness:Cn,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Cn,values:null,vAlphabetic:Cn,vMathematical:Cn,vectorEffect:null,vHanging:Cn,vIdeographic:Cn,version:null,vertAdvY:Cn,vertOriginX:Cn,vertOriginY:Cn,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Cn,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),eje=MJ,tje=DJ,nje=NJ,rje=UJ,ije=BJ,sje=JGe,oje=eje([nje,tje,rje,ije,sje]),aje=CJ,lje=kJ,cje=RJ,s9="data",uje=hje,fje=/^data[-\w.:]+$/i,zJ=/-[a-z]/g,dje=/[A-Z]/g;function hje(t,e){var n=aje(e),r=e,i=cje;return n in t.normal?t.property[t.normal[n]]:(n.length>4&&n.slice(0,4)===s9&&fje.test(e)&&(e.charAt(4)==="-"?r=pje(e):e=mje(e),i=lje),new i(r,e))}function pje(t){var e=t.slice(5).replace(zJ,yje);return s9+e.charAt(0).toUpperCase()+e.slice(1)}function mje(t){var e=t.slice(4);return zJ.test(e)?t:(e=e.replace(dje,gje),e.charAt(0)!=="-"&&(e="-"+e),s9+e)}function gje(t){return"-"+t.toLowerCase()}function yje(t){return t.charAt(1).toUpperCase()}const vje="classID",xje="datatype",_je="itemID",bje="strokeDasharray",Eje="strokeDashoffset",wje="strokeLinecap",Sje="strokeLinejoin",Tje="strokeMiterlimit",Aje="typeof",Mje="xlinkActuate",Cje="xlinkArcrole",Rje="xlinkHref",Ije="xlinkRole",Pje="xlinkShow",kje="xlinkTitle",Lje="xlinkType",Dje="xmlnsXlink",Nje={classId:vje,dataType:xje,itemId:_je,strokeDashArray:bje,strokeDashOffset:Eje,strokeLineCap:wje,strokeLineJoin:Sje,strokeMiterLimit:Tje,typeOf:Aje,xLinkActuate:Mje,xLinkArcRole:Cje,xLinkHref:Rje,xLinkRole:Ije,xLinkShow:Pje,xLinkTitle:kje,xLinkType:Lje,xmlnsXLink:Dje};var o9={};o9.parse=Uje;o9.stringify=Bje;var UB="",Oje=" ",Fje=/[ \t\n\r\f]+/g;function Uje(t){var e=String(t||UB).trim();return e===UB?[]:e.split(Fje)}function Bje(t){return t.join(Oje).trim()}var a9={};a9.parse=zje;a9.stringify=Hje;var QM=",",BB=" ",i1="";function zje(t){for(var e=[],n=String(t||i1),r=n.indexOf(QM),i=0,s=!1,o;!s;)r===-1&&(r=n.length,s=!0),o=n.slice(i,r).trim(),(o||!s)&&e.push(o),i=r+1,r=n.indexOf(QM,i);return e}function Hje(t,e){var n=e||{},r=n.padLeft===!1?i1:BB,i=n.padRight?BB:i1;return t[t.length-1]===i1&&(t=t.concat(i1)),t.join(i+QM+r).trim()}var zB=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,Gje=/\n/g,jje=/^\s*/,Vje=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,Wje=/^:\s*/,$je=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,Xje=/^[;\s]*/,qje=/^\s+|\s+$/g,Yje=`
`,HB="/",GB="*",pd="",Kje="comment",Zje="declaration",Qje=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function i(p){var m=p.match(Gje);m&&(n+=m.length);var g=p.lastIndexOf(Yje);r=~g?p.length-g:r+p.length}function s(){var p={line:n,column:r};return function(m){return m.position=new o(p),c(),m}}function o(p){this.start=p,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function a(p){var m=new Error(e.source+":"+n+":"+r+": "+p);if(m.reason=p,m.filename=e.source,m.line=n,m.column=r,m.source=t,!e.silent)throw m}function l(p){var m=p.exec(t);if(m){var g=m[0];return i(g),t=t.slice(g.length),m}}function c(){l(jje)}function u(p){var m;for(p=p||[];m=f();)m!==!1&&p.push(m);return p}function f(){var p=s();if(!(HB!=t.charAt(0)||GB!=t.charAt(1))){for(var m=2;pd!=t.charAt(m)&&(GB!=t.charAt(m)||HB!=t.charAt(m+1));)++m;if(m+=2,pd===t.charAt(m-1))return a("End of comment missing");var g=t.slice(2,m-2);return r+=2,i(g),t=t.slice(m),r+=2,p({type:Kje,comment:g})}}function d(){var p=s(),m=l(Vje);if(m){if(f(),!l(Wje))return a("property missing ':'");var g=l($je),y=p({type:Zje,property:jB(m[0].replace(zB,pd)),value:g?jB(g[0].replace(zB,pd)):pd});return l(Xje),y}}function h(){var p=[];u(p);for(var m;m=d();)m!==!1&&(p.push(m),u(p));return p}return c(),h()};function jB(t){return t?t.replace(qje,pd):pd}var Jje=Qje;function eVe(t,e){var n=null;if(!t||typeof t!="string")return n;for(var r,i=Jje(t),s=typeof e=="function",o,a,l=0,c=i.length;l<c;l++)r=i[l],o=r.property,a=r.value,s?e(o,a,r):a&&(n||(n={}),n[o]=a);return n}var tVe=eVe;const nVe="http://www.w3.org/1999/xhtml",rVe="http://www.w3.org/1998/Math/MathML",iVe="http://www.w3.org/2000/svg",sVe="http://www.w3.org/1999/xlink",oVe="http://www.w3.org/XML/1998/namespace",aVe="http://www.w3.org/2000/xmlns/",lVe={html:nVe,mathml:rVe,svg:iVe,xlink:sVe,xml:oVe,xmlns:aVe};var cVe=YGe,HJ=oje,uVe=uje,fVe=Nje,dVe=o9,hVe=a9,pVe=tVe,mVe=lVe,l9=e9,gVe=l9("root"),JM=l9("element"),yVe=l9("text"),vVe=xVe;function xVe(t,e,n){var r=n||{},i=bVe(t),s=SVe(t),o=wVe(t),a;if(typeof t!="function")throw new Error("h is not a function");if(typeof r=="string"||typeof r=="boolean"?(a=r,r={}):a=r.prefix,gVe(e))e=e.children.length===1&&JM(e.children[0])?e.children[0]:{type:"element",tagName:"div",properties:{},children:e.children};else if(!JM(e))throw new Error("Expected root or element, not `"+(e&&e.type||e)+"`");return GJ(t,e,{schema:r.space==="svg"?HJ:cVe,prefix:a??(i||s||o?"h-":null),key:0,react:i,vue:s,vdom:o,hyperscript:EVe(t)})}function GJ(t,e,n){var r=n.schema,i=r,s=e.tagName,o={},a=[],l=-1,c,u;r.space==="html"&&s.toLowerCase()==="svg"&&(i=HJ,n.schema=i);for(c in e.properties)_Ve(o,c,e.properties[c],n,s);if(n.vdom&&(i.space==="html"?s=s.toUpperCase():o.namespace=mVe[i.space]),n.prefix&&(n.key++,o.key=n.prefix+n.key),e.children)for(;++l<e.children.length;)u=e.children[l],JM(u)?a.push(GJ(t,u,n)):yVe(u)&&a.push(u.value);return n.schema=r,a.length?t.call(e,s,o,a):t.call(e,s,o)}function _Ve(t,e,n,r,i){var s=uVe(r.schema,e),o;n==null||n!==n||n===!1&&(r.vue||r.vdom||r.hyperscript)||!n&&s.boolean&&(r.vue||r.vdom||r.hyperscript)||(n&&typeof n=="object"&&"length"in n&&(n=(s.commaSeparated?hVe:dVe).stringify(n)),s.boolean&&r.hyperscript&&(n=""),s.property==="style"&&typeof n=="string"&&(r.react||r.vue||r.vdom)&&(n=TVe(n,i)),r.vue?s.property!=="style"&&(o="attrs"):s.mustUseProperty||(r.vdom?s.property!=="style"&&(o="attributes"):r.hyperscript&&(o="attrs")),o?(t[o]||(t[o]={}),t[o][s.attribute]=n):s.space&&r.react?t[fVe[s.property]||s.property]=n:t[s.attribute]=n)}function bVe(t){var e=t&&t("div");return!!(e&&("_owner"in e||"_store"in e)&&e.key==null)}function EVe(t){return!!(t&&t.context&&t.cleanup)}function wVe(t){return t&&t("div").type==="VirtualNode"}function SVe(t){var e=t&&t("div");return!!(e&&e.context&&e.context._isVue)}function TVe(t,e){var n={};try{pVe(t,r)}catch(i){throw i.message=e+"[style]"+i.message.slice(9),i}return n;function r(i,s){i.slice(0,4)==="-ms-"&&(i="ms-"+i.slice(4)),n[i.replace(/-([a-z])/g,AVe)]=s}}function AVe(t,e){return e.toUpperCase()}var MVe=jJ;function jJ(t){if(typeof t=="string")return PVe(t);if(t==null)return kVe;if(typeof t=="object")return("length"in t?IVe:RVe)(t);if(typeof t=="function")return t;throw new Error("Expected function, string, or object as test")}function CVe(t){for(var e=[],n=t.length,r=-1;++r<n;)e[r]=jJ(t[r]);return e}function RVe(t){return e;function e(n){var r;for(r in t)if(n[r]!==t[r])return!1;return!0}}function IVe(t){var e=CVe(t),n=e.length;return r;function r(){for(var i=-1;++i<n;)if(e[i].apply(this,arguments))return!0;return!1}}function PVe(t){return e;function e(n){return!!(n&&n.type===t)}}function kVe(){return!0}var LVe=Ew,DVe=MVe,VJ=!0,WJ="skip",T3=!1;Ew.CONTINUE=VJ;Ew.SKIP=WJ;Ew.EXIT=T3;function Ew(t,e,n,r){var i;typeof e=="function"&&typeof n!="function"&&(r=n,n=e,e=null),i=DVe(e),s(t,null,[]);function s(a,l,c){var u=[],f;return(!e||i(a,l,c[c.length-1]||null))&&(u=VB(n(a,c)),u[0]===T3)?u:a.children&&u[0]!==WJ?(f=VB(o(a.children,c.concat(a))),f[0]===T3?f:u):u}function o(a,l){for(var c=-1,u=r?-1:1,f=(r?a.length:c)+u,d;f>c&&f<a.length;){if(d=s(a[f],f,l),d[0]===T3)return d;f=typeof d[1]=="number"?d[1]:f+u}}}function VB(t){return t!==null&&typeof t=="object"&&"length"in t?t:typeof t=="number"?[VJ,t]:[t]}var NVe=Sw,ww=LVe,OVe=ww.CONTINUE,FVe=ww.SKIP,UVe=ww.EXIT;Sw.CONTINUE=OVe;Sw.SKIP=FVe;Sw.EXIT=UVe;function Sw(t,e,n,r){typeof e=="function"&&typeof n!="function"&&(r=n,n=e,e=null),ww(t,e,i,r);function i(s,o){var a=o[o.length-1],l=a?a.children.indexOf(s):null;return n(s,l,a)}}var BVe=NVe,zVe=Object.prototype.hasOwnProperty,GA={align:"text-align",valign:"vertical-align",height:"height",width:"width"},HVe=function(t){return BVe(t,"element",GVe),t};function GVe(t){if(!(t.tagName!=="tr"&&t.tagName!=="td"&&t.tagName!=="th")){var e,n;for(e in GA)!zVe.call(GA,e)||t.properties[e]===void 0||(n=GA[e],jVe(t,n,t.properties[e]),delete t.properties[e])}}function jVe(t,e,n){var r=(t.properties.style||"").trim();r&&!/;\s*/.test(r)&&(r+=";"),r&&(r+=" ");var i=r+e+": "+n+";";t.properties.style=i}var VVe=vVe,WVe=HVe,$Ve=YVe,XVe={}.hasOwnProperty,qVe=new Set(["table","thead","tbody","tfoot","tr","th","td"]);function YVe(t){var e=t||{},n=e.createElement;this.Compiler=r;function r(s){var o=VVe(i,WVe(s),e.prefix);return s.type==="root"?(o=o.type==="div"&&(s.children.length!==1||s.children[0].type!=="element")?o.props.children:[o],n(e.Fragment||"div",{},o)):o}function i(s,o,a){var l=s;return a&&qVe.has(s)&&(a=a.filter(function(c){return c!==`
`})),e.components&&XVe.call(e.components,s)&&(l=e.components[s],e.passNode&&(o.node=this)),n(l,o,a)}}const KVe=mu($Ve);function e6(){return e6=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},e6.apply(this,arguments)}function ZVe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var QVe=["children"],JVe=function(t){var e=t===void 0?{}:t,n=e.remarkParseOptions,r=e.remarkToRehypeOptions,i=e.rehypeReactOptions,s=e.remarkPlugins,o=s===void 0?[]:s,a=e.rehypePlugins,l=a===void 0?[]:a,c=e.onError,u=c===void 0?function(){}:c,f=v.useState(null),d=f[0],h=f[1],p=v.useCallback(function(m){oDe().use(qBe,n).use(o).use(gGe,r).use(l).use(KVe,e6({createElement:v.createElement,Fragment:v.Fragment},i)).process(m).then(function(g){return h(g.result)}).catch(u)},[]);return[d,p]},eWe=function(t){var e=t.children,n=ZVe(t,QVe),r=JVe(n),i=r[0],s=r[1];return v.useEffect(function(){s(e)},[e,s]),i};function $J({_key:t,children:e,style:n,...r}){const{markdown:i}=v.useMemo(()=>({markdown:typeof e=="string"?e:e.join(" ")}),[e,n]);return H.jsx(eWe,{rehypePlugins:[uLe],remarkToRehypeOptions:{allowDangerousHtml:!0},...r,children:i})}function XJ({_key:t,start:e=0,end:n,stepSize:r=1,play:i=!1}){const{sendMsg:s}=Mr(),{clock:o}=At();v.useEffect(()=>i?o.start():o.stop(),[]);const a=v.useCallback(f=>{const d={etype:"TIMELINE_STEP",key:t,value:{step:f,elapsedTime:o.getElapsedTime(),delta:o.getDelta()}};try{s(d)}catch{return}},[]),l=vr("Timeline",{stepSize:{value:r,min:-5,max:10,step:.5}},[]),[c,u]=vr("Timeline",()=>({step:{value:0,min:e,max:n,step:l.stepSize,onChange:f=>{typeof f>"u"||a(f)},transient:!1},frameRate:{value:30,min:1,max:240,step:1},play:Oy(()=>{o.running?o.stop():o.start()},{label:function(){return o.running?"Pause":"Play"}})}),[l.stepSize]);return v.useEffect(()=>{if(c.frameRate<=0)return;const f=setInterval(()=>{o.running&&(c.step+=1,u({step:c.step}),a(c.step))},1e3/c.frameRate);return()=>{clearInterval(f)}},[o,c,c.frameRate]),null}const qJ=Ge.lazy(()=>t6(()=>import("./chunk-CY_2iGUk.js"),__vite__mapDeps([4,3,1,2]))),tWe="_container_hv7nz_1",nWe="_primaryStyle_hv7nz_10",rWe="_resizable_hv7nz_15",iWe="_resizableInner_hv7nz_36";function sWe({_key:t,children:[e,n],vertical:r=!1,offset:i=0,hidden:s=!1}){const o=i<0,a=v.useRef(null),[l,c]=v.useState({size:1,isHidden:s}),u=r?"width":"height",f=r?"x":"y";v.useEffect(()=>{s!==null&&c({...l,isHidden:s})},[s]);const d=l.isHidden?"100%":`calc(${l.size*100}% - ${Math.abs(i)}px)`,h=l.isHidden?null:H.jsx("div",{className:iWe,children:n}),p=H.jsx("div",{className:nWe,style:{flexShrink:l.isHidden?0:1,height:r?"100%":d,width:r?d:"100%"},children:e});return H.jsxs("div",{ref:a,className:tWe,style:{flexDirection:r?"row":"column"},children:[o?h:p,H.jsx("div",{className:rWe,style:{width:r?"16px":"auto",height:r?"auto":"16px",cursor:r?"ew-resize":"ns-resize",padding:r?"0 7px":"7px 0",margin:r?"0 -7px":"-7px 0"},onPointerDown:m=>{m.currentTarget.setPointerCapture(m.pointerId)},onPointerMove:m=>{const g=m.currentTarget;if(a!=null&&a.current&&g.hasPointerCapture(m.pointerId)){const y=a.current.getBoundingClientRect(),x=(m[f]||m[`client${f.toUpperCase()}`])-y[f],_=o?x<-i/2:y[u]-x<i/2,w=o?y[u]-x:x,T=Od((w+Math.abs(i))/y[u],0,1);c({size:T,isHidden:_})}},onPointerUp:m=>{m.currentTarget.releasePointerCapture(m.pointerId)}}),o?p:h]})}const oWe="_containerStyle_so8x0_1",aWe="_primaryStyle_so8x0_10",lWe="_panelContainerStyle_so8x0_15",cWe="_shrunkStyle_so8x0_36",uWe="_panelStyle_so8x0_43";function fWe({_key:t,style:e={},children:[n,r,i],vertical:s=!1,offset:o=0,minOffset:a=0,hidden:l=null}){const c=o<0,u=v.useRef(null),[f,d]=v.useState({size:c?1:0,isHidden:l}),h=s?"width":"height",p=s?"x":"y";v.useEffect(()=>{l!==null&&d({...f,isHidden:l})},[l]);const m=f.isHidden?`calc(100% - ${a}px)`:`calc(${f.size*100}% - ${Math.abs(o)}px)`;return H.jsxs("div",{ref:u,className:oWe,style:{flexDirection:s?"row":"column",...e},children:[H.jsx("div",{className:aWe,style:{flexShrink:f.isHidden?0:1,height:s?"100%":m,width:s?m:"100%"},children:n}),H.jsx("div",{className:lWe,style:{width:s?"16px":"auto",height:s?"auto":"16px",cursor:s?"ew-resize":"ns-resize",padding:s?"0 7px":"7px 0",margin:s?"0 -7px":"-7px 0"},onPointerDown:g=>{g.currentTarget.setPointerCapture(g.pointerId)},onPointerMove:g=>{if(u.current&&g.currentTarget.hasPointerCapture(g.pointerId)){const y=u.current.getBoundingClientRect(),x=(g[p]||g[`client${p.toUpperCase()}`])-y[p],_=c?x<-o/2:y[h]-x<o/2,w=c?y[h]-x:x,T=Od((w+Math.abs(o))/y[h],0,1);d({size:T,isHidden:_})}},onPointerUp:g=>{g.currentTarget.releasePointerCapture(g.pointerId)}}),f.isHidden?H.jsx("div",{className:cWe,children:i}):H.jsx("div",{className:uWe,children:r})]})}const dWe="_listName_1s0ny_1",YJ=v.createContext({value:!1}),hWe=({children:t})=>H.jsx(YJ.Provider,{value:{value:!0},children:t}),KJ=()=>v.useContext(YJ),pWe=()=>{const t=KJ();return console.log("Simple:",t),H.jsxs("div",{children:[H.jsx($B,{children:H.jsx("title",{children:"Simple Helmet works"})}),H.jsx("h1",{className:dWe,children:"Simple Component"}),H.jsx("p",{children:t!=null&&t.value?"This is cool!":"context value did not load"})]})},PXe=Object.freeze(Object.defineProperty({__proto__:null,ALL_SCENE_KEYS:Am,AccumulativeShadows:NC,AdaptiveDpr:kV,AdaptiveEvents:LV,AddOp:rMe,AmbientLight:fR,AmbientLightStage:vK,AppContext:$y,AppProvider:cRe,Arrow:ZK,AsciiRenderer:yj,AutoScroll:hZ,BBAnchor:Nj,BBox:VE,Backdrop:dV,BakeShadows:PV,Billboard:uC,Bounds:TC,Box:vq,Button:pZ,Bvh:Dj,CONTRIB_COMPONENT_LIST:XY,Camera:lq,CameraShake:nV,CameraView:pK,Capsule:xq,CatmullRomLine:HG,Caustics:pV,Center:bC,ChildrenKey:O8,Circle:_q,Clone:m_,Cloud:_V,Combine:bMe,ComputedAttribute:hj,Cone:bq,ContactShadows:DC,ContribLoader:bZ,CoordsMarker:QK,CubicBezierLine:zG,CurveModifier:jj,CycleRaycast:eG,Cylinder:Eq,Dae:sK,Decal:mj,Detailed:RV,DirectionalLight:WE,Div:xZ,Dodecahedron:wq,Edges:Sq,Effects:rj,Environment:LC,EventEmitter:Bq,Extrude:Tq,FIBER:Qle,FILE_REGISTER:CM,FaceLandmarker:YV,Facemesh:XV,FileDropContainer:nR,Fisheye:FV,Float:rV,Frustum:eb,Fuse:_Me,Gamepad:D8,Glb:K_,Gltf:K_,GrabRender:JK,GradientTexture:ij,GraphView:sMe,Grid:eZ,Gripper:nZ,HUDPlane:Ef,HandleBox:uK,Hands:lK,HemisphereLight:uR,HemisphereLightStage:xK,Html:ch,Hud:mC,Icosahedron:Aq,Image:oj,ImageBackground:ER,ImagePlane:I1,ImageUpload:vZ,Img:gZ,Input:yZ,Instances:Ry,Lathe:Mq,Lightformer:yV,Line:Ni,LumaSplats:qJ,MarchingCubes:pj,Markdown:$J,Mask:OV,Merged:zj,MeshDiscardMaterial:Yj,MeshDistortMaterial:Vj,MeshPortalMaterial:UV,MeshReflectorMaterial:$j,MeshRefractionMaterial:Xj,MeshTransmissionMaterial:qj,MeshWobbleMaterial:Wj,MotionControllers:cK,Movable:lR,NodeItem:_M,NodeList:F8,Obj:QY,Octahedron:Cq,Outlines:hC,Pcd:JY,PerformanceMonitor:NV,Pivot:oR,PivotXR:aR,Plane:Rq,Playback:TR,PlaybackBar:dZ,PlaybackContext:QE,PlaybackControls:MR,PlaybackProvider:aZ,PlaybackStateContext:JE,PlaybackStateProvider:lZ,Playhead:wR,Ply:eK,PointCloud:GK,PointLight:yK,PointMaterial:Kj,Pointer:cR,PointerControls:hK,Points:AV,Polyhedron:Iq,PositionalAudio:GG,Preload:IV,QuadraticBezierLine:BG,RandomizedLight:OC,Range:SR,RectAreaLight:mK,RemoveOp:iMe,Render:wZ,RenderCubeTexture:BC,RenderLayer:SZ,RenderTexture:UC,Resizable:sWe,ResizableSwitch:fWe,Resize:eV,Ring:Pq,RoundedBox:Qj,Sampler:dj,Scene:H8,SceneBackground:WK,SceneContainer:ZY,SceneFileDropContainer:YY,ScreenQuad:Jj,ScreenSpace:FG,Segments:CV,Select:OG,SetOp:gq,Shadow:hV,Shape:kq,SimpleComponent:pWe,SimpleProvider:hWe,SkeletalGripper:G8,Sky:vV,Slider:mZ,SocketContext:L8,SoftShadows:Zj,Sparkles:SV,Sphere:Lq,Splat:rZ,SpotLight:gK,SpotLightShadow:gV,SpriteAnimator:Gj,Stage:fV,Stars:xV,StereoVideoPlane:KK,Stl:iK,Store:Tm,Svg:gj,THREE:SH,Tetrahedron:Dq,Text:_Z,Text3D:nj,Timeline:uZ,TimelineControls:XJ,TimelineFileDrop:fZ,TimelineStateContext:ew,TimelineStateProvider:cZ,Timestamp:ab,Torus:Nq,TorusKnot:Oq,Trail:fj,TriMesh:VK,Tube:Fq,UpdateOp:yq,UpsertOp:NE,Urdf:rK,VideoMaterial:ZE,VideoPlane:XK,View:HC,VuerGroup:ph,VuerRoot:uRe,WebRTCStereoVideoPlane:YK,WebRTCVideoMaterial:bR,WebRTCVideoPlane:qK,WebSocketProvider:z5e,Wireframe:Uq,XrMovableAnchor:fK,XrMovableLocal:sR,ZUSTAND:J5e,addNode:pq,controllerState:oa,findByKey:Vy,getLandmark:aK,getState:J_,handState:Jr,imageToBase64:zq,l2:M1,list2menu:tZ,mat2Pos:Yu,removeByKey:dq,sentinel:oZ,transposeTuple:oy,updateNode:hq,upsertNode:mq,useMotionControllerState:Q_,usePlayback:mh,usePlaybackStates:AR,useSceneStore:OE,useSimple:KJ,useSocket:Mr,useSourceState:Z_,useTimelineStates:tw},Symbol.toStringTag,{value:"Module"}));export{gn as $,to as A,ri as B,wt as C,Vb as D,xr as E,Qle as F,ZY as G,tfe as H,fZ as I,Fr as J,Nr as K,j$ as L,et as M,xK as N,yn as O,Oi as P,bn as Q,oh as R,d_ as S,SH as T,eZ as U,PXe as V,oi as W,hu as X,OE as Y,fc as Z,It as _,bMe as a,$3 as a$,Dt as a0,ln as a1,$o as a2,_y as a3,Ps as a4,Ub as a5,Tf as a6,Fc as a7,es as a8,Kn as a9,Xo as aA,Za as aB,ru as aC,O2 as aD,$d as aE,oC as aF,zn as aG,Rb as aH,sc as aI,Rs as aJ,Pn as aK,Ts as aL,Pr as aM,G3 as aN,u1 as aO,H3 as aP,F3 as aQ,c1 as aR,B3 as aS,z3 as aT,N3 as aU,o1 as aV,pr as aW,ti as aX,As as aY,_b as aZ,Yc as a_,wr as aa,Ib as ab,Ar as ac,Hi as ad,pre as ae,Sl as af,Br as ag,Ms as ah,qr as ai,ns as aj,Or as ak,ei as al,tr as am,nu as an,nh as ao,pm as ap,Jd as aq,dr as ar,Gm as as,Hm as at,jm as au,Qd as av,wf as aw,Wb as ax,_6 as ay,Qa as az,lK as b,N$e as b$,fn as b0,UG as b1,rs as b2,m5 as b3,m_ as b4,OWe as b5,Gi as b6,Gz as b7,T6 as b8,Jz as b9,LV as bA,yj as bB,Nj as bC,dV as bD,PV as bE,uC as bF,TC as bG,w$e as bH,Dj as bI,nV as bJ,U$e as bK,HG as bL,pV as bM,S$e as bN,_V as bO,TL as bP,j0e as bQ,hj as bR,T$e as bS,DC as bT,epe as bU,zG as bV,jj as bW,eG as bX,A$e as bY,mj as bZ,RV as b_,D4 as ba,ah as bb,E6 as bc,Q6 as bd,Bm as be,sf as bf,df as bg,Mo as bh,Om as bi,fH as bj,Fn as bk,bC as bl,nj as bm,$me as bn,fr as bo,Wme as bp,Cy as bq,Ml as br,g6 as bs,Yo as bt,q6 as bu,W$e as bv,uc as bw,XV as bx,NC as by,kV as bz,lZ as c,OC as c$,aj as c0,rj as c1,LC as c2,cV as c3,kC as c4,y0e as c5,O$e as c6,YV as c7,oD as c8,gT as c9,zj as cA,Yj as cB,Vj as cC,UV as cD,$j as cE,Xj as cF,qj as cG,Wj as cH,D$e as cI,tpe as cJ,nE as cK,hC as cL,NV as cM,vj as cN,wge as cO,Qme as cP,H$e as cQ,Kj as cR,Kme as cS,AV as cT,Y0e as cU,k$e as cV,Fme as cW,X0e as cX,GG as cY,IV as cZ,BG as c_,sD as ca,gg as cb,g$e as cc,FV as cd,rV as ce,Bk as cf,fpe as cg,dpe as ch,ij as ci,Ck as cj,ppe as ck,y$e as cl,ch as cm,mC as cn,L$e as co,oj as cp,EC as cq,_$e as cr,Ry as cs,F$e as ct,yV as cu,Ni as cv,p$e as cw,pj as cx,m$e as cy,OV as cz,cZ as d,bXe as d$,BC as d0,UC as d1,eV as d2,P$e as d3,Qj as d4,dj as d5,Jj as d6,FG as d7,G$e as d8,K0e as d9,mpe as dA,x$e as dB,y3 as dC,f$e as dD,v$e as dE,r0e as dF,Jhe as dG,aE as dH,dC as dI,gC as dJ,fh as dK,Ime as dL,V$e as dM,j$e as dN,c$e as dO,b$e as dP,yC as dQ,Ghe as dR,Hhe as dS,Q$e as dT,nr as dU,e4e as dV,JSe as dW,Gy as dX,eXe as dY,tXe as dZ,Z$e as d_,CV as da,OG as db,hV as dc,B$e as dd,vV as de,Zj as df,SV as dg,SC as dh,Lk as di,z$e as dj,gV as dk,Gj as dl,fV as dm,xV as dn,gj as dp,I$e as dq,Mk as dr,h$e as ds,C$e as dt,R$e as du,fj as dv,M$e as dw,HC as dx,uV as dy,D0e as dz,bZ as e,sXe as e$,wX as e0,m4e as e1,h4e as e2,v4e as e3,g4e as e4,d4e as e5,p4e as e6,zy as e7,TX as e8,x4e as e9,Ewe as eA,O_ as eB,wwe as eC,uwe as eD,F4e as eE,OSe as eF,I4e as eG,R4e as eH,o4e as eI,nXe as eJ,rXe as eK,Rc as eL,U4e as eM,l4e as eN,aXe as eO,lXe as eP,b8 as eQ,a4e as eR,t4e as eS,c4e as eT,n4e as eU,CXe as eV,wXe as eW,TXe as eX,MXe as eY,L4e as eZ,gXe as e_,y4e as ea,N4e as eb,H4e as ec,kE as ed,u4e as ee,IXe as ef,C4e as eg,f4e as eh,uXe as ei,EXe as ej,M4e as ek,CX as el,oXe as em,r4e as en,xXe as eo,cXe as ep,s4e as eq,vXe as er,_Xe as es,D4e as et,fXe as eu,mXe as ev,hXe as ew,Il as ex,vX as ey,A4e as ez,dZ as f,_8 as f0,ga as f1,iXe as f2,P4e as f3,dXe as f4,k4e as f5,pXe as f6,RXe as f7,yXe as f8,AXe as f9,M3 as fA,zi as fB,$a as fC,Qt as fD,Cs as fE,E8 as fa,SXe as fb,hWe as fc,pWe as fd,Sr as fe,wy as ff,Ya as fg,z1 as fh,rf as fi,Nm as fj,io as fk,uf as fl,ss as fm,hf as fn,my as fo,Hb as fp,fre as fq,ls as fr,Fm as fs,wb as ft,yr as fu,D6 as fv,Js as fw,mb as fx,Ku as fy,gb as fz,fWe as g,aZ as h,cRe as i,YY as j,uRe as k,$ as l,sWe as m,z5e as n,sMe as o,Mr as p,Ke as q,kWe as r,mh as s,Ln as t,At as u,Hn as v,uZ as w,Yt as x,lh as y,Kb as z};
//# sourceMappingURL=chunk-Bfuqp34V.js.map

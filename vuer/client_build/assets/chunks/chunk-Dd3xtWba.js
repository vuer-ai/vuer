const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/chunk-JV_3G-wq.js","assets/chunks/chunk-CnlBHst8.js","assets/static/onRenderClient.B48D1ByE.css","assets/chunks/chunk-D7HrI6pR.js","assets/chunks/chunk-Bazdu1RU.js","assets/chunks/chunk-C92vmGZt.js"])))=>i.map(i=>d[i]);
var Ic=Object.defineProperty;var Mc=(K,_,Z)=>_ in K?Ic(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z;var Dn=(K,_,Z)=>Mc(K,typeof _!="symbol"?_+"":_,Z);import{_ as __vitePreload}from"./chunk-D7HrI6pR.js";import{r as reactExports,l as requireScheduler,g as getDefaultExportFromCjs$1,j as jsxRuntimeExports,f as createRoot$1,R as React,m as reactDomExports,e as ReactDOM,$ as $2AODx$react,h as commonjsGlobal,H as Helmet}from"./chunk-CnlBHst8.js";function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_];for(var te in Z)({}).hasOwnProperty.call(Z,te)&&(K[te]=Z[te])}return K},_extends$3.apply(null,arguments)}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="175",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,NeutralToneMapping=7,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,UnsignedInt5999Type=35902,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBIntegerFormat=1032,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,BasicDepthPacking=3200,RGBADepthPacking=3201,RGBDepthPacking=3202,RGDepthPacking=3203,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace$1="",SRGBColorSpace$2="srgb",LinearSRGBColorSpace$2="srgb-linear",LinearTransfer="linear",SRGBTransfer="srgb",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001,TimestampQuery={COMPUTE:"compute",RENDER:"render"};let EventDispatcher$1=class{addEventListener(_,Z){this._listeners===void 0&&(this._listeners={});const te=this._listeners;te[_]===void 0&&(te[_]=[]),te[_].indexOf(Z)===-1&&te[_].push(Z)}hasEventListener(_,Z){const te=this._listeners;return te===void 0?!1:te[_]!==void 0&&te[_].indexOf(Z)!==-1}removeEventListener(_,Z){const te=this._listeners;if(te===void 0)return;const ne=te[_];if(ne!==void 0){const ie=ne.indexOf(Z);ie!==-1&&ne.splice(ie,1)}}dispatchEvent(_){const Z=this._listeners;if(Z===void 0)return;const te=Z[_.type];if(te!==void 0){_.target=this;const ne=te.slice(0);for(let ie=0,oe=ne.length;ie<oe;ie++)ne[ie].call(this,_);_.target=null}}};const _lut$1=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID$1(){const K=Math.random()*4294967295|0,_=Math.random()*4294967295|0,Z=Math.random()*4294967295|0,te=Math.random()*4294967295|0;return(_lut$1[K&255]+_lut$1[K>>8&255]+_lut$1[K>>16&255]+_lut$1[K>>24&255]+"-"+_lut$1[_&255]+_lut$1[_>>8&255]+"-"+_lut$1[_>>16&15|64]+_lut$1[_>>24&255]+"-"+_lut$1[Z&63|128]+_lut$1[Z>>8&255]+"-"+_lut$1[Z>>16&255]+_lut$1[Z>>24&255]+_lut$1[te&255]+_lut$1[te>>8&255]+_lut$1[te>>16&255]+_lut$1[te>>24&255]).toLowerCase()}function clamp$4(K,_,Z){return Math.max(_,Math.min(Z,K))}function euclideanModulo(K,_){return(K%_+_)%_}function mapLinear(K,_,Z,te,ne){return te+(K-_)*(ne-te)/(Z-_)}function inverseLerp(K,_,Z){return K!==_?(Z-K)/(_-K):0}function lerp(K,_,Z){return(1-Z)*K+Z*_}function damp(K,_,Z,te){return lerp(K,_,1-Math.exp(-Z*te))}function pingpong(K,_=1){return _-Math.abs(euclideanModulo(K,_*2)-_)}function smoothstep(K,_,Z){return K<=_?0:K>=Z?1:(K=(K-_)/(Z-_),K*K*(3-2*K))}function smootherstep(K,_,Z){return K<=_?0:K>=Z?1:(K=(K-_)/(Z-_),K*K*K*(K*(K*6-15)+10))}function randInt(K,_){return K+Math.floor(Math.random()*(_-K+1))}function randFloat(K,_){return K+Math.random()*(_-K)}function randFloatSpread(K){return K*(.5-Math.random())}function seededRandom(K){K!==void 0&&(_seed=K);let _=_seed+=1831565813;return _=Math.imul(_^_>>>15,_|1),_^=_+Math.imul(_^_>>>7,_|61),((_^_>>>14)>>>0)/4294967296}function degToRad(K){return K*DEG2RAD}function radToDeg(K){return K*RAD2DEG}function isPowerOfTwo(K){return(K&K-1)===0&&K!==0}function ceilPowerOfTwo(K){return Math.pow(2,Math.ceil(Math.log(K)/Math.LN2))}function floorPowerOfTwo(K){return Math.pow(2,Math.floor(Math.log(K)/Math.LN2))}function setQuaternionFromProperEuler(K,_,Z,te,ne){const ie=Math.cos,oe=Math.sin,se=ie(Z/2),ae=oe(Z/2),le=ie((_+te)/2),ce=oe((_+te)/2),fe=ie((_-te)/2),de=oe((_-te)/2),pe=ie((te-_)/2),he=oe((te-_)/2);switch(ne){case"XYX":K.set(se*ce,ae*fe,ae*de,se*le);break;case"YZY":K.set(ae*de,se*ce,ae*fe,se*le);break;case"ZXZ":K.set(ae*fe,ae*de,se*ce,se*le);break;case"XZX":K.set(se*ce,ae*he,ae*pe,se*le);break;case"YXY":K.set(ae*pe,se*ce,ae*he,se*le);break;case"ZYZ":K.set(ae*he,ae*pe,se*ce,se*le);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+ne)}}function denormalize(K,_){switch(_.constructor){case Float32Array:return K;case Uint32Array:return K/4294967295;case Uint16Array:return K/65535;case Uint8Array:return K/255;case Int32Array:return Math.max(K/2147483647,-1);case Int16Array:return Math.max(K/32767,-1);case Int8Array:return Math.max(K/127,-1);default:throw new Error("Invalid component type.")}}function normalize$c(K,_){switch(_.constructor){case Float32Array:return K;case Uint32Array:return Math.round(K*4294967295);case Uint16Array:return Math.round(K*65535);case Uint8Array:return Math.round(K*255);case Int32Array:return Math.round(K*2147483647);case Int16Array:return Math.round(K*32767);case Int8Array:return Math.round(K*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID:generateUUID$1,clamp:clamp$4,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize:normalize$c,denormalize};class Vector2{constructor(_=0,Z=0){Vector2.prototype.isVector2=!0,this.x=_,this.y=Z}get width(){return this.x}set width(_){this.x=_}get height(){return this.y}set height(_){this.y=_}set(_,Z){return this.x=_,this.y=Z,this}setScalar(_){return this.x=_,this.y=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setComponent(_,Z){switch(_){case 0:this.x=Z;break;case 1:this.y=Z;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y)}copy(_){return this.x=_.x,this.y=_.y,this}add(_){return this.x+=_.x,this.y+=_.y,this}addScalar(_){return this.x+=_,this.y+=_,this}addVectors(_,Z){return this.x=_.x+Z.x,this.y=_.y+Z.y,this}addScaledVector(_,Z){return this.x+=_.x*Z,this.y+=_.y*Z,this}sub(_){return this.x-=_.x,this.y-=_.y,this}subScalar(_){return this.x-=_,this.y-=_,this}subVectors(_,Z){return this.x=_.x-Z.x,this.y=_.y-Z.y,this}multiply(_){return this.x*=_.x,this.y*=_.y,this}multiplyScalar(_){return this.x*=_,this.y*=_,this}divide(_){return this.x/=_.x,this.y/=_.y,this}divideScalar(_){return this.multiplyScalar(1/_)}applyMatrix3(_){const Z=this.x,te=this.y,ne=_.elements;return this.x=ne[0]*Z+ne[3]*te+ne[6],this.y=ne[1]*Z+ne[4]*te+ne[7],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this}clamp(_,Z){return this.x=clamp$4(this.x,_.x,Z.x),this.y=clamp$4(this.y,_.y,Z.y),this}clampScalar(_,Z){return this.x=clamp$4(this.x,_,Z),this.y=clamp$4(this.y,_,Z),this}clampLength(_,Z){const te=this.length();return this.divideScalar(te||1).multiplyScalar(clamp$4(te,_,Z))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_){return this.x*_.x+this.y*_.y}cross(_){return this.x*_.y-this.y*_.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_){const Z=Math.sqrt(this.lengthSq()*_.lengthSq());if(Z===0)return Math.PI/2;const te=this.dot(_)/Z;return Math.acos(clamp$4(te,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const Z=this.x-_.x,te=this.y-_.y;return Z*Z+te*te}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,Z){return this.x+=(_.x-this.x)*Z,this.y+=(_.y-this.y)*Z,this}lerpVectors(_,Z,te){return this.x=_.x+(Z.x-_.x)*te,this.y=_.y+(Z.y-_.y)*te,this}equals(_){return _.x===this.x&&_.y===this.y}fromArray(_,Z=0){return this.x=_[Z],this.y=_[Z+1],this}toArray(_=[],Z=0){return _[Z]=this.x,_[Z+1]=this.y,_}fromBufferAttribute(_,Z){return this.x=_.getX(Z),this.y=_.getY(Z),this}rotateAround(_,Z){const te=Math.cos(Z),ne=Math.sin(Z),ie=this.x-_.x,oe=this.y-_.y;return this.x=ie*te-oe*ne+_.x,this.y=ie*ne+oe*te+_.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_,Z,te,ne,ie,oe,se,ae,le){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_!==void 0&&this.set(_,Z,te,ne,ie,oe,se,ae,le)}set(_,Z,te,ne,ie,oe,se,ae,le){const ce=this.elements;return ce[0]=_,ce[1]=ne,ce[2]=se,ce[3]=Z,ce[4]=ie,ce[5]=ae,ce[6]=te,ce[7]=oe,ce[8]=le,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const Z=this.elements,te=_.elements;return Z[0]=te[0],Z[1]=te[1],Z[2]=te[2],Z[3]=te[3],Z[4]=te[4],Z[5]=te[5],Z[6]=te[6],Z[7]=te[7],Z[8]=te[8],this}extractBasis(_,Z,te){return _.setFromMatrix3Column(this,0),Z.setFromMatrix3Column(this,1),te.setFromMatrix3Column(this,2),this}setFromMatrix4(_){const Z=_.elements;return this.set(Z[0],Z[4],Z[8],Z[1],Z[5],Z[9],Z[2],Z[6],Z[10]),this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,Z){const te=_.elements,ne=Z.elements,ie=this.elements,oe=te[0],se=te[3],ae=te[6],le=te[1],ce=te[4],fe=te[7],de=te[2],pe=te[5],he=te[8],ge=ne[0],me=ne[3],Ae=ne[6],ye=ne[1],ve=ne[4],_e=ne[7],Te=ne[2],be=ne[5],Re=ne[8];return ie[0]=oe*ge+se*ye+ae*Te,ie[3]=oe*me+se*ve+ae*be,ie[6]=oe*Ae+se*_e+ae*Re,ie[1]=le*ge+ce*ye+fe*Te,ie[4]=le*me+ce*ve+fe*be,ie[7]=le*Ae+ce*_e+fe*Re,ie[2]=de*ge+pe*ye+he*Te,ie[5]=de*me+pe*ve+he*be,ie[8]=de*Ae+pe*_e+he*Re,this}multiplyScalar(_){const Z=this.elements;return Z[0]*=_,Z[3]*=_,Z[6]*=_,Z[1]*=_,Z[4]*=_,Z[7]*=_,Z[2]*=_,Z[5]*=_,Z[8]*=_,this}determinant(){const _=this.elements,Z=_[0],te=_[1],ne=_[2],ie=_[3],oe=_[4],se=_[5],ae=_[6],le=_[7],ce=_[8];return Z*oe*ce-Z*se*le-te*ie*ce+te*se*ae+ne*ie*le-ne*oe*ae}invert(){const _=this.elements,Z=_[0],te=_[1],ne=_[2],ie=_[3],oe=_[4],se=_[5],ae=_[6],le=_[7],ce=_[8],fe=ce*oe-se*le,de=se*ae-ce*ie,pe=le*ie-oe*ae,he=Z*fe+te*de+ne*pe;if(he===0)return this.set(0,0,0,0,0,0,0,0,0);const ge=1/he;return _[0]=fe*ge,_[1]=(ne*le-ce*te)*ge,_[2]=(se*te-ne*oe)*ge,_[3]=de*ge,_[4]=(ce*Z-ne*ae)*ge,_[5]=(ne*ie-se*Z)*ge,_[6]=pe*ge,_[7]=(te*ae-le*Z)*ge,_[8]=(oe*Z-te*ie)*ge,this}transpose(){let _;const Z=this.elements;return _=Z[1],Z[1]=Z[3],Z[3]=_,_=Z[2],Z[2]=Z[6],Z[6]=_,_=Z[5],Z[5]=Z[7],Z[7]=_,this}getNormalMatrix(_){return this.setFromMatrix4(_).invert().transpose()}transposeIntoArray(_){const Z=this.elements;return _[0]=Z[0],_[1]=Z[3],_[2]=Z[6],_[3]=Z[1],_[4]=Z[4],_[5]=Z[7],_[6]=Z[2],_[7]=Z[5],_[8]=Z[8],this}setUvTransform(_,Z,te,ne,ie,oe,se){const ae=Math.cos(ie),le=Math.sin(ie);return this.set(te*ae,te*le,-te*(ae*oe+le*se)+oe+_,-ne*le,ne*ae,-ne*(-le*oe+ae*se)+se+Z,0,0,1),this}scale(_,Z){return this.premultiply(_m3.makeScale(_,Z)),this}rotate(_){return this.premultiply(_m3.makeRotation(-_)),this}translate(_,Z){return this.premultiply(_m3.makeTranslation(_,Z)),this}makeTranslation(_,Z){return _.isVector2?this.set(1,0,_.x,0,1,_.y,0,0,1):this.set(1,0,_,0,1,Z,0,0,1),this}makeRotation(_){const Z=Math.cos(_),te=Math.sin(_);return this.set(Z,-te,0,te,Z,0,0,0,1),this}makeScale(_,Z){return this.set(_,0,0,0,Z,0,0,0,1),this}equals(_){const Z=this.elements,te=_.elements;for(let ne=0;ne<9;ne++)if(Z[ne]!==te[ne])return!1;return!0}fromArray(_,Z=0){for(let te=0;te<9;te++)this.elements[te]=_[te+Z];return this}toArray(_=[],Z=0){const te=this.elements;return _[Z]=te[0],_[Z+1]=te[1],_[Z+2]=te[2],_[Z+3]=te[3],_[Z+4]=te[4],_[Z+5]=te[5],_[Z+6]=te[6],_[Z+7]=te[7],_[Z+8]=te[8],_}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(K){for(let _=K.length-1;_>=0;--_)if(K[_]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(K,_){return new TYPED_ARRAYS[K](_)}function createElementNS(K){return document.createElementNS("http://www.w3.org/1999/xhtml",K)}function createCanvasElement(){const K=createElementNS("canvas");return K.style.display="block",K}const _cache={};function warnOnce(K){K in _cache||(_cache[K]=!0,console.warn(K))}function probeAsync(K,_,Z){return new Promise(function(te,ne){function ie(){switch(K.clientWaitSync(_,K.SYNC_FLUSH_COMMANDS_BIT,0)){case K.WAIT_FAILED:ne();break;case K.TIMEOUT_EXPIRED:setTimeout(ie,Z);break;default:te()}}setTimeout(ie,Z)})}function toNormalizedProjectionMatrix(K){const _=K.elements;_[2]=.5*_[2]+.5*_[3],_[6]=.5*_[6]+.5*_[7],_[10]=.5*_[10]+.5*_[11],_[14]=.5*_[14]+.5*_[15]}function toReversedProjectionMatrix(K){const _=K.elements;_[11]===-1?(_[10]=-_[10]-1,_[14]=-_[14]):(_[10]=-_[10],_[14]=-_[14]+1)}const LINEAR_REC709_TO_XYZ=new Matrix3().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),XYZ_TO_LINEAR_REC709=new Matrix3().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function createColorManagement(){const K={enabled:!0,workingColorSpace:LinearSRGBColorSpace$2,spaces:{},convert:function(ne,ie,oe){return this.enabled===!1||ie===oe||!ie||!oe||(this.spaces[ie].transfer===SRGBTransfer&&(ne.r=SRGBToLinear(ne.r),ne.g=SRGBToLinear(ne.g),ne.b=SRGBToLinear(ne.b)),this.spaces[ie].primaries!==this.spaces[oe].primaries&&(ne.applyMatrix3(this.spaces[ie].toXYZ),ne.applyMatrix3(this.spaces[oe].fromXYZ)),this.spaces[oe].transfer===SRGBTransfer&&(ne.r=LinearToSRGB(ne.r),ne.g=LinearToSRGB(ne.g),ne.b=LinearToSRGB(ne.b))),ne},fromWorkingColorSpace:function(ne,ie){return this.convert(ne,this.workingColorSpace,ie)},toWorkingColorSpace:function(ne,ie){return this.convert(ne,ie,this.workingColorSpace)},getPrimaries:function(ne){return this.spaces[ne].primaries},getTransfer:function(ne){return ne===NoColorSpace$1?LinearTransfer:this.spaces[ne].transfer},getLuminanceCoefficients:function(ne,ie=this.workingColorSpace){return ne.fromArray(this.spaces[ie].luminanceCoefficients)},define:function(ne){Object.assign(this.spaces,ne)},_getMatrix:function(ne,ie,oe){return ne.copy(this.spaces[ie].toXYZ).multiply(this.spaces[oe].fromXYZ)},_getDrawingBufferColorSpace:function(ne){return this.spaces[ne].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(ne=this.workingColorSpace){return this.spaces[ne].workingColorSpaceConfig.unpackColorSpace}},_=[.64,.33,.3,.6,.15,.06],Z=[.2126,.7152,.0722],te=[.3127,.329];return K.define({[LinearSRGBColorSpace$2]:{primaries:_,whitePoint:te,transfer:LinearTransfer,toXYZ:LINEAR_REC709_TO_XYZ,fromXYZ:XYZ_TO_LINEAR_REC709,luminanceCoefficients:Z,workingColorSpaceConfig:{unpackColorSpace:SRGBColorSpace$2},outputColorSpaceConfig:{drawingBufferColorSpace:SRGBColorSpace$2}},[SRGBColorSpace$2]:{primaries:_,whitePoint:te,transfer:SRGBTransfer,toXYZ:LINEAR_REC709_TO_XYZ,fromXYZ:XYZ_TO_LINEAR_REC709,luminanceCoefficients:Z,outputColorSpaceConfig:{drawingBufferColorSpace:SRGBColorSpace$2}}}),K}const ColorManagement=createColorManagement();function SRGBToLinear(K){return K<.04045?K*.0773993808:Math.pow(K*.9478672986+.0521327014,2.4)}function LinearToSRGB(K){return K<.0031308?K*12.92:1.055*Math.pow(K,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(_,Z="image/png"){if(/^data:/i.test(_.src)||typeof HTMLCanvasElement>"u")return _.src;let te;if(_ instanceof HTMLCanvasElement)te=_;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_.width,_canvas.height=_.height;const ne=_canvas.getContext("2d");_ instanceof ImageData?ne.putImageData(_,0,0):ne.drawImage(_,0,0,_.width,_.height),te=_canvas}return te.toDataURL(Z)}static sRGBToLinear(_){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap){const Z=createElementNS("canvas");Z.width=_.width,Z.height=_.height;const te=Z.getContext("2d");te.drawImage(_,0,0,_.width,_.height);const ne=te.getImageData(0,0,_.width,_.height),ie=ne.data;for(let oe=0;oe<ie.length;oe++)ie[oe]=SRGBToLinear(ie[oe]/255)*255;return te.putImageData(ne,0,0),Z}else if(_.data){const Z=_.data.slice(0);for(let te=0;te<Z.length;te++)Z instanceof Uint8Array||Z instanceof Uint8ClampedArray?Z[te]=Math.floor(SRGBToLinear(Z[te]/255)*255):Z[te]=SRGBToLinear(Z[te]);return{data:Z,width:_.width,height:_.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_}}let _sourceId=0;class Source{constructor(_=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID$1(),this.data=_,this.dataReady=!0,this.version=0}set needsUpdate(_){_===!0&&this.version++}toJSON(_){const Z=_===void 0||typeof _=="string";if(!Z&&_.images[this.uuid]!==void 0)return _.images[this.uuid];const te={uuid:this.uuid,url:""},ne=this.data;if(ne!==null){let ie;if(Array.isArray(ne)){ie=[];for(let oe=0,se=ne.length;oe<se;oe++)ne[oe].isDataTexture?ie.push(serializeImage(ne[oe].image)):ie.push(serializeImage(ne[oe]))}else ie=serializeImage(ne);te.url=ie}return Z||(_.images[this.uuid]=te),te}}function serializeImage(K){return typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&K instanceof ImageBitmap?ImageUtils.getDataURL(K):K.data?{data:Array.from(K.data),width:K.width,height:K.height,type:K.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0,Texture$1=class As extends EventDispatcher$1{constructor(_=As.DEFAULT_IMAGE,Z=As.DEFAULT_MAPPING,te=ClampToEdgeWrapping,ne=ClampToEdgeWrapping,ie=LinearFilter,oe=LinearMipmapLinearFilter,se=RGBAFormat,ae=UnsignedByteType,le=As.DEFAULT_ANISOTROPY,ce=NoColorSpace$1){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID$1(),this.name="",this.source=new Source(_),this.mipmaps=[],this.mapping=Z,this.channel=0,this.wrapS=te,this.wrapT=ne,this.magFilter=ie,this.minFilter=oe,this.anisotropy=le,this.format=se,this.internalFormat=null,this.type=ae,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=ce,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(_=null){this.source.data=_}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_){return this.name=_.name,this.source=_.source,this.mipmaps=_.mipmaps.slice(0),this.mapping=_.mapping,this.channel=_.channel,this.wrapS=_.wrapS,this.wrapT=_.wrapT,this.magFilter=_.magFilter,this.minFilter=_.minFilter,this.anisotropy=_.anisotropy,this.format=_.format,this.internalFormat=_.internalFormat,this.type=_.type,this.offset.copy(_.offset),this.repeat.copy(_.repeat),this.center.copy(_.center),this.rotation=_.rotation,this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrix.copy(_.matrix),this.generateMipmaps=_.generateMipmaps,this.premultiplyAlpha=_.premultiplyAlpha,this.flipY=_.flipY,this.unpackAlignment=_.unpackAlignment,this.colorSpace=_.colorSpace,this.renderTarget=_.renderTarget,this.isRenderTargetTexture=_.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(_.userData)),this.needsUpdate=!0,this}toJSON(_){const Z=_===void 0||typeof _=="string";if(!Z&&_.textures[this.uuid]!==void 0)return _.textures[this.uuid];const te={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(te.userData=this.userData),Z||(_.textures[this.uuid]=te),te}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_){if(this.mapping!==UVMapping)return _;if(_.applyMatrix3(this.matrix),_.x<0||_.x>1)switch(this.wrapS){case RepeatWrapping:_.x=_.x-Math.floor(_.x);break;case ClampToEdgeWrapping:_.x=_.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.x)%2)===1?_.x=Math.ceil(_.x)-_.x:_.x=_.x-Math.floor(_.x);break}if(_.y<0||_.y>1)switch(this.wrapT){case RepeatWrapping:_.y=_.y-Math.floor(_.y);break;case ClampToEdgeWrapping:_.y=_.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.y)%2)===1?_.y=Math.ceil(_.y)-_.y:_.y=_.y-Math.floor(_.y);break}return this.flipY&&(_.y=1-_.y),_}set needsUpdate(_){_===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(_){_===!0&&this.pmremVersion++}};Texture$1.DEFAULT_IMAGE=null;Texture$1.DEFAULT_MAPPING=UVMapping;Texture$1.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_=0,Z=0,te=0,ne=1){Vector4.prototype.isVector4=!0,this.x=_,this.y=Z,this.z=te,this.w=ne}get width(){return this.z}set width(_){this.z=_}get height(){return this.w}set height(_){this.w=_}set(_,Z,te,ne){return this.x=_,this.y=Z,this.z=te,this.w=ne,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this.w=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setW(_){return this.w=_,this}setComponent(_,Z){switch(_){case 0:this.x=Z;break;case 1:this.y=Z;break;case 2:this.z=Z;break;case 3:this.w=Z;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w!==void 0?_.w:1,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this}addVectors(_,Z){return this.x=_.x+Z.x,this.y=_.y+Z.y,this.z=_.z+Z.z,this.w=_.w+Z.w,this}addScaledVector(_,Z){return this.x+=_.x*Z,this.y+=_.y*Z,this.z+=_.z*Z,this.w+=_.w*Z,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this}subVectors(_,Z){return this.x=_.x-Z.x,this.y=_.y-Z.y,this.z=_.z-Z.z,this.w=_.w-Z.w,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this.w*=_.w,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}applyMatrix4(_){const Z=this.x,te=this.y,ne=this.z,ie=this.w,oe=_.elements;return this.x=oe[0]*Z+oe[4]*te+oe[8]*ne+oe[12]*ie,this.y=oe[1]*Z+oe[5]*te+oe[9]*ne+oe[13]*ie,this.z=oe[2]*Z+oe[6]*te+oe[10]*ne+oe[14]*ie,this.w=oe[3]*Z+oe[7]*te+oe[11]*ne+oe[15]*ie,this}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this.w/=_.w,this}divideScalar(_){return this.multiplyScalar(1/_)}setAxisAngleFromQuaternion(_){this.w=2*Math.acos(_.w);const Z=Math.sqrt(1-_.w*_.w);return Z<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_.x/Z,this.y=_.y/Z,this.z=_.z/Z),this}setAxisAngleFromRotationMatrix(_){let Z,te,ne,ie;const ae=_.elements,le=ae[0],ce=ae[4],fe=ae[8],de=ae[1],pe=ae[5],he=ae[9],ge=ae[2],me=ae[6],Ae=ae[10];if(Math.abs(ce-de)<.01&&Math.abs(fe-ge)<.01&&Math.abs(he-me)<.01){if(Math.abs(ce+de)<.1&&Math.abs(fe+ge)<.1&&Math.abs(he+me)<.1&&Math.abs(le+pe+Ae-3)<.1)return this.set(1,0,0,0),this;Z=Math.PI;const ve=(le+1)/2,_e=(pe+1)/2,Te=(Ae+1)/2,be=(ce+de)/4,Re=(fe+ge)/4,we=(he+me)/4;return ve>_e&&ve>Te?ve<.01?(te=0,ne=.707106781,ie=.707106781):(te=Math.sqrt(ve),ne=be/te,ie=Re/te):_e>Te?_e<.01?(te=.707106781,ne=0,ie=.707106781):(ne=Math.sqrt(_e),te=be/ne,ie=we/ne):Te<.01?(te=.707106781,ne=.707106781,ie=0):(ie=Math.sqrt(Te),te=Re/ie,ne=we/ie),this.set(te,ne,ie,Z),this}let ye=Math.sqrt((me-he)*(me-he)+(fe-ge)*(fe-ge)+(de-ce)*(de-ce));return Math.abs(ye)<.001&&(ye=1),this.x=(me-he)/ye,this.y=(fe-ge)/ye,this.z=(de-ce)/ye,this.w=Math.acos((le+pe+Ae-1)/2),this}setFromMatrixPosition(_){const Z=_.elements;return this.x=Z[12],this.y=Z[13],this.z=Z[14],this.w=Z[15],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this.w=Math.min(this.w,_.w),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this}clamp(_,Z){return this.x=clamp$4(this.x,_.x,Z.x),this.y=clamp$4(this.y,_.y,Z.y),this.z=clamp$4(this.z,_.z,Z.z),this.w=clamp$4(this.w,_.w,Z.w),this}clampScalar(_,Z){return this.x=clamp$4(this.x,_,Z),this.y=clamp$4(this.y,_,Z),this.z=clamp$4(this.z,_,Z),this.w=clamp$4(this.w,_,Z),this}clampLength(_,Z){const te=this.length();return this.divideScalar(te||1).multiplyScalar(clamp$4(te,_,Z))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,Z){return this.x+=(_.x-this.x)*Z,this.y+=(_.y-this.y)*Z,this.z+=(_.z-this.z)*Z,this.w+=(_.w-this.w)*Z,this}lerpVectors(_,Z,te){return this.x=_.x+(Z.x-_.x)*te,this.y=_.y+(Z.y-_.y)*te,this.z=_.z+(Z.z-_.z)*te,this.w=_.w+(Z.w-_.w)*te,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w}fromArray(_,Z=0){return this.x=_[Z],this.y=_[Z+1],this.z=_[Z+2],this.w=_[Z+3],this}toArray(_=[],Z=0){return _[Z]=this.x,_[Z+1]=this.y,_[Z+2]=this.z,_[Z+3]=this.w,_}fromBufferAttribute(_,Z){return this.x=_.getX(Z),this.y=_.getY(Z),this.z=_.getZ(Z),this.w=_.getW(Z),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher$1{constructor(_=1,Z=1,te={}){super(),this.isRenderTarget=!0,this.width=_,this.height=Z,this.depth=1,this.scissor=new Vector4(0,0,_,Z),this.scissorTest=!1,this.viewport=new Vector4(0,0,_,Z);const ne={width:_,height:Z,depth:1};te=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},te);const ie=new Texture$1(ne,te.mapping,te.wrapS,te.wrapT,te.magFilter,te.minFilter,te.format,te.type,te.anisotropy,te.colorSpace);ie.flipY=!1,ie.generateMipmaps=te.generateMipmaps,ie.internalFormat=te.internalFormat,this.textures=[];const oe=te.count;for(let se=0;se<oe;se++)this.textures[se]=ie.clone(),this.textures[se].isRenderTargetTexture=!0,this.textures[se].renderTarget=this;this.depthBuffer=te.depthBuffer,this.stencilBuffer=te.stencilBuffer,this.resolveDepthBuffer=te.resolveDepthBuffer,this.resolveStencilBuffer=te.resolveStencilBuffer,this._depthTexture=te.depthTexture,this.samples=te.samples}get texture(){return this.textures[0]}set texture(_){this.textures[0]=_}set depthTexture(_){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),_!==null&&(_.renderTarget=this),this._depthTexture=_}get depthTexture(){return this._depthTexture}setSize(_,Z,te=1){if(this.width!==_||this.height!==Z||this.depth!==te){this.width=_,this.height=Z,this.depth=te;for(let ne=0,ie=this.textures.length;ne<ie;ne++)this.textures[ne].image.width=_,this.textures[ne].image.height=Z,this.textures[ne].image.depth=te;this.dispose()}this.viewport.set(0,0,_,Z),this.scissor.set(0,0,_,Z)}clone(){return new this.constructor().copy(this)}copy(_){this.width=_.width,this.height=_.height,this.depth=_.depth,this.scissor.copy(_.scissor),this.scissorTest=_.scissorTest,this.viewport.copy(_.viewport),this.textures.length=0;for(let Z=0,te=_.textures.length;Z<te;Z++){this.textures[Z]=_.textures[Z].clone(),this.textures[Z].isRenderTargetTexture=!0,this.textures[Z].renderTarget=this;const ne=Object.assign({},_.textures[Z].image);this.textures[Z].source=new Source(ne)}return this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,this.resolveDepthBuffer=_.resolveDepthBuffer,this.resolveStencilBuffer=_.resolveStencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.samples=_.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(_=1,Z=1,te={}){super(_,Z,te),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture$1{constructor(_=null,Z=1,te=1,ne=1){super(null),this.isDataArrayTexture=!0,this.image={data:_,width:Z,height:te,depth:ne},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(_){this.layerUpdates.add(_)}clearLayerUpdates(){this.layerUpdates.clear()}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(_=1,Z=1,te=1,ne={}){super(_,Z,ne),this.isWebGLArrayRenderTarget=!0,this.depth=te,this.texture=new DataArrayTexture(null,_,Z,te),this.texture.isRenderTargetTexture=!0}}let Data3DTexture$1=class extends Texture$1{constructor(_=null,Z=1,te=1,ne=1){super(null),this.isData3DTexture=!0,this.image={data:_,width:Z,height:te,depth:ne},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(_=1,Z=1,te=1,ne={}){super(_,Z,ne),this.isWebGL3DRenderTarget=!0,this.depth=te,this.texture=new Data3DTexture$1(null,_,Z,te),this.texture.isRenderTargetTexture=!0}}class Quaternion{constructor(_=0,Z=0,te=0,ne=1){this.isQuaternion=!0,this._x=_,this._y=Z,this._z=te,this._w=ne}static slerpFlat(_,Z,te,ne,ie,oe,se){let ae=te[ne+0],le=te[ne+1],ce=te[ne+2],fe=te[ne+3];const de=ie[oe+0],pe=ie[oe+1],he=ie[oe+2],ge=ie[oe+3];if(se===0){_[Z+0]=ae,_[Z+1]=le,_[Z+2]=ce,_[Z+3]=fe;return}if(se===1){_[Z+0]=de,_[Z+1]=pe,_[Z+2]=he,_[Z+3]=ge;return}if(fe!==ge||ae!==de||le!==pe||ce!==he){let me=1-se;const Ae=ae*de+le*pe+ce*he+fe*ge,ye=Ae>=0?1:-1,ve=1-Ae*Ae;if(ve>Number.EPSILON){const Te=Math.sqrt(ve),be=Math.atan2(Te,Ae*ye);me=Math.sin(me*be)/Te,se=Math.sin(se*be)/Te}const _e=se*ye;if(ae=ae*me+de*_e,le=le*me+pe*_e,ce=ce*me+he*_e,fe=fe*me+ge*_e,me===1-se){const Te=1/Math.sqrt(ae*ae+le*le+ce*ce+fe*fe);ae*=Te,le*=Te,ce*=Te,fe*=Te}}_[Z]=ae,_[Z+1]=le,_[Z+2]=ce,_[Z+3]=fe}static multiplyQuaternionsFlat(_,Z,te,ne,ie,oe){const se=te[ne],ae=te[ne+1],le=te[ne+2],ce=te[ne+3],fe=ie[oe],de=ie[oe+1],pe=ie[oe+2],he=ie[oe+3];return _[Z]=se*he+ce*fe+ae*pe-le*de,_[Z+1]=ae*he+ce*de+le*fe-se*pe,_[Z+2]=le*he+ce*pe+se*de-ae*fe,_[Z+3]=ce*he-se*fe-ae*de-le*pe,_}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get w(){return this._w}set w(_){this._w=_,this._onChangeCallback()}set(_,Z,te,ne){return this._x=_,this._y=Z,this._z=te,this._w=ne,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_){return this._x=_.x,this._y=_.y,this._z=_.z,this._w=_.w,this._onChangeCallback(),this}setFromEuler(_,Z=!0){const te=_._x,ne=_._y,ie=_._z,oe=_._order,se=Math.cos,ae=Math.sin,le=se(te/2),ce=se(ne/2),fe=se(ie/2),de=ae(te/2),pe=ae(ne/2),he=ae(ie/2);switch(oe){case"XYZ":this._x=de*ce*fe+le*pe*he,this._y=le*pe*fe-de*ce*he,this._z=le*ce*he+de*pe*fe,this._w=le*ce*fe-de*pe*he;break;case"YXZ":this._x=de*ce*fe+le*pe*he,this._y=le*pe*fe-de*ce*he,this._z=le*ce*he-de*pe*fe,this._w=le*ce*fe+de*pe*he;break;case"ZXY":this._x=de*ce*fe-le*pe*he,this._y=le*pe*fe+de*ce*he,this._z=le*ce*he+de*pe*fe,this._w=le*ce*fe-de*pe*he;break;case"ZYX":this._x=de*ce*fe-le*pe*he,this._y=le*pe*fe+de*ce*he,this._z=le*ce*he-de*pe*fe,this._w=le*ce*fe+de*pe*he;break;case"YZX":this._x=de*ce*fe+le*pe*he,this._y=le*pe*fe+de*ce*he,this._z=le*ce*he-de*pe*fe,this._w=le*ce*fe-de*pe*he;break;case"XZY":this._x=de*ce*fe-le*pe*he,this._y=le*pe*fe-de*ce*he,this._z=le*ce*he+de*pe*fe,this._w=le*ce*fe+de*pe*he;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+oe)}return Z===!0&&this._onChangeCallback(),this}setFromAxisAngle(_,Z){const te=Z/2,ne=Math.sin(te);return this._x=_.x*ne,this._y=_.y*ne,this._z=_.z*ne,this._w=Math.cos(te),this._onChangeCallback(),this}setFromRotationMatrix(_){const Z=_.elements,te=Z[0],ne=Z[4],ie=Z[8],oe=Z[1],se=Z[5],ae=Z[9],le=Z[2],ce=Z[6],fe=Z[10],de=te+se+fe;if(de>0){const pe=.5/Math.sqrt(de+1);this._w=.25/pe,this._x=(ce-ae)*pe,this._y=(ie-le)*pe,this._z=(oe-ne)*pe}else if(te>se&&te>fe){const pe=2*Math.sqrt(1+te-se-fe);this._w=(ce-ae)/pe,this._x=.25*pe,this._y=(ne+oe)/pe,this._z=(ie+le)/pe}else if(se>fe){const pe=2*Math.sqrt(1+se-te-fe);this._w=(ie-le)/pe,this._x=(ne+oe)/pe,this._y=.25*pe,this._z=(ae+ce)/pe}else{const pe=2*Math.sqrt(1+fe-te-se);this._w=(oe-ne)/pe,this._x=(ie+le)/pe,this._y=(ae+ce)/pe,this._z=.25*pe}return this._onChangeCallback(),this}setFromUnitVectors(_,Z){let te=_.dot(Z)+1;return te<Number.EPSILON?(te=0,Math.abs(_.x)>Math.abs(_.z)?(this._x=-_.y,this._y=_.x,this._z=0,this._w=te):(this._x=0,this._y=-_.z,this._z=_.y,this._w=te)):(this._x=_.y*Z.z-_.z*Z.y,this._y=_.z*Z.x-_.x*Z.z,this._z=_.x*Z.y-_.y*Z.x,this._w=te),this.normalize()}angleTo(_){return 2*Math.acos(Math.abs(clamp$4(this.dot(_),-1,1)))}rotateTowards(_,Z){const te=this.angleTo(_);if(te===0)return this;const ne=Math.min(1,Z/te);return this.slerp(_,ne),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_){return this._x*_._x+this._y*_._y+this._z*_._z+this._w*_._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _=this.length();return _===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_=1/_,this._x=this._x*_,this._y=this._y*_,this._z=this._z*_,this._w=this._w*_),this._onChangeCallback(),this}multiply(_){return this.multiplyQuaternions(this,_)}premultiply(_){return this.multiplyQuaternions(_,this)}multiplyQuaternions(_,Z){const te=_._x,ne=_._y,ie=_._z,oe=_._w,se=Z._x,ae=Z._y,le=Z._z,ce=Z._w;return this._x=te*ce+oe*se+ne*le-ie*ae,this._y=ne*ce+oe*ae+ie*se-te*le,this._z=ie*ce+oe*le+te*ae-ne*se,this._w=oe*ce-te*se-ne*ae-ie*le,this._onChangeCallback(),this}slerp(_,Z){if(Z===0)return this;if(Z===1)return this.copy(_);const te=this._x,ne=this._y,ie=this._z,oe=this._w;let se=oe*_._w+te*_._x+ne*_._y+ie*_._z;if(se<0?(this._w=-_._w,this._x=-_._x,this._y=-_._y,this._z=-_._z,se=-se):this.copy(_),se>=1)return this._w=oe,this._x=te,this._y=ne,this._z=ie,this;const ae=1-se*se;if(ae<=Number.EPSILON){const pe=1-Z;return this._w=pe*oe+Z*this._w,this._x=pe*te+Z*this._x,this._y=pe*ne+Z*this._y,this._z=pe*ie+Z*this._z,this.normalize(),this}const le=Math.sqrt(ae),ce=Math.atan2(le,se),fe=Math.sin((1-Z)*ce)/le,de=Math.sin(Z*ce)/le;return this._w=oe*fe+this._w*de,this._x=te*fe+this._x*de,this._y=ne*fe+this._y*de,this._z=ie*fe+this._z*de,this._onChangeCallback(),this}slerpQuaternions(_,Z,te){return this.copy(_).slerp(Z,te)}random(){const _=2*Math.PI*Math.random(),Z=2*Math.PI*Math.random(),te=Math.random(),ne=Math.sqrt(1-te),ie=Math.sqrt(te);return this.set(ne*Math.sin(_),ne*Math.cos(_),ie*Math.sin(Z),ie*Math.cos(Z))}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._w===this._w}fromArray(_,Z=0){return this._x=_[Z],this._y=_[Z+1],this._z=_[Z+2],this._w=_[Z+3],this._onChangeCallback(),this}toArray(_=[],Z=0){return _[Z]=this._x,_[Z+1]=this._y,_[Z+2]=this._z,_[Z+3]=this._w,_}fromBufferAttribute(_,Z){return this._x=_.getX(Z),this._y=_.getY(Z),this._z=_.getZ(Z),this._w=_.getW(Z),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_=0,Z=0,te=0){Vector3.prototype.isVector3=!0,this.x=_,this.y=Z,this.z=te}set(_,Z,te){return te===void 0&&(te=this.z),this.x=_,this.y=Z,this.z=te,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setComponent(_,Z){switch(_){case 0:this.x=Z;break;case 1:this.y=Z;break;case 2:this.z=Z;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this}addVectors(_,Z){return this.x=_.x+Z.x,this.y=_.y+Z.y,this.z=_.z+Z.z,this}addScaledVector(_,Z){return this.x+=_.x*Z,this.y+=_.y*Z,this.z+=_.z*Z,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this}subVectors(_,Z){return this.x=_.x-Z.x,this.y=_.y-Z.y,this.z=_.z-Z.z,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}multiplyVectors(_,Z){return this.x=_.x*Z.x,this.y=_.y*Z.y,this.z=_.z*Z.z,this}applyEuler(_){return this.applyQuaternion(_quaternion$4.setFromEuler(_))}applyAxisAngle(_,Z){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_,Z))}applyMatrix3(_){const Z=this.x,te=this.y,ne=this.z,ie=_.elements;return this.x=ie[0]*Z+ie[3]*te+ie[6]*ne,this.y=ie[1]*Z+ie[4]*te+ie[7]*ne,this.z=ie[2]*Z+ie[5]*te+ie[8]*ne,this}applyNormalMatrix(_){return this.applyMatrix3(_).normalize()}applyMatrix4(_){const Z=this.x,te=this.y,ne=this.z,ie=_.elements,oe=1/(ie[3]*Z+ie[7]*te+ie[11]*ne+ie[15]);return this.x=(ie[0]*Z+ie[4]*te+ie[8]*ne+ie[12])*oe,this.y=(ie[1]*Z+ie[5]*te+ie[9]*ne+ie[13])*oe,this.z=(ie[2]*Z+ie[6]*te+ie[10]*ne+ie[14])*oe,this}applyQuaternion(_){const Z=this.x,te=this.y,ne=this.z,ie=_.x,oe=_.y,se=_.z,ae=_.w,le=2*(oe*ne-se*te),ce=2*(se*Z-ie*ne),fe=2*(ie*te-oe*Z);return this.x=Z+ae*le+oe*fe-se*ce,this.y=te+ae*ce+se*le-ie*fe,this.z=ne+ae*fe+ie*ce-oe*le,this}project(_){return this.applyMatrix4(_.matrixWorldInverse).applyMatrix4(_.projectionMatrix)}unproject(_){return this.applyMatrix4(_.projectionMatrixInverse).applyMatrix4(_.matrixWorld)}transformDirection(_){const Z=this.x,te=this.y,ne=this.z,ie=_.elements;return this.x=ie[0]*Z+ie[4]*te+ie[8]*ne,this.y=ie[1]*Z+ie[5]*te+ie[9]*ne,this.z=ie[2]*Z+ie[6]*te+ie[10]*ne,this.normalize()}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this}divideScalar(_){return this.multiplyScalar(1/_)}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}clamp(_,Z){return this.x=clamp$4(this.x,_.x,Z.x),this.y=clamp$4(this.y,_.y,Z.y),this.z=clamp$4(this.z,_.z,Z.z),this}clampScalar(_,Z){return this.x=clamp$4(this.x,_,Z),this.y=clamp$4(this.y,_,Z),this.z=clamp$4(this.z,_,Z),this}clampLength(_,Z){const te=this.length();return this.divideScalar(te||1).multiplyScalar(clamp$4(te,_,Z))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,Z){return this.x+=(_.x-this.x)*Z,this.y+=(_.y-this.y)*Z,this.z+=(_.z-this.z)*Z,this}lerpVectors(_,Z,te){return this.x=_.x+(Z.x-_.x)*te,this.y=_.y+(Z.y-_.y)*te,this.z=_.z+(Z.z-_.z)*te,this}cross(_){return this.crossVectors(this,_)}crossVectors(_,Z){const te=_.x,ne=_.y,ie=_.z,oe=Z.x,se=Z.y,ae=Z.z;return this.x=ne*ae-ie*se,this.y=ie*oe-te*ae,this.z=te*se-ne*oe,this}projectOnVector(_){const Z=_.lengthSq();if(Z===0)return this.set(0,0,0);const te=_.dot(this)/Z;return this.copy(_).multiplyScalar(te)}projectOnPlane(_){return _vector$c.copy(this).projectOnVector(_),this.sub(_vector$c)}reflect(_){return this.sub(_vector$c.copy(_).multiplyScalar(2*this.dot(_)))}angleTo(_){const Z=Math.sqrt(this.lengthSq()*_.lengthSq());if(Z===0)return Math.PI/2;const te=this.dot(_)/Z;return Math.acos(clamp$4(te,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const Z=this.x-_.x,te=this.y-_.y,ne=this.z-_.z;return Z*Z+te*te+ne*ne}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)+Math.abs(this.z-_.z)}setFromSpherical(_){return this.setFromSphericalCoords(_.radius,_.phi,_.theta)}setFromSphericalCoords(_,Z,te){const ne=Math.sin(Z)*_;return this.x=ne*Math.sin(te),this.y=Math.cos(Z)*_,this.z=ne*Math.cos(te),this}setFromCylindrical(_){return this.setFromCylindricalCoords(_.radius,_.theta,_.y)}setFromCylindricalCoords(_,Z,te){return this.x=_*Math.sin(Z),this.y=te,this.z=_*Math.cos(Z),this}setFromMatrixPosition(_){const Z=_.elements;return this.x=Z[12],this.y=Z[13],this.z=Z[14],this}setFromMatrixScale(_){const Z=this.setFromMatrixColumn(_,0).length(),te=this.setFromMatrixColumn(_,1).length(),ne=this.setFromMatrixColumn(_,2).length();return this.x=Z,this.y=te,this.z=ne,this}setFromMatrixColumn(_,Z){return this.fromArray(_.elements,Z*4)}setFromMatrix3Column(_,Z){return this.fromArray(_.elements,Z*3)}setFromEuler(_){return this.x=_._x,this.y=_._y,this.z=_._z,this}setFromColor(_){return this.x=_.r,this.y=_.g,this.z=_.b,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z}fromArray(_,Z=0){return this.x=_[Z],this.y=_[Z+1],this.z=_[Z+2],this}toArray(_=[],Z=0){return _[Z]=this.x,_[Z+1]=this.y,_[Z+2]=this.z,_}fromBufferAttribute(_,Z){return this.x=_.getX(Z),this.y=_.getY(Z),this.z=_.getZ(Z),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _=Math.random()*Math.PI*2,Z=Math.random()*2-1,te=Math.sqrt(1-Z*Z);return this.x=te*Math.cos(_),this.y=Z,this.z=te*Math.sin(_),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_=new Vector3(1/0,1/0,1/0),Z=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_,this.max=Z}set(_,Z){return this.min.copy(_),this.max.copy(Z),this}setFromArray(_){this.makeEmpty();for(let Z=0,te=_.length;Z<te;Z+=3)this.expandByPoint(_vector$b.fromArray(_,Z));return this}setFromBufferAttribute(_){this.makeEmpty();for(let Z=0,te=_.count;Z<te;Z++)this.expandByPoint(_vector$b.fromBufferAttribute(_,Z));return this}setFromPoints(_){this.makeEmpty();for(let Z=0,te=_.length;Z<te;Z++)this.expandByPoint(_[Z]);return this}setFromCenterAndSize(_,Z){const te=_vector$b.copy(Z).multiplyScalar(.5);return this.min.copy(_).sub(te),this.max.copy(_).add(te),this}setFromObject(_,Z=!1){return this.makeEmpty(),this.expandByObject(_,Z)}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_){return this.isEmpty()?_.set(0,0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}expandByObject(_,Z=!1){_.updateWorldMatrix(!1,!1);const te=_.geometry;if(te!==void 0){const ie=te.getAttribute("position");if(Z===!0&&ie!==void 0&&_.isInstancedMesh!==!0)for(let oe=0,se=ie.count;oe<se;oe++)_.isMesh===!0?_.getVertexPosition(oe,_vector$b):_vector$b.fromBufferAttribute(ie,oe),_vector$b.applyMatrix4(_.matrixWorld),this.expandByPoint(_vector$b);else _.boundingBox!==void 0?(_.boundingBox===null&&_.computeBoundingBox(),_box$4.copy(_.boundingBox)):(te.boundingBox===null&&te.computeBoundingBox(),_box$4.copy(te.boundingBox)),_box$4.applyMatrix4(_.matrixWorld),this.union(_box$4)}const ne=_.children;for(let ie=0,oe=ne.length;ie<oe;ie++)this.expandByObject(ne[ie],Z);return this}containsPoint(_){return _.x>=this.min.x&&_.x<=this.max.x&&_.y>=this.min.y&&_.y<=this.max.y&&_.z>=this.min.z&&_.z<=this.max.z}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z}getParameter(_,Z){return Z.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_){return _.max.x>=this.min.x&&_.min.x<=this.max.x&&_.max.y>=this.min.y&&_.min.y<=this.max.y&&_.max.z>=this.min.z&&_.min.z<=this.max.z}intersectsSphere(_){return this.clampPoint(_.center,_vector$b),_vector$b.distanceToSquared(_.center)<=_.radius*_.radius}intersectsPlane(_){let Z,te;return _.normal.x>0?(Z=_.normal.x*this.min.x,te=_.normal.x*this.max.x):(Z=_.normal.x*this.max.x,te=_.normal.x*this.min.x),_.normal.y>0?(Z+=_.normal.y*this.min.y,te+=_.normal.y*this.max.y):(Z+=_.normal.y*this.max.y,te+=_.normal.y*this.min.y),_.normal.z>0?(Z+=_.normal.z*this.min.z,te+=_.normal.z*this.max.z):(Z+=_.normal.z*this.max.z,te+=_.normal.z*this.min.z),Z<=-_.constant&&te>=-_.constant}intersectsTriangle(_){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_.a,_center),_v1$7.subVectors(_.b,_center),_v2$4.subVectors(_.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let Z=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(Z,_v0$2,_v1$7,_v2$4,_extents)||(Z=[1,0,0,0,1,0,0,0,1],!satForAxes(Z,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),Z=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(Z,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_,Z){return Z.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$b).distanceTo(_)}getBoundingSphere(_){return this.isEmpty()?_.makeEmpty():(this.getCenter(_.center),_.radius=this.getSize(_vector$b).length()*.5),_}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}applyMatrix4(_){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_),this.setFromPoints(_points),this)}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(K,_,Z,te,ne){for(let ie=0,oe=K.length-3;ie<=oe;ie+=3){_testAxis.fromArray(K,ie);const se=ne.x*Math.abs(_testAxis.x)+ne.y*Math.abs(_testAxis.y)+ne.z*Math.abs(_testAxis.z),ae=_.dot(_testAxis),le=Z.dot(_testAxis),ce=te.dot(_testAxis);if(Math.max(-Math.max(ae,le,ce),Math.min(ae,le,ce))>se)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;let Sphere$2=class{constructor(_=new Vector3,Z=-1){this.isSphere=!0,this.center=_,this.radius=Z}set(_,Z){return this.center.copy(_),this.radius=Z,this}setFromPoints(_,Z){const te=this.center;Z!==void 0?te.copy(Z):_box$3.setFromPoints(_).getCenter(te);let ne=0;for(let ie=0,oe=_.length;ie<oe;ie++)ne=Math.max(ne,te.distanceToSquared(_[ie]));return this.radius=Math.sqrt(ne),this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_){return _.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_){return _.distanceTo(this.center)-this.radius}intersectsSphere(_){const Z=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=Z*Z}intersectsBox(_){return _.intersectsSphere(this)}intersectsPlane(_){return Math.abs(_.distanceToPoint(this.center))<=this.radius}clampPoint(_,Z){const te=this.center.distanceToSquared(_);return Z.copy(_),te>this.radius*this.radius&&(Z.sub(this.center).normalize(),Z.multiplyScalar(this.radius).add(this.center)),Z}getBoundingBox(_){return this.isEmpty()?(_.makeEmpty(),_):(_.set(this.center,this.center),_.expandByScalar(this.radius),_)}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}expandByPoint(_){if(this.isEmpty())return this.center.copy(_),this.radius=0,this;_v1$6.subVectors(_,this.center);const Z=_v1$6.lengthSq();if(Z>this.radius*this.radius){const te=Math.sqrt(Z),ne=(te-this.radius)*.5;this.center.addScaledVector(_v1$6,ne/te),this.radius+=ne}return this}union(_){return _.isEmpty()?this:this.isEmpty()?(this.copy(_),this):(this.center.equals(_.center)===!0?this.radius=Math.max(this.radius,_.radius):(_v2$3.subVectors(_.center,this.center).setLength(_.radius),this.expandByPoint(_v1$6.copy(_.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_.center).sub(_v2$3))),this)}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new this.constructor().copy(this)}};const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(_=new Vector3,Z=new Vector3(0,0,-1)){this.origin=_,this.direction=Z}set(_,Z){return this.origin.copy(_),this.direction.copy(Z),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,Z){return Z.copy(this.origin).addScaledVector(this.direction,_)}lookAt(_){return this.direction.copy(_).sub(this.origin).normalize(),this}recast(_){return this.origin.copy(this.at(_,_vector$a)),this}closestPointToPoint(_,Z){Z.subVectors(_,this.origin);const te=Z.dot(this.direction);return te<0?Z.copy(this.origin):Z.copy(this.origin).addScaledVector(this.direction,te)}distanceToPoint(_){return Math.sqrt(this.distanceSqToPoint(_))}distanceSqToPoint(_){const Z=_vector$a.subVectors(_,this.origin).dot(this.direction);return Z<0?this.origin.distanceToSquared(_):(_vector$a.copy(this.origin).addScaledVector(this.direction,Z),_vector$a.distanceToSquared(_))}distanceSqToSegment(_,Z,te,ne){_segCenter.copy(_).add(Z).multiplyScalar(.5),_segDir.copy(Z).sub(_).normalize(),_diff.copy(this.origin).sub(_segCenter);const ie=_.distanceTo(Z)*.5,oe=-this.direction.dot(_segDir),se=_diff.dot(this.direction),ae=-_diff.dot(_segDir),le=_diff.lengthSq(),ce=Math.abs(1-oe*oe);let fe,de,pe,he;if(ce>0)if(fe=oe*ae-se,de=oe*se-ae,he=ie*ce,fe>=0)if(de>=-he)if(de<=he){const ge=1/ce;fe*=ge,de*=ge,pe=fe*(fe+oe*de+2*se)+de*(oe*fe+de+2*ae)+le}else de=ie,fe=Math.max(0,-(oe*de+se)),pe=-fe*fe+de*(de+2*ae)+le;else de=-ie,fe=Math.max(0,-(oe*de+se)),pe=-fe*fe+de*(de+2*ae)+le;else de<=-he?(fe=Math.max(0,-(-oe*ie+se)),de=fe>0?-ie:Math.min(Math.max(-ie,-ae),ie),pe=-fe*fe+de*(de+2*ae)+le):de<=he?(fe=0,de=Math.min(Math.max(-ie,-ae),ie),pe=de*(de+2*ae)+le):(fe=Math.max(0,-(oe*ie+se)),de=fe>0?ie:Math.min(Math.max(-ie,-ae),ie),pe=-fe*fe+de*(de+2*ae)+le);else de=oe>0?-ie:ie,fe=Math.max(0,-(oe*de+se)),pe=-fe*fe+de*(de+2*ae)+le;return te&&te.copy(this.origin).addScaledVector(this.direction,fe),ne&&ne.copy(_segCenter).addScaledVector(_segDir,de),pe}intersectSphere(_,Z){_vector$a.subVectors(_.center,this.origin);const te=_vector$a.dot(this.direction),ne=_vector$a.dot(_vector$a)-te*te,ie=_.radius*_.radius;if(ne>ie)return null;const oe=Math.sqrt(ie-ne),se=te-oe,ae=te+oe;return ae<0?null:se<0?this.at(ae,Z):this.at(se,Z)}intersectsSphere(_){return this.distanceSqToPoint(_.center)<=_.radius*_.radius}distanceToPlane(_){const Z=_.normal.dot(this.direction);if(Z===0)return _.distanceToPoint(this.origin)===0?0:null;const te=-(this.origin.dot(_.normal)+_.constant)/Z;return te>=0?te:null}intersectPlane(_,Z){const te=this.distanceToPlane(_);return te===null?null:this.at(te,Z)}intersectsPlane(_){const Z=_.distanceToPoint(this.origin);return Z===0||_.normal.dot(this.direction)*Z<0}intersectBox(_,Z){let te,ne,ie,oe,se,ae;const le=1/this.direction.x,ce=1/this.direction.y,fe=1/this.direction.z,de=this.origin;return le>=0?(te=(_.min.x-de.x)*le,ne=(_.max.x-de.x)*le):(te=(_.max.x-de.x)*le,ne=(_.min.x-de.x)*le),ce>=0?(ie=(_.min.y-de.y)*ce,oe=(_.max.y-de.y)*ce):(ie=(_.max.y-de.y)*ce,oe=(_.min.y-de.y)*ce),te>oe||ie>ne||((ie>te||isNaN(te))&&(te=ie),(oe<ne||isNaN(ne))&&(ne=oe),fe>=0?(se=(_.min.z-de.z)*fe,ae=(_.max.z-de.z)*fe):(se=(_.max.z-de.z)*fe,ae=(_.min.z-de.z)*fe),te>ae||se>ne)||((se>te||te!==te)&&(te=se),(ae<ne||ne!==ne)&&(ne=ae),ne<0)?null:this.at(te>=0?te:ne,Z)}intersectsBox(_){return this.intersectBox(_,_vector$a)!==null}intersectTriangle(_,Z,te,ne,ie){_edge1.subVectors(Z,_),_edge2.subVectors(te,_),_normal$1.crossVectors(_edge1,_edge2);let oe=this.direction.dot(_normal$1),se;if(oe>0){if(ne)return null;se=1}else if(oe<0)se=-1,oe=-oe;else return null;_diff.subVectors(this.origin,_);const ae=se*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(ae<0)return null;const le=se*this.direction.dot(_edge1.cross(_diff));if(le<0||ae+le>oe)return null;const ce=-se*_diff.dot(_normal$1);return ce<0?null:this.at(ce/oe,ie)}applyMatrix4(_){return this.origin.applyMatrix4(_),this.direction.transformDirection(_),this}equals(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de,pe,he,ge,me){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_!==void 0&&this.set(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de,pe,he,ge,me)}set(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de,pe,he,ge,me){const Ae=this.elements;return Ae[0]=_,Ae[4]=Z,Ae[8]=te,Ae[12]=ne,Ae[1]=ie,Ae[5]=oe,Ae[9]=se,Ae[13]=ae,Ae[2]=le,Ae[6]=ce,Ae[10]=fe,Ae[14]=de,Ae[3]=pe,Ae[7]=he,Ae[11]=ge,Ae[15]=me,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_){const Z=this.elements,te=_.elements;return Z[0]=te[0],Z[1]=te[1],Z[2]=te[2],Z[3]=te[3],Z[4]=te[4],Z[5]=te[5],Z[6]=te[6],Z[7]=te[7],Z[8]=te[8],Z[9]=te[9],Z[10]=te[10],Z[11]=te[11],Z[12]=te[12],Z[13]=te[13],Z[14]=te[14],Z[15]=te[15],this}copyPosition(_){const Z=this.elements,te=_.elements;return Z[12]=te[12],Z[13]=te[13],Z[14]=te[14],this}setFromMatrix3(_){const Z=_.elements;return this.set(Z[0],Z[3],Z[6],0,Z[1],Z[4],Z[7],0,Z[2],Z[5],Z[8],0,0,0,0,1),this}extractBasis(_,Z,te){return _.setFromMatrixColumn(this,0),Z.setFromMatrixColumn(this,1),te.setFromMatrixColumn(this,2),this}makeBasis(_,Z,te){return this.set(_.x,Z.x,te.x,0,_.y,Z.y,te.y,0,_.z,Z.z,te.z,0,0,0,0,1),this}extractRotation(_){const Z=this.elements,te=_.elements,ne=1/_v1$5.setFromMatrixColumn(_,0).length(),ie=1/_v1$5.setFromMatrixColumn(_,1).length(),oe=1/_v1$5.setFromMatrixColumn(_,2).length();return Z[0]=te[0]*ne,Z[1]=te[1]*ne,Z[2]=te[2]*ne,Z[3]=0,Z[4]=te[4]*ie,Z[5]=te[5]*ie,Z[6]=te[6]*ie,Z[7]=0,Z[8]=te[8]*oe,Z[9]=te[9]*oe,Z[10]=te[10]*oe,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,this}makeRotationFromEuler(_){const Z=this.elements,te=_.x,ne=_.y,ie=_.z,oe=Math.cos(te),se=Math.sin(te),ae=Math.cos(ne),le=Math.sin(ne),ce=Math.cos(ie),fe=Math.sin(ie);if(_.order==="XYZ"){const de=oe*ce,pe=oe*fe,he=se*ce,ge=se*fe;Z[0]=ae*ce,Z[4]=-ae*fe,Z[8]=le,Z[1]=pe+he*le,Z[5]=de-ge*le,Z[9]=-se*ae,Z[2]=ge-de*le,Z[6]=he+pe*le,Z[10]=oe*ae}else if(_.order==="YXZ"){const de=ae*ce,pe=ae*fe,he=le*ce,ge=le*fe;Z[0]=de+ge*se,Z[4]=he*se-pe,Z[8]=oe*le,Z[1]=oe*fe,Z[5]=oe*ce,Z[9]=-se,Z[2]=pe*se-he,Z[6]=ge+de*se,Z[10]=oe*ae}else if(_.order==="ZXY"){const de=ae*ce,pe=ae*fe,he=le*ce,ge=le*fe;Z[0]=de-ge*se,Z[4]=-oe*fe,Z[8]=he+pe*se,Z[1]=pe+he*se,Z[5]=oe*ce,Z[9]=ge-de*se,Z[2]=-oe*le,Z[6]=se,Z[10]=oe*ae}else if(_.order==="ZYX"){const de=oe*ce,pe=oe*fe,he=se*ce,ge=se*fe;Z[0]=ae*ce,Z[4]=he*le-pe,Z[8]=de*le+ge,Z[1]=ae*fe,Z[5]=ge*le+de,Z[9]=pe*le-he,Z[2]=-le,Z[6]=se*ae,Z[10]=oe*ae}else if(_.order==="YZX"){const de=oe*ae,pe=oe*le,he=se*ae,ge=se*le;Z[0]=ae*ce,Z[4]=ge-de*fe,Z[8]=he*fe+pe,Z[1]=fe,Z[5]=oe*ce,Z[9]=-se*ce,Z[2]=-le*ce,Z[6]=pe*fe+he,Z[10]=de-ge*fe}else if(_.order==="XZY"){const de=oe*ae,pe=oe*le,he=se*ae,ge=se*le;Z[0]=ae*ce,Z[4]=-fe,Z[8]=le*ce,Z[1]=de*fe+ge,Z[5]=oe*ce,Z[9]=pe*fe-he,Z[2]=he*fe-pe,Z[6]=se*ce,Z[10]=ge*fe+de}return Z[3]=0,Z[7]=0,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,this}makeRotationFromQuaternion(_){return this.compose(_zero,_,_one)}lookAt(_,Z,te){const ne=this.elements;return _z.subVectors(_,Z),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(te,_z),_x.lengthSq()===0&&(Math.abs(te.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(te,_z)),_x.normalize(),_y.crossVectors(_z,_x),ne[0]=_x.x,ne[4]=_y.x,ne[8]=_z.x,ne[1]=_x.y,ne[5]=_y.y,ne[9]=_z.y,ne[2]=_x.z,ne[6]=_y.z,ne[10]=_z.z,this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,Z){const te=_.elements,ne=Z.elements,ie=this.elements,oe=te[0],se=te[4],ae=te[8],le=te[12],ce=te[1],fe=te[5],de=te[9],pe=te[13],he=te[2],ge=te[6],me=te[10],Ae=te[14],ye=te[3],ve=te[7],_e=te[11],Te=te[15],be=ne[0],Re=ne[4],we=ne[8],Pe=ne[12],Ie=ne[1],$e=ne[5],Ue=ne[9],ke=ne[13],Ge=ne[2],He=ne[6],ze=ne[10],Ke=ne[14],tt=ne[3],Je=ne[7],ot=ne[11],Fe=ne[15];return ie[0]=oe*be+se*Ie+ae*Ge+le*tt,ie[4]=oe*Re+se*$e+ae*He+le*Je,ie[8]=oe*we+se*Ue+ae*ze+le*ot,ie[12]=oe*Pe+se*ke+ae*Ke+le*Fe,ie[1]=ce*be+fe*Ie+de*Ge+pe*tt,ie[5]=ce*Re+fe*$e+de*He+pe*Je,ie[9]=ce*we+fe*Ue+de*ze+pe*ot,ie[13]=ce*Pe+fe*ke+de*Ke+pe*Fe,ie[2]=he*be+ge*Ie+me*Ge+Ae*tt,ie[6]=he*Re+ge*$e+me*He+Ae*Je,ie[10]=he*we+ge*Ue+me*ze+Ae*ot,ie[14]=he*Pe+ge*ke+me*Ke+Ae*Fe,ie[3]=ye*be+ve*Ie+_e*Ge+Te*tt,ie[7]=ye*Re+ve*$e+_e*He+Te*Je,ie[11]=ye*we+ve*Ue+_e*ze+Te*ot,ie[15]=ye*Pe+ve*ke+_e*Ke+Te*Fe,this}multiplyScalar(_){const Z=this.elements;return Z[0]*=_,Z[4]*=_,Z[8]*=_,Z[12]*=_,Z[1]*=_,Z[5]*=_,Z[9]*=_,Z[13]*=_,Z[2]*=_,Z[6]*=_,Z[10]*=_,Z[14]*=_,Z[3]*=_,Z[7]*=_,Z[11]*=_,Z[15]*=_,this}determinant(){const _=this.elements,Z=_[0],te=_[4],ne=_[8],ie=_[12],oe=_[1],se=_[5],ae=_[9],le=_[13],ce=_[2],fe=_[6],de=_[10],pe=_[14],he=_[3],ge=_[7],me=_[11],Ae=_[15];return he*(+ie*ae*fe-ne*le*fe-ie*se*de+te*le*de+ne*se*pe-te*ae*pe)+ge*(+Z*ae*pe-Z*le*de+ie*oe*de-ne*oe*pe+ne*le*ce-ie*ae*ce)+me*(+Z*le*fe-Z*se*pe-ie*oe*fe+te*oe*pe+ie*se*ce-te*le*ce)+Ae*(-ne*se*ce-Z*ae*fe+Z*se*de+ne*oe*fe-te*oe*de+te*ae*ce)}transpose(){const _=this.elements;let Z;return Z=_[1],_[1]=_[4],_[4]=Z,Z=_[2],_[2]=_[8],_[8]=Z,Z=_[6],_[6]=_[9],_[9]=Z,Z=_[3],_[3]=_[12],_[12]=Z,Z=_[7],_[7]=_[13],_[13]=Z,Z=_[11],_[11]=_[14],_[14]=Z,this}setPosition(_,Z,te){const ne=this.elements;return _.isVector3?(ne[12]=_.x,ne[13]=_.y,ne[14]=_.z):(ne[12]=_,ne[13]=Z,ne[14]=te),this}invert(){const _=this.elements,Z=_[0],te=_[1],ne=_[2],ie=_[3],oe=_[4],se=_[5],ae=_[6],le=_[7],ce=_[8],fe=_[9],de=_[10],pe=_[11],he=_[12],ge=_[13],me=_[14],Ae=_[15],ye=fe*me*le-ge*de*le+ge*ae*pe-se*me*pe-fe*ae*Ae+se*de*Ae,ve=he*de*le-ce*me*le-he*ae*pe+oe*me*pe+ce*ae*Ae-oe*de*Ae,_e=ce*ge*le-he*fe*le+he*se*pe-oe*ge*pe-ce*se*Ae+oe*fe*Ae,Te=he*fe*ae-ce*ge*ae-he*se*de+oe*ge*de+ce*se*me-oe*fe*me,be=Z*ye+te*ve+ne*_e+ie*Te;if(be===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Re=1/be;return _[0]=ye*Re,_[1]=(ge*de*ie-fe*me*ie-ge*ne*pe+te*me*pe+fe*ne*Ae-te*de*Ae)*Re,_[2]=(se*me*ie-ge*ae*ie+ge*ne*le-te*me*le-se*ne*Ae+te*ae*Ae)*Re,_[3]=(fe*ae*ie-se*de*ie-fe*ne*le+te*de*le+se*ne*pe-te*ae*pe)*Re,_[4]=ve*Re,_[5]=(ce*me*ie-he*de*ie+he*ne*pe-Z*me*pe-ce*ne*Ae+Z*de*Ae)*Re,_[6]=(he*ae*ie-oe*me*ie-he*ne*le+Z*me*le+oe*ne*Ae-Z*ae*Ae)*Re,_[7]=(oe*de*ie-ce*ae*ie+ce*ne*le-Z*de*le-oe*ne*pe+Z*ae*pe)*Re,_[8]=_e*Re,_[9]=(he*fe*ie-ce*ge*ie-he*te*pe+Z*ge*pe+ce*te*Ae-Z*fe*Ae)*Re,_[10]=(oe*ge*ie-he*se*ie+he*te*le-Z*ge*le-oe*te*Ae+Z*se*Ae)*Re,_[11]=(ce*se*ie-oe*fe*ie-ce*te*le+Z*fe*le+oe*te*pe-Z*se*pe)*Re,_[12]=Te*Re,_[13]=(ce*ge*ne-he*fe*ne+he*te*de-Z*ge*de-ce*te*me+Z*fe*me)*Re,_[14]=(he*se*ne-oe*ge*ne-he*te*ae+Z*ge*ae+oe*te*me-Z*se*me)*Re,_[15]=(oe*fe*ne-ce*se*ne+ce*te*ae-Z*fe*ae-oe*te*de+Z*se*de)*Re,this}scale(_){const Z=this.elements,te=_.x,ne=_.y,ie=_.z;return Z[0]*=te,Z[4]*=ne,Z[8]*=ie,Z[1]*=te,Z[5]*=ne,Z[9]*=ie,Z[2]*=te,Z[6]*=ne,Z[10]*=ie,Z[3]*=te,Z[7]*=ne,Z[11]*=ie,this}getMaxScaleOnAxis(){const _=this.elements,Z=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],te=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],ne=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(Z,te,ne))}makeTranslation(_,Z,te){return _.isVector3?this.set(1,0,0,_.x,0,1,0,_.y,0,0,1,_.z,0,0,0,1):this.set(1,0,0,_,0,1,0,Z,0,0,1,te,0,0,0,1),this}makeRotationX(_){const Z=Math.cos(_),te=Math.sin(_);return this.set(1,0,0,0,0,Z,-te,0,0,te,Z,0,0,0,0,1),this}makeRotationY(_){const Z=Math.cos(_),te=Math.sin(_);return this.set(Z,0,te,0,0,1,0,0,-te,0,Z,0,0,0,0,1),this}makeRotationZ(_){const Z=Math.cos(_),te=Math.sin(_);return this.set(Z,-te,0,0,te,Z,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_,Z){const te=Math.cos(Z),ne=Math.sin(Z),ie=1-te,oe=_.x,se=_.y,ae=_.z,le=ie*oe,ce=ie*se;return this.set(le*oe+te,le*se-ne*ae,le*ae+ne*se,0,le*se+ne*ae,ce*se+te,ce*ae-ne*oe,0,le*ae-ne*se,ce*ae+ne*oe,ie*ae*ae+te,0,0,0,0,1),this}makeScale(_,Z,te){return this.set(_,0,0,0,0,Z,0,0,0,0,te,0,0,0,0,1),this}makeShear(_,Z,te,ne,ie,oe){return this.set(1,te,ie,0,_,1,oe,0,Z,ne,1,0,0,0,0,1),this}compose(_,Z,te){const ne=this.elements,ie=Z._x,oe=Z._y,se=Z._z,ae=Z._w,le=ie+ie,ce=oe+oe,fe=se+se,de=ie*le,pe=ie*ce,he=ie*fe,ge=oe*ce,me=oe*fe,Ae=se*fe,ye=ae*le,ve=ae*ce,_e=ae*fe,Te=te.x,be=te.y,Re=te.z;return ne[0]=(1-(ge+Ae))*Te,ne[1]=(pe+_e)*Te,ne[2]=(he-ve)*Te,ne[3]=0,ne[4]=(pe-_e)*be,ne[5]=(1-(de+Ae))*be,ne[6]=(me+ye)*be,ne[7]=0,ne[8]=(he+ve)*Re,ne[9]=(me-ye)*Re,ne[10]=(1-(de+ge))*Re,ne[11]=0,ne[12]=_.x,ne[13]=_.y,ne[14]=_.z,ne[15]=1,this}decompose(_,Z,te){const ne=this.elements;let ie=_v1$5.set(ne[0],ne[1],ne[2]).length();const oe=_v1$5.set(ne[4],ne[5],ne[6]).length(),se=_v1$5.set(ne[8],ne[9],ne[10]).length();this.determinant()<0&&(ie=-ie),_.x=ne[12],_.y=ne[13],_.z=ne[14],_m1$2.copy(this);const le=1/ie,ce=1/oe,fe=1/se;return _m1$2.elements[0]*=le,_m1$2.elements[1]*=le,_m1$2.elements[2]*=le,_m1$2.elements[4]*=ce,_m1$2.elements[5]*=ce,_m1$2.elements[6]*=ce,_m1$2.elements[8]*=fe,_m1$2.elements[9]*=fe,_m1$2.elements[10]*=fe,Z.setFromRotationMatrix(_m1$2),te.x=ie,te.y=oe,te.z=se,this}makePerspective(_,Z,te,ne,ie,oe,se=WebGLCoordinateSystem){const ae=this.elements,le=2*ie/(Z-_),ce=2*ie/(te-ne),fe=(Z+_)/(Z-_),de=(te+ne)/(te-ne);let pe,he;if(se===WebGLCoordinateSystem)pe=-(oe+ie)/(oe-ie),he=-2*oe*ie/(oe-ie);else if(se===WebGPUCoordinateSystem)pe=-oe/(oe-ie),he=-oe*ie/(oe-ie);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+se);return ae[0]=le,ae[4]=0,ae[8]=fe,ae[12]=0,ae[1]=0,ae[5]=ce,ae[9]=de,ae[13]=0,ae[2]=0,ae[6]=0,ae[10]=pe,ae[14]=he,ae[3]=0,ae[7]=0,ae[11]=-1,ae[15]=0,this}makeOrthographic(_,Z,te,ne,ie,oe,se=WebGLCoordinateSystem){const ae=this.elements,le=1/(Z-_),ce=1/(te-ne),fe=1/(oe-ie),de=(Z+_)*le,pe=(te+ne)*ce;let he,ge;if(se===WebGLCoordinateSystem)he=(oe+ie)*fe,ge=-2*fe;else if(se===WebGPUCoordinateSystem)he=ie*fe,ge=-1*fe;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+se);return ae[0]=2*le,ae[4]=0,ae[8]=0,ae[12]=-de,ae[1]=0,ae[5]=2*ce,ae[9]=0,ae[13]=-pe,ae[2]=0,ae[6]=0,ae[10]=ge,ae[14]=-he,ae[3]=0,ae[7]=0,ae[11]=0,ae[15]=1,this}equals(_){const Z=this.elements,te=_.elements;for(let ne=0;ne<16;ne++)if(Z[ne]!==te[ne])return!1;return!0}fromArray(_,Z=0){for(let te=0;te<16;te++)this.elements[te]=_[te+Z];return this}toArray(_=[],Z=0){const te=this.elements;return _[Z]=te[0],_[Z+1]=te[1],_[Z+2]=te[2],_[Z+3]=te[3],_[Z+4]=te[4],_[Z+5]=te[5],_[Z+6]=te[6],_[Z+7]=te[7],_[Z+8]=te[8],_[Z+9]=te[9],_[Z+10]=te[10],_[Z+11]=te[11],_[Z+12]=te[12],_[Z+13]=te[13],_[Z+14]=te[14],_[Z+15]=te[15],_}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$2=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_=0,Z=0,te=0,ne=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_,this._y=Z,this._z=te,this._order=ne}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get order(){return this._order}set order(_){this._order=_,this._onChangeCallback()}set(_,Z,te,ne=this._order){return this._x=_,this._y=Z,this._z=te,this._order=ne,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this._onChangeCallback(),this}setFromRotationMatrix(_,Z=this._order,te=!0){const ne=_.elements,ie=ne[0],oe=ne[4],se=ne[8],ae=ne[1],le=ne[5],ce=ne[9],fe=ne[2],de=ne[6],pe=ne[10];switch(Z){case"XYZ":this._y=Math.asin(clamp$4(se,-1,1)),Math.abs(se)<.9999999?(this._x=Math.atan2(-ce,pe),this._z=Math.atan2(-oe,ie)):(this._x=Math.atan2(de,le),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$4(ce,-1,1)),Math.abs(ce)<.9999999?(this._y=Math.atan2(se,pe),this._z=Math.atan2(ae,le)):(this._y=Math.atan2(-fe,ie),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$4(de,-1,1)),Math.abs(de)<.9999999?(this._y=Math.atan2(-fe,pe),this._z=Math.atan2(-oe,le)):(this._y=0,this._z=Math.atan2(ae,ie));break;case"ZYX":this._y=Math.asin(-clamp$4(fe,-1,1)),Math.abs(fe)<.9999999?(this._x=Math.atan2(de,pe),this._z=Math.atan2(ae,ie)):(this._x=0,this._z=Math.atan2(-oe,le));break;case"YZX":this._z=Math.asin(clamp$4(ae,-1,1)),Math.abs(ae)<.9999999?(this._x=Math.atan2(-ce,le),this._y=Math.atan2(-fe,ie)):(this._x=0,this._y=Math.atan2(se,pe));break;case"XZY":this._z=Math.asin(-clamp$4(oe,-1,1)),Math.abs(oe)<.9999999?(this._x=Math.atan2(de,le),this._y=Math.atan2(se,ie)):(this._x=Math.atan2(-ce,pe),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+Z)}return this._order=Z,te===!0&&this._onChangeCallback(),this}setFromQuaternion(_,Z,te){return _matrix$2.makeRotationFromQuaternion(_),this.setFromRotationMatrix(_matrix$2,Z,te)}setFromVector3(_,Z=this._order){return this.set(_.x,_.y,_.z,Z)}reorder(_){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_)}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._order===this._order}fromArray(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==void 0&&(this._order=_[3]),this._onChangeCallback(),this}toArray(_=[],Z=0){return _[Z]=this._x,_[Z+1]=this._y,_[Z+2]=this._z,_[Z+3]=this._order,_}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_){this.mask=(1<<_|0)>>>0}enable(_){this.mask|=1<<_|0}enableAll(){this.mask=-1}toggle(_){this.mask^=1<<_|0}disable(_){this.mask&=~(1<<_|0)}disableAll(){this.mask=0}test(_){return(this.mask&_.mask)!==0}isEnabled(_){return(this.mask&(1<<_|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"},_childaddedEvent={type:"childadded",child:null},_childremovedEvent={type:"childremoved",child:null};class Object3D extends EventDispatcher$1{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID$1(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _=new Vector3,Z=new Euler,te=new Quaternion,ne=new Vector3(1,1,1);function ie(){te.setFromEuler(Z,!1)}function oe(){Z.setFromQuaternion(te,void 0,!1)}Z._onChange(ie),te._onChange(oe),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_},rotation:{configurable:!0,enumerable:!0,value:Z},quaternion:{configurable:!0,enumerable:!0,value:te},scale:{configurable:!0,enumerable:!0,value:ne},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_){return this.quaternion.premultiply(_),this}setRotationFromAxisAngle(_,Z){this.quaternion.setFromAxisAngle(_,Z)}setRotationFromEuler(_){this.quaternion.setFromEuler(_,!0)}setRotationFromMatrix(_){this.quaternion.setFromRotationMatrix(_)}setRotationFromQuaternion(_){this.quaternion.copy(_)}rotateOnAxis(_,Z){return _q1.setFromAxisAngle(_,Z),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_,Z){return _q1.setFromAxisAngle(_,Z),this.quaternion.premultiply(_q1),this}rotateX(_){return this.rotateOnAxis(_xAxis,_)}rotateY(_){return this.rotateOnAxis(_yAxis,_)}rotateZ(_){return this.rotateOnAxis(_zAxis,_)}translateOnAxis(_,Z){return _v1$4.copy(_).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(Z)),this}translateX(_){return this.translateOnAxis(_xAxis,_)}translateY(_){return this.translateOnAxis(_yAxis,_)}translateZ(_){return this.translateOnAxis(_zAxis,_)}localToWorld(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(this.matrixWorld)}worldToLocal(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(_m1$1$1.copy(this.matrixWorld).invert())}lookAt(_,Z,te){_.isVector3?_target.copy(_):_target.set(_,Z,te);const ne=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1$1.lookAt(_position$3,_target,this.up):_m1$1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1$1),ne&&(_m1$1$1.extractRotation(ne.matrixWorld),_q1.setFromRotationMatrix(_m1$1$1),this.quaternion.premultiply(_q1.invert()))}add(_){if(arguments.length>1){for(let Z=0;Z<arguments.length;Z++)this.add(arguments[Z]);return this}return _===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_),this):(_&&_.isObject3D?(_.removeFromParent(),_.parent=this,this.children.push(_),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_),this)}remove(_){if(arguments.length>1){for(let te=0;te<arguments.length;te++)this.remove(arguments[te]);return this}const Z=this.children.indexOf(_);return Z!==-1&&(_.parent=null,this.children.splice(Z,1),_.dispatchEvent(_removedEvent),_childremovedEvent.child=_,this.dispatchEvent(_childremovedEvent),_childremovedEvent.child=null),this}removeFromParent(){const _=this.parent;return _!==null&&_.remove(this),this}clear(){return this.remove(...this.children)}attach(_){return this.updateWorldMatrix(!0,!1),_m1$1$1.copy(this.matrixWorld).invert(),_.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),_m1$1$1.multiply(_.parent.matrixWorld)),_.applyMatrix4(_m1$1$1),_.removeFromParent(),_.parent=this,this.children.push(_),_.updateWorldMatrix(!1,!0),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null,this}getObjectById(_){return this.getObjectByProperty("id",_)}getObjectByName(_){return this.getObjectByProperty("name",_)}getObjectByProperty(_,Z){if(this[_]===Z)return this;for(let te=0,ne=this.children.length;te<ne;te++){const oe=this.children[te].getObjectByProperty(_,Z);if(oe!==void 0)return oe}}getObjectsByProperty(_,Z,te=[]){this[_]===Z&&te.push(this);const ne=this.children;for(let ie=0,oe=ne.length;ie<oe;ie++)ne[ie].getObjectsByProperty(_,Z,te);return te}getWorldPosition(_){return this.updateWorldMatrix(!0,!1),_.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_,_scale$2),_}getWorldScale(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_),_}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const Z=this.matrixWorld.elements;return _.set(Z[8],Z[9],Z[10]).normalize()}raycast(){}traverse(_){_(this);const Z=this.children;for(let te=0,ne=Z.length;te<ne;te++)Z[te].traverse(_)}traverseVisible(_){if(this.visible===!1)return;_(this);const Z=this.children;for(let te=0,ne=Z.length;te<ne;te++)Z[te].traverseVisible(_)}traverseAncestors(_){const Z=this.parent;Z!==null&&(_(Z),Z.traverseAncestors(_))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,_=!0);const Z=this.children;for(let te=0,ne=Z.length;te<ne;te++)Z[te].updateMatrixWorld(_)}updateWorldMatrix(_,Z){const te=this.parent;if(_===!0&&te!==null&&te.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),Z===!0){const ne=this.children;for(let ie=0,oe=ne.length;ie<oe;ie++)ne[ie].updateWorldMatrix(!1,!0)}}toJSON(_){const Z=_===void 0||typeof _=="string",te={};Z&&(_={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},te.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const ne={};ne.uuid=this.uuid,ne.type=this.type,this.name!==""&&(ne.name=this.name),this.castShadow===!0&&(ne.castShadow=!0),this.receiveShadow===!0&&(ne.receiveShadow=!0),this.visible===!1&&(ne.visible=!1),this.frustumCulled===!1&&(ne.frustumCulled=!1),this.renderOrder!==0&&(ne.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(ne.userData=this.userData),ne.layers=this.layers.mask,ne.matrix=this.matrix.toArray(),ne.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(ne.matrixAutoUpdate=!1),this.isInstancedMesh&&(ne.type="InstancedMesh",ne.count=this.count,ne.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(ne.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(ne.type="BatchedMesh",ne.perObjectFrustumCulled=this.perObjectFrustumCulled,ne.sortObjects=this.sortObjects,ne.drawRanges=this._drawRanges,ne.reservedRanges=this._reservedRanges,ne.visibility=this._visibility,ne.active=this._active,ne.bounds=this._bounds.map(se=>({boxInitialized:se.boxInitialized,boxMin:se.box.min.toArray(),boxMax:se.box.max.toArray(),sphereInitialized:se.sphereInitialized,sphereRadius:se.sphere.radius,sphereCenter:se.sphere.center.toArray()})),ne.maxInstanceCount=this._maxInstanceCount,ne.maxVertexCount=this._maxVertexCount,ne.maxIndexCount=this._maxIndexCount,ne.geometryInitialized=this._geometryInitialized,ne.geometryCount=this._geometryCount,ne.matricesTexture=this._matricesTexture.toJSON(_),this._colorsTexture!==null&&(ne.colorsTexture=this._colorsTexture.toJSON(_)),this.boundingSphere!==null&&(ne.boundingSphere={center:ne.boundingSphere.center.toArray(),radius:ne.boundingSphere.radius}),this.boundingBox!==null&&(ne.boundingBox={min:ne.boundingBox.min.toArray(),max:ne.boundingBox.max.toArray()}));function ie(se,ae){return se[ae.uuid]===void 0&&(se[ae.uuid]=ae.toJSON(_)),ae.uuid}if(this.isScene)this.background&&(this.background.isColor?ne.background=this.background.toJSON():this.background.isTexture&&(ne.background=this.background.toJSON(_).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(ne.environment=this.environment.toJSON(_).uuid);else if(this.isMesh||this.isLine||this.isPoints){ne.geometry=ie(_.geometries,this.geometry);const se=this.geometry.parameters;if(se!==void 0&&se.shapes!==void 0){const ae=se.shapes;if(Array.isArray(ae))for(let le=0,ce=ae.length;le<ce;le++){const fe=ae[le];ie(_.shapes,fe)}else ie(_.shapes,ae)}}if(this.isSkinnedMesh&&(ne.bindMode=this.bindMode,ne.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(ie(_.skeletons,this.skeleton),ne.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const se=[];for(let ae=0,le=this.material.length;ae<le;ae++)se.push(ie(_.materials,this.material[ae]));ne.material=se}else ne.material=ie(_.materials,this.material);if(this.children.length>0){ne.children=[];for(let se=0;se<this.children.length;se++)ne.children.push(this.children[se].toJSON(_).object)}if(this.animations.length>0){ne.animations=[];for(let se=0;se<this.animations.length;se++){const ae=this.animations[se];ne.animations.push(ie(_.animations,ae))}}if(Z){const se=oe(_.geometries),ae=oe(_.materials),le=oe(_.textures),ce=oe(_.images),fe=oe(_.shapes),de=oe(_.skeletons),pe=oe(_.animations),he=oe(_.nodes);se.length>0&&(te.geometries=se),ae.length>0&&(te.materials=ae),le.length>0&&(te.textures=le),ce.length>0&&(te.images=ce),fe.length>0&&(te.shapes=fe),de.length>0&&(te.skeletons=de),pe.length>0&&(te.animations=pe),he.length>0&&(te.nodes=he)}return te.object=ne,te;function oe(se){const ae=[];for(const le in se){const ce=se[le];delete ce.metadata,ae.push(ce)}return ae}}clone(_){return new this.constructor().copy(this,_)}copy(_,Z=!0){if(this.name=_.name,this.up.copy(_.up),this.position.copy(_.position),this.rotation.order=_.rotation.order,this.quaternion.copy(_.quaternion),this.scale.copy(_.scale),this.matrix.copy(_.matrix),this.matrixWorld.copy(_.matrixWorld),this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrixWorldAutoUpdate=_.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_.matrixWorldNeedsUpdate,this.layers.mask=_.layers.mask,this.visible=_.visible,this.castShadow=_.castShadow,this.receiveShadow=_.receiveShadow,this.frustumCulled=_.frustumCulled,this.renderOrder=_.renderOrder,this.animations=_.animations.slice(),this.userData=JSON.parse(JSON.stringify(_.userData)),Z===!0)for(let te=0;te<_.children.length;te++){const ne=_.children[te];this.add(ne.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3,_v40=new Vector4,_v41=new Vector4,_v42=new Vector4;class Triangle{constructor(_=new Vector3,Z=new Vector3,te=new Vector3){this.a=_,this.b=Z,this.c=te}static getNormal(_,Z,te,ne){ne.subVectors(te,Z),_v0$1.subVectors(_,Z),ne.cross(_v0$1);const ie=ne.lengthSq();return ie>0?ne.multiplyScalar(1/Math.sqrt(ie)):ne.set(0,0,0)}static getBarycoord(_,Z,te,ne,ie){_v0$1.subVectors(ne,Z),_v1$3.subVectors(te,Z),_v2$2.subVectors(_,Z);const oe=_v0$1.dot(_v0$1),se=_v0$1.dot(_v1$3),ae=_v0$1.dot(_v2$2),le=_v1$3.dot(_v1$3),ce=_v1$3.dot(_v2$2),fe=oe*le-se*se;if(fe===0)return ie.set(0,0,0),null;const de=1/fe,pe=(le*ae-se*ce)*de,he=(oe*ce-se*ae)*de;return ie.set(1-pe-he,he,pe)}static containsPoint(_,Z,te,ne){return this.getBarycoord(_,Z,te,ne,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(_,Z,te,ne,ie,oe,se,ae){return this.getBarycoord(_,Z,te,ne,_v3$2)===null?(ae.x=0,ae.y=0,"z"in ae&&(ae.z=0),"w"in ae&&(ae.w=0),null):(ae.setScalar(0),ae.addScaledVector(ie,_v3$2.x),ae.addScaledVector(oe,_v3$2.y),ae.addScaledVector(se,_v3$2.z),ae)}static getInterpolatedAttribute(_,Z,te,ne,ie,oe){return _v40.setScalar(0),_v41.setScalar(0),_v42.setScalar(0),_v40.fromBufferAttribute(_,Z),_v41.fromBufferAttribute(_,te),_v42.fromBufferAttribute(_,ne),oe.setScalar(0),oe.addScaledVector(_v40,ie.x),oe.addScaledVector(_v41,ie.y),oe.addScaledVector(_v42,ie.z),oe}static isFrontFacing(_,Z,te,ne){return _v0$1.subVectors(te,Z),_v1$3.subVectors(_,Z),_v0$1.cross(_v1$3).dot(ne)<0}set(_,Z,te){return this.a.copy(_),this.b.copy(Z),this.c.copy(te),this}setFromPointsAndIndices(_,Z,te,ne){return this.a.copy(_[Z]),this.b.copy(_[te]),this.c.copy(_[ne]),this}setFromAttributeAndIndices(_,Z,te,ne){return this.a.fromBufferAttribute(_,Z),this.b.fromBufferAttribute(_,te),this.c.fromBufferAttribute(_,ne),this}clone(){return new this.constructor().copy(this)}copy(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_){return _.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_){return Triangle.getNormal(this.a,this.b,this.c,_)}getPlane(_){return _.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_,Z){return Triangle.getBarycoord(_,this.a,this.b,this.c,Z)}getInterpolation(_,Z,te,ne,ie){return Triangle.getInterpolation(_,this.a,this.b,this.c,Z,te,ne,ie)}containsPoint(_){return Triangle.containsPoint(_,this.a,this.b,this.c)}isFrontFacing(_){return Triangle.isFrontFacing(this.a,this.b,this.c,_)}intersectsBox(_){return _.intersectsTriangle(this)}closestPointToPoint(_,Z){const te=this.a,ne=this.b,ie=this.c;let oe,se;_vab.subVectors(ne,te),_vac.subVectors(ie,te),_vap.subVectors(_,te);const ae=_vab.dot(_vap),le=_vac.dot(_vap);if(ae<=0&&le<=0)return Z.copy(te);_vbp.subVectors(_,ne);const ce=_vab.dot(_vbp),fe=_vac.dot(_vbp);if(ce>=0&&fe<=ce)return Z.copy(ne);const de=ae*fe-ce*le;if(de<=0&&ae>=0&&ce<=0)return oe=ae/(ae-ce),Z.copy(te).addScaledVector(_vab,oe);_vcp.subVectors(_,ie);const pe=_vab.dot(_vcp),he=_vac.dot(_vcp);if(he>=0&&pe<=he)return Z.copy(ie);const ge=pe*le-ae*he;if(ge<=0&&le>=0&&he<=0)return se=le/(le-he),Z.copy(te).addScaledVector(_vac,se);const me=ce*he-pe*fe;if(me<=0&&fe-ce>=0&&pe-he>=0)return _vbc.subVectors(ie,ne),se=(fe-ce)/(fe-ce+(pe-he)),Z.copy(ne).addScaledVector(_vbc,se);const Ae=1/(me+ge+de);return oe=ge*Ae,se=de*Ae,Z.copy(te).addScaledVector(_vab,oe).addScaledVector(_vac,se)}equals(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(K,_,Z){return Z<0&&(Z+=1),Z>1&&(Z-=1),Z<1/6?K+(_-K)*6*Z:Z<1/2?_:Z<2/3?K+(_-K)*6*(2/3-Z):K}let Color$1=class{constructor(_,Z,te){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_,Z,te)}set(_,Z,te){if(Z===void 0&&te===void 0){const ne=_;ne&&ne.isColor?this.copy(ne):typeof ne=="number"?this.setHex(ne):typeof ne=="string"&&this.setStyle(ne)}else this.setRGB(_,Z,te);return this}setScalar(_){return this.r=_,this.g=_,this.b=_,this}setHex(_,Z=SRGBColorSpace$2){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,ColorManagement.toWorkingColorSpace(this,Z),this}setRGB(_,Z,te,ne=ColorManagement.workingColorSpace){return this.r=_,this.g=Z,this.b=te,ColorManagement.toWorkingColorSpace(this,ne),this}setHSL(_,Z,te,ne=ColorManagement.workingColorSpace){if(_=euclideanModulo(_,1),Z=clamp$4(Z,0,1),te=clamp$4(te,0,1),Z===0)this.r=this.g=this.b=te;else{const ie=te<=.5?te*(1+Z):te+Z-te*Z,oe=2*te-ie;this.r=hue2rgb(oe,ie,_+1/3),this.g=hue2rgb(oe,ie,_),this.b=hue2rgb(oe,ie,_-1/3)}return ColorManagement.toWorkingColorSpace(this,ne),this}setStyle(_,Z=SRGBColorSpace$2){function te(ie){ie!==void 0&&parseFloat(ie)<1&&console.warn("THREE.Color: Alpha component of "+_+" will be ignored.")}let ne;if(ne=/^(\w+)\(([^\)]*)\)/.exec(_)){let ie;const oe=ne[1],se=ne[2];switch(oe){case"rgb":case"rgba":if(ie=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(se))return te(ie[4]),this.setRGB(Math.min(255,parseInt(ie[1],10))/255,Math.min(255,parseInt(ie[2],10))/255,Math.min(255,parseInt(ie[3],10))/255,Z);if(ie=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(se))return te(ie[4]),this.setRGB(Math.min(100,parseInt(ie[1],10))/100,Math.min(100,parseInt(ie[2],10))/100,Math.min(100,parseInt(ie[3],10))/100,Z);break;case"hsl":case"hsla":if(ie=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(se))return te(ie[4]),this.setHSL(parseFloat(ie[1])/360,parseFloat(ie[2])/100,parseFloat(ie[3])/100,Z);break;default:console.warn("THREE.Color: Unknown color model "+_)}}else if(ne=/^\#([A-Fa-f\d]+)$/.exec(_)){const ie=ne[1],oe=ie.length;if(oe===3)return this.setRGB(parseInt(ie.charAt(0),16)/15,parseInt(ie.charAt(1),16)/15,parseInt(ie.charAt(2),16)/15,Z);if(oe===6)return this.setHex(parseInt(ie,16),Z);console.warn("THREE.Color: Invalid hex color "+_)}else if(_&&_.length>0)return this.setColorName(_,Z);return this}setColorName(_,Z=SRGBColorSpace$2){const te=_colorKeywords[_.toLowerCase()];return te!==void 0?this.setHex(te,Z):console.warn("THREE.Color: Unknown color "+_),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}copySRGBToLinear(_){return this.r=SRGBToLinear(_.r),this.g=SRGBToLinear(_.g),this.b=SRGBToLinear(_.b),this}copyLinearToSRGB(_){return this.r=LinearToSRGB(_.r),this.g=LinearToSRGB(_.g),this.b=LinearToSRGB(_.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_=SRGBColorSpace$2){return ColorManagement.fromWorkingColorSpace(_color$2.copy(this),_),Math.round(clamp$4(_color$2.r*255,0,255))*65536+Math.round(clamp$4(_color$2.g*255,0,255))*256+Math.round(clamp$4(_color$2.b*255,0,255))}getHexString(_=SRGBColorSpace$2){return("000000"+this.getHex(_).toString(16)).slice(-6)}getHSL(_,Z=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color$2.copy(this),Z);const te=_color$2.r,ne=_color$2.g,ie=_color$2.b,oe=Math.max(te,ne,ie),se=Math.min(te,ne,ie);let ae,le;const ce=(se+oe)/2;if(se===oe)ae=0,le=0;else{const fe=oe-se;switch(le=ce<=.5?fe/(oe+se):fe/(2-oe-se),oe){case te:ae=(ne-ie)/fe+(ne<ie?6:0);break;case ne:ae=(ie-te)/fe+2;break;case ie:ae=(te-ne)/fe+4;break}ae/=6}return _.h=ae,_.s=le,_.l=ce,_}getRGB(_,Z=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color$2.copy(this),Z),_.r=_color$2.r,_.g=_color$2.g,_.b=_color$2.b,_}getStyle(_=SRGBColorSpace$2){ColorManagement.fromWorkingColorSpace(_color$2.copy(this),_);const Z=_color$2.r,te=_color$2.g,ne=_color$2.b;return _!==SRGBColorSpace$2?`color(${_} ${Z.toFixed(3)} ${te.toFixed(3)} ${ne.toFixed(3)})`:`rgb(${Math.round(Z*255)},${Math.round(te*255)},${Math.round(ne*255)})`}offsetHSL(_,Z,te){return this.getHSL(_hslA),this.setHSL(_hslA.h+_,_hslA.s+Z,_hslA.l+te)}add(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this}addColors(_,Z){return this.r=_.r+Z.r,this.g=_.g+Z.g,this.b=_.b+Z.b,this}addScalar(_){return this.r+=_,this.g+=_,this.b+=_,this}sub(_){return this.r=Math.max(0,this.r-_.r),this.g=Math.max(0,this.g-_.g),this.b=Math.max(0,this.b-_.b),this}multiply(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this}multiplyScalar(_){return this.r*=_,this.g*=_,this.b*=_,this}lerp(_,Z){return this.r+=(_.r-this.r)*Z,this.g+=(_.g-this.g)*Z,this.b+=(_.b-this.b)*Z,this}lerpColors(_,Z,te){return this.r=_.r+(Z.r-_.r)*te,this.g=_.g+(Z.g-_.g)*te,this.b=_.b+(Z.b-_.b)*te,this}lerpHSL(_,Z){this.getHSL(_hslA),_.getHSL(_hslB);const te=lerp(_hslA.h,_hslB.h,Z),ne=lerp(_hslA.s,_hslB.s,Z),ie=lerp(_hslA.l,_hslB.l,Z);return this.setHSL(te,ne,ie),this}setFromVector3(_){return this.r=_.x,this.g=_.y,this.b=_.z,this}applyMatrix3(_){const Z=this.r,te=this.g,ne=this.b,ie=_.elements;return this.r=ie[0]*Z+ie[3]*te+ie[6]*ne,this.g=ie[1]*Z+ie[4]*te+ie[7]*ne,this.b=ie[2]*Z+ie[5]*te+ie[8]*ne,this}equals(_){return _.r===this.r&&_.g===this.g&&_.b===this.b}fromArray(_,Z=0){return this.r=_[Z],this.g=_[Z+1],this.b=_[Z+2],this}toArray(_=[],Z=0){return _[Z]=this.r,_[Z+1]=this.g,_[Z+2]=this.b,_}fromBufferAttribute(_,Z){return this.r=_.getX(Z),this.g=_.getY(Z),this.b=_.getZ(Z),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _color$2=new Color$1;Color$1.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher$1{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID$1(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color$1(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_){this._alphaTest>0!=_>0&&this.version++,this._alphaTest=_}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_){if(_!==void 0)for(const Z in _){const te=_[Z];if(te===void 0){console.warn(`THREE.Material: parameter '${Z}' has value of undefined.`);continue}const ne=this[Z];if(ne===void 0){console.warn(`THREE.Material: '${Z}' is not a property of THREE.${this.type}.`);continue}ne&&ne.isColor?ne.set(te):ne&&ne.isVector3&&te&&te.isVector3?ne.copy(te):this[Z]=te}}toJSON(_){const Z=_===void 0||typeof _=="string";Z&&(_={textures:{},images:{}});const te={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};te.uuid=this.uuid,te.type=this.type,this.name!==""&&(te.name=this.name),this.color&&this.color.isColor&&(te.color=this.color.getHex()),this.roughness!==void 0&&(te.roughness=this.roughness),this.metalness!==void 0&&(te.metalness=this.metalness),this.sheen!==void 0&&(te.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(te.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(te.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(te.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(te.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(te.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(te.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(te.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(te.shininess=this.shininess),this.clearcoat!==void 0&&(te.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(te.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(te.clearcoatMap=this.clearcoatMap.toJSON(_).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(te.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(te.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_).uuid,te.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(te.dispersion=this.dispersion),this.iridescence!==void 0&&(te.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(te.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(te.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(te.iridescenceMap=this.iridescenceMap.toJSON(_).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(te.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_).uuid),this.anisotropy!==void 0&&(te.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(te.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(te.anisotropyMap=this.anisotropyMap.toJSON(_).uuid),this.map&&this.map.isTexture&&(te.map=this.map.toJSON(_).uuid),this.matcap&&this.matcap.isTexture&&(te.matcap=this.matcap.toJSON(_).uuid),this.alphaMap&&this.alphaMap.isTexture&&(te.alphaMap=this.alphaMap.toJSON(_).uuid),this.lightMap&&this.lightMap.isTexture&&(te.lightMap=this.lightMap.toJSON(_).uuid,te.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(te.aoMap=this.aoMap.toJSON(_).uuid,te.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(te.bumpMap=this.bumpMap.toJSON(_).uuid,te.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(te.normalMap=this.normalMap.toJSON(_).uuid,te.normalMapType=this.normalMapType,te.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(te.displacementMap=this.displacementMap.toJSON(_).uuid,te.displacementScale=this.displacementScale,te.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(te.roughnessMap=this.roughnessMap.toJSON(_).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(te.metalnessMap=this.metalnessMap.toJSON(_).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(te.emissiveMap=this.emissiveMap.toJSON(_).uuid),this.specularMap&&this.specularMap.isTexture&&(te.specularMap=this.specularMap.toJSON(_).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(te.specularIntensityMap=this.specularIntensityMap.toJSON(_).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(te.specularColorMap=this.specularColorMap.toJSON(_).uuid),this.envMap&&this.envMap.isTexture&&(te.envMap=this.envMap.toJSON(_).uuid,this.combine!==void 0&&(te.combine=this.combine)),this.envMapRotation!==void 0&&(te.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(te.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(te.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(te.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(te.gradientMap=this.gradientMap.toJSON(_).uuid),this.transmission!==void 0&&(te.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(te.transmissionMap=this.transmissionMap.toJSON(_).uuid),this.thickness!==void 0&&(te.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(te.thicknessMap=this.thicknessMap.toJSON(_).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(te.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(te.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(te.size=this.size),this.shadowSide!==null&&(te.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(te.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(te.blending=this.blending),this.side!==FrontSide&&(te.side=this.side),this.vertexColors===!0&&(te.vertexColors=!0),this.opacity<1&&(te.opacity=this.opacity),this.transparent===!0&&(te.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(te.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(te.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(te.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(te.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(te.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(te.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(te.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(te.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(te.depthFunc=this.depthFunc),this.depthTest===!1&&(te.depthTest=this.depthTest),this.depthWrite===!1&&(te.depthWrite=this.depthWrite),this.colorWrite===!1&&(te.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(te.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(te.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(te.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(te.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(te.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(te.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(te.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(te.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(te.rotation=this.rotation),this.polygonOffset===!0&&(te.polygonOffset=!0),this.polygonOffsetFactor!==0&&(te.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(te.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(te.linewidth=this.linewidth),this.dashSize!==void 0&&(te.dashSize=this.dashSize),this.gapSize!==void 0&&(te.gapSize=this.gapSize),this.scale!==void 0&&(te.scale=this.scale),this.dithering===!0&&(te.dithering=!0),this.alphaTest>0&&(te.alphaTest=this.alphaTest),this.alphaHash===!0&&(te.alphaHash=!0),this.alphaToCoverage===!0&&(te.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(te.premultipliedAlpha=!0),this.forceSinglePass===!0&&(te.forceSinglePass=!0),this.wireframe===!0&&(te.wireframe=!0),this.wireframeLinewidth>1&&(te.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(te.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(te.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(te.flatShading=!0),this.visible===!1&&(te.visible=!1),this.toneMapped===!1&&(te.toneMapped=!1),this.fog===!1&&(te.fog=!1),Object.keys(this.userData).length>0&&(te.userData=this.userData);function ne(ie){const oe=[];for(const se in ie){const ae=ie[se];delete ae.metadata,oe.push(ae)}return oe}if(Z){const ie=ne(_.textures),oe=ne(_.images);ie.length>0&&(te.textures=ie),oe.length>0&&(te.images=oe)}return te}clone(){return new this.constructor().copy(this)}copy(_){this.name=_.name,this.blending=_.blending,this.side=_.side,this.vertexColors=_.vertexColors,this.opacity=_.opacity,this.transparent=_.transparent,this.blendSrc=_.blendSrc,this.blendDst=_.blendDst,this.blendEquation=_.blendEquation,this.blendSrcAlpha=_.blendSrcAlpha,this.blendDstAlpha=_.blendDstAlpha,this.blendEquationAlpha=_.blendEquationAlpha,this.blendColor.copy(_.blendColor),this.blendAlpha=_.blendAlpha,this.depthFunc=_.depthFunc,this.depthTest=_.depthTest,this.depthWrite=_.depthWrite,this.stencilWriteMask=_.stencilWriteMask,this.stencilFunc=_.stencilFunc,this.stencilRef=_.stencilRef,this.stencilFuncMask=_.stencilFuncMask,this.stencilFail=_.stencilFail,this.stencilZFail=_.stencilZFail,this.stencilZPass=_.stencilZPass,this.stencilWrite=_.stencilWrite;const Z=_.clippingPlanes;let te=null;if(Z!==null){const ne=Z.length;te=new Array(ne);for(let ie=0;ie!==ne;++ie)te[ie]=Z[ie].clone()}return this.clippingPlanes=te,this.clipIntersection=_.clipIntersection,this.clipShadows=_.clipShadows,this.shadowSide=_.shadowSide,this.colorWrite=_.colorWrite,this.precision=_.precision,this.polygonOffset=_.polygonOffset,this.polygonOffsetFactor=_.polygonOffsetFactor,this.polygonOffsetUnits=_.polygonOffsetUnits,this.dithering=_.dithering,this.alphaTest=_.alphaTest,this.alphaHash=_.alphaHash,this.alphaToCoverage=_.alphaToCoverage,this.premultipliedAlpha=_.premultipliedAlpha,this.forceSinglePass=_.forceSinglePass,this.visible=_.visible,this.toneMapped=_.toneMapped,this.userData=JSON.parse(JSON.stringify(_.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_){_===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class MeshBasicMaterial extends Material{constructor(_){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}const _tables=_generateTables();function _generateTables(){const K=new ArrayBuffer(4),_=new Float32Array(K),Z=new Uint32Array(K),te=new Uint32Array(512),ne=new Uint32Array(512);for(let ae=0;ae<256;++ae){const le=ae-127;le<-27?(te[ae]=0,te[ae|256]=32768,ne[ae]=24,ne[ae|256]=24):le<-14?(te[ae]=1024>>-le-14,te[ae|256]=1024>>-le-14|32768,ne[ae]=-le-1,ne[ae|256]=-le-1):le<=15?(te[ae]=le+15<<10,te[ae|256]=le+15<<10|32768,ne[ae]=13,ne[ae|256]=13):le<128?(te[ae]=31744,te[ae|256]=64512,ne[ae]=24,ne[ae|256]=24):(te[ae]=31744,te[ae|256]=64512,ne[ae]=13,ne[ae|256]=13)}const ie=new Uint32Array(2048),oe=new Uint32Array(64),se=new Uint32Array(64);for(let ae=1;ae<1024;++ae){let le=ae<<13,ce=0;for(;!(le&8388608);)le<<=1,ce-=8388608;le&=-8388609,ce+=947912704,ie[ae]=le|ce}for(let ae=1024;ae<2048;++ae)ie[ae]=939524096+(ae-1024<<13);for(let ae=1;ae<31;++ae)oe[ae]=ae<<23;oe[31]=1199570944,oe[32]=2147483648;for(let ae=33;ae<63;++ae)oe[ae]=2147483648+(ae-32<<23);oe[63]=3347054592;for(let ae=1;ae<64;++ae)ae!==32&&(se[ae]=1024);return{floatView:_,uint32View:Z,baseTable:te,shiftTable:ne,mantissaTable:ie,exponentTable:oe,offsetTable:se}}function toHalfFloat(K){Math.abs(K)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),K=clamp$4(K,-65504,65504),_tables.floatView[0]=K;const _=_tables.uint32View[0],Z=_>>23&511;return _tables.baseTable[Z]+((_&8388607)>>_tables.shiftTable[Z])}function fromHalfFloat(K){const _=K>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_]+(K&1023)]+_tables.exponentTable[_],_tables.floatView[0]}class DataUtils{static toHalfFloat(_){return toHalfFloat(_)}static fromHalfFloat(_){return fromHalfFloat(_)}}const _vector$9=new Vector3,_vector2$1=new Vector2;let _id$2=0;class BufferAttribute{constructor(_,Z,te=!1){if(Array.isArray(_))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.name="",this.array=_,this.itemSize=Z,this.count=_!==void 0?_.length/Z:0,this.normalized=te,this.usage=StaticDrawUsage,this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}setUsage(_){return this.usage=_,this}addUpdateRange(_,Z){this.updateRanges.push({start:_,count:Z})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.name=_.name,this.array=new _.array.constructor(_.array),this.itemSize=_.itemSize,this.count=_.count,this.normalized=_.normalized,this.usage=_.usage,this.gpuType=_.gpuType,this}copyAt(_,Z,te){_*=this.itemSize,te*=Z.itemSize;for(let ne=0,ie=this.itemSize;ne<ie;ne++)this.array[_+ne]=Z.array[te+ne];return this}copyArray(_){return this.array.set(_),this}applyMatrix3(_){if(this.itemSize===2)for(let Z=0,te=this.count;Z<te;Z++)_vector2$1.fromBufferAttribute(this,Z),_vector2$1.applyMatrix3(_),this.setXY(Z,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let Z=0,te=this.count;Z<te;Z++)_vector$9.fromBufferAttribute(this,Z),_vector$9.applyMatrix3(_),this.setXYZ(Z,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(_){for(let Z=0,te=this.count;Z<te;Z++)_vector$9.fromBufferAttribute(this,Z),_vector$9.applyMatrix4(_),this.setXYZ(Z,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(_){for(let Z=0,te=this.count;Z<te;Z++)_vector$9.fromBufferAttribute(this,Z),_vector$9.applyNormalMatrix(_),this.setXYZ(Z,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(_){for(let Z=0,te=this.count;Z<te;Z++)_vector$9.fromBufferAttribute(this,Z),_vector$9.transformDirection(_),this.setXYZ(Z,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(_,Z=0){return this.array.set(_,Z),this}getComponent(_,Z){let te=this.array[_*this.itemSize+Z];return this.normalized&&(te=denormalize(te,this.array)),te}setComponent(_,Z,te){return this.normalized&&(te=normalize$c(te,this.array)),this.array[_*this.itemSize+Z]=te,this}getX(_){let Z=this.array[_*this.itemSize];return this.normalized&&(Z=denormalize(Z,this.array)),Z}setX(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize]=Z,this}getY(_){let Z=this.array[_*this.itemSize+1];return this.normalized&&(Z=denormalize(Z,this.array)),Z}setY(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize+1]=Z,this}getZ(_){let Z=this.array[_*this.itemSize+2];return this.normalized&&(Z=denormalize(Z,this.array)),Z}setZ(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize+2]=Z,this}getW(_){let Z=this.array[_*this.itemSize+3];return this.normalized&&(Z=denormalize(Z,this.array)),Z}setW(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize+3]=Z,this}setXY(_,Z,te){return _*=this.itemSize,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array)),this.array[_+0]=Z,this.array[_+1]=te,this}setXYZ(_,Z,te,ne){return _*=this.itemSize,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array),ne=normalize$c(ne,this.array)),this.array[_+0]=Z,this.array[_+1]=te,this.array[_+2]=ne,this}setXYZW(_,Z,te,ne,ie){return _*=this.itemSize,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array),ne=normalize$c(ne,this.array),ie=normalize$c(ie,this.array)),this.array[_+0]=Z,this.array[_+1]=te,this.array[_+2]=ne,this.array[_+3]=ie,this}onUpload(_){return this.onUploadCallback=_,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_.name=this.name),this.usage!==StaticDrawUsage&&(_.usage=this.usage),_}}class Int8BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Int8Array(_),Z,te)}}class Uint8BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Uint8Array(_),Z,te)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Uint8ClampedArray(_),Z,te)}}class Int16BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Int16Array(_),Z,te)}}class Uint16BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Uint16Array(_),Z,te)}}class Int32BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Int32Array(_),Z,te)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Uint32Array(_),Z,te)}}class Float16BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Uint16Array(_),Z,te),this.isFloat16BufferAttribute=!0}getX(_){let Z=fromHalfFloat(this.array[_*this.itemSize]);return this.normalized&&(Z=denormalize(Z,this.array)),Z}setX(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize]=toHalfFloat(Z),this}getY(_){let Z=fromHalfFloat(this.array[_*this.itemSize+1]);return this.normalized&&(Z=denormalize(Z,this.array)),Z}setY(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize+1]=toHalfFloat(Z),this}getZ(_){let Z=fromHalfFloat(this.array[_*this.itemSize+2]);return this.normalized&&(Z=denormalize(Z,this.array)),Z}setZ(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize+2]=toHalfFloat(Z),this}getW(_){let Z=fromHalfFloat(this.array[_*this.itemSize+3]);return this.normalized&&(Z=denormalize(Z,this.array)),Z}setW(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.array[_*this.itemSize+3]=toHalfFloat(Z),this}setXY(_,Z,te){return _*=this.itemSize,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array)),this.array[_+0]=toHalfFloat(Z),this.array[_+1]=toHalfFloat(te),this}setXYZ(_,Z,te,ne){return _*=this.itemSize,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array),ne=normalize$c(ne,this.array)),this.array[_+0]=toHalfFloat(Z),this.array[_+1]=toHalfFloat(te),this.array[_+2]=toHalfFloat(ne),this}setXYZW(_,Z,te,ne,ie){return _*=this.itemSize,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array),ne=normalize$c(ne,this.array),ie=normalize$c(ie,this.array)),this.array[_+0]=toHalfFloat(Z),this.array[_+1]=toHalfFloat(te),this.array[_+2]=toHalfFloat(ne),this.array[_+3]=toHalfFloat(ie),this}}class Float32BufferAttribute extends BufferAttribute{constructor(_,Z,te){super(new Float32Array(_),Z,te)}}let _id$1=0;const _m1$3=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher$1{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$1++}),this.uuid=generateUUID$1(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_){return Array.isArray(_)?this.index=new(arrayNeedsUint32(_)?Uint32BufferAttribute:Uint16BufferAttribute)(_,1):this.index=_,this}setIndirect(_){return this.indirect=_,this}getIndirect(){return this.indirect}getAttribute(_){return this.attributes[_]}setAttribute(_,Z){return this.attributes[_]=Z,this}deleteAttribute(_){return delete this.attributes[_],this}hasAttribute(_){return this.attributes[_]!==void 0}addGroup(_,Z,te=0){this.groups.push({start:_,count:Z,materialIndex:te})}clearGroups(){this.groups=[]}setDrawRange(_,Z){this.drawRange.start=_,this.drawRange.count=Z}applyMatrix4(_){const Z=this.attributes.position;Z!==void 0&&(Z.applyMatrix4(_),Z.needsUpdate=!0);const te=this.attributes.normal;if(te!==void 0){const ie=new Matrix3().getNormalMatrix(_);te.applyNormalMatrix(ie),te.needsUpdate=!0}const ne=this.attributes.tangent;return ne!==void 0&&(ne.transformDirection(_),ne.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_){return _m1$3.makeRotationFromQuaternion(_),this.applyMatrix4(_m1$3),this}rotateX(_){return _m1$3.makeRotationX(_),this.applyMatrix4(_m1$3),this}rotateY(_){return _m1$3.makeRotationY(_),this.applyMatrix4(_m1$3),this}rotateZ(_){return _m1$3.makeRotationZ(_),this.applyMatrix4(_m1$3),this}translate(_,Z,te){return _m1$3.makeTranslation(_,Z,te),this.applyMatrix4(_m1$3),this}scale(_,Z,te){return _m1$3.makeScale(_,Z,te),this.applyMatrix4(_m1$3),this}lookAt(_){return _obj.lookAt(_),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_){const Z=this.getAttribute("position");if(Z===void 0){const te=[];for(let ne=0,ie=_.length;ne<ie;ne++){const oe=_[ne];te.push(oe.x,oe.y,oe.z||0)}this.setAttribute("position",new Float32BufferAttribute(te,3))}else{const te=Math.min(_.length,Z.count);for(let ne=0;ne<te;ne++){const ie=_[ne];Z.setXYZ(ne,ie.x,ie.y,ie.z||0)}_.length>Z.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),Z.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this.attributes.position,Z=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_!==void 0){if(this.boundingBox.setFromBufferAttribute(_),Z)for(let te=0,ne=Z.length;te<ne;te++){const ie=Z[te];_box$2.setFromBufferAttribute(ie),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$2);const _=this.attributes.position,Z=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3,1/0);return}if(_){const te=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(_),Z)for(let ie=0,oe=Z.length;ie<oe;ie++){const se=Z[ie];_boxMorphTargets.setFromBufferAttribute(se),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(te);let ne=0;for(let ie=0,oe=_.count;ie<oe;ie++)_vector$8.fromBufferAttribute(_,ie),ne=Math.max(ne,te.distanceToSquared(_vector$8));if(Z)for(let ie=0,oe=Z.length;ie<oe;ie++){const se=Z[ie],ae=this.morphTargetsRelative;for(let le=0,ce=se.count;le<ce;le++)_vector$8.fromBufferAttribute(se,le),ae&&(_offset.fromBufferAttribute(_,le),_vector$8.add(_offset)),ne=Math.max(ne,te.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(ne),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _=this.index,Z=this.attributes;if(_===null||Z.position===void 0||Z.normal===void 0||Z.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const te=Z.position,ne=Z.normal,ie=Z.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*te.count),4));const oe=this.getAttribute("tangent"),se=[],ae=[];for(let we=0;we<te.count;we++)se[we]=new Vector3,ae[we]=new Vector3;const le=new Vector3,ce=new Vector3,fe=new Vector3,de=new Vector2,pe=new Vector2,he=new Vector2,ge=new Vector3,me=new Vector3;function Ae(we,Pe,Ie){le.fromBufferAttribute(te,we),ce.fromBufferAttribute(te,Pe),fe.fromBufferAttribute(te,Ie),de.fromBufferAttribute(ie,we),pe.fromBufferAttribute(ie,Pe),he.fromBufferAttribute(ie,Ie),ce.sub(le),fe.sub(le),pe.sub(de),he.sub(de);const $e=1/(pe.x*he.y-he.x*pe.y);isFinite($e)&&(ge.copy(ce).multiplyScalar(he.y).addScaledVector(fe,-pe.y).multiplyScalar($e),me.copy(fe).multiplyScalar(pe.x).addScaledVector(ce,-he.x).multiplyScalar($e),se[we].add(ge),se[Pe].add(ge),se[Ie].add(ge),ae[we].add(me),ae[Pe].add(me),ae[Ie].add(me))}let ye=this.groups;ye.length===0&&(ye=[{start:0,count:_.count}]);for(let we=0,Pe=ye.length;we<Pe;++we){const Ie=ye[we],$e=Ie.start,Ue=Ie.count;for(let ke=$e,Ge=$e+Ue;ke<Ge;ke+=3)Ae(_.getX(ke+0),_.getX(ke+1),_.getX(ke+2))}const ve=new Vector3,_e=new Vector3,Te=new Vector3,be=new Vector3;function Re(we){Te.fromBufferAttribute(ne,we),be.copy(Te);const Pe=se[we];ve.copy(Pe),ve.sub(Te.multiplyScalar(Te.dot(Pe))).normalize(),_e.crossVectors(be,Pe);const $e=_e.dot(ae[we])<0?-1:1;oe.setXYZW(we,ve.x,ve.y,ve.z,$e)}for(let we=0,Pe=ye.length;we<Pe;++we){const Ie=ye[we],$e=Ie.start,Ue=Ie.count;for(let ke=$e,Ge=$e+Ue;ke<Ge;ke+=3)Re(_.getX(ke+0)),Re(_.getX(ke+1)),Re(_.getX(ke+2))}}computeVertexNormals(){const _=this.index,Z=this.getAttribute("position");if(Z!==void 0){let te=this.getAttribute("normal");if(te===void 0)te=new BufferAttribute(new Float32Array(Z.count*3),3),this.setAttribute("normal",te);else for(let de=0,pe=te.count;de<pe;de++)te.setXYZ(de,0,0,0);const ne=new Vector3,ie=new Vector3,oe=new Vector3,se=new Vector3,ae=new Vector3,le=new Vector3,ce=new Vector3,fe=new Vector3;if(_)for(let de=0,pe=_.count;de<pe;de+=3){const he=_.getX(de+0),ge=_.getX(de+1),me=_.getX(de+2);ne.fromBufferAttribute(Z,he),ie.fromBufferAttribute(Z,ge),oe.fromBufferAttribute(Z,me),ce.subVectors(oe,ie),fe.subVectors(ne,ie),ce.cross(fe),se.fromBufferAttribute(te,he),ae.fromBufferAttribute(te,ge),le.fromBufferAttribute(te,me),se.add(ce),ae.add(ce),le.add(ce),te.setXYZ(he,se.x,se.y,se.z),te.setXYZ(ge,ae.x,ae.y,ae.z),te.setXYZ(me,le.x,le.y,le.z)}else for(let de=0,pe=Z.count;de<pe;de+=3)ne.fromBufferAttribute(Z,de+0),ie.fromBufferAttribute(Z,de+1),oe.fromBufferAttribute(Z,de+2),ce.subVectors(oe,ie),fe.subVectors(ne,ie),ce.cross(fe),te.setXYZ(de+0,ce.x,ce.y,ce.z),te.setXYZ(de+1,ce.x,ce.y,ce.z),te.setXYZ(de+2,ce.x,ce.y,ce.z);this.normalizeNormals(),te.needsUpdate=!0}}normalizeNormals(){const _=this.attributes.normal;for(let Z=0,te=_.count;Z<te;Z++)_vector$8.fromBufferAttribute(_,Z),_vector$8.normalize(),_.setXYZ(Z,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function _(se,ae){const le=se.array,ce=se.itemSize,fe=se.normalized,de=new le.constructor(ae.length*ce);let pe=0,he=0;for(let ge=0,me=ae.length;ge<me;ge++){se.isInterleavedBufferAttribute?pe=ae[ge]*se.data.stride+se.offset:pe=ae[ge]*ce;for(let Ae=0;Ae<ce;Ae++)de[he++]=le[pe++]}return new BufferAttribute(de,ce,fe)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const Z=new BufferGeometry,te=this.index.array,ne=this.attributes;for(const se in ne){const ae=ne[se],le=_(ae,te);Z.setAttribute(se,le)}const ie=this.morphAttributes;for(const se in ie){const ae=[],le=ie[se];for(let ce=0,fe=le.length;ce<fe;ce++){const de=le[ce],pe=_(de,te);ae.push(pe)}Z.morphAttributes[se]=ae}Z.morphTargetsRelative=this.morphTargetsRelative;const oe=this.groups;for(let se=0,ae=oe.length;se<ae;se++){const le=oe[se];Z.addGroup(le.start,le.count,le.materialIndex)}return Z}toJSON(){const _={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),Object.keys(this.userData).length>0&&(_.userData=this.userData),this.parameters!==void 0){const ae=this.parameters;for(const le in ae)ae[le]!==void 0&&(_[le]=ae[le]);return _}_.data={attributes:{}};const Z=this.index;Z!==null&&(_.data.index={type:Z.array.constructor.name,array:Array.prototype.slice.call(Z.array)});const te=this.attributes;for(const ae in te){const le=te[ae];_.data.attributes[ae]=le.toJSON(_.data)}const ne={};let ie=!1;for(const ae in this.morphAttributes){const le=this.morphAttributes[ae],ce=[];for(let fe=0,de=le.length;fe<de;fe++){const pe=le[fe];ce.push(pe.toJSON(_.data))}ce.length>0&&(ne[ae]=ce,ie=!0)}ie&&(_.data.morphAttributes=ne,_.data.morphTargetsRelative=this.morphTargetsRelative);const oe=this.groups;oe.length>0&&(_.data.groups=JSON.parse(JSON.stringify(oe)));const se=this.boundingSphere;return se!==null&&(_.data.boundingSphere={center:se.center.toArray(),radius:se.radius}),_}clone(){return new this.constructor().copy(this)}copy(_){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const Z={};this.name=_.name;const te=_.index;te!==null&&this.setIndex(te.clone());const ne=_.attributes;for(const le in ne){const ce=ne[le];this.setAttribute(le,ce.clone(Z))}const ie=_.morphAttributes;for(const le in ie){const ce=[],fe=ie[le];for(let de=0,pe=fe.length;de<pe;de++)ce.push(fe[de].clone(Z));this.morphAttributes[le]=ce}this.morphTargetsRelative=_.morphTargetsRelative;const oe=_.groups;for(let le=0,ce=oe.length;le<ce;le++){const fe=oe[le];this.addGroup(fe.start,fe.count,fe.materialIndex)}const se=_.boundingBox;se!==null&&(this.boundingBox=se.clone());const ae=_.boundingSphere;return ae!==null&&(this.boundingSphere=ae.clone()),this.drawRange.start=_.drawRange.start,this.drawRange.count=_.drawRange.count,this.userData=_.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere$2,_sphereHitAt=new Vector3,_vA$1$1=new Vector3,_vB$1$1=new Vector3,_vC$1$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_intersectionPoint$2=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_=new BufferGeometry,Z=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_,this.material=Z,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(_,Z){return super.copy(_,Z),_.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_.morphTargetInfluences.slice()),_.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_.morphTargetDictionary)),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}updateMorphTargets(){const Z=this.geometry.morphAttributes,te=Object.keys(Z);if(te.length>0){const ne=Z[te[0]];if(ne!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let ie=0,oe=ne.length;ie<oe;ie++){const se=ne[ie].name||String(ie);this.morphTargetInfluences.push(0),this.morphTargetDictionary[se]=ie}}}}getVertexPosition(_,Z){const te=this.geometry,ne=te.attributes.position,ie=te.morphAttributes.position,oe=te.morphTargetsRelative;Z.fromBufferAttribute(ne,_);const se=this.morphTargetInfluences;if(ie&&se){_morphA.set(0,0,0);for(let ae=0,le=ie.length;ae<le;ae++){const ce=se[ae],fe=ie[ae];ce!==0&&(_tempA.fromBufferAttribute(fe,_),oe?_morphA.addScaledVector(_tempA,ce):_morphA.addScaledVector(_tempA.sub(Z),ce))}Z.add(_morphA)}return Z}raycast(_,Z){const te=this.geometry,ne=this.material,ie=this.matrixWorld;ne!==void 0&&(te.boundingSphere===null&&te.computeBoundingSphere(),_sphere$6.copy(te.boundingSphere),_sphere$6.applyMatrix4(ie),_ray$3.copy(_.ray).recast(_.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_.far-_.near)**2))&&(_inverseMatrix$3.copy(ie).invert(),_ray$3.copy(_.ray).applyMatrix4(_inverseMatrix$3),!(te.boundingBox!==null&&_ray$3.intersectsBox(te.boundingBox)===!1)&&this._computeIntersections(_,Z,_ray$3)))}_computeIntersections(_,Z,te){let ne;const ie=this.geometry,oe=this.material,se=ie.index,ae=ie.attributes.position,le=ie.attributes.uv,ce=ie.attributes.uv1,fe=ie.attributes.normal,de=ie.groups,pe=ie.drawRange;if(se!==null)if(Array.isArray(oe))for(let he=0,ge=de.length;he<ge;he++){const me=de[he],Ae=oe[me.materialIndex],ye=Math.max(me.start,pe.start),ve=Math.min(se.count,Math.min(me.start+me.count,pe.start+pe.count));for(let _e=ye,Te=ve;_e<Te;_e+=3){const be=se.getX(_e),Re=se.getX(_e+1),we=se.getX(_e+2);ne=checkGeometryIntersection(this,Ae,_,te,le,ce,fe,be,Re,we),ne&&(ne.faceIndex=Math.floor(_e/3),ne.face.materialIndex=me.materialIndex,Z.push(ne))}}else{const he=Math.max(0,pe.start),ge=Math.min(se.count,pe.start+pe.count);for(let me=he,Ae=ge;me<Ae;me+=3){const ye=se.getX(me),ve=se.getX(me+1),_e=se.getX(me+2);ne=checkGeometryIntersection(this,oe,_,te,le,ce,fe,ye,ve,_e),ne&&(ne.faceIndex=Math.floor(me/3),Z.push(ne))}}else if(ae!==void 0)if(Array.isArray(oe))for(let he=0,ge=de.length;he<ge;he++){const me=de[he],Ae=oe[me.materialIndex],ye=Math.max(me.start,pe.start),ve=Math.min(ae.count,Math.min(me.start+me.count,pe.start+pe.count));for(let _e=ye,Te=ve;_e<Te;_e+=3){const be=_e,Re=_e+1,we=_e+2;ne=checkGeometryIntersection(this,Ae,_,te,le,ce,fe,be,Re,we),ne&&(ne.faceIndex=Math.floor(_e/3),ne.face.materialIndex=me.materialIndex,Z.push(ne))}}else{const he=Math.max(0,pe.start),ge=Math.min(ae.count,pe.start+pe.count);for(let me=he,Ae=ge;me<Ae;me+=3){const ye=me,ve=me+1,_e=me+2;ne=checkGeometryIntersection(this,oe,_,te,le,ce,fe,ye,ve,_e),ne&&(ne.faceIndex=Math.floor(me/3),Z.push(ne))}}}}function checkIntersection$1$1(K,_,Z,te,ne,ie,oe,se){let ae;if(_.side===BackSide?ae=te.intersectTriangle(oe,ie,ne,!0,se):ae=te.intersectTriangle(ne,ie,oe,_.side===FrontSide,se),ae===null)return null;_intersectionPointWorld.copy(se),_intersectionPointWorld.applyMatrix4(K.matrixWorld);const le=Z.ray.origin.distanceTo(_intersectionPointWorld);return le<Z.near||le>Z.far?null:{distance:le,point:_intersectionPointWorld.clone(),object:K}}function checkGeometryIntersection(K,_,Z,te,ne,ie,oe,se,ae,le){K.getVertexPosition(se,_vA$1$1),K.getVertexPosition(ae,_vB$1$1),K.getVertexPosition(le,_vC$1$1);const ce=checkIntersection$1$1(K,_,Z,te,_vA$1$1,_vB$1$1,_vC$1$1,_intersectionPoint$2);if(ce){const fe=new Vector3;Triangle.getBarycoord(_intersectionPoint$2,_vA$1$1,_vB$1$1,_vC$1$1,fe),ne&&(ce.uv=Triangle.getInterpolatedAttribute(ne,se,ae,le,fe,new Vector2)),ie&&(ce.uv1=Triangle.getInterpolatedAttribute(ie,se,ae,le,fe,new Vector2)),oe&&(ce.normal=Triangle.getInterpolatedAttribute(oe,se,ae,le,fe,new Vector3),ce.normal.dot(te.direction)>0&&ce.normal.multiplyScalar(-1));const de={a:se,b:ae,c:le,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1$1,_vB$1$1,_vC$1$1,de.normal),ce.face=de,ce.barycoord=fe}return ce}class BoxGeometry extends BufferGeometry{constructor(_=1,Z=1,te=1,ne=1,ie=1,oe=1){super(),this.type="BoxGeometry",this.parameters={width:_,height:Z,depth:te,widthSegments:ne,heightSegments:ie,depthSegments:oe};const se=this;ne=Math.floor(ne),ie=Math.floor(ie),oe=Math.floor(oe);const ae=[],le=[],ce=[],fe=[];let de=0,pe=0;he("z","y","x",-1,-1,te,Z,_,oe,ie,0),he("z","y","x",1,-1,te,Z,-_,oe,ie,1),he("x","z","y",1,1,_,te,Z,ne,oe,2),he("x","z","y",1,-1,_,te,-Z,ne,oe,3),he("x","y","z",1,-1,_,Z,te,ne,ie,4),he("x","y","z",-1,-1,_,Z,-te,ne,ie,5),this.setIndex(ae),this.setAttribute("position",new Float32BufferAttribute(le,3)),this.setAttribute("normal",new Float32BufferAttribute(ce,3)),this.setAttribute("uv",new Float32BufferAttribute(fe,2));function he(ge,me,Ae,ye,ve,_e,Te,be,Re,we,Pe){const Ie=_e/Re,$e=Te/we,Ue=_e/2,ke=Te/2,Ge=be/2,He=Re+1,ze=we+1;let Ke=0,tt=0;const Je=new Vector3;for(let ot=0;ot<ze;ot++){const Fe=ot*$e-ke;for(let ct=0;ct<He;ct++){const ht=ct*Ie-Ue;Je[ge]=ht*ye,Je[me]=Fe*ve,Je[Ae]=Ge,le.push(Je.x,Je.y,Je.z),Je[ge]=0,Je[me]=0,Je[Ae]=be>0?1:-1,ce.push(Je.x,Je.y,Je.z),fe.push(ct/Re),fe.push(1-ot/we),Ke+=1}}for(let ot=0;ot<we;ot++)for(let Fe=0;Fe<Re;Fe++){const ct=de+Fe+He*ot,ht=de+Fe+He*(ot+1),lt=de+(Fe+1)+He*(ot+1),Qe=de+(Fe+1)+He*ot;ae.push(ct,ht,Qe),ae.push(ht,lt,Qe),tt+=6}se.addGroup(pe,tt,Pe),pe+=tt,de+=Ke}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new BoxGeometry(_.width,_.height,_.depth,_.widthSegments,_.heightSegments,_.depthSegments)}}function cloneUniforms(K){const _={};for(const Z in K){_[Z]={};for(const te in K[Z]){const ne=K[Z][te];ne&&(ne.isColor||ne.isMatrix3||ne.isMatrix4||ne.isVector2||ne.isVector3||ne.isVector4||ne.isTexture||ne.isQuaternion)?ne.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_[Z][te]=null):_[Z][te]=ne.clone():Array.isArray(ne)?_[Z][te]=ne.slice():_[Z][te]=ne}}return _}function mergeUniforms(K){const _={};for(let Z=0;Z<K.length;Z++){const te=cloneUniforms(K[Z]);for(const ne in te)_[ne]=te[ne]}return _}function cloneUniformsGroups(K){const _=[];for(let Z=0;Z<K.length;Z++)_.push(K[Z].clone());return _}function getUnlitUniformColorSpace(K){const _=K.getRenderTarget();return _===null?K.outputColorSpace:_.isXRRenderTarget===!0?_.texture.colorSpace:ColorManagement.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(_){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_!==void 0&&this.setValues(_)}copy(_){return super.copy(_),this.fragmentShader=_.fragmentShader,this.vertexShader=_.vertexShader,this.uniforms=cloneUniforms(_.uniforms),this.uniformsGroups=cloneUniformsGroups(_.uniformsGroups),this.defines=Object.assign({},_.defines),this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.fog=_.fog,this.lights=_.lights,this.clipping=_.clipping,this.extensions=Object.assign({},_.extensions),this.glslVersion=_.glslVersion,this}toJSON(_){const Z=super.toJSON(_);Z.glslVersion=this.glslVersion,Z.uniforms={};for(const ne in this.uniforms){const oe=this.uniforms[ne].value;oe&&oe.isTexture?Z.uniforms[ne]={type:"t",value:oe.toJSON(_).uuid}:oe&&oe.isColor?Z.uniforms[ne]={type:"c",value:oe.getHex()}:oe&&oe.isVector2?Z.uniforms[ne]={type:"v2",value:oe.toArray()}:oe&&oe.isVector3?Z.uniforms[ne]={type:"v3",value:oe.toArray()}:oe&&oe.isVector4?Z.uniforms[ne]={type:"v4",value:oe.toArray()}:oe&&oe.isMatrix3?Z.uniforms[ne]={type:"m3",value:oe.toArray()}:oe&&oe.isMatrix4?Z.uniforms[ne]={type:"m4",value:oe.toArray()}:Z.uniforms[ne]={value:oe}}Object.keys(this.defines).length>0&&(Z.defines=this.defines),Z.vertexShader=this.vertexShader,Z.fragmentShader=this.fragmentShader,Z.lights=this.lights,Z.clipping=this.clipping;const te={};for(const ne in this.extensions)this.extensions[ne]===!0&&(te[ne]=!0);return Object.keys(te).length>0&&(Z.extensions=te),Z}}let Camera$1=class extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_,Z){return super.copy(_,Z),this.matrixWorldInverse.copy(_.matrixWorldInverse),this.projectionMatrix.copy(_.projectionMatrix),this.projectionMatrixInverse.copy(_.projectionMatrixInverse),this.coordinateSystem=_.coordinateSystem,this}getWorldDirection(_){return super.getWorldDirection(_).negate()}updateMatrixWorld(_){super.updateMatrixWorld(_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_,Z){super.updateWorldMatrix(_,Z),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;let PerspectiveCamera$2=class extends Camera$1{constructor(_=50,Z=1,te=.1,ne=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_,this.zoom=1,this.near=te,this.far=ne,this.focus=10,this.aspect=Z,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_,Z){return super.copy(_,Z),this.fov=_.fov,this.zoom=_.zoom,this.near=_.near,this.far=_.far,this.focus=_.focus,this.aspect=_.aspect,this.view=_.view===null?null:Object.assign({},_.view),this.filmGauge=_.filmGauge,this.filmOffset=_.filmOffset,this}setFocalLength(_){const Z=.5*this.getFilmHeight()/_;this.fov=RAD2DEG*2*Math.atan(Z),this.updateProjectionMatrix()}getFocalLength(){const _=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_,Z,te){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),Z.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),te.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z)}getViewSize(_,Z){return this.getViewBounds(_,_minTarget,_maxTarget),Z.subVectors(_maxTarget,_minTarget)}setViewOffset(_,Z,te,ne,ie,oe){this.aspect=_/Z,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=Z,this.view.offsetX=te,this.view.offsetY=ne,this.view.width=ie,this.view.height=oe,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=this.near;let Z=_*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,te=2*Z,ne=this.aspect*te,ie=-.5*ne;const oe=this.view;if(this.view!==null&&this.view.enabled){const ae=oe.fullWidth,le=oe.fullHeight;ie+=oe.offsetX*ne/ae,Z-=oe.offsetY*te/le,ne*=oe.width/ae,te*=oe.height/le}const se=this.filmOffset;se!==0&&(ie+=_*se/this.getFilmWidth()),this.projectionMatrix.makePerspective(ie,ie+ne,Z,Z-te,_,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const Z=super.toJSON(_);return Z.object.fov=this.fov,Z.object.zoom=this.zoom,Z.object.near=this.near,Z.object.far=this.far,Z.object.focus=this.focus,Z.object.aspect=this.aspect,this.view!==null&&(Z.object.view=Object.assign({},this.view)),Z.object.filmGauge=this.filmGauge,Z.object.filmOffset=this.filmOffset,Z}};const fov=-90,aspect=1;let CubeCamera$1=class extends Object3D{constructor(_,Z,te){super(),this.type="CubeCamera",this.renderTarget=te,this.coordinateSystem=null,this.activeMipmapLevel=0;const ne=new PerspectiveCamera$2(fov,aspect,_,Z);ne.layers=this.layers,this.add(ne);const ie=new PerspectiveCamera$2(fov,aspect,_,Z);ie.layers=this.layers,this.add(ie);const oe=new PerspectiveCamera$2(fov,aspect,_,Z);oe.layers=this.layers,this.add(oe);const se=new PerspectiveCamera$2(fov,aspect,_,Z);se.layers=this.layers,this.add(se);const ae=new PerspectiveCamera$2(fov,aspect,_,Z);ae.layers=this.layers,this.add(ae);const le=new PerspectiveCamera$2(fov,aspect,_,Z);le.layers=this.layers,this.add(le)}updateCoordinateSystem(){const _=this.coordinateSystem,Z=this.children.concat(),[te,ne,ie,oe,se,ae]=Z;for(const le of Z)this.remove(le);if(_===WebGLCoordinateSystem)te.up.set(0,1,0),te.lookAt(1,0,0),ne.up.set(0,1,0),ne.lookAt(-1,0,0),ie.up.set(0,0,-1),ie.lookAt(0,1,0),oe.up.set(0,0,1),oe.lookAt(0,-1,0),se.up.set(0,1,0),se.lookAt(0,0,1),ae.up.set(0,1,0),ae.lookAt(0,0,-1);else if(_===WebGPUCoordinateSystem)te.up.set(0,-1,0),te.lookAt(-1,0,0),ne.up.set(0,-1,0),ne.lookAt(1,0,0),ie.up.set(0,0,1),ie.lookAt(0,1,0),oe.up.set(0,0,-1),oe.lookAt(0,-1,0),se.up.set(0,-1,0),se.lookAt(0,0,1),ae.up.set(0,-1,0),ae.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_);for(const le of Z)this.add(le),le.updateMatrixWorld()}update(_,Z){this.parent===null&&this.updateMatrixWorld();const{renderTarget:te,activeMipmapLevel:ne}=this;this.coordinateSystem!==_.coordinateSystem&&(this.coordinateSystem=_.coordinateSystem,this.updateCoordinateSystem());const[ie,oe,se,ae,le,ce]=this.children,fe=_.getRenderTarget(),de=_.getActiveCubeFace(),pe=_.getActiveMipmapLevel(),he=_.xr.enabled;_.xr.enabled=!1;const ge=te.texture.generateMipmaps;te.texture.generateMipmaps=!1,_.setRenderTarget(te,0,ne),_.render(Z,ie),_.setRenderTarget(te,1,ne),_.render(Z,oe),_.setRenderTarget(te,2,ne),_.render(Z,se),_.setRenderTarget(te,3,ne),_.render(Z,ae),_.setRenderTarget(te,4,ne),_.render(Z,le),te.texture.generateMipmaps=ge,_.setRenderTarget(te,5,ne),_.render(Z,ce),_.setRenderTarget(fe,de,pe),_.xr.enabled=he,te.texture.needsPMREMUpdate=!0}};class CubeTexture extends Texture$1{constructor(_=[],Z=CubeReflectionMapping,te,ne,ie,oe,se,ae,le,ce){super(_,Z,te,ne,ie,oe,se,ae,le,ce),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_){this.image=_}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_=1,Z={}){super(_,_,Z),this.isWebGLCubeRenderTarget=!0;const te={width:_,height:_,depth:1},ne=[te,te,te,te,te,te];this.texture=new CubeTexture(ne,Z.mapping,Z.wrapS,Z.wrapT,Z.magFilter,Z.minFilter,Z.format,Z.type,Z.anisotropy,Z.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=Z.generateMipmaps!==void 0?Z.generateMipmaps:!1,this.texture.minFilter=Z.minFilter!==void 0?Z.minFilter:LinearFilter}fromEquirectangularTexture(_,Z){this.texture.type=Z.type,this.texture.colorSpace=Z.colorSpace,this.texture.generateMipmaps=Z.generateMipmaps,this.texture.minFilter=Z.minFilter,this.texture.magFilter=Z.magFilter;const te={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},ne=new BoxGeometry(5,5,5),ie=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(te.uniforms),vertexShader:te.vertexShader,fragmentShader:te.fragmentShader,side:BackSide,blending:NoBlending});ie.uniforms.tEquirect.value=Z;const oe=new Mesh(ne,ie),se=Z.minFilter;return Z.minFilter===LinearMipmapLinearFilter&&(Z.minFilter=LinearFilter),new CubeCamera$1(1,10,this).update(_,oe),Z.minFilter=se,oe.geometry.dispose(),oe.material.dispose(),this}clear(_,Z=!0,te=!0,ne=!0){const ie=_.getRenderTarget();for(let oe=0;oe<6;oe++)_.setRenderTarget(this,oe),_.clear(Z,te,ne);_.setRenderTarget(ie)}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(_){return this._targetRay!==null&&this._targetRay.dispatchEvent(_),this._grip!==null&&this._grip.dispatchEvent(_),this._hand!==null&&this._hand.dispatchEvent(_),this}connect(_){if(_&&_.hand){const Z=this._hand;if(Z)for(const te of _.hand.values())this._getHandJoint(Z,te)}return this.dispatchEvent({type:"connected",data:_}),this}disconnect(_){return this.dispatchEvent({type:"disconnected",data:_}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_,Z,te){let ne=null,ie=null,oe=null;const se=this._targetRay,ae=this._grip,le=this._hand;if(_&&Z.session.visibilityState!=="visible-blurred"){if(le&&_.hand){oe=!0;for(const ge of _.hand.values()){const me=Z.getJointPose(ge,te),Ae=this._getHandJoint(le,ge);me!==null&&(Ae.matrix.fromArray(me.transform.matrix),Ae.matrix.decompose(Ae.position,Ae.rotation,Ae.scale),Ae.matrixWorldNeedsUpdate=!0,Ae.jointRadius=me.radius),Ae.visible=me!==null}const ce=le.joints["index-finger-tip"],fe=le.joints["thumb-tip"],de=ce.position.distanceTo(fe.position),pe=.02,he=.005;le.inputState.pinching&&de>pe+he?(le.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_.handedness,target:this})):!le.inputState.pinching&&de<=pe-he&&(le.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_.handedness,target:this}))}else ae!==null&&_.gripSpace&&(ie=Z.getPose(_.gripSpace,te),ie!==null&&(ae.matrix.fromArray(ie.transform.matrix),ae.matrix.decompose(ae.position,ae.rotation,ae.scale),ae.matrixWorldNeedsUpdate=!0,ie.linearVelocity?(ae.hasLinearVelocity=!0,ae.linearVelocity.copy(ie.linearVelocity)):ae.hasLinearVelocity=!1,ie.angularVelocity?(ae.hasAngularVelocity=!0,ae.angularVelocity.copy(ie.angularVelocity)):ae.hasAngularVelocity=!1));se!==null&&(ne=Z.getPose(_.targetRaySpace,te),ne===null&&ie!==null&&(ne=ie),ne!==null&&(se.matrix.fromArray(ne.transform.matrix),se.matrix.decompose(se.position,se.rotation,se.scale),se.matrixWorldNeedsUpdate=!0,ne.linearVelocity?(se.hasLinearVelocity=!0,se.linearVelocity.copy(ne.linearVelocity)):se.hasLinearVelocity=!1,ne.angularVelocity?(se.hasAngularVelocity=!0,se.angularVelocity.copy(ne.angularVelocity)):se.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return se!==null&&(se.visible=ne!==null),ae!==null&&(ae.visible=ie!==null),le!==null&&(le.visible=oe!==null),this}_getHandJoint(_,Z){if(_.joints[Z.jointName]===void 0){const te=new Group;te.matrixAutoUpdate=!1,te.visible=!1,_.joints[Z.jointName]=te,_.add(te)}return _.joints[Z.jointName]}}class FogExp2{constructor(_,Z=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color$1(_),this.density=Z}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fog{constructor(_,Z=1,te=1e3){this.isFog=!0,this.name="",this.color=new Color$1(_),this.near=Z,this.far=te}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let Scene$1=class extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler,this.environmentIntensity=1,this.environmentRotation=new Euler,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_,Z){return super.copy(_,Z),_.background!==null&&(this.background=_.background.clone()),_.environment!==null&&(this.environment=_.environment.clone()),_.fog!==null&&(this.fog=_.fog.clone()),this.backgroundBlurriness=_.backgroundBlurriness,this.backgroundIntensity=_.backgroundIntensity,this.backgroundRotation.copy(_.backgroundRotation),this.environmentIntensity=_.environmentIntensity,this.environmentRotation.copy(_.environmentRotation),_.overrideMaterial!==null&&(this.overrideMaterial=_.overrideMaterial.clone()),this.matrixAutoUpdate=_.matrixAutoUpdate,this}toJSON(_){const Z=super.toJSON(_);return this.fog!==null&&(Z.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(Z.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(Z.object.backgroundIntensity=this.backgroundIntensity),Z.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(Z.object.environmentIntensity=this.environmentIntensity),Z.object.environmentRotation=this.environmentRotation.toArray(),Z}};class InterleavedBuffer{constructor(_,Z){this.isInterleavedBuffer=!0,this.array=_,this.stride=Z,this.count=_!==void 0?_.length/Z:0,this.usage=StaticDrawUsage,this.updateRanges=[],this.version=0,this.uuid=generateUUID$1()}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}setUsage(_){return this.usage=_,this}addUpdateRange(_,Z){this.updateRanges.push({start:_,count:Z})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.array=new _.array.constructor(_.array),this.count=_.count,this.stride=_.stride,this.usage=_.usage,this}copyAt(_,Z,te){_*=this.stride,te*=Z.stride;for(let ne=0,ie=this.stride;ne<ie;ne++)this.array[_+ne]=Z.array[te+ne];return this}set(_,Z=0){return this.array.set(_,Z),this}clone(_){_.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const Z=new this.array.constructor(_.arrayBuffers[this.array.buffer._uuid]),te=new this.constructor(Z,this.stride);return te.setUsage(this.usage),te}onUpload(_){return this.onUploadCallback=_,this}toJSON(_){return _.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$7=new Vector3;class InterleavedBufferAttribute{constructor(_,Z,te,ne=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_,this.itemSize=Z,this.offset=te,this.normalized=ne}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_){this.data.needsUpdate=_}applyMatrix4(_){for(let Z=0,te=this.data.count;Z<te;Z++)_vector$7.fromBufferAttribute(this,Z),_vector$7.applyMatrix4(_),this.setXYZ(Z,_vector$7.x,_vector$7.y,_vector$7.z);return this}applyNormalMatrix(_){for(let Z=0,te=this.count;Z<te;Z++)_vector$7.fromBufferAttribute(this,Z),_vector$7.applyNormalMatrix(_),this.setXYZ(Z,_vector$7.x,_vector$7.y,_vector$7.z);return this}transformDirection(_){for(let Z=0,te=this.count;Z<te;Z++)_vector$7.fromBufferAttribute(this,Z),_vector$7.transformDirection(_),this.setXYZ(Z,_vector$7.x,_vector$7.y,_vector$7.z);return this}getComponent(_,Z){let te=this.array[_*this.data.stride+this.offset+Z];return this.normalized&&(te=denormalize(te,this.array)),te}setComponent(_,Z,te){return this.normalized&&(te=normalize$c(te,this.array)),this.data.array[_*this.data.stride+this.offset+Z]=te,this}setX(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.data.array[_*this.data.stride+this.offset]=Z,this}setY(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.data.array[_*this.data.stride+this.offset+1]=Z,this}setZ(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.data.array[_*this.data.stride+this.offset+2]=Z,this}setW(_,Z){return this.normalized&&(Z=normalize$c(Z,this.array)),this.data.array[_*this.data.stride+this.offset+3]=Z,this}getX(_){let Z=this.data.array[_*this.data.stride+this.offset];return this.normalized&&(Z=denormalize(Z,this.array)),Z}getY(_){let Z=this.data.array[_*this.data.stride+this.offset+1];return this.normalized&&(Z=denormalize(Z,this.array)),Z}getZ(_){let Z=this.data.array[_*this.data.stride+this.offset+2];return this.normalized&&(Z=denormalize(Z,this.array)),Z}getW(_){let Z=this.data.array[_*this.data.stride+this.offset+3];return this.normalized&&(Z=denormalize(Z,this.array)),Z}setXY(_,Z,te){return _=_*this.data.stride+this.offset,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array)),this.data.array[_+0]=Z,this.data.array[_+1]=te,this}setXYZ(_,Z,te,ne){return _=_*this.data.stride+this.offset,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array),ne=normalize$c(ne,this.array)),this.data.array[_+0]=Z,this.data.array[_+1]=te,this.data.array[_+2]=ne,this}setXYZW(_,Z,te,ne,ie){return _=_*this.data.stride+this.offset,this.normalized&&(Z=normalize$c(Z,this.array),te=normalize$c(te,this.array),ne=normalize$c(ne,this.array),ie=normalize$c(ie,this.array)),this.data.array[_+0]=Z,this.data.array[_+1]=te,this.data.array[_+2]=ne,this.data.array[_+3]=ie,this}clone(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const Z=[];for(let te=0;te<this.count;te++){const ne=te*this.data.stride+this.offset;for(let ie=0;ie<this.itemSize;ie++)Z.push(this.data.array[ne+ie])}return new BufferAttribute(new this.array.constructor(Z),this.itemSize,this.normalized)}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.clone(_)),new InterleavedBufferAttribute(_.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const Z=[];for(let te=0;te<this.count;te++){const ne=te*this.data.stride+this.offset;for(let ie=0;ie<this.itemSize;ie++)Z.push(this.data.array[ne+ie])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:Z,normalized:this.normalized}}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.toJSON(_)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.rotation=_.rotation,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}let _geometry$2;const _intersectPoint=new Vector3,_worldScale$2=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA$3=new Vector3,_vB$3=new Vector3,_vC$3=new Vector3,_uvA$2=new Vector2,_uvB$2=new Vector2,_uvC$2=new Vector2;class Sprite extends Object3D{constructor(_=new SpriteMaterial){if(super(),this.isSprite=!0,this.type="Sprite",_geometry$2===void 0){_geometry$2=new BufferGeometry;const Z=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),te=new InterleavedBuffer(Z,5);_geometry$2.setIndex([0,1,2,0,2,3]),_geometry$2.setAttribute("position",new InterleavedBufferAttribute(te,3,0,!1)),_geometry$2.setAttribute("uv",new InterleavedBufferAttribute(te,2,3,!1))}this.geometry=_geometry$2,this.material=_,this.center=new Vector2(.5,.5)}raycast(_,Z){_.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale$2.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale$2.multiplyScalar(-_mvPosition.z);const te=this.material.rotation;let ne,ie;te!==0&&(ie=Math.cos(te),ne=Math.sin(te));const oe=this.center;transformVertex(_vA$3.set(-.5,-.5,0),_mvPosition,oe,_worldScale$2,ne,ie),transformVertex(_vB$3.set(.5,-.5,0),_mvPosition,oe,_worldScale$2,ne,ie),transformVertex(_vC$3.set(.5,.5,0),_mvPosition,oe,_worldScale$2,ne,ie),_uvA$2.set(0,0),_uvB$2.set(1,0),_uvC$2.set(1,1);let se=_.ray.intersectTriangle(_vA$3,_vB$3,_vC$3,!1,_intersectPoint);if(se===null&&(transformVertex(_vB$3.set(-.5,.5,0),_mvPosition,oe,_worldScale$2,ne,ie),_uvB$2.set(0,1),se=_.ray.intersectTriangle(_vA$3,_vC$3,_vB$3,!1,_intersectPoint),se===null))return;const ae=_.ray.origin.distanceTo(_intersectPoint);ae<_.near||ae>_.far||Z.push({distance:ae,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA$3,_vB$3,_vC$3,_uvA$2,_uvB$2,_uvC$2,new Vector2),face:null,object:this})}copy(_,Z){return super.copy(_,Z),_.center!==void 0&&this.center.copy(_.center),this.material=_.material,this}}function transformVertex(K,_,Z,te,ne,ie){_alignedPosition.subVectors(K,Z).addScalar(.5).multiply(te),ne!==void 0?(_rotatedPosition.x=ie*_alignedPosition.x-ne*_alignedPosition.y,_rotatedPosition.y=ne*_alignedPosition.x+ie*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),K.copy(_),K.x+=_rotatedPosition.x,K.y+=_rotatedPosition.y,K.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(_){super.copy(_,!1);const Z=_.levels;for(let te=0,ne=Z.length;te<ne;te++){const ie=Z[te];this.addLevel(ie.object.clone(),ie.distance,ie.hysteresis)}return this.autoUpdate=_.autoUpdate,this}addLevel(_,Z=0,te=0){Z=Math.abs(Z);const ne=this.levels;let ie;for(ie=0;ie<ne.length&&!(Z<ne[ie].distance);ie++);return ne.splice(ie,0,{distance:Z,hysteresis:te,object:_}),this.add(_),this}removeLevel(_){const Z=this.levels;for(let te=0;te<Z.length;te++)if(Z[te].distance===_){const ne=Z.splice(te,1);return this.remove(ne[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_){const Z=this.levels;if(Z.length>0){let te,ne;for(te=1,ne=Z.length;te<ne;te++){let ie=Z[te].distance;if(Z[te].object.visible&&(ie-=ie*Z[te].hysteresis),_<ie)break}return Z[te-1].object}return null}raycast(_,Z){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const ne=_.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(ne).raycast(_,Z)}}update(_){const Z=this.levels;if(Z.length>1){_v1$2.setFromMatrixPosition(_.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const te=_v1$2.distanceTo(_v2$1)/_.zoom;Z[0].object.visible=!0;let ne,ie;for(ne=1,ie=Z.length;ne<ie;ne++){let oe=Z[ne].distance;if(Z[ne].object.visible&&(oe-=oe*Z[ne].hysteresis),te>=oe)Z[ne-1].object.visible=!1,Z[ne].object.visible=!0;else break}for(this._currentLevel=ne-1;ne<ie;ne++)Z[ne].object.visible=!1}}toJSON(_){const Z=super.toJSON(_);this.autoUpdate===!1&&(Z.object.autoUpdate=!1),Z.object.levels=[];const te=this.levels;for(let ne=0,ie=te.length;ne<ie;ne++){const oe=te[ne];Z.object.levels.push({object:oe.object.uuid,distance:oe.distance,hysteresis:oe.hysteresis})}return Z}}const _basePosition=new Vector3,_skinIndex$1=new Vector4,_skinWeight$1=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$5=new Sphere$2,_inverseMatrix$2=new Matrix4,_ray$2$1=new Ray;class SkinnedMesh extends Mesh{constructor(_,Z){super(_,Z),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const Z=_.getAttribute("position");for(let te=0;te<Z.count;te++)this.getVertexPosition(te,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere$2),this.boundingSphere.makeEmpty();const Z=_.getAttribute("position");for(let te=0;te<Z.count;te++)this.getVertexPosition(te,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_,Z){return super.copy(_,Z),this.bindMode=_.bindMode,this.bindMatrix.copy(_.bindMatrix),this.bindMatrixInverse.copy(_.bindMatrixInverse),this.skeleton=_.skeleton,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}raycast(_,Z){const te=this.material,ne=this.matrixWorld;te!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$5.copy(this.boundingSphere),_sphere$5.applyMatrix4(ne),_.ray.intersectsSphere(_sphere$5)!==!1&&(_inverseMatrix$2.copy(ne).invert(),_ray$2$1.copy(_.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2$1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_,Z,_ray$2$1)))}getVertexPosition(_,Z){return super.getVertexPosition(_,Z),this.applyBoneTransform(_,Z),Z}bind(_,Z){this.skeleton=_,Z===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),Z=this.matrixWorld),this.bindMatrix.copy(Z),this.bindMatrixInverse.copy(Z).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _=new Vector4,Z=this.geometry.attributes.skinWeight;for(let te=0,ne=Z.count;te<ne;te++){_.fromBufferAttribute(Z,te);const ie=1/_.manhattanLength();ie!==1/0?_.multiplyScalar(ie):_.set(1,0,0,0),Z.setXYZW(te,_.x,_.y,_.z,_.w)}}updateMatrixWorld(_){super.updateMatrixWorld(_),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_,Z){const te=this.skeleton,ne=this.geometry;_skinIndex$1.fromBufferAttribute(ne.attributes.skinIndex,_),_skinWeight$1.fromBufferAttribute(ne.attributes.skinWeight,_),_basePosition.copy(Z).applyMatrix4(this.bindMatrix),Z.set(0,0,0);for(let ie=0;ie<4;ie++){const oe=_skinWeight$1.getComponent(ie);if(oe!==0){const se=_skinIndex$1.getComponent(ie);_matrix4.multiplyMatrices(te.bones[se].matrixWorld,te.boneInverses[se]),Z.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),oe)}}return Z.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture$1{constructor(_=null,Z=1,te=1,ne,ie,oe,se,ae,le=NearestFilter,ce=NearestFilter,fe,de){super(null,oe,se,ae,le,ce,ne,ie,fe,de),this.isDataTexture=!0,this.image={data:_,width:Z,height:te},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$2=new Matrix4;class Skeleton{constructor(_=[],Z=[]){this.uuid=generateUUID$1(),this.bones=_.slice(0),this.boneInverses=Z,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const _=this.bones,Z=this.boneInverses;if(this.boneMatrices=new Float32Array(_.length*16),Z.length===0)this.calculateInverses();else if(_.length!==Z.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let te=0,ne=this.bones.length;te<ne;te++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _=0,Z=this.bones.length;_<Z;_++){const te=new Matrix4;this.bones[_]&&te.copy(this.bones[_].matrixWorld).invert(),this.boneInverses.push(te)}}pose(){for(let _=0,Z=this.bones.length;_<Z;_++){const te=this.bones[_];te&&te.matrixWorld.copy(this.boneInverses[_]).invert()}for(let _=0,Z=this.bones.length;_<Z;_++){const te=this.bones[_];te&&(te.parent&&te.parent.isBone?(te.matrix.copy(te.parent.matrixWorld).invert(),te.matrix.multiply(te.matrixWorld)):te.matrix.copy(te.matrixWorld),te.matrix.decompose(te.position,te.quaternion,te.scale))}}update(){const _=this.bones,Z=this.boneInverses,te=this.boneMatrices,ne=this.boneTexture;for(let ie=0,oe=_.length;ie<oe;ie++){const se=_[ie]?_[ie].matrixWorld:_identityMatrix$2;_offsetMatrix.multiplyMatrices(se,Z[ie]),_offsetMatrix.toArray(te,ie*16)}ne!==null&&(ne.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _=Math.sqrt(this.bones.length*4);_=Math.ceil(_/4)*4,_=Math.max(_,4);const Z=new Float32Array(_*_*4);Z.set(this.boneMatrices);const te=new DataTexture(Z,_,_,RGBAFormat,FloatType);return te.needsUpdate=!0,this.boneMatrices=Z,this.boneTexture=te,this}getBoneByName(_){for(let Z=0,te=this.bones.length;Z<te;Z++){const ne=this.bones[Z];if(ne.name===_)return ne}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_,Z){this.uuid=_.uuid;for(let te=0,ne=_.bones.length;te<ne;te++){const ie=_.bones[te];let oe=Z[ie];oe===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",ie),oe=new Bone),this.bones.push(oe),this.boneInverses.push(new Matrix4().fromArray(_.boneInverses[te]))}return this.init(),this}toJSON(){const _={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_.uuid=this.uuid;const Z=this.bones,te=this.boneInverses;for(let ne=0,ie=Z.length;ne<ie;ne++){const oe=Z[ne];_.bones.push(oe.uuid);const se=te[ne];_.boneInverses.push(se.toArray())}return _}}class InstancedBufferAttribute extends BufferAttribute{constructor(_,Z,te,ne=1){super(_,Z,te),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=ne}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}toJSON(){const _=super.toJSON();return _.meshPerAttribute=this.meshPerAttribute,_.isInstancedBufferAttribute=!0,_}}const _instanceLocalMatrix$1=new Matrix4,_instanceWorldMatrix$1=new Matrix4,_instanceIntersects$1=[],_box3=new Box3,_identity=new Matrix4,_mesh$1$1=new Mesh,_sphere$4=new Sphere$2;class InstancedMesh extends Mesh{constructor(_,Z,te){super(_,Z),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(te*16),16),this.instanceColor=null,this.morphTexture=null,this.count=te,this.boundingBox=null,this.boundingSphere=null;for(let ne=0;ne<te;ne++)this.setMatrixAt(ne,_identity)}computeBoundingBox(){const _=this.geometry,Z=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),_.boundingBox===null&&_.computeBoundingBox(),this.boundingBox.makeEmpty();for(let te=0;te<Z;te++)this.getMatrixAt(te,_instanceLocalMatrix$1),_box3.copy(_.boundingBox).applyMatrix4(_instanceLocalMatrix$1),this.boundingBox.union(_box3)}computeBoundingSphere(){const _=this.geometry,Z=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere$2),_.boundingSphere===null&&_.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let te=0;te<Z;te++)this.getMatrixAt(te,_instanceLocalMatrix$1),_sphere$4.copy(_.boundingSphere).applyMatrix4(_instanceLocalMatrix$1),this.boundingSphere.union(_sphere$4)}copy(_,Z){return super.copy(_,Z),this.instanceMatrix.copy(_.instanceMatrix),_.morphTexture!==null&&(this.morphTexture=_.morphTexture.clone()),_.instanceColor!==null&&(this.instanceColor=_.instanceColor.clone()),this.count=_.count,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}getColorAt(_,Z){Z.fromArray(this.instanceColor.array,_*3)}getMatrixAt(_,Z){Z.fromArray(this.instanceMatrix.array,_*16)}getMorphAt(_,Z){const te=Z.morphTargetInfluences,ne=this.morphTexture.source.data.data,ie=te.length+1,oe=_*ie+1;for(let se=0;se<te.length;se++)te[se]=ne[oe+se]}raycast(_,Z){const te=this.matrixWorld,ne=this.count;if(_mesh$1$1.geometry=this.geometry,_mesh$1$1.material=this.material,_mesh$1$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(te),_.ray.intersectsSphere(_sphere$4)!==!1))for(let ie=0;ie<ne;ie++){this.getMatrixAt(ie,_instanceLocalMatrix$1),_instanceWorldMatrix$1.multiplyMatrices(te,_instanceLocalMatrix$1),_mesh$1$1.matrixWorld=_instanceWorldMatrix$1,_mesh$1$1.raycast(_,_instanceIntersects$1);for(let oe=0,se=_instanceIntersects$1.length;oe<se;oe++){const ae=_instanceIntersects$1[oe];ae.instanceId=ie,ae.object=this,Z.push(ae)}_instanceIntersects$1.length=0}}setColorAt(_,Z){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),Z.toArray(this.instanceColor.array,_*3)}setMatrixAt(_,Z){Z.toArray(this.instanceMatrix.array,_*16)}setMorphAt(_,Z){const te=Z.morphTargetInfluences,ne=te.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture(new Float32Array(ne*this.count),ne,this.count,RedFormat,FloatType));const ie=this.morphTexture.source.data.data;let oe=0;for(let le=0;le<te.length;le++)oe+=te[le];const se=this.geometry.morphTargetsRelative?1:1-oe,ae=ne*_;ie[ae]=se,ie.set(te,ae+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;let Plane$2=class{constructor(_=new Vector3(1,0,0),Z=0){this.isPlane=!0,this.normal=_,this.constant=Z}set(_,Z){return this.normal.copy(_),this.constant=Z,this}setComponents(_,Z,te,ne){return this.normal.set(_,Z,te),this.constant=ne,this}setFromNormalAndCoplanarPoint(_,Z){return this.normal.copy(_),this.constant=-Z.dot(this.normal),this}setFromCoplanarPoints(_,Z,te){const ne=_vector1.subVectors(te,Z).cross(_vector2.subVectors(_,Z)).normalize();return this.setFromNormalAndCoplanarPoint(ne,_),this}copy(_){return this.normal.copy(_.normal),this.constant=_.constant,this}normalize(){const _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_){return this.normal.dot(_)+this.constant}distanceToSphere(_){return this.distanceToPoint(_.center)-_.radius}projectPoint(_,Z){return Z.copy(_).addScaledVector(this.normal,-this.distanceToPoint(_))}intersectLine(_,Z){const te=_.delta(_vector1),ne=this.normal.dot(te);if(ne===0)return this.distanceToPoint(_.start)===0?Z.copy(_.start):null;const ie=-(_.start.dot(this.normal)+this.constant)/ne;return ie<0||ie>1?null:Z.copy(_.start).addScaledVector(te,ie)}intersectsLine(_){const Z=this.distanceToPoint(_.start),te=this.distanceToPoint(_.end);return Z<0&&te>0||te<0&&Z>0}intersectsBox(_){return _.intersectsPlane(this)}intersectsSphere(_){return _.intersectsPlane(this)}coplanarPoint(_){return _.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_,Z){const te=Z||_normalMatrix.getNormalMatrix(_),ne=this.coplanarPoint(_vector1).applyMatrix4(_),ie=this.normal.applyMatrix3(te).normalize();return this.constant=-ne.dot(ie),this}translate(_){return this.constant-=_.dot(this.normal),this}equals(_){return _.normal.equals(this.normal)&&_.constant===this.constant}clone(){return new this.constructor().copy(this)}};const _sphere$3=new Sphere$2,_vector$6=new Vector3;let Frustum$1=class{constructor(_=new Plane$2,Z=new Plane$2,te=new Plane$2,ne=new Plane$2,ie=new Plane$2,oe=new Plane$2){this.planes=[_,Z,te,ne,ie,oe]}set(_,Z,te,ne,ie,oe){const se=this.planes;return se[0].copy(_),se[1].copy(Z),se[2].copy(te),se[3].copy(ne),se[4].copy(ie),se[5].copy(oe),this}copy(_){const Z=this.planes;for(let te=0;te<6;te++)Z[te].copy(_.planes[te]);return this}setFromProjectionMatrix(_,Z=WebGLCoordinateSystem){const te=this.planes,ne=_.elements,ie=ne[0],oe=ne[1],se=ne[2],ae=ne[3],le=ne[4],ce=ne[5],fe=ne[6],de=ne[7],pe=ne[8],he=ne[9],ge=ne[10],me=ne[11],Ae=ne[12],ye=ne[13],ve=ne[14],_e=ne[15];if(te[0].setComponents(ae-ie,de-le,me-pe,_e-Ae).normalize(),te[1].setComponents(ae+ie,de+le,me+pe,_e+Ae).normalize(),te[2].setComponents(ae+oe,de+ce,me+he,_e+ye).normalize(),te[3].setComponents(ae-oe,de-ce,me-he,_e-ye).normalize(),te[4].setComponents(ae-se,de-fe,me-ge,_e-ve).normalize(),Z===WebGLCoordinateSystem)te[5].setComponents(ae+se,de+fe,me+ge,_e+ve).normalize();else if(Z===WebGPUCoordinateSystem)te[5].setComponents(se,fe,ge,ve).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+Z);return this}intersectsObject(_){if(_.boundingSphere!==void 0)_.boundingSphere===null&&_.computeBoundingSphere(),_sphere$3.copy(_.boundingSphere).applyMatrix4(_.matrixWorld);else{const Z=_.geometry;Z.boundingSphere===null&&Z.computeBoundingSphere(),_sphere$3.copy(Z.boundingSphere).applyMatrix4(_.matrixWorld)}return this.intersectsSphere(_sphere$3)}intersectsSprite(_){return _sphere$3.center.set(0,0,0),_sphere$3.radius=.7071067811865476,_sphere$3.applyMatrix4(_.matrixWorld),this.intersectsSphere(_sphere$3)}intersectsSphere(_){const Z=this.planes,te=_.center,ne=-_.radius;for(let ie=0;ie<6;ie++)if(Z[ie].distanceToPoint(te)<ne)return!1;return!0}intersectsBox(_){const Z=this.planes;for(let te=0;te<6;te++){const ne=Z[te];if(_vector$6.x=ne.normal.x>0?_.max.x:_.min.x,_vector$6.y=ne.normal.y>0?_.max.y:_.min.y,_vector$6.z=ne.normal.z>0?_.max.z:_.min.z,ne.distanceToPoint(_vector$6)<0)return!1}return!0}containsPoint(_){const Z=this.planes;for(let te=0;te<6;te++)if(Z[te].distanceToPoint(_)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function ascIdSort(K,_){return K-_}function sortOpaque(K,_){return K.z-_.z}function sortTransparent(K,_){return _.z-K.z}class MultiDrawRenderList{constructor(){this.index=0,this.pool=[],this.list=[]}push(_,Z,te,ne){const ie=this.pool,oe=this.list;this.index>=ie.length&&ie.push({start:-1,count:-1,z:-1,index:-1});const se=ie[this.index];oe.push(se),this.index++,se.start=_,se.count=Z,se.z=te,se.index=ne}reset(){this.list.length=0,this.index=0}}const _matrix$1=new Matrix4,_whiteColor=new Color$1(1,1,1),_frustum=new Frustum$1,_box$1$1=new Box3,_sphere$2=new Sphere$2,_vector$5=new Vector3,_forward=new Vector3,_temp$1=new Vector3,_renderList=new MultiDrawRenderList,_mesh$3=new Mesh,_batchIntersects$2=[];function copyAttributeData(K,_,Z=0){const te=_.itemSize;if(K.isInterleavedBufferAttribute||K.array.constructor!==_.array.constructor){const ne=K.count;for(let ie=0;ie<ne;ie++)for(let oe=0;oe<te;oe++)_.setComponent(ie+Z,oe,K.getComponent(ie,oe))}else _.array.set(K.array,Z*te);_.needsUpdate=!0}function copyArrayContents(K,_){if(K.constructor!==_.constructor){const Z=Math.min(K.length,_.length);for(let te=0;te<Z;te++)_[te]=K[te]}else{const Z=Math.min(K.length,_.length);_.set(new K.constructor(K.buffer,0,Z))}}class BatchedMesh extends Mesh{constructor(_,Z,te=Z*2,ne){super(new BufferGeometry,ne),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=_,this._maxVertexCount=Z,this._maxIndexCount=te,this._multiDrawCounts=new Int32Array(_),this._multiDrawStarts=new Int32Array(_),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let _=Math.sqrt(this._maxInstanceCount*4);_=Math.ceil(_/4)*4,_=Math.max(_,4);const Z=new Float32Array(_*_*4),te=new DataTexture(Z,_,_,RGBAFormat,FloatType);this._matricesTexture=te}_initIndirectTexture(){let _=Math.sqrt(this._maxInstanceCount);_=Math.ceil(_);const Z=new Uint32Array(_*_),te=new DataTexture(Z,_,_,RedIntegerFormat,UnsignedIntType);this._indirectTexture=te}_initColorsTexture(){let _=Math.sqrt(this._maxInstanceCount);_=Math.ceil(_);const Z=new Float32Array(_*_*4).fill(1),te=new DataTexture(Z,_,_,RGBAFormat,FloatType);te.colorSpace=ColorManagement.workingColorSpace,this._colorsTexture=te}_initializeGeometry(_){const Z=this.geometry,te=this._maxVertexCount,ne=this._maxIndexCount;if(this._geometryInitialized===!1){for(const ie in _.attributes){const oe=_.getAttribute(ie),{array:se,itemSize:ae,normalized:le}=oe,ce=new se.constructor(te*ae),fe=new BufferAttribute(ce,ae,le);Z.setAttribute(ie,fe)}if(_.getIndex()!==null){const ie=te>65535?new Uint32Array(ne):new Uint16Array(ne);Z.setIndex(new BufferAttribute(ie,1))}this._geometryInitialized=!0}}_validateGeometry(_){const Z=this.geometry;if(!!_.getIndex()!=!!Z.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const te in Z.attributes){if(!_.hasAttribute(te))throw new Error(`THREE.BatchedMesh: Added geometry missing "${te}". All geometries must have consistent attributes.`);const ne=_.getAttribute(te),ie=Z.getAttribute(te);if(ne.itemSize!==ie.itemSize||ne.normalized!==ie.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(_){const Z=this._instanceInfo;if(_<0||_>=Z.length||Z[_].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${_}. Instance is either out of range or has been deleted.`)}validateGeometryId(_){const Z=this._geometryInfo;if(_<0||_>=Z.length||Z[_].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${_}. Geometry is either out of range or has been deleted.`)}setCustomSort(_){return this.customSort=_,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this.boundingBox,Z=this._instanceInfo;_.makeEmpty();for(let te=0,ne=Z.length;te<ne;te++){if(Z[te].active===!1)continue;const ie=Z[te].geometryIndex;this.getMatrixAt(te,_matrix$1),this.getBoundingBoxAt(ie,_box$1$1).applyMatrix4(_matrix$1),_.union(_box$1$1)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$2);const _=this.boundingSphere,Z=this._instanceInfo;_.makeEmpty();for(let te=0,ne=Z.length;te<ne;te++){if(Z[te].active===!1)continue;const ie=Z[te].geometryIndex;this.getMatrixAt(te,_matrix$1),this.getBoundingSphereAt(ie,_sphere$2).applyMatrix4(_matrix$1),_.union(_sphere$2)}}addInstance(_){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const te={visible:!0,active:!0,geometryIndex:_};let ne=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(ascIdSort),ne=this._availableInstanceIds.shift(),this._instanceInfo[ne]=te):(ne=this._instanceInfo.length,this._instanceInfo.push(te));const ie=this._matricesTexture;_matrix$1.identity().toArray(ie.image.data,ne*16),ie.needsUpdate=!0;const oe=this._colorsTexture;return oe&&(_whiteColor.toArray(oe.image.data,ne*4),oe.needsUpdate=!0),this._visibilityChanged=!0,ne}addGeometry(_,Z=-1,te=-1){this._initializeGeometry(_),this._validateGeometry(_);const ne={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},ie=this._geometryInfo;ne.vertexStart=this._nextVertexStart,ne.reservedVertexCount=Z===-1?_.getAttribute("position").count:Z;const oe=_.getIndex();if(oe!==null&&(ne.indexStart=this._nextIndexStart,ne.reservedIndexCount=te===-1?oe.count:te),ne.indexStart!==-1&&ne.indexStart+ne.reservedIndexCount>this._maxIndexCount||ne.vertexStart+ne.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let ae;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(ascIdSort),ae=this._availableGeometryIds.shift(),ie[ae]=ne):(ae=this._geometryCount,this._geometryCount++,ie.push(ne)),this.setGeometryAt(ae,_),this._nextIndexStart=ne.indexStart+ne.reservedIndexCount,this._nextVertexStart=ne.vertexStart+ne.reservedVertexCount,ae}setGeometryAt(_,Z){if(_>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(Z);const te=this.geometry,ne=te.getIndex()!==null,ie=te.getIndex(),oe=Z.getIndex(),se=this._geometryInfo[_];if(ne&&oe.count>se.reservedIndexCount||Z.attributes.position.count>se.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const ae=se.vertexStart,le=se.reservedVertexCount;se.vertexCount=Z.getAttribute("position").count;for(const ce in te.attributes){const fe=Z.getAttribute(ce),de=te.getAttribute(ce);copyAttributeData(fe,de,ae);const pe=fe.itemSize;for(let he=fe.count,ge=le;he<ge;he++){const me=ae+he;for(let Ae=0;Ae<pe;Ae++)de.setComponent(me,Ae,0)}de.needsUpdate=!0,de.addUpdateRange(ae*pe,le*pe)}if(ne){const ce=se.indexStart,fe=se.reservedIndexCount;se.indexCount=Z.getIndex().count;for(let de=0;de<oe.count;de++)ie.setX(ce+de,ae+oe.getX(de));for(let de=oe.count,pe=fe;de<pe;de++)ie.setX(ce+de,ae);ie.needsUpdate=!0,ie.addUpdateRange(ce,se.reservedIndexCount)}return se.start=ne?se.indexStart:se.vertexStart,se.count=ne?se.indexCount:se.vertexCount,se.boundingBox=null,Z.boundingBox!==null&&(se.boundingBox=Z.boundingBox.clone()),se.boundingSphere=null,Z.boundingSphere!==null&&(se.boundingSphere=Z.boundingSphere.clone()),this._visibilityChanged=!0,_}deleteGeometry(_){const Z=this._geometryInfo;if(_>=Z.length||Z[_].active===!1)return this;const te=this._instanceInfo;for(let ne=0,ie=te.length;ne<ie;ne++)te[ne].active&&te[ne].geometryIndex===_&&this.deleteInstance(ne);return Z[_].active=!1,this._availableGeometryIds.push(_),this._visibilityChanged=!0,this}deleteInstance(_){return this.validateInstanceId(_),this._instanceInfo[_].active=!1,this._availableInstanceIds.push(_),this._visibilityChanged=!0,this}optimize(){let _=0,Z=0;const te=this._geometryInfo,ne=te.map((oe,se)=>se).sort((oe,se)=>te[oe].vertexStart-te[se].vertexStart),ie=this.geometry;for(let oe=0,se=te.length;oe<se;oe++){const ae=ne[oe],le=te[ae];if(le.active!==!1){if(ie.index!==null){if(le.indexStart!==Z){const{indexStart:ce,vertexStart:fe,reservedIndexCount:de}=le,pe=ie.index,he=pe.array,ge=_-fe;for(let me=ce;me<ce+de;me++)he[me]=he[me]+ge;pe.array.copyWithin(Z,ce,ce+de),pe.addUpdateRange(Z,de),le.indexStart=Z}Z+=le.reservedIndexCount}if(le.vertexStart!==_){const{vertexStart:ce,reservedVertexCount:fe}=le,de=ie.attributes;for(const pe in de){const he=de[pe],{array:ge,itemSize:me}=he;ge.copyWithin(_*me,ce*me,(ce+fe)*me),he.addUpdateRange(_*me,fe*me)}le.vertexStart=_}_+=le.reservedVertexCount,le.start=ie.index?le.indexStart:le.vertexStart,this._nextIndexStart=ie.index?le.indexStart+le.reservedIndexCount:0,this._nextVertexStart=le.vertexStart+le.reservedVertexCount}}return this}getBoundingBoxAt(_,Z){if(_>=this._geometryCount)return null;const te=this.geometry,ne=this._geometryInfo[_];if(ne.boundingBox===null){const ie=new Box3,oe=te.index,se=te.attributes.position;for(let ae=ne.start,le=ne.start+ne.count;ae<le;ae++){let ce=ae;oe&&(ce=oe.getX(ce)),ie.expandByPoint(_vector$5.fromBufferAttribute(se,ce))}ne.boundingBox=ie}return Z.copy(ne.boundingBox),Z}getBoundingSphereAt(_,Z){if(_>=this._geometryCount)return null;const te=this.geometry,ne=this._geometryInfo[_];if(ne.boundingSphere===null){const ie=new Sphere$2;this.getBoundingBoxAt(_,_box$1$1),_box$1$1.getCenter(ie.center);const oe=te.index,se=te.attributes.position;let ae=0;for(let le=ne.start,ce=ne.start+ne.count;le<ce;le++){let fe=le;oe&&(fe=oe.getX(fe)),_vector$5.fromBufferAttribute(se,fe),ae=Math.max(ae,ie.center.distanceToSquared(_vector$5))}ie.radius=Math.sqrt(ae),ne.boundingSphere=ie}return Z.copy(ne.boundingSphere),Z}setMatrixAt(_,Z){this.validateInstanceId(_);const te=this._matricesTexture,ne=this._matricesTexture.image.data;return Z.toArray(ne,_*16),te.needsUpdate=!0,this}getMatrixAt(_,Z){return this.validateInstanceId(_),Z.fromArray(this._matricesTexture.image.data,_*16)}setColorAt(_,Z){return this.validateInstanceId(_),this._colorsTexture===null&&this._initColorsTexture(),Z.toArray(this._colorsTexture.image.data,_*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(_,Z){return this.validateInstanceId(_),Z.fromArray(this._colorsTexture.image.data,_*4)}setVisibleAt(_,Z){return this.validateInstanceId(_),this._instanceInfo[_].visible===Z?this:(this._instanceInfo[_].visible=Z,this._visibilityChanged=!0,this)}getVisibleAt(_){return this.validateInstanceId(_),this._instanceInfo[_].visible}setGeometryIdAt(_,Z){return this.validateInstanceId(_),this.validateGeometryId(Z),this._instanceInfo[_].geometryIndex=Z,this}getGeometryIdAt(_){return this.validateInstanceId(_),this._instanceInfo[_].geometryIndex}getGeometryRangeAt(_,Z={}){this.validateGeometryId(_);const te=this._geometryInfo[_];return Z.vertexStart=te.vertexStart,Z.vertexCount=te.vertexCount,Z.reservedVertexCount=te.reservedVertexCount,Z.indexStart=te.indexStart,Z.indexCount=te.indexCount,Z.reservedIndexCount=te.reservedIndexCount,Z.start=te.start,Z.count=te.count,Z}setInstanceCount(_){const Z=this._availableInstanceIds,te=this._instanceInfo;for(Z.sort(ascIdSort);Z[Z.length-1]===te.length;)te.pop(),Z.pop();if(_<te.length)throw new Error(`BatchedMesh: Instance ids outside the range ${_} are being used. Cannot shrink instance count.`);const ne=new Int32Array(_),ie=new Int32Array(_);copyArrayContents(this._multiDrawCounts,ne),copyArrayContents(this._multiDrawStarts,ie),this._multiDrawCounts=ne,this._multiDrawStarts=ie,this._maxInstanceCount=_;const oe=this._indirectTexture,se=this._matricesTexture,ae=this._colorsTexture;oe.dispose(),this._initIndirectTexture(),copyArrayContents(oe.image.data,this._indirectTexture.image.data),se.dispose(),this._initMatricesTexture(),copyArrayContents(se.image.data,this._matricesTexture.image.data),ae&&(ae.dispose(),this._initColorsTexture(),copyArrayContents(ae.image.data,this._colorsTexture.image.data))}setGeometrySize(_,Z){const te=[...this._geometryInfo].filter(se=>se.active);if(Math.max(...te.map(se=>se.vertexStart+se.reservedVertexCount))>_)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${Z}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...te.map(ae=>ae.indexStart+ae.reservedIndexCount))>Z)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${Z}. Cannot shrink further.`);const ie=this.geometry;ie.dispose(),this._maxVertexCount=_,this._maxIndexCount=Z,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new BufferGeometry,this._initializeGeometry(ie));const oe=this.geometry;ie.index&&copyArrayContents(ie.index.array,oe.index.array);for(const se in ie.attributes)copyArrayContents(ie.attributes[se].array,oe.attributes[se].array)}raycast(_,Z){const te=this._instanceInfo,ne=this._geometryInfo,ie=this.matrixWorld,oe=this.geometry;_mesh$3.material=this.material,_mesh$3.geometry.index=oe.index,_mesh$3.geometry.attributes=oe.attributes,_mesh$3.geometry.boundingBox===null&&(_mesh$3.geometry.boundingBox=new Box3),_mesh$3.geometry.boundingSphere===null&&(_mesh$3.geometry.boundingSphere=new Sphere$2);for(let se=0,ae=te.length;se<ae;se++){if(!te[se].visible||!te[se].active)continue;const le=te[se].geometryIndex,ce=ne[le];_mesh$3.geometry.setDrawRange(ce.start,ce.count),this.getMatrixAt(se,_mesh$3.matrixWorld).premultiply(ie),this.getBoundingBoxAt(le,_mesh$3.geometry.boundingBox),this.getBoundingSphereAt(le,_mesh$3.geometry.boundingSphere),_mesh$3.raycast(_,_batchIntersects$2);for(let fe=0,de=_batchIntersects$2.length;fe<de;fe++){const pe=_batchIntersects$2[fe];pe.object=this,pe.batchId=se,Z.push(pe)}_batchIntersects$2.length=0}_mesh$3.material=null,_mesh$3.geometry.index=null,_mesh$3.geometry.attributes={},_mesh$3.geometry.setDrawRange(0,1/0)}copy(_){return super.copy(_),this.geometry=_.geometry.clone(),this.perObjectFrustumCulled=_.perObjectFrustumCulled,this.sortObjects=_.sortObjects,this.boundingBox=_.boundingBox!==null?_.boundingBox.clone():null,this.boundingSphere=_.boundingSphere!==null?_.boundingSphere.clone():null,this._geometryInfo=_._geometryInfo.map(Z=>({...Z,boundingBox:Z.boundingBox!==null?Z.boundingBox.clone():null,boundingSphere:Z.boundingSphere!==null?Z.boundingSphere.clone():null})),this._instanceInfo=_._instanceInfo.map(Z=>({...Z})),this._maxInstanceCount=_._maxInstanceCount,this._maxVertexCount=_._maxVertexCount,this._maxIndexCount=_._maxIndexCount,this._geometryInitialized=_._geometryInitialized,this._geometryCount=_._geometryCount,this._multiDrawCounts=_._multiDrawCounts.slice(),this._multiDrawStarts=_._multiDrawStarts.slice(),this._matricesTexture=_._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=_._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(_,Z,te,ne,ie){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const oe=ne.getIndex(),se=oe===null?1:oe.array.BYTES_PER_ELEMENT,ae=this._instanceInfo,le=this._multiDrawStarts,ce=this._multiDrawCounts,fe=this._geometryInfo,de=this.perObjectFrustumCulled,pe=this._indirectTexture,he=pe.image.data;de&&(_matrix$1.multiplyMatrices(te.projectionMatrix,te.matrixWorldInverse).multiply(this.matrixWorld),_frustum.setFromProjectionMatrix(_matrix$1,_.coordinateSystem));let ge=0;if(this.sortObjects){_matrix$1.copy(this.matrixWorld).invert(),_vector$5.setFromMatrixPosition(te.matrixWorld).applyMatrix4(_matrix$1),_forward.set(0,0,-1).transformDirection(te.matrixWorld).transformDirection(_matrix$1);for(let ye=0,ve=ae.length;ye<ve;ye++)if(ae[ye].visible&&ae[ye].active){const _e=ae[ye].geometryIndex;this.getMatrixAt(ye,_matrix$1),this.getBoundingSphereAt(_e,_sphere$2).applyMatrix4(_matrix$1);let Te=!1;if(de&&(Te=!_frustum.intersectsSphere(_sphere$2)),!Te){const be=fe[_e],Re=_temp$1.subVectors(_sphere$2.center,_vector$5).dot(_forward);_renderList.push(be.start,be.count,Re,ye)}}const me=_renderList.list,Ae=this.customSort;Ae===null?me.sort(ie.transparent?sortTransparent:sortOpaque):Ae.call(this,me,te);for(let ye=0,ve=me.length;ye<ve;ye++){const _e=me[ye];le[ge]=_e.start*se,ce[ge]=_e.count,he[ge]=_e.index,ge++}_renderList.reset()}else for(let me=0,Ae=ae.length;me<Ae;me++)if(ae[me].visible&&ae[me].active){const ye=ae[me].geometryIndex;let ve=!1;if(de&&(this.getMatrixAt(me,_matrix$1),this.getBoundingSphereAt(ye,_sphere$2).applyMatrix4(_matrix$1),ve=!_frustum.intersectsSphere(_sphere$2)),!ve){const _e=fe[ye];le[ge]=_e.start*se,ce[ge]=_e.count,he[ge]=me,ge++}}pe.needsUpdate=!0,this._multiDrawCount=ge,this._visibilityChanged=!1}onBeforeShadow(_,Z,te,ne,ie,oe){this.onBeforeRender(_,null,ne,ie,oe)}}class LineBasicMaterial extends Material{constructor(_){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.linewidth=_.linewidth,this.linecap=_.linecap,this.linejoin=_.linejoin,this.fog=_.fog,this}}const _vStart=new Vector3,_vEnd=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1$1=new Ray,_sphere$1$1=new Sphere$2,_intersectPointOnRay=new Vector3,_intersectPointOnSegment=new Vector3;let Line$2=class extends Object3D{constructor(_=new BufferGeometry,Z=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_,this.material=Z,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(_,Z){return super.copy(_,Z),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}computeLineDistances(){const _=this.geometry;if(_.index===null){const Z=_.attributes.position,te=[0];for(let ne=1,ie=Z.count;ne<ie;ne++)_vStart.fromBufferAttribute(Z,ne-1),_vEnd.fromBufferAttribute(Z,ne),te[ne]=te[ne-1],te[ne]+=_vStart.distanceTo(_vEnd);_.setAttribute("lineDistance",new Float32BufferAttribute(te,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_,Z){const te=this.geometry,ne=this.matrixWorld,ie=_.params.Line.threshold,oe=te.drawRange;if(te.boundingSphere===null&&te.computeBoundingSphere(),_sphere$1$1.copy(te.boundingSphere),_sphere$1$1.applyMatrix4(ne),_sphere$1$1.radius+=ie,_.ray.intersectsSphere(_sphere$1$1)===!1)return;_inverseMatrix$1.copy(ne).invert(),_ray$1$1.copy(_.ray).applyMatrix4(_inverseMatrix$1);const se=ie/((this.scale.x+this.scale.y+this.scale.z)/3),ae=se*se,le=this.isLineSegments?2:1,ce=te.index,de=te.attributes.position;if(ce!==null){const pe=Math.max(0,oe.start),he=Math.min(ce.count,oe.start+oe.count);for(let ge=pe,me=he-1;ge<me;ge+=le){const Ae=ce.getX(ge),ye=ce.getX(ge+1),ve=checkIntersection$2(this,_,_ray$1$1,ae,Ae,ye,ge);ve&&Z.push(ve)}if(this.isLineLoop){const ge=ce.getX(he-1),me=ce.getX(pe),Ae=checkIntersection$2(this,_,_ray$1$1,ae,ge,me,he-1);Ae&&Z.push(Ae)}}else{const pe=Math.max(0,oe.start),he=Math.min(de.count,oe.start+oe.count);for(let ge=pe,me=he-1;ge<me;ge+=le){const Ae=checkIntersection$2(this,_,_ray$1$1,ae,ge,ge+1,ge);Ae&&Z.push(Ae)}if(this.isLineLoop){const ge=checkIntersection$2(this,_,_ray$1$1,ae,he-1,pe,he-1);ge&&Z.push(ge)}}}updateMorphTargets(){const Z=this.geometry.morphAttributes,te=Object.keys(Z);if(te.length>0){const ne=Z[te[0]];if(ne!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let ie=0,oe=ne.length;ie<oe;ie++){const se=ne[ie].name||String(ie);this.morphTargetInfluences.push(0),this.morphTargetDictionary[se]=ie}}}}};function checkIntersection$2(K,_,Z,te,ne,ie,oe){const se=K.geometry.attributes.position;if(_vStart.fromBufferAttribute(se,ne),_vEnd.fromBufferAttribute(se,ie),Z.distanceSqToSegment(_vStart,_vEnd,_intersectPointOnRay,_intersectPointOnSegment)>te)return;_intersectPointOnRay.applyMatrix4(K.matrixWorld);const le=_.ray.origin.distanceTo(_intersectPointOnRay);if(!(le<_.near||le>_.far))return{distance:le,point:_intersectPointOnSegment.clone().applyMatrix4(K.matrixWorld),index:oe,face:null,faceIndex:null,barycoord:null,object:K}}const _start$1=new Vector3,_end$1=new Vector3;class LineSegments extends Line$2{constructor(_,Z){super(_,Z),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _=this.geometry;if(_.index===null){const Z=_.attributes.position,te=[];for(let ne=0,ie=Z.count;ne<ie;ne+=2)_start$1.fromBufferAttribute(Z,ne),_end$1.fromBufferAttribute(Z,ne+1),te[ne]=ne===0?0:te[ne-1],te[ne+1]=te[ne]+_start$1.distanceTo(_end$1);_.setAttribute("lineDistance",new Float32BufferAttribute(te,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line$2{constructor(_,Z){super(_,Z),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.size=_.size,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}const _inverseMatrix$4=new Matrix4,_ray$4=new Ray,_sphere$7=new Sphere$2,_position$2=new Vector3;let Points$1=class extends Object3D{constructor(_=new BufferGeometry,Z=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_,this.material=Z,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(_,Z){return super.copy(_,Z),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}raycast(_,Z){const te=this.geometry,ne=this.matrixWorld,ie=_.params.Points.threshold,oe=te.drawRange;if(te.boundingSphere===null&&te.computeBoundingSphere(),_sphere$7.copy(te.boundingSphere),_sphere$7.applyMatrix4(ne),_sphere$7.radius+=ie,_.ray.intersectsSphere(_sphere$7)===!1)return;_inverseMatrix$4.copy(ne).invert(),_ray$4.copy(_.ray).applyMatrix4(_inverseMatrix$4);const se=ie/((this.scale.x+this.scale.y+this.scale.z)/3),ae=se*se,le=te.index,fe=te.attributes.position;if(le!==null){const de=Math.max(0,oe.start),pe=Math.min(le.count,oe.start+oe.count);for(let he=de,ge=pe;he<ge;he++){const me=le.getX(he);_position$2.fromBufferAttribute(fe,me),testPoint(_position$2,me,ae,ne,_,Z,this)}}else{const de=Math.max(0,oe.start),pe=Math.min(fe.count,oe.start+oe.count);for(let he=de,ge=pe;he<ge;he++)_position$2.fromBufferAttribute(fe,he),testPoint(_position$2,he,ae,ne,_,Z,this)}}updateMorphTargets(){const Z=this.geometry.morphAttributes,te=Object.keys(Z);if(te.length>0){const ne=Z[te[0]];if(ne!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let ie=0,oe=ne.length;ie<oe;ie++){const se=ne[ie].name||String(ie);this.morphTargetInfluences.push(0),this.morphTargetDictionary[se]=ie}}}}};function testPoint(K,_,Z,te,ne,ie,oe){const se=_ray$4.distanceSqToPoint(K);if(se<Z){const ae=new Vector3;_ray$4.closestPointToPoint(K,ae),ae.applyMatrix4(te);const le=ne.ray.origin.distanceTo(ae);if(le<ne.near||le>ne.far)return;ie.push({distance:le,distanceToRay:Math.sqrt(se),point:ae,index:_,face:null,faceIndex:null,barycoord:null,object:oe})}}class VideoTexture extends Texture$1{constructor(_,Z,te,ne,ie=LinearFilter,oe=LinearFilter,se,ae,le){super(_,Z,te,ne,ie,oe,se,ae,le),this.isVideoTexture=!0,this.generateMipmaps=!1;const ce=this;function fe(){ce.needsUpdate=!0,_.requestVideoFrameCallback(fe)}"requestVideoFrameCallback"in _&&_.requestVideoFrameCallback(fe)}clone(){return new this.constructor(this.image).copy(this)}update(){const _=this.image;"requestVideoFrameCallback"in _===!1&&_.readyState>=_.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class VideoFrameTexture extends VideoTexture{constructor(_,Z,te,ne,ie,oe,se,ae){super({},_,Z,te,ne,ie,oe,se,ae),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(_){this.image=_,this.needsUpdate=!0}}class FramebufferTexture extends Texture$1{constructor(_,Z){super({width:_,height:Z}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture$1{constructor(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de){super(null,oe,se,ae,le,ce,ne,ie,fe,de),this.isCompressedTexture=!0,this.image={width:Z,height:te},this.mipmaps=_,this.flipY=!1,this.generateMipmaps=!1}}let CompressedArrayTexture$1=class extends CompressedTexture{constructor(_,Z,te,ne,ie,oe){super(_,Z,te,ie,oe),this.isCompressedArrayTexture=!0,this.image.depth=ne,this.wrapR=ClampToEdgeWrapping,this.layerUpdates=new Set}addLayerUpdate(_){this.layerUpdates.add(_)}clearLayerUpdates(){this.layerUpdates.clear()}},CompressedCubeTexture$1=class extends CompressedTexture{constructor(_,Z,te){super(void 0,_[0].width,_[0].height,Z,te,CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=_}};class CanvasTexture extends Texture$1{constructor(_,Z,te,ne,ie,oe,se,ae,le){super(_,Z,te,ne,ie,oe,se,ae,le),this.isCanvasTexture=!0,this.needsUpdate=!0}}class DepthTexture extends Texture$1{constructor(_,Z,te=UnsignedIntType,ne,ie,oe,se=NearestFilter,ae=NearestFilter,le,ce=DepthFormat){if(ce!==DepthFormat&&ce!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,ne,ie,oe,se,ae,ce,te,le),this.isDepthTexture=!0,this.image={width:_,height:Z},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_){return super.copy(_),this.source=new Source(Object.assign({},_.image)),this.compareFunction=_.compareFunction,this}toJSON(_){const Z=super.toJSON(_);return this.compareFunction!==null&&(Z.compareFunction=this.compareFunction),Z}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(_,Z){const te=this.getUtoTmapping(_);return this.getPoint(te,Z)}getPoints(_=5){const Z=[];for(let te=0;te<=_;te++)Z.push(this.getPoint(te/_));return Z}getSpacedPoints(_=5){const Z=[];for(let te=0;te<=_;te++)Z.push(this.getPointAt(te/_));return Z}getLength(){const _=this.getLengths();return _[_.length-1]}getLengths(_=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const Z=[];let te,ne=this.getPoint(0),ie=0;Z.push(0);for(let oe=1;oe<=_;oe++)te=this.getPoint(oe/_),ie+=te.distanceTo(ne),Z.push(ie),ne=te;return this.cacheArcLengths=Z,Z}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_,Z=null){const te=this.getLengths();let ne=0;const ie=te.length;let oe;Z?oe=Z:oe=_*te[ie-1];let se=0,ae=ie-1,le;for(;se<=ae;)if(ne=Math.floor(se+(ae-se)/2),le=te[ne]-oe,le<0)se=ne+1;else if(le>0)ae=ne-1;else{ae=ne;break}if(ne=ae,te[ne]===oe)return ne/(ie-1);const ce=te[ne],de=te[ne+1]-ce,pe=(oe-ce)/de;return(ne+pe)/(ie-1)}getTangent(_,Z){let ne=_-1e-4,ie=_+1e-4;ne<0&&(ne=0),ie>1&&(ie=1);const oe=this.getPoint(ne),se=this.getPoint(ie),ae=Z||(oe.isVector2?new Vector2:new Vector3);return ae.copy(se).sub(oe).normalize(),ae}getTangentAt(_,Z){const te=this.getUtoTmapping(_);return this.getTangent(te,Z)}computeFrenetFrames(_,Z=!1){const te=new Vector3,ne=[],ie=[],oe=[],se=new Vector3,ae=new Matrix4;for(let pe=0;pe<=_;pe++){const he=pe/_;ne[pe]=this.getTangentAt(he,new Vector3)}ie[0]=new Vector3,oe[0]=new Vector3;let le=Number.MAX_VALUE;const ce=Math.abs(ne[0].x),fe=Math.abs(ne[0].y),de=Math.abs(ne[0].z);ce<=le&&(le=ce,te.set(1,0,0)),fe<=le&&(le=fe,te.set(0,1,0)),de<=le&&te.set(0,0,1),se.crossVectors(ne[0],te).normalize(),ie[0].crossVectors(ne[0],se),oe[0].crossVectors(ne[0],ie[0]);for(let pe=1;pe<=_;pe++){if(ie[pe]=ie[pe-1].clone(),oe[pe]=oe[pe-1].clone(),se.crossVectors(ne[pe-1],ne[pe]),se.length()>Number.EPSILON){se.normalize();const he=Math.acos(clamp$4(ne[pe-1].dot(ne[pe]),-1,1));ie[pe].applyMatrix4(ae.makeRotationAxis(se,he))}oe[pe].crossVectors(ne[pe],ie[pe])}if(Z===!0){let pe=Math.acos(clamp$4(ie[0].dot(ie[_]),-1,1));pe/=_,ne[0].dot(se.crossVectors(ie[0],ie[_]))>0&&(pe=-pe);for(let he=1;he<=_;he++)ie[he].applyMatrix4(ae.makeRotationAxis(ne[he],pe*he)),oe[he].crossVectors(ne[he],ie[he])}return{tangents:ne,normals:ie,binormals:oe}}clone(){return new this.constructor().copy(this)}copy(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}toJSON(){const _={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return _.arcLengthDivisions=this.arcLengthDivisions,_.type=this.type,_}fromJSON(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_=0,Z=0,te=1,ne=1,ie=0,oe=Math.PI*2,se=!1,ae=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_,this.aY=Z,this.xRadius=te,this.yRadius=ne,this.aStartAngle=ie,this.aEndAngle=oe,this.aClockwise=se,this.aRotation=ae}getPoint(_,Z=new Vector2){const te=Z,ne=Math.PI*2;let ie=this.aEndAngle-this.aStartAngle;const oe=Math.abs(ie)<Number.EPSILON;for(;ie<0;)ie+=ne;for(;ie>ne;)ie-=ne;ie<Number.EPSILON&&(oe?ie=0:ie=ne),this.aClockwise===!0&&!oe&&(ie===ne?ie=-ne:ie=ie-ne);const se=this.aStartAngle+_*ie;let ae=this.aX+this.xRadius*Math.cos(se),le=this.aY+this.yRadius*Math.sin(se);if(this.aRotation!==0){const ce=Math.cos(this.aRotation),fe=Math.sin(this.aRotation),de=ae-this.aX,pe=le-this.aY;ae=de*ce-pe*fe+this.aX,le=de*fe+pe*ce+this.aY}return te.set(ae,le)}copy(_){return super.copy(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}toJSON(){const _=super.toJSON();return _.aX=this.aX,_.aY=this.aY,_.xRadius=this.xRadius,_.yRadius=this.yRadius,_.aStartAngle=this.aStartAngle,_.aEndAngle=this.aEndAngle,_.aClockwise=this.aClockwise,_.aRotation=this.aRotation,_}fromJSON(_){return super.fromJSON(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_,Z,te,ne,ie,oe){super(_,Z,te,te,ne,ie,oe),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let K=0,_=0,Z=0,te=0;function ne(ie,oe,se,ae){K=ie,_=se,Z=-3*ie+3*oe-2*se-ae,te=2*ie-2*oe+se+ae}return{initCatmullRom:function(ie,oe,se,ae,le){ne(oe,se,le*(se-ie),le*(ae-oe))},initNonuniformCatmullRom:function(ie,oe,se,ae,le,ce,fe){let de=(oe-ie)/le-(se-ie)/(le+ce)+(se-oe)/ce,pe=(se-oe)/ce-(ae-oe)/(ce+fe)+(ae-se)/fe;de*=ce,pe*=ce,ne(oe,se,de,pe)},calc:function(ie){const oe=ie*ie,se=oe*ie;return K+_*ie+Z*oe+te*se}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_=[],Z=!1,te="centripetal",ne=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_,this.closed=Z,this.curveType=te,this.tension=ne}getPoint(_,Z=new Vector3){const te=Z,ne=this.points,ie=ne.length,oe=(ie-(this.closed?0:1))*_;let se=Math.floor(oe),ae=oe-se;this.closed?se+=se>0?0:(Math.floor(Math.abs(se)/ie)+1)*ie:ae===0&&se===ie-1&&(se=ie-2,ae=1);let le,ce;this.closed||se>0?le=ne[(se-1)%ie]:(tmp.subVectors(ne[0],ne[1]).add(ne[0]),le=tmp);const fe=ne[se%ie],de=ne[(se+1)%ie];if(this.closed||se+2<ie?ce=ne[(se+2)%ie]:(tmp.subVectors(ne[ie-1],ne[ie-2]).add(ne[ie-1]),ce=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const pe=this.curveType==="chordal"?.5:.25;let he=Math.pow(le.distanceToSquared(fe),pe),ge=Math.pow(fe.distanceToSquared(de),pe),me=Math.pow(de.distanceToSquared(ce),pe);ge<1e-4&&(ge=1),he<1e-4&&(he=ge),me<1e-4&&(me=ge),px.initNonuniformCatmullRom(le.x,fe.x,de.x,ce.x,he,ge,me),py.initNonuniformCatmullRom(le.y,fe.y,de.y,ce.y,he,ge,me),pz.initNonuniformCatmullRom(le.z,fe.z,de.z,ce.z,he,ge,me)}else this.curveType==="catmullrom"&&(px.initCatmullRom(le.x,fe.x,de.x,ce.x,this.tension),py.initCatmullRom(le.y,fe.y,de.y,ce.y,this.tension),pz.initCatmullRom(le.z,fe.z,de.z,ce.z,this.tension));return te.set(px.calc(ae),py.calc(ae),pz.calc(ae)),te}copy(_){super.copy(_),this.points=[];for(let Z=0,te=_.points.length;Z<te;Z++){const ne=_.points[Z];this.points.push(ne.clone())}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}toJSON(){const _=super.toJSON();_.points=[];for(let Z=0,te=this.points.length;Z<te;Z++){const ne=this.points[Z];_.points.push(ne.toArray())}return _.closed=this.closed,_.curveType=this.curveType,_.tension=this.tension,_}fromJSON(_){super.fromJSON(_),this.points=[];for(let Z=0,te=_.points.length;Z<te;Z++){const ne=_.points[Z];this.points.push(new Vector3().fromArray(ne))}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}}function CatmullRom(K,_,Z,te,ne){const ie=(te-_)*.5,oe=(ne-Z)*.5,se=K*K,ae=K*se;return(2*Z-2*te+ie+oe)*ae+(-3*Z+3*te-2*ie-oe)*se+ie*K+Z}function QuadraticBezierP0(K,_){const Z=1-K;return Z*Z*_}function QuadraticBezierP1(K,_){return 2*(1-K)*K*_}function QuadraticBezierP2(K,_){return K*K*_}function QuadraticBezier(K,_,Z,te){return QuadraticBezierP0(K,_)+QuadraticBezierP1(K,Z)+QuadraticBezierP2(K,te)}function CubicBezierP0(K,_){const Z=1-K;return Z*Z*Z*_}function CubicBezierP1(K,_){const Z=1-K;return 3*Z*Z*K*_}function CubicBezierP2(K,_){return 3*(1-K)*K*K*_}function CubicBezierP3(K,_){return K*K*K*_}function CubicBezier(K,_,Z,te,ne){return CubicBezierP0(K,_)+CubicBezierP1(K,Z)+CubicBezierP2(K,te)+CubicBezierP3(K,ne)}class CubicBezierCurve extends Curve{constructor(_=new Vector2,Z=new Vector2,te=new Vector2,ne=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_,this.v1=Z,this.v2=te,this.v3=ne}getPoint(_,Z=new Vector2){const te=Z,ne=this.v0,ie=this.v1,oe=this.v2,se=this.v3;return te.set(CubicBezier(_,ne.x,ie.x,oe.x,se.x),CubicBezier(_,ne.y,ie.y,oe.y,se.y)),te}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_=new Vector3,Z=new Vector3,te=new Vector3,ne=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_,this.v1=Z,this.v2=te,this.v3=ne}getPoint(_,Z=new Vector3){const te=Z,ne=this.v0,ie=this.v1,oe=this.v2,se=this.v3;return te.set(CubicBezier(_,ne.x,ie.x,oe.x,se.x),CubicBezier(_,ne.y,ie.y,oe.y,se.y),CubicBezier(_,ne.z,ie.z,oe.z,se.z)),te}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class LineCurve extends Curve{constructor(_=new Vector2,Z=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_,this.v2=Z}getPoint(_,Z=new Vector2){const te=Z;return _===1?te.copy(this.v2):(te.copy(this.v2).sub(this.v1),te.multiplyScalar(_).add(this.v1)),te}getPointAt(_,Z){return this.getPoint(_,Z)}getTangent(_,Z=new Vector2){return Z.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,Z){return this.getTangent(_,Z)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class LineCurve3 extends Curve{constructor(_=new Vector3,Z=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_,this.v2=Z}getPoint(_,Z=new Vector3){const te=Z;return _===1?te.copy(this.v2):(te.copy(this.v2).sub(this.v1),te.multiplyScalar(_).add(this.v1)),te}getPointAt(_,Z){return this.getPoint(_,Z)}getTangent(_,Z=new Vector3){return Z.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,Z){return this.getTangent(_,Z)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_=new Vector2,Z=new Vector2,te=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_,this.v1=Z,this.v2=te}getPoint(_,Z=new Vector2){const te=Z,ne=this.v0,ie=this.v1,oe=this.v2;return te.set(QuadraticBezier(_,ne.x,ie.x,oe.x),QuadraticBezier(_,ne.y,ie.y,oe.y)),te}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_=new Vector3,Z=new Vector3,te=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_,this.v1=Z,this.v2=te}getPoint(_,Z=new Vector3){const te=Z,ne=this.v0,ie=this.v1,oe=this.v2;return te.set(QuadraticBezier(_,ne.x,ie.x,oe.x),QuadraticBezier(_,ne.y,ie.y,oe.y),QuadraticBezier(_,ne.z,ie.z,oe.z)),te}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class SplineCurve extends Curve{constructor(_=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_}getPoint(_,Z=new Vector2){const te=Z,ne=this.points,ie=(ne.length-1)*_,oe=Math.floor(ie),se=ie-oe,ae=ne[oe===0?oe:oe-1],le=ne[oe],ce=ne[oe>ne.length-2?ne.length-1:oe+1],fe=ne[oe>ne.length-3?ne.length-1:oe+2];return te.set(CatmullRom(se,ae.x,le.x,ce.x,fe.x),CatmullRom(se,ae.y,le.y,ce.y,fe.y)),te}copy(_){super.copy(_),this.points=[];for(let Z=0,te=_.points.length;Z<te;Z++){const ne=_.points[Z];this.points.push(ne.clone())}return this}toJSON(){const _=super.toJSON();_.points=[];for(let Z=0,te=this.points.length;Z<te;Z++){const ne=this.points[Z];_.points.push(ne.toArray())}return _}fromJSON(_){super.fromJSON(_),this.points=[];for(let Z=0,te=_.points.length;Z<te;Z++){const ne=_.points[Z];this.points.push(new Vector2().fromArray(ne))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_){this.curves.push(_)}closePath(){const _=this.curves[0].getPoint(0),Z=this.curves[this.curves.length-1].getPoint(1);if(!_.equals(Z)){const te=_.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Curves[te](Z,_))}return this}getPoint(_,Z){const te=_*this.getLength(),ne=this.getCurveLengths();let ie=0;for(;ie<ne.length;){if(ne[ie]>=te){const oe=ne[ie]-te,se=this.curves[ie],ae=se.getLength(),le=ae===0?0:1-oe/ae;return se.getPointAt(le,Z)}ie++}return null}getLength(){const _=this.getCurveLengths();return _[_.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _=[];let Z=0;for(let te=0,ne=this.curves.length;te<ne;te++)Z+=this.curves[te].getLength(),_.push(Z);return this.cacheLengths=_,_}getSpacedPoints(_=40){const Z=[];for(let te=0;te<=_;te++)Z.push(this.getPoint(te/_));return this.autoClose&&Z.push(Z[0]),Z}getPoints(_=12){const Z=[];let te;for(let ne=0,ie=this.curves;ne<ie.length;ne++){const oe=ie[ne],se=oe.isEllipseCurve?_*2:oe.isLineCurve||oe.isLineCurve3?1:oe.isSplineCurve?_*oe.points.length:_,ae=oe.getPoints(se);for(let le=0;le<ae.length;le++){const ce=ae[le];te&&te.equals(ce)||(Z.push(ce),te=ce)}}return this.autoClose&&Z.length>1&&!Z[Z.length-1].equals(Z[0])&&Z.push(Z[0]),Z}copy(_){super.copy(_),this.curves=[];for(let Z=0,te=_.curves.length;Z<te;Z++){const ne=_.curves[Z];this.curves.push(ne.clone())}return this.autoClose=_.autoClose,this}toJSON(){const _=super.toJSON();_.autoClose=this.autoClose,_.curves=[];for(let Z=0,te=this.curves.length;Z<te;Z++){const ne=this.curves[Z];_.curves.push(ne.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.autoClose=_.autoClose,this.curves=[];for(let Z=0,te=_.curves.length;Z<te;Z++){const ne=_.curves[Z];this.curves.push(new Curves[ne.type]().fromJSON(ne))}return this}}class Path extends CurvePath{constructor(_){super(),this.type="Path",this.currentPoint=new Vector2,_&&this.setFromPoints(_)}setFromPoints(_){this.moveTo(_[0].x,_[0].y);for(let Z=1,te=_.length;Z<te;Z++)this.lineTo(_[Z].x,_[Z].y);return this}moveTo(_,Z){return this.currentPoint.set(_,Z),this}lineTo(_,Z){const te=new LineCurve(this.currentPoint.clone(),new Vector2(_,Z));return this.curves.push(te),this.currentPoint.set(_,Z),this}quadraticCurveTo(_,Z,te,ne){const ie=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(_,Z),new Vector2(te,ne));return this.curves.push(ie),this.currentPoint.set(te,ne),this}bezierCurveTo(_,Z,te,ne,ie,oe){const se=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(_,Z),new Vector2(te,ne),new Vector2(ie,oe));return this.curves.push(se),this.currentPoint.set(ie,oe),this}splineThru(_){const Z=[this.currentPoint.clone()].concat(_),te=new SplineCurve(Z);return this.curves.push(te),this.currentPoint.copy(_[_.length-1]),this}arc(_,Z,te,ne,ie,oe){const se=this.currentPoint.x,ae=this.currentPoint.y;return this.absarc(_+se,Z+ae,te,ne,ie,oe),this}absarc(_,Z,te,ne,ie,oe){return this.absellipse(_,Z,te,te,ne,ie,oe),this}ellipse(_,Z,te,ne,ie,oe,se,ae){const le=this.currentPoint.x,ce=this.currentPoint.y;return this.absellipse(_+le,Z+ce,te,ne,ie,oe,se,ae),this}absellipse(_,Z,te,ne,ie,oe,se,ae){const le=new EllipseCurve(_,Z,te,ne,ie,oe,se,ae);if(this.curves.length>0){const fe=le.getPoint(0);fe.equals(this.currentPoint)||this.lineTo(fe.x,fe.y)}this.curves.push(le);const ce=le.getPoint(1);return this.currentPoint.copy(ce),this}copy(_){return super.copy(_),this.currentPoint.copy(_.currentPoint),this}toJSON(){const _=super.toJSON();return _.currentPoint=this.currentPoint.toArray(),_}fromJSON(_){return super.fromJSON(_),this.currentPoint.fromArray(_.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(_=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],Z=12,te=0,ne=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_,segments:Z,phiStart:te,phiLength:ne},Z=Math.floor(Z),ne=clamp$4(ne,0,Math.PI*2);const ie=[],oe=[],se=[],ae=[],le=[],ce=1/Z,fe=new Vector3,de=new Vector2,pe=new Vector3,he=new Vector3,ge=new Vector3;let me=0,Ae=0;for(let ye=0;ye<=_.length-1;ye++)switch(ye){case 0:me=_[ye+1].x-_[ye].x,Ae=_[ye+1].y-_[ye].y,pe.x=Ae*1,pe.y=-me,pe.z=Ae*0,ge.copy(pe),pe.normalize(),ae.push(pe.x,pe.y,pe.z);break;case _.length-1:ae.push(ge.x,ge.y,ge.z);break;default:me=_[ye+1].x-_[ye].x,Ae=_[ye+1].y-_[ye].y,pe.x=Ae*1,pe.y=-me,pe.z=Ae*0,he.copy(pe),pe.x+=ge.x,pe.y+=ge.y,pe.z+=ge.z,pe.normalize(),ae.push(pe.x,pe.y,pe.z),ge.copy(he)}for(let ye=0;ye<=Z;ye++){const ve=te+ye*ce*ne,_e=Math.sin(ve),Te=Math.cos(ve);for(let be=0;be<=_.length-1;be++){fe.x=_[be].x*_e,fe.y=_[be].y,fe.z=_[be].x*Te,oe.push(fe.x,fe.y,fe.z),de.x=ye/Z,de.y=be/(_.length-1),se.push(de.x,de.y);const Re=ae[3*be+0]*_e,we=ae[3*be+1],Pe=ae[3*be+0]*Te;le.push(Re,we,Pe)}}for(let ye=0;ye<Z;ye++)for(let ve=0;ve<_.length-1;ve++){const _e=ve+ye*_.length,Te=_e,be=_e+_.length,Re=_e+_.length+1,we=_e+1;ie.push(Te,be,we),ie.push(Re,we,be)}this.setIndex(ie),this.setAttribute("position",new Float32BufferAttribute(oe,3)),this.setAttribute("uv",new Float32BufferAttribute(se,2)),this.setAttribute("normal",new Float32BufferAttribute(le,3))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new LatheGeometry(_.points,_.segments,_.phiStart,_.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_=1,Z=1,te=4,ne=8){const ie=new Path;ie.absarc(0,-Z/2,_,Math.PI*1.5,0),ie.absarc(0,Z/2,_,0,Math.PI*.5),super(ie.getPoints(te),ne),this.type="CapsuleGeometry",this.parameters={radius:_,length:Z,capSegments:te,radialSegments:ne}}static fromJSON(_){return new CapsuleGeometry(_.radius,_.length,_.capSegments,_.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(_=1,Z=32,te=0,ne=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_,segments:Z,thetaStart:te,thetaLength:ne},Z=Math.max(3,Z);const ie=[],oe=[],se=[],ae=[],le=new Vector3,ce=new Vector2;oe.push(0,0,0),se.push(0,0,1),ae.push(.5,.5);for(let fe=0,de=3;fe<=Z;fe++,de+=3){const pe=te+fe/Z*ne;le.x=_*Math.cos(pe),le.y=_*Math.sin(pe),oe.push(le.x,le.y,le.z),se.push(0,0,1),ce.x=(oe[de]/_+1)/2,ce.y=(oe[de+1]/_+1)/2,ae.push(ce.x,ce.y)}for(let fe=1;fe<=Z;fe++)ie.push(fe,fe+1,0);this.setIndex(ie),this.setAttribute("position",new Float32BufferAttribute(oe,3)),this.setAttribute("normal",new Float32BufferAttribute(se,3)),this.setAttribute("uv",new Float32BufferAttribute(ae,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CircleGeometry(_.radius,_.segments,_.thetaStart,_.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(_=1,Z=1,te=1,ne=32,ie=1,oe=!1,se=0,ae=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_,radiusBottom:Z,height:te,radialSegments:ne,heightSegments:ie,openEnded:oe,thetaStart:se,thetaLength:ae};const le=this;ne=Math.floor(ne),ie=Math.floor(ie);const ce=[],fe=[],de=[],pe=[];let he=0;const ge=[],me=te/2;let Ae=0;ye(),oe===!1&&(_>0&&ve(!0),Z>0&&ve(!1)),this.setIndex(ce),this.setAttribute("position",new Float32BufferAttribute(fe,3)),this.setAttribute("normal",new Float32BufferAttribute(de,3)),this.setAttribute("uv",new Float32BufferAttribute(pe,2));function ye(){const _e=new Vector3,Te=new Vector3;let be=0;const Re=(Z-_)/te;for(let we=0;we<=ie;we++){const Pe=[],Ie=we/ie,$e=Ie*(Z-_)+_;for(let Ue=0;Ue<=ne;Ue++){const ke=Ue/ne,Ge=ke*ae+se,He=Math.sin(Ge),ze=Math.cos(Ge);Te.x=$e*He,Te.y=-Ie*te+me,Te.z=$e*ze,fe.push(Te.x,Te.y,Te.z),_e.set(He,Re,ze).normalize(),de.push(_e.x,_e.y,_e.z),pe.push(ke,1-Ie),Pe.push(he++)}ge.push(Pe)}for(let we=0;we<ne;we++)for(let Pe=0;Pe<ie;Pe++){const Ie=ge[Pe][we],$e=ge[Pe+1][we],Ue=ge[Pe+1][we+1],ke=ge[Pe][we+1];(_>0||Pe!==0)&&(ce.push(Ie,$e,ke),be+=3),(Z>0||Pe!==ie-1)&&(ce.push($e,Ue,ke),be+=3)}le.addGroup(Ae,be,0),Ae+=be}function ve(_e){const Te=he,be=new Vector2,Re=new Vector3;let we=0;const Pe=_e===!0?_:Z,Ie=_e===!0?1:-1;for(let Ue=1;Ue<=ne;Ue++)fe.push(0,me*Ie,0),de.push(0,Ie,0),pe.push(.5,.5),he++;const $e=he;for(let Ue=0;Ue<=ne;Ue++){const Ge=Ue/ne*ae+se,He=Math.cos(Ge),ze=Math.sin(Ge);Re.x=Pe*ze,Re.y=me*Ie,Re.z=Pe*He,fe.push(Re.x,Re.y,Re.z),de.push(0,Ie,0),be.x=He*.5+.5,be.y=ze*.5*Ie+.5,pe.push(be.x,be.y),he++}for(let Ue=0;Ue<ne;Ue++){const ke=Te+Ue,Ge=$e+Ue;_e===!0?ce.push(Ge,Ge+1,ke):ce.push(Ge+1,Ge,ke),we+=3}le.addGroup(Ae,we,_e===!0?1:2),Ae+=we}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CylinderGeometry(_.radiusTop,_.radiusBottom,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_=1,Z=1,te=32,ne=1,ie=!1,oe=0,se=Math.PI*2){super(0,_,Z,te,ne,ie,oe,se),this.type="ConeGeometry",this.parameters={radius:_,height:Z,radialSegments:te,heightSegments:ne,openEnded:ie,thetaStart:oe,thetaLength:se}}static fromJSON(_){return new ConeGeometry(_.radius,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(_=[],Z=[],te=1,ne=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_,indices:Z,radius:te,detail:ne};const ie=[],oe=[];se(ne),le(te),ce(),this.setAttribute("position",new Float32BufferAttribute(ie,3)),this.setAttribute("normal",new Float32BufferAttribute(ie.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(oe,2)),ne===0?this.computeVertexNormals():this.normalizeNormals();function se(ye){const ve=new Vector3,_e=new Vector3,Te=new Vector3;for(let be=0;be<Z.length;be+=3)pe(Z[be+0],ve),pe(Z[be+1],_e),pe(Z[be+2],Te),ae(ve,_e,Te,ye)}function ae(ye,ve,_e,Te){const be=Te+1,Re=[];for(let we=0;we<=be;we++){Re[we]=[];const Pe=ye.clone().lerp(_e,we/be),Ie=ve.clone().lerp(_e,we/be),$e=be-we;for(let Ue=0;Ue<=$e;Ue++)Ue===0&&we===be?Re[we][Ue]=Pe:Re[we][Ue]=Pe.clone().lerp(Ie,Ue/$e)}for(let we=0;we<be;we++)for(let Pe=0;Pe<2*(be-we)-1;Pe++){const Ie=Math.floor(Pe/2);Pe%2===0?(de(Re[we][Ie+1]),de(Re[we+1][Ie]),de(Re[we][Ie])):(de(Re[we][Ie+1]),de(Re[we+1][Ie+1]),de(Re[we+1][Ie]))}}function le(ye){const ve=new Vector3;for(let _e=0;_e<ie.length;_e+=3)ve.x=ie[_e+0],ve.y=ie[_e+1],ve.z=ie[_e+2],ve.normalize().multiplyScalar(ye),ie[_e+0]=ve.x,ie[_e+1]=ve.y,ie[_e+2]=ve.z}function ce(){const ye=new Vector3;for(let ve=0;ve<ie.length;ve+=3){ye.x=ie[ve+0],ye.y=ie[ve+1],ye.z=ie[ve+2];const _e=me(ye)/2/Math.PI+.5,Te=Ae(ye)/Math.PI+.5;oe.push(_e,1-Te)}he(),fe()}function fe(){for(let ye=0;ye<oe.length;ye+=6){const ve=oe[ye+0],_e=oe[ye+2],Te=oe[ye+4],be=Math.max(ve,_e,Te),Re=Math.min(ve,_e,Te);be>.9&&Re<.1&&(ve<.2&&(oe[ye+0]+=1),_e<.2&&(oe[ye+2]+=1),Te<.2&&(oe[ye+4]+=1))}}function de(ye){ie.push(ye.x,ye.y,ye.z)}function pe(ye,ve){const _e=ye*3;ve.x=_[_e+0],ve.y=_[_e+1],ve.z=_[_e+2]}function he(){const ye=new Vector3,ve=new Vector3,_e=new Vector3,Te=new Vector3,be=new Vector2,Re=new Vector2,we=new Vector2;for(let Pe=0,Ie=0;Pe<ie.length;Pe+=9,Ie+=6){ye.set(ie[Pe+0],ie[Pe+1],ie[Pe+2]),ve.set(ie[Pe+3],ie[Pe+4],ie[Pe+5]),_e.set(ie[Pe+6],ie[Pe+7],ie[Pe+8]),be.set(oe[Ie+0],oe[Ie+1]),Re.set(oe[Ie+2],oe[Ie+3]),we.set(oe[Ie+4],oe[Ie+5]),Te.copy(ye).add(ve).add(_e).divideScalar(3);const $e=me(Te);ge(be,Ie+0,ye,$e),ge(Re,Ie+2,ve,$e),ge(we,Ie+4,_e,$e)}}function ge(ye,ve,_e,Te){Te<0&&ye.x===1&&(oe[ve]=ye.x-1),_e.x===0&&_e.z===0&&(oe[ve]=Te/2/Math.PI+.5)}function me(ye){return Math.atan2(ye.z,-ye.x)}function Ae(ye){return Math.atan2(-ye.y,Math.sqrt(ye.x*ye.x+ye.z*ye.z))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PolyhedronGeometry(_.vertices,_.indices,_.radius,_.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_=1,Z=0){const te=(1+Math.sqrt(5))/2,ne=1/te,ie=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-ne,-te,0,-ne,te,0,ne,-te,0,ne,te,-ne,-te,0,-ne,te,0,ne,-te,0,ne,te,0,-te,0,-ne,te,0,-ne,-te,0,ne,te,0,ne],oe=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(ie,oe,_,Z),this.type="DodecahedronGeometry",this.parameters={radius:_,detail:Z}}static fromJSON(_){return new DodecahedronGeometry(_.radius,_.detail)}}const _v0$3=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(_=null,Z=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_,thresholdAngle:Z},_!==null){const ne=Math.pow(10,4),ie=Math.cos(DEG2RAD*Z),oe=_.getIndex(),se=_.getAttribute("position"),ae=oe?oe.count:se.count,le=[0,0,0],ce=["a","b","c"],fe=new Array(3),de={},pe=[];for(let he=0;he<ae;he+=3){oe?(le[0]=oe.getX(he),le[1]=oe.getX(he+1),le[2]=oe.getX(he+2)):(le[0]=he,le[1]=he+1,le[2]=he+2);const{a:ge,b:me,c:Ae}=_triangle;if(ge.fromBufferAttribute(se,le[0]),me.fromBufferAttribute(se,le[1]),Ae.fromBufferAttribute(se,le[2]),_triangle.getNormal(_normal),fe[0]=`${Math.round(ge.x*ne)},${Math.round(ge.y*ne)},${Math.round(ge.z*ne)}`,fe[1]=`${Math.round(me.x*ne)},${Math.round(me.y*ne)},${Math.round(me.z*ne)}`,fe[2]=`${Math.round(Ae.x*ne)},${Math.round(Ae.y*ne)},${Math.round(Ae.z*ne)}`,!(fe[0]===fe[1]||fe[1]===fe[2]||fe[2]===fe[0]))for(let ye=0;ye<3;ye++){const ve=(ye+1)%3,_e=fe[ye],Te=fe[ve],be=_triangle[ce[ye]],Re=_triangle[ce[ve]],we=`${_e}_${Te}`,Pe=`${Te}_${_e}`;Pe in de&&de[Pe]?(_normal.dot(de[Pe].normal)<=ie&&(pe.push(be.x,be.y,be.z),pe.push(Re.x,Re.y,Re.z)),de[Pe]=null):we in de||(de[we]={index0:le[ye],index1:le[ve],normal:_normal.clone()})}}for(const he in de)if(de[he]){const{index0:ge,index1:me}=de[he];_v0$3.fromBufferAttribute(se,ge),_v1$1.fromBufferAttribute(se,me),pe.push(_v0$3.x,_v0$3.y,_v0$3.z),pe.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(pe,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}let Shape$2=class extends Path{constructor(_){super(_),this.uuid=generateUUID$1(),this.type="Shape",this.holes=[]}getPointsHoles(_){const Z=[];for(let te=0,ne=this.holes.length;te<ne;te++)Z[te]=this.holes[te].getPoints(_);return Z}extractPoints(_){return{shape:this.getPoints(_),holes:this.getPointsHoles(_)}}copy(_){super.copy(_),this.holes=[];for(let Z=0,te=_.holes.length;Z<te;Z++){const ne=_.holes[Z];this.holes.push(ne.clone())}return this}toJSON(){const _=super.toJSON();_.uuid=this.uuid,_.holes=[];for(let Z=0,te=this.holes.length;Z<te;Z++){const ne=this.holes[Z];_.holes.push(ne.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.uuid=_.uuid,this.holes=[];for(let Z=0,te=_.holes.length;Z<te;Z++){const ne=_.holes[Z];this.holes.push(new Path().fromJSON(ne))}return this}};function earcut(K,_,Z=2){const te=_&&_.length,ne=te?_[0]*Z:K.length;let ie=linkedList(K,0,ne,Z,!0);const oe=[];if(!ie||ie.next===ie.prev)return oe;let se,ae,le;if(te&&(ie=eliminateHoles(K,_,ie,Z)),K.length>80*Z){se=1/0,ae=1/0;let ce=-1/0,fe=-1/0;for(let de=Z;de<ne;de+=Z){const pe=K[de],he=K[de+1];pe<se&&(se=pe),he<ae&&(ae=he),pe>ce&&(ce=pe),he>fe&&(fe=he)}le=Math.max(ce-se,fe-ae),le=le!==0?32767/le:0}return earcutLinked(ie,oe,Z,se,ae,le,0),oe}function linkedList(K,_,Z,te,ne){let ie;if(ne===signedArea(K,_,Z,te)>0)for(let oe=_;oe<Z;oe+=te)ie=insertNode(oe/te|0,K[oe],K[oe+1],ie);else for(let oe=Z-te;oe>=_;oe-=te)ie=insertNode(oe/te|0,K[oe],K[oe+1],ie);return ie&&equals$1(ie,ie.next)&&(removeNode(ie),ie=ie.next),ie}function filterPoints(K,_){if(!K)return K;_||(_=K);let Z=K,te;do if(te=!1,!Z.steiner&&(equals$1(Z,Z.next)||area(Z.prev,Z,Z.next)===0)){if(removeNode(Z),Z=_=Z.prev,Z===Z.next)break;te=!0}else Z=Z.next;while(te||Z!==_);return _}function earcutLinked(K,_,Z,te,ne,ie,oe){if(!K)return;!oe&&ie&&indexCurve(K,te,ne,ie);let se=K;for(;K.prev!==K.next;){const ae=K.prev,le=K.next;if(ie?isEarHashed(K,te,ne,ie):isEar(K)){_.push(ae.i,K.i,le.i),removeNode(K),K=le.next,se=le.next;continue}if(K=le,K===se){oe?oe===1?(K=cureLocalIntersections(filterPoints(K),_),earcutLinked(K,_,Z,te,ne,ie,2)):oe===2&&splitEarcut(K,_,Z,te,ne,ie):earcutLinked(filterPoints(K),_,Z,te,ne,ie,1);break}}}function isEar(K){const _=K.prev,Z=K,te=K.next;if(area(_,Z,te)>=0)return!1;const ne=_.x,ie=Z.x,oe=te.x,se=_.y,ae=Z.y,le=te.y,ce=Math.min(ne,ie,oe),fe=Math.min(se,ae,le),de=Math.max(ne,ie,oe),pe=Math.max(se,ae,le);let he=te.next;for(;he!==_;){if(he.x>=ce&&he.x<=de&&he.y>=fe&&he.y<=pe&&pointInTriangleExceptFirst(ne,se,ie,ae,oe,le,he.x,he.y)&&area(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function isEarHashed(K,_,Z,te){const ne=K.prev,ie=K,oe=K.next;if(area(ne,ie,oe)>=0)return!1;const se=ne.x,ae=ie.x,le=oe.x,ce=ne.y,fe=ie.y,de=oe.y,pe=Math.min(se,ae,le),he=Math.min(ce,fe,de),ge=Math.max(se,ae,le),me=Math.max(ce,fe,de),Ae=zOrder(pe,he,_,Z,te),ye=zOrder(ge,me,_,Z,te);let ve=K.prevZ,_e=K.nextZ;for(;ve&&ve.z>=Ae&&_e&&_e.z<=ye;){if(ve.x>=pe&&ve.x<=ge&&ve.y>=he&&ve.y<=me&&ve!==ne&&ve!==oe&&pointInTriangleExceptFirst(se,ce,ae,fe,le,de,ve.x,ve.y)&&area(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,_e.x>=pe&&_e.x<=ge&&_e.y>=he&&_e.y<=me&&_e!==ne&&_e!==oe&&pointInTriangleExceptFirst(se,ce,ae,fe,le,de,_e.x,_e.y)&&area(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;ve&&ve.z>=Ae;){if(ve.x>=pe&&ve.x<=ge&&ve.y>=he&&ve.y<=me&&ve!==ne&&ve!==oe&&pointInTriangleExceptFirst(se,ce,ae,fe,le,de,ve.x,ve.y)&&area(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;_e&&_e.z<=ye;){if(_e.x>=pe&&_e.x<=ge&&_e.y>=he&&_e.y<=me&&_e!==ne&&_e!==oe&&pointInTriangleExceptFirst(se,ce,ae,fe,le,de,_e.x,_e.y)&&area(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function cureLocalIntersections(K,_){let Z=K;do{const te=Z.prev,ne=Z.next.next;!equals$1(te,ne)&&intersects(te,Z,Z.next,ne)&&locallyInside(te,ne)&&locallyInside(ne,te)&&(_.push(te.i,Z.i,ne.i),removeNode(Z),removeNode(Z.next),Z=K=ne),Z=Z.next}while(Z!==K);return filterPoints(Z)}function splitEarcut(K,_,Z,te,ne,ie){let oe=K;do{let se=oe.next.next;for(;se!==oe.prev;){if(oe.i!==se.i&&isValidDiagonal(oe,se)){let ae=splitPolygon(oe,se);oe=filterPoints(oe,oe.next),ae=filterPoints(ae,ae.next),earcutLinked(oe,_,Z,te,ne,ie,0),earcutLinked(ae,_,Z,te,ne,ie,0);return}se=se.next}oe=oe.next}while(oe!==K)}function eliminateHoles(K,_,Z,te){const ne=[];for(let ie=0,oe=_.length;ie<oe;ie++){const se=_[ie]*te,ae=ie<oe-1?_[ie+1]*te:K.length,le=linkedList(K,se,ae,te,!1);le===le.next&&(le.steiner=!0),ne.push(getLeftmost(le))}ne.sort(compareXYSlope);for(let ie=0;ie<ne.length;ie++)Z=eliminateHole(ne[ie],Z);return Z}function compareXYSlope(K,_){let Z=K.x-_.x;if(Z===0&&(Z=K.y-_.y,Z===0)){const te=(K.next.y-K.y)/(K.next.x-K.x),ne=(_.next.y-_.y)/(_.next.x-_.x);Z=te-ne}return Z}function eliminateHole(K,_){const Z=findHoleBridge(K,_);if(!Z)return _;const te=splitPolygon(Z,K);return filterPoints(te,te.next),filterPoints(Z,Z.next)}function findHoleBridge(K,_){let Z=_;const te=K.x,ne=K.y;let ie=-1/0,oe;if(equals$1(K,Z))return Z;do{if(equals$1(K,Z.next))return Z.next;if(ne<=Z.y&&ne>=Z.next.y&&Z.next.y!==Z.y){const fe=Z.x+(ne-Z.y)*(Z.next.x-Z.x)/(Z.next.y-Z.y);if(fe<=te&&fe>ie&&(ie=fe,oe=Z.x<Z.next.x?Z:Z.next,fe===te))return oe}Z=Z.next}while(Z!==_);if(!oe)return null;const se=oe,ae=oe.x,le=oe.y;let ce=1/0;Z=oe;do{if(te>=Z.x&&Z.x>=ae&&te!==Z.x&&pointInTriangle(ne<le?te:ie,ne,ae,le,ne<le?ie:te,ne,Z.x,Z.y)){const fe=Math.abs(ne-Z.y)/(te-Z.x);locallyInside(Z,K)&&(fe<ce||fe===ce&&(Z.x>oe.x||Z.x===oe.x&&sectorContainsSector(oe,Z)))&&(oe=Z,ce=fe)}Z=Z.next}while(Z!==se);return oe}function sectorContainsSector(K,_){return area(K.prev,K,_.prev)<0&&area(_.next,K,K.next)<0}function indexCurve(K,_,Z,te){let ne=K;do ne.z===0&&(ne.z=zOrder(ne.x,ne.y,_,Z,te)),ne.prevZ=ne.prev,ne.nextZ=ne.next,ne=ne.next;while(ne!==K);ne.prevZ.nextZ=null,ne.prevZ=null,sortLinked(ne)}function sortLinked(K){let _,Z=1;do{let te=K,ne;K=null;let ie=null;for(_=0;te;){_++;let oe=te,se=0;for(let le=0;le<Z&&(se++,oe=oe.nextZ,!!oe);le++);let ae=Z;for(;se>0||ae>0&&oe;)se!==0&&(ae===0||!oe||te.z<=oe.z)?(ne=te,te=te.nextZ,se--):(ne=oe,oe=oe.nextZ,ae--),ie?ie.nextZ=ne:K=ne,ne.prevZ=ie,ie=ne;te=oe}ie.nextZ=null,Z*=2}while(_>1);return K}function zOrder(K,_,Z,te,ne){return K=(K-Z)*ne|0,_=(_-te)*ne|0,K=(K|K<<8)&16711935,K=(K|K<<4)&252645135,K=(K|K<<2)&858993459,K=(K|K<<1)&1431655765,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,K|_<<1}function getLeftmost(K){let _=K,Z=K;do(_.x<Z.x||_.x===Z.x&&_.y<Z.y)&&(Z=_),_=_.next;while(_!==K);return Z}function pointInTriangle(K,_,Z,te,ne,ie,oe,se){return(ne-oe)*(_-se)>=(K-oe)*(ie-se)&&(K-oe)*(te-se)>=(Z-oe)*(_-se)&&(Z-oe)*(ie-se)>=(ne-oe)*(te-se)}function pointInTriangleExceptFirst(K,_,Z,te,ne,ie,oe,se){return!(K===oe&&_===se)&&pointInTriangle(K,_,Z,te,ne,ie,oe,se)}function isValidDiagonal(K,_){return K.next.i!==_.i&&K.prev.i!==_.i&&!intersectsPolygon(K,_)&&(locallyInside(K,_)&&locallyInside(_,K)&&middleInside(K,_)&&(area(K.prev,K,_.prev)||area(K,_.prev,_))||equals$1(K,_)&&area(K.prev,K,K.next)>0&&area(_.prev,_,_.next)>0)}function area(K,_,Z){return(_.y-K.y)*(Z.x-_.x)-(_.x-K.x)*(Z.y-_.y)}function equals$1(K,_){return K.x===_.x&&K.y===_.y}function intersects(K,_,Z,te){const ne=sign(area(K,_,Z)),ie=sign(area(K,_,te)),oe=sign(area(Z,te,K)),se=sign(area(Z,te,_));return!!(ne!==ie&&oe!==se||ne===0&&onSegment(K,Z,_)||ie===0&&onSegment(K,te,_)||oe===0&&onSegment(Z,K,te)||se===0&&onSegment(Z,_,te))}function onSegment(K,_,Z){return _.x<=Math.max(K.x,Z.x)&&_.x>=Math.min(K.x,Z.x)&&_.y<=Math.max(K.y,Z.y)&&_.y>=Math.min(K.y,Z.y)}function sign(K){return K>0?1:K<0?-1:0}function intersectsPolygon(K,_){let Z=K;do{if(Z.i!==K.i&&Z.next.i!==K.i&&Z.i!==_.i&&Z.next.i!==_.i&&intersects(Z,Z.next,K,_))return!0;Z=Z.next}while(Z!==K);return!1}function locallyInside(K,_){return area(K.prev,K,K.next)<0?area(K,_,K.next)>=0&&area(K,K.prev,_)>=0:area(K,_,K.prev)<0||area(K,K.next,_)<0}function middleInside(K,_){let Z=K,te=!1;const ne=(K.x+_.x)/2,ie=(K.y+_.y)/2;do Z.y>ie!=Z.next.y>ie&&Z.next.y!==Z.y&&ne<(Z.next.x-Z.x)*(ie-Z.y)/(Z.next.y-Z.y)+Z.x&&(te=!te),Z=Z.next;while(Z!==K);return te}function splitPolygon(K,_){const Z=createNode(K.i,K.x,K.y),te=createNode(_.i,_.x,_.y),ne=K.next,ie=_.prev;return K.next=_,_.prev=K,Z.next=ne,ne.prev=Z,te.next=Z,Z.prev=te,ie.next=te,te.prev=ie,te}function insertNode(K,_,Z,te){const ne=createNode(K,_,Z);return te?(ne.next=te.next,ne.prev=te,te.next.prev=ne,te.next=ne):(ne.prev=ne,ne.next=ne),ne}function removeNode(K){K.next.prev=K.prev,K.prev.next=K.next,K.prevZ&&(K.prevZ.nextZ=K.nextZ),K.nextZ&&(K.nextZ.prevZ=K.prevZ)}function createNode(K,_,Z){return{i:K,x:_,y:Z,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function signedArea(K,_,Z,te){let ne=0;for(let ie=_,oe=Z-te;ie<Z;ie+=te)ne+=(K[oe]-K[ie])*(K[ie+1]+K[oe+1]),oe=ie;return ne}class Earcut{static triangulate(_,Z,te=2){return earcut(_,Z,te)}}class ShapeUtils{static area(_){const Z=_.length;let te=0;for(let ne=Z-1,ie=0;ie<Z;ne=ie++)te+=_[ne].x*_[ie].y-_[ie].x*_[ne].y;return te*.5}static isClockWise(_){return ShapeUtils.area(_)<0}static triangulateShape(_,Z){const te=[],ne=[],ie=[];removeDupEndPts(_),addContour(te,_);let oe=_.length;Z.forEach(removeDupEndPts);for(let ae=0;ae<Z.length;ae++)ne.push(oe),oe+=Z[ae].length,addContour(te,Z[ae]);const se=Earcut.triangulate(te,ne);for(let ae=0;ae<se.length;ae+=3)ie.push(se.slice(ae,ae+3));return ie}}function removeDupEndPts(K){const _=K.length;_>2&&K[_-1].equals(K[0])&&K.pop()}function addContour(K,_){for(let Z=0;Z<_.length;Z++)K.push(_[Z].x),K.push(_[Z].y)}class ExtrudeGeometry extends BufferGeometry{constructor(_=new Shape$2([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),Z={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_,options:Z},_=Array.isArray(_)?_:[_];const te=this,ne=[],ie=[];for(let se=0,ae=_.length;se<ae;se++){const le=_[se];oe(le)}this.setAttribute("position",new Float32BufferAttribute(ne,3)),this.setAttribute("uv",new Float32BufferAttribute(ie,2)),this.computeVertexNormals();function oe(se){const ae=[],le=Z.curveSegments!==void 0?Z.curveSegments:12,ce=Z.steps!==void 0?Z.steps:1,fe=Z.depth!==void 0?Z.depth:1;let de=Z.bevelEnabled!==void 0?Z.bevelEnabled:!0,pe=Z.bevelThickness!==void 0?Z.bevelThickness:.2,he=Z.bevelSize!==void 0?Z.bevelSize:pe-.1,ge=Z.bevelOffset!==void 0?Z.bevelOffset:0,me=Z.bevelSegments!==void 0?Z.bevelSegments:3;const Ae=Z.extrudePath,ye=Z.UVGenerator!==void 0?Z.UVGenerator:WorldUVGenerator;let ve,_e=!1,Te,be,Re,we;Ae&&(ve=Ae.getSpacedPoints(ce),_e=!0,de=!1,Te=Ae.computeFrenetFrames(ce,!1),be=new Vector3,Re=new Vector3,we=new Vector3),de||(me=0,pe=0,he=0,ge=0);const Pe=se.extractPoints(le);let Ie=Pe.shape;const $e=Pe.holes;if(!ShapeUtils.isClockWise(Ie)){Ie=Ie.reverse();for(let bt=0,Ot=$e.length;bt<Ot;bt++){const Mt=$e[bt];ShapeUtils.isClockWise(Mt)&&($e[bt]=Mt.reverse())}}function ke(bt){const Mt=10000000000000001e-36;let _t=bt[0];for(let pt=1;pt<=bt.length;pt++){const ft=pt%bt.length,st=bt[ft],vt=st.x-_t.x,Pt=st.y-_t.y,Lt=vt*vt+Pt*Pt,Vt=Math.max(Math.abs(st.x),Math.abs(st.y),Math.abs(_t.x),Math.abs(_t.y)),Le=Mt*Vt*Vt;if(Lt<=Le){bt.splice(ft,1),pt--;continue}_t=st}}ke(Ie),$e.forEach(ke);const Ge=$e.length,He=Ie;for(let bt=0;bt<Ge;bt++){const Ot=$e[bt];Ie=Ie.concat(Ot)}function ze(bt,Ot,Mt){return Ot||console.error("THREE.ExtrudeGeometry: vec does not exist"),bt.clone().addScaledVector(Ot,Mt)}const Ke=Ie.length;function tt(bt,Ot,Mt){let _t,pt,ft;const st=bt.x-Ot.x,vt=bt.y-Ot.y,Pt=Mt.x-bt.x,Lt=Mt.y-bt.y,Vt=st*st+vt*vt,Le=st*Lt-vt*Pt;if(Math.abs(Le)>Number.EPSILON){const De=Math.sqrt(Vt),Be=Math.sqrt(Pt*Pt+Lt*Lt),rt=Ot.x-vt/De,at=Ot.y+st/De,xt=Mt.x-Lt/Be,Ct=Mt.y+Pt/Be,Qt=((xt-rt)*Lt-(Ct-at)*Pt)/(st*Lt-vt*Pt);_t=rt+st*Qt-bt.x,pt=at+vt*Qt-bt.y;const qt=_t*_t+pt*pt;if(qt<=2)return new Vector2(_t,pt);ft=Math.sqrt(qt/2)}else{let De=!1;st>Number.EPSILON?Pt>Number.EPSILON&&(De=!0):st<-Number.EPSILON?Pt<-Number.EPSILON&&(De=!0):Math.sign(vt)===Math.sign(Lt)&&(De=!0),De?(_t=-vt,pt=st,ft=Math.sqrt(Vt)):(_t=st,pt=vt,ft=Math.sqrt(Vt/2))}return new Vector2(_t/ft,pt/ft)}const Je=[];for(let bt=0,Ot=He.length,Mt=Ot-1,_t=bt+1;bt<Ot;bt++,Mt++,_t++)Mt===Ot&&(Mt=0),_t===Ot&&(_t=0),Je[bt]=tt(He[bt],He[Mt],He[_t]);const ot=[];let Fe,ct=Je.concat();for(let bt=0,Ot=Ge;bt<Ot;bt++){const Mt=$e[bt];Fe=[];for(let _t=0,pt=Mt.length,ft=pt-1,st=_t+1;_t<pt;_t++,ft++,st++)ft===pt&&(ft=0),st===pt&&(st=0),Fe[_t]=tt(Mt[_t],Mt[ft],Mt[st]);ot.push(Fe),ct=ct.concat(Fe)}const ht=[],lt=[];for(let bt=0;bt<me;bt++){const Ot=bt/me,Mt=pe*Math.cos(Ot*Math.PI/2),_t=he*Math.sin(Ot*Math.PI/2)+ge;for(let pt=0,ft=He.length;pt<ft;pt++){const st=ze(He[pt],Je[pt],_t);Et(st.x,st.y,-Mt),Ot==0&&ht.push(st)}for(let pt=0,ft=Ge;pt<ft;pt++){const st=$e[pt];Fe=ot[pt];const vt=[];for(let Pt=0,Lt=st.length;Pt<Lt;Pt++){const Vt=ze(st[Pt],Fe[Pt],_t);Et(Vt.x,Vt.y,-Mt),Ot==0&&vt.push(Vt)}Ot==0&&lt.push(vt)}}const Qe=ShapeUtils.triangulateShape(ht,lt),Ze=Qe.length,it=he+ge;for(let bt=0;bt<Ke;bt++){const Ot=de?ze(Ie[bt],ct[bt],it):Ie[bt];_e?(Re.copy(Te.normals[0]).multiplyScalar(Ot.x),be.copy(Te.binormals[0]).multiplyScalar(Ot.y),we.copy(ve[0]).add(Re).add(be),Et(we.x,we.y,we.z)):Et(Ot.x,Ot.y,0)}for(let bt=1;bt<=ce;bt++)for(let Ot=0;Ot<Ke;Ot++){const Mt=de?ze(Ie[Ot],ct[Ot],it):Ie[Ot];_e?(Re.copy(Te.normals[bt]).multiplyScalar(Mt.x),be.copy(Te.binormals[bt]).multiplyScalar(Mt.y),we.copy(ve[bt]).add(Re).add(be),Et(we.x,we.y,we.z)):Et(Mt.x,Mt.y,fe/ce*bt)}for(let bt=me-1;bt>=0;bt--){const Ot=bt/me,Mt=pe*Math.cos(Ot*Math.PI/2),_t=he*Math.sin(Ot*Math.PI/2)+ge;for(let pt=0,ft=He.length;pt<ft;pt++){const st=ze(He[pt],Je[pt],_t);Et(st.x,st.y,fe+Mt)}for(let pt=0,ft=$e.length;pt<ft;pt++){const st=$e[pt];Fe=ot[pt];for(let vt=0,Pt=st.length;vt<Pt;vt++){const Lt=ze(st[vt],Fe[vt],_t);_e?Et(Lt.x,Lt.y+ve[ce-1].y,ve[ce-1].x+Mt):Et(Lt.x,Lt.y,fe+Mt)}}}nt(),Tt();function nt(){const bt=ne.length/3;if(de){let Ot=0,Mt=Ke*Ot;for(let _t=0;_t<Ze;_t++){const pt=Qe[_t];Nt(pt[2]+Mt,pt[1]+Mt,pt[0]+Mt)}Ot=ce+me*2,Mt=Ke*Ot;for(let _t=0;_t<Ze;_t++){const pt=Qe[_t];Nt(pt[0]+Mt,pt[1]+Mt,pt[2]+Mt)}}else{for(let Ot=0;Ot<Ze;Ot++){const Mt=Qe[Ot];Nt(Mt[2],Mt[1],Mt[0])}for(let Ot=0;Ot<Ze;Ot++){const Mt=Qe[Ot];Nt(Mt[0]+Ke*ce,Mt[1]+Ke*ce,Mt[2]+Ke*ce)}}te.addGroup(bt,ne.length/3-bt,0)}function Tt(){const bt=ne.length/3;let Ot=0;St(He,Ot),Ot+=He.length;for(let Mt=0,_t=$e.length;Mt<_t;Mt++){const pt=$e[Mt];St(pt,Ot),Ot+=pt.length}te.addGroup(bt,ne.length/3-bt,1)}function St(bt,Ot){let Mt=bt.length;for(;--Mt>=0;){const _t=Mt;let pt=Mt-1;pt<0&&(pt=bt.length-1);for(let ft=0,st=ce+me*2;ft<st;ft++){const vt=Ke*ft,Pt=Ke*(ft+1),Lt=Ot+_t+vt,Vt=Ot+pt+vt,Le=Ot+pt+Pt,De=Ot+_t+Pt;zt(Lt,Vt,Le,De)}}}function Et(bt,Ot,Mt){ae.push(bt),ae.push(Ot),ae.push(Mt)}function Nt(bt,Ot,Mt){yt(bt),yt(Ot),yt(Mt);const _t=ne.length/3,pt=ye.generateTopUV(te,ne,_t-3,_t-2,_t-1);Ut(pt[0]),Ut(pt[1]),Ut(pt[2])}function zt(bt,Ot,Mt,_t){yt(bt),yt(Ot),yt(_t),yt(Ot),yt(Mt),yt(_t);const pt=ne.length/3,ft=ye.generateSideWallUV(te,ne,pt-6,pt-3,pt-2,pt-1);Ut(ft[0]),Ut(ft[1]),Ut(ft[3]),Ut(ft[1]),Ut(ft[2]),Ut(ft[3])}function yt(bt){ne.push(ae[bt*3+0]),ne.push(ae[bt*3+1]),ne.push(ae[bt*3+2])}function Ut(bt){ie.push(bt.x),ie.push(bt.y)}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),Z=this.parameters.shapes,te=this.parameters.options;return toJSON$1(Z,te,_)}static fromJSON(_,Z){const te=[];for(let ie=0,oe=_.shapes.length;ie<oe;ie++){const se=Z[_.shapes[ie]];te.push(se)}const ne=_.options.extrudePath;return ne!==void 0&&(_.options.extrudePath=new Curves[ne.type]().fromJSON(ne)),new ExtrudeGeometry(te,_.options)}}const WorldUVGenerator={generateTopUV:function(K,_,Z,te,ne){const ie=_[Z*3],oe=_[Z*3+1],se=_[te*3],ae=_[te*3+1],le=_[ne*3],ce=_[ne*3+1];return[new Vector2(ie,oe),new Vector2(se,ae),new Vector2(le,ce)]},generateSideWallUV:function(K,_,Z,te,ne,ie){const oe=_[Z*3],se=_[Z*3+1],ae=_[Z*3+2],le=_[te*3],ce=_[te*3+1],fe=_[te*3+2],de=_[ne*3],pe=_[ne*3+1],he=_[ne*3+2],ge=_[ie*3],me=_[ie*3+1],Ae=_[ie*3+2];return Math.abs(se-ce)<Math.abs(oe-le)?[new Vector2(oe,1-ae),new Vector2(le,1-fe),new Vector2(de,1-he),new Vector2(ge,1-Ae)]:[new Vector2(se,1-ae),new Vector2(ce,1-fe),new Vector2(pe,1-he),new Vector2(me,1-Ae)]}};function toJSON$1(K,_,Z){if(Z.shapes=[],Array.isArray(K))for(let te=0,ne=K.length;te<ne;te++){const ie=K[te];Z.shapes.push(ie.uuid)}else Z.shapes.push(K.uuid);return Z.options=Object.assign({},_),_.extrudePath!==void 0&&(Z.options.extrudePath=_.extrudePath.toJSON()),Z}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_=1,Z=0){const te=(1+Math.sqrt(5))/2,ne=[-1,te,0,1,te,0,-1,-te,0,1,-te,0,0,-1,te,0,1,te,0,-1,-te,0,1,-te,te,0,-1,te,0,1,-te,0,-1,-te,0,1],ie=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(ne,ie,_,Z),this.type="IcosahedronGeometry",this.parameters={radius:_,detail:Z}}static fromJSON(_){return new IcosahedronGeometry(_.radius,_.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_=1,Z=0){const te=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],ne=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(te,ne,_,Z),this.type="OctahedronGeometry",this.parameters={radius:_,detail:Z}}static fromJSON(_){return new OctahedronGeometry(_.radius,_.detail)}}class PlaneGeometry extends BufferGeometry{constructor(_=1,Z=1,te=1,ne=1){super(),this.type="PlaneGeometry",this.parameters={width:_,height:Z,widthSegments:te,heightSegments:ne};const ie=_/2,oe=Z/2,se=Math.floor(te),ae=Math.floor(ne),le=se+1,ce=ae+1,fe=_/se,de=Z/ae,pe=[],he=[],ge=[],me=[];for(let Ae=0;Ae<ce;Ae++){const ye=Ae*de-oe;for(let ve=0;ve<le;ve++){const _e=ve*fe-ie;he.push(_e,-ye,0),ge.push(0,0,1),me.push(ve/se),me.push(1-Ae/ae)}}for(let Ae=0;Ae<ae;Ae++)for(let ye=0;ye<se;ye++){const ve=ye+le*Ae,_e=ye+le*(Ae+1),Te=ye+1+le*(Ae+1),be=ye+1+le*Ae;pe.push(ve,_e,be),pe.push(_e,Te,be)}this.setIndex(pe),this.setAttribute("position",new Float32BufferAttribute(he,3)),this.setAttribute("normal",new Float32BufferAttribute(ge,3)),this.setAttribute("uv",new Float32BufferAttribute(me,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PlaneGeometry(_.width,_.height,_.widthSegments,_.heightSegments)}}class RingGeometry extends BufferGeometry{constructor(_=.5,Z=1,te=32,ne=1,ie=0,oe=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_,outerRadius:Z,thetaSegments:te,phiSegments:ne,thetaStart:ie,thetaLength:oe},te=Math.max(3,te),ne=Math.max(1,ne);const se=[],ae=[],le=[],ce=[];let fe=_;const de=(Z-_)/ne,pe=new Vector3,he=new Vector2;for(let ge=0;ge<=ne;ge++){for(let me=0;me<=te;me++){const Ae=ie+me/te*oe;pe.x=fe*Math.cos(Ae),pe.y=fe*Math.sin(Ae),ae.push(pe.x,pe.y,pe.z),le.push(0,0,1),he.x=(pe.x/Z+1)/2,he.y=(pe.y/Z+1)/2,ce.push(he.x,he.y)}fe+=de}for(let ge=0;ge<ne;ge++){const me=ge*(te+1);for(let Ae=0;Ae<te;Ae++){const ye=Ae+me,ve=ye,_e=ye+te+1,Te=ye+te+2,be=ye+1;se.push(ve,_e,be),se.push(_e,Te,be)}}this.setIndex(se),this.setAttribute("position",new Float32BufferAttribute(ae,3)),this.setAttribute("normal",new Float32BufferAttribute(le,3)),this.setAttribute("uv",new Float32BufferAttribute(ce,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new RingGeometry(_.innerRadius,_.outerRadius,_.thetaSegments,_.phiSegments,_.thetaStart,_.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(_=new Shape$2([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),Z=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_,curveSegments:Z};const te=[],ne=[],ie=[],oe=[];let se=0,ae=0;if(Array.isArray(_)===!1)le(_);else for(let ce=0;ce<_.length;ce++)le(_[ce]),this.addGroup(se,ae,ce),se+=ae,ae=0;this.setIndex(te),this.setAttribute("position",new Float32BufferAttribute(ne,3)),this.setAttribute("normal",new Float32BufferAttribute(ie,3)),this.setAttribute("uv",new Float32BufferAttribute(oe,2));function le(ce){const fe=ne.length/3,de=ce.extractPoints(Z);let pe=de.shape;const he=de.holes;ShapeUtils.isClockWise(pe)===!1&&(pe=pe.reverse());for(let me=0,Ae=he.length;me<Ae;me++){const ye=he[me];ShapeUtils.isClockWise(ye)===!0&&(he[me]=ye.reverse())}const ge=ShapeUtils.triangulateShape(pe,he);for(let me=0,Ae=he.length;me<Ae;me++){const ye=he[me];pe=pe.concat(ye)}for(let me=0,Ae=pe.length;me<Ae;me++){const ye=pe[me];ne.push(ye.x,ye.y,0),ie.push(0,0,1),oe.push(ye.x,ye.y)}for(let me=0,Ae=ge.length;me<Ae;me++){const ye=ge[me],ve=ye[0]+fe,_e=ye[1]+fe,Te=ye[2]+fe;te.push(ve,_e,Te),ae+=3}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),Z=this.parameters.shapes;return toJSON(Z,_)}static fromJSON(_,Z){const te=[];for(let ne=0,ie=_.shapes.length;ne<ie;ne++){const oe=Z[_.shapes[ne]];te.push(oe)}return new ShapeGeometry(te,_.curveSegments)}}function toJSON(K,_){if(_.shapes=[],Array.isArray(K))for(let Z=0,te=K.length;Z<te;Z++){const ne=K[Z];_.shapes.push(ne.uuid)}else _.shapes.push(K.uuid);return _}class SphereGeometry extends BufferGeometry{constructor(_=1,Z=32,te=16,ne=0,ie=Math.PI*2,oe=0,se=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_,widthSegments:Z,heightSegments:te,phiStart:ne,phiLength:ie,thetaStart:oe,thetaLength:se},Z=Math.max(3,Math.floor(Z)),te=Math.max(2,Math.floor(te));const ae=Math.min(oe+se,Math.PI);let le=0;const ce=[],fe=new Vector3,de=new Vector3,pe=[],he=[],ge=[],me=[];for(let Ae=0;Ae<=te;Ae++){const ye=[],ve=Ae/te;let _e=0;Ae===0&&oe===0?_e=.5/Z:Ae===te&&ae===Math.PI&&(_e=-.5/Z);for(let Te=0;Te<=Z;Te++){const be=Te/Z;fe.x=-_*Math.cos(ne+be*ie)*Math.sin(oe+ve*se),fe.y=_*Math.cos(oe+ve*se),fe.z=_*Math.sin(ne+be*ie)*Math.sin(oe+ve*se),he.push(fe.x,fe.y,fe.z),de.copy(fe).normalize(),ge.push(de.x,de.y,de.z),me.push(be+_e,1-ve),ye.push(le++)}ce.push(ye)}for(let Ae=0;Ae<te;Ae++)for(let ye=0;ye<Z;ye++){const ve=ce[Ae][ye+1],_e=ce[Ae][ye],Te=ce[Ae+1][ye],be=ce[Ae+1][ye+1];(Ae!==0||oe>0)&&pe.push(ve,_e,be),(Ae!==te-1||ae<Math.PI)&&pe.push(_e,Te,be)}this.setIndex(pe),this.setAttribute("position",new Float32BufferAttribute(he,3)),this.setAttribute("normal",new Float32BufferAttribute(ge,3)),this.setAttribute("uv",new Float32BufferAttribute(me,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new SphereGeometry(_.radius,_.widthSegments,_.heightSegments,_.phiStart,_.phiLength,_.thetaStart,_.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(_=1,Z=0){const te=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],ne=[2,1,0,0,3,2,1,3,0,2,3,1];super(te,ne,_,Z),this.type="TetrahedronGeometry",this.parameters={radius:_,detail:Z}}static fromJSON(_){return new TetrahedronGeometry(_.radius,_.detail)}}class TorusGeometry extends BufferGeometry{constructor(_=1,Z=.4,te=12,ne=48,ie=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_,tube:Z,radialSegments:te,tubularSegments:ne,arc:ie},te=Math.floor(te),ne=Math.floor(ne);const oe=[],se=[],ae=[],le=[],ce=new Vector3,fe=new Vector3,de=new Vector3;for(let pe=0;pe<=te;pe++)for(let he=0;he<=ne;he++){const ge=he/ne*ie,me=pe/te*Math.PI*2;fe.x=(_+Z*Math.cos(me))*Math.cos(ge),fe.y=(_+Z*Math.cos(me))*Math.sin(ge),fe.z=Z*Math.sin(me),se.push(fe.x,fe.y,fe.z),ce.x=_*Math.cos(ge),ce.y=_*Math.sin(ge),de.subVectors(fe,ce).normalize(),ae.push(de.x,de.y,de.z),le.push(he/ne),le.push(pe/te)}for(let pe=1;pe<=te;pe++)for(let he=1;he<=ne;he++){const ge=(ne+1)*pe+he-1,me=(ne+1)*(pe-1)+he-1,Ae=(ne+1)*(pe-1)+he,ye=(ne+1)*pe+he;oe.push(ge,me,ye),oe.push(me,Ae,ye)}this.setIndex(oe),this.setAttribute("position",new Float32BufferAttribute(se,3)),this.setAttribute("normal",new Float32BufferAttribute(ae,3)),this.setAttribute("uv",new Float32BufferAttribute(le,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusGeometry(_.radius,_.tube,_.radialSegments,_.tubularSegments,_.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(_=1,Z=.4,te=64,ne=8,ie=2,oe=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_,tube:Z,tubularSegments:te,radialSegments:ne,p:ie,q:oe},te=Math.floor(te),ne=Math.floor(ne);const se=[],ae=[],le=[],ce=[],fe=new Vector3,de=new Vector3,pe=new Vector3,he=new Vector3,ge=new Vector3,me=new Vector3,Ae=new Vector3;for(let ve=0;ve<=te;++ve){const _e=ve/te*ie*Math.PI*2;ye(_e,ie,oe,_,pe),ye(_e+.01,ie,oe,_,he),me.subVectors(he,pe),Ae.addVectors(he,pe),ge.crossVectors(me,Ae),Ae.crossVectors(ge,me),ge.normalize(),Ae.normalize();for(let Te=0;Te<=ne;++Te){const be=Te/ne*Math.PI*2,Re=-Z*Math.cos(be),we=Z*Math.sin(be);fe.x=pe.x+(Re*Ae.x+we*ge.x),fe.y=pe.y+(Re*Ae.y+we*ge.y),fe.z=pe.z+(Re*Ae.z+we*ge.z),ae.push(fe.x,fe.y,fe.z),de.subVectors(fe,pe).normalize(),le.push(de.x,de.y,de.z),ce.push(ve/te),ce.push(Te/ne)}}for(let ve=1;ve<=te;ve++)for(let _e=1;_e<=ne;_e++){const Te=(ne+1)*(ve-1)+(_e-1),be=(ne+1)*ve+(_e-1),Re=(ne+1)*ve+_e,we=(ne+1)*(ve-1)+_e;se.push(Te,be,we),se.push(be,Re,we)}this.setIndex(se),this.setAttribute("position",new Float32BufferAttribute(ae,3)),this.setAttribute("normal",new Float32BufferAttribute(le,3)),this.setAttribute("uv",new Float32BufferAttribute(ce,2));function ye(ve,_e,Te,be,Re){const we=Math.cos(ve),Pe=Math.sin(ve),Ie=Te/_e*ve,$e=Math.cos(Ie);Re.x=be*(2+$e)*.5*we,Re.y=be*(2+$e)*Pe*.5,Re.z=be*Math.sin(Ie)*.5}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusKnotGeometry(_.radius,_.tube,_.tubularSegments,_.radialSegments,_.p,_.q)}}class TubeGeometry extends BufferGeometry{constructor(_=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),Z=64,te=1,ne=8,ie=!1){super(),this.type="TubeGeometry",this.parameters={path:_,tubularSegments:Z,radius:te,radialSegments:ne,closed:ie};const oe=_.computeFrenetFrames(Z,ie);this.tangents=oe.tangents,this.normals=oe.normals,this.binormals=oe.binormals;const se=new Vector3,ae=new Vector3,le=new Vector2;let ce=new Vector3;const fe=[],de=[],pe=[],he=[];ge(),this.setIndex(he),this.setAttribute("position",new Float32BufferAttribute(fe,3)),this.setAttribute("normal",new Float32BufferAttribute(de,3)),this.setAttribute("uv",new Float32BufferAttribute(pe,2));function ge(){for(let ve=0;ve<Z;ve++)me(ve);me(ie===!1?Z:0),ye(),Ae()}function me(ve){ce=_.getPointAt(ve/Z,ce);const _e=oe.normals[ve],Te=oe.binormals[ve];for(let be=0;be<=ne;be++){const Re=be/ne*Math.PI*2,we=Math.sin(Re),Pe=-Math.cos(Re);ae.x=Pe*_e.x+we*Te.x,ae.y=Pe*_e.y+we*Te.y,ae.z=Pe*_e.z+we*Te.z,ae.normalize(),de.push(ae.x,ae.y,ae.z),se.x=ce.x+te*ae.x,se.y=ce.y+te*ae.y,se.z=ce.z+te*ae.z,fe.push(se.x,se.y,se.z)}}function Ae(){for(let ve=1;ve<=Z;ve++)for(let _e=1;_e<=ne;_e++){const Te=(ne+1)*(ve-1)+(_e-1),be=(ne+1)*ve+(_e-1),Re=(ne+1)*ve+_e,we=(ne+1)*(ve-1)+_e;he.push(Te,be,we),he.push(be,Re,we)}}function ye(){for(let ve=0;ve<=Z;ve++)for(let _e=0;_e<=ne;_e++)le.x=ve/Z,le.y=_e/ne,pe.push(le.x,le.y)}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON();return _.path=this.parameters.path.toJSON(),_}static fromJSON(_){return new TubeGeometry(new Curves[_.path.type]().fromJSON(_.path),_.tubularSegments,_.radius,_.radialSegments,_.closed)}}class WireframeGeometry extends BufferGeometry{constructor(_=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_},_!==null){const Z=[],te=new Set,ne=new Vector3,ie=new Vector3;if(_.index!==null){const oe=_.attributes.position,se=_.index;let ae=_.groups;ae.length===0&&(ae=[{start:0,count:se.count,materialIndex:0}]);for(let le=0,ce=ae.length;le<ce;++le){const fe=ae[le],de=fe.start,pe=fe.count;for(let he=de,ge=de+pe;he<ge;he+=3)for(let me=0;me<3;me++){const Ae=se.getX(he+me),ye=se.getX(he+(me+1)%3);ne.fromBufferAttribute(oe,Ae),ie.fromBufferAttribute(oe,ye),isUniqueEdge(ne,ie,te)===!0&&(Z.push(ne.x,ne.y,ne.z),Z.push(ie.x,ie.y,ie.z))}}}else{const oe=_.attributes.position;for(let se=0,ae=oe.count/3;se<ae;se++)for(let le=0;le<3;le++){const ce=3*se+le,fe=3*se+(le+1)%3;ne.fromBufferAttribute(oe,ce),ie.fromBufferAttribute(oe,fe),isUniqueEdge(ne,ie,te)===!0&&(Z.push(ne.x,ne.y,ne.z),Z.push(ie.x,ie.y,ie.z))}}this.setAttribute("position",new Float32BufferAttribute(Z,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}function isUniqueEdge(K,_,Z){const te=`${K.x},${K.y},${K.z}-${_.x},${_.y},${_.z}`,ne=`${_.x},${_.y},${_.z}-${K.x},${K.y},${K.z}`;return Z.has(te)===!0||Z.has(ne)===!0?!1:(Z.add(te),Z.add(ne),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(_){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color$1(0),this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.fog=_.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(_){super(_),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(_){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Color$1(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={STANDARD:""},this.color.copy(_.color),this.roughness=_.roughness,this.metalness=_.metalness,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.roughnessMap=_.roughnessMap,this.metalnessMap=_.metalnessMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.envMapIntensity=_.envMapIntensity,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$4(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(Z){this.ior=(1+.4*Z)/(1-.4*Z)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color$1(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color$1(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color$1(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_)}get anisotropy(){return this._anisotropy}set anisotropy(_){this._anisotropy>0!=_>0&&this.version++,this._anisotropy=_}get clearcoat(){return this._clearcoat}set clearcoat(_){this._clearcoat>0!=_>0&&this.version++,this._clearcoat=_}get iridescence(){return this._iridescence}set iridescence(_){this._iridescence>0!=_>0&&this.version++,this._iridescence=_}get dispersion(){return this._dispersion}set dispersion(_){this._dispersion>0!=_>0&&this.version++,this._dispersion=_}get sheen(){return this._sheen}set sheen(_){this._sheen>0!=_>0&&this.version++,this._sheen=_}get transmission(){return this._transmission}set transmission(_){this._transmission>0!=_>0&&this.version++,this._transmission=_}copy(_){return super.copy(_),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_.anisotropy,this.anisotropyRotation=_.anisotropyRotation,this.anisotropyMap=_.anisotropyMap,this.clearcoat=_.clearcoat,this.clearcoatMap=_.clearcoatMap,this.clearcoatRoughness=_.clearcoatRoughness,this.clearcoatRoughnessMap=_.clearcoatRoughnessMap,this.clearcoatNormalMap=_.clearcoatNormalMap,this.clearcoatNormalScale.copy(_.clearcoatNormalScale),this.dispersion=_.dispersion,this.ior=_.ior,this.iridescence=_.iridescence,this.iridescenceMap=_.iridescenceMap,this.iridescenceIOR=_.iridescenceIOR,this.iridescenceThicknessRange=[..._.iridescenceThicknessRange],this.iridescenceThicknessMap=_.iridescenceThicknessMap,this.sheen=_.sheen,this.sheenColor.copy(_.sheenColor),this.sheenColorMap=_.sheenColorMap,this.sheenRoughness=_.sheenRoughness,this.sheenRoughnessMap=_.sheenRoughnessMap,this.transmission=_.transmission,this.transmissionMap=_.transmissionMap,this.thickness=_.thickness,this.thicknessMap=_.thicknessMap,this.attenuationDistance=_.attenuationDistance,this.attenuationColor.copy(_.attenuationColor),this.specularIntensity=_.specularIntensity,this.specularIntensityMap=_.specularIntensityMap,this.specularColor.copy(_.specularColor),this.specularColorMap=_.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color$1(16777215),this.specular=new Color$1(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.specular.copy(_.specular),this.shininess=_.shininess,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshToonMaterial extends Material{constructor(_){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color$1(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.gradientMap=_.gradientMap,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}class MeshNormalMaterial extends Material{constructor(_){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_)}copy(_){return super.copy(_),this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.flatShading=_.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshDepthMaterial extends Material{constructor(_){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_)}copy(_){return super.copy(_),this.depthPacking=_.depthPacking,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(_){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_)}copy(_){return super.copy(_),this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this}}class MeshMatcapMaterial extends Material{constructor(_){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color$1(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={MATCAP:""},this.color.copy(_.color),this.matcap=_.matcap,this.map=_.map,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.flatShading=_.flatShading,this.fog=_.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_)}copy(_){return super.copy(_),this.scale=_.scale,this.dashSize=_.dashSize,this.gapSize=_.gapSize,this}}function convertArray(K,_){return!K||K.constructor===_?K:typeof _.BYTES_PER_ELEMENT=="number"?new _(K):Array.prototype.slice.call(K)}function isTypedArray(K){return ArrayBuffer.isView(K)&&!(K instanceof DataView)}function getKeyframeOrder(K){function _(ne,ie){return K[ne]-K[ie]}const Z=K.length,te=new Array(Z);for(let ne=0;ne!==Z;++ne)te[ne]=ne;return te.sort(_),te}function sortedArray(K,_,Z){const te=K.length,ne=new K.constructor(te);for(let ie=0,oe=0;oe!==te;++ie){const se=Z[ie]*_;for(let ae=0;ae!==_;++ae)ne[oe++]=K[se+ae]}return ne}function flattenJSON(K,_,Z,te){let ne=1,ie=K[0];for(;ie!==void 0&&ie[te]===void 0;)ie=K[ne++];if(ie===void 0)return;let oe=ie[te];if(oe!==void 0)if(Array.isArray(oe))do oe=ie[te],oe!==void 0&&(_.push(ie.time),Z.push(...oe)),ie=K[ne++];while(ie!==void 0);else if(oe.toArray!==void 0)do oe=ie[te],oe!==void 0&&(_.push(ie.time),oe.toArray(Z,Z.length)),ie=K[ne++];while(ie!==void 0);else do oe=ie[te],oe!==void 0&&(_.push(ie.time),Z.push(oe)),ie=K[ne++];while(ie!==void 0)}function subclip(K,_,Z,te,ne=30){const ie=K.clone();ie.name=_;const oe=[];for(let ae=0;ae<ie.tracks.length;++ae){const le=ie.tracks[ae],ce=le.getValueSize(),fe=[],de=[];for(let pe=0;pe<le.times.length;++pe){const he=le.times[pe]*ne;if(!(he<Z||he>=te)){fe.push(le.times[pe]);for(let ge=0;ge<ce;++ge)de.push(le.values[pe*ce+ge])}}fe.length!==0&&(le.times=convertArray(fe,le.times.constructor),le.values=convertArray(de,le.values.constructor),oe.push(le))}ie.tracks=oe;let se=1/0;for(let ae=0;ae<ie.tracks.length;++ae)se>ie.tracks[ae].times[0]&&(se=ie.tracks[ae].times[0]);for(let ae=0;ae<ie.tracks.length;++ae)ie.tracks[ae].shift(-1*se);return ie.resetDuration(),ie}function makeClipAdditive(K,_=0,Z=K,te=30){te<=0&&(te=30);const ne=Z.tracks.length,ie=_/te;for(let oe=0;oe<ne;++oe){const se=Z.tracks[oe],ae=se.ValueTypeName;if(ae==="bool"||ae==="string")continue;const le=K.tracks.find(function(Ae){return Ae.name===se.name&&Ae.ValueTypeName===ae});if(le===void 0)continue;let ce=0;const fe=se.getValueSize();se.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ce=fe/3);let de=0;const pe=le.getValueSize();le.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(de=pe/3);const he=se.times.length-1;let ge;if(ie<=se.times[0]){const Ae=ce,ye=fe-ce;ge=se.values.slice(Ae,ye)}else if(ie>=se.times[he]){const Ae=he*fe+ce,ye=Ae+fe-ce;ge=se.values.slice(Ae,ye)}else{const Ae=se.createInterpolant(),ye=ce,ve=fe-ce;Ae.evaluate(ie),ge=Ae.resultBuffer.slice(ye,ve)}ae==="quaternion"&&new Quaternion().fromArray(ge).normalize().conjugate().toArray(ge);const me=le.times.length;for(let Ae=0;Ae<me;++Ae){const ye=Ae*pe+de;if(ae==="quaternion")Quaternion.multiplyQuaternionsFlat(le.values,ye,ge,0,le.values,ye);else{const ve=pe-de*2;for(let _e=0;_e<ve;++_e)le.values[ye+_e]-=ge[_e]}}}return K.blendMode=AdditiveAnimationBlendMode,K}class AnimationUtils{static convertArray(_,Z){return convertArray(_,Z)}static isTypedArray(_){return isTypedArray(_)}static getKeyframeOrder(_){return getKeyframeOrder(_)}static sortedArray(_,Z,te){return sortedArray(_,Z,te)}static flattenJSON(_,Z,te,ne){flattenJSON(_,Z,te,ne)}static subclip(_,Z,te,ne,ie=30){return subclip(_,Z,te,ne,ie)}static makeClipAdditive(_,Z=0,te=_,ne=30){return makeClipAdditive(_,Z,te,ne)}}class Interpolant{constructor(_,Z,te,ne){this.parameterPositions=_,this._cachedIndex=0,this.resultBuffer=ne!==void 0?ne:new Z.constructor(te),this.sampleValues=Z,this.valueSize=te,this.settings=null,this.DefaultSettings_={}}evaluate(_){const Z=this.parameterPositions;let te=this._cachedIndex,ne=Z[te],ie=Z[te-1];e:{t:{let oe;n:{r:if(!(_<ne)){for(let se=te+2;;){if(ne===void 0){if(_<ie)break r;return te=Z.length,this._cachedIndex=te,this.copySampleValue_(te-1)}if(te===se)break;if(ie=ne,ne=Z[++te],_<ne)break t}oe=Z.length;break n}if(!(_>=ie)){const se=Z[1];_<se&&(te=2,ie=se);for(let ae=te-2;;){if(ie===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(te===ae)break;if(ne=ie,ie=Z[--te-1],_>=ie)break t}oe=te,te=0;break n}break e}for(;te<oe;){const se=te+oe>>>1;_<Z[se]?oe=se:te=se+1}if(ne=Z[te],ie=Z[te-1],ie===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(ne===void 0)return te=Z.length,this._cachedIndex=te,this.copySampleValue_(te-1)}this._cachedIndex=te,this.intervalChanged_(te,ie,ne)}return this.interpolate_(te,ie,_,ne)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_){const Z=this.resultBuffer,te=this.sampleValues,ne=this.valueSize,ie=_*ne;for(let oe=0;oe!==ne;++oe)Z[oe]=te[ie+oe];return Z}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_,Z,te,ne){super(_,Z,te,ne),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_,Z,te){const ne=this.parameterPositions;let ie=_-2,oe=_+1,se=ne[ie],ae=ne[oe];if(se===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:ie=_,se=2*Z-te;break;case WrapAroundEnding:ie=ne.length-2,se=Z+ne[ie]-ne[ie+1];break;default:ie=_,se=te}if(ae===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:oe=_,ae=2*te-Z;break;case WrapAroundEnding:oe=1,ae=te+ne[1]-ne[0];break;default:oe=_-1,ae=Z}const le=(te-Z)*.5,ce=this.valueSize;this._weightPrev=le/(Z-se),this._weightNext=le/(ae-te),this._offsetPrev=ie*ce,this._offsetNext=oe*ce}interpolate_(_,Z,te,ne){const ie=this.resultBuffer,oe=this.sampleValues,se=this.valueSize,ae=_*se,le=ae-se,ce=this._offsetPrev,fe=this._offsetNext,de=this._weightPrev,pe=this._weightNext,he=(te-Z)/(ne-Z),ge=he*he,me=ge*he,Ae=-de*me+2*de*ge-de*he,ye=(1+de)*me+(-1.5-2*de)*ge+(-.5+de)*he+1,ve=(-1-pe)*me+(1.5+pe)*ge+.5*he,_e=pe*me-pe*ge;for(let Te=0;Te!==se;++Te)ie[Te]=Ae*oe[ce+Te]+ye*oe[le+Te]+ve*oe[ae+Te]+_e*oe[fe+Te];return ie}}class LinearInterpolant extends Interpolant{constructor(_,Z,te,ne){super(_,Z,te,ne)}interpolate_(_,Z,te,ne){const ie=this.resultBuffer,oe=this.sampleValues,se=this.valueSize,ae=_*se,le=ae-se,ce=(te-Z)/(ne-Z),fe=1-ce;for(let de=0;de!==se;++de)ie[de]=oe[le+de]*fe+oe[ae+de]*ce;return ie}}class DiscreteInterpolant extends Interpolant{constructor(_,Z,te,ne){super(_,Z,te,ne)}interpolate_(_){return this.copySampleValue_(_-1)}}class KeyframeTrack{constructor(_,Z,te,ne){if(_===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(Z===void 0||Z.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_);this.name=_,this.times=convertArray(Z,this.TimeBufferType),this.values=convertArray(te,this.ValueBufferType),this.setInterpolation(ne||this.DefaultInterpolation)}static toJSON(_){const Z=_.constructor;let te;if(Z.toJSON!==this.toJSON)te=Z.toJSON(_);else{te={name:_.name,times:convertArray(_.times,Array),values:convertArray(_.values,Array)};const ne=_.getInterpolation();ne!==_.DefaultInterpolation&&(te.interpolation=ne)}return te.type=_.ValueTypeName,te}InterpolantFactoryMethodDiscrete(_){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodLinear(_){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodSmooth(_){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_)}setInterpolation(_){let Z;switch(_){case InterpolateDiscrete:Z=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:Z=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:Z=this.InterpolantFactoryMethodSmooth;break}if(Z===void 0){const te="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(te);return console.warn("THREE.KeyframeTrack:",te),this}return this.createInterpolant=Z,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_){if(_!==0){const Z=this.times;for(let te=0,ne=Z.length;te!==ne;++te)Z[te]+=_}return this}scale(_){if(_!==1){const Z=this.times;for(let te=0,ne=Z.length;te!==ne;++te)Z[te]*=_}return this}trim(_,Z){const te=this.times,ne=te.length;let ie=0,oe=ne-1;for(;ie!==ne&&te[ie]<_;)++ie;for(;oe!==-1&&te[oe]>Z;)--oe;if(++oe,ie!==0||oe!==ne){ie>=oe&&(oe=Math.max(oe,1),ie=oe-1);const se=this.getValueSize();this.times=te.slice(ie,oe),this.values=this.values.slice(ie*se,oe*se)}return this}validate(){let _=!0;const Z=this.getValueSize();Z-Math.floor(Z)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_=!1);const te=this.times,ne=this.values,ie=te.length;ie===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_=!1);let oe=null;for(let se=0;se!==ie;se++){const ae=te[se];if(typeof ae=="number"&&isNaN(ae)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,se,ae),_=!1;break}if(oe!==null&&oe>ae){console.error("THREE.KeyframeTrack: Out of order keys.",this,se,ae,oe),_=!1;break}oe=ae}if(ne!==void 0&&isTypedArray(ne))for(let se=0,ae=ne.length;se!==ae;++se){const le=ne[se];if(isNaN(le)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,se,le),_=!1;break}}return _}optimize(){const _=this.times.slice(),Z=this.values.slice(),te=this.getValueSize(),ne=this.getInterpolation()===InterpolateSmooth,ie=_.length-1;let oe=1;for(let se=1;se<ie;++se){let ae=!1;const le=_[se],ce=_[se+1];if(le!==ce&&(se!==1||le!==_[0]))if(ne)ae=!0;else{const fe=se*te,de=fe-te,pe=fe+te;for(let he=0;he!==te;++he){const ge=Z[fe+he];if(ge!==Z[de+he]||ge!==Z[pe+he]){ae=!0;break}}}if(ae){if(se!==oe){_[oe]=_[se];const fe=se*te,de=oe*te;for(let pe=0;pe!==te;++pe)Z[de+pe]=Z[fe+pe]}++oe}}if(ie>0){_[oe]=_[ie];for(let se=ie*te,ae=oe*te,le=0;le!==te;++le)Z[ae+le]=Z[se+le];++oe}return oe!==_.length?(this.times=_.slice(0,oe),this.values=Z.slice(0,oe*te)):(this.times=_,this.values=Z),this}clone(){const _=this.times.slice(),Z=this.values.slice(),te=this.constructor,ne=new te(this.name,_,Z);return ne.createInterpolant=this.createInterpolant,ne}}KeyframeTrack.prototype.ValueTypeName="";KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{constructor(_,Z,te){super(_,Z,te)}}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{constructor(_,Z,te,ne){super(_,Z,te,ne)}}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{constructor(_,Z,te,ne){super(_,Z,te,ne)}}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_,Z,te,ne){super(_,Z,te,ne)}interpolate_(_,Z,te,ne){const ie=this.resultBuffer,oe=this.sampleValues,se=this.valueSize,ae=(te-Z)/(ne-Z);let le=_*se;for(let ce=le+se;le!==ce;le+=4)Quaternion.slerpFlat(ie,0,oe,le-se,oe,le,ae);return ie}}class QuaternionKeyframeTrack extends KeyframeTrack{constructor(_,Z,te,ne){super(_,Z,te,ne)}InterpolantFactoryMethodLinear(_){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{constructor(_,Z,te){super(_,Z,te)}}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{constructor(_,Z,te,ne){super(_,Z,te,ne)}}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_="",Z=-1,te=[],ne=NormalAnimationBlendMode){this.name=_,this.tracks=te,this.duration=Z,this.blendMode=ne,this.uuid=generateUUID$1(),this.duration<0&&this.resetDuration()}static parse(_){const Z=[],te=_.tracks,ne=1/(_.fps||1);for(let oe=0,se=te.length;oe!==se;++oe)Z.push(parseKeyframeTrack(te[oe]).scale(ne));const ie=new this(_.name,_.duration,Z,_.blendMode);return ie.uuid=_.uuid,ie}static toJSON(_){const Z=[],te=_.tracks,ne={name:_.name,duration:_.duration,tracks:Z,uuid:_.uuid,blendMode:_.blendMode};for(let ie=0,oe=te.length;ie!==oe;++ie)Z.push(KeyframeTrack.toJSON(te[ie]));return ne}static CreateFromMorphTargetSequence(_,Z,te,ne){const ie=Z.length,oe=[];for(let se=0;se<ie;se++){let ae=[],le=[];ae.push((se+ie-1)%ie,se,(se+1)%ie),le.push(0,1,0);const ce=getKeyframeOrder(ae);ae=sortedArray(ae,1,ce),le=sortedArray(le,1,ce),!ne&&ae[0]===0&&(ae.push(ie),le.push(le[0])),oe.push(new NumberKeyframeTrack(".morphTargetInfluences["+Z[se].name+"]",ae,le).scale(1/te))}return new this(_,-1,oe)}static findByName(_,Z){let te=_;if(!Array.isArray(_)){const ne=_;te=ne.geometry&&ne.geometry.animations||ne.animations}for(let ne=0;ne<te.length;ne++)if(te[ne].name===Z)return te[ne];return null}static CreateClipsFromMorphTargetSequences(_,Z,te){const ne={},ie=/^([\w-]*?)([\d]+)$/;for(let se=0,ae=_.length;se<ae;se++){const le=_[se],ce=le.name.match(ie);if(ce&&ce.length>1){const fe=ce[1];let de=ne[fe];de||(ne[fe]=de=[]),de.push(le)}}const oe=[];for(const se in ne)oe.push(this.CreateFromMorphTargetSequence(se,ne[se],Z,te));return oe}static parseAnimation(_,Z){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!_)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const te=function(fe,de,pe,he,ge){if(pe.length!==0){const me=[],Ae=[];flattenJSON(pe,me,Ae,he),me.length!==0&&ge.push(new fe(de,me,Ae))}},ne=[],ie=_.name||"default",oe=_.fps||30,se=_.blendMode;let ae=_.length||-1;const le=_.hierarchy||[];for(let fe=0;fe<le.length;fe++){const de=le[fe].keys;if(!(!de||de.length===0))if(de[0].morphTargets){const pe={};let he;for(he=0;he<de.length;he++)if(de[he].morphTargets)for(let ge=0;ge<de[he].morphTargets.length;ge++)pe[de[he].morphTargets[ge]]=-1;for(const ge in pe){const me=[],Ae=[];for(let ye=0;ye!==de[he].morphTargets.length;++ye){const ve=de[he];me.push(ve.time),Ae.push(ve.morphTarget===ge?1:0)}ne.push(new NumberKeyframeTrack(".morphTargetInfluence["+ge+"]",me,Ae))}ae=pe.length*oe}else{const pe=".bones["+Z[fe].name+"]";te(VectorKeyframeTrack,pe+".position",de,"pos",ne),te(QuaternionKeyframeTrack,pe+".quaternion",de,"rot",ne),te(VectorKeyframeTrack,pe+".scale",de,"scl",ne)}}return ne.length===0?null:new this(ie,ae,ne,se)}resetDuration(){const _=this.tracks;let Z=0;for(let te=0,ne=_.length;te!==ne;++te){const ie=this.tracks[te];Z=Math.max(Z,ie.times[ie.times.length-1])}return this.duration=Z,this}trim(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].trim(0,this.duration);return this}validate(){let _=!0;for(let Z=0;Z<this.tracks.length;Z++)_=_&&this.tracks[Z].validate();return _}optimize(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].optimize();return this}clone(){const _=[];for(let Z=0;Z<this.tracks.length;Z++)_.push(this.tracks[Z].clone());return new this.constructor(this.name,this.duration,_,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(K){switch(K.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+K)}function parseKeyframeTrack(K){if(K.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _=getTrackTypeForValueTypeName(K.type);if(K.times===void 0){const Z=[],te=[];flattenJSON(K.keys,Z,te,"value"),K.times=Z,K.values=te}return _.parse!==void 0?_.parse(K):new _(K.name,K.times,K.values,K.interpolation)}const Cache={enabled:!1,files:{},add:function(K,_){this.enabled!==!1&&(this.files[K]=_)},get:function(K){if(this.enabled!==!1)return this.files[K]},remove:function(K){delete this.files[K]},clear:function(){this.files={}}};class LoadingManager{constructor(_,Z,te){const ne=this;let ie=!1,oe=0,se=0,ae;const le=[];this.onStart=void 0,this.onLoad=_,this.onProgress=Z,this.onError=te,this.itemStart=function(ce){se++,ie===!1&&ne.onStart!==void 0&&ne.onStart(ce,oe,se),ie=!0},this.itemEnd=function(ce){oe++,ne.onProgress!==void 0&&ne.onProgress(ce,oe,se),oe===se&&(ie=!1,ne.onLoad!==void 0&&ne.onLoad())},this.itemError=function(ce){ne.onError!==void 0&&ne.onError(ce)},this.resolveURL=function(ce){return ae?ae(ce):ce},this.setURLModifier=function(ce){return ae=ce,this},this.addHandler=function(ce,fe){return le.push(ce,fe),this},this.removeHandler=function(ce){const fe=le.indexOf(ce);return fe!==-1&&le.splice(fe,2),this},this.getHandler=function(ce){for(let fe=0,de=le.length;fe<de;fe+=2){const pe=le[fe],he=le[fe+1];if(pe.global&&(pe.lastIndex=0),pe.test(ce))return he}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_){this.manager=_!==void 0?_:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_,Z){const te=this;return new Promise(function(ne,ie){te.load(_,ne,Z,ie)})}parse(){}setCrossOrigin(_){return this.crossOrigin=_,this}setWithCredentials(_){return this.withCredentials=_,this}setPath(_){return this.path=_,this}setResourcePath(_){return this.resourcePath=_,this}setRequestHeader(_){return this.requestHeader=_,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_,Z){super(_),this.response=Z}}class FileLoader extends Loader{constructor(_){super(_),this.mimeType="",this.responseType=""}load(_,Z,te,ne){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const ie=Cache.get(_);if(ie!==void 0)return this.manager.itemStart(_),setTimeout(()=>{Z&&Z(ie),this.manager.itemEnd(_)},0),ie;if(loading[_]!==void 0){loading[_].push({onLoad:Z,onProgress:te,onError:ne});return}loading[_]=[],loading[_].push({onLoad:Z,onProgress:te,onError:ne});const oe=new Request(_,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),se=this.mimeType,ae=this.responseType;fetch(oe).then(le=>{if(le.status===200||le.status===0){if(le.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||le.body===void 0||le.body.getReader===void 0)return le;const ce=loading[_],fe=le.body.getReader(),de=le.headers.get("X-File-Size")||le.headers.get("Content-Length"),pe=de?parseInt(de):0,he=pe!==0;let ge=0;const me=new ReadableStream({start(Ae){ye();function ye(){fe.read().then(({done:ve,value:_e})=>{if(ve)Ae.close();else{ge+=_e.byteLength;const Te=new ProgressEvent("progress",{lengthComputable:he,loaded:ge,total:pe});for(let be=0,Re=ce.length;be<Re;be++){const we=ce[be];we.onProgress&&we.onProgress(Te)}Ae.enqueue(_e),ye()}},ve=>{Ae.error(ve)})}}});return new Response(me)}else throw new HttpError(`fetch for "${le.url}" responded with ${le.status}: ${le.statusText}`,le)}).then(le=>{switch(ae){case"arraybuffer":return le.arrayBuffer();case"blob":return le.blob();case"document":return le.text().then(ce=>new DOMParser().parseFromString(ce,se));case"json":return le.json();default:if(se==="")return le.text();{const fe=/charset="?([^;"\s]*)"?/i.exec(se),de=fe&&fe[1]?fe[1].toLowerCase():void 0,pe=new TextDecoder(de);return le.arrayBuffer().then(he=>pe.decode(he))}}}).then(le=>{Cache.add(_,le);const ce=loading[_];delete loading[_];for(let fe=0,de=ce.length;fe<de;fe++){const pe=ce[fe];pe.onLoad&&pe.onLoad(le)}}).catch(le=>{const ce=loading[_];if(ce===void 0)throw this.manager.itemError(_),le;delete loading[_];for(let fe=0,de=ce.length;fe<de;fe++){const pe=ce[fe];pe.onError&&pe.onError(le)}this.manager.itemError(_)}).finally(()=>{this.manager.itemEnd(_)}),this.manager.itemStart(_)}setResponseType(_){return this.responseType=_,this}setMimeType(_){return this.mimeType=_,this}}class AnimationLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=new FileLoader(this.manager);oe.setPath(this.path),oe.setRequestHeader(this.requestHeader),oe.setWithCredentials(this.withCredentials),oe.load(_,function(se){try{Z(ie.parse(JSON.parse(se)))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}parse(_){const Z=[];for(let te=0;te<_.length;te++){const ne=AnimationClip.parse(_[te]);Z.push(ne)}return Z}}class CompressedTextureLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=[],se=new CompressedTexture,ae=new FileLoader(this.manager);ae.setPath(this.path),ae.setResponseType("arraybuffer"),ae.setRequestHeader(this.requestHeader),ae.setWithCredentials(ie.withCredentials);let le=0;function ce(fe){ae.load(_[fe],function(de){const pe=ie.parse(de,!0);oe[fe]={width:pe.width,height:pe.height,format:pe.format,mipmaps:pe.mipmaps},le+=1,le===6&&(pe.mipmapCount===1&&(se.minFilter=LinearFilter),se.image=oe,se.format=pe.format,se.needsUpdate=!0,Z&&Z(se))},te,ne)}if(Array.isArray(_))for(let fe=0,de=_.length;fe<de;++fe)ce(fe);else ae.load(_,function(fe){const de=ie.parse(fe,!0);if(de.isCubemap){const pe=de.mipmaps.length/de.mipmapCount;for(let he=0;he<pe;he++){oe[he]={mipmaps:[]};for(let ge=0;ge<de.mipmapCount;ge++)oe[he].mipmaps.push(de.mipmaps[he*de.mipmapCount+ge]),oe[he].format=de.format,oe[he].width=de.width,oe[he].height=de.height}se.image=oe}else se.image.width=de.width,se.image.height=de.height,se.mipmaps=de.mipmaps;de.mipmapCount===1&&(se.minFilter=LinearFilter),se.format=de.format,se.needsUpdate=!0,Z&&Z(se)},te,ne);return se}}class ImageLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const ie=this,oe=Cache.get(_);if(oe!==void 0)return ie.manager.itemStart(_),setTimeout(function(){Z&&Z(oe),ie.manager.itemEnd(_)},0),oe;const se=createElementNS("img");function ae(){ce(),Cache.add(_,this),Z&&Z(this),ie.manager.itemEnd(_)}function le(fe){ce(),ne&&ne(fe),ie.manager.itemError(_),ie.manager.itemEnd(_)}function ce(){se.removeEventListener("load",ae,!1),se.removeEventListener("error",le,!1)}return se.addEventListener("load",ae,!1),se.addEventListener("error",le,!1),_.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(se.crossOrigin=this.crossOrigin),ie.manager.itemStart(_),se.src=_,se}}class CubeTextureLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=new CubeTexture;ie.colorSpace=SRGBColorSpace$2;const oe=new ImageLoader(this.manager);oe.setCrossOrigin(this.crossOrigin),oe.setPath(this.path);let se=0;function ae(le){oe.load(_[le],function(ce){ie.images[le]=ce,se++,se===6&&(ie.needsUpdate=!0,Z&&Z(ie))},void 0,ne)}for(let le=0;le<_.length;++le)ae(le);return ie}}class DataTextureLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=new DataTexture,se=new FileLoader(this.manager);return se.setResponseType("arraybuffer"),se.setRequestHeader(this.requestHeader),se.setPath(this.path),se.setWithCredentials(ie.withCredentials),se.load(_,function(ae){let le;try{le=ie.parse(ae)}catch(ce){if(ne!==void 0)ne(ce);else{console.error(ce);return}}le.image!==void 0?oe.image=le.image:le.data!==void 0&&(oe.image.width=le.width,oe.image.height=le.height,oe.image.data=le.data),oe.wrapS=le.wrapS!==void 0?le.wrapS:ClampToEdgeWrapping,oe.wrapT=le.wrapT!==void 0?le.wrapT:ClampToEdgeWrapping,oe.magFilter=le.magFilter!==void 0?le.magFilter:LinearFilter,oe.minFilter=le.minFilter!==void 0?le.minFilter:LinearFilter,oe.anisotropy=le.anisotropy!==void 0?le.anisotropy:1,le.colorSpace!==void 0&&(oe.colorSpace=le.colorSpace),le.flipY!==void 0&&(oe.flipY=le.flipY),le.format!==void 0&&(oe.format=le.format),le.type!==void 0&&(oe.type=le.type),le.mipmaps!==void 0&&(oe.mipmaps=le.mipmaps,oe.minFilter=LinearMipmapLinearFilter),le.mipmapCount===1&&(oe.minFilter=LinearFilter),le.generateMipmaps!==void 0&&(oe.generateMipmaps=le.generateMipmaps),oe.needsUpdate=!0,Z&&Z(oe,le)},te,ne),oe}}class TextureLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=new Texture$1,oe=new ImageLoader(this.manager);return oe.setCrossOrigin(this.crossOrigin),oe.setPath(this.path),oe.load(_,function(se){ie.image=se,ie.needsUpdate=!0,Z!==void 0&&Z(ie)},te,ne),ie}}class Light extends Object3D{constructor(_,Z=1){super(),this.isLight=!0,this.type="Light",this.color=new Color$1(_),this.intensity=Z}dispose(){}copy(_,Z){return super.copy(_,Z),this.color.copy(_.color),this.intensity=_.intensity,this}toJSON(_){const Z=super.toJSON(_);return Z.object.color=this.color.getHex(),Z.object.intensity=this.intensity,this.groundColor!==void 0&&(Z.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(Z.object.distance=this.distance),this.angle!==void 0&&(Z.object.angle=this.angle),this.decay!==void 0&&(Z.object.decay=this.decay),this.penumbra!==void 0&&(Z.object.penumbra=this.penumbra),this.shadow!==void 0&&(Z.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(Z.object.target=this.target.uuid),Z}}let HemisphereLight$1=class extends Light{constructor(_,Z,te){super(_,te),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color$1(Z)}copy(_,Z){return super.copy(_,Z),this.groundColor.copy(_.groundColor),this}};const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_){this.camera=_,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum$1,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_){const Z=this.camera,te=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_.matrixWorld),Z.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_.target.matrixWorld),Z.lookAt(_lookTarget$1),Z.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(Z.projectionMatrix,Z.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),te.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),te.multiply(_projScreenMatrix$1)}getViewport(_){return this._viewports[_]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_){return this.camera=_.camera.clone(),this.intensity=_.intensity,this.bias=_.bias,this.radius=_.radius,this.mapSize.copy(_.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _={};return this.intensity!==1&&(_.intensity=this.intensity),this.bias!==0&&(_.bias=this.bias),this.normalBias!==0&&(_.normalBias=this.normalBias),this.radius!==1&&(_.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_.mapSize=this.mapSize.toArray()),_.camera=this.camera.toJSON(!1).object,delete _.camera.matrix,_}}let SpotLightShadow$1=class extends LightShadow{constructor(){super(new PerspectiveCamera$2(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_){const Z=this.camera,te=RAD2DEG*2*_.angle*this.focus,ne=this.mapSize.width/this.mapSize.height,ie=_.distance||Z.far;(te!==Z.fov||ne!==Z.aspect||ie!==Z.far)&&(Z.fov=te,Z.aspect=ne,Z.far=ie,Z.updateProjectionMatrix()),super.updateMatrices(_)}copy(_){return super.copy(_),this.focus=_.focus,this}},SpotLight$2=class extends Light{constructor(_,Z,te=0,ne=Math.PI/3,ie=0,oe=2){super(_,Z),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=te,this.angle=ne,this.penumbra=ie,this.decay=oe,this.map=null,this.shadow=new SpotLightShadow$1}get power(){return this.intensity*Math.PI}set power(_){this.intensity=_/Math.PI}dispose(){this.shadow.dispose()}copy(_,Z){return super.copy(_,Z),this.distance=_.distance,this.angle=_.angle,this.penumbra=_.penumbra,this.decay=_.decay,this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}};const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera$2(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_,Z=0){const te=this.camera,ne=this.matrix,ie=_.distance||te.far;ie!==te.far&&(te.far=ie,te.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_.matrixWorld),te.position.copy(_lightPositionWorld),_lookTarget.copy(te.position),_lookTarget.add(this._cubeDirections[Z]),te.up.copy(this._cubeUps[Z]),te.lookAt(_lookTarget),te.updateMatrixWorld(),ne.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(te.projectionMatrix,te.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}let PointLight$1=class extends Light{constructor(_,Z,te=0,ne=2){super(_,Z),this.isPointLight=!0,this.type="PointLight",this.distance=te,this.decay=ne,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_){this.intensity=_/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_,Z){return super.copy(_,Z),this.distance=_.distance,this.decay=_.decay,this.shadow=_.shadow.clone(),this}},OrthographicCamera$1=class extends Camera$1{constructor(_=-1,Z=1,te=1,ne=-1,ie=.1,oe=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_,this.right=Z,this.top=te,this.bottom=ne,this.near=ie,this.far=oe,this.updateProjectionMatrix()}copy(_,Z){return super.copy(_,Z),this.left=_.left,this.right=_.right,this.top=_.top,this.bottom=_.bottom,this.near=_.near,this.far=_.far,this.zoom=_.zoom,this.view=_.view===null?null:Object.assign({},_.view),this}setViewOffset(_,Z,te,ne,ie,oe){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=Z,this.view.offsetX=te,this.view.offsetY=ne,this.view.width=ie,this.view.height=oe,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=(this.right-this.left)/(2*this.zoom),Z=(this.top-this.bottom)/(2*this.zoom),te=(this.right+this.left)/2,ne=(this.top+this.bottom)/2;let ie=te-_,oe=te+_,se=ne+Z,ae=ne-Z;if(this.view!==null&&this.view.enabled){const le=(this.right-this.left)/this.view.fullWidth/this.zoom,ce=(this.top-this.bottom)/this.view.fullHeight/this.zoom;ie+=le*this.view.offsetX,oe=ie+le*this.view.width,se-=ce*this.view.offsetY,ae=se-ce*this.view.height}this.projectionMatrix.makeOrthographic(ie,oe,se,ae,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const Z=super.toJSON(_);return Z.object.zoom=this.zoom,Z.object.left=this.left,Z.object.right=this.right,Z.object.top=this.top,Z.object.bottom=this.bottom,Z.object.near=this.near,Z.object.far=this.far,this.view!==null&&(Z.object.view=Object.assign({},this.view)),Z}};class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera$1(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}let DirectionalLight$1=class extends Light{constructor(_,Z){super(_,Z),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_){return super.copy(_),this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}},AmbientLight$1=class extends Light{constructor(_,Z){super(_,Z),this.isAmbientLight=!0,this.type="AmbientLight"}},RectAreaLight$1=class extends Light{constructor(_,Z,te=10,ne=10){super(_,Z),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=te,this.height=ne}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_){this.intensity=_/(this.width*this.height*Math.PI)}copy(_){return super.copy(_),this.width=_.width,this.height=_.height,this}toJSON(_){const Z=super.toJSON(_);return Z.object.width=this.width,Z.object.height=this.height,Z}};class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _=0;_<9;_++)this.coefficients.push(new Vector3)}set(_){for(let Z=0;Z<9;Z++)this.coefficients[Z].copy(_[Z]);return this}zero(){for(let _=0;_<9;_++)this.coefficients[_].set(0,0,0);return this}getAt(_,Z){const te=_.x,ne=_.y,ie=_.z,oe=this.coefficients;return Z.copy(oe[0]).multiplyScalar(.282095),Z.addScaledVector(oe[1],.488603*ne),Z.addScaledVector(oe[2],.488603*ie),Z.addScaledVector(oe[3],.488603*te),Z.addScaledVector(oe[4],1.092548*(te*ne)),Z.addScaledVector(oe[5],1.092548*(ne*ie)),Z.addScaledVector(oe[6],.315392*(3*ie*ie-1)),Z.addScaledVector(oe[7],1.092548*(te*ie)),Z.addScaledVector(oe[8],.546274*(te*te-ne*ne)),Z}getIrradianceAt(_,Z){const te=_.x,ne=_.y,ie=_.z,oe=this.coefficients;return Z.copy(oe[0]).multiplyScalar(.886227),Z.addScaledVector(oe[1],2*.511664*ne),Z.addScaledVector(oe[2],2*.511664*ie),Z.addScaledVector(oe[3],2*.511664*te),Z.addScaledVector(oe[4],2*.429043*te*ne),Z.addScaledVector(oe[5],2*.429043*ne*ie),Z.addScaledVector(oe[6],.743125*ie*ie-.247708),Z.addScaledVector(oe[7],2*.429043*te*ie),Z.addScaledVector(oe[8],.429043*(te*te-ne*ne)),Z}add(_){for(let Z=0;Z<9;Z++)this.coefficients[Z].add(_.coefficients[Z]);return this}addScaledSH(_,Z){for(let te=0;te<9;te++)this.coefficients[te].addScaledVector(_.coefficients[te],Z);return this}scale(_){for(let Z=0;Z<9;Z++)this.coefficients[Z].multiplyScalar(_);return this}lerp(_,Z){for(let te=0;te<9;te++)this.coefficients[te].lerp(_.coefficients[te],Z);return this}equals(_){for(let Z=0;Z<9;Z++)if(!this.coefficients[Z].equals(_.coefficients[Z]))return!1;return!0}copy(_){return this.set(_.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_,Z=0){const te=this.coefficients;for(let ne=0;ne<9;ne++)te[ne].fromArray(_,Z+ne*3);return this}toArray(_=[],Z=0){const te=this.coefficients;for(let ne=0;ne<9;ne++)te[ne].toArray(_,Z+ne*3);return _}static getBasisAt(_,Z){const te=_.x,ne=_.y,ie=_.z;Z[0]=.282095,Z[1]=.488603*ne,Z[2]=.488603*ie,Z[3]=.488603*te,Z[4]=1.092548*te*ne,Z[5]=1.092548*ne*ie,Z[6]=.315392*(3*ie*ie-1),Z[7]=1.092548*te*ie,Z[8]=.546274*(te*te-ne*ne)}}class LightProbe extends Light{constructor(_=new SphericalHarmonics3,Z=1){super(void 0,Z),this.isLightProbe=!0,this.sh=_}copy(_){return super.copy(_),this.sh.copy(_.sh),this}fromJSON(_){return this.intensity=_.intensity,this.sh.fromArray(_.sh),this}toJSON(_){const Z=super.toJSON(_);return Z.object.sh=this.sh.toArray(),Z}}class MaterialLoader extends Loader{constructor(_){super(_),this.textures={}}load(_,Z,te,ne){const ie=this,oe=new FileLoader(ie.manager);oe.setPath(ie.path),oe.setRequestHeader(ie.requestHeader),oe.setWithCredentials(ie.withCredentials),oe.load(_,function(se){try{Z(ie.parse(JSON.parse(se)))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}parse(_){const Z=this.textures;function te(ie){return Z[ie]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",ie),Z[ie]}const ne=this.createMaterialFromType(_.type);if(_.uuid!==void 0&&(ne.uuid=_.uuid),_.name!==void 0&&(ne.name=_.name),_.color!==void 0&&ne.color!==void 0&&ne.color.setHex(_.color),_.roughness!==void 0&&(ne.roughness=_.roughness),_.metalness!==void 0&&(ne.metalness=_.metalness),_.sheen!==void 0&&(ne.sheen=_.sheen),_.sheenColor!==void 0&&(ne.sheenColor=new Color$1().setHex(_.sheenColor)),_.sheenRoughness!==void 0&&(ne.sheenRoughness=_.sheenRoughness),_.emissive!==void 0&&ne.emissive!==void 0&&ne.emissive.setHex(_.emissive),_.specular!==void 0&&ne.specular!==void 0&&ne.specular.setHex(_.specular),_.specularIntensity!==void 0&&(ne.specularIntensity=_.specularIntensity),_.specularColor!==void 0&&ne.specularColor!==void 0&&ne.specularColor.setHex(_.specularColor),_.shininess!==void 0&&(ne.shininess=_.shininess),_.clearcoat!==void 0&&(ne.clearcoat=_.clearcoat),_.clearcoatRoughness!==void 0&&(ne.clearcoatRoughness=_.clearcoatRoughness),_.dispersion!==void 0&&(ne.dispersion=_.dispersion),_.iridescence!==void 0&&(ne.iridescence=_.iridescence),_.iridescenceIOR!==void 0&&(ne.iridescenceIOR=_.iridescenceIOR),_.iridescenceThicknessRange!==void 0&&(ne.iridescenceThicknessRange=_.iridescenceThicknessRange),_.transmission!==void 0&&(ne.transmission=_.transmission),_.thickness!==void 0&&(ne.thickness=_.thickness),_.attenuationDistance!==void 0&&(ne.attenuationDistance=_.attenuationDistance),_.attenuationColor!==void 0&&ne.attenuationColor!==void 0&&ne.attenuationColor.setHex(_.attenuationColor),_.anisotropy!==void 0&&(ne.anisotropy=_.anisotropy),_.anisotropyRotation!==void 0&&(ne.anisotropyRotation=_.anisotropyRotation),_.fog!==void 0&&(ne.fog=_.fog),_.flatShading!==void 0&&(ne.flatShading=_.flatShading),_.blending!==void 0&&(ne.blending=_.blending),_.combine!==void 0&&(ne.combine=_.combine),_.side!==void 0&&(ne.side=_.side),_.shadowSide!==void 0&&(ne.shadowSide=_.shadowSide),_.opacity!==void 0&&(ne.opacity=_.opacity),_.transparent!==void 0&&(ne.transparent=_.transparent),_.alphaTest!==void 0&&(ne.alphaTest=_.alphaTest),_.alphaHash!==void 0&&(ne.alphaHash=_.alphaHash),_.depthFunc!==void 0&&(ne.depthFunc=_.depthFunc),_.depthTest!==void 0&&(ne.depthTest=_.depthTest),_.depthWrite!==void 0&&(ne.depthWrite=_.depthWrite),_.colorWrite!==void 0&&(ne.colorWrite=_.colorWrite),_.blendSrc!==void 0&&(ne.blendSrc=_.blendSrc),_.blendDst!==void 0&&(ne.blendDst=_.blendDst),_.blendEquation!==void 0&&(ne.blendEquation=_.blendEquation),_.blendSrcAlpha!==void 0&&(ne.blendSrcAlpha=_.blendSrcAlpha),_.blendDstAlpha!==void 0&&(ne.blendDstAlpha=_.blendDstAlpha),_.blendEquationAlpha!==void 0&&(ne.blendEquationAlpha=_.blendEquationAlpha),_.blendColor!==void 0&&ne.blendColor!==void 0&&ne.blendColor.setHex(_.blendColor),_.blendAlpha!==void 0&&(ne.blendAlpha=_.blendAlpha),_.stencilWriteMask!==void 0&&(ne.stencilWriteMask=_.stencilWriteMask),_.stencilFunc!==void 0&&(ne.stencilFunc=_.stencilFunc),_.stencilRef!==void 0&&(ne.stencilRef=_.stencilRef),_.stencilFuncMask!==void 0&&(ne.stencilFuncMask=_.stencilFuncMask),_.stencilFail!==void 0&&(ne.stencilFail=_.stencilFail),_.stencilZFail!==void 0&&(ne.stencilZFail=_.stencilZFail),_.stencilZPass!==void 0&&(ne.stencilZPass=_.stencilZPass),_.stencilWrite!==void 0&&(ne.stencilWrite=_.stencilWrite),_.wireframe!==void 0&&(ne.wireframe=_.wireframe),_.wireframeLinewidth!==void 0&&(ne.wireframeLinewidth=_.wireframeLinewidth),_.wireframeLinecap!==void 0&&(ne.wireframeLinecap=_.wireframeLinecap),_.wireframeLinejoin!==void 0&&(ne.wireframeLinejoin=_.wireframeLinejoin),_.rotation!==void 0&&(ne.rotation=_.rotation),_.linewidth!==void 0&&(ne.linewidth=_.linewidth),_.dashSize!==void 0&&(ne.dashSize=_.dashSize),_.gapSize!==void 0&&(ne.gapSize=_.gapSize),_.scale!==void 0&&(ne.scale=_.scale),_.polygonOffset!==void 0&&(ne.polygonOffset=_.polygonOffset),_.polygonOffsetFactor!==void 0&&(ne.polygonOffsetFactor=_.polygonOffsetFactor),_.polygonOffsetUnits!==void 0&&(ne.polygonOffsetUnits=_.polygonOffsetUnits),_.dithering!==void 0&&(ne.dithering=_.dithering),_.alphaToCoverage!==void 0&&(ne.alphaToCoverage=_.alphaToCoverage),_.premultipliedAlpha!==void 0&&(ne.premultipliedAlpha=_.premultipliedAlpha),_.forceSinglePass!==void 0&&(ne.forceSinglePass=_.forceSinglePass),_.visible!==void 0&&(ne.visible=_.visible),_.toneMapped!==void 0&&(ne.toneMapped=_.toneMapped),_.userData!==void 0&&(ne.userData=_.userData),_.vertexColors!==void 0&&(typeof _.vertexColors=="number"?ne.vertexColors=_.vertexColors>0:ne.vertexColors=_.vertexColors),_.uniforms!==void 0)for(const ie in _.uniforms){const oe=_.uniforms[ie];switch(ne.uniforms[ie]={},oe.type){case"t":ne.uniforms[ie].value=te(oe.value);break;case"c":ne.uniforms[ie].value=new Color$1().setHex(oe.value);break;case"v2":ne.uniforms[ie].value=new Vector2().fromArray(oe.value);break;case"v3":ne.uniforms[ie].value=new Vector3().fromArray(oe.value);break;case"v4":ne.uniforms[ie].value=new Vector4().fromArray(oe.value);break;case"m3":ne.uniforms[ie].value=new Matrix3().fromArray(oe.value);break;case"m4":ne.uniforms[ie].value=new Matrix4().fromArray(oe.value);break;default:ne.uniforms[ie].value=oe.value}}if(_.defines!==void 0&&(ne.defines=_.defines),_.vertexShader!==void 0&&(ne.vertexShader=_.vertexShader),_.fragmentShader!==void 0&&(ne.fragmentShader=_.fragmentShader),_.glslVersion!==void 0&&(ne.glslVersion=_.glslVersion),_.extensions!==void 0)for(const ie in _.extensions)ne.extensions[ie]=_.extensions[ie];if(_.lights!==void 0&&(ne.lights=_.lights),_.clipping!==void 0&&(ne.clipping=_.clipping),_.size!==void 0&&(ne.size=_.size),_.sizeAttenuation!==void 0&&(ne.sizeAttenuation=_.sizeAttenuation),_.map!==void 0&&(ne.map=te(_.map)),_.matcap!==void 0&&(ne.matcap=te(_.matcap)),_.alphaMap!==void 0&&(ne.alphaMap=te(_.alphaMap)),_.bumpMap!==void 0&&(ne.bumpMap=te(_.bumpMap)),_.bumpScale!==void 0&&(ne.bumpScale=_.bumpScale),_.normalMap!==void 0&&(ne.normalMap=te(_.normalMap)),_.normalMapType!==void 0&&(ne.normalMapType=_.normalMapType),_.normalScale!==void 0){let ie=_.normalScale;Array.isArray(ie)===!1&&(ie=[ie,ie]),ne.normalScale=new Vector2().fromArray(ie)}return _.displacementMap!==void 0&&(ne.displacementMap=te(_.displacementMap)),_.displacementScale!==void 0&&(ne.displacementScale=_.displacementScale),_.displacementBias!==void 0&&(ne.displacementBias=_.displacementBias),_.roughnessMap!==void 0&&(ne.roughnessMap=te(_.roughnessMap)),_.metalnessMap!==void 0&&(ne.metalnessMap=te(_.metalnessMap)),_.emissiveMap!==void 0&&(ne.emissiveMap=te(_.emissiveMap)),_.emissiveIntensity!==void 0&&(ne.emissiveIntensity=_.emissiveIntensity),_.specularMap!==void 0&&(ne.specularMap=te(_.specularMap)),_.specularIntensityMap!==void 0&&(ne.specularIntensityMap=te(_.specularIntensityMap)),_.specularColorMap!==void 0&&(ne.specularColorMap=te(_.specularColorMap)),_.envMap!==void 0&&(ne.envMap=te(_.envMap)),_.envMapRotation!==void 0&&ne.envMapRotation.fromArray(_.envMapRotation),_.envMapIntensity!==void 0&&(ne.envMapIntensity=_.envMapIntensity),_.reflectivity!==void 0&&(ne.reflectivity=_.reflectivity),_.refractionRatio!==void 0&&(ne.refractionRatio=_.refractionRatio),_.lightMap!==void 0&&(ne.lightMap=te(_.lightMap)),_.lightMapIntensity!==void 0&&(ne.lightMapIntensity=_.lightMapIntensity),_.aoMap!==void 0&&(ne.aoMap=te(_.aoMap)),_.aoMapIntensity!==void 0&&(ne.aoMapIntensity=_.aoMapIntensity),_.gradientMap!==void 0&&(ne.gradientMap=te(_.gradientMap)),_.clearcoatMap!==void 0&&(ne.clearcoatMap=te(_.clearcoatMap)),_.clearcoatRoughnessMap!==void 0&&(ne.clearcoatRoughnessMap=te(_.clearcoatRoughnessMap)),_.clearcoatNormalMap!==void 0&&(ne.clearcoatNormalMap=te(_.clearcoatNormalMap)),_.clearcoatNormalScale!==void 0&&(ne.clearcoatNormalScale=new Vector2().fromArray(_.clearcoatNormalScale)),_.iridescenceMap!==void 0&&(ne.iridescenceMap=te(_.iridescenceMap)),_.iridescenceThicknessMap!==void 0&&(ne.iridescenceThicknessMap=te(_.iridescenceThicknessMap)),_.transmissionMap!==void 0&&(ne.transmissionMap=te(_.transmissionMap)),_.thicknessMap!==void 0&&(ne.thicknessMap=te(_.thicknessMap)),_.anisotropyMap!==void 0&&(ne.anisotropyMap=te(_.anisotropyMap)),_.sheenColorMap!==void 0&&(ne.sheenColorMap=te(_.sheenColorMap)),_.sheenRoughnessMap!==void 0&&(ne.sheenRoughnessMap=te(_.sheenRoughnessMap)),ne}setTextures(_){return this.textures=_,this}createMaterialFromType(_){return MaterialLoader.createMaterialFromType(_)}static createMaterialFromType(_){const Z={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new Z[_]}}class LoaderUtils{static extractUrlBase(_){const Z=_.lastIndexOf("/");return Z===-1?"./":_.slice(0,Z+1)}static resolveURL(_,Z){return typeof _!="string"||_===""?"":(/^https?:\/\//i.test(Z)&&/^\//.test(_)&&(Z=Z.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_)||/^data:.*,.*$/i.test(_)||/^blob:.*$/i.test(_)?_:Z+_)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_){return super.copy(_),this.instanceCount=_.instanceCount,this}toJSON(){const _=super.toJSON();return _.instanceCount=this.instanceCount,_.isInstancedBufferGeometry=!0,_}}class BufferGeometryLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=new FileLoader(ie.manager);oe.setPath(ie.path),oe.setRequestHeader(ie.requestHeader),oe.setWithCredentials(ie.withCredentials),oe.load(_,function(se){try{Z(ie.parse(JSON.parse(se)))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}parse(_){const Z={},te={};function ne(pe,he){if(Z[he]!==void 0)return Z[he];const me=pe.interleavedBuffers[he],Ae=ie(pe,me.buffer),ye=getTypedArray(me.type,Ae),ve=new InterleavedBuffer(ye,me.stride);return ve.uuid=me.uuid,Z[he]=ve,ve}function ie(pe,he){if(te[he]!==void 0)return te[he];const me=pe.arrayBuffers[he],Ae=new Uint32Array(me).buffer;return te[he]=Ae,Ae}const oe=_.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,se=_.data.index;if(se!==void 0){const pe=getTypedArray(se.type,se.array);oe.setIndex(new BufferAttribute(pe,1))}const ae=_.data.attributes;for(const pe in ae){const he=ae[pe];let ge;if(he.isInterleavedBufferAttribute){const me=ne(_.data,he.data);ge=new InterleavedBufferAttribute(me,he.itemSize,he.offset,he.normalized)}else{const me=getTypedArray(he.type,he.array),Ae=he.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;ge=new Ae(me,he.itemSize,he.normalized)}he.name!==void 0&&(ge.name=he.name),he.usage!==void 0&&ge.setUsage(he.usage),oe.setAttribute(pe,ge)}const le=_.data.morphAttributes;if(le)for(const pe in le){const he=le[pe],ge=[];for(let me=0,Ae=he.length;me<Ae;me++){const ye=he[me];let ve;if(ye.isInterleavedBufferAttribute){const _e=ne(_.data,ye.data);ve=new InterleavedBufferAttribute(_e,ye.itemSize,ye.offset,ye.normalized)}else{const _e=getTypedArray(ye.type,ye.array);ve=new BufferAttribute(_e,ye.itemSize,ye.normalized)}ye.name!==void 0&&(ve.name=ye.name),ge.push(ve)}oe.morphAttributes[pe]=ge}_.data.morphTargetsRelative&&(oe.morphTargetsRelative=!0);const fe=_.data.groups||_.data.drawcalls||_.data.offsets;if(fe!==void 0)for(let pe=0,he=fe.length;pe!==he;++pe){const ge=fe[pe];oe.addGroup(ge.start,ge.count,ge.materialIndex)}const de=_.data.boundingSphere;if(de!==void 0){const pe=new Vector3;de.center!==void 0&&pe.fromArray(de.center),oe.boundingSphere=new Sphere$2(pe,de.radius)}return _.name&&(oe.name=_.name),_.userData&&(oe.userData=_.userData),oe}}class ObjectLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||oe;const se=new FileLoader(this.manager);se.setPath(this.path),se.setRequestHeader(this.requestHeader),se.setWithCredentials(this.withCredentials),se.load(_,function(ae){let le=null;try{le=JSON.parse(ae)}catch(fe){ne!==void 0&&ne(fe),console.error("THREE:ObjectLoader: Can't parse "+_+".",fe.message);return}const ce=le.metadata;if(ce===void 0||ce.type===void 0||ce.type.toLowerCase()==="geometry"){ne!==void 0&&ne(new Error("THREE.ObjectLoader: Can't load "+_)),console.error("THREE.ObjectLoader: Can't load "+_);return}ie.parse(le,Z)},te,ne)}async loadAsync(_,Z){const te=this,ne=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||ne;const ie=new FileLoader(this.manager);ie.setPath(this.path),ie.setRequestHeader(this.requestHeader),ie.setWithCredentials(this.withCredentials);const oe=await ie.loadAsync(_,Z),se=JSON.parse(oe),ae=se.metadata;if(ae===void 0||ae.type===void 0||ae.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_);return await te.parseAsync(se)}parse(_,Z){const te=this.parseAnimations(_.animations),ne=this.parseShapes(_.shapes),ie=this.parseGeometries(_.geometries,ne),oe=this.parseImages(_.images,function(){Z!==void 0&&Z(le)}),se=this.parseTextures(_.textures,oe),ae=this.parseMaterials(_.materials,se),le=this.parseObject(_.object,ie,ae,se,te),ce=this.parseSkeletons(_.skeletons,le);if(this.bindSkeletons(le,ce),this.bindLightTargets(le),Z!==void 0){let fe=!1;for(const de in oe)if(oe[de].data instanceof HTMLImageElement){fe=!0;break}fe===!1&&Z(le)}return le}async parseAsync(_){const Z=this.parseAnimations(_.animations),te=this.parseShapes(_.shapes),ne=this.parseGeometries(_.geometries,te),ie=await this.parseImagesAsync(_.images),oe=this.parseTextures(_.textures,ie),se=this.parseMaterials(_.materials,oe),ae=this.parseObject(_.object,ne,se,oe,Z),le=this.parseSkeletons(_.skeletons,ae);return this.bindSkeletons(ae,le),this.bindLightTargets(ae),ae}parseShapes(_){const Z={};if(_!==void 0)for(let te=0,ne=_.length;te<ne;te++){const ie=new Shape$2().fromJSON(_[te]);Z[ie.uuid]=ie}return Z}parseSkeletons(_,Z){const te={},ne={};if(Z.traverse(function(ie){ie.isBone&&(ne[ie.uuid]=ie)}),_!==void 0)for(let ie=0,oe=_.length;ie<oe;ie++){const se=new Skeleton().fromJSON(_[ie],ne);te[se.uuid]=se}return te}parseGeometries(_,Z){const te={};if(_!==void 0){const ne=new BufferGeometryLoader;for(let ie=0,oe=_.length;ie<oe;ie++){let se;const ae=_[ie];switch(ae.type){case"BufferGeometry":case"InstancedBufferGeometry":se=ne.parse(ae);break;default:ae.type in Geometries?se=Geometries[ae.type].fromJSON(ae,Z):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${ae.type}"`)}se.uuid=ae.uuid,ae.name!==void 0&&(se.name=ae.name),ae.userData!==void 0&&(se.userData=ae.userData),te[ae.uuid]=se}}return te}parseMaterials(_,Z){const te={},ne={};if(_!==void 0){const ie=new MaterialLoader;ie.setTextures(Z);for(let oe=0,se=_.length;oe<se;oe++){const ae=_[oe];te[ae.uuid]===void 0&&(te[ae.uuid]=ie.parse(ae)),ne[ae.uuid]=te[ae.uuid]}}return ne}parseAnimations(_){const Z={};if(_!==void 0)for(let te=0;te<_.length;te++){const ne=_[te],ie=AnimationClip.parse(ne);Z[ie.uuid]=ie}return Z}parseImages(_,Z){const te=this,ne={};let ie;function oe(ae){return te.manager.itemStart(ae),ie.load(ae,function(){te.manager.itemEnd(ae)},void 0,function(){te.manager.itemError(ae),te.manager.itemEnd(ae)})}function se(ae){if(typeof ae=="string"){const le=ae,ce=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(le)?le:te.resourcePath+le;return oe(ce)}else return ae.data?{data:getTypedArray(ae.type,ae.data),width:ae.width,height:ae.height}:null}if(_!==void 0&&_.length>0){const ae=new LoadingManager(Z);ie=new ImageLoader(ae),ie.setCrossOrigin(this.crossOrigin);for(let le=0,ce=_.length;le<ce;le++){const fe=_[le],de=fe.url;if(Array.isArray(de)){const pe=[];for(let he=0,ge=de.length;he<ge;he++){const me=de[he],Ae=se(me);Ae!==null&&(Ae instanceof HTMLImageElement?pe.push(Ae):pe.push(new DataTexture(Ae.data,Ae.width,Ae.height)))}ne[fe.uuid]=new Source(pe)}else{const pe=se(fe.url);ne[fe.uuid]=new Source(pe)}}}return ne}async parseImagesAsync(_){const Z=this,te={};let ne;async function ie(oe){if(typeof oe=="string"){const se=oe,ae=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(se)?se:Z.resourcePath+se;return await ne.loadAsync(ae)}else return oe.data?{data:getTypedArray(oe.type,oe.data),width:oe.width,height:oe.height}:null}if(_!==void 0&&_.length>0){ne=new ImageLoader(this.manager),ne.setCrossOrigin(this.crossOrigin);for(let oe=0,se=_.length;oe<se;oe++){const ae=_[oe],le=ae.url;if(Array.isArray(le)){const ce=[];for(let fe=0,de=le.length;fe<de;fe++){const pe=le[fe],he=await ie(pe);he!==null&&(he instanceof HTMLImageElement?ce.push(he):ce.push(new DataTexture(he.data,he.width,he.height)))}te[ae.uuid]=new Source(ce)}else{const ce=await ie(ae.url);te[ae.uuid]=new Source(ce)}}}return te}parseTextures(_,Z){function te(ie,oe){return typeof ie=="number"?ie:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",ie),oe[ie])}const ne={};if(_!==void 0)for(let ie=0,oe=_.length;ie<oe;ie++){const se=_[ie];se.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',se.uuid),Z[se.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",se.image);const ae=Z[se.image],le=ae.data;let ce;Array.isArray(le)?(ce=new CubeTexture,le.length===6&&(ce.needsUpdate=!0)):(le&&le.data?ce=new DataTexture:ce=new Texture$1,le&&(ce.needsUpdate=!0)),ce.source=ae,ce.uuid=se.uuid,se.name!==void 0&&(ce.name=se.name),se.mapping!==void 0&&(ce.mapping=te(se.mapping,TEXTURE_MAPPING)),se.channel!==void 0&&(ce.channel=se.channel),se.offset!==void 0&&ce.offset.fromArray(se.offset),se.repeat!==void 0&&ce.repeat.fromArray(se.repeat),se.center!==void 0&&ce.center.fromArray(se.center),se.rotation!==void 0&&(ce.rotation=se.rotation),se.wrap!==void 0&&(ce.wrapS=te(se.wrap[0],TEXTURE_WRAPPING),ce.wrapT=te(se.wrap[1],TEXTURE_WRAPPING)),se.format!==void 0&&(ce.format=se.format),se.internalFormat!==void 0&&(ce.internalFormat=se.internalFormat),se.type!==void 0&&(ce.type=se.type),se.colorSpace!==void 0&&(ce.colorSpace=se.colorSpace),se.minFilter!==void 0&&(ce.minFilter=te(se.minFilter,TEXTURE_FILTER)),se.magFilter!==void 0&&(ce.magFilter=te(se.magFilter,TEXTURE_FILTER)),se.anisotropy!==void 0&&(ce.anisotropy=se.anisotropy),se.flipY!==void 0&&(ce.flipY=se.flipY),se.generateMipmaps!==void 0&&(ce.generateMipmaps=se.generateMipmaps),se.premultiplyAlpha!==void 0&&(ce.premultiplyAlpha=se.premultiplyAlpha),se.unpackAlignment!==void 0&&(ce.unpackAlignment=se.unpackAlignment),se.compareFunction!==void 0&&(ce.compareFunction=se.compareFunction),se.userData!==void 0&&(ce.userData=se.userData),ne[se.uuid]=ce}return ne}parseObject(_,Z,te,ne,ie){let oe;function se(de){return Z[de]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",de),Z[de]}function ae(de){if(de!==void 0){if(Array.isArray(de)){const pe=[];for(let he=0,ge=de.length;he<ge;he++){const me=de[he];te[me]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",me),pe.push(te[me])}return pe}return te[de]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",de),te[de]}}function le(de){return ne[de]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",de),ne[de]}let ce,fe;switch(_.type){case"Scene":oe=new Scene$1,_.background!==void 0&&(Number.isInteger(_.background)?oe.background=new Color$1(_.background):oe.background=le(_.background)),_.environment!==void 0&&(oe.environment=le(_.environment)),_.fog!==void 0&&(_.fog.type==="Fog"?oe.fog=new Fog(_.fog.color,_.fog.near,_.fog.far):_.fog.type==="FogExp2"&&(oe.fog=new FogExp2(_.fog.color,_.fog.density)),_.fog.name!==""&&(oe.fog.name=_.fog.name)),_.backgroundBlurriness!==void 0&&(oe.backgroundBlurriness=_.backgroundBlurriness),_.backgroundIntensity!==void 0&&(oe.backgroundIntensity=_.backgroundIntensity),_.backgroundRotation!==void 0&&oe.backgroundRotation.fromArray(_.backgroundRotation),_.environmentIntensity!==void 0&&(oe.environmentIntensity=_.environmentIntensity),_.environmentRotation!==void 0&&oe.environmentRotation.fromArray(_.environmentRotation);break;case"PerspectiveCamera":oe=new PerspectiveCamera$2(_.fov,_.aspect,_.near,_.far),_.focus!==void 0&&(oe.focus=_.focus),_.zoom!==void 0&&(oe.zoom=_.zoom),_.filmGauge!==void 0&&(oe.filmGauge=_.filmGauge),_.filmOffset!==void 0&&(oe.filmOffset=_.filmOffset),_.view!==void 0&&(oe.view=Object.assign({},_.view));break;case"OrthographicCamera":oe=new OrthographicCamera$1(_.left,_.right,_.top,_.bottom,_.near,_.far),_.zoom!==void 0&&(oe.zoom=_.zoom),_.view!==void 0&&(oe.view=Object.assign({},_.view));break;case"AmbientLight":oe=new AmbientLight$1(_.color,_.intensity);break;case"DirectionalLight":oe=new DirectionalLight$1(_.color,_.intensity),oe.target=_.target||"";break;case"PointLight":oe=new PointLight$1(_.color,_.intensity,_.distance,_.decay);break;case"RectAreaLight":oe=new RectAreaLight$1(_.color,_.intensity,_.width,_.height);break;case"SpotLight":oe=new SpotLight$2(_.color,_.intensity,_.distance,_.angle,_.penumbra,_.decay),oe.target=_.target||"";break;case"HemisphereLight":oe=new HemisphereLight$1(_.color,_.groundColor,_.intensity);break;case"LightProbe":oe=new LightProbe().fromJSON(_);break;case"SkinnedMesh":ce=se(_.geometry),fe=ae(_.material),oe=new SkinnedMesh(ce,fe),_.bindMode!==void 0&&(oe.bindMode=_.bindMode),_.bindMatrix!==void 0&&oe.bindMatrix.fromArray(_.bindMatrix),_.skeleton!==void 0&&(oe.skeleton=_.skeleton);break;case"Mesh":ce=se(_.geometry),fe=ae(_.material),oe=new Mesh(ce,fe);break;case"InstancedMesh":ce=se(_.geometry),fe=ae(_.material);const de=_.count,pe=_.instanceMatrix,he=_.instanceColor;oe=new InstancedMesh(ce,fe,de),oe.instanceMatrix=new InstancedBufferAttribute(new Float32Array(pe.array),16),he!==void 0&&(oe.instanceColor=new InstancedBufferAttribute(new Float32Array(he.array),he.itemSize));break;case"BatchedMesh":ce=se(_.geometry),fe=ae(_.material),oe=new BatchedMesh(_.maxInstanceCount,_.maxVertexCount,_.maxIndexCount,fe),oe.geometry=ce,oe.perObjectFrustumCulled=_.perObjectFrustumCulled,oe.sortObjects=_.sortObjects,oe._drawRanges=_.drawRanges,oe._reservedRanges=_.reservedRanges,oe._visibility=_.visibility,oe._active=_.active,oe._bounds=_.bounds.map(ge=>{const me=new Box3;me.min.fromArray(ge.boxMin),me.max.fromArray(ge.boxMax);const Ae=new Sphere$2;return Ae.radius=ge.sphereRadius,Ae.center.fromArray(ge.sphereCenter),{boxInitialized:ge.boxInitialized,box:me,sphereInitialized:ge.sphereInitialized,sphere:Ae}}),oe._maxInstanceCount=_.maxInstanceCount,oe._maxVertexCount=_.maxVertexCount,oe._maxIndexCount=_.maxIndexCount,oe._geometryInitialized=_.geometryInitialized,oe._geometryCount=_.geometryCount,oe._matricesTexture=le(_.matricesTexture.uuid),_.colorsTexture!==void 0&&(oe._colorsTexture=le(_.colorsTexture.uuid));break;case"LOD":oe=new LOD;break;case"Line":oe=new Line$2(se(_.geometry),ae(_.material));break;case"LineLoop":oe=new LineLoop(se(_.geometry),ae(_.material));break;case"LineSegments":oe=new LineSegments(se(_.geometry),ae(_.material));break;case"PointCloud":case"Points":oe=new Points$1(se(_.geometry),ae(_.material));break;case"Sprite":oe=new Sprite(ae(_.material));break;case"Group":oe=new Group;break;case"Bone":oe=new Bone;break;default:oe=new Object3D}if(oe.uuid=_.uuid,_.name!==void 0&&(oe.name=_.name),_.matrix!==void 0?(oe.matrix.fromArray(_.matrix),_.matrixAutoUpdate!==void 0&&(oe.matrixAutoUpdate=_.matrixAutoUpdate),oe.matrixAutoUpdate&&oe.matrix.decompose(oe.position,oe.quaternion,oe.scale)):(_.position!==void 0&&oe.position.fromArray(_.position),_.rotation!==void 0&&oe.rotation.fromArray(_.rotation),_.quaternion!==void 0&&oe.quaternion.fromArray(_.quaternion),_.scale!==void 0&&oe.scale.fromArray(_.scale)),_.up!==void 0&&oe.up.fromArray(_.up),_.castShadow!==void 0&&(oe.castShadow=_.castShadow),_.receiveShadow!==void 0&&(oe.receiveShadow=_.receiveShadow),_.shadow&&(_.shadow.intensity!==void 0&&(oe.shadow.intensity=_.shadow.intensity),_.shadow.bias!==void 0&&(oe.shadow.bias=_.shadow.bias),_.shadow.normalBias!==void 0&&(oe.shadow.normalBias=_.shadow.normalBias),_.shadow.radius!==void 0&&(oe.shadow.radius=_.shadow.radius),_.shadow.mapSize!==void 0&&oe.shadow.mapSize.fromArray(_.shadow.mapSize),_.shadow.camera!==void 0&&(oe.shadow.camera=this.parseObject(_.shadow.camera))),_.visible!==void 0&&(oe.visible=_.visible),_.frustumCulled!==void 0&&(oe.frustumCulled=_.frustumCulled),_.renderOrder!==void 0&&(oe.renderOrder=_.renderOrder),_.userData!==void 0&&(oe.userData=_.userData),_.layers!==void 0&&(oe.layers.mask=_.layers),_.children!==void 0){const de=_.children;for(let pe=0;pe<de.length;pe++)oe.add(this.parseObject(de[pe],Z,te,ne,ie))}if(_.animations!==void 0){const de=_.animations;for(let pe=0;pe<de.length;pe++){const he=de[pe];oe.animations.push(ie[he])}}if(_.type==="LOD"){_.autoUpdate!==void 0&&(oe.autoUpdate=_.autoUpdate);const de=_.levels;for(let pe=0;pe<de.length;pe++){const he=de[pe],ge=oe.getObjectByProperty("uuid",he.object);ge!==void 0&&oe.addLevel(ge,he.distance,he.hysteresis)}}return oe}bindSkeletons(_,Z){Object.keys(Z).length!==0&&_.traverse(function(te){if(te.isSkinnedMesh===!0&&te.skeleton!==void 0){const ne=Z[te.skeleton];ne===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",te.skeleton):te.bind(ne,te.bindMatrix)}})}bindLightTargets(_){_.traverse(function(Z){if(Z.isDirectionalLight||Z.isSpotLight){const te=Z.target,ne=_.getObjectByProperty("uuid",te);ne!==void 0?Z.target=ne:Z.target=new Object3D}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(_){super(_),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_){return this.options=_,this}load(_,Z,te,ne){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const ie=this,oe=Cache.get(_);if(oe!==void 0){if(ie.manager.itemStart(_),oe.then){oe.then(le=>{Z&&Z(le),ie.manager.itemEnd(_)}).catch(le=>{ne&&ne(le)});return}return setTimeout(function(){Z&&Z(oe),ie.manager.itemEnd(_)},0),oe}const se={};se.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",se.headers=this.requestHeader;const ae=fetch(_,se).then(function(le){return le.blob()}).then(function(le){return createImageBitmap(le,Object.assign(ie.options,{colorSpaceConversion:"none"}))}).then(function(le){return Cache.add(_,le),Z&&Z(le),ie.manager.itemEnd(_),le}).catch(function(le){ne&&ne(le),Cache.remove(_),ie.manager.itemError(_),ie.manager.itemEnd(_)});Cache.add(_,ae),ie.manager.itemStart(_)}}let _context;class AudioContext{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(_){_context=_}}class AudioLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=new FileLoader(this.manager);oe.setResponseType("arraybuffer"),oe.setPath(this.path),oe.setRequestHeader(this.requestHeader),oe.setWithCredentials(this.withCredentials),oe.load(_,function(ae){try{const le=ae.slice(0);AudioContext.getContext().decodeAudioData(le,function(fe){Z(fe)}).catch(se)}catch(le){se(le)}},te,ne);function se(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera$2,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera$2,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_){const Z=this._cache;if(Z.focus!==_.focus||Z.fov!==_.fov||Z.aspect!==_.aspect*this.aspect||Z.near!==_.near||Z.far!==_.far||Z.zoom!==_.zoom||Z.eyeSep!==this.eyeSep){Z.focus=_.focus,Z.fov=_.fov,Z.aspect=_.aspect*this.aspect,Z.near=_.near,Z.far=_.far,Z.zoom=_.zoom,Z.eyeSep=this.eyeSep,_projectionMatrix.copy(_.projectionMatrix);const ne=Z.eyeSep/2,ie=ne*Z.near/Z.focus,oe=Z.near*Math.tan(DEG2RAD*Z.fov*.5)/Z.zoom;let se,ae;_eyeLeft.elements[12]=-ne,_eyeRight.elements[12]=ne,se=-oe*Z.aspect+ie,ae=oe*Z.aspect+ie,_projectionMatrix.elements[0]=2*Z.near/(ae-se),_projectionMatrix.elements[8]=(ae+se)/(ae-se),this.cameraL.projectionMatrix.copy(_projectionMatrix),se=-oe*Z.aspect-ie,ae=oe*Z.aspect-ie,_projectionMatrix.elements[0]=2*Z.near/(ae-se),_projectionMatrix.elements[8]=(ae+se)/(ae-se),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_.matrixWorld).multiply(_eyeRight)}}class ArrayCamera extends PerspectiveCamera$2{constructor(_=[]){super(),this.isArrayCamera=!0,this.cameras=_,this.index=0}}class Clock{constructor(_=!0){this.autoStart=_,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now$2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const Z=now$2();_=(Z-this.oldTime)/1e3,this.oldTime=Z,this.elapsedTime+=_}return _}}function now$2(){return performance.now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}updateMatrixWorld(_){super.updateMatrixWorld(_);const Z=this.context.listener,te=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),Z.positionX){const ne=this.context.currentTime+this.timeDelta;Z.positionX.linearRampToValueAtTime(_position$1.x,ne),Z.positionY.linearRampToValueAtTime(_position$1.y,ne),Z.positionZ.linearRampToValueAtTime(_position$1.z,ne),Z.forwardX.linearRampToValueAtTime(_orientation$1.x,ne),Z.forwardY.linearRampToValueAtTime(_orientation$1.y,ne),Z.forwardZ.linearRampToValueAtTime(_orientation$1.z,ne),Z.upX.linearRampToValueAtTime(te.x,ne),Z.upY.linearRampToValueAtTime(te.y,ne),Z.upZ.linearRampToValueAtTime(te.z,ne)}else Z.setPosition(_position$1.x,_position$1.y,_position$1.z),Z.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,te.x,te.y,te.z)}}class Audio extends Object3D{constructor(_){super(),this.type="Audio",this.listener=_,this.context=_.context,this.gain=this.context.createGain(),this.gain.connect(_.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_,this.connect(),this}setMediaElementSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_),this.connect(),this}setMediaStreamSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_),this.connect(),this}setBuffer(_){return this.buffer=_,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_;const Z=this.context.createBufferSource();return Z.buffer=this.buffer,Z.loop=this.loop,Z.loopStart=this.loopStart,Z.loopEnd=this.loopEnd,Z.onended=this.onEnded.bind(this),Z.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=Z,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(_=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+_),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _=1,Z=this.filters.length;_<Z;_++)this.filters[_-1].connect(this.filters[_]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _=1,Z=this.filters.length;_<Z;_++)this.filters[_-1].disconnect(this.filters[_]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(_){return _||(_=[]),this._connected===!0?(this.disconnect(),this.filters=_.slice(),this.connect()):this.filters=_.slice(),this}setDetune(_){return this.detune=_,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_){return this.setFilters(_?[_]:[])}setPlaybackRate(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_){return this.loopStart=_,this}setLoopEnd(_){return this.loopEnd=_,this}getVolume(){return this.gain.gain.value}setVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}copy(_,Z){return super.copy(_,Z),_.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=_.autoplay,this.buffer=_.buffer,this.detune=_.detune,this.loop=_.loop,this.loopStart=_.loopStart,this.loopEnd=_.loopEnd,this.offset=_.offset,this.duration=_.duration,this.playbackRate=_.playbackRate,this.hasPlaybackControl=_.hasPlaybackControl,this.sourceType=_.sourceType,this.filters=_.filters.slice(),this)}clone(_){return new this.constructor(this.listener).copy(this,_)}}const _position$4=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;let PositionalAudio$1=class extends Audio{constructor(_){super(_),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_){return this.panner.refDistance=_,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_){return this.panner.rolloffFactor=_,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_){return this.panner.distanceModel=_,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_){return this.panner.maxDistance=_,this}setDirectionalCone(_,Z,te){return this.panner.coneInnerAngle=_,this.panner.coneOuterAngle=Z,this.panner.coneOuterGain=te,this}updateMatrixWorld(_){if(super.updateMatrixWorld(_),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position$4,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const Z=this.panner;if(Z.positionX){const te=this.context.currentTime+this.listener.timeDelta;Z.positionX.linearRampToValueAtTime(_position$4.x,te),Z.positionY.linearRampToValueAtTime(_position$4.y,te),Z.positionZ.linearRampToValueAtTime(_position$4.z,te),Z.orientationX.linearRampToValueAtTime(_orientation.x,te),Z.orientationY.linearRampToValueAtTime(_orientation.y,te),Z.orientationZ.linearRampToValueAtTime(_orientation.z,te)}else Z.setPosition(_position$4.x,_position$4.y,_position$4.z),Z.setOrientation(_orientation.x,_orientation.y,_orientation.z)}};class AudioAnalyser{constructor(_,Z=2048){this.analyser=_.context.createAnalyser(),this.analyser.fftSize=Z,this.data=new Uint8Array(this.analyser.frequencyBinCount),_.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _=0;const Z=this.getFrequencyData();for(let te=0;te<Z.length;te++)_+=Z[te];return _/Z.length}}class PropertyMixer{constructor(_,Z,te){this.binding=_,this.valueSize=te;let ne,ie,oe;switch(Z){case"quaternion":ne=this._slerp,ie=this._slerpAdditive,oe=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(te*6),this._workIndex=5;break;case"string":case"bool":ne=this._select,ie=this._select,oe=this._setAdditiveIdentityOther,this.buffer=new Array(te*5);break;default:ne=this._lerp,ie=this._lerpAdditive,oe=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(te*5)}this._mixBufferRegion=ne,this._mixBufferRegionAdditive=ie,this._setIdentity=oe,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_,Z){const te=this.buffer,ne=this.valueSize,ie=_*ne+ne;let oe=this.cumulativeWeight;if(oe===0){for(let se=0;se!==ne;++se)te[ie+se]=te[se];oe=Z}else{oe+=Z;const se=Z/oe;this._mixBufferRegion(te,ie,0,se,ne)}this.cumulativeWeight=oe}accumulateAdditive(_){const Z=this.buffer,te=this.valueSize,ne=te*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(Z,ne,0,_,te),this.cumulativeWeightAdditive+=_}apply(_){const Z=this.valueSize,te=this.buffer,ne=_*Z+Z,ie=this.cumulativeWeight,oe=this.cumulativeWeightAdditive,se=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,ie<1){const ae=Z*this._origIndex;this._mixBufferRegion(te,ne,ae,1-ie,Z)}oe>0&&this._mixBufferRegionAdditive(te,ne,this._addIndex*Z,1,Z);for(let ae=Z,le=Z+Z;ae!==le;++ae)if(te[ae]!==te[ae+Z]){se.setValue(te,ne);break}}saveOriginalState(){const _=this.binding,Z=this.buffer,te=this.valueSize,ne=te*this._origIndex;_.getValue(Z,ne);for(let ie=te,oe=ne;ie!==oe;++ie)Z[ie]=Z[ne+ie%te];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _=this.valueSize*3;this.binding.setValue(this.buffer,_)}_setAdditiveIdentityNumeric(){const _=this._addIndex*this.valueSize,Z=_+this.valueSize;for(let te=_;te<Z;te++)this.buffer[te]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _=this._origIndex*this.valueSize,Z=this._addIndex*this.valueSize;for(let te=0;te<this.valueSize;te++)this.buffer[Z+te]=this.buffer[_+te]}_select(_,Z,te,ne,ie){if(ne>=.5)for(let oe=0;oe!==ie;++oe)_[Z+oe]=_[te+oe]}_slerp(_,Z,te,ne){Quaternion.slerpFlat(_,Z,_,Z,_,te,ne)}_slerpAdditive(_,Z,te,ne,ie){const oe=this._workIndex*ie;Quaternion.multiplyQuaternionsFlat(_,oe,_,Z,_,te),Quaternion.slerpFlat(_,Z,_,Z,_,oe,ne)}_lerp(_,Z,te,ne,ie){const oe=1-ne;for(let se=0;se!==ie;++se){const ae=Z+se;_[ae]=_[ae]*oe+_[te+se]*ne}}_lerpAdditive(_,Z,te,ne,ie){for(let oe=0;oe!==ie;++oe){const se=Z+oe;_[se]=_[se]+_[te+oe]*ne}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_,Z,te){const ne=te||PropertyBinding.parseTrackName(Z);this._targetGroup=_,this._bindings=_.subscribe_(Z,ne)}getValue(_,Z){this.bind();const te=this._targetGroup.nCachedObjects_,ne=this._bindings[te];ne!==void 0&&ne.getValue(_,Z)}setValue(_,Z){const te=this._bindings;for(let ne=this._targetGroup.nCachedObjects_,ie=te.length;ne!==ie;++ne)te[ne].setValue(_,Z)}bind(){const _=this._bindings;for(let Z=this._targetGroup.nCachedObjects_,te=_.length;Z!==te;++Z)_[Z].bind()}unbind(){const _=this._bindings;for(let Z=this._targetGroup.nCachedObjects_,te=_.length;Z!==te;++Z)_[Z].unbind()}}class PropertyBinding{constructor(_,Z,te){this.path=Z,this.parsedPath=te||PropertyBinding.parseTrackName(Z),this.node=PropertyBinding.findNode(_,this.parsedPath.nodeName),this.rootNode=_,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_,Z,te){return _&&_.isAnimationObjectGroup?new PropertyBinding.Composite(_,Z,te):new PropertyBinding(_,Z,te)}static sanitizeNodeName(_){return _.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_){const Z=_trackRe.exec(_);if(Z===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_);const te={nodeName:Z[2],objectName:Z[3],objectIndex:Z[4],propertyName:Z[5],propertyIndex:Z[6]},ne=te.nodeName&&te.nodeName.lastIndexOf(".");if(ne!==void 0&&ne!==-1){const ie=te.nodeName.substring(ne+1);_supportedObjectNames.indexOf(ie)!==-1&&(te.nodeName=te.nodeName.substring(0,ne),te.objectName=ie)}if(te.propertyName===null||te.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_);return te}static findNode(_,Z){if(Z===void 0||Z===""||Z==="."||Z===-1||Z===_.name||Z===_.uuid)return _;if(_.skeleton){const te=_.skeleton.getBoneByName(Z);if(te!==void 0)return te}if(_.children){const te=function(ie){for(let oe=0;oe<ie.length;oe++){const se=ie[oe];if(se.name===Z||se.uuid===Z)return se;const ae=te(se.children);if(ae)return ae}return null},ne=te(_.children);if(ne)return ne}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_,Z){_[Z]=this.targetObject[this.propertyName]}_getValue_array(_,Z){const te=this.resolvedProperty;for(let ne=0,ie=te.length;ne!==ie;++ne)_[Z++]=te[ne]}_getValue_arrayElement(_,Z){_[Z]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_,Z){this.resolvedProperty.toArray(_,Z)}_setValue_direct(_,Z){this.targetObject[this.propertyName]=_[Z]}_setValue_direct_setNeedsUpdate(_,Z){this.targetObject[this.propertyName]=_[Z],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_,Z){this.targetObject[this.propertyName]=_[Z],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_,Z){const te=this.resolvedProperty;for(let ne=0,ie=te.length;ne!==ie;++ne)te[ne]=_[Z++]}_setValue_array_setNeedsUpdate(_,Z){const te=this.resolvedProperty;for(let ne=0,ie=te.length;ne!==ie;++ne)te[ne]=_[Z++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_,Z){const te=this.resolvedProperty;for(let ne=0,ie=te.length;ne!==ie;++ne)te[ne]=_[Z++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_,Z){this.resolvedProperty[this.propertyIndex]=_[Z]}_setValue_arrayElement_setNeedsUpdate(_,Z){this.resolvedProperty[this.propertyIndex]=_[Z],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_,Z){this.resolvedProperty[this.propertyIndex]=_[Z],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_,Z){this.resolvedProperty.fromArray(_,Z)}_setValue_fromArray_setNeedsUpdate(_,Z){this.resolvedProperty.fromArray(_,Z),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_,Z){this.resolvedProperty.fromArray(_,Z),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_,Z){this.bind(),this.getValue(_,Z)}_setValue_unbound(_,Z){this.bind(),this.setValue(_,Z)}bind(){let _=this.node;const Z=this.parsedPath,te=Z.objectName,ne=Z.propertyName;let ie=Z.propertyIndex;if(_||(_=PropertyBinding.findNode(this.rootNode,Z.nodeName),this.node=_),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(te){let le=Z.objectIndex;switch(te){case"materials":if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_=_.material.materials;break;case"bones":if(!_.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_=_.skeleton.bones;for(let ce=0;ce<_.length;ce++)if(_[ce].name===le){le=ce;break}break;case"map":if("map"in _){_=_.map;break}if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_=_.material.map;break;default:if(_[te]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_=_[te]}if(le!==void 0){if(_[le]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_);return}_=_[le]}}const oe=_[ne];if(oe===void 0){const le=Z.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+le+"."+ne+" but it wasn't found.",_);return}let se=this.Versioning.None;this.targetObject=_,_.isMaterial===!0?se=this.Versioning.NeedsUpdate:_.isObject3D===!0&&(se=this.Versioning.MatrixWorldNeedsUpdate);let ae=this.BindingType.Direct;if(ie!==void 0){if(ne==="morphTargetInfluences"){if(!_.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_.morphTargetDictionary[ie]!==void 0&&(ie=_.morphTargetDictionary[ie])}ae=this.BindingType.ArrayElement,this.resolvedProperty=oe,this.propertyIndex=ie}else oe.fromArray!==void 0&&oe.toArray!==void 0?(ae=this.BindingType.HasFromToArray,this.resolvedProperty=oe):Array.isArray(oe)?(ae=this.BindingType.EntireArray,this.resolvedProperty=oe):this.propertyName=ne;this.getValue=this.GetterByBindingType[ae],this.setValue=this.SetterByBindingTypeAndVersioning[ae][se]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID$1(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _={};this._indicesByUUID=_;for(let te=0,ne=arguments.length;te!==ne;++te)_[arguments[te].uuid]=te;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const Z=this;this.stats={objects:{get total(){return Z._objects.length},get inUse(){return this.total-Z.nCachedObjects_}},get bindingsPerObject(){return Z._bindings.length}}}add(){const _=this._objects,Z=this._indicesByUUID,te=this._paths,ne=this._parsedPaths,ie=this._bindings,oe=ie.length;let se,ae=_.length,le=this.nCachedObjects_;for(let ce=0,fe=arguments.length;ce!==fe;++ce){const de=arguments[ce],pe=de.uuid;let he=Z[pe];if(he===void 0){he=ae++,Z[pe]=he,_.push(de);for(let ge=0,me=oe;ge!==me;++ge)ie[ge].push(new PropertyBinding(de,te[ge],ne[ge]))}else if(he<le){se=_[he];const ge=--le,me=_[ge];Z[me.uuid]=he,_[he]=me,Z[pe]=ge,_[ge]=de;for(let Ae=0,ye=oe;Ae!==ye;++Ae){const ve=ie[Ae],_e=ve[ge];let Te=ve[he];ve[he]=_e,Te===void 0&&(Te=new PropertyBinding(de,te[Ae],ne[Ae])),ve[ge]=Te}}else _[he]!==se&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=le}remove(){const _=this._objects,Z=this._indicesByUUID,te=this._bindings,ne=te.length;let ie=this.nCachedObjects_;for(let oe=0,se=arguments.length;oe!==se;++oe){const ae=arguments[oe],le=ae.uuid,ce=Z[le];if(ce!==void 0&&ce>=ie){const fe=ie++,de=_[fe];Z[de.uuid]=ce,_[ce]=de,Z[le]=fe,_[fe]=ae;for(let pe=0,he=ne;pe!==he;++pe){const ge=te[pe],me=ge[fe],Ae=ge[ce];ge[ce]=me,ge[fe]=Ae}}}this.nCachedObjects_=ie}uncache(){const _=this._objects,Z=this._indicesByUUID,te=this._bindings,ne=te.length;let ie=this.nCachedObjects_,oe=_.length;for(let se=0,ae=arguments.length;se!==ae;++se){const le=arguments[se],ce=le.uuid,fe=Z[ce];if(fe!==void 0)if(delete Z[ce],fe<ie){const de=--ie,pe=_[de],he=--oe,ge=_[he];Z[pe.uuid]=fe,_[fe]=pe,Z[ge.uuid]=de,_[de]=ge,_.pop();for(let me=0,Ae=ne;me!==Ae;++me){const ye=te[me],ve=ye[de],_e=ye[he];ye[fe]=ve,ye[de]=_e,ye.pop()}}else{const de=--oe,pe=_[de];de>0&&(Z[pe.uuid]=fe),_[fe]=pe,_.pop();for(let he=0,ge=ne;he!==ge;++he){const me=te[he];me[fe]=me[de],me.pop()}}}this.nCachedObjects_=ie}subscribe_(_,Z){const te=this._bindingsIndicesByPath;let ne=te[_];const ie=this._bindings;if(ne!==void 0)return ie[ne];const oe=this._paths,se=this._parsedPaths,ae=this._objects,le=ae.length,ce=this.nCachedObjects_,fe=new Array(le);ne=ie.length,te[_]=ne,oe.push(_),se.push(Z),ie.push(fe);for(let de=ce,pe=ae.length;de!==pe;++de){const he=ae[de];fe[de]=new PropertyBinding(he,_,Z)}return fe}unsubscribe_(_){const Z=this._bindingsIndicesByPath,te=Z[_];if(te!==void 0){const ne=this._paths,ie=this._parsedPaths,oe=this._bindings,se=oe.length-1,ae=oe[se],le=_[se];Z[le]=te,oe[te]=ae,oe.pop(),ie[te]=ie[se],ie.pop(),ne[te]=ne[se],ne.pop()}}}class AnimationAction{constructor(_,Z,te=null,ne=Z.blendMode){this._mixer=_,this._clip=Z,this._localRoot=te,this.blendMode=ne;const ie=Z.tracks,oe=ie.length,se=new Array(oe),ae={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let le=0;le!==oe;++le){const ce=ie[le].createInterpolant(null);se[le]=ce,ce.settings=ae}this._interpolantSettings=ae,this._interpolants=se,this._propertyBindings=new Array(oe),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_){return this._startTime=_,this}setLoop(_,Z){return this.loop=_,this.repetitions=Z,this}setEffectiveWeight(_){return this.weight=_,this._effectiveWeight=this.enabled?_:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_){return this._scheduleFading(_,0,1)}fadeOut(_){return this._scheduleFading(_,1,0)}crossFadeFrom(_,Z,te=!1){if(_.fadeOut(Z),this.fadeIn(Z),te===!0){const ne=this._clip.duration,ie=_._clip.duration,oe=ie/ne,se=ne/ie;_.warp(1,oe,Z),this.warp(se,1,Z)}return this}crossFadeTo(_,Z,te=!1){return _.crossFadeFrom(this,Z,te)}stopFading(){const _=this._weightInterpolant;return _!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}setEffectiveTimeScale(_){return this.timeScale=_,this._effectiveTimeScale=this.paused?0:_,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_){return this.timeScale=this._clip.duration/_,this.stopWarping()}syncWith(_){return this.time=_.time,this.timeScale=_.timeScale,this.stopWarping()}halt(_){return this.warp(this._effectiveTimeScale,0,_)}warp(_,Z,te){const ne=this._mixer,ie=ne.time,oe=this.timeScale;let se=this._timeScaleInterpolant;se===null&&(se=ne._lendControlInterpolant(),this._timeScaleInterpolant=se);const ae=se.parameterPositions,le=se.sampleValues;return ae[0]=ie,ae[1]=ie+te,le[0]=_/oe,le[1]=Z/oe,this}stopWarping(){const _=this._timeScaleInterpolant;return _!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_,Z,te,ne){if(!this.enabled){this._updateWeight(_);return}const ie=this._startTime;if(ie!==null){const ae=(_-ie)*te;ae<0||te===0?Z=0:(this._startTime=null,Z=te*ae)}Z*=this._updateTimeScale(_);const oe=this._updateTime(Z),se=this._updateWeight(_);if(se>0){const ae=this._interpolants,le=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let ce=0,fe=ae.length;ce!==fe;++ce)ae[ce].evaluate(oe),le[ce].accumulateAdditive(se);break;case NormalAnimationBlendMode:default:for(let ce=0,fe=ae.length;ce!==fe;++ce)ae[ce].evaluate(oe),le[ce].accumulate(ne,se)}}}_updateWeight(_){let Z=0;if(this.enabled){Z=this.weight;const te=this._weightInterpolant;if(te!==null){const ne=te.evaluate(_)[0];Z*=ne,_>te.parameterPositions[1]&&(this.stopFading(),ne===0&&(this.enabled=!1))}}return this._effectiveWeight=Z,Z}_updateTimeScale(_){let Z=0;if(!this.paused){Z=this.timeScale;const te=this._timeScaleInterpolant;if(te!==null){const ne=te.evaluate(_)[0];Z*=ne,_>te.parameterPositions[1]&&(this.stopWarping(),Z===0?this.paused=!0:this.timeScale=Z)}}return this._effectiveTimeScale=Z,Z}_updateTime(_){const Z=this._clip.duration,te=this.loop;let ne=this.time+_,ie=this._loopCount;const oe=te===LoopPingPong;if(_===0)return ie===-1?ne:oe&&(ie&1)===1?Z-ne:ne;if(te===LoopOnce){ie===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(ne>=Z)ne=Z;else if(ne<0)ne=0;else{this.time=ne;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=ne,this._mixer.dispatchEvent({type:"finished",action:this,direction:_<0?-1:1})}}else{if(ie===-1&&(_>=0?(ie=0,this._setEndings(!0,this.repetitions===0,oe)):this._setEndings(this.repetitions===0,!0,oe)),ne>=Z||ne<0){const se=Math.floor(ne/Z);ne-=Z*se,ie+=Math.abs(se);const ae=this.repetitions-ie;if(ae<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,ne=_>0?Z:0,this.time=ne,this._mixer.dispatchEvent({type:"finished",action:this,direction:_>0?1:-1});else{if(ae===1){const le=_<0;this._setEndings(le,!le,oe)}else this._setEndings(!1,!1,oe);this._loopCount=ie,this.time=ne,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:se})}}else this.time=ne;if(oe&&(ie&1)===1)return Z-ne}return ne}_setEndings(_,Z,te){const ne=this._interpolantSettings;te?(ne.endingStart=ZeroSlopeEnding,ne.endingEnd=ZeroSlopeEnding):(_?ne.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:ne.endingStart=WrapAroundEnding,Z?ne.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:ne.endingEnd=WrapAroundEnding)}_scheduleFading(_,Z,te){const ne=this._mixer,ie=ne.time;let oe=this._weightInterpolant;oe===null&&(oe=ne._lendControlInterpolant(),this._weightInterpolant=oe);const se=oe.parameterPositions,ae=oe.sampleValues;return se[0]=ie,ae[0]=Z,se[1]=ie+_,ae[1]=te,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher$1{constructor(_){super(),this._root=_,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_,Z){const te=_._localRoot||this._root,ne=_._clip.tracks,ie=ne.length,oe=_._propertyBindings,se=_._interpolants,ae=te.uuid,le=this._bindingsByRootAndName;let ce=le[ae];ce===void 0&&(ce={},le[ae]=ce);for(let fe=0;fe!==ie;++fe){const de=ne[fe],pe=de.name;let he=ce[pe];if(he!==void 0)++he.referenceCount,oe[fe]=he;else{if(he=oe[fe],he!==void 0){he._cacheIndex===null&&(++he.referenceCount,this._addInactiveBinding(he,ae,pe));continue}const ge=Z&&Z._propertyBindings[fe].binding.parsedPath;he=new PropertyMixer(PropertyBinding.create(te,pe,ge),de.ValueTypeName,de.getValueSize()),++he.referenceCount,this._addInactiveBinding(he,ae,pe),oe[fe]=he}se[fe].resultBuffer=he.buffer}}_activateAction(_){if(!this._isActiveAction(_)){if(_._cacheIndex===null){const te=(_._localRoot||this._root).uuid,ne=_._clip.uuid,ie=this._actionsByClip[ne];this._bindAction(_,ie&&ie.knownActions[0]),this._addInactiveAction(_,ne,te)}const Z=_._propertyBindings;for(let te=0,ne=Z.length;te!==ne;++te){const ie=Z[te];ie.useCount++===0&&(this._lendBinding(ie),ie.saveOriginalState())}this._lendAction(_)}}_deactivateAction(_){if(this._isActiveAction(_)){const Z=_._propertyBindings;for(let te=0,ne=Z.length;te!==ne;++te){const ie=Z[te];--ie.useCount===0&&(ie.restoreOriginalState(),this._takeBackBinding(ie))}this._takeBackAction(_)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _=this;this.stats={actions:{get total(){return _._actions.length},get inUse(){return _._nActiveActions}},bindings:{get total(){return _._bindings.length},get inUse(){return _._nActiveBindings}},controlInterpolants:{get total(){return _._controlInterpolants.length},get inUse(){return _._nActiveControlInterpolants}}}}_isActiveAction(_){const Z=_._cacheIndex;return Z!==null&&Z<this._nActiveActions}_addInactiveAction(_,Z,te){const ne=this._actions,ie=this._actionsByClip;let oe=ie[Z];if(oe===void 0)oe={knownActions:[_],actionByRoot:{}},_._byClipCacheIndex=0,ie[Z]=oe;else{const se=oe.knownActions;_._byClipCacheIndex=se.length,se.push(_)}_._cacheIndex=ne.length,ne.push(_),oe.actionByRoot[te]=_}_removeInactiveAction(_){const Z=this._actions,te=Z[Z.length-1],ne=_._cacheIndex;te._cacheIndex=ne,Z[ne]=te,Z.pop(),_._cacheIndex=null;const ie=_._clip.uuid,oe=this._actionsByClip,se=oe[ie],ae=se.knownActions,le=ae[ae.length-1],ce=_._byClipCacheIndex;le._byClipCacheIndex=ce,ae[ce]=le,ae.pop(),_._byClipCacheIndex=null;const fe=se.actionByRoot,de=(_._localRoot||this._root).uuid;delete fe[de],ae.length===0&&delete oe[ie],this._removeInactiveBindingsForAction(_)}_removeInactiveBindingsForAction(_){const Z=_._propertyBindings;for(let te=0,ne=Z.length;te!==ne;++te){const ie=Z[te];--ie.referenceCount===0&&this._removeInactiveBinding(ie)}}_lendAction(_){const Z=this._actions,te=_._cacheIndex,ne=this._nActiveActions++,ie=Z[ne];_._cacheIndex=ne,Z[ne]=_,ie._cacheIndex=te,Z[te]=ie}_takeBackAction(_){const Z=this._actions,te=_._cacheIndex,ne=--this._nActiveActions,ie=Z[ne];_._cacheIndex=ne,Z[ne]=_,ie._cacheIndex=te,Z[te]=ie}_addInactiveBinding(_,Z,te){const ne=this._bindingsByRootAndName,ie=this._bindings;let oe=ne[Z];oe===void 0&&(oe={},ne[Z]=oe),oe[te]=_,_._cacheIndex=ie.length,ie.push(_)}_removeInactiveBinding(_){const Z=this._bindings,te=_.binding,ne=te.rootNode.uuid,ie=te.path,oe=this._bindingsByRootAndName,se=oe[ne],ae=Z[Z.length-1],le=_._cacheIndex;ae._cacheIndex=le,Z[le]=ae,Z.pop(),delete se[ie],Object.keys(se).length===0&&delete oe[ne]}_lendBinding(_){const Z=this._bindings,te=_._cacheIndex,ne=this._nActiveBindings++,ie=Z[ne];_._cacheIndex=ne,Z[ne]=_,ie._cacheIndex=te,Z[te]=ie}_takeBackBinding(_){const Z=this._bindings,te=_._cacheIndex,ne=--this._nActiveBindings,ie=Z[ne];_._cacheIndex=ne,Z[ne]=_,ie._cacheIndex=te,Z[te]=ie}_lendControlInterpolant(){const _=this._controlInterpolants,Z=this._nActiveControlInterpolants++;let te=_[Z];return te===void 0&&(te=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),te.__cacheIndex=Z,_[Z]=te),te}_takeBackControlInterpolant(_){const Z=this._controlInterpolants,te=_.__cacheIndex,ne=--this._nActiveControlInterpolants,ie=Z[ne];_.__cacheIndex=ne,Z[ne]=_,ie.__cacheIndex=te,Z[te]=ie}clipAction(_,Z,te){const ne=Z||this._root,ie=ne.uuid;let oe=typeof _=="string"?AnimationClip.findByName(ne,_):_;const se=oe!==null?oe.uuid:_,ae=this._actionsByClip[se];let le=null;if(te===void 0&&(oe!==null?te=oe.blendMode:te=NormalAnimationBlendMode),ae!==void 0){const fe=ae.actionByRoot[ie];if(fe!==void 0&&fe.blendMode===te)return fe;le=ae.knownActions[0],oe===null&&(oe=le._clip)}if(oe===null)return null;const ce=new AnimationAction(this,oe,Z,te);return this._bindAction(ce,le),this._addInactiveAction(ce,se,ie),ce}existingAction(_,Z){const te=Z||this._root,ne=te.uuid,ie=typeof _=="string"?AnimationClip.findByName(te,_):_,oe=ie?ie.uuid:_,se=this._actionsByClip[oe];return se!==void 0&&se.actionByRoot[ne]||null}stopAllAction(){const _=this._actions,Z=this._nActiveActions;for(let te=Z-1;te>=0;--te)_[te].stop();return this}update(_){_*=this.timeScale;const Z=this._actions,te=this._nActiveActions,ne=this.time+=_,ie=Math.sign(_),oe=this._accuIndex^=1;for(let le=0;le!==te;++le)Z[le]._update(ne,_,ie,oe);const se=this._bindings,ae=this._nActiveBindings;for(let le=0;le!==ae;++le)se[le].apply(oe);return this}setTime(_){this.time=0;for(let Z=0;Z<this._actions.length;Z++)this._actions[Z].time=0;return this.update(_)}getRoot(){return this._root}uncacheClip(_){const Z=this._actions,te=_.uuid,ne=this._actionsByClip,ie=ne[te];if(ie!==void 0){const oe=ie.knownActions;for(let se=0,ae=oe.length;se!==ae;++se){const le=oe[se];this._deactivateAction(le);const ce=le._cacheIndex,fe=Z[Z.length-1];le._cacheIndex=null,le._byClipCacheIndex=null,fe._cacheIndex=ce,Z[ce]=fe,Z.pop(),this._removeInactiveBindingsForAction(le)}delete ne[te]}}uncacheRoot(_){const Z=_.uuid,te=this._actionsByClip;for(const oe in te){const se=te[oe].actionByRoot,ae=se[Z];ae!==void 0&&(this._deactivateAction(ae),this._removeInactiveAction(ae))}const ne=this._bindingsByRootAndName,ie=ne[Z];if(ie!==void 0)for(const oe in ie){const se=ie[oe];se.restoreOriginalState(),this._removeInactiveBinding(se)}}uncacheAction(_,Z){const te=this.existingAction(_,Z);te!==null&&(this._deactivateAction(te),this._removeInactiveAction(te))}}class RenderTarget3D extends RenderTarget{constructor(_=1,Z=1,te=1,ne={}){super(_,Z,ne),this.isRenderTarget3D=!0,this.depth=te,this.texture=new Data3DTexture$1(null,_,Z,te),this.texture.isRenderTargetTexture=!0}}class RenderTargetArray extends RenderTarget{constructor(_=1,Z=1,te=1,ne={}){super(_,Z,ne),this.isRenderTargetArray=!0,this.depth=te,this.texture=new DataArrayTexture(null,_,Z,te),this.texture.isRenderTargetTexture=!0}}class Uniform{constructor(_){this.value=_}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let _id$3=0;class UniformsGroup extends EventDispatcher$1{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_id$3++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(_){return this.uniforms.push(_),this}remove(_){const Z=this.uniforms.indexOf(_);return Z!==-1&&this.uniforms.splice(Z,1),this}setName(_){return this.name=_,this}setUsage(_){return this.usage=_,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(_){this.name=_.name,this.usage=_.usage;const Z=_.uniforms;this.uniforms.length=0;for(let te=0,ne=Z.length;te<ne;te++){const ie=Array.isArray(Z[te])?Z[te]:[Z[te]];for(let oe=0;oe<ie.length;oe++)this.uniforms.push(ie[oe].clone())}return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_,Z,te=1){super(_,Z),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=te}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}clone(_){const Z=super.clone(_);return Z.meshPerAttribute=this.meshPerAttribute,Z}toJSON(_){const Z=super.toJSON(_);return Z.isInstancedInterleavedBuffer=!0,Z.meshPerAttribute=this.meshPerAttribute,Z}}class GLBufferAttribute{constructor(_,Z,te,ne,ie){this.isGLBufferAttribute=!0,this.name="",this.buffer=_,this.type=Z,this.itemSize=te,this.elementSize=ne,this.count=ie,this.version=0}set needsUpdate(_){_===!0&&this.version++}setBuffer(_){return this.buffer=_,this}setType(_,Z){return this.type=_,this.elementSize=Z,this}setItemSize(_){return this.itemSize=_,this}setCount(_){return this.count=_,this}}const _matrix$3=new Matrix4;class Raycaster{constructor(_,Z,te=0,ne=1/0){this.ray=new Ray(_,Z),this.near=te,this.far=ne,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_,Z){this.ray.set(_,Z)}setFromCamera(_,Z){Z.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(Z.matrixWorld),this.ray.direction.set(_.x,_.y,.5).unproject(Z).sub(this.ray.origin).normalize(),this.camera=Z):Z.isOrthographicCamera?(this.ray.origin.set(_.x,_.y,(Z.near+Z.far)/(Z.near-Z.far)).unproject(Z),this.ray.direction.set(0,0,-1).transformDirection(Z.matrixWorld),this.camera=Z):console.error("THREE.Raycaster: Unsupported camera type: "+Z.type)}setFromXRController(_){return _matrix$3.identity().extractRotation(_.matrixWorld),this.ray.origin.setFromMatrixPosition(_.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(_matrix$3),this}intersectObject(_,Z=!0,te=[]){return intersect(_,this,te,Z),te.sort(ascSort),te}intersectObjects(_,Z=!0,te=[]){for(let ne=0,ie=_.length;ne<ie;ne++)intersect(_[ne],this,te,Z);return te.sort(ascSort),te}}function ascSort(K,_){return K.distance-_.distance}function intersect(K,_,Z,te){let ne=!0;if(K.layers.test(_.layers)&&K.raycast(_,Z)===!1&&(ne=!1),ne===!0&&te===!0){const ie=K.children;for(let oe=0,se=ie.length;oe<se;oe++)intersect(ie[oe],_,Z,!0)}}class Spherical{constructor(_=1,Z=0,te=0){this.radius=_,this.phi=Z,this.theta=te}set(_,Z,te){return this.radius=_,this.phi=Z,this.theta=te,this}copy(_){return this.radius=_.radius,this.phi=_.phi,this.theta=_.theta,this}makeSafe(){return this.phi=clamp$4(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,Z,te){return this.radius=Math.sqrt(_*_+Z*Z+te*te),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_,te),this.phi=Math.acos(clamp$4(Z/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_=1,Z=0,te=0){this.radius=_,this.theta=Z,this.y=te}set(_,Z,te){return this.radius=_,this.theta=Z,this.y=te,this}copy(_){return this.radius=_.radius,this.theta=_.theta,this.y=_.y,this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,Z,te){return this.radius=Math.sqrt(_*_+te*te),this.theta=Math.atan2(_,te),this.y=Z,this}clone(){return new this.constructor().copy(this)}}class Matrix2{constructor(_,Z,te,ne){Matrix2.prototype.isMatrix2=!0,this.elements=[1,0,0,1],_!==void 0&&this.set(_,Z,te,ne)}identity(){return this.set(1,0,0,1),this}fromArray(_,Z=0){for(let te=0;te<4;te++)this.elements[te]=_[te+Z];return this}set(_,Z,te,ne){const ie=this.elements;return ie[0]=_,ie[2]=Z,ie[1]=te,ie[3]=ne,this}}const _vector$4=new Vector2;class Box2{constructor(_=new Vector2(1/0,1/0),Z=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=_,this.max=Z}set(_,Z){return this.min.copy(_),this.max.copy(Z),this}setFromPoints(_){this.makeEmpty();for(let Z=0,te=_.length;Z<te;Z++)this.expandByPoint(_[Z]);return this}setFromCenterAndSize(_,Z){const te=_vector$4.copy(Z).multiplyScalar(.5);return this.min.copy(_).sub(te),this.max.copy(_).add(te),this}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_){return this.isEmpty()?_.set(0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}containsPoint(_){return _.x>=this.min.x&&_.x<=this.max.x&&_.y>=this.min.y&&_.y<=this.max.y}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y}getParameter(_,Z){return Z.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_){return _.max.x>=this.min.x&&_.min.x<=this.max.x&&_.max.y>=this.min.y&&_.min.y<=this.max.y}clampPoint(_,Z){return Z.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$4).distanceTo(_)}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_=new Vector3,Z=new Vector3){this.start=_,this.end=Z}set(_,Z){return this.start.copy(_),this.end.copy(Z),this}copy(_){return this.start.copy(_.start),this.end.copy(_.end),this}getCenter(_){return _.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_){return _.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_,Z){return this.delta(Z).multiplyScalar(_).add(this.start)}closestPointToPointParameter(_,Z){_startP.subVectors(_,this.start),_startEnd.subVectors(this.end,this.start);const te=_startEnd.dot(_startEnd);let ie=_startEnd.dot(_startP)/te;return Z&&(ie=clamp$4(ie,0,1)),ie}closestPointToPoint(_,Z,te){const ne=this.closestPointToPointParameter(_,Z);return this.delta(te).multiplyScalar(ne).add(this.start)}applyMatrix4(_){return this.start.applyMatrix4(_),this.end.applyMatrix4(_),this}equals(_){return _.start.equals(this.start)&&_.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(_,Z){super(),this.light=_,this.matrixAutoUpdate=!1,this.color=Z,this.type="SpotLightHelper";const te=new BufferGeometry,ne=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let oe=0,se=1,ae=32;oe<ae;oe++,se++){const le=oe/ae*Math.PI*2,ce=se/ae*Math.PI*2;ne.push(Math.cos(le),Math.sin(le),1,Math.cos(ce),Math.sin(ce),1)}te.setAttribute("position",new Float32BufferAttribute(ne,3));const ie=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(te,ie),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const _=this.light.distance?this.light.distance:1e3,Z=_*Math.tan(this.light.angle);this.cone.scale.set(Z,Z,_),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix$1=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(_){const Z=getBoneList(_),te=new BufferGeometry,ne=[],ie=[],oe=new Color$1(0,0,1),se=new Color$1(0,1,0);for(let le=0;le<Z.length;le++){const ce=Z[le];ce.parent&&ce.parent.isBone&&(ne.push(0,0,0),ne.push(0,0,0),ie.push(oe.r,oe.g,oe.b),ie.push(se.r,se.g,se.b))}te.setAttribute("position",new Float32BufferAttribute(ne,3)),te.setAttribute("color",new Float32BufferAttribute(ie,3));const ae=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(te,ae),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_,this.bones=Z,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_){const Z=this.bones,te=this.geometry,ne=te.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let ie=0,oe=0;ie<Z.length;ie++){const se=Z[ie];se.parent&&se.parent.isBone&&(_boneMatrix$1.multiplyMatrices(_matrixWorldInv,se.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix$1),ne.setXYZ(oe,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix$1.multiplyMatrices(_matrixWorldInv,se.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix$1),ne.setXYZ(oe+1,_vector$2.x,_vector$2.y,_vector$2.z),oe+=2)}te.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(K){const _=[];K.isBone===!0&&_.push(K);for(let Z=0;Z<K.children.length;Z++)_.push(...getBoneList(K.children[Z]));return _}class PointLightHelper extends Mesh{constructor(_,Z,te){const ne=new SphereGeometry(Z,4,2),ie=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(ne,ie),this.light=_,this.color=te,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color$1,_color2=new Color$1;class HemisphereLightHelper extends Object3D{constructor(_,Z,te){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=te,this.type="HemisphereLightHelper";const ne=new OctahedronGeometry(Z);ne.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const ie=ne.getAttribute("position"),oe=new Float32Array(ie.count*3);ne.setAttribute("color",new BufferAttribute(oe,3)),this.add(new Mesh(ne,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const Z=_.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let te=0,ne=Z.count;te<ne;te++){const ie=te<ne/2?_color1:_color2;Z.setXYZ(te,ie.r,ie.g,ie.b)}Z.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_=10,Z=10,te=4473924,ne=8947848){te=new Color$1(te),ne=new Color$1(ne);const ie=Z/2,oe=_/Z,se=_/2,ae=[],le=[];for(let de=0,pe=0,he=-se;de<=Z;de++,he+=oe){ae.push(-se,0,he,se,0,he),ae.push(he,0,-se,he,0,se);const ge=de===ie?te:ne;ge.toArray(le,pe),pe+=3,ge.toArray(le,pe),pe+=3,ge.toArray(le,pe),pe+=3,ge.toArray(le,pe),pe+=3}const ce=new BufferGeometry;ce.setAttribute("position",new Float32BufferAttribute(ae,3)),ce.setAttribute("color",new Float32BufferAttribute(le,3));const fe=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ce,fe),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_=10,Z=16,te=8,ne=64,ie=4473924,oe=8947848){ie=new Color$1(ie),oe=new Color$1(oe);const se=[],ae=[];if(Z>1)for(let fe=0;fe<Z;fe++){const de=fe/Z*(Math.PI*2),pe=Math.sin(de)*_,he=Math.cos(de)*_;se.push(0,0,0),se.push(pe,0,he);const ge=fe&1?ie:oe;ae.push(ge.r,ge.g,ge.b),ae.push(ge.r,ge.g,ge.b)}for(let fe=0;fe<te;fe++){const de=fe&1?ie:oe,pe=_-_/te*fe;for(let he=0;he<ne;he++){let ge=he/ne*(Math.PI*2),me=Math.sin(ge)*pe,Ae=Math.cos(ge)*pe;se.push(me,0,Ae),ae.push(de.r,de.g,de.b),ge=(he+1)/ne*(Math.PI*2),me=Math.sin(ge)*pe,Ae=Math.cos(ge)*pe,se.push(me,0,Ae),ae.push(de.r,de.g,de.b)}}const le=new BufferGeometry;le.setAttribute("position",new Float32BufferAttribute(se,3)),le.setAttribute("color",new Float32BufferAttribute(ae,3));const ce=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(le,ce),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(_,Z,te){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=te,this.type="DirectionalLightHelper",Z===void 0&&(Z=1);let ne=new BufferGeometry;ne.setAttribute("position",new Float32BufferAttribute([-Z,Z,0,Z,Z,0,Z,-Z,0,-Z,-Z,0,-Z,Z,0],3));const ie=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line$2(ne,ie),this.add(this.lightPlane),ne=new BufferGeometry,ne.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line$2(ne,ie),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector$d=new Vector3,_camera$2=new Camera$1;class CameraHelper extends LineSegments{constructor(_){const Z=new BufferGeometry,te=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),ne=[],ie=[],oe={};se("n1","n2"),se("n2","n4"),se("n4","n3"),se("n3","n1"),se("f1","f2"),se("f2","f4"),se("f4","f3"),se("f3","f1"),se("n1","f1"),se("n2","f2"),se("n3","f3"),se("n4","f4"),se("p","n1"),se("p","n2"),se("p","n3"),se("p","n4"),se("u1","u2"),se("u2","u3"),se("u3","u1"),se("c","t"),se("p","c"),se("cn1","cn2"),se("cn3","cn4"),se("cf1","cf2"),se("cf3","cf4");function se(he,ge){ae(he),ae(ge)}function ae(he){ne.push(0,0,0),ie.push(0,0,0),oe[he]===void 0&&(oe[he]=[]),oe[he].push(ne.length/3-1)}Z.setAttribute("position",new Float32BufferAttribute(ne,3)),Z.setAttribute("color",new Float32BufferAttribute(ie,3)),super(Z,te),this.type="CameraHelper",this.camera=_,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=oe,this.update();const le=new Color$1(16755200),ce=new Color$1(16711680),fe=new Color$1(43775),de=new Color$1(16777215),pe=new Color$1(3355443);this.setColors(le,ce,fe,de,pe)}setColors(_,Z,te,ne,ie){const se=this.geometry.getAttribute("color");se.setXYZ(0,_.r,_.g,_.b),se.setXYZ(1,_.r,_.g,_.b),se.setXYZ(2,_.r,_.g,_.b),se.setXYZ(3,_.r,_.g,_.b),se.setXYZ(4,_.r,_.g,_.b),se.setXYZ(5,_.r,_.g,_.b),se.setXYZ(6,_.r,_.g,_.b),se.setXYZ(7,_.r,_.g,_.b),se.setXYZ(8,_.r,_.g,_.b),se.setXYZ(9,_.r,_.g,_.b),se.setXYZ(10,_.r,_.g,_.b),se.setXYZ(11,_.r,_.g,_.b),se.setXYZ(12,_.r,_.g,_.b),se.setXYZ(13,_.r,_.g,_.b),se.setXYZ(14,_.r,_.g,_.b),se.setXYZ(15,_.r,_.g,_.b),se.setXYZ(16,_.r,_.g,_.b),se.setXYZ(17,_.r,_.g,_.b),se.setXYZ(18,_.r,_.g,_.b),se.setXYZ(19,_.r,_.g,_.b),se.setXYZ(20,_.r,_.g,_.b),se.setXYZ(21,_.r,_.g,_.b),se.setXYZ(22,_.r,_.g,_.b),se.setXYZ(23,_.r,_.g,_.b),se.setXYZ(24,Z.r,Z.g,Z.b),se.setXYZ(25,Z.r,Z.g,Z.b),se.setXYZ(26,Z.r,Z.g,Z.b),se.setXYZ(27,Z.r,Z.g,Z.b),se.setXYZ(28,Z.r,Z.g,Z.b),se.setXYZ(29,Z.r,Z.g,Z.b),se.setXYZ(30,Z.r,Z.g,Z.b),se.setXYZ(31,Z.r,Z.g,Z.b),se.setXYZ(32,te.r,te.g,te.b),se.setXYZ(33,te.r,te.g,te.b),se.setXYZ(34,te.r,te.g,te.b),se.setXYZ(35,te.r,te.g,te.b),se.setXYZ(36,te.r,te.g,te.b),se.setXYZ(37,te.r,te.g,te.b),se.setXYZ(38,ne.r,ne.g,ne.b),se.setXYZ(39,ne.r,ne.g,ne.b),se.setXYZ(40,ie.r,ie.g,ie.b),se.setXYZ(41,ie.r,ie.g,ie.b),se.setXYZ(42,ie.r,ie.g,ie.b),se.setXYZ(43,ie.r,ie.g,ie.b),se.setXYZ(44,ie.r,ie.g,ie.b),se.setXYZ(45,ie.r,ie.g,ie.b),se.setXYZ(46,ie.r,ie.g,ie.b),se.setXYZ(47,ie.r,ie.g,ie.b),se.setXYZ(48,ie.r,ie.g,ie.b),se.setXYZ(49,ie.r,ie.g,ie.b),se.needsUpdate=!0}update(){const _=this.geometry,Z=this.pointMap,te=1,ne=1;_camera$2.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const ie=this.camera.coordinateSystem===WebGLCoordinateSystem?-1:0;setPoint$1("c",Z,_,_camera$2,0,0,ie),setPoint$1("t",Z,_,_camera$2,0,0,1),setPoint$1("n1",Z,_,_camera$2,-1,-1,ie),setPoint$1("n2",Z,_,_camera$2,te,-1,ie),setPoint$1("n3",Z,_,_camera$2,-1,ne,ie),setPoint$1("n4",Z,_,_camera$2,te,ne,ie),setPoint$1("f1",Z,_,_camera$2,-1,-1,1),setPoint$1("f2",Z,_,_camera$2,te,-1,1),setPoint$1("f3",Z,_,_camera$2,-1,ne,1),setPoint$1("f4",Z,_,_camera$2,te,ne,1),setPoint$1("u1",Z,_,_camera$2,te*.7,ne*1.1,ie),setPoint$1("u2",Z,_,_camera$2,-1*.7,ne*1.1,ie),setPoint$1("u3",Z,_,_camera$2,0,ne*2,ie),setPoint$1("cf1",Z,_,_camera$2,-1,0,1),setPoint$1("cf2",Z,_,_camera$2,te,0,1),setPoint$1("cf3",Z,_,_camera$2,0,-1,1),setPoint$1("cf4",Z,_,_camera$2,0,ne,1),setPoint$1("cn1",Z,_,_camera$2,-1,0,ie),setPoint$1("cn2",Z,_,_camera$2,te,0,ie),setPoint$1("cn3",Z,_,_camera$2,0,-1,ie),setPoint$1("cn4",Z,_,_camera$2,0,ne,ie),_.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint$1(K,_,Z,te,ne,ie,oe){_vector$d.set(ne,ie,oe).unproject(te);const se=_[K];if(se!==void 0){const ae=Z.getAttribute("position");for(let le=0,ce=se.length;le<ce;le++)ae.setXYZ(se[le],_vector$d.x,_vector$d.y,_vector$d.z)}}const _box$5=new Box3;class BoxHelper extends LineSegments{constructor(_,Z=16776960){const te=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ne=new Float32Array(8*3),ie=new BufferGeometry;ie.setIndex(new BufferAttribute(te,1)),ie.setAttribute("position",new BufferAttribute(ne,3)),super(ie,new LineBasicMaterial({color:Z,toneMapped:!1})),this.object=_,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&_box$5.setFromObject(this.object),_box$5.isEmpty())return;const _=_box$5.min,Z=_box$5.max,te=this.geometry.attributes.position,ne=te.array;ne[0]=Z.x,ne[1]=Z.y,ne[2]=Z.z,ne[3]=_.x,ne[4]=Z.y,ne[5]=Z.z,ne[6]=_.x,ne[7]=_.y,ne[8]=Z.z,ne[9]=Z.x,ne[10]=_.y,ne[11]=Z.z,ne[12]=Z.x,ne[13]=Z.y,ne[14]=_.z,ne[15]=_.x,ne[16]=Z.y,ne[17]=_.z,ne[18]=_.x,ne[19]=_.y,ne[20]=_.z,ne[21]=Z.x,ne[22]=_.y,ne[23]=_.z,te.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_){return this.object=_,this.update(),this}copy(_,Z){return super.copy(_,Z),this.object=_.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_,Z=16776960){const te=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ne=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],ie=new BufferGeometry;ie.setIndex(new BufferAttribute(te,1)),ie.setAttribute("position",new Float32BufferAttribute(ne,3)),super(ie,new LineBasicMaterial({color:Z,toneMapped:!1})),this.box=_,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_){const Z=this.box;Z.isEmpty()||(Z.getCenter(this.position),Z.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line$2{constructor(_,Z=1,te=16776960){const ne=te,ie=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],oe=new BufferGeometry;oe.setAttribute("position",new Float32BufferAttribute(ie,3)),oe.computeBoundingSphere(),super(oe,new LineBasicMaterial({color:ne,toneMapped:!1})),this.type="PlaneHelper",this.plane=_,this.size=Z;const se=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],ae=new BufferGeometry;ae.setAttribute("position",new Float32BufferAttribute(se,3)),ae.computeBoundingSphere(),this.add(new Mesh(ae,new MeshBasicMaterial({color:ne,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(_=new Vector3(0,0,1),Z=new Vector3(0,0,0),te=1,ne=16776960,ie=te*.2,oe=ie*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(Z),this.line=new Line$2(_lineGeometry,new LineBasicMaterial({color:ne,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:ne,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_),this.setLength(te,ie,oe)}setDirection(_){if(_.y>.99999)this.quaternion.set(0,0,0,1);else if(_.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(_.z,0,-_.x).normalize();const Z=Math.acos(_.y);this.quaternion.setFromAxisAngle(_axis,Z)}}setLength(_,Z=_*.2,te=Z*.2){this.line.scale.set(1,Math.max(1e-4,_-Z),1),this.line.updateMatrix(),this.cone.scale.set(te,Z,te),this.cone.position.y=_,this.cone.updateMatrix()}setColor(_){this.line.material.color.set(_),this.cone.material.color.set(_)}copy(_){return super.copy(_,!1),this.line.copy(_.line),this.cone.copy(_.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_=1){const Z=[0,0,0,_,0,0,0,0,0,0,_,0,0,0,0,0,0,_],te=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],ne=new BufferGeometry;ne.setAttribute("position",new Float32BufferAttribute(Z,3)),ne.setAttribute("color",new Float32BufferAttribute(te,3));const ie=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ne,ie),this.type="AxesHelper"}setColors(_,Z,te){const ne=new Color$1,ie=this.geometry.attributes.color.array;return ne.set(_),ne.toArray(ie,0),ne.toArray(ie,3),ne.set(Z),ne.toArray(ie,6),ne.toArray(ie,9),ne.set(te),ne.toArray(ie,12),ne.toArray(ie,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color$1,this.subPaths=[],this.currentPath=null}moveTo(_,Z){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_,Z),this}lineTo(_,Z){return this.currentPath.lineTo(_,Z),this}quadraticCurveTo(_,Z,te,ne){return this.currentPath.quadraticCurveTo(_,Z,te,ne),this}bezierCurveTo(_,Z,te,ne,ie,oe){return this.currentPath.bezierCurveTo(_,Z,te,ne,ie,oe),this}splineThru(_){return this.currentPath.splineThru(_),this}toShapes(_){function Z(Ae){const ye=[];for(let ve=0,_e=Ae.length;ve<_e;ve++){const Te=Ae[ve],be=new Shape$2;be.curves=Te.curves,ye.push(be)}return ye}function te(Ae,ye){const ve=ye.length;let _e=!1;for(let Te=ve-1,be=0;be<ve;Te=be++){let Re=ye[Te],we=ye[be],Pe=we.x-Re.x,Ie=we.y-Re.y;if(Math.abs(Ie)>Number.EPSILON){if(Ie<0&&(Re=ye[be],Pe=-Pe,we=ye[Te],Ie=-Ie),Ae.y<Re.y||Ae.y>we.y)continue;if(Ae.y===Re.y){if(Ae.x===Re.x)return!0}else{const $e=Ie*(Ae.x-Re.x)-Pe*(Ae.y-Re.y);if($e===0)return!0;if($e<0)continue;_e=!_e}}else{if(Ae.y!==Re.y)continue;if(we.x<=Ae.x&&Ae.x<=Re.x||Re.x<=Ae.x&&Ae.x<=we.x)return!0}}return _e}const ne=ShapeUtils.isClockWise,ie=this.subPaths;if(ie.length===0)return[];let oe,se,ae;const le=[];if(ie.length===1)return se=ie[0],ae=new Shape$2,ae.curves=se.curves,le.push(ae),le;let ce=!ne(ie[0].getPoints());ce=_?!ce:ce;const fe=[],de=[];let pe=[],he=0,ge;de[he]=void 0,pe[he]=[];for(let Ae=0,ye=ie.length;Ae<ye;Ae++)se=ie[Ae],ge=se.getPoints(),oe=ne(ge),oe=_?!oe:oe,oe?(!ce&&de[he]&&he++,de[he]={s:new Shape$2,p:ge},de[he].s.curves=se.curves,ce&&he++,pe[he]=[]):pe[he].push({h:se,p:ge[0]});if(!de[0])return Z(ie);if(de.length>1){let Ae=!1,ye=0;for(let ve=0,_e=de.length;ve<_e;ve++)fe[ve]=[];for(let ve=0,_e=de.length;ve<_e;ve++){const Te=pe[ve];for(let be=0;be<Te.length;be++){const Re=Te[be];let we=!0;for(let Pe=0;Pe<de.length;Pe++)te(Re.p,de[Pe].p)&&(ve!==Pe&&ye++,we?(we=!1,fe[Pe].push(Re)):Ae=!0);we&&fe[ve].push(Re)}}ye>0&&Ae===!1&&(pe=fe)}let me;for(let Ae=0,ye=de.length;Ae<ye;Ae++){ae=de[Ae].s,le.push(ae),me=pe[Ae];for(let ve=0,_e=me.length;ve<_e;ve++)ae.holes.push(me[ve].h)}return le}}class Controls extends EventDispatcher$1{constructor(_,Z=null){super(),this.object=_,this.domElement=Z,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(_){if(_===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=_}disconnect(){}dispose(){}update(){}}function contain(K,_){const Z=K.image&&K.image.width?K.image.width/K.image.height:1;return Z>_?(K.repeat.x=1,K.repeat.y=Z/_,K.offset.x=0,K.offset.y=(1-K.repeat.y)/2):(K.repeat.x=_/Z,K.repeat.y=1,K.offset.x=(1-K.repeat.x)/2,K.offset.y=0),K}function cover(K,_){const Z=K.image&&K.image.width?K.image.width/K.image.height:1;return Z>_?(K.repeat.x=_/Z,K.repeat.y=1,K.offset.x=(1-K.repeat.x)/2,K.offset.y=0):(K.repeat.x=1,K.repeat.y=Z/_,K.offset.x=0,K.offset.y=(1-K.repeat.y)/2),K}function fill(K){return K.repeat.x=1,K.repeat.y=1,K.offset.x=0,K.offset.y=0,K}function getByteLength(K,_,Z,te){const ne=getTextureTypeByteLength(te);switch(Z){case AlphaFormat:return K*_;case LuminanceFormat:return K*_;case LuminanceAlphaFormat:return K*_*2;case RedFormat:return K*_/ne.components*ne.byteLength;case RedIntegerFormat:return K*_/ne.components*ne.byteLength;case RGFormat:return K*_*2/ne.components*ne.byteLength;case RGIntegerFormat:return K*_*2/ne.components*ne.byteLength;case RGBFormat:return K*_*3/ne.components*ne.byteLength;case RGBAFormat:return K*_*4/ne.components*ne.byteLength;case RGBAIntegerFormat:return K*_*4/ne.components*ne.byteLength;case RGB_S3TC_DXT1_Format:case RGBA_S3TC_DXT1_Format:return Math.floor((K+3)/4)*Math.floor((_+3)/4)*8;case RGBA_S3TC_DXT3_Format:case RGBA_S3TC_DXT5_Format:return Math.floor((K+3)/4)*Math.floor((_+3)/4)*16;case RGB_PVRTC_2BPPV1_Format:case RGBA_PVRTC_2BPPV1_Format:return Math.max(K,16)*Math.max(_,8)/4;case RGB_PVRTC_4BPPV1_Format:case RGBA_PVRTC_4BPPV1_Format:return Math.max(K,8)*Math.max(_,8)/2;case RGB_ETC1_Format:case RGB_ETC2_Format:return Math.floor((K+3)/4)*Math.floor((_+3)/4)*8;case RGBA_ETC2_EAC_Format:return Math.floor((K+3)/4)*Math.floor((_+3)/4)*16;case RGBA_ASTC_4x4_Format:return Math.floor((K+3)/4)*Math.floor((_+3)/4)*16;case RGBA_ASTC_5x4_Format:return Math.floor((K+4)/5)*Math.floor((_+3)/4)*16;case RGBA_ASTC_5x5_Format:return Math.floor((K+4)/5)*Math.floor((_+4)/5)*16;case RGBA_ASTC_6x5_Format:return Math.floor((K+5)/6)*Math.floor((_+4)/5)*16;case RGBA_ASTC_6x6_Format:return Math.floor((K+5)/6)*Math.floor((_+5)/6)*16;case RGBA_ASTC_8x5_Format:return Math.floor((K+7)/8)*Math.floor((_+4)/5)*16;case RGBA_ASTC_8x6_Format:return Math.floor((K+7)/8)*Math.floor((_+5)/6)*16;case RGBA_ASTC_8x8_Format:return Math.floor((K+7)/8)*Math.floor((_+7)/8)*16;case RGBA_ASTC_10x5_Format:return Math.floor((K+9)/10)*Math.floor((_+4)/5)*16;case RGBA_ASTC_10x6_Format:return Math.floor((K+9)/10)*Math.floor((_+5)/6)*16;case RGBA_ASTC_10x8_Format:return Math.floor((K+9)/10)*Math.floor((_+7)/8)*16;case RGBA_ASTC_10x10_Format:return Math.floor((K+9)/10)*Math.floor((_+9)/10)*16;case RGBA_ASTC_12x10_Format:return Math.floor((K+11)/12)*Math.floor((_+9)/10)*16;case RGBA_ASTC_12x12_Format:return Math.floor((K+11)/12)*Math.floor((_+11)/12)*16;case RGBA_BPTC_Format:case RGB_BPTC_SIGNED_Format:case RGB_BPTC_UNSIGNED_Format:return Math.ceil(K/4)*Math.ceil(_/4)*16;case RED_RGTC1_Format:case SIGNED_RED_RGTC1_Format:return Math.ceil(K/4)*Math.ceil(_/4)*8;case RED_GREEN_RGTC2_Format:case SIGNED_RED_GREEN_RGTC2_Format:return Math.ceil(K/4)*Math.ceil(_/4)*16}throw new Error(`Unable to determine texture byte length for ${Z} format.`)}function getTextureTypeByteLength(K){switch(K){case UnsignedByteType:case ByteType:return{byteLength:1,components:1};case UnsignedShortType:case ShortType:case HalfFloatType:return{byteLength:2,components:1};case UnsignedShort4444Type:case UnsignedShort5551Type:return{byteLength:2,components:4};case UnsignedIntType:case IntType:case FloatType:return{byteLength:4,components:1};case UnsignedInt5999Type:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${K}.`)}class TextureUtils{static contain(_,Z){return contain(_,Z)}static cover(_,Z){return cover(_,Z)}static fill(_){return fill(_)}static getByteLength(_,Z,te,ne){return getByteLength(_,Z,te,ne)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function WebGLAnimation(){let K=null,_=!1,Z=null,te=null;function ne(ie,oe){Z(ie,oe),te=K.requestAnimationFrame(ne)}return{start:function(){_!==!0&&Z!==null&&(te=K.requestAnimationFrame(ne),_=!0)},stop:function(){K.cancelAnimationFrame(te),_=!1},setAnimationLoop:function(ie){Z=ie},setContext:function(ie){K=ie}}}function WebGLAttributes(K){const _=new WeakMap;function Z(se,ae){const le=se.array,ce=se.usage,fe=le.byteLength,de=K.createBuffer();K.bindBuffer(ae,de),K.bufferData(ae,le,ce),se.onUploadCallback();let pe;if(le instanceof Float32Array)pe=K.FLOAT;else if(le instanceof Uint16Array)se.isFloat16BufferAttribute?pe=K.HALF_FLOAT:pe=K.UNSIGNED_SHORT;else if(le instanceof Int16Array)pe=K.SHORT;else if(le instanceof Uint32Array)pe=K.UNSIGNED_INT;else if(le instanceof Int32Array)pe=K.INT;else if(le instanceof Int8Array)pe=K.BYTE;else if(le instanceof Uint8Array)pe=K.UNSIGNED_BYTE;else if(le instanceof Uint8ClampedArray)pe=K.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+le);return{buffer:de,type:pe,bytesPerElement:le.BYTES_PER_ELEMENT,version:se.version,size:fe}}function te(se,ae,le){const ce=ae.array,fe=ae.updateRanges;if(K.bindBuffer(le,se),fe.length===0)K.bufferSubData(le,0,ce);else{fe.sort((pe,he)=>pe.start-he.start);let de=0;for(let pe=1;pe<fe.length;pe++){const he=fe[de],ge=fe[pe];ge.start<=he.start+he.count+1?he.count=Math.max(he.count,ge.start+ge.count-he.start):(++de,fe[de]=ge)}fe.length=de+1;for(let pe=0,he=fe.length;pe<he;pe++){const ge=fe[pe];K.bufferSubData(le,ge.start*ce.BYTES_PER_ELEMENT,ce,ge.start,ge.count)}ae.clearUpdateRanges()}ae.onUploadCallback()}function ne(se){return se.isInterleavedBufferAttribute&&(se=se.data),_.get(se)}function ie(se){se.isInterleavedBufferAttribute&&(se=se.data);const ae=_.get(se);ae&&(K.deleteBuffer(ae.buffer),_.delete(se))}function oe(se,ae){if(se.isInterleavedBufferAttribute&&(se=se.data),se.isGLBufferAttribute){const ce=_.get(se);(!ce||ce.version<se.version)&&_.set(se,{buffer:se.buffer,type:se.type,bytesPerElement:se.elementSize,version:se.version});return}const le=_.get(se);if(le===void 0)_.set(se,Z(se,ae));else if(le.version<se.version){if(le.size!==se.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");te(le.buffer,se,ae),le.version=se.version}}return{get:ne,remove:ie,update:oe}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,common$1=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment$1="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphinstance_vertex=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment$1=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common:common$1,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment:colorspace_fragment$1,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphinstance_vertex,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment:opaque_fragment$1,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},envMapRotation:{value:new Matrix3},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color$1(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},specular:{value:new Color$1(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix3}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color$1(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color$1(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color$1(0)},specularColor:{value:new Color$1(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0},_e1$1=new Euler,_m1$1=new Matrix4;function WebGLBackground(K,_,Z,te,ne,ie,oe){const se=new Color$1(0);let ae=ie===!0?0:1,le,ce,fe=null,de=0,pe=null;function he(ve){let _e=ve.isScene===!0?ve.background:null;return _e&&_e.isTexture&&(_e=(ve.backgroundBlurriness>0?Z:_).get(_e)),_e}function ge(ve){let _e=!1;const Te=he(ve);Te===null?Ae(se,ae):Te&&Te.isColor&&(Ae(Te,1),_e=!0);const be=K.xr.getEnvironmentBlendMode();be==="additive"?te.buffers.color.setClear(0,0,0,1,oe):be==="alpha-blend"&&te.buffers.color.setClear(0,0,0,0,oe),(K.autoClear||_e)&&(te.buffers.depth.setTest(!0),te.buffers.depth.setMask(!0),te.buffers.color.setMask(!0),K.clear(K.autoClearColor,K.autoClearDepth,K.autoClearStencil))}function me(ve,_e){const Te=he(_e);Te&&(Te.isCubeTexture||Te.mapping===CubeUVReflectionMapping)?(ce===void 0&&(ce=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),ce.geometry.deleteAttribute("normal"),ce.geometry.deleteAttribute("uv"),ce.onBeforeRender=function(be,Re,we){this.matrixWorld.copyPosition(we.matrixWorld)},Object.defineProperty(ce.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),ne.update(ce)),_e1$1.copy(_e.backgroundRotation),_e1$1.x*=-1,_e1$1.y*=-1,_e1$1.z*=-1,Te.isCubeTexture&&Te.isRenderTargetTexture===!1&&(_e1$1.y*=-1,_e1$1.z*=-1),ce.material.uniforms.envMap.value=Te,ce.material.uniforms.flipEnvMap.value=Te.isCubeTexture&&Te.isRenderTargetTexture===!1?-1:1,ce.material.uniforms.backgroundBlurriness.value=_e.backgroundBlurriness,ce.material.uniforms.backgroundIntensity.value=_e.backgroundIntensity,ce.material.uniforms.backgroundRotation.value.setFromMatrix4(_m1$1.makeRotationFromEuler(_e1$1)),ce.material.toneMapped=ColorManagement.getTransfer(Te.colorSpace)!==SRGBTransfer,(fe!==Te||de!==Te.version||pe!==K.toneMapping)&&(ce.material.needsUpdate=!0,fe=Te,de=Te.version,pe=K.toneMapping),ce.layers.enableAll(),ve.unshift(ce,ce.geometry,ce.material,0,0,null)):Te&&Te.isTexture&&(le===void 0&&(le=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),le.geometry.deleteAttribute("normal"),Object.defineProperty(le.material,"map",{get:function(){return this.uniforms.t2D.value}}),ne.update(le)),le.material.uniforms.t2D.value=Te,le.material.uniforms.backgroundIntensity.value=_e.backgroundIntensity,le.material.toneMapped=ColorManagement.getTransfer(Te.colorSpace)!==SRGBTransfer,Te.matrixAutoUpdate===!0&&Te.updateMatrix(),le.material.uniforms.uvTransform.value.copy(Te.matrix),(fe!==Te||de!==Te.version||pe!==K.toneMapping)&&(le.material.needsUpdate=!0,fe=Te,de=Te.version,pe=K.toneMapping),le.layers.enableAll(),ve.unshift(le,le.geometry,le.material,0,0,null))}function Ae(ve,_e){ve.getRGB(_rgb,getUnlitUniformColorSpace(K)),te.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,_e,oe)}function ye(){ce!==void 0&&(ce.geometry.dispose(),ce.material.dispose(),ce=void 0),le!==void 0&&(le.geometry.dispose(),le.material.dispose(),le=void 0)}return{getClearColor:function(){return se},setClearColor:function(ve,_e=1){se.set(ve),ae=_e,Ae(se,ae)},getClearAlpha:function(){return ae},setClearAlpha:function(ve){ae=ve,Ae(se,ae)},render:ge,addToRenderList:me,dispose:ye}}function WebGLBindingStates(K,_){const Z=K.getParameter(K.MAX_VERTEX_ATTRIBS),te={},ne=de(null);let ie=ne,oe=!1;function se(Ie,$e,Ue,ke,Ge){let He=!1;const ze=fe(ke,Ue,$e);ie!==ze&&(ie=ze,le(ie.object)),He=pe(Ie,ke,Ue,Ge),He&&he(Ie,ke,Ue,Ge),Ge!==null&&_.update(Ge,K.ELEMENT_ARRAY_BUFFER),(He||oe)&&(oe=!1,_e(Ie,$e,Ue,ke),Ge!==null&&K.bindBuffer(K.ELEMENT_ARRAY_BUFFER,_.get(Ge).buffer))}function ae(){return K.createVertexArray()}function le(Ie){return K.bindVertexArray(Ie)}function ce(Ie){return K.deleteVertexArray(Ie)}function fe(Ie,$e,Ue){const ke=Ue.wireframe===!0;let Ge=te[Ie.id];Ge===void 0&&(Ge={},te[Ie.id]=Ge);let He=Ge[$e.id];He===void 0&&(He={},Ge[$e.id]=He);let ze=He[ke];return ze===void 0&&(ze=de(ae()),He[ke]=ze),ze}function de(Ie){const $e=[],Ue=[],ke=[];for(let Ge=0;Ge<Z;Ge++)$e[Ge]=0,Ue[Ge]=0,ke[Ge]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:$e,enabledAttributes:Ue,attributeDivisors:ke,object:Ie,attributes:{},index:null}}function pe(Ie,$e,Ue,ke){const Ge=ie.attributes,He=$e.attributes;let ze=0;const Ke=Ue.getAttributes();for(const tt in Ke)if(Ke[tt].location>=0){const ot=Ge[tt];let Fe=He[tt];if(Fe===void 0&&(tt==="instanceMatrix"&&Ie.instanceMatrix&&(Fe=Ie.instanceMatrix),tt==="instanceColor"&&Ie.instanceColor&&(Fe=Ie.instanceColor)),ot===void 0||ot.attribute!==Fe||Fe&&ot.data!==Fe.data)return!0;ze++}return ie.attributesNum!==ze||ie.index!==ke}function he(Ie,$e,Ue,ke){const Ge={},He=$e.attributes;let ze=0;const Ke=Ue.getAttributes();for(const tt in Ke)if(Ke[tt].location>=0){let ot=He[tt];ot===void 0&&(tt==="instanceMatrix"&&Ie.instanceMatrix&&(ot=Ie.instanceMatrix),tt==="instanceColor"&&Ie.instanceColor&&(ot=Ie.instanceColor));const Fe={};Fe.attribute=ot,ot&&ot.data&&(Fe.data=ot.data),Ge[tt]=Fe,ze++}ie.attributes=Ge,ie.attributesNum=ze,ie.index=ke}function ge(){const Ie=ie.newAttributes;for(let $e=0,Ue=Ie.length;$e<Ue;$e++)Ie[$e]=0}function me(Ie){Ae(Ie,0)}function Ae(Ie,$e){const Ue=ie.newAttributes,ke=ie.enabledAttributes,Ge=ie.attributeDivisors;Ue[Ie]=1,ke[Ie]===0&&(K.enableVertexAttribArray(Ie),ke[Ie]=1),Ge[Ie]!==$e&&(K.vertexAttribDivisor(Ie,$e),Ge[Ie]=$e)}function ye(){const Ie=ie.newAttributes,$e=ie.enabledAttributes;for(let Ue=0,ke=$e.length;Ue<ke;Ue++)$e[Ue]!==Ie[Ue]&&(K.disableVertexAttribArray(Ue),$e[Ue]=0)}function ve(Ie,$e,Ue,ke,Ge,He,ze){ze===!0?K.vertexAttribIPointer(Ie,$e,Ue,Ge,He):K.vertexAttribPointer(Ie,$e,Ue,ke,Ge,He)}function _e(Ie,$e,Ue,ke){ge();const Ge=ke.attributes,He=Ue.getAttributes(),ze=$e.defaultAttributeValues;for(const Ke in He){const tt=He[Ke];if(tt.location>=0){let Je=Ge[Ke];if(Je===void 0&&(Ke==="instanceMatrix"&&Ie.instanceMatrix&&(Je=Ie.instanceMatrix),Ke==="instanceColor"&&Ie.instanceColor&&(Je=Ie.instanceColor)),Je!==void 0){const ot=Je.normalized,Fe=Je.itemSize,ct=_.get(Je);if(ct===void 0)continue;const ht=ct.buffer,lt=ct.type,Qe=ct.bytesPerElement,Ze=lt===K.INT||lt===K.UNSIGNED_INT||Je.gpuType===IntType;if(Je.isInterleavedBufferAttribute){const it=Je.data,nt=it.stride,Tt=Je.offset;if(it.isInstancedInterleavedBuffer){for(let St=0;St<tt.locationSize;St++)Ae(tt.location+St,it.meshPerAttribute);Ie.isInstancedMesh!==!0&&ke._maxInstanceCount===void 0&&(ke._maxInstanceCount=it.meshPerAttribute*it.count)}else for(let St=0;St<tt.locationSize;St++)me(tt.location+St);K.bindBuffer(K.ARRAY_BUFFER,ht);for(let St=0;St<tt.locationSize;St++)ve(tt.location+St,Fe/tt.locationSize,lt,ot,nt*Qe,(Tt+Fe/tt.locationSize*St)*Qe,Ze)}else{if(Je.isInstancedBufferAttribute){for(let it=0;it<tt.locationSize;it++)Ae(tt.location+it,Je.meshPerAttribute);Ie.isInstancedMesh!==!0&&ke._maxInstanceCount===void 0&&(ke._maxInstanceCount=Je.meshPerAttribute*Je.count)}else for(let it=0;it<tt.locationSize;it++)me(tt.location+it);K.bindBuffer(K.ARRAY_BUFFER,ht);for(let it=0;it<tt.locationSize;it++)ve(tt.location+it,Fe/tt.locationSize,lt,ot,Fe*Qe,Fe/tt.locationSize*it*Qe,Ze)}}else if(ze!==void 0){const ot=ze[Ke];if(ot!==void 0)switch(ot.length){case 2:K.vertexAttrib2fv(tt.location,ot);break;case 3:K.vertexAttrib3fv(tt.location,ot);break;case 4:K.vertexAttrib4fv(tt.location,ot);break;default:K.vertexAttrib1fv(tt.location,ot)}}}}ye()}function Te(){we();for(const Ie in te){const $e=te[Ie];for(const Ue in $e){const ke=$e[Ue];for(const Ge in ke)ce(ke[Ge].object),delete ke[Ge];delete $e[Ue]}delete te[Ie]}}function be(Ie){if(te[Ie.id]===void 0)return;const $e=te[Ie.id];for(const Ue in $e){const ke=$e[Ue];for(const Ge in ke)ce(ke[Ge].object),delete ke[Ge];delete $e[Ue]}delete te[Ie.id]}function Re(Ie){for(const $e in te){const Ue=te[$e];if(Ue[Ie.id]===void 0)continue;const ke=Ue[Ie.id];for(const Ge in ke)ce(ke[Ge].object),delete ke[Ge];delete Ue[Ie.id]}}function we(){Pe(),oe=!0,ie!==ne&&(ie=ne,le(ie.object))}function Pe(){ne.geometry=null,ne.program=null,ne.wireframe=!1}return{setup:se,reset:we,resetDefaultState:Pe,dispose:Te,releaseStatesOfGeometry:be,releaseStatesOfProgram:Re,initAttributes:ge,enableAttribute:me,disableUnusedAttributes:ye}}function WebGLBufferRenderer(K,_,Z){let te;function ne(le){te=le}function ie(le,ce){K.drawArrays(te,le,ce),Z.update(ce,te,1)}function oe(le,ce,fe){fe!==0&&(K.drawArraysInstanced(te,le,ce,fe),Z.update(ce,te,fe))}function se(le,ce,fe){if(fe===0)return;_.get("WEBGL_multi_draw").multiDrawArraysWEBGL(te,le,0,ce,0,fe);let pe=0;for(let he=0;he<fe;he++)pe+=ce[he];Z.update(pe,te,1)}function ae(le,ce,fe,de){if(fe===0)return;const pe=_.get("WEBGL_multi_draw");if(pe===null)for(let he=0;he<le.length;he++)oe(le[he],ce[he],de[he]);else{pe.multiDrawArraysInstancedWEBGL(te,le,0,ce,0,de,0,fe);let he=0;for(let ge=0;ge<fe;ge++)he+=ce[ge]*de[ge];Z.update(he,te,1)}}this.setMode=ne,this.render=ie,this.renderInstances=oe,this.renderMultiDraw=se,this.renderMultiDrawInstances=ae}function WebGLCapabilities(K,_,Z,te){let ne;function ie(){if(ne!==void 0)return ne;if(_.has("EXT_texture_filter_anisotropic")===!0){const Re=_.get("EXT_texture_filter_anisotropic");ne=K.getParameter(Re.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else ne=0;return ne}function oe(Re){return!(Re!==RGBAFormat&&te.convert(Re)!==K.getParameter(K.IMPLEMENTATION_COLOR_READ_FORMAT))}function se(Re){const we=Re===HalfFloatType&&(_.has("EXT_color_buffer_half_float")||_.has("EXT_color_buffer_float"));return!(Re!==UnsignedByteType&&te.convert(Re)!==K.getParameter(K.IMPLEMENTATION_COLOR_READ_TYPE)&&Re!==FloatType&&!we)}function ae(Re){if(Re==="highp"){if(K.getShaderPrecisionFormat(K.VERTEX_SHADER,K.HIGH_FLOAT).precision>0&&K.getShaderPrecisionFormat(K.FRAGMENT_SHADER,K.HIGH_FLOAT).precision>0)return"highp";Re="mediump"}return Re==="mediump"&&K.getShaderPrecisionFormat(K.VERTEX_SHADER,K.MEDIUM_FLOAT).precision>0&&K.getShaderPrecisionFormat(K.FRAGMENT_SHADER,K.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let le=Z.precision!==void 0?Z.precision:"highp";const ce=ae(le);ce!==le&&(console.warn("THREE.WebGLRenderer:",le,"not supported, using",ce,"instead."),le=ce);const fe=Z.logarithmicDepthBuffer===!0,de=Z.reverseDepthBuffer===!0&&_.has("EXT_clip_control"),pe=K.getParameter(K.MAX_TEXTURE_IMAGE_UNITS),he=K.getParameter(K.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ge=K.getParameter(K.MAX_TEXTURE_SIZE),me=K.getParameter(K.MAX_CUBE_MAP_TEXTURE_SIZE),Ae=K.getParameter(K.MAX_VERTEX_ATTRIBS),ye=K.getParameter(K.MAX_VERTEX_UNIFORM_VECTORS),ve=K.getParameter(K.MAX_VARYING_VECTORS),_e=K.getParameter(K.MAX_FRAGMENT_UNIFORM_VECTORS),Te=he>0,be=K.getParameter(K.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:ie,getMaxPrecision:ae,textureFormatReadable:oe,textureTypeReadable:se,precision:le,logarithmicDepthBuffer:fe,reverseDepthBuffer:de,maxTextures:pe,maxVertexTextures:he,maxTextureSize:ge,maxCubemapSize:me,maxAttributes:Ae,maxVertexUniforms:ye,maxVaryings:ve,maxFragmentUniforms:_e,vertexTextures:Te,maxSamples:be}}function WebGLClipping(K){const _=this;let Z=null,te=0,ne=!1,ie=!1;const oe=new Plane$2,se=new Matrix3,ae={value:null,needsUpdate:!1};this.uniform=ae,this.numPlanes=0,this.numIntersection=0,this.init=function(fe,de){const pe=fe.length!==0||de||te!==0||ne;return ne=de,te=fe.length,pe},this.beginShadows=function(){ie=!0,ce(null)},this.endShadows=function(){ie=!1},this.setGlobalState=function(fe,de){Z=ce(fe,de,0)},this.setState=function(fe,de,pe){const he=fe.clippingPlanes,ge=fe.clipIntersection,me=fe.clipShadows,Ae=K.get(fe);if(!ne||he===null||he.length===0||ie&&!me)ie?ce(null):le();else{const ye=ie?0:te,ve=ye*4;let _e=Ae.clippingState||null;ae.value=_e,_e=ce(he,de,ve,pe);for(let Te=0;Te!==ve;++Te)_e[Te]=Z[Te];Ae.clippingState=_e,this.numIntersection=ge?this.numPlanes:0,this.numPlanes+=ye}};function le(){ae.value!==Z&&(ae.value=Z,ae.needsUpdate=te>0),_.numPlanes=te,_.numIntersection=0}function ce(fe,de,pe,he){const ge=fe!==null?fe.length:0;let me=null;if(ge!==0){if(me=ae.value,he!==!0||me===null){const Ae=pe+ge*4,ye=de.matrixWorldInverse;se.getNormalMatrix(ye),(me===null||me.length<Ae)&&(me=new Float32Array(Ae));for(let ve=0,_e=pe;ve!==ge;++ve,_e+=4)oe.copy(fe[ve]).applyMatrix4(ye,se),oe.normal.toArray(me,_e),me[_e+3]=oe.constant}ae.value=me,ae.needsUpdate=!0}return _.numPlanes=ge,_.numIntersection=0,me}}function WebGLCubeMaps(K){let _=new WeakMap;function Z(oe,se){return se===EquirectangularReflectionMapping?oe.mapping=CubeReflectionMapping:se===EquirectangularRefractionMapping&&(oe.mapping=CubeRefractionMapping),oe}function te(oe){if(oe&&oe.isTexture){const se=oe.mapping;if(se===EquirectangularReflectionMapping||se===EquirectangularRefractionMapping)if(_.has(oe)){const ae=_.get(oe).texture;return Z(ae,oe.mapping)}else{const ae=oe.image;if(ae&&ae.height>0){const le=new WebGLCubeRenderTarget(ae.height);return le.fromEquirectangularTexture(K,oe),_.set(oe,le),oe.addEventListener("dispose",ne),Z(le.texture,oe.mapping)}else return null}}return oe}function ne(oe){const se=oe.target;se.removeEventListener("dispose",ne);const ae=_.get(se);ae!==void 0&&(_.delete(se),ae.dispose())}function ie(){_=new WeakMap}return{get:te,dispose:ie}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera$1,_clearColor=new Color$1;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0,_oldXrEnabled=!1;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(-PHI,INV_PHI,0),new Vector3(PHI,INV_PHI,0),new Vector3(-INV_PHI,0,PHI),new Vector3(INV_PHI,0,PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(0,PHI,INV_PHI),new Vector3(-1,1,-1),new Vector3(1,1,-1),new Vector3(-1,1,1),new Vector3(1,1,1)],_origin=new Vector3;class PMREMGenerator{constructor(_){this._renderer=_,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_,Z=0,te=.1,ne=100,ie={}){const{size:oe=256,position:se=_origin}=ie;_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(oe);const ae=this._allocateTargets();return ae.depthBuffer=!0,this._sceneToCubeUV(_,te,ne,ae,se),Z>0&&this._blur(ae,0,0,Z),this._applyPMREM(ae),this._cleanup(ae),ae}fromEquirectangular(_,Z=null){return this._fromTexture(_,Z)}fromCubemap(_,Z=null){return this._fromTexture(_,Z)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_){this._lodMax=Math.floor(Math.log2(_)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _=0;_<this._lodPlanes.length;_++)this._lodPlanes[_].dispose()}_cleanup(_){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),this._renderer.xr.enabled=_oldXrEnabled,_.scissorTest=!1,_setViewport(_,0,0,_.width,_.height)}_fromTexture(_,Z){_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping?this._setSize(_.image.length===0?16:_.image[0].width||_.image[0].image.width):this._setSize(_.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const te=Z||this._allocateTargets();return this._textureToCubeUV(_,te),this._applyPMREM(te),this._cleanup(te),te}_allocateTargets(){const _=3*Math.max(this._cubeSize,112),Z=4*this._cubeSize,te={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace$2,depthBuffer:!1},ne=_createRenderTarget(_,Z,te);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_||this._pingPongRenderTarget.height!==Z){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_,Z,te);const{_lodMax:ie}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(ie)),this._blurMaterial=_getBlurShader(ie,_,Z)}return ne}_compileMaterial(_){const Z=new Mesh(this._lodPlanes[0],_);this._renderer.compile(Z,_flatCamera)}_sceneToCubeUV(_,Z,te,ne,ie){const ae=new PerspectiveCamera$2(90,1,Z,te),le=[1,-1,1,1,1,1],ce=[1,1,1,-1,-1,-1],fe=this._renderer,de=fe.autoClear,pe=fe.toneMapping;fe.getClearColor(_clearColor),fe.toneMapping=NoToneMapping,fe.autoClear=!1;const he=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),ge=new Mesh(new BoxGeometry,he);let me=!1;const Ae=_.background;Ae?Ae.isColor&&(he.color.copy(Ae),_.background=null,me=!0):(he.color.copy(_clearColor),me=!0);for(let ye=0;ye<6;ye++){const ve=ye%3;ve===0?(ae.up.set(0,le[ye],0),ae.position.set(ie.x,ie.y,ie.z),ae.lookAt(ie.x+ce[ye],ie.y,ie.z)):ve===1?(ae.up.set(0,0,le[ye]),ae.position.set(ie.x,ie.y,ie.z),ae.lookAt(ie.x,ie.y+ce[ye],ie.z)):(ae.up.set(0,le[ye],0),ae.position.set(ie.x,ie.y,ie.z),ae.lookAt(ie.x,ie.y,ie.z+ce[ye]));const _e=this._cubeSize;_setViewport(ne,ve*_e,ye>2?_e:0,_e,_e),fe.setRenderTarget(ne),me&&fe.render(ge,ae),fe.render(_,ae)}ge.geometry.dispose(),ge.material.dispose(),fe.toneMapping=pe,fe.autoClear=de,_.background=Ae}_textureToCubeUV(_,Z){const te=this._renderer,ne=_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping;ne?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const ie=ne?this._cubemapMaterial:this._equirectMaterial,oe=new Mesh(this._lodPlanes[0],ie),se=ie.uniforms;se.envMap.value=_;const ae=this._cubeSize;_setViewport(Z,0,0,3*ae,2*ae),te.setRenderTarget(Z),te.render(oe,_flatCamera)}_applyPMREM(_){const Z=this._renderer,te=Z.autoClear;Z.autoClear=!1;const ne=this._lodPlanes.length;for(let ie=1;ie<ne;ie++){const oe=Math.sqrt(this._sigmas[ie]*this._sigmas[ie]-this._sigmas[ie-1]*this._sigmas[ie-1]),se=_axisDirections[(ne-ie-1)%_axisDirections.length];this._blur(_,ie-1,ie,oe,se)}Z.autoClear=te}_blur(_,Z,te,ne,ie){const oe=this._pingPongRenderTarget;this._halfBlur(_,oe,Z,te,ne,"latitudinal",ie),this._halfBlur(oe,_,te,te,ne,"longitudinal",ie)}_halfBlur(_,Z,te,ne,ie,oe,se){const ae=this._renderer,le=this._blurMaterial;oe!=="latitudinal"&&oe!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ce=3,fe=new Mesh(this._lodPlanes[ne],le),de=le.uniforms,pe=this._sizeLods[te]-1,he=isFinite(ie)?Math.PI/(2*pe):2*Math.PI/(2*MAX_SAMPLES-1),ge=ie/he,me=isFinite(ie)?1+Math.floor(ce*ge):MAX_SAMPLES;me>MAX_SAMPLES&&console.warn(`sigmaRadians, ${ie}, is too large and will clip, as it requested ${me} samples when the maximum is set to ${MAX_SAMPLES}`);const Ae=[];let ye=0;for(let Re=0;Re<MAX_SAMPLES;++Re){const we=Re/ge,Pe=Math.exp(-we*we/2);Ae.push(Pe),Re===0?ye+=Pe:Re<me&&(ye+=2*Pe)}for(let Re=0;Re<Ae.length;Re++)Ae[Re]=Ae[Re]/ye;de.envMap.value=_.texture,de.samples.value=me,de.weights.value=Ae,de.latitudinal.value=oe==="latitudinal",se&&(de.poleAxis.value=se);const{_lodMax:ve}=this;de.dTheta.value=he,de.mipInt.value=ve-te;const _e=this._sizeLods[ne],Te=3*_e*(ne>ve-LOD_MIN?ne-ve+LOD_MIN:0),be=4*(this._cubeSize-_e);_setViewport(Z,Te,be,3*_e,2*_e),ae.setRenderTarget(Z),ae.render(fe,_flatCamera)}}function _createPlanes(K){const _=[],Z=[],te=[];let ne=K;const ie=K-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let oe=0;oe<ie;oe++){const se=Math.pow(2,ne);Z.push(se);let ae=1/se;oe>K-LOD_MIN?ae=EXTRA_LOD_SIGMA[oe-K+LOD_MIN-1]:oe===0&&(ae=0),te.push(ae);const le=1/(se-2),ce=-le,fe=1+le,de=[ce,ce,fe,ce,fe,fe,ce,ce,fe,fe,ce,fe],pe=6,he=6,ge=3,me=2,Ae=1,ye=new Float32Array(ge*he*pe),ve=new Float32Array(me*he*pe),_e=new Float32Array(Ae*he*pe);for(let be=0;be<pe;be++){const Re=be%3*2/3-1,we=be>2?0:-1,Pe=[Re,we,0,Re+2/3,we,0,Re+2/3,we+1,0,Re,we,0,Re+2/3,we+1,0,Re,we+1,0];ye.set(Pe,ge*he*be),ve.set(de,me*he*be);const Ie=[be,be,be,be,be,be];_e.set(Ie,Ae*he*be)}const Te=new BufferGeometry;Te.setAttribute("position",new BufferAttribute(ye,ge)),Te.setAttribute("uv",new BufferAttribute(ve,me)),Te.setAttribute("faceIndex",new BufferAttribute(_e,Ae)),_.push(Te),ne>LOD_MIN&&ne--}return{lodPlanes:_,sizeLods:Z,sigmas:te}}function _createRenderTarget(K,_,Z){const te=new WebGLRenderTarget(K,_,Z);return te.texture.mapping=CubeUVReflectionMapping,te.texture.name="PMREM.cubeUv",te.scissorTest=!0,te}function _setViewport(K,_,Z,te,ne){K.viewport.set(_,Z,te,ne),K.scissor.set(_,Z,te,ne)}function _getBlurShader(K,_,Z){const te=new Float32Array(MAX_SAMPLES),ne=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_,CUBEUV_TEXEL_HEIGHT:1/Z,CUBEUV_MAX_MIP:`${K}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:te},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:ne}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(K){let _=new WeakMap,Z=null;function te(se){if(se&&se.isTexture){const ae=se.mapping,le=ae===EquirectangularReflectionMapping||ae===EquirectangularRefractionMapping,ce=ae===CubeReflectionMapping||ae===CubeRefractionMapping;if(le||ce){let fe=_.get(se);const de=fe!==void 0?fe.texture.pmremVersion:0;if(se.isRenderTargetTexture&&se.pmremVersion!==de)return Z===null&&(Z=new PMREMGenerator(K)),fe=le?Z.fromEquirectangular(se,fe):Z.fromCubemap(se,fe),fe.texture.pmremVersion=se.pmremVersion,_.set(se,fe),fe.texture;if(fe!==void 0)return fe.texture;{const pe=se.image;return le&&pe&&pe.height>0||ce&&pe&&ne(pe)?(Z===null&&(Z=new PMREMGenerator(K)),fe=le?Z.fromEquirectangular(se):Z.fromCubemap(se),fe.texture.pmremVersion=se.pmremVersion,_.set(se,fe),se.addEventListener("dispose",ie),fe.texture):null}}}return se}function ne(se){let ae=0;const le=6;for(let ce=0;ce<le;ce++)se[ce]!==void 0&&ae++;return ae===le}function ie(se){const ae=se.target;ae.removeEventListener("dispose",ie);const le=_.get(ae);le!==void 0&&(_.delete(ae),le.dispose())}function oe(){_=new WeakMap,Z!==null&&(Z.dispose(),Z=null)}return{get:te,dispose:oe}}function WebGLExtensions(K){const _={};function Z(te){if(_[te]!==void 0)return _[te];let ne;switch(te){case"WEBGL_depth_texture":ne=K.getExtension("WEBGL_depth_texture")||K.getExtension("MOZ_WEBGL_depth_texture")||K.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":ne=K.getExtension("EXT_texture_filter_anisotropic")||K.getExtension("MOZ_EXT_texture_filter_anisotropic")||K.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":ne=K.getExtension("WEBGL_compressed_texture_s3tc")||K.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||K.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":ne=K.getExtension("WEBGL_compressed_texture_pvrtc")||K.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:ne=K.getExtension(te)}return _[te]=ne,ne}return{has:function(te){return Z(te)!==null},init:function(){Z("EXT_color_buffer_float"),Z("WEBGL_clip_cull_distance"),Z("OES_texture_float_linear"),Z("EXT_color_buffer_half_float"),Z("WEBGL_multisampled_render_to_texture"),Z("WEBGL_render_shared_exponent")},get:function(te){const ne=Z(te);return ne===null&&warnOnce("THREE.WebGLRenderer: "+te+" extension not supported."),ne}}}function WebGLGeometries(K,_,Z,te){const ne={},ie=new WeakMap;function oe(fe){const de=fe.target;de.index!==null&&_.remove(de.index);for(const he in de.attributes)_.remove(de.attributes[he]);de.removeEventListener("dispose",oe),delete ne[de.id];const pe=ie.get(de);pe&&(_.remove(pe),ie.delete(de)),te.releaseStatesOfGeometry(de),de.isInstancedBufferGeometry===!0&&delete de._maxInstanceCount,Z.memory.geometries--}function se(fe,de){return ne[de.id]===!0||(de.addEventListener("dispose",oe),ne[de.id]=!0,Z.memory.geometries++),de}function ae(fe){const de=fe.attributes;for(const pe in de)_.update(de[pe],K.ARRAY_BUFFER)}function le(fe){const de=[],pe=fe.index,he=fe.attributes.position;let ge=0;if(pe!==null){const ye=pe.array;ge=pe.version;for(let ve=0,_e=ye.length;ve<_e;ve+=3){const Te=ye[ve+0],be=ye[ve+1],Re=ye[ve+2];de.push(Te,be,be,Re,Re,Te)}}else if(he!==void 0){const ye=he.array;ge=he.version;for(let ve=0,_e=ye.length/3-1;ve<_e;ve+=3){const Te=ve+0,be=ve+1,Re=ve+2;de.push(Te,be,be,Re,Re,Te)}}else return;const me=new(arrayNeedsUint32(de)?Uint32BufferAttribute:Uint16BufferAttribute)(de,1);me.version=ge;const Ae=ie.get(fe);Ae&&_.remove(Ae),ie.set(fe,me)}function ce(fe){const de=ie.get(fe);if(de){const pe=fe.index;pe!==null&&de.version<pe.version&&le(fe)}else le(fe);return ie.get(fe)}return{get:se,update:ae,getWireframeAttribute:ce}}function WebGLIndexedBufferRenderer(K,_,Z){let te;function ne(de){te=de}let ie,oe;function se(de){ie=de.type,oe=de.bytesPerElement}function ae(de,pe){K.drawElements(te,pe,ie,de*oe),Z.update(pe,te,1)}function le(de,pe,he){he!==0&&(K.drawElementsInstanced(te,pe,ie,de*oe,he),Z.update(pe,te,he))}function ce(de,pe,he){if(he===0)return;_.get("WEBGL_multi_draw").multiDrawElementsWEBGL(te,pe,0,ie,de,0,he);let me=0;for(let Ae=0;Ae<he;Ae++)me+=pe[Ae];Z.update(me,te,1)}function fe(de,pe,he,ge){if(he===0)return;const me=_.get("WEBGL_multi_draw");if(me===null)for(let Ae=0;Ae<de.length;Ae++)le(de[Ae]/oe,pe[Ae],ge[Ae]);else{me.multiDrawElementsInstancedWEBGL(te,pe,0,ie,de,0,ge,0,he);let Ae=0;for(let ye=0;ye<he;ye++)Ae+=pe[ye]*ge[ye];Z.update(Ae,te,1)}}this.setMode=ne,this.setIndex=se,this.render=ae,this.renderInstances=le,this.renderMultiDraw=ce,this.renderMultiDrawInstances=fe}function WebGLInfo(K){const _={geometries:0,textures:0},Z={frame:0,calls:0,triangles:0,points:0,lines:0};function te(ie,oe,se){switch(Z.calls++,oe){case K.TRIANGLES:Z.triangles+=se*(ie/3);break;case K.LINES:Z.lines+=se*(ie/2);break;case K.LINE_STRIP:Z.lines+=se*(ie-1);break;case K.LINE_LOOP:Z.lines+=se*ie;break;case K.POINTS:Z.points+=se*ie;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",oe);break}}function ne(){Z.calls=0,Z.triangles=0,Z.points=0,Z.lines=0}return{memory:_,render:Z,programs:null,autoReset:!0,reset:ne,update:te}}function WebGLMorphtargets(K,_,Z){const te=new WeakMap,ne=new Vector4;function ie(oe,se,ae){const le=oe.morphTargetInfluences,ce=se.morphAttributes.position||se.morphAttributes.normal||se.morphAttributes.color,fe=ce!==void 0?ce.length:0;let de=te.get(se);if(de===void 0||de.count!==fe){let Pe=function(){Re.dispose(),te.delete(se),se.removeEventListener("dispose",Pe)};de!==void 0&&de.texture.dispose();const pe=se.morphAttributes.position!==void 0,he=se.morphAttributes.normal!==void 0,ge=se.morphAttributes.color!==void 0,me=se.morphAttributes.position||[],Ae=se.morphAttributes.normal||[],ye=se.morphAttributes.color||[];let ve=0;pe===!0&&(ve=1),he===!0&&(ve=2),ge===!0&&(ve=3);let _e=se.attributes.position.count*ve,Te=1;_e>_.maxTextureSize&&(Te=Math.ceil(_e/_.maxTextureSize),_e=_.maxTextureSize);const be=new Float32Array(_e*Te*4*fe),Re=new DataArrayTexture(be,_e,Te,fe);Re.type=FloatType,Re.needsUpdate=!0;const we=ve*4;for(let Ie=0;Ie<fe;Ie++){const $e=me[Ie],Ue=Ae[Ie],ke=ye[Ie],Ge=_e*Te*4*Ie;for(let He=0;He<$e.count;He++){const ze=He*we;pe===!0&&(ne.fromBufferAttribute($e,He),be[Ge+ze+0]=ne.x,be[Ge+ze+1]=ne.y,be[Ge+ze+2]=ne.z,be[Ge+ze+3]=0),he===!0&&(ne.fromBufferAttribute(Ue,He),be[Ge+ze+4]=ne.x,be[Ge+ze+5]=ne.y,be[Ge+ze+6]=ne.z,be[Ge+ze+7]=0),ge===!0&&(ne.fromBufferAttribute(ke,He),be[Ge+ze+8]=ne.x,be[Ge+ze+9]=ne.y,be[Ge+ze+10]=ne.z,be[Ge+ze+11]=ke.itemSize===4?ne.w:1)}}de={count:fe,texture:Re,size:new Vector2(_e,Te)},te.set(se,de),se.addEventListener("dispose",Pe)}if(oe.isInstancedMesh===!0&&oe.morphTexture!==null)ae.getUniforms().setValue(K,"morphTexture",oe.morphTexture,Z);else{let pe=0;for(let ge=0;ge<le.length;ge++)pe+=le[ge];const he=se.morphTargetsRelative?1:1-pe;ae.getUniforms().setValue(K,"morphTargetBaseInfluence",he),ae.getUniforms().setValue(K,"morphTargetInfluences",le)}ae.getUniforms().setValue(K,"morphTargetsTexture",de.texture,Z),ae.getUniforms().setValue(K,"morphTargetsTextureSize",de.size)}return{update:ie}}function WebGLObjects(K,_,Z,te){let ne=new WeakMap;function ie(ae){const le=te.render.frame,ce=ae.geometry,fe=_.get(ae,ce);if(ne.get(fe)!==le&&(_.update(fe),ne.set(fe,le)),ae.isInstancedMesh&&(ae.hasEventListener("dispose",se)===!1&&ae.addEventListener("dispose",se),ne.get(ae)!==le&&(Z.update(ae.instanceMatrix,K.ARRAY_BUFFER),ae.instanceColor!==null&&Z.update(ae.instanceColor,K.ARRAY_BUFFER),ne.set(ae,le))),ae.isSkinnedMesh){const de=ae.skeleton;ne.get(de)!==le&&(de.update(),ne.set(de,le))}return fe}function oe(){ne=new WeakMap}function se(ae){const le=ae.target;le.removeEventListener("dispose",se),Z.remove(le.instanceMatrix),le.instanceColor!==null&&Z.remove(le.instanceColor)}return{update:ie,dispose:oe}}const emptyTexture=new Texture$1,emptyShadowTexture=new DepthTexture(1,1),emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture$1,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten$1(K,_,Z){const te=K[0];if(te<=0||te>0)return K;const ne=_*Z;let ie=arrayCacheF32[ne];if(ie===void 0&&(ie=new Float32Array(ne),arrayCacheF32[ne]=ie),_!==0){te.toArray(ie,0);for(let oe=1,se=0;oe!==_;++oe)se+=Z,K[oe].toArray(ie,se)}return ie}function arraysEqual(K,_){if(K.length!==_.length)return!1;for(let Z=0,te=K.length;Z<te;Z++)if(K[Z]!==_[Z])return!1;return!0}function copyArray(K,_){for(let Z=0,te=_.length;Z<te;Z++)K[Z]=_[Z]}function allocTexUnits(K,_){let Z=arrayCacheI32[_];Z===void 0&&(Z=new Int32Array(_),arrayCacheI32[_]=Z);for(let te=0;te!==_;++te)Z[te]=K.allocateTextureUnit();return Z}function setValueV1f(K,_){const Z=this.cache;Z[0]!==_&&(K.uniform1f(this.addr,_),Z[0]=_)}function setValueV2f(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y)&&(K.uniform2f(this.addr,_.x,_.y),Z[0]=_.x,Z[1]=_.y);else{if(arraysEqual(Z,_))return;K.uniform2fv(this.addr,_),copyArray(Z,_)}}function setValueV3f(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y||Z[2]!==_.z)&&(K.uniform3f(this.addr,_.x,_.y,_.z),Z[0]=_.x,Z[1]=_.y,Z[2]=_.z);else if(_.r!==void 0)(Z[0]!==_.r||Z[1]!==_.g||Z[2]!==_.b)&&(K.uniform3f(this.addr,_.r,_.g,_.b),Z[0]=_.r,Z[1]=_.g,Z[2]=_.b);else{if(arraysEqual(Z,_))return;K.uniform3fv(this.addr,_),copyArray(Z,_)}}function setValueV4f(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y||Z[2]!==_.z||Z[3]!==_.w)&&(K.uniform4f(this.addr,_.x,_.y,_.z,_.w),Z[0]=_.x,Z[1]=_.y,Z[2]=_.z,Z[3]=_.w);else{if(arraysEqual(Z,_))return;K.uniform4fv(this.addr,_),copyArray(Z,_)}}function setValueM2(K,_){const Z=this.cache,te=_.elements;if(te===void 0){if(arraysEqual(Z,_))return;K.uniformMatrix2fv(this.addr,!1,_),copyArray(Z,_)}else{if(arraysEqual(Z,te))return;mat2array.set(te),K.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(Z,te)}}function setValueM3(K,_){const Z=this.cache,te=_.elements;if(te===void 0){if(arraysEqual(Z,_))return;K.uniformMatrix3fv(this.addr,!1,_),copyArray(Z,_)}else{if(arraysEqual(Z,te))return;mat3array.set(te),K.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(Z,te)}}function setValueM4(K,_){const Z=this.cache,te=_.elements;if(te===void 0){if(arraysEqual(Z,_))return;K.uniformMatrix4fv(this.addr,!1,_),copyArray(Z,_)}else{if(arraysEqual(Z,te))return;mat4array.set(te),K.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(Z,te)}}function setValueV1i(K,_){const Z=this.cache;Z[0]!==_&&(K.uniform1i(this.addr,_),Z[0]=_)}function setValueV2i(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y)&&(K.uniform2i(this.addr,_.x,_.y),Z[0]=_.x,Z[1]=_.y);else{if(arraysEqual(Z,_))return;K.uniform2iv(this.addr,_),copyArray(Z,_)}}function setValueV3i(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y||Z[2]!==_.z)&&(K.uniform3i(this.addr,_.x,_.y,_.z),Z[0]=_.x,Z[1]=_.y,Z[2]=_.z);else{if(arraysEqual(Z,_))return;K.uniform3iv(this.addr,_),copyArray(Z,_)}}function setValueV4i(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y||Z[2]!==_.z||Z[3]!==_.w)&&(K.uniform4i(this.addr,_.x,_.y,_.z,_.w),Z[0]=_.x,Z[1]=_.y,Z[2]=_.z,Z[3]=_.w);else{if(arraysEqual(Z,_))return;K.uniform4iv(this.addr,_),copyArray(Z,_)}}function setValueV1ui(K,_){const Z=this.cache;Z[0]!==_&&(K.uniform1ui(this.addr,_),Z[0]=_)}function setValueV2ui(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y)&&(K.uniform2ui(this.addr,_.x,_.y),Z[0]=_.x,Z[1]=_.y);else{if(arraysEqual(Z,_))return;K.uniform2uiv(this.addr,_),copyArray(Z,_)}}function setValueV3ui(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y||Z[2]!==_.z)&&(K.uniform3ui(this.addr,_.x,_.y,_.z),Z[0]=_.x,Z[1]=_.y,Z[2]=_.z);else{if(arraysEqual(Z,_))return;K.uniform3uiv(this.addr,_),copyArray(Z,_)}}function setValueV4ui(K,_){const Z=this.cache;if(_.x!==void 0)(Z[0]!==_.x||Z[1]!==_.y||Z[2]!==_.z||Z[3]!==_.w)&&(K.uniform4ui(this.addr,_.x,_.y,_.z,_.w),Z[0]=_.x,Z[1]=_.y,Z[2]=_.z,Z[3]=_.w);else{if(arraysEqual(Z,_))return;K.uniform4uiv(this.addr,_),copyArray(Z,_)}}function setValueT1(K,_,Z){const te=this.cache,ne=Z.allocateTextureUnit();te[0]!==ne&&(K.uniform1i(this.addr,ne),te[0]=ne);let ie;this.type===K.SAMPLER_2D_SHADOW?(emptyShadowTexture.compareFunction=LessEqualCompare,ie=emptyShadowTexture):ie=emptyTexture,Z.setTexture2D(_||ie,ne)}function setValueT3D1(K,_,Z){const te=this.cache,ne=Z.allocateTextureUnit();te[0]!==ne&&(K.uniform1i(this.addr,ne),te[0]=ne),Z.setTexture3D(_||empty3dTexture,ne)}function setValueT6(K,_,Z){const te=this.cache,ne=Z.allocateTextureUnit();te[0]!==ne&&(K.uniform1i(this.addr,ne),te[0]=ne),Z.setTextureCube(_||emptyCubeTexture,ne)}function setValueT2DArray1(K,_,Z){const te=this.cache,ne=Z.allocateTextureUnit();te[0]!==ne&&(K.uniform1i(this.addr,ne),te[0]=ne),Z.setTexture2DArray(_||emptyArrayTexture,ne)}function getSingularSetter(K){switch(K){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(K,_){K.uniform1fv(this.addr,_)}function setValueV2fArray(K,_){const Z=flatten$1(_,this.size,2);K.uniform2fv(this.addr,Z)}function setValueV3fArray(K,_){const Z=flatten$1(_,this.size,3);K.uniform3fv(this.addr,Z)}function setValueV4fArray(K,_){const Z=flatten$1(_,this.size,4);K.uniform4fv(this.addr,Z)}function setValueM2Array(K,_){const Z=flatten$1(_,this.size,4);K.uniformMatrix2fv(this.addr,!1,Z)}function setValueM3Array(K,_){const Z=flatten$1(_,this.size,9);K.uniformMatrix3fv(this.addr,!1,Z)}function setValueM4Array(K,_){const Z=flatten$1(_,this.size,16);K.uniformMatrix4fv(this.addr,!1,Z)}function setValueV1iArray(K,_){K.uniform1iv(this.addr,_)}function setValueV2iArray(K,_){K.uniform2iv(this.addr,_)}function setValueV3iArray(K,_){K.uniform3iv(this.addr,_)}function setValueV4iArray(K,_){K.uniform4iv(this.addr,_)}function setValueV1uiArray(K,_){K.uniform1uiv(this.addr,_)}function setValueV2uiArray(K,_){K.uniform2uiv(this.addr,_)}function setValueV3uiArray(K,_){K.uniform3uiv(this.addr,_)}function setValueV4uiArray(K,_){K.uniform4uiv(this.addr,_)}function setValueT1Array(K,_,Z){const te=this.cache,ne=_.length,ie=allocTexUnits(Z,ne);arraysEqual(te,ie)||(K.uniform1iv(this.addr,ie),copyArray(te,ie));for(let oe=0;oe!==ne;++oe)Z.setTexture2D(_[oe]||emptyTexture,ie[oe])}function setValueT3DArray(K,_,Z){const te=this.cache,ne=_.length,ie=allocTexUnits(Z,ne);arraysEqual(te,ie)||(K.uniform1iv(this.addr,ie),copyArray(te,ie));for(let oe=0;oe!==ne;++oe)Z.setTexture3D(_[oe]||empty3dTexture,ie[oe])}function setValueT6Array(K,_,Z){const te=this.cache,ne=_.length,ie=allocTexUnits(Z,ne);arraysEqual(te,ie)||(K.uniform1iv(this.addr,ie),copyArray(te,ie));for(let oe=0;oe!==ne;++oe)Z.setTextureCube(_[oe]||emptyCubeTexture,ie[oe])}function setValueT2DArrayArray(K,_,Z){const te=this.cache,ne=_.length,ie=allocTexUnits(Z,ne);arraysEqual(te,ie)||(K.uniform1iv(this.addr,ie),copyArray(te,ie));for(let oe=0;oe!==ne;++oe)Z.setTexture2DArray(_[oe]||emptyArrayTexture,ie[oe])}function getPureArraySetter(K){switch(K){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_,Z,te){this.id=_,this.addr=te,this.cache=[],this.type=Z.type,this.setValue=getSingularSetter(Z.type)}}class PureArrayUniform{constructor(_,Z,te){this.id=_,this.addr=te,this.cache=[],this.type=Z.type,this.size=Z.size,this.setValue=getPureArraySetter(Z.type)}}class StructuredUniform{constructor(_){this.id=_,this.seq=[],this.map={}}setValue(_,Z,te){const ne=this.seq;for(let ie=0,oe=ne.length;ie!==oe;++ie){const se=ne[ie];se.setValue(_,Z[se.id],te)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(K,_){K.seq.push(_),K.map[_.id]=_}function parseUniform(K,_,Z){const te=K.name,ne=te.length;for(RePathPart.lastIndex=0;;){const ie=RePathPart.exec(te),oe=RePathPart.lastIndex;let se=ie[1];const ae=ie[2]==="]",le=ie[3];if(ae&&(se=se|0),le===void 0||le==="["&&oe+2===ne){addUniform(Z,le===void 0?new SingleUniform(se,K,_):new PureArrayUniform(se,K,_));break}else{let fe=Z.map[se];fe===void 0&&(fe=new StructuredUniform(se),addUniform(Z,fe)),Z=fe}}}class WebGLUniforms{constructor(_,Z){this.seq=[],this.map={};const te=_.getProgramParameter(Z,_.ACTIVE_UNIFORMS);for(let ne=0;ne<te;++ne){const ie=_.getActiveUniform(Z,ne),oe=_.getUniformLocation(Z,ie.name);parseUniform(ie,oe,this)}}setValue(_,Z,te,ne){const ie=this.map[Z];ie!==void 0&&ie.setValue(_,te,ne)}setOptional(_,Z,te){const ne=Z[te];ne!==void 0&&this.setValue(_,te,ne)}static upload(_,Z,te,ne){for(let ie=0,oe=Z.length;ie!==oe;++ie){const se=Z[ie],ae=te[se.id];ae.needsUpdate!==!1&&se.setValue(_,ae.value,ne)}}static seqWithValue(_,Z){const te=[];for(let ne=0,ie=_.length;ne!==ie;++ne){const oe=_[ne];oe.id in Z&&te.push(oe)}return te}}function WebGLShader(K,_,Z){const te=K.createShader(_);return K.shaderSource(te,Z),K.compileShader(te),te}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(K,_){const Z=K.split(`
`),te=[],ne=Math.max(_-6,0),ie=Math.min(_+6,Z.length);for(let oe=ne;oe<ie;oe++){const se=oe+1;te.push(`${se===_?">":" "} ${se}: ${Z[oe]}`)}return te.join(`
`)}const _m0=new Matrix3;function getEncodingComponents(K){ColorManagement._getMatrix(_m0,ColorManagement.workingColorSpace,K);const _=`mat3( ${_m0.elements.map(Z=>Z.toFixed(4))} )`;switch(ColorManagement.getTransfer(K)){case LinearTransfer:return[_,"LinearTransferOETF"];case SRGBTransfer:return[_,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",K),[_,"LinearTransferOETF"]}}function getShaderErrors(K,_,Z){const te=K.getShaderParameter(_,K.COMPILE_STATUS),ne=K.getShaderInfoLog(_).trim();if(te&&ne==="")return"";const ie=/ERROR: 0:(\d+)/.exec(ne);if(ie){const oe=parseInt(ie[1]);return Z.toUpperCase()+`

`+ne+`

`+handleSource(K.getShaderSource(_),oe)}else return ne}function getTexelEncodingFunction(K,_){const Z=getEncodingComponents(_);return[`vec4 ${K}( vec4 value ) {`,`	return ${Z[1]}( vec4( value.rgb * ${Z[0]}, value.a ) );`,"}"].join(`
`)}function getToneMappingFunction(K,_){let Z;switch(_){case LinearToneMapping:Z="Linear";break;case ReinhardToneMapping:Z="Reinhard";break;case CineonToneMapping:Z="Cineon";break;case ACESFilmicToneMapping:Z="ACESFilmic";break;case AgXToneMapping:Z="AgX";break;case NeutralToneMapping:Z="Neutral";break;case CustomToneMapping:Z="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_),Z="Linear"}return"vec3 "+K+"( vec3 color ) { return "+Z+"ToneMapping( color ); }"}const _v0=new Vector3;function getLuminanceFunction(){ColorManagement.getLuminanceCoefficients(_v0);const K=_v0.x.toFixed(4),_=_v0.y.toFixed(4),Z=_v0.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${K}, ${_}, ${Z} );`,"	return dot( weights, rgb );","}"].join(`
`)}function generateVertexExtensions(K){return[K.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",K.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(K){const _=[];for(const Z in K){const te=K[Z];te!==!1&&_.push("#define "+Z+" "+te)}return _.join(`
`)}function fetchAttributeLocations(K,_){const Z={},te=K.getProgramParameter(_,K.ACTIVE_ATTRIBUTES);for(let ne=0;ne<te;ne++){const ie=K.getActiveAttrib(_,ne),oe=ie.name;let se=1;ie.type===K.FLOAT_MAT2&&(se=2),ie.type===K.FLOAT_MAT3&&(se=3),ie.type===K.FLOAT_MAT4&&(se=4),Z[oe]={type:ie.type,location:K.getAttribLocation(_,oe),locationSize:se}}return Z}function filterEmptyLine(K){return K!==""}function replaceLightNums(K,_){const Z=_.numSpotLightShadows+_.numSpotLightMaps-_.numSpotLightShadowsWithMaps;return K.replace(/NUM_DIR_LIGHTS/g,_.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,Z).replace(/NUM_RECT_AREA_LIGHTS/g,_.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_.numPointLightShadows)}function replaceClippingPlaneNums(K,_){return K.replace(/NUM_CLIPPING_PLANES/g,_.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_.numClippingPlanes-_.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(K){return K.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map;function includeReplacer(K,_){let Z=ShaderChunk[_];if(Z===void 0){const te=shaderChunkMap.get(_);if(te!==void 0)Z=ShaderChunk[te],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_,te);else throw new Error("Can not resolve #include <"+_+">")}return resolveIncludes(Z)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(K){return K.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(K,_,Z,te){let ne="";for(let ie=parseInt(_);ie<parseInt(Z);ie++)ne+=te.replace(/\[\s*i\s*\]/g,"[ "+ie+" ]").replace(/UNROLLED_LOOP_INDEX/g,ie);return ne}function generatePrecision(K){let _=`precision ${K.precision} float;
	precision ${K.precision} int;
	precision ${K.precision} sampler2D;
	precision ${K.precision} samplerCube;
	precision ${K.precision} sampler3D;
	precision ${K.precision} sampler2DArray;
	precision ${K.precision} sampler2DShadow;
	precision ${K.precision} samplerCubeShadow;
	precision ${K.precision} sampler2DArrayShadow;
	precision ${K.precision} isampler2D;
	precision ${K.precision} isampler3D;
	precision ${K.precision} isamplerCube;
	precision ${K.precision} isampler2DArray;
	precision ${K.precision} usampler2D;
	precision ${K.precision} usampler3D;
	precision ${K.precision} usamplerCube;
	precision ${K.precision} usampler2DArray;
	`;return K.precision==="highp"?_+=`
#define HIGH_PRECISION`:K.precision==="mediump"?_+=`
#define MEDIUM_PRECISION`:K.precision==="lowp"&&(_+=`
#define LOW_PRECISION`),_}function generateShadowMapTypeDefine(K){let _="SHADOWMAP_TYPE_BASIC";return K.shadowMapType===PCFShadowMap?_="SHADOWMAP_TYPE_PCF":K.shadowMapType===PCFSoftShadowMap?_="SHADOWMAP_TYPE_PCF_SOFT":K.shadowMapType===VSMShadowMap&&(_="SHADOWMAP_TYPE_VSM"),_}function generateEnvMapTypeDefine(K){let _="ENVMAP_TYPE_CUBE";if(K.envMap)switch(K.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_="ENVMAP_TYPE_CUBE_UV";break}return _}function generateEnvMapModeDefine(K){let _="ENVMAP_MODE_REFLECTION";if(K.envMap)switch(K.envMapMode){case CubeRefractionMapping:_="ENVMAP_MODE_REFRACTION";break}return _}function generateEnvMapBlendingDefine(K){let _="ENVMAP_BLENDING_NONE";if(K.envMap)switch(K.combine){case MultiplyOperation:_="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_="ENVMAP_BLENDING_MIX";break;case AddOperation:_="ENVMAP_BLENDING_ADD";break}return _}function generateCubeUVSize(K){const _=K.envMapCubeUVHeight;if(_===null)return null;const Z=Math.log2(_)-2,te=1/_;return{texelWidth:1/(3*Math.max(Math.pow(2,Z),7*16)),texelHeight:te,maxMip:Z}}function WebGLProgram(K,_,Z,te){const ne=K.getContext(),ie=Z.defines;let oe=Z.vertexShader,se=Z.fragmentShader;const ae=generateShadowMapTypeDefine(Z),le=generateEnvMapTypeDefine(Z),ce=generateEnvMapModeDefine(Z),fe=generateEnvMapBlendingDefine(Z),de=generateCubeUVSize(Z),pe=generateVertexExtensions(Z),he=generateDefines(ie),ge=ne.createProgram();let me,Ae,ye=Z.glslVersion?"#version "+Z.glslVersion+`
`:"";Z.isRawShaderMaterial?(me=["#define SHADER_TYPE "+Z.shaderType,"#define SHADER_NAME "+Z.shaderName,he].filter(filterEmptyLine).join(`
`),me.length>0&&(me+=`
`),Ae=["#define SHADER_TYPE "+Z.shaderType,"#define SHADER_NAME "+Z.shaderName,he].filter(filterEmptyLine).join(`
`),Ae.length>0&&(Ae+=`
`)):(me=[generatePrecision(Z),"#define SHADER_TYPE "+Z.shaderType,"#define SHADER_NAME "+Z.shaderName,he,Z.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",Z.batching?"#define USE_BATCHING":"",Z.batchingColor?"#define USE_BATCHING_COLOR":"",Z.instancing?"#define USE_INSTANCING":"",Z.instancingColor?"#define USE_INSTANCING_COLOR":"",Z.instancingMorph?"#define USE_INSTANCING_MORPH":"",Z.useFog&&Z.fog?"#define USE_FOG":"",Z.useFog&&Z.fogExp2?"#define FOG_EXP2":"",Z.map?"#define USE_MAP":"",Z.envMap?"#define USE_ENVMAP":"",Z.envMap?"#define "+ce:"",Z.lightMap?"#define USE_LIGHTMAP":"",Z.aoMap?"#define USE_AOMAP":"",Z.bumpMap?"#define USE_BUMPMAP":"",Z.normalMap?"#define USE_NORMALMAP":"",Z.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",Z.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",Z.displacementMap?"#define USE_DISPLACEMENTMAP":"",Z.emissiveMap?"#define USE_EMISSIVEMAP":"",Z.anisotropy?"#define USE_ANISOTROPY":"",Z.anisotropyMap?"#define USE_ANISOTROPYMAP":"",Z.clearcoatMap?"#define USE_CLEARCOATMAP":"",Z.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",Z.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",Z.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",Z.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",Z.specularMap?"#define USE_SPECULARMAP":"",Z.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",Z.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",Z.roughnessMap?"#define USE_ROUGHNESSMAP":"",Z.metalnessMap?"#define USE_METALNESSMAP":"",Z.alphaMap?"#define USE_ALPHAMAP":"",Z.alphaHash?"#define USE_ALPHAHASH":"",Z.transmission?"#define USE_TRANSMISSION":"",Z.transmissionMap?"#define USE_TRANSMISSIONMAP":"",Z.thicknessMap?"#define USE_THICKNESSMAP":"",Z.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",Z.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",Z.mapUv?"#define MAP_UV "+Z.mapUv:"",Z.alphaMapUv?"#define ALPHAMAP_UV "+Z.alphaMapUv:"",Z.lightMapUv?"#define LIGHTMAP_UV "+Z.lightMapUv:"",Z.aoMapUv?"#define AOMAP_UV "+Z.aoMapUv:"",Z.emissiveMapUv?"#define EMISSIVEMAP_UV "+Z.emissiveMapUv:"",Z.bumpMapUv?"#define BUMPMAP_UV "+Z.bumpMapUv:"",Z.normalMapUv?"#define NORMALMAP_UV "+Z.normalMapUv:"",Z.displacementMapUv?"#define DISPLACEMENTMAP_UV "+Z.displacementMapUv:"",Z.metalnessMapUv?"#define METALNESSMAP_UV "+Z.metalnessMapUv:"",Z.roughnessMapUv?"#define ROUGHNESSMAP_UV "+Z.roughnessMapUv:"",Z.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+Z.anisotropyMapUv:"",Z.clearcoatMapUv?"#define CLEARCOATMAP_UV "+Z.clearcoatMapUv:"",Z.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+Z.clearcoatNormalMapUv:"",Z.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+Z.clearcoatRoughnessMapUv:"",Z.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+Z.iridescenceMapUv:"",Z.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+Z.iridescenceThicknessMapUv:"",Z.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+Z.sheenColorMapUv:"",Z.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+Z.sheenRoughnessMapUv:"",Z.specularMapUv?"#define SPECULARMAP_UV "+Z.specularMapUv:"",Z.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+Z.specularColorMapUv:"",Z.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+Z.specularIntensityMapUv:"",Z.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+Z.transmissionMapUv:"",Z.thicknessMapUv?"#define THICKNESSMAP_UV "+Z.thicknessMapUv:"",Z.vertexTangents&&Z.flatShading===!1?"#define USE_TANGENT":"",Z.vertexColors?"#define USE_COLOR":"",Z.vertexAlphas?"#define USE_COLOR_ALPHA":"",Z.vertexUv1s?"#define USE_UV1":"",Z.vertexUv2s?"#define USE_UV2":"",Z.vertexUv3s?"#define USE_UV3":"",Z.pointsUvs?"#define USE_POINTS_UV":"",Z.flatShading?"#define FLAT_SHADED":"",Z.skinning?"#define USE_SKINNING":"",Z.morphTargets?"#define USE_MORPHTARGETS":"",Z.morphNormals&&Z.flatShading===!1?"#define USE_MORPHNORMALS":"",Z.morphColors?"#define USE_MORPHCOLORS":"",Z.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+Z.morphTextureStride:"",Z.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+Z.morphTargetsCount:"",Z.doubleSided?"#define DOUBLE_SIDED":"",Z.flipSided?"#define FLIP_SIDED":"",Z.shadowMapEnabled?"#define USE_SHADOWMAP":"",Z.shadowMapEnabled?"#define "+ae:"",Z.sizeAttenuation?"#define USE_SIZEATTENUATION":"",Z.numLightProbes>0?"#define USE_LIGHT_PROBES":"",Z.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Z.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),Ae=[generatePrecision(Z),"#define SHADER_TYPE "+Z.shaderType,"#define SHADER_NAME "+Z.shaderName,he,Z.useFog&&Z.fog?"#define USE_FOG":"",Z.useFog&&Z.fogExp2?"#define FOG_EXP2":"",Z.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",Z.map?"#define USE_MAP":"",Z.matcap?"#define USE_MATCAP":"",Z.envMap?"#define USE_ENVMAP":"",Z.envMap?"#define "+le:"",Z.envMap?"#define "+ce:"",Z.envMap?"#define "+fe:"",de?"#define CUBEUV_TEXEL_WIDTH "+de.texelWidth:"",de?"#define CUBEUV_TEXEL_HEIGHT "+de.texelHeight:"",de?"#define CUBEUV_MAX_MIP "+de.maxMip+".0":"",Z.lightMap?"#define USE_LIGHTMAP":"",Z.aoMap?"#define USE_AOMAP":"",Z.bumpMap?"#define USE_BUMPMAP":"",Z.normalMap?"#define USE_NORMALMAP":"",Z.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",Z.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",Z.emissiveMap?"#define USE_EMISSIVEMAP":"",Z.anisotropy?"#define USE_ANISOTROPY":"",Z.anisotropyMap?"#define USE_ANISOTROPYMAP":"",Z.clearcoat?"#define USE_CLEARCOAT":"",Z.clearcoatMap?"#define USE_CLEARCOATMAP":"",Z.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",Z.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",Z.dispersion?"#define USE_DISPERSION":"",Z.iridescence?"#define USE_IRIDESCENCE":"",Z.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",Z.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",Z.specularMap?"#define USE_SPECULARMAP":"",Z.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",Z.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",Z.roughnessMap?"#define USE_ROUGHNESSMAP":"",Z.metalnessMap?"#define USE_METALNESSMAP":"",Z.alphaMap?"#define USE_ALPHAMAP":"",Z.alphaTest?"#define USE_ALPHATEST":"",Z.alphaHash?"#define USE_ALPHAHASH":"",Z.sheen?"#define USE_SHEEN":"",Z.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",Z.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",Z.transmission?"#define USE_TRANSMISSION":"",Z.transmissionMap?"#define USE_TRANSMISSIONMAP":"",Z.thicknessMap?"#define USE_THICKNESSMAP":"",Z.vertexTangents&&Z.flatShading===!1?"#define USE_TANGENT":"",Z.vertexColors||Z.instancingColor||Z.batchingColor?"#define USE_COLOR":"",Z.vertexAlphas?"#define USE_COLOR_ALPHA":"",Z.vertexUv1s?"#define USE_UV1":"",Z.vertexUv2s?"#define USE_UV2":"",Z.vertexUv3s?"#define USE_UV3":"",Z.pointsUvs?"#define USE_POINTS_UV":"",Z.gradientMap?"#define USE_GRADIENTMAP":"",Z.flatShading?"#define FLAT_SHADED":"",Z.doubleSided?"#define DOUBLE_SIDED":"",Z.flipSided?"#define FLIP_SIDED":"",Z.shadowMapEnabled?"#define USE_SHADOWMAP":"",Z.shadowMapEnabled?"#define "+ae:"",Z.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",Z.numLightProbes>0?"#define USE_LIGHT_PROBES":"",Z.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",Z.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",Z.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Z.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",Z.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",Z.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",Z.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",Z.toneMapping):"",Z.dithering?"#define DITHERING":"",Z.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",Z.outputColorSpace),getLuminanceFunction(),Z.useDepthPacking?"#define DEPTH_PACKING "+Z.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),oe=resolveIncludes(oe),oe=replaceLightNums(oe,Z),oe=replaceClippingPlaneNums(oe,Z),se=resolveIncludes(se),se=replaceLightNums(se,Z),se=replaceClippingPlaneNums(se,Z),oe=unrollLoops(oe),se=unrollLoops(se),Z.isRawShaderMaterial!==!0&&(ye=`#version 300 es
`,me=[pe,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+me,Ae=["#define varying in",Z.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",Z.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Ae);const ve=ye+me+oe,_e=ye+Ae+se,Te=WebGLShader(ne,ne.VERTEX_SHADER,ve),be=WebGLShader(ne,ne.FRAGMENT_SHADER,_e);ne.attachShader(ge,Te),ne.attachShader(ge,be),Z.index0AttributeName!==void 0?ne.bindAttribLocation(ge,0,Z.index0AttributeName):Z.morphTargets===!0&&ne.bindAttribLocation(ge,0,"position"),ne.linkProgram(ge);function Re($e){if(K.debug.checkShaderErrors){const Ue=ne.getProgramInfoLog(ge).trim(),ke=ne.getShaderInfoLog(Te).trim(),Ge=ne.getShaderInfoLog(be).trim();let He=!0,ze=!0;if(ne.getProgramParameter(ge,ne.LINK_STATUS)===!1)if(He=!1,typeof K.debug.onShaderError=="function")K.debug.onShaderError(ne,ge,Te,be);else{const Ke=getShaderErrors(ne,Te,"vertex"),tt=getShaderErrors(ne,be,"fragment");console.error("THREE.WebGLProgram: Shader Error "+ne.getError()+" - VALIDATE_STATUS "+ne.getProgramParameter(ge,ne.VALIDATE_STATUS)+`

Material Name: `+$e.name+`
Material Type: `+$e.type+`

Program Info Log: `+Ue+`
`+Ke+`
`+tt)}else Ue!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Ue):(ke===""||Ge==="")&&(ze=!1);ze&&($e.diagnostics={runnable:He,programLog:Ue,vertexShader:{log:ke,prefix:me},fragmentShader:{log:Ge,prefix:Ae}})}ne.deleteShader(Te),ne.deleteShader(be),we=new WebGLUniforms(ne,ge),Pe=fetchAttributeLocations(ne,ge)}let we;this.getUniforms=function(){return we===void 0&&Re(this),we};let Pe;this.getAttributes=function(){return Pe===void 0&&Re(this),Pe};let Ie=Z.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Ie===!1&&(Ie=ne.getProgramParameter(ge,COMPLETION_STATUS_KHR)),Ie},this.destroy=function(){te.releaseStatesOfProgram(this),ne.deleteProgram(ge),this.program=void 0},this.type=Z.shaderType,this.name=Z.shaderName,this.id=programIdCount++,this.cacheKey=_,this.usedTimes=1,this.program=ge,this.vertexShader=Te,this.fragmentShader=be,this}let _id=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_){const Z=_.vertexShader,te=_.fragmentShader,ne=this._getShaderStage(Z),ie=this._getShaderStage(te),oe=this._getShaderCacheForMaterial(_);return oe.has(ne)===!1&&(oe.add(ne),ne.usedTimes++),oe.has(ie)===!1&&(oe.add(ie),ie.usedTimes++),this}remove(_){const Z=this.materialCache.get(_);for(const te of Z)te.usedTimes--,te.usedTimes===0&&this.shaderCache.delete(te.code);return this.materialCache.delete(_),this}getVertexShaderID(_){return this._getShaderStage(_.vertexShader).id}getFragmentShaderID(_){return this._getShaderStage(_.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_){const Z=this.materialCache;let te=Z.get(_);return te===void 0&&(te=new Set,Z.set(_,te)),te}_getShaderStage(_){const Z=this.shaderCache;let te=Z.get(_);return te===void 0&&(te=new WebGLShaderStage(_),Z.set(_,te)),te}}class WebGLShaderStage{constructor(_){this.id=_id++,this.code=_,this.usedTimes=0}}function WebGLPrograms(K,_,Z,te,ne,ie,oe){const se=new Layers,ae=new WebGLShaderCache,le=new Set,ce=[],fe=ne.logarithmicDepthBuffer,de=ne.vertexTextures;let pe=ne.precision;const he={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ge(Pe){return le.add(Pe),Pe===0?"uv":`uv${Pe}`}function me(Pe,Ie,$e,Ue,ke){const Ge=Ue.fog,He=ke.geometry,ze=Pe.isMeshStandardMaterial?Ue.environment:null,Ke=(Pe.isMeshStandardMaterial?Z:_).get(Pe.envMap||ze),tt=Ke&&Ke.mapping===CubeUVReflectionMapping?Ke.image.height:null,Je=he[Pe.type];Pe.precision!==null&&(pe=ne.getMaxPrecision(Pe.precision),pe!==Pe.precision&&console.warn("THREE.WebGLProgram.getParameters:",Pe.precision,"not supported, using",pe,"instead."));const ot=He.morphAttributes.position||He.morphAttributes.normal||He.morphAttributes.color,Fe=ot!==void 0?ot.length:0;let ct=0;He.morphAttributes.position!==void 0&&(ct=1),He.morphAttributes.normal!==void 0&&(ct=2),He.morphAttributes.color!==void 0&&(ct=3);let ht,lt,Qe,Ze;if(Je){const Rn=ShaderLib[Je];ht=Rn.vertexShader,lt=Rn.fragmentShader}else ht=Pe.vertexShader,lt=Pe.fragmentShader,ae.update(Pe),Qe=ae.getVertexShaderID(Pe),Ze=ae.getFragmentShaderID(Pe);const it=K.getRenderTarget(),nt=K.state.buffers.depth.getReversed(),Tt=ke.isInstancedMesh===!0,St=ke.isBatchedMesh===!0,Et=!!Pe.map,Nt=!!Pe.matcap,zt=!!Ke,yt=!!Pe.aoMap,Ut=!!Pe.lightMap,bt=!!Pe.bumpMap,Ot=!!Pe.normalMap,Mt=!!Pe.displacementMap,_t=!!Pe.emissiveMap,pt=!!Pe.metalnessMap,ft=!!Pe.roughnessMap,st=Pe.anisotropy>0,vt=Pe.clearcoat>0,Pt=Pe.dispersion>0,Lt=Pe.iridescence>0,Vt=Pe.sheen>0,Le=Pe.transmission>0,De=st&&!!Pe.anisotropyMap,Be=vt&&!!Pe.clearcoatMap,rt=vt&&!!Pe.clearcoatNormalMap,at=vt&&!!Pe.clearcoatRoughnessMap,xt=Lt&&!!Pe.iridescenceMap,Ct=Lt&&!!Pe.iridescenceThicknessMap,Qt=Vt&&!!Pe.sheenColorMap,qt=Vt&&!!Pe.sheenRoughnessMap,It=!!Pe.specularMap,Gt=!!Pe.specularColorMap,Jt=!!Pe.specularIntensityMap,kt=Le&&!!Pe.transmissionMap,Ht=Le&&!!Pe.thicknessMap,Yt=!!Pe.gradientMap,hn=!!Pe.alphaMap,_n=Pe.alphaTest>0,xn=!!Pe.alphaHash,Ln=!!Pe.extensions;let Vn=NoToneMapping;Pe.toneMapped&&(it===null||it.isXRRenderTarget===!0)&&(Vn=K.toneMapping);const kn={shaderID:Je,shaderType:Pe.type,shaderName:Pe.name,vertexShader:ht,fragmentShader:lt,defines:Pe.defines,customVertexShaderID:Qe,customFragmentShaderID:Ze,isRawShaderMaterial:Pe.isRawShaderMaterial===!0,glslVersion:Pe.glslVersion,precision:pe,batching:St,batchingColor:St&&ke._colorsTexture!==null,instancing:Tt,instancingColor:Tt&&ke.instanceColor!==null,instancingMorph:Tt&&ke.morphTexture!==null,supportsVertexTextures:de,outputColorSpace:it===null?K.outputColorSpace:it.isXRRenderTarget===!0?it.texture.colorSpace:LinearSRGBColorSpace$2,alphaToCoverage:!!Pe.alphaToCoverage,map:Et,matcap:Nt,envMap:zt,envMapMode:zt&&Ke.mapping,envMapCubeUVHeight:tt,aoMap:yt,lightMap:Ut,bumpMap:bt,normalMap:Ot,displacementMap:de&&Mt,emissiveMap:_t,normalMapObjectSpace:Ot&&Pe.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:Ot&&Pe.normalMapType===TangentSpaceNormalMap,metalnessMap:pt,roughnessMap:ft,anisotropy:st,anisotropyMap:De,clearcoat:vt,clearcoatMap:Be,clearcoatNormalMap:rt,clearcoatRoughnessMap:at,dispersion:Pt,iridescence:Lt,iridescenceMap:xt,iridescenceThicknessMap:Ct,sheen:Vt,sheenColorMap:Qt,sheenRoughnessMap:qt,specularMap:It,specularColorMap:Gt,specularIntensityMap:Jt,transmission:Le,transmissionMap:kt,thicknessMap:Ht,gradientMap:Yt,opaque:Pe.transparent===!1&&Pe.blending===NormalBlending&&Pe.alphaToCoverage===!1,alphaMap:hn,alphaTest:_n,alphaHash:xn,combine:Pe.combine,mapUv:Et&&ge(Pe.map.channel),aoMapUv:yt&&ge(Pe.aoMap.channel),lightMapUv:Ut&&ge(Pe.lightMap.channel),bumpMapUv:bt&&ge(Pe.bumpMap.channel),normalMapUv:Ot&&ge(Pe.normalMap.channel),displacementMapUv:Mt&&ge(Pe.displacementMap.channel),emissiveMapUv:_t&&ge(Pe.emissiveMap.channel),metalnessMapUv:pt&&ge(Pe.metalnessMap.channel),roughnessMapUv:ft&&ge(Pe.roughnessMap.channel),anisotropyMapUv:De&&ge(Pe.anisotropyMap.channel),clearcoatMapUv:Be&&ge(Pe.clearcoatMap.channel),clearcoatNormalMapUv:rt&&ge(Pe.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:at&&ge(Pe.clearcoatRoughnessMap.channel),iridescenceMapUv:xt&&ge(Pe.iridescenceMap.channel),iridescenceThicknessMapUv:Ct&&ge(Pe.iridescenceThicknessMap.channel),sheenColorMapUv:Qt&&ge(Pe.sheenColorMap.channel),sheenRoughnessMapUv:qt&&ge(Pe.sheenRoughnessMap.channel),specularMapUv:It&&ge(Pe.specularMap.channel),specularColorMapUv:Gt&&ge(Pe.specularColorMap.channel),specularIntensityMapUv:Jt&&ge(Pe.specularIntensityMap.channel),transmissionMapUv:kt&&ge(Pe.transmissionMap.channel),thicknessMapUv:Ht&&ge(Pe.thicknessMap.channel),alphaMapUv:hn&&ge(Pe.alphaMap.channel),vertexTangents:!!He.attributes.tangent&&(Ot||st),vertexColors:Pe.vertexColors,vertexAlphas:Pe.vertexColors===!0&&!!He.attributes.color&&He.attributes.color.itemSize===4,pointsUvs:ke.isPoints===!0&&!!He.attributes.uv&&(Et||hn),fog:!!Ge,useFog:Pe.fog===!0,fogExp2:!!Ge&&Ge.isFogExp2,flatShading:Pe.flatShading===!0,sizeAttenuation:Pe.sizeAttenuation===!0,logarithmicDepthBuffer:fe,reverseDepthBuffer:nt,skinning:ke.isSkinnedMesh===!0,morphTargets:He.morphAttributes.position!==void 0,morphNormals:He.morphAttributes.normal!==void 0,morphColors:He.morphAttributes.color!==void 0,morphTargetsCount:Fe,morphTextureStride:ct,numDirLights:Ie.directional.length,numPointLights:Ie.point.length,numSpotLights:Ie.spot.length,numSpotLightMaps:Ie.spotLightMap.length,numRectAreaLights:Ie.rectArea.length,numHemiLights:Ie.hemi.length,numDirLightShadows:Ie.directionalShadowMap.length,numPointLightShadows:Ie.pointShadowMap.length,numSpotLightShadows:Ie.spotShadowMap.length,numSpotLightShadowsWithMaps:Ie.numSpotLightShadowsWithMaps,numLightProbes:Ie.numLightProbes,numClippingPlanes:oe.numPlanes,numClipIntersection:oe.numIntersection,dithering:Pe.dithering,shadowMapEnabled:K.shadowMap.enabled&&$e.length>0,shadowMapType:K.shadowMap.type,toneMapping:Vn,decodeVideoTexture:Et&&Pe.map.isVideoTexture===!0&&ColorManagement.getTransfer(Pe.map.colorSpace)===SRGBTransfer,decodeVideoTextureEmissive:_t&&Pe.emissiveMap.isVideoTexture===!0&&ColorManagement.getTransfer(Pe.emissiveMap.colorSpace)===SRGBTransfer,premultipliedAlpha:Pe.premultipliedAlpha,doubleSided:Pe.side===DoubleSide,flipSided:Pe.side===BackSide,useDepthPacking:Pe.depthPacking>=0,depthPacking:Pe.depthPacking||0,index0AttributeName:Pe.index0AttributeName,extensionClipCullDistance:Ln&&Pe.extensions.clipCullDistance===!0&&te.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ln&&Pe.extensions.multiDraw===!0||St)&&te.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:te.has("KHR_parallel_shader_compile"),customProgramCacheKey:Pe.customProgramCacheKey()};return kn.vertexUv1s=le.has(1),kn.vertexUv2s=le.has(2),kn.vertexUv3s=le.has(3),le.clear(),kn}function Ae(Pe){const Ie=[];if(Pe.shaderID?Ie.push(Pe.shaderID):(Ie.push(Pe.customVertexShaderID),Ie.push(Pe.customFragmentShaderID)),Pe.defines!==void 0)for(const $e in Pe.defines)Ie.push($e),Ie.push(Pe.defines[$e]);return Pe.isRawShaderMaterial===!1&&(ye(Ie,Pe),ve(Ie,Pe),Ie.push(K.outputColorSpace)),Ie.push(Pe.customProgramCacheKey),Ie.join()}function ye(Pe,Ie){Pe.push(Ie.precision),Pe.push(Ie.outputColorSpace),Pe.push(Ie.envMapMode),Pe.push(Ie.envMapCubeUVHeight),Pe.push(Ie.mapUv),Pe.push(Ie.alphaMapUv),Pe.push(Ie.lightMapUv),Pe.push(Ie.aoMapUv),Pe.push(Ie.bumpMapUv),Pe.push(Ie.normalMapUv),Pe.push(Ie.displacementMapUv),Pe.push(Ie.emissiveMapUv),Pe.push(Ie.metalnessMapUv),Pe.push(Ie.roughnessMapUv),Pe.push(Ie.anisotropyMapUv),Pe.push(Ie.clearcoatMapUv),Pe.push(Ie.clearcoatNormalMapUv),Pe.push(Ie.clearcoatRoughnessMapUv),Pe.push(Ie.iridescenceMapUv),Pe.push(Ie.iridescenceThicknessMapUv),Pe.push(Ie.sheenColorMapUv),Pe.push(Ie.sheenRoughnessMapUv),Pe.push(Ie.specularMapUv),Pe.push(Ie.specularColorMapUv),Pe.push(Ie.specularIntensityMapUv),Pe.push(Ie.transmissionMapUv),Pe.push(Ie.thicknessMapUv),Pe.push(Ie.combine),Pe.push(Ie.fogExp2),Pe.push(Ie.sizeAttenuation),Pe.push(Ie.morphTargetsCount),Pe.push(Ie.morphAttributeCount),Pe.push(Ie.numDirLights),Pe.push(Ie.numPointLights),Pe.push(Ie.numSpotLights),Pe.push(Ie.numSpotLightMaps),Pe.push(Ie.numHemiLights),Pe.push(Ie.numRectAreaLights),Pe.push(Ie.numDirLightShadows),Pe.push(Ie.numPointLightShadows),Pe.push(Ie.numSpotLightShadows),Pe.push(Ie.numSpotLightShadowsWithMaps),Pe.push(Ie.numLightProbes),Pe.push(Ie.shadowMapType),Pe.push(Ie.toneMapping),Pe.push(Ie.numClippingPlanes),Pe.push(Ie.numClipIntersection),Pe.push(Ie.depthPacking)}function ve(Pe,Ie){se.disableAll(),Ie.supportsVertexTextures&&se.enable(0),Ie.instancing&&se.enable(1),Ie.instancingColor&&se.enable(2),Ie.instancingMorph&&se.enable(3),Ie.matcap&&se.enable(4),Ie.envMap&&se.enable(5),Ie.normalMapObjectSpace&&se.enable(6),Ie.normalMapTangentSpace&&se.enable(7),Ie.clearcoat&&se.enable(8),Ie.iridescence&&se.enable(9),Ie.alphaTest&&se.enable(10),Ie.vertexColors&&se.enable(11),Ie.vertexAlphas&&se.enable(12),Ie.vertexUv1s&&se.enable(13),Ie.vertexUv2s&&se.enable(14),Ie.vertexUv3s&&se.enable(15),Ie.vertexTangents&&se.enable(16),Ie.anisotropy&&se.enable(17),Ie.alphaHash&&se.enable(18),Ie.batching&&se.enable(19),Ie.dispersion&&se.enable(20),Ie.batchingColor&&se.enable(21),Pe.push(se.mask),se.disableAll(),Ie.fog&&se.enable(0),Ie.useFog&&se.enable(1),Ie.flatShading&&se.enable(2),Ie.logarithmicDepthBuffer&&se.enable(3),Ie.reverseDepthBuffer&&se.enable(4),Ie.skinning&&se.enable(5),Ie.morphTargets&&se.enable(6),Ie.morphNormals&&se.enable(7),Ie.morphColors&&se.enable(8),Ie.premultipliedAlpha&&se.enable(9),Ie.shadowMapEnabled&&se.enable(10),Ie.doubleSided&&se.enable(11),Ie.flipSided&&se.enable(12),Ie.useDepthPacking&&se.enable(13),Ie.dithering&&se.enable(14),Ie.transmission&&se.enable(15),Ie.sheen&&se.enable(16),Ie.opaque&&se.enable(17),Ie.pointsUvs&&se.enable(18),Ie.decodeVideoTexture&&se.enable(19),Ie.decodeVideoTextureEmissive&&se.enable(20),Ie.alphaToCoverage&&se.enable(21),Pe.push(se.mask)}function _e(Pe){const Ie=he[Pe.type];let $e;if(Ie){const Ue=ShaderLib[Ie];$e=UniformsUtils.clone(Ue.uniforms)}else $e=Pe.uniforms;return $e}function Te(Pe,Ie){let $e;for(let Ue=0,ke=ce.length;Ue<ke;Ue++){const Ge=ce[Ue];if(Ge.cacheKey===Ie){$e=Ge,++$e.usedTimes;break}}return $e===void 0&&($e=new WebGLProgram(K,Ie,Pe,ie),ce.push($e)),$e}function be(Pe){if(--Pe.usedTimes===0){const Ie=ce.indexOf(Pe);ce[Ie]=ce[ce.length-1],ce.pop(),Pe.destroy()}}function Re(Pe){ae.remove(Pe)}function we(){ae.dispose()}return{getParameters:me,getProgramCacheKey:Ae,getUniforms:_e,acquireProgram:Te,releaseProgram:be,releaseShaderCache:Re,programs:ce,dispose:we}}function WebGLProperties(){let K=new WeakMap;function _(oe){return K.has(oe)}function Z(oe){let se=K.get(oe);return se===void 0&&(se={},K.set(oe,se)),se}function te(oe){K.delete(oe)}function ne(oe,se,ae){K.get(oe)[se]=ae}function ie(){K=new WeakMap}return{has:_,get:Z,remove:te,update:ne,dispose:ie}}function painterSortStable(K,_){return K.groupOrder!==_.groupOrder?K.groupOrder-_.groupOrder:K.renderOrder!==_.renderOrder?K.renderOrder-_.renderOrder:K.material.id!==_.material.id?K.material.id-_.material.id:K.z!==_.z?K.z-_.z:K.id-_.id}function reversePainterSortStable(K,_){return K.groupOrder!==_.groupOrder?K.groupOrder-_.groupOrder:K.renderOrder!==_.renderOrder?K.renderOrder-_.renderOrder:K.z!==_.z?_.z-K.z:K.id-_.id}function WebGLRenderList(){const K=[];let _=0;const Z=[],te=[],ne=[];function ie(){_=0,Z.length=0,te.length=0,ne.length=0}function oe(fe,de,pe,he,ge,me){let Ae=K[_];return Ae===void 0?(Ae={id:fe.id,object:fe,geometry:de,material:pe,groupOrder:he,renderOrder:fe.renderOrder,z:ge,group:me},K[_]=Ae):(Ae.id=fe.id,Ae.object=fe,Ae.geometry=de,Ae.material=pe,Ae.groupOrder=he,Ae.renderOrder=fe.renderOrder,Ae.z=ge,Ae.group=me),_++,Ae}function se(fe,de,pe,he,ge,me){const Ae=oe(fe,de,pe,he,ge,me);pe.transmission>0?te.push(Ae):pe.transparent===!0?ne.push(Ae):Z.push(Ae)}function ae(fe,de,pe,he,ge,me){const Ae=oe(fe,de,pe,he,ge,me);pe.transmission>0?te.unshift(Ae):pe.transparent===!0?ne.unshift(Ae):Z.unshift(Ae)}function le(fe,de){Z.length>1&&Z.sort(fe||painterSortStable),te.length>1&&te.sort(de||reversePainterSortStable),ne.length>1&&ne.sort(de||reversePainterSortStable)}function ce(){for(let fe=_,de=K.length;fe<de;fe++){const pe=K[fe];if(pe.id===null)break;pe.id=null,pe.object=null,pe.geometry=null,pe.material=null,pe.group=null}}return{opaque:Z,transmissive:te,transparent:ne,init:ie,push:se,unshift:ae,finish:ce,sort:le}}function WebGLRenderLists(){let K=new WeakMap;function _(te,ne){const ie=K.get(te);let oe;return ie===void 0?(oe=new WebGLRenderList,K.set(te,[oe])):ne>=ie.length?(oe=new WebGLRenderList,ie.push(oe)):oe=ie[ne],oe}function Z(){K=new WeakMap}return{get:_,dispose:Z}}function UniformsCache(){const K={};return{get:function(_){if(K[_.id]!==void 0)return K[_.id];let Z;switch(_.type){case"DirectionalLight":Z={direction:new Vector3,color:new Color$1};break;case"SpotLight":Z={position:new Vector3,direction:new Vector3,color:new Color$1,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":Z={position:new Vector3,color:new Color$1,distance:0,decay:0};break;case"HemisphereLight":Z={direction:new Vector3,skyColor:new Color$1,groundColor:new Color$1};break;case"RectAreaLight":Z={color:new Color$1,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return K[_.id]=Z,Z}}}function ShadowUniformsCache(){const K={};return{get:function(_){if(K[_.id]!==void 0)return K[_.id];let Z;switch(_.type){case"DirectionalLight":Z={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":Z={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":Z={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return K[_.id]=Z,Z}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(K,_){return(_.castShadow?2:0)-(K.castShadow?2:0)+(_.map?1:0)-(K.map?1:0)}function WebGLLights(K){const _=new UniformsCache,Z=ShadowUniformsCache(),te={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let le=0;le<9;le++)te.probe.push(new Vector3);const ne=new Vector3,ie=new Matrix4,oe=new Matrix4;function se(le){let ce=0,fe=0,de=0;for(let Pe=0;Pe<9;Pe++)te.probe[Pe].set(0,0,0);let pe=0,he=0,ge=0,me=0,Ae=0,ye=0,ve=0,_e=0,Te=0,be=0,Re=0;le.sort(shadowCastingAndTexturingLightsFirst);for(let Pe=0,Ie=le.length;Pe<Ie;Pe++){const $e=le[Pe],Ue=$e.color,ke=$e.intensity,Ge=$e.distance,He=$e.shadow&&$e.shadow.map?$e.shadow.map.texture:null;if($e.isAmbientLight)ce+=Ue.r*ke,fe+=Ue.g*ke,de+=Ue.b*ke;else if($e.isLightProbe){for(let ze=0;ze<9;ze++)te.probe[ze].addScaledVector($e.sh.coefficients[ze],ke);Re++}else if($e.isDirectionalLight){const ze=_.get($e);if(ze.color.copy($e.color).multiplyScalar($e.intensity),$e.castShadow){const Ke=$e.shadow,tt=Z.get($e);tt.shadowIntensity=Ke.intensity,tt.shadowBias=Ke.bias,tt.shadowNormalBias=Ke.normalBias,tt.shadowRadius=Ke.radius,tt.shadowMapSize=Ke.mapSize,te.directionalShadow[pe]=tt,te.directionalShadowMap[pe]=He,te.directionalShadowMatrix[pe]=$e.shadow.matrix,ye++}te.directional[pe]=ze,pe++}else if($e.isSpotLight){const ze=_.get($e);ze.position.setFromMatrixPosition($e.matrixWorld),ze.color.copy(Ue).multiplyScalar(ke),ze.distance=Ge,ze.coneCos=Math.cos($e.angle),ze.penumbraCos=Math.cos($e.angle*(1-$e.penumbra)),ze.decay=$e.decay,te.spot[ge]=ze;const Ke=$e.shadow;if($e.map&&(te.spotLightMap[Te]=$e.map,Te++,Ke.updateMatrices($e),$e.castShadow&&be++),te.spotLightMatrix[ge]=Ke.matrix,$e.castShadow){const tt=Z.get($e);tt.shadowIntensity=Ke.intensity,tt.shadowBias=Ke.bias,tt.shadowNormalBias=Ke.normalBias,tt.shadowRadius=Ke.radius,tt.shadowMapSize=Ke.mapSize,te.spotShadow[ge]=tt,te.spotShadowMap[ge]=He,_e++}ge++}else if($e.isRectAreaLight){const ze=_.get($e);ze.color.copy(Ue).multiplyScalar(ke),ze.halfWidth.set($e.width*.5,0,0),ze.halfHeight.set(0,$e.height*.5,0),te.rectArea[me]=ze,me++}else if($e.isPointLight){const ze=_.get($e);if(ze.color.copy($e.color).multiplyScalar($e.intensity),ze.distance=$e.distance,ze.decay=$e.decay,$e.castShadow){const Ke=$e.shadow,tt=Z.get($e);tt.shadowIntensity=Ke.intensity,tt.shadowBias=Ke.bias,tt.shadowNormalBias=Ke.normalBias,tt.shadowRadius=Ke.radius,tt.shadowMapSize=Ke.mapSize,tt.shadowCameraNear=Ke.camera.near,tt.shadowCameraFar=Ke.camera.far,te.pointShadow[he]=tt,te.pointShadowMap[he]=He,te.pointShadowMatrix[he]=$e.shadow.matrix,ve++}te.point[he]=ze,he++}else if($e.isHemisphereLight){const ze=_.get($e);ze.skyColor.copy($e.color).multiplyScalar(ke),ze.groundColor.copy($e.groundColor).multiplyScalar(ke),te.hemi[Ae]=ze,Ae++}}me>0&&(K.has("OES_texture_float_linear")===!0?(te.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,te.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(te.rectAreaLTC1=UniformsLib.LTC_HALF_1,te.rectAreaLTC2=UniformsLib.LTC_HALF_2)),te.ambient[0]=ce,te.ambient[1]=fe,te.ambient[2]=de;const we=te.hash;(we.directionalLength!==pe||we.pointLength!==he||we.spotLength!==ge||we.rectAreaLength!==me||we.hemiLength!==Ae||we.numDirectionalShadows!==ye||we.numPointShadows!==ve||we.numSpotShadows!==_e||we.numSpotMaps!==Te||we.numLightProbes!==Re)&&(te.directional.length=pe,te.spot.length=ge,te.rectArea.length=me,te.point.length=he,te.hemi.length=Ae,te.directionalShadow.length=ye,te.directionalShadowMap.length=ye,te.pointShadow.length=ve,te.pointShadowMap.length=ve,te.spotShadow.length=_e,te.spotShadowMap.length=_e,te.directionalShadowMatrix.length=ye,te.pointShadowMatrix.length=ve,te.spotLightMatrix.length=_e+Te-be,te.spotLightMap.length=Te,te.numSpotLightShadowsWithMaps=be,te.numLightProbes=Re,we.directionalLength=pe,we.pointLength=he,we.spotLength=ge,we.rectAreaLength=me,we.hemiLength=Ae,we.numDirectionalShadows=ye,we.numPointShadows=ve,we.numSpotShadows=_e,we.numSpotMaps=Te,we.numLightProbes=Re,te.version=nextVersion++)}function ae(le,ce){let fe=0,de=0,pe=0,he=0,ge=0;const me=ce.matrixWorldInverse;for(let Ae=0,ye=le.length;Ae<ye;Ae++){const ve=le[Ae];if(ve.isDirectionalLight){const _e=te.directional[fe];_e.direction.setFromMatrixPosition(ve.matrixWorld),ne.setFromMatrixPosition(ve.target.matrixWorld),_e.direction.sub(ne),_e.direction.transformDirection(me),fe++}else if(ve.isSpotLight){const _e=te.spot[pe];_e.position.setFromMatrixPosition(ve.matrixWorld),_e.position.applyMatrix4(me),_e.direction.setFromMatrixPosition(ve.matrixWorld),ne.setFromMatrixPosition(ve.target.matrixWorld),_e.direction.sub(ne),_e.direction.transformDirection(me),pe++}else if(ve.isRectAreaLight){const _e=te.rectArea[he];_e.position.setFromMatrixPosition(ve.matrixWorld),_e.position.applyMatrix4(me),oe.identity(),ie.copy(ve.matrixWorld),ie.premultiply(me),oe.extractRotation(ie),_e.halfWidth.set(ve.width*.5,0,0),_e.halfHeight.set(0,ve.height*.5,0),_e.halfWidth.applyMatrix4(oe),_e.halfHeight.applyMatrix4(oe),he++}else if(ve.isPointLight){const _e=te.point[de];_e.position.setFromMatrixPosition(ve.matrixWorld),_e.position.applyMatrix4(me),de++}else if(ve.isHemisphereLight){const _e=te.hemi[ge];_e.direction.setFromMatrixPosition(ve.matrixWorld),_e.direction.transformDirection(me),ge++}}}return{setup:se,setupView:ae,state:te}}function WebGLRenderState(K){const _=new WebGLLights(K),Z=[],te=[];function ne(ce){le.camera=ce,Z.length=0,te.length=0}function ie(ce){Z.push(ce)}function oe(ce){te.push(ce)}function se(){_.setup(Z)}function ae(ce){_.setupView(Z,ce)}const le={lightsArray:Z,shadowsArray:te,camera:null,lights:_,transmissionRenderTarget:{}};return{init:ne,state:le,setupLights:se,setupLightsView:ae,pushLight:ie,pushShadow:oe}}function WebGLRenderStates(K){let _=new WeakMap;function Z(ne,ie=0){const oe=_.get(ne);let se;return oe===void 0?(se=new WebGLRenderState(K),_.set(ne,[se])):ie>=oe.length?(se=new WebGLRenderState(K),oe.push(se)):se=oe[ie],se}function te(){_=new WeakMap}return{get:Z,dispose:te}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment$i=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(K,_,Z){let te=new Frustum$1;const ne=new Vector2,ie=new Vector2,oe=new Vector4,se=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),ae=new MeshDistanceMaterial,le={},ce=Z.maxTextureSize,fe={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},de=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment$i}),pe=de.clone();pe.defines.HORIZONTAL_PASS=1;const he=new BufferGeometry;he.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ge=new Mesh(he,de),me=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let Ae=this.type;this.render=function(be,Re,we){if(me.enabled===!1||me.autoUpdate===!1&&me.needsUpdate===!1||be.length===0)return;const Pe=K.getRenderTarget(),Ie=K.getActiveCubeFace(),$e=K.getActiveMipmapLevel(),Ue=K.state;Ue.setBlending(NoBlending),Ue.buffers.color.setClear(1,1,1,1),Ue.buffers.depth.setTest(!0),Ue.setScissorTest(!1);const ke=Ae!==VSMShadowMap&&this.type===VSMShadowMap,Ge=Ae===VSMShadowMap&&this.type!==VSMShadowMap;for(let He=0,ze=be.length;He<ze;He++){const Ke=be[He],tt=Ke.shadow;if(tt===void 0){console.warn("THREE.WebGLShadowMap:",Ke,"has no shadow.");continue}if(tt.autoUpdate===!1&&tt.needsUpdate===!1)continue;ne.copy(tt.mapSize);const Je=tt.getFrameExtents();if(ne.multiply(Je),ie.copy(tt.mapSize),(ne.x>ce||ne.y>ce)&&(ne.x>ce&&(ie.x=Math.floor(ce/Je.x),ne.x=ie.x*Je.x,tt.mapSize.x=ie.x),ne.y>ce&&(ie.y=Math.floor(ce/Je.y),ne.y=ie.y*Je.y,tt.mapSize.y=ie.y)),tt.map===null||ke===!0||Ge===!0){const Fe=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};tt.map!==null&&tt.map.dispose(),tt.map=new WebGLRenderTarget(ne.x,ne.y,Fe),tt.map.texture.name=Ke.name+".shadowMap",tt.camera.updateProjectionMatrix()}K.setRenderTarget(tt.map),K.clear();const ot=tt.getViewportCount();for(let Fe=0;Fe<ot;Fe++){const ct=tt.getViewport(Fe);oe.set(ie.x*ct.x,ie.y*ct.y,ie.x*ct.z,ie.y*ct.w),Ue.viewport(oe),tt.updateMatrices(Ke,Fe),te=tt.getFrustum(),_e(Re,we,tt.camera,Ke,this.type)}tt.isPointLightShadow!==!0&&this.type===VSMShadowMap&&ye(tt,we),tt.needsUpdate=!1}Ae=this.type,me.needsUpdate=!1,K.setRenderTarget(Pe,Ie,$e)};function ye(be,Re){const we=_.update(ge);de.defines.VSM_SAMPLES!==be.blurSamples&&(de.defines.VSM_SAMPLES=be.blurSamples,pe.defines.VSM_SAMPLES=be.blurSamples,de.needsUpdate=!0,pe.needsUpdate=!0),be.mapPass===null&&(be.mapPass=new WebGLRenderTarget(ne.x,ne.y)),de.uniforms.shadow_pass.value=be.map.texture,de.uniforms.resolution.value=be.mapSize,de.uniforms.radius.value=be.radius,K.setRenderTarget(be.mapPass),K.clear(),K.renderBufferDirect(Re,null,we,de,ge,null),pe.uniforms.shadow_pass.value=be.mapPass.texture,pe.uniforms.resolution.value=be.mapSize,pe.uniforms.radius.value=be.radius,K.setRenderTarget(be.map),K.clear(),K.renderBufferDirect(Re,null,we,pe,ge,null)}function ve(be,Re,we,Pe){let Ie=null;const $e=we.isPointLight===!0?be.customDistanceMaterial:be.customDepthMaterial;if($e!==void 0)Ie=$e;else if(Ie=we.isPointLight===!0?ae:se,K.localClippingEnabled&&Re.clipShadows===!0&&Array.isArray(Re.clippingPlanes)&&Re.clippingPlanes.length!==0||Re.displacementMap&&Re.displacementScale!==0||Re.alphaMap&&Re.alphaTest>0||Re.map&&Re.alphaTest>0){const Ue=Ie.uuid,ke=Re.uuid;let Ge=le[Ue];Ge===void 0&&(Ge={},le[Ue]=Ge);let He=Ge[ke];He===void 0&&(He=Ie.clone(),Ge[ke]=He,Re.addEventListener("dispose",Te)),Ie=He}if(Ie.visible=Re.visible,Ie.wireframe=Re.wireframe,Pe===VSMShadowMap?Ie.side=Re.shadowSide!==null?Re.shadowSide:Re.side:Ie.side=Re.shadowSide!==null?Re.shadowSide:fe[Re.side],Ie.alphaMap=Re.alphaMap,Ie.alphaTest=Re.alphaTest,Ie.map=Re.map,Ie.clipShadows=Re.clipShadows,Ie.clippingPlanes=Re.clippingPlanes,Ie.clipIntersection=Re.clipIntersection,Ie.displacementMap=Re.displacementMap,Ie.displacementScale=Re.displacementScale,Ie.displacementBias=Re.displacementBias,Ie.wireframeLinewidth=Re.wireframeLinewidth,Ie.linewidth=Re.linewidth,we.isPointLight===!0&&Ie.isMeshDistanceMaterial===!0){const Ue=K.properties.get(Ie);Ue.light=we}return Ie}function _e(be,Re,we,Pe,Ie){if(be.visible===!1)return;if(be.layers.test(Re.layers)&&(be.isMesh||be.isLine||be.isPoints)&&(be.castShadow||be.receiveShadow&&Ie===VSMShadowMap)&&(!be.frustumCulled||te.intersectsObject(be))){be.modelViewMatrix.multiplyMatrices(we.matrixWorldInverse,be.matrixWorld);const ke=_.update(be),Ge=be.material;if(Array.isArray(Ge)){const He=ke.groups;for(let ze=0,Ke=He.length;ze<Ke;ze++){const tt=He[ze],Je=Ge[tt.materialIndex];if(Je&&Je.visible){const ot=ve(be,Je,Pe,Ie);be.onBeforeShadow(K,be,Re,we,ke,ot,tt),K.renderBufferDirect(we,null,ke,ot,be,tt),be.onAfterShadow(K,be,Re,we,ke,ot,tt)}}}else if(Ge.visible){const He=ve(be,Ge,Pe,Ie);be.onBeforeShadow(K,be,Re,we,ke,He,null),K.renderBufferDirect(we,null,ke,He,be,null),be.onAfterShadow(K,be,Re,we,ke,He,null)}}const Ue=be.children;for(let ke=0,Ge=Ue.length;ke<Ge;ke++)_e(Ue[ke],Re,we,Pe,Ie)}function Te(be){be.target.removeEventListener("dispose",Te);for(const we in le){const Pe=le[we],Ie=be.target.uuid;Ie in Pe&&(Pe[Ie].dispose(),delete Pe[Ie])}}}const reversedFuncs={[NeverDepth]:AlwaysDepth,[LessDepth]:GreaterDepth,[EqualDepth]:NotEqualDepth,[LessEqualDepth]:GreaterEqualDepth,[AlwaysDepth]:NeverDepth,[GreaterDepth]:LessDepth,[NotEqualDepth]:EqualDepth,[GreaterEqualDepth]:LessEqualDepth};function WebGLState(K,_){function Z(){let kt=!1;const Ht=new Vector4;let Yt=null;const hn=new Vector4(0,0,0,0);return{setMask:function(_n){Yt!==_n&&!kt&&(K.colorMask(_n,_n,_n,_n),Yt=_n)},setLocked:function(_n){kt=_n},setClear:function(_n,xn,Ln,Vn,kn){kn===!0&&(_n*=Vn,xn*=Vn,Ln*=Vn),Ht.set(_n,xn,Ln,Vn),hn.equals(Ht)===!1&&(K.clearColor(_n,xn,Ln,Vn),hn.copy(Ht))},reset:function(){kt=!1,Yt=null,hn.set(-1,0,0,0)}}}function te(){let kt=!1,Ht=!1,Yt=null,hn=null,_n=null;return{setReversed:function(xn){if(Ht!==xn){const Ln=_.get("EXT_clip_control");xn?Ln.clipControlEXT(Ln.LOWER_LEFT_EXT,Ln.ZERO_TO_ONE_EXT):Ln.clipControlEXT(Ln.LOWER_LEFT_EXT,Ln.NEGATIVE_ONE_TO_ONE_EXT),Ht=xn;const Vn=_n;_n=null,this.setClear(Vn)}},getReversed:function(){return Ht},setTest:function(xn){xn?it(K.DEPTH_TEST):nt(K.DEPTH_TEST)},setMask:function(xn){Yt!==xn&&!kt&&(K.depthMask(xn),Yt=xn)},setFunc:function(xn){if(Ht&&(xn=reversedFuncs[xn]),hn!==xn){switch(xn){case NeverDepth:K.depthFunc(K.NEVER);break;case AlwaysDepth:K.depthFunc(K.ALWAYS);break;case LessDepth:K.depthFunc(K.LESS);break;case LessEqualDepth:K.depthFunc(K.LEQUAL);break;case EqualDepth:K.depthFunc(K.EQUAL);break;case GreaterEqualDepth:K.depthFunc(K.GEQUAL);break;case GreaterDepth:K.depthFunc(K.GREATER);break;case NotEqualDepth:K.depthFunc(K.NOTEQUAL);break;default:K.depthFunc(K.LEQUAL)}hn=xn}},setLocked:function(xn){kt=xn},setClear:function(xn){_n!==xn&&(Ht&&(xn=1-xn),K.clearDepth(xn),_n=xn)},reset:function(){kt=!1,Yt=null,hn=null,_n=null,Ht=!1}}}function ne(){let kt=!1,Ht=null,Yt=null,hn=null,_n=null,xn=null,Ln=null,Vn=null,kn=null;return{setTest:function(Rn){kt||(Rn?it(K.STENCIL_TEST):nt(K.STENCIL_TEST))},setMask:function(Rn){Ht!==Rn&&!kt&&(K.stencilMask(Rn),Ht=Rn)},setFunc:function(Rn,or,pr){(Yt!==Rn||hn!==or||_n!==pr)&&(K.stencilFunc(Rn,or,pr),Yt=Rn,hn=or,_n=pr)},setOp:function(Rn,or,pr){(xn!==Rn||Ln!==or||Vn!==pr)&&(K.stencilOp(Rn,or,pr),xn=Rn,Ln=or,Vn=pr)},setLocked:function(Rn){kt=Rn},setClear:function(Rn){kn!==Rn&&(K.clearStencil(Rn),kn=Rn)},reset:function(){kt=!1,Ht=null,Yt=null,hn=null,_n=null,xn=null,Ln=null,Vn=null,kn=null}}}const ie=new Z,oe=new te,se=new ne,ae=new WeakMap,le=new WeakMap;let ce={},fe={},de=new WeakMap,pe=[],he=null,ge=!1,me=null,Ae=null,ye=null,ve=null,_e=null,Te=null,be=null,Re=new Color$1(0,0,0),we=0,Pe=!1,Ie=null,$e=null,Ue=null,ke=null,Ge=null;const He=K.getParameter(K.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ze=!1,Ke=0;const tt=K.getParameter(K.VERSION);tt.indexOf("WebGL")!==-1?(Ke=parseFloat(/^WebGL (\d)/.exec(tt)[1]),ze=Ke>=1):tt.indexOf("OpenGL ES")!==-1&&(Ke=parseFloat(/^OpenGL ES (\d)/.exec(tt)[1]),ze=Ke>=2);let Je=null,ot={};const Fe=K.getParameter(K.SCISSOR_BOX),ct=K.getParameter(K.VIEWPORT),ht=new Vector4().fromArray(Fe),lt=new Vector4().fromArray(ct);function Qe(kt,Ht,Yt,hn){const _n=new Uint8Array(4),xn=K.createTexture();K.bindTexture(kt,xn),K.texParameteri(kt,K.TEXTURE_MIN_FILTER,K.NEAREST),K.texParameteri(kt,K.TEXTURE_MAG_FILTER,K.NEAREST);for(let Ln=0;Ln<Yt;Ln++)kt===K.TEXTURE_3D||kt===K.TEXTURE_2D_ARRAY?K.texImage3D(Ht,0,K.RGBA,1,1,hn,0,K.RGBA,K.UNSIGNED_BYTE,_n):K.texImage2D(Ht+Ln,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,_n);return xn}const Ze={};Ze[K.TEXTURE_2D]=Qe(K.TEXTURE_2D,K.TEXTURE_2D,1),Ze[K.TEXTURE_CUBE_MAP]=Qe(K.TEXTURE_CUBE_MAP,K.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ze[K.TEXTURE_2D_ARRAY]=Qe(K.TEXTURE_2D_ARRAY,K.TEXTURE_2D_ARRAY,1,1),Ze[K.TEXTURE_3D]=Qe(K.TEXTURE_3D,K.TEXTURE_3D,1,1),ie.setClear(0,0,0,1),oe.setClear(1),se.setClear(0),it(K.DEPTH_TEST),oe.setFunc(LessEqualDepth),bt(!1),Ot(CullFaceBack),it(K.CULL_FACE),yt(NoBlending);function it(kt){ce[kt]!==!0&&(K.enable(kt),ce[kt]=!0)}function nt(kt){ce[kt]!==!1&&(K.disable(kt),ce[kt]=!1)}function Tt(kt,Ht){return fe[kt]!==Ht?(K.bindFramebuffer(kt,Ht),fe[kt]=Ht,kt===K.DRAW_FRAMEBUFFER&&(fe[K.FRAMEBUFFER]=Ht),kt===K.FRAMEBUFFER&&(fe[K.DRAW_FRAMEBUFFER]=Ht),!0):!1}function St(kt,Ht){let Yt=pe,hn=!1;if(kt){Yt=de.get(Ht),Yt===void 0&&(Yt=[],de.set(Ht,Yt));const _n=kt.textures;if(Yt.length!==_n.length||Yt[0]!==K.COLOR_ATTACHMENT0){for(let xn=0,Ln=_n.length;xn<Ln;xn++)Yt[xn]=K.COLOR_ATTACHMENT0+xn;Yt.length=_n.length,hn=!0}}else Yt[0]!==K.BACK&&(Yt[0]=K.BACK,hn=!0);hn&&K.drawBuffers(Yt)}function Et(kt){return he!==kt?(K.useProgram(kt),he=kt,!0):!1}const Nt={[AddEquation]:K.FUNC_ADD,[SubtractEquation]:K.FUNC_SUBTRACT,[ReverseSubtractEquation]:K.FUNC_REVERSE_SUBTRACT};Nt[MinEquation]=K.MIN,Nt[MaxEquation]=K.MAX;const zt={[ZeroFactor]:K.ZERO,[OneFactor]:K.ONE,[SrcColorFactor]:K.SRC_COLOR,[SrcAlphaFactor]:K.SRC_ALPHA,[SrcAlphaSaturateFactor]:K.SRC_ALPHA_SATURATE,[DstColorFactor]:K.DST_COLOR,[DstAlphaFactor]:K.DST_ALPHA,[OneMinusSrcColorFactor]:K.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:K.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:K.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:K.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:K.CONSTANT_COLOR,[OneMinusConstantColorFactor]:K.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:K.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:K.ONE_MINUS_CONSTANT_ALPHA};function yt(kt,Ht,Yt,hn,_n,xn,Ln,Vn,kn,Rn){if(kt===NoBlending){ge===!0&&(nt(K.BLEND),ge=!1);return}if(ge===!1&&(it(K.BLEND),ge=!0),kt!==CustomBlending){if(kt!==me||Rn!==Pe){if((Ae!==AddEquation||_e!==AddEquation)&&(K.blendEquation(K.FUNC_ADD),Ae=AddEquation,_e=AddEquation),Rn)switch(kt){case NormalBlending:K.blendFuncSeparate(K.ONE,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:K.blendFunc(K.ONE,K.ONE);break;case SubtractiveBlending:K.blendFuncSeparate(K.ZERO,K.ONE_MINUS_SRC_COLOR,K.ZERO,K.ONE);break;case MultiplyBlending:K.blendFuncSeparate(K.ZERO,K.SRC_COLOR,K.ZERO,K.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",kt);break}else switch(kt){case NormalBlending:K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:K.blendFunc(K.SRC_ALPHA,K.ONE);break;case SubtractiveBlending:K.blendFuncSeparate(K.ZERO,K.ONE_MINUS_SRC_COLOR,K.ZERO,K.ONE);break;case MultiplyBlending:K.blendFunc(K.ZERO,K.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",kt);break}ye=null,ve=null,Te=null,be=null,Re.set(0,0,0),we=0,me=kt,Pe=Rn}return}_n=_n||Ht,xn=xn||Yt,Ln=Ln||hn,(Ht!==Ae||_n!==_e)&&(K.blendEquationSeparate(Nt[Ht],Nt[_n]),Ae=Ht,_e=_n),(Yt!==ye||hn!==ve||xn!==Te||Ln!==be)&&(K.blendFuncSeparate(zt[Yt],zt[hn],zt[xn],zt[Ln]),ye=Yt,ve=hn,Te=xn,be=Ln),(Vn.equals(Re)===!1||kn!==we)&&(K.blendColor(Vn.r,Vn.g,Vn.b,kn),Re.copy(Vn),we=kn),me=kt,Pe=!1}function Ut(kt,Ht){kt.side===DoubleSide?nt(K.CULL_FACE):it(K.CULL_FACE);let Yt=kt.side===BackSide;Ht&&(Yt=!Yt),bt(Yt),kt.blending===NormalBlending&&kt.transparent===!1?yt(NoBlending):yt(kt.blending,kt.blendEquation,kt.blendSrc,kt.blendDst,kt.blendEquationAlpha,kt.blendSrcAlpha,kt.blendDstAlpha,kt.blendColor,kt.blendAlpha,kt.premultipliedAlpha),oe.setFunc(kt.depthFunc),oe.setTest(kt.depthTest),oe.setMask(kt.depthWrite),ie.setMask(kt.colorWrite);const hn=kt.stencilWrite;se.setTest(hn),hn&&(se.setMask(kt.stencilWriteMask),se.setFunc(kt.stencilFunc,kt.stencilRef,kt.stencilFuncMask),se.setOp(kt.stencilFail,kt.stencilZFail,kt.stencilZPass)),_t(kt.polygonOffset,kt.polygonOffsetFactor,kt.polygonOffsetUnits),kt.alphaToCoverage===!0?it(K.SAMPLE_ALPHA_TO_COVERAGE):nt(K.SAMPLE_ALPHA_TO_COVERAGE)}function bt(kt){Ie!==kt&&(kt?K.frontFace(K.CW):K.frontFace(K.CCW),Ie=kt)}function Ot(kt){kt!==CullFaceNone?(it(K.CULL_FACE),kt!==$e&&(kt===CullFaceBack?K.cullFace(K.BACK):kt===CullFaceFront?K.cullFace(K.FRONT):K.cullFace(K.FRONT_AND_BACK))):nt(K.CULL_FACE),$e=kt}function Mt(kt){kt!==Ue&&(ze&&K.lineWidth(kt),Ue=kt)}function _t(kt,Ht,Yt){kt?(it(K.POLYGON_OFFSET_FILL),(ke!==Ht||Ge!==Yt)&&(K.polygonOffset(Ht,Yt),ke=Ht,Ge=Yt)):nt(K.POLYGON_OFFSET_FILL)}function pt(kt){kt?it(K.SCISSOR_TEST):nt(K.SCISSOR_TEST)}function ft(kt){kt===void 0&&(kt=K.TEXTURE0+He-1),Je!==kt&&(K.activeTexture(kt),Je=kt)}function st(kt,Ht,Yt){Yt===void 0&&(Je===null?Yt=K.TEXTURE0+He-1:Yt=Je);let hn=ot[Yt];hn===void 0&&(hn={type:void 0,texture:void 0},ot[Yt]=hn),(hn.type!==kt||hn.texture!==Ht)&&(Je!==Yt&&(K.activeTexture(Yt),Je=Yt),K.bindTexture(kt,Ht||Ze[kt]),hn.type=kt,hn.texture=Ht)}function vt(){const kt=ot[Je];kt!==void 0&&kt.type!==void 0&&(K.bindTexture(kt.type,null),kt.type=void 0,kt.texture=void 0)}function Pt(){try{K.compressedTexImage2D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function Lt(){try{K.compressedTexImage3D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function Vt(){try{K.texSubImage2D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function Le(){try{K.texSubImage3D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function De(){try{K.compressedTexSubImage2D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function Be(){try{K.compressedTexSubImage3D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function rt(){try{K.texStorage2D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function at(){try{K.texStorage3D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function xt(){try{K.texImage2D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function Ct(){try{K.texImage3D(...arguments)}catch(kt){console.error("THREE.WebGLState:",kt)}}function Qt(kt){ht.equals(kt)===!1&&(K.scissor(kt.x,kt.y,kt.z,kt.w),ht.copy(kt))}function qt(kt){lt.equals(kt)===!1&&(K.viewport(kt.x,kt.y,kt.z,kt.w),lt.copy(kt))}function It(kt,Ht){let Yt=le.get(Ht);Yt===void 0&&(Yt=new WeakMap,le.set(Ht,Yt));let hn=Yt.get(kt);hn===void 0&&(hn=K.getUniformBlockIndex(Ht,kt.name),Yt.set(kt,hn))}function Gt(kt,Ht){const hn=le.get(Ht).get(kt);ae.get(Ht)!==hn&&(K.uniformBlockBinding(Ht,hn,kt.__bindingPointIndex),ae.set(Ht,hn))}function Jt(){K.disable(K.BLEND),K.disable(K.CULL_FACE),K.disable(K.DEPTH_TEST),K.disable(K.POLYGON_OFFSET_FILL),K.disable(K.SCISSOR_TEST),K.disable(K.STENCIL_TEST),K.disable(K.SAMPLE_ALPHA_TO_COVERAGE),K.blendEquation(K.FUNC_ADD),K.blendFunc(K.ONE,K.ZERO),K.blendFuncSeparate(K.ONE,K.ZERO,K.ONE,K.ZERO),K.blendColor(0,0,0,0),K.colorMask(!0,!0,!0,!0),K.clearColor(0,0,0,0),K.depthMask(!0),K.depthFunc(K.LESS),oe.setReversed(!1),K.clearDepth(1),K.stencilMask(4294967295),K.stencilFunc(K.ALWAYS,0,4294967295),K.stencilOp(K.KEEP,K.KEEP,K.KEEP),K.clearStencil(0),K.cullFace(K.BACK),K.frontFace(K.CCW),K.polygonOffset(0,0),K.activeTexture(K.TEXTURE0),K.bindFramebuffer(K.FRAMEBUFFER,null),K.bindFramebuffer(K.DRAW_FRAMEBUFFER,null),K.bindFramebuffer(K.READ_FRAMEBUFFER,null),K.useProgram(null),K.lineWidth(1),K.scissor(0,0,K.canvas.width,K.canvas.height),K.viewport(0,0,K.canvas.width,K.canvas.height),ce={},Je=null,ot={},fe={},de=new WeakMap,pe=[],he=null,ge=!1,me=null,Ae=null,ye=null,ve=null,_e=null,Te=null,be=null,Re=new Color$1(0,0,0),we=0,Pe=!1,Ie=null,$e=null,Ue=null,ke=null,Ge=null,ht.set(0,0,K.canvas.width,K.canvas.height),lt.set(0,0,K.canvas.width,K.canvas.height),ie.reset(),oe.reset(),se.reset()}return{buffers:{color:ie,depth:oe,stencil:se},enable:it,disable:nt,bindFramebuffer:Tt,drawBuffers:St,useProgram:Et,setBlending:yt,setMaterial:Ut,setFlipSided:bt,setCullFace:Ot,setLineWidth:Mt,setPolygonOffset:_t,setScissorTest:pt,activeTexture:ft,bindTexture:st,unbindTexture:vt,compressedTexImage2D:Pt,compressedTexImage3D:Lt,texImage2D:xt,texImage3D:Ct,updateUBOMapping:It,uniformBlockBinding:Gt,texStorage2D:rt,texStorage3D:at,texSubImage2D:Vt,texSubImage3D:Le,compressedTexSubImage2D:De,compressedTexSubImage3D:Be,scissor:Qt,viewport:qt,reset:Jt}}function WebGLTextures(K,_,Z,te,ne,ie,oe){const se=_.has("WEBGL_multisampled_render_to_texture")?_.get("WEBGL_multisampled_render_to_texture"):null,ae=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),le=new Vector2,ce=new WeakMap;let fe;const de=new WeakMap;let pe=!1;try{pe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function he(ft,st){return pe?new OffscreenCanvas(ft,st):createElementNS("canvas")}function ge(ft,st,vt){let Pt=1;const Lt=pt(ft);if((Lt.width>vt||Lt.height>vt)&&(Pt=vt/Math.max(Lt.width,Lt.height)),Pt<1)if(typeof HTMLImageElement<"u"&&ft instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ft instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ft instanceof ImageBitmap||typeof VideoFrame<"u"&&ft instanceof VideoFrame){const Vt=Math.floor(Pt*Lt.width),Le=Math.floor(Pt*Lt.height);fe===void 0&&(fe=he(Vt,Le));const De=st?he(Vt,Le):fe;return De.width=Vt,De.height=Le,De.getContext("2d").drawImage(ft,0,0,Vt,Le),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Lt.width+"x"+Lt.height+") to ("+Vt+"x"+Le+")."),De}else return"data"in ft&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Lt.width+"x"+Lt.height+")."),ft;return ft}function me(ft){return ft.generateMipmaps}function Ae(ft){K.generateMipmap(ft)}function ye(ft){return ft.isWebGLCubeRenderTarget?K.TEXTURE_CUBE_MAP:ft.isWebGL3DRenderTarget?K.TEXTURE_3D:ft.isWebGLArrayRenderTarget||ft.isCompressedArrayTexture?K.TEXTURE_2D_ARRAY:K.TEXTURE_2D}function ve(ft,st,vt,Pt,Lt=!1){if(ft!==null){if(K[ft]!==void 0)return K[ft];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ft+"'")}let Vt=st;if(st===K.RED&&(vt===K.FLOAT&&(Vt=K.R32F),vt===K.HALF_FLOAT&&(Vt=K.R16F),vt===K.UNSIGNED_BYTE&&(Vt=K.R8)),st===K.RED_INTEGER&&(vt===K.UNSIGNED_BYTE&&(Vt=K.R8UI),vt===K.UNSIGNED_SHORT&&(Vt=K.R16UI),vt===K.UNSIGNED_INT&&(Vt=K.R32UI),vt===K.BYTE&&(Vt=K.R8I),vt===K.SHORT&&(Vt=K.R16I),vt===K.INT&&(Vt=K.R32I)),st===K.RG&&(vt===K.FLOAT&&(Vt=K.RG32F),vt===K.HALF_FLOAT&&(Vt=K.RG16F),vt===K.UNSIGNED_BYTE&&(Vt=K.RG8)),st===K.RG_INTEGER&&(vt===K.UNSIGNED_BYTE&&(Vt=K.RG8UI),vt===K.UNSIGNED_SHORT&&(Vt=K.RG16UI),vt===K.UNSIGNED_INT&&(Vt=K.RG32UI),vt===K.BYTE&&(Vt=K.RG8I),vt===K.SHORT&&(Vt=K.RG16I),vt===K.INT&&(Vt=K.RG32I)),st===K.RGB_INTEGER&&(vt===K.UNSIGNED_BYTE&&(Vt=K.RGB8UI),vt===K.UNSIGNED_SHORT&&(Vt=K.RGB16UI),vt===K.UNSIGNED_INT&&(Vt=K.RGB32UI),vt===K.BYTE&&(Vt=K.RGB8I),vt===K.SHORT&&(Vt=K.RGB16I),vt===K.INT&&(Vt=K.RGB32I)),st===K.RGBA_INTEGER&&(vt===K.UNSIGNED_BYTE&&(Vt=K.RGBA8UI),vt===K.UNSIGNED_SHORT&&(Vt=K.RGBA16UI),vt===K.UNSIGNED_INT&&(Vt=K.RGBA32UI),vt===K.BYTE&&(Vt=K.RGBA8I),vt===K.SHORT&&(Vt=K.RGBA16I),vt===K.INT&&(Vt=K.RGBA32I)),st===K.RGB&&vt===K.UNSIGNED_INT_5_9_9_9_REV&&(Vt=K.RGB9_E5),st===K.RGBA){const Le=Lt?LinearTransfer:ColorManagement.getTransfer(Pt);vt===K.FLOAT&&(Vt=K.RGBA32F),vt===K.HALF_FLOAT&&(Vt=K.RGBA16F),vt===K.UNSIGNED_BYTE&&(Vt=Le===SRGBTransfer?K.SRGB8_ALPHA8:K.RGBA8),vt===K.UNSIGNED_SHORT_4_4_4_4&&(Vt=K.RGBA4),vt===K.UNSIGNED_SHORT_5_5_5_1&&(Vt=K.RGB5_A1)}return(Vt===K.R16F||Vt===K.R32F||Vt===K.RG16F||Vt===K.RG32F||Vt===K.RGBA16F||Vt===K.RGBA32F)&&_.get("EXT_color_buffer_float"),Vt}function _e(ft,st){let vt;return ft?st===null||st===UnsignedIntType||st===UnsignedInt248Type?vt=K.DEPTH24_STENCIL8:st===FloatType?vt=K.DEPTH32F_STENCIL8:st===UnsignedShortType&&(vt=K.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):st===null||st===UnsignedIntType||st===UnsignedInt248Type?vt=K.DEPTH_COMPONENT24:st===FloatType?vt=K.DEPTH_COMPONENT32F:st===UnsignedShortType&&(vt=K.DEPTH_COMPONENT16),vt}function Te(ft,st){return me(ft)===!0||ft.isFramebufferTexture&&ft.minFilter!==NearestFilter&&ft.minFilter!==LinearFilter?Math.log2(Math.max(st.width,st.height))+1:ft.mipmaps!==void 0&&ft.mipmaps.length>0?ft.mipmaps.length:ft.isCompressedTexture&&Array.isArray(ft.image)?st.mipmaps.length:1}function be(ft){const st=ft.target;st.removeEventListener("dispose",be),we(st),st.isVideoTexture&&ce.delete(st)}function Re(ft){const st=ft.target;st.removeEventListener("dispose",Re),Ie(st)}function we(ft){const st=te.get(ft);if(st.__webglInit===void 0)return;const vt=ft.source,Pt=de.get(vt);if(Pt){const Lt=Pt[st.__cacheKey];Lt.usedTimes--,Lt.usedTimes===0&&Pe(ft),Object.keys(Pt).length===0&&de.delete(vt)}te.remove(ft)}function Pe(ft){const st=te.get(ft);K.deleteTexture(st.__webglTexture);const vt=ft.source,Pt=de.get(vt);delete Pt[st.__cacheKey],oe.memory.textures--}function Ie(ft){const st=te.get(ft);if(ft.depthTexture&&(ft.depthTexture.dispose(),te.remove(ft.depthTexture)),ft.isWebGLCubeRenderTarget)for(let Pt=0;Pt<6;Pt++){if(Array.isArray(st.__webglFramebuffer[Pt]))for(let Lt=0;Lt<st.__webglFramebuffer[Pt].length;Lt++)K.deleteFramebuffer(st.__webglFramebuffer[Pt][Lt]);else K.deleteFramebuffer(st.__webglFramebuffer[Pt]);st.__webglDepthbuffer&&K.deleteRenderbuffer(st.__webglDepthbuffer[Pt])}else{if(Array.isArray(st.__webglFramebuffer))for(let Pt=0;Pt<st.__webglFramebuffer.length;Pt++)K.deleteFramebuffer(st.__webglFramebuffer[Pt]);else K.deleteFramebuffer(st.__webglFramebuffer);if(st.__webglDepthbuffer&&K.deleteRenderbuffer(st.__webglDepthbuffer),st.__webglMultisampledFramebuffer&&K.deleteFramebuffer(st.__webglMultisampledFramebuffer),st.__webglColorRenderbuffer)for(let Pt=0;Pt<st.__webglColorRenderbuffer.length;Pt++)st.__webglColorRenderbuffer[Pt]&&K.deleteRenderbuffer(st.__webglColorRenderbuffer[Pt]);st.__webglDepthRenderbuffer&&K.deleteRenderbuffer(st.__webglDepthRenderbuffer)}const vt=ft.textures;for(let Pt=0,Lt=vt.length;Pt<Lt;Pt++){const Vt=te.get(vt[Pt]);Vt.__webglTexture&&(K.deleteTexture(Vt.__webglTexture),oe.memory.textures--),te.remove(vt[Pt])}te.remove(ft)}let $e=0;function Ue(){$e=0}function ke(){const ft=$e;return ft>=ne.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ft+" texture units while this GPU supports only "+ne.maxTextures),$e+=1,ft}function Ge(ft){const st=[];return st.push(ft.wrapS),st.push(ft.wrapT),st.push(ft.wrapR||0),st.push(ft.magFilter),st.push(ft.minFilter),st.push(ft.anisotropy),st.push(ft.internalFormat),st.push(ft.format),st.push(ft.type),st.push(ft.generateMipmaps),st.push(ft.premultiplyAlpha),st.push(ft.flipY),st.push(ft.unpackAlignment),st.push(ft.colorSpace),st.join()}function He(ft,st){const vt=te.get(ft);if(ft.isVideoTexture&&Mt(ft),ft.isRenderTargetTexture===!1&&ft.version>0&&vt.__version!==ft.version){const Pt=ft.image;if(Pt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Pt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{lt(vt,ft,st);return}}Z.bindTexture(K.TEXTURE_2D,vt.__webglTexture,K.TEXTURE0+st)}function ze(ft,st){const vt=te.get(ft);if(ft.version>0&&vt.__version!==ft.version){lt(vt,ft,st);return}Z.bindTexture(K.TEXTURE_2D_ARRAY,vt.__webglTexture,K.TEXTURE0+st)}function Ke(ft,st){const vt=te.get(ft);if(ft.version>0&&vt.__version!==ft.version){lt(vt,ft,st);return}Z.bindTexture(K.TEXTURE_3D,vt.__webglTexture,K.TEXTURE0+st)}function tt(ft,st){const vt=te.get(ft);if(ft.version>0&&vt.__version!==ft.version){Qe(vt,ft,st);return}Z.bindTexture(K.TEXTURE_CUBE_MAP,vt.__webglTexture,K.TEXTURE0+st)}const Je={[RepeatWrapping]:K.REPEAT,[ClampToEdgeWrapping]:K.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:K.MIRRORED_REPEAT},ot={[NearestFilter]:K.NEAREST,[NearestMipmapNearestFilter]:K.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:K.NEAREST_MIPMAP_LINEAR,[LinearFilter]:K.LINEAR,[LinearMipmapNearestFilter]:K.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:K.LINEAR_MIPMAP_LINEAR},Fe={[NeverCompare]:K.NEVER,[AlwaysCompare]:K.ALWAYS,[LessCompare]:K.LESS,[LessEqualCompare]:K.LEQUAL,[EqualCompare]:K.EQUAL,[GreaterEqualCompare]:K.GEQUAL,[GreaterCompare]:K.GREATER,[NotEqualCompare]:K.NOTEQUAL};function ct(ft,st){if(st.type===FloatType&&_.has("OES_texture_float_linear")===!1&&(st.magFilter===LinearFilter||st.magFilter===LinearMipmapNearestFilter||st.magFilter===NearestMipmapLinearFilter||st.magFilter===LinearMipmapLinearFilter||st.minFilter===LinearFilter||st.minFilter===LinearMipmapNearestFilter||st.minFilter===NearestMipmapLinearFilter||st.minFilter===LinearMipmapLinearFilter)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),K.texParameteri(ft,K.TEXTURE_WRAP_S,Je[st.wrapS]),K.texParameteri(ft,K.TEXTURE_WRAP_T,Je[st.wrapT]),(ft===K.TEXTURE_3D||ft===K.TEXTURE_2D_ARRAY)&&K.texParameteri(ft,K.TEXTURE_WRAP_R,Je[st.wrapR]),K.texParameteri(ft,K.TEXTURE_MAG_FILTER,ot[st.magFilter]),K.texParameteri(ft,K.TEXTURE_MIN_FILTER,ot[st.minFilter]),st.compareFunction&&(K.texParameteri(ft,K.TEXTURE_COMPARE_MODE,K.COMPARE_REF_TO_TEXTURE),K.texParameteri(ft,K.TEXTURE_COMPARE_FUNC,Fe[st.compareFunction])),_.has("EXT_texture_filter_anisotropic")===!0){if(st.magFilter===NearestFilter||st.minFilter!==NearestMipmapLinearFilter&&st.minFilter!==LinearMipmapLinearFilter||st.type===FloatType&&_.has("OES_texture_float_linear")===!1)return;if(st.anisotropy>1||te.get(st).__currentAnisotropy){const vt=_.get("EXT_texture_filter_anisotropic");K.texParameterf(ft,vt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(st.anisotropy,ne.getMaxAnisotropy())),te.get(st).__currentAnisotropy=st.anisotropy}}}function ht(ft,st){let vt=!1;ft.__webglInit===void 0&&(ft.__webglInit=!0,st.addEventListener("dispose",be));const Pt=st.source;let Lt=de.get(Pt);Lt===void 0&&(Lt={},de.set(Pt,Lt));const Vt=Ge(st);if(Vt!==ft.__cacheKey){Lt[Vt]===void 0&&(Lt[Vt]={texture:K.createTexture(),usedTimes:0},oe.memory.textures++,vt=!0),Lt[Vt].usedTimes++;const Le=Lt[ft.__cacheKey];Le!==void 0&&(Lt[ft.__cacheKey].usedTimes--,Le.usedTimes===0&&Pe(st)),ft.__cacheKey=Vt,ft.__webglTexture=Lt[Vt].texture}return vt}function lt(ft,st,vt){let Pt=K.TEXTURE_2D;(st.isDataArrayTexture||st.isCompressedArrayTexture)&&(Pt=K.TEXTURE_2D_ARRAY),st.isData3DTexture&&(Pt=K.TEXTURE_3D);const Lt=ht(ft,st),Vt=st.source;Z.bindTexture(Pt,ft.__webglTexture,K.TEXTURE0+vt);const Le=te.get(Vt);if(Vt.version!==Le.__version||Lt===!0){Z.activeTexture(K.TEXTURE0+vt);const De=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Be=st.colorSpace===NoColorSpace$1?null:ColorManagement.getPrimaries(st.colorSpace),rt=st.colorSpace===NoColorSpace$1||De===Be?K.NONE:K.BROWSER_DEFAULT_WEBGL;K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,st.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,st.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,st.unpackAlignment),K.pixelStorei(K.UNPACK_COLORSPACE_CONVERSION_WEBGL,rt);let at=ge(st.image,!1,ne.maxTextureSize);at=_t(st,at);const xt=ie.convert(st.format,st.colorSpace),Ct=ie.convert(st.type);let Qt=ve(st.internalFormat,xt,Ct,st.colorSpace,st.isVideoTexture);ct(Pt,st);let qt;const It=st.mipmaps,Gt=st.isVideoTexture!==!0,Jt=Le.__version===void 0||Lt===!0,kt=Vt.dataReady,Ht=Te(st,at);if(st.isDepthTexture)Qt=_e(st.format===DepthStencilFormat,st.type),Jt&&(Gt?Z.texStorage2D(K.TEXTURE_2D,1,Qt,at.width,at.height):Z.texImage2D(K.TEXTURE_2D,0,Qt,at.width,at.height,0,xt,Ct,null));else if(st.isDataTexture)if(It.length>0){Gt&&Jt&&Z.texStorage2D(K.TEXTURE_2D,Ht,Qt,It[0].width,It[0].height);for(let Yt=0,hn=It.length;Yt<hn;Yt++)qt=It[Yt],Gt?kt&&Z.texSubImage2D(K.TEXTURE_2D,Yt,0,0,qt.width,qt.height,xt,Ct,qt.data):Z.texImage2D(K.TEXTURE_2D,Yt,Qt,qt.width,qt.height,0,xt,Ct,qt.data);st.generateMipmaps=!1}else Gt?(Jt&&Z.texStorage2D(K.TEXTURE_2D,Ht,Qt,at.width,at.height),kt&&Z.texSubImage2D(K.TEXTURE_2D,0,0,0,at.width,at.height,xt,Ct,at.data)):Z.texImage2D(K.TEXTURE_2D,0,Qt,at.width,at.height,0,xt,Ct,at.data);else if(st.isCompressedTexture)if(st.isCompressedArrayTexture){Gt&&Jt&&Z.texStorage3D(K.TEXTURE_2D_ARRAY,Ht,Qt,It[0].width,It[0].height,at.depth);for(let Yt=0,hn=It.length;Yt<hn;Yt++)if(qt=It[Yt],st.format!==RGBAFormat)if(xt!==null)if(Gt){if(kt)if(st.layerUpdates.size>0){const _n=getByteLength(qt.width,qt.height,st.format,st.type);for(const xn of st.layerUpdates){const Ln=qt.data.subarray(xn*_n/qt.data.BYTES_PER_ELEMENT,(xn+1)*_n/qt.data.BYTES_PER_ELEMENT);Z.compressedTexSubImage3D(K.TEXTURE_2D_ARRAY,Yt,0,0,xn,qt.width,qt.height,1,xt,Ln)}st.clearLayerUpdates()}else Z.compressedTexSubImage3D(K.TEXTURE_2D_ARRAY,Yt,0,0,0,qt.width,qt.height,at.depth,xt,qt.data)}else Z.compressedTexImage3D(K.TEXTURE_2D_ARRAY,Yt,Qt,qt.width,qt.height,at.depth,0,qt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Gt?kt&&Z.texSubImage3D(K.TEXTURE_2D_ARRAY,Yt,0,0,0,qt.width,qt.height,at.depth,xt,Ct,qt.data):Z.texImage3D(K.TEXTURE_2D_ARRAY,Yt,Qt,qt.width,qt.height,at.depth,0,xt,Ct,qt.data)}else{Gt&&Jt&&Z.texStorage2D(K.TEXTURE_2D,Ht,Qt,It[0].width,It[0].height);for(let Yt=0,hn=It.length;Yt<hn;Yt++)qt=It[Yt],st.format!==RGBAFormat?xt!==null?Gt?kt&&Z.compressedTexSubImage2D(K.TEXTURE_2D,Yt,0,0,qt.width,qt.height,xt,qt.data):Z.compressedTexImage2D(K.TEXTURE_2D,Yt,Qt,qt.width,qt.height,0,qt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Gt?kt&&Z.texSubImage2D(K.TEXTURE_2D,Yt,0,0,qt.width,qt.height,xt,Ct,qt.data):Z.texImage2D(K.TEXTURE_2D,Yt,Qt,qt.width,qt.height,0,xt,Ct,qt.data)}else if(st.isDataArrayTexture)if(Gt){if(Jt&&Z.texStorage3D(K.TEXTURE_2D_ARRAY,Ht,Qt,at.width,at.height,at.depth),kt)if(st.layerUpdates.size>0){const Yt=getByteLength(at.width,at.height,st.format,st.type);for(const hn of st.layerUpdates){const _n=at.data.subarray(hn*Yt/at.data.BYTES_PER_ELEMENT,(hn+1)*Yt/at.data.BYTES_PER_ELEMENT);Z.texSubImage3D(K.TEXTURE_2D_ARRAY,0,0,0,hn,at.width,at.height,1,xt,Ct,_n)}st.clearLayerUpdates()}else Z.texSubImage3D(K.TEXTURE_2D_ARRAY,0,0,0,0,at.width,at.height,at.depth,xt,Ct,at.data)}else Z.texImage3D(K.TEXTURE_2D_ARRAY,0,Qt,at.width,at.height,at.depth,0,xt,Ct,at.data);else if(st.isData3DTexture)Gt?(Jt&&Z.texStorage3D(K.TEXTURE_3D,Ht,Qt,at.width,at.height,at.depth),kt&&Z.texSubImage3D(K.TEXTURE_3D,0,0,0,0,at.width,at.height,at.depth,xt,Ct,at.data)):Z.texImage3D(K.TEXTURE_3D,0,Qt,at.width,at.height,at.depth,0,xt,Ct,at.data);else if(st.isFramebufferTexture){if(Jt)if(Gt)Z.texStorage2D(K.TEXTURE_2D,Ht,Qt,at.width,at.height);else{let Yt=at.width,hn=at.height;for(let _n=0;_n<Ht;_n++)Z.texImage2D(K.TEXTURE_2D,_n,Qt,Yt,hn,0,xt,Ct,null),Yt>>=1,hn>>=1}}else if(It.length>0){if(Gt&&Jt){const Yt=pt(It[0]);Z.texStorage2D(K.TEXTURE_2D,Ht,Qt,Yt.width,Yt.height)}for(let Yt=0,hn=It.length;Yt<hn;Yt++)qt=It[Yt],Gt?kt&&Z.texSubImage2D(K.TEXTURE_2D,Yt,0,0,xt,Ct,qt):Z.texImage2D(K.TEXTURE_2D,Yt,Qt,xt,Ct,qt);st.generateMipmaps=!1}else if(Gt){if(Jt){const Yt=pt(at);Z.texStorage2D(K.TEXTURE_2D,Ht,Qt,Yt.width,Yt.height)}kt&&Z.texSubImage2D(K.TEXTURE_2D,0,0,0,xt,Ct,at)}else Z.texImage2D(K.TEXTURE_2D,0,Qt,xt,Ct,at);me(st)&&Ae(Pt),Le.__version=Vt.version,st.onUpdate&&st.onUpdate(st)}ft.__version=st.version}function Qe(ft,st,vt){if(st.image.length!==6)return;const Pt=ht(ft,st),Lt=st.source;Z.bindTexture(K.TEXTURE_CUBE_MAP,ft.__webglTexture,K.TEXTURE0+vt);const Vt=te.get(Lt);if(Lt.version!==Vt.__version||Pt===!0){Z.activeTexture(K.TEXTURE0+vt);const Le=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),De=st.colorSpace===NoColorSpace$1?null:ColorManagement.getPrimaries(st.colorSpace),Be=st.colorSpace===NoColorSpace$1||Le===De?K.NONE:K.BROWSER_DEFAULT_WEBGL;K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,st.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,st.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,st.unpackAlignment),K.pixelStorei(K.UNPACK_COLORSPACE_CONVERSION_WEBGL,Be);const rt=st.isCompressedTexture||st.image[0].isCompressedTexture,at=st.image[0]&&st.image[0].isDataTexture,xt=[];for(let hn=0;hn<6;hn++)!rt&&!at?xt[hn]=ge(st.image[hn],!0,ne.maxCubemapSize):xt[hn]=at?st.image[hn].image:st.image[hn],xt[hn]=_t(st,xt[hn]);const Ct=xt[0],Qt=ie.convert(st.format,st.colorSpace),qt=ie.convert(st.type),It=ve(st.internalFormat,Qt,qt,st.colorSpace),Gt=st.isVideoTexture!==!0,Jt=Vt.__version===void 0||Pt===!0,kt=Lt.dataReady;let Ht=Te(st,Ct);ct(K.TEXTURE_CUBE_MAP,st);let Yt;if(rt){Gt&&Jt&&Z.texStorage2D(K.TEXTURE_CUBE_MAP,Ht,It,Ct.width,Ct.height);for(let hn=0;hn<6;hn++){Yt=xt[hn].mipmaps;for(let _n=0;_n<Yt.length;_n++){const xn=Yt[_n];st.format!==RGBAFormat?Qt!==null?Gt?kt&&Z.compressedTexSubImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n,0,0,xn.width,xn.height,Qt,xn.data):Z.compressedTexImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n,It,xn.width,xn.height,0,xn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Gt?kt&&Z.texSubImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n,0,0,xn.width,xn.height,Qt,qt,xn.data):Z.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n,It,xn.width,xn.height,0,Qt,qt,xn.data)}}}else{if(Yt=st.mipmaps,Gt&&Jt){Yt.length>0&&Ht++;const hn=pt(xt[0]);Z.texStorage2D(K.TEXTURE_CUBE_MAP,Ht,It,hn.width,hn.height)}for(let hn=0;hn<6;hn++)if(at){Gt?kt&&Z.texSubImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,0,0,xt[hn].width,xt[hn].height,Qt,qt,xt[hn].data):Z.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,It,xt[hn].width,xt[hn].height,0,Qt,qt,xt[hn].data);for(let _n=0;_n<Yt.length;_n++){const Ln=Yt[_n].image[hn].image;Gt?kt&&Z.texSubImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n+1,0,0,Ln.width,Ln.height,Qt,qt,Ln.data):Z.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n+1,It,Ln.width,Ln.height,0,Qt,qt,Ln.data)}}else{Gt?kt&&Z.texSubImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,0,0,Qt,qt,xt[hn]):Z.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,0,It,Qt,qt,xt[hn]);for(let _n=0;_n<Yt.length;_n++){const xn=Yt[_n];Gt?kt&&Z.texSubImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n+1,0,0,Qt,qt,xn.image[hn]):Z.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+hn,_n+1,It,Qt,qt,xn.image[hn])}}}me(st)&&Ae(K.TEXTURE_CUBE_MAP),Vt.__version=Lt.version,st.onUpdate&&st.onUpdate(st)}ft.__version=st.version}function Ze(ft,st,vt,Pt,Lt,Vt){const Le=ie.convert(vt.format,vt.colorSpace),De=ie.convert(vt.type),Be=ve(vt.internalFormat,Le,De,vt.colorSpace),rt=te.get(st),at=te.get(vt);if(at.__renderTarget=st,!rt.__hasExternalTextures){const xt=Math.max(1,st.width>>Vt),Ct=Math.max(1,st.height>>Vt);Lt===K.TEXTURE_3D||Lt===K.TEXTURE_2D_ARRAY?Z.texImage3D(Lt,Vt,Be,xt,Ct,st.depth,0,Le,De,null):Z.texImage2D(Lt,Vt,Be,xt,Ct,0,Le,De,null)}Z.bindFramebuffer(K.FRAMEBUFFER,ft),Ot(st)?se.framebufferTexture2DMultisampleEXT(K.FRAMEBUFFER,Pt,Lt,at.__webglTexture,0,bt(st)):(Lt===K.TEXTURE_2D||Lt>=K.TEXTURE_CUBE_MAP_POSITIVE_X&&Lt<=K.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&K.framebufferTexture2D(K.FRAMEBUFFER,Pt,Lt,at.__webglTexture,Vt),Z.bindFramebuffer(K.FRAMEBUFFER,null)}function it(ft,st,vt){if(K.bindRenderbuffer(K.RENDERBUFFER,ft),st.depthBuffer){const Pt=st.depthTexture,Lt=Pt&&Pt.isDepthTexture?Pt.type:null,Vt=_e(st.stencilBuffer,Lt),Le=st.stencilBuffer?K.DEPTH_STENCIL_ATTACHMENT:K.DEPTH_ATTACHMENT,De=bt(st);Ot(st)?se.renderbufferStorageMultisampleEXT(K.RENDERBUFFER,De,Vt,st.width,st.height):vt?K.renderbufferStorageMultisample(K.RENDERBUFFER,De,Vt,st.width,st.height):K.renderbufferStorage(K.RENDERBUFFER,Vt,st.width,st.height),K.framebufferRenderbuffer(K.FRAMEBUFFER,Le,K.RENDERBUFFER,ft)}else{const Pt=st.textures;for(let Lt=0;Lt<Pt.length;Lt++){const Vt=Pt[Lt],Le=ie.convert(Vt.format,Vt.colorSpace),De=ie.convert(Vt.type),Be=ve(Vt.internalFormat,Le,De,Vt.colorSpace),rt=bt(st);vt&&Ot(st)===!1?K.renderbufferStorageMultisample(K.RENDERBUFFER,rt,Be,st.width,st.height):Ot(st)?se.renderbufferStorageMultisampleEXT(K.RENDERBUFFER,rt,Be,st.width,st.height):K.renderbufferStorage(K.RENDERBUFFER,Be,st.width,st.height)}}K.bindRenderbuffer(K.RENDERBUFFER,null)}function nt(ft,st){if(st&&st.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(Z.bindFramebuffer(K.FRAMEBUFFER,ft),!(st.depthTexture&&st.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Pt=te.get(st.depthTexture);Pt.__renderTarget=st,(!Pt.__webglTexture||st.depthTexture.image.width!==st.width||st.depthTexture.image.height!==st.height)&&(st.depthTexture.image.width=st.width,st.depthTexture.image.height=st.height,st.depthTexture.needsUpdate=!0),He(st.depthTexture,0);const Lt=Pt.__webglTexture,Vt=bt(st);if(st.depthTexture.format===DepthFormat)Ot(st)?se.framebufferTexture2DMultisampleEXT(K.FRAMEBUFFER,K.DEPTH_ATTACHMENT,K.TEXTURE_2D,Lt,0,Vt):K.framebufferTexture2D(K.FRAMEBUFFER,K.DEPTH_ATTACHMENT,K.TEXTURE_2D,Lt,0);else if(st.depthTexture.format===DepthStencilFormat)Ot(st)?se.framebufferTexture2DMultisampleEXT(K.FRAMEBUFFER,K.DEPTH_STENCIL_ATTACHMENT,K.TEXTURE_2D,Lt,0,Vt):K.framebufferTexture2D(K.FRAMEBUFFER,K.DEPTH_STENCIL_ATTACHMENT,K.TEXTURE_2D,Lt,0);else throw new Error("Unknown depthTexture format")}function Tt(ft){const st=te.get(ft),vt=ft.isWebGLCubeRenderTarget===!0;if(st.__boundDepthTexture!==ft.depthTexture){const Pt=ft.depthTexture;if(st.__depthDisposeCallback&&st.__depthDisposeCallback(),Pt){const Lt=()=>{delete st.__boundDepthTexture,delete st.__depthDisposeCallback,Pt.removeEventListener("dispose",Lt)};Pt.addEventListener("dispose",Lt),st.__depthDisposeCallback=Lt}st.__boundDepthTexture=Pt}if(ft.depthTexture&&!st.__autoAllocateDepthBuffer){if(vt)throw new Error("target.depthTexture not supported in Cube render targets");nt(st.__webglFramebuffer,ft)}else if(vt){st.__webglDepthbuffer=[];for(let Pt=0;Pt<6;Pt++)if(Z.bindFramebuffer(K.FRAMEBUFFER,st.__webglFramebuffer[Pt]),st.__webglDepthbuffer[Pt]===void 0)st.__webglDepthbuffer[Pt]=K.createRenderbuffer(),it(st.__webglDepthbuffer[Pt],ft,!1);else{const Lt=ft.stencilBuffer?K.DEPTH_STENCIL_ATTACHMENT:K.DEPTH_ATTACHMENT,Vt=st.__webglDepthbuffer[Pt];K.bindRenderbuffer(K.RENDERBUFFER,Vt),K.framebufferRenderbuffer(K.FRAMEBUFFER,Lt,K.RENDERBUFFER,Vt)}}else if(Z.bindFramebuffer(K.FRAMEBUFFER,st.__webglFramebuffer),st.__webglDepthbuffer===void 0)st.__webglDepthbuffer=K.createRenderbuffer(),it(st.__webglDepthbuffer,ft,!1);else{const Pt=ft.stencilBuffer?K.DEPTH_STENCIL_ATTACHMENT:K.DEPTH_ATTACHMENT,Lt=st.__webglDepthbuffer;K.bindRenderbuffer(K.RENDERBUFFER,Lt),K.framebufferRenderbuffer(K.FRAMEBUFFER,Pt,K.RENDERBUFFER,Lt)}Z.bindFramebuffer(K.FRAMEBUFFER,null)}function St(ft,st,vt){const Pt=te.get(ft);st!==void 0&&Ze(Pt.__webglFramebuffer,ft,ft.texture,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,0),vt!==void 0&&Tt(ft)}function Et(ft){const st=ft.texture,vt=te.get(ft),Pt=te.get(st);ft.addEventListener("dispose",Re);const Lt=ft.textures,Vt=ft.isWebGLCubeRenderTarget===!0,Le=Lt.length>1;if(Le||(Pt.__webglTexture===void 0&&(Pt.__webglTexture=K.createTexture()),Pt.__version=st.version,oe.memory.textures++),Vt){vt.__webglFramebuffer=[];for(let De=0;De<6;De++)if(st.mipmaps&&st.mipmaps.length>0){vt.__webglFramebuffer[De]=[];for(let Be=0;Be<st.mipmaps.length;Be++)vt.__webglFramebuffer[De][Be]=K.createFramebuffer()}else vt.__webglFramebuffer[De]=K.createFramebuffer()}else{if(st.mipmaps&&st.mipmaps.length>0){vt.__webglFramebuffer=[];for(let De=0;De<st.mipmaps.length;De++)vt.__webglFramebuffer[De]=K.createFramebuffer()}else vt.__webglFramebuffer=K.createFramebuffer();if(Le)for(let De=0,Be=Lt.length;De<Be;De++){const rt=te.get(Lt[De]);rt.__webglTexture===void 0&&(rt.__webglTexture=K.createTexture(),oe.memory.textures++)}if(ft.samples>0&&Ot(ft)===!1){vt.__webglMultisampledFramebuffer=K.createFramebuffer(),vt.__webglColorRenderbuffer=[],Z.bindFramebuffer(K.FRAMEBUFFER,vt.__webglMultisampledFramebuffer);for(let De=0;De<Lt.length;De++){const Be=Lt[De];vt.__webglColorRenderbuffer[De]=K.createRenderbuffer(),K.bindRenderbuffer(K.RENDERBUFFER,vt.__webglColorRenderbuffer[De]);const rt=ie.convert(Be.format,Be.colorSpace),at=ie.convert(Be.type),xt=ve(Be.internalFormat,rt,at,Be.colorSpace,ft.isXRRenderTarget===!0),Ct=bt(ft);K.renderbufferStorageMultisample(K.RENDERBUFFER,Ct,xt,ft.width,ft.height),K.framebufferRenderbuffer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0+De,K.RENDERBUFFER,vt.__webglColorRenderbuffer[De])}K.bindRenderbuffer(K.RENDERBUFFER,null),ft.depthBuffer&&(vt.__webglDepthRenderbuffer=K.createRenderbuffer(),it(vt.__webglDepthRenderbuffer,ft,!0)),Z.bindFramebuffer(K.FRAMEBUFFER,null)}}if(Vt){Z.bindTexture(K.TEXTURE_CUBE_MAP,Pt.__webglTexture),ct(K.TEXTURE_CUBE_MAP,st);for(let De=0;De<6;De++)if(st.mipmaps&&st.mipmaps.length>0)for(let Be=0;Be<st.mipmaps.length;Be++)Ze(vt.__webglFramebuffer[De][Be],ft,st,K.COLOR_ATTACHMENT0,K.TEXTURE_CUBE_MAP_POSITIVE_X+De,Be);else Ze(vt.__webglFramebuffer[De],ft,st,K.COLOR_ATTACHMENT0,K.TEXTURE_CUBE_MAP_POSITIVE_X+De,0);me(st)&&Ae(K.TEXTURE_CUBE_MAP),Z.unbindTexture()}else if(Le){for(let De=0,Be=Lt.length;De<Be;De++){const rt=Lt[De],at=te.get(rt);Z.bindTexture(K.TEXTURE_2D,at.__webglTexture),ct(K.TEXTURE_2D,rt),Ze(vt.__webglFramebuffer,ft,rt,K.COLOR_ATTACHMENT0+De,K.TEXTURE_2D,0),me(rt)&&Ae(K.TEXTURE_2D)}Z.unbindTexture()}else{let De=K.TEXTURE_2D;if((ft.isWebGL3DRenderTarget||ft.isWebGLArrayRenderTarget)&&(De=ft.isWebGL3DRenderTarget?K.TEXTURE_3D:K.TEXTURE_2D_ARRAY),Z.bindTexture(De,Pt.__webglTexture),ct(De,st),st.mipmaps&&st.mipmaps.length>0)for(let Be=0;Be<st.mipmaps.length;Be++)Ze(vt.__webglFramebuffer[Be],ft,st,K.COLOR_ATTACHMENT0,De,Be);else Ze(vt.__webglFramebuffer,ft,st,K.COLOR_ATTACHMENT0,De,0);me(st)&&Ae(De),Z.unbindTexture()}ft.depthBuffer&&Tt(ft)}function Nt(ft){const st=ft.textures;for(let vt=0,Pt=st.length;vt<Pt;vt++){const Lt=st[vt];if(me(Lt)){const Vt=ye(ft),Le=te.get(Lt).__webglTexture;Z.bindTexture(Vt,Le),Ae(Vt),Z.unbindTexture()}}}const zt=[],yt=[];function Ut(ft){if(ft.samples>0){if(Ot(ft)===!1){const st=ft.textures,vt=ft.width,Pt=ft.height;let Lt=K.COLOR_BUFFER_BIT;const Vt=ft.stencilBuffer?K.DEPTH_STENCIL_ATTACHMENT:K.DEPTH_ATTACHMENT,Le=te.get(ft),De=st.length>1;if(De)for(let Be=0;Be<st.length;Be++)Z.bindFramebuffer(K.FRAMEBUFFER,Le.__webglMultisampledFramebuffer),K.framebufferRenderbuffer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0+Be,K.RENDERBUFFER,null),Z.bindFramebuffer(K.FRAMEBUFFER,Le.__webglFramebuffer),K.framebufferTexture2D(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0+Be,K.TEXTURE_2D,null,0);Z.bindFramebuffer(K.READ_FRAMEBUFFER,Le.__webglMultisampledFramebuffer),Z.bindFramebuffer(K.DRAW_FRAMEBUFFER,Le.__webglFramebuffer);for(let Be=0;Be<st.length;Be++){if(ft.resolveDepthBuffer&&(ft.depthBuffer&&(Lt|=K.DEPTH_BUFFER_BIT),ft.stencilBuffer&&ft.resolveStencilBuffer&&(Lt|=K.STENCIL_BUFFER_BIT)),De){K.framebufferRenderbuffer(K.READ_FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.RENDERBUFFER,Le.__webglColorRenderbuffer[Be]);const rt=te.get(st[Be]).__webglTexture;K.framebufferTexture2D(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,rt,0)}K.blitFramebuffer(0,0,vt,Pt,0,0,vt,Pt,Lt,K.NEAREST),ae===!0&&(zt.length=0,yt.length=0,zt.push(K.COLOR_ATTACHMENT0+Be),ft.depthBuffer&&ft.resolveDepthBuffer===!1&&(zt.push(Vt),yt.push(Vt),K.invalidateFramebuffer(K.DRAW_FRAMEBUFFER,yt)),K.invalidateFramebuffer(K.READ_FRAMEBUFFER,zt))}if(Z.bindFramebuffer(K.READ_FRAMEBUFFER,null),Z.bindFramebuffer(K.DRAW_FRAMEBUFFER,null),De)for(let Be=0;Be<st.length;Be++){Z.bindFramebuffer(K.FRAMEBUFFER,Le.__webglMultisampledFramebuffer),K.framebufferRenderbuffer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0+Be,K.RENDERBUFFER,Le.__webglColorRenderbuffer[Be]);const rt=te.get(st[Be]).__webglTexture;Z.bindFramebuffer(K.FRAMEBUFFER,Le.__webglFramebuffer),K.framebufferTexture2D(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0+Be,K.TEXTURE_2D,rt,0)}Z.bindFramebuffer(K.DRAW_FRAMEBUFFER,Le.__webglMultisampledFramebuffer)}else if(ft.depthBuffer&&ft.resolveDepthBuffer===!1&&ae){const st=ft.stencilBuffer?K.DEPTH_STENCIL_ATTACHMENT:K.DEPTH_ATTACHMENT;K.invalidateFramebuffer(K.DRAW_FRAMEBUFFER,[st])}}}function bt(ft){return Math.min(ne.maxSamples,ft.samples)}function Ot(ft){const st=te.get(ft);return ft.samples>0&&_.has("WEBGL_multisampled_render_to_texture")===!0&&st.__useRenderToTexture!==!1}function Mt(ft){const st=oe.render.frame;ce.get(ft)!==st&&(ce.set(ft,st),ft.update())}function _t(ft,st){const vt=ft.colorSpace,Pt=ft.format,Lt=ft.type;return ft.isCompressedTexture===!0||ft.isVideoTexture===!0||vt!==LinearSRGBColorSpace$2&&vt!==NoColorSpace$1&&(ColorManagement.getTransfer(vt)===SRGBTransfer?(Pt!==RGBAFormat||Lt!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",vt)),st}function pt(ft){return typeof HTMLImageElement<"u"&&ft instanceof HTMLImageElement?(le.width=ft.naturalWidth||ft.width,le.height=ft.naturalHeight||ft.height):typeof VideoFrame<"u"&&ft instanceof VideoFrame?(le.width=ft.displayWidth,le.height=ft.displayHeight):(le.width=ft.width,le.height=ft.height),le}this.allocateTextureUnit=ke,this.resetTextureUnits=Ue,this.setTexture2D=He,this.setTexture2DArray=ze,this.setTexture3D=Ke,this.setTextureCube=tt,this.rebindTextures=St,this.setupRenderTarget=Et,this.updateRenderTargetMipmap=Nt,this.updateMultisampleRenderTarget=Ut,this.setupDepthRenderbuffer=Tt,this.setupFrameBufferTexture=Ze,this.useMultisampledRTT=Ot}function WebGLUtils(K,_){function Z(te,ne=NoColorSpace$1){let ie;const oe=ColorManagement.getTransfer(ne);if(te===UnsignedByteType)return K.UNSIGNED_BYTE;if(te===UnsignedShort4444Type)return K.UNSIGNED_SHORT_4_4_4_4;if(te===UnsignedShort5551Type)return K.UNSIGNED_SHORT_5_5_5_1;if(te===UnsignedInt5999Type)return K.UNSIGNED_INT_5_9_9_9_REV;if(te===ByteType)return K.BYTE;if(te===ShortType)return K.SHORT;if(te===UnsignedShortType)return K.UNSIGNED_SHORT;if(te===IntType)return K.INT;if(te===UnsignedIntType)return K.UNSIGNED_INT;if(te===FloatType)return K.FLOAT;if(te===HalfFloatType)return K.HALF_FLOAT;if(te===AlphaFormat)return K.ALPHA;if(te===RGBFormat)return K.RGB;if(te===RGBAFormat)return K.RGBA;if(te===LuminanceFormat)return K.LUMINANCE;if(te===LuminanceAlphaFormat)return K.LUMINANCE_ALPHA;if(te===DepthFormat)return K.DEPTH_COMPONENT;if(te===DepthStencilFormat)return K.DEPTH_STENCIL;if(te===RedFormat)return K.RED;if(te===RedIntegerFormat)return K.RED_INTEGER;if(te===RGFormat)return K.RG;if(te===RGIntegerFormat)return K.RG_INTEGER;if(te===RGBAIntegerFormat)return K.RGBA_INTEGER;if(te===RGB_S3TC_DXT1_Format||te===RGBA_S3TC_DXT1_Format||te===RGBA_S3TC_DXT3_Format||te===RGBA_S3TC_DXT5_Format)if(oe===SRGBTransfer)if(ie=_.get("WEBGL_compressed_texture_s3tc_srgb"),ie!==null){if(te===RGB_S3TC_DXT1_Format)return ie.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(te===RGBA_S3TC_DXT1_Format)return ie.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(te===RGBA_S3TC_DXT3_Format)return ie.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(te===RGBA_S3TC_DXT5_Format)return ie.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(ie=_.get("WEBGL_compressed_texture_s3tc"),ie!==null){if(te===RGB_S3TC_DXT1_Format)return ie.COMPRESSED_RGB_S3TC_DXT1_EXT;if(te===RGBA_S3TC_DXT1_Format)return ie.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(te===RGBA_S3TC_DXT3_Format)return ie.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(te===RGBA_S3TC_DXT5_Format)return ie.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(te===RGB_PVRTC_4BPPV1_Format||te===RGB_PVRTC_2BPPV1_Format||te===RGBA_PVRTC_4BPPV1_Format||te===RGBA_PVRTC_2BPPV1_Format)if(ie=_.get("WEBGL_compressed_texture_pvrtc"),ie!==null){if(te===RGB_PVRTC_4BPPV1_Format)return ie.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(te===RGB_PVRTC_2BPPV1_Format)return ie.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(te===RGBA_PVRTC_4BPPV1_Format)return ie.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(te===RGBA_PVRTC_2BPPV1_Format)return ie.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(te===RGB_ETC1_Format||te===RGB_ETC2_Format||te===RGBA_ETC2_EAC_Format)if(ie=_.get("WEBGL_compressed_texture_etc"),ie!==null){if(te===RGB_ETC1_Format||te===RGB_ETC2_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ETC2:ie.COMPRESSED_RGB8_ETC2;if(te===RGBA_ETC2_EAC_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:ie.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(te===RGBA_ASTC_4x4_Format||te===RGBA_ASTC_5x4_Format||te===RGBA_ASTC_5x5_Format||te===RGBA_ASTC_6x5_Format||te===RGBA_ASTC_6x6_Format||te===RGBA_ASTC_8x5_Format||te===RGBA_ASTC_8x6_Format||te===RGBA_ASTC_8x8_Format||te===RGBA_ASTC_10x5_Format||te===RGBA_ASTC_10x6_Format||te===RGBA_ASTC_10x8_Format||te===RGBA_ASTC_10x10_Format||te===RGBA_ASTC_12x10_Format||te===RGBA_ASTC_12x12_Format)if(ie=_.get("WEBGL_compressed_texture_astc"),ie!==null){if(te===RGBA_ASTC_4x4_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:ie.COMPRESSED_RGBA_ASTC_4x4_KHR;if(te===RGBA_ASTC_5x4_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:ie.COMPRESSED_RGBA_ASTC_5x4_KHR;if(te===RGBA_ASTC_5x5_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:ie.COMPRESSED_RGBA_ASTC_5x5_KHR;if(te===RGBA_ASTC_6x5_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:ie.COMPRESSED_RGBA_ASTC_6x5_KHR;if(te===RGBA_ASTC_6x6_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:ie.COMPRESSED_RGBA_ASTC_6x6_KHR;if(te===RGBA_ASTC_8x5_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:ie.COMPRESSED_RGBA_ASTC_8x5_KHR;if(te===RGBA_ASTC_8x6_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:ie.COMPRESSED_RGBA_ASTC_8x6_KHR;if(te===RGBA_ASTC_8x8_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:ie.COMPRESSED_RGBA_ASTC_8x8_KHR;if(te===RGBA_ASTC_10x5_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:ie.COMPRESSED_RGBA_ASTC_10x5_KHR;if(te===RGBA_ASTC_10x6_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:ie.COMPRESSED_RGBA_ASTC_10x6_KHR;if(te===RGBA_ASTC_10x8_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:ie.COMPRESSED_RGBA_ASTC_10x8_KHR;if(te===RGBA_ASTC_10x10_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:ie.COMPRESSED_RGBA_ASTC_10x10_KHR;if(te===RGBA_ASTC_12x10_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:ie.COMPRESSED_RGBA_ASTC_12x10_KHR;if(te===RGBA_ASTC_12x12_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:ie.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(te===RGBA_BPTC_Format||te===RGB_BPTC_SIGNED_Format||te===RGB_BPTC_UNSIGNED_Format)if(ie=_.get("EXT_texture_compression_bptc"),ie!==null){if(te===RGBA_BPTC_Format)return oe===SRGBTransfer?ie.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:ie.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(te===RGB_BPTC_SIGNED_Format)return ie.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(te===RGB_BPTC_UNSIGNED_Format)return ie.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(te===RED_RGTC1_Format||te===SIGNED_RED_RGTC1_Format||te===RED_GREEN_RGTC2_Format||te===SIGNED_RED_GREEN_RGTC2_Format)if(ie=_.get("EXT_texture_compression_rgtc"),ie!==null){if(te===RGBA_BPTC_Format)return ie.COMPRESSED_RED_RGTC1_EXT;if(te===SIGNED_RED_RGTC1_Format)return ie.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(te===RED_GREEN_RGTC2_Format)return ie.COMPRESSED_RED_GREEN_RGTC2_EXT;if(te===SIGNED_RED_GREEN_RGTC2_Format)return ie.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return te===UnsignedInt248Type?K.UNSIGNED_INT_24_8:K[te]!==void 0?K[te]:null}return{convert:Z}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(_,Z,te){if(this.texture===null){const ne=new Texture$1,ie=_.properties.get(ne);ie.__webglTexture=Z.texture,(Z.depthNear!==te.depthNear||Z.depthFar!==te.depthFar)&&(this.depthNear=Z.depthNear,this.depthFar=Z.depthFar),this.texture=ne}}getMesh(_){if(this.texture!==null&&this.mesh===null){const Z=_.cameras[0].viewport,te=new ShaderMaterial({vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:Z.z},depthHeight:{value:Z.w}}});this.mesh=new Mesh(new PlaneGeometry(20,20),te)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class WebXRManager extends EventDispatcher$1{constructor(_,Z){super();const te=this;let ne=null,ie=1,oe=null,se="local-floor",ae=1,le=null,ce=null,fe=null,de=null,pe=null,he=null;const ge=new WebXRDepthSensing,me=Z.getContextAttributes();let Ae=null,ye=null;const ve=[],_e=[],Te=new Vector2;let be=null;const Re=new PerspectiveCamera$2;Re.viewport=new Vector4;const we=new PerspectiveCamera$2;we.viewport=new Vector4;const Pe=[Re,we],Ie=new ArrayCamera;let $e=null,Ue=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(lt){let Qe=ve[lt];return Qe===void 0&&(Qe=new WebXRController,ve[lt]=Qe),Qe.getTargetRaySpace()},this.getControllerGrip=function(lt){let Qe=ve[lt];return Qe===void 0&&(Qe=new WebXRController,ve[lt]=Qe),Qe.getGripSpace()},this.getHand=function(lt){let Qe=ve[lt];return Qe===void 0&&(Qe=new WebXRController,ve[lt]=Qe),Qe.getHandSpace()};function ke(lt){const Qe=_e.indexOf(lt.inputSource);if(Qe===-1)return;const Ze=ve[Qe];Ze!==void 0&&(Ze.update(lt.inputSource,lt.frame,le||oe),Ze.dispatchEvent({type:lt.type,data:lt.inputSource}))}function Ge(){ne.removeEventListener("select",ke),ne.removeEventListener("selectstart",ke),ne.removeEventListener("selectend",ke),ne.removeEventListener("squeeze",ke),ne.removeEventListener("squeezestart",ke),ne.removeEventListener("squeezeend",ke),ne.removeEventListener("end",Ge),ne.removeEventListener("inputsourceschange",He);for(let lt=0;lt<ve.length;lt++){const Qe=_e[lt];Qe!==null&&(_e[lt]=null,ve[lt].disconnect(Qe))}$e=null,Ue=null,ge.reset(),_.setRenderTarget(Ae),pe=null,de=null,fe=null,ne=null,ye=null,ht.stop(),te.isPresenting=!1,_.setPixelRatio(be),_.setSize(Te.width,Te.height,!1),te.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(lt){ie=lt,te.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(lt){se=lt,te.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return le||oe},this.setReferenceSpace=function(lt){le=lt},this.getBaseLayer=function(){return de!==null?de:pe},this.getBinding=function(){return fe},this.getFrame=function(){return he},this.getSession=function(){return ne},this.setSession=async function(lt){if(ne=lt,ne!==null){if(Ae=_.getRenderTarget(),ne.addEventListener("select",ke),ne.addEventListener("selectstart",ke),ne.addEventListener("selectend",ke),ne.addEventListener("squeeze",ke),ne.addEventListener("squeezestart",ke),ne.addEventListener("squeezeend",ke),ne.addEventListener("end",Ge),ne.addEventListener("inputsourceschange",He),me.xrCompatible!==!0&&await Z.makeXRCompatible(),be=_.getPixelRatio(),_.getSize(Te),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ze=null,it=null,nt=null;me.depth&&(nt=me.stencil?Z.DEPTH24_STENCIL8:Z.DEPTH_COMPONENT24,Ze=me.stencil?DepthStencilFormat:DepthFormat,it=me.stencil?UnsignedInt248Type:UnsignedIntType);const Tt={colorFormat:Z.RGBA8,depthFormat:nt,scaleFactor:ie};fe=new XRWebGLBinding(ne,Z),de=fe.createProjectionLayer(Tt),ne.updateRenderState({layers:[de]}),_.setPixelRatio(1),_.setSize(de.textureWidth,de.textureHeight,!1),ye=new WebGLRenderTarget(de.textureWidth,de.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(de.textureWidth,de.textureHeight,it,void 0,void 0,void 0,void 0,void 0,void 0,Ze),stencilBuffer:me.stencil,colorSpace:_.outputColorSpace,samples:me.antialias?4:0,resolveDepthBuffer:de.ignoreDepthValues===!1,resolveStencilBuffer:de.ignoreDepthValues===!1})}else{const Ze={antialias:me.antialias,alpha:!0,depth:me.depth,stencil:me.stencil,framebufferScaleFactor:ie};pe=new XRWebGLLayer(ne,Z,Ze),ne.updateRenderState({baseLayer:pe}),_.setPixelRatio(1),_.setSize(pe.framebufferWidth,pe.framebufferHeight,!1),ye=new WebGLRenderTarget(pe.framebufferWidth,pe.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:_.outputColorSpace,stencilBuffer:me.stencil,resolveDepthBuffer:pe.ignoreDepthValues===!1,resolveStencilBuffer:pe.ignoreDepthValues===!1})}ye.isXRRenderTarget=!0,this.setFoveation(ae),le=null,oe=await ne.requestReferenceSpace(se),ht.setContext(ne),ht.start(),te.isPresenting=!0,te.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(ne!==null)return ne.environmentBlendMode},this.getDepthTexture=function(){return ge.getDepthTexture()};function He(lt){for(let Qe=0;Qe<lt.removed.length;Qe++){const Ze=lt.removed[Qe],it=_e.indexOf(Ze);it>=0&&(_e[it]=null,ve[it].disconnect(Ze))}for(let Qe=0;Qe<lt.added.length;Qe++){const Ze=lt.added[Qe];let it=_e.indexOf(Ze);if(it===-1){for(let Tt=0;Tt<ve.length;Tt++)if(Tt>=_e.length){_e.push(Ze),it=Tt;break}else if(_e[Tt]===null){_e[Tt]=Ze,it=Tt;break}if(it===-1)break}const nt=ve[it];nt&&nt.connect(Ze)}}const ze=new Vector3,Ke=new Vector3;function tt(lt,Qe,Ze){ze.setFromMatrixPosition(Qe.matrixWorld),Ke.setFromMatrixPosition(Ze.matrixWorld);const it=ze.distanceTo(Ke),nt=Qe.projectionMatrix.elements,Tt=Ze.projectionMatrix.elements,St=nt[14]/(nt[10]-1),Et=nt[14]/(nt[10]+1),Nt=(nt[9]+1)/nt[5],zt=(nt[9]-1)/nt[5],yt=(nt[8]-1)/nt[0],Ut=(Tt[8]+1)/Tt[0],bt=St*yt,Ot=St*Ut,Mt=it/(-yt+Ut),_t=Mt*-yt;if(Qe.matrixWorld.decompose(lt.position,lt.quaternion,lt.scale),lt.translateX(_t),lt.translateZ(Mt),lt.matrixWorld.compose(lt.position,lt.quaternion,lt.scale),lt.matrixWorldInverse.copy(lt.matrixWorld).invert(),nt[10]===-1)lt.projectionMatrix.copy(Qe.projectionMatrix),lt.projectionMatrixInverse.copy(Qe.projectionMatrixInverse);else{const pt=St+Mt,ft=Et+Mt,st=bt-_t,vt=Ot+(it-_t),Pt=Nt*Et/ft*pt,Lt=zt*Et/ft*pt;lt.projectionMatrix.makePerspective(st,vt,Pt,Lt,pt,ft),lt.projectionMatrixInverse.copy(lt.projectionMatrix).invert()}}function Je(lt,Qe){Qe===null?lt.matrixWorld.copy(lt.matrix):lt.matrixWorld.multiplyMatrices(Qe.matrixWorld,lt.matrix),lt.matrixWorldInverse.copy(lt.matrixWorld).invert()}this.updateCamera=function(lt){if(ne===null)return;let Qe=lt.near,Ze=lt.far;ge.texture!==null&&(ge.depthNear>0&&(Qe=ge.depthNear),ge.depthFar>0&&(Ze=ge.depthFar)),Ie.near=we.near=Re.near=Qe,Ie.far=we.far=Re.far=Ze,($e!==Ie.near||Ue!==Ie.far)&&(ne.updateRenderState({depthNear:Ie.near,depthFar:Ie.far}),$e=Ie.near,Ue=Ie.far),Re.layers.mask=lt.layers.mask|2,we.layers.mask=lt.layers.mask|4,Ie.layers.mask=Re.layers.mask|we.layers.mask;const it=lt.parent,nt=Ie.cameras;Je(Ie,it);for(let Tt=0;Tt<nt.length;Tt++)Je(nt[Tt],it);nt.length===2?tt(Ie,Re,we):Ie.projectionMatrix.copy(Re.projectionMatrix),ot(lt,Ie,it)};function ot(lt,Qe,Ze){Ze===null?lt.matrix.copy(Qe.matrixWorld):(lt.matrix.copy(Ze.matrixWorld),lt.matrix.invert(),lt.matrix.multiply(Qe.matrixWorld)),lt.matrix.decompose(lt.position,lt.quaternion,lt.scale),lt.updateMatrixWorld(!0),lt.projectionMatrix.copy(Qe.projectionMatrix),lt.projectionMatrixInverse.copy(Qe.projectionMatrixInverse),lt.isPerspectiveCamera&&(lt.fov=RAD2DEG*2*Math.atan(1/lt.projectionMatrix.elements[5]),lt.zoom=1)}this.getCamera=function(){return Ie},this.getFoveation=function(){if(!(de===null&&pe===null))return ae},this.setFoveation=function(lt){ae=lt,de!==null&&(de.fixedFoveation=lt),pe!==null&&pe.fixedFoveation!==void 0&&(pe.fixedFoveation=lt)},this.hasDepthSensing=function(){return ge.texture!==null},this.getDepthSensingMesh=function(){return ge.getMesh(Ie)};let Fe=null;function ct(lt,Qe){if(ce=Qe.getViewerPose(le||oe),he=Qe,ce!==null){const Ze=ce.views;pe!==null&&(_.setRenderTargetFramebuffer(ye,pe.framebuffer),_.setRenderTarget(ye));let it=!1;Ze.length!==Ie.cameras.length&&(Ie.cameras.length=0,it=!0);for(let St=0;St<Ze.length;St++){const Et=Ze[St];let Nt=null;if(pe!==null)Nt=pe.getViewport(Et);else{const yt=fe.getViewSubImage(de,Et);Nt=yt.viewport,St===0&&(_.setRenderTargetTextures(ye,yt.colorTexture,yt.depthStencilTexture),_.setRenderTarget(ye))}let zt=Pe[St];zt===void 0&&(zt=new PerspectiveCamera$2,zt.layers.enable(St),zt.viewport=new Vector4,Pe[St]=zt),zt.matrix.fromArray(Et.transform.matrix),zt.matrix.decompose(zt.position,zt.quaternion,zt.scale),zt.projectionMatrix.fromArray(Et.projectionMatrix),zt.projectionMatrixInverse.copy(zt.projectionMatrix).invert(),zt.viewport.set(Nt.x,Nt.y,Nt.width,Nt.height),St===0&&(Ie.matrix.copy(zt.matrix),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale)),it===!0&&Ie.cameras.push(zt)}const nt=ne.enabledFeatures;if(nt&&nt.includes("depth-sensing")&&ne.depthUsage=="gpu-optimized"&&fe){const St=fe.getDepthInformation(Ze[0]);St&&St.isValid&&St.texture&&ge.init(_,St,ne.renderState)}}for(let Ze=0;Ze<ve.length;Ze++){const it=_e[Ze],nt=ve[Ze];it!==null&&nt!==void 0&&nt.update(it,Qe,le||oe)}Fe&&Fe(lt,Qe),Qe.detectedPlanes&&te.dispatchEvent({type:"planesdetected",data:Qe}),he=null}const ht=new WebGLAnimation;ht.setAnimationLoop(ct),this.setAnimationLoop=function(lt){Fe=lt},this.dispose=function(){}}}const _e1=new Euler,_m1=new Matrix4;function WebGLMaterials(K,_){function Z(me,Ae){me.matrixAutoUpdate===!0&&me.updateMatrix(),Ae.value.copy(me.matrix)}function te(me,Ae){Ae.color.getRGB(me.fogColor.value,getUnlitUniformColorSpace(K)),Ae.isFog?(me.fogNear.value=Ae.near,me.fogFar.value=Ae.far):Ae.isFogExp2&&(me.fogDensity.value=Ae.density)}function ne(me,Ae,ye,ve,_e){Ae.isMeshBasicMaterial||Ae.isMeshLambertMaterial?ie(me,Ae):Ae.isMeshToonMaterial?(ie(me,Ae),fe(me,Ae)):Ae.isMeshPhongMaterial?(ie(me,Ae),ce(me,Ae)):Ae.isMeshStandardMaterial?(ie(me,Ae),de(me,Ae),Ae.isMeshPhysicalMaterial&&pe(me,Ae,_e)):Ae.isMeshMatcapMaterial?(ie(me,Ae),he(me,Ae)):Ae.isMeshDepthMaterial?ie(me,Ae):Ae.isMeshDistanceMaterial?(ie(me,Ae),ge(me,Ae)):Ae.isMeshNormalMaterial?ie(me,Ae):Ae.isLineBasicMaterial?(oe(me,Ae),Ae.isLineDashedMaterial&&se(me,Ae)):Ae.isPointsMaterial?ae(me,Ae,ye,ve):Ae.isSpriteMaterial?le(me,Ae):Ae.isShadowMaterial?(me.color.value.copy(Ae.color),me.opacity.value=Ae.opacity):Ae.isShaderMaterial&&(Ae.uniformsNeedUpdate=!1)}function ie(me,Ae){me.opacity.value=Ae.opacity,Ae.color&&me.diffuse.value.copy(Ae.color),Ae.emissive&&me.emissive.value.copy(Ae.emissive).multiplyScalar(Ae.emissiveIntensity),Ae.map&&(me.map.value=Ae.map,Z(Ae.map,me.mapTransform)),Ae.alphaMap&&(me.alphaMap.value=Ae.alphaMap,Z(Ae.alphaMap,me.alphaMapTransform)),Ae.bumpMap&&(me.bumpMap.value=Ae.bumpMap,Z(Ae.bumpMap,me.bumpMapTransform),me.bumpScale.value=Ae.bumpScale,Ae.side===BackSide&&(me.bumpScale.value*=-1)),Ae.normalMap&&(me.normalMap.value=Ae.normalMap,Z(Ae.normalMap,me.normalMapTransform),me.normalScale.value.copy(Ae.normalScale),Ae.side===BackSide&&me.normalScale.value.negate()),Ae.displacementMap&&(me.displacementMap.value=Ae.displacementMap,Z(Ae.displacementMap,me.displacementMapTransform),me.displacementScale.value=Ae.displacementScale,me.displacementBias.value=Ae.displacementBias),Ae.emissiveMap&&(me.emissiveMap.value=Ae.emissiveMap,Z(Ae.emissiveMap,me.emissiveMapTransform)),Ae.specularMap&&(me.specularMap.value=Ae.specularMap,Z(Ae.specularMap,me.specularMapTransform)),Ae.alphaTest>0&&(me.alphaTest.value=Ae.alphaTest);const ye=_.get(Ae),ve=ye.envMap,_e=ye.envMapRotation;ve&&(me.envMap.value=ve,_e1.copy(_e),_e1.x*=-1,_e1.y*=-1,_e1.z*=-1,ve.isCubeTexture&&ve.isRenderTargetTexture===!1&&(_e1.y*=-1,_e1.z*=-1),me.envMapRotation.value.setFromMatrix4(_m1.makeRotationFromEuler(_e1)),me.flipEnvMap.value=ve.isCubeTexture&&ve.isRenderTargetTexture===!1?-1:1,me.reflectivity.value=Ae.reflectivity,me.ior.value=Ae.ior,me.refractionRatio.value=Ae.refractionRatio),Ae.lightMap&&(me.lightMap.value=Ae.lightMap,me.lightMapIntensity.value=Ae.lightMapIntensity,Z(Ae.lightMap,me.lightMapTransform)),Ae.aoMap&&(me.aoMap.value=Ae.aoMap,me.aoMapIntensity.value=Ae.aoMapIntensity,Z(Ae.aoMap,me.aoMapTransform))}function oe(me,Ae){me.diffuse.value.copy(Ae.color),me.opacity.value=Ae.opacity,Ae.map&&(me.map.value=Ae.map,Z(Ae.map,me.mapTransform))}function se(me,Ae){me.dashSize.value=Ae.dashSize,me.totalSize.value=Ae.dashSize+Ae.gapSize,me.scale.value=Ae.scale}function ae(me,Ae,ye,ve){me.diffuse.value.copy(Ae.color),me.opacity.value=Ae.opacity,me.size.value=Ae.size*ye,me.scale.value=ve*.5,Ae.map&&(me.map.value=Ae.map,Z(Ae.map,me.uvTransform)),Ae.alphaMap&&(me.alphaMap.value=Ae.alphaMap,Z(Ae.alphaMap,me.alphaMapTransform)),Ae.alphaTest>0&&(me.alphaTest.value=Ae.alphaTest)}function le(me,Ae){me.diffuse.value.copy(Ae.color),me.opacity.value=Ae.opacity,me.rotation.value=Ae.rotation,Ae.map&&(me.map.value=Ae.map,Z(Ae.map,me.mapTransform)),Ae.alphaMap&&(me.alphaMap.value=Ae.alphaMap,Z(Ae.alphaMap,me.alphaMapTransform)),Ae.alphaTest>0&&(me.alphaTest.value=Ae.alphaTest)}function ce(me,Ae){me.specular.value.copy(Ae.specular),me.shininess.value=Math.max(Ae.shininess,1e-4)}function fe(me,Ae){Ae.gradientMap&&(me.gradientMap.value=Ae.gradientMap)}function de(me,Ae){me.metalness.value=Ae.metalness,Ae.metalnessMap&&(me.metalnessMap.value=Ae.metalnessMap,Z(Ae.metalnessMap,me.metalnessMapTransform)),me.roughness.value=Ae.roughness,Ae.roughnessMap&&(me.roughnessMap.value=Ae.roughnessMap,Z(Ae.roughnessMap,me.roughnessMapTransform)),Ae.envMap&&(me.envMapIntensity.value=Ae.envMapIntensity)}function pe(me,Ae,ye){me.ior.value=Ae.ior,Ae.sheen>0&&(me.sheenColor.value.copy(Ae.sheenColor).multiplyScalar(Ae.sheen),me.sheenRoughness.value=Ae.sheenRoughness,Ae.sheenColorMap&&(me.sheenColorMap.value=Ae.sheenColorMap,Z(Ae.sheenColorMap,me.sheenColorMapTransform)),Ae.sheenRoughnessMap&&(me.sheenRoughnessMap.value=Ae.sheenRoughnessMap,Z(Ae.sheenRoughnessMap,me.sheenRoughnessMapTransform))),Ae.clearcoat>0&&(me.clearcoat.value=Ae.clearcoat,me.clearcoatRoughness.value=Ae.clearcoatRoughness,Ae.clearcoatMap&&(me.clearcoatMap.value=Ae.clearcoatMap,Z(Ae.clearcoatMap,me.clearcoatMapTransform)),Ae.clearcoatRoughnessMap&&(me.clearcoatRoughnessMap.value=Ae.clearcoatRoughnessMap,Z(Ae.clearcoatRoughnessMap,me.clearcoatRoughnessMapTransform)),Ae.clearcoatNormalMap&&(me.clearcoatNormalMap.value=Ae.clearcoatNormalMap,Z(Ae.clearcoatNormalMap,me.clearcoatNormalMapTransform),me.clearcoatNormalScale.value.copy(Ae.clearcoatNormalScale),Ae.side===BackSide&&me.clearcoatNormalScale.value.negate())),Ae.dispersion>0&&(me.dispersion.value=Ae.dispersion),Ae.iridescence>0&&(me.iridescence.value=Ae.iridescence,me.iridescenceIOR.value=Ae.iridescenceIOR,me.iridescenceThicknessMinimum.value=Ae.iridescenceThicknessRange[0],me.iridescenceThicknessMaximum.value=Ae.iridescenceThicknessRange[1],Ae.iridescenceMap&&(me.iridescenceMap.value=Ae.iridescenceMap,Z(Ae.iridescenceMap,me.iridescenceMapTransform)),Ae.iridescenceThicknessMap&&(me.iridescenceThicknessMap.value=Ae.iridescenceThicknessMap,Z(Ae.iridescenceThicknessMap,me.iridescenceThicknessMapTransform))),Ae.transmission>0&&(me.transmission.value=Ae.transmission,me.transmissionSamplerMap.value=ye.texture,me.transmissionSamplerSize.value.set(ye.width,ye.height),Ae.transmissionMap&&(me.transmissionMap.value=Ae.transmissionMap,Z(Ae.transmissionMap,me.transmissionMapTransform)),me.thickness.value=Ae.thickness,Ae.thicknessMap&&(me.thicknessMap.value=Ae.thicknessMap,Z(Ae.thicknessMap,me.thicknessMapTransform)),me.attenuationDistance.value=Ae.attenuationDistance,me.attenuationColor.value.copy(Ae.attenuationColor)),Ae.anisotropy>0&&(me.anisotropyVector.value.set(Ae.anisotropy*Math.cos(Ae.anisotropyRotation),Ae.anisotropy*Math.sin(Ae.anisotropyRotation)),Ae.anisotropyMap&&(me.anisotropyMap.value=Ae.anisotropyMap,Z(Ae.anisotropyMap,me.anisotropyMapTransform))),me.specularIntensity.value=Ae.specularIntensity,me.specularColor.value.copy(Ae.specularColor),Ae.specularColorMap&&(me.specularColorMap.value=Ae.specularColorMap,Z(Ae.specularColorMap,me.specularColorMapTransform)),Ae.specularIntensityMap&&(me.specularIntensityMap.value=Ae.specularIntensityMap,Z(Ae.specularIntensityMap,me.specularIntensityMapTransform))}function he(me,Ae){Ae.matcap&&(me.matcap.value=Ae.matcap)}function ge(me,Ae){const ye=_.get(Ae).light;me.referencePosition.value.setFromMatrixPosition(ye.matrixWorld),me.nearDistance.value=ye.shadow.camera.near,me.farDistance.value=ye.shadow.camera.far}return{refreshFogUniforms:te,refreshMaterialUniforms:ne}}function WebGLUniformsGroups(K,_,Z,te){let ne={},ie={},oe=[];const se=K.getParameter(K.MAX_UNIFORM_BUFFER_BINDINGS);function ae(ye,ve){const _e=ve.program;te.uniformBlockBinding(ye,_e)}function le(ye,ve){let _e=ne[ye.id];_e===void 0&&(he(ye),_e=ce(ye),ne[ye.id]=_e,ye.addEventListener("dispose",me));const Te=ve.program;te.updateUBOMapping(ye,Te);const be=_.render.frame;ie[ye.id]!==be&&(de(ye),ie[ye.id]=be)}function ce(ye){const ve=fe();ye.__bindingPointIndex=ve;const _e=K.createBuffer(),Te=ye.__size,be=ye.usage;return K.bindBuffer(K.UNIFORM_BUFFER,_e),K.bufferData(K.UNIFORM_BUFFER,Te,be),K.bindBuffer(K.UNIFORM_BUFFER,null),K.bindBufferBase(K.UNIFORM_BUFFER,ve,_e),_e}function fe(){for(let ye=0;ye<se;ye++)if(oe.indexOf(ye)===-1)return oe.push(ye),ye;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function de(ye){const ve=ne[ye.id],_e=ye.uniforms,Te=ye.__cache;K.bindBuffer(K.UNIFORM_BUFFER,ve);for(let be=0,Re=_e.length;be<Re;be++){const we=Array.isArray(_e[be])?_e[be]:[_e[be]];for(let Pe=0,Ie=we.length;Pe<Ie;Pe++){const $e=we[Pe];if(pe($e,be,Pe,Te)===!0){const Ue=$e.__offset,ke=Array.isArray($e.value)?$e.value:[$e.value];let Ge=0;for(let He=0;He<ke.length;He++){const ze=ke[He],Ke=ge(ze);typeof ze=="number"||typeof ze=="boolean"?($e.__data[0]=ze,K.bufferSubData(K.UNIFORM_BUFFER,Ue+Ge,$e.__data)):ze.isMatrix3?($e.__data[0]=ze.elements[0],$e.__data[1]=ze.elements[1],$e.__data[2]=ze.elements[2],$e.__data[3]=0,$e.__data[4]=ze.elements[3],$e.__data[5]=ze.elements[4],$e.__data[6]=ze.elements[5],$e.__data[7]=0,$e.__data[8]=ze.elements[6],$e.__data[9]=ze.elements[7],$e.__data[10]=ze.elements[8],$e.__data[11]=0):(ze.toArray($e.__data,Ge),Ge+=Ke.storage/Float32Array.BYTES_PER_ELEMENT)}K.bufferSubData(K.UNIFORM_BUFFER,Ue,$e.__data)}}}K.bindBuffer(K.UNIFORM_BUFFER,null)}function pe(ye,ve,_e,Te){const be=ye.value,Re=ve+"_"+_e;if(Te[Re]===void 0)return typeof be=="number"||typeof be=="boolean"?Te[Re]=be:Te[Re]=be.clone(),!0;{const we=Te[Re];if(typeof be=="number"||typeof be=="boolean"){if(we!==be)return Te[Re]=be,!0}else if(we.equals(be)===!1)return we.copy(be),!0}return!1}function he(ye){const ve=ye.uniforms;let _e=0;const Te=16;for(let Re=0,we=ve.length;Re<we;Re++){const Pe=Array.isArray(ve[Re])?ve[Re]:[ve[Re]];for(let Ie=0,$e=Pe.length;Ie<$e;Ie++){const Ue=Pe[Ie],ke=Array.isArray(Ue.value)?Ue.value:[Ue.value];for(let Ge=0,He=ke.length;Ge<He;Ge++){const ze=ke[Ge],Ke=ge(ze),tt=_e%Te,Je=tt%Ke.boundary,ot=tt+Je;_e+=Je,ot!==0&&Te-ot<Ke.storage&&(_e+=Te-ot),Ue.__data=new Float32Array(Ke.storage/Float32Array.BYTES_PER_ELEMENT),Ue.__offset=_e,_e+=Ke.storage}}}const be=_e%Te;return be>0&&(_e+=Te-be),ye.__size=_e,ye.__cache={},this}function ge(ye){const ve={boundary:0,storage:0};return typeof ye=="number"||typeof ye=="boolean"?(ve.boundary=4,ve.storage=4):ye.isVector2?(ve.boundary=8,ve.storage=8):ye.isVector3||ye.isColor?(ve.boundary=16,ve.storage=12):ye.isVector4?(ve.boundary=16,ve.storage=16):ye.isMatrix3?(ve.boundary=48,ve.storage=48):ye.isMatrix4?(ve.boundary=64,ve.storage=64):ye.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",ye),ve}function me(ye){const ve=ye.target;ve.removeEventListener("dispose",me);const _e=oe.indexOf(ve.__bindingPointIndex);oe.splice(_e,1),K.deleteBuffer(ne[ve.id]),delete ne[ve.id],delete ie[ve.id]}function Ae(){for(const ye in ne)K.deleteBuffer(ne[ye]);oe=[],ne={},ie={}}return{bind:ae,update:le,dispose:Ae}}class WebGLRenderer{constructor(_={}){const{canvas:Z=createCanvasElement(),context:te=null,depth:ne=!0,stencil:ie=!1,alpha:oe=!1,antialias:se=!1,premultipliedAlpha:ae=!0,preserveDrawingBuffer:le=!1,powerPreference:ce="default",failIfMajorPerformanceCaveat:fe=!1,reverseDepthBuffer:de=!1}=_;this.isWebGLRenderer=!0;let pe;if(te!==null){if(typeof WebGLRenderingContext<"u"&&te instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");pe=te.getContextAttributes().alpha}else pe=oe;const he=new Uint32Array(4),ge=new Int32Array(4);let me=null,Ae=null;const ye=[],ve=[];this.domElement=Z,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=NoToneMapping,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const _e=this;let Te=!1;this._outputColorSpace=SRGBColorSpace$2;let be=0,Re=0,we=null,Pe=-1,Ie=null;const $e=new Vector4,Ue=new Vector4;let ke=null;const Ge=new Color$1(0);let He=0,ze=Z.width,Ke=Z.height,tt=1,Je=null,ot=null;const Fe=new Vector4(0,0,ze,Ke),ct=new Vector4(0,0,ze,Ke);let ht=!1;const lt=new Frustum$1;let Qe=!1,Ze=!1;const it=new Matrix4,nt=new Matrix4,Tt=new Vector3,St=new Vector4,Et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Nt=!1;function zt(){return we===null?tt:1}let yt=te;function Ut(At,Dt){return Z.getContext(At,Dt)}try{const At={alpha:!0,depth:ne,stencil:ie,antialias:se,premultipliedAlpha:ae,preserveDrawingBuffer:le,powerPreference:ce,failIfMajorPerformanceCaveat:fe};if("setAttribute"in Z&&Z.setAttribute("data-engine",`three.js r${REVISION}`),Z.addEventListener("webglcontextlost",hn,!1),Z.addEventListener("webglcontextrestored",_n,!1),Z.addEventListener("webglcontextcreationerror",xn,!1),yt===null){const Dt="webgl2";if(yt=Ut(Dt,At),yt===null)throw Ut(Dt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(At){throw console.error("THREE.WebGLRenderer: "+At.message),At}let bt,Ot,Mt,_t,pt,ft,st,vt,Pt,Lt,Vt,Le,De,Be,rt,at,xt,Ct,Qt,qt,It,Gt,Jt,kt;function Ht(){bt=new WebGLExtensions(yt),bt.init(),Gt=new WebGLUtils(yt,bt),Ot=new WebGLCapabilities(yt,bt,_,Gt),Mt=new WebGLState(yt,bt),Ot.reverseDepthBuffer&&de&&Mt.buffers.depth.setReversed(!0),_t=new WebGLInfo(yt),pt=new WebGLProperties,ft=new WebGLTextures(yt,bt,Mt,pt,Ot,Gt,_t),st=new WebGLCubeMaps(_e),vt=new WebGLCubeUVMaps(_e),Pt=new WebGLAttributes(yt),Jt=new WebGLBindingStates(yt,Pt),Lt=new WebGLGeometries(yt,Pt,_t,Jt),Vt=new WebGLObjects(yt,Lt,Pt,_t),Qt=new WebGLMorphtargets(yt,Ot,ft),at=new WebGLClipping(pt),Le=new WebGLPrograms(_e,st,vt,bt,Ot,Jt,at),De=new WebGLMaterials(_e,pt),Be=new WebGLRenderLists,rt=new WebGLRenderStates(bt),Ct=new WebGLBackground(_e,st,vt,Mt,Vt,pe,ae),xt=new WebGLShadowMap(_e,Vt,Ot),kt=new WebGLUniformsGroups(yt,_t,Ot,Mt),qt=new WebGLBufferRenderer(yt,bt,_t),It=new WebGLIndexedBufferRenderer(yt,bt,_t),_t.programs=Le.programs,_e.capabilities=Ot,_e.extensions=bt,_e.properties=pt,_e.renderLists=Be,_e.shadowMap=xt,_e.state=Mt,_e.info=_t}Ht();const Yt=new WebXRManager(_e,yt);this.xr=Yt,this.getContext=function(){return yt},this.getContextAttributes=function(){return yt.getContextAttributes()},this.forceContextLoss=function(){const At=bt.get("WEBGL_lose_context");At&&At.loseContext()},this.forceContextRestore=function(){const At=bt.get("WEBGL_lose_context");At&&At.restoreContext()},this.getPixelRatio=function(){return tt},this.setPixelRatio=function(At){At!==void 0&&(tt=At,this.setSize(ze,Ke,!1))},this.getSize=function(At){return At.set(ze,Ke)},this.setSize=function(At,Dt,$t=!0){if(Yt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ze=At,Ke=Dt,Z.width=Math.floor(At*tt),Z.height=Math.floor(Dt*tt),$t===!0&&(Z.style.width=At+"px",Z.style.height=Dt+"px"),this.setViewport(0,0,At,Dt)},this.getDrawingBufferSize=function(At){return At.set(ze*tt,Ke*tt).floor()},this.setDrawingBufferSize=function(At,Dt,$t){ze=At,Ke=Dt,tt=$t,Z.width=Math.floor(At*$t),Z.height=Math.floor(Dt*$t),this.setViewport(0,0,At,Dt)},this.getCurrentViewport=function(At){return At.copy($e)},this.getViewport=function(At){return At.copy(Fe)},this.setViewport=function(At,Dt,$t,Bt){At.isVector4?Fe.set(At.x,At.y,At.z,At.w):Fe.set(At,Dt,$t,Bt),Mt.viewport($e.copy(Fe).multiplyScalar(tt).round())},this.getScissor=function(At){return At.copy(ct)},this.setScissor=function(At,Dt,$t,Bt){At.isVector4?ct.set(At.x,At.y,At.z,At.w):ct.set(At,Dt,$t,Bt),Mt.scissor(Ue.copy(ct).multiplyScalar(tt).round())},this.getScissorTest=function(){return ht},this.setScissorTest=function(At){Mt.setScissorTest(ht=At)},this.setOpaqueSort=function(At){Je=At},this.setTransparentSort=function(At){ot=At},this.getClearColor=function(At){return At.copy(Ct.getClearColor())},this.setClearColor=function(){Ct.setClearColor(...arguments)},this.getClearAlpha=function(){return Ct.getClearAlpha()},this.setClearAlpha=function(){Ct.setClearAlpha(...arguments)},this.clear=function(At=!0,Dt=!0,$t=!0){let Bt=0;if(At){let Wt=!1;if(we!==null){const tn=we.texture.format;Wt=tn===RGBAIntegerFormat||tn===RGIntegerFormat||tn===RedIntegerFormat}if(Wt){const tn=we.texture.type,cn=tn===UnsignedByteType||tn===UnsignedIntType||tn===UnsignedShortType||tn===UnsignedInt248Type||tn===UnsignedShort4444Type||tn===UnsignedShort5551Type,An=Ct.getClearColor(),En=Ct.getClearAlpha(),Bn=An.r,In=An.g,Cn=An.b;cn?(he[0]=Bn,he[1]=In,he[2]=Cn,he[3]=En,yt.clearBufferuiv(yt.COLOR,0,he)):(ge[0]=Bn,ge[1]=In,ge[2]=Cn,ge[3]=En,yt.clearBufferiv(yt.COLOR,0,ge))}else Bt|=yt.COLOR_BUFFER_BIT}Dt&&(Bt|=yt.DEPTH_BUFFER_BIT),$t&&(Bt|=yt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),yt.clear(Bt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){Z.removeEventListener("webglcontextlost",hn,!1),Z.removeEventListener("webglcontextrestored",_n,!1),Z.removeEventListener("webglcontextcreationerror",xn,!1),Ct.dispose(),Be.dispose(),rt.dispose(),pt.dispose(),st.dispose(),vt.dispose(),Vt.dispose(),Jt.dispose(),kt.dispose(),Le.dispose(),Yt.dispose(),Yt.removeEventListener("sessionstart",vr),Yt.removeEventListener("sessionend",Nr),Sr.stop()};function hn(At){At.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Te=!0}function _n(){console.log("THREE.WebGLRenderer: Context Restored."),Te=!1;const At=_t.autoReset,Dt=xt.enabled,$t=xt.autoUpdate,Bt=xt.needsUpdate,Wt=xt.type;Ht(),_t.autoReset=At,xt.enabled=Dt,xt.autoUpdate=$t,xt.needsUpdate=Bt,xt.type=Wt}function xn(At){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",At.statusMessage)}function Ln(At){const Dt=At.target;Dt.removeEventListener("dispose",Ln),Vn(Dt)}function Vn(At){kn(At),pt.remove(At)}function kn(At){const Dt=pt.get(At).programs;Dt!==void 0&&(Dt.forEach(function($t){Le.releaseProgram($t)}),At.isShaderMaterial&&Le.releaseShaderCache(At))}this.renderBufferDirect=function(At,Dt,$t,Bt,Wt,tn){Dt===null&&(Dt=Et);const cn=Wt.isMesh&&Wt.matrixWorld.determinant()<0,An=jt(At,Dt,$t,Bt,Wt);Mt.setMaterial(Bt,cn);let En=$t.index,Bn=1;if(Bt.wireframe===!0){if(En=Lt.getWireframeAttribute($t),En===void 0)return;Bn=2}const In=$t.drawRange,Cn=$t.attributes.position;let wn=In.start*Bn,bn=(In.start+In.count)*Bn;tn!==null&&(wn=Math.max(wn,tn.start*Bn),bn=Math.min(bn,(tn.start+tn.count)*Bn)),En!==null?(wn=Math.max(wn,0),bn=Math.min(bn,En.count)):Cn!=null&&(wn=Math.max(wn,0),bn=Math.min(bn,Cn.count));const nr=bn-wn;if(nr<0||nr===1/0)return;Jt.setup(Wt,Bt,An,$t,En);let Fn,On=qt;if(En!==null&&(Fn=Pt.get(En),On=It,On.setIndex(Fn)),Wt.isMesh)Bt.wireframe===!0?(Mt.setLineWidth(Bt.wireframeLinewidth*zt()),On.setMode(yt.LINES)):On.setMode(yt.TRIANGLES);else if(Wt.isLine){let Nn=Bt.linewidth;Nn===void 0&&(Nn=1),Mt.setLineWidth(Nn*zt()),Wt.isLineSegments?On.setMode(yt.LINES):Wt.isLineLoop?On.setMode(yt.LINE_LOOP):On.setMode(yt.LINE_STRIP)}else Wt.isPoints?On.setMode(yt.POINTS):Wt.isSprite&&On.setMode(yt.TRIANGLES);if(Wt.isBatchedMesh)if(Wt._multiDrawInstances!==null)warnOnce("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),On.renderMultiDrawInstances(Wt._multiDrawStarts,Wt._multiDrawCounts,Wt._multiDrawCount,Wt._multiDrawInstances);else if(bt.get("WEBGL_multi_draw"))On.renderMultiDraw(Wt._multiDrawStarts,Wt._multiDrawCounts,Wt._multiDrawCount);else{const Nn=Wt._multiDrawStarts,mr=Wt._multiDrawCounts,zn=Wt._multiDrawCount,Zn=En?Pt.get(En).bytesPerElement:1,Un=pt.get(Bt).currentProgram.getUniforms();for(let er=0;er<zn;er++)Un.setValue(yt,"_gl_DrawID",er),On.render(Nn[er]/Zn,mr[er])}else if(Wt.isInstancedMesh)On.renderInstances(wn,nr,Wt.count);else if($t.isInstancedBufferGeometry){const Nn=$t._maxInstanceCount!==void 0?$t._maxInstanceCount:1/0,mr=Math.min($t.instanceCount,Nn);On.renderInstances(wn,nr,mr)}else On.render(wn,nr)};function Rn(At,Dt,$t){At.transparent===!0&&At.side===DoubleSide&&At.forceSinglePass===!1?(At.side=BackSide,At.needsUpdate=!0,$r(At,Dt,$t),At.side=FrontSide,At.needsUpdate=!0,$r(At,Dt,$t),At.side=DoubleSide):$r(At,Dt,$t)}this.compile=function(At,Dt,$t=null){$t===null&&($t=At),Ae=rt.get($t),Ae.init(Dt),ve.push(Ae),$t.traverseVisible(function(Wt){Wt.isLight&&Wt.layers.test(Dt.layers)&&(Ae.pushLight(Wt),Wt.castShadow&&Ae.pushShadow(Wt))}),At!==$t&&At.traverseVisible(function(Wt){Wt.isLight&&Wt.layers.test(Dt.layers)&&(Ae.pushLight(Wt),Wt.castShadow&&Ae.pushShadow(Wt))}),Ae.setupLights();const Bt=new Set;return At.traverse(function(Wt){if(!(Wt.isMesh||Wt.isPoints||Wt.isLine||Wt.isSprite))return;const tn=Wt.material;if(tn)if(Array.isArray(tn))for(let cn=0;cn<tn.length;cn++){const An=tn[cn];Rn(An,$t,Wt),Bt.add(An)}else Rn(tn,$t,Wt),Bt.add(tn)}),Ae=ve.pop(),Bt},this.compileAsync=function(At,Dt,$t=null){const Bt=this.compile(At,Dt,$t);return new Promise(Wt=>{function tn(){if(Bt.forEach(function(cn){pt.get(cn).currentProgram.isReady()&&Bt.delete(cn)}),Bt.size===0){Wt(At);return}setTimeout(tn,10)}bt.get("KHR_parallel_shader_compile")!==null?tn():setTimeout(tn,10)})};let or=null;function pr(At){or&&or(At)}function vr(){Sr.stop()}function Nr(){Sr.start()}const Sr=new WebGLAnimation;Sr.setAnimationLoop(pr),typeof self<"u"&&Sr.setContext(self),this.setAnimationLoop=function(At){or=At,Yt.setAnimationLoop(At),At===null?Sr.stop():Sr.start()},Yt.addEventListener("sessionstart",vr),Yt.addEventListener("sessionend",Nr),this.render=function(At,Dt){if(Dt!==void 0&&Dt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Te===!0)return;if(At.matrixWorldAutoUpdate===!0&&At.updateMatrixWorld(),Dt.parent===null&&Dt.matrixWorldAutoUpdate===!0&&Dt.updateMatrixWorld(),Yt.enabled===!0&&Yt.isPresenting===!0&&(Yt.cameraAutoUpdate===!0&&Yt.updateCamera(Dt),Dt=Yt.getCamera()),At.isScene===!0&&At.onBeforeRender(_e,At,Dt,we),Ae=rt.get(At,ve.length),Ae.init(Dt),ve.push(Ae),nt.multiplyMatrices(Dt.projectionMatrix,Dt.matrixWorldInverse),lt.setFromProjectionMatrix(nt),Ze=this.localClippingEnabled,Qe=at.init(this.clippingPlanes,Ze),me=Be.get(At,ye.length),me.init(),ye.push(me),Yt.enabled===!0&&Yt.isPresenting===!0){const tn=_e.xr.getDepthSensingMesh();tn!==null&&Pr(tn,Dt,-1/0,_e.sortObjects)}Pr(At,Dt,0,_e.sortObjects),me.finish(),_e.sortObjects===!0&&me.sort(Je,ot),Nt=Yt.enabled===!1||Yt.isPresenting===!1||Yt.hasDepthSensing()===!1,Nt&&Ct.addToRenderList(me,At),this.info.render.frame++,Qe===!0&&at.beginShadows();const $t=Ae.state.shadowsArray;xt.render($t,At,Dt),Qe===!0&&at.endShadows(),this.info.autoReset===!0&&this.info.reset();const Bt=me.opaque,Wt=me.transmissive;if(Ae.setupLights(),Dt.isArrayCamera){const tn=Dt.cameras;if(Wt.length>0)for(let cn=0,An=tn.length;cn<An;cn++){const En=tn[cn];Cr(Bt,Wt,At,En)}Nt&&Ct.render(At);for(let cn=0,An=tn.length;cn<An;cn++){const En=tn[cn];Dr(me,At,En,En.viewport)}}else Wt.length>0&&Cr(Bt,Wt,At,Dt),Nt&&Ct.render(At),Dr(me,At,Dt);we!==null&&Re===0&&(ft.updateMultisampleRenderTarget(we),ft.updateRenderTargetMipmap(we)),At.isScene===!0&&At.onAfterRender(_e,At,Dt),Jt.resetDefaultState(),Pe=-1,Ie=null,ve.pop(),ve.length>0?(Ae=ve[ve.length-1],Qe===!0&&at.setGlobalState(_e.clippingPlanes,Ae.state.camera)):Ae=null,ye.pop(),ye.length>0?me=ye[ye.length-1]:me=null};function Pr(At,Dt,$t,Bt){if(At.visible===!1)return;if(At.layers.test(Dt.layers)){if(At.isGroup)$t=At.renderOrder;else if(At.isLOD)At.autoUpdate===!0&&At.update(Dt);else if(At.isLight)Ae.pushLight(At),At.castShadow&&Ae.pushShadow(At);else if(At.isSprite){if(!At.frustumCulled||lt.intersectsSprite(At)){Bt&&St.setFromMatrixPosition(At.matrixWorld).applyMatrix4(nt);const cn=Vt.update(At),An=At.material;An.visible&&me.push(At,cn,An,$t,St.z,null)}}else if((At.isMesh||At.isLine||At.isPoints)&&(!At.frustumCulled||lt.intersectsObject(At))){const cn=Vt.update(At),An=At.material;if(Bt&&(At.boundingSphere!==void 0?(At.boundingSphere===null&&At.computeBoundingSphere(),St.copy(At.boundingSphere.center)):(cn.boundingSphere===null&&cn.computeBoundingSphere(),St.copy(cn.boundingSphere.center)),St.applyMatrix4(At.matrixWorld).applyMatrix4(nt)),Array.isArray(An)){const En=cn.groups;for(let Bn=0,In=En.length;Bn<In;Bn++){const Cn=En[Bn],wn=An[Cn.materialIndex];wn&&wn.visible&&me.push(At,cn,wn,$t,St.z,Cn)}}else An.visible&&me.push(At,cn,An,$t,St.z,null)}}const tn=At.children;for(let cn=0,An=tn.length;cn<An;cn++)Pr(tn[cn],Dt,$t,Bt)}function Dr(At,Dt,$t,Bt){const Wt=At.opaque,tn=At.transmissive,cn=At.transparent;Ae.setupLightsView($t),Qe===!0&&at.setGlobalState(_e.clippingPlanes,$t),Bt&&Mt.viewport($e.copy(Bt)),Wt.length>0&&Kn(Wt,Dt,$t),tn.length>0&&Kn(tn,Dt,$t),cn.length>0&&Kn(cn,Dt,$t),Mt.buffers.depth.setTest(!0),Mt.buffers.depth.setMask(!0),Mt.buffers.color.setMask(!0),Mt.setPolygonOffset(!1)}function Cr(At,Dt,$t,Bt){if(($t.isScene===!0?$t.overrideMaterial:null)!==null)return;Ae.state.transmissionRenderTarget[Bt.id]===void 0&&(Ae.state.transmissionRenderTarget[Bt.id]=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:bt.has("EXT_color_buffer_half_float")||bt.has("EXT_color_buffer_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:4,stencilBuffer:ie,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ColorManagement.workingColorSpace}));const tn=Ae.state.transmissionRenderTarget[Bt.id],cn=Bt.viewport||$e;tn.setSize(cn.z*_e.transmissionResolutionScale,cn.w*_e.transmissionResolutionScale);const An=_e.getRenderTarget();_e.setRenderTarget(tn),_e.getClearColor(Ge),He=_e.getClearAlpha(),He<1&&_e.setClearColor(16777215,.5),_e.clear(),Nt&&Ct.render($t);const En=_e.toneMapping;_e.toneMapping=NoToneMapping;const Bn=Bt.viewport;if(Bt.viewport!==void 0&&(Bt.viewport=void 0),Ae.setupLightsView(Bt),Qe===!0&&at.setGlobalState(_e.clippingPlanes,Bt),Kn(At,$t,Bt),ft.updateMultisampleRenderTarget(tn),ft.updateRenderTargetMipmap(tn),bt.has("WEBGL_multisampled_render_to_texture")===!1){let In=!1;for(let Cn=0,wn=Dt.length;Cn<wn;Cn++){const bn=Dt[Cn],nr=bn.object,Fn=bn.geometry,On=bn.material,Nn=bn.group;if(On.side===DoubleSide&&nr.layers.test(Bt.layers)){const mr=On.side;On.side=BackSide,On.needsUpdate=!0,Er(nr,$t,Bt,Fn,On,Nn),On.side=mr,On.needsUpdate=!0,In=!0}}In===!0&&(ft.updateMultisampleRenderTarget(tn),ft.updateRenderTargetMipmap(tn))}_e.setRenderTarget(An),_e.setClearColor(Ge,He),Bn!==void 0&&(Bt.viewport=Bn),_e.toneMapping=En}function Kn(At,Dt,$t){const Bt=Dt.isScene===!0?Dt.overrideMaterial:null;for(let Wt=0,tn=At.length;Wt<tn;Wt++){const cn=At[Wt],An=cn.object,En=cn.geometry,Bn=cn.group;let In=cn.material;In.allowOverride===!0&&Bt!==null&&(In=Bt),An.layers.test($t.layers)&&Er(An,Dt,$t,En,In,Bn)}}function Er(At,Dt,$t,Bt,Wt,tn){At.onBeforeRender(_e,Dt,$t,Bt,Wt,tn),At.modelViewMatrix.multiplyMatrices($t.matrixWorldInverse,At.matrixWorld),At.normalMatrix.getNormalMatrix(At.modelViewMatrix),Wt.onBeforeRender(_e,Dt,$t,Bt,At,tn),Wt.transparent===!0&&Wt.side===DoubleSide&&Wt.forceSinglePass===!1?(Wt.side=BackSide,Wt.needsUpdate=!0,_e.renderBufferDirect($t,Dt,Bt,Wt,At,tn),Wt.side=FrontSide,Wt.needsUpdate=!0,_e.renderBufferDirect($t,Dt,Bt,Wt,At,tn),Wt.side=DoubleSide):_e.renderBufferDirect($t,Dt,Bt,Wt,At,tn),At.onAfterRender(_e,Dt,$t,Bt,Wt,tn)}function $r(At,Dt,$t){Dt.isScene!==!0&&(Dt=Et);const Bt=pt.get(At),Wt=Ae.state.lights,tn=Ae.state.shadowsArray,cn=Wt.state.version,An=Le.getParameters(At,Wt.state,tn,Dt,$t),En=Le.getProgramCacheKey(An);let Bn=Bt.programs;Bt.environment=At.isMeshStandardMaterial?Dt.environment:null,Bt.fog=Dt.fog,Bt.envMap=(At.isMeshStandardMaterial?vt:st).get(At.envMap||Bt.environment),Bt.envMapRotation=Bt.environment!==null&&At.envMap===null?Dt.environmentRotation:At.envMapRotation,Bn===void 0&&(At.addEventListener("dispose",Ln),Bn=new Map,Bt.programs=Bn);let In=Bn.get(En);if(In!==void 0){if(Bt.currentProgram===In&&Bt.lightsStateVersion===cn)return wt(At,An),In}else An.uniforms=Le.getUniforms(At),At.onBeforeCompile(An,_e),In=Le.acquireProgram(An,En),Bn.set(En,In),Bt.uniforms=An.uniforms;const Cn=Bt.uniforms;return(!At.isShaderMaterial&&!At.isRawShaderMaterial||At.clipping===!0)&&(Cn.clippingPlanes=at.uniform),wt(At,An),Bt.needsLights=un(At),Bt.lightsStateVersion=cn,Bt.needsLights&&(Cn.ambientLightColor.value=Wt.state.ambient,Cn.lightProbe.value=Wt.state.probe,Cn.directionalLights.value=Wt.state.directional,Cn.directionalLightShadows.value=Wt.state.directionalShadow,Cn.spotLights.value=Wt.state.spot,Cn.spotLightShadows.value=Wt.state.spotShadow,Cn.rectAreaLights.value=Wt.state.rectArea,Cn.ltc_1.value=Wt.state.rectAreaLTC1,Cn.ltc_2.value=Wt.state.rectAreaLTC2,Cn.pointLights.value=Wt.state.point,Cn.pointLightShadows.value=Wt.state.pointShadow,Cn.hemisphereLights.value=Wt.state.hemi,Cn.directionalShadowMap.value=Wt.state.directionalShadowMap,Cn.directionalShadowMatrix.value=Wt.state.directionalShadowMatrix,Cn.spotShadowMap.value=Wt.state.spotShadowMap,Cn.spotLightMatrix.value=Wt.state.spotLightMatrix,Cn.spotLightMap.value=Wt.state.spotLightMap,Cn.pointShadowMap.value=Wt.state.pointShadowMap,Cn.pointShadowMatrix.value=Wt.state.pointShadowMatrix),Bt.currentProgram=In,Bt.uniformsList=null,In}function gt(At){if(At.uniformsList===null){const Dt=At.currentProgram.getUniforms();At.uniformsList=WebGLUniforms.seqWithValue(Dt.seq,At.uniforms)}return At.uniformsList}function wt(At,Dt){const $t=pt.get(At);$t.outputColorSpace=Dt.outputColorSpace,$t.batching=Dt.batching,$t.batchingColor=Dt.batchingColor,$t.instancing=Dt.instancing,$t.instancingColor=Dt.instancingColor,$t.instancingMorph=Dt.instancingMorph,$t.skinning=Dt.skinning,$t.morphTargets=Dt.morphTargets,$t.morphNormals=Dt.morphNormals,$t.morphColors=Dt.morphColors,$t.morphTargetsCount=Dt.morphTargetsCount,$t.numClippingPlanes=Dt.numClippingPlanes,$t.numIntersection=Dt.numClipIntersection,$t.vertexAlphas=Dt.vertexAlphas,$t.vertexTangents=Dt.vertexTangents,$t.toneMapping=Dt.toneMapping}function jt(At,Dt,$t,Bt,Wt){Dt.isScene!==!0&&(Dt=Et),ft.resetTextureUnits();const tn=Dt.fog,cn=Bt.isMeshStandardMaterial?Dt.environment:null,An=we===null?_e.outputColorSpace:we.isXRRenderTarget===!0?we.texture.colorSpace:LinearSRGBColorSpace$2,En=(Bt.isMeshStandardMaterial?vt:st).get(Bt.envMap||cn),Bn=Bt.vertexColors===!0&&!!$t.attributes.color&&$t.attributes.color.itemSize===4,In=!!$t.attributes.tangent&&(!!Bt.normalMap||Bt.anisotropy>0),Cn=!!$t.morphAttributes.position,wn=!!$t.morphAttributes.normal,bn=!!$t.morphAttributes.color;let nr=NoToneMapping;Bt.toneMapped&&(we===null||we.isXRRenderTarget===!0)&&(nr=_e.toneMapping);const Fn=$t.morphAttributes.position||$t.morphAttributes.normal||$t.morphAttributes.color,On=Fn!==void 0?Fn.length:0,Nn=pt.get(Bt),mr=Ae.state.lights;if(Qe===!0&&(Ze===!0||At!==Ie)){const hr=At===Ie&&Bt.id===Pe;at.setState(Bt,At,hr)}let zn=!1;Bt.version===Nn.__version?(Nn.needsLights&&Nn.lightsStateVersion!==mr.state.version||Nn.outputColorSpace!==An||Wt.isBatchedMesh&&Nn.batching===!1||!Wt.isBatchedMesh&&Nn.batching===!0||Wt.isBatchedMesh&&Nn.batchingColor===!0&&Wt.colorTexture===null||Wt.isBatchedMesh&&Nn.batchingColor===!1&&Wt.colorTexture!==null||Wt.isInstancedMesh&&Nn.instancing===!1||!Wt.isInstancedMesh&&Nn.instancing===!0||Wt.isSkinnedMesh&&Nn.skinning===!1||!Wt.isSkinnedMesh&&Nn.skinning===!0||Wt.isInstancedMesh&&Nn.instancingColor===!0&&Wt.instanceColor===null||Wt.isInstancedMesh&&Nn.instancingColor===!1&&Wt.instanceColor!==null||Wt.isInstancedMesh&&Nn.instancingMorph===!0&&Wt.morphTexture===null||Wt.isInstancedMesh&&Nn.instancingMorph===!1&&Wt.morphTexture!==null||Nn.envMap!==En||Bt.fog===!0&&Nn.fog!==tn||Nn.numClippingPlanes!==void 0&&(Nn.numClippingPlanes!==at.numPlanes||Nn.numIntersection!==at.numIntersection)||Nn.vertexAlphas!==Bn||Nn.vertexTangents!==In||Nn.morphTargets!==Cn||Nn.morphNormals!==wn||Nn.morphColors!==bn||Nn.toneMapping!==nr||Nn.morphTargetsCount!==On)&&(zn=!0):(zn=!0,Nn.__version=Bt.version);let Zn=Nn.currentProgram;zn===!0&&(Zn=$r(Bt,Dt,Wt));let Un=!1,er=!1,Jn=!1;const rr=Zn.getUniforms(),sr=Nn.uniforms;if(Mt.useProgram(Zn.program)&&(Un=!0,er=!0,Jn=!0),Bt.id!==Pe&&(Pe=Bt.id,er=!0),Un||Ie!==At){Mt.buffers.depth.getReversed()?(it.copy(At.projectionMatrix),toNormalizedProjectionMatrix(it),toReversedProjectionMatrix(it),rr.setValue(yt,"projectionMatrix",it)):rr.setValue(yt,"projectionMatrix",At.projectionMatrix),rr.setValue(yt,"viewMatrix",At.matrixWorldInverse);const _r=rr.map.cameraPosition;_r!==void 0&&_r.setValue(yt,Tt.setFromMatrixPosition(At.matrixWorld)),Ot.logarithmicDepthBuffer&&rr.setValue(yt,"logDepthBufFC",2/(Math.log(At.far+1)/Math.LN2)),(Bt.isMeshPhongMaterial||Bt.isMeshToonMaterial||Bt.isMeshLambertMaterial||Bt.isMeshBasicMaterial||Bt.isMeshStandardMaterial||Bt.isShaderMaterial)&&rr.setValue(yt,"isOrthographic",At.isOrthographicCamera===!0),Ie!==At&&(Ie=At,er=!0,Jn=!0)}if(Wt.isSkinnedMesh){rr.setOptional(yt,Wt,"bindMatrix"),rr.setOptional(yt,Wt,"bindMatrixInverse");const hr=Wt.skeleton;hr&&(hr.boneTexture===null&&hr.computeBoneTexture(),rr.setValue(yt,"boneTexture",hr.boneTexture,ft))}Wt.isBatchedMesh&&(rr.setOptional(yt,Wt,"batchingTexture"),rr.setValue(yt,"batchingTexture",Wt._matricesTexture,ft),rr.setOptional(yt,Wt,"batchingIdTexture"),rr.setValue(yt,"batchingIdTexture",Wt._indirectTexture,ft),rr.setOptional(yt,Wt,"batchingColorTexture"),Wt._colorsTexture!==null&&rr.setValue(yt,"batchingColorTexture",Wt._colorsTexture,ft));const fr=$t.morphAttributes;if((fr.position!==void 0||fr.normal!==void 0||fr.color!==void 0)&&Qt.update(Wt,$t,Zn),(er||Nn.receiveShadow!==Wt.receiveShadow)&&(Nn.receiveShadow=Wt.receiveShadow,rr.setValue(yt,"receiveShadow",Wt.receiveShadow)),Bt.isMeshGouraudMaterial&&Bt.envMap!==null&&(sr.envMap.value=En,sr.flipEnvMap.value=En.isCubeTexture&&En.isRenderTargetTexture===!1?-1:1),Bt.isMeshStandardMaterial&&Bt.envMap===null&&Dt.environment!==null&&(sr.envMapIntensity.value=Dt.environmentIntensity),er&&(rr.setValue(yt,"toneMappingExposure",_e.toneMappingExposure),Nn.needsLights&&rn(sr,Jn),tn&&Bt.fog===!0&&De.refreshFogUniforms(sr,tn),De.refreshMaterialUniforms(sr,Bt,tt,Ke,Ae.state.transmissionRenderTarget[At.id]),WebGLUniforms.upload(yt,gt(Nn),sr,ft)),Bt.isShaderMaterial&&Bt.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(yt,gt(Nn),sr,ft),Bt.uniformsNeedUpdate=!1),Bt.isSpriteMaterial&&rr.setValue(yt,"center",Wt.center),rr.setValue(yt,"modelViewMatrix",Wt.modelViewMatrix),rr.setValue(yt,"normalMatrix",Wt.normalMatrix),rr.setValue(yt,"modelMatrix",Wt.matrixWorld),Bt.isShaderMaterial||Bt.isRawShaderMaterial){const hr=Bt.uniformsGroups;for(let _r=0,Vr=hr.length;_r<Vr;_r++){const Hn=hr[_r];kt.update(Hn,Zn),kt.bind(Hn,Zn)}}return Zn}function rn(At,Dt){At.ambientLightColor.needsUpdate=Dt,At.lightProbe.needsUpdate=Dt,At.directionalLights.needsUpdate=Dt,At.directionalLightShadows.needsUpdate=Dt,At.pointLights.needsUpdate=Dt,At.pointLightShadows.needsUpdate=Dt,At.spotLights.needsUpdate=Dt,At.spotLightShadows.needsUpdate=Dt,At.rectAreaLights.needsUpdate=Dt,At.hemisphereLights.needsUpdate=Dt}function un(At){return At.isMeshLambertMaterial||At.isMeshToonMaterial||At.isMeshPhongMaterial||At.isMeshStandardMaterial||At.isShadowMaterial||At.isShaderMaterial&&At.lights===!0}this.getActiveCubeFace=function(){return be},this.getActiveMipmapLevel=function(){return Re},this.getRenderTarget=function(){return we},this.setRenderTargetTextures=function(At,Dt,$t){const Bt=pt.get(At);Bt.__autoAllocateDepthBuffer=At.resolveDepthBuffer===!1,Bt.__autoAllocateDepthBuffer===!1&&(Bt.__useRenderToTexture=!1),pt.get(At.texture).__webglTexture=Dt,pt.get(At.depthTexture).__webglTexture=Bt.__autoAllocateDepthBuffer?void 0:$t,Bt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(At,Dt){const $t=pt.get(At);$t.__webglFramebuffer=Dt,$t.__useDefaultFramebuffer=Dt===void 0};const dn=yt.createFramebuffer();this.setRenderTarget=function(At,Dt=0,$t=0){we=At,be=Dt,Re=$t;let Bt=!0,Wt=null,tn=!1,cn=!1;if(At){const En=pt.get(At);if(En.__useDefaultFramebuffer!==void 0)Mt.bindFramebuffer(yt.FRAMEBUFFER,null),Bt=!1;else if(En.__webglFramebuffer===void 0)ft.setupRenderTarget(At);else if(En.__hasExternalTextures)ft.rebindTextures(At,pt.get(At.texture).__webglTexture,pt.get(At.depthTexture).__webglTexture);else if(At.depthBuffer){const Cn=At.depthTexture;if(En.__boundDepthTexture!==Cn){if(Cn!==null&&pt.has(Cn)&&(At.width!==Cn.image.width||At.height!==Cn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ft.setupDepthRenderbuffer(At)}}const Bn=At.texture;(Bn.isData3DTexture||Bn.isDataArrayTexture||Bn.isCompressedArrayTexture)&&(cn=!0);const In=pt.get(At).__webglFramebuffer;At.isWebGLCubeRenderTarget?(Array.isArray(In[Dt])?Wt=In[Dt][$t]:Wt=In[Dt],tn=!0):At.samples>0&&ft.useMultisampledRTT(At)===!1?Wt=pt.get(At).__webglMultisampledFramebuffer:Array.isArray(In)?Wt=In[$t]:Wt=In,$e.copy(At.viewport),Ue.copy(At.scissor),ke=At.scissorTest}else $e.copy(Fe).multiplyScalar(tt).floor(),Ue.copy(ct).multiplyScalar(tt).floor(),ke=ht;if($t!==0&&(Wt=dn),Mt.bindFramebuffer(yt.FRAMEBUFFER,Wt)&&Bt&&Mt.drawBuffers(At,Wt),Mt.viewport($e),Mt.scissor(Ue),Mt.setScissorTest(ke),tn){const En=pt.get(At.texture);yt.framebufferTexture2D(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_CUBE_MAP_POSITIVE_X+Dt,En.__webglTexture,$t)}else if(cn){const En=pt.get(At.texture),Bn=Dt;yt.framebufferTextureLayer(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,En.__webglTexture,$t,Bn)}else if(At!==null&&$t!==0){const En=pt.get(At.texture);yt.framebufferTexture2D(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,En.__webglTexture,$t)}Pe=-1},this.readRenderTargetPixels=function(At,Dt,$t,Bt,Wt,tn,cn){if(!(At&&At.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let An=pt.get(At).__webglFramebuffer;if(At.isWebGLCubeRenderTarget&&cn!==void 0&&(An=An[cn]),An){Mt.bindFramebuffer(yt.FRAMEBUFFER,An);try{const En=At.texture,Bn=En.format,In=En.type;if(!Ot.textureFormatReadable(Bn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ot.textureTypeReadable(In)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Dt>=0&&Dt<=At.width-Bt&&$t>=0&&$t<=At.height-Wt&&yt.readPixels(Dt,$t,Bt,Wt,Gt.convert(Bn),Gt.convert(In),tn)}finally{const En=we!==null?pt.get(we).__webglFramebuffer:null;Mt.bindFramebuffer(yt.FRAMEBUFFER,En)}}},this.readRenderTargetPixelsAsync=async function(At,Dt,$t,Bt,Wt,tn,cn){if(!(At&&At.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let An=pt.get(At).__webglFramebuffer;if(At.isWebGLCubeRenderTarget&&cn!==void 0&&(An=An[cn]),An)if(Dt>=0&&Dt<=At.width-Bt&&$t>=0&&$t<=At.height-Wt){Mt.bindFramebuffer(yt.FRAMEBUFFER,An);const En=At.texture,Bn=En.format,In=En.type;if(!Ot.textureFormatReadable(Bn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ot.textureTypeReadable(In))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Cn=yt.createBuffer();yt.bindBuffer(yt.PIXEL_PACK_BUFFER,Cn),yt.bufferData(yt.PIXEL_PACK_BUFFER,tn.byteLength,yt.STREAM_READ),yt.readPixels(Dt,$t,Bt,Wt,Gt.convert(Bn),Gt.convert(In),0);const wn=we!==null?pt.get(we).__webglFramebuffer:null;Mt.bindFramebuffer(yt.FRAMEBUFFER,wn);const bn=yt.fenceSync(yt.SYNC_GPU_COMMANDS_COMPLETE,0);return yt.flush(),await probeAsync(yt,bn,4),yt.bindBuffer(yt.PIXEL_PACK_BUFFER,Cn),yt.getBufferSubData(yt.PIXEL_PACK_BUFFER,0,tn),yt.deleteBuffer(Cn),yt.deleteSync(bn),tn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(At,Dt=null,$t=0){const Bt=Math.pow(2,-$t),Wt=Math.floor(At.image.width*Bt),tn=Math.floor(At.image.height*Bt),cn=Dt!==null?Dt.x:0,An=Dt!==null?Dt.y:0;ft.setTexture2D(At,0),yt.copyTexSubImage2D(yt.TEXTURE_2D,$t,0,0,cn,An,Wt,tn),Mt.unbindTexture()};const Tn=yt.createFramebuffer(),Sn=yt.createFramebuffer();this.copyTextureToTexture=function(At,Dt,$t=null,Bt=null,Wt=0,tn=null){tn===null&&(Wt!==0?(warnOnce("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),tn=Wt,Wt=0):tn=0);let cn,An,En,Bn,In,Cn,wn,bn,nr;const Fn=At.isCompressedTexture?At.mipmaps[tn]:At.image;if($t!==null)cn=$t.max.x-$t.min.x,An=$t.max.y-$t.min.y,En=$t.isBox3?$t.max.z-$t.min.z:1,Bn=$t.min.x,In=$t.min.y,Cn=$t.isBox3?$t.min.z:0;else{const fr=Math.pow(2,-Wt);cn=Math.floor(Fn.width*fr),An=Math.floor(Fn.height*fr),At.isDataArrayTexture?En=Fn.depth:At.isData3DTexture?En=Math.floor(Fn.depth*fr):En=1,Bn=0,In=0,Cn=0}Bt!==null?(wn=Bt.x,bn=Bt.y,nr=Bt.z):(wn=0,bn=0,nr=0);const On=Gt.convert(Dt.format),Nn=Gt.convert(Dt.type);let mr;Dt.isData3DTexture?(ft.setTexture3D(Dt,0),mr=yt.TEXTURE_3D):Dt.isDataArrayTexture||Dt.isCompressedArrayTexture?(ft.setTexture2DArray(Dt,0),mr=yt.TEXTURE_2D_ARRAY):(ft.setTexture2D(Dt,0),mr=yt.TEXTURE_2D),yt.pixelStorei(yt.UNPACK_FLIP_Y_WEBGL,Dt.flipY),yt.pixelStorei(yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Dt.premultiplyAlpha),yt.pixelStorei(yt.UNPACK_ALIGNMENT,Dt.unpackAlignment);const zn=yt.getParameter(yt.UNPACK_ROW_LENGTH),Zn=yt.getParameter(yt.UNPACK_IMAGE_HEIGHT),Un=yt.getParameter(yt.UNPACK_SKIP_PIXELS),er=yt.getParameter(yt.UNPACK_SKIP_ROWS),Jn=yt.getParameter(yt.UNPACK_SKIP_IMAGES);yt.pixelStorei(yt.UNPACK_ROW_LENGTH,Fn.width),yt.pixelStorei(yt.UNPACK_IMAGE_HEIGHT,Fn.height),yt.pixelStorei(yt.UNPACK_SKIP_PIXELS,Bn),yt.pixelStorei(yt.UNPACK_SKIP_ROWS,In),yt.pixelStorei(yt.UNPACK_SKIP_IMAGES,Cn);const rr=At.isDataArrayTexture||At.isData3DTexture,sr=Dt.isDataArrayTexture||Dt.isData3DTexture;if(At.isDepthTexture){const fr=pt.get(At),hr=pt.get(Dt),_r=pt.get(fr.__renderTarget),Vr=pt.get(hr.__renderTarget);Mt.bindFramebuffer(yt.READ_FRAMEBUFFER,_r.__webglFramebuffer),Mt.bindFramebuffer(yt.DRAW_FRAMEBUFFER,Vr.__webglFramebuffer);for(let Hn=0;Hn<En;Hn++)rr&&(yt.framebufferTextureLayer(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,pt.get(At).__webglTexture,Wt,Cn+Hn),yt.framebufferTextureLayer(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,pt.get(Dt).__webglTexture,tn,nr+Hn)),yt.blitFramebuffer(Bn,In,cn,An,wn,bn,cn,An,yt.DEPTH_BUFFER_BIT,yt.NEAREST);Mt.bindFramebuffer(yt.READ_FRAMEBUFFER,null),Mt.bindFramebuffer(yt.DRAW_FRAMEBUFFER,null)}else if(Wt!==0||At.isRenderTargetTexture||pt.has(At)){const fr=pt.get(At),hr=pt.get(Dt);Mt.bindFramebuffer(yt.READ_FRAMEBUFFER,Tn),Mt.bindFramebuffer(yt.DRAW_FRAMEBUFFER,Sn);for(let _r=0;_r<En;_r++)rr?yt.framebufferTextureLayer(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,fr.__webglTexture,Wt,Cn+_r):yt.framebufferTexture2D(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,fr.__webglTexture,Wt),sr?yt.framebufferTextureLayer(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,hr.__webglTexture,tn,nr+_r):yt.framebufferTexture2D(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,hr.__webglTexture,tn),Wt!==0?yt.blitFramebuffer(Bn,In,cn,An,wn,bn,cn,An,yt.COLOR_BUFFER_BIT,yt.NEAREST):sr?yt.copyTexSubImage3D(mr,tn,wn,bn,nr+_r,Bn,In,cn,An):yt.copyTexSubImage2D(mr,tn,wn,bn,Bn,In,cn,An);Mt.bindFramebuffer(yt.READ_FRAMEBUFFER,null),Mt.bindFramebuffer(yt.DRAW_FRAMEBUFFER,null)}else sr?At.isDataTexture||At.isData3DTexture?yt.texSubImage3D(mr,tn,wn,bn,nr,cn,An,En,On,Nn,Fn.data):Dt.isCompressedArrayTexture?yt.compressedTexSubImage3D(mr,tn,wn,bn,nr,cn,An,En,On,Fn.data):yt.texSubImage3D(mr,tn,wn,bn,nr,cn,An,En,On,Nn,Fn):At.isDataTexture?yt.texSubImage2D(yt.TEXTURE_2D,tn,wn,bn,cn,An,On,Nn,Fn.data):At.isCompressedTexture?yt.compressedTexSubImage2D(yt.TEXTURE_2D,tn,wn,bn,Fn.width,Fn.height,On,Fn.data):yt.texSubImage2D(yt.TEXTURE_2D,tn,wn,bn,cn,An,On,Nn,Fn);yt.pixelStorei(yt.UNPACK_ROW_LENGTH,zn),yt.pixelStorei(yt.UNPACK_IMAGE_HEIGHT,Zn),yt.pixelStorei(yt.UNPACK_SKIP_PIXELS,Un),yt.pixelStorei(yt.UNPACK_SKIP_ROWS,er),yt.pixelStorei(yt.UNPACK_SKIP_IMAGES,Jn),tn===0&&Dt.generateMipmaps&&yt.generateMipmap(mr),Mt.unbindTexture()},this.copyTextureToTexture3D=function(At,Dt,$t=null,Bt=null,Wt=0){return warnOnce('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(At,Dt,$t,Bt,Wt)},this.initRenderTarget=function(At){pt.get(At).__webglFramebuffer===void 0&&ft.setupRenderTarget(At)},this.initTexture=function(At){At.isCubeTexture?ft.setTextureCube(At,0):At.isData3DTexture?ft.setTexture3D(At,0):At.isDataArrayTexture||At.isCompressedArrayTexture?ft.setTexture2DArray(At,0):ft.setTexture2D(At,0),Mt.unbindTexture()},this.resetState=function(){be=0,Re=0,we=null,Mt.reset(),Jt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(_){this._outputColorSpace=_;const Z=this.getContext();Z.drawingBufferColorSpace=ColorManagement._getDrawingBufferColorSpace(_),Z.unpackColorSpace=ColorManagement._getUnpackColorSpace()}}const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AgXToneMapping,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight:AmbientLight$1,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera:Camera$1,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleGeometry,ClampToEdgeWrapping,Clock,Color:Color$1,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture:CompressedArrayTexture$1,CompressedCubeTexture:CompressedCubeTexture$1,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,Controls,CubeCamera:CubeCamera$1,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture:Data3DTexture$1,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DetachedBindMode,DirectionalLight:DirectionalLight$1,DirectionalLightHelper,DiscreteInterpolant,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher:EventDispatcher$1,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum:Frustum$1,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HalfFloatType,HemisphereLight:HemisphereLight$1,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line:Line$2,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace:LinearSRGBColorSpace$2,LinearToneMapping,LinearTransfer,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix2,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeutralToneMapping,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace:NoColorSpace$1,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronGeometry,OneFactor,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera:OrthographicCamera$1,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path,PerspectiveCamera:PerspectiveCamera$2,Plane:Plane$2,PlaneGeometry,PlaneHelper,PointLight:PointLight$1,PointLightHelper,Points:Points$1,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio:PositionalAudio$1,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGBDepthPacking,RGBFormat,RGBIntegerFormat,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGDepthPacking,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray,Raycaster,RectAreaLight:RectAreaLight$1,RedFormat,RedIntegerFormat,ReinhardToneMapping,RenderTarget,RenderTarget3D,RenderTargetArray,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace:SRGBColorSpace$2,SRGBTransfer,Scene:Scene$1,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape:Shape$2,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere:Sphere$2,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight:SpotLight$2,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronGeometry,Texture:Texture$1,TextureLoader,TextureUtils,TimestampQuery,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedInt5999Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoFrameTexture,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WebXRController,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,createCanvasElement},Symbol.toStringTag,{value:"Module"}));var constants$4={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactReconcilerConstants_production_min;function requireReactReconcilerConstants_production_min(){return hasRequiredReactReconcilerConstants_production_min||(hasRequiredReactReconcilerConstants_production_min=1,reactReconcilerConstants_production_min.ConcurrentRoot=1,reactReconcilerConstants_production_min.ContinuousEventPriority=4,reactReconcilerConstants_production_min.DefaultEventPriority=16,reactReconcilerConstants_production_min.DiscreteEventPriority=1,reactReconcilerConstants_production_min.IdleEventPriority=536870912,reactReconcilerConstants_production_min.LegacyRoot=0),reactReconcilerConstants_production_min}constants$4.exports=requireReactReconcilerConstants_production_min();var constantsExports=constants$4.exports;function createStore$7(K){let _;const Z=new Set,te=(le,ce)=>{const fe=typeof le=="function"?le(_):le;if(fe!==_){const de=_;_=ce?fe:Object.assign({},_,fe),Z.forEach(pe=>pe(_,de))}},ne=()=>_,ie=(le,ce=ne,fe=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let de=ce(_);function pe(){const he=ce(_);if(!fe(de,he)){const ge=de;le(de=he,ge)}}return Z.add(pe),()=>Z.delete(pe)},ae={setState:te,getState:ne,subscribe:(le,ce,fe)=>ce||fe?ie(le,ce,fe):(Z.add(le),()=>Z.delete(le)),destroy:()=>Z.clear()};return _=K(te,ne,ae),ae}const isSSR$1=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$3=isSSR$1?reactExports.useEffect:reactExports.useLayoutEffect;function create$e(K){const _=typeof K=="function"?createStore$7(K):K,Z=(te=_.getState,ne=Object.is)=>{const[,ie]=reactExports.useReducer(me=>me+1,0),oe=_.getState(),se=reactExports.useRef(oe),ae=reactExports.useRef(te),le=reactExports.useRef(ne),ce=reactExports.useRef(!1),fe=reactExports.useRef();fe.current===void 0&&(fe.current=te(oe));let de,pe=!1;(se.current!==oe||ae.current!==te||le.current!==ne||ce.current)&&(de=te(oe),pe=!ne(fe.current,de)),useIsomorphicLayoutEffect$3(()=>{pe&&(fe.current=de),se.current=oe,ae.current=te,le.current=ne,ce.current=!1});const he=reactExports.useRef(oe);useIsomorphicLayoutEffect$3(()=>{const me=()=>{try{const ye=_.getState(),ve=ae.current(ye);le.current(fe.current,ve)||(se.current=ye,fe.current=ve,ie())}catch{ce.current=!0,ie()}},Ae=_.subscribe(me);return _.getState()!==he.current&&me(),Ae},[]);const ge=pe?de:fe.current;return reactExports.useDebugValue(ge),ge};return Object.assign(Z,_),Z[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const te=[Z,_];return{next(){const ne=te.length<=0;return{value:te.shift(),done:ne}}}},Z}const isPromise$1=K=>typeof K=="object"&&typeof K.then=="function",globalCache$1=[];function shallowEqualArrays$1(K,_,Z=(te,ne)=>te===ne){if(K===_)return!0;if(!K||!_)return!1;const te=K.length;if(_.length!==te)return!1;for(let ne=0;ne<te;ne++)if(!Z(K[ne],_[ne]))return!1;return!0}function query$1(K,_=null,Z=!1,te={}){_===null&&(_=[K]);for(const ie of globalCache$1)if(shallowEqualArrays$1(_,ie.keys,ie.equal)){if(Z)return;if(Object.prototype.hasOwnProperty.call(ie,"error"))throw ie.error;if(Object.prototype.hasOwnProperty.call(ie,"response"))return te.lifespan&&te.lifespan>0&&(ie.timeout&&clearTimeout(ie.timeout),ie.timeout=setTimeout(ie.remove,te.lifespan)),ie.response;if(!Z)throw ie.promise}const ne={keys:_,equal:te.equal,remove:()=>{const ie=globalCache$1.indexOf(ne);ie!==-1&&globalCache$1.splice(ie,1)},promise:(isPromise$1(K)?K:K(..._)).then(ie=>{ne.response=ie,te.lifespan&&te.lifespan>0&&(ne.timeout=setTimeout(ne.remove,te.lifespan))}).catch(ie=>ne.error=ie)};if(globalCache$1.push(ne),!Z)throw ne.promise}const suspend$1=(K,_,Z)=>query$1(K,_,!1,Z),preload=(K,_,Z)=>void query$1(K,_,!0,Z),clear$1=K=>{if(K===void 0||K.length===0)globalCache$1.splice(0,globalCache$1.length);else{const _=globalCache$1.find(Z=>shallowEqualArrays$1(K,Z.keys,Z.equal));_&&_.remove()}};var reactReconciler={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min,hasRequiredReactReconciler_production_min;function requireReactReconciler_production_min(){return hasRequiredReactReconciler_production_min||(hasRequiredReactReconciler_production_min=1,reactReconciler_production_min=function(_){var Z={},te=reactExports,ne=requireScheduler(),ie=Object.assign;function oe(Ee){for(var Se="https://reactjs.org/docs/error-decoder.html?invariant="+Ee,Oe=1;Oe<arguments.length;Oe++)Se+="&args[]="+encodeURIComponent(arguments[Oe]);return"Minified React error #"+Ee+"; visit "+Se+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var se=te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ae=Symbol.for("react.element"),le=Symbol.for("react.portal"),ce=Symbol.for("react.fragment"),fe=Symbol.for("react.strict_mode"),de=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),he=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),ye=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),_e=Symbol.for("react.offscreen"),Te=Symbol.iterator;function be(Ee){return Ee===null||typeof Ee!="object"?null:(Ee=Te&&Ee[Te]||Ee["@@iterator"],typeof Ee=="function"?Ee:null)}function Re(Ee){if(Ee==null)return null;if(typeof Ee=="function")return Ee.displayName||Ee.name||null;if(typeof Ee=="string")return Ee;switch(Ee){case ce:return"Fragment";case le:return"Portal";case de:return"Profiler";case fe:return"StrictMode";case me:return"Suspense";case Ae:return"SuspenseList"}if(typeof Ee=="object")switch(Ee.$$typeof){case he:return(Ee.displayName||"Context")+".Consumer";case pe:return(Ee._context.displayName||"Context")+".Provider";case ge:var Se=Ee.render;return Ee=Ee.displayName,Ee||(Ee=Se.displayName||Se.name||"",Ee=Ee!==""?"ForwardRef("+Ee+")":"ForwardRef"),Ee;case ye:return Se=Ee.displayName||null,Se!==null?Se:Re(Ee.type)||"Memo";case ve:Se=Ee._payload,Ee=Ee._init;try{return Re(Ee(Se))}catch{}}return null}function we(Ee){var Se=Ee.type;switch(Ee.tag){case 24:return"Cache";case 9:return(Se.displayName||"Context")+".Consumer";case 10:return(Se._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return Ee=Se.render,Ee=Ee.displayName||Ee.name||"",Se.displayName||(Ee!==""?"ForwardRef("+Ee+")":"ForwardRef");case 7:return"Fragment";case 5:return Se;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Re(Se);case 8:return Se===fe?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Se=="function")return Se.displayName||Se.name||null;if(typeof Se=="string")return Se}return null}function Pe(Ee){var Se=Ee,Oe=Ee;if(Ee.alternate)for(;Se.return;)Se=Se.return;else{Ee=Se;do Se=Ee,Se.flags&4098&&(Oe=Se.return),Ee=Se.return;while(Ee)}return Se.tag===3?Oe:null}function Ie(Ee){if(Pe(Ee)!==Ee)throw Error(oe(188))}function $e(Ee){var Se=Ee.alternate;if(!Se){if(Se=Pe(Ee),Se===null)throw Error(oe(188));return Se!==Ee?null:Ee}for(var Oe=Ee,je=Se;;){var Xe=Oe.return;if(Xe===null)break;var ut=Xe.alternate;if(ut===null){if(je=Xe.return,je!==null){Oe=je;continue}break}if(Xe.child===ut.child){for(ut=Xe.child;ut;){if(ut===Oe)return Ie(Xe),Ee;if(ut===je)return Ie(Xe),Se;ut=ut.sibling}throw Error(oe(188))}if(Oe.return!==je.return)Oe=Xe,je=ut;else{for(var Rt=!1,Zt=Xe.child;Zt;){if(Zt===Oe){Rt=!0,Oe=Xe,je=ut;break}if(Zt===je){Rt=!0,je=Xe,Oe=ut;break}Zt=Zt.sibling}if(!Rt){for(Zt=ut.child;Zt;){if(Zt===Oe){Rt=!0,Oe=ut,je=Xe;break}if(Zt===je){Rt=!0,je=ut,Oe=Xe;break}Zt=Zt.sibling}if(!Rt)throw Error(oe(189))}}if(Oe.alternate!==je)throw Error(oe(190))}if(Oe.tag!==3)throw Error(oe(188));return Oe.stateNode.current===Oe?Ee:Se}function Ue(Ee){return Ee=$e(Ee),Ee!==null?ke(Ee):null}function ke(Ee){if(Ee.tag===5||Ee.tag===6)return Ee;for(Ee=Ee.child;Ee!==null;){var Se=ke(Ee);if(Se!==null)return Se;Ee=Ee.sibling}return null}function Ge(Ee){if(Ee.tag===5||Ee.tag===6)return Ee;for(Ee=Ee.child;Ee!==null;){if(Ee.tag!==4){var Se=Ge(Ee);if(Se!==null)return Se}Ee=Ee.sibling}return null}var He=Array.isArray,ze=_.getPublicInstance,Ke=_.getRootHostContext,tt=_.getChildHostContext,Je=_.prepareForCommit,ot=_.resetAfterCommit,Fe=_.createInstance,ct=_.appendInitialChild,ht=_.finalizeInitialChildren,lt=_.prepareUpdate,Qe=_.shouldSetTextContent,Ze=_.createTextInstance,it=_.scheduleTimeout,nt=_.cancelTimeout,Tt=_.noTimeout,St=_.isPrimaryRenderer,Et=_.supportsMutation,Nt=_.supportsPersistence,zt=_.supportsHydration,yt=_.getInstanceFromNode,Ut=_.preparePortalMount,bt=_.getCurrentEventPriority,Ot=_.detachDeletedInstance,Mt=_.supportsMicrotasks,_t=_.scheduleMicrotask,pt=_.supportsTestSelectors,ft=_.findFiberRoot,st=_.getBoundingRect,vt=_.getTextContent,Pt=_.isHiddenSubtree,Lt=_.matchAccessibilityRole,Vt=_.setFocusIfFocusable,Le=_.setupIntersectionObserver,De=_.appendChild,Be=_.appendChildToContainer,rt=_.commitTextUpdate,at=_.commitMount,xt=_.commitUpdate,Ct=_.insertBefore,Qt=_.insertInContainerBefore,qt=_.removeChild,It=_.removeChildFromContainer,Gt=_.resetTextContent,Jt=_.hideInstance,kt=_.hideTextInstance,Ht=_.unhideInstance,Yt=_.unhideTextInstance,hn=_.clearContainer,_n=_.cloneInstance,xn=_.createContainerChildSet,Ln=_.appendChildToContainerChildSet,Vn=_.finalizeContainerChildren,kn=_.replaceContainerChildren,Rn=_.cloneHiddenInstance,or=_.cloneHiddenTextInstance,pr=_.canHydrateInstance,vr=_.canHydrateTextInstance,Nr=_.canHydrateSuspenseInstance,Sr=_.isSuspenseInstancePending,Pr=_.isSuspenseInstanceFallback,Dr=_.getSuspenseInstanceFallbackErrorDetails,Cr=_.registerSuspenseInstanceRetry,Kn=_.getNextHydratableSibling,Er=_.getFirstHydratableChild,$r=_.getFirstHydratableChildWithinContainer,gt=_.getFirstHydratableChildWithinSuspenseInstance,wt=_.hydrateInstance,jt=_.hydrateTextInstance,rn=_.hydrateSuspenseInstance,un=_.getNextHydratableInstanceAfterSuspenseInstance,dn=_.commitHydratedContainer,Tn=_.commitHydratedSuspenseInstance,Sn=_.clearSuspenseBoundary,At=_.clearSuspenseBoundaryFromContainer,Dt=_.shouldDeleteUnhydratedTailInstances,$t=_.didNotMatchHydratedContainerTextInstance,Bt=_.didNotMatchHydratedTextInstance,Wt;function tn(Ee){if(Wt===void 0)try{throw Error()}catch(Oe){var Se=Oe.stack.trim().match(/\n( *(at )?)/);Wt=Se&&Se[1]||""}return`
`+Wt+Ee}var cn=!1;function An(Ee,Se){if(!Ee||cn)return"";cn=!0;var Oe=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Se)if(Se=function(){throw Error()},Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(Pn){var je=Pn}Reflect.construct(Ee,[],Se)}else{try{Se.call()}catch(Pn){je=Pn}Ee.call(Se.prototype)}else{try{throw Error()}catch(Pn){je=Pn}Ee()}}catch(Pn){if(Pn&&je&&typeof Pn.stack=="string"){for(var Xe=Pn.stack.split(`
`),ut=je.stack.split(`
`),Rt=Xe.length-1,Zt=ut.length-1;1<=Rt&&0<=Zt&&Xe[Rt]!==ut[Zt];)Zt--;for(;1<=Rt&&0<=Zt;Rt--,Zt--)if(Xe[Rt]!==ut[Zt]){if(Rt!==1||Zt!==1)do if(Rt--,Zt--,0>Zt||Xe[Rt]!==ut[Zt]){var pn=`
`+Xe[Rt].replace(" at new "," at ");return Ee.displayName&&pn.includes("<anonymous>")&&(pn=pn.replace("<anonymous>",Ee.displayName)),pn}while(1<=Rt&&0<=Zt);break}}}finally{cn=!1,Error.prepareStackTrace=Oe}return(Ee=Ee?Ee.displayName||Ee.name:"")?tn(Ee):""}var En=Object.prototype.hasOwnProperty,Bn=[],In=-1;function Cn(Ee){return{current:Ee}}function wn(Ee){0>In||(Ee.current=Bn[In],Bn[In]=null,In--)}function bn(Ee,Se){In++,Bn[In]=Ee.current,Ee.current=Se}var nr={},Fn=Cn(nr),On=Cn(!1),Nn=nr;function mr(Ee,Se){var Oe=Ee.type.contextTypes;if(!Oe)return nr;var je=Ee.stateNode;if(je&&je.__reactInternalMemoizedUnmaskedChildContext===Se)return je.__reactInternalMemoizedMaskedChildContext;var Xe={},ut;for(ut in Oe)Xe[ut]=Se[ut];return je&&(Ee=Ee.stateNode,Ee.__reactInternalMemoizedUnmaskedChildContext=Se,Ee.__reactInternalMemoizedMaskedChildContext=Xe),Xe}function zn(Ee){return Ee=Ee.childContextTypes,Ee!=null}function Zn(){wn(On),wn(Fn)}function Un(Ee,Se,Oe){if(Fn.current!==nr)throw Error(oe(168));bn(Fn,Se),bn(On,Oe)}function er(Ee,Se,Oe){var je=Ee.stateNode;if(Se=Se.childContextTypes,typeof je.getChildContext!="function")return Oe;je=je.getChildContext();for(var Xe in je)if(!(Xe in Se))throw Error(oe(108,we(Ee)||"Unknown",Xe));return ie({},Oe,je)}function Jn(Ee){return Ee=(Ee=Ee.stateNode)&&Ee.__reactInternalMemoizedMergedChildContext||nr,Nn=Fn.current,bn(Fn,Ee),bn(On,On.current),!0}function rr(Ee,Se,Oe){var je=Ee.stateNode;if(!je)throw Error(oe(169));Oe?(Ee=er(Ee,Se,Nn),je.__reactInternalMemoizedMergedChildContext=Ee,wn(On),wn(Fn),bn(Fn,Ee)):wn(On),bn(On,Oe)}var sr=Math.clz32?Math.clz32:_r,fr=Math.log,hr=Math.LN2;function _r(Ee){return Ee>>>=0,Ee===0?32:31-(fr(Ee)/hr|0)|0}var Vr=64,Hn=4194304;function qn(Ee){switch(Ee&-Ee){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Ee&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return Ee&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return Ee}}function mt(Ee,Se){var Oe=Ee.pendingLanes;if(Oe===0)return 0;var je=0,Xe=Ee.suspendedLanes,ut=Ee.pingedLanes,Rt=Oe&268435455;if(Rt!==0){var Zt=Rt&~Xe;Zt!==0?je=qn(Zt):(ut&=Rt,ut!==0&&(je=qn(ut)))}else Rt=Oe&~Xe,Rt!==0?je=qn(Rt):ut!==0&&(je=qn(ut));if(je===0)return 0;if(Se!==0&&Se!==je&&!(Se&Xe)&&(Xe=je&-je,ut=Se&-Se,Xe>=ut||Xe===16&&(ut&4194240)!==0))return Se;if(je&4&&(je|=Oe&16),Se=Ee.entangledLanes,Se!==0)for(Ee=Ee.entanglements,Se&=je;0<Se;)Oe=31-sr(Se),Xe=1<<Oe,je|=Ee[Oe],Se&=~Xe;return je}function Ve(Ee,Se){switch(Ee){case 1:case 2:case 4:return Se+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Se+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function We(Ee,Se){for(var Oe=Ee.suspendedLanes,je=Ee.pingedLanes,Xe=Ee.expirationTimes,ut=Ee.pendingLanes;0<ut;){var Rt=31-sr(ut),Zt=1<<Rt,pn=Xe[Rt];pn===-1?(!(Zt&Oe)||Zt&je)&&(Xe[Rt]=Ve(Zt,Se)):pn<=Se&&(Ee.expiredLanes|=Zt),ut&=~Zt}}function Ye(Ee){return Ee=Ee.pendingLanes&-1073741825,Ee!==0?Ee:Ee&1073741824?1073741824:0}function qe(){var Ee=Vr;return Vr<<=1,!(Vr&4194240)&&(Vr=64),Ee}function dt(Ee){for(var Se=[],Oe=0;31>Oe;Oe++)Se.push(Ee);return Se}function Ft(Ee,Se,Oe){Ee.pendingLanes|=Se,Se!==536870912&&(Ee.suspendedLanes=0,Ee.pingedLanes=0),Ee=Ee.eventTimes,Se=31-sr(Se),Ee[Se]=Oe}function Xt(Ee,Se){var Oe=Ee.pendingLanes&~Se;Ee.pendingLanes=Se,Ee.suspendedLanes=0,Ee.pingedLanes=0,Ee.expiredLanes&=Se,Ee.mutableReadLanes&=Se,Ee.entangledLanes&=Se,Se=Ee.entanglements;var je=Ee.eventTimes;for(Ee=Ee.expirationTimes;0<Oe;){var Xe=31-sr(Oe),ut=1<<Xe;Se[Xe]=0,je[Xe]=-1,Ee[Xe]=-1,Oe&=~ut}}function an(Ee,Se){var Oe=Ee.entangledLanes|=Se;for(Ee=Ee.entanglements;Oe;){var je=31-sr(Oe),Xe=1<<je;Xe&Se|Ee[je]&Se&&(Ee[je]|=Se),Oe&=~Xe}}var Kt=0;function on(Ee){return Ee&=-Ee,1<Ee?4<Ee?Ee&268435455?16:536870912:4:1}var sn=ne.unstable_scheduleCallback,nn=ne.unstable_cancelCallback,mn=ne.unstable_shouldYield,yn=ne.unstable_requestPaint,vn=ne.unstable_now,Mn=ne.unstable_ImmediatePriority,Yn=ne.unstable_UserBlockingPriority,jn=ne.unstable_NormalPriority,Wn=ne.unstable_IdlePriority,ir=null,gr=null;function wr(Ee){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(ir,Ee,void 0,(Ee.current.flags&128)===128)}catch{}}function ei(Ee,Se){return Ee===Se&&(Ee!==0||1/Ee===1/Se)||Ee!==Ee&&Se!==Se}var Or=typeof Object.is=="function"?Object.is:ei,kr=null,Wi=!1,Qi=!1;function no(Ee){kr===null?kr=[Ee]:kr.push(Ee)}function Xi(Ee){Wi=!0,no(Ee)}function ui(){if(!Qi&&kr!==null){Qi=!0;var Ee=0,Se=Kt;try{var Oe=kr;for(Kt=1;Ee<Oe.length;Ee++){var je=Oe[Ee];do je=je(!0);while(je!==null)}kr=null,Wi=!1}catch(Xe){throw kr!==null&&(kr=kr.slice(Ee+1)),sn(Mn,ui),Xe}finally{Kt=Se,Qi=!1}}return null}var pi=[],Ci=0,jr=null,ro=0,qr=[],Yr=0,wi=null,Ei=1,Ir="";function Gr(Ee,Se){pi[Ci++]=ro,pi[Ci++]=jr,jr=Ee,ro=Se}function Kr(Ee,Se,Oe){qr[Yr++]=Ei,qr[Yr++]=Ir,qr[Yr++]=wi,wi=Ee;var je=Ei;Ee=Ir;var Xe=32-sr(je)-1;je&=~(1<<Xe),Oe+=1;var ut=32-sr(Se)+Xe;if(30<ut){var Rt=Xe-Xe%5;ut=(je&(1<<Rt)-1).toString(32),je>>=Rt,Xe-=Rt,Ei=1<<32-sr(Se)+Xe|Oe<<Xe|je,Ir=ut+Ee}else Ei=1<<ut|Oe<<Xe|je,Ir=Ee}function hi(Ee){Ee.return!==null&&(Gr(Ee,1),Kr(Ee,1,0))}function io(Ee){for(;Ee===jr;)jr=pi[--Ci],pi[Ci]=null,ro=pi[--Ci],pi[Ci]=null;for(;Ee===wi;)wi=qr[--Yr],qr[Yr]=null,Ir=qr[--Yr],qr[Yr]=null,Ei=qr[--Yr],qr[Yr]=null}var fi=null,mi=null,Mr=!1,go=!1,_i=null;function ya(Ee,Se){var Oe=vi(5,null,null,0);Oe.elementType="DELETED",Oe.stateNode=Se,Oe.return=Ee,Se=Ee.deletions,Se===null?(Ee.deletions=[Oe],Ee.flags|=16):Se.push(Oe)}function va(Ee,Se){switch(Ee.tag){case 5:return Se=pr(Se,Ee.type,Ee.pendingProps),Se!==null?(Ee.stateNode=Se,fi=Ee,mi=Er(Se),!0):!1;case 6:return Se=vr(Se,Ee.pendingProps),Se!==null?(Ee.stateNode=Se,fi=Ee,mi=null,!0):!1;case 13:if(Se=Nr(Se),Se!==null){var Oe=wi!==null?{id:Ei,overflow:Ir}:null;return Ee.memoizedState={dehydrated:Se,treeContext:Oe,retryLane:1073741824},Oe=vi(18,null,null,0),Oe.stateNode=Se,Oe.return=Ee,Ee.child=Oe,fi=Ee,mi=null,!0}return!1;default:return!1}}function xs(Ee){return(Ee.mode&1)!==0&&(Ee.flags&128)===0}function ys(Ee){if(Mr){var Se=mi;if(Se){var Oe=Se;if(!va(Ee,Se)){if(xs(Ee))throw Error(oe(418));Se=Kn(Oe);var je=fi;Se&&va(Ee,Se)?ya(je,Oe):(Ee.flags=Ee.flags&-4097|2,Mr=!1,fi=Ee)}}else{if(xs(Ee))throw Error(oe(418));Ee.flags=Ee.flags&-4097|2,Mr=!1,fi=Ee}}}function Ea(Ee){for(Ee=Ee.return;Ee!==null&&Ee.tag!==5&&Ee.tag!==3&&Ee.tag!==13;)Ee=Ee.return;fi=Ee}function Do(Ee){if(!zt||Ee!==fi)return!1;if(!Mr)return Ea(Ee),Mr=!0,!1;if(Ee.tag!==3&&(Ee.tag!==5||Dt(Ee.type)&&!Qe(Ee.type,Ee.memoizedProps))){var Se=mi;if(Se){if(xs(Ee))throw Sa(),Error(oe(418));for(;Se;)ya(Ee,Se),Se=Kn(Se)}}if(Ea(Ee),Ee.tag===13){if(!zt)throw Error(oe(316));if(Ee=Ee.memoizedState,Ee=Ee!==null?Ee.dehydrated:null,!Ee)throw Error(oe(317));mi=un(Ee)}else mi=fi?Kn(Ee.stateNode):null;return!0}function Sa(){for(var Ee=mi;Ee;)Ee=Kn(Ee)}function oo(){zt&&(mi=fi=null,go=Mr=!1)}function vs(Ee){_i===null?_i=[Ee]:_i.push(Ee)}var Yl=se.ReactCurrentBatchConfig;function Bo(Ee,Se){if(Or(Ee,Se))return!0;if(typeof Ee!="object"||Ee===null||typeof Se!="object"||Se===null)return!1;var Oe=Object.keys(Ee),je=Object.keys(Se);if(Oe.length!==je.length)return!1;for(je=0;je<Oe.length;je++){var Xe=Oe[je];if(!En.call(Se,Xe)||!Or(Ee[Xe],Se[Xe]))return!1}return!0}function Kl(Ee){switch(Ee.tag){case 5:return tn(Ee.type);case 16:return tn("Lazy");case 13:return tn("Suspense");case 19:return tn("SuspenseList");case 0:case 2:case 15:return Ee=An(Ee.type,!1),Ee;case 11:return Ee=An(Ee.type.render,!1),Ee;case 1:return Ee=An(Ee.type,!0),Ee;default:return""}}function Ao(Ee,Se,Oe){if(Ee=Oe.ref,Ee!==null&&typeof Ee!="function"&&typeof Ee!="object"){if(Oe._owner){if(Oe=Oe._owner,Oe){if(Oe.tag!==1)throw Error(oe(309));var je=Oe.stateNode}if(!je)throw Error(oe(147,Ee));var Xe=je,ut=""+Ee;return Se!==null&&Se.ref!==null&&typeof Se.ref=="function"&&Se.ref._stringRef===ut?Se.ref:(Se=function(Rt){var Zt=Xe.refs;Rt===null?delete Zt[ut]:Zt[ut]=Rt},Se._stringRef=ut,Se)}if(typeof Ee!="string")throw Error(oe(284));if(!Oe._owner)throw Error(oe(290,Ee))}return Ee}function Lo(Ee,Se){throw Ee=Object.prototype.toString.call(Se),Error(oe(31,Ee==="[object Object]"?"object with keys {"+Object.keys(Se).join(", ")+"}":Ee))}function Ta(Ee){var Se=Ee._init;return Se(Ee._payload)}function ba(Ee){function Se(ln,en){if(Ee){var gn=ln.deletions;gn===null?(ln.deletions=[en],ln.flags|=16):gn.push(en)}}function Oe(ln,en){if(!Ee)return null;for(;en!==null;)Se(ln,en),en=en.sibling;return null}function je(ln,en){for(ln=new Map;en!==null;)en.key!==null?ln.set(en.key,en):ln.set(en.index,en),en=en.sibling;return ln}function Xe(ln,en){return ln=Vi(ln,en),ln.index=0,ln.sibling=null,ln}function ut(ln,en,gn){return ln.index=gn,Ee?(gn=ln.alternate,gn!==null?(gn=gn.index,gn<en?(ln.flags|=2,en):gn):(ln.flags|=2,en)):(ln.flags|=1048576,en)}function Rt(ln){return Ee&&ln.alternate===null&&(ln.flags|=2),ln}function Zt(ln,en,gn,Gn){return en===null||en.tag!==6?(en=ma(gn,ln.mode,Gn),en.return=ln,en):(en=Xe(en,gn),en.return=ln,en)}function pn(ln,en,gn,Gn){var tr=gn.type;return tr===ce?Xn(ln,en,gn.props.children,Gn,gn.key):en!==null&&(en.elementType===tr||typeof tr=="object"&&tr!==null&&tr.$$typeof===ve&&Ta(tr)===en.type)?(Gn=Xe(en,gn.props),Gn.ref=Ao(ln,en,gn),Gn.return=ln,Gn):(Gn=hs(gn.type,gn.key,gn.props,null,ln.mode,Gn),Gn.ref=Ao(ln,en,gn),Gn.return=ln,Gn)}function Pn(ln,en,gn,Gn){return en===null||en.tag!==4||en.stateNode.containerInfo!==gn.containerInfo||en.stateNode.implementation!==gn.implementation?(en=ga(gn,ln.mode,Gn),en.return=ln,en):(en=Xe(en,gn.children||[]),en.return=ln,en)}function Xn(ln,en,gn,Gn,tr){return en===null||en.tag!==7?(en=to(gn,ln.mode,Gn,tr),en.return=ln,en):(en=Xe(en,gn),en.return=ln,en)}function ar(ln,en,gn){if(typeof en=="string"&&en!==""||typeof en=="number")return en=ma(""+en,ln.mode,gn),en.return=ln,en;if(typeof en=="object"&&en!==null){switch(en.$$typeof){case ae:return gn=hs(en.type,en.key,en.props,null,ln.mode,gn),gn.ref=Ao(ln,null,en),gn.return=ln,gn;case le:return en=ga(en,ln.mode,gn),en.return=ln,en;case ve:var Gn=en._init;return ar(ln,Gn(en._payload),gn)}if(He(en)||be(en))return en=to(en,ln.mode,gn,null),en.return=ln,en;Lo(ln,en)}return null}function $n(ln,en,gn,Gn){var tr=en!==null?en.key:null;if(typeof gn=="string"&&gn!==""||typeof gn=="number")return tr!==null?null:Zt(ln,en,""+gn,Gn);if(typeof gn=="object"&&gn!==null){switch(gn.$$typeof){case ae:return gn.key===tr?pn(ln,en,gn,Gn):null;case le:return gn.key===tr?Pn(ln,en,gn,Gn):null;case ve:return tr=gn._init,$n(ln,en,tr(gn._payload),Gn)}if(He(gn)||be(gn))return tr!==null?null:Xn(ln,en,gn,Gn,null);Lo(ln,gn)}return null}function br(ln,en,gn,Gn,tr){if(typeof Gn=="string"&&Gn!==""||typeof Gn=="number")return ln=ln.get(gn)||null,Zt(en,ln,""+Gn,tr);if(typeof Gn=="object"&&Gn!==null){switch(Gn.$$typeof){case ae:return ln=ln.get(Gn.key===null?gn:Gn.key)||null,pn(en,ln,Gn,tr);case le:return ln=ln.get(Gn.key===null?gn:Gn.key)||null,Pn(en,ln,Gn,tr);case ve:var dr=Gn._init;return br(ln,en,gn,dr(Gn._payload),tr)}if(He(Gn)||be(Gn))return ln=ln.get(gn)||null,Xn(en,ln,Gn,tr,null);Lo(en,Gn)}return null}function Tr(ln,en,gn,Gn){for(var tr=null,dr=null,ur=en,xr=en=0,Xr=null;ur!==null&&xr<gn.length;xr++){ur.index>xr?(Xr=ur,ur=null):Xr=ur.sibling;var yr=$n(ln,ur,gn[xr],Gn);if(yr===null){ur===null&&(ur=Xr);break}Ee&&ur&&yr.alternate===null&&Se(ln,ur),en=ut(yr,en,xr),dr===null?tr=yr:dr.sibling=yr,dr=yr,ur=Xr}if(xr===gn.length)return Oe(ln,ur),Mr&&Gr(ln,xr),tr;if(ur===null){for(;xr<gn.length;xr++)ur=ar(ln,gn[xr],Gn),ur!==null&&(en=ut(ur,en,xr),dr===null?tr=ur:dr.sibling=ur,dr=ur);return Mr&&Gr(ln,xr),tr}for(ur=je(ln,ur);xr<gn.length;xr++)Xr=br(ur,ln,xr,gn[xr],Gn),Xr!==null&&(Ee&&Xr.alternate!==null&&ur.delete(Xr.key===null?xr:Xr.key),en=ut(Xr,en,xr),dr===null?tr=Xr:dr.sibling=Xr,dr=Xr);return Ee&&ur.forEach(function(ji){return Se(ln,ji)}),Mr&&Gr(ln,xr),tr}function ci(ln,en,gn,Gn){var tr=be(gn);if(typeof tr!="function")throw Error(oe(150));if(gn=tr.call(gn),gn==null)throw Error(oe(151));for(var dr=tr=null,ur=en,xr=en=0,Xr=null,yr=gn.next();ur!==null&&!yr.done;xr++,yr=gn.next()){ur.index>xr?(Xr=ur,ur=null):Xr=ur.sibling;var ji=$n(ln,ur,yr.value,Gn);if(ji===null){ur===null&&(ur=Xr);break}Ee&&ur&&ji.alternate===null&&Se(ln,ur),en=ut(ji,en,xr),dr===null?tr=ji:dr.sibling=ji,dr=ji,ur=Xr}if(yr.done)return Oe(ln,ur),Mr&&Gr(ln,xr),tr;if(ur===null){for(;!yr.done;xr++,yr=gn.next())yr=ar(ln,yr.value,Gn),yr!==null&&(en=ut(yr,en,xr),dr===null?tr=yr:dr.sibling=yr,dr=yr);return Mr&&Gr(ln,xr),tr}for(ur=je(ln,ur);!yr.done;xr++,yr=gn.next())yr=br(ur,ln,xr,yr.value,Gn),yr!==null&&(Ee&&yr.alternate!==null&&ur.delete(yr.key===null?xr:yr.key),en=ut(yr,en,xr),dr===null?tr=yr:dr.sibling=yr,dr=yr);return Ee&&ur.forEach(function(wc){return Se(ln,wc)}),Mr&&Gr(ln,xr),tr}function ki(ln,en,gn,Gn){if(typeof gn=="object"&&gn!==null&&gn.type===ce&&gn.key===null&&(gn=gn.props.children),typeof gn=="object"&&gn!==null){switch(gn.$$typeof){case ae:e:{for(var tr=gn.key,dr=en;dr!==null;){if(dr.key===tr){if(tr=gn.type,tr===ce){if(dr.tag===7){Oe(ln,dr.sibling),en=Xe(dr,gn.props.children),en.return=ln,ln=en;break e}}else if(dr.elementType===tr||typeof tr=="object"&&tr!==null&&tr.$$typeof===ve&&Ta(tr)===dr.type){Oe(ln,dr.sibling),en=Xe(dr,gn.props),en.ref=Ao(ln,dr,gn),en.return=ln,ln=en;break e}Oe(ln,dr);break}else Se(ln,dr);dr=dr.sibling}gn.type===ce?(en=to(gn.props.children,ln.mode,Gn,gn.key),en.return=ln,ln=en):(Gn=hs(gn.type,gn.key,gn.props,null,ln.mode,Gn),Gn.ref=Ao(ln,en,gn),Gn.return=ln,ln=Gn)}return Rt(ln);case le:e:{for(dr=gn.key;en!==null;){if(en.key===dr)if(en.tag===4&&en.stateNode.containerInfo===gn.containerInfo&&en.stateNode.implementation===gn.implementation){Oe(ln,en.sibling),en=Xe(en,gn.children||[]),en.return=ln,ln=en;break e}else{Oe(ln,en);break}else Se(ln,en);en=en.sibling}en=ga(gn,ln.mode,Gn),en.return=ln,ln=en}return Rt(ln);case ve:return dr=gn._init,ki(ln,en,dr(gn._payload),Gn)}if(He(gn))return Tr(ln,en,gn,Gn);if(be(gn))return ci(ln,en,gn,Gn);Lo(ln,gn)}return typeof gn=="string"&&gn!==""||typeof gn=="number"?(gn=""+gn,en!==null&&en.tag===6?(Oe(ln,en.sibling),en=Xe(en,gn),en.return=ln,ln=en):(Oe(ln,en),en=ma(gn,ln.mode,Gn),en.return=ln,ln=en),Rt(ln)):Oe(ln,en)}return ki}var so=ba(!0),Ca=ba(!1),No=Cn(null),Oo=null,ao=null,Es=null;function _s(){Es=ao=Oo=null}function wa(Ee,Se,Oe){St?(bn(No,Se._currentValue),Se._currentValue=Oe):(bn(No,Se._currentValue2),Se._currentValue2=Oe)}function Ss(Ee){var Se=No.current;wn(No),St?Ee._currentValue=Se:Ee._currentValue2=Se}function Ts(Ee,Se,Oe){for(;Ee!==null;){var je=Ee.alternate;if((Ee.childLanes&Se)!==Se?(Ee.childLanes|=Se,je!==null&&(je.childLanes|=Se)):je!==null&&(je.childLanes&Se)!==Se&&(je.childLanes|=Se),Ee===Oe)break;Ee=Ee.return}}function lo(Ee,Se){Oo=Ee,Es=ao=null,Ee=Ee.dependencies,Ee!==null&&Ee.firstContext!==null&&(Ee.lanes&Se&&(si=!0),Ee.firstContext=null)}function gi(Ee){var Se=St?Ee._currentValue:Ee._currentValue2;if(Es!==Ee)if(Ee={context:Ee,memoizedValue:Se,next:null},ao===null){if(Oo===null)throw Error(oe(308));ao=Ee,Oo.dependencies={lanes:0,firstContext:Ee}}else ao=ao.next=Ee;return Se}var qi=null;function bs(Ee){qi===null?qi=[Ee]:qi.push(Ee)}function Ia(Ee,Se,Oe,je){var Xe=Se.interleaved;return Xe===null?(Oe.next=Oe,bs(Se)):(Oe.next=Xe.next,Xe.next=Oe),Se.interleaved=Oe,Ii(Ee,je)}function Ii(Ee,Se){Ee.lanes|=Se;var Oe=Ee.alternate;for(Oe!==null&&(Oe.lanes|=Se),Oe=Ee,Ee=Ee.return;Ee!==null;)Ee.childLanes|=Se,Oe=Ee.alternate,Oe!==null&&(Oe.childLanes|=Se),Oe=Ee,Ee=Ee.return;return Oe.tag===3?Oe.stateNode:null}var Fi=!1;function Cs(Ee){Ee.updateQueue={baseState:Ee.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ma(Ee,Se){Ee=Ee.updateQueue,Se.updateQueue===Ee&&(Se.updateQueue={baseState:Ee.baseState,firstBaseUpdate:Ee.firstBaseUpdate,lastBaseUpdate:Ee.lastBaseUpdate,shared:Ee.shared,effects:Ee.effects})}function Li(Ee,Se){return{eventTime:Ee,lane:Se,tag:0,payload:null,callback:null,next:null}}function $i(Ee,Se,Oe){var je=Ee.updateQueue;if(je===null)return null;if(je=je.shared,Ar&2){var Xe=je.pending;return Xe===null?Se.next=Se:(Se.next=Xe.next,Xe.next=Se),je.pending=Se,Ii(Ee,Oe)}return Xe=je.interleaved,Xe===null?(Se.next=Se,bs(je)):(Se.next=Xe.next,Xe.next=Se),je.interleaved=Se,Ii(Ee,Oe)}function ko(Ee,Se,Oe){if(Se=Se.updateQueue,Se!==null&&(Se=Se.shared,(Oe&4194240)!==0)){var je=Se.lanes;je&=Ee.pendingLanes,Oe|=je,Se.lanes=Oe,an(Ee,Oe)}}function Ra(Ee,Se){var Oe=Ee.updateQueue,je=Ee.alternate;if(je!==null&&(je=je.updateQueue,Oe===je)){var Xe=null,ut=null;if(Oe=Oe.firstBaseUpdate,Oe!==null){do{var Rt={eventTime:Oe.eventTime,lane:Oe.lane,tag:Oe.tag,payload:Oe.payload,callback:Oe.callback,next:null};ut===null?Xe=ut=Rt:ut=ut.next=Rt,Oe=Oe.next}while(Oe!==null);ut===null?Xe=ut=Se:ut=ut.next=Se}else Xe=ut=Se;Oe={baseState:je.baseState,firstBaseUpdate:Xe,lastBaseUpdate:ut,shared:je.shared,effects:je.effects},Ee.updateQueue=Oe;return}Ee=Oe.lastBaseUpdate,Ee===null?Oe.firstBaseUpdate=Se:Ee.next=Se,Oe.lastBaseUpdate=Se}function Fo(Ee,Se,Oe,je){var Xe=Ee.updateQueue;Fi=!1;var ut=Xe.firstBaseUpdate,Rt=Xe.lastBaseUpdate,Zt=Xe.shared.pending;if(Zt!==null){Xe.shared.pending=null;var pn=Zt,Pn=pn.next;pn.next=null,Rt===null?ut=Pn:Rt.next=Pn,Rt=pn;var Xn=Ee.alternate;Xn!==null&&(Xn=Xn.updateQueue,Zt=Xn.lastBaseUpdate,Zt!==Rt&&(Zt===null?Xn.firstBaseUpdate=Pn:Zt.next=Pn,Xn.lastBaseUpdate=pn))}if(ut!==null){var ar=Xe.baseState;Rt=0,Xn=Pn=pn=null,Zt=ut;do{var $n=Zt.lane,br=Zt.eventTime;if((je&$n)===$n){Xn!==null&&(Xn=Xn.next={eventTime:br,lane:0,tag:Zt.tag,payload:Zt.payload,callback:Zt.callback,next:null});e:{var Tr=Ee,ci=Zt;switch($n=Se,br=Oe,ci.tag){case 1:if(Tr=ci.payload,typeof Tr=="function"){ar=Tr.call(br,ar,$n);break e}ar=Tr;break e;case 3:Tr.flags=Tr.flags&-65537|128;case 0:if(Tr=ci.payload,$n=typeof Tr=="function"?Tr.call(br,ar,$n):Tr,$n==null)break e;ar=ie({},ar,$n);break e;case 2:Fi=!0}}Zt.callback!==null&&Zt.lane!==0&&(Ee.flags|=64,$n=Xe.effects,$n===null?Xe.effects=[Zt]:$n.push(Zt))}else br={eventTime:br,lane:$n,tag:Zt.tag,payload:Zt.payload,callback:Zt.callback,next:null},Xn===null?(Pn=Xn=br,pn=ar):Xn=Xn.next=br,Rt|=$n;if(Zt=Zt.next,Zt===null){if(Zt=Xe.shared.pending,Zt===null)break;$n=Zt,Zt=$n.next,$n.next=null,Xe.lastBaseUpdate=$n,Xe.shared.pending=null}}while(!0);if(Xn===null&&(pn=ar),Xe.baseState=pn,Xe.firstBaseUpdate=Pn,Xe.lastBaseUpdate=Xn,Se=Xe.shared.interleaved,Se!==null){Xe=Se;do Rt|=Xe.lane,Xe=Xe.next;while(Xe!==Se)}else ut===null&&(Xe.shared.lanes=0);Ki|=Rt,Ee.lanes=Rt,Ee.memoizedState=ar}}function Pa(Ee,Se,Oe){if(Ee=Se.effects,Se.effects=null,Ee!==null)for(Se=0;Se<Ee.length;Se++){var je=Ee[Se],Xe=je.callback;if(Xe!==null){if(je.callback=null,je=Oe,typeof Xe!="function")throw Error(oe(191,Xe));Xe.call(je)}}}var xo={},Ai=Cn(xo),yo=Cn(xo),co=Cn(xo);function Mi(Ee){if(Ee===xo)throw Error(oe(174));return Ee}function ws(Ee,Se){bn(co,Se),bn(yo,Ee),bn(Ai,xo),Ee=Ke(Se),wn(Ai),bn(Ai,Ee)}function uo(){wn(Ai),wn(yo),wn(co)}function Da(Ee){var Se=Mi(co.current),Oe=Mi(Ai.current);Se=tt(Oe,Ee.type,Se),Oe!==Se&&(bn(yo,Ee),bn(Ai,Se))}function Is(Ee){yo.current===Ee&&(wn(Ai),wn(yo))}var Br=Cn(0);function $o(Ee){for(var Se=Ee;Se!==null;){if(Se.tag===13){var Oe=Se.memoizedState;if(Oe!==null&&(Oe=Oe.dehydrated,Oe===null||Sr(Oe)||Pr(Oe)))return Se}else if(Se.tag===19&&Se.memoizedProps.revealOrder!==void 0){if(Se.flags&128)return Se}else if(Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===Ee)break;for(;Se.sibling===null;){if(Se.return===null||Se.return===Ee)return null;Se=Se.return}Se.sibling.return=Se.return,Se=Se.sibling}return null}var Ms=[];function Rs(){for(var Ee=0;Ee<Ms.length;Ee++){var Se=Ms[Ee];St?Se._workInProgressVersionPrimary=null:Se._workInProgressVersionSecondary=null}Ms.length=0}var Uo=se.ReactCurrentDispatcher,Ps=se.ReactCurrentBatchConfig,Yi=0,Lr=null,zr=null,Wr=null,Go=!1,vo=!1,Eo=0,Jl=0;function ti(){throw Error(oe(321))}function Ds(Ee,Se){if(Se===null)return!1;for(var Oe=0;Oe<Se.length&&Oe<Ee.length;Oe++)if(!Or(Ee[Oe],Se[Oe]))return!1;return!0}function Bs(Ee,Se,Oe,je,Xe,ut){if(Yi=ut,Lr=Se,Se.memoizedState=null,Se.updateQueue=null,Se.lanes=0,Uo.current=Ee===null||Ee.memoizedState===null?nc:rc,Ee=Oe(je,Xe),vo){ut=0;do{if(vo=!1,Eo=0,25<=ut)throw Error(oe(301));ut+=1,Wr=zr=null,Se.updateQueue=null,Uo.current=ic,Ee=Oe(je,Xe)}while(vo)}if(Uo.current=Vo,Se=zr!==null&&zr.next!==null,Yi=0,Wr=zr=Lr=null,Go=!1,Se)throw Error(oe(300));return Ee}function Ls(){var Ee=Eo!==0;return Eo=0,Ee}function Ri(){var Ee={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?Lr.memoizedState=Wr=Ee:Wr=Wr.next=Ee,Wr}function xi(){if(zr===null){var Ee=Lr.alternate;Ee=Ee!==null?Ee.memoizedState:null}else Ee=zr.next;var Se=Wr===null?Lr.memoizedState:Wr.next;if(Se!==null)Wr=Se,zr=Ee;else{if(Ee===null)throw Error(oe(310));zr=Ee,Ee={memoizedState:zr.memoizedState,baseState:zr.baseState,baseQueue:zr.baseQueue,queue:zr.queue,next:null},Wr===null?Lr.memoizedState=Wr=Ee:Wr=Wr.next=Ee}return Wr}function _o(Ee,Se){return typeof Se=="function"?Se(Ee):Se}function Ns(Ee){var Se=xi(),Oe=Se.queue;if(Oe===null)throw Error(oe(311));Oe.lastRenderedReducer=Ee;var je=zr,Xe=je.baseQueue,ut=Oe.pending;if(ut!==null){if(Xe!==null){var Rt=Xe.next;Xe.next=ut.next,ut.next=Rt}je.baseQueue=Xe=ut,Oe.pending=null}if(Xe!==null){ut=Xe.next,je=je.baseState;var Zt=Rt=null,pn=null,Pn=ut;do{var Xn=Pn.lane;if((Yi&Xn)===Xn)pn!==null&&(pn=pn.next={lane:0,action:Pn.action,hasEagerState:Pn.hasEagerState,eagerState:Pn.eagerState,next:null}),je=Pn.hasEagerState?Pn.eagerState:Ee(je,Pn.action);else{var ar={lane:Xn,action:Pn.action,hasEagerState:Pn.hasEagerState,eagerState:Pn.eagerState,next:null};pn===null?(Zt=pn=ar,Rt=je):pn=pn.next=ar,Lr.lanes|=Xn,Ki|=Xn}Pn=Pn.next}while(Pn!==null&&Pn!==ut);pn===null?Rt=je:pn.next=Zt,Or(je,Se.memoizedState)||(si=!0),Se.memoizedState=je,Se.baseState=Rt,Se.baseQueue=pn,Oe.lastRenderedState=je}if(Ee=Oe.interleaved,Ee!==null){Xe=Ee;do ut=Xe.lane,Lr.lanes|=ut,Ki|=ut,Xe=Xe.next;while(Xe!==Ee)}else Xe===null&&(Oe.lanes=0);return[Se.memoizedState,Oe.dispatch]}function Os(Ee){var Se=xi(),Oe=Se.queue;if(Oe===null)throw Error(oe(311));Oe.lastRenderedReducer=Ee;var je=Oe.dispatch,Xe=Oe.pending,ut=Se.memoizedState;if(Xe!==null){Oe.pending=null;var Rt=Xe=Xe.next;do ut=Ee(ut,Rt.action),Rt=Rt.next;while(Rt!==Xe);Or(ut,Se.memoizedState)||(si=!0),Se.memoizedState=ut,Se.baseQueue===null&&(Se.baseState=ut),Oe.lastRenderedState=ut}return[ut,je]}function Ba(){}function La(Ee,Se){var Oe=Lr,je=xi(),Xe=Se(),ut=!Or(je.memoizedState,Xe);if(ut&&(je.memoizedState=Xe,si=!0),je=je.queue,ks(ka.bind(null,Oe,je,Ee),[Ee]),je.getSnapshot!==Se||ut||Wr!==null&&Wr.memoizedState.tag&1){if(Oe.flags|=2048,So(9,Oa.bind(null,Oe,je,Xe,Se),void 0,null),Qr===null)throw Error(oe(349));Yi&30||Na(Oe,Se,Xe)}return Xe}function Na(Ee,Se,Oe){Ee.flags|=16384,Ee={getSnapshot:Se,value:Oe},Se=Lr.updateQueue,Se===null?(Se={lastEffect:null,stores:null},Lr.updateQueue=Se,Se.stores=[Ee]):(Oe=Se.stores,Oe===null?Se.stores=[Ee]:Oe.push(Ee))}function Oa(Ee,Se,Oe,je){Se.value=Oe,Se.getSnapshot=je,Fa(Se)&&$a(Ee)}function ka(Ee,Se,Oe){return Oe(function(){Fa(Se)&&$a(Ee)})}function Fa(Ee){var Se=Ee.getSnapshot;Ee=Ee.value;try{var Oe=Se();return!Or(Ee,Oe)}catch{return!0}}function $a(Ee){var Se=Ii(Ee,1);Se!==null&&yi(Se,Ee,1,-1)}function Ua(Ee){var Se=Ri();return typeof Ee=="function"&&(Ee=Ee()),Se.memoizedState=Se.baseState=Ee,Ee={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_o,lastRenderedState:Ee},Se.queue=Ee,Ee=Ee.dispatch=tc.bind(null,Lr,Ee),[Se.memoizedState,Ee]}function So(Ee,Se,Oe,je){return Ee={tag:Ee,create:Se,destroy:Oe,deps:je,next:null},Se=Lr.updateQueue,Se===null?(Se={lastEffect:null,stores:null},Lr.updateQueue=Se,Se.lastEffect=Ee.next=Ee):(Oe=Se.lastEffect,Oe===null?Se.lastEffect=Ee.next=Ee:(je=Oe.next,Oe.next=Ee,Ee.next=je,Se.lastEffect=Ee)),Ee}function Ga(){return xi().memoizedState}function zo(Ee,Se,Oe,je){var Xe=Ri();Lr.flags|=Ee,Xe.memoizedState=So(1|Se,Oe,void 0,je===void 0?null:je)}function Ho(Ee,Se,Oe,je){var Xe=xi();je=je===void 0?null:je;var ut=void 0;if(zr!==null){var Rt=zr.memoizedState;if(ut=Rt.destroy,je!==null&&Ds(je,Rt.deps)){Xe.memoizedState=So(Se,Oe,ut,je);return}}Lr.flags|=Ee,Xe.memoizedState=So(1|Se,Oe,ut,je)}function za(Ee,Se){return zo(8390656,8,Ee,Se)}function ks(Ee,Se){return Ho(2048,8,Ee,Se)}function Ha(Ee,Se){return Ho(4,2,Ee,Se)}function Va(Ee,Se){return Ho(4,4,Ee,Se)}function ja(Ee,Se){if(typeof Se=="function")return Ee=Ee(),Se(Ee),function(){Se(null)};if(Se!=null)return Ee=Ee(),Se.current=Ee,function(){Se.current=null}}function Wa(Ee,Se,Oe){return Oe=Oe!=null?Oe.concat([Ee]):null,Ho(4,4,ja.bind(null,Se,Ee),Oe)}function Fs(){}function Qa(Ee,Se){var Oe=xi();Se=Se===void 0?null:Se;var je=Oe.memoizedState;return je!==null&&Se!==null&&Ds(Se,je[1])?je[0]:(Oe.memoizedState=[Ee,Se],Ee)}function Xa(Ee,Se){var Oe=xi();Se=Se===void 0?null:Se;var je=Oe.memoizedState;return je!==null&&Se!==null&&Ds(Se,je[1])?je[0]:(Ee=Ee(),Oe.memoizedState=[Ee,Se],Ee)}function qa(Ee,Se,Oe){return Yi&21?(Or(Oe,Se)||(Oe=qe(),Lr.lanes|=Oe,Ki|=Oe,Ee.baseState=!0),Se):(Ee.baseState&&(Ee.baseState=!1,si=!0),Ee.memoizedState=Oe)}function Zl(Ee,Se){var Oe=Kt;Kt=Oe!==0&&4>Oe?Oe:4,Ee(!0);var je=Ps.transition;Ps.transition={};try{Ee(!1),Se()}finally{Kt=Oe,Ps.transition=je}}function Ya(){return xi().memoizedState}function ec(Ee,Se,Oe){var je=zi(Ee);if(Oe={lane:je,action:Oe,hasEagerState:!1,eagerState:null,next:null},Ka(Ee))Ja(Se,Oe);else if(Oe=Ia(Ee,Se,Oe,je),Oe!==null){var Xe=ii();yi(Oe,Ee,je,Xe),Za(Oe,Se,je)}}function tc(Ee,Se,Oe){var je=zi(Ee),Xe={lane:je,action:Oe,hasEagerState:!1,eagerState:null,next:null};if(Ka(Ee))Ja(Se,Xe);else{var ut=Ee.alternate;if(Ee.lanes===0&&(ut===null||ut.lanes===0)&&(ut=Se.lastRenderedReducer,ut!==null))try{var Rt=Se.lastRenderedState,Zt=ut(Rt,Oe);if(Xe.hasEagerState=!0,Xe.eagerState=Zt,Or(Zt,Rt)){var pn=Se.interleaved;pn===null?(Xe.next=Xe,bs(Se)):(Xe.next=pn.next,pn.next=Xe),Se.interleaved=Xe;return}}catch{}finally{}Oe=Ia(Ee,Se,Xe,je),Oe!==null&&(Xe=ii(),yi(Oe,Ee,je,Xe),Za(Oe,Se,je))}}function Ka(Ee){var Se=Ee.alternate;return Ee===Lr||Se!==null&&Se===Lr}function Ja(Ee,Se){vo=Go=!0;var Oe=Ee.pending;Oe===null?Se.next=Se:(Se.next=Oe.next,Oe.next=Se),Ee.pending=Se}function Za(Ee,Se,Oe){if(Oe&4194240){var je=Se.lanes;je&=Ee.pendingLanes,Oe|=je,Se.lanes=Oe,an(Ee,Oe)}}var Vo={readContext:gi,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useInsertionEffect:ti,useLayoutEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useMutableSource:ti,useSyncExternalStore:ti,useId:ti,unstable_isNewReconciler:!1},nc={readContext:gi,useCallback:function(Ee,Se){return Ri().memoizedState=[Ee,Se===void 0?null:Se],Ee},useContext:gi,useEffect:za,useImperativeHandle:function(Ee,Se,Oe){return Oe=Oe!=null?Oe.concat([Ee]):null,zo(4194308,4,ja.bind(null,Se,Ee),Oe)},useLayoutEffect:function(Ee,Se){return zo(4194308,4,Ee,Se)},useInsertionEffect:function(Ee,Se){return zo(4,2,Ee,Se)},useMemo:function(Ee,Se){var Oe=Ri();return Se=Se===void 0?null:Se,Ee=Ee(),Oe.memoizedState=[Ee,Se],Ee},useReducer:function(Ee,Se,Oe){var je=Ri();return Se=Oe!==void 0?Oe(Se):Se,je.memoizedState=je.baseState=Se,Ee={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ee,lastRenderedState:Se},je.queue=Ee,Ee=Ee.dispatch=ec.bind(null,Lr,Ee),[je.memoizedState,Ee]},useRef:function(Ee){var Se=Ri();return Ee={current:Ee},Se.memoizedState=Ee},useState:Ua,useDebugValue:Fs,useDeferredValue:function(Ee){return Ri().memoizedState=Ee},useTransition:function(){var Ee=Ua(!1),Se=Ee[0];return Ee=Zl.bind(null,Ee[1]),Ri().memoizedState=Ee,[Se,Ee]},useMutableSource:function(){},useSyncExternalStore:function(Ee,Se,Oe){var je=Lr,Xe=Ri();if(Mr){if(Oe===void 0)throw Error(oe(407));Oe=Oe()}else{if(Oe=Se(),Qr===null)throw Error(oe(349));Yi&30||Na(je,Se,Oe)}Xe.memoizedState=Oe;var ut={value:Oe,getSnapshot:Se};return Xe.queue=ut,za(ka.bind(null,je,ut,Ee),[Ee]),je.flags|=2048,So(9,Oa.bind(null,je,ut,Oe,Se),void 0,null),Oe},useId:function(){var Ee=Ri(),Se=Qr.identifierPrefix;if(Mr){var Oe=Ir,je=Ei;Oe=(je&~(1<<32-sr(je)-1)).toString(32)+Oe,Se=":"+Se+"R"+Oe,Oe=Eo++,0<Oe&&(Se+="H"+Oe.toString(32)),Se+=":"}else Oe=Jl++,Se=":"+Se+"r"+Oe.toString(32)+":";return Ee.memoizedState=Se},unstable_isNewReconciler:!1},rc={readContext:gi,useCallback:Qa,useContext:gi,useEffect:ks,useImperativeHandle:Wa,useInsertionEffect:Ha,useLayoutEffect:Va,useMemo:Xa,useReducer:Ns,useRef:Ga,useState:function(){return Ns(_o)},useDebugValue:Fs,useDeferredValue:function(Ee){var Se=xi();return qa(Se,zr.memoizedState,Ee)},useTransition:function(){var Ee=Ns(_o)[0],Se=xi().memoizedState;return[Ee,Se]},useMutableSource:Ba,useSyncExternalStore:La,useId:Ya,unstable_isNewReconciler:!1},ic={readContext:gi,useCallback:Qa,useContext:gi,useEffect:ks,useImperativeHandle:Wa,useInsertionEffect:Ha,useLayoutEffect:Va,useMemo:Xa,useReducer:Os,useRef:Ga,useState:function(){return Os(_o)},useDebugValue:Fs,useDeferredValue:function(Ee){var Se=xi();return zr===null?Se.memoizedState=Ee:qa(Se,zr.memoizedState,Ee)},useTransition:function(){var Ee=Os(_o)[0],Se=xi().memoizedState;return[Ee,Se]},useMutableSource:Ba,useSyncExternalStore:La,useId:Ya,unstable_isNewReconciler:!1};function Si(Ee,Se){if(Ee&&Ee.defaultProps){Se=ie({},Se),Ee=Ee.defaultProps;for(var Oe in Ee)Se[Oe]===void 0&&(Se[Oe]=Ee[Oe]);return Se}return Se}function $s(Ee,Se,Oe,je){Se=Ee.memoizedState,Oe=Oe(je,Se),Oe=Oe==null?Se:ie({},Se,Oe),Ee.memoizedState=Oe,Ee.lanes===0&&(Ee.updateQueue.baseState=Oe)}var jo={isMounted:function(Ee){return(Ee=Ee._reactInternals)?Pe(Ee)===Ee:!1},enqueueSetState:function(Ee,Se,Oe){Ee=Ee._reactInternals;var je=ii(),Xe=zi(Ee),ut=Li(je,Xe);ut.payload=Se,Oe!=null&&(ut.callback=Oe),Se=$i(Ee,ut,Xe),Se!==null&&(yi(Se,Ee,Xe,je),ko(Se,Ee,Xe))},enqueueReplaceState:function(Ee,Se,Oe){Ee=Ee._reactInternals;var je=ii(),Xe=zi(Ee),ut=Li(je,Xe);ut.tag=1,ut.payload=Se,Oe!=null&&(ut.callback=Oe),Se=$i(Ee,ut,Xe),Se!==null&&(yi(Se,Ee,Xe,je),ko(Se,Ee,Xe))},enqueueForceUpdate:function(Ee,Se){Ee=Ee._reactInternals;var Oe=ii(),je=zi(Ee),Xe=Li(Oe,je);Xe.tag=2,Se!=null&&(Xe.callback=Se),Se=$i(Ee,Xe,je),Se!==null&&(yi(Se,Ee,je,Oe),ko(Se,Ee,je))}};function tl(Ee,Se,Oe,je,Xe,ut,Rt){return Ee=Ee.stateNode,typeof Ee.shouldComponentUpdate=="function"?Ee.shouldComponentUpdate(je,ut,Rt):Se.prototype&&Se.prototype.isPureReactComponent?!Bo(Oe,je)||!Bo(Xe,ut):!0}function nl(Ee,Se,Oe){var je=!1,Xe=nr,ut=Se.contextType;return typeof ut=="object"&&ut!==null?ut=gi(ut):(Xe=zn(Se)?Nn:Fn.current,je=Se.contextTypes,ut=(je=je!=null)?mr(Ee,Xe):nr),Se=new Se(Oe,ut),Ee.memoizedState=Se.state!==null&&Se.state!==void 0?Se.state:null,Se.updater=jo,Ee.stateNode=Se,Se._reactInternals=Ee,je&&(Ee=Ee.stateNode,Ee.__reactInternalMemoizedUnmaskedChildContext=Xe,Ee.__reactInternalMemoizedMaskedChildContext=ut),Se}function rl(Ee,Se,Oe,je){Ee=Se.state,typeof Se.componentWillReceiveProps=="function"&&Se.componentWillReceiveProps(Oe,je),typeof Se.UNSAFE_componentWillReceiveProps=="function"&&Se.UNSAFE_componentWillReceiveProps(Oe,je),Se.state!==Ee&&jo.enqueueReplaceState(Se,Se.state,null)}function Us(Ee,Se,Oe,je){var Xe=Ee.stateNode;Xe.props=Oe,Xe.state=Ee.memoizedState,Xe.refs={},Cs(Ee);var ut=Se.contextType;typeof ut=="object"&&ut!==null?Xe.context=gi(ut):(ut=zn(Se)?Nn:Fn.current,Xe.context=mr(Ee,ut)),Xe.state=Ee.memoizedState,ut=Se.getDerivedStateFromProps,typeof ut=="function"&&($s(Ee,Se,ut,Oe),Xe.state=Ee.memoizedState),typeof Se.getDerivedStateFromProps=="function"||typeof Xe.getSnapshotBeforeUpdate=="function"||typeof Xe.UNSAFE_componentWillMount!="function"&&typeof Xe.componentWillMount!="function"||(Se=Xe.state,typeof Xe.componentWillMount=="function"&&Xe.componentWillMount(),typeof Xe.UNSAFE_componentWillMount=="function"&&Xe.UNSAFE_componentWillMount(),Se!==Xe.state&&jo.enqueueReplaceState(Xe,Xe.state,null),Fo(Ee,Oe,Xe,je),Xe.state=Ee.memoizedState),typeof Xe.componentDidMount=="function"&&(Ee.flags|=4194308)}function fo(Ee,Se){try{var Oe="",je=Se;do Oe+=Kl(je),je=je.return;while(je);var Xe=Oe}catch(ut){Xe=`
Error generating stack: `+ut.message+`
`+ut.stack}return{value:Ee,source:Se,stack:Xe,digest:null}}function Gs(Ee,Se,Oe){return{value:Ee,source:null,stack:Oe??null,digest:Se??null}}function zs(Ee,Se){try{console.error(Se.value)}catch(Oe){setTimeout(function(){throw Oe})}}var oc=typeof WeakMap=="function"?WeakMap:Map;function il(Ee,Se,Oe){Oe=Li(-1,Oe),Oe.tag=3,Oe.payload={element:null};var je=Se.value;return Oe.callback=function(){ls||(ls=!0,la=je),zs(Ee,Se)},Oe}function ol(Ee,Se,Oe){Oe=Li(-1,Oe),Oe.tag=3;var je=Ee.type.getDerivedStateFromError;if(typeof je=="function"){var Xe=Se.value;Oe.payload=function(){return je(Xe)},Oe.callback=function(){zs(Ee,Se)}}var ut=Ee.stateNode;return ut!==null&&typeof ut.componentDidCatch=="function"&&(Oe.callback=function(){zs(Ee,Se),typeof je!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var Rt=Se.stack;this.componentDidCatch(Se.value,{componentStack:Rt!==null?Rt:""})}),Oe}function sl(Ee,Se,Oe){var je=Ee.pingCache;if(je===null){je=Ee.pingCache=new oc;var Xe=new Set;je.set(Se,Xe)}else Xe=je.get(Se),Xe===void 0&&(Xe=new Set,je.set(Se,Xe));Xe.has(Oe)||(Xe.add(Oe),Ee=yc.bind(null,Ee,Se,Oe),Se.then(Ee,Ee))}function al(Ee){do{var Se;if((Se=Ee.tag===13)&&(Se=Ee.memoizedState,Se=Se!==null?Se.dehydrated!==null:!0),Se)return Ee;Ee=Ee.return}while(Ee!==null);return null}function ll(Ee,Se,Oe,je,Xe){return Ee.mode&1?(Ee.flags|=65536,Ee.lanes=Xe,Ee):(Ee===Se?Ee.flags|=65536:(Ee.flags|=128,Oe.flags|=131072,Oe.flags&=-52805,Oe.tag===1&&(Oe.alternate===null?Oe.tag=17:(Se=Li(-1,1),Se.tag=2,$i(Oe,Se,1))),Oe.lanes|=1),Ee)}var sc=se.ReactCurrentOwner,si=!1;function oi(Ee,Se,Oe,je){Se.child=Ee===null?Ca(Se,null,Oe,je):so(Se,Ee.child,Oe,je)}function cl(Ee,Se,Oe,je,Xe){Oe=Oe.render;var ut=Se.ref;return lo(Se,Xe),je=Bs(Ee,Se,Oe,je,ut,Xe),Oe=Ls(),Ee!==null&&!si?(Se.updateQueue=Ee.updateQueue,Se.flags&=-2053,Ee.lanes&=~Xe,Ni(Ee,Se,Xe)):(Mr&&Oe&&hi(Se),Se.flags|=1,oi(Ee,Se,je,Xe),Se.child)}function ul(Ee,Se,Oe,je,Xe){if(Ee===null){var ut=Oe.type;return typeof ut=="function"&&!ha(ut)&&ut.defaultProps===void 0&&Oe.compare===null&&Oe.defaultProps===void 0?(Se.tag=15,Se.type=ut,dl(Ee,Se,ut,je,Xe)):(Ee=hs(Oe.type,null,je,Se,Se.mode,Xe),Ee.ref=Se.ref,Ee.return=Se,Se.child=Ee)}if(ut=Ee.child,!(Ee.lanes&Xe)){var Rt=ut.memoizedProps;if(Oe=Oe.compare,Oe=Oe!==null?Oe:Bo,Oe(Rt,je)&&Ee.ref===Se.ref)return Ni(Ee,Se,Xe)}return Se.flags|=1,Ee=Vi(ut,je),Ee.ref=Se.ref,Ee.return=Se,Se.child=Ee}function dl(Ee,Se,Oe,je,Xe){if(Ee!==null){var ut=Ee.memoizedProps;if(Bo(ut,je)&&Ee.ref===Se.ref)if(si=!1,Se.pendingProps=je=ut,(Ee.lanes&Xe)!==0)Ee.flags&131072&&(si=!0);else return Se.lanes=Ee.lanes,Ni(Ee,Se,Xe)}return Hs(Ee,Se,Oe,je,Xe)}function pl(Ee,Se,Oe){var je=Se.pendingProps,Xe=je.children,ut=Ee!==null?Ee.memoizedState:null;if(je.mode==="hidden")if(!(Se.mode&1))Se.memoizedState={baseLanes:0,cachePool:null,transitions:null},bn(ho,di),di|=Oe;else{if(!(Oe&1073741824))return Ee=ut!==null?ut.baseLanes|Oe:Oe,Se.lanes=Se.childLanes=1073741824,Se.memoizedState={baseLanes:Ee,cachePool:null,transitions:null},Se.updateQueue=null,bn(ho,di),di|=Ee,null;Se.memoizedState={baseLanes:0,cachePool:null,transitions:null},je=ut!==null?ut.baseLanes:Oe,bn(ho,di),di|=je}else ut!==null?(je=ut.baseLanes|Oe,Se.memoizedState=null):je=Oe,bn(ho,di),di|=je;return oi(Ee,Se,Xe,Oe),Se.child}function hl(Ee,Se){var Oe=Se.ref;(Ee===null&&Oe!==null||Ee!==null&&Ee.ref!==Oe)&&(Se.flags|=512,Se.flags|=2097152)}function Hs(Ee,Se,Oe,je,Xe){var ut=zn(Oe)?Nn:Fn.current;return ut=mr(Se,ut),lo(Se,Xe),Oe=Bs(Ee,Se,Oe,je,ut,Xe),je=Ls(),Ee!==null&&!si?(Se.updateQueue=Ee.updateQueue,Se.flags&=-2053,Ee.lanes&=~Xe,Ni(Ee,Se,Xe)):(Mr&&je&&hi(Se),Se.flags|=1,oi(Ee,Se,Oe,Xe),Se.child)}function ml(Ee,Se,Oe,je,Xe){if(zn(Oe)){var ut=!0;Jn(Se)}else ut=!1;if(lo(Se,Xe),Se.stateNode===null)Qo(Ee,Se),nl(Se,Oe,je),Us(Se,Oe,je,Xe),je=!0;else if(Ee===null){var Rt=Se.stateNode,Zt=Se.memoizedProps;Rt.props=Zt;var pn=Rt.context,Pn=Oe.contextType;typeof Pn=="object"&&Pn!==null?Pn=gi(Pn):(Pn=zn(Oe)?Nn:Fn.current,Pn=mr(Se,Pn));var Xn=Oe.getDerivedStateFromProps,ar=typeof Xn=="function"||typeof Rt.getSnapshotBeforeUpdate=="function";ar||typeof Rt.UNSAFE_componentWillReceiveProps!="function"&&typeof Rt.componentWillReceiveProps!="function"||(Zt!==je||pn!==Pn)&&rl(Se,Rt,je,Pn),Fi=!1;var $n=Se.memoizedState;Rt.state=$n,Fo(Se,je,Rt,Xe),pn=Se.memoizedState,Zt!==je||$n!==pn||On.current||Fi?(typeof Xn=="function"&&($s(Se,Oe,Xn,je),pn=Se.memoizedState),(Zt=Fi||tl(Se,Oe,Zt,je,$n,pn,Pn))?(ar||typeof Rt.UNSAFE_componentWillMount!="function"&&typeof Rt.componentWillMount!="function"||(typeof Rt.componentWillMount=="function"&&Rt.componentWillMount(),typeof Rt.UNSAFE_componentWillMount=="function"&&Rt.UNSAFE_componentWillMount()),typeof Rt.componentDidMount=="function"&&(Se.flags|=4194308)):(typeof Rt.componentDidMount=="function"&&(Se.flags|=4194308),Se.memoizedProps=je,Se.memoizedState=pn),Rt.props=je,Rt.state=pn,Rt.context=Pn,je=Zt):(typeof Rt.componentDidMount=="function"&&(Se.flags|=4194308),je=!1)}else{Rt=Se.stateNode,Ma(Ee,Se),Zt=Se.memoizedProps,Pn=Se.type===Se.elementType?Zt:Si(Se.type,Zt),Rt.props=Pn,ar=Se.pendingProps,$n=Rt.context,pn=Oe.contextType,typeof pn=="object"&&pn!==null?pn=gi(pn):(pn=zn(Oe)?Nn:Fn.current,pn=mr(Se,pn));var br=Oe.getDerivedStateFromProps;(Xn=typeof br=="function"||typeof Rt.getSnapshotBeforeUpdate=="function")||typeof Rt.UNSAFE_componentWillReceiveProps!="function"&&typeof Rt.componentWillReceiveProps!="function"||(Zt!==ar||$n!==pn)&&rl(Se,Rt,je,pn),Fi=!1,$n=Se.memoizedState,Rt.state=$n,Fo(Se,je,Rt,Xe);var Tr=Se.memoizedState;Zt!==ar||$n!==Tr||On.current||Fi?(typeof br=="function"&&($s(Se,Oe,br,je),Tr=Se.memoizedState),(Pn=Fi||tl(Se,Oe,Pn,je,$n,Tr,pn)||!1)?(Xn||typeof Rt.UNSAFE_componentWillUpdate!="function"&&typeof Rt.componentWillUpdate!="function"||(typeof Rt.componentWillUpdate=="function"&&Rt.componentWillUpdate(je,Tr,pn),typeof Rt.UNSAFE_componentWillUpdate=="function"&&Rt.UNSAFE_componentWillUpdate(je,Tr,pn)),typeof Rt.componentDidUpdate=="function"&&(Se.flags|=4),typeof Rt.getSnapshotBeforeUpdate=="function"&&(Se.flags|=1024)):(typeof Rt.componentDidUpdate!="function"||Zt===Ee.memoizedProps&&$n===Ee.memoizedState||(Se.flags|=4),typeof Rt.getSnapshotBeforeUpdate!="function"||Zt===Ee.memoizedProps&&$n===Ee.memoizedState||(Se.flags|=1024),Se.memoizedProps=je,Se.memoizedState=Tr),Rt.props=je,Rt.state=Tr,Rt.context=pn,je=Pn):(typeof Rt.componentDidUpdate!="function"||Zt===Ee.memoizedProps&&$n===Ee.memoizedState||(Se.flags|=4),typeof Rt.getSnapshotBeforeUpdate!="function"||Zt===Ee.memoizedProps&&$n===Ee.memoizedState||(Se.flags|=1024),je=!1)}return Vs(Ee,Se,Oe,je,ut,Xe)}function Vs(Ee,Se,Oe,je,Xe,ut){hl(Ee,Se);var Rt=(Se.flags&128)!==0;if(!je&&!Rt)return Xe&&rr(Se,Oe,!1),Ni(Ee,Se,ut);je=Se.stateNode,sc.current=Se;var Zt=Rt&&typeof Oe.getDerivedStateFromError!="function"?null:je.render();return Se.flags|=1,Ee!==null&&Rt?(Se.child=so(Se,Ee.child,null,ut),Se.child=so(Se,null,Zt,ut)):oi(Ee,Se,Zt,ut),Se.memoizedState=je.state,Xe&&rr(Se,Oe,!0),Se.child}function gl(Ee){var Se=Ee.stateNode;Se.pendingContext?Un(Ee,Se.pendingContext,Se.pendingContext!==Se.context):Se.context&&Un(Ee,Se.context,!1),ws(Ee,Se.containerInfo)}function Al(Ee,Se,Oe,je,Xe){return oo(),vs(Xe),Se.flags|=256,oi(Ee,Se,Oe,je),Se.child}var js={dehydrated:null,treeContext:null,retryLane:0};function Ws(Ee){return{baseLanes:Ee,cachePool:null,transitions:null}}function xl(Ee,Se,Oe){var je=Se.pendingProps,Xe=Br.current,ut=!1,Rt=(Se.flags&128)!==0,Zt;if((Zt=Rt)||(Zt=Ee!==null&&Ee.memoizedState===null?!1:(Xe&2)!==0),Zt?(ut=!0,Se.flags&=-129):(Ee===null||Ee.memoizedState!==null)&&(Xe|=1),bn(Br,Xe&1),Ee===null)return ys(Se),Ee=Se.memoizedState,Ee!==null&&(Ee=Ee.dehydrated,Ee!==null)?(Se.mode&1?Pr(Ee)?Se.lanes=8:Se.lanes=1073741824:Se.lanes=1,null):(Rt=je.children,Ee=je.fallback,ut?(je=Se.mode,ut=Se.child,Rt={mode:"hidden",children:Rt},!(je&1)&&ut!==null?(ut.childLanes=0,ut.pendingProps=Rt):ut=ms(Rt,je,0,null),Ee=to(Ee,je,Oe,null),ut.return=Se,Ee.return=Se,ut.sibling=Ee,Se.child=ut,Se.child.memoizedState=Ws(Oe),Se.memoizedState=js,Ee):Qs(Se,Rt));if(Xe=Ee.memoizedState,Xe!==null&&(Zt=Xe.dehydrated,Zt!==null))return ac(Ee,Se,Rt,je,Zt,Xe,Oe);if(ut){ut=je.fallback,Rt=Se.mode,Xe=Ee.child,Zt=Xe.sibling;var pn={mode:"hidden",children:je.children};return!(Rt&1)&&Se.child!==Xe?(je=Se.child,je.childLanes=0,je.pendingProps=pn,Se.deletions=null):(je=Vi(Xe,pn),je.subtreeFlags=Xe.subtreeFlags&14680064),Zt!==null?ut=Vi(Zt,ut):(ut=to(ut,Rt,Oe,null),ut.flags|=2),ut.return=Se,je.return=Se,je.sibling=ut,Se.child=je,je=ut,ut=Se.child,Rt=Ee.child.memoizedState,Rt=Rt===null?Ws(Oe):{baseLanes:Rt.baseLanes|Oe,cachePool:null,transitions:Rt.transitions},ut.memoizedState=Rt,ut.childLanes=Ee.childLanes&~Oe,Se.memoizedState=js,je}return ut=Ee.child,Ee=ut.sibling,je=Vi(ut,{mode:"visible",children:je.children}),!(Se.mode&1)&&(je.lanes=Oe),je.return=Se,je.sibling=null,Ee!==null&&(Oe=Se.deletions,Oe===null?(Se.deletions=[Ee],Se.flags|=16):Oe.push(Ee)),Se.child=je,Se.memoizedState=null,je}function Qs(Ee,Se){return Se=ms({mode:"visible",children:Se},Ee.mode,0,null),Se.return=Ee,Ee.child=Se}function Wo(Ee,Se,Oe,je){return je!==null&&vs(je),so(Se,Ee.child,null,Oe),Ee=Qs(Se,Se.pendingProps.children),Ee.flags|=2,Se.memoizedState=null,Ee}function ac(Ee,Se,Oe,je,Xe,ut,Rt){if(Oe)return Se.flags&256?(Se.flags&=-257,je=Gs(Error(oe(422))),Wo(Ee,Se,Rt,je)):Se.memoizedState!==null?(Se.child=Ee.child,Se.flags|=128,null):(ut=je.fallback,Xe=Se.mode,je=ms({mode:"visible",children:je.children},Xe,0,null),ut=to(ut,Xe,Rt,null),ut.flags|=2,je.return=Se,ut.return=Se,je.sibling=ut,Se.child=je,Se.mode&1&&so(Se,Ee.child,null,Rt),Se.child.memoizedState=Ws(Rt),Se.memoizedState=js,ut);if(!(Se.mode&1))return Wo(Ee,Se,Rt,null);if(Pr(Xe))return je=Dr(Xe).digest,ut=Error(oe(419)),je=Gs(ut,je,void 0),Wo(Ee,Se,Rt,je);if(Oe=(Rt&Ee.childLanes)!==0,si||Oe){if(je=Qr,je!==null){switch(Rt&-Rt){case 4:Xe=2;break;case 16:Xe=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Xe=32;break;case 536870912:Xe=268435456;break;default:Xe=0}Xe=Xe&(je.suspendedLanes|Rt)?0:Xe,Xe!==0&&Xe!==ut.retryLane&&(ut.retryLane=Xe,Ii(Ee,Xe),yi(je,Ee,Xe,-1))}return pa(),je=Gs(Error(oe(421))),Wo(Ee,Se,Rt,je)}return Sr(Xe)?(Se.flags|=128,Se.child=Ee.child,Se=vc.bind(null,Ee),Cr(Xe,Se),null):(Ee=ut.treeContext,zt&&(mi=gt(Xe),fi=Se,Mr=!0,_i=null,go=!1,Ee!==null&&(qr[Yr++]=Ei,qr[Yr++]=Ir,qr[Yr++]=wi,Ei=Ee.id,Ir=Ee.overflow,wi=Se)),Se=Qs(Se,je.children),Se.flags|=4096,Se)}function yl(Ee,Se,Oe){Ee.lanes|=Se;var je=Ee.alternate;je!==null&&(je.lanes|=Se),Ts(Ee.return,Se,Oe)}function Xs(Ee,Se,Oe,je,Xe){var ut=Ee.memoizedState;ut===null?Ee.memoizedState={isBackwards:Se,rendering:null,renderingStartTime:0,last:je,tail:Oe,tailMode:Xe}:(ut.isBackwards=Se,ut.rendering=null,ut.renderingStartTime=0,ut.last=je,ut.tail=Oe,ut.tailMode=Xe)}function vl(Ee,Se,Oe){var je=Se.pendingProps,Xe=je.revealOrder,ut=je.tail;if(oi(Ee,Se,je.children,Oe),je=Br.current,je&2)je=je&1|2,Se.flags|=128;else{if(Ee!==null&&Ee.flags&128)e:for(Ee=Se.child;Ee!==null;){if(Ee.tag===13)Ee.memoizedState!==null&&yl(Ee,Oe,Se);else if(Ee.tag===19)yl(Ee,Oe,Se);else if(Ee.child!==null){Ee.child.return=Ee,Ee=Ee.child;continue}if(Ee===Se)break e;for(;Ee.sibling===null;){if(Ee.return===null||Ee.return===Se)break e;Ee=Ee.return}Ee.sibling.return=Ee.return,Ee=Ee.sibling}je&=1}if(bn(Br,je),!(Se.mode&1))Se.memoizedState=null;else switch(Xe){case"forwards":for(Oe=Se.child,Xe=null;Oe!==null;)Ee=Oe.alternate,Ee!==null&&$o(Ee)===null&&(Xe=Oe),Oe=Oe.sibling;Oe=Xe,Oe===null?(Xe=Se.child,Se.child=null):(Xe=Oe.sibling,Oe.sibling=null),Xs(Se,!1,Xe,Oe,ut);break;case"backwards":for(Oe=null,Xe=Se.child,Se.child=null;Xe!==null;){if(Ee=Xe.alternate,Ee!==null&&$o(Ee)===null){Se.child=Xe;break}Ee=Xe.sibling,Xe.sibling=Oe,Oe=Xe,Xe=Ee}Xs(Se,!0,Oe,null,ut);break;case"together":Xs(Se,!1,null,null,void 0);break;default:Se.memoizedState=null}return Se.child}function Qo(Ee,Se){!(Se.mode&1)&&Ee!==null&&(Ee.alternate=null,Se.alternate=null,Se.flags|=2)}function Ni(Ee,Se,Oe){if(Ee!==null&&(Se.dependencies=Ee.dependencies),Ki|=Se.lanes,!(Oe&Se.childLanes))return null;if(Ee!==null&&Se.child!==Ee.child)throw Error(oe(153));if(Se.child!==null){for(Ee=Se.child,Oe=Vi(Ee,Ee.pendingProps),Se.child=Oe,Oe.return=Se;Ee.sibling!==null;)Ee=Ee.sibling,Oe=Oe.sibling=Vi(Ee,Ee.pendingProps),Oe.return=Se;Oe.sibling=null}return Se.child}function lc(Ee,Se,Oe){switch(Se.tag){case 3:gl(Se),oo();break;case 5:Da(Se);break;case 1:zn(Se.type)&&Jn(Se);break;case 4:ws(Se,Se.stateNode.containerInfo);break;case 10:wa(Se,Se.type._context,Se.memoizedProps.value);break;case 13:var je=Se.memoizedState;if(je!==null)return je.dehydrated!==null?(bn(Br,Br.current&1),Se.flags|=128,null):Oe&Se.child.childLanes?xl(Ee,Se,Oe):(bn(Br,Br.current&1),Ee=Ni(Ee,Se,Oe),Ee!==null?Ee.sibling:null);bn(Br,Br.current&1);break;case 19:if(je=(Oe&Se.childLanes)!==0,Ee.flags&128){if(je)return vl(Ee,Se,Oe);Se.flags|=128}var Xe=Se.memoizedState;if(Xe!==null&&(Xe.rendering=null,Xe.tail=null,Xe.lastEffect=null),bn(Br,Br.current),je)break;return null;case 22:case 23:return Se.lanes=0,pl(Ee,Se,Oe)}return Ni(Ee,Se,Oe)}function Pi(Ee){Ee.flags|=4}function El(Ee,Se){if(Ee!==null&&Ee.child===Se.child)return!0;if(Se.flags&16)return!1;for(Ee=Se.child;Ee!==null;){if(Ee.flags&12854||Ee.subtreeFlags&12854)return!1;Ee=Ee.sibling}return!0}var To,bo,Xo,qo;if(Et)To=function(Ee,Se){for(var Oe=Se.child;Oe!==null;){if(Oe.tag===5||Oe.tag===6)ct(Ee,Oe.stateNode);else if(Oe.tag!==4&&Oe.child!==null){Oe.child.return=Oe,Oe=Oe.child;continue}if(Oe===Se)break;for(;Oe.sibling===null;){if(Oe.return===null||Oe.return===Se)return;Oe=Oe.return}Oe.sibling.return=Oe.return,Oe=Oe.sibling}},bo=function(){},Xo=function(Ee,Se,Oe,je,Xe){if(Ee=Ee.memoizedProps,Ee!==je){var ut=Se.stateNode,Rt=Mi(Ai.current);Oe=lt(ut,Oe,Ee,je,Xe,Rt),(Se.updateQueue=Oe)&&Pi(Se)}},qo=function(Ee,Se,Oe,je){Oe!==je&&Pi(Se)};else if(Nt){To=function(Ee,Se,Oe,je){for(var Xe=Se.child;Xe!==null;){if(Xe.tag===5){var ut=Xe.stateNode;Oe&&je&&(ut=Rn(ut,Xe.type,Xe.memoizedProps,Xe)),ct(Ee,ut)}else if(Xe.tag===6)ut=Xe.stateNode,Oe&&je&&(ut=or(ut,Xe.memoizedProps,Xe)),ct(Ee,ut);else if(Xe.tag!==4){if(Xe.tag===22&&Xe.memoizedState!==null)ut=Xe.child,ut!==null&&(ut.return=Xe),To(Ee,Xe,!0,!0);else if(Xe.child!==null){Xe.child.return=Xe,Xe=Xe.child;continue}}if(Xe===Se)break;for(;Xe.sibling===null;){if(Xe.return===null||Xe.return===Se)return;Xe=Xe.return}Xe.sibling.return=Xe.return,Xe=Xe.sibling}};var _l=function(Ee,Se,Oe,je){for(var Xe=Se.child;Xe!==null;){if(Xe.tag===5){var ut=Xe.stateNode;Oe&&je&&(ut=Rn(ut,Xe.type,Xe.memoizedProps,Xe)),Ln(Ee,ut)}else if(Xe.tag===6)ut=Xe.stateNode,Oe&&je&&(ut=or(ut,Xe.memoizedProps,Xe)),Ln(Ee,ut);else if(Xe.tag!==4){if(Xe.tag===22&&Xe.memoizedState!==null)ut=Xe.child,ut!==null&&(ut.return=Xe),_l(Ee,Xe,!0,!0);else if(Xe.child!==null){Xe.child.return=Xe,Xe=Xe.child;continue}}if(Xe===Se)break;for(;Xe.sibling===null;){if(Xe.return===null||Xe.return===Se)return;Xe=Xe.return}Xe.sibling.return=Xe.return,Xe=Xe.sibling}};bo=function(Ee,Se){var Oe=Se.stateNode;if(!El(Ee,Se)){Ee=Oe.containerInfo;var je=xn(Ee);_l(je,Se,!1,!1),Oe.pendingChildren=je,Pi(Se),Vn(Ee,je)}},Xo=function(Ee,Se,Oe,je,Xe){var ut=Ee.stateNode,Rt=Ee.memoizedProps;if((Ee=El(Ee,Se))&&Rt===je)Se.stateNode=ut;else{var Zt=Se.stateNode,pn=Mi(Ai.current),Pn=null;Rt!==je&&(Pn=lt(Zt,Oe,Rt,je,Xe,pn)),Ee&&Pn===null?Se.stateNode=ut:(ut=_n(ut,Pn,Oe,Rt,je,Se,Ee,Zt),ht(ut,Oe,je,Xe,pn)&&Pi(Se),Se.stateNode=ut,Ee?Pi(Se):To(ut,Se,!1,!1))}},qo=function(Ee,Se,Oe,je){Oe!==je?(Ee=Mi(co.current),Oe=Mi(Ai.current),Se.stateNode=Ze(je,Ee,Oe,Se),Pi(Se)):Se.stateNode=Ee.stateNode}}else bo=function(){},Xo=function(){},qo=function(){};function Co(Ee,Se){if(!Mr)switch(Ee.tailMode){case"hidden":Se=Ee.tail;for(var Oe=null;Se!==null;)Se.alternate!==null&&(Oe=Se),Se=Se.sibling;Oe===null?Ee.tail=null:Oe.sibling=null;break;case"collapsed":Oe=Ee.tail;for(var je=null;Oe!==null;)Oe.alternate!==null&&(je=Oe),Oe=Oe.sibling;je===null?Se||Ee.tail===null?Ee.tail=null:Ee.tail.sibling=null:je.sibling=null}}function ni(Ee){var Se=Ee.alternate!==null&&Ee.alternate.child===Ee.child,Oe=0,je=0;if(Se)for(var Xe=Ee.child;Xe!==null;)Oe|=Xe.lanes|Xe.childLanes,je|=Xe.subtreeFlags&14680064,je|=Xe.flags&14680064,Xe.return=Ee,Xe=Xe.sibling;else for(Xe=Ee.child;Xe!==null;)Oe|=Xe.lanes|Xe.childLanes,je|=Xe.subtreeFlags,je|=Xe.flags,Xe.return=Ee,Xe=Xe.sibling;return Ee.subtreeFlags|=je,Ee.childLanes=Oe,Se}function cc(Ee,Se,Oe){var je=Se.pendingProps;switch(io(Se),Se.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ni(Se),null;case 1:return zn(Se.type)&&Zn(),ni(Se),null;case 3:return Oe=Se.stateNode,uo(),wn(On),wn(Fn),Rs(),Oe.pendingContext&&(Oe.context=Oe.pendingContext,Oe.pendingContext=null),(Ee===null||Ee.child===null)&&(Do(Se)?Pi(Se):Ee===null||Ee.memoizedState.isDehydrated&&!(Se.flags&256)||(Se.flags|=1024,_i!==null&&(fa(_i),_i=null))),bo(Ee,Se),ni(Se),null;case 5:Is(Se),Oe=Mi(co.current);var Xe=Se.type;if(Ee!==null&&Se.stateNode!=null)Xo(Ee,Se,Xe,je,Oe),Ee.ref!==Se.ref&&(Se.flags|=512,Se.flags|=2097152);else{if(!je){if(Se.stateNode===null)throw Error(oe(166));return ni(Se),null}if(Ee=Mi(Ai.current),Do(Se)){if(!zt)throw Error(oe(175));Ee=wt(Se.stateNode,Se.type,Se.memoizedProps,Oe,Ee,Se,!go),Se.updateQueue=Ee,Ee!==null&&Pi(Se)}else{var ut=Fe(Xe,je,Oe,Ee,Se);To(ut,Se,!1,!1),Se.stateNode=ut,ht(ut,Xe,je,Oe,Ee)&&Pi(Se)}Se.ref!==null&&(Se.flags|=512,Se.flags|=2097152)}return ni(Se),null;case 6:if(Ee&&Se.stateNode!=null)qo(Ee,Se,Ee.memoizedProps,je);else{if(typeof je!="string"&&Se.stateNode===null)throw Error(oe(166));if(Ee=Mi(co.current),Oe=Mi(Ai.current),Do(Se)){if(!zt)throw Error(oe(176));if(Ee=Se.stateNode,Oe=Se.memoizedProps,(je=jt(Ee,Oe,Se,!go))&&(Xe=fi,Xe!==null))switch(Xe.tag){case 3:$t(Xe.stateNode.containerInfo,Ee,Oe,(Xe.mode&1)!==0);break;case 5:Bt(Xe.type,Xe.memoizedProps,Xe.stateNode,Ee,Oe,(Xe.mode&1)!==0)}je&&Pi(Se)}else Se.stateNode=Ze(je,Ee,Oe,Se)}return ni(Se),null;case 13:if(wn(Br),je=Se.memoizedState,Ee===null||Ee.memoizedState!==null&&Ee.memoizedState.dehydrated!==null){if(Mr&&mi!==null&&Se.mode&1&&!(Se.flags&128))Sa(),oo(),Se.flags|=98560,Xe=!1;else if(Xe=Do(Se),je!==null&&je.dehydrated!==null){if(Ee===null){if(!Xe)throw Error(oe(318));if(!zt)throw Error(oe(344));if(Xe=Se.memoizedState,Xe=Xe!==null?Xe.dehydrated:null,!Xe)throw Error(oe(317));rn(Xe,Se)}else oo(),!(Se.flags&128)&&(Se.memoizedState=null),Se.flags|=4;ni(Se),Xe=!1}else _i!==null&&(fa(_i),_i=null),Xe=!0;if(!Xe)return Se.flags&65536?Se:null}return Se.flags&128?(Se.lanes=Oe,Se):(Oe=je!==null,Oe!==(Ee!==null&&Ee.memoizedState!==null)&&Oe&&(Se.child.flags|=8192,Se.mode&1&&(Ee===null||Br.current&1?Hr===0&&(Hr=3):pa())),Se.updateQueue!==null&&(Se.flags|=4),ni(Se),null);case 4:return uo(),bo(Ee,Se),Ee===null&&Ut(Se.stateNode.containerInfo),ni(Se),null;case 10:return Ss(Se.type._context),ni(Se),null;case 17:return zn(Se.type)&&Zn(),ni(Se),null;case 19:if(wn(Br),Xe=Se.memoizedState,Xe===null)return ni(Se),null;if(je=(Se.flags&128)!==0,ut=Xe.rendering,ut===null)if(je)Co(Xe,!1);else{if(Hr!==0||Ee!==null&&Ee.flags&128)for(Ee=Se.child;Ee!==null;){if(ut=$o(Ee),ut!==null){for(Se.flags|=128,Co(Xe,!1),Ee=ut.updateQueue,Ee!==null&&(Se.updateQueue=Ee,Se.flags|=4),Se.subtreeFlags=0,Ee=Oe,Oe=Se.child;Oe!==null;)je=Oe,Xe=Ee,je.flags&=14680066,ut=je.alternate,ut===null?(je.childLanes=0,je.lanes=Xe,je.child=null,je.subtreeFlags=0,je.memoizedProps=null,je.memoizedState=null,je.updateQueue=null,je.dependencies=null,je.stateNode=null):(je.childLanes=ut.childLanes,je.lanes=ut.lanes,je.child=ut.child,je.subtreeFlags=0,je.deletions=null,je.memoizedProps=ut.memoizedProps,je.memoizedState=ut.memoizedState,je.updateQueue=ut.updateQueue,je.type=ut.type,Xe=ut.dependencies,je.dependencies=Xe===null?null:{lanes:Xe.lanes,firstContext:Xe.firstContext}),Oe=Oe.sibling;return bn(Br,Br.current&1|2),Se.child}Ee=Ee.sibling}Xe.tail!==null&&vn()>aa&&(Se.flags|=128,je=!0,Co(Xe,!1),Se.lanes=4194304)}else{if(!je)if(Ee=$o(ut),Ee!==null){if(Se.flags|=128,je=!0,Ee=Ee.updateQueue,Ee!==null&&(Se.updateQueue=Ee,Se.flags|=4),Co(Xe,!0),Xe.tail===null&&Xe.tailMode==="hidden"&&!ut.alternate&&!Mr)return ni(Se),null}else 2*vn()-Xe.renderingStartTime>aa&&Oe!==1073741824&&(Se.flags|=128,je=!0,Co(Xe,!1),Se.lanes=4194304);Xe.isBackwards?(ut.sibling=Se.child,Se.child=ut):(Ee=Xe.last,Ee!==null?Ee.sibling=ut:Se.child=ut,Xe.last=ut)}return Xe.tail!==null?(Se=Xe.tail,Xe.rendering=Se,Xe.tail=Se.sibling,Xe.renderingStartTime=vn(),Se.sibling=null,Ee=Br.current,bn(Br,je?Ee&1|2:Ee&1),Se):(ni(Se),null);case 22:case 23:return da(),Oe=Se.memoizedState!==null,Ee!==null&&Ee.memoizedState!==null!==Oe&&(Se.flags|=8192),Oe&&Se.mode&1?di&1073741824&&(ni(Se),Et&&Se.subtreeFlags&6&&(Se.flags|=8192)):ni(Se),null;case 24:return null;case 25:return null}throw Error(oe(156,Se.tag))}function uc(Ee,Se){switch(io(Se),Se.tag){case 1:return zn(Se.type)&&Zn(),Ee=Se.flags,Ee&65536?(Se.flags=Ee&-65537|128,Se):null;case 3:return uo(),wn(On),wn(Fn),Rs(),Ee=Se.flags,Ee&65536&&!(Ee&128)?(Se.flags=Ee&-65537|128,Se):null;case 5:return Is(Se),null;case 13:if(wn(Br),Ee=Se.memoizedState,Ee!==null&&Ee.dehydrated!==null){if(Se.alternate===null)throw Error(oe(340));oo()}return Ee=Se.flags,Ee&65536?(Se.flags=Ee&-65537|128,Se):null;case 19:return wn(Br),null;case 4:return uo(),null;case 10:return Ss(Se.type._context),null;case 22:case 23:return da(),null;case 24:return null;default:return null}}var Yo=!1,ri=!1,fc=typeof WeakSet=="function"?WeakSet:Set,Qn=null;function po(Ee,Se){var Oe=Ee.ref;if(Oe!==null)if(typeof Oe=="function")try{Oe(null)}catch(je){Rr(Ee,Se,je)}else Oe.current=null}function qs(Ee,Se,Oe){try{Oe()}catch(je){Rr(Ee,Se,je)}}var Sl=!1;function dc(Ee,Se){for(Je(Ee.containerInfo),Qn=Se;Qn!==null;)if(Ee=Qn,Se=Ee.child,(Ee.subtreeFlags&1028)!==0&&Se!==null)Se.return=Ee,Qn=Se;else for(;Qn!==null;){Ee=Qn;try{var Oe=Ee.alternate;if(Ee.flags&1024)switch(Ee.tag){case 0:case 11:case 15:break;case 1:if(Oe!==null){var je=Oe.memoizedProps,Xe=Oe.memoizedState,ut=Ee.stateNode,Rt=ut.getSnapshotBeforeUpdate(Ee.elementType===Ee.type?je:Si(Ee.type,je),Xe);ut.__reactInternalSnapshotBeforeUpdate=Rt}break;case 3:Et&&hn(Ee.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(Zt){Rr(Ee,Ee.return,Zt)}if(Se=Ee.sibling,Se!==null){Se.return=Ee.return,Qn=Se;break}Qn=Ee.return}return Oe=Sl,Sl=!1,Oe}function wo(Ee,Se,Oe){var je=Se.updateQueue;if(je=je!==null?je.lastEffect:null,je!==null){var Xe=je=je.next;do{if((Xe.tag&Ee)===Ee){var ut=Xe.destroy;Xe.destroy=void 0,ut!==void 0&&qs(Se,Oe,ut)}Xe=Xe.next}while(Xe!==je)}}function Ko(Ee,Se){if(Se=Se.updateQueue,Se=Se!==null?Se.lastEffect:null,Se!==null){var Oe=Se=Se.next;do{if((Oe.tag&Ee)===Ee){var je=Oe.create;Oe.destroy=je()}Oe=Oe.next}while(Oe!==Se)}}function Ys(Ee){var Se=Ee.ref;if(Se!==null){var Oe=Ee.stateNode;switch(Ee.tag){case 5:Ee=ze(Oe);break;default:Ee=Oe}typeof Se=="function"?Se(Ee):Se.current=Ee}}function Tl(Ee){var Se=Ee.alternate;Se!==null&&(Ee.alternate=null,Tl(Se)),Ee.child=null,Ee.deletions=null,Ee.sibling=null,Ee.tag===5&&(Se=Ee.stateNode,Se!==null&&Ot(Se)),Ee.stateNode=null,Ee.return=null,Ee.dependencies=null,Ee.memoizedProps=null,Ee.memoizedState=null,Ee.pendingProps=null,Ee.stateNode=null,Ee.updateQueue=null}function bl(Ee){return Ee.tag===5||Ee.tag===3||Ee.tag===4}function Cl(Ee){e:for(;;){for(;Ee.sibling===null;){if(Ee.return===null||bl(Ee.return))return null;Ee=Ee.return}for(Ee.sibling.return=Ee.return,Ee=Ee.sibling;Ee.tag!==5&&Ee.tag!==6&&Ee.tag!==18;){if(Ee.flags&2||Ee.child===null||Ee.tag===4)continue e;Ee.child.return=Ee,Ee=Ee.child}if(!(Ee.flags&2))return Ee.stateNode}}function Ks(Ee,Se,Oe){var je=Ee.tag;if(je===5||je===6)Ee=Ee.stateNode,Se?Qt(Oe,Ee,Se):Be(Oe,Ee);else if(je!==4&&(Ee=Ee.child,Ee!==null))for(Ks(Ee,Se,Oe),Ee=Ee.sibling;Ee!==null;)Ks(Ee,Se,Oe),Ee=Ee.sibling}function Js(Ee,Se,Oe){var je=Ee.tag;if(je===5||je===6)Ee=Ee.stateNode,Se?Ct(Oe,Ee,Se):De(Oe,Ee);else if(je!==4&&(Ee=Ee.child,Ee!==null))for(Js(Ee,Se,Oe),Ee=Ee.sibling;Ee!==null;)Js(Ee,Se,Oe),Ee=Ee.sibling}var Jr=null,Ti=!1;function Di(Ee,Se,Oe){for(Oe=Oe.child;Oe!==null;)Zs(Ee,Se,Oe),Oe=Oe.sibling}function Zs(Ee,Se,Oe){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(ir,Oe)}catch{}switch(Oe.tag){case 5:ri||po(Oe,Se);case 6:if(Et){var je=Jr,Xe=Ti;Jr=null,Di(Ee,Se,Oe),Jr=je,Ti=Xe,Jr!==null&&(Ti?It(Jr,Oe.stateNode):qt(Jr,Oe.stateNode))}else Di(Ee,Se,Oe);break;case 18:Et&&Jr!==null&&(Ti?At(Jr,Oe.stateNode):Sn(Jr,Oe.stateNode));break;case 4:Et?(je=Jr,Xe=Ti,Jr=Oe.stateNode.containerInfo,Ti=!0,Di(Ee,Se,Oe),Jr=je,Ti=Xe):(Nt&&(je=Oe.stateNode.containerInfo,Xe=xn(je),kn(je,Xe)),Di(Ee,Se,Oe));break;case 0:case 11:case 14:case 15:if(!ri&&(je=Oe.updateQueue,je!==null&&(je=je.lastEffect,je!==null))){Xe=je=je.next;do{var ut=Xe,Rt=ut.destroy;ut=ut.tag,Rt!==void 0&&(ut&2||ut&4)&&qs(Oe,Se,Rt),Xe=Xe.next}while(Xe!==je)}Di(Ee,Se,Oe);break;case 1:if(!ri&&(po(Oe,Se),je=Oe.stateNode,typeof je.componentWillUnmount=="function"))try{je.props=Oe.memoizedProps,je.state=Oe.memoizedState,je.componentWillUnmount()}catch(Zt){Rr(Oe,Se,Zt)}Di(Ee,Se,Oe);break;case 21:Di(Ee,Se,Oe);break;case 22:Oe.mode&1?(ri=(je=ri)||Oe.memoizedState!==null,Di(Ee,Se,Oe),ri=je):Di(Ee,Se,Oe);break;default:Di(Ee,Se,Oe)}}function wl(Ee){var Se=Ee.updateQueue;if(Se!==null){Ee.updateQueue=null;var Oe=Ee.stateNode;Oe===null&&(Oe=Ee.stateNode=new fc),Se.forEach(function(je){var Xe=Ec.bind(null,Ee,je);Oe.has(je)||(Oe.add(je),je.then(Xe,Xe))})}}function bi(Ee,Se){var Oe=Se.deletions;if(Oe!==null)for(var je=0;je<Oe.length;je++){var Xe=Oe[je];try{var ut=Ee,Rt=Se;if(Et){var Zt=Rt;e:for(;Zt!==null;){switch(Zt.tag){case 5:Jr=Zt.stateNode,Ti=!1;break e;case 3:Jr=Zt.stateNode.containerInfo,Ti=!0;break e;case 4:Jr=Zt.stateNode.containerInfo,Ti=!0;break e}Zt=Zt.return}if(Jr===null)throw Error(oe(160));Zs(ut,Rt,Xe),Jr=null,Ti=!1}else Zs(ut,Rt,Xe);var pn=Xe.alternate;pn!==null&&(pn.return=null),Xe.return=null}catch(Pn){Rr(Xe,Se,Pn)}}if(Se.subtreeFlags&12854)for(Se=Se.child;Se!==null;)Il(Se,Ee),Se=Se.sibling}function Il(Ee,Se){var Oe=Ee.alternate,je=Ee.flags;switch(Ee.tag){case 0:case 11:case 14:case 15:if(bi(Se,Ee),Bi(Ee),je&4){try{wo(3,Ee,Ee.return),Ko(3,Ee)}catch($n){Rr(Ee,Ee.return,$n)}try{wo(5,Ee,Ee.return)}catch($n){Rr(Ee,Ee.return,$n)}}break;case 1:bi(Se,Ee),Bi(Ee),je&512&&Oe!==null&&po(Oe,Oe.return);break;case 5:if(bi(Se,Ee),Bi(Ee),je&512&&Oe!==null&&po(Oe,Oe.return),Et){if(Ee.flags&32){var Xe=Ee.stateNode;try{Gt(Xe)}catch($n){Rr(Ee,Ee.return,$n)}}if(je&4&&(Xe=Ee.stateNode,Xe!=null)){var ut=Ee.memoizedProps;if(Oe=Oe!==null?Oe.memoizedProps:ut,je=Ee.type,Se=Ee.updateQueue,Ee.updateQueue=null,Se!==null)try{xt(Xe,Se,je,Oe,ut,Ee)}catch($n){Rr(Ee,Ee.return,$n)}}}break;case 6:if(bi(Se,Ee),Bi(Ee),je&4&&Et){if(Ee.stateNode===null)throw Error(oe(162));Xe=Ee.stateNode,ut=Ee.memoizedProps,Oe=Oe!==null?Oe.memoizedProps:ut;try{rt(Xe,Oe,ut)}catch($n){Rr(Ee,Ee.return,$n)}}break;case 3:if(bi(Se,Ee),Bi(Ee),je&4){if(Et&&zt&&Oe!==null&&Oe.memoizedState.isDehydrated)try{dn(Se.containerInfo)}catch($n){Rr(Ee,Ee.return,$n)}if(Nt){Xe=Se.containerInfo,ut=Se.pendingChildren;try{kn(Xe,ut)}catch($n){Rr(Ee,Ee.return,$n)}}}break;case 4:if(bi(Se,Ee),Bi(Ee),je&4&&Nt){ut=Ee.stateNode,Xe=ut.containerInfo,ut=ut.pendingChildren;try{kn(Xe,ut)}catch($n){Rr(Ee,Ee.return,$n)}}break;case 13:bi(Se,Ee),Bi(Ee),Xe=Ee.child,Xe.flags&8192&&(ut=Xe.memoizedState!==null,Xe.stateNode.isHidden=ut,!ut||Xe.alternate!==null&&Xe.alternate.memoizedState!==null||(sa=vn())),je&4&&wl(Ee);break;case 22:var Rt=Oe!==null&&Oe.memoizedState!==null;if(Ee.mode&1?(ri=(Oe=ri)||Rt,bi(Se,Ee),ri=Oe):bi(Se,Ee),Bi(Ee),je&8192){if(Oe=Ee.memoizedState!==null,(Ee.stateNode.isHidden=Oe)&&!Rt&&Ee.mode&1)for(Qn=Ee,je=Ee.child;je!==null;){for(Se=Qn=je;Qn!==null;){Rt=Qn;var Zt=Rt.child;switch(Rt.tag){case 0:case 11:case 14:case 15:wo(4,Rt,Rt.return);break;case 1:po(Rt,Rt.return);var pn=Rt.stateNode;if(typeof pn.componentWillUnmount=="function"){var Pn=Rt,Xn=Rt.return;try{var ar=Pn;pn.props=ar.memoizedProps,pn.state=ar.memoizedState,pn.componentWillUnmount()}catch($n){Rr(Pn,Xn,$n)}}break;case 5:po(Rt,Rt.return);break;case 22:if(Rt.memoizedState!==null){Pl(Se);continue}}Zt!==null?(Zt.return=Rt,Qn=Zt):Pl(Se)}je=je.sibling}if(Et){e:if(je=null,Et)for(Se=Ee;;){if(Se.tag===5){if(je===null){je=Se;try{Xe=Se.stateNode,Oe?Jt(Xe):Ht(Se.stateNode,Se.memoizedProps)}catch($n){Rr(Ee,Ee.return,$n)}}}else if(Se.tag===6){if(je===null)try{ut=Se.stateNode,Oe?kt(ut):Yt(ut,Se.memoizedProps)}catch($n){Rr(Ee,Ee.return,$n)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===Ee)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===Ee)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===Ee)break e;je===Se&&(je=null),Se=Se.return}je===Se&&(je=null),Se.sibling.return=Se.return,Se=Se.sibling}}}break;case 19:bi(Se,Ee),Bi(Ee),je&4&&wl(Ee);break;case 21:break;default:bi(Se,Ee),Bi(Ee)}}function Bi(Ee){var Se=Ee.flags;if(Se&2){try{if(Et){e:{for(var Oe=Ee.return;Oe!==null;){if(bl(Oe)){var je=Oe;break e}Oe=Oe.return}throw Error(oe(160))}switch(je.tag){case 5:var Xe=je.stateNode;je.flags&32&&(Gt(Xe),je.flags&=-33);var ut=Cl(Ee);Js(Ee,ut,Xe);break;case 3:case 4:var Rt=je.stateNode.containerInfo,Zt=Cl(Ee);Ks(Ee,Zt,Rt);break;default:throw Error(oe(161))}}}catch(pn){Rr(Ee,Ee.return,pn)}Ee.flags&=-3}Se&4096&&(Ee.flags&=-4097)}function pc(Ee,Se,Oe){Qn=Ee,Ml(Ee)}function Ml(Ee,Se,Oe){for(var je=(Ee.mode&1)!==0;Qn!==null;){var Xe=Qn,ut=Xe.child;if(Xe.tag===22&&je){var Rt=Xe.memoizedState!==null||Yo;if(!Rt){var Zt=Xe.alternate,pn=Zt!==null&&Zt.memoizedState!==null||ri;Zt=Yo;var Pn=ri;if(Yo=Rt,(ri=pn)&&!Pn)for(Qn=Xe;Qn!==null;)Rt=Qn,pn=Rt.child,Rt.tag===22&&Rt.memoizedState!==null?Dl(Xe):pn!==null?(pn.return=Rt,Qn=pn):Dl(Xe);for(;ut!==null;)Qn=ut,Ml(ut),ut=ut.sibling;Qn=Xe,Yo=Zt,ri=Pn}Rl(Ee)}else Xe.subtreeFlags&8772&&ut!==null?(ut.return=Xe,Qn=ut):Rl(Ee)}}function Rl(Ee){for(;Qn!==null;){var Se=Qn;if(Se.flags&8772){var Oe=Se.alternate;try{if(Se.flags&8772)switch(Se.tag){case 0:case 11:case 15:ri||Ko(5,Se);break;case 1:var je=Se.stateNode;if(Se.flags&4&&!ri)if(Oe===null)je.componentDidMount();else{var Xe=Se.elementType===Se.type?Oe.memoizedProps:Si(Se.type,Oe.memoizedProps);je.componentDidUpdate(Xe,Oe.memoizedState,je.__reactInternalSnapshotBeforeUpdate)}var ut=Se.updateQueue;ut!==null&&Pa(Se,ut,je);break;case 3:var Rt=Se.updateQueue;if(Rt!==null){if(Oe=null,Se.child!==null)switch(Se.child.tag){case 5:Oe=ze(Se.child.stateNode);break;case 1:Oe=Se.child.stateNode}Pa(Se,Rt,Oe)}break;case 5:var Zt=Se.stateNode;Oe===null&&Se.flags&4&&at(Zt,Se.type,Se.memoizedProps,Se);break;case 6:break;case 4:break;case 12:break;case 13:if(zt&&Se.memoizedState===null){var pn=Se.alternate;if(pn!==null){var Pn=pn.memoizedState;if(Pn!==null){var Xn=Pn.dehydrated;Xn!==null&&Tn(Xn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}ri||Se.flags&512&&Ys(Se)}catch(ar){Rr(Se,Se.return,ar)}}if(Se===Ee){Qn=null;break}if(Oe=Se.sibling,Oe!==null){Oe.return=Se.return,Qn=Oe;break}Qn=Se.return}}function Pl(Ee){for(;Qn!==null;){var Se=Qn;if(Se===Ee){Qn=null;break}var Oe=Se.sibling;if(Oe!==null){Oe.return=Se.return,Qn=Oe;break}Qn=Se.return}}function Dl(Ee){for(;Qn!==null;){var Se=Qn;try{switch(Se.tag){case 0:case 11:case 15:var Oe=Se.return;try{Ko(4,Se)}catch(pn){Rr(Se,Oe,pn)}break;case 1:var je=Se.stateNode;if(typeof je.componentDidMount=="function"){var Xe=Se.return;try{je.componentDidMount()}catch(pn){Rr(Se,Xe,pn)}}var ut=Se.return;try{Ys(Se)}catch(pn){Rr(Se,ut,pn)}break;case 5:var Rt=Se.return;try{Ys(Se)}catch(pn){Rr(Se,Rt,pn)}}}catch(pn){Rr(Se,Se.return,pn)}if(Se===Ee){Qn=null;break}var Zt=Se.sibling;if(Zt!==null){Zt.return=Se.return,Qn=Zt;break}Qn=Se.return}}var Jo=0,Zo=1,es=2,rs=3,os=4;if(typeof Symbol=="function"&&Symbol.for){var Io=Symbol.for;Jo=Io("selector.component"),Zo=Io("selector.has_pseudo_class"),es=Io("selector.role"),rs=Io("selector.test_id"),os=Io("selector.text")}function ea(Ee){var Se=yt(Ee);if(Se!=null){if(typeof Se.memoizedProps["data-testname"]!="string")throw Error(oe(364));return Se}if(Ee=ft(Ee),Ee===null)throw Error(oe(362));return Ee.stateNode.current}function ta(Ee,Se){switch(Se.$$typeof){case Jo:if(Ee.type===Se.value)return!0;break;case Zo:e:{Se=Se.value,Ee=[Ee,0];for(var Oe=0;Oe<Ee.length;){var je=Ee[Oe++],Xe=Ee[Oe++],ut=Se[Xe];if(je.tag!==5||!Pt(je)){for(;ut!=null&&ta(je,ut);)Xe++,ut=Se[Xe];if(Xe===Se.length){Se=!0;break e}else for(je=je.child;je!==null;)Ee.push(je,Xe),je=je.sibling}}Se=!1}return Se;case es:if(Ee.tag===5&&Lt(Ee.stateNode,Se.value))return!0;break;case os:if((Ee.tag===5||Ee.tag===6)&&(Ee=vt(Ee),Ee!==null&&0<=Ee.indexOf(Se.value)))return!0;break;case rs:if(Ee.tag===5&&(Ee=Ee.memoizedProps["data-testname"],typeof Ee=="string"&&Ee.toLowerCase()===Se.value.toLowerCase()))return!0;break;default:throw Error(oe(365))}return!1}function na(Ee){switch(Ee.$$typeof){case Jo:return"<"+(Re(Ee.value)||"Unknown")+">";case Zo:return":has("+(na(Ee)||"")+")";case es:return'[role="'+Ee.value+'"]';case os:return'"'+Ee.value+'"';case rs:return'[data-testname="'+Ee.value+'"]';default:throw Error(oe(365))}}function Bl(Ee,Se){var Oe=[];Ee=[Ee,0];for(var je=0;je<Ee.length;){var Xe=Ee[je++],ut=Ee[je++],Rt=Se[ut];if(Xe.tag!==5||!Pt(Xe)){for(;Rt!=null&&ta(Xe,Rt);)ut++,Rt=Se[ut];if(ut===Se.length)Oe.push(Xe);else for(Xe=Xe.child;Xe!==null;)Ee.push(Xe,ut),Xe=Xe.sibling}}return Oe}function ra(Ee,Se){if(!pt)throw Error(oe(363));Ee=ea(Ee),Ee=Bl(Ee,Se),Se=[],Ee=Array.from(Ee);for(var Oe=0;Oe<Ee.length;){var je=Ee[Oe++];if(je.tag===5)Pt(je)||Se.push(je.stateNode);else for(je=je.child;je!==null;)Ee.push(je),je=je.sibling}return Se}var hc=Math.ceil,ss=se.ReactCurrentDispatcher,ia=se.ReactCurrentOwner,Fr=se.ReactCurrentBatchConfig,Ar=0,Qr=null,Ur=null,Zr=0,di=0,ho=Cn(0),Hr=0,Mo=null,Ki=0,as=0,oa=0,Ro=null,ai=null,sa=0,aa=1/0,Oi=null;function mo(){aa=vn()+500}var ls=!1,la=null,Ui=null,cs=!1,Gi=null,us=0,Po=0,ca=null,fs=-1,ds=0;function ii(){return Ar&6?vn():fs!==-1?fs:fs=vn()}function zi(Ee){return Ee.mode&1?Ar&2&&Zr!==0?Zr&-Zr:Yl.transition!==null?(ds===0&&(ds=qe()),ds):(Ee=Kt,Ee!==0?Ee:bt()):1}function yi(Ee,Se,Oe,je){if(50<Po)throw Po=0,ca=null,Error(oe(185));Ft(Ee,Oe,je),(!(Ar&2)||Ee!==Qr)&&(Ee===Qr&&(!(Ar&2)&&(as|=Oe),Hr===4&&Hi(Ee,Zr)),li(Ee,je),Oe===1&&Ar===0&&!(Se.mode&1)&&(mo(),Wi&&ui()))}function li(Ee,Se){var Oe=Ee.callbackNode;We(Ee,Se);var je=mt(Ee,Ee===Qr?Zr:0);if(je===0)Oe!==null&&nn(Oe),Ee.callbackNode=null,Ee.callbackPriority=0;else if(Se=je&-je,Ee.callbackPriority!==Se){if(Oe!=null&&nn(Oe),Se===1)Ee.tag===0?Xi(Nl.bind(null,Ee)):no(Nl.bind(null,Ee)),Mt?_t(function(){!(Ar&6)&&ui()}):sn(Mn,ui),Oe=null;else{switch(on(je)){case 1:Oe=Mn;break;case 4:Oe=Yn;break;case 16:Oe=jn;break;case 536870912:Oe=Wn;break;default:Oe=jn}Oe=Vl(Oe,Ll.bind(null,Ee))}Ee.callbackPriority=Se,Ee.callbackNode=Oe}}function Ll(Ee,Se){if(fs=-1,ds=0,Ar&6)throw Error(oe(327));var Oe=Ee.callbackNode;if(eo()&&Ee.callbackNode!==Oe)return null;var je=mt(Ee,Ee===Qr?Zr:0);if(je===0)return null;if(je&30||je&Ee.expiredLanes||Se)Se=ps(Ee,je);else{Se=je;var Xe=Ar;Ar|=2;var ut=Fl();(Qr!==Ee||Zr!==Se)&&(Oi=null,mo(),Ji(Ee,Se));do try{Ac();break}catch(Zt){kl(Ee,Zt)}while(!0);_s(),ss.current=ut,Ar=Xe,Ur!==null?Se=0:(Qr=null,Zr=0,Se=Hr)}if(Se!==0){if(Se===2&&(Xe=Ye(Ee),Xe!==0&&(je=Xe,Se=ua(Ee,Xe))),Se===1)throw Oe=Mo,Ji(Ee,0),Hi(Ee,je),li(Ee,vn()),Oe;if(Se===6)Hi(Ee,je);else{if(Xe=Ee.current.alternate,!(je&30)&&!mc(Xe)&&(Se=ps(Ee,je),Se===2&&(ut=Ye(Ee),ut!==0&&(je=ut,Se=ua(Ee,ut))),Se===1))throw Oe=Mo,Ji(Ee,0),Hi(Ee,je),li(Ee,vn()),Oe;switch(Ee.finishedWork=Xe,Ee.finishedLanes=je,Se){case 0:case 1:throw Error(oe(345));case 2:Zi(Ee,ai,Oi);break;case 3:if(Hi(Ee,je),(je&130023424)===je&&(Se=sa+500-vn(),10<Se)){if(mt(Ee,0)!==0)break;if(Xe=Ee.suspendedLanes,(Xe&je)!==je){ii(),Ee.pingedLanes|=Ee.suspendedLanes&Xe;break}Ee.timeoutHandle=it(Zi.bind(null,Ee,ai,Oi),Se);break}Zi(Ee,ai,Oi);break;case 4:if(Hi(Ee,je),(je&4194240)===je)break;for(Se=Ee.eventTimes,Xe=-1;0<je;){var Rt=31-sr(je);ut=1<<Rt,Rt=Se[Rt],Rt>Xe&&(Xe=Rt),je&=~ut}if(je=Xe,je=vn()-je,je=(120>je?120:480>je?480:1080>je?1080:1920>je?1920:3e3>je?3e3:4320>je?4320:1960*hc(je/1960))-je,10<je){Ee.timeoutHandle=it(Zi.bind(null,Ee,ai,Oi),je);break}Zi(Ee,ai,Oi);break;case 5:Zi(Ee,ai,Oi);break;default:throw Error(oe(329))}}}return li(Ee,vn()),Ee.callbackNode===Oe?Ll.bind(null,Ee):null}function ua(Ee,Se){var Oe=Ro;return Ee.current.memoizedState.isDehydrated&&(Ji(Ee,Se).flags|=256),Ee=ps(Ee,Se),Ee!==2&&(Se=ai,ai=Oe,Se!==null&&fa(Se)),Ee}function fa(Ee){ai===null?ai=Ee:ai.push.apply(ai,Ee)}function mc(Ee){for(var Se=Ee;;){if(Se.flags&16384){var Oe=Se.updateQueue;if(Oe!==null&&(Oe=Oe.stores,Oe!==null))for(var je=0;je<Oe.length;je++){var Xe=Oe[je],ut=Xe.getSnapshot;Xe=Xe.value;try{if(!Or(ut(),Xe))return!1}catch{return!1}}}if(Oe=Se.child,Se.subtreeFlags&16384&&Oe!==null)Oe.return=Se,Se=Oe;else{if(Se===Ee)break;for(;Se.sibling===null;){if(Se.return===null||Se.return===Ee)return!0;Se=Se.return}Se.sibling.return=Se.return,Se=Se.sibling}}return!0}function Hi(Ee,Se){for(Se&=~oa,Se&=~as,Ee.suspendedLanes|=Se,Ee.pingedLanes&=~Se,Ee=Ee.expirationTimes;0<Se;){var Oe=31-sr(Se),je=1<<Oe;Ee[Oe]=-1,Se&=~je}}function Nl(Ee){if(Ar&6)throw Error(oe(327));eo();var Se=mt(Ee,0);if(!(Se&1))return li(Ee,vn()),null;var Oe=ps(Ee,Se);if(Ee.tag!==0&&Oe===2){var je=Ye(Ee);je!==0&&(Se=je,Oe=ua(Ee,je))}if(Oe===1)throw Oe=Mo,Ji(Ee,0),Hi(Ee,Se),li(Ee,vn()),Oe;if(Oe===6)throw Error(oe(345));return Ee.finishedWork=Ee.current.alternate,Ee.finishedLanes=Se,Zi(Ee,ai,Oi),li(Ee,vn()),null}function Ol(Ee){Gi!==null&&Gi.tag===0&&!(Ar&6)&&eo();var Se=Ar;Ar|=1;var Oe=Fr.transition,je=Kt;try{if(Fr.transition=null,Kt=1,Ee)return Ee()}finally{Kt=je,Fr.transition=Oe,Ar=Se,!(Ar&6)&&ui()}}function da(){di=ho.current,wn(ho)}function Ji(Ee,Se){Ee.finishedWork=null,Ee.finishedLanes=0;var Oe=Ee.timeoutHandle;if(Oe!==Tt&&(Ee.timeoutHandle=Tt,nt(Oe)),Ur!==null)for(Oe=Ur.return;Oe!==null;){var je=Oe;switch(io(je),je.tag){case 1:je=je.type.childContextTypes,je!=null&&Zn();break;case 3:uo(),wn(On),wn(Fn),Rs();break;case 5:Is(je);break;case 4:uo();break;case 13:wn(Br);break;case 19:wn(Br);break;case 10:Ss(je.type._context);break;case 22:case 23:da()}Oe=Oe.return}if(Qr=Ee,Ur=Ee=Vi(Ee.current,null),Zr=di=Se,Hr=0,Mo=null,oa=as=Ki=0,ai=Ro=null,qi!==null){for(Se=0;Se<qi.length;Se++)if(Oe=qi[Se],je=Oe.interleaved,je!==null){Oe.interleaved=null;var Xe=je.next,ut=Oe.pending;if(ut!==null){var Rt=ut.next;ut.next=Xe,je.next=Rt}Oe.pending=je}qi=null}return Ee}function kl(Ee,Se){do{var Oe=Ur;try{if(_s(),Uo.current=Vo,Go){for(var je=Lr.memoizedState;je!==null;){var Xe=je.queue;Xe!==null&&(Xe.pending=null),je=je.next}Go=!1}if(Yi=0,Wr=zr=Lr=null,vo=!1,Eo=0,ia.current=null,Oe===null||Oe.return===null){Hr=1,Mo=Se,Ur=null;break}e:{var ut=Ee,Rt=Oe.return,Zt=Oe,pn=Se;if(Se=Zr,Zt.flags|=32768,pn!==null&&typeof pn=="object"&&typeof pn.then=="function"){var Pn=pn,Xn=Zt,ar=Xn.tag;if(!(Xn.mode&1)&&(ar===0||ar===11||ar===15)){var $n=Xn.alternate;$n?(Xn.updateQueue=$n.updateQueue,Xn.memoizedState=$n.memoizedState,Xn.lanes=$n.lanes):(Xn.updateQueue=null,Xn.memoizedState=null)}var br=al(Rt);if(br!==null){br.flags&=-257,ll(br,Rt,Zt,ut,Se),br.mode&1&&sl(ut,Pn,Se),Se=br,pn=Pn;var Tr=Se.updateQueue;if(Tr===null){var ci=new Set;ci.add(pn),Se.updateQueue=ci}else Tr.add(pn);break e}else{if(!(Se&1)){sl(ut,Pn,Se),pa();break e}pn=Error(oe(426))}}else if(Mr&&Zt.mode&1){var ki=al(Rt);if(ki!==null){!(ki.flags&65536)&&(ki.flags|=256),ll(ki,Rt,Zt,ut,Se),vs(fo(pn,Zt));break e}}ut=pn=fo(pn,Zt),Hr!==4&&(Hr=2),Ro===null?Ro=[ut]:Ro.push(ut),ut=Rt;do{switch(ut.tag){case 3:ut.flags|=65536,Se&=-Se,ut.lanes|=Se;var ln=il(ut,pn,Se);Ra(ut,ln);break e;case 1:Zt=pn;var en=ut.type,gn=ut.stateNode;if(!(ut.flags&128)&&(typeof en.getDerivedStateFromError=="function"||gn!==null&&typeof gn.componentDidCatch=="function"&&(Ui===null||!Ui.has(gn)))){ut.flags|=65536,Se&=-Se,ut.lanes|=Se;var Gn=ol(ut,Zt,Se);Ra(ut,Gn);break e}}ut=ut.return}while(ut!==null)}Ul(Oe)}catch(tr){Se=tr,Ur===Oe&&Oe!==null&&(Ur=Oe=Oe.return);continue}break}while(!0)}function Fl(){var Ee=ss.current;return ss.current=Vo,Ee===null?Vo:Ee}function pa(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),Qr===null||!(Ki&268435455)&&!(as&268435455)||Hi(Qr,Zr)}function ps(Ee,Se){var Oe=Ar;Ar|=2;var je=Fl();(Qr!==Ee||Zr!==Se)&&(Oi=null,Ji(Ee,Se));do try{gc();break}catch(Xe){kl(Ee,Xe)}while(!0);if(_s(),Ar=Oe,ss.current=je,Ur!==null)throw Error(oe(261));return Qr=null,Zr=0,Hr}function gc(){for(;Ur!==null;)$l(Ur)}function Ac(){for(;Ur!==null&&!mn();)$l(Ur)}function $l(Ee){var Se=Hl(Ee.alternate,Ee,di);Ee.memoizedProps=Ee.pendingProps,Se===null?Ul(Ee):Ur=Se,ia.current=null}function Ul(Ee){var Se=Ee;do{var Oe=Se.alternate;if(Ee=Se.return,Se.flags&32768){if(Oe=uc(Oe,Se),Oe!==null){Oe.flags&=32767,Ur=Oe;return}if(Ee!==null)Ee.flags|=32768,Ee.subtreeFlags=0,Ee.deletions=null;else{Hr=6,Ur=null;return}}else if(Oe=cc(Oe,Se,di),Oe!==null){Ur=Oe;return}if(Se=Se.sibling,Se!==null){Ur=Se;return}Ur=Se=Ee}while(Se!==null);Hr===0&&(Hr=5)}function Zi(Ee,Se,Oe){var je=Kt,Xe=Fr.transition;try{Fr.transition=null,Kt=1,xc(Ee,Se,Oe,je)}finally{Fr.transition=Xe,Kt=je}return null}function xc(Ee,Se,Oe,je){do eo();while(Gi!==null);if(Ar&6)throw Error(oe(327));Oe=Ee.finishedWork;var Xe=Ee.finishedLanes;if(Oe===null)return null;if(Ee.finishedWork=null,Ee.finishedLanes=0,Oe===Ee.current)throw Error(oe(177));Ee.callbackNode=null,Ee.callbackPriority=0;var ut=Oe.lanes|Oe.childLanes;if(Xt(Ee,ut),Ee===Qr&&(Ur=Qr=null,Zr=0),!(Oe.subtreeFlags&2064)&&!(Oe.flags&2064)||cs||(cs=!0,Vl(jn,function(){return eo(),null})),ut=(Oe.flags&15990)!==0,Oe.subtreeFlags&15990||ut){ut=Fr.transition,Fr.transition=null;var Rt=Kt;Kt=1;var Zt=Ar;Ar|=4,ia.current=null,dc(Ee,Oe),Il(Oe,Ee),ot(Ee.containerInfo),Ee.current=Oe,pc(Oe),yn(),Ar=Zt,Kt=Rt,Fr.transition=ut}else Ee.current=Oe;if(cs&&(cs=!1,Gi=Ee,us=Xe),ut=Ee.pendingLanes,ut===0&&(Ui=null),wr(Oe.stateNode),li(Ee,vn()),Se!==null)for(je=Ee.onRecoverableError,Oe=0;Oe<Se.length;Oe++)Xe=Se[Oe],je(Xe.value,{componentStack:Xe.stack,digest:Xe.digest});if(ls)throw ls=!1,Ee=la,la=null,Ee;return us&1&&Ee.tag!==0&&eo(),ut=Ee.pendingLanes,ut&1?Ee===ca?Po++:(Po=0,ca=Ee):Po=0,ui(),null}function eo(){if(Gi!==null){var Ee=on(us),Se=Fr.transition,Oe=Kt;try{if(Fr.transition=null,Kt=16>Ee?16:Ee,Gi===null)var je=!1;else{if(Ee=Gi,Gi=null,us=0,Ar&6)throw Error(oe(331));var Xe=Ar;for(Ar|=4,Qn=Ee.current;Qn!==null;){var ut=Qn,Rt=ut.child;if(Qn.flags&16){var Zt=ut.deletions;if(Zt!==null){for(var pn=0;pn<Zt.length;pn++){var Pn=Zt[pn];for(Qn=Pn;Qn!==null;){var Xn=Qn;switch(Xn.tag){case 0:case 11:case 15:wo(8,Xn,ut)}var ar=Xn.child;if(ar!==null)ar.return=Xn,Qn=ar;else for(;Qn!==null;){Xn=Qn;var $n=Xn.sibling,br=Xn.return;if(Tl(Xn),Xn===Pn){Qn=null;break}if($n!==null){$n.return=br,Qn=$n;break}Qn=br}}}var Tr=ut.alternate;if(Tr!==null){var ci=Tr.child;if(ci!==null){Tr.child=null;do{var ki=ci.sibling;ci.sibling=null,ci=ki}while(ci!==null)}}Qn=ut}}if(ut.subtreeFlags&2064&&Rt!==null)Rt.return=ut,Qn=Rt;else e:for(;Qn!==null;){if(ut=Qn,ut.flags&2048)switch(ut.tag){case 0:case 11:case 15:wo(9,ut,ut.return)}var ln=ut.sibling;if(ln!==null){ln.return=ut.return,Qn=ln;break e}Qn=ut.return}}var en=Ee.current;for(Qn=en;Qn!==null;){Rt=Qn;var gn=Rt.child;if(Rt.subtreeFlags&2064&&gn!==null)gn.return=Rt,Qn=gn;else e:for(Rt=en;Qn!==null;){if(Zt=Qn,Zt.flags&2048)try{switch(Zt.tag){case 0:case 11:case 15:Ko(9,Zt)}}catch(tr){Rr(Zt,Zt.return,tr)}if(Zt===Rt){Qn=null;break e}var Gn=Zt.sibling;if(Gn!==null){Gn.return=Zt.return,Qn=Gn;break e}Qn=Zt.return}}if(Ar=Xe,ui(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(ir,Ee)}catch{}je=!0}return je}finally{Kt=Oe,Fr.transition=Se}}return!1}function Gl(Ee,Se,Oe){Se=fo(Oe,Se),Se=il(Ee,Se,1),Ee=$i(Ee,Se,1),Se=ii(),Ee!==null&&(Ft(Ee,1,Se),li(Ee,Se))}function Rr(Ee,Se,Oe){if(Ee.tag===3)Gl(Ee,Ee,Oe);else for(;Se!==null;){if(Se.tag===3){Gl(Se,Ee,Oe);break}else if(Se.tag===1){var je=Se.stateNode;if(typeof Se.type.getDerivedStateFromError=="function"||typeof je.componentDidCatch=="function"&&(Ui===null||!Ui.has(je))){Ee=fo(Oe,Ee),Ee=ol(Se,Ee,1),Se=$i(Se,Ee,1),Ee=ii(),Se!==null&&(Ft(Se,1,Ee),li(Se,Ee));break}}Se=Se.return}}function yc(Ee,Se,Oe){var je=Ee.pingCache;je!==null&&je.delete(Se),Se=ii(),Ee.pingedLanes|=Ee.suspendedLanes&Oe,Qr===Ee&&(Zr&Oe)===Oe&&(Hr===4||Hr===3&&(Zr&130023424)===Zr&&500>vn()-sa?Ji(Ee,0):oa|=Oe),li(Ee,Se)}function zl(Ee,Se){Se===0&&(Ee.mode&1?(Se=Hn,Hn<<=1,!(Hn&130023424)&&(Hn=4194304)):Se=1);var Oe=ii();Ee=Ii(Ee,Se),Ee!==null&&(Ft(Ee,Se,Oe),li(Ee,Oe))}function vc(Ee){var Se=Ee.memoizedState,Oe=0;Se!==null&&(Oe=Se.retryLane),zl(Ee,Oe)}function Ec(Ee,Se){var Oe=0;switch(Ee.tag){case 13:var je=Ee.stateNode,Xe=Ee.memoizedState;Xe!==null&&(Oe=Xe.retryLane);break;case 19:je=Ee.stateNode;break;default:throw Error(oe(314))}je!==null&&je.delete(Se),zl(Ee,Oe)}var Hl;Hl=function(Ee,Se,Oe){if(Ee!==null)if(Ee.memoizedProps!==Se.pendingProps||On.current)si=!0;else{if(!(Ee.lanes&Oe)&&!(Se.flags&128))return si=!1,lc(Ee,Se,Oe);si=!!(Ee.flags&131072)}else si=!1,Mr&&Se.flags&1048576&&Kr(Se,ro,Se.index);switch(Se.lanes=0,Se.tag){case 2:var je=Se.type;Qo(Ee,Se),Ee=Se.pendingProps;var Xe=mr(Se,Fn.current);lo(Se,Oe),Xe=Bs(null,Se,je,Ee,Xe,Oe);var ut=Ls();return Se.flags|=1,typeof Xe=="object"&&Xe!==null&&typeof Xe.render=="function"&&Xe.$$typeof===void 0?(Se.tag=1,Se.memoizedState=null,Se.updateQueue=null,zn(je)?(ut=!0,Jn(Se)):ut=!1,Se.memoizedState=Xe.state!==null&&Xe.state!==void 0?Xe.state:null,Cs(Se),Xe.updater=jo,Se.stateNode=Xe,Xe._reactInternals=Se,Us(Se,je,Ee,Oe),Se=Vs(null,Se,je,!0,ut,Oe)):(Se.tag=0,Mr&&ut&&hi(Se),oi(null,Se,Xe,Oe),Se=Se.child),Se;case 16:je=Se.elementType;e:{switch(Qo(Ee,Se),Ee=Se.pendingProps,Xe=je._init,je=Xe(je._payload),Se.type=je,Xe=Se.tag=Sc(je),Ee=Si(je,Ee),Xe){case 0:Se=Hs(null,Se,je,Ee,Oe);break e;case 1:Se=ml(null,Se,je,Ee,Oe);break e;case 11:Se=cl(null,Se,je,Ee,Oe);break e;case 14:Se=ul(null,Se,je,Si(je.type,Ee),Oe);break e}throw Error(oe(306,je,""))}return Se;case 0:return je=Se.type,Xe=Se.pendingProps,Xe=Se.elementType===je?Xe:Si(je,Xe),Hs(Ee,Se,je,Xe,Oe);case 1:return je=Se.type,Xe=Se.pendingProps,Xe=Se.elementType===je?Xe:Si(je,Xe),ml(Ee,Se,je,Xe,Oe);case 3:e:{if(gl(Se),Ee===null)throw Error(oe(387));je=Se.pendingProps,ut=Se.memoizedState,Xe=ut.element,Ma(Ee,Se),Fo(Se,je,null,Oe);var Rt=Se.memoizedState;if(je=Rt.element,zt&&ut.isDehydrated)if(ut={element:je,isDehydrated:!1,cache:Rt.cache,pendingSuspenseBoundaries:Rt.pendingSuspenseBoundaries,transitions:Rt.transitions},Se.updateQueue.baseState=ut,Se.memoizedState=ut,Se.flags&256){Xe=fo(Error(oe(423)),Se),Se=Al(Ee,Se,je,Oe,Xe);break e}else if(je!==Xe){Xe=fo(Error(oe(424)),Se),Se=Al(Ee,Se,je,Oe,Xe);break e}else for(zt&&(mi=$r(Se.stateNode.containerInfo),fi=Se,Mr=!0,_i=null,go=!1),Oe=Ca(Se,null,je,Oe),Se.child=Oe;Oe;)Oe.flags=Oe.flags&-3|4096,Oe=Oe.sibling;else{if(oo(),je===Xe){Se=Ni(Ee,Se,Oe);break e}oi(Ee,Se,je,Oe)}Se=Se.child}return Se;case 5:return Da(Se),Ee===null&&ys(Se),je=Se.type,Xe=Se.pendingProps,ut=Ee!==null?Ee.memoizedProps:null,Rt=Xe.children,Qe(je,Xe)?Rt=null:ut!==null&&Qe(je,ut)&&(Se.flags|=32),hl(Ee,Se),oi(Ee,Se,Rt,Oe),Se.child;case 6:return Ee===null&&ys(Se),null;case 13:return xl(Ee,Se,Oe);case 4:return ws(Se,Se.stateNode.containerInfo),je=Se.pendingProps,Ee===null?Se.child=so(Se,null,je,Oe):oi(Ee,Se,je,Oe),Se.child;case 11:return je=Se.type,Xe=Se.pendingProps,Xe=Se.elementType===je?Xe:Si(je,Xe),cl(Ee,Se,je,Xe,Oe);case 7:return oi(Ee,Se,Se.pendingProps,Oe),Se.child;case 8:return oi(Ee,Se,Se.pendingProps.children,Oe),Se.child;case 12:return oi(Ee,Se,Se.pendingProps.children,Oe),Se.child;case 10:e:{if(je=Se.type._context,Xe=Se.pendingProps,ut=Se.memoizedProps,Rt=Xe.value,wa(Se,je,Rt),ut!==null)if(Or(ut.value,Rt)){if(ut.children===Xe.children&&!On.current){Se=Ni(Ee,Se,Oe);break e}}else for(ut=Se.child,ut!==null&&(ut.return=Se);ut!==null;){var Zt=ut.dependencies;if(Zt!==null){Rt=ut.child;for(var pn=Zt.firstContext;pn!==null;){if(pn.context===je){if(ut.tag===1){pn=Li(-1,Oe&-Oe),pn.tag=2;var Pn=ut.updateQueue;if(Pn!==null){Pn=Pn.shared;var Xn=Pn.pending;Xn===null?pn.next=pn:(pn.next=Xn.next,Xn.next=pn),Pn.pending=pn}}ut.lanes|=Oe,pn=ut.alternate,pn!==null&&(pn.lanes|=Oe),Ts(ut.return,Oe,Se),Zt.lanes|=Oe;break}pn=pn.next}}else if(ut.tag===10)Rt=ut.type===Se.type?null:ut.child;else if(ut.tag===18){if(Rt=ut.return,Rt===null)throw Error(oe(341));Rt.lanes|=Oe,Zt=Rt.alternate,Zt!==null&&(Zt.lanes|=Oe),Ts(Rt,Oe,Se),Rt=ut.sibling}else Rt=ut.child;if(Rt!==null)Rt.return=ut;else for(Rt=ut;Rt!==null;){if(Rt===Se){Rt=null;break}if(ut=Rt.sibling,ut!==null){ut.return=Rt.return,Rt=ut;break}Rt=Rt.return}ut=Rt}oi(Ee,Se,Xe.children,Oe),Se=Se.child}return Se;case 9:return Xe=Se.type,je=Se.pendingProps.children,lo(Se,Oe),Xe=gi(Xe),je=je(Xe),Se.flags|=1,oi(Ee,Se,je,Oe),Se.child;case 14:return je=Se.type,Xe=Si(je,Se.pendingProps),Xe=Si(je.type,Xe),ul(Ee,Se,je,Xe,Oe);case 15:return dl(Ee,Se,Se.type,Se.pendingProps,Oe);case 17:return je=Se.type,Xe=Se.pendingProps,Xe=Se.elementType===je?Xe:Si(je,Xe),Qo(Ee,Se),Se.tag=1,zn(je)?(Ee=!0,Jn(Se)):Ee=!1,lo(Se,Oe),nl(Se,je,Xe),Us(Se,je,Xe,Oe),Vs(null,Se,je,!0,Ee,Oe);case 19:return vl(Ee,Se,Oe);case 22:return pl(Ee,Se,Oe)}throw Error(oe(156,Se.tag))};function Vl(Ee,Se){return sn(Ee,Se)}function _c(Ee,Se,Oe,je){this.tag=Ee,this.key=Oe,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Se,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=je,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vi(Ee,Se,Oe,je){return new _c(Ee,Se,Oe,je)}function ha(Ee){return Ee=Ee.prototype,!(!Ee||!Ee.isReactComponent)}function Sc(Ee){if(typeof Ee=="function")return ha(Ee)?1:0;if(Ee!=null){if(Ee=Ee.$$typeof,Ee===ge)return 11;if(Ee===ye)return 14}return 2}function Vi(Ee,Se){var Oe=Ee.alternate;return Oe===null?(Oe=vi(Ee.tag,Se,Ee.key,Ee.mode),Oe.elementType=Ee.elementType,Oe.type=Ee.type,Oe.stateNode=Ee.stateNode,Oe.alternate=Ee,Ee.alternate=Oe):(Oe.pendingProps=Se,Oe.type=Ee.type,Oe.flags=0,Oe.subtreeFlags=0,Oe.deletions=null),Oe.flags=Ee.flags&14680064,Oe.childLanes=Ee.childLanes,Oe.lanes=Ee.lanes,Oe.child=Ee.child,Oe.memoizedProps=Ee.memoizedProps,Oe.memoizedState=Ee.memoizedState,Oe.updateQueue=Ee.updateQueue,Se=Ee.dependencies,Oe.dependencies=Se===null?null:{lanes:Se.lanes,firstContext:Se.firstContext},Oe.sibling=Ee.sibling,Oe.index=Ee.index,Oe.ref=Ee.ref,Oe}function hs(Ee,Se,Oe,je,Xe,ut){var Rt=2;if(je=Ee,typeof Ee=="function")ha(Ee)&&(Rt=1);else if(typeof Ee=="string")Rt=5;else e:switch(Ee){case ce:return to(Oe.children,Xe,ut,Se);case fe:Rt=8,Xe|=8;break;case de:return Ee=vi(12,Oe,Se,Xe|2),Ee.elementType=de,Ee.lanes=ut,Ee;case me:return Ee=vi(13,Oe,Se,Xe),Ee.elementType=me,Ee.lanes=ut,Ee;case Ae:return Ee=vi(19,Oe,Se,Xe),Ee.elementType=Ae,Ee.lanes=ut,Ee;case _e:return ms(Oe,Xe,ut,Se);default:if(typeof Ee=="object"&&Ee!==null)switch(Ee.$$typeof){case pe:Rt=10;break e;case he:Rt=9;break e;case ge:Rt=11;break e;case ye:Rt=14;break e;case ve:Rt=16,je=null;break e}throw Error(oe(130,Ee==null?Ee:typeof Ee,""))}return Se=vi(Rt,Oe,Se,Xe),Se.elementType=Ee,Se.type=je,Se.lanes=ut,Se}function to(Ee,Se,Oe,je){return Ee=vi(7,Ee,je,Se),Ee.lanes=Oe,Ee}function ms(Ee,Se,Oe,je){return Ee=vi(22,Ee,je,Se),Ee.elementType=_e,Ee.lanes=Oe,Ee.stateNode={isHidden:!1},Ee}function ma(Ee,Se,Oe){return Ee=vi(6,Ee,null,Se),Ee.lanes=Oe,Ee}function ga(Ee,Se,Oe){return Se=vi(4,Ee.children!==null?Ee.children:[],Ee.key,Se),Se.lanes=Oe,Se.stateNode={containerInfo:Ee.containerInfo,pendingChildren:null,implementation:Ee.implementation},Se}function Tc(Ee,Se,Oe,je,Xe){this.tag=Se,this.containerInfo=Ee,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Tt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dt(0),this.expirationTimes=dt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dt(0),this.identifierPrefix=je,this.onRecoverableError=Xe,zt&&(this.mutableSourceEagerHydrationData=null)}function jl(Ee,Se,Oe,je,Xe,ut,Rt,Zt,pn){return Ee=new Tc(Ee,Se,Oe,Zt,pn),Se===1?(Se=1,ut===!0&&(Se|=8)):Se=0,ut=vi(3,null,null,Se),Ee.current=ut,ut.stateNode=Ee,ut.memoizedState={element:je,isDehydrated:Oe,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cs(ut),Ee}function Wl(Ee){if(!Ee)return nr;Ee=Ee._reactInternals;e:{if(Pe(Ee)!==Ee||Ee.tag!==1)throw Error(oe(170));var Se=Ee;do{switch(Se.tag){case 3:Se=Se.stateNode.context;break e;case 1:if(zn(Se.type)){Se=Se.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Se=Se.return}while(Se!==null);throw Error(oe(171))}if(Ee.tag===1){var Oe=Ee.type;if(zn(Oe))return er(Ee,Oe,Se)}return Se}function Ql(Ee){var Se=Ee._reactInternals;if(Se===void 0)throw typeof Ee.render=="function"?Error(oe(188)):(Ee=Object.keys(Ee).join(","),Error(oe(268,Ee)));return Ee=Ue(Se),Ee===null?null:Ee.stateNode}function Xl(Ee,Se){if(Ee=Ee.memoizedState,Ee!==null&&Ee.dehydrated!==null){var Oe=Ee.retryLane;Ee.retryLane=Oe!==0&&Oe<Se?Oe:Se}}function gs(Ee,Se){Xl(Ee,Se),(Ee=Ee.alternate)&&Xl(Ee,Se)}function bc(Ee){return Ee=Ue(Ee),Ee===null?null:Ee.stateNode}function Cc(){return null}return Z.attemptContinuousHydration=function(Ee){if(Ee.tag===13){var Se=Ii(Ee,134217728);if(Se!==null){var Oe=ii();yi(Se,Ee,134217728,Oe)}gs(Ee,134217728)}},Z.attemptDiscreteHydration=function(Ee){if(Ee.tag===13){var Se=Ii(Ee,1);if(Se!==null){var Oe=ii();yi(Se,Ee,1,Oe)}gs(Ee,1)}},Z.attemptHydrationAtCurrentPriority=function(Ee){if(Ee.tag===13){var Se=zi(Ee),Oe=Ii(Ee,Se);if(Oe!==null){var je=ii();yi(Oe,Ee,Se,je)}gs(Ee,Se)}},Z.attemptSynchronousHydration=function(Ee){switch(Ee.tag){case 3:var Se=Ee.stateNode;if(Se.current.memoizedState.isDehydrated){var Oe=qn(Se.pendingLanes);Oe!==0&&(an(Se,Oe|1),li(Se,vn()),!(Ar&6)&&(mo(),ui()))}break;case 13:Ol(function(){var je=Ii(Ee,1);if(je!==null){var Xe=ii();yi(je,Ee,1,Xe)}}),gs(Ee,1)}},Z.batchedUpdates=function(Ee,Se){var Oe=Ar;Ar|=1;try{return Ee(Se)}finally{Ar=Oe,Ar===0&&(mo(),Wi&&ui())}},Z.createComponentSelector=function(Ee){return{$$typeof:Jo,value:Ee}},Z.createContainer=function(Ee,Se,Oe,je,Xe,ut,Rt){return jl(Ee,Se,!1,null,Oe,je,Xe,ut,Rt)},Z.createHasPseudoClassSelector=function(Ee){return{$$typeof:Zo,value:Ee}},Z.createHydrationContainer=function(Ee,Se,Oe,je,Xe,ut,Rt,Zt,pn){return Ee=jl(Oe,je,!0,Ee,Xe,ut,Rt,Zt,pn),Ee.context=Wl(null),Oe=Ee.current,je=ii(),Xe=zi(Oe),ut=Li(je,Xe),ut.callback=Se??null,$i(Oe,ut,Xe),Ee.current.lanes=Xe,Ft(Ee,Xe,je),li(Ee,je),Ee},Z.createPortal=function(Ee,Se,Oe){var je=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:le,key:je==null?null:""+je,children:Ee,containerInfo:Se,implementation:Oe}},Z.createRoleSelector=function(Ee){return{$$typeof:es,value:Ee}},Z.createTestNameSelector=function(Ee){return{$$typeof:rs,value:Ee}},Z.createTextSelector=function(Ee){return{$$typeof:os,value:Ee}},Z.deferredUpdates=function(Ee){var Se=Kt,Oe=Fr.transition;try{return Fr.transition=null,Kt=16,Ee()}finally{Kt=Se,Fr.transition=Oe}},Z.discreteUpdates=function(Ee,Se,Oe,je,Xe){var ut=Kt,Rt=Fr.transition;try{return Fr.transition=null,Kt=1,Ee(Se,Oe,je,Xe)}finally{Kt=ut,Fr.transition=Rt,Ar===0&&mo()}},Z.findAllNodes=ra,Z.findBoundingRects=function(Ee,Se){if(!pt)throw Error(oe(363));Se=ra(Ee,Se),Ee=[];for(var Oe=0;Oe<Se.length;Oe++)Ee.push(st(Se[Oe]));for(Se=Ee.length-1;0<Se;Se--){Oe=Ee[Se];for(var je=Oe.x,Xe=je+Oe.width,ut=Oe.y,Rt=ut+Oe.height,Zt=Se-1;0<=Zt;Zt--)if(Se!==Zt){var pn=Ee[Zt],Pn=pn.x,Xn=Pn+pn.width,ar=pn.y,$n=ar+pn.height;if(je>=Pn&&ut>=ar&&Xe<=Xn&&Rt<=$n){Ee.splice(Se,1);break}else if(je!==Pn||Oe.width!==pn.width||$n<ut||ar>Rt){if(!(ut!==ar||Oe.height!==pn.height||Xn<je||Pn>Xe)){Pn>je&&(pn.width+=Pn-je,pn.x=je),Xn<Xe&&(pn.width=Xe-Pn),Ee.splice(Se,1);break}}else{ar>ut&&(pn.height+=ar-ut,pn.y=ut),$n<Rt&&(pn.height=Rt-ar),Ee.splice(Se,1);break}}}return Ee},Z.findHostInstance=Ql,Z.findHostInstanceWithNoPortals=function(Ee){return Ee=$e(Ee),Ee=Ee!==null?Ge(Ee):null,Ee===null?null:Ee.stateNode},Z.findHostInstanceWithWarning=function(Ee){return Ql(Ee)},Z.flushControlled=function(Ee){var Se=Ar;Ar|=1;var Oe=Fr.transition,je=Kt;try{Fr.transition=null,Kt=1,Ee()}finally{Kt=je,Fr.transition=Oe,Ar=Se,Ar===0&&(mo(),ui())}},Z.flushPassiveEffects=eo,Z.flushSync=Ol,Z.focusWithin=function(Ee,Se){if(!pt)throw Error(oe(363));for(Ee=ea(Ee),Se=Bl(Ee,Se),Se=Array.from(Se),Ee=0;Ee<Se.length;){var Oe=Se[Ee++];if(!Pt(Oe)){if(Oe.tag===5&&Vt(Oe.stateNode))return!0;for(Oe=Oe.child;Oe!==null;)Se.push(Oe),Oe=Oe.sibling}}return!1},Z.getCurrentUpdatePriority=function(){return Kt},Z.getFindAllNodesFailureDescription=function(Ee,Se){if(!pt)throw Error(oe(363));var Oe=0,je=[];Ee=[ea(Ee),0];for(var Xe=0;Xe<Ee.length;){var ut=Ee[Xe++],Rt=Ee[Xe++],Zt=Se[Rt];if((ut.tag!==5||!Pt(ut))&&(ta(ut,Zt)&&(je.push(na(Zt)),Rt++,Rt>Oe&&(Oe=Rt)),Rt<Se.length))for(ut=ut.child;ut!==null;)Ee.push(ut,Rt),ut=ut.sibling}if(Oe<Se.length){for(Ee=[];Oe<Se.length;Oe++)Ee.push(na(Se[Oe]));return`findAllNodes was able to match part of the selector:
  `+(je.join(" > ")+`

No matching component was found for:
  `)+Ee.join(" > ")}return null},Z.getPublicRootInstance=function(Ee){if(Ee=Ee.current,!Ee.child)return null;switch(Ee.child.tag){case 5:return ze(Ee.child.stateNode);default:return Ee.child.stateNode}},Z.injectIntoDevTools=function(Ee){if(Ee={bundleType:Ee.bundleType,version:Ee.version,rendererPackageName:Ee.rendererPackageName,rendererConfig:Ee.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:se.ReactCurrentDispatcher,findHostInstanceByFiber:bc,findFiberByHostInstance:Ee.findFiberByHostInstance||Cc,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")Ee=!1;else{var Se=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(Se.isDisabled||!Se.supportsFiber)Ee=!0;else{try{ir=Se.inject(Ee),gr=Se}catch{}Ee=!!Se.checkDCE}}return Ee},Z.isAlreadyRendering=function(){return!1},Z.observeVisibleRects=function(Ee,Se,Oe,je){if(!pt)throw Error(oe(363));Ee=ra(Ee,Se);var Xe=Le(Ee,Oe,je).disconnect;return{disconnect:function(){Xe()}}},Z.registerMutableSourceForHydration=function(Ee,Se){var Oe=Se._getVersion;Oe=Oe(Se._source),Ee.mutableSourceEagerHydrationData==null?Ee.mutableSourceEagerHydrationData=[Se,Oe]:Ee.mutableSourceEagerHydrationData.push(Se,Oe)},Z.runWithPriority=function(Ee,Se){var Oe=Kt;try{return Kt=Ee,Se()}finally{Kt=Oe}},Z.shouldError=function(){return null},Z.shouldSuspend=function(){return!1},Z.updateContainer=function(Ee,Se,Oe,je){var Xe=Se.current,ut=ii(),Rt=zi(Xe);return Oe=Wl(Oe),Se.context===null?Se.context=Oe:Se.pendingContext=Oe,Se=Li(ut,Rt),Se.payload={element:Ee},je=je===void 0?null:je,je!==null&&(Se.callback=je),Ee=$i(Xe,Se,Rt),Ee!==null&&(yi(Ee,Xe,Rt,ut),ko(Ee,Xe,Rt)),Rt},Z}),reactReconciler_production_min}reactReconciler.exports=requireReactReconciler_production_min();var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs$1(reactReconcilerExports);var schedulerExports=requireScheduler(),threeTypes=Object.freeze({__proto__:null});const catalogue={},extend$6=K=>void Object.assign(catalogue,K);function createRenderer(K,_){function Z(ce,{args:fe=[],attach:de,...pe},he){let ge=`${ce[0].toUpperCase()}${ce.slice(1)}`,me;if(ce==="primitive"){if(pe.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const Ae=pe.object;me=prepare(Ae,{type:ce,root:he,attach:de,primitive:!0})}else{const Ae=catalogue[ge];if(!Ae)throw new Error(`R3F: ${ge} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(fe))throw new Error("R3F: The args prop must be an array!");me=prepare(new Ae(...fe),{type:ce,root:he,attach:de,memoizedProps:{args:fe}})}return me.__r3f.attach===void 0&&(me.isBufferGeometry?me.__r3f.attach="geometry":me.isMaterial&&(me.__r3f.attach="material")),ge!=="inject"&&applyProps$1(me,pe),me}function te(ce,fe){let de=!1;if(fe){var pe,he;(pe=fe.__r3f)!=null&&pe.attach?attach(ce,fe,fe.__r3f.attach):fe.isObject3D&&ce.isObject3D&&(ce.add(fe),de=!0),de||(he=ce.__r3f)==null||he.objects.push(fe),fe.__r3f||prepare(fe,{}),fe.__r3f.parent=ce,updateInstance(fe),invalidateInstance(fe)}}function ne(ce,fe,de){let pe=!1;if(fe){var he,ge;if((he=fe.__r3f)!=null&&he.attach)attach(ce,fe,fe.__r3f.attach);else if(fe.isObject3D&&ce.isObject3D){fe.parent=ce,fe.dispatchEvent({type:"added"}),ce.dispatchEvent({type:"childadded",child:fe});const me=ce.children.filter(ye=>ye!==fe),Ae=me.indexOf(de);ce.children=[...me.slice(0,Ae),fe,...me.slice(Ae)],pe=!0}pe||(ge=ce.__r3f)==null||ge.objects.push(fe),fe.__r3f||prepare(fe,{}),fe.__r3f.parent=ce,updateInstance(fe),invalidateInstance(fe)}}function ie(ce,fe,de=!1){ce&&[...ce].forEach(pe=>oe(fe,pe,de))}function oe(ce,fe,de){if(fe){var pe,he,ge;if(fe.__r3f&&(fe.__r3f.parent=null),(pe=ce.__r3f)!=null&&pe.objects&&(ce.__r3f.objects=ce.__r3f.objects.filter(_e=>_e!==fe)),(he=fe.__r3f)!=null&&he.attach)detach(ce,fe,fe.__r3f.attach);else if(fe.isObject3D&&ce.isObject3D){var me;ce.remove(fe),(me=fe.__r3f)!=null&&me.root&&removeInteractivity(findInitialRoot(fe),fe)}const ye=(ge=fe.__r3f)==null?void 0:ge.primitive,ve=!ye&&(de===void 0?fe.dispose!==null:de);if(!ye){var Ae;ie((Ae=fe.__r3f)==null?void 0:Ae.objects,fe,ve),ie(fe.children,fe,ve)}if(delete fe.__r3f,ve&&fe.dispose&&fe.type!=="Scene"){const _e=()=>{try{fe.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,_e):_e()}invalidateInstance(ce)}}function se(ce,fe,de,pe){var he;const ge=(he=ce.__r3f)==null?void 0:he.parent;if(!ge)return;const me=Z(fe,de,ce.__r3f.root);if(ce.children){for(const Ae of ce.children)Ae.__r3f&&te(me,Ae);ce.children=ce.children.filter(Ae=>!Ae.__r3f)}ce.__r3f.objects.forEach(Ae=>te(me,Ae)),ce.__r3f.objects=[],ce.__r3f.autoRemovedBeforeAppend||oe(ge,ce),me.parent&&(me.__r3f.autoRemovedBeforeAppend=!0),te(ge,me),me.raycast&&me.__r3f.eventCount&&findInitialRoot(me).getState().internal.interaction.push(me),[pe,pe.alternate].forEach(Ae=>{Ae!==null&&(Ae.stateNode=me,Ae.ref&&(typeof Ae.ref=="function"?Ae.ref(me):Ae.ref.current=me))})}const ae=()=>{};return{reconciler:Reconciler({createInstance:Z,removeChild:oe,appendChild:te,appendInitialChild:te,insertBefore:ne,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(ce,fe)=>{if(!fe)return;const de=ce.getState().scene;de.__r3f&&(de.__r3f.root=ce,te(de,fe))},removeChildFromContainer:(ce,fe)=>{fe&&oe(ce.getState().scene,fe)},insertInContainerBefore:(ce,fe,de)=>{if(!fe||!de)return;const pe=ce.getState().scene;pe.__r3f&&ne(pe,fe,de)},getRootHostContext:()=>null,getChildHostContext:ce=>ce,finalizeInitialChildren(ce){var fe;return!!((fe=ce==null?void 0:ce.__r3f)!=null?fe:{}).handlers},prepareUpdate(ce,fe,de,pe){var he;if(((he=ce==null?void 0:ce.__r3f)!=null?he:{}).primitive&&pe.object&&pe.object!==ce)return[!0];{const{args:me=[],children:Ae,...ye}=pe,{args:ve=[],children:_e,...Te}=de;if(!Array.isArray(me))throw new Error("R3F: the args prop must be an array!");if(me.some((Re,we)=>Re!==ve[we]))return[!0];const be=diffProps(ce,ye,Te,!0);return be.changes.length?[!1,be]:null}},commitUpdate(ce,[fe,de],pe,he,ge,me){fe?se(ce,pe,ge,me):applyProps$1(ce,de)},commitMount(ce,fe,de,pe){var he;const ge=(he=ce.__r3f)!=null?he:{};ce.raycast&&ge.handlers&&ge.eventCount&&findInitialRoot(ce).getState().internal.interaction.push(ce)},getPublicInstance:ce=>ce,prepareForCommit:()=>null,preparePortalMount:ce=>prepare(ce.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(ce){var fe;const{attach:de,parent:pe}=(fe=ce.__r3f)!=null?fe:{};de&&pe&&detach(pe,ce,de),ce.isObject3D&&(ce.visible=!1),invalidateInstance(ce)},unhideInstance(ce,fe){var de;const{attach:pe,parent:he}=(de=ce.__r3f)!=null?de:{};pe&&he&&attach(he,ce,pe),(ce.isObject3D&&fe.visible==null||fe.visible)&&(ce.visible=!0),invalidateInstance(ce)},createTextInstance:ae,hideTextInstance:ae,unhideTextInstance:ae,getCurrentEventPriority:()=>_?_():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document$1,_window$navigator$1;const hasColorSpace$1=K=>"colorSpace"in K||"outputColorSpace"in K,getColorManagement=()=>{var K;return(K=catalogue.ColorManagement)!=null?K:null},isOrthographicCamera$1=K=>K&&K.isOrthographicCamera,isRef$1=K=>K&&K.hasOwnProperty("current"),useIsomorphicLayoutEffect$2=typeof window<"u"&&((_window$document$1=window.document)!=null&&_window$document$1.createElement||((_window$navigator$1=window.navigator)==null?void 0:_window$navigator$1.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(K){const _=reactExports.useRef(K);return useIsomorphicLayoutEffect$2(()=>void(_.current=K),[K]),_}function Block({set:K}){return useIsomorphicLayoutEffect$2(()=>(K(new Promise(()=>null)),()=>K(!1)),[K]),null}class ErrorBoundary extends reactExports.Component{constructor(..._){super(..._),this.state={error:!1}}componentDidCatch(_){this.props.set(_)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=K=>K&&!!K.memoized&&!!K.changes;function calculateDpr(K){var _;const Z=typeof window<"u"?(_=window.devicePixelRatio)!=null?_:2:1;return Array.isArray(K)?Math.min(Math.max(K[0],Z),K[1]):K}const getRootState=K=>{var _;return(_=K.__r3f)==null?void 0:_.root.getState()};function findInitialRoot(K){let _=K.__r3f.root;for(;_.getState().previousRoot;)_=_.getState().previousRoot;return _}const is={obj:K=>K===Object(K)&&!is.arr(K)&&typeof K!="function",fun:K=>typeof K=="function",str:K=>typeof K=="string",num:K=>typeof K=="number",boo:K=>typeof K=="boolean",und:K=>K===void 0,arr:K=>Array.isArray(K),equ(K,_,{arrays:Z="shallow",objects:te="reference",strict:ne=!0}={}){if(typeof K!=typeof _||!!K!=!!_)return!1;if(is.str(K)||is.num(K)||is.boo(K))return K===_;const ie=is.obj(K);if(ie&&te==="reference")return K===_;const oe=is.arr(K);if(oe&&Z==="reference")return K===_;if((oe||ie)&&K===_)return!0;let se;for(se in K)if(!(se in _))return!1;if(ie&&Z==="shallow"&&te==="shallow"){for(se in ne?_:K)if(!is.equ(K[se],_[se],{strict:ne,objects:"reference"}))return!1}else for(se in ne?_:K)if(K[se]!==_[se])return!1;if(is.und(se)){if(oe&&K.length===0&&_.length===0||ie&&Object.keys(K).length===0&&Object.keys(_).length===0)return!0;if(K!==_)return!1}return!0}};function buildGraph(K){const _={nodes:{},materials:{}};return K&&K.traverse(Z=>{Z.name&&(_.nodes[Z.name]=Z),Z.material&&!_.materials[Z.material.name]&&(_.materials[Z.material.name]=Z.material)}),_}function dispose(K){K.dispose&&K.type!=="Scene"&&K.dispose();for(const _ in K)_.dispose==null||_.dispose(),delete K[_]}function prepare(K,_){const Z=K;return Z.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,..._},K}function resolve(K,_){let Z=K;if(_.includes("-")){const te=_.split("-"),ne=te.pop();return Z=te.reduce((ie,oe)=>ie[oe],K),{target:Z,key:ne}}else return{target:Z,key:_}}const INDEX_REGEX=/-\d+$/;function attach(K,_,Z){if(is.str(Z)){if(INDEX_REGEX.test(Z)){const ie=Z.replace(INDEX_REGEX,""),{target:oe,key:se}=resolve(K,ie);Array.isArray(oe[se])||(oe[se]=[])}const{target:te,key:ne}=resolve(K,Z);_.__r3f.previousAttach=te[ne],te[ne]=_}else _.__r3f.previousAttach=Z(K,_)}function detach(K,_,Z){var te,ne;if(is.str(Z)){const{target:ie,key:oe}=resolve(K,Z),se=_.__r3f.previousAttach;se===void 0?delete ie[oe]:ie[oe]=se}else(te=_.__r3f)==null||te.previousAttach==null||te.previousAttach(K,_);(ne=_.__r3f)==null||delete ne.previousAttach}function diffProps(K,{children:_,key:Z,ref:te,...ne},{children:ie,key:oe,ref:se,...ae}={},le=!1){const ce=K.__r3f,fe=Object.entries(ne),de=[];if(le){const he=Object.keys(ae);for(let ge=0;ge<he.length;ge++)ne.hasOwnProperty(he[ge])||fe.unshift([he[ge],DEFAULT+"remove"])}fe.forEach(([he,ge])=>{var me;if((me=K.__r3f)!=null&&me.primitive&&he==="object"||is.equ(ge,ae[he]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(he))return de.push([he,ge,!0,[]]);let Ae=[];he.includes("-")&&(Ae=he.split("-")),de.push([he,ge,!1,Ae]);for(const ye in ne){const ve=ne[ye];ye.startsWith(`${he}-`)&&de.push([ye,ve,!1,ye.split("-")])}});const pe={...ne};return ce!=null&&ce.memoizedProps&&ce!=null&&ce.memoizedProps.args&&(pe.args=ce.memoizedProps.args),ce!=null&&ce.memoizedProps&&ce!=null&&ce.memoizedProps.attach&&(pe.attach=ce.memoizedProps.attach),{memoized:pe,changes:de}}function applyProps$1(K,_){var Z;const te=K.__r3f,ne=te==null?void 0:te.root,ie=ne==null||ne.getState==null?void 0:ne.getState(),{memoized:oe,changes:se}=isDiffSet(_)?_:diffProps(K,_),ae=te==null?void 0:te.eventCount;K.__r3f&&(K.__r3f.memoizedProps=oe);for(let de=0;de<se.length;de++){let[pe,he,ge,me]=se[de];if(hasColorSpace$1(K)){const _e="srgb",Te="srgb-linear";pe==="encoding"?(pe="colorSpace",he=he===3001?_e:Te):pe==="outputEncoding"&&(pe="outputColorSpace",he=he===3001?_e:Te)}let Ae=K,ye=Ae[pe];if(me.length&&(ye=me.reduce((ve,_e)=>ve[_e],K),!(ye&&ye.set))){const[ve,..._e]=me.reverse();Ae=_e.reverse().reduce((Te,be)=>Te[be],K),pe=ve}if(he===DEFAULT+"remove")if(Ae.constructor){let ve=DEFAULTS.get(Ae.constructor);ve||(ve=new Ae.constructor,DEFAULTS.set(Ae.constructor,ve)),he=ve[pe]}else he=0;if(ge&&te)he?te.handlers[pe]=he:delete te.handlers[pe],te.eventCount=Object.keys(te.handlers).length;else if(ye&&ye.set&&(ye.copy||ye instanceof Layers)){if(Array.isArray(he))ye.fromArray?ye.fromArray(he):ye.set(...he);else if(ye.copy&&he&&he.constructor&&ye.constructor===he.constructor)ye.copy(he);else if(he!==void 0){var le;const ve=(le=ye)==null?void 0:le.isColor;!ve&&ye.setScalar?ye.setScalar(he):ye instanceof Layers&&he instanceof Layers?ye.mask=he.mask:ye.set(he),!getColorManagement()&&ie&&!ie.linear&&ve&&ye.convertSRGBToLinear()}}else{var ce;if(Ae[pe]=he,(ce=Ae[pe])!=null&&ce.isTexture&&Ae[pe].format===RGBAFormat&&Ae[pe].type===UnsignedByteType&&ie){const ve=Ae[pe];hasColorSpace$1(ve)&&hasColorSpace$1(ie.gl)?ve.colorSpace=ie.gl.outputColorSpace:ve.encoding=ie.gl.outputEncoding}}invalidateInstance(K)}if(te&&te.parent&&K.raycast&&ae!==te.eventCount){const de=findInitialRoot(K).getState().internal,pe=de.interaction.indexOf(K);pe>-1&&de.interaction.splice(pe,1),te.eventCount&&de.interaction.push(K)}return!(se.length===1&&se[0][0]==="onUpdate")&&se.length&&(Z=K.__r3f)!=null&&Z.parent&&updateInstance(K),K}function invalidateInstance(K){var _,Z;const te=(_=K.__r3f)==null||(Z=_.root)==null||Z.getState==null?void 0:Z.getState();te&&te.internal.frames===0&&te.invalidate()}function updateInstance(K){K.onUpdate==null||K.onUpdate(K)}function updateCamera(K,_){K.manual||(isOrthographicCamera$1(K)?(K.left=_.width/-2,K.right=_.width/2,K.top=_.height/2,K.bottom=_.height/-2):K.aspect=_.width/_.height,K.updateProjectionMatrix(),K.updateMatrixWorld())}function makeId(K){return(K.eventObject||K.object).uuid+"/"+K.index+K.instanceId}function getEventPriority(){var K;const _=typeof self<"u"&&self||typeof window<"u"&&window;if(!_)return constantsExports.DefaultEventPriority;switch((K=_.event)==null?void 0:K.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(K,_,Z,te){const ne=Z.get(_);ne&&(Z.delete(_),Z.size===0&&(K.delete(te),ne.target.releasePointerCapture(te)))}function removeInteractivity(K,_){const{internal:Z}=K.getState();Z.interaction=Z.interaction.filter(te=>te!==_),Z.initialHits=Z.initialHits.filter(te=>te!==_),Z.hovered.forEach((te,ne)=>{(te.eventObject===_||te.object===_)&&Z.hovered.delete(ne)}),Z.capturedMap.forEach((te,ne)=>{releaseInternalPointerCapture(Z.capturedMap,_,te,ne)})}function createEvents(K){function _(ae){const{internal:le}=K.getState(),ce=ae.offsetX-le.initialClick[0],fe=ae.offsetY-le.initialClick[1];return Math.round(Math.sqrt(ce*ce+fe*fe))}function Z(ae){return ae.filter(le=>["Move","Over","Enter","Out","Leave"].some(ce=>{var fe;return(fe=le.__r3f)==null?void 0:fe.handlers["onPointer"+ce]}))}function te(ae,le){const ce=K.getState(),fe=new Set,de=[],pe=le?le(ce.internal.interaction):ce.internal.interaction;for(let Ae=0;Ae<pe.length;Ae++){const ye=getRootState(pe[Ae]);ye&&(ye.raycaster.camera=void 0)}ce.previousRoot||ce.events.compute==null||ce.events.compute(ae,ce);function he(Ae){const ye=getRootState(Ae);if(!ye||!ye.events.enabled||ye.raycaster.camera===null)return[];if(ye.raycaster.camera===void 0){var ve;ye.events.compute==null||ye.events.compute(ae,ye,(ve=ye.previousRoot)==null?void 0:ve.getState()),ye.raycaster.camera===void 0&&(ye.raycaster.camera=null)}return ye.raycaster.camera?ye.raycaster.intersectObject(Ae,!0):[]}let ge=pe.flatMap(he).sort((Ae,ye)=>{const ve=getRootState(Ae.object),_e=getRootState(ye.object);return!ve||!_e?Ae.distance-ye.distance:_e.events.priority-ve.events.priority||Ae.distance-ye.distance}).filter(Ae=>{const ye=makeId(Ae);return fe.has(ye)?!1:(fe.add(ye),!0)});ce.events.filter&&(ge=ce.events.filter(ge,ce));for(const Ae of ge){let ye=Ae.object;for(;ye;){var me;(me=ye.__r3f)!=null&&me.eventCount&&de.push({...Ae,eventObject:ye}),ye=ye.parent}}if("pointerId"in ae&&ce.internal.capturedMap.has(ae.pointerId))for(let Ae of ce.internal.capturedMap.get(ae.pointerId).values())fe.has(makeId(Ae.intersection))||de.push(Ae.intersection);return de}function ne(ae,le,ce,fe){const de=K.getState();if(ae.length){const pe={stopped:!1};for(const he of ae){const ge=getRootState(he.object)||de,{raycaster:me,pointer:Ae,camera:ye,internal:ve}=ge,_e=new Vector3(Ae.x,Ae.y,0).unproject(ye),Te=Ie=>{var $e,Ue;return($e=(Ue=ve.capturedMap.get(Ie))==null?void 0:Ue.has(he.eventObject))!=null?$e:!1},be=Ie=>{const $e={intersection:he,target:le.target};ve.capturedMap.has(Ie)?ve.capturedMap.get(Ie).set(he.eventObject,$e):ve.capturedMap.set(Ie,new Map([[he.eventObject,$e]])),le.target.setPointerCapture(Ie)},Re=Ie=>{const $e=ve.capturedMap.get(Ie);$e&&releaseInternalPointerCapture(ve.capturedMap,he.eventObject,$e,Ie)};let we={};for(let Ie in le){let $e=le[Ie];typeof $e!="function"&&(we[Ie]=$e)}let Pe={...he,...we,pointer:Ae,intersections:ae,stopped:pe.stopped,delta:ce,unprojectedPoint:_e,ray:me.ray,camera:ye,stopPropagation(){const Ie="pointerId"in le&&ve.capturedMap.get(le.pointerId);if((!Ie||Ie.has(he.eventObject))&&(Pe.stopped=pe.stopped=!0,ve.hovered.size&&Array.from(ve.hovered.values()).find($e=>$e.eventObject===he.eventObject))){const $e=ae.slice(0,ae.indexOf(he));ie([...$e,he])}},target:{hasPointerCapture:Te,setPointerCapture:be,releasePointerCapture:Re},currentTarget:{hasPointerCapture:Te,setPointerCapture:be,releasePointerCapture:Re},nativeEvent:le};if(fe(Pe),pe.stopped===!0)break}}return ae}function ie(ae){const{internal:le}=K.getState();for(const ce of le.hovered.values())if(!ae.length||!ae.find(fe=>fe.object===ce.object&&fe.index===ce.index&&fe.instanceId===ce.instanceId)){const de=ce.eventObject.__r3f,pe=de==null?void 0:de.handlers;if(le.hovered.delete(makeId(ce)),de!=null&&de.eventCount){const he={...ce,intersections:ae};pe.onPointerOut==null||pe.onPointerOut(he),pe.onPointerLeave==null||pe.onPointerLeave(he)}}}function oe(ae,le){for(let ce=0;ce<le.length;ce++){const fe=le[ce].__r3f;fe==null||fe.handlers.onPointerMissed==null||fe.handlers.onPointerMissed(ae)}}function se(ae){switch(ae){case"onPointerLeave":case"onPointerCancel":return()=>ie([]);case"onLostPointerCapture":return le=>{const{internal:ce}=K.getState();"pointerId"in le&&ce.capturedMap.has(le.pointerId)&&requestAnimationFrame(()=>{ce.capturedMap.has(le.pointerId)&&(ce.capturedMap.delete(le.pointerId),ie([]))})}}return function(ce){const{onPointerMissed:fe,internal:de}=K.getState();de.lastEvent.current=ce;const pe=ae==="onPointerMove",he=ae==="onClick"||ae==="onContextMenu"||ae==="onDoubleClick",me=te(ce,pe?Z:void 0),Ae=he?_(ce):0;ae==="onPointerDown"&&(de.initialClick=[ce.offsetX,ce.offsetY],de.initialHits=me.map(ve=>ve.eventObject)),he&&!me.length&&Ae<=2&&(oe(ce,de.interaction),fe&&fe(ce)),pe&&ie(me);function ye(ve){const _e=ve.eventObject,Te=_e.__r3f,be=Te==null?void 0:Te.handlers;if(Te!=null&&Te.eventCount)if(pe){if(be.onPointerOver||be.onPointerEnter||be.onPointerOut||be.onPointerLeave){const Re=makeId(ve),we=de.hovered.get(Re);we?we.stopped&&ve.stopPropagation():(de.hovered.set(Re,ve),be.onPointerOver==null||be.onPointerOver(ve),be.onPointerEnter==null||be.onPointerEnter(ve))}be.onPointerMove==null||be.onPointerMove(ve)}else{const Re=be[ae];Re?(!he||de.initialHits.includes(_e))&&(oe(ce,de.interaction.filter(we=>!de.initialHits.includes(we))),Re(ve)):he&&de.initialHits.includes(_e)&&oe(ce,de.interaction.filter(we=>!de.initialHits.includes(we)))}}ne(me,ce,Ae,ye)}}return{handlePointer:se}}const privateKeys$1=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],isRenderer=K=>!!(K!=null&&K.render),context$8=reactExports.createContext(null),createStore$6=(K,_)=>{const Z=create$e((se,ae)=>{const le=new Vector3,ce=new Vector3,fe=new Vector3;function de(Ae=ae().camera,ye=ce,ve=ae().size){const{width:_e,height:Te,top:be,left:Re}=ve,we=_e/Te;ye.isVector3?fe.copy(ye):fe.set(...ye);const Pe=Ae.getWorldPosition(le).distanceTo(fe);if(isOrthographicCamera$1(Ae))return{width:_e/Ae.zoom,height:Te/Ae.zoom,top:be,left:Re,factor:1,distance:Pe,aspect:we};{const Ie=Ae.fov*Math.PI/180,$e=2*Math.tan(Ie/2)*Pe,Ue=$e*(_e/Te);return{width:Ue,height:$e,top:be,left:Re,factor:_e/Ue,distance:Pe,aspect:we}}}let pe;const he=Ae=>se(ye=>({performance:{...ye.performance,current:Ae}})),ge=new Vector2;return{set:se,get:ae,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(Ae=1)=>K(ae(),Ae),advance:(Ae,ye)=>_(Ae,ye,ae()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:ge,mouse:ge,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const Ae=ae();pe&&clearTimeout(pe),Ae.performance.current!==Ae.performance.min&&he(Ae.performance.min),pe=setTimeout(()=>he(ae().performance.max),Ae.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:de},setEvents:Ae=>se(ye=>({...ye,events:{...ye.events,...Ae}})),setSize:(Ae,ye,ve,_e,Te)=>{const be=ae().camera,Re={width:Ae,height:ye,top:_e||0,left:Te||0,updateStyle:ve};se(we=>({size:Re,viewport:{...we.viewport,...de(be,ce,Re)}}))},setDpr:Ae=>se(ye=>{const ve=calculateDpr(Ae);return{viewport:{...ye.viewport,dpr:ve,initialDpr:ye.viewport.initialDpr||ve}}}),setFrameloop:(Ae="always")=>{const ye=ae().clock;ye.stop(),ye.elapsedTime=0,Ae!=="never"&&(ye.start(),ye.elapsedTime=0),se(()=>({frameloop:Ae}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(Ae,ye,ve)=>{const _e=ae().internal;return _e.priority=_e.priority+(ye>0?1:0),_e.subscribers.push({ref:Ae,priority:ye,store:ve}),_e.subscribers=_e.subscribers.sort((Te,be)=>Te.priority-be.priority),()=>{const Te=ae().internal;Te!=null&&Te.subscribers&&(Te.priority=Te.priority-(ye>0?1:0),Te.subscribers=Te.subscribers.filter(be=>be.ref!==Ae))}}}}}),te=Z.getState();let ne=te.size,ie=te.viewport.dpr,oe=te.camera;return Z.subscribe(()=>{const{camera:se,size:ae,viewport:le,gl:ce,set:fe}=Z.getState();if(ae.width!==ne.width||ae.height!==ne.height||le.dpr!==ie){var de;ne=ae,ie=le.dpr,updateCamera(se,ae),ce.setPixelRatio(le.dpr);const pe=(de=ae.updateStyle)!=null?de:typeof HTMLCanvasElement<"u"&&ce.domElement instanceof HTMLCanvasElement;ce.setSize(ae.width,ae.height,pe)}se!==oe&&(oe=se,fe(pe=>({viewport:{...pe.viewport,...pe.viewport.getCurrentViewport(se)}})))}),Z.subscribe(se=>K(se)),Z};function createSubs(K,_){const Z={callback:K};return _.add(Z),()=>void _.delete(Z)}let i$c,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;const addEffect=K=>createSubs(K,globalEffects),addAfterEffect=K=>createSubs(K,globalAfterEffects),addTail=K=>createSubs(K,globalTailEffects);function run(K,_){if(K.size)for(const{callback:Z}of K.values())Z(_)}function flushGlobalEffects(K,_){switch(K){case"before":return run(globalEffects,_);case"after":return run(globalAfterEffects,_);case"tail":return run(globalTailEffects,_)}}let subscribers,subscription;function render$1(K,_,Z){let te=_.clock.getDelta();for(_.frameloop==="never"&&typeof K=="number"&&(te=K-_.clock.elapsedTime,_.clock.oldTime=_.clock.elapsedTime,_.clock.elapsedTime=K),subscribers=_.internal.subscribers,i$c=0;i$c<subscribers.length;i$c++)subscription=subscribers[i$c],subscription.ref.current(subscription.store.getState(),te,Z);return!_.internal.priority&&_.gl.render&&_.gl.render(_.scene,_.camera),_.internal.frames=Math.max(0,_.internal.frames-1),_.frameloop==="always"?1:_.internal.frames}function createLoop(K){let _=!1,Z=!1,te,ne,ie;function oe(le){ne=requestAnimationFrame(oe),_=!0,te=0,flushGlobalEffects("before",le),Z=!0;for(const fe of K.values()){var ce;ie=fe.store.getState(),ie.internal.active&&(ie.frameloop==="always"||ie.internal.frames>0)&&!((ce=ie.gl.xr)!=null&&ce.isPresenting)&&(te+=render$1(le,ie))}if(Z=!1,flushGlobalEffects("after",le),te===0)return flushGlobalEffects("tail",le),_=!1,cancelAnimationFrame(ne)}function se(le,ce=1){var fe;if(!le)return K.forEach(de=>se(de.store.getState(),ce));(fe=le.gl.xr)!=null&&fe.isPresenting||!le.internal.active||le.frameloop==="never"||(ce>1?le.internal.frames=Math.min(60,le.internal.frames+ce):Z?le.internal.frames=2:le.internal.frames=1,_||(_=!0,requestAnimationFrame(oe)))}function ae(le,ce=!0,fe,de){if(ce&&flushGlobalEffects("before",le),fe)render$1(le,fe,de);else for(const pe of K.values())render$1(le,pe.store.getState());ce&&flushGlobalEffects("after",le)}return{loop:oe,invalidate:se,advance:ae}}function useInstanceHandle(K){const _=reactExports.useRef(null);return useIsomorphicLayoutEffect$2(()=>void(_.current=K.current.__r3f),[K]),_}function useStore$3(){const K=reactExports.useContext(context$8);if(!K)throw new Error("R3F: Hooks can only be used within the Canvas component!");return K}function useThree(K=Z=>Z,_){return useStore$3()(K,_)}function useFrame(K,_=0){const Z=useStore$3(),te=Z.getState().internal.subscribe,ne=useMutableCallback(K);return useIsomorphicLayoutEffect$2(()=>te(ne,_,Z),[_,te,Z]),null}function useGraph(K){return reactExports.useMemo(()=>buildGraph(K),[K])}const memoizedLoaders=new WeakMap;function loadingFn(K,_){return function(Z,...te){let ne=memoizedLoaders.get(Z);return ne||(ne=new Z,memoizedLoaders.set(Z,ne)),K&&K(ne),Promise.all(te.map(ie=>new Promise((oe,se)=>ne.load(ie,ae=>{ae.scene&&Object.assign(ae,buildGraph(ae.scene)),oe(ae)},_,ae=>se(new Error(`Could not load ${ie}: ${ae==null?void 0:ae.message}`))))))}}function useLoader(K,_,Z,te){const ne=Array.isArray(_)?_:[_],ie=suspend$1(loadingFn(Z,te),[K,...ne],{equal:is.equ});return Array.isArray(_)?ie:ie[0]}useLoader.preload=function(K,_,Z){const te=Array.isArray(_)?_:[_];return preload(loadingFn(Z),[K,...te])};useLoader.clear=function(K,_){const Z=Array.isArray(_)?_:[_];return clear$1([K,...Z])};const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(K,_)=>{const Z=typeof K=="function"?K(_):K;return isRenderer(Z)?Z:new WebGLRenderer({powerPreference:"high-performance",canvas:_,antialias:!0,alpha:!0,...K})};function computeInitialSize(K,_){const Z=typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement;if(_){const{width:te,height:ne,top:ie,left:oe,updateStyle:se=Z}=_;return{width:te,height:ne,top:ie,left:oe,updateStyle:se}}else if(typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement&&K.parentElement){const{width:te,height:ne,top:ie,left:oe}=K.parentElement.getBoundingClientRect();return{width:te,height:ne,top:ie,left:oe,updateStyle:Z}}else if(typeof OffscreenCanvas<"u"&&K instanceof OffscreenCanvas)return{width:K.width,height:K.height,top:0,left:0,updateStyle:Z};return{width:0,height:0,top:0,left:0}}function createRoot(K){const _=roots.get(K),Z=_==null?void 0:_.fiber,te=_==null?void 0:_.store;_&&console.warn("R3F.createRoot should only be called once!");const ne=typeof reportError=="function"?reportError:console.error,ie=te||createStore$6(invalidate,advance),oe=Z||reconciler.createContainer(ie,constantsExports.ConcurrentRoot,null,!1,null,"",ne,null);_||roots.set(K,{fiber:oe,store:ie});let se,ae=!1,le;return{configure(ce={}){let{gl:fe,size:de,scene:pe,events:he,onCreated:ge,shadows:me=!1,linear:Ae=!1,flat:ye=!1,legacy:ve=!1,orthographic:_e=!1,frameloop:Te="always",dpr:be=[1,2],performance:Re,raycaster:we,camera:Pe,onPointerMissed:Ie}=ce,$e=ie.getState(),Ue=$e.gl;$e.gl||$e.set({gl:Ue=createRendererInstance(fe,K)});let ke=$e.raycaster;ke||$e.set({raycaster:ke=new Raycaster});const{params:Ge,...He}=we||{};if(is.equ(He,ke,shallowLoose)||applyProps(ke,{...He}),is.equ(Ge,ke.params,shallowLoose)||applyProps(ke,{params:{...ke.params,...Ge}}),!$e.camera||$e.camera===le&&!is.equ(le,Pe,shallowLoose)){le=Pe;const ot=Pe instanceof Camera$1,Fe=ot?Pe:_e?new OrthographicCamera$1(0,0,0,0,.1,1e3):new PerspectiveCamera$2(75,0,.1,1e3);ot||(Fe.position.z=5,Pe&&(applyProps(Fe,Pe),("aspect"in Pe||"left"in Pe||"right"in Pe||"bottom"in Pe||"top"in Pe)&&(Fe.manual=!0,Fe.updateProjectionMatrix())),!$e.camera&&!(Pe!=null&&Pe.rotation)&&Fe.lookAt(0,0,0)),$e.set({camera:Fe}),ke.camera=Fe}if(!$e.scene){let ot;pe!=null&&pe.isScene?ot=pe:(ot=new Scene$1,pe&&applyProps(ot,pe)),$e.set({scene:prepare(ot)})}if(!$e.xr){var ze;const ot=(ht,lt)=>{const Qe=ie.getState();Qe.frameloop!=="never"&&advance(ht,!0,Qe,lt)},Fe=()=>{const ht=ie.getState();ht.gl.xr.enabled=ht.gl.xr.isPresenting,ht.gl.xr.setAnimationLoop(ht.gl.xr.isPresenting?ot:null),ht.gl.xr.isPresenting||invalidate(ht)},ct={connect(){const ht=ie.getState().gl;ht.xr.addEventListener("sessionstart",Fe),ht.xr.addEventListener("sessionend",Fe)},disconnect(){const ht=ie.getState().gl;ht.xr.removeEventListener("sessionstart",Fe),ht.xr.removeEventListener("sessionend",Fe)}};typeof((ze=Ue.xr)==null?void 0:ze.addEventListener)=="function"&&ct.connect(),$e.set({xr:ct})}if(Ue.shadowMap){const ot=Ue.shadowMap.enabled,Fe=Ue.shadowMap.type;if(Ue.shadowMap.enabled=!!me,is.boo(me))Ue.shadowMap.type=PCFSoftShadowMap;else if(is.str(me)){var Ke;const ct={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};Ue.shadowMap.type=(Ke=ct[me])!=null?Ke:PCFSoftShadowMap}else is.obj(me)&&Object.assign(Ue.shadowMap,me);(ot!==Ue.shadowMap.enabled||Fe!==Ue.shadowMap.type)&&(Ue.shadowMap.needsUpdate=!0)}const tt=getColorManagement();tt&&("enabled"in tt?tt.enabled=!ve:"legacyMode"in tt&&(tt.legacyMode=ve)),ae||applyProps(Ue,{outputEncoding:Ae?3e3:3001,toneMapping:ye?NoToneMapping:ACESFilmicToneMapping}),$e.legacy!==ve&&$e.set(()=>({legacy:ve})),$e.linear!==Ae&&$e.set(()=>({linear:Ae})),$e.flat!==ye&&$e.set(()=>({flat:ye})),fe&&!is.fun(fe)&&!isRenderer(fe)&&!is.equ(fe,Ue,shallowLoose)&&applyProps(Ue,fe),he&&!$e.events.handlers&&$e.set({events:he(ie)});const Je=computeInitialSize(K,de);return is.equ(Je,$e.size,shallowLoose)||$e.setSize(Je.width,Je.height,Je.updateStyle,Je.top,Je.left),be&&$e.viewport.dpr!==calculateDpr(be)&&$e.setDpr(be),$e.frameloop!==Te&&$e.setFrameloop(Te),$e.onPointerMissed||$e.set({onPointerMissed:Ie}),Re&&!is.equ(Re,$e.performance,shallowLoose)&&$e.set(ot=>({performance:{...ot.performance,...Re}})),se=ge,ae=!0,this},render(ce){return ae||this.configure(),reconciler.updateContainer(jsxRuntimeExports.jsx(Provider,{store:ie,children:ce,onCreated:se,rootElement:K}),oe,null,()=>{}),ie},unmount(){unmountComponentAtNode(K)}}}function render(K,_,Z){console.warn("R3F.render is no longer supported in React 18. Use createRoot instead!");const te=createRoot(_);return te.configure(Z),te.render(K)}function Provider({store:K,children:_,onCreated:Z,rootElement:te}){return useIsomorphicLayoutEffect$2(()=>{const ne=K.getState();ne.set(ie=>({internal:{...ie.internal,active:!0}})),Z&&Z(ne),K.getState().events.connected||ne.events.connect==null||ne.events.connect(te)},[]),jsxRuntimeExports.jsx(context$8.Provider,{value:K,children:_})}function unmountComponentAtNode(K,_){const Z=roots.get(K),te=Z==null?void 0:Z.fiber;if(te){const ne=Z==null?void 0:Z.store.getState();ne&&(ne.internal.active=!1),reconciler.updateContainer(null,te,null,()=>{ne&&setTimeout(()=>{try{var ie,oe,se,ae;ne.events.disconnect==null||ne.events.disconnect(),(ie=ne.gl)==null||(oe=ie.renderLists)==null||oe.dispose==null||oe.dispose(),(se=ne.gl)==null||se.forceContextLoss==null||se.forceContextLoss(),(ae=ne.gl)!=null&&ae.xr&&ne.xr.disconnect(),dispose(ne),roots.delete(K),_&&_(K)}catch{}},500)})}}function createPortal(K,_,Z){return jsxRuntimeExports.jsx(Portal$1,{children:K,container:_,state:Z},_.uuid)}function Portal$1({state:K={},children:_,container:Z}){const{events:te,size:ne,...ie}=K,oe=useStore$3(),[se]=reactExports.useState(()=>new Raycaster),[ae]=reactExports.useState(()=>new Vector2),le=reactExports.useCallback((fe,de)=>{const pe={...fe};Object.keys(fe).forEach(ge=>{(privateKeys$1.includes(ge)||fe[ge]!==de[ge]&&de[ge])&&delete pe[ge]});let he;if(de&&ne){const ge=de.camera;he=fe.viewport.getCurrentViewport(ge,new Vector3,ne),ge!==fe.camera&&updateCamera(ge,ne)}return{...pe,scene:Z,raycaster:se,pointer:ae,mouse:ae,previousRoot:oe,events:{...fe.events,...de==null?void 0:de.events,...te},size:{...fe.size,...ne},viewport:{...fe.viewport,...he},...ie}},[K]),[ce]=reactExports.useState(()=>{const fe=oe.getState();return create$e((pe,he)=>({...fe,scene:Z,raycaster:se,pointer:ae,mouse:ae,previousRoot:oe,events:{...fe.events,...te},size:{...fe.size,...ne},...ie,set:pe,get:he,setEvents:ge=>pe(me=>({...me,events:{...me.events,...ge}}))}))});return reactExports.useEffect(()=>{const fe=oe.subscribe(de=>ce.setState(pe=>le(de,pe)));return()=>{fe()}},[le]),reactExports.useEffect(()=>{ce.setState(fe=>le(oe.getState(),fe))},[le]),reactExports.useEffect(()=>()=>{ce.destroy()},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:reconciler.createPortal(jsxRuntimeExports.jsx(context$8.Provider,{value:ce,children:_}),ce,null)})}function flushSync(K){return reconciler.flushSync(K,void 0)}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});const act=reactExports.unstable_act,DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(K){const{handlePointer:_}=createEvents(K);return{priority:1,enabled:!0,compute(Z,te,ne){te.pointer.set(Z.offsetX/te.size.width*2-1,-(Z.offsetY/te.size.height)*2+1),te.raycaster.setFromCamera(te.pointer,te.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((Z,te)=>({...Z,[te]:_(te)}),{}),update:()=>{var Z;const{events:te,internal:ne}=K.getState();(Z=ne.lastEvent)!=null&&Z.current&&te.handlers&&te.handlers.onPointerMove(ne.lastEvent.current)},connect:Z=>{var te;const{set:ne,events:ie}=K.getState();ie.disconnect==null||ie.disconnect(),ne(oe=>({events:{...oe.events,connected:Z}})),Object.entries((te=ie.handlers)!=null?te:[]).forEach(([oe,se])=>{const[ae,le]=DOM_EVENTS[oe];Z.addEventListener(ae,se,{passive:le})})},disconnect:()=>{const{set:Z,events:te}=K.getState();if(te.connected){var ne;Object.entries((ne=te.handlers)!=null?ne:[]).forEach(([ie,oe])=>{if(te&&te.connected instanceof HTMLElement){const[se]=DOM_EVENTS[ie];te.connected.removeEventListener(se,oe)}}),Z(ie=>({events:{...ie.events,connected:void 0}}))}}}}function g$5(K,_){let Z;return(...te)=>{window.clearTimeout(Z),Z=window.setTimeout(()=>K(...te),_)}}function j$2({debounce:K,scroll:_,polyfill:Z,offsetSize:te}={debounce:0,scroll:!1,offsetSize:!1}){const ne=Z||(typeof window>"u"?class{}:window.ResizeObserver);if(!ne)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[ie,oe]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),se=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:ie,orientationHandler:null}),ae=K?typeof K=="number"?K:K.scroll:null,le=K?typeof K=="number"?K:K.resize:null,ce=reactExports.useRef(!1);reactExports.useEffect(()=>(ce.current=!0,()=>void(ce.current=!1)));const[fe,de,pe]=reactExports.useMemo(()=>{const Ae=()=>{if(!se.current.element)return;const{left:ye,top:ve,width:_e,height:Te,bottom:be,right:Re,x:we,y:Pe}=se.current.element.getBoundingClientRect(),Ie={left:ye,top:ve,width:_e,height:Te,bottom:be,right:Re,x:we,y:Pe};se.current.element instanceof HTMLElement&&te&&(Ie.height=se.current.element.offsetHeight,Ie.width=se.current.element.offsetWidth),Object.freeze(Ie),ce.current&&!D$3(se.current.lastBounds,Ie)&&oe(se.current.lastBounds=Ie)};return[Ae,le?g$5(Ae,le):Ae,ae?g$5(Ae,ae):Ae]},[oe,te,ae,le]);function he(){se.current.scrollContainers&&(se.current.scrollContainers.forEach(Ae=>Ae.removeEventListener("scroll",pe,!0)),se.current.scrollContainers=null),se.current.resizeObserver&&(se.current.resizeObserver.disconnect(),se.current.resizeObserver=null),se.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",se.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",se.current.orientationHandler))}function ge(){se.current.element&&(se.current.resizeObserver=new ne(pe),se.current.resizeObserver.observe(se.current.element),_&&se.current.scrollContainers&&se.current.scrollContainers.forEach(Ae=>Ae.addEventListener("scroll",pe,{capture:!0,passive:!0})),se.current.orientationHandler=()=>{pe()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",se.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",se.current.orientationHandler))}const me=Ae=>{!Ae||Ae===se.current.element||(he(),se.current.element=Ae,se.current.scrollContainers=E$2(Ae),ge())};return X(pe,!!_),W$2(de),reactExports.useEffect(()=>{he(),ge()},[_,pe,de]),reactExports.useEffect(()=>he,[]),[me,ie,fe]}function W$2(K){reactExports.useEffect(()=>{const _=K;return window.addEventListener("resize",_),()=>void window.removeEventListener("resize",_)},[K])}function X(K,_){reactExports.useEffect(()=>{if(_){const Z=K;return window.addEventListener("scroll",Z,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",Z,!0)}},[K,_])}function E$2(K){const _=[];if(!K||K===document.body)return _;const{overflow:Z,overflowX:te,overflowY:ne}=window.getComputedStyle(K);return[Z,te,ne].some(ie=>ie==="auto"||ie==="scroll")&&_.push(K),[..._,...E$2(K.parentElement)]}const k$4=["x","y","top","bottom","left","right","width","height"],D$3=(K,_)=>k$4.every(Z=>K[Z]===_[Z]);var __defProp$e=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$e=(K,_,Z)=>_ in K?__defProp$e(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__spreadValues=(K,_)=>{for(var Z in _||(_={}))__hasOwnProp.call(_,Z)&&__defNormalProp$e(K,Z,_[Z]);if(__getOwnPropSymbols)for(var Z of __getOwnPropSymbols(_))__propIsEnum.call(_,Z)&&__defNormalProp$e(K,Z,_[Z]);return K},__spreadProps=(K,_)=>__defProps(K,__getOwnPropDescs(_)),_a$1,_b$1;typeof window<"u"&&((_a$1=window.document)!=null&&_a$1.createElement||((_b$1=window.navigator)==null?void 0:_b$1.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function traverseFiber(K,_,Z){if(!K)return;if(Z(K)===!0)return K;let te=K.child;for(;te;){const ne=traverseFiber(te,_,Z);if(ne)return ne;te=te.sibling}}function wrapContext(K){try{return Object.defineProperties(K,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return K}}const error=console.error;console.error=function(){const K=[...arguments].join("");if(K!=null&&K.startsWith("Warning:")&&K.includes("useContext")){console.error=error;return}return error.apply(this,arguments)};const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}function useFiber(){const K=reactExports.useContext(FiberContext);if(K===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const _=reactExports.useId();return reactExports.useMemo(()=>{for(const te of[K,K==null?void 0:K.alternate]){if(!te)continue;const ne=traverseFiber(te,!1,ie=>{let oe=ie.memoizedState;for(;oe;){if(oe.memoizedState===_)return!0;oe=oe.next}});if(ne)return ne}},[K,_])}function useContextMap(){const K=useFiber(),[_]=reactExports.useState(()=>new Map);_.clear();let Z=K;for(;Z;){if(Z.type&&typeof Z.type=="object"){const ne=Z.type._context===void 0&&Z.type.Provider===Z.type?Z.type:Z.type._context;ne&&ne!==FiberContext&&!_.has(ne)&&_.set(ne,reactExports.useContext(wrapContext(ne)))}Z=Z.return}return _}function useContextBridge(){const K=useContextMap();return reactExports.useMemo(()=>Array.from(K.keys()).reduce((_,Z)=>te=>reactExports.createElement(_,null,reactExports.createElement(Z.Provider,__spreadProps(__spreadValues({},te),{value:K.get(Z)}))),_=>reactExports.createElement(FiberProvider,__spreadValues({},_))),[K])}const CanvasImpl=reactExports.forwardRef(function({children:_,fallback:Z,resize:te,style:ne,gl:ie,events:oe=createPointerEvents,eventSource:se,eventPrefix:ae,shadows:le,linear:ce,flat:fe,legacy:de,orthographic:pe,frameloop:he,dpr:ge,performance:me,raycaster:Ae,camera:ye,scene:ve,onPointerMissed:_e,onCreated:Te,...be},Re){reactExports.useMemo(()=>extend$6(THREE),[]);const we=useContextBridge(),[Pe,Ie]=j$2({scroll:!0,debounce:{scroll:50,resize:0},...te}),$e=reactExports.useRef(null),Ue=reactExports.useRef(null);reactExports.useImperativeHandle(Re,()=>$e.current);const ke=useMutableCallback(_e),[Ge,He]=reactExports.useState(!1),[ze,Ke]=reactExports.useState(!1);if(Ge)throw Ge;if(ze)throw ze;const tt=reactExports.useRef(null);useIsomorphicLayoutEffect$2(()=>{const ot=$e.current;Ie.width>0&&Ie.height>0&&ot&&(tt.current||(tt.current=createRoot(ot)),tt.current.configure({gl:ie,events:oe,shadows:le,linear:ce,flat:fe,legacy:de,orthographic:pe,frameloop:he,dpr:ge,performance:me,raycaster:Ae,camera:ye,scene:ve,size:Ie,onPointerMissed:(...Fe)=>ke.current==null?void 0:ke.current(...Fe),onCreated:Fe=>{Fe.events.connect==null||Fe.events.connect(se?isRef$1(se)?se.current:se:Ue.current),ae&&Fe.setEvents({compute:(ct,ht)=>{const lt=ct[ae+"X"],Qe=ct[ae+"Y"];ht.pointer.set(lt/ht.size.width*2-1,-(Qe/ht.size.height)*2+1),ht.raycaster.setFromCamera(ht.pointer,ht.camera)}}),Te==null||Te(Fe)}}),tt.current.render(jsxRuntimeExports.jsx(we,{children:jsxRuntimeExports.jsx(ErrorBoundary,{set:Ke,children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Block,{set:He}),children:_??null})})})))}),reactExports.useEffect(()=>{const ot=$e.current;if(ot)return()=>unmountComponentAtNode(ot)},[]);const Je=se?"none":"auto";return jsxRuntimeExports.jsx("div",{ref:Ue,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Je,...ne},...be,children:jsxRuntimeExports.jsx("div",{ref:Pe,style:{width:"100%",height:"100%"},children:jsxRuntimeExports.jsx("canvas",{ref:$e,style:{display:"block"},children:Z})})})}),Canvas$1=reactExports.forwardRef(function(_,Z){return jsxRuntimeExports.jsx(FiberProvider,{children:jsxRuntimeExports.jsx(CanvasImpl,{..._,ref:Z})})}),FIBER=Object.freeze(Object.defineProperty({__proto__:null,Canvas:Canvas$1,ReactThreeFiber:threeTypes,_roots:roots,act,addAfterEffect,addEffect,addTail,advance,applyProps,buildGraph,context:context$8,createEvents,createPointerEvents,createPortal,createRoot,dispose,events:createPointerEvents,extend:extend$6,flushGlobalEffects,flushSync,getRootState,invalidate,reconciler,render,unmountComponentAtNode,useFrame,useGraph,useInstanceHandle,useLoader,useStore:useStore$3,useThree},Symbol.toStringTag,{value:"Module"})),v1=new Vector3,v2=new Vector3,v3=new Vector3,v4=new Vector2;function defaultCalculatePosition(K,_,Z){const te=v1.setFromMatrixPosition(K.matrixWorld);te.project(_);const ne=Z.width/2,ie=Z.height/2;return[te.x*ne+ne,-(te.y*ie)+ie]}function isObjectBehindCamera(K,_){const Z=v1.setFromMatrixPosition(K.matrixWorld),te=v2.setFromMatrixPosition(_.matrixWorld),ne=Z.sub(te),ie=_.getWorldDirection(v3);return ne.angleTo(ie)>Math.PI/2}function isObjectVisible(K,_,Z,te){const ne=v1.setFromMatrixPosition(K.matrixWorld),ie=ne.clone();ie.project(_),v4.set(ie.x,ie.y),Z.setFromCamera(v4,_);const oe=Z.intersectObjects(te,!0);if(oe.length){const se=oe[0].distance;return ne.distanceTo(Z.ray.origin)<se}return!0}function objectScale(K,_){if(_ instanceof OrthographicCamera$1)return _.zoom;if(_ instanceof PerspectiveCamera$2){const Z=v1.setFromMatrixPosition(K.matrixWorld),te=v2.setFromMatrixPosition(_.matrixWorld),ne=_.fov*Math.PI/180,ie=Z.distanceTo(te);return 1/(2*Math.tan(ne/2)*ie)}else return 1}function objectZIndex(K,_,Z){if(_ instanceof PerspectiveCamera$2||_ instanceof OrthographicCamera$1){const te=v1.setFromMatrixPosition(K.matrixWorld),ne=v2.setFromMatrixPosition(_.matrixWorld),ie=te.distanceTo(ne),oe=(Z[1]-Z[0])/(_.far-_.near),se=Z[1]-oe*_.far;return Math.round(oe*ie+se)}}const epsilon=K=>Math.abs(K)<1e-10?0:K;function getCSSMatrix(K,_,Z=""){let te="matrix3d(";for(let ne=0;ne!==16;ne++)te+=epsilon(_[ne]*K.elements[ne])+(ne!==15?",":")");return Z+te}const getCameraCSSMatrix=(K=>_=>getCSSMatrix(_,K))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),getObjectCSSMatrix=(K=>(_,Z)=>getCSSMatrix(_,K(Z),"translate(-50%,-50%)"))(K=>[1/K,1/K,1/K,1,-1/K,-1/K,-1/K,-1,1/K,1/K,1/K,1,1,1,1,1]);function isRefObject(K){return K&&typeof K=="object"&&"current"in K}const Html=reactExports.forwardRef(({children:K,eps:_=.001,style:Z,className:te,prepend:ne,center:ie,fullscreen:oe,portal:se,distanceFactor:ae,sprite:le=!1,transform:ce=!1,occlude:fe,onOcclude:de,castShadow:pe,receiveShadow:he,material:ge,geometry:me,zIndexRange:Ae=[16777271,0],calculatePosition:ye=defaultCalculatePosition,as:ve="div",wrapperClass:_e,pointerEvents:Te="auto",...be},Re)=>{const{gl:we,camera:Pe,scene:Ie,size:$e,raycaster:Ue,events:ke,viewport:Ge}=useThree(),[He]=reactExports.useState(()=>document.createElement(ve)),ze=reactExports.useRef(null),Ke=reactExports.useRef(null),tt=reactExports.useRef(0),Je=reactExports.useRef([0,0]),ot=reactExports.useRef(null),Fe=reactExports.useRef(null),ct=(se==null?void 0:se.current)||ke.connected||we.domElement.parentNode,ht=reactExports.useRef(null),lt=reactExports.useRef(!1),Qe=reactExports.useMemo(()=>fe&&fe!=="blending"||Array.isArray(fe)&&fe.length&&isRefObject(fe[0]),[fe]);reactExports.useLayoutEffect(()=>{const St=we.domElement;fe&&fe==="blending"?(St.style.zIndex=`${Math.floor(Ae[0]/2)}`,St.style.position="absolute",St.style.pointerEvents="none"):(St.style.zIndex=null,St.style.position=null,St.style.pointerEvents=null)},[fe]),reactExports.useLayoutEffect(()=>{if(Ke.current){const St=ze.current=createRoot$1(He);if(Ie.updateMatrixWorld(),ce)He.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Et=ye(Ke.current,Pe,$e);He.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Et[0]}px,${Et[1]}px,0);transform-origin:0 0;`}return ct&&(ne?ct.prepend(He):ct.appendChild(He)),()=>{ct&&ct.removeChild(He),St.unmount()}}},[ct,ce]),reactExports.useLayoutEffect(()=>{_e&&(He.className=_e)},[_e]);const Ze=reactExports.useMemo(()=>ce?{position:"absolute",top:0,left:0,width:$e.width,height:$e.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:ie?"translate3d(-50%,-50%,0)":"none",...oe&&{top:-$e.height/2,left:-$e.width/2,width:$e.width,height:$e.height},...Z},[Z,ie,oe,$e,ce]),it=reactExports.useMemo(()=>({position:"absolute",pointerEvents:Te}),[Te]);reactExports.useLayoutEffect(()=>{if(lt.current=!1,ce){var St;(St=ze.current)==null||St.render(reactExports.createElement("div",{ref:ot,style:Ze},reactExports.createElement("div",{ref:Fe,style:it},reactExports.createElement("div",{ref:Re,className:te,style:Z,children:K}))))}else{var Et;(Et=ze.current)==null||Et.render(reactExports.createElement("div",{ref:Re,style:Ze,className:te,children:K}))}});const nt=reactExports.useRef(!0);useFrame(St=>{if(Ke.current){Pe.updateMatrixWorld(),Ke.current.updateWorldMatrix(!0,!1);const Et=ce?Je.current:ye(Ke.current,Pe,$e);if(ce||Math.abs(tt.current-Pe.zoom)>_||Math.abs(Je.current[0]-Et[0])>_||Math.abs(Je.current[1]-Et[1])>_){const Nt=isObjectBehindCamera(Ke.current,Pe);let zt=!1;Qe&&(Array.isArray(fe)?zt=fe.map(Ot=>Ot.current):fe!=="blending"&&(zt=[Ie]));const yt=nt.current;if(zt){const Ot=isObjectVisible(Ke.current,Pe,Ue,zt);nt.current=Ot&&!Nt}else nt.current=!Nt;yt!==nt.current&&(de?de(!nt.current):He.style.display=nt.current?"block":"none");const Ut=Math.floor(Ae[0]/2),bt=fe?Qe?[Ae[0],Ut]:[Ut-1,0]:Ae;if(He.style.zIndex=`${objectZIndex(Ke.current,Pe,bt)}`,ce){const[Ot,Mt]=[$e.width/2,$e.height/2],_t=Pe.projectionMatrix.elements[5]*Mt,{isOrthographicCamera:pt,top:ft,left:st,bottom:vt,right:Pt}=Pe,Lt=getCameraCSSMatrix(Pe.matrixWorldInverse),Vt=pt?`scale(${_t})translate(${epsilon(-(Pt+st)/2)}px,${epsilon((ft+vt)/2)}px)`:`translateZ(${_t}px)`;let Le=Ke.current.matrixWorld;le&&(Le=Pe.matrixWorldInverse.clone().transpose().copyPosition(Le).scale(Ke.current.scale),Le.elements[3]=Le.elements[7]=Le.elements[11]=0,Le.elements[15]=1),He.style.width=$e.width+"px",He.style.height=$e.height+"px",He.style.perspective=pt?"":`${_t}px`,ot.current&&Fe.current&&(ot.current.style.transform=`${Vt}${Lt}translate(${Ot}px,${Mt}px)`,Fe.current.style.transform=getObjectCSSMatrix(Le,1/((ae||10)/400)))}else{const Ot=ae===void 0?1:objectScale(Ke.current,Pe)*ae;He.style.transform=`translate3d(${Et[0]}px,${Et[1]}px,0) scale(${Ot})`}Je.current=Et,tt.current=Pe.zoom}}if(!Qe&&ht.current&&!lt.current)if(ce){if(ot.current){const Et=ot.current.children[0];if(Et!=null&&Et.clientWidth&&Et!=null&&Et.clientHeight){const{isOrthographicCamera:Nt}=Pe;if(Nt||me)be.scale&&(Array.isArray(be.scale)?be.scale instanceof Vector3?ht.current.scale.copy(be.scale.clone().divideScalar(1)):ht.current.scale.set(1/be.scale[0],1/be.scale[1],1/be.scale[2]):ht.current.scale.setScalar(1/be.scale));else{const zt=(ae||10)/400,yt=Et.clientWidth*zt,Ut=Et.clientHeight*zt;ht.current.scale.set(yt,Ut,1)}lt.current=!0}}}else{const Et=He.children[0];if(Et!=null&&Et.clientWidth&&Et!=null&&Et.clientHeight){const Nt=1/Ge.factor,zt=Et.clientWidth*Nt,yt=Et.clientHeight*Nt;ht.current.scale.set(zt,yt,1),lt.current=!0}ht.current.lookAt(St.camera.position)}});const Tt=reactExports.useMemo(()=>({vertexShader:ce?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[ce]);return reactExports.createElement("group",_extends$3({},be,{ref:Ke}),fe&&!Qe&&reactExports.createElement("mesh",{castShadow:pe,receiveShadow:he,ref:ht},me||reactExports.createElement("planeGeometry",null),ge||reactExports.createElement("shaderMaterial",{side:DoubleSide,vertexShader:Tt.vertexShader,fragmentShader:Tt.fragmentShader})))});function CycleRaycast({onChanged:K,portal:_,preventDefault:Z=!0,scroll:te=!0,keyCode:ne=9}){const ie=reactExports.useRef(0),oe=useThree(le=>le.setEvents),se=useThree(le=>le.get),ae=useThree(le=>le.gl);return reactExports.useEffect(()=>{var le;let ce=[],fe;const de=se().events.filter,pe=(le=_==null?void 0:_.current)!==null&&le!==void 0?le:ae.domElement.parentNode,he=()=>pe&&K&&K(ce,Math.round(ie.current)%ce.length);oe({filter:(ve,_e)=>{let Te=[...ve];(Te.length!==ce.length||!ce.every(be=>Te.map(Re=>Re.object.uuid).includes(be.object.uuid)))&&(ie.current=0,ce=Te,he()),de&&(Te=de(Te,_e));for(let be=0;be<Math.round(ie.current)%Te.length;be++){const Re=Te.shift();Te=[...Te,Re]}return Te}});const ge=ve=>{var _e,Te;ie.current=ve(ie.current),(_e=se().events.handlers)==null||_e.onPointerCancel(void 0),(Te=se().events.handlers)==null||Te.onPointerMove(fe),he()},me=ve=>{(ve.keyCode||ve.which)===ne&&(Z&&ve.preventDefault(),ce.length>1&&ge(_e=>_e+1))},Ae=ve=>{Z&&ve.preventDefault();let _e=0;ve||(ve=window.event),ve.wheelDelta?_e=ve.wheelDelta/120:ve.detail&&(_e=-ve.detail/3),ce.length>1&&ge(Te=>Math.abs(Te-_e))},ye=ve=>fe=ve;return document.addEventListener("pointermove",ye,{passive:!0}),te&&document.addEventListener("wheel",Ae),ne!==void 0&&document.addEventListener("keydown",me),()=>{oe({filter:de}),ne!==void 0&&document.removeEventListener("keydown",me),te&&document.removeEventListener("wheel",Ae),document.removeEventListener("pointermove",ye)}},[ae,se,oe,Z,te,ne]),null}const createStoreImpl$4=K=>{let _;const Z=new Set,te=(le,ce)=>{const fe=typeof le=="function"?le(_):le;if(!Object.is(fe,_)){const de=_;_=ce??(typeof fe!="object"||fe===null)?fe:Object.assign({},_,fe),Z.forEach(pe=>pe(_,de))}},ne=()=>_,se={setState:te,getState:ne,getInitialState:()=>ae,subscribe:le=>(Z.add(le),()=>Z.delete(le))},ae=_=K(te,ne,se);return se},createStore$5=K=>K?createStoreImpl$4(K):createStoreImpl$4,identity$7=K=>K;function useStore$2(K,_=identity$7){const Z=React.useSyncExternalStore(K.subscribe,()=>_(K.getState()),()=>_(K.getInitialState()));return React.useDebugValue(Z),Z}const createImpl$2=K=>{const _=createStore$5(K),Z=te=>useStore$2(_,te);return Object.assign(Z,_),Z},create$d=K=>K?createImpl$2(K):createImpl$2,ZUSTAND=Object.freeze(Object.defineProperty({__proto__:null,create:create$d,createStore:createStore$5,useStore:useStore$2},Symbol.toStringTag,{value:"Module"}));function clamp$3(K,_,Z){return Math.max(_,Math.min(K,Z))}const V$2={toVector(K,_){return K===void 0&&(K=_),Array.isArray(K)?K:[K,K]},add(K,_){return[K[0]+_[0],K[1]+_[1]]},sub(K,_){return[K[0]-_[0],K[1]-_[1]]},addTo(K,_){K[0]+=_[0],K[1]+=_[1]},subTo(K,_){K[0]-=_[0],K[1]-=_[1]}};function rubberband(K,_,Z){return _===0||Math.abs(_)===1/0?Math.pow(K,Z*5):K*_*Z/(_+Z*K)}function rubberbandIfOutOfBounds(K,_,Z,te=.15){return te===0?clamp$3(K,_,Z):K<_?-rubberband(_-K,Z-_,te)+_:K>Z?+rubberband(K-Z,Z-_,te)+Z:K}function computeRubberband(K,[_,Z],[te,ne]){const[[ie,oe],[se,ae]]=K;return[rubberbandIfOutOfBounds(_,ie,oe,te),rubberbandIfOutOfBounds(Z,se,ae,ne)]}function _toPrimitive(K,_){if(typeof K!="object"||K===null)return K;var Z=K[Symbol.toPrimitive];if(Z!==void 0){var te=Z.call(K,_);if(typeof te!="object")return te;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(K)}function _toPropertyKey(K){var _=_toPrimitive(K,"string");return typeof _=="symbol"?_:String(_)}function _defineProperty$3(K,_,Z){return _=_toPropertyKey(_),_ in K?Object.defineProperty(K,_,{value:Z,enumerable:!0,configurable:!0,writable:!0}):K[_]=Z,K}function ownKeys$3(K,_){var Z=Object.keys(K);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(K);_&&(te=te.filter(function(ne){return Object.getOwnPropertyDescriptor(K,ne).enumerable})),Z.push.apply(Z,te)}return Z}function _objectSpread2$1(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_]!=null?arguments[_]:{};_%2?ownKeys$3(Object(Z),!0).forEach(function(te){_defineProperty$3(K,te,Z[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(Z)):ownKeys$3(Object(Z)).forEach(function(te){Object.defineProperty(K,te,Object.getOwnPropertyDescriptor(Z,te))})}return K}const EVENT_TYPE_MAP={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize$1(K){return K?K[0].toUpperCase()+K.slice(1):""}const actionsWithoutCaptureSupported=["enter","leave"];function hasCapture(K=!1,_){return K&&!actionsWithoutCaptureSupported.includes(_)}function toHandlerProp(K,_="",Z=!1){const te=EVENT_TYPE_MAP[K],ne=te&&te[_]||_;return"on"+capitalize$1(K)+capitalize$1(ne)+(hasCapture(Z,ne)?"Capture":"")}const pointerCaptureEvents=["gotpointercapture","lostpointercapture"];function parseProp(K){let _=K.substring(2).toLowerCase();const Z=!!~_.indexOf("passive");Z&&(_=_.replace("passive",""));const te=pointerCaptureEvents.includes(_)?"capturecapture":"capture",ne=!!~_.indexOf(te);return ne&&(_=_.replace("capture","")),{device:_,capture:ne,passive:Z}}function toDomEventType(K,_=""){const Z=EVENT_TYPE_MAP[K],te=Z&&Z[_]||_;return K+te}function isTouch(K){return"touches"in K}function getPointerType(K){return isTouch(K)?"touch":"pointerType"in K?K.pointerType:"mouse"}function getCurrentTargetTouchList(K){return Array.from(K.touches).filter(_=>{var Z,te;return _.target===K.currentTarget||((Z=K.currentTarget)===null||Z===void 0||(te=Z.contains)===null||te===void 0?void 0:te.call(Z,_.target))})}function getTouchList(K){return K.type==="touchend"||K.type==="touchcancel"?K.changedTouches:K.targetTouches}function getValueEvent(K){return isTouch(K)?getTouchList(K)[0]:K}function distanceAngle(K,_){try{const Z=_.clientX-K.clientX,te=_.clientY-K.clientY,ne=(_.clientX+K.clientX)/2,ie=(_.clientY+K.clientY)/2,oe=Math.hypot(Z,te);return{angle:-(Math.atan2(Z,te)*180)/Math.PI,distance:oe,origin:[ne,ie]}}catch{}return null}function touchIds(K){return getCurrentTargetTouchList(K).map(_=>_.identifier)}function touchDistanceAngle(K,_){const[Z,te]=Array.from(K.touches).filter(ne=>_.includes(ne.identifier));return distanceAngle(Z,te)}function pointerId(K){const _=getValueEvent(K);return isTouch(K)?_.identifier:_.pointerId}function pointerValues(K){const _=getValueEvent(K);return[_.clientX,_.clientY]}const LINE_HEIGHT=40,PAGE_HEIGHT=800;function wheelValues(K){let{deltaX:_,deltaY:Z,deltaMode:te}=K;return te===1?(_*=LINE_HEIGHT,Z*=LINE_HEIGHT):te===2&&(_*=PAGE_HEIGHT,Z*=PAGE_HEIGHT),[_,Z]}function scrollValues(K){var _,Z;const{scrollX:te,scrollY:ne,scrollLeft:ie,scrollTop:oe}=K.currentTarget;return[(_=te??ie)!==null&&_!==void 0?_:0,(Z=ne??oe)!==null&&Z!==void 0?Z:0]}function getEventDetails(K){const _={};if("buttons"in K&&(_.buttons=K.buttons),"shiftKey"in K){const{shiftKey:Z,altKey:te,metaKey:ne,ctrlKey:ie}=K;Object.assign(_,{shiftKey:Z,altKey:te,metaKey:ne,ctrlKey:ie})}return _}function call(K,..._){return typeof K=="function"?K(..._):K}function noop$1(){}function chain(...K){return K.length===0?noop$1:K.length===1?K[0]:function(){let _;for(const Z of K)_=Z.apply(this,arguments)||_;return _}}function assignDefault(K,_){return Object.assign({},_,K||{})}const BEFORE_LAST_KINEMATICS_DELAY=32;class Engine{constructor(_,Z,te){this.ctrl=_,this.args=Z,this.key=te,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(_){this.ctrl.state[this.key]=_}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:_,shared:Z,ingKey:te,args:ne}=this;Z[te]=_._active=_.active=_._blocked=_._force=!1,_._step=[!1,!1],_.intentional=!1,_._movement=[0,0],_._distance=[0,0],_._direction=[0,0],_._delta=[0,0],_._bounds=[[-1/0,1/0],[-1/0,1/0]],_.args=ne,_.axis=void 0,_.memo=void 0,_.elapsedTime=_.timeDelta=0,_.direction=[0,0],_.distance=[0,0],_.overflow=[0,0],_._movementBound=[!1,!1],_.velocity=[0,0],_.movement=[0,0],_.delta=[0,0],_.timeStamp=0}start(_){const Z=this.state,te=this.config;Z._active||(this.reset(),this.computeInitial(),Z._active=!0,Z.target=_.target,Z.currentTarget=_.currentTarget,Z.lastOffset=te.from?call(te.from,Z):Z.offset,Z.offset=Z.lastOffset,Z.startTime=Z.timeStamp=_.timeStamp)}computeValues(_){const Z=this.state;Z._values=_,Z.values=this.config.transform(_)}computeInitial(){const _=this.state;_._initial=_._values,_.initial=_.values}compute(_){const{state:Z,config:te,shared:ne}=this;Z.args=this.args;let ie=0;if(_&&(Z.event=_,te.preventDefault&&_.cancelable&&Z.event.preventDefault(),Z.type=_.type,ne.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,ne.locked=!!document.pointerLockElement,Object.assign(ne,getEventDetails(_)),ne.down=ne.pressed=ne.buttons%2===1||ne.touches>0,ie=_.timeStamp-Z.timeStamp,Z.timeStamp=_.timeStamp,Z.elapsedTime=Z.timeStamp-Z.startTime),Z._active){const be=Z._delta.map(Math.abs);V$2.addTo(Z._distance,be)}this.axisIntent&&this.axisIntent(_);const[oe,se]=Z._movement,[ae,le]=te.threshold,{_step:ce,values:fe}=Z;if(te.hasCustomTransform?(ce[0]===!1&&(ce[0]=Math.abs(oe)>=ae&&fe[0]),ce[1]===!1&&(ce[1]=Math.abs(se)>=le&&fe[1])):(ce[0]===!1&&(ce[0]=Math.abs(oe)>=ae&&Math.sign(oe)*ae),ce[1]===!1&&(ce[1]=Math.abs(se)>=le&&Math.sign(se)*le)),Z.intentional=ce[0]!==!1||ce[1]!==!1,!Z.intentional)return;const de=[0,0];if(te.hasCustomTransform){const[be,Re]=fe;de[0]=ce[0]!==!1?be-ce[0]:0,de[1]=ce[1]!==!1?Re-ce[1]:0}else de[0]=ce[0]!==!1?oe-ce[0]:0,de[1]=ce[1]!==!1?se-ce[1]:0;this.restrictToAxis&&!Z._blocked&&this.restrictToAxis(de);const pe=Z.offset,he=Z._active&&!Z._blocked||Z.active;he&&(Z.first=Z._active&&!Z.active,Z.last=!Z._active&&Z.active,Z.active=ne[this.ingKey]=Z._active,_&&(Z.first&&("bounds"in te&&(Z._bounds=call(te.bounds,Z)),this.setup&&this.setup()),Z.movement=de,this.computeOffset()));const[ge,me]=Z.offset,[[Ae,ye],[ve,_e]]=Z._bounds;Z.overflow=[ge<Ae?-1:ge>ye?1:0,me<ve?-1:me>_e?1:0],Z._movementBound[0]=Z.overflow[0]?Z._movementBound[0]===!1?Z._movement[0]:Z._movementBound[0]:!1,Z._movementBound[1]=Z.overflow[1]?Z._movementBound[1]===!1?Z._movement[1]:Z._movementBound[1]:!1;const Te=Z._active?te.rubberband||[0,0]:[0,0];if(Z.offset=computeRubberband(Z._bounds,Z.offset,Te),Z.delta=V$2.sub(Z.offset,pe),this.computeMovement(),he&&(!Z.last||ie>BEFORE_LAST_KINEMATICS_DELAY)){Z.delta=V$2.sub(Z.offset,pe);const be=Z.delta.map(Math.abs);V$2.addTo(Z.distance,be),Z.direction=Z.delta.map(Math.sign),Z._direction=Z._delta.map(Math.sign),!Z.first&&ie>0&&(Z.velocity=[be[0]/ie,be[1]/ie],Z.timeDelta=ie)}}emit(){const _=this.state,Z=this.shared,te=this.config;if(_._active||this.clean(),(_._blocked||!_.intentional)&&!_._force&&!te.triggerAllEvents)return;const ne=this.handler(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},Z),_),{},{[this.aliasKey]:_.values}));ne!==void 0&&(_.memo=ne)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function selectAxis([K,_],Z){const te=Math.abs(K),ne=Math.abs(_);if(te>ne&&te>Z)return"x";if(ne>te&&ne>Z)return"y"}class CoordinatesEngine extends Engine{constructor(..._){super(..._),_defineProperty$3(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=V$2.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=V$2.sub(this.state.offset,this.state.lastOffset)}axisIntent(_){const Z=this.state,te=this.config;if(!Z.axis&&_){const ne=typeof te.axisThreshold=="object"?te.axisThreshold[getPointerType(_)]:te.axisThreshold;Z.axis=selectAxis(Z._movement,ne)}Z._blocked=(te.lockDirection||!!te.axis)&&!Z.axis||!!te.axis&&te.axis!==Z.axis}restrictToAxis(_){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":_[1]=0;break;case"y":_[0]=0;break}}}const identity$6=K=>K,DEFAULT_RUBBERBAND=.15,commonConfigResolver={enabled(K=!0){return K},eventOptions(K,_,Z){return _objectSpread2$1(_objectSpread2$1({},Z.shared.eventOptions),K)},preventDefault(K=!1){return K},triggerAllEvents(K=!1){return K},rubberband(K=0){switch(K){case!0:return[DEFAULT_RUBBERBAND,DEFAULT_RUBBERBAND];case!1:return[0,0];default:return V$2.toVector(K)}},from(K){if(typeof K=="function")return K;if(K!=null)return V$2.toVector(K)},transform(K,_,Z){const te=K||Z.shared.transform;return this.hasCustomTransform=!!te,te||identity$6},threshold(K){return V$2.toVector(K,0)}},DEFAULT_AXIS_THRESHOLD=0,coordinatesConfigResolver=_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{axis(K,_,{axis:Z}){if(this.lockDirection=Z==="lock",!this.lockDirection)return Z},axisThreshold(K=DEFAULT_AXIS_THRESHOLD){return K},bounds(K={}){if(typeof K=="function")return ie=>coordinatesConfigResolver.bounds(K(ie));if("current"in K)return()=>K.current;if(typeof HTMLElement=="function"&&K instanceof HTMLElement)return K;const{left:_=-1/0,right:Z=1/0,top:te=-1/0,bottom:ne=1/0}=K;return[[_,Z],[te,ne]]}}),KEYS_DELTA_MAP={ArrowRight:(K,_=1)=>[K*_,0],ArrowLeft:(K,_=1)=>[-1*K*_,0],ArrowUp:(K,_=1)=>[0,-1*K*_],ArrowDown:(K,_=1)=>[0,K*_]};class DragEngine extends CoordinatesEngine{constructor(..._){super(..._),_defineProperty$3(this,"ingKey","dragging")}reset(){super.reset();const _=this.state;_._pointerId=void 0,_._pointerActive=!1,_._keyboardActive=!1,_._preventScroll=!1,_._delayed=!1,_.swipe=[0,0],_.tap=!1,_.canceled=!1,_.cancel=this.cancel.bind(this)}setup(){const _=this.state;if(_._bounds instanceof HTMLElement){const Z=_._bounds.getBoundingClientRect(),te=_.currentTarget.getBoundingClientRect(),ne={left:Z.left-te.left+_.offset[0],right:Z.right-te.right+_.offset[0],top:Z.top-te.top+_.offset[1],bottom:Z.bottom-te.bottom+_.offset[1]};_._bounds=coordinatesConfigResolver.bounds(ne)}}cancel(){const _=this.state;_.canceled||(_.canceled=!0,_._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(_){const Z=this.config,te=this.state;if(_.buttons!=null&&(Array.isArray(Z.pointerButtons)?!Z.pointerButtons.includes(_.buttons):Z.pointerButtons!==-1&&Z.pointerButtons!==_.buttons))return;const ne=this.ctrl.setEventIds(_);Z.pointerCapture&&_.target.setPointerCapture(_.pointerId),!(ne&&ne.size>1&&te._pointerActive)&&(this.start(_),this.setupPointer(_),te._pointerId=pointerId(_),te._pointerActive=!0,this.computeValues(pointerValues(_)),this.computeInitial(),Z.preventScrollAxis&&getPointerType(_)!=="mouse"?(te._active=!1,this.setupScrollPrevention(_)):Z.delay>0?(this.setupDelayTrigger(_),Z.triggerAllEvents&&(this.compute(_),this.emit())):this.startPointerDrag(_))}startPointerDrag(_){const Z=this.state;Z._active=!0,Z._preventScroll=!0,Z._delayed=!1,this.compute(_),this.emit()}pointerMove(_){const Z=this.state,te=this.config;if(!Z._pointerActive)return;const ne=pointerId(_);if(Z._pointerId!==void 0&&ne!==Z._pointerId)return;const ie=pointerValues(_);if(document.pointerLockElement===_.target?Z._delta=[_.movementX,_.movementY]:(Z._delta=V$2.sub(ie,Z._values),this.computeValues(ie)),V$2.addTo(Z._movement,Z._delta),this.compute(_),Z._delayed&&Z.intentional){this.timeoutStore.remove("dragDelay"),Z.active=!1,this.startPointerDrag(_);return}if(te.preventScrollAxis&&!Z._preventScroll)if(Z.axis)if(Z.axis===te.preventScrollAxis||te.preventScrollAxis==="xy"){Z._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(_);return}else return;this.emit()}pointerUp(_){this.ctrl.setEventIds(_);try{this.config.pointerCapture&&_.target.hasPointerCapture(_.pointerId)&&_.target.releasePointerCapture(_.pointerId)}catch{}const Z=this.state,te=this.config;if(!Z._active||!Z._pointerActive)return;const ne=pointerId(_);if(Z._pointerId!==void 0&&ne!==Z._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(_);const[ie,oe]=Z._distance;if(Z.tap=ie<=te.tapsThreshold&&oe<=te.tapsThreshold,Z.tap&&te.filterTaps)Z._force=!0;else{const[se,ae]=Z._delta,[le,ce]=Z._movement,[fe,de]=te.swipe.velocity,[pe,he]=te.swipe.distance,ge=te.swipe.duration;if(Z.elapsedTime<ge){const me=Math.abs(se/Z.timeDelta),Ae=Math.abs(ae/Z.timeDelta);me>fe&&Math.abs(le)>pe&&(Z.swipe[0]=Math.sign(se)),Ae>de&&Math.abs(ce)>he&&(Z.swipe[1]=Math.sign(ae))}}this.emit()}pointerClick(_){!this.state.tap&&_.detail>0&&(_.preventDefault(),_.stopPropagation())}setupPointer(_){const Z=this.config,te=Z.device;Z.pointerLock&&_.currentTarget.requestPointerLock(),Z.pointerCapture||(this.eventStore.add(this.sharedConfig.window,te,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,te,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,te,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(_){this.state._preventScroll&&_.cancelable&&_.preventDefault()}setupScrollPrevention(_){this.state._preventScroll=!1,persistEvent(_);const Z=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",Z),this.eventStore.add(this.sharedConfig.window,"touch","cancel",Z),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,_)}setupDelayTrigger(_){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(_)},this.config.delay)}keyDown(_){const Z=KEYS_DELTA_MAP[_.key];if(Z){const te=this.state,ne=_.shiftKey?10:_.altKey?.1:1;this.start(_),te._delta=Z(this.config.keyboardDisplacement,ne),te._keyboardActive=!0,V$2.addTo(te._movement,te._delta),this.compute(_),this.emit()}}keyUp(_){_.key in KEYS_DELTA_MAP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(_),this.emit())}bind(_){const Z=this.config.device;_(Z,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(_(Z,"change",this.pointerMove.bind(this)),_(Z,"end",this.pointerUp.bind(this)),_(Z,"cancel",this.pointerUp.bind(this)),_("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(_("key","down",this.keyDown.bind(this)),_("key","up",this.keyUp.bind(this))),this.config.filterTaps&&_("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function persistEvent(K){"persist"in K&&typeof K.persist=="function"&&K.persist()}const isBrowser=typeof window<"u"&&window.document&&window.document.createElement;function supportsTouchEvents(){return isBrowser&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||isBrowser&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return isBrowser&&"onpointerdown"in window}function supportsPointerLock(){return isBrowser&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch{return!1}}const SUPPORT={isBrowser,gesture:supportsGestureEvents(),touch:supportsTouchEvents(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},DEFAULT_PREVENT_SCROLL_DELAY=250,DEFAULT_DRAG_DELAY=180,DEFAULT_SWIPE_VELOCITY=.5,DEFAULT_SWIPE_DISTANCE=50,DEFAULT_SWIPE_DURATION=250,DEFAULT_KEYBOARD_DISPLACEMENT=10,DEFAULT_DRAG_AXIS_THRESHOLD={mouse:0,touch:0,pen:8},dragConfigResolver=_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{device(K,_,{pointer:{touch:Z=!1,lock:te=!1,mouse:ne=!1}={}}){return this.pointerLock=te&&SUPPORT.pointerLock,SUPPORT.touch&&Z?"touch":this.pointerLock?"mouse":SUPPORT.pointer&&!ne?"pointer":SUPPORT.touch?"touch":"mouse"},preventScrollAxis(K,_,{preventScroll:Z}){if(this.preventScrollDelay=typeof Z=="number"?Z:Z||Z===void 0&&K?DEFAULT_PREVENT_SCROLL_DELAY:void 0,!(!SUPPORT.touchscreen||Z===!1))return K||(Z!==void 0?"y":void 0)},pointerCapture(K,_,{pointer:{capture:Z=!0,buttons:te=1,keys:ne=!0}={}}){return this.pointerButtons=te,this.keys=ne,!this.pointerLock&&this.device==="pointer"&&Z},threshold(K,_,{filterTaps:Z=!1,tapsThreshold:te=3,axis:ne=void 0}){const ie=V$2.toVector(K,Z?te:ne?1:0);return this.filterTaps=Z,this.tapsThreshold=te,ie},swipe({velocity:K=DEFAULT_SWIPE_VELOCITY,distance:_=DEFAULT_SWIPE_DISTANCE,duration:Z=DEFAULT_SWIPE_DURATION}={}){return{velocity:this.transform(V$2.toVector(K)),distance:this.transform(V$2.toVector(_)),duration:Z}},delay(K=0){switch(K){case!0:return DEFAULT_DRAG_DELAY;case!1:return 0;default:return K}},axisThreshold(K){return K?_objectSpread2$1(_objectSpread2$1({},DEFAULT_DRAG_AXIS_THRESHOLD),K):DEFAULT_DRAG_AXIS_THRESHOLD},keyboardDisplacement(K=DEFAULT_KEYBOARD_DISPLACEMENT){return K}});function clampStateInternalMovementToBounds(K){const[_,Z]=K.overflow,[te,ne]=K._delta,[ie,oe]=K._direction;(_<0&&te>0&&ie<0||_>0&&te<0&&ie>0)&&(K._movement[0]=K._movementBound[0]),(Z<0&&ne>0&&oe<0||Z>0&&ne<0&&oe>0)&&(K._movement[1]=K._movementBound[1])}const SCALE_ANGLE_RATIO_INTENT_DEG=30,PINCH_WHEEL_RATIO=100;class PinchEngine extends Engine{constructor(..._){super(..._),_defineProperty$3(this,"ingKey","pinching"),_defineProperty$3(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const _=this.state;_._touchIds=[],_.canceled=!1,_.cancel=this.cancel.bind(this),_.turns=0}computeOffset(){const{type:_,movement:Z,lastOffset:te}=this.state;_==="wheel"?this.state.offset=V$2.add(Z,te):this.state.offset=[(1+Z[0])*te[0],Z[1]+te[1]]}computeMovement(){const{offset:_,lastOffset:Z}=this.state;this.state.movement=[_[0]/Z[0],_[1]-Z[1]]}axisIntent(){const _=this.state,[Z,te]=_._movement;if(!_.axis){const ne=Math.abs(Z)*SCALE_ANGLE_RATIO_INTENT_DEG-Math.abs(te);ne<0?_.axis="angle":ne>0&&(_.axis="scale")}}restrictToAxis(_){this.config.lockDirection&&(this.state.axis==="scale"?_[1]=0:this.state.axis==="angle"&&(_[0]=0))}cancel(){const _=this.state;_.canceled||setTimeout(()=>{_.canceled=!0,_._active=!1,this.compute(),this.emit()},0)}touchStart(_){this.ctrl.setEventIds(_);const Z=this.state,te=this.ctrl.touchIds;if(Z._active&&Z._touchIds.every(ie=>te.has(ie))||te.size<2)return;this.start(_),Z._touchIds=Array.from(te).slice(0,2);const ne=touchDistanceAngle(_,Z._touchIds);ne&&this.pinchStart(_,ne)}pointerStart(_){if(_.buttons!=null&&_.buttons%2!==1)return;this.ctrl.setEventIds(_),_.target.setPointerCapture(_.pointerId);const Z=this.state,te=Z._pointerEvents,ne=this.ctrl.pointerIds;if(Z._active&&Array.from(te.keys()).every(oe=>ne.has(oe))||(te.size<2&&te.set(_.pointerId,_),Z._pointerEvents.size<2))return;this.start(_);const ie=distanceAngle(...Array.from(te.values()));ie&&this.pinchStart(_,ie)}pinchStart(_,Z){const te=this.state;te.origin=Z.origin,this.computeValues([Z.distance,Z.angle]),this.computeInitial(),this.compute(_),this.emit()}touchMove(_){if(!this.state._active)return;const Z=touchDistanceAngle(_,this.state._touchIds);Z&&this.pinchMove(_,Z)}pointerMove(_){const Z=this.state._pointerEvents;if(Z.has(_.pointerId)&&Z.set(_.pointerId,_),!this.state._active)return;const te=distanceAngle(...Array.from(Z.values()));te&&this.pinchMove(_,te)}pinchMove(_,Z){const te=this.state,ne=te._values[1],ie=Z.angle-ne;let oe=0;Math.abs(ie)>270&&(oe+=Math.sign(ie)),this.computeValues([Z.distance,Z.angle-360*oe]),te.origin=Z.origin,te.turns=oe,te._movement=[te._values[0]/te._initial[0]-1,te._values[1]-te._initial[1]],this.compute(_),this.emit()}touchEnd(_){this.ctrl.setEventIds(_),this.state._active&&this.state._touchIds.some(Z=>!this.ctrl.touchIds.has(Z))&&(this.state._active=!1,this.compute(_),this.emit())}pointerEnd(_){const Z=this.state;this.ctrl.setEventIds(_);try{_.target.releasePointerCapture(_.pointerId)}catch{}Z._pointerEvents.has(_.pointerId)&&Z._pointerEvents.delete(_.pointerId),Z._active&&Z._pointerEvents.size<2&&(Z._active=!1,this.compute(_),this.emit())}gestureStart(_){_.cancelable&&_.preventDefault();const Z=this.state;Z._active||(this.start(_),this.computeValues([_.scale,_.rotation]),Z.origin=[_.clientX,_.clientY],this.compute(_),this.emit())}gestureMove(_){if(_.cancelable&&_.preventDefault(),!this.state._active)return;const Z=this.state;this.computeValues([_.scale,_.rotation]),Z.origin=[_.clientX,_.clientY];const te=Z._movement;Z._movement=[_.scale-1,_.rotation],Z._delta=V$2.sub(Z._movement,te),this.compute(_),this.emit()}gestureEnd(_){this.state._active&&(this.state._active=!1,this.compute(_),this.emit())}wheel(_){const Z=this.config.modifierKey;Z&&(Array.isArray(Z)?!Z.find(te=>_[te]):!_[Z])||(this.state._active?this.wheelChange(_):this.wheelStart(_),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(_){this.start(_),this.wheelChange(_)}wheelChange(_){"uv"in _||_.cancelable&&_.preventDefault();const te=this.state;te._delta=[-wheelValues(_)[1]/PINCH_WHEEL_RATIO*te.offset[0],0],V$2.addTo(te._movement,te._delta),clampStateInternalMovementToBounds(te),this.state.origin=[_.clientX,_.clientY],this.compute(_),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(_){const Z=this.config.device;Z&&(_(Z,"start",this[Z+"Start"].bind(this)),_(Z,"change",this[Z+"Move"].bind(this)),_(Z,"end",this[Z+"End"].bind(this)),_(Z,"cancel",this[Z+"End"].bind(this)),_("lostPointerCapture","",this[Z+"End"].bind(this))),this.config.pinchOnWheel&&_("wheel","",this.wheel.bind(this),{passive:!1})}}const pinchConfigResolver=_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{device(K,_,{shared:Z,pointer:{touch:te=!1}={}}){if(Z.target&&!SUPPORT.touch&&SUPPORT.gesture)return"gesture";if(SUPPORT.touch&&te)return"touch";if(SUPPORT.touchscreen){if(SUPPORT.pointer)return"pointer";if(SUPPORT.touch)return"touch"}},bounds(K,_,{scaleBounds:Z={},angleBounds:te={}}){const ne=oe=>{const se=assignDefault(call(Z,oe),{min:-1/0,max:1/0});return[se.min,se.max]},ie=oe=>{const se=assignDefault(call(te,oe),{min:-1/0,max:1/0});return[se.min,se.max]};return typeof Z!="function"&&typeof te!="function"?[ne(),ie()]:oe=>[ne(oe),ie(oe)]},threshold(K,_,Z){return this.lockDirection=Z.axis==="lock",V$2.toVector(K,this.lockDirection?[.1,3]:0)},modifierKey(K){return K===void 0?"ctrlKey":K},pinchOnWheel(K=!0){return K}});class MoveEngine extends CoordinatesEngine{constructor(..._){super(..._),_defineProperty$3(this,"ingKey","moving")}move(_){this.config.mouseOnly&&_.pointerType!=="mouse"||(this.state._active?this.moveChange(_):this.moveStart(_),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(_){this.start(_),this.computeValues(pointerValues(_)),this.compute(_),this.computeInitial(),this.emit()}moveChange(_){if(!this.state._active)return;const Z=pointerValues(_),te=this.state;te._delta=V$2.sub(Z,te._values),V$2.addTo(te._movement,te._delta),this.computeValues(Z),this.compute(_),this.emit()}moveEnd(_){this.state._active&&(this.state._active=!1,this.compute(_),this.emit())}bind(_){_("pointer","change",this.move.bind(this)),_("pointer","leave",this.moveEnd.bind(this))}}const moveConfigResolver=_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(K=!0)=>K});class ScrollEngine extends CoordinatesEngine{constructor(..._){super(..._),_defineProperty$3(this,"ingKey","scrolling")}scroll(_){this.state._active||this.start(_),this.scrollChange(_),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(_){_.cancelable&&_.preventDefault();const Z=this.state,te=scrollValues(_);Z._delta=V$2.sub(te,Z._values),V$2.addTo(Z._movement,Z._delta),this.computeValues(te),this.compute(_),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(_){_("scroll","",this.scroll.bind(this))}}const scrollConfigResolver=coordinatesConfigResolver;class WheelEngine extends CoordinatesEngine{constructor(..._){super(..._),_defineProperty$3(this,"ingKey","wheeling")}wheel(_){this.state._active||this.start(_),this.wheelChange(_),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(_){const Z=this.state;Z._delta=wheelValues(_),V$2.addTo(Z._movement,Z._delta),clampStateInternalMovementToBounds(Z),this.compute(_),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(_){_("wheel","",this.wheel.bind(this))}}const wheelConfigResolver=coordinatesConfigResolver;class HoverEngine extends CoordinatesEngine{constructor(..._){super(..._),_defineProperty$3(this,"ingKey","hovering")}enter(_){this.config.mouseOnly&&_.pointerType!=="mouse"||(this.start(_),this.computeValues(pointerValues(_)),this.compute(_),this.emit())}leave(_){if(this.config.mouseOnly&&_.pointerType!=="mouse")return;const Z=this.state;if(!Z._active)return;Z._active=!1;const te=pointerValues(_);Z._movement=Z._delta=V$2.sub(te,Z._values),this.computeValues(te),this.compute(_),Z.delta=Z.movement,this.emit()}bind(_){_("pointer","enter",this.enter.bind(this)),_("pointer","leave",this.leave.bind(this))}}const hoverConfigResolver=_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(K=!0)=>K}),EngineMap=new Map,ConfigResolverMap=new Map;function registerAction(K){EngineMap.set(K.key,K.engine),ConfigResolverMap.set(K.key,K.resolver)}const dragAction={key:"drag",engine:DragEngine,resolver:dragConfigResolver},hoverAction={key:"hover",engine:HoverEngine,resolver:hoverConfigResolver},moveAction={key:"move",engine:MoveEngine,resolver:moveConfigResolver},pinchAction={key:"pinch",engine:PinchEngine,resolver:pinchConfigResolver},scrollAction={key:"scroll",engine:ScrollEngine,resolver:scrollConfigResolver},wheelAction={key:"wheel",engine:WheelEngine,resolver:wheelConfigResolver};function _objectWithoutPropertiesLoose$3(K,_){if(K==null)return{};var Z={},te=Object.keys(K),ne,ie;for(ie=0;ie<te.length;ie++)ne=te[ie],!(_.indexOf(ne)>=0)&&(Z[ne]=K[ne]);return Z}function _objectWithoutProperties$2(K,_){if(K==null)return{};var Z=_objectWithoutPropertiesLoose$3(K,_),te,ne;if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(K);for(ne=0;ne<ie.length;ne++)te=ie[ne],!(_.indexOf(te)>=0)&&Object.prototype.propertyIsEnumerable.call(K,te)&&(Z[te]=K[te])}return Z}const sharedConfigResolver={target(K){if(K)return()=>"current"in K?K.current:K},enabled(K=!0){return K},window(K=SUPPORT.isBrowser?window:void 0){return K},eventOptions({passive:K=!0,capture:_=!1}={}){return{passive:K,capture:_}},transform(K){return K}},_excluded$c=["target","eventOptions","window","enabled","transform"];function resolveWith(K={},_){const Z={};for(const[te,ne]of Object.entries(_))switch(typeof ne){case"function":Z[te]=ne.call(Z,K[te],te,K);break;case"object":Z[te]=resolveWith(K[te],ne);break;case"boolean":ne&&(Z[te]=K[te]);break}return Z}function parse$b(K,_,Z={}){const te=K,{target:ne,eventOptions:ie,window:oe,enabled:se,transform:ae}=te,le=_objectWithoutProperties$2(te,_excluded$c);if(Z.shared=resolveWith({target:ne,eventOptions:ie,window:oe,enabled:se,transform:ae},sharedConfigResolver),_){const ce=ConfigResolverMap.get(_);Z[_]=resolveWith(_objectSpread2$1({shared:Z.shared},le),ce)}else for(const ce in le){const fe=ConfigResolverMap.get(ce);fe&&(Z[ce]=resolveWith(_objectSpread2$1({shared:Z.shared},le[ce]),fe))}return Z}class EventStore{constructor(_,Z){_defineProperty$3(this,"_listeners",new Set),this._ctrl=_,this._gestureKey=Z}add(_,Z,te,ne,ie){const oe=this._listeners,se=toDomEventType(Z,te),ae=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},le=_objectSpread2$1(_objectSpread2$1({},ae),ie);_.addEventListener(se,ne,le);const ce=()=>{_.removeEventListener(se,ne,le),oe.delete(ce)};return oe.add(ce),ce}clean(){this._listeners.forEach(_=>_()),this._listeners.clear()}}class TimeoutStore{constructor(){_defineProperty$3(this,"_timeouts",new Map)}add(_,Z,te=140,...ne){this.remove(_),this._timeouts.set(_,window.setTimeout(Z,te,...ne))}remove(_){const Z=this._timeouts.get(_);Z&&window.clearTimeout(Z)}clean(){this._timeouts.forEach(_=>void window.clearTimeout(_)),this._timeouts.clear()}}class Controller{constructor(_){_defineProperty$3(this,"gestures",new Set),_defineProperty$3(this,"_targetEventStore",new EventStore(this)),_defineProperty$3(this,"gestureEventStores",{}),_defineProperty$3(this,"gestureTimeoutStores",{}),_defineProperty$3(this,"handlers",{}),_defineProperty$3(this,"config",{}),_defineProperty$3(this,"pointerIds",new Set),_defineProperty$3(this,"touchIds",new Set),_defineProperty$3(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,_)}setEventIds(_){if(isTouch(_))return this.touchIds=new Set(touchIds(_)),this.touchIds;if("pointerId"in _)return _.type==="pointerup"||_.type==="pointercancel"?this.pointerIds.delete(_.pointerId):_.type==="pointerdown"&&this.pointerIds.add(_.pointerId),this.pointerIds}applyHandlers(_,Z){this.handlers=_,this.nativeHandlers=Z}applyConfig(_,Z){this.config=parse$b(_,Z,this.config)}clean(){this._targetEventStore.clean();for(const _ of this.gestures)this.gestureEventStores[_].clean(),this.gestureTimeoutStores[_].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(..._){const Z=this.config.shared,te={};let ne;if(!(Z.target&&(ne=Z.target(),!ne))){if(Z.enabled){for(const oe of this.gestures){const se=this.config[oe],ae=bindToProps(te,se.eventOptions,!!ne);if(se.enabled){const le=EngineMap.get(oe);new le(this,_,oe).bind(ae)}}const ie=bindToProps(te,Z.eventOptions,!!ne);for(const oe in this.nativeHandlers)ie(oe,"",se=>this.nativeHandlers[oe](_objectSpread2$1(_objectSpread2$1({},this.state.shared),{},{event:se,args:_})),void 0,!0)}for(const ie in te)te[ie]=chain(...te[ie]);if(!ne)return te;for(const ie in te){const{device:oe,capture:se,passive:ae}=parseProp(ie);this._targetEventStore.add(ne,oe,"",te[ie],{capture:se,passive:ae})}}}}function setupGesture(K,_){K.gestures.add(_),K.gestureEventStores[_]=new EventStore(K,_),K.gestureTimeoutStores[_]=new TimeoutStore}function resolveGestures(K,_){_.drag&&setupGesture(K,"drag"),_.wheel&&setupGesture(K,"wheel"),_.scroll&&setupGesture(K,"scroll"),_.move&&setupGesture(K,"move"),_.pinch&&setupGesture(K,"pinch"),_.hover&&setupGesture(K,"hover")}const bindToProps=(K,_,Z)=>(te,ne,ie,oe={},se=!1)=>{var ae,le;const ce=(ae=oe.capture)!==null&&ae!==void 0?ae:_.capture,fe=(le=oe.passive)!==null&&le!==void 0?le:_.passive;let de=se?te:toHandlerProp(te,ne,ce);Z&&fe&&(de+="Passive"),K[de]=K[de]||[],K[de].push(ie)},RE_NOT_NATIVE=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function sortHandlers(K){const _={},Z={},te=new Set;for(let ne in K)RE_NOT_NATIVE.test(ne)?(te.add(RegExp.lastMatch),Z[ne]=K[ne]):_[ne]=K[ne];return[Z,_,te]}function registerGesture(K,_,Z,te,ne,ie){if(!K.has(Z)||!EngineMap.has(te))return;const oe=Z+"Start",se=Z+"End",ae=le=>{let ce;return le.first&&oe in _&&_[oe](le),Z in _&&(ce=_[Z](le)),le.last&&se in _&&_[se](le),ce};ne[te]=ae,ie[te]=ie[te]||{}}function parseMergedHandlers(K,_){const[Z,te,ne]=sortHandlers(K),ie={};return registerGesture(ne,Z,"onDrag","drag",ie,_),registerGesture(ne,Z,"onWheel","wheel",ie,_),registerGesture(ne,Z,"onScroll","scroll",ie,_),registerGesture(ne,Z,"onPinch","pinch",ie,_),registerGesture(ne,Z,"onMove","move",ie,_),registerGesture(ne,Z,"onHover","hover",ie,_),{handlers:ie,config:_,nativeHandlers:te}}function useRecognizers(K,_={},Z,te){const ne=React.useMemo(()=>new Controller(K),[]);if(ne.applyHandlers(K,te),ne.applyConfig(_,Z),React.useEffect(ne.effect.bind(ne)),React.useEffect(()=>ne.clean.bind(ne),[]),_.target===void 0)return ne.bind.bind(ne)}function useDrag$1(K,_){return registerAction(dragAction),useRecognizers({drag:K},_||{},"drag")}function createUseGesture(K){return K.forEach(registerAction),function(Z,te){const{handlers:ne,nativeHandlers:ie,config:oe}=parseMergedHandlers(Z,te||{});return useRecognizers(ne,oe,void 0,ie)}}function useGesture(K,_){return createUseGesture([dragAction,pinchAction,scrollAction,wheelAction,moveAction,hoverAction])(K,_||{})}let webGL2Available;function isWebGL2Available$1(){var K;if(webGL2Available!==void 0)return webGL2Available;try{let _;const Z=document.createElement("canvas");return webGL2Available=!!(window.WebGL2RenderingContext&&(_=Z.getContext("webgl2"))),_&&((K=_.getExtension("WEBGL_lose_context"))==null||K.loseContext()),webGL2Available}catch{return webGL2Available=!1}}const version$4=parseInt(REVISION.replace(/\D+/g,"")),UV1=version$4>=125?"uv1":"uv2";var __defProp$d=Object.defineProperty,__defNormalProp$d=(K,_,Z)=>_ in K?__defProp$d(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$d=(K,_,Z)=>(__defNormalProp$d(K,typeof _!="symbol"?_+"":_,Z),Z);const CHANNELS=4,TEXTURE_WIDTH=1024,TEXTURE_HEIGHT=4,initSplineTexture=(K=1)=>{const _=new Float32Array(TEXTURE_WIDTH*TEXTURE_HEIGHT*K*CHANNELS),Z=new DataTexture(_,TEXTURE_WIDTH,TEXTURE_HEIGHT*K,RGBAFormat,FloatType);return Z.wrapS=RepeatWrapping,Z.wrapT=RepeatWrapping,Z.magFilter=NearestFilter,Z.needsUpdate=!0,Z},updateSplineTexture=(K,_,Z=0)=>{const te=Math.floor(TEXTURE_WIDTH*(TEXTURE_HEIGHT/4));_.arcLengthDivisions=te/2,_.updateArcLengths();const ne=_.getSpacedPoints(te),ie=_.computeFrenetFrames(te,!0);for(let oe=0;oe<te;oe++){const se=Math.floor(oe/TEXTURE_WIDTH),ae=oe%TEXTURE_WIDTH;let le=ne[oe];setTextureValue(K,ae,le.x,le.y,le.z,0+se+TEXTURE_HEIGHT*Z),le=ie.tangents[oe],setTextureValue(K,ae,le.x,le.y,le.z,1+se+TEXTURE_HEIGHT*Z),le=ie.normals[oe],setTextureValue(K,ae,le.x,le.y,le.z,2+se+TEXTURE_HEIGHT*Z),le=ie.binormals[oe],setTextureValue(K,ae,le.x,le.y,le.z,3+se+TEXTURE_HEIGHT*Z)}K.needsUpdate=!0},setTextureValue=(K,_,Z,te,ne,ie)=>{const oe=K.image,{data:se}=oe,ae=CHANNELS*TEXTURE_WIDTH*ie;se[_*CHANNELS+ae+0]=Z,se[_*CHANNELS+ae+1]=te,se[_*CHANNELS+ae+2]=ne,se[_*CHANNELS+ae+3]=1},getUniforms=K=>({spineTexture:{value:K},pathOffset:{type:"f",value:0},pathSegment:{type:"f",value:1},spineOffset:{type:"f",value:161},spineLength:{type:"f",value:400},flow:{type:"i",value:1}});function modifyShader(K,_,Z=1){K.__ok||(K.__ok=!0,K.onBeforeCompile=te=>{if(te.__modified)return;te.__modified=!0,Object.assign(te.uniforms,_);const ne=`
		uniform sampler2D spineTexture;
		uniform float pathOffset;
		uniform float pathSegment;
		uniform float spineOffset;
		uniform float spineLength;
		uniform int flow;

		float textureLayers = ${TEXTURE_HEIGHT*Z}.;
		float textureStacks = ${TEXTURE_HEIGHT/4}.;

		${te.vertexShader}
		`.replace("#include <beginnormal_vertex>","").replace("#include <defaultnormal_vertex>","").replace("#include <begin_vertex>","").replace(/void\s*main\s*\(\)\s*\{/,`
        void main() {
        #include <beginnormal_vertex>

        vec4 worldPos = modelMatrix * vec4(position, 1.);

        bool bend = flow > 0;
        float xWeight = bend ? 0. : 1.;

        #ifdef USE_INSTANCING
        float pathOffsetFromInstanceMatrix = instanceMatrix[3][2];
        float spineLengthFromInstanceMatrix = instanceMatrix[3][0];
        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLengthFromInstanceMatrix : 0.;
        float mt = (spinePortion * pathSegment + pathOffset + pathOffsetFromInstanceMatrix)*textureStacks;
        #else
        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLength : 0.;
        float mt = (spinePortion * pathSegment + pathOffset)*textureStacks;
        #endif

        mt = mod(mt, textureStacks);
        float rowOffset = floor(mt);

        #ifdef USE_INSTANCING
        rowOffset += instanceMatrix[3][1] * ${TEXTURE_HEIGHT}.;
        #endif

        vec3 spinePos = texture2D(spineTexture, vec2(mt, (0. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 a =        texture2D(spineTexture, vec2(mt, (1. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 b =        texture2D(spineTexture, vec2(mt, (2. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 c =        texture2D(spineTexture, vec2(mt, (3. + rowOffset + 0.5) / textureLayers)).xyz;
        mat3 basis = mat3(a, b, c);

        vec3 transformed = basis
          * vec3(worldPos.x * xWeight, worldPos.y * 1., worldPos.z * 1.)
          + spinePos;

        vec3 transformedNormal = normalMatrix * (basis * objectNormal);
			`).replace("#include <project_vertex>",`vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );
				gl_Position = projectionMatrix * mvPosition;`);te.vertexShader=ne})}class Flow{constructor(_,Z=1){__publicField$d(this,"curveArray"),__publicField$d(this,"curveLengthArray"),__publicField$d(this,"object3D"),__publicField$d(this,"splineTexure"),__publicField$d(this,"uniforms");const te=_.clone(),ne=initSplineTexture(Z),ie=getUniforms(ne);te.traverse(oe=>{(oe instanceof Mesh||oe instanceof InstancedMesh)&&(oe.material=oe.material.clone(),modifyShader(oe.material,ie,Z))}),this.curveArray=new Array(Z),this.curveLengthArray=new Array(Z),this.object3D=te,this.splineTexure=ne,this.uniforms=ie}updateCurve(_,Z){if(_>=this.curveArray.length)throw Error("Index out of range for Flow");const te=Z.getLength();this.uniforms.spineLength.value=te,this.curveLengthArray[_]=te,this.curveArray[_]=Z,updateSplineTexture(this.splineTexure,Z,_)}moveAlongCurve(_){this.uniforms.pathOffset.value+=_}}function mergeVertices(K,_=1e-4){_=Math.max(_,Number.EPSILON);const Z={},te=K.getIndex(),ne=K.getAttribute("position"),ie=te?te.count:ne.count;let oe=0;const se=Object.keys(K.attributes),ae={},le={},ce=[],fe=["getX","getY","getZ","getW"];for(let ge=0,me=se.length;ge<me;ge++){const Ae=se[ge];ae[Ae]=[];const ye=K.morphAttributes[Ae];ye&&(le[Ae]=new Array(ye.length).fill(0).map(()=>[]))}const de=Math.log10(1/_),pe=Math.pow(10,de);for(let ge=0;ge<ie;ge++){const me=te?te.getX(ge):ge;let Ae="";for(let ye=0,ve=se.length;ye<ve;ye++){const _e=se[ye],Te=K.getAttribute(_e),be=Te.itemSize;for(let Re=0;Re<be;Re++)Ae+=`${~~(Te[fe[Re]](me)*pe)},`}if(Ae in Z)ce.push(Z[Ae]);else{for(let ye=0,ve=se.length;ye<ve;ye++){const _e=se[ye],Te=K.getAttribute(_e),be=K.morphAttributes[_e],Re=Te.itemSize,we=ae[_e],Pe=le[_e];for(let Ie=0;Ie<Re;Ie++){const $e=fe[Ie];if(we.push(Te[$e](me)),be)for(let Ue=0,ke=be.length;Ue<ke;Ue++)Pe[Ue].push(be[Ue][$e](me))}}Z[Ae]=oe,ce.push(oe),oe++}}const he=K.clone();for(let ge=0,me=se.length;ge<me;ge++){const Ae=se[ge],ye=K.getAttribute(Ae),ve=new ye.array.constructor(ae[Ae]),_e=new BufferAttribute(ve,ye.itemSize,ye.normalized);if(he.setAttribute(Ae,_e),Ae in le)for(let Te=0;Te<le[Ae].length;Te++){const be=K.morphAttributes[Ae][Te],Re=new be.array.constructor(le[Ae][Te]),we=new BufferAttribute(Re,be.itemSize,be.normalized);he.morphAttributes[Ae][Te]=we}}return he.setIndex(ce),he}function toTrianglesDrawMode$1(K,_){if(_===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),K;if(_===TriangleFanDrawMode||_===TriangleStripDrawMode){let Z=K.getIndex();if(Z===null){const oe=[],se=K.getAttribute("position");if(se!==void 0){for(let ae=0;ae<se.count;ae++)oe.push(ae);K.setIndex(oe),Z=K.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),K}const te=Z.count-2,ne=[];if(Z)if(_===TriangleFanDrawMode)for(let oe=1;oe<=te;oe++)ne.push(Z.getX(0)),ne.push(Z.getX(oe)),ne.push(Z.getX(oe+1));else for(let oe=0;oe<te;oe++)oe%2===0?(ne.push(Z.getX(oe)),ne.push(Z.getX(oe+1)),ne.push(Z.getX(oe+2))):(ne.push(Z.getX(oe+2)),ne.push(Z.getX(oe+1)),ne.push(Z.getX(oe)));ne.length/3!==te&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const ie=K.clone();return ie.setIndex(ne),ie.clearGroups(),ie}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_),K}function toCreasedNormals(K,_=Math.PI/3){const Z=Math.cos(_),te=(1+1e-10)*100,ne=[new Vector3,new Vector3,new Vector3],ie=new Vector3,oe=new Vector3,se=new Vector3,ae=new Vector3;function le(ge){const me=~~(ge.x*te),Ae=~~(ge.y*te),ye=~~(ge.z*te);return`${me},${Ae},${ye}`}const ce=K.index?K.toNonIndexed():K,fe=ce.attributes.position,de={};for(let ge=0,me=fe.count/3;ge<me;ge++){const Ae=3*ge,ye=ne[0].fromBufferAttribute(fe,Ae+0),ve=ne[1].fromBufferAttribute(fe,Ae+1),_e=ne[2].fromBufferAttribute(fe,Ae+2);ie.subVectors(_e,ve),oe.subVectors(ye,ve);const Te=new Vector3().crossVectors(ie,oe).normalize();for(let be=0;be<3;be++){const Re=ne[be],we=le(Re);we in de||(de[we]=[]),de[we].push(Te)}}const pe=new Float32Array(fe.count*3),he=new BufferAttribute(pe,3,!1);for(let ge=0,me=fe.count/3;ge<me;ge++){const Ae=3*ge,ye=ne[0].fromBufferAttribute(fe,Ae+0),ve=ne[1].fromBufferAttribute(fe,Ae+1),_e=ne[2].fromBufferAttribute(fe,Ae+2);ie.subVectors(_e,ve),oe.subVectors(ye,ve),se.crossVectors(ie,oe).normalize();for(let Te=0;Te<3;Te++){const be=ne[Te],Re=le(be),we=de[Re];ae.set(0,0,0);for(let Pe=0,Ie=we.length;Pe<Ie;Pe++){const $e=we[Pe];se.dot($e)>Z&&ae.add($e)}ae.normalize(),he.setXYZ(Ae+Te,ae.x,ae.y,ae.z)}}return ce.setAttribute("normal",he),ce}var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(K,_){for(var Z=new u16(31),te=0;te<31;++te)Z[te]=_+=1<<K[te-1];for(var ne=new u32(Z[30]),te=1;te<30;++te)for(var ie=Z[te];ie<Z[te+1];++ie)ne[ie]=ie-Z[te]<<5|te;return[Z,ne]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b[0],rev=new u16(32768);for(var i$b=0;i$b<32768;++i$b){var x$4=(i$b&43690)>>>1|(i$b&21845)<<1;x$4=(x$4&52428)>>>2|(x$4&13107)<<2,x$4=(x$4&61680)>>>4|(x$4&3855)<<4,rev[i$b]=((x$4&65280)>>>8|(x$4&255)<<8)>>>1}var hMap=function(K,_,Z){for(var te=K.length,ne=0,ie=new u16(_);ne<te;++ne)++ie[K[ne]-1];var oe=new u16(_);for(ne=0;ne<_;++ne)oe[ne]=oe[ne-1]+ie[ne-1]<<1;var se;if(Z){se=new u16(1<<_);var ae=15-_;for(ne=0;ne<te;++ne)if(K[ne])for(var le=ne<<4|K[ne],ce=_-K[ne],fe=oe[K[ne]-1]++<<ce,de=fe|(1<<ce)-1;fe<=de;++fe)se[rev[fe]>>>ae]=le}else for(se=new u16(te),ne=0;ne<te;++ne)K[ne]&&(se[ne]=rev[oe[K[ne]-1]++]>>>15-K[ne]);return se},flt=new u8(288);for(var i$b=0;i$b<144;++i$b)flt[i$b]=8;for(var i$b=144;i$b<256;++i$b)flt[i$b]=9;for(var i$b=256;i$b<280;++i$b)flt[i$b]=7;for(var i$b=280;i$b<288;++i$b)flt[i$b]=8;var fdt=new u8(32);for(var i$b=0;i$b<32;++i$b)fdt[i$b]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(K){for(var _=K[0],Z=1;Z<K.length;++Z)K[Z]>_&&(_=K[Z]);return _},bits=function(K,_,Z){var te=_/8|0;return(K[te]|K[te+1]<<8)>>(_&7)&Z},bits16=function(K,_){var Z=_/8|0;return(K[Z]|K[Z+1]<<8|K[Z+2]<<16)>>(_&7)},shft=function(K){return(K/8|0)+(K&7&&1)},slc=function(K,_,Z){(Z==null||Z>K.length)&&(Z=K.length);var te=new(K instanceof u16?u16:K instanceof u32?u32:u8)(Z-_);return te.set(K.subarray(_,Z)),te},inflt=function(K,_,Z){var te=K.length;if(!te||Z&&!Z.l&&te<5)return _||new u8(0);var ne=!_||Z,ie=!Z||Z.i;Z||(Z={}),_||(_=new u8(te*3));var oe=function(Ze){var it=_.length;if(Ze>it){var nt=new u8(Math.max(it*2,Ze));nt.set(_),_=nt}},se=Z.f||0,ae=Z.p||0,le=Z.b||0,ce=Z.l,fe=Z.d,de=Z.m,pe=Z.n,he=te*8;do{if(!ce){Z.f=se=bits(K,ae,1);var ge=bits(K,ae+1,3);if(ae+=3,ge)if(ge==1)ce=flrm,fe=fdrm,de=9,pe=5;else if(ge==2){var ve=bits(K,ae,31)+257,_e=bits(K,ae+10,15)+4,Te=ve+bits(K,ae+5,31)+1;ae+=14;for(var be=new u8(Te),Re=new u8(19),we=0;we<_e;++we)Re[clim[we]]=bits(K,ae+we*3,7);ae+=_e*3;for(var Pe=max(Re),Ie=(1<<Pe)-1,$e=hMap(Re,Pe,1),we=0;we<Te;){var Ue=$e[bits(K,ae,Ie)];ae+=Ue&15;var me=Ue>>>4;if(me<16)be[we++]=me;else{var ke=0,Ge=0;for(me==16?(Ge=3+bits(K,ae,3),ae+=2,ke=be[we-1]):me==17?(Ge=3+bits(K,ae,7),ae+=3):me==18&&(Ge=11+bits(K,ae,127),ae+=7);Ge--;)be[we++]=ke}}var He=be.subarray(0,ve),ze=be.subarray(ve);de=max(He),pe=max(ze),ce=hMap(He,de,1),fe=hMap(ze,pe,1)}else throw"invalid block type";else{var me=shft(ae)+4,Ae=K[me-4]|K[me-3]<<8,ye=me+Ae;if(ye>te){if(ie)throw"unexpected EOF";break}ne&&oe(le+Ae),_.set(K.subarray(me,ye),le),Z.b=le+=Ae,Z.p=ae=ye*8;continue}if(ae>he){if(ie)throw"unexpected EOF";break}}ne&&oe(le+131072);for(var Ke=(1<<de)-1,tt=(1<<pe)-1,Je=ae;;Je=ae){var ke=ce[bits16(K,ae)&Ke],ot=ke>>>4;if(ae+=ke&15,ae>he){if(ie)throw"unexpected EOF";break}if(!ke)throw"invalid length/literal";if(ot<256)_[le++]=ot;else if(ot==256){Je=ae,ce=null;break}else{var Fe=ot-254;if(ot>264){var we=ot-257,ct=fleb[we];Fe=bits(K,ae,(1<<ct)-1)+fl[we],ae+=ct}var ht=fe[bits16(K,ae)&tt],lt=ht>>>4;if(!ht)throw"invalid distance";ae+=ht&15;var ze=fd[lt];if(lt>3){var ct=fdeb[lt];ze+=bits16(K,ae)&(1<<ct)-1,ae+=ct}if(ae>he){if(ie)throw"unexpected EOF";break}ne&&oe(le+131072);for(var Qe=le+Fe;le<Qe;le+=4)_[le]=_[le-ze],_[le+1]=_[le+1-ze],_[le+2]=_[le+2-ze],_[le+3]=_[le+3-ze];le=Qe}}Z.l=ce,Z.p=Je,Z.b=le,ce&&(se=1,Z.m=de,Z.d=fe,Z.n=pe)}while(!se);return le==_.length?_:slc(_,0,le)},et=new u8(0),zlv=function(K){if((K[0]&15)!=8||K[0]>>>4>7||(K[0]<<8|K[1])%31)throw"invalid zlib data";if(K[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function unzlibSync(K,_){return inflt((zlv(K),K.subarray(2,-4)),_)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch{}let MarchingCubes$1=class extends Mesh{constructor(_,Z,te=!1,ne=!1,ie=1e4){const oe=new BufferGeometry;super(oe,Z),this.isMarchingCubes=!0;const se=this,ae=new Float32Array(12*3),le=new Float32Array(12*3),ce=new Float32Array(12*3);this.enableUvs=te,this.enableColors=ne,this.init=function(ye){this.resolution=ye,this.isolation=80,this.size=ye,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(this.size3*3),this.palette=new Float32Array(this.size3*3),this.count=0;const ve=ie*3;this.positionArray=new Float32Array(ve*3);const _e=new BufferAttribute(this.positionArray,3);_e.setUsage(DynamicDrawUsage),oe.setAttribute("position",_e),this.normalArray=new Float32Array(ve*3);const Te=new BufferAttribute(this.normalArray,3);if(Te.setUsage(DynamicDrawUsage),oe.setAttribute("normal",Te),this.enableUvs){this.uvArray=new Float32Array(ve*2);const be=new BufferAttribute(this.uvArray,2);be.setUsage(DynamicDrawUsage),oe.setAttribute("uv",be)}if(this.enableColors){this.colorArray=new Float32Array(ve*3);const be=new BufferAttribute(this.colorArray,3);be.setUsage(DynamicDrawUsage),oe.setAttribute("color",be)}oe.boundingSphere=new Sphere$2(new Vector3,1)};function fe(ye,ve,_e){return ye+(ve-ye)*_e}function de(ye,ve,_e,Te,be,Re,we,Pe,Ie,$e){const Ue=(_e-we)/(Pe-we),ke=se.normal_cache;ae[ve+0]=Te+Ue*se.delta,ae[ve+1]=be,ae[ve+2]=Re,le[ve+0]=fe(ke[ye+0],ke[ye+3],Ue),le[ve+1]=fe(ke[ye+1],ke[ye+4],Ue),le[ve+2]=fe(ke[ye+2],ke[ye+5],Ue),ce[ve+0]=fe(se.palette[Ie*3+0],se.palette[$e*3+0],Ue),ce[ve+1]=fe(se.palette[Ie*3+1],se.palette[$e*3+1],Ue),ce[ve+2]=fe(se.palette[Ie*3+2],se.palette[$e*3+2],Ue)}function pe(ye,ve,_e,Te,be,Re,we,Pe,Ie,$e){const Ue=(_e-we)/(Pe-we),ke=se.normal_cache;ae[ve+0]=Te,ae[ve+1]=be+Ue*se.delta,ae[ve+2]=Re;const Ge=ye+se.yd*3;le[ve+0]=fe(ke[ye+0],ke[Ge+0],Ue),le[ve+1]=fe(ke[ye+1],ke[Ge+1],Ue),le[ve+2]=fe(ke[ye+2],ke[Ge+2],Ue),ce[ve+0]=fe(se.palette[Ie*3+0],se.palette[$e*3+0],Ue),ce[ve+1]=fe(se.palette[Ie*3+1],se.palette[$e*3+1],Ue),ce[ve+2]=fe(se.palette[Ie*3+2],se.palette[$e*3+2],Ue)}function he(ye,ve,_e,Te,be,Re,we,Pe,Ie,$e){const Ue=(_e-we)/(Pe-we),ke=se.normal_cache;ae[ve+0]=Te,ae[ve+1]=be,ae[ve+2]=Re+Ue*se.delta;const Ge=ye+se.zd*3;le[ve+0]=fe(ke[ye+0],ke[Ge+0],Ue),le[ve+1]=fe(ke[ye+1],ke[Ge+1],Ue),le[ve+2]=fe(ke[ye+2],ke[Ge+2],Ue),ce[ve+0]=fe(se.palette[Ie*3+0],se.palette[$e*3+0],Ue),ce[ve+1]=fe(se.palette[Ie*3+1],se.palette[$e*3+1],Ue),ce[ve+2]=fe(se.palette[Ie*3+2],se.palette[$e*3+2],Ue)}function ge(ye){const ve=ye*3;se.normal_cache[ve]===0&&(se.normal_cache[ve+0]=se.field[ye-1]-se.field[ye+1],se.normal_cache[ve+1]=se.field[ye-se.yd]-se.field[ye+se.yd],se.normal_cache[ve+2]=se.field[ye-se.zd]-se.field[ye+se.zd])}function me(ye,ve,_e,Te,be){const Re=Te+1,we=Te+se.yd,Pe=Te+se.zd,Ie=Re+se.yd,$e=Re+se.zd,Ue=Te+se.yd+se.zd,ke=Re+se.yd+se.zd;let Ge=0;const He=se.field[Te],ze=se.field[Re],Ke=se.field[we],tt=se.field[Ie],Je=se.field[Pe],ot=se.field[$e],Fe=se.field[Ue],ct=se.field[ke];He<be&&(Ge|=1),ze<be&&(Ge|=2),Ke<be&&(Ge|=8),tt<be&&(Ge|=4),Je<be&&(Ge|=16),ot<be&&(Ge|=32),Fe<be&&(Ge|=128),ct<be&&(Ge|=64);const ht=edgeTable[Ge];if(ht===0)return 0;const lt=se.delta,Qe=ye+lt,Ze=ve+lt,it=_e+lt;ht&1&&(ge(Te),ge(Re),de(Te*3,0,be,ye,ve,_e,He,ze,Te,Re)),ht&2&&(ge(Re),ge(Ie),pe(Re*3,3,be,Qe,ve,_e,ze,tt,Re,Ie)),ht&4&&(ge(we),ge(Ie),de(we*3,6,be,ye,Ze,_e,Ke,tt,we,Ie)),ht&8&&(ge(Te),ge(we),pe(Te*3,9,be,ye,ve,_e,He,Ke,Te,we)),ht&16&&(ge(Pe),ge($e),de(Pe*3,12,be,ye,ve,it,Je,ot,Pe,$e)),ht&32&&(ge($e),ge(ke),pe($e*3,15,be,Qe,ve,it,ot,ct,$e,ke)),ht&64&&(ge(Ue),ge(ke),de(Ue*3,18,be,ye,Ze,it,Fe,ct,Ue,ke)),ht&128&&(ge(Pe),ge(Ue),pe(Pe*3,21,be,ye,ve,it,Je,Fe,Pe,Ue)),ht&256&&(ge(Te),ge(Pe),he(Te*3,24,be,ye,ve,_e,He,Je,Te,Pe)),ht&512&&(ge(Re),ge($e),he(Re*3,27,be,Qe,ve,_e,ze,ot,Re,$e)),ht&1024&&(ge(Ie),ge(ke),he(Ie*3,30,be,Qe,Ze,_e,tt,ct,Ie,ke)),ht&2048&&(ge(we),ge(Ue),he(we*3,33,be,ye,Ze,_e,Ke,Fe,we,Ue)),Ge<<=4;let nt,Tt,St,Et=0,Nt=0;for(;triTable[Ge+Nt]!=-1;)nt=Ge+Nt,Tt=nt+1,St=nt+2,Ae(ae,le,ce,3*triTable[nt],3*triTable[Tt],3*triTable[St]),Nt+=3,Et++;return Et}function Ae(ye,ve,_e,Te,be,Re){const we=se.count*3;if(se.positionArray[we+0]=ye[Te],se.positionArray[we+1]=ye[Te+1],se.positionArray[we+2]=ye[Te+2],se.positionArray[we+3]=ye[be],se.positionArray[we+4]=ye[be+1],se.positionArray[we+5]=ye[be+2],se.positionArray[we+6]=ye[Re],se.positionArray[we+7]=ye[Re+1],se.positionArray[we+8]=ye[Re+2],se.material.flatShading===!0){const Pe=(ve[Te+0]+ve[be+0]+ve[Re+0])/3,Ie=(ve[Te+1]+ve[be+1]+ve[Re+1])/3,$e=(ve[Te+2]+ve[be+2]+ve[Re+2])/3;se.normalArray[we+0]=Pe,se.normalArray[we+1]=Ie,se.normalArray[we+2]=$e,se.normalArray[we+3]=Pe,se.normalArray[we+4]=Ie,se.normalArray[we+5]=$e,se.normalArray[we+6]=Pe,se.normalArray[we+7]=Ie,se.normalArray[we+8]=$e}else se.normalArray[we+0]=ve[Te+0],se.normalArray[we+1]=ve[Te+1],se.normalArray[we+2]=ve[Te+2],se.normalArray[we+3]=ve[be+0],se.normalArray[we+4]=ve[be+1],se.normalArray[we+5]=ve[be+2],se.normalArray[we+6]=ve[Re+0],se.normalArray[we+7]=ve[Re+1],se.normalArray[we+8]=ve[Re+2];if(se.enableUvs){const Pe=se.count*2;se.uvArray[Pe+0]=ye[Te+0],se.uvArray[Pe+1]=ye[Te+2],se.uvArray[Pe+2]=ye[be+0],se.uvArray[Pe+3]=ye[be+2],se.uvArray[Pe+4]=ye[Re+0],se.uvArray[Pe+5]=ye[Re+2]}se.enableColors&&(se.colorArray[we+0]=_e[Te+0],se.colorArray[we+1]=_e[Te+1],se.colorArray[we+2]=_e[Te+2],se.colorArray[we+3]=_e[be+0],se.colorArray[we+4]=_e[be+1],se.colorArray[we+5]=_e[be+2],se.colorArray[we+6]=_e[Re+0],se.colorArray[we+7]=_e[Re+1],se.colorArray[we+8]=_e[Re+2]),se.count+=3}this.addBall=function(ye,ve,_e,Te,be,Re){const we=Math.sign(Te);Te=Math.abs(Te);const Pe=Re!=null;let Ie=new Color$1(ye,ve,_e);if(Pe)try{Ie=Re instanceof Color$1?Re:Array.isArray(Re)?new Color$1(Math.min(Math.abs(Re[0]),1),Math.min(Math.abs(Re[1]),1),Math.min(Math.abs(Re[2]),1)):new Color$1(Re)}catch{Ie=new Color$1(ye,ve,_e)}const $e=this.size*Math.sqrt(Te/be),Ue=_e*this.size,ke=ve*this.size,Ge=ye*this.size;let He=Math.floor(Ue-$e);He<1&&(He=1);let ze=Math.floor(Ue+$e);ze>this.size-1&&(ze=this.size-1);let Ke=Math.floor(ke-$e);Ke<1&&(Ke=1);let tt=Math.floor(ke+$e);tt>this.size-1&&(tt=this.size-1);let Je=Math.floor(Ge-$e);Je<1&&(Je=1);let ot=Math.floor(Ge+$e);ot>this.size-1&&(ot=this.size-1);let Fe,ct,ht,lt,Qe,Ze,it,nt,Tt,St,Et;for(ht=He;ht<ze;ht++)for(Qe=this.size2*ht,nt=ht/this.size-_e,Tt=nt*nt,ct=Ke;ct<tt;ct++)for(lt=Qe+this.size*ct,it=ct/this.size-ve,St=it*it,Fe=Je;Fe<ot;Fe++)if(Ze=Fe/this.size-ye,Et=Te/(1e-6+Ze*Ze+St+Tt)-be,Et>0){this.field[lt+Fe]+=Et*we;const Nt=Math.sqrt((Fe-Ge)*(Fe-Ge)+(ct-ke)*(ct-ke)+(ht-Ue)*(ht-Ue))/$e,zt=1-Nt*Nt*Nt*(Nt*(Nt*6-15)+10);this.palette[(lt+Fe)*3+0]+=Ie.r*zt,this.palette[(lt+Fe)*3+1]+=Ie.g*zt,this.palette[(lt+Fe)*3+2]+=Ie.b*zt}},this.addPlaneX=function(ye,ve){const _e=this.size,Te=this.yd,be=this.zd,Re=this.field;let we,Pe,Ie,$e,Ue,ke,Ge,He=_e*Math.sqrt(ye/ve);for(He>_e&&(He=_e),we=0;we<He;we++)if(ke=we/_e,$e=ke*ke,Ue=ye/(1e-4+$e)-ve,Ue>0)for(Pe=0;Pe<_e;Pe++)for(Ge=we+Pe*Te,Ie=0;Ie<_e;Ie++)Re[be*Ie+Ge]+=Ue},this.addPlaneY=function(ye,ve){const _e=this.size,Te=this.yd,be=this.zd,Re=this.field;let we,Pe,Ie,$e,Ue,ke,Ge,He,ze=_e*Math.sqrt(ye/ve);for(ze>_e&&(ze=_e),Pe=0;Pe<ze;Pe++)if(ke=Pe/_e,$e=ke*ke,Ue=ye/(1e-4+$e)-ve,Ue>0)for(Ge=Pe*Te,we=0;we<_e;we++)for(He=Ge+we,Ie=0;Ie<_e;Ie++)Re[be*Ie+He]+=Ue},this.addPlaneZ=function(ye,ve){const _e=this.size,Te=this.yd,be=this.zd,Re=this.field;let we,Pe,Ie,$e,Ue,ke,Ge,He,ze=_e*Math.sqrt(ye/ve);for(ze>_e&&(ze=_e),Ie=0;Ie<ze;Ie++)if(ke=Ie/_e,$e=ke*ke,Ue=ye/(1e-4+$e)-ve,Ue>0)for(Ge=be*Ie,Pe=0;Pe<_e;Pe++)for(He=Ge+Pe*Te,we=0;we<_e;we++)Re[He+we]+=Ue},this.setCell=function(ye,ve,_e,Te){const be=this.size2*_e+this.size*ve+ye;this.field[be]=Te},this.getCell=function(ye,ve,_e){const Te=this.size2*_e+this.size*ve+ye;return this.field[Te]},this.blur=function(ye=1){const ve=this.field,_e=ve.slice(),Te=this.size,be=this.size2;for(let Re=0;Re<Te;Re++)for(let we=0;we<Te;we++)for(let Pe=0;Pe<Te;Pe++){const Ie=be*Pe+Te*we+Re;let $e=_e[Ie],Ue=1;for(let ke=-1;ke<=1;ke+=2){const Ge=ke+Re;if(!(Ge<0||Ge>=Te))for(let He=-1;He<=1;He+=2){const ze=He+we;if(!(ze<0||ze>=Te))for(let Ke=-1;Ke<=1;Ke+=2){const tt=Ke+Pe;if(tt<0||tt>=Te)continue;const Je=be*tt+Te*ze+Ge,ot=_e[Je];Ue++,$e+=ye*(ot-$e)/Ue}}}ve[Ie]=$e}},this.reset=function(){for(let ye=0;ye<this.size3;ye++)this.normal_cache[ye*3]=0,this.field[ye]=0,this.palette[ye*3]=this.palette[ye*3+1]=this.palette[ye*3+2]=0},this.update=function(){this.count=0;const ye=this.size-2;for(let ve=1;ve<ye;ve++){const _e=this.size2*ve,Te=(ve-this.halfsize)/this.halfsize;for(let be=1;be<ye;be++){const Re=_e+this.size*be,we=(be-this.halfsize)/this.halfsize;for(let Pe=1;Pe<ye;Pe++){const Ie=(Pe-this.halfsize)/this.halfsize,$e=Re+Pe;me(Ie,we,Te,$e,this.isolation)}}}this.geometry.setDrawRange(0,this.count),oe.getAttribute("position").needsUpdate=!0,oe.getAttribute("normal").needsUpdate=!0,this.enableUvs&&(oe.getAttribute("uv").needsUpdate=!0),this.enableColors&&(oe.getAttribute("color").needsUpdate=!0),this.count/3>ie&&console.warn("THREE.MarchingCubes: Geometry buffers too small for rendering. Please create an instance with a higher poly count.")},this.init(_)}};const edgeTable=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),triTable=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);var __defProp$c=Object.defineProperty,__defNormalProp$c=(K,_,Z)=>_ in K?__defProp$c(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$c=(K,_,Z)=>(__defNormalProp$c(K,typeof _!="symbol"?_+"":_,Z),Z);class SimplexNoise{constructor(_=Math){__publicField$c(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),__publicField$c(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),__publicField$c(this,"p",[]),__publicField$c(this,"perm",[]),__publicField$c(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),__publicField$c(this,"dot",(Z,te,ne)=>Z[0]*te+Z[1]*ne),__publicField$c(this,"dot3",(Z,te,ne,ie)=>Z[0]*te+Z[1]*ne+Z[2]*ie),__publicField$c(this,"dot4",(Z,te,ne,ie,oe)=>Z[0]*te+Z[1]*ne+Z[2]*ie+Z[3]*oe),__publicField$c(this,"noise",(Z,te)=>{let ne,ie,oe;const se=.5*(Math.sqrt(3)-1),ae=(Z+te)*se,le=Math.floor(Z+ae),ce=Math.floor(te+ae),fe=(3-Math.sqrt(3))/6,de=(le+ce)*fe,pe=le-de,he=ce-de,ge=Z-pe,me=te-he;let Ae=0,ye=1;ge>me&&(Ae=1,ye=0);const ve=ge-Ae+fe,_e=me-ye+fe,Te=ge-1+2*fe,be=me-1+2*fe,Re=le&255,we=ce&255,Pe=this.perm[Re+this.perm[we]]%12,Ie=this.perm[Re+Ae+this.perm[we+ye]]%12,$e=this.perm[Re+1+this.perm[we+1]]%12;let Ue=.5-ge*ge-me*me;Ue<0?ne=0:(Ue*=Ue,ne=Ue*Ue*this.dot(this.grad3[Pe],ge,me));let ke=.5-ve*ve-_e*_e;ke<0?ie=0:(ke*=ke,ie=ke*ke*this.dot(this.grad3[Ie],ve,_e));let Ge=.5-Te*Te-be*be;return Ge<0?oe=0:(Ge*=Ge,oe=Ge*Ge*this.dot(this.grad3[$e],Te,be)),70*(ne+ie+oe)}),__publicField$c(this,"noise3d",(Z,te,ne)=>{let ie,oe,se,ae;const ce=(Z+te+ne)*.3333333333333333,fe=Math.floor(Z+ce),de=Math.floor(te+ce),pe=Math.floor(ne+ce),he=1/6,ge=(fe+de+pe)*he,me=fe-ge,Ae=de-ge,ye=pe-ge,ve=Z-me,_e=te-Ae,Te=ne-ye;let be,Re,we,Pe,Ie,$e;ve>=_e?_e>=Te?(be=1,Re=0,we=0,Pe=1,Ie=1,$e=0):ve>=Te?(be=1,Re=0,we=0,Pe=1,Ie=0,$e=1):(be=0,Re=0,we=1,Pe=1,Ie=0,$e=1):_e<Te?(be=0,Re=0,we=1,Pe=0,Ie=1,$e=1):ve<Te?(be=0,Re=1,we=0,Pe=0,Ie=1,$e=1):(be=0,Re=1,we=0,Pe=1,Ie=1,$e=0);const Ue=ve-be+he,ke=_e-Re+he,Ge=Te-we+he,He=ve-Pe+2*he,ze=_e-Ie+2*he,Ke=Te-$e+2*he,tt=ve-1+3*he,Je=_e-1+3*he,ot=Te-1+3*he,Fe=fe&255,ct=de&255,ht=pe&255,lt=this.perm[Fe+this.perm[ct+this.perm[ht]]]%12,Qe=this.perm[Fe+be+this.perm[ct+Re+this.perm[ht+we]]]%12,Ze=this.perm[Fe+Pe+this.perm[ct+Ie+this.perm[ht+$e]]]%12,it=this.perm[Fe+1+this.perm[ct+1+this.perm[ht+1]]]%12;let nt=.6-ve*ve-_e*_e-Te*Te;nt<0?ie=0:(nt*=nt,ie=nt*nt*this.dot3(this.grad3[lt],ve,_e,Te));let Tt=.6-Ue*Ue-ke*ke-Ge*Ge;Tt<0?oe=0:(Tt*=Tt,oe=Tt*Tt*this.dot3(this.grad3[Qe],Ue,ke,Ge));let St=.6-He*He-ze*ze-Ke*Ke;St<0?se=0:(St*=St,se=St*St*this.dot3(this.grad3[Ze],He,ze,Ke));let Et=.6-tt*tt-Je*Je-ot*ot;return Et<0?ae=0:(Et*=Et,ae=Et*Et*this.dot3(this.grad3[it],tt,Je,ot)),32*(ie+oe+se+ae)}),__publicField$c(this,"noise4d",(Z,te,ne,ie)=>{const oe=this.grad4,se=this.simplex,ae=this.perm,le=(Math.sqrt(5)-1)/4,ce=(5-Math.sqrt(5))/20;let fe,de,pe,he,ge;const me=(Z+te+ne+ie)*le,Ae=Math.floor(Z+me),ye=Math.floor(te+me),ve=Math.floor(ne+me),_e=Math.floor(ie+me),Te=(Ae+ye+ve+_e)*ce,be=Ae-Te,Re=ye-Te,we=ve-Te,Pe=_e-Te,Ie=Z-be,$e=te-Re,Ue=ne-we,ke=ie-Pe,Ge=Ie>$e?32:0,He=Ie>Ue?16:0,ze=$e>Ue?8:0,Ke=Ie>ke?4:0,tt=$e>ke?2:0,Je=Ue>ke?1:0,ot=Ge+He+ze+Ke+tt+Je;let Fe,ct,ht,lt,Qe,Ze,it,nt,Tt,St,Et,Nt;Fe=se[ot][0]>=3?1:0,ct=se[ot][1]>=3?1:0,ht=se[ot][2]>=3?1:0,lt=se[ot][3]>=3?1:0,Qe=se[ot][0]>=2?1:0,Ze=se[ot][1]>=2?1:0,it=se[ot][2]>=2?1:0,nt=se[ot][3]>=2?1:0,Tt=se[ot][0]>=1?1:0,St=se[ot][1]>=1?1:0,Et=se[ot][2]>=1?1:0,Nt=se[ot][3]>=1?1:0;const zt=Ie-Fe+ce,yt=$e-ct+ce,Ut=Ue-ht+ce,bt=ke-lt+ce,Ot=Ie-Qe+2*ce,Mt=$e-Ze+2*ce,_t=Ue-it+2*ce,pt=ke-nt+2*ce,ft=Ie-Tt+3*ce,st=$e-St+3*ce,vt=Ue-Et+3*ce,Pt=ke-Nt+3*ce,Lt=Ie-1+4*ce,Vt=$e-1+4*ce,Le=Ue-1+4*ce,De=ke-1+4*ce,Be=Ae&255,rt=ye&255,at=ve&255,xt=_e&255,Ct=ae[Be+ae[rt+ae[at+ae[xt]]]]%32,Qt=ae[Be+Fe+ae[rt+ct+ae[at+ht+ae[xt+lt]]]]%32,qt=ae[Be+Qe+ae[rt+Ze+ae[at+it+ae[xt+nt]]]]%32,It=ae[Be+Tt+ae[rt+St+ae[at+Et+ae[xt+Nt]]]]%32,Gt=ae[Be+1+ae[rt+1+ae[at+1+ae[xt+1]]]]%32;let Jt=.6-Ie*Ie-$e*$e-Ue*Ue-ke*ke;Jt<0?fe=0:(Jt*=Jt,fe=Jt*Jt*this.dot4(oe[Ct],Ie,$e,Ue,ke));let kt=.6-zt*zt-yt*yt-Ut*Ut-bt*bt;kt<0?de=0:(kt*=kt,de=kt*kt*this.dot4(oe[Qt],zt,yt,Ut,bt));let Ht=.6-Ot*Ot-Mt*Mt-_t*_t-pt*pt;Ht<0?pe=0:(Ht*=Ht,pe=Ht*Ht*this.dot4(oe[qt],Ot,Mt,_t,pt));let Yt=.6-ft*ft-st*st-vt*vt-Pt*Pt;Yt<0?he=0:(Yt*=Yt,he=Yt*Yt*this.dot4(oe[It],ft,st,vt,Pt));let hn=.6-Lt*Lt-Vt*Vt-Le*Le-De*De;return hn<0?ge=0:(hn*=hn,ge=hn*hn*this.dot4(oe[Gt],Lt,Vt,Le,De)),27*(fe+de+pe+he+ge)});for(let Z=0;Z<256;Z++)this.p[Z]=Math.floor(_.random()*256);for(let Z=0;Z<512;Z++)this.perm[Z]=this.p[Z&255]}}var __defProp$b=Object.defineProperty,__defNormalProp$b=(K,_,Z)=>_ in K?__defProp$b(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$b=(K,_,Z)=>(__defNormalProp$b(K,typeof _!="symbol"?_+"":_,Z),Z);const Sky$1=(()=>{const K={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${version$4>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},_=new ShaderMaterial({name:"SkyShader",fragmentShader:K.fragmentShader,vertexShader:K.vertexShader,uniforms:UniformsUtils.clone(K.uniforms),side:BackSide,depthWrite:!1});class Z extends Mesh{constructor(){super(new BoxGeometry(1,1,1),_)}}return __publicField$b(Z,"SkyShader",K),__publicField$b(Z,"material",_),Z})(),isCubeTexture$1=K=>K&&K.isCubeTexture;class GroundProjectedEnv extends Mesh{constructor(_,Z){var te,ne;const ie=isCubeTexture$1(_),se=((ne=ie?(te=_.image[0])==null?void 0:te.width:_.image.width)!=null?ne:1024)/4,ae=Math.floor(Math.log2(se)),le=Math.pow(2,ae),ce=3*Math.max(le,16*7),fe=4*le,de=[ie?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/ce}`,`#define CUBEUV_TEXEL_HEIGHT ${1/fe}`,`#define CUBEUV_MAX_MIP ${ae}.0`],pe=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,he=de.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${version$4>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,ge={map:{value:_},height:{value:(Z==null?void 0:Z.height)||15},radius:{value:(Z==null?void 0:Z.radius)||100}},me=new IcosahedronGeometry(1,16),Ae=new ShaderMaterial({uniforms:ge,fragmentShader:he,vertexShader:pe,side:DoubleSide});super(me,Ae)}set radius(_){this.material.uniforms.radius.value=_}get radius(){return this.material.uniforms.radius.value}set height(_){this.material.uniforms.height.value=_}get height(){return this.material.uniforms.height.value}}function retarget(K,_,Z={}){const te=new Vector3,ne=new Quaternion,ie=new Vector3,oe=new Matrix4,se=new Matrix4,ae=new Matrix4;Z.preserveMatrix=Z.preserveMatrix!==void 0?Z.preserveMatrix:!0,Z.preservePosition=Z.preservePosition!==void 0?Z.preservePosition:!0,Z.preserveHipPosition=Z.preserveHipPosition!==void 0?Z.preserveHipPosition:!1,Z.useTargetMatrix=Z.useTargetMatrix!==void 0?Z.useTargetMatrix:!1,Z.hip=Z.hip!==void 0?Z.hip:"hip",Z.names=Z.names||{};const le=_.isObject3D?_.skeleton.bones:getBones(_),ce=K.isObject3D?K.skeleton.bones:getBones(K);let fe,de,pe,he,ge;if(K.isObject3D?K.skeleton.pose():(Z.useTargetMatrix=!0,Z.preserveMatrix=!1),Z.preservePosition){ge=[];for(let me=0;me<ce.length;me++)ge.push(ce[me].position.clone())}if(Z.preserveMatrix){K.updateMatrixWorld(),K.matrixWorld.identity();for(let me=0;me<K.children.length;++me)K.children[me].updateMatrixWorld(!0)}if(Z.offsets){fe=[];for(let me=0;me<ce.length;++me)de=ce[me],pe=Z.names[de.name]||de.name,Z.offsets[pe]&&(de.matrix.multiply(Z.offsets[pe]),de.matrix.decompose(de.position,de.quaternion,de.scale),de.updateMatrixWorld()),fe.push(de.matrixWorld.clone())}for(let me=0;me<ce.length;++me){if(de=ce[me],pe=Z.names[de.name]||de.name,he=getBoneByName(pe,le),ae.copy(de.matrixWorld),he){if(he.updateMatrixWorld(),Z.useTargetMatrix?se.copy(he.matrixWorld):(se.copy(K.matrixWorld).invert(),se.multiply(he.matrixWorld)),ie.setFromMatrixScale(se),se.scale(ie.set(1/ie.x,1/ie.y,1/ie.z)),ae.makeRotationFromQuaternion(ne.setFromRotationMatrix(se)),K.isObject3D){const Ae=ce.indexOf(de),ye=fe?fe[Ae]:oe.copy(K.skeleton.boneInverses[Ae]).invert();ae.multiply(ye)}ae.copyPosition(se)}de.parent&&de.parent.isBone?(de.matrix.copy(de.parent.matrixWorld).invert(),de.matrix.multiply(ae)):de.matrix.copy(ae),Z.preserveHipPosition&&pe===Z.hip&&de.matrix.setPosition(te.set(0,de.position.y,0)),de.matrix.decompose(de.position,de.quaternion,de.scale),de.updateMatrixWorld()}if(Z.preservePosition)for(let me=0;me<ce.length;++me)de=ce[me],pe=Z.names[de.name]||de.name,pe!==Z.hip&&de.position.copy(ge[me]);Z.preserveMatrix&&K.updateMatrixWorld(!0)}function retargetClip(K,_,Z,te={}){te.useFirstFramePosition=te.useFirstFramePosition!==void 0?te.useFirstFramePosition:!1,te.fps=te.fps!==void 0?te.fps:30,te.names=te.names||[],_.isObject3D||(_=getHelperFromSkeleton(_));const ne=Math.round(Z.duration*(te.fps/1e3)*1e3),ie=1/te.fps,oe=[],se=new AnimationMixer(_),ae=getBones(K.skeleton),le=[];let ce,fe,de,pe,he;se.clipAction(Z).play(),se.update(0),_.updateMatrixWorld();for(let ge=0;ge<ne;++ge){const me=ge*ie;retarget(K,_,te);for(let Ae=0;Ae<ae.length;++Ae)he=te.names[ae[Ae].name]||ae[Ae].name,de=getBoneByName(he,_.skeleton),de&&(fe=ae[Ae],pe=le[Ae]=le[Ae]||{bone:fe},te.hip===he&&(pe.pos||(pe.pos={times:new Float32Array(ne),values:new Float32Array(ne*3)}),te.useFirstFramePosition&&(ge===0&&(ce=fe.position.clone()),fe.position.sub(ce)),pe.pos.times[ge]=me,fe.position.toArray(pe.pos.values,ge*3)),pe.quat||(pe.quat={times:new Float32Array(ne),values:new Float32Array(ne*4)}),pe.quat.times[ge]=me,fe.quaternion.toArray(pe.quat.values,ge*4));se.update(ie),_.updateMatrixWorld()}for(let ge=0;ge<le.length;++ge)pe=le[ge],pe&&(pe.pos&&oe.push(new VectorKeyframeTrack(".bones["+pe.bone.name+"].position",pe.pos.times,pe.pos.values)),oe.push(new QuaternionKeyframeTrack(".bones["+pe.bone.name+"].quaternion",pe.quat.times,pe.quat.values)));return se.uncacheAction(Z),new AnimationClip(Z.name,-1,oe)}function clone$1(K){const _=new Map,Z=new Map,te=K.clone();return parallelTraverse$1(K,te,function(ne,ie){_.set(ie,ne),Z.set(ne,ie)}),te.traverse(function(ne){if(!ne.isSkinnedMesh)return;const ie=ne,oe=_.get(ne),se=oe.skeleton.bones;ie.skeleton=oe.skeleton.clone(),ie.bindMatrix.copy(oe.bindMatrix),ie.skeleton.bones=se.map(function(ae){return Z.get(ae)}),ie.bind(ie.skeleton,ie.bindMatrix)}),te}function getBoneByName(K,_){for(let Z=0,te=getBones(_);Z<te.length;Z++)if(K===te[Z].name)return te[Z]}function getBones(K){return Array.isArray(K)?K:K.bones}function getHelperFromSkeleton(K){const _=new SkeletonHelper(K.bones[0]);return _.skeleton=K,_}function parallelTraverse$1(K,_,Z){Z(K,_);for(let te=0;te<K.children.length;te++)parallelTraverse$1(K.children[te],_.children[te],Z)}const SkeletonUtils={retarget,retargetClip,clone:clone$1},_face=new Triangle,_color$1=new Vector3;class MeshSurfaceSampler{constructor(_){let Z=_.geometry;Z.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),Z=Z.toNonIndexed()),this.geometry=Z,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(_){return this.weightAttribute=_?this.geometry.getAttribute(_):null,this}build(){const _=this.positionAttribute,Z=this.weightAttribute,te=new Float32Array(_.count/3);for(let ie=0;ie<_.count;ie+=3){let oe=1;Z&&(oe=Z.getX(ie)+Z.getX(ie+1)+Z.getX(ie+2)),_face.a.fromBufferAttribute(_,ie),_face.b.fromBufferAttribute(_,ie+1),_face.c.fromBufferAttribute(_,ie+2),oe*=_face.getArea(),te[ie/3]=oe}this.distribution=new Float32Array(_.count/3);let ne=0;for(let ie=0;ie<te.length;ie++)ne+=te[ie],this.distribution[ie]=ne;return this}setRandomGenerator(_){return this.randomFunction=_,this}sample(_,Z,te){const ne=this.sampleFaceIndex();return this.sampleFace(ne,_,Z,te)}sampleFaceIndex(){const _=this.distribution[this.distribution.length-1];return this.binarySearch(this.randomFunction()*_)}binarySearch(_){const Z=this.distribution;let te=0,ne=Z.length-1,ie=-1;for(;te<=ne;){const oe=Math.ceil((te+ne)/2);if(oe===0||Z[oe-1]<=_&&Z[oe]>_){ie=oe;break}else _<Z[oe]?ne=oe-1:te=oe+1}return ie}sampleFace(_,Z,te,ne){let ie=this.randomFunction(),oe=this.randomFunction();return ie+oe>1&&(ie=1-ie,oe=1-oe),_face.a.fromBufferAttribute(this.positionAttribute,_*3),_face.b.fromBufferAttribute(this.positionAttribute,_*3+1),_face.c.fromBufferAttribute(this.positionAttribute,_*3+2),Z.set(0,0,0).addScaledVector(_face.a,ie).addScaledVector(_face.b,oe).addScaledVector(_face.c,1-(ie+oe)),te!==void 0&&_face.getNormal(te),ne!==void 0&&this.colorAttribute!==void 0&&(_face.a.fromBufferAttribute(this.colorAttribute,_*3),_face.b.fromBufferAttribute(this.colorAttribute,_*3+1),_face.c.fromBufferAttribute(this.colorAttribute,_*3+2),_color$1.set(0,0,0).addScaledVector(_face.a,ie).addScaledVector(_face.b,oe).addScaledVector(_face.c,1-(ie+oe)),ne.r=_color$1.x,ne.g=_color$1.y,ne.b=_color$1.z),this}}var __defProp$a=Object.defineProperty,__defNormalProp$a=(K,_,Z)=>_ in K?__defProp$a(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$a=(K,_,Z)=>(__defNormalProp$a(K,_+"",Z),Z);class EventDispatcher{constructor(){__publicField$a(this,"_listeners")}addEventListener(_,Z){this._listeners===void 0&&(this._listeners={});const te=this._listeners;te[_]===void 0&&(te[_]=[]),te[_].indexOf(Z)===-1&&te[_].push(Z)}hasEventListener(_,Z){if(this._listeners===void 0)return!1;const te=this._listeners;return te[_]!==void 0&&te[_].indexOf(Z)!==-1}removeEventListener(_,Z){if(this._listeners===void 0)return;const ne=this._listeners[_];if(ne!==void 0){const ie=ne.indexOf(Z);ie!==-1&&ne.splice(ie,1)}}dispatchEvent(_){if(this._listeners===void 0)return;const te=this._listeners[_.type];if(te!==void 0){_.target=this;const ne=te.slice(0);for(let ie=0,oe=ne.length;ie<oe;ie++)ne[ie].call(this,_);_.target=null}}}var __defProp$9=Object.defineProperty,__defNormalProp$9=(K,_,Z)=>_ in K?__defProp$9(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$9=(K,_,Z)=>(__defNormalProp$9(K,typeof _!="symbol"?_+"":_,Z),Z);const _ray$2=new Ray,_plane=new Plane$2,TILT_LIMIT=Math.cos(70*(Math.PI/180)),moduloWrapAround=(K,_)=>(K%_+_)%_;let OrbitControls$1=class extends EventDispatcher{constructor(_,Z){super(),__publicField$9(this,"object"),__publicField$9(this,"domElement"),__publicField$9(this,"enabled",!0),__publicField$9(this,"target",new Vector3),__publicField$9(this,"minDistance",0),__publicField$9(this,"maxDistance",1/0),__publicField$9(this,"minZoom",0),__publicField$9(this,"maxZoom",1/0),__publicField$9(this,"minPolarAngle",0),__publicField$9(this,"maxPolarAngle",Math.PI),__publicField$9(this,"minAzimuthAngle",-1/0),__publicField$9(this,"maxAzimuthAngle",1/0),__publicField$9(this,"enableDamping",!1),__publicField$9(this,"dampingFactor",.05),__publicField$9(this,"enableZoom",!0),__publicField$9(this,"zoomSpeed",1),__publicField$9(this,"enableRotate",!0),__publicField$9(this,"rotateSpeed",1),__publicField$9(this,"enablePan",!0),__publicField$9(this,"panSpeed",1),__publicField$9(this,"screenSpacePanning",!0),__publicField$9(this,"keyPanSpeed",7),__publicField$9(this,"zoomToCursor",!1),__publicField$9(this,"autoRotate",!1),__publicField$9(this,"autoRotateSpeed",2),__publicField$9(this,"reverseOrbit",!1),__publicField$9(this,"reverseHorizontalOrbit",!1),__publicField$9(this,"reverseVerticalOrbit",!1),__publicField$9(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField$9(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField$9(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField$9(this,"target0"),__publicField$9(this,"position0"),__publicField$9(this,"zoom0"),__publicField$9(this,"_domElementKeyEvents",null),__publicField$9(this,"getPolarAngle"),__publicField$9(this,"getAzimuthalAngle"),__publicField$9(this,"setPolarAngle"),__publicField$9(this,"setAzimuthalAngle"),__publicField$9(this,"getDistance"),__publicField$9(this,"getZoomScale"),__publicField$9(this,"listenToKeyEvents"),__publicField$9(this,"stopListenToKeyEvents"),__publicField$9(this,"saveState"),__publicField$9(this,"reset"),__publicField$9(this,"update"),__publicField$9(this,"connect"),__publicField$9(this,"dispose"),__publicField$9(this,"dollyIn"),__publicField$9(this,"dollyOut"),__publicField$9(this,"getScale"),__publicField$9(this,"setScale"),this.object=_,this.domElement=Z,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>ce.phi,this.getAzimuthalAngle=()=>ce.theta,this.setPolarAngle=It=>{let Gt=moduloWrapAround(It,2*Math.PI),Jt=ce.phi;Jt<0&&(Jt+=2*Math.PI),Gt<0&&(Gt+=2*Math.PI);let kt=Math.abs(Gt-Jt);2*Math.PI-kt<kt&&(Gt<Jt?Gt+=2*Math.PI:Jt+=2*Math.PI),fe.phi=Gt-Jt,te.update()},this.setAzimuthalAngle=It=>{let Gt=moduloWrapAround(It,2*Math.PI),Jt=ce.theta;Jt<0&&(Jt+=2*Math.PI),Gt<0&&(Gt+=2*Math.PI);let kt=Math.abs(Gt-Jt);2*Math.PI-kt<kt&&(Gt<Jt?Gt+=2*Math.PI:Jt+=2*Math.PI),fe.theta=Gt-Jt,te.update()},this.getDistance=()=>te.object.position.distanceTo(te.target),this.listenToKeyEvents=It=>{It.addEventListener("keydown",De),this._domElementKeyEvents=It},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",De),this._domElementKeyEvents=null},this.saveState=()=>{te.target0.copy(te.target),te.position0.copy(te.object.position),te.zoom0=te.object.zoom},this.reset=()=>{te.target.copy(te.target0),te.object.position.copy(te.position0),te.object.zoom=te.zoom0,te.object.updateProjectionMatrix(),te.dispatchEvent(ne),te.update(),ae=se.NONE},this.update=(()=>{const It=new Vector3,Gt=new Vector3(0,1,0),Jt=new Quaternion().setFromUnitVectors(_.up,Gt),kt=Jt.clone().invert(),Ht=new Vector3,Yt=new Quaternion,hn=2*Math.PI;return function(){const xn=te.object.position;Jt.setFromUnitVectors(_.up,Gt),kt.copy(Jt).invert(),It.copy(xn).sub(te.target),It.applyQuaternion(Jt),ce.setFromVector3(It),te.autoRotate&&ae===se.NONE&&Ge(Ue()),te.enableDamping?(ce.theta+=fe.theta*te.dampingFactor,ce.phi+=fe.phi*te.dampingFactor):(ce.theta+=fe.theta,ce.phi+=fe.phi);let Ln=te.minAzimuthAngle,Vn=te.maxAzimuthAngle;isFinite(Ln)&&isFinite(Vn)&&(Ln<-Math.PI?Ln+=hn:Ln>Math.PI&&(Ln-=hn),Vn<-Math.PI?Vn+=hn:Vn>Math.PI&&(Vn-=hn),Ln<=Vn?ce.theta=Math.max(Ln,Math.min(Vn,ce.theta)):ce.theta=ce.theta>(Ln+Vn)/2?Math.max(Ln,ce.theta):Math.min(Vn,ce.theta)),ce.phi=Math.max(te.minPolarAngle,Math.min(te.maxPolarAngle,ce.phi)),ce.makeSafe(),te.enableDamping===!0?te.target.addScaledVector(pe,te.dampingFactor):te.target.add(pe),te.zoomToCursor&&Pe||te.object.isOrthographicCamera?ce.radius=ht(ce.radius):ce.radius=ht(ce.radius*de),It.setFromSpherical(ce),It.applyQuaternion(kt),xn.copy(te.target).add(It),te.object.matrixAutoUpdate||te.object.updateMatrix(),te.object.lookAt(te.target),te.enableDamping===!0?(fe.theta*=1-te.dampingFactor,fe.phi*=1-te.dampingFactor,pe.multiplyScalar(1-te.dampingFactor)):(fe.set(0,0,0),pe.set(0,0,0));let kn=!1;if(te.zoomToCursor&&Pe){let Rn=null;if(te.object instanceof PerspectiveCamera$2&&te.object.isPerspectiveCamera){const or=It.length();Rn=ht(or*de);const pr=or-Rn;te.object.position.addScaledVector(Re,pr),te.object.updateMatrixWorld()}else if(te.object.isOrthographicCamera){const or=new Vector3(we.x,we.y,0);or.unproject(te.object),te.object.zoom=Math.max(te.minZoom,Math.min(te.maxZoom,te.object.zoom/de)),te.object.updateProjectionMatrix(),kn=!0;const pr=new Vector3(we.x,we.y,0);pr.unproject(te.object),te.object.position.sub(pr).add(or),te.object.updateMatrixWorld(),Rn=It.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),te.zoomToCursor=!1;Rn!==null&&(te.screenSpacePanning?te.target.set(0,0,-1).transformDirection(te.object.matrix).multiplyScalar(Rn).add(te.object.position):(_ray$2.origin.copy(te.object.position),_ray$2.direction.set(0,0,-1).transformDirection(te.object.matrix),Math.abs(te.object.up.dot(_ray$2.direction))<TILT_LIMIT?_.lookAt(te.target):(_plane.setFromNormalAndCoplanarPoint(te.object.up,te.target),_ray$2.intersectPlane(_plane,te.target))))}else te.object instanceof OrthographicCamera$1&&te.object.isOrthographicCamera&&(kn=de!==1,kn&&(te.object.zoom=Math.max(te.minZoom,Math.min(te.maxZoom,te.object.zoom/de)),te.object.updateProjectionMatrix()));return de=1,Pe=!1,kn||Ht.distanceToSquared(te.object.position)>le||8*(1-Yt.dot(te.object.quaternion))>le?(te.dispatchEvent(ne),Ht.copy(te.object.position),Yt.copy(te.object.quaternion),kn=!1,!0):!1}})(),this.connect=It=>{te.domElement=It,te.domElement.style.touchAction="none",te.domElement.addEventListener("contextmenu",at),te.domElement.addEventListener("pointerdown",st),te.domElement.addEventListener("pointercancel",Pt),te.domElement.addEventListener("wheel",Le)},this.dispose=()=>{var It,Gt,Jt,kt,Ht,Yt;te.domElement&&(te.domElement.style.touchAction="auto"),(It=te.domElement)==null||It.removeEventListener("contextmenu",at),(Gt=te.domElement)==null||Gt.removeEventListener("pointerdown",st),(Jt=te.domElement)==null||Jt.removeEventListener("pointercancel",Pt),(kt=te.domElement)==null||kt.removeEventListener("wheel",Le),(Ht=te.domElement)==null||Ht.ownerDocument.removeEventListener("pointermove",vt),(Yt=te.domElement)==null||Yt.ownerDocument.removeEventListener("pointerup",Pt),te._domElementKeyEvents!==null&&te._domElementKeyEvents.removeEventListener("keydown",De)};const te=this,ne={type:"change"},ie={type:"start"},oe={type:"end"},se={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let ae=se.NONE;const le=1e-6,ce=new Spherical,fe=new Spherical;let de=1;const pe=new Vector3,he=new Vector2,ge=new Vector2,me=new Vector2,Ae=new Vector2,ye=new Vector2,ve=new Vector2,_e=new Vector2,Te=new Vector2,be=new Vector2,Re=new Vector3,we=new Vector2;let Pe=!1;const Ie=[],$e={};function Ue(){return 2*Math.PI/60/60*te.autoRotateSpeed}function ke(){return Math.pow(.95,te.zoomSpeed)}function Ge(It){te.reverseOrbit||te.reverseHorizontalOrbit?fe.theta+=It:fe.theta-=It}function He(It){te.reverseOrbit||te.reverseVerticalOrbit?fe.phi+=It:fe.phi-=It}const ze=(()=>{const It=new Vector3;return function(Jt,kt){It.setFromMatrixColumn(kt,0),It.multiplyScalar(-Jt),pe.add(It)}})(),Ke=(()=>{const It=new Vector3;return function(Jt,kt){te.screenSpacePanning===!0?It.setFromMatrixColumn(kt,1):(It.setFromMatrixColumn(kt,0),It.crossVectors(te.object.up,It)),It.multiplyScalar(Jt),pe.add(It)}})(),tt=(()=>{const It=new Vector3;return function(Jt,kt){const Ht=te.domElement;if(Ht&&te.object instanceof PerspectiveCamera$2&&te.object.isPerspectiveCamera){const Yt=te.object.position;It.copy(Yt).sub(te.target);let hn=It.length();hn*=Math.tan(te.object.fov/2*Math.PI/180),ze(2*Jt*hn/Ht.clientHeight,te.object.matrix),Ke(2*kt*hn/Ht.clientHeight,te.object.matrix)}else Ht&&te.object instanceof OrthographicCamera$1&&te.object.isOrthographicCamera?(ze(Jt*(te.object.right-te.object.left)/te.object.zoom/Ht.clientWidth,te.object.matrix),Ke(kt*(te.object.top-te.object.bottom)/te.object.zoom/Ht.clientHeight,te.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),te.enablePan=!1)}})();function Je(It){te.object instanceof PerspectiveCamera$2&&te.object.isPerspectiveCamera||te.object instanceof OrthographicCamera$1&&te.object.isOrthographicCamera?de=It:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),te.enableZoom=!1)}function ot(It){Je(de/It)}function Fe(It){Je(de*It)}function ct(It){if(!te.zoomToCursor||!te.domElement)return;Pe=!0;const Gt=te.domElement.getBoundingClientRect(),Jt=It.clientX-Gt.left,kt=It.clientY-Gt.top,Ht=Gt.width,Yt=Gt.height;we.x=Jt/Ht*2-1,we.y=-(kt/Yt)*2+1,Re.set(we.x,we.y,1).unproject(te.object).sub(te.object.position).normalize()}function ht(It){return Math.max(te.minDistance,Math.min(te.maxDistance,It))}function lt(It){he.set(It.clientX,It.clientY)}function Qe(It){ct(It),_e.set(It.clientX,It.clientY)}function Ze(It){Ae.set(It.clientX,It.clientY)}function it(It){ge.set(It.clientX,It.clientY),me.subVectors(ge,he).multiplyScalar(te.rotateSpeed);const Gt=te.domElement;Gt&&(Ge(2*Math.PI*me.x/Gt.clientHeight),He(2*Math.PI*me.y/Gt.clientHeight)),he.copy(ge),te.update()}function nt(It){Te.set(It.clientX,It.clientY),be.subVectors(Te,_e),be.y>0?ot(ke()):be.y<0&&Fe(ke()),_e.copy(Te),te.update()}function Tt(It){ye.set(It.clientX,It.clientY),ve.subVectors(ye,Ae).multiplyScalar(te.panSpeed),tt(ve.x,ve.y),Ae.copy(ye),te.update()}function St(It){ct(It),It.deltaY<0?Fe(ke()):It.deltaY>0&&ot(ke()),te.update()}function Et(It){let Gt=!1;switch(It.code){case te.keys.UP:tt(0,te.keyPanSpeed),Gt=!0;break;case te.keys.BOTTOM:tt(0,-te.keyPanSpeed),Gt=!0;break;case te.keys.LEFT:tt(te.keyPanSpeed,0),Gt=!0;break;case te.keys.RIGHT:tt(-te.keyPanSpeed,0),Gt=!0;break}Gt&&(It.preventDefault(),te.update())}function Nt(){if(Ie.length==1)he.set(Ie[0].pageX,Ie[0].pageY);else{const It=.5*(Ie[0].pageX+Ie[1].pageX),Gt=.5*(Ie[0].pageY+Ie[1].pageY);he.set(It,Gt)}}function zt(){if(Ie.length==1)Ae.set(Ie[0].pageX,Ie[0].pageY);else{const It=.5*(Ie[0].pageX+Ie[1].pageX),Gt=.5*(Ie[0].pageY+Ie[1].pageY);Ae.set(It,Gt)}}function yt(){const It=Ie[0].pageX-Ie[1].pageX,Gt=Ie[0].pageY-Ie[1].pageY,Jt=Math.sqrt(It*It+Gt*Gt);_e.set(0,Jt)}function Ut(){te.enableZoom&&yt(),te.enablePan&&zt()}function bt(){te.enableZoom&&yt(),te.enableRotate&&Nt()}function Ot(It){if(Ie.length==1)ge.set(It.pageX,It.pageY);else{const Jt=qt(It),kt=.5*(It.pageX+Jt.x),Ht=.5*(It.pageY+Jt.y);ge.set(kt,Ht)}me.subVectors(ge,he).multiplyScalar(te.rotateSpeed);const Gt=te.domElement;Gt&&(Ge(2*Math.PI*me.x/Gt.clientHeight),He(2*Math.PI*me.y/Gt.clientHeight)),he.copy(ge)}function Mt(It){if(Ie.length==1)ye.set(It.pageX,It.pageY);else{const Gt=qt(It),Jt=.5*(It.pageX+Gt.x),kt=.5*(It.pageY+Gt.y);ye.set(Jt,kt)}ve.subVectors(ye,Ae).multiplyScalar(te.panSpeed),tt(ve.x,ve.y),Ae.copy(ye)}function _t(It){const Gt=qt(It),Jt=It.pageX-Gt.x,kt=It.pageY-Gt.y,Ht=Math.sqrt(Jt*Jt+kt*kt);Te.set(0,Ht),be.set(0,Math.pow(Te.y/_e.y,te.zoomSpeed)),ot(be.y),_e.copy(Te)}function pt(It){te.enableZoom&&_t(It),te.enablePan&&Mt(It)}function ft(It){te.enableZoom&&_t(It),te.enableRotate&&Ot(It)}function st(It){var Gt,Jt;te.enabled!==!1&&(Ie.length===0&&((Gt=te.domElement)==null||Gt.ownerDocument.addEventListener("pointermove",vt),(Jt=te.domElement)==null||Jt.ownerDocument.addEventListener("pointerup",Pt)),xt(It),It.pointerType==="touch"?Be(It):Lt(It))}function vt(It){te.enabled!==!1&&(It.pointerType==="touch"?rt(It):Vt(It))}function Pt(It){var Gt,Jt,kt;Ct(It),Ie.length===0&&((Gt=te.domElement)==null||Gt.releasePointerCapture(It.pointerId),(Jt=te.domElement)==null||Jt.ownerDocument.removeEventListener("pointermove",vt),(kt=te.domElement)==null||kt.ownerDocument.removeEventListener("pointerup",Pt)),te.dispatchEvent(oe),ae=se.NONE}function Lt(It){let Gt;switch(It.button){case 0:Gt=te.mouseButtons.LEFT;break;case 1:Gt=te.mouseButtons.MIDDLE;break;case 2:Gt=te.mouseButtons.RIGHT;break;default:Gt=-1}switch(Gt){case MOUSE.DOLLY:if(te.enableZoom===!1)return;Qe(It),ae=se.DOLLY;break;case MOUSE.ROTATE:if(It.ctrlKey||It.metaKey||It.shiftKey){if(te.enablePan===!1)return;Ze(It),ae=se.PAN}else{if(te.enableRotate===!1)return;lt(It),ae=se.ROTATE}break;case MOUSE.PAN:if(It.ctrlKey||It.metaKey||It.shiftKey){if(te.enableRotate===!1)return;lt(It),ae=se.ROTATE}else{if(te.enablePan===!1)return;Ze(It),ae=se.PAN}break;default:ae=se.NONE}ae!==se.NONE&&te.dispatchEvent(ie)}function Vt(It){if(te.enabled!==!1)switch(ae){case se.ROTATE:if(te.enableRotate===!1)return;it(It);break;case se.DOLLY:if(te.enableZoom===!1)return;nt(It);break;case se.PAN:if(te.enablePan===!1)return;Tt(It);break}}function Le(It){te.enabled===!1||te.enableZoom===!1||ae!==se.NONE&&ae!==se.ROTATE||(It.preventDefault(),te.dispatchEvent(ie),St(It),te.dispatchEvent(oe))}function De(It){te.enabled===!1||te.enablePan===!1||Et(It)}function Be(It){switch(Qt(It),Ie.length){case 1:switch(te.touches.ONE){case TOUCH.ROTATE:if(te.enableRotate===!1)return;Nt(),ae=se.TOUCH_ROTATE;break;case TOUCH.PAN:if(te.enablePan===!1)return;zt(),ae=se.TOUCH_PAN;break;default:ae=se.NONE}break;case 2:switch(te.touches.TWO){case TOUCH.DOLLY_PAN:if(te.enableZoom===!1&&te.enablePan===!1)return;Ut(),ae=se.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(te.enableZoom===!1&&te.enableRotate===!1)return;bt(),ae=se.TOUCH_DOLLY_ROTATE;break;default:ae=se.NONE}break;default:ae=se.NONE}ae!==se.NONE&&te.dispatchEvent(ie)}function rt(It){switch(Qt(It),ae){case se.TOUCH_ROTATE:if(te.enableRotate===!1)return;Ot(It),te.update();break;case se.TOUCH_PAN:if(te.enablePan===!1)return;Mt(It),te.update();break;case se.TOUCH_DOLLY_PAN:if(te.enableZoom===!1&&te.enablePan===!1)return;pt(It),te.update();break;case se.TOUCH_DOLLY_ROTATE:if(te.enableZoom===!1&&te.enableRotate===!1)return;ft(It),te.update();break;default:ae=se.NONE}}function at(It){te.enabled!==!1&&It.preventDefault()}function xt(It){Ie.push(It)}function Ct(It){delete $e[It.pointerId];for(let Gt=0;Gt<Ie.length;Gt++)if(Ie[Gt].pointerId==It.pointerId){Ie.splice(Gt,1);return}}function Qt(It){let Gt=$e[It.pointerId];Gt===void 0&&(Gt=new Vector2,$e[It.pointerId]=Gt),Gt.set(It.pageX,It.pageY)}function qt(It){const Gt=It.pointerId===Ie[0].pointerId?Ie[1]:Ie[0];return $e[Gt.pointerId]}this.dollyIn=(It=ke())=>{Fe(It),te.update()},this.dollyOut=(It=ke())=>{ot(It),te.update()},this.getScale=()=>de,this.setScale=It=>{Je(It),te.update()},this.getZoomScale=()=>ke(),Z!==void 0&&this.connect(Z),this.update()}};class MapControls extends OrbitControls$1{constructor(_,Z){super(_,Z),this.screenSpacePanning=!1,this.mouseButtons.LEFT=MOUSE.PAN,this.mouseButtons.RIGHT=MOUSE.ROTATE,this.touches.ONE=TOUCH.PAN,this.touches.TWO=TOUCH.DOLLY_ROTATE}}var __defProp$8=Object.defineProperty,__defNormalProp$8=(K,_,Z)=>_ in K?__defProp$8(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$8=(K,_,Z)=>(__defNormalProp$8(K,typeof _!="symbol"?_+"":_,Z),Z);let Pass$1=class{constructor(){__publicField$8(this,"enabled",!0),__publicField$8(this,"needsSwap",!0),__publicField$8(this,"clear",!1),__publicField$8(this,"renderToScreen",!1)}setSize(_,Z){}render(_,Z,te,ne,ie){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}},FullScreenQuad$1=class{constructor(_){__publicField$8(this,"camera",new OrthographicCamera$1(-1,1,1,-1,0,1)),__publicField$8(this,"geometry",new PlaneGeometry(2,2)),__publicField$8(this,"mesh"),this.mesh=new Mesh(this.geometry,_)}get material(){return this.mesh.material}set material(_){this.mesh.material=_}dispose(){this.mesh.geometry.dispose()}render(_){_.render(this.mesh,this.camera)}};var __defProp$7=Object.defineProperty,__defNormalProp$7=(K,_,Z)=>_ in K?__defProp$7(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$7=(K,_,Z)=>(__defNormalProp$7(K,typeof _!="symbol"?_+"":_,Z),Z);class ShaderPass extends Pass$1{constructor(_,Z="tDiffuse"){super(),__publicField$7(this,"textureID"),__publicField$7(this,"uniforms"),__publicField$7(this,"material"),__publicField$7(this,"fsQuad"),this.textureID=Z,_ instanceof ShaderMaterial?(this.uniforms=_.uniforms,this.material=_):(this.uniforms=UniformsUtils.clone(_.uniforms),this.material=new ShaderMaterial({defines:Object.assign({},_.defines),uniforms:this.uniforms,vertexShader:_.vertexShader,fragmentShader:_.fragmentShader})),this.fsQuad=new FullScreenQuad$1(this.material)}render(_,Z,te){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=te.texture),this.fsQuad.material=this.material,this.renderToScreen?(_.setRenderTarget(null),this.fsQuad.render(_)):(_.setRenderTarget(Z),this.clear&&_.clear(_.autoClearColor,_.autoClearDepth,_.autoClearStencil),this.fsQuad.render(_))}dispose(){this.fsQuad.dispose(),this.material.dispose()}}const CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`
    varying vec2 vUv;

    void main() {

    	vUv = uv;
    	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`
    uniform float opacity;

    uniform sampler2D tDiffuse;

    varying vec2 vUv;

    void main() {

    	vec4 texel = texture2D( tDiffuse, vUv );
    	gl_FragColor = opacity * texel;

    }
  `};var __defProp$6=Object.defineProperty,__defNormalProp$6=(K,_,Z)=>_ in K?__defProp$6(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$6=(K,_,Z)=>(__defNormalProp$6(K,typeof _!="symbol"?_+"":_,Z),Z);let MaskPass$1=class extends Pass$1{constructor(_,Z){super(),__publicField$6(this,"scene"),__publicField$6(this,"camera"),__publicField$6(this,"inverse"),this.scene=_,this.camera=Z,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(_,Z,te){const ne=_.getContext(),ie=_.state;ie.buffers.color.setMask(!1),ie.buffers.depth.setMask(!1),ie.buffers.color.setLocked(!0),ie.buffers.depth.setLocked(!0);let oe,se;this.inverse?(oe=0,se=1):(oe=1,se=0),ie.buffers.stencil.setTest(!0),ie.buffers.stencil.setOp(ne.REPLACE,ne.REPLACE,ne.REPLACE),ie.buffers.stencil.setFunc(ne.ALWAYS,oe,4294967295),ie.buffers.stencil.setClear(se),ie.buffers.stencil.setLocked(!0),_.setRenderTarget(te),this.clear&&_.clear(),_.render(this.scene,this.camera),_.setRenderTarget(Z),this.clear&&_.clear(),_.render(this.scene,this.camera),ie.buffers.color.setLocked(!1),ie.buffers.depth.setLocked(!1),ie.buffers.stencil.setLocked(!1),ie.buffers.stencil.setFunc(ne.EQUAL,1,4294967295),ie.buffers.stencil.setOp(ne.KEEP,ne.KEEP,ne.KEEP),ie.buffers.stencil.setLocked(!0)}},ClearMaskPass$1=class extends Pass$1{constructor(){super(),this.needsSwap=!1}render(_){_.state.buffers.stencil.setLocked(!1),_.state.buffers.stencil.setTest(!1)}};var __defProp$5=Object.defineProperty,__defNormalProp$5=(K,_,Z)=>_ in K?__defProp$5(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$5=(K,_,Z)=>(__defNormalProp$5(K,typeof _!="symbol"?_+"":_,Z),Z);let EffectComposer$2=class{constructor(_,Z){if(__publicField$5(this,"renderer"),__publicField$5(this,"_pixelRatio"),__publicField$5(this,"_width"),__publicField$5(this,"_height"),__publicField$5(this,"renderTarget1"),__publicField$5(this,"renderTarget2"),__publicField$5(this,"writeBuffer"),__publicField$5(this,"readBuffer"),__publicField$5(this,"renderToScreen"),__publicField$5(this,"passes",[]),__publicField$5(this,"copyPass"),__publicField$5(this,"clock"),this.renderer=_,Z===void 0){const te={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat},ne=_.getSize(new Vector2);this._pixelRatio=_.getPixelRatio(),this._width=ne.width,this._height=ne.height,Z=new WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,te),Z.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=Z.width,this._height=Z.height;this.renderTarget1=Z,this.renderTarget2=Z.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,CopyShader===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),ShaderPass===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new ShaderPass(CopyShader),this.copyPass.material.blending=NoBlending,this.clock=new Clock}swapBuffers(){const _=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=_}addPass(_){this.passes.push(_),_.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(_,Z){this.passes.splice(Z,0,_),_.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(_){const Z=this.passes.indexOf(_);Z!==-1&&this.passes.splice(Z,1)}isLastEnabledPass(_){for(let Z=_+1;Z<this.passes.length;Z++)if(this.passes[Z].enabled)return!1;return!0}render(_){_===void 0&&(_=this.clock.getDelta());const Z=this.renderer.getRenderTarget();let te=!1;const ne=this.passes.length;for(let ie=0;ie<ne;ie++){const oe=this.passes[ie];if(oe.enabled!==!1){if(oe.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(ie),oe.render(this.renderer,this.writeBuffer,this.readBuffer,_,te),oe.needsSwap){if(te){const se=this.renderer.getContext(),ae=this.renderer.state.buffers.stencil;ae.setFunc(se.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,_),ae.setFunc(se.EQUAL,1,4294967295)}this.swapBuffers()}MaskPass$1!==void 0&&(oe instanceof MaskPass$1?te=!0:oe instanceof ClearMaskPass$1&&(te=!1))}}this.renderer.setRenderTarget(Z)}reset(_){if(_===void 0){const Z=this.renderer.getSize(new Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=Z.width,this._height=Z.height,_=this.renderTarget1.clone(),_.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=_,this.renderTarget2=_.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(_,Z){this._width=_,this._height=Z;const te=this._width*this._pixelRatio,ne=this._height*this._pixelRatio;this.renderTarget1.setSize(te,ne),this.renderTarget2.setSize(te,ne);for(let ie=0;ie<this.passes.length;ie++)this.passes[ie].setSize(te,ne)}setPixelRatio(_){this._pixelRatio=_,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}};var __defProp$4=Object.defineProperty,__defNormalProp$4=(K,_,Z)=>_ in K?__defProp$4(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$4=(K,_,Z)=>(__defNormalProp$4(K,typeof _!="symbol"?_+"":_,Z),Z);let RenderPass$1=class extends Pass$1{constructor(_,Z,te,ne,ie=0){super(),__publicField$4(this,"scene"),__publicField$4(this,"camera"),__publicField$4(this,"overrideMaterial"),__publicField$4(this,"clearColor"),__publicField$4(this,"clearAlpha"),__publicField$4(this,"clearDepth",!1),__publicField$4(this,"_oldClearColor",new Color$1),this.scene=_,this.camera=Z,this.overrideMaterial=te,this.clearColor=ne,this.clearAlpha=ie,this.clear=!0,this.needsSwap=!1}render(_,Z,te){let ne=_.autoClear;_.autoClear=!1;let ie,oe=null;this.overrideMaterial!==void 0&&(oe=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(_.getClearColor(this._oldClearColor),ie=_.getClearAlpha(),_.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&_.clearDepth(),_.setRenderTarget(this.renderToScreen?null:te),this.clear&&_.clear(_.autoClearColor,_.autoClearDepth,_.autoClearStencil),_.render(this.scene,this.camera),this.clearColor&&_.setClearColor(this._oldClearColor,ie),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=oe),_.autoClear=ne}};function decodeText$1(K){if(typeof TextDecoder<"u")return new TextDecoder().decode(K);let _="";for(let Z=0,te=K.length;Z<te;Z++)_+=String.fromCharCode(K[Z]);try{return decodeURIComponent(escape(_))}catch{return _}}const SRGBColorSpace$1="srgb",LinearSRGBColorSpace$1="srgb-linear",sRGBEncoding$1=3001,LinearEncoding$1=3e3;let GLTFLoader$1=class extends Loader{constructor(_){super(_),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(Z){return new GLTFMaterialsClearcoatExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsDispersionExtension$1(Z)}),this.register(function(Z){return new GLTFTextureBasisUExtension$1(Z)}),this.register(function(Z){return new GLTFTextureWebPExtension$1(Z)}),this.register(function(Z){return new GLTFTextureAVIFExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsSheenExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsTransmissionExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsVolumeExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsIorExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsEmissiveStrengthExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsSpecularExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsIridescenceExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsAnisotropyExtension$1(Z)}),this.register(function(Z){return new GLTFMaterialsBumpExtension$1(Z)}),this.register(function(Z){return new GLTFLightsExtension$1(Z)}),this.register(function(Z){return new GLTFMeshoptCompression$1(Z)}),this.register(function(Z){return new GLTFMeshGpuInstancing$1(Z)})}load(_,Z,te,ne){const ie=this;let oe;if(this.resourcePath!=="")oe=this.resourcePath;else if(this.path!==""){const le=LoaderUtils.extractUrlBase(_);oe=LoaderUtils.resolveURL(le,this.path)}else oe=LoaderUtils.extractUrlBase(_);this.manager.itemStart(_);const se=function(le){ne?ne(le):console.error(le),ie.manager.itemError(_),ie.manager.itemEnd(_)},ae=new FileLoader(this.manager);ae.setPath(this.path),ae.setResponseType("arraybuffer"),ae.setRequestHeader(this.requestHeader),ae.setWithCredentials(this.withCredentials),ae.load(_,function(le){try{ie.parse(le,oe,function(ce){Z(ce),ie.manager.itemEnd(_)},se)}catch(ce){se(ce)}},te,se)}setDRACOLoader(_){return this.dracoLoader=_,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_){return this.ktx2Loader=_,this}setMeshoptDecoder(_){return this.meshoptDecoder=_,this}register(_){return this.pluginCallbacks.indexOf(_)===-1&&this.pluginCallbacks.push(_),this}unregister(_){return this.pluginCallbacks.indexOf(_)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_),1),this}parse(_,Z,te,ne){let ie;const oe={},se={};if(typeof _=="string")ie=JSON.parse(_);else if(_ instanceof ArrayBuffer)if(decodeText$1(new Uint8Array(_.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC$1){try{oe[EXTENSIONS$1.KHR_BINARY_GLTF]=new GLTFBinaryExtension$1(_)}catch(ce){ne&&ne(ce);return}ie=JSON.parse(oe[EXTENSIONS$1.KHR_BINARY_GLTF].content)}else ie=JSON.parse(decodeText$1(new Uint8Array(_)));else ie=_;if(ie.asset===void 0||ie.asset.version[0]<2){ne&&ne(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ae=new GLTFParser$1(ie,{path:Z||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ae.fileLoader.setRequestHeader(this.requestHeader);for(let le=0;le<this.pluginCallbacks.length;le++){const ce=this.pluginCallbacks[le](ae);ce.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),se[ce.name]=ce,oe[ce.name]=!0}if(ie.extensionsUsed)for(let le=0;le<ie.extensionsUsed.length;++le){const ce=ie.extensionsUsed[le],fe=ie.extensionsRequired||[];switch(ce){case EXTENSIONS$1.KHR_MATERIALS_UNLIT:oe[ce]=new GLTFMaterialsUnlitExtension$1;break;case EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION:oe[ce]=new GLTFDracoMeshCompressionExtension$1(ie,this.dracoLoader);break;case EXTENSIONS$1.KHR_TEXTURE_TRANSFORM:oe[ce]=new GLTFTextureTransformExtension$1;break;case EXTENSIONS$1.KHR_MESH_QUANTIZATION:oe[ce]=new GLTFMeshQuantizationExtension$1;break;default:fe.indexOf(ce)>=0&&se[ce]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ce+'".')}}ae.setExtensions(oe),ae.setPlugins(se),ae.parse(te,ne)}parseAsync(_,Z){const te=this;return new Promise(function(ne,ie){te.parse(_,Z,ne,ie)})}};function GLTFRegistry$1(){let K={};return{get:function(_){return K[_]},add:function(_,Z){K[_]=Z},remove:function(_){delete K[_]},removeAll:function(){K={}}}}const EXTENSIONS$1={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let GLTFLightsExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _=this.parser,Z=this.parser.json.nodes||[];for(let te=0,ne=Z.length;te<ne;te++){const ie=Z[te];ie.extensions&&ie.extensions[this.name]&&ie.extensions[this.name].light!==void 0&&_._addNodeRef(this.cache,ie.extensions[this.name].light)}}_loadLight(_){const Z=this.parser,te="light:"+_;let ne=Z.cache.get(te);if(ne)return ne;const ie=Z.json,ae=((ie.extensions&&ie.extensions[this.name]||{}).lights||[])[_];let le;const ce=new Color$1(16777215);ae.color!==void 0&&ce.setRGB(ae.color[0],ae.color[1],ae.color[2],LinearSRGBColorSpace$1);const fe=ae.range!==void 0?ae.range:0;switch(ae.type){case"directional":le=new DirectionalLight$1(ce),le.target.position.set(0,0,-1),le.add(le.target);break;case"point":le=new PointLight$1(ce),le.distance=fe;break;case"spot":le=new SpotLight$2(ce),le.distance=fe,ae.spot=ae.spot||{},ae.spot.innerConeAngle=ae.spot.innerConeAngle!==void 0?ae.spot.innerConeAngle:0,ae.spot.outerConeAngle=ae.spot.outerConeAngle!==void 0?ae.spot.outerConeAngle:Math.PI/4,le.angle=ae.spot.outerConeAngle,le.penumbra=1-ae.spot.innerConeAngle/ae.spot.outerConeAngle,le.target.position.set(0,0,-1),le.add(le.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+ae.type)}return le.position.set(0,0,0),le.decay=2,assignExtrasToUserData$1(le,ae),ae.intensity!==void 0&&(le.intensity=ae.intensity),le.name=Z.createUniqueName(ae.name||"light_"+_),ne=Promise.resolve(le),Z.cache.add(te,ne),ne}getDependency(_,Z){if(_==="light")return this._loadLight(Z)}createNodeAttachment(_){const Z=this,te=this.parser,ie=te.json.nodes[_],se=(ie.extensions&&ie.extensions[this.name]||{}).light;return se===void 0?null:this._loadLight(se).then(function(ae){return te._getNodeRef(Z.cache,se,ae)})}},GLTFMaterialsUnlitExtension$1=class{constructor(){this.name=EXTENSIONS$1.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_,Z,te){const ne=[];_.color=new Color$1(1,1,1),_.opacity=1;const ie=Z.pbrMetallicRoughness;if(ie){if(Array.isArray(ie.baseColorFactor)){const oe=ie.baseColorFactor;_.color.setRGB(oe[0],oe[1],oe[2],LinearSRGBColorSpace$1),_.opacity=oe[3]}ie.baseColorTexture!==void 0&&ne.push(te.assignTexture(_,"map",ie.baseColorTexture,SRGBColorSpace$1))}return Promise.all(ne)}},GLTFMaterialsEmissiveStrengthExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_,Z){const ne=this.parser.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=ne.extensions[this.name].emissiveStrength;return ie!==void 0&&(Z.emissiveIntensity=ie),Promise.resolve()}},GLTFMaterialsClearcoatExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_CLEARCOAT}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];if(oe.clearcoatFactor!==void 0&&(Z.clearcoat=oe.clearcoatFactor),oe.clearcoatTexture!==void 0&&ie.push(te.assignTexture(Z,"clearcoatMap",oe.clearcoatTexture)),oe.clearcoatRoughnessFactor!==void 0&&(Z.clearcoatRoughness=oe.clearcoatRoughnessFactor),oe.clearcoatRoughnessTexture!==void 0&&ie.push(te.assignTexture(Z,"clearcoatRoughnessMap",oe.clearcoatRoughnessTexture)),oe.clearcoatNormalTexture!==void 0&&(ie.push(te.assignTexture(Z,"clearcoatNormalMap",oe.clearcoatNormalTexture)),oe.clearcoatNormalTexture.scale!==void 0)){const se=oe.clearcoatNormalTexture.scale;Z.clearcoatNormalScale=new Vector2(se,se)}return Promise.all(ie)}},GLTFMaterialsDispersionExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_DISPERSION}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const ne=this.parser.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=ne.extensions[this.name];return Z.dispersion=ie.dispersion!==void 0?ie.dispersion:0,Promise.resolve()}},GLTFMaterialsIridescenceExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return oe.iridescenceFactor!==void 0&&(Z.iridescence=oe.iridescenceFactor),oe.iridescenceTexture!==void 0&&ie.push(te.assignTexture(Z,"iridescenceMap",oe.iridescenceTexture)),oe.iridescenceIor!==void 0&&(Z.iridescenceIOR=oe.iridescenceIor),Z.iridescenceThicknessRange===void 0&&(Z.iridescenceThicknessRange=[100,400]),oe.iridescenceThicknessMinimum!==void 0&&(Z.iridescenceThicknessRange[0]=oe.iridescenceThicknessMinimum),oe.iridescenceThicknessMaximum!==void 0&&(Z.iridescenceThicknessRange[1]=oe.iridescenceThicknessMaximum),oe.iridescenceThicknessTexture!==void 0&&ie.push(te.assignTexture(Z,"iridescenceThicknessMap",oe.iridescenceThicknessTexture)),Promise.all(ie)}},GLTFMaterialsSheenExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_SHEEN}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[];Z.sheenColor=new Color$1(0,0,0),Z.sheenRoughness=0,Z.sheen=1;const oe=ne.extensions[this.name];if(oe.sheenColorFactor!==void 0){const se=oe.sheenColorFactor;Z.sheenColor.setRGB(se[0],se[1],se[2],LinearSRGBColorSpace$1)}return oe.sheenRoughnessFactor!==void 0&&(Z.sheenRoughness=oe.sheenRoughnessFactor),oe.sheenColorTexture!==void 0&&ie.push(te.assignTexture(Z,"sheenColorMap",oe.sheenColorTexture,SRGBColorSpace$1)),oe.sheenRoughnessTexture!==void 0&&ie.push(te.assignTexture(Z,"sheenRoughnessMap",oe.sheenRoughnessTexture)),Promise.all(ie)}},GLTFMaterialsTransmissionExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_TRANSMISSION}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return oe.transmissionFactor!==void 0&&(Z.transmission=oe.transmissionFactor),oe.transmissionTexture!==void 0&&ie.push(te.assignTexture(Z,"transmissionMap",oe.transmissionTexture)),Promise.all(ie)}},GLTFMaterialsVolumeExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_VOLUME}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];Z.thickness=oe.thicknessFactor!==void 0?oe.thicknessFactor:0,oe.thicknessTexture!==void 0&&ie.push(te.assignTexture(Z,"thicknessMap",oe.thicknessTexture)),Z.attenuationDistance=oe.attenuationDistance||1/0;const se=oe.attenuationColor||[1,1,1];return Z.attenuationColor=new Color$1().setRGB(se[0],se[1],se[2],LinearSRGBColorSpace$1),Promise.all(ie)}},GLTFMaterialsIorExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_IOR}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const ne=this.parser.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=ne.extensions[this.name];return Z.ior=ie.ior!==void 0?ie.ior:1.5,Promise.resolve()}},GLTFMaterialsSpecularExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_SPECULAR}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];Z.specularIntensity=oe.specularFactor!==void 0?oe.specularFactor:1,oe.specularTexture!==void 0&&ie.push(te.assignTexture(Z,"specularIntensityMap",oe.specularTexture));const se=oe.specularColorFactor||[1,1,1];return Z.specularColor=new Color$1().setRGB(se[0],se[1],se[2],LinearSRGBColorSpace$1),oe.specularColorTexture!==void 0&&ie.push(te.assignTexture(Z,"specularColorMap",oe.specularColorTexture,SRGBColorSpace$1)),Promise.all(ie)}},GLTFMaterialsBumpExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.EXT_MATERIALS_BUMP}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return Z.bumpScale=oe.bumpFactor!==void 0?oe.bumpFactor:1,oe.bumpTexture!==void 0&&ie.push(te.assignTexture(Z,"bumpMap",oe.bumpTexture)),Promise.all(ie)}},GLTFMaterialsAnisotropyExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_MATERIALS_ANISOTROPY}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return oe.anisotropyStrength!==void 0&&(Z.anisotropy=oe.anisotropyStrength),oe.anisotropyRotation!==void 0&&(Z.anisotropyRotation=oe.anisotropyRotation),oe.anisotropyTexture!==void 0&&ie.push(te.assignTexture(Z,"anisotropyMap",oe.anisotropyTexture)),Promise.all(ie)}},GLTFTextureBasisUExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.KHR_TEXTURE_BASISU}loadTexture(_){const Z=this.parser,te=Z.json,ne=te.textures[_];if(!ne.extensions||!ne.extensions[this.name])return null;const ie=ne.extensions[this.name],oe=Z.options.ktx2Loader;if(!oe){if(te.extensionsRequired&&te.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return Z.loadTextureImage(_,ie.source,oe)}},GLTFTextureWebPExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_){const Z=this.name,te=this.parser,ne=te.json,ie=ne.textures[_];if(!ie.extensions||!ie.extensions[Z])return null;const oe=ie.extensions[Z],se=ne.images[oe.source];let ae=te.textureLoader;if(se.uri){const le=te.options.manager.getHandler(se.uri);le!==null&&(ae=le)}return this.detectSupport().then(function(le){if(le)return te.loadTextureImage(_,oe.source,ae);if(ne.extensionsRequired&&ne.extensionsRequired.indexOf(Z)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return te.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const Z=new Image;Z.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",Z.onload=Z.onerror=function(){_(Z.height===1)}})),this.isSupported}},GLTFTextureAVIFExtension$1=class{constructor(_){this.parser=_,this.name=EXTENSIONS$1.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_){const Z=this.name,te=this.parser,ne=te.json,ie=ne.textures[_];if(!ie.extensions||!ie.extensions[Z])return null;const oe=ie.extensions[Z],se=ne.images[oe.source];let ae=te.textureLoader;if(se.uri){const le=te.options.manager.getHandler(se.uri);le!==null&&(ae=le)}return this.detectSupport().then(function(le){if(le)return te.loadTextureImage(_,oe.source,ae);if(ne.extensionsRequired&&ne.extensionsRequired.indexOf(Z)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return te.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const Z=new Image;Z.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",Z.onload=Z.onerror=function(){_(Z.height===1)}})),this.isSupported}},GLTFMeshoptCompression$1=class{constructor(_){this.name=EXTENSIONS$1.EXT_MESHOPT_COMPRESSION,this.parser=_}loadBufferView(_){const Z=this.parser.json,te=Z.bufferViews[_];if(te.extensions&&te.extensions[this.name]){const ne=te.extensions[this.name],ie=this.parser.getDependency("buffer",ne.buffer),oe=this.parser.options.meshoptDecoder;if(!oe||!oe.supported){if(Z.extensionsRequired&&Z.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return ie.then(function(se){const ae=ne.byteOffset||0,le=ne.byteLength||0,ce=ne.count,fe=ne.byteStride,de=new Uint8Array(se,ae,le);return oe.decodeGltfBufferAsync?oe.decodeGltfBufferAsync(ce,fe,de,ne.mode,ne.filter).then(function(pe){return pe.buffer}):oe.ready.then(function(){const pe=new ArrayBuffer(ce*fe);return oe.decodeGltfBuffer(new Uint8Array(pe),ce,fe,de,ne.mode,ne.filter),pe})})}else return null}},GLTFMeshGpuInstancing$1=class{constructor(_){this.name=EXTENSIONS$1.EXT_MESH_GPU_INSTANCING,this.parser=_}createNodeMesh(_){const Z=this.parser.json,te=Z.nodes[_];if(!te.extensions||!te.extensions[this.name]||te.mesh===void 0)return null;const ne=Z.meshes[te.mesh];for(const le of ne.primitives)if(le.mode!==WEBGL_CONSTANTS$1.TRIANGLES&&le.mode!==WEBGL_CONSTANTS$1.TRIANGLE_STRIP&&le.mode!==WEBGL_CONSTANTS$1.TRIANGLE_FAN&&le.mode!==void 0)return null;const oe=te.extensions[this.name].attributes,se=[],ae={};for(const le in oe)se.push(this.parser.getDependency("accessor",oe[le]).then(ce=>(ae[le]=ce,ae[le])));return se.length<1?null:(se.push(this.parser.createNodeMesh(_)),Promise.all(se).then(le=>{const ce=le.pop(),fe=ce.isGroup?ce.children:[ce],de=le[0].count,pe=[];for(const he of fe){const ge=new Matrix4,me=new Vector3,Ae=new Quaternion,ye=new Vector3(1,1,1),ve=new InstancedMesh(he.geometry,he.material,de);for(let _e=0;_e<de;_e++)ae.TRANSLATION&&me.fromBufferAttribute(ae.TRANSLATION,_e),ae.ROTATION&&Ae.fromBufferAttribute(ae.ROTATION,_e),ae.SCALE&&ye.fromBufferAttribute(ae.SCALE,_e),ve.setMatrixAt(_e,ge.compose(me,Ae,ye));for(const _e in ae)if(_e==="_COLOR_0"){const Te=ae[_e];ve.instanceColor=new InstancedBufferAttribute(Te.array,Te.itemSize,Te.normalized)}else _e!=="TRANSLATION"&&_e!=="ROTATION"&&_e!=="SCALE"&&he.geometry.setAttribute(_e,ae[_e]);Object3D.prototype.copy.call(ve,he),this.parser.assignFinalMaterial(ve),pe.push(ve)}return ce.isGroup?(ce.clear(),ce.add(...pe),ce):pe[0]}))}};const BINARY_EXTENSION_HEADER_MAGIC$1="glTF",BINARY_EXTENSION_HEADER_LENGTH$1=12,BINARY_EXTENSION_CHUNK_TYPES$1={JSON:1313821514,BIN:5130562};let GLTFBinaryExtension$1=class{constructor(_){this.name=EXTENSIONS$1.KHR_BINARY_GLTF,this.content=null,this.body=null;const Z=new DataView(_,0,BINARY_EXTENSION_HEADER_LENGTH$1);if(this.header={magic:decodeText$1(new Uint8Array(_.slice(0,4))),version:Z.getUint32(4,!0),length:Z.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC$1)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const te=this.header.length-BINARY_EXTENSION_HEADER_LENGTH$1,ne=new DataView(_,BINARY_EXTENSION_HEADER_LENGTH$1);let ie=0;for(;ie<te;){const oe=ne.getUint32(ie,!0);ie+=4;const se=ne.getUint32(ie,!0);if(ie+=4,se===BINARY_EXTENSION_CHUNK_TYPES$1.JSON){const ae=new Uint8Array(_,BINARY_EXTENSION_HEADER_LENGTH$1+ie,oe);this.content=decodeText$1(ae)}else if(se===BINARY_EXTENSION_CHUNK_TYPES$1.BIN){const ae=BINARY_EXTENSION_HEADER_LENGTH$1+ie;this.body=_.slice(ae,ae+oe)}ie+=oe}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},GLTFDracoMeshCompressionExtension$1=class{constructor(_,Z){if(!Z)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION,this.json=_,this.dracoLoader=Z,this.dracoLoader.preload()}decodePrimitive(_,Z){const te=this.json,ne=this.dracoLoader,ie=_.extensions[this.name].bufferView,oe=_.extensions[this.name].attributes,se={},ae={},le={};for(const ce in oe){const fe=ATTRIBUTES$1[ce]||ce.toLowerCase();se[fe]=oe[ce]}for(const ce in _.attributes){const fe=ATTRIBUTES$1[ce]||ce.toLowerCase();if(oe[ce]!==void 0){const de=te.accessors[_.attributes[ce]],pe=WEBGL_COMPONENT_TYPES$1[de.componentType];le[fe]=pe.name,ae[fe]=de.normalized===!0}}return Z.getDependency("bufferView",ie).then(function(ce){return new Promise(function(fe,de){ne.decodeDracoFile(ce,function(pe){for(const he in pe.attributes){const ge=pe.attributes[he],me=ae[he];me!==void 0&&(ge.normalized=me)}fe(pe)},se,le,LinearSRGBColorSpace$1,de)})})}},GLTFTextureTransformExtension$1=class{constructor(){this.name=EXTENSIONS$1.KHR_TEXTURE_TRANSFORM}extendTexture(_,Z){return(Z.texCoord===void 0||Z.texCoord===_.channel)&&Z.offset===void 0&&Z.rotation===void 0&&Z.scale===void 0||(_=_.clone(),Z.texCoord!==void 0&&(_.channel=Z.texCoord),Z.offset!==void 0&&_.offset.fromArray(Z.offset),Z.rotation!==void 0&&(_.rotation=Z.rotation),Z.scale!==void 0&&_.repeat.fromArray(Z.scale),_.needsUpdate=!0),_}},GLTFMeshQuantizationExtension$1=class{constructor(){this.name=EXTENSIONS$1.KHR_MESH_QUANTIZATION}},GLTFCubicSplineInterpolant$1=class extends Interpolant{constructor(_,Z,te,ne){super(_,Z,te,ne)}copySampleValue_(_){const Z=this.resultBuffer,te=this.sampleValues,ne=this.valueSize,ie=_*ne*3+ne;for(let oe=0;oe!==ne;oe++)Z[oe]=te[ie+oe];return Z}interpolate_(_,Z,te,ne){const ie=this.resultBuffer,oe=this.sampleValues,se=this.valueSize,ae=se*2,le=se*3,ce=ne-Z,fe=(te-Z)/ce,de=fe*fe,pe=de*fe,he=_*le,ge=he-le,me=-2*pe+3*de,Ae=pe-de,ye=1-me,ve=Ae-de+fe;for(let _e=0;_e!==se;_e++){const Te=oe[ge+_e+se],be=oe[ge+_e+ae]*ce,Re=oe[he+_e+se],we=oe[he+_e]*ce;ie[_e]=ye*Te+ve*be+me*Re+Ae*we}return ie}};const _q$1=new Quaternion;let GLTFCubicSplineQuaternionInterpolant$1=class extends GLTFCubicSplineInterpolant$1{interpolate_(_,Z,te,ne){const ie=super.interpolate_(_,Z,te,ne);return _q$1.fromArray(ie).normalize().toArray(ie),ie}};const WEBGL_CONSTANTS$1={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},WEBGL_COMPONENT_TYPES$1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS$1={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS$1={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES$1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES$1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...version$4>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES$1={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION$1={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES$1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial$1(K){return K.DefaultMaterial===void 0&&(K.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),K.DefaultMaterial}function addUnknownExtensionsToUserData$1(K,_,Z){for(const te in Z.extensions)K[te]===void 0&&(_.userData.gltfExtensions=_.userData.gltfExtensions||{},_.userData.gltfExtensions[te]=Z.extensions[te])}function assignExtrasToUserData$1(K,_){_.extras!==void 0&&(typeof _.extras=="object"?Object.assign(K.userData,_.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_.extras))}function addMorphTargets$1(K,_,Z){let te=!1,ne=!1,ie=!1;for(let le=0,ce=_.length;le<ce;le++){const fe=_[le];if(fe.POSITION!==void 0&&(te=!0),fe.NORMAL!==void 0&&(ne=!0),fe.COLOR_0!==void 0&&(ie=!0),te&&ne&&ie)break}if(!te&&!ne&&!ie)return Promise.resolve(K);const oe=[],se=[],ae=[];for(let le=0,ce=_.length;le<ce;le++){const fe=_[le];if(te){const de=fe.POSITION!==void 0?Z.getDependency("accessor",fe.POSITION):K.attributes.position;oe.push(de)}if(ne){const de=fe.NORMAL!==void 0?Z.getDependency("accessor",fe.NORMAL):K.attributes.normal;se.push(de)}if(ie){const de=fe.COLOR_0!==void 0?Z.getDependency("accessor",fe.COLOR_0):K.attributes.color;ae.push(de)}}return Promise.all([Promise.all(oe),Promise.all(se),Promise.all(ae)]).then(function(le){const ce=le[0],fe=le[1],de=le[2];return te&&(K.morphAttributes.position=ce),ne&&(K.morphAttributes.normal=fe),ie&&(K.morphAttributes.color=de),K.morphTargetsRelative=!0,K})}function updateMorphTargets$1(K,_){if(K.updateMorphTargets(),_.weights!==void 0)for(let Z=0,te=_.weights.length;Z<te;Z++)K.morphTargetInfluences[Z]=_.weights[Z];if(_.extras&&Array.isArray(_.extras.targetNames)){const Z=_.extras.targetNames;if(K.morphTargetInfluences.length===Z.length){K.morphTargetDictionary={};for(let te=0,ne=Z.length;te<ne;te++)K.morphTargetDictionary[Z[te]]=te}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey$1(K){let _;const Z=K.extensions&&K.extensions[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION];if(Z?_="draco:"+Z.bufferView+":"+Z.indices+":"+createAttributesKey$1(Z.attributes):_=K.indices+":"+createAttributesKey$1(K.attributes)+":"+K.mode,K.targets!==void 0)for(let te=0,ne=K.targets.length;te<ne;te++)_+=":"+createAttributesKey$1(K.targets[te]);return _}function createAttributesKey$1(K){let _="";const Z=Object.keys(K).sort();for(let te=0,ne=Z.length;te<ne;te++)_+=Z[te]+":"+K[Z[te]]+";";return _}function getNormalizedComponentScale$1(K){switch(K){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType$1(K){return K.search(/\.jpe?g($|\?)/i)>0||K.search(/^data\:image\/jpeg/)===0?"image/jpeg":K.search(/\.webp($|\?)/i)>0||K.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix$1=new Matrix4;let GLTFParser$1=class{constructor(_={},Z={}){this.json=_,this.extensions={},this.plugins={},this.options=Z,this.cache=new GLTFRegistry$1,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let te=!1,ne=!1,ie=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(te=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,ne=navigator.userAgent.indexOf("Firefox")>-1,ie=ne?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||te||ne&&ie<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_){this.extensions=_}setPlugins(_){this.plugins=_}parse(_,Z){const te=this,ne=this.json,ie=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(oe){return oe._markDefs&&oe._markDefs()}),Promise.all(this._invokeAll(function(oe){return oe.beforeRoot&&oe.beforeRoot()})).then(function(){return Promise.all([te.getDependencies("scene"),te.getDependencies("animation"),te.getDependencies("camera")])}).then(function(oe){const se={scene:oe[0][ne.scene||0],scenes:oe[0],animations:oe[1],cameras:oe[2],asset:ne.asset,parser:te,userData:{}};return addUnknownExtensionsToUserData$1(ie,se,ne),assignExtrasToUserData$1(se,ne),Promise.all(te._invokeAll(function(ae){return ae.afterRoot&&ae.afterRoot(se)})).then(function(){for(const ae of se.scenes)ae.updateMatrixWorld();_(se)})}).catch(Z)}_markDefs(){const _=this.json.nodes||[],Z=this.json.skins||[],te=this.json.meshes||[];for(let ne=0,ie=Z.length;ne<ie;ne++){const oe=Z[ne].joints;for(let se=0,ae=oe.length;se<ae;se++)_[oe[se]].isBone=!0}for(let ne=0,ie=_.length;ne<ie;ne++){const oe=_[ne];oe.mesh!==void 0&&(this._addNodeRef(this.meshCache,oe.mesh),oe.skin!==void 0&&(te[oe.mesh].isSkinnedMesh=!0)),oe.camera!==void 0&&this._addNodeRef(this.cameraCache,oe.camera)}}_addNodeRef(_,Z){Z!==void 0&&(_.refs[Z]===void 0&&(_.refs[Z]=_.uses[Z]=0),_.refs[Z]++)}_getNodeRef(_,Z,te){if(_.refs[Z]<=1)return te;const ne=te.clone(),ie=(oe,se)=>{const ae=this.associations.get(oe);ae!=null&&this.associations.set(se,ae);for(const[le,ce]of oe.children.entries())ie(ce,se.children[le])};return ie(te,ne),ne.name+="_instance_"+_.uses[Z]++,ne}_invokeOne(_){const Z=Object.values(this.plugins);Z.push(this);for(let te=0;te<Z.length;te++){const ne=_(Z[te]);if(ne)return ne}return null}_invokeAll(_){const Z=Object.values(this.plugins);Z.unshift(this);const te=[];for(let ne=0;ne<Z.length;ne++){const ie=_(Z[ne]);ie&&te.push(ie)}return te}getDependency(_,Z){const te=_+":"+Z;let ne=this.cache.get(te);if(!ne){switch(_){case"scene":ne=this.loadScene(Z);break;case"node":ne=this._invokeOne(function(ie){return ie.loadNode&&ie.loadNode(Z)});break;case"mesh":ne=this._invokeOne(function(ie){return ie.loadMesh&&ie.loadMesh(Z)});break;case"accessor":ne=this.loadAccessor(Z);break;case"bufferView":ne=this._invokeOne(function(ie){return ie.loadBufferView&&ie.loadBufferView(Z)});break;case"buffer":ne=this.loadBuffer(Z);break;case"material":ne=this._invokeOne(function(ie){return ie.loadMaterial&&ie.loadMaterial(Z)});break;case"texture":ne=this._invokeOne(function(ie){return ie.loadTexture&&ie.loadTexture(Z)});break;case"skin":ne=this.loadSkin(Z);break;case"animation":ne=this._invokeOne(function(ie){return ie.loadAnimation&&ie.loadAnimation(Z)});break;case"camera":ne=this.loadCamera(Z);break;default:if(ne=this._invokeOne(function(ie){return ie!=this&&ie.getDependency&&ie.getDependency(_,Z)}),!ne)throw new Error("Unknown type: "+_);break}this.cache.add(te,ne)}return ne}getDependencies(_){let Z=this.cache.get(_);if(!Z){const te=this,ne=this.json[_+(_==="mesh"?"es":"s")]||[];Z=Promise.all(ne.map(function(ie,oe){return te.getDependency(_,oe)})),this.cache.add(_,Z)}return Z}loadBuffer(_){const Z=this.json.buffers[_],te=this.fileLoader;if(Z.type&&Z.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+Z.type+" buffer type is not supported.");if(Z.uri===void 0&&_===0)return Promise.resolve(this.extensions[EXTENSIONS$1.KHR_BINARY_GLTF].body);const ne=this.options;return new Promise(function(ie,oe){te.load(LoaderUtils.resolveURL(Z.uri,ne.path),ie,void 0,function(){oe(new Error('THREE.GLTFLoader: Failed to load buffer "'+Z.uri+'".'))})})}loadBufferView(_){const Z=this.json.bufferViews[_];return this.getDependency("buffer",Z.buffer).then(function(te){const ne=Z.byteLength||0,ie=Z.byteOffset||0;return te.slice(ie,ie+ne)})}loadAccessor(_){const Z=this,te=this.json,ne=this.json.accessors[_];if(ne.bufferView===void 0&&ne.sparse===void 0){const oe=WEBGL_TYPE_SIZES$1[ne.type],se=WEBGL_COMPONENT_TYPES$1[ne.componentType],ae=ne.normalized===!0,le=new se(ne.count*oe);return Promise.resolve(new BufferAttribute(le,oe,ae))}const ie=[];return ne.bufferView!==void 0?ie.push(this.getDependency("bufferView",ne.bufferView)):ie.push(null),ne.sparse!==void 0&&(ie.push(this.getDependency("bufferView",ne.sparse.indices.bufferView)),ie.push(this.getDependency("bufferView",ne.sparse.values.bufferView))),Promise.all(ie).then(function(oe){const se=oe[0],ae=WEBGL_TYPE_SIZES$1[ne.type],le=WEBGL_COMPONENT_TYPES$1[ne.componentType],ce=le.BYTES_PER_ELEMENT,fe=ce*ae,de=ne.byteOffset||0,pe=ne.bufferView!==void 0?te.bufferViews[ne.bufferView].byteStride:void 0,he=ne.normalized===!0;let ge,me;if(pe&&pe!==fe){const Ae=Math.floor(de/pe),ye="InterleavedBuffer:"+ne.bufferView+":"+ne.componentType+":"+Ae+":"+ne.count;let ve=Z.cache.get(ye);ve||(ge=new le(se,Ae*pe,ne.count*pe/ce),ve=new InterleavedBuffer(ge,pe/ce),Z.cache.add(ye,ve)),me=new InterleavedBufferAttribute(ve,ae,de%pe/ce,he)}else se===null?ge=new le(ne.count*ae):ge=new le(se,de,ne.count*ae),me=new BufferAttribute(ge,ae,he);if(ne.sparse!==void 0){const Ae=WEBGL_TYPE_SIZES$1.SCALAR,ye=WEBGL_COMPONENT_TYPES$1[ne.sparse.indices.componentType],ve=ne.sparse.indices.byteOffset||0,_e=ne.sparse.values.byteOffset||0,Te=new ye(oe[1],ve,ne.sparse.count*Ae),be=new le(oe[2],_e,ne.sparse.count*ae);se!==null&&(me=new BufferAttribute(me.array.slice(),me.itemSize,me.normalized));for(let Re=0,we=Te.length;Re<we;Re++){const Pe=Te[Re];if(me.setX(Pe,be[Re*ae]),ae>=2&&me.setY(Pe,be[Re*ae+1]),ae>=3&&me.setZ(Pe,be[Re*ae+2]),ae>=4&&me.setW(Pe,be[Re*ae+3]),ae>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return me})}loadTexture(_){const Z=this.json,te=this.options,ie=Z.textures[_].source,oe=Z.images[ie];let se=this.textureLoader;if(oe.uri){const ae=te.manager.getHandler(oe.uri);ae!==null&&(se=ae)}return this.loadTextureImage(_,ie,se)}loadTextureImage(_,Z,te){const ne=this,ie=this.json,oe=ie.textures[_],se=ie.images[Z],ae=(se.uri||se.bufferView)+":"+oe.sampler;if(this.textureCache[ae])return this.textureCache[ae];const le=this.loadImageSource(Z,te).then(function(ce){ce.flipY=!1,ce.name=oe.name||se.name||"",ce.name===""&&typeof se.uri=="string"&&se.uri.startsWith("data:image/")===!1&&(ce.name=se.uri);const de=(ie.samplers||{})[oe.sampler]||{};return ce.magFilter=WEBGL_FILTERS$1[de.magFilter]||LinearFilter,ce.minFilter=WEBGL_FILTERS$1[de.minFilter]||LinearMipmapLinearFilter,ce.wrapS=WEBGL_WRAPPINGS$1[de.wrapS]||RepeatWrapping,ce.wrapT=WEBGL_WRAPPINGS$1[de.wrapT]||RepeatWrapping,ne.associations.set(ce,{textures:_}),ce}).catch(function(){return null});return this.textureCache[ae]=le,le}loadImageSource(_,Z){const te=this,ne=this.json,ie=this.options;if(this.sourceCache[_]!==void 0)return this.sourceCache[_].then(fe=>fe.clone());const oe=ne.images[_],se=self.URL||self.webkitURL;let ae=oe.uri||"",le=!1;if(oe.bufferView!==void 0)ae=te.getDependency("bufferView",oe.bufferView).then(function(fe){le=!0;const de=new Blob([fe],{type:oe.mimeType});return ae=se.createObjectURL(de),ae});else if(oe.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_+" is missing URI and bufferView");const ce=Promise.resolve(ae).then(function(fe){return new Promise(function(de,pe){let he=de;Z.isImageBitmapLoader===!0&&(he=function(ge){const me=new Texture$1(ge);me.needsUpdate=!0,de(me)}),Z.load(LoaderUtils.resolveURL(fe,ie.path),he,void 0,pe)})}).then(function(fe){return le===!0&&se.revokeObjectURL(ae),assignExtrasToUserData$1(fe,oe),fe.userData.mimeType=oe.mimeType||getImageURIMimeType$1(oe.uri),fe}).catch(function(fe){throw console.error("THREE.GLTFLoader: Couldn't load texture",ae),fe});return this.sourceCache[_]=ce,ce}assignTexture(_,Z,te,ne){const ie=this;return this.getDependency("texture",te.index).then(function(oe){if(!oe)return null;if(te.texCoord!==void 0&&te.texCoord>0&&(oe=oe.clone(),oe.channel=te.texCoord),ie.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM]){const se=te.extensions!==void 0?te.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM]:void 0;if(se){const ae=ie.associations.get(oe);oe=ie.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM].extendTexture(oe,se),ie.associations.set(oe,ae)}}return ne!==void 0&&(typeof ne=="number"&&(ne=ne===sRGBEncoding$1?SRGBColorSpace$1:LinearSRGBColorSpace$1),"colorSpace"in oe?oe.colorSpace=ne:oe.encoding=ne===SRGBColorSpace$1?sRGBEncoding$1:LinearEncoding$1),_[Z]=oe,oe})}assignFinalMaterial(_){const Z=_.geometry;let te=_.material;const ne=Z.attributes.tangent===void 0,ie=Z.attributes.color!==void 0,oe=Z.attributes.normal===void 0;if(_.isPoints){const se="PointsMaterial:"+te.uuid;let ae=this.cache.get(se);ae||(ae=new PointsMaterial,Material.prototype.copy.call(ae,te),ae.color.copy(te.color),ae.map=te.map,ae.sizeAttenuation=!1,this.cache.add(se,ae)),te=ae}else if(_.isLine){const se="LineBasicMaterial:"+te.uuid;let ae=this.cache.get(se);ae||(ae=new LineBasicMaterial,Material.prototype.copy.call(ae,te),ae.color.copy(te.color),ae.map=te.map,this.cache.add(se,ae)),te=ae}if(ne||ie||oe){let se="ClonedMaterial:"+te.uuid+":";ne&&(se+="derivative-tangents:"),ie&&(se+="vertex-colors:"),oe&&(se+="flat-shading:");let ae=this.cache.get(se);ae||(ae=te.clone(),ie&&(ae.vertexColors=!0),oe&&(ae.flatShading=!0),ne&&(ae.normalScale&&(ae.normalScale.y*=-1),ae.clearcoatNormalScale&&(ae.clearcoatNormalScale.y*=-1)),this.cache.add(se,ae),this.associations.set(ae,this.associations.get(te))),te=ae}_.material=te}getMaterialType(){return MeshStandardMaterial}loadMaterial(_){const Z=this,te=this.json,ne=this.extensions,ie=te.materials[_];let oe;const se={},ae=ie.extensions||{},le=[];if(ae[EXTENSIONS$1.KHR_MATERIALS_UNLIT]){const fe=ne[EXTENSIONS$1.KHR_MATERIALS_UNLIT];oe=fe.getMaterialType(),le.push(fe.extendParams(se,ie,Z))}else{const fe=ie.pbrMetallicRoughness||{};if(se.color=new Color$1(1,1,1),se.opacity=1,Array.isArray(fe.baseColorFactor)){const de=fe.baseColorFactor;se.color.setRGB(de[0],de[1],de[2],LinearSRGBColorSpace$1),se.opacity=de[3]}fe.baseColorTexture!==void 0&&le.push(Z.assignTexture(se,"map",fe.baseColorTexture,SRGBColorSpace$1)),se.metalness=fe.metallicFactor!==void 0?fe.metallicFactor:1,se.roughness=fe.roughnessFactor!==void 0?fe.roughnessFactor:1,fe.metallicRoughnessTexture!==void 0&&(le.push(Z.assignTexture(se,"metalnessMap",fe.metallicRoughnessTexture)),le.push(Z.assignTexture(se,"roughnessMap",fe.metallicRoughnessTexture))),oe=this._invokeOne(function(de){return de.getMaterialType&&de.getMaterialType(_)}),le.push(Promise.all(this._invokeAll(function(de){return de.extendMaterialParams&&de.extendMaterialParams(_,se)})))}ie.doubleSided===!0&&(se.side=DoubleSide);const ce=ie.alphaMode||ALPHA_MODES$1.OPAQUE;if(ce===ALPHA_MODES$1.BLEND?(se.transparent=!0,se.depthWrite=!1):(se.transparent=!1,ce===ALPHA_MODES$1.MASK&&(se.alphaTest=ie.alphaCutoff!==void 0?ie.alphaCutoff:.5)),ie.normalTexture!==void 0&&oe!==MeshBasicMaterial&&(le.push(Z.assignTexture(se,"normalMap",ie.normalTexture)),se.normalScale=new Vector2(1,1),ie.normalTexture.scale!==void 0)){const fe=ie.normalTexture.scale;se.normalScale.set(fe,fe)}if(ie.occlusionTexture!==void 0&&oe!==MeshBasicMaterial&&(le.push(Z.assignTexture(se,"aoMap",ie.occlusionTexture)),ie.occlusionTexture.strength!==void 0&&(se.aoMapIntensity=ie.occlusionTexture.strength)),ie.emissiveFactor!==void 0&&oe!==MeshBasicMaterial){const fe=ie.emissiveFactor;se.emissive=new Color$1().setRGB(fe[0],fe[1],fe[2],LinearSRGBColorSpace$1)}return ie.emissiveTexture!==void 0&&oe!==MeshBasicMaterial&&le.push(Z.assignTexture(se,"emissiveMap",ie.emissiveTexture,SRGBColorSpace$1)),Promise.all(le).then(function(){const fe=new oe(se);return ie.name&&(fe.name=ie.name),assignExtrasToUserData$1(fe,ie),Z.associations.set(fe,{materials:_}),ie.extensions&&addUnknownExtensionsToUserData$1(ne,fe,ie),fe})}createUniqueName(_){const Z=PropertyBinding.sanitizeNodeName(_||"");return Z in this.nodeNamesUsed?Z+"_"+ ++this.nodeNamesUsed[Z]:(this.nodeNamesUsed[Z]=0,Z)}loadGeometries(_){const Z=this,te=this.extensions,ne=this.primitiveCache;function ie(se){return te[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(se,Z).then(function(ae){return addPrimitiveAttributes$1(ae,se,Z)})}const oe=[];for(let se=0,ae=_.length;se<ae;se++){const le=_[se],ce=createPrimitiveKey$1(le),fe=ne[ce];if(fe)oe.push(fe.promise);else{let de;le.extensions&&le.extensions[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION]?de=ie(le):de=addPrimitiveAttributes$1(new BufferGeometry,le,Z),ne[ce]={primitive:le,promise:de},oe.push(de)}}return Promise.all(oe)}loadMesh(_){const Z=this,te=this.json,ne=this.extensions,ie=te.meshes[_],oe=ie.primitives,se=[];for(let ae=0,le=oe.length;ae<le;ae++){const ce=oe[ae].material===void 0?createDefaultMaterial$1(this.cache):this.getDependency("material",oe[ae].material);se.push(ce)}return se.push(Z.loadGeometries(oe)),Promise.all(se).then(function(ae){const le=ae.slice(0,ae.length-1),ce=ae[ae.length-1],fe=[];for(let pe=0,he=ce.length;pe<he;pe++){const ge=ce[pe],me=oe[pe];let Ae;const ye=le[pe];if(me.mode===WEBGL_CONSTANTS$1.TRIANGLES||me.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP||me.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN||me.mode===void 0)Ae=ie.isSkinnedMesh===!0?new SkinnedMesh(ge,ye):new Mesh(ge,ye),Ae.isSkinnedMesh===!0&&Ae.normalizeSkinWeights(),me.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP?Ae.geometry=toTrianglesDrawMode$1(Ae.geometry,TriangleStripDrawMode):me.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN&&(Ae.geometry=toTrianglesDrawMode$1(Ae.geometry,TriangleFanDrawMode));else if(me.mode===WEBGL_CONSTANTS$1.LINES)Ae=new LineSegments(ge,ye);else if(me.mode===WEBGL_CONSTANTS$1.LINE_STRIP)Ae=new Line$2(ge,ye);else if(me.mode===WEBGL_CONSTANTS$1.LINE_LOOP)Ae=new LineLoop(ge,ye);else if(me.mode===WEBGL_CONSTANTS$1.POINTS)Ae=new Points$1(ge,ye);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+me.mode);Object.keys(Ae.geometry.morphAttributes).length>0&&updateMorphTargets$1(Ae,ie),Ae.name=Z.createUniqueName(ie.name||"mesh_"+_),assignExtrasToUserData$1(Ae,ie),me.extensions&&addUnknownExtensionsToUserData$1(ne,Ae,me),Z.assignFinalMaterial(Ae),fe.push(Ae)}for(let pe=0,he=fe.length;pe<he;pe++)Z.associations.set(fe[pe],{meshes:_,primitives:pe});if(fe.length===1)return ie.extensions&&addUnknownExtensionsToUserData$1(ne,fe[0],ie),fe[0];const de=new Group;ie.extensions&&addUnknownExtensionsToUserData$1(ne,de,ie),Z.associations.set(de,{meshes:_});for(let pe=0,he=fe.length;pe<he;pe++)de.add(fe[pe]);return de})}loadCamera(_){let Z;const te=this.json.cameras[_],ne=te[te.type];if(!ne){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return te.type==="perspective"?Z=new PerspectiveCamera$2(MathUtils.radToDeg(ne.yfov),ne.aspectRatio||1,ne.znear||1,ne.zfar||2e6):te.type==="orthographic"&&(Z=new OrthographicCamera$1(-ne.xmag,ne.xmag,ne.ymag,-ne.ymag,ne.znear,ne.zfar)),te.name&&(Z.name=this.createUniqueName(te.name)),assignExtrasToUserData$1(Z,te),Promise.resolve(Z)}loadSkin(_){const Z=this.json.skins[_],te=[];for(let ne=0,ie=Z.joints.length;ne<ie;ne++)te.push(this._loadNodeShallow(Z.joints[ne]));return Z.inverseBindMatrices!==void 0?te.push(this.getDependency("accessor",Z.inverseBindMatrices)):te.push(null),Promise.all(te).then(function(ne){const ie=ne.pop(),oe=ne,se=[],ae=[];for(let le=0,ce=oe.length;le<ce;le++){const fe=oe[le];if(fe){se.push(fe);const de=new Matrix4;ie!==null&&de.fromArray(ie.array,le*16),ae.push(de)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Z.joints[le])}return new Skeleton(se,ae)})}loadAnimation(_){const Z=this.json,te=this,ne=Z.animations[_],ie=ne.name?ne.name:"animation_"+_,oe=[],se=[],ae=[],le=[],ce=[];for(let fe=0,de=ne.channels.length;fe<de;fe++){const pe=ne.channels[fe],he=ne.samplers[pe.sampler],ge=pe.target,me=ge.node,Ae=ne.parameters!==void 0?ne.parameters[he.input]:he.input,ye=ne.parameters!==void 0?ne.parameters[he.output]:he.output;ge.node!==void 0&&(oe.push(this.getDependency("node",me)),se.push(this.getDependency("accessor",Ae)),ae.push(this.getDependency("accessor",ye)),le.push(he),ce.push(ge))}return Promise.all([Promise.all(oe),Promise.all(se),Promise.all(ae),Promise.all(le),Promise.all(ce)]).then(function(fe){const de=fe[0],pe=fe[1],he=fe[2],ge=fe[3],me=fe[4],Ae=[];for(let ye=0,ve=de.length;ye<ve;ye++){const _e=de[ye],Te=pe[ye],be=he[ye],Re=ge[ye],we=me[ye];if(_e===void 0)continue;_e.updateMatrix&&_e.updateMatrix();const Pe=te._createAnimationTracks(_e,Te,be,Re,we);if(Pe)for(let Ie=0;Ie<Pe.length;Ie++)Ae.push(Pe[Ie])}return new AnimationClip(ie,void 0,Ae)})}createNodeMesh(_){const Z=this.json,te=this,ne=Z.nodes[_];return ne.mesh===void 0?null:te.getDependency("mesh",ne.mesh).then(function(ie){const oe=te._getNodeRef(te.meshCache,ne.mesh,ie);return ne.weights!==void 0&&oe.traverse(function(se){if(se.isMesh)for(let ae=0,le=ne.weights.length;ae<le;ae++)se.morphTargetInfluences[ae]=ne.weights[ae]}),oe})}loadNode(_){const Z=this.json,te=this,ne=Z.nodes[_],ie=te._loadNodeShallow(_),oe=[],se=ne.children||[];for(let le=0,ce=se.length;le<ce;le++)oe.push(te.getDependency("node",se[le]));const ae=ne.skin===void 0?Promise.resolve(null):te.getDependency("skin",ne.skin);return Promise.all([ie,Promise.all(oe),ae]).then(function(le){const ce=le[0],fe=le[1],de=le[2];de!==null&&ce.traverse(function(pe){pe.isSkinnedMesh&&pe.bind(de,_identityMatrix$1)});for(let pe=0,he=fe.length;pe<he;pe++)ce.add(fe[pe]);return ce})}_loadNodeShallow(_){const Z=this.json,te=this.extensions,ne=this;if(this.nodeCache[_]!==void 0)return this.nodeCache[_];const ie=Z.nodes[_],oe=ie.name?ne.createUniqueName(ie.name):"",se=[],ae=ne._invokeOne(function(le){return le.createNodeMesh&&le.createNodeMesh(_)});return ae&&se.push(ae),ie.camera!==void 0&&se.push(ne.getDependency("camera",ie.camera).then(function(le){return ne._getNodeRef(ne.cameraCache,ie.camera,le)})),ne._invokeAll(function(le){return le.createNodeAttachment&&le.createNodeAttachment(_)}).forEach(function(le){se.push(le)}),this.nodeCache[_]=Promise.all(se).then(function(le){let ce;if(ie.isBone===!0?ce=new Bone:le.length>1?ce=new Group:le.length===1?ce=le[0]:ce=new Object3D,ce!==le[0])for(let fe=0,de=le.length;fe<de;fe++)ce.add(le[fe]);if(ie.name&&(ce.userData.name=ie.name,ce.name=oe),assignExtrasToUserData$1(ce,ie),ie.extensions&&addUnknownExtensionsToUserData$1(te,ce,ie),ie.matrix!==void 0){const fe=new Matrix4;fe.fromArray(ie.matrix),ce.applyMatrix4(fe)}else ie.translation!==void 0&&ce.position.fromArray(ie.translation),ie.rotation!==void 0&&ce.quaternion.fromArray(ie.rotation),ie.scale!==void 0&&ce.scale.fromArray(ie.scale);return ne.associations.has(ce)||ne.associations.set(ce,{}),ne.associations.get(ce).nodes=_,ce}),this.nodeCache[_]}loadScene(_){const Z=this.extensions,te=this.json.scenes[_],ne=this,ie=new Group;te.name&&(ie.name=ne.createUniqueName(te.name)),assignExtrasToUserData$1(ie,te),te.extensions&&addUnknownExtensionsToUserData$1(Z,ie,te);const oe=te.nodes||[],se=[];for(let ae=0,le=oe.length;ae<le;ae++)se.push(ne.getDependency("node",oe[ae]));return Promise.all(se).then(function(ae){for(let ce=0,fe=ae.length;ce<fe;ce++)ie.add(ae[ce]);const le=ce=>{const fe=new Map;for(const[de,pe]of ne.associations)(de instanceof Material||de instanceof Texture$1)&&fe.set(de,pe);return ce.traverse(de=>{const pe=ne.associations.get(de);pe!=null&&fe.set(de,pe)}),fe};return ne.associations=le(ie),ie})}_createAnimationTracks(_,Z,te,ne,ie){const oe=[],se=_.name?_.name:_.uuid,ae=[];PATH_PROPERTIES$1[ie.path]===PATH_PROPERTIES$1.weights?_.traverse(function(de){de.morphTargetInfluences&&ae.push(de.name?de.name:de.uuid)}):ae.push(se);let le;switch(PATH_PROPERTIES$1[ie.path]){case PATH_PROPERTIES$1.weights:le=NumberKeyframeTrack;break;case PATH_PROPERTIES$1.rotation:le=QuaternionKeyframeTrack;break;case PATH_PROPERTIES$1.position:case PATH_PROPERTIES$1.scale:le=VectorKeyframeTrack;break;default:switch(te.itemSize){case 1:le=NumberKeyframeTrack;break;case 2:case 3:default:le=VectorKeyframeTrack;break}break}const ce=ne.interpolation!==void 0?INTERPOLATION$1[ne.interpolation]:InterpolateLinear,fe=this._getArrayFromAccessor(te);for(let de=0,pe=ae.length;de<pe;de++){const he=new le(ae[de]+"."+PATH_PROPERTIES$1[ie.path],Z.array,fe,ce);ne.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(he),oe.push(he)}return oe}_getArrayFromAccessor(_){let Z=_.array;if(_.normalized){const te=getNormalizedComponentScale$1(Z.constructor),ne=new Float32Array(Z.length);for(let ie=0,oe=Z.length;ie<oe;ie++)ne[ie]=Z[ie]*te;Z=ne}return Z}_createCubicSplineTrackInterpolant(_){_.createInterpolant=function(te){const ne=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant$1:GLTFCubicSplineInterpolant$1;return new ne(this.times,this.values,this.getValueSize()/3,te)},_.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function computeBounds$1(K,_,Z){const te=_.attributes,ne=new Box3;if(te.POSITION!==void 0){const se=Z.json.accessors[te.POSITION],ae=se.min,le=se.max;if(ae!==void 0&&le!==void 0){if(ne.set(new Vector3(ae[0],ae[1],ae[2]),new Vector3(le[0],le[1],le[2])),se.normalized){const ce=getNormalizedComponentScale$1(WEBGL_COMPONENT_TYPES$1[se.componentType]);ne.min.multiplyScalar(ce),ne.max.multiplyScalar(ce)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const ie=_.targets;if(ie!==void 0){const se=new Vector3,ae=new Vector3;for(let le=0,ce=ie.length;le<ce;le++){const fe=ie[le];if(fe.POSITION!==void 0){const de=Z.json.accessors[fe.POSITION],pe=de.min,he=de.max;if(pe!==void 0&&he!==void 0){if(ae.setX(Math.max(Math.abs(pe[0]),Math.abs(he[0]))),ae.setY(Math.max(Math.abs(pe[1]),Math.abs(he[1]))),ae.setZ(Math.max(Math.abs(pe[2]),Math.abs(he[2]))),de.normalized){const ge=getNormalizedComponentScale$1(WEBGL_COMPONENT_TYPES$1[de.componentType]);ae.multiplyScalar(ge)}se.max(ae)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}ne.expandByVector(se)}K.boundingBox=ne;const oe=new Sphere$2;ne.getCenter(oe.center),oe.radius=ne.min.distanceTo(ne.max)/2,K.boundingSphere=oe}function addPrimitiveAttributes$1(K,_,Z){const te=_.attributes,ne=[];function ie(oe,se){return Z.getDependency("accessor",oe).then(function(ae){K.setAttribute(se,ae)})}for(const oe in te){const se=ATTRIBUTES$1[oe]||oe.toLowerCase();se in K.attributes||ne.push(ie(te[oe],se))}if(_.indices!==void 0&&!K.index){const oe=Z.getDependency("accessor",_.indices).then(function(se){K.setIndex(se)});ne.push(oe)}return assignExtrasToUserData$1(K,_),computeBounds$1(K,_,Z),Promise.all(ne).then(function(){return _.targets!==void 0?addMorphTargets$1(K,_.targets,Z):K})}class DecalGeometry extends BufferGeometry{constructor(_,Z,te,ne){super();const ie=[],oe=[],se=[],ae=new Vector3,le=new Matrix4;le.makeRotationFromEuler(te),le.setPosition(Z);const ce=new Matrix4;ce.copy(le).invert(),fe(),this.setAttribute("position",new Float32BufferAttribute(ie,3)),this.setAttribute("normal",new Float32BufferAttribute(oe,3)),this.setAttribute("uv",new Float32BufferAttribute(se,2));function fe(){let ge,me=[];const Ae=new Vector3,ye=new Vector3;if(_.geometry.isGeometry===!0){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}const ve=_.geometry,_e=ve.attributes.position,Te=ve.attributes.normal;if(ve.index!==null){const be=ve.index;for(ge=0;ge<be.count;ge++)Ae.fromBufferAttribute(_e,be.getX(ge)),ye.fromBufferAttribute(Te,be.getX(ge)),de(me,Ae,ye)}else for(ge=0;ge<_e.count;ge++)Ae.fromBufferAttribute(_e,ge),ye.fromBufferAttribute(Te,ge),de(me,Ae,ye);for(me=pe(me,ae.set(1,0,0)),me=pe(me,ae.set(-1,0,0)),me=pe(me,ae.set(0,1,0)),me=pe(me,ae.set(0,-1,0)),me=pe(me,ae.set(0,0,1)),me=pe(me,ae.set(0,0,-1)),ge=0;ge<me.length;ge++){const be=me[ge];se.push(.5+be.position.x/ne.x,.5+be.position.y/ne.y),be.position.applyMatrix4(le),ie.push(be.position.x,be.position.y,be.position.z),oe.push(be.normal.x,be.normal.y,be.normal.z)}}function de(ge,me,Ae){me.applyMatrix4(_.matrixWorld),me.applyMatrix4(ce),Ae.transformDirection(_.matrixWorld),ge.push(new DecalVertex(me.clone(),Ae.clone()))}function pe(ge,me){const Ae=[],ye=.5*Math.abs(ne.dot(me));for(let ve=0;ve<ge.length;ve+=3){let _e,Te,be,Re=0,we,Pe,Ie,$e;const Ue=ge[ve+0].position.dot(me)-ye,ke=ge[ve+1].position.dot(me)-ye,Ge=ge[ve+2].position.dot(me)-ye;switch(_e=Ue>0,Te=ke>0,be=Ge>0,Re=(_e?1:0)+(Te?1:0)+(be?1:0),Re){case 0:{Ae.push(ge[ve]),Ae.push(ge[ve+1]),Ae.push(ge[ve+2]);break}case 1:{if(_e&&(we=ge[ve+1],Pe=ge[ve+2],Ie=he(ge[ve],we,me,ye),$e=he(ge[ve],Pe,me,ye)),Te){we=ge[ve],Pe=ge[ve+2],Ie=he(ge[ve+1],we,me,ye),$e=he(ge[ve+1],Pe,me,ye),Ae.push(Ie),Ae.push(Pe.clone()),Ae.push(we.clone()),Ae.push(Pe.clone()),Ae.push(Ie.clone()),Ae.push($e);break}be&&(we=ge[ve],Pe=ge[ve+1],Ie=he(ge[ve+2],we,me,ye),$e=he(ge[ve+2],Pe,me,ye)),Ae.push(we.clone()),Ae.push(Pe.clone()),Ae.push(Ie),Ae.push($e),Ae.push(Ie.clone()),Ae.push(Pe.clone());break}case 2:{_e||(we=ge[ve].clone(),Pe=he(we,ge[ve+1],me,ye),Ie=he(we,ge[ve+2],me,ye),Ae.push(we),Ae.push(Pe),Ae.push(Ie)),Te||(we=ge[ve+1].clone(),Pe=he(we,ge[ve+2],me,ye),Ie=he(we,ge[ve],me,ye),Ae.push(we),Ae.push(Pe),Ae.push(Ie)),be||(we=ge[ve+2].clone(),Pe=he(we,ge[ve],me,ye),Ie=he(we,ge[ve+1],me,ye),Ae.push(we),Ae.push(Pe),Ae.push(Ie));break}}}return Ae}function he(ge,me,Ae,ye){const ve=ge.position.dot(Ae)-ye,_e=me.position.dot(Ae)-ye,Te=ve/(ve-_e);return new DecalVertex(new Vector3(ge.position.x+Te*(me.position.x-ge.position.x),ge.position.y+Te*(me.position.y-ge.position.y),ge.position.z+Te*(me.position.z-ge.position.z)),new Vector3(ge.normal.x+Te*(me.normal.x-ge.normal.x),ge.normal.y+Te*(me.normal.y-ge.normal.y),ge.normal.z+Te*(me.normal.z-ge.normal.z)))}}}class DecalVertex{constructor(_,Z){this.position=_,this.normal=Z}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}class TextGeometry extends ExtrudeGeometry{constructor(_,Z={}){const{bevelEnabled:te=!1,bevelSize:ne=8,bevelThickness:ie=10,font:oe,height:se=50,size:ae=100,lineHeight:le=1,letterSpacing:ce=0,...fe}=Z;if(oe===void 0)super();else{const de=oe.generateShapes(_,ae,{lineHeight:le,letterSpacing:ce});super(de,{...fe,bevelEnabled:te,bevelSize:ne,bevelThickness:ie,depth:se})}this.type="TextGeometry"}}const GammaCorrectionShader={uniforms:{tDiffuse:{value:null}},vertexShader:`
    varying vec2 vUv;

    void main() {

    	vUv = uv;
    	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;

    varying vec2 vUv;

    void main() {

    	vec4 tex = texture2D( tDiffuse, vUv );

    	#ifdef LinearTosRGB
    		gl_FragColor = LinearTosRGB( tex );
    	#else
    		gl_FragColor = sRGBTransferOETF( tex );
    	#endif

    }
  `},HorizontalBlurShader={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},VerticalBlurShader={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `},frustum=new Frustum$1,center=new Vector3,tmpPoint=new Vector3,vecNear=new Vector3,vecTopLeft=new Vector3,vecTopRight=new Vector3,vecDownRight=new Vector3,vecDownLeft=new Vector3,vecFarTopLeft=new Vector3,vecFarTopRight=new Vector3,vecFarDownRight=new Vector3,vecFarDownLeft=new Vector3,vectemp1=new Vector3,vectemp2=new Vector3,vectemp3=new Vector3;class SelectionBox{constructor(_,Z,te){this.camera=_,this.scene=Z,this.startPoint=new Vector3,this.endPoint=new Vector3,this.collection=[],this.deep=te||Number.MAX_VALUE}select(_,Z){return this.startPoint=_||this.startPoint,this.endPoint=Z||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(frustum,this.scene),this.collection}updateFrustum(_,Z){if(_=_||this.startPoint,Z=Z||this.endPoint,_.x===Z.x&&(Z.x+=Number.EPSILON),_.y===Z.y&&(Z.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){tmpPoint.copy(_),tmpPoint.x=Math.min(_.x,Z.x),tmpPoint.y=Math.max(_.y,Z.y),Z.x=Math.max(_.x,Z.x),Z.y=Math.min(_.y,Z.y),vecNear.setFromMatrixPosition(this.camera.matrixWorld),vecTopLeft.copy(tmpPoint),vecTopRight.set(Z.x,tmpPoint.y,0),vecDownRight.copy(Z),vecDownLeft.set(tmpPoint.x,Z.y,0),vecTopLeft.unproject(this.camera),vecTopRight.unproject(this.camera),vecDownRight.unproject(this.camera),vecDownLeft.unproject(this.camera),vectemp1.copy(vecTopLeft).sub(vecNear),vectemp2.copy(vecTopRight).sub(vecNear),vectemp3.copy(vecDownRight).sub(vecNear),vectemp1.normalize(),vectemp2.normalize(),vectemp3.normalize(),vectemp1.multiplyScalar(this.deep),vectemp2.multiplyScalar(this.deep),vectemp3.multiplyScalar(this.deep),vectemp1.add(vecNear),vectemp2.add(vecNear),vectemp3.add(vecNear);var te=frustum.planes;te[0].setFromCoplanarPoints(vecNear,vecTopLeft,vecTopRight),te[1].setFromCoplanarPoints(vecNear,vecTopRight,vecDownRight),te[2].setFromCoplanarPoints(vecDownRight,vecDownLeft,vecNear),te[3].setFromCoplanarPoints(vecDownLeft,vecTopLeft,vecNear),te[4].setFromCoplanarPoints(vecTopRight,vecDownRight,vecDownLeft),te[5].setFromCoplanarPoints(vectemp3,vectemp2,vectemp1),te[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const ne=Math.min(_.x,Z.x),ie=Math.max(_.y,Z.y),oe=Math.max(_.x,Z.x),se=Math.min(_.y,Z.y);vecTopLeft.set(ne,ie,-1),vecTopRight.set(oe,ie,-1),vecDownRight.set(oe,se,-1),vecDownLeft.set(ne,se,-1),vecFarTopLeft.set(ne,ie,1),vecFarTopRight.set(oe,ie,1),vecFarDownRight.set(oe,se,1),vecFarDownLeft.set(ne,se,1),vecTopLeft.unproject(this.camera),vecTopRight.unproject(this.camera),vecDownRight.unproject(this.camera),vecDownLeft.unproject(this.camera),vecFarTopLeft.unproject(this.camera),vecFarTopRight.unproject(this.camera),vecFarDownRight.unproject(this.camera),vecFarDownLeft.unproject(this.camera);var te=frustum.planes;te[0].setFromCoplanarPoints(vecTopLeft,vecFarTopLeft,vecFarTopRight),te[1].setFromCoplanarPoints(vecTopRight,vecFarTopRight,vecFarDownRight),te[2].setFromCoplanarPoints(vecFarDownRight,vecFarDownLeft,vecDownLeft),te[3].setFromCoplanarPoints(vecFarDownLeft,vecFarTopLeft,vecTopLeft),te[4].setFromCoplanarPoints(vecTopRight,vecDownRight,vecDownLeft),te[5].setFromCoplanarPoints(vecFarDownRight,vecFarTopRight,vecFarTopLeft),te[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(_,Z){if((Z.isMesh||Z.isLine||Z.isPoints)&&Z.material!==void 0&&(Z.geometry.boundingSphere===null&&Z.geometry.computeBoundingSphere(),center.copy(Z.geometry.boundingSphere.center),center.applyMatrix4(Z.matrixWorld),_.containsPoint(center)&&this.collection.push(Z)),Z.children.length>0)for(let te=0;te<Z.children.length;te++)this.searchChildInFrustum(_,Z.children[te])}}class AsciiEffect{constructor(_,Z=" .:-=+*#%@",te={}){const ne=te.resolution||.15,ie=te.scale||1,oe=te.color||!1,se=te.alpha||!1,ae=te.block||!1,le=te.invert||!1,ce=te.strResolution||"low";let fe,de;const pe=document.createElement("div");pe.style.cursor="default";const he=document.createElement("table");pe.appendChild(he);let ge,me,Ae;this.setSize=function(Ge,He){fe=Ge,de=He,_.setSize(Ge,He),ye()},this.render=function(Ge,He){_.render(Ge,He),ke(he)},this.domElement=pe;function ye(){ge=Math.floor(fe*ne),me=Math.floor(de*ne),Re.width=ge,Re.height=me,Ae=_.domElement,Ae.style.backgroundColor&&(he.rows[0].cells[0].style.backgroundColor=Ae.style.backgroundColor,he.rows[0].cells[0].style.color=Ae.style.color),he.cellSpacing=0,he.cellPadding=0;const Ge=he.style;Ge.whiteSpace="pre",Ge.margin="0px",Ge.padding="0px",Ge.letterSpacing=Ue+"px",Ge.fontFamily=Te,Ge.fontSize=Ie+"px",Ge.lineHeight=$e+"px",Ge.textAlign="left",Ge.textDecoration="none"}const ve=" .,:;i1tfLCG08@".split(""),_e=" CGO08@".split(""),Te="courier new, monospace",be=_.domElement,Re=document.createElement("canvas");if(!Re.getContext)return;const we=Re.getContext("2d");if(!we.getImageData)return;let Pe=oe?_e:ve;Z&&(Pe=Z);const Ie=2/ne*ie,$e=2/ne*ie;let Ue=0;if(ce=="low")switch(ie){case 1:Ue=-1;break;case 2:case 3:Ue=-2.1;break;case 4:Ue=-3.1;break;case 5:Ue=-4.15;break}if(ce=="medium")switch(ie){case 1:Ue=0;break;case 2:Ue=-1;break;case 3:Ue=-1.04;break;case 4:case 5:Ue=-2.1;break}if(ce=="high")switch(ie){case 1:case 2:Ue=0;break;case 3:case 4:case 5:Ue=-1;break}function ke(Ge){we.clearRect(0,0,ge,me),we.drawImage(be,0,0,ge,me);const He=we.getImageData(0,0,ge,me).data;let ze="";for(let Ke=0;Ke<me;Ke+=2){for(let tt=0;tt<ge;tt++){const Je=(Ke*ge+tt)*4,ot=He[Je],Fe=He[Je+1],ct=He[Je+2],ht=He[Je+3];let lt,Qe;Qe=(.3*ot+.59*Fe+.11*ct)/255,ht==0&&(Qe=1),lt=Math.floor((1-Qe)*(Pe.length-1)),le&&(lt=Pe.length-lt-1);let Ze=Pe[lt];(Ze===void 0||Ze==" ")&&(Ze="&nbsp;"),oe?ze+="<span style='color:rgb("+ot+","+Fe+","+ct+");"+(ae?"background-color:rgb("+ot+","+Fe+","+ct+");":"")+(se?"opacity:"+ht/255+";":"")+"'>"+Ze+"</span>":ze+=Ze}ze+="<br/>"}Ge.innerHTML=`<tr><td style="display:block;width:${fe}px;height:${de}px;overflow:hidden">${ze}</td></tr>`}}}var __defProp$3=Object.defineProperty,__defNormalProp$3=(K,_,Z)=>_ in K?__defProp$3(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$3=(K,_,Z)=>(__defNormalProp$3(K,typeof _!="symbol"?_+"":_,Z),Z);class FontLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=new FileLoader(this.manager);ie.setPath(this.path),ie.setRequestHeader(this.requestHeader),ie.setWithCredentials(this.withCredentials),ie.load(_,oe=>{if(typeof oe!="string")throw new Error("unsupported data type");const se=JSON.parse(oe),ae=this.parse(se);Z&&Z(ae)},te,ne)}loadAsync(_,Z){return super.loadAsync(_,Z)}parse(_){return new Font(_)}}class Font{constructor(_){__publicField$3(this,"data"),__publicField$3(this,"isFont",!0),__publicField$3(this,"type","Font"),this.data=_}generateShapes(_,Z=100,te){const ne=[],ie={letterSpacing:0,lineHeight:1,...te},oe=createPaths(_,Z,this.data,ie);for(let se=0,ae=oe.length;se<ae;se++)Array.prototype.push.apply(ne,oe[se].toShapes(!1));return ne}}function createPaths(K,_,Z,te){const ne=Array.from(K),ie=_/Z.resolution,oe=(Z.boundingBox.yMax-Z.boundingBox.yMin+Z.underlineThickness)*ie,se=[];let ae=0,le=0;for(let ce=0;ce<ne.length;ce++){const fe=ne[ce];if(fe===`
`)ae=0,le-=oe*te.lineHeight;else{const de=createPath(fe,ie,ae,le,Z);de&&(ae+=de.offsetX+te.letterSpacing,se.push(de.path))}}return se}function createPath(K,_,Z,te,ne){const ie=ne.glyphs[K]||ne.glyphs["?"];if(!ie){console.error('THREE.Font: character "'+K+'" does not exists in font family '+ne.familyName+".");return}const oe=new ShapePath;let se,ae,le,ce,fe,de,pe,he;if(ie.o){const ge=ie._cachedOutline||(ie._cachedOutline=ie.o.split(" "));for(let me=0,Ae=ge.length;me<Ae;)switch(ge[me++]){case"m":se=parseInt(ge[me++])*_+Z,ae=parseInt(ge[me++])*_+te,oe.moveTo(se,ae);break;case"l":se=parseInt(ge[me++])*_+Z,ae=parseInt(ge[me++])*_+te,oe.lineTo(se,ae);break;case"q":le=parseInt(ge[me++])*_+Z,ce=parseInt(ge[me++])*_+te,fe=parseInt(ge[me++])*_+Z,de=parseInt(ge[me++])*_+te,oe.quadraticCurveTo(fe,de,le,ce);break;case"b":le=parseInt(ge[me++])*_+Z,ce=parseInt(ge[me++])*_+te,fe=parseInt(ge[me++])*_+Z,de=parseInt(ge[me++])*_+te,pe=parseInt(ge[me++])*_+Z,he=parseInt(ge[me++])*_+te,oe.bezierCurveTo(fe,de,pe,he,le,ce);break}}return{offsetX:ie.ha*_,path:oe}}let TGALoader$1=class extends DataTextureLoader{constructor(_){super(_)}parse(_){function Z(ze){switch(ze.image_type){case de:case ge:(ze.colormap_length>256||ze.colormap_size!==24||ze.colormap_type!==1)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case pe:case he:case me:case Ae:ze.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case fe:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',ze.image_type)}(ze.width<=0||ze.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),ze.pixel_size!==8&&ze.pixel_size!==16&&ze.pixel_size!==24&&ze.pixel_size!==32&&console.error('THREE.TGALoader: Invalid pixel size "%s".',ze.pixel_size)}function te(ze,Ke,tt,Je,ot){let Fe,ct;const ht=tt.pixel_size>>3,lt=tt.width*tt.height*ht;if(Ke&&(ct=ot.subarray(Je,Je+=tt.colormap_length*(tt.colormap_size>>3))),ze){Fe=new Uint8Array(lt);let Qe,Ze,it,nt=0;const Tt=new Uint8Array(ht);for(;nt<lt;)if(Qe=ot[Je++],Ze=(Qe&127)+1,Qe&128){for(it=0;it<ht;++it)Tt[it]=ot[Je++];for(it=0;it<Ze;++it)Fe.set(Tt,nt+it*ht);nt+=ht*Ze}else{for(Ze*=ht,it=0;it<Ze;++it)Fe[nt+it]=ot[Je++];nt+=Ze}}else Fe=ot.subarray(Je,Je+=Ke?tt.width*tt.height:lt);return{pixel_data:Fe,palettes:ct}}function ne(ze,Ke,tt,Je,ot,Fe,ct,ht,lt){const Qe=lt;let Ze,it=0,nt,Tt;const St=Ie.width;for(Tt=Ke;Tt!==Je;Tt+=tt)for(nt=ot;nt!==ct;nt+=Fe,it++)Ze=ht[it],ze[(nt+St*Tt)*4+3]=255,ze[(nt+St*Tt)*4+2]=Qe[Ze*3+0],ze[(nt+St*Tt)*4+1]=Qe[Ze*3+1],ze[(nt+St*Tt)*4+0]=Qe[Ze*3+2];return ze}function ie(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt,Qe=0,Ze,it;const nt=Ie.width;for(it=Ke;it!==Je;it+=tt)for(Ze=ot;Ze!==ct;Ze+=Fe,Qe+=2)lt=ht[Qe+0]+(ht[Qe+1]<<8),ze[(Ze+nt*it)*4+0]=(lt&31744)>>7,ze[(Ze+nt*it)*4+1]=(lt&992)>>2,ze[(Ze+nt*it)*4+2]=(lt&31)>>3,ze[(Ze+nt*it)*4+3]=lt&32768?0:255;return ze}function oe(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt=0,Qe,Ze;const it=Ie.width;for(Ze=Ke;Ze!==Je;Ze+=tt)for(Qe=ot;Qe!==ct;Qe+=Fe,lt+=3)ze[(Qe+it*Ze)*4+3]=255,ze[(Qe+it*Ze)*4+2]=ht[lt+0],ze[(Qe+it*Ze)*4+1]=ht[lt+1],ze[(Qe+it*Ze)*4+0]=ht[lt+2];return ze}function se(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt=0,Qe,Ze;const it=Ie.width;for(Ze=Ke;Ze!==Je;Ze+=tt)for(Qe=ot;Qe!==ct;Qe+=Fe,lt+=4)ze[(Qe+it*Ze)*4+2]=ht[lt+0],ze[(Qe+it*Ze)*4+1]=ht[lt+1],ze[(Qe+it*Ze)*4+0]=ht[lt+2],ze[(Qe+it*Ze)*4+3]=ht[lt+3];return ze}function ae(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt,Qe=0,Ze,it;const nt=Ie.width;for(it=Ke;it!==Je;it+=tt)for(Ze=ot;Ze!==ct;Ze+=Fe,Qe++)lt=ht[Qe],ze[(Ze+nt*it)*4+0]=lt,ze[(Ze+nt*it)*4+1]=lt,ze[(Ze+nt*it)*4+2]=lt,ze[(Ze+nt*it)*4+3]=255;return ze}function le(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt=0,Qe,Ze;const it=Ie.width;for(Ze=Ke;Ze!==Je;Ze+=tt)for(Qe=ot;Qe!==ct;Qe+=Fe,lt+=2)ze[(Qe+it*Ze)*4+0]=ht[lt+0],ze[(Qe+it*Ze)*4+1]=ht[lt+0],ze[(Qe+it*Ze)*4+2]=ht[lt+0],ze[(Qe+it*Ze)*4+3]=ht[lt+1];return ze}function ce(ze,Ke,tt,Je,ot){let Fe,ct,ht,lt,Qe,Ze;switch((Ie.flags&ye)>>ve){default:case be:Fe=0,ht=1,Qe=Ke,ct=0,lt=1,Ze=tt;break;case _e:Fe=0,ht=1,Qe=Ke,ct=tt-1,lt=-1,Ze=-1;break;case Re:Fe=Ke-1,ht=-1,Qe=-1,ct=0,lt=1,Ze=tt;break;case Te:Fe=Ke-1,ht=-1,Qe=-1,ct=tt-1,lt=-1,Ze=-1;break}if(ke)switch(Ie.pixel_size){case 8:ae(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;case 16:le(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;default:console.error("THREE.TGALoader: Format not supported.");break}else switch(Ie.pixel_size){case 8:ne(ze,ct,lt,Ze,Fe,ht,Qe,Je,ot);break;case 16:ie(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;case 24:oe(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;case 32:se(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;default:console.error("THREE.TGALoader: Format not supported.");break}return ze}const fe=0,de=1,pe=2,he=3,ge=9,me=10,Ae=11,ye=48,ve=4,_e=0,Te=1,be=2,Re=3;_.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let we=0;const Pe=new Uint8Array(_),Ie={id_length:Pe[we++],colormap_type:Pe[we++],image_type:Pe[we++],colormap_index:Pe[we++]|Pe[we++]<<8,colormap_length:Pe[we++]|Pe[we++]<<8,colormap_size:Pe[we++],origin:[Pe[we++]|Pe[we++]<<8,Pe[we++]|Pe[we++]<<8],width:Pe[we++]|Pe[we++]<<8,height:Pe[we++]|Pe[we++]<<8,pixel_size:Pe[we++],flags:Pe[we++]};Z(Ie),Ie.id_length+we>_.length&&console.error("THREE.TGALoader: No data."),we+=Ie.id_length;let $e=!1,Ue=!1,ke=!1;switch(Ie.image_type){case ge:$e=!0,Ue=!0;break;case de:Ue=!0;break;case me:$e=!0;break;case pe:break;case Ae:$e=!0,ke=!0;break;case he:ke=!0;break}const Ge=new Uint8Array(Ie.width*Ie.height*4),He=te($e,Ue,Ie,we,Pe);return ce(Ge,Ie.width,Ie.height,He.pixel_data,He.palettes),{data:Ge,width:Ie.width,height:Ie.height,flipY:!0,generateMipmaps:!0,minFilter:LinearMipmapLinearFilter}}};class Data3DTexture extends Texture$1{constructor(_=null,Z=1,te=1,ne=1){super(null),this.isData3DTexture=!0,this.image={data:_,width:Z,height:te,depth:ne},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let STLLoader$1=class extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=new FileLoader(this.manager);oe.setPath(this.path),oe.setResponseType("arraybuffer"),oe.setRequestHeader(this.requestHeader),oe.setWithCredentials(this.withCredentials),oe.load(_,function(se){try{Z(ie.parse(se))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}parse(_){function Z(le){const ce=new DataView(le),fe=32/8*3+32/8*3*3+16/8,de=ce.getUint32(80,!0);if(80+32/8+de*fe===ce.byteLength)return!0;const he=[115,111,108,105,100];for(let ge=0;ge<5;ge++)if(te(he,ce,ge))return!1;return!0}function te(le,ce,fe){for(let de=0,pe=le.length;de<pe;de++)if(le[de]!==ce.getUint8(fe+de,!1))return!1;return!0}function ne(le){const ce=new DataView(le),fe=ce.getUint32(80,!0);let de,pe,he,ge=!1,me,Ae,ye,ve,_e;for(let Ie=0;Ie<70;Ie++)ce.getUint32(Ie,!1)==1129270351&&ce.getUint8(Ie+4)==82&&ce.getUint8(Ie+5)==61&&(ge=!0,me=new Float32Array(fe*3*3),Ae=ce.getUint8(Ie+6)/255,ye=ce.getUint8(Ie+7)/255,ve=ce.getUint8(Ie+8)/255,_e=ce.getUint8(Ie+9)/255);const Te=84,be=12*4+2,Re=new BufferGeometry,we=new Float32Array(fe*3*3),Pe=new Float32Array(fe*3*3);for(let Ie=0;Ie<fe;Ie++){const $e=Te+Ie*be,Ue=ce.getFloat32($e,!0),ke=ce.getFloat32($e+4,!0),Ge=ce.getFloat32($e+8,!0);if(ge){const He=ce.getUint16($e+48,!0);He&32768?(de=Ae,pe=ye,he=ve):(de=(He&31)/31,pe=(He>>5&31)/31,he=(He>>10&31)/31)}for(let He=1;He<=3;He++){const ze=$e+He*12,Ke=Ie*3*3+(He-1)*3;we[Ke]=ce.getFloat32(ze,!0),we[Ke+1]=ce.getFloat32(ze+4,!0),we[Ke+2]=ce.getFloat32(ze+8,!0),Pe[Ke]=Ue,Pe[Ke+1]=ke,Pe[Ke+2]=Ge,ge&&(me[Ke]=de,me[Ke+1]=pe,me[Ke+2]=he)}}return Re.setAttribute("position",new BufferAttribute(we,3)),Re.setAttribute("normal",new BufferAttribute(Pe,3)),ge&&(Re.setAttribute("color",new BufferAttribute(me,3)),Re.hasColors=!0,Re.alpha=_e),Re}function ie(le){const ce=new BufferGeometry,fe=/solid([\s\S]*?)endsolid/g,de=/facet([\s\S]*?)endfacet/g;let pe=0;const he=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,ge=new RegExp("vertex"+he+he+he,"g"),me=new RegExp("normal"+he+he+he,"g"),Ae=[],ye=[],ve=new Vector3;let _e,Te=0,be=0,Re=0;for(;(_e=fe.exec(le))!==null;){be=Re;const we=_e[0];for(;(_e=de.exec(we))!==null;){let $e=0,Ue=0;const ke=_e[0];for(;(_e=me.exec(ke))!==null;)ve.x=parseFloat(_e[1]),ve.y=parseFloat(_e[2]),ve.z=parseFloat(_e[3]),Ue++;for(;(_e=ge.exec(ke))!==null;)Ae.push(parseFloat(_e[1]),parseFloat(_e[2]),parseFloat(_e[3])),ye.push(ve.x,ve.y,ve.z),$e++,Re++;Ue!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+pe),$e!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+pe),pe++}const Pe=be,Ie=Re-be;ce.addGroup(Pe,Ie,Te),Te++}return ce.setAttribute("position",new Float32BufferAttribute(Ae,3)),ce.setAttribute("normal",new Float32BufferAttribute(ye,3)),ce}function oe(le){return typeof le!="string"?decodeText$1(new Uint8Array(le)):le}function se(le){if(typeof le=="string"){const ce=new Uint8Array(le.length);for(let fe=0;fe<le.length;fe++)ce[fe]=le.charCodeAt(fe)&255;return ce.buffer||ce}else return le}const ae=se(_);return Z(ae)?ne(ae):ie(oe(_))}};class MTLLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=this.path===""?LoaderUtils.extractUrlBase(_):this.path,se=new FileLoader(this.manager);se.setPath(this.path),se.setRequestHeader(this.requestHeader),se.setWithCredentials(this.withCredentials),se.load(_,function(ae){try{Z(ie.parse(ae,oe))}catch(le){ne?ne(le):console.error(le),ie.manager.itemError(_)}},te,ne)}setMaterialOptions(_){return this.materialOptions=_,this}parse(_,Z){const te=_.split(`
`);let ne={};const ie=/\s+/,oe={};for(let ae=0;ae<te.length;ae++){let le=te[ae];if(le=le.trim(),le.length===0||le.charAt(0)==="#")continue;const ce=le.indexOf(" ");let fe=ce>=0?le.substring(0,ce):le;fe=fe.toLowerCase();let de=ce>=0?le.substring(ce+1):"";if(de=de.trim(),fe==="newmtl")ne={name:de},oe[de]=ne;else if(fe==="ka"||fe==="kd"||fe==="ks"||fe==="ke"){const pe=de.split(ie,3);ne[fe]=[parseFloat(pe[0]),parseFloat(pe[1]),parseFloat(pe[2])]}else ne[fe]=de}const se=new MaterialCreator(this.resourcePath||Z,this.materialOptions);return se.setCrossOrigin(this.crossOrigin),se.setManager(this.manager),se.setMaterials(oe),se}}class MaterialCreator{constructor(_="",Z={}){this.baseUrl=_,this.options=Z,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:RepeatWrapping}setCrossOrigin(_){return this.crossOrigin=_,this}setManager(_){this.manager=_}setMaterials(_){this.materialsInfo=this.convert(_),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(_){if(!this.options)return _;const Z={};for(const te in _){const ne=_[te],ie={};Z[te]=ie;for(const oe in ne){let se=!0,ae=ne[oe];const le=oe.toLowerCase();switch(le){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(ae=[ae[0]/255,ae[1]/255,ae[2]/255]),this.options&&this.options.ignoreZeroRGBs&&ae[0]===0&&ae[1]===0&&ae[2]===0&&(se=!1);break}se&&(ie[le]=ae)}}return Z}preload(){for(const _ in this.materialsInfo)this.create(_)}getIndex(_){return this.nameLookup[_]}getAsArray(){let _=0;for(const Z in this.materialsInfo)this.materialsArray[_]=this.create(Z),this.nameLookup[Z]=_,_++;return this.materialsArray}create(_){return this.materials[_]===void 0&&this.createMaterial_(_),this.materials[_]}createMaterial_(_){const Z=this,te=this.materialsInfo[_],ne={name:_,side:this.side};function ie(se,ae){return typeof ae!="string"||ae===""?"":/^https?:\/\//i.test(ae)?ae:se+ae}function oe(se,ae){if(ne[se])return;const le=Z.getTextureParams(ae,ne),ce=Z.loadTexture(ie(Z.baseUrl,le.url));ce.repeat.copy(le.scale),ce.offset.copy(le.offset),ce.wrapS=Z.wrap,ce.wrapT=Z.wrap,ne[se]=ce}for(const se in te){const ae=te[se];let le;if(ae!=="")switch(se.toLowerCase()){case"kd":ne.color=new Color$1().fromArray(ae);break;case"ks":ne.specular=new Color$1().fromArray(ae);break;case"ke":ne.emissive=new Color$1().fromArray(ae);break;case"map_kd":oe("map",ae);break;case"map_ks":oe("specularMap",ae);break;case"map_ke":oe("emissiveMap",ae);break;case"norm":oe("normalMap",ae);break;case"map_bump":case"bump":oe("bumpMap",ae);break;case"map_d":oe("alphaMap",ae),ne.transparent=!0;break;case"ns":ne.shininess=parseFloat(ae);break;case"d":le=parseFloat(ae),le<1&&(ne.opacity=le,ne.transparent=!0);break;case"tr":le=parseFloat(ae),this.options&&this.options.invertTrProperty&&(le=1-le),le>0&&(ne.opacity=1-le,ne.transparent=!0);break}}return this.materials[_]=new MeshPhongMaterial(ne),this.materials[_]}getTextureParams(_,Z){const te={scale:new Vector2(1,1),offset:new Vector2(0,0)},ne=_.split(/\s+/);let ie;return ie=ne.indexOf("-bm"),ie>=0&&(Z.bumpScale=parseFloat(ne[ie+1]),ne.splice(ie,2)),ie=ne.indexOf("-s"),ie>=0&&(te.scale.set(parseFloat(ne[ie+1]),parseFloat(ne[ie+2])),ne.splice(ie,4)),ie=ne.indexOf("-o"),ie>=0&&(te.offset.set(parseFloat(ne[ie+1]),parseFloat(ne[ie+2])),ne.splice(ie,4)),te.url=ne.join(" ").trim(),te}loadTexture(_,Z,te,ne,ie){const oe=this.manager!==void 0?this.manager:DefaultLoadingManager;let se=oe.getHandler(_);se===null&&(se=new TextureLoader(oe)),se.setCrossOrigin&&se.setCrossOrigin(this.crossOrigin);const ae=se.load(_,te,ne,ie);return Z!==void 0&&(ae.mapping=Z),ae}}let ColladaLoader$1=class extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=ie.path===""?LoaderUtils.extractUrlBase(_):ie.path,se=new FileLoader(ie.manager);se.setPath(ie.path),se.setRequestHeader(ie.requestHeader),se.setWithCredentials(ie.withCredentials),se.load(_,function(ae){try{Z(ie.parse(ae,oe))}catch(le){ne?ne(le):console.error(le),ie.manager.itemError(_)}},te,ne)}parse(_,Z){function te(mt,Ve){const We=[],Ye=mt.childNodes;for(let qe=0,dt=Ye.length;qe<dt;qe++){const Ft=Ye[qe];Ft.nodeName===Ve&&We.push(Ft)}return We}function ne(mt){if(mt.length===0)return[];const Ve=mt.trim().split(/\s+/),We=new Array(Ve.length);for(let Ye=0,qe=Ve.length;Ye<qe;Ye++)We[Ye]=Ve[Ye];return We}function ie(mt){if(mt.length===0)return[];const Ve=mt.trim().split(/\s+/),We=new Array(Ve.length);for(let Ye=0,qe=Ve.length;Ye<qe;Ye++)We[Ye]=parseFloat(Ve[Ye]);return We}function oe(mt){if(mt.length===0)return[];const Ve=mt.trim().split(/\s+/),We=new Array(Ve.length);for(let Ye=0,qe=Ve.length;Ye<qe;Ye++)We[Ye]=parseInt(Ve[Ye]);return We}function se(mt){return mt.substring(1)}function ae(){return"three_default_"+Vr++}function le(mt){return Object.keys(mt).length===0}function ce(mt){return{unit:fe(te(mt,"unit")[0]),upAxis:de(te(mt,"up_axis")[0])}}function fe(mt){return mt!==void 0&&mt.hasAttribute("meter")===!0?parseFloat(mt.getAttribute("meter")):1}function de(mt){return mt!==void 0?mt.textContent:"Y_UP"}function pe(mt,Ve,We,Ye){const qe=te(mt,Ve)[0];if(qe!==void 0){const dt=te(qe,We);for(let Ft=0;Ft<dt.length;Ft++)Ye(dt[Ft])}}function he(mt,Ve){for(const We in mt){const Ye=mt[We];Ye.build=Ve(mt[We])}}function ge(mt,Ve){return mt.build!==void 0||(mt.build=Ve(mt)),mt.build}function me(mt){const Ve={sources:{},samplers:{},channels:{}};let We=!1;for(let Ye=0,qe=mt.childNodes.length;Ye<qe;Ye++){const dt=mt.childNodes[Ye];if(dt.nodeType!==1)continue;let Ft;switch(dt.nodeName){case"source":Ft=dt.getAttribute("id"),Ve.sources[Ft]=Yt(dt);break;case"sampler":Ft=dt.getAttribute("id"),Ve.samplers[Ft]=Ae(dt);break;case"channel":Ft=dt.getAttribute("target"),Ve.channels[Ft]=ye(dt);break;case"animation":me(dt),We=!0;break;default:console.log(dt)}}We===!1&&(Hn.animations[mt.getAttribute("id")||MathUtils.generateUUID()]=Ve)}function Ae(mt){const Ve={inputs:{}};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"input":const dt=se(qe.getAttribute("source")),Ft=qe.getAttribute("semantic");Ve.inputs[Ft]=dt;break}}return Ve}function ye(mt){const Ve={};let Ye=mt.getAttribute("target").split("/");const qe=Ye.shift();let dt=Ye.shift();const Ft=dt.indexOf("(")!==-1,Xt=dt.indexOf(".")!==-1;if(Xt)Ye=dt.split("."),dt=Ye.shift(),Ve.member=Ye.shift();else if(Ft){const an=dt.split("(");dt=an.shift();for(let Kt=0;Kt<an.length;Kt++)an[Kt]=parseInt(an[Kt].replace(/\)/,""));Ve.indices=an}return Ve.id=qe,Ve.sid=dt,Ve.arraySyntax=Ft,Ve.memberSyntax=Xt,Ve.sampler=se(mt.getAttribute("source")),Ve}function ve(mt){const Ve=[],We=mt.channels,Ye=mt.samplers,qe=mt.sources;for(const dt in We)if(We.hasOwnProperty(dt)){const Ft=We[dt],Xt=Ye[Ft.sampler],an=Xt.inputs.INPUT,Kt=Xt.inputs.OUTPUT,on=qe[an],sn=qe[Kt],nn=Te(Ft,on,sn);Ie(nn,Ve)}return Ve}function _e(mt){return ge(Hn.animations[mt],ve)}function Te(mt,Ve,We){const Ye=Hn.nodes[mt.id],qe=wn(Ye.id),dt=Ye.transforms[mt.sid],Ft=Ye.matrix.clone().transpose();let Xt,an,Kt,on,sn,nn;const mn={};switch(dt){case"matrix":for(Kt=0,on=Ve.array.length;Kt<on;Kt++)if(Xt=Ve.array[Kt],an=Kt*We.stride,mn[Xt]===void 0&&(mn[Xt]={}),mt.arraySyntax===!0){const Mn=We.array[an],Yn=mt.indices[0]+4*mt.indices[1];mn[Xt][Yn]=Mn}else for(sn=0,nn=We.stride;sn<nn;sn++)mn[Xt][sn]=We.array[an+sn];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',dt);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',dt);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',dt);break}const yn=be(mn,Ft);return{name:qe.uuid,keyframes:yn}}function be(mt,Ve){const We=[];for(const qe in mt)We.push({time:parseFloat(qe),value:mt[qe]});We.sort(Ye);for(let qe=0;qe<16;qe++)$e(We,qe,Ve.elements[qe]);return We;function Ye(qe,dt){return qe.time-dt.time}}const Re=new Vector3,we=new Vector3,Pe=new Quaternion;function Ie(mt,Ve){const We=mt.keyframes,Ye=mt.name,qe=[],dt=[],Ft=[],Xt=[];for(let an=0,Kt=We.length;an<Kt;an++){const on=We[an],sn=on.time,nn=on.value;Dt.fromArray(nn).transpose(),Dt.decompose(Re,Pe,we),qe.push(sn),dt.push(Re.x,Re.y,Re.z),Ft.push(Pe.x,Pe.y,Pe.z,Pe.w),Xt.push(we.x,we.y,we.z)}return dt.length>0&&Ve.push(new VectorKeyframeTrack(Ye+".position",qe,dt)),Ft.length>0&&Ve.push(new QuaternionKeyframeTrack(Ye+".quaternion",qe,Ft)),Xt.length>0&&Ve.push(new VectorKeyframeTrack(Ye+".scale",qe,Xt)),Ve}function $e(mt,Ve,We){let Ye,qe=!0,dt,Ft;for(dt=0,Ft=mt.length;dt<Ft;dt++)Ye=mt[dt],Ye.value[Ve]===void 0?Ye.value[Ve]=null:qe=!1;if(qe===!0)for(dt=0,Ft=mt.length;dt<Ft;dt++)Ye=mt[dt],Ye.value[Ve]=We;else Ue(mt,Ve)}function Ue(mt,Ve){let We,Ye;for(let qe=0,dt=mt.length;qe<dt;qe++){const Ft=mt[qe];if(Ft.value[Ve]===null){if(We=ke(mt,qe,Ve),Ye=Ge(mt,qe,Ve),We===null){Ft.value[Ve]=Ye.value[Ve];continue}if(Ye===null){Ft.value[Ve]=We.value[Ve];continue}He(Ft,We,Ye,Ve)}}}function ke(mt,Ve,We){for(;Ve>=0;){const Ye=mt[Ve];if(Ye.value[We]!==null)return Ye;Ve--}return null}function Ge(mt,Ve,We){for(;Ve<mt.length;){const Ye=mt[Ve];if(Ye.value[We]!==null)return Ye;Ve++}return null}function He(mt,Ve,We,Ye){if(We.time-Ve.time===0){mt.value[Ye]=Ve.value[Ye];return}mt.value[Ye]=(mt.time-Ve.time)*(We.value[Ye]-Ve.value[Ye])/(We.time-Ve.time)+Ve.value[Ye]}function ze(mt){const Ve={name:mt.getAttribute("id")||"default",start:parseFloat(mt.getAttribute("start")||0),end:parseFloat(mt.getAttribute("end")||0),animations:[]};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"instance_animation":Ve.animations.push(se(qe.getAttribute("url")));break}}Hn.clips[mt.getAttribute("id")]=Ve}function Ke(mt){const Ve=[],We=mt.name,Ye=mt.end-mt.start||-1,qe=mt.animations;for(let dt=0,Ft=qe.length;dt<Ft;dt++){const Xt=_e(qe[dt]);for(let an=0,Kt=Xt.length;an<Kt;an++)Ve.push(Xt[an])}return new AnimationClip(We,Ye,Ve)}function tt(mt){return ge(Hn.clips[mt],Ke)}function Je(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"skin":Ve.id=se(qe.getAttribute("source")),Ve.skin=ot(qe);break;case"morph":Ve.id=se(qe.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Hn.controllers[mt.getAttribute("id")]=Ve}function ot(mt){const Ve={sources:{}};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"bind_shape_matrix":Ve.bindShapeMatrix=ie(qe.textContent);break;case"source":const dt=qe.getAttribute("id");Ve.sources[dt]=Yt(qe);break;case"joints":Ve.joints=Fe(qe);break;case"vertex_weights":Ve.vertexWeights=ct(qe);break}}return Ve}function Fe(mt){const Ve={inputs:{}};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"input":const dt=qe.getAttribute("semantic"),Ft=se(qe.getAttribute("source"));Ve.inputs[dt]=Ft;break}}return Ve}function ct(mt){const Ve={inputs:{}};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"input":const dt=qe.getAttribute("semantic"),Ft=se(qe.getAttribute("source")),Xt=parseInt(qe.getAttribute("offset"));Ve.inputs[dt]={id:Ft,offset:Xt};break;case"vcount":Ve.vcount=oe(qe.textContent);break;case"v":Ve.v=oe(qe.textContent);break}}return Ve}function ht(mt){const Ve={id:mt.id},We=Hn.geometries[Ve.id];return mt.skin!==void 0&&(Ve.skin=lt(mt.skin),We.sources.skinIndices=Ve.skin.indices,We.sources.skinWeights=Ve.skin.weights),Ve}function lt(mt){const We={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},Ye=mt.sources,qe=mt.vertexWeights,dt=qe.vcount,Ft=qe.v,Xt=qe.inputs.JOINT.offset,an=qe.inputs.WEIGHT.offset,Kt=mt.sources[mt.joints.inputs.JOINT],on=mt.sources[mt.joints.inputs.INV_BIND_MATRIX],sn=Ye[qe.inputs.WEIGHT.id].array;let nn=0,mn,yn,vn;for(mn=0,vn=dt.length;mn<vn;mn++){const Yn=dt[mn],jn=[];for(yn=0;yn<Yn;yn++){const Wn=Ft[nn+Xt],ir=Ft[nn+an],gr=sn[ir];jn.push({index:Wn,weight:gr}),nn+=2}for(jn.sort(Mn),yn=0;yn<4;yn++){const Wn=jn[yn];Wn!==void 0?(We.indices.array.push(Wn.index),We.weights.array.push(Wn.weight)):(We.indices.array.push(0),We.weights.array.push(0))}}for(mt.bindShapeMatrix?We.bindMatrix=new Matrix4().fromArray(mt.bindShapeMatrix).transpose():We.bindMatrix=new Matrix4().identity(),mn=0,vn=Kt.array.length;mn<vn;mn++){const Yn=Kt.array[mn],jn=new Matrix4().fromArray(on.array,mn*on.stride).transpose();We.joints.push({name:Yn,boneInverse:jn})}return We;function Mn(Yn,jn){return jn.weight-Yn.weight}}function Qe(mt){return ge(Hn.controllers[mt],ht)}function Ze(mt){const Ve={init_from:te(mt,"init_from")[0].textContent};Hn.images[mt.getAttribute("id")]=Ve}function it(mt){return mt.build!==void 0?mt.build:mt.init_from}function nt(mt){const Ve=Hn.images[mt];return Ve!==void 0?ge(Ve,it):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",mt),null)}function Tt(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"profile_COMMON":Ve.profile=St(qe);break}}Hn.effects[mt.getAttribute("id")]=Ve}function St(mt){const Ve={surfaces:{},samplers:{}};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"newparam":Et(qe,Ve);break;case"technique":Ve.technique=yt(qe);break;case"extra":Ve.extra=pt(qe);break}}return Ve}function Et(mt,Ve){const We=mt.getAttribute("sid");for(let Ye=0,qe=mt.childNodes.length;Ye<qe;Ye++){const dt=mt.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"surface":Ve.surfaces[We]=Nt(dt);break;case"sampler2D":Ve.samplers[We]=zt(dt);break}}}function Nt(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"init_from":Ve.init_from=qe.textContent;break}}return Ve}function zt(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"source":Ve.source=qe.textContent;break}}return Ve}function yt(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"constant":case"lambert":case"blinn":case"phong":Ve.type=qe.nodeName,Ve.parameters=Ut(qe);break;case"extra":Ve.extra=pt(qe);break}}return Ve}function Ut(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":Ve[qe.nodeName]=bt(qe);break;case"transparent":Ve[qe.nodeName]={opaque:qe.hasAttribute("opaque")?qe.getAttribute("opaque"):"A_ONE",data:bt(qe)};break}}return Ve}function bt(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"color":Ve[qe.nodeName]=ie(qe.textContent);break;case"float":Ve[qe.nodeName]=parseFloat(qe.textContent);break;case"texture":Ve[qe.nodeName]={id:qe.getAttribute("texture"),extra:Ot(qe)};break}}return Ve}function Ot(mt){const Ve={technique:{}};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"extra":Mt(qe,Ve);break}}return Ve}function Mt(mt,Ve){for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"technique":_t(qe,Ve);break}}}function _t(mt,Ve){for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":Ve.technique[qe.nodeName]=parseFloat(qe.textContent);break;case"wrapU":case"wrapV":qe.textContent.toUpperCase()==="TRUE"?Ve.technique[qe.nodeName]=1:qe.textContent.toUpperCase()==="FALSE"?Ve.technique[qe.nodeName]=0:Ve.technique[qe.nodeName]=parseInt(qe.textContent);break;case"bump":Ve[qe.nodeName]=st(qe);break}}}function pt(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"technique":Ve.technique=ft(qe);break}}return Ve}function ft(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"double_sided":Ve[qe.nodeName]=parseInt(qe.textContent);break;case"bump":Ve[qe.nodeName]=st(qe);break}}return Ve}function st(mt){for(var Ve={},We=0,Ye=mt.childNodes.length;We<Ye;We++){var qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"texture":Ve[qe.nodeName]={id:qe.getAttribute("texture"),texcoord:qe.getAttribute("texcoord"),extra:Ot(qe)};break}}return Ve}function vt(mt){return mt}function Pt(mt){return ge(Hn.effects[mt],vt)}function Lt(mt){const Ve={name:mt.getAttribute("name")};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"instance_effect":Ve.url=se(qe.getAttribute("url"));break}}Hn.materials[mt.getAttribute("id")]=Ve}function Vt(mt){let Ve,We=mt.slice((mt.lastIndexOf(".")-1>>>0)+2);switch(We=We.toLowerCase(),We){case"tga":Ve=fr;break;default:Ve=sr}return Ve}function Le(mt){const Ve=Pt(mt.url),We=Ve.profile.technique;let Ye;switch(We.type){case"phong":case"blinn":Ye=new MeshPhongMaterial;break;case"lambert":Ye=new MeshLambertMaterial;break;default:Ye=new MeshBasicMaterial;break}Ye.name=mt.name||"";function qe(an){const Kt=Ve.profile.samplers[an.id];let on=null;if(Kt!==void 0){const sn=Ve.profile.surfaces[Kt.source];on=nt(sn.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),on=nt(an.id);if(on!==null){const sn=Vt(on);if(sn!==void 0){const nn=sn.load(on),mn=an.extra;if(mn!==void 0&&mn.technique!==void 0&&le(mn.technique)===!1){const yn=mn.technique;nn.wrapS=yn.wrapU?RepeatWrapping:ClampToEdgeWrapping,nn.wrapT=yn.wrapV?RepeatWrapping:ClampToEdgeWrapping,nn.offset.set(yn.offsetU||0,yn.offsetV||0),nn.repeat.set(yn.repeatU||1,yn.repeatV||1)}else nn.wrapS=RepeatWrapping,nn.wrapT=RepeatWrapping;return nn}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",on),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",an.id),null}const dt=We.parameters;for(const an in dt){const Kt=dt[an];switch(an){case"diffuse":Kt.color&&Ye.color.fromArray(Kt.color),Kt.texture&&(Ye.map=qe(Kt.texture));break;case"specular":Kt.color&&Ye.specular&&Ye.specular.fromArray(Kt.color),Kt.texture&&(Ye.specularMap=qe(Kt.texture));break;case"bump":Kt.texture&&(Ye.normalMap=qe(Kt.texture));break;case"ambient":Kt.texture&&(Ye.lightMap=qe(Kt.texture));break;case"shininess":Kt.float&&Ye.shininess&&(Ye.shininess=Kt.float);break;case"emission":Kt.color&&Ye.emissive&&Ye.emissive.fromArray(Kt.color),Kt.texture&&(Ye.emissiveMap=qe(Kt.texture));break}}let Ft=dt.transparent,Xt=dt.transparency;if(Xt===void 0&&Ft&&(Xt={float:1}),Ft===void 0&&Xt&&(Ft={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Ft&&Xt)if(Ft.data.texture)Ye.transparent=!0;else{const an=Ft.data.color;switch(Ft.opaque){case"A_ONE":Ye.opacity=an[3]*Xt.float;break;case"RGB_ZERO":Ye.opacity=1-an[0]*Xt.float;break;case"A_ZERO":Ye.opacity=1-an[3]*Xt.float;break;case"RGB_ONE":Ye.opacity=an[0]*Xt.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Ft.opaque)}Ye.opacity<1&&(Ye.transparent=!0)}if(We.extra!==void 0&&We.extra.technique!==void 0){const an=We.extra.technique;for(const Kt in an){const on=an[Kt];switch(Kt){case"double_sided":Ye.side=on===1?DoubleSide:FrontSide;break;case"bump":Ye.normalMap=qe(on.texture),Ye.normalScale=new Vector2(1,1);break}}}return Ye}function De(mt){return ge(Hn.materials[mt],Le)}function Be(mt){const Ve={name:mt.getAttribute("name")};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"optics":Ve.optics=rt(qe);break}}Hn.cameras[mt.getAttribute("id")]=Ve}function rt(mt){for(let Ve=0;Ve<mt.childNodes.length;Ve++){const We=mt.childNodes[Ve];switch(We.nodeName){case"technique_common":return at(We)}}return{}}function at(mt){const Ve={};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];switch(Ye.nodeName){case"perspective":case"orthographic":Ve.technique=Ye.nodeName,Ve.parameters=xt(Ye);break}}return Ve}function xt(mt){const Ve={};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];switch(Ye.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":Ve[Ye.nodeName]=parseFloat(Ye.textContent);break}}return Ve}function Ct(mt){let Ve;switch(mt.optics.technique){case"perspective":Ve=new PerspectiveCamera$2(mt.optics.parameters.yfov,mt.optics.parameters.aspect_ratio,mt.optics.parameters.znear,mt.optics.parameters.zfar);break;case"orthographic":let We=mt.optics.parameters.ymag,Ye=mt.optics.parameters.xmag;const qe=mt.optics.parameters.aspect_ratio;Ye=Ye===void 0?We*qe:Ye,We=We===void 0?Ye/qe:We,Ye*=.5,We*=.5,Ve=new OrthographicCamera$1(-Ye,Ye,We,-We,mt.optics.parameters.znear,mt.optics.parameters.zfar);break;default:Ve=new PerspectiveCamera$2;break}return Ve.name=mt.name||"",Ve}function Qt(mt){const Ve=Hn.cameras[mt];return Ve!==void 0?ge(Ve,Ct):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",mt),null)}function qt(mt){let Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"technique_common":Ve=It(qe);break}}Hn.lights[mt.getAttribute("id")]=Ve}function It(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"directional":case"point":case"spot":case"ambient":Ve.technique=qe.nodeName,Ve.parameters=Gt(qe)}}return Ve}function Gt(mt){const Ve={};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"color":const dt=ie(qe.textContent);Ve.color=new Color$1().fromArray(dt);break;case"falloff_angle":Ve.falloffAngle=parseFloat(qe.textContent);break;case"quadratic_attenuation":const Ft=parseFloat(qe.textContent);Ve.distance=Ft?Math.sqrt(1/Ft):0;break}}return Ve}function Jt(mt){let Ve;switch(mt.technique){case"directional":Ve=new DirectionalLight$1;break;case"point":Ve=new PointLight$1;break;case"spot":Ve=new SpotLight$2;break;case"ambient":Ve=new AmbientLight$1;break}return mt.parameters.color&&Ve.color.copy(mt.parameters.color),mt.parameters.distance&&(Ve.distance=mt.parameters.distance),Ve}function kt(mt){const Ve=Hn.lights[mt];return Ve!==void 0?ge(Ve,Jt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",mt),null)}function Ht(mt){const Ve={name:mt.getAttribute("name"),sources:{},vertices:{},primitives:[]},We=te(mt,"mesh")[0];if(We!==void 0){for(let Ye=0;Ye<We.childNodes.length;Ye++){const qe=We.childNodes[Ye];if(qe.nodeType!==1)continue;const dt=qe.getAttribute("id");switch(qe.nodeName){case"source":Ve.sources[dt]=Yt(qe);break;case"vertices":Ve.vertices=hn(qe);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",qe.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":Ve.primitives.push(_n(qe));break;default:console.log(qe)}}Hn.geometries[mt.getAttribute("id")]=Ve}}function Yt(mt){const Ve={array:[],stride:3};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"float_array":Ve.array=ie(Ye.textContent);break;case"Name_array":Ve.array=ne(Ye.textContent);break;case"technique_common":const qe=te(Ye,"accessor")[0];qe!==void 0&&(Ve.stride=parseInt(qe.getAttribute("stride")));break}}return Ve}function hn(mt){const Ve={};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];Ye.nodeType===1&&(Ve[Ye.getAttribute("semantic")]=se(Ye.getAttribute("source")))}return Ve}function _n(mt){const Ve={type:mt.nodeName,material:mt.getAttribute("material"),count:parseInt(mt.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let We=0,Ye=mt.childNodes.length;We<Ye;We++){const qe=mt.childNodes[We];if(qe.nodeType===1)switch(qe.nodeName){case"input":const dt=se(qe.getAttribute("source")),Ft=qe.getAttribute("semantic"),Xt=parseInt(qe.getAttribute("offset")),an=parseInt(qe.getAttribute("set")),Kt=an>0?Ft+an:Ft;Ve.inputs[Kt]={id:dt,offset:Xt},Ve.stride=Math.max(Ve.stride,Xt+1),Ft==="TEXCOORD"&&(Ve.hasUV=!0);break;case"vcount":Ve.vcount=oe(qe.textContent);break;case"p":Ve.p=oe(qe.textContent);break}}return Ve}function xn(mt){const Ve={};for(let We=0;We<mt.length;We++){const Ye=mt[We];Ve[Ye.type]===void 0&&(Ve[Ye.type]=[]),Ve[Ye.type].push(Ye)}return Ve}function Ln(mt){let Ve=0;for(let We=0,Ye=mt.length;We<Ye;We++)mt[We].hasUV===!0&&Ve++;Ve>0&&Ve<mt.length&&(mt.uvsNeedsFix=!0)}function Vn(mt){const Ve={},We=mt.sources,Ye=mt.vertices,qe=mt.primitives;if(qe.length===0)return{};const dt=xn(qe);for(const Ft in dt){const Xt=dt[Ft];Ln(Xt),Ve[Ft]=kn(Xt,We,Ye)}return Ve}function kn(mt,Ve,We){const Ye={},qe={array:[],stride:0},dt={array:[],stride:0},Ft={array:[],stride:0},Xt={array:[],stride:0},an={array:[],stride:0},Kt={array:[],stride:4},on={array:[],stride:4},sn=new BufferGeometry,nn=[];let mn=0;for(let yn=0;yn<mt.length;yn++){const vn=mt[yn],Mn=vn.inputs;let Yn=0;switch(vn.type){case"lines":case"linestrips":Yn=vn.count*2;break;case"triangles":Yn=vn.count*3;break;case"polylist":for(let jn=0;jn<vn.count;jn++){const Wn=vn.vcount[jn];switch(Wn){case 3:Yn+=3;break;case 4:Yn+=6;break;default:Yn+=(Wn-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",vn.type)}sn.addGroup(mn,Yn,yn),mn+=Yn,vn.material&&nn.push(vn.material);for(const jn in Mn){const Wn=Mn[jn];switch(jn){case"VERTEX":for(const ir in We){const gr=We[ir];switch(ir){case"POSITION":const wr=qe.array.length;if(Rn(vn,Ve[gr],Wn.offset,qe.array),qe.stride=Ve[gr].stride,Ve.skinWeights&&Ve.skinIndices&&(Rn(vn,Ve.skinIndices,Wn.offset,Kt.array),Rn(vn,Ve.skinWeights,Wn.offset,on.array)),vn.hasUV===!1&&mt.uvsNeedsFix===!0){const ei=(qe.array.length-wr)/qe.stride;for(let Or=0;Or<ei;Or++)Ft.array.push(0,0)}break;case"NORMAL":Rn(vn,Ve[gr],Wn.offset,dt.array),dt.stride=Ve[gr].stride;break;case"COLOR":Rn(vn,Ve[gr],Wn.offset,an.array),an.stride=Ve[gr].stride;break;case"TEXCOORD":Rn(vn,Ve[gr],Wn.offset,Ft.array),Ft.stride=Ve[gr].stride;break;case"TEXCOORD1":Rn(vn,Ve[gr],Wn.offset,Xt.array),Ft.stride=Ve[gr].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',ir)}}break;case"NORMAL":Rn(vn,Ve[Wn.id],Wn.offset,dt.array),dt.stride=Ve[Wn.id].stride;break;case"COLOR":Rn(vn,Ve[Wn.id],Wn.offset,an.array),an.stride=Ve[Wn.id].stride;break;case"TEXCOORD":Rn(vn,Ve[Wn.id],Wn.offset,Ft.array),Ft.stride=Ve[Wn.id].stride;break;case"TEXCOORD1":Rn(vn,Ve[Wn.id],Wn.offset,Xt.array),Xt.stride=Ve[Wn.id].stride;break}}}return qe.array.length>0&&sn.setAttribute("position",new Float32BufferAttribute(qe.array,qe.stride)),dt.array.length>0&&sn.setAttribute("normal",new Float32BufferAttribute(dt.array,dt.stride)),an.array.length>0&&sn.setAttribute("color",new Float32BufferAttribute(an.array,an.stride)),Ft.array.length>0&&sn.setAttribute("uv",new Float32BufferAttribute(Ft.array,Ft.stride)),Xt.array.length>0&&sn.setAttribute(UV1,new Float32BufferAttribute(Xt.array,Xt.stride)),Kt.array.length>0&&sn.setAttribute("skinIndex",new Float32BufferAttribute(Kt.array,Kt.stride)),on.array.length>0&&sn.setAttribute("skinWeight",new Float32BufferAttribute(on.array,on.stride)),Ye.data=sn,Ye.type=mt[0].type,Ye.materialKeys=nn,Ye}function Rn(mt,Ve,We,Ye){const qe=mt.p,dt=mt.stride,Ft=mt.vcount;function Xt(on){let sn=qe[on+We]*Kt;const nn=sn+Kt;for(;sn<nn;sn++)Ye.push(an[sn])}const an=Ve.array,Kt=Ve.stride;if(mt.vcount!==void 0){let on=0;for(let sn=0,nn=Ft.length;sn<nn;sn++){const mn=Ft[sn];if(mn===4){const yn=on+dt*0,vn=on+dt*1,Mn=on+dt*2,Yn=on+dt*3;Xt(yn),Xt(vn),Xt(Yn),Xt(vn),Xt(Mn),Xt(Yn)}else if(mn===3){const yn=on+dt*0,vn=on+dt*1,Mn=on+dt*2;Xt(yn),Xt(vn),Xt(Mn)}else if(mn>4)for(let yn=1,vn=mn-2;yn<=vn;yn++){const Mn=on+dt*0,Yn=on+dt*yn,jn=on+dt*(yn+1);Xt(Mn),Xt(Yn),Xt(jn)}on+=dt*mn}}else for(let on=0,sn=qe.length;on<sn;on+=dt)Xt(on)}function or(mt){return ge(Hn.geometries[mt],Vn)}function pr(mt){const Ve={name:mt.getAttribute("name")||"",joints:{},links:[]};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"technique_common":Sr(Ye,Ve);break}}Hn.kinematicsModels[mt.getAttribute("id")]=Ve}function vr(mt){return mt.build!==void 0?mt.build:mt}function Nr(mt){return ge(Hn.kinematicsModels[mt],vr)}function Sr(mt,Ve){for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"joint":Ve.joints[Ye.getAttribute("sid")]=Pr(Ye);break;case"link":Ve.links.push(Cr(Ye));break}}}function Pr(mt){let Ve;for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"prismatic":case"revolute":Ve=Dr(Ye);break}}return Ve}function Dr(mt){const Ve={sid:mt.getAttribute("sid"),name:mt.getAttribute("name")||"",axis:new Vector3,limits:{min:0,max:0},type:mt.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"axis":const qe=ie(Ye.textContent);Ve.axis.fromArray(qe);break;case"limits":const dt=Ye.getElementsByTagName("max")[0],Ft=Ye.getElementsByTagName("min")[0];Ve.limits.max=parseFloat(dt.textContent),Ve.limits.min=parseFloat(Ft.textContent);break}}return Ve.limits.min>=Ve.limits.max&&(Ve.static=!0),Ve.middlePosition=(Ve.limits.min+Ve.limits.max)/2,Ve}function Cr(mt){const Ve={sid:mt.getAttribute("sid"),name:mt.getAttribute("name")||"",attachments:[],transforms:[]};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"attachment_full":Ve.attachments.push(Kn(Ye));break;case"matrix":case"translate":case"rotate":Ve.transforms.push(Er(Ye));break}}return Ve}function Kn(mt){const Ve={joint:mt.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"link":Ve.links.push(Cr(Ye));break;case"matrix":case"translate":case"rotate":Ve.transforms.push(Er(Ye));break}}return Ve}function Er(mt){const Ve={type:mt.nodeName},We=ie(mt.textContent);switch(Ve.type){case"matrix":Ve.obj=new Matrix4,Ve.obj.fromArray(We).transpose();break;case"translate":Ve.obj=new Vector3,Ve.obj.fromArray(We);break;case"rotate":Ve.obj=new Vector3,Ve.obj.fromArray(We),Ve.angle=MathUtils.degToRad(We[3]);break}return Ve}function $r(mt){const Ve={name:mt.getAttribute("name")||"",rigidBodies:{}};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"rigid_body":Ve.rigidBodies[Ye.getAttribute("name")]={},gt(Ye,Ve.rigidBodies[Ye.getAttribute("name")]);break}}Hn.physicsModels[mt.getAttribute("id")]=Ve}function gt(mt,Ve){for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"technique_common":wt(Ye,Ve);break}}}function wt(mt,Ve){for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"inertia":Ve.inertia=ie(Ye.textContent);break;case"mass":Ve.mass=ie(Ye.textContent)[0];break}}}function jt(mt){const Ve={bindJointAxis:[]};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"bind_joint_axis":Ve.bindJointAxis.push(rn(Ye));break}}Hn.kinematicsScenes[se(mt.getAttribute("url"))]=Ve}function rn(mt){const Ve={target:mt.getAttribute("target").split("/").pop()};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType===1)switch(Ye.nodeName){case"axis":const qe=Ye.getElementsByTagName("param")[0];Ve.axis=qe.textContent;const dt=Ve.axis.split("inst_").pop().split("axis")[0];Ve.jointIndex=dt.substr(0,dt.length-1);break}}return Ve}function un(mt){return mt.build!==void 0?mt.build:mt}function dn(mt){return ge(Hn.kinematicsScenes[mt],un)}function Tn(){const mt=Object.keys(Hn.kinematicsModels)[0],Ve=Object.keys(Hn.kinematicsScenes)[0],We=Object.keys(Hn.visualScenes)[0];if(mt===void 0||Ve===void 0)return;const Ye=Nr(mt),qe=dn(Ve),dt=On(We),Ft=qe.bindJointAxis,Xt={};for(let on=0,sn=Ft.length;on<sn;on++){const nn=Ft[on],mn=Un.querySelector('[sid="'+nn.target+'"]');if(mn){const yn=mn.parentElement;an(nn.jointIndex,yn)}}function an(on,sn){const nn=sn.getAttribute("name"),mn=Ye.joints[on];dt.traverse(function(yn){yn.name===nn&&(Xt[on]={object:yn,transforms:Sn(sn),joint:mn,position:mn.zeroPosition})})}const Kt=new Matrix4;_r={joints:Ye&&Ye.joints,getJointValue:function(on){const sn=Xt[on];if(sn)return sn.position;console.warn("THREE.ColladaLoader: Joint "+on+" doesn't exist.")},setJointValue:function(on,sn){const nn=Xt[on];if(nn){const mn=nn.joint;if(sn>mn.limits.max||sn<mn.limits.min)console.warn("THREE.ColladaLoader: Joint "+on+" value "+sn+" outside of limits (min: "+mn.limits.min+", max: "+mn.limits.max+").");else if(mn.static)console.warn("THREE.ColladaLoader: Joint "+on+" is static.");else{const yn=nn.object,vn=mn.axis,Mn=nn.transforms;Dt.identity();for(let Yn=0;Yn<Mn.length;Yn++){const jn=Mn[Yn];if(jn.sid&&jn.sid.indexOf(on)!==-1)switch(mn.type){case"revolute":Dt.multiply(Kt.makeRotationAxis(vn,MathUtils.degToRad(sn)));break;case"prismatic":Dt.multiply(Kt.makeTranslation(vn.x*sn,vn.y*sn,vn.z*sn));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+mn.type);break}else switch(jn.type){case"matrix":Dt.multiply(jn.obj);break;case"translate":Dt.multiply(Kt.makeTranslation(jn.obj.x,jn.obj.y,jn.obj.z));break;case"scale":Dt.scale(jn.obj);break;case"rotate":Dt.multiply(Kt.makeRotationAxis(jn.obj,jn.angle));break}}yn.matrix.copy(Dt),yn.matrix.decompose(yn.position,yn.quaternion,yn.scale),Xt[on].position=sn}}else console.log("THREE.ColladaLoader: "+on+" does not exist.")}}}function Sn(mt){const Ve=[],We=Un.querySelector('[id="'+mt.id+'"]');for(let Ye=0;Ye<We.childNodes.length;Ye++){const qe=We.childNodes[Ye];if(qe.nodeType!==1)continue;let dt,Ft;switch(qe.nodeName){case"matrix":dt=ie(qe.textContent);const Xt=new Matrix4().fromArray(dt).transpose();Ve.push({sid:qe.getAttribute("sid"),type:qe.nodeName,obj:Xt});break;case"translate":case"scale":dt=ie(qe.textContent),Ft=new Vector3().fromArray(dt),Ve.push({sid:qe.getAttribute("sid"),type:qe.nodeName,obj:Ft});break;case"rotate":dt=ie(qe.textContent),Ft=new Vector3().fromArray(dt);const an=MathUtils.degToRad(dt[3]);Ve.push({sid:qe.getAttribute("sid"),type:qe.nodeName,obj:Ft,angle:an});break}}return Ve}function At(mt){const Ve=mt.getElementsByTagName("node");for(let We=0;We<Ve.length;We++){const Ye=Ve[We];Ye.hasAttribute("id")===!1&&Ye.setAttribute("id",ae())}}const Dt=new Matrix4,$t=new Vector3;function Bt(mt){const Ve={name:mt.getAttribute("name")||"",type:mt.getAttribute("type"),id:mt.getAttribute("id"),sid:mt.getAttribute("sid"),matrix:new Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];if(Ye.nodeType!==1)continue;let qe;switch(Ye.nodeName){case"node":Ve.nodes.push(Ye.getAttribute("id")),Bt(Ye);break;case"instance_camera":Ve.instanceCameras.push(se(Ye.getAttribute("url")));break;case"instance_controller":Ve.instanceControllers.push(Wt(Ye));break;case"instance_light":Ve.instanceLights.push(se(Ye.getAttribute("url")));break;case"instance_geometry":Ve.instanceGeometries.push(Wt(Ye));break;case"instance_node":Ve.instanceNodes.push(se(Ye.getAttribute("url")));break;case"matrix":qe=ie(Ye.textContent),Ve.matrix.multiply(Dt.fromArray(qe).transpose()),Ve.transforms[Ye.getAttribute("sid")]=Ye.nodeName;break;case"translate":qe=ie(Ye.textContent),$t.fromArray(qe),Ve.matrix.multiply(Dt.makeTranslation($t.x,$t.y,$t.z)),Ve.transforms[Ye.getAttribute("sid")]=Ye.nodeName;break;case"rotate":qe=ie(Ye.textContent);const dt=MathUtils.degToRad(qe[3]);Ve.matrix.multiply(Dt.makeRotationAxis($t.fromArray(qe),dt)),Ve.transforms[Ye.getAttribute("sid")]=Ye.nodeName;break;case"scale":qe=ie(Ye.textContent),Ve.matrix.scale($t.fromArray(qe)),Ve.transforms[Ye.getAttribute("sid")]=Ye.nodeName;break;case"extra":break;default:console.log(Ye)}}return Cn(Ve.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",Ve.id):Hn.nodes[Ve.id]=Ve,Ve}function Wt(mt){const Ve={id:se(mt.getAttribute("url")),materials:{},skeletons:[]};for(let We=0;We<mt.childNodes.length;We++){const Ye=mt.childNodes[We];switch(Ye.nodeName){case"bind_material":const qe=Ye.getElementsByTagName("instance_material");for(let dt=0;dt<qe.length;dt++){const Ft=qe[dt],Xt=Ft.getAttribute("symbol"),an=Ft.getAttribute("target");Ve.materials[Xt]=se(an)}break;case"skeleton":Ve.skeletons.push(se(Ye.textContent));break}}return Ve}function tn(mt,Ve){const We=[],Ye=[];let qe,dt,Ft;for(qe=0;qe<mt.length;qe++){const Kt=mt[qe];let on;if(Cn(Kt))on=wn(Kt),cn(on,Ve,We);else if(Fn(Kt)){const nn=Hn.visualScenes[Kt].children;for(let mn=0;mn<nn.length;mn++){const yn=nn[mn];if(yn.type==="JOINT"){const vn=wn(yn.id);cn(vn,Ve,We)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Kt)}for(qe=0;qe<Ve.length;qe++)for(dt=0;dt<We.length;dt++)if(Ft=We[dt],Ft.bone.name===Ve[qe].name){Ye[qe]=Ft,Ft.processed=!0;break}for(qe=0;qe<We.length;qe++)Ft=We[qe],Ft.processed===!1&&(Ye.push(Ft),Ft.processed=!0);const Xt=[],an=[];for(qe=0;qe<Ye.length;qe++)Ft=Ye[qe],Xt.push(Ft.bone),an.push(Ft.boneInverse);return new Skeleton(Xt,an)}function cn(mt,Ve,We){mt.traverse(function(Ye){if(Ye.isBone===!0){let qe;for(let dt=0;dt<Ve.length;dt++){const Ft=Ve[dt];if(Ft.name===Ye.name){qe=Ft.boneInverse;break}}qe===void 0&&(qe=new Matrix4),We.push({bone:Ye,boneInverse:qe,processed:!1})}})}function An(mt){const Ve=[],We=mt.matrix,Ye=mt.nodes,qe=mt.type,dt=mt.instanceCameras,Ft=mt.instanceControllers,Xt=mt.instanceLights,an=mt.instanceGeometries,Kt=mt.instanceNodes;for(let sn=0,nn=Ye.length;sn<nn;sn++)Ve.push(wn(Ye[sn]));for(let sn=0,nn=dt.length;sn<nn;sn++){const mn=Qt(dt[sn]);mn!==null&&Ve.push(mn.clone())}for(let sn=0,nn=Ft.length;sn<nn;sn++){const mn=Ft[sn],yn=Qe(mn.id),vn=or(yn.id),Mn=In(vn,mn.materials),Yn=mn.skeletons,jn=yn.skin.joints,Wn=tn(Yn,jn);for(let ir=0,gr=Mn.length;ir<gr;ir++){const wr=Mn[ir];wr.isSkinnedMesh&&(wr.bind(Wn,yn.skin.bindMatrix),wr.normalizeSkinWeights()),Ve.push(wr)}}for(let sn=0,nn=Xt.length;sn<nn;sn++){const mn=kt(Xt[sn]);mn!==null&&Ve.push(mn.clone())}for(let sn=0,nn=an.length;sn<nn;sn++){const mn=an[sn],yn=or(mn.id),vn=In(yn,mn.materials);for(let Mn=0,Yn=vn.length;Mn<Yn;Mn++)Ve.push(vn[Mn])}for(let sn=0,nn=Kt.length;sn<nn;sn++)Ve.push(wn(Kt[sn]).clone());let on;if(Ye.length===0&&Ve.length===1)on=Ve[0];else{on=qe==="JOINT"?new Bone:new Group;for(let sn=0;sn<Ve.length;sn++)on.add(Ve[sn])}return on.name=qe==="JOINT"?mt.sid:mt.name,on.matrix.copy(We),on.matrix.decompose(on.position,on.quaternion,on.scale),on}const En=new MeshBasicMaterial({color:16711935});function Bn(mt,Ve){const We=[];for(let Ye=0,qe=mt.length;Ye<qe;Ye++){const dt=Ve[mt[Ye]];dt===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",mt[Ye]),We.push(En)):We.push(De(dt))}return We}function In(mt,Ve){const We=[];for(const Ye in mt){const qe=mt[Ye],dt=Bn(qe.materialKeys,Ve);dt.length===0&&(Ye==="lines"||Ye==="linestrips"?dt.push(new LineBasicMaterial):dt.push(new MeshPhongMaterial));const Ft=qe.data.attributes.skinIndex!==void 0,Xt=dt.length===1?dt[0]:dt;let an;switch(Ye){case"lines":an=new LineSegments(qe.data,Xt);break;case"linestrips":an=new Line$2(qe.data,Xt);break;case"triangles":case"polylist":Ft?an=new SkinnedMesh(qe.data,Xt):an=new Mesh(qe.data,Xt);break}We.push(an)}return We}function Cn(mt){return Hn.nodes[mt]!==void 0}function wn(mt){return ge(Hn.nodes[mt],An)}function bn(mt){const Ve={name:mt.getAttribute("name"),children:[]};At(mt);const We=te(mt,"node");for(let Ye=0;Ye<We.length;Ye++)Ve.children.push(Bt(We[Ye]));Hn.visualScenes[mt.getAttribute("id")]=Ve}function nr(mt){const Ve=new Group;Ve.name=mt.name;const We=mt.children;for(let Ye=0;Ye<We.length;Ye++){const qe=We[Ye];Ve.add(wn(qe.id))}return Ve}function Fn(mt){return Hn.visualScenes[mt]!==void 0}function On(mt){return ge(Hn.visualScenes[mt],nr)}function Nn(mt){const Ve=te(mt,"instance_visual_scene")[0];return On(se(Ve.getAttribute("url")))}function mr(){const mt=Hn.clips;if(le(mt)===!0){if(le(Hn.animations)===!1){const Ve=[];for(const We in Hn.animations){const Ye=_e(We);for(let qe=0,dt=Ye.length;qe<dt;qe++)Ve.push(Ye[qe])}hr.push(new AnimationClip("default",-1,Ve))}}else for(const Ve in mt)hr.push(tt(Ve))}function zn(mt){let Ve="";const We=[mt];for(;We.length;){const Ye=We.shift();Ye.nodeType===Node.TEXT_NODE?Ve+=Ye.textContent:(Ve+=`
`,We.push.apply(We,Ye.childNodes))}return Ve.trim()}if(_.length===0)return{scene:new Scene$1};const Zn=new DOMParser().parseFromString(_,"application/xml"),Un=te(Zn,"COLLADA")[0],er=Zn.getElementsByTagName("parsererror")[0];if(er!==void 0){const mt=te(er,"div")[0];let Ve;return mt?Ve=mt.textContent:Ve=zn(er),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,Ve),null}const Jn=Un.getAttribute("version");console.log("THREE.ColladaLoader: File version",Jn);const rr=ce(te(Un,"asset")[0]),sr=new TextureLoader(this.manager);sr.setPath(this.resourcePath||Z).setCrossOrigin(this.crossOrigin);let fr;TGALoader$1&&(fr=new TGALoader$1(this.manager),fr.setPath(this.resourcePath||Z));const hr=[];let _r={},Vr=0;const Hn={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};pe(Un,"library_animations","animation",me),pe(Un,"library_animation_clips","animation_clip",ze),pe(Un,"library_controllers","controller",Je),pe(Un,"library_images","image",Ze),pe(Un,"library_effects","effect",Tt),pe(Un,"library_materials","material",Lt),pe(Un,"library_cameras","camera",Be),pe(Un,"library_lights","light",qt),pe(Un,"library_geometries","geometry",Ht),pe(Un,"library_nodes","node",Bt),pe(Un,"library_visual_scenes","visual_scene",bn),pe(Un,"library_kinematics_models","kinematics_model",pr),pe(Un,"library_physics_models","physics_model",$r),pe(Un,"scene","instance_kinematics_scene",jt),he(Hn.animations,ve),he(Hn.clips,Ke),he(Hn.controllers,ht),he(Hn.images,it),he(Hn.effects,vt),he(Hn.materials,Le),he(Hn.cameras,Ct),he(Hn.lights,Jt),he(Hn.geometries,Vn),he(Hn.visualScenes,nr),mr(),Tn();const qn=Nn(te(Un,"scene")[0]);return qn.animations=hr,rr.upAxis==="Z_UP"&&qn.quaternion.setFromEuler(new Euler(-Math.PI/2,0,0)),qn.scale.multiplyScalar(rr.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),hr},kinematics:_r,library:Hn,scene:qn}}};class WorkerPool{constructor(_=4){this.pool=_,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(_){if(!this.workers[_]){const Z=this.workerCreator();Z.addEventListener("message",this._onMessage.bind(this,_)),this.workers[_]=Z}}_getIdleWorker(){for(let _=0;_<this.pool;_++)if(!(this.workerStatus&1<<_))return _;return-1}_onMessage(_,Z){const te=this.workersResolve[_];if(te&&te(Z),this.queue.length){const{resolve:ne,msg:ie,transfer:oe}=this.queue.shift();this.workersResolve[_]=ne,this.workers[_].postMessage(ie,oe)}else this.workerStatus^=1<<_}setWorkerCreator(_){this.workerCreator=_}setWorkerLimit(_){this.pool=_}postMessage(_,Z){return new Promise(te=>{const ne=this._getIdleWorker();ne!==-1?(this._initWorker(ne),this.workerStatus|=1<<ne,this.workersResolve[ne]=te,this.workers[ne].postMessage(_,Z)):this.queue.push({resolve:te,msg:_,transfer:Z})})}dispose(){this.workers.forEach(_=>_.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const KHR_SUPERCOMPRESSION_NONE=0,KHR_SUPERCOMPRESSION_ZSTD=2,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT=0,KHR_DF_VENDORID_KHRONOS=0,KHR_DF_VERSION=2,KHR_DF_MODEL_UNSPECIFIED=0,KHR_DF_FLAG_ALPHA_STRAIGHT=0,KHR_DF_FLAG_ALPHA_PREMULTIPLIED=1,KHR_DF_TRANSFER_SRGB=2,KHR_DF_PRIMARIES_UNSPECIFIED=0,KHR_DF_PRIMARIES_BT709=1,KHR_DF_PRIMARIES_DISPLAYP3=10,KHR_DF_SAMPLE_DATATYPE_SIGNED=64,VK_FORMAT_UNDEFINED=0,VK_FORMAT_R8_UNORM=9,VK_FORMAT_R8_SRGB=15,VK_FORMAT_R8G8_UNORM=16,VK_FORMAT_R8G8_SRGB=22,VK_FORMAT_R8G8B8A8_UNORM=37,VK_FORMAT_R8G8B8A8_SRGB=43,VK_FORMAT_R16_SFLOAT=76,VK_FORMAT_R16G16_SFLOAT=83,VK_FORMAT_R16G16B16A16_SFLOAT=97,VK_FORMAT_R32_SFLOAT=100,VK_FORMAT_R32G32_SFLOAT=103,VK_FORMAT_R32G32B32A32_SFLOAT=109,VK_FORMAT_ASTC_6x6_UNORM_BLOCK=165,VK_FORMAT_ASTC_6x6_SRGB_BLOCK=166;class KTX2Container{constructor(){this.vkFormat=VK_FORMAT_UNDEFINED,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=KHR_SUPERCOMPRESSION_NONE,this.levels=[],this.dataFormatDescriptor=[{vendorId:KHR_DF_VENDORID_KHRONOS,descriptorType:KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT,descriptorBlockSize:0,versionNumber:KHR_DF_VERSION,colorModel:KHR_DF_MODEL_UNSPECIFIED,colorPrimaries:KHR_DF_PRIMARIES_BT709,transferFunction:KHR_DF_TRANSFER_SRGB,flags:KHR_DF_FLAG_ALPHA_STRAIGHT,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class BufferReader{constructor(_,Z,te,ne){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(_.buffer,_.byteOffset+Z,te),this._littleEndian=ne,this._offset=0}_nextUint8(){const _=this._dataView.getUint8(this._offset);return this._offset+=1,_}_nextUint16(){const _=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,_}_nextUint32(){const _=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,_}_nextUint64(){const _=this._dataView.getUint32(this._offset,this._littleEndian),Z=this._dataView.getUint32(this._offset+4,this._littleEndian),te=_+2**32*Z;return this._offset+=8,te}_nextInt32(){const _=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,_}_nextUint8Array(_){const Z=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,_);return this._offset+=_,Z}_skip(_){return this._offset+=_,this}_scan(_,Z){Z===void 0&&(Z=0);const te=this._offset;let ne=0;for(;this._dataView.getUint8(this._offset)!==Z&&ne<_;)ne++,this._offset++;return ne<_&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+te,ne)}}const KTX2_ID=[171,75,84,88,32,50,48,187,13,10,26,10];function decodeText(K){return typeof TextDecoder<"u"?new TextDecoder().decode(K):Buffer.from(K).toString("utf8")}function read$1(K){const _=new Uint8Array(K.buffer,K.byteOffset,KTX2_ID.length);if(_[0]!==KTX2_ID[0]||_[1]!==KTX2_ID[1]||_[2]!==KTX2_ID[2]||_[3]!==KTX2_ID[3]||_[4]!==KTX2_ID[4]||_[5]!==KTX2_ID[5]||_[6]!==KTX2_ID[6]||_[7]!==KTX2_ID[7]||_[8]!==KTX2_ID[8]||_[9]!==KTX2_ID[9]||_[10]!==KTX2_ID[10]||_[11]!==KTX2_ID[11])throw new Error("Missing KTX 2.0 identifier.");const Z=new KTX2Container,te=17*Uint32Array.BYTES_PER_ELEMENT,ne=new BufferReader(K,KTX2_ID.length,te,!0);Z.vkFormat=ne._nextUint32(),Z.typeSize=ne._nextUint32(),Z.pixelWidth=ne._nextUint32(),Z.pixelHeight=ne._nextUint32(),Z.pixelDepth=ne._nextUint32(),Z.layerCount=ne._nextUint32(),Z.faceCount=ne._nextUint32();const ie=ne._nextUint32();Z.supercompressionScheme=ne._nextUint32();const oe=ne._nextUint32(),se=ne._nextUint32(),ae=ne._nextUint32(),le=ne._nextUint32(),ce=ne._nextUint64(),fe=ne._nextUint64(),de=ie*3*8,pe=new BufferReader(K,KTX2_ID.length+te,de,!0);for(let ot=0;ot<ie;ot++)Z.levels.push({levelData:new Uint8Array(K.buffer,K.byteOffset+pe._nextUint64(),pe._nextUint64()),uncompressedByteLength:pe._nextUint64()});const he=new BufferReader(K,oe,se,!0),ge={vendorId:he._skip(4)._nextUint16(),descriptorType:he._nextUint16(),versionNumber:he._nextUint16(),descriptorBlockSize:he._nextUint16(),colorModel:he._nextUint8(),colorPrimaries:he._nextUint8(),transferFunction:he._nextUint8(),flags:he._nextUint8(),texelBlockDimension:[he._nextUint8(),he._nextUint8(),he._nextUint8(),he._nextUint8()],bytesPlane:[he._nextUint8(),he._nextUint8(),he._nextUint8(),he._nextUint8(),he._nextUint8(),he._nextUint8(),he._nextUint8(),he._nextUint8()],samples:[]},ye=(ge.descriptorBlockSize/4-6)/4;for(let ot=0;ot<ye;ot++){const Fe={bitOffset:he._nextUint16(),bitLength:he._nextUint8(),channelType:he._nextUint8(),samplePosition:[he._nextUint8(),he._nextUint8(),he._nextUint8(),he._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};Fe.channelType&KHR_DF_SAMPLE_DATATYPE_SIGNED?(Fe.sampleLower=he._nextInt32(),Fe.sampleUpper=he._nextInt32()):(Fe.sampleLower=he._nextUint32(),Fe.sampleUpper=he._nextUint32()),ge.samples[ot]=Fe}Z.dataFormatDescriptor.length=0,Z.dataFormatDescriptor.push(ge);const ve=new BufferReader(K,ae,le,!0);for(;ve._offset<le;){const ot=ve._nextUint32(),Fe=ve._scan(ot),ct=decodeText(Fe);if(Z.keyValue[ct]=ve._nextUint8Array(ot-Fe.byteLength-1),ct.match(/^ktx/i)){const lt=decodeText(Z.keyValue[ct]);Z.keyValue[ct]=lt.substring(0,lt.lastIndexOf("\0"))}const ht=ot%4?4-ot%4:0;ve._skip(ht)}if(fe<=0)return Z;const _e=new BufferReader(K,ce,fe,!0),Te=_e._nextUint16(),be=_e._nextUint16(),Re=_e._nextUint32(),we=_e._nextUint32(),Pe=_e._nextUint32(),Ie=_e._nextUint32(),$e=[];for(let ot=0;ot<ie;ot++)$e.push({imageFlags:_e._nextUint32(),rgbSliceByteOffset:_e._nextUint32(),rgbSliceByteLength:_e._nextUint32(),alphaSliceByteOffset:_e._nextUint32(),alphaSliceByteLength:_e._nextUint32()});const Ue=ce+_e._offset,ke=Ue+Re,Ge=ke+we,He=Ge+Pe,ze=new Uint8Array(K.buffer,K.byteOffset+Ue,Re),Ke=new Uint8Array(K.buffer,K.byteOffset+ke,we),tt=new Uint8Array(K.buffer,K.byteOffset+Ge,Pe),Je=new Uint8Array(K.buffer,K.byteOffset+He,Ie);return Z.globalData={endpointCount:Te,selectorCount:be,imageDescs:$e,endpointsData:ze,selectorsData:Ke,tablesData:tt,extendedData:Je},Z}let init,instance,heap;const IMPORT_OBJECT={env:{emscripten_notify_memory_growth:function(K){heap=new Uint8Array(instance.exports.memory.buffer)}}};class ZSTDDecoder{init(){return init||(typeof fetch<"u"?init=fetch("data:application/wasm;base64,"+wasm).then(_=>_.arrayBuffer()).then(_=>WebAssembly.instantiate(_,IMPORT_OBJECT)).then(this._init):init=WebAssembly.instantiate(Buffer.from(wasm,"base64"),IMPORT_OBJECT).then(this._init),init)}_init(_){instance=_.instance,IMPORT_OBJECT.env.emscripten_notify_memory_growth(0)}decode(_,Z=0){if(!instance)throw new Error("ZSTDDecoder: Await .init() before decoding.");const te=_.byteLength,ne=instance.exports.malloc(te);heap.set(_,ne),Z=Z||Number(instance.exports.ZSTD_findDecompressedSize(ne,te));const ie=instance.exports.malloc(Z),oe=instance.exports.ZSTD_decompress(ie,Z,ne,te),se=heap.slice(ie,ie+oe);return instance.exports.free(ne),instance.exports.free(ie),se}}const wasm="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ";class CompressedCubeTexture extends CompressedTexture{constructor(_,Z,te){super(void 0,_[0].width,_[0].height,Z,te,CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=_}}class CompressedArrayTexture extends CompressedTexture{constructor(_,Z,te,ne,ie,oe){super(_,Z,te,ie,oe),this.isCompressedArrayTexture=!0,this.image.depth=ne,this.wrapR=ClampToEdgeWrapping}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(K,_,Z)=>_ in K?__defProp$2(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$2=(K,_,Z)=>(__defNormalProp$2(K,typeof _!="symbol"?_+"":_,Z),Z);const LinearEncoding=3e3,sRGBEncoding=3001,NoColorSpace="",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearSRGBColorSpace="srgb-linear",SRGBColorSpace="srgb",_taskCache$1=new WeakMap;let _activeLoaders=0,_zstd;const KTX2Loader=(()=>{const K=class extends Loader{constructor(Z){super(Z),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(Z){return this.transcoderPath=Z,this}setWorkerLimit(Z){return this.workerPool.setWorkerLimit(Z),this}detectSupport(Z){return this.workerConfig={astcSupported:Z.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:Z.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:Z.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:Z.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:Z.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:Z.extensions.has("WEBGL_compressed_texture_pvrtc")||Z.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},Z.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const Z=new FileLoader(this.manager);Z.setPath(this.transcoderPath),Z.setWithCredentials(this.withCredentials);const te=Z.loadAsync("basis_transcoder.js"),ne=new FileLoader(this.manager);ne.setPath(this.transcoderPath),ne.setResponseType("arraybuffer"),ne.setWithCredentials(this.withCredentials);const ie=ne.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([te,ie]).then(([oe,se])=>{const ae=K.BasisWorker.toString(),le=["/* constants */","let _EngineFormat = "+JSON.stringify(K.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(K.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(K.BasisFormat),"/* basis_transcoder.js */",oe,"/* worker */",ae.substring(ae.indexOf("{")+1,ae.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([le])),this.transcoderBinary=se,this.workerPool.setWorkerCreator(()=>{const ce=new Worker(this.workerSourceURL),fe=this.transcoderBinary.slice(0);return ce.postMessage({type:"init",config:this.workerConfig,transcoderBinary:fe},[fe]),ce})}),_activeLoaders>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),_activeLoaders++}return this.transcoderPending}load(Z,te,ne,ie){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const oe=new FileLoader(this.manager);oe.setResponseType("arraybuffer"),oe.setWithCredentials(this.withCredentials),oe.load(Z,se=>{if(_taskCache$1.has(se))return _taskCache$1.get(se).promise.then(te).catch(ie);this._createTexture(se).then(ae=>te?te(ae):null).catch(ie)},ne,ie)}_createTextureFrom(Z,te){const{faces:ne,width:ie,height:oe,format:se,type:ae,error:le,dfdFlags:ce}=Z;if(ae==="error")return Promise.reject(le);let fe;if(te.faceCount===6)fe=new CompressedCubeTexture(ne,se,UnsignedByteType);else{const pe=ne[0].mipmaps;fe=te.layerCount>1?new CompressedArrayTexture(pe,ie,oe,te.layerCount,se,UnsignedByteType):new CompressedTexture(pe,ie,oe,se,UnsignedByteType)}fe.minFilter=ne[0].mipmaps.length===1?LinearFilter:LinearMipmapLinearFilter,fe.magFilter=LinearFilter,fe.generateMipmaps=!1,fe.needsUpdate=!0;const de=parseColorSpace(te);return"colorSpace"in fe?fe.colorSpace=de:fe.encoding=de===SRGBColorSpace?sRGBEncoding:LinearEncoding,fe.premultiplyAlpha=!!(ce&KHR_DF_FLAG_ALPHA_PREMULTIPLIED),fe}async _createTexture(Z,te={}){const ne=read$1(new Uint8Array(Z));if(ne.vkFormat!==VK_FORMAT_UNDEFINED)return createRawTexture(ne);const ie=te,oe=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:Z,taskConfig:ie},[Z])).then(se=>this._createTextureFrom(se.data,ne));return _taskCache$1.set(Z,{promise:oe}),oe}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),_activeLoaders--,this}};let _=K;return __publicField$2(_,"BasisFormat",{ETC1S:0,UASTC_4x4:1}),__publicField$2(_,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16}),__publicField$2(_,"EngineFormat",{RGBAFormat,RGBA_ASTC_4x4_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format}),__publicField$2(_,"BasisWorker",function(){let Z,te,ne;const ie=_EngineFormat,oe=_TranscoderFormat,se=_BasisFormat;self.addEventListener("message",function(me){const Ae=me.data;switch(Ae.type){case"init":Z=Ae.config,ae(Ae.transcoderBinary);break;case"transcode":te.then(()=>{try{const{faces:ye,buffers:ve,width:_e,height:Te,hasAlpha:be,format:Re,dfdFlags:we}=le(Ae.buffer);self.postMessage({type:"transcode",id:Ae.id,faces:ye,width:_e,height:Te,hasAlpha:be,format:Re,dfdFlags:we},ve)}catch(ye){console.error(ye),self.postMessage({type:"error",id:Ae.id,error:ye.message})}});break}});function ae(me){te=new Promise(Ae=>{ne={wasmBinary:me,onRuntimeInitialized:Ae},BASIS(ne)}).then(()=>{ne.initializeBasis(),ne.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function le(me){const Ae=new ne.KTX2File(new Uint8Array(me));function ye(){Ae.close(),Ae.delete()}if(!Ae.isValid())throw ye(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const ve=Ae.isUASTC()?se.UASTC_4x4:se.ETC1S,_e=Ae.getWidth(),Te=Ae.getHeight(),be=Ae.getLayers()||1,Re=Ae.getLevels(),we=Ae.getFaces(),Pe=Ae.getHasAlpha(),Ie=Ae.getDFDFlags(),{transcoderFormat:$e,engineFormat:Ue}=pe(ve,_e,Te,Pe);if(!_e||!Te||!Re)throw ye(),new Error("THREE.KTX2Loader:	Invalid texture");if(!Ae.startTranscoding())throw ye(),new Error("THREE.KTX2Loader: .startTranscoding failed");const ke=[],Ge=[];for(let He=0;He<we;He++){const ze=[];for(let Ke=0;Ke<Re;Ke++){const tt=[];let Je,ot;for(let ct=0;ct<be;ct++){const ht=Ae.getImageLevelInfo(Ke,ct,He);He===0&&Ke===0&&ct===0&&(ht.origWidth%4!==0||ht.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),Re>1?(Je=ht.origWidth,ot=ht.origHeight):(Je=ht.width,ot=ht.height);const lt=new Uint8Array(Ae.getImageTranscodedSizeInBytes(Ke,ct,0,$e));if(!Ae.transcodeImage(lt,Ke,ct,He,$e,0,-1,-1))throw ye(),new Error("THREE.KTX2Loader: .transcodeImage failed.");tt.push(lt)}const Fe=ge(tt);ze.push({data:Fe,width:Je,height:ot}),Ge.push(Fe.buffer)}ke.push({mipmaps:ze,width:_e,height:Te,format:Ue})}return ye(),{faces:ke,buffers:Ge,width:_e,height:Te,hasAlpha:Pe,format:Ue,dfdFlags:Ie}}const ce=[{if:"astcSupported",basisFormat:[se.UASTC_4x4],transcoderFormat:[oe.ASTC_4x4,oe.ASTC_4x4],engineFormat:[ie.RGBA_ASTC_4x4_Format,ie.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[se.ETC1S,se.UASTC_4x4],transcoderFormat:[oe.BC7_M5,oe.BC7_M5],engineFormat:[ie.RGBA_BPTC_Format,ie.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[se.ETC1S,se.UASTC_4x4],transcoderFormat:[oe.BC1,oe.BC3],engineFormat:[ie.RGB_S3TC_DXT1_Format,ie.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[se.ETC1S,se.UASTC_4x4],transcoderFormat:[oe.ETC1,oe.ETC2],engineFormat:[ie.RGB_ETC2_Format,ie.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[se.ETC1S,se.UASTC_4x4],transcoderFormat:[oe.ETC1],engineFormat:[ie.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[se.ETC1S,se.UASTC_4x4],transcoderFormat:[oe.PVRTC1_4_RGB,oe.PVRTC1_4_RGBA],engineFormat:[ie.RGB_PVRTC_4BPPV1_Format,ie.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],fe=ce.sort(function(me,Ae){return me.priorityETC1S-Ae.priorityETC1S}),de=ce.sort(function(me,Ae){return me.priorityUASTC-Ae.priorityUASTC});function pe(me,Ae,ye,ve){let _e,Te;const be=me===se.ETC1S?fe:de;for(let Re=0;Re<be.length;Re++){const we=be[Re];if(Z[we.if]&&we.basisFormat.includes(me)&&!(ve&&we.transcoderFormat.length<2)&&!(we.needsPowerOfTwo&&!(he(Ae)&&he(ye))))return _e=we.transcoderFormat[ve?1:0],Te=we.engineFormat[ve?1:0],{transcoderFormat:_e,engineFormat:Te}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),_e=oe.RGBA32,Te=ie.RGBAFormat,{transcoderFormat:_e,engineFormat:Te}}function he(me){return me<=2?!0:(me&me-1)===0&&me!==0}function ge(me){if(me.length===1)return me[0];let Ae=0;for(let _e=0;_e<me.length;_e++){const Te=me[_e];Ae+=Te.byteLength}const ye=new Uint8Array(Ae);let ve=0;for(let _e=0;_e<me.length;_e++){const Te=me[_e];ye.set(Te,ve),ve+=Te.byteLength}return ye}}),_})(),UNCOMPRESSED_FORMATS=new Set([RGBAFormat,RGFormat,RedFormat]),FORMAT_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:RGBAFormat,[VK_FORMAT_R16G16B16A16_SFLOAT]:RGBAFormat,[VK_FORMAT_R8G8B8A8_UNORM]:RGBAFormat,[VK_FORMAT_R8G8B8A8_SRGB]:RGBAFormat,[VK_FORMAT_R32G32_SFLOAT]:RGFormat,[VK_FORMAT_R16G16_SFLOAT]:RGFormat,[VK_FORMAT_R8G8_UNORM]:RGFormat,[VK_FORMAT_R8G8_SRGB]:RGFormat,[VK_FORMAT_R32_SFLOAT]:RedFormat,[VK_FORMAT_R16_SFLOAT]:RedFormat,[VK_FORMAT_R8_SRGB]:RedFormat,[VK_FORMAT_R8_UNORM]:RedFormat,[VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:RGBA_ASTC_6x6_Format,[VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:RGBA_ASTC_6x6_Format},TYPE_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:FloatType,[VK_FORMAT_R16G16B16A16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8B8A8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8B8A8_SRGB]:UnsignedByteType,[VK_FORMAT_R32G32_SFLOAT]:FloatType,[VK_FORMAT_R16G16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8_SRGB]:UnsignedByteType,[VK_FORMAT_R32_SFLOAT]:FloatType,[VK_FORMAT_R16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8_SRGB]:UnsignedByteType,[VK_FORMAT_R8_UNORM]:UnsignedByteType,[VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:UnsignedByteType,[VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:UnsignedByteType};async function createRawTexture(K){const{vkFormat:_}=K;if(FORMAT_MAP[_]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let Z;K.supercompressionScheme===KHR_SUPERCOMPRESSION_ZSTD&&(_zstd||(_zstd=new Promise(async oe=>{const se=new ZSTDDecoder;await se.init(),oe(se)})),Z=await _zstd);const te=[];for(let oe=0;oe<K.levels.length;oe++){const se=Math.max(1,K.pixelWidth>>oe),ae=Math.max(1,K.pixelHeight>>oe),le=K.pixelDepth?Math.max(1,K.pixelDepth>>oe):0,ce=K.levels[oe];let fe;if(K.supercompressionScheme===KHR_SUPERCOMPRESSION_NONE)fe=ce.levelData;else if(K.supercompressionScheme===KHR_SUPERCOMPRESSION_ZSTD)fe=Z.decode(ce.levelData,ce.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let de;TYPE_MAP[_]===FloatType?de=new Float32Array(fe.buffer,fe.byteOffset,fe.byteLength/Float32Array.BYTES_PER_ELEMENT):TYPE_MAP[_]===HalfFloatType?de=new Uint16Array(fe.buffer,fe.byteOffset,fe.byteLength/Uint16Array.BYTES_PER_ELEMENT):de=fe,te.push({data:de,width:se,height:ae,depth:le})}let ne;if(UNCOMPRESSED_FORMATS.has(FORMAT_MAP[_]))ne=K.pixelDepth===0?new DataTexture(te[0].data,K.pixelWidth,K.pixelHeight):new Data3DTexture(te[0].data,K.pixelWidth,K.pixelHeight,K.pixelDepth);else{if(K.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");ne=new CompressedTexture(te,K.pixelWidth,K.pixelHeight)}ne.mipmaps=te,ne.type=TYPE_MAP[_],ne.format=FORMAT_MAP[_],ne.needsUpdate=!0;const ie=parseColorSpace(K);return"colorSpace"in ne?ne.colorSpace=ie:ne.encoding=ie===SRGBColorSpace?sRGBEncoding:LinearEncoding,Promise.resolve(ne)}function parseColorSpace(K){const _=K.dataFormatDescriptor[0];return _.colorPrimaries===KHR_DF_PRIMARIES_BT709?_.transferFunction===KHR_DF_TRANSFER_SRGB?SRGBColorSpace:LinearSRGBColorSpace:_.colorPrimaries===KHR_DF_PRIMARIES_DISPLAYP3?_.transferFunction===KHR_DF_TRANSFER_SRGB?DisplayP3ColorSpace:LinearDisplayP3ColorSpace:(_.colorPrimaries===KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${_.colorPrimaries}"`),NoColorSpace)}class RGBELoader extends DataTextureLoader{constructor(_){super(_),this.type=HalfFloatType}parse(_){const oe=function(we,Pe){switch(we){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(Pe||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(Pe||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(Pe||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(Pe||""))}},ce=`
`,fe=function(we,Pe,Ie){Pe=Pe||1024;let Ue=we.pos,ke=-1,Ge=0,He="",ze=String.fromCharCode.apply(null,new Uint16Array(we.subarray(Ue,Ue+128)));for(;0>(ke=ze.indexOf(ce))&&Ge<Pe&&Ue<we.byteLength;)He+=ze,Ge+=ze.length,Ue+=128,ze+=String.fromCharCode.apply(null,new Uint16Array(we.subarray(Ue,Ue+128)));return-1<ke?(we.pos+=Ge+ke+1,He+ze.slice(0,ke)):!1},de=function(we){const Pe=/^#\?(\S+)/,Ie=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,$e=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Ue=/^\s*FORMAT=(\S+)\s*$/,ke=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Ge={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let He,ze;for((we.pos>=we.byteLength||!(He=fe(we)))&&oe(1,"no header found"),(ze=He.match(Pe))||oe(3,"bad initial token"),Ge.valid|=1,Ge.programtype=ze[1],Ge.string+=He+`
`;He=fe(we),He!==!1;){if(Ge.string+=He+`
`,He.charAt(0)==="#"){Ge.comments+=He+`
`;continue}if((ze=He.match(Ie))&&(Ge.gamma=parseFloat(ze[1])),(ze=He.match($e))&&(Ge.exposure=parseFloat(ze[1])),(ze=He.match(Ue))&&(Ge.valid|=2,Ge.format=ze[1]),(ze=He.match(ke))&&(Ge.valid|=4,Ge.height=parseInt(ze[1],10),Ge.width=parseInt(ze[2],10)),Ge.valid&2&&Ge.valid&4)break}return Ge.valid&2||oe(3,"missing format specifier"),Ge.valid&4||oe(3,"missing image size specifier"),Ge},pe=function(we,Pe,Ie){const $e=Pe;if($e<8||$e>32767||we[0]!==2||we[1]!==2||we[2]&128)return new Uint8Array(we);$e!==(we[2]<<8|we[3])&&oe(3,"wrong scanline width");const Ue=new Uint8Array(4*Pe*Ie);Ue.length||oe(4,"unable to allocate buffer space");let ke=0,Ge=0;const He=4*$e,ze=new Uint8Array(4),Ke=new Uint8Array(He);let tt=Ie;for(;tt>0&&Ge<we.byteLength;){Ge+4>we.byteLength&&oe(1),ze[0]=we[Ge++],ze[1]=we[Ge++],ze[2]=we[Ge++],ze[3]=we[Ge++],(ze[0]!=2||ze[1]!=2||(ze[2]<<8|ze[3])!=$e)&&oe(3,"bad rgbe scanline format");let Je=0,ot;for(;Je<He&&Ge<we.byteLength;){ot=we[Ge++];const ct=ot>128;if(ct&&(ot-=128),(ot===0||Je+ot>He)&&oe(3,"bad scanline data"),ct){const ht=we[Ge++];for(let lt=0;lt<ot;lt++)Ke[Je++]=ht}else Ke.set(we.subarray(Ge,Ge+ot),Je),Je+=ot,Ge+=ot}const Fe=$e;for(let ct=0;ct<Fe;ct++){let ht=0;Ue[ke]=Ke[ct+ht],ht+=$e,Ue[ke+1]=Ke[ct+ht],ht+=$e,Ue[ke+2]=Ke[ct+ht],ht+=$e,Ue[ke+3]=Ke[ct+ht],ke+=4}tt--}return Ue},he=function(we,Pe,Ie,$e){const Ue=we[Pe+3],ke=Math.pow(2,Ue-128)/255;Ie[$e+0]=we[Pe+0]*ke,Ie[$e+1]=we[Pe+1]*ke,Ie[$e+2]=we[Pe+2]*ke,Ie[$e+3]=1},ge=function(we,Pe,Ie,$e){const Ue=we[Pe+3],ke=Math.pow(2,Ue-128)/255;Ie[$e+0]=DataUtils.toHalfFloat(Math.min(we[Pe+0]*ke,65504)),Ie[$e+1]=DataUtils.toHalfFloat(Math.min(we[Pe+1]*ke,65504)),Ie[$e+2]=DataUtils.toHalfFloat(Math.min(we[Pe+2]*ke,65504)),Ie[$e+3]=DataUtils.toHalfFloat(1)},me=new Uint8Array(_);me.pos=0;const Ae=de(me),ye=Ae.width,ve=Ae.height,_e=pe(me.subarray(me.pos),ye,ve);let Te,be,Re;switch(this.type){case FloatType:Re=_e.length/4;const we=new Float32Array(Re*4);for(let Ie=0;Ie<Re;Ie++)he(_e,Ie*4,we,Ie*4);Te=we,be=FloatType;break;case HalfFloatType:Re=_e.length/4;const Pe=new Uint16Array(Re*4);for(let Ie=0;Ie<Re;Ie++)ge(_e,Ie*4,Pe,Ie*4);Te=Pe,be=HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:ye,height:ve,data:Te,header:Ae.string,gamma:Ae.gamma,exposure:Ae.exposure,type:be}}setDataType(_){return this.type=_,this}load(_,Z,te,ne){function ie(oe,se){switch(oe.type){case FloatType:case HalfFloatType:"colorSpace"in oe?oe.colorSpace="srgb-linear":oe.encoding=3e3,oe.minFilter=LinearFilter,oe.magFilter=LinearFilter,oe.generateMipmaps=!1,oe.flipY=!0;break}Z&&Z(oe,se)}return super.load(_,ie,te,ne)}}const hasColorSpace=version$4>=152;class EXRLoader extends DataTextureLoader{constructor(_){super(_),this.type=HalfFloatType}parse(_){const Pe=Math.pow(2.7182818,2.2);function Ie(gt,wt){for(var jt=0,rn=0;rn<65536;++rn)(rn==0||gt[rn>>3]&1<<(rn&7))&&(wt[jt++]=rn);for(var un=jt-1;jt<65536;)wt[jt++]=0;return un}function $e(gt){for(var wt=0;wt<16384;wt++)gt[wt]={},gt[wt].len=0,gt[wt].lit=0,gt[wt].p=null}const Ue={l:0,c:0,lc:0};function ke(gt,wt,jt,rn,un){for(;jt<gt;)wt=wt<<8|qt(rn,un),jt+=8;jt-=gt,Ue.l=wt>>jt&(1<<gt)-1,Ue.c=wt,Ue.lc=jt}const Ge=new Array(59);function He(gt){for(var wt=0;wt<=58;++wt)Ge[wt]=0;for(var wt=0;wt<65537;++wt)Ge[gt[wt]]+=1;for(var jt=0,wt=58;wt>0;--wt){var rn=jt+Ge[wt]>>1;Ge[wt]=jt,jt=rn}for(var wt=0;wt<65537;++wt){var un=gt[wt];un>0&&(gt[wt]=un|Ge[un]++<<6)}}function ze(gt,wt,jt,rn,un,dn,Tn){for(var Sn=jt,At=0,Dt=0;un<=dn;un++){if(Sn.value-jt.value>rn)return!1;ke(6,At,Dt,gt,Sn);var $t=Ue.l;if(At=Ue.c,Dt=Ue.lc,Tn[un]=$t,$t==63){if(Sn.value-jt.value>rn)throw"Something wrong with hufUnpackEncTable";ke(8,At,Dt,gt,Sn);var Bt=Ue.l+6;if(At=Ue.c,Dt=Ue.lc,un+Bt>dn+1)throw"Something wrong with hufUnpackEncTable";for(;Bt--;)Tn[un++]=0;un--}else if($t>=59){var Bt=$t-59+2;if(un+Bt>dn+1)throw"Something wrong with hufUnpackEncTable";for(;Bt--;)Tn[un++]=0;un--}}He(Tn)}function Ke(gt){return gt&63}function tt(gt){return gt>>6}function Je(gt,wt,jt,rn){for(;wt<=jt;wt++){var un=tt(gt[wt]),dn=Ke(gt[wt]);if(un>>dn)throw"Invalid table entry";if(dn>14){var Tn=rn[un>>dn-14];if(Tn.len)throw"Invalid table entry";if(Tn.lit++,Tn.p){var Sn=Tn.p;Tn.p=new Array(Tn.lit);for(var At=0;At<Tn.lit-1;++At)Tn.p[At]=Sn[At]}else Tn.p=new Array(1);Tn.p[Tn.lit-1]=wt}else if(dn)for(var Dt=0,At=1<<14-dn;At>0;At--){var Tn=rn[(un<<14-dn)+Dt];if(Tn.len||Tn.p)throw"Invalid table entry";Tn.len=dn,Tn.lit=wt,Dt++}}return!0}const ot={c:0,lc:0};function Fe(gt,wt,jt,rn){gt=gt<<8|qt(jt,rn),wt+=8,ot.c=gt,ot.lc=wt}const ct={c:0,lc:0};function ht(gt,wt,jt,rn,un,dn,Tn,Sn,At,Dt){if(gt==wt){rn<8&&(Fe(jt,rn,un,Tn),jt=ot.c,rn=ot.lc),rn-=8;var $t=jt>>rn,$t=new Uint8Array([$t])[0];if(At.value+$t>Dt)return!1;for(var Bt=Sn[At.value-1];$t-- >0;)Sn[At.value++]=Bt}else if(At.value<Dt)Sn[At.value++]=gt;else return!1;ct.c=jt,ct.lc=rn}function lt(gt){return gt&65535}function Qe(gt){var wt=lt(gt);return wt>32767?wt-65536:wt}const Ze={a:0,b:0};function it(gt,wt){var jt=Qe(gt),rn=Qe(wt),un=rn,dn=jt+(un&1)+(un>>1),Tn=dn,Sn=dn-un;Ze.a=Tn,Ze.b=Sn}function nt(gt,wt){var jt=lt(gt),rn=lt(wt),un=jt-(rn>>1)&65535,dn=rn+un-32768&65535;Ze.a=dn,Ze.b=un}function Tt(gt,wt,jt,rn,un,dn,Tn){for(var Sn=Tn<16384,At=jt>un?un:jt,Dt=1,$t;Dt<=At;)Dt<<=1;for(Dt>>=1,$t=Dt,Dt>>=1;Dt>=1;){for(var Bt=0,Wt=Bt+dn*(un-$t),tn=dn*Dt,cn=dn*$t,An=rn*Dt,En=rn*$t,Bn,In,Cn,wn;Bt<=Wt;Bt+=cn){for(var bn=Bt,nr=Bt+rn*(jt-$t);bn<=nr;bn+=En){var Fn=bn+An,On=bn+tn,Nn=On+An;Sn?(it(gt[bn+wt],gt[On+wt]),Bn=Ze.a,Cn=Ze.b,it(gt[Fn+wt],gt[Nn+wt]),In=Ze.a,wn=Ze.b,it(Bn,In),gt[bn+wt]=Ze.a,gt[Fn+wt]=Ze.b,it(Cn,wn),gt[On+wt]=Ze.a,gt[Nn+wt]=Ze.b):(nt(gt[bn+wt],gt[On+wt]),Bn=Ze.a,Cn=Ze.b,nt(gt[Fn+wt],gt[Nn+wt]),In=Ze.a,wn=Ze.b,nt(Bn,In),gt[bn+wt]=Ze.a,gt[Fn+wt]=Ze.b,nt(Cn,wn),gt[On+wt]=Ze.a,gt[Nn+wt]=Ze.b)}if(jt&Dt){var On=bn+tn;Sn?it(gt[bn+wt],gt[On+wt]):nt(gt[bn+wt],gt[On+wt]),Bn=Ze.a,gt[On+wt]=Ze.b,gt[bn+wt]=Bn}}if(un&Dt)for(var bn=Bt,nr=Bt+rn*(jt-$t);bn<=nr;bn+=En){var Fn=bn+An;Sn?it(gt[bn+wt],gt[Fn+wt]):nt(gt[bn+wt],gt[Fn+wt]),Bn=Ze.a,gt[Fn+wt]=Ze.b,gt[bn+wt]=Bn}$t=Dt,Dt>>=1}return Bt}function St(gt,wt,jt,rn,un,dn,Tn,Sn,At,Dt){for(var $t=0,Bt=0,Wt=Sn,tn=Math.trunc(un.value+(dn+7)/8);un.value<tn;)for(Fe($t,Bt,jt,un),$t=ot.c,Bt=ot.lc;Bt>=14;){var cn=$t>>Bt-14&16383,An=wt[cn];if(An.len)Bt-=An.len,ht(An.lit,Tn,$t,Bt,jt,rn,un,At,Dt,Wt),$t=ct.c,Bt=ct.lc;else{if(!An.p)throw"hufDecode issues";var En;for(En=0;En<An.lit;En++){for(var Bn=Ke(gt[An.p[En]]);Bt<Bn&&un.value<tn;)Fe($t,Bt,jt,un),$t=ot.c,Bt=ot.lc;if(Bt>=Bn&&tt(gt[An.p[En]])==($t>>Bt-Bn&(1<<Bn)-1)){Bt-=Bn,ht(An.p[En],Tn,$t,Bt,jt,rn,un,At,Dt,Wt),$t=ct.c,Bt=ct.lc;break}}if(En==An.lit)throw"hufDecode issues"}}var In=8-dn&7;for($t>>=In,Bt-=In;Bt>0;){var An=wt[$t<<14-Bt&16383];if(An.len)Bt-=An.len,ht(An.lit,Tn,$t,Bt,jt,rn,un,At,Dt,Wt),$t=ct.c,Bt=ct.lc;else throw"hufDecode issues"}return!0}function Et(gt,wt,jt,rn,un,dn){var Tn={value:0},Sn=jt.value,At=Qt(wt,jt),Dt=Qt(wt,jt);jt.value+=4;var $t=Qt(wt,jt);if(jt.value+=4,At<0||At>=65537||Dt<0||Dt>=65537)throw"Something wrong with HUF_ENCSIZE";var Bt=new Array(65537),Wt=new Array(16384);$e(Wt);var tn=rn-(jt.value-Sn);if(ze(gt,wt,jt,tn,At,Dt,Bt),$t>8*(rn-(jt.value-Sn)))throw"Something wrong with hufUncompress";Je(Bt,At,Dt,Wt),St(Bt,Wt,gt,wt,jt,$t,Dt,dn,un,Tn)}function Nt(gt,wt,jt){for(var rn=0;rn<jt;++rn)wt[rn]=gt[wt[rn]]}function zt(gt){for(var wt=1;wt<gt.length;wt++){var jt=gt[wt-1]+gt[wt]-128;gt[wt]=jt}}function yt(gt,wt){for(var jt=0,rn=Math.floor((gt.length+1)/2),un=0,dn=gt.length-1;!(un>dn||(wt[un++]=gt[jt++],un>dn));)wt[un++]=gt[rn++]}function Ut(gt){for(var wt=gt.byteLength,jt=new Array,rn=0,un=new DataView(gt);wt>0;){var dn=un.getInt8(rn++);if(dn<0){var Tn=-dn;wt-=Tn+1;for(var Sn=0;Sn<Tn;Sn++)jt.push(un.getUint8(rn++))}else{var Tn=dn;wt-=2;for(var At=un.getUint8(rn++),Sn=0;Sn<Tn+1;Sn++)jt.push(At)}}return jt}function bt(gt,wt,jt,rn,un,dn){var Fn=new DataView(dn.buffer),Tn=jt[gt.idx[0]].width,Sn=jt[gt.idx[0]].height,At=3,Dt=Math.floor(Tn/8),$t=Math.ceil(Tn/8),Bt=Math.ceil(Sn/8),Wt=Tn-($t-1)*8,tn=Sn-(Bt-1)*8,cn={value:0},An=new Array(At),En=new Array(At),Bn=new Array(At),In=new Array(At),Cn=new Array(At);for(let Zn=0;Zn<At;++Zn)Cn[Zn]=wt[gt.idx[Zn]],An[Zn]=Zn<1?0:An[Zn-1]+$t*Bt,En[Zn]=new Float32Array(64),Bn[Zn]=new Uint16Array(64),In[Zn]=new Uint16Array($t*64);for(let Zn=0;Zn<Bt;++Zn){var wn=8;Zn==Bt-1&&(wn=tn);var bn=8;for(let er=0;er<$t;++er){er==$t-1&&(bn=Wt);for(let Jn=0;Jn<At;++Jn)Bn[Jn].fill(0),Bn[Jn][0]=un[An[Jn]++],Ot(cn,rn,Bn[Jn]),Mt(Bn[Jn],En[Jn]),_t(En[Jn]);pt(En);for(let Jn=0;Jn<At;++Jn)ft(En[Jn],In[Jn],er*64)}let Un=0;for(let er=0;er<At;++er){const Jn=jt[gt.idx[er]].type;for(let rr=8*Zn;rr<8*Zn+wn;++rr){Un=Cn[er][rr];for(let sr=0;sr<Dt;++sr){const fr=sr*64+(rr&7)*8;Fn.setUint16(Un+0*2*Jn,In[er][fr+0],!0),Fn.setUint16(Un+1*2*Jn,In[er][fr+1],!0),Fn.setUint16(Un+2*2*Jn,In[er][fr+2],!0),Fn.setUint16(Un+3*2*Jn,In[er][fr+3],!0),Fn.setUint16(Un+4*2*Jn,In[er][fr+4],!0),Fn.setUint16(Un+5*2*Jn,In[er][fr+5],!0),Fn.setUint16(Un+6*2*Jn,In[er][fr+6],!0),Fn.setUint16(Un+7*2*Jn,In[er][fr+7],!0),Un+=8*2*Jn}}if(Dt!=$t)for(let rr=8*Zn;rr<8*Zn+wn;++rr){const sr=Cn[er][rr]+8*Dt*2*Jn,fr=Dt*64+(rr&7)*8;for(let hr=0;hr<bn;++hr)Fn.setUint16(sr+hr*2*Jn,In[er][fr+hr],!0)}}}for(var nr=new Uint16Array(Tn),Fn=new DataView(dn.buffer),On=0;On<At;++On){jt[gt.idx[On]].decoded=!0;var Nn=jt[gt.idx[On]].type;if(jt[On].type==2)for(var mr=0;mr<Sn;++mr){const Zn=Cn[On][mr];for(var zn=0;zn<Tn;++zn)nr[zn]=Fn.getUint16(Zn+zn*2*Nn,!0);for(var zn=0;zn<Tn;++zn)Fn.setFloat32(Zn+zn*2*Nn,Ht(nr[zn]),!0)}}}function Ot(gt,wt,jt){for(var rn,un=1;un<64;)rn=wt[gt.value],rn==65280?un=64:rn>>8==255?un+=rn&255:(jt[un]=rn,un++),gt.value++}function Mt(gt,wt){wt[0]=Ht(gt[0]),wt[1]=Ht(gt[1]),wt[2]=Ht(gt[5]),wt[3]=Ht(gt[6]),wt[4]=Ht(gt[14]),wt[5]=Ht(gt[15]),wt[6]=Ht(gt[27]),wt[7]=Ht(gt[28]),wt[8]=Ht(gt[2]),wt[9]=Ht(gt[4]),wt[10]=Ht(gt[7]),wt[11]=Ht(gt[13]),wt[12]=Ht(gt[16]),wt[13]=Ht(gt[26]),wt[14]=Ht(gt[29]),wt[15]=Ht(gt[42]),wt[16]=Ht(gt[3]),wt[17]=Ht(gt[8]),wt[18]=Ht(gt[12]),wt[19]=Ht(gt[17]),wt[20]=Ht(gt[25]),wt[21]=Ht(gt[30]),wt[22]=Ht(gt[41]),wt[23]=Ht(gt[43]),wt[24]=Ht(gt[9]),wt[25]=Ht(gt[11]),wt[26]=Ht(gt[18]),wt[27]=Ht(gt[24]),wt[28]=Ht(gt[31]),wt[29]=Ht(gt[40]),wt[30]=Ht(gt[44]),wt[31]=Ht(gt[53]),wt[32]=Ht(gt[10]),wt[33]=Ht(gt[19]),wt[34]=Ht(gt[23]),wt[35]=Ht(gt[32]),wt[36]=Ht(gt[39]),wt[37]=Ht(gt[45]),wt[38]=Ht(gt[52]),wt[39]=Ht(gt[54]),wt[40]=Ht(gt[20]),wt[41]=Ht(gt[22]),wt[42]=Ht(gt[33]),wt[43]=Ht(gt[38]),wt[44]=Ht(gt[46]),wt[45]=Ht(gt[51]),wt[46]=Ht(gt[55]),wt[47]=Ht(gt[60]),wt[48]=Ht(gt[21]),wt[49]=Ht(gt[34]),wt[50]=Ht(gt[37]),wt[51]=Ht(gt[47]),wt[52]=Ht(gt[50]),wt[53]=Ht(gt[56]),wt[54]=Ht(gt[59]),wt[55]=Ht(gt[61]),wt[56]=Ht(gt[35]),wt[57]=Ht(gt[36]),wt[58]=Ht(gt[48]),wt[59]=Ht(gt[49]),wt[60]=Ht(gt[57]),wt[61]=Ht(gt[58]),wt[62]=Ht(gt[62]),wt[63]=Ht(gt[63])}function _t(gt){const wt=.5*Math.cos(.7853975),jt=.5*Math.cos(3.14159/16),rn=.5*Math.cos(3.14159/8),un=.5*Math.cos(3*3.14159/16),dn=.5*Math.cos(5*3.14159/16),Tn=.5*Math.cos(3*3.14159/8),Sn=.5*Math.cos(7*3.14159/16);for(var At=new Array(4),Dt=new Array(4),$t=new Array(4),Bt=new Array(4),Wt=0;Wt<8;++Wt){var tn=Wt*8;At[0]=rn*gt[tn+2],At[1]=Tn*gt[tn+2],At[2]=rn*gt[tn+6],At[3]=Tn*gt[tn+6],Dt[0]=jt*gt[tn+1]+un*gt[tn+3]+dn*gt[tn+5]+Sn*gt[tn+7],Dt[1]=un*gt[tn+1]-Sn*gt[tn+3]-jt*gt[tn+5]-dn*gt[tn+7],Dt[2]=dn*gt[tn+1]-jt*gt[tn+3]+Sn*gt[tn+5]+un*gt[tn+7],Dt[3]=Sn*gt[tn+1]-dn*gt[tn+3]+un*gt[tn+5]-jt*gt[tn+7],$t[0]=wt*(gt[tn+0]+gt[tn+4]),$t[3]=wt*(gt[tn+0]-gt[tn+4]),$t[1]=At[0]+At[3],$t[2]=At[1]-At[2],Bt[0]=$t[0]+$t[1],Bt[1]=$t[3]+$t[2],Bt[2]=$t[3]-$t[2],Bt[3]=$t[0]-$t[1],gt[tn+0]=Bt[0]+Dt[0],gt[tn+1]=Bt[1]+Dt[1],gt[tn+2]=Bt[2]+Dt[2],gt[tn+3]=Bt[3]+Dt[3],gt[tn+4]=Bt[3]-Dt[3],gt[tn+5]=Bt[2]-Dt[2],gt[tn+6]=Bt[1]-Dt[1],gt[tn+7]=Bt[0]-Dt[0]}for(var cn=0;cn<8;++cn)At[0]=rn*gt[16+cn],At[1]=Tn*gt[16+cn],At[2]=rn*gt[48+cn],At[3]=Tn*gt[48+cn],Dt[0]=jt*gt[8+cn]+un*gt[24+cn]+dn*gt[40+cn]+Sn*gt[56+cn],Dt[1]=un*gt[8+cn]-Sn*gt[24+cn]-jt*gt[40+cn]-dn*gt[56+cn],Dt[2]=dn*gt[8+cn]-jt*gt[24+cn]+Sn*gt[40+cn]+un*gt[56+cn],Dt[3]=Sn*gt[8+cn]-dn*gt[24+cn]+un*gt[40+cn]-jt*gt[56+cn],$t[0]=wt*(gt[cn]+gt[32+cn]),$t[3]=wt*(gt[cn]-gt[32+cn]),$t[1]=At[0]+At[3],$t[2]=At[1]-At[2],Bt[0]=$t[0]+$t[1],Bt[1]=$t[3]+$t[2],Bt[2]=$t[3]-$t[2],Bt[3]=$t[0]-$t[1],gt[0+cn]=Bt[0]+Dt[0],gt[8+cn]=Bt[1]+Dt[1],gt[16+cn]=Bt[2]+Dt[2],gt[24+cn]=Bt[3]+Dt[3],gt[32+cn]=Bt[3]-Dt[3],gt[40+cn]=Bt[2]-Dt[2],gt[48+cn]=Bt[1]-Dt[1],gt[56+cn]=Bt[0]-Dt[0]}function pt(gt){for(var wt=0;wt<64;++wt){var jt=gt[0][wt],rn=gt[1][wt],un=gt[2][wt];gt[0][wt]=jt+1.5747*un,gt[1][wt]=jt-.1873*rn-.4682*un,gt[2][wt]=jt+1.8556*rn}}function ft(gt,wt,jt){for(var rn=0;rn<64;++rn)wt[jt+rn]=DataUtils.toHalfFloat(st(gt[rn]))}function st(gt){return gt<=1?Math.sign(gt)*Math.pow(Math.abs(gt),2.2):Math.sign(gt)*Math.pow(Pe,Math.abs(gt)-1)}function vt(gt){return new DataView(gt.array.buffer,gt.offset.value,gt.size)}function Pt(gt){var wt=gt.viewer.buffer.slice(gt.offset.value,gt.offset.value+gt.size),jt=new Uint8Array(Ut(wt)),rn=new Uint8Array(jt.length);return zt(jt),yt(jt,rn),new DataView(rn.buffer)}function Lt(gt){var wt=gt.array.slice(gt.offset.value,gt.offset.value+gt.size),jt=unzlibSync(wt),rn=new Uint8Array(jt.length);return zt(jt),yt(jt,rn),new DataView(rn.buffer)}function Vt(gt){for(var wt=gt.viewer,jt={value:gt.offset.value},rn=new Uint16Array(gt.width*gt.scanlineBlockSize*(gt.channels*gt.type)),un=new Uint8Array(8192),dn=0,Tn=new Array(gt.channels),Sn=0;Sn<gt.channels;Sn++)Tn[Sn]={},Tn[Sn].start=dn,Tn[Sn].end=Tn[Sn].start,Tn[Sn].nx=gt.width,Tn[Sn].ny=gt.lines,Tn[Sn].size=gt.type,dn+=Tn[Sn].nx*Tn[Sn].ny*Tn[Sn].size;var At=Yt(wt,jt),Dt=Yt(wt,jt);if(Dt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(At<=Dt)for(var Sn=0;Sn<Dt-At+1;Sn++)un[Sn+At]=It(wt,jt);var $t=new Uint16Array(65536),Bt=Ie(un,$t),Wt=Qt(wt,jt);Et(gt.array,wt,jt,Wt,rn,dn);for(var Sn=0;Sn<gt.channels;++Sn)for(var tn=Tn[Sn],cn=0;cn<Tn[Sn].size;++cn)Tt(rn,tn.start+cn,tn.nx,tn.size,tn.ny,tn.nx*tn.size,Bt);Nt($t,rn,dn);for(var An=0,En=new Uint8Array(rn.buffer.byteLength),Bn=0;Bn<gt.lines;Bn++)for(var In=0;In<gt.channels;In++){var tn=Tn[In],Cn=tn.nx*tn.size,wn=new Uint8Array(rn.buffer,tn.end*2,Cn*2);En.set(wn,An),An+=Cn*2,tn.end+=Cn}return new DataView(En.buffer)}function Le(gt){var wt=gt.array.slice(gt.offset.value,gt.offset.value+gt.size),jt=unzlibSync(wt);const rn=gt.lines*gt.channels*gt.width,un=gt.type==1?new Uint16Array(rn):new Uint32Array(rn);let dn=0,Tn=0;const Sn=new Array(4);for(let At=0;At<gt.lines;At++)for(let Dt=0;Dt<gt.channels;Dt++){let $t=0;switch(gt.type){case 1:Sn[0]=dn,Sn[1]=Sn[0]+gt.width,dn=Sn[1]+gt.width;for(let Bt=0;Bt<gt.width;++Bt){const Wt=jt[Sn[0]++]<<8|jt[Sn[1]++];$t+=Wt,un[Tn]=$t,Tn++}break;case 2:Sn[0]=dn,Sn[1]=Sn[0]+gt.width,Sn[2]=Sn[1]+gt.width,dn=Sn[2]+gt.width;for(let Bt=0;Bt<gt.width;++Bt){const Wt=jt[Sn[0]++]<<24|jt[Sn[1]++]<<16|jt[Sn[2]++]<<8;$t+=Wt,un[Tn]=$t,Tn++}break}}return new DataView(un.buffer)}function De(gt){var wt=gt.viewer,jt={value:gt.offset.value},rn=new Uint8Array(gt.width*gt.lines*(gt.channels*gt.type*2)),un={version:Gt(wt,jt),unknownUncompressedSize:Gt(wt,jt),unknownCompressedSize:Gt(wt,jt),acCompressedSize:Gt(wt,jt),dcCompressedSize:Gt(wt,jt),rleCompressedSize:Gt(wt,jt),rleUncompressedSize:Gt(wt,jt),rleRawSize:Gt(wt,jt),totalAcUncompressedCount:Gt(wt,jt),totalDcUncompressedCount:Gt(wt,jt),acCompression:Gt(wt,jt)};if(un.version<2)throw"EXRLoader.parse: "+Cr.compression+" version "+un.version+" is unsupported";for(var dn=new Array,Tn=Yt(wt,jt)-2;Tn>0;){var Sn=Be(wt.buffer,jt),At=It(wt,jt),Dt=At>>2&3,$t=(At>>4)-1,Bt=new Int8Array([$t])[0],Wt=It(wt,jt);dn.push({name:Sn,index:Bt,type:Wt,compression:Dt}),Tn-=Sn.length+3}for(var tn=Cr.channels,cn=new Array(gt.channels),An=0;An<gt.channels;++An){var En=cn[An]={},Bn=tn[An];En.name=Bn.name,En.compression=0,En.decoded=!1,En.type=Bn.pixelType,En.pLinear=Bn.pLinear,En.width=gt.width,En.height=gt.lines}for(var In={idx:new Array(3)},Cn=0;Cn<gt.channels;++Cn)for(var En=cn[Cn],An=0;An<dn.length;++An){var wn=dn[An];En.name==wn.name&&(En.compression=wn.compression,wn.index>=0&&(In.idx[wn.index]=Cn),En.offset=Cn)}if(un.acCompressedSize>0)switch(un.acCompression){case 0:var Fn=new Uint16Array(un.totalAcUncompressedCount);Et(gt.array,wt,jt,un.acCompressedSize,Fn,un.totalAcUncompressedCount);break;case 1:var bn=gt.array.slice(jt.value,jt.value+un.totalAcUncompressedCount),nr=unzlibSync(bn),Fn=new Uint16Array(nr.buffer);jt.value+=un.totalAcUncompressedCount;break}if(un.dcCompressedSize>0){var On={array:gt.array,offset:jt,size:un.dcCompressedSize},Nn=new Uint16Array(Lt(On).buffer);jt.value+=un.dcCompressedSize}if(un.rleRawSize>0){var bn=gt.array.slice(jt.value,jt.value+un.rleCompressedSize),nr=unzlibSync(bn),mr=Ut(nr.buffer);jt.value+=un.rleCompressedSize}for(var zn=0,Zn=new Array(cn.length),An=0;An<Zn.length;++An)Zn[An]=new Array;for(var Un=0;Un<gt.lines;++Un)for(var er=0;er<cn.length;++er)Zn[er].push(zn),zn+=cn[er].width*gt.type*2;bt(In,Zn,cn,Fn,Nn,rn);for(var An=0;An<cn.length;++An){var En=cn[An];if(!En.decoded)switch(En.compression){case 2:for(var Jn=0,rr=0,Un=0;Un<gt.lines;++Un){for(var sr=Zn[An][Jn],fr=0;fr<En.width;++fr){for(var hr=0;hr<2*En.type;++hr)rn[sr++]=mr[rr+hr*En.width*En.height];rr++}Jn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(rn.buffer)}function Be(gt,wt){for(var jt=new Uint8Array(gt),rn=0;jt[wt.value+rn]!=0;)rn+=1;var un=new TextDecoder().decode(jt.slice(wt.value,wt.value+rn));return wt.value=wt.value+rn+1,un}function rt(gt,wt,jt){var rn=new TextDecoder().decode(new Uint8Array(gt).slice(wt.value,wt.value+jt));return wt.value=wt.value+jt,rn}function at(gt,wt){var jt=Ct(gt,wt),rn=Qt(gt,wt);return[jt,rn]}function xt(gt,wt){var jt=Qt(gt,wt),rn=Qt(gt,wt);return[jt,rn]}function Ct(gt,wt){var jt=gt.getInt32(wt.value,!0);return wt.value=wt.value+4,jt}function Qt(gt,wt){var jt=gt.getUint32(wt.value,!0);return wt.value=wt.value+4,jt}function qt(gt,wt){var jt=gt[wt.value];return wt.value=wt.value+1,jt}function It(gt,wt){var jt=gt.getUint8(wt.value);return wt.value=wt.value+1,jt}const Gt=function(gt,wt){let jt;return"getBigInt64"in DataView.prototype?jt=Number(gt.getBigInt64(wt.value,!0)):jt=gt.getUint32(wt.value+4,!0)+Number(gt.getUint32(wt.value,!0)<<32),wt.value+=8,jt};function Jt(gt,wt){var jt=gt.getFloat32(wt.value,!0);return wt.value+=4,jt}function kt(gt,wt){return DataUtils.toHalfFloat(Jt(gt,wt))}function Ht(gt){var wt=(gt&31744)>>10,jt=gt&1023;return(gt>>15?-1:1)*(wt?wt===31?jt?NaN:1/0:Math.pow(2,wt-15)*(1+jt/1024):6103515625e-14*(jt/1024))}function Yt(gt,wt){var jt=gt.getUint16(wt.value,!0);return wt.value+=2,jt}function hn(gt,wt){return Ht(Yt(gt,wt))}function _n(gt,wt,jt,rn){for(var un=jt.value,dn=[];jt.value<un+rn-1;){var Tn=Be(wt,jt),Sn=Ct(gt,jt),At=It(gt,jt);jt.value+=3;var Dt=Ct(gt,jt),$t=Ct(gt,jt);dn.push({name:Tn,pixelType:Sn,pLinear:At,xSampling:Dt,ySampling:$t})}return jt.value+=1,dn}function xn(gt,wt){var jt=Jt(gt,wt),rn=Jt(gt,wt),un=Jt(gt,wt),dn=Jt(gt,wt),Tn=Jt(gt,wt),Sn=Jt(gt,wt),At=Jt(gt,wt),Dt=Jt(gt,wt);return{redX:jt,redY:rn,greenX:un,greenY:dn,blueX:Tn,blueY:Sn,whiteX:At,whiteY:Dt}}function Ln(gt,wt){var jt=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],rn=It(gt,wt);return jt[rn]}function Vn(gt,wt){var jt=Qt(gt,wt),rn=Qt(gt,wt),un=Qt(gt,wt),dn=Qt(gt,wt);return{xMin:jt,yMin:rn,xMax:un,yMax:dn}}function kn(gt,wt){var jt=["INCREASING_Y"],rn=It(gt,wt);return jt[rn]}function Rn(gt,wt){var jt=Jt(gt,wt),rn=Jt(gt,wt);return[jt,rn]}function or(gt,wt){var jt=Jt(gt,wt),rn=Jt(gt,wt),un=Jt(gt,wt);return[jt,rn,un]}function pr(gt,wt,jt,rn,un){if(rn==="string"||rn==="stringvector"||rn==="iccProfile")return rt(wt,jt,un);if(rn==="chlist")return _n(gt,wt,jt,un);if(rn==="chromaticities")return xn(gt,jt);if(rn==="compression")return Ln(gt,jt);if(rn==="box2i")return Vn(gt,jt);if(rn==="lineOrder")return kn(gt,jt);if(rn==="float")return Jt(gt,jt);if(rn==="v2f")return Rn(gt,jt);if(rn==="v3f")return or(gt,jt);if(rn==="int")return Ct(gt,jt);if(rn==="rational")return at(gt,jt);if(rn==="timecode")return xt(gt,jt);if(rn==="preview")return jt.value+=un,"skipped";jt.value+=un}function vr(gt,wt,jt){const rn={};if(gt.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";rn.version=gt.getUint8(4);const un=gt.getUint8(5);rn.spec={singleTile:!!(un&2),longName:!!(un&4),deepFormat:!!(un&8),multiPart:!!(un&16)},jt.value=8;for(var dn=!0;dn;){var Tn=Be(wt,jt);if(Tn==0)dn=!1;else{var Sn=Be(wt,jt),At=Qt(gt,jt),Dt=pr(gt,wt,jt,Sn,At);Dt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Sn}'.`):rn[Tn]=Dt}}if(un&-5)throw console.error("EXRHeader:",rn),"THREE.EXRLoader: provided file is currently unsupported.";return rn}function Nr(gt,wt,jt,rn,un){const dn={size:0,viewer:wt,array:jt,offset:rn,width:gt.dataWindow.xMax-gt.dataWindow.xMin+1,height:gt.dataWindow.yMax-gt.dataWindow.yMin+1,channels:gt.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:gt.channels[0].pixelType,uncompress:null,getter:null,format:null,[hasColorSpace?"colorSpace":"encoding"]:null};switch(gt.compression){case"NO_COMPRESSION":dn.lines=1,dn.uncompress=vt;break;case"RLE_COMPRESSION":dn.lines=1,dn.uncompress=Pt;break;case"ZIPS_COMPRESSION":dn.lines=1,dn.uncompress=Lt;break;case"ZIP_COMPRESSION":dn.lines=16,dn.uncompress=Lt;break;case"PIZ_COMPRESSION":dn.lines=32,dn.uncompress=Vt;break;case"PXR24_COMPRESSION":dn.lines=16,dn.uncompress=Le;break;case"DWAA_COMPRESSION":dn.lines=32,dn.uncompress=De;break;case"DWAB_COMPRESSION":dn.lines=256,dn.uncompress=De;break;default:throw"EXRLoader.parse: "+gt.compression+" is unsupported"}if(dn.scanlineBlockSize=dn.lines,dn.type==1)switch(un){case FloatType:dn.getter=hn,dn.inputSize=2;break;case HalfFloatType:dn.getter=Yt,dn.inputSize=2;break}else if(dn.type==2)switch(un){case FloatType:dn.getter=Jt,dn.inputSize=4;break;case HalfFloatType:dn.getter=kt,dn.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+dn.type+" for "+gt.compression+".";dn.blockCount=(gt.dataWindow.yMax+1)/dn.scanlineBlockSize;for(var Tn=0;Tn<dn.blockCount;Tn++)Gt(wt,rn);dn.outputChannels=dn.channels==3?4:dn.channels;const Sn=dn.width*dn.height*dn.outputChannels;switch(un){case FloatType:dn.byteArray=new Float32Array(Sn),dn.channels<dn.outputChannels&&dn.byteArray.fill(1,0,Sn);break;case HalfFloatType:dn.byteArray=new Uint16Array(Sn),dn.channels<dn.outputChannels&&dn.byteArray.fill(15360,0,Sn);break;default:console.error("THREE.EXRLoader: unsupported type: ",un);break}return dn.bytesPerLine=dn.width*dn.inputSize*dn.channels,dn.outputChannels==4?dn.format=RGBAFormat:dn.format=RedFormat,hasColorSpace?dn.colorSpace="srgb-linear":dn.encoding=3e3,dn}const Sr=new DataView(_),Pr=new Uint8Array(_),Dr={value:0},Cr=vr(Sr,_,Dr),Kn=Nr(Cr,Sr,Pr,Dr,this.type),Er={value:0},$r={R:0,G:1,B:2,A:3,Y:0};for(let gt=0;gt<Kn.height/Kn.scanlineBlockSize;gt++){const wt=Qt(Sr,Dr);Kn.size=Qt(Sr,Dr),Kn.lines=wt+Kn.scanlineBlockSize>Kn.height?Kn.height-wt:Kn.scanlineBlockSize;const rn=Kn.size<Kn.lines*Kn.bytesPerLine?Kn.uncompress(Kn):vt(Kn);Dr.value+=Kn.size;for(let un=0;un<Kn.scanlineBlockSize;un++){const dn=un+gt*Kn.scanlineBlockSize;if(dn>=Kn.height)break;for(let Tn=0;Tn<Kn.channels;Tn++){const Sn=$r[Cr.channels[Tn].name];for(let At=0;At<Kn.width;At++){Er.value=(un*(Kn.channels*Kn.width)+Tn*Kn.width+At)*Kn.inputSize;const Dt=(Kn.height-1-dn)*(Kn.width*Kn.outputChannels)+At*Kn.outputChannels+Sn;Kn.byteArray[Dt]=Kn.getter(rn,Er)}}}}return{header:Cr,width:Kn.width,height:Kn.height,data:Kn.byteArray,format:Kn.format,[hasColorSpace?"colorSpace":"encoding"]:Kn[hasColorSpace?"colorSpace":"encoding"],type:this.type}}setDataType(_){return this.type=_,this}load(_,Z,te,ne){function ie(oe,se){hasColorSpace?oe.colorSpace=se.colorSpace:oe.encoding=se.encoding,oe.minFilter=LinearFilter,oe.magFilter=LinearFilter,oe.generateMipmaps=!1,oe.flipY=!1,Z&&Z(oe,se)}return super.load(_,ie,te,ne)}}const COLOR_SPACE_SVG="srgb",SVGLoader=(()=>{class K extends Loader{constructor(Z){super(Z),this.defaultDPI=90,this.defaultUnit="px"}load(Z,te,ne,ie){const oe=this,se=new FileLoader(oe.manager);se.setPath(oe.path),se.setRequestHeader(oe.requestHeader),se.setWithCredentials(oe.withCredentials),se.load(Z,function(ae){try{te(oe.parse(ae))}catch(le){ie?ie(le):console.error(le),oe.manager.itemError(Z)}},ne,ie)}parse(Z){const te=this;function ne(Qe,Ze){if(Qe.nodeType!==1)return;const it=Te(Qe);let nt=!1,Tt=null;switch(Qe.nodeName){case"svg":Ze=ge(Qe,Ze);break;case"style":oe(Qe);break;case"g":Ze=ge(Qe,Ze);break;case"path":Ze=ge(Qe,Ze),Qe.hasAttribute("d")&&(Tt=ie(Qe));break;case"rect":Ze=ge(Qe,Ze),Tt=le(Qe);break;case"polygon":Ze=ge(Qe,Ze),Tt=ce(Qe);break;case"polyline":Ze=ge(Qe,Ze),Tt=fe(Qe);break;case"circle":Ze=ge(Qe,Ze),Tt=de(Qe);break;case"ellipse":Ze=ge(Qe,Ze),Tt=pe(Qe);break;case"line":Ze=ge(Qe,Ze),Tt=he(Qe);break;case"defs":nt=!0;break;case"use":Ze=ge(Qe,Ze);const Nt=(Qe.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),zt=Qe.viewportElement.getElementById(Nt);zt?ne(zt,Ze):console.warn("SVGLoader: 'use node' references non-existent node id: "+Nt);break}Tt&&(Ze.fill!==void 0&&Ze.fill!=="none"&&Tt.color.setStyle(Ze.fill,COLOR_SPACE_SVG),Re(Tt,ct),ke.push(Tt),Tt.userData={node:Qe,style:Ze});const St=Qe.childNodes;for(let Et=0;Et<St.length;Et++){const Nt=St[Et];nt&&Nt.nodeName!=="style"&&Nt.nodeName!=="defs"||ne(Nt,Ze)}it&&(He.pop(),He.length>0?ct.copy(He[He.length-1]):ct.identity())}function ie(Qe){const Ze=new ShapePath,it=new Vector2,nt=new Vector2,Tt=new Vector2;let St=!0,Et=!1;const Nt=Qe.getAttribute("d");if(Nt===""||Nt==="none")return null;const zt=Nt.match(/[a-df-z][^a-df-z]*/gi);for(let yt=0,Ut=zt.length;yt<Ut;yt++){const bt=zt[yt],Ot=bt.charAt(0),Mt=bt.slice(1).trim();St===!0&&(Et=!0,St=!1);let _t;switch(Ot){case"M":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=2)it.x=_t[pt+0],it.y=_t[pt+1],nt.x=it.x,nt.y=it.y,pt===0?Ze.moveTo(it.x,it.y):Ze.lineTo(it.x,it.y),pt===0&&Tt.copy(it);break;case"H":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt++)it.x=_t[pt],nt.x=it.x,nt.y=it.y,Ze.lineTo(it.x,it.y),pt===0&&Et===!0&&Tt.copy(it);break;case"V":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt++)it.y=_t[pt],nt.x=it.x,nt.y=it.y,Ze.lineTo(it.x,it.y),pt===0&&Et===!0&&Tt.copy(it);break;case"L":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=2)it.x=_t[pt+0],it.y=_t[pt+1],nt.x=it.x,nt.y=it.y,Ze.lineTo(it.x,it.y),pt===0&&Et===!0&&Tt.copy(it);break;case"C":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=6)Ze.bezierCurveTo(_t[pt+0],_t[pt+1],_t[pt+2],_t[pt+3],_t[pt+4],_t[pt+5]),nt.x=_t[pt+2],nt.y=_t[pt+3],it.x=_t[pt+4],it.y=_t[pt+5],pt===0&&Et===!0&&Tt.copy(it);break;case"S":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=4)Ze.bezierCurveTo(me(it.x,nt.x),me(it.y,nt.y),_t[pt+0],_t[pt+1],_t[pt+2],_t[pt+3]),nt.x=_t[pt+0],nt.y=_t[pt+1],it.x=_t[pt+2],it.y=_t[pt+3],pt===0&&Et===!0&&Tt.copy(it);break;case"Q":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=4)Ze.quadraticCurveTo(_t[pt+0],_t[pt+1],_t[pt+2],_t[pt+3]),nt.x=_t[pt+0],nt.y=_t[pt+1],it.x=_t[pt+2],it.y=_t[pt+3],pt===0&&Et===!0&&Tt.copy(it);break;case"T":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=2){const st=me(it.x,nt.x),vt=me(it.y,nt.y);Ze.quadraticCurveTo(st,vt,_t[pt+0],_t[pt+1]),nt.x=st,nt.y=vt,it.x=_t[pt+0],it.y=_t[pt+1],pt===0&&Et===!0&&Tt.copy(it)}break;case"A":_t=Ae(Mt,[3,4],7);for(let pt=0,ft=_t.length;pt<ft;pt+=7){if(_t[pt+5]==it.x&&_t[pt+6]==it.y)continue;const st=it.clone();it.x=_t[pt+5],it.y=_t[pt+6],nt.x=it.x,nt.y=it.y,se(Ze,_t[pt],_t[pt+1],_t[pt+2],_t[pt+3],_t[pt+4],st,it),pt===0&&Et===!0&&Tt.copy(it)}break;case"m":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=2)it.x+=_t[pt+0],it.y+=_t[pt+1],nt.x=it.x,nt.y=it.y,pt===0?Ze.moveTo(it.x,it.y):Ze.lineTo(it.x,it.y),pt===0&&Tt.copy(it);break;case"h":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt++)it.x+=_t[pt],nt.x=it.x,nt.y=it.y,Ze.lineTo(it.x,it.y),pt===0&&Et===!0&&Tt.copy(it);break;case"v":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt++)it.y+=_t[pt],nt.x=it.x,nt.y=it.y,Ze.lineTo(it.x,it.y),pt===0&&Et===!0&&Tt.copy(it);break;case"l":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=2)it.x+=_t[pt+0],it.y+=_t[pt+1],nt.x=it.x,nt.y=it.y,Ze.lineTo(it.x,it.y),pt===0&&Et===!0&&Tt.copy(it);break;case"c":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=6)Ze.bezierCurveTo(it.x+_t[pt+0],it.y+_t[pt+1],it.x+_t[pt+2],it.y+_t[pt+3],it.x+_t[pt+4],it.y+_t[pt+5]),nt.x=it.x+_t[pt+2],nt.y=it.y+_t[pt+3],it.x+=_t[pt+4],it.y+=_t[pt+5],pt===0&&Et===!0&&Tt.copy(it);break;case"s":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=4)Ze.bezierCurveTo(me(it.x,nt.x),me(it.y,nt.y),it.x+_t[pt+0],it.y+_t[pt+1],it.x+_t[pt+2],it.y+_t[pt+3]),nt.x=it.x+_t[pt+0],nt.y=it.y+_t[pt+1],it.x+=_t[pt+2],it.y+=_t[pt+3],pt===0&&Et===!0&&Tt.copy(it);break;case"q":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=4)Ze.quadraticCurveTo(it.x+_t[pt+0],it.y+_t[pt+1],it.x+_t[pt+2],it.y+_t[pt+3]),nt.x=it.x+_t[pt+0],nt.y=it.y+_t[pt+1],it.x+=_t[pt+2],it.y+=_t[pt+3],pt===0&&Et===!0&&Tt.copy(it);break;case"t":_t=Ae(Mt);for(let pt=0,ft=_t.length;pt<ft;pt+=2){const st=me(it.x,nt.x),vt=me(it.y,nt.y);Ze.quadraticCurveTo(st,vt,it.x+_t[pt+0],it.y+_t[pt+1]),nt.x=st,nt.y=vt,it.x=it.x+_t[pt+0],it.y=it.y+_t[pt+1],pt===0&&Et===!0&&Tt.copy(it)}break;case"a":_t=Ae(Mt,[3,4],7);for(let pt=0,ft=_t.length;pt<ft;pt+=7){if(_t[pt+5]==0&&_t[pt+6]==0)continue;const st=it.clone();it.x+=_t[pt+5],it.y+=_t[pt+6],nt.x=it.x,nt.y=it.y,se(Ze,_t[pt],_t[pt+1],_t[pt+2],_t[pt+3],_t[pt+4],st,it),pt===0&&Et===!0&&Tt.copy(it)}break;case"Z":case"z":Ze.currentPath.autoClose=!0,Ze.currentPath.curves.length>0&&(it.copy(Tt),Ze.currentPath.currentPoint.copy(it),St=!0);break;default:console.warn(bt)}Et=!1}return Ze}function oe(Qe){if(!(!Qe.sheet||!Qe.sheet.cssRules||!Qe.sheet.cssRules.length))for(let Ze=0;Ze<Qe.sheet.cssRules.length;Ze++){const it=Qe.sheet.cssRules[Ze];if(it.type!==1)continue;const nt=it.selectorText.split(/,/gm).filter(Boolean).map(Tt=>Tt.trim());for(let Tt=0;Tt<nt.length;Tt++){const St=Object.fromEntries(Object.entries(it.style).filter(([,Et])=>Et!==""));Ge[nt[Tt]]=Object.assign(Ge[nt[Tt]]||{},St)}}}function se(Qe,Ze,it,nt,Tt,St,Et,Nt){if(Ze==0||it==0){Qe.lineTo(Nt.x,Nt.y);return}nt=nt*Math.PI/180,Ze=Math.abs(Ze),it=Math.abs(it);const zt=(Et.x-Nt.x)/2,yt=(Et.y-Nt.y)/2,Ut=Math.cos(nt)*zt+Math.sin(nt)*yt,bt=-Math.sin(nt)*zt+Math.cos(nt)*yt;let Ot=Ze*Ze,Mt=it*it;const _t=Ut*Ut,pt=bt*bt,ft=_t/Ot+pt/Mt;if(ft>1){const at=Math.sqrt(ft);Ze=at*Ze,it=at*it,Ot=Ze*Ze,Mt=it*it}const st=Ot*pt+Mt*_t,vt=(Ot*Mt-st)/st;let Pt=Math.sqrt(Math.max(0,vt));Tt===St&&(Pt=-Pt);const Lt=Pt*Ze*bt/it,Vt=-Pt*it*Ut/Ze,Le=Math.cos(nt)*Lt-Math.sin(nt)*Vt+(Et.x+Nt.x)/2,De=Math.sin(nt)*Lt+Math.cos(nt)*Vt+(Et.y+Nt.y)/2,Be=ae(1,0,(Ut-Lt)/Ze,(bt-Vt)/it),rt=ae((Ut-Lt)/Ze,(bt-Vt)/it,(-Ut-Lt)/Ze,(-bt-Vt)/it)%(Math.PI*2);Qe.currentPath.absellipse(Le,De,Ze,it,Be,Be+rt,St===0,nt)}function ae(Qe,Ze,it,nt){const Tt=Qe*it+Ze*nt,St=Math.sqrt(Qe*Qe+Ze*Ze)*Math.sqrt(it*it+nt*nt);let Et=Math.acos(Math.max(-1,Math.min(1,Tt/St)));return Qe*nt-Ze*it<0&&(Et=-Et),Et}function le(Qe){const Ze=_e(Qe.getAttribute("x")||0),it=_e(Qe.getAttribute("y")||0),nt=_e(Qe.getAttribute("rx")||Qe.getAttribute("ry")||0),Tt=_e(Qe.getAttribute("ry")||Qe.getAttribute("rx")||0),St=_e(Qe.getAttribute("width")),Et=_e(Qe.getAttribute("height")),Nt=1-.551915024494,zt=new ShapePath;return zt.moveTo(Ze+nt,it),zt.lineTo(Ze+St-nt,it),(nt!==0||Tt!==0)&&zt.bezierCurveTo(Ze+St-nt*Nt,it,Ze+St,it+Tt*Nt,Ze+St,it+Tt),zt.lineTo(Ze+St,it+Et-Tt),(nt!==0||Tt!==0)&&zt.bezierCurveTo(Ze+St,it+Et-Tt*Nt,Ze+St-nt*Nt,it+Et,Ze+St-nt,it+Et),zt.lineTo(Ze+nt,it+Et),(nt!==0||Tt!==0)&&zt.bezierCurveTo(Ze+nt*Nt,it+Et,Ze,it+Et-Tt*Nt,Ze,it+Et-Tt),zt.lineTo(Ze,it+Tt),(nt!==0||Tt!==0)&&zt.bezierCurveTo(Ze,it+Tt*Nt,Ze+nt*Nt,it,Ze+nt,it),zt}function ce(Qe){function Ze(St,Et,Nt){const zt=_e(Et),yt=_e(Nt);Tt===0?nt.moveTo(zt,yt):nt.lineTo(zt,yt),Tt++}const it=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,nt=new ShapePath;let Tt=0;return Qe.getAttribute("points").replace(it,Ze),nt.currentPath.autoClose=!0,nt}function fe(Qe){function Ze(St,Et,Nt){const zt=_e(Et),yt=_e(Nt);Tt===0?nt.moveTo(zt,yt):nt.lineTo(zt,yt),Tt++}const it=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,nt=new ShapePath;let Tt=0;return Qe.getAttribute("points").replace(it,Ze),nt.currentPath.autoClose=!1,nt}function de(Qe){const Ze=_e(Qe.getAttribute("cx")||0),it=_e(Qe.getAttribute("cy")||0),nt=_e(Qe.getAttribute("r")||0),Tt=new Path;Tt.absarc(Ze,it,nt,0,Math.PI*2);const St=new ShapePath;return St.subPaths.push(Tt),St}function pe(Qe){const Ze=_e(Qe.getAttribute("cx")||0),it=_e(Qe.getAttribute("cy")||0),nt=_e(Qe.getAttribute("rx")||0),Tt=_e(Qe.getAttribute("ry")||0),St=new Path;St.absellipse(Ze,it,nt,Tt,0,Math.PI*2);const Et=new ShapePath;return Et.subPaths.push(St),Et}function he(Qe){const Ze=_e(Qe.getAttribute("x1")||0),it=_e(Qe.getAttribute("y1")||0),nt=_e(Qe.getAttribute("x2")||0),Tt=_e(Qe.getAttribute("y2")||0),St=new ShapePath;return St.moveTo(Ze,it),St.lineTo(nt,Tt),St.currentPath.autoClose=!1,St}function ge(Qe,Ze){Ze=Object.assign({},Ze);let it={};if(Qe.hasAttribute("class")){const Et=Qe.getAttribute("class").split(/\s/).filter(Boolean).map(Nt=>Nt.trim());for(let Nt=0;Nt<Et.length;Nt++)it=Object.assign(it,Ge["."+Et[Nt]])}Qe.hasAttribute("id")&&(it=Object.assign(it,Ge["#"+Qe.getAttribute("id")]));function nt(Et,Nt,zt){zt===void 0&&(zt=function(Ut){return Ut.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),Ut}),Qe.hasAttribute(Et)&&(Ze[Nt]=zt(Qe.getAttribute(Et))),it[Et]&&(Ze[Nt]=zt(it[Et])),Qe.style&&Qe.style[Et]!==""&&(Ze[Nt]=zt(Qe.style[Et]))}function Tt(Et){return Math.max(0,Math.min(1,_e(Et)))}function St(Et){return Math.max(0,_e(Et))}return nt("fill","fill"),nt("fill-opacity","fillOpacity",Tt),nt("fill-rule","fillRule"),nt("opacity","opacity",Tt),nt("stroke","stroke"),nt("stroke-opacity","strokeOpacity",Tt),nt("stroke-width","strokeWidth",St),nt("stroke-linejoin","strokeLineJoin"),nt("stroke-linecap","strokeLineCap"),nt("stroke-miterlimit","strokeMiterLimit",St),nt("visibility","visibility"),Ze}function me(Qe,Ze){return Qe-(Ze-Qe)}function Ae(Qe,Ze,it){if(typeof Qe!="string")throw new TypeError("Invalid input: "+typeof Qe);const nt={WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},Tt=0,St=1,Et=2,Nt=3;let zt=Tt,yt=!0,Ut="",bt="";const Ot=[];function Mt(st,vt,Pt){const Lt=new SyntaxError('Unexpected character "'+st+'" at index '+vt+".");throw Lt.partial=Pt,Lt}function _t(){Ut!==""&&(bt===""?Ot.push(Number(Ut)):Ot.push(Number(Ut)*Math.pow(10,Number(bt)))),Ut="",bt=""}let pt;const ft=Qe.length;for(let st=0;st<ft;st++){if(pt=Qe[st],Array.isArray(Ze)&&Ze.includes(Ot.length%it)&&nt.FLAGS.test(pt)){zt=St,Ut=pt,_t();continue}if(zt===Tt){if(nt.WHITESPACE.test(pt))continue;if(nt.DIGIT.test(pt)||nt.SIGN.test(pt)){zt=St,Ut=pt;continue}if(nt.POINT.test(pt)){zt=Et,Ut=pt;continue}nt.COMMA.test(pt)&&(yt&&Mt(pt,st,Ot),yt=!0)}if(zt===St){if(nt.DIGIT.test(pt)){Ut+=pt;continue}if(nt.POINT.test(pt)){Ut+=pt,zt=Et;continue}if(nt.EXP.test(pt)){zt=Nt;continue}nt.SIGN.test(pt)&&Ut.length===1&&nt.SIGN.test(Ut[0])&&Mt(pt,st,Ot)}if(zt===Et){if(nt.DIGIT.test(pt)){Ut+=pt;continue}if(nt.EXP.test(pt)){zt=Nt;continue}nt.POINT.test(pt)&&Ut[Ut.length-1]==="."&&Mt(pt,st,Ot)}if(zt===Nt){if(nt.DIGIT.test(pt)){bt+=pt;continue}if(nt.SIGN.test(pt)){if(bt===""){bt+=pt;continue}bt.length===1&&nt.SIGN.test(bt)&&Mt(pt,st,Ot)}}nt.WHITESPACE.test(pt)?(_t(),zt=Tt,yt=!1):nt.COMMA.test(pt)?(_t(),zt=Tt,yt=!0):nt.SIGN.test(pt)?(_t(),zt=St,Ut=pt):nt.POINT.test(pt)?(_t(),zt=Et,Ut=pt):Mt(pt,st,Ot)}return _t(),Ot}const ye=["mm","cm","in","pt","pc","px"],ve={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function _e(Qe){let Ze="px";if(typeof Qe=="string"||Qe instanceof String)for(let nt=0,Tt=ye.length;nt<Tt;nt++){const St=ye[nt];if(Qe.endsWith(St)){Ze=St,Qe=Qe.substring(0,Qe.length-St.length);break}}let it;return Ze==="px"&&te.defaultUnit!=="px"?it=ve.in[te.defaultUnit]/te.defaultDPI:(it=ve[Ze][te.defaultUnit],it<0&&(it=ve[Ze].in*te.defaultDPI)),it*parseFloat(Qe)}function Te(Qe){if(!(Qe.hasAttribute("transform")||Qe.nodeName==="use"&&(Qe.hasAttribute("x")||Qe.hasAttribute("y"))))return null;const Ze=be(Qe);return He.length>0&&Ze.premultiply(He[He.length-1]),ct.copy(Ze),He.push(Ze),Ze}function be(Qe){const Ze=new Matrix3,it=ze;if(Qe.nodeName==="use"&&(Qe.hasAttribute("x")||Qe.hasAttribute("y"))){const nt=_e(Qe.getAttribute("x")),Tt=_e(Qe.getAttribute("y"));Ze.translate(nt,Tt)}if(Qe.hasAttribute("transform")){const nt=Qe.getAttribute("transform").split(")");for(let Tt=nt.length-1;Tt>=0;Tt--){const St=nt[Tt].trim();if(St==="")continue;const Et=St.indexOf("("),Nt=St.length;if(Et>0&&Et<Nt){const zt=St.slice(0,Et),yt=Ae(St.slice(Et+1));switch(it.identity(),zt){case"translate":if(yt.length>=1){const Ut=yt[0];let bt=0;yt.length>=2&&(bt=yt[1]),it.translate(Ut,bt)}break;case"rotate":if(yt.length>=1){let Ut=0,bt=0,Ot=0;Ut=yt[0]*Math.PI/180,yt.length>=3&&(bt=yt[1],Ot=yt[2]),Ke.makeTranslation(-bt,-Ot),tt.makeRotation(Ut),Je.multiplyMatrices(tt,Ke),Ke.makeTranslation(bt,Ot),it.multiplyMatrices(Ke,Je)}break;case"scale":if(yt.length>=1){const Ut=yt[0];let bt=Ut;yt.length>=2&&(bt=yt[1]),it.scale(Ut,bt)}break;case"skewX":yt.length===1&&it.set(1,Math.tan(yt[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":yt.length===1&&it.set(1,0,0,Math.tan(yt[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":yt.length===6&&it.set(yt[0],yt[2],yt[4],yt[1],yt[3],yt[5],0,0,1);break}}Ze.premultiply(it)}}return Ze}function Re(Qe,Ze){function it(Et){Fe.set(Et.x,Et.y,1).applyMatrix3(Ze),Et.set(Fe.x,Fe.y)}function nt(Et){const Nt=Et.xRadius,zt=Et.yRadius,yt=Math.cos(Et.aRotation),Ut=Math.sin(Et.aRotation),bt=new Vector3(Nt*yt,Nt*Ut,0),Ot=new Vector3(-zt*Ut,zt*yt,0),Mt=bt.applyMatrix3(Ze),_t=Ot.applyMatrix3(Ze),pt=ze.set(Mt.x,_t.x,0,Mt.y,_t.y,0,0,0,1),ft=Ke.copy(pt).invert(),Pt=tt.copy(ft).transpose().multiply(ft).elements,Lt=Ue(Pt[0],Pt[1],Pt[4]),Vt=Math.sqrt(Lt.rt1),Le=Math.sqrt(Lt.rt2);if(Et.xRadius=1/Vt,Et.yRadius=1/Le,Et.aRotation=Math.atan2(Lt.sn,Lt.cs),!((Et.aEndAngle-Et.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const Be=Ke.set(Vt,0,0,0,Le,0,0,0,1),rt=tt.set(Lt.cs,Lt.sn,0,-Lt.sn,Lt.cs,0,0,0,1),at=Be.multiply(rt).multiply(pt),xt=Ct=>{const{x:Qt,y:qt}=new Vector3(Math.cos(Ct),Math.sin(Ct),0).applyMatrix3(at);return Math.atan2(qt,Qt)};Et.aStartAngle=xt(Et.aStartAngle),Et.aEndAngle=xt(Et.aEndAngle),we(Ze)&&(Et.aClockwise=!Et.aClockwise)}}function Tt(Et){const Nt=Ie(Ze),zt=$e(Ze);Et.xRadius*=Nt,Et.yRadius*=zt;const yt=Nt>Number.EPSILON?Math.atan2(Ze.elements[1],Ze.elements[0]):Math.atan2(-Ze.elements[3],Ze.elements[4]);Et.aRotation+=yt,we(Ze)&&(Et.aStartAngle*=-1,Et.aEndAngle*=-1,Et.aClockwise=!Et.aClockwise)}const St=Qe.subPaths;for(let Et=0,Nt=St.length;Et<Nt;Et++){const yt=St[Et].curves;for(let Ut=0;Ut<yt.length;Ut++){const bt=yt[Ut];bt.isLineCurve?(it(bt.v1),it(bt.v2)):bt.isCubicBezierCurve?(it(bt.v0),it(bt.v1),it(bt.v2),it(bt.v3)):bt.isQuadraticBezierCurve?(it(bt.v0),it(bt.v1),it(bt.v2)):bt.isEllipseCurve&&(ot.set(bt.aX,bt.aY),it(ot),bt.aX=ot.x,bt.aY=ot.y,Pe(Ze)?nt(bt):Tt(bt))}}}function we(Qe){const Ze=Qe.elements;return Ze[0]*Ze[4]-Ze[1]*Ze[3]<0}function Pe(Qe){const Ze=Qe.elements,it=Ze[0]*Ze[3]+Ze[1]*Ze[4];if(it===0)return!1;const nt=Ie(Qe),Tt=$e(Qe);return Math.abs(it/(nt*Tt))>Number.EPSILON}function Ie(Qe){const Ze=Qe.elements;return Math.sqrt(Ze[0]*Ze[0]+Ze[1]*Ze[1])}function $e(Qe){const Ze=Qe.elements;return Math.sqrt(Ze[3]*Ze[3]+Ze[4]*Ze[4])}function Ue(Qe,Ze,it){let nt,Tt,St,Et,Nt;const zt=Qe+it,yt=Qe-it,Ut=Math.sqrt(yt*yt+4*Ze*Ze);return zt>0?(nt=.5*(zt+Ut),Nt=1/nt,Tt=Qe*Nt*it-Ze*Nt*Ze):zt<0?Tt=.5*(zt-Ut):(nt=.5*Ut,Tt=-.5*Ut),yt>0?St=yt+Ut:St=yt-Ut,Math.abs(St)>2*Math.abs(Ze)?(Nt=-2*Ze/St,Et=1/Math.sqrt(1+Nt*Nt),St=Nt*Et):Math.abs(Ze)===0?(St=1,Et=0):(Nt=-.5*St/Ze,St=1/Math.sqrt(1+Nt*Nt),Et=Nt*St),yt>0&&(Nt=St,St=-Et,Et=Nt),{rt1:nt,rt2:Tt,cs:St,sn:Et}}const ke=[],Ge={},He=[],ze=new Matrix3,Ke=new Matrix3,tt=new Matrix3,Je=new Matrix3,ot=new Vector2,Fe=new Vector3,ct=new Matrix3,ht=new DOMParser().parseFromString(Z,"image/svg+xml");return ne(ht.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:ke,xml:ht.documentElement}}static createShapes(Z){const ne={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},ie={loc:ne.ORIGIN,t:0};function oe(me,Ae,ye,ve){const _e=me.x,Te=Ae.x,be=ye.x,Re=ve.x,we=me.y,Pe=Ae.y,Ie=ye.y,$e=ve.y,Ue=(Re-be)*(we-Ie)-($e-Ie)*(_e-be),ke=(Te-_e)*(we-Ie)-(Pe-we)*(_e-be),Ge=($e-Ie)*(Te-_e)-(Re-be)*(Pe-we),He=Ue/Ge,ze=ke/Ge;if(Ge===0&&Ue!==0||He<=0||He>=1||ze<0||ze>1)return null;if(Ue===0&&Ge===0){for(let Ke=0;Ke<2;Ke++)if(se(Ke===0?ye:ve,me,Ae),ie.loc==ne.ORIGIN){const tt=Ke===0?ye:ve;return{x:tt.x,y:tt.y,t:ie.t}}else if(ie.loc==ne.BETWEEN){const tt=+(_e+ie.t*(Te-_e)).toPrecision(10),Je=+(we+ie.t*(Pe-we)).toPrecision(10);return{x:tt,y:Je,t:ie.t}}return null}else{for(let Je=0;Je<2;Je++)if(se(Je===0?ye:ve,me,Ae),ie.loc==ne.ORIGIN){const ot=Je===0?ye:ve;return{x:ot.x,y:ot.y,t:ie.t}}const Ke=+(_e+He*(Te-_e)).toPrecision(10),tt=+(we+He*(Pe-we)).toPrecision(10);return{x:Ke,y:tt,t:He}}}function se(me,Ae,ye){const ve=ye.x-Ae.x,_e=ye.y-Ae.y,Te=me.x-Ae.x,be=me.y-Ae.y,Re=ve*be-Te*_e;if(me.x===Ae.x&&me.y===Ae.y){ie.loc=ne.ORIGIN,ie.t=0;return}if(me.x===ye.x&&me.y===ye.y){ie.loc=ne.DESTINATION,ie.t=1;return}if(Re<-Number.EPSILON){ie.loc=ne.LEFT;return}if(Re>Number.EPSILON){ie.loc=ne.RIGHT;return}if(ve*Te<0||_e*be<0){ie.loc=ne.BEHIND;return}if(Math.sqrt(ve*ve+_e*_e)<Math.sqrt(Te*Te+be*be)){ie.loc=ne.BEYOND;return}let we;ve!==0?we=Te/ve:we=be/_e,ie.loc=ne.BETWEEN,ie.t=we}function ae(me,Ae){const ye=[],ve=[];for(let _e=1;_e<me.length;_e++){const Te=me[_e-1],be=me[_e];for(let Re=1;Re<Ae.length;Re++){const we=Ae[Re-1],Pe=Ae[Re],Ie=oe(Te,be,we,Pe);Ie!==null&&ye.find($e=>$e.t<=Ie.t+Number.EPSILON&&$e.t>=Ie.t-Number.EPSILON)===void 0&&(ye.push(Ie),ve.push(new Vector2(Ie.x,Ie.y)))}}return ve}function le(me,Ae,ye){const ve=new Vector2;Ae.getCenter(ve);const _e=[];return ye.forEach(Te=>{Te.boundingBox.containsPoint(ve)&&ae(me,Te.points).forEach(Re=>{_e.push({identifier:Te.identifier,isCW:Te.isCW,point:Re})})}),_e.sort((Te,be)=>Te.point.x-be.point.x),_e}function ce(me,Ae,ye,ve,_e){(_e==null||_e==="")&&(_e="nonzero");const Te=new Vector2;me.boundingBox.getCenter(Te);const be=[new Vector2(ye,Te.y),new Vector2(ve,Te.y)],Re=le(be,me.boundingBox,Ae);Re.sort((ke,Ge)=>ke.point.x-Ge.point.x);const we=[],Pe=[];Re.forEach(ke=>{ke.identifier===me.identifier?we.push(ke):Pe.push(ke)});const Ie=we[0].point.x,$e=[];let Ue=0;for(;Ue<Pe.length&&Pe[Ue].point.x<Ie;)$e.length>0&&$e[$e.length-1]===Pe[Ue].identifier?$e.pop():$e.push(Pe[Ue].identifier),Ue++;if($e.push(me.identifier),_e==="evenodd"){const ke=$e.length%2===0,Ge=$e[$e.length-2];return{identifier:me.identifier,isHole:ke,for:Ge}}else if(_e==="nonzero"){let ke=!0,Ge=null,He=null;for(let ze=0;ze<$e.length;ze++){const Ke=$e[ze];ke?(He=Ae[Ke].isCW,ke=!1,Ge=Ke):He!==Ae[Ke].isCW&&(He=Ae[Ke].isCW,ke=!0)}return{identifier:me.identifier,isHole:ke,for:Ge}}else console.warn('fill-rule: "'+_e+'" is currently not implemented.')}let fe=999999999,de=-999999999,pe=Z.subPaths.map(me=>{const Ae=me.getPoints();let ye=-999999999,ve=999999999,_e=-999999999,Te=999999999;for(let be=0;be<Ae.length;be++){const Re=Ae[be];Re.y>ye&&(ye=Re.y),Re.y<ve&&(ve=Re.y),Re.x>_e&&(_e=Re.x),Re.x<Te&&(Te=Re.x)}return de<=_e&&(de=_e+1),fe>=Te&&(fe=Te-1),{curves:me.curves,points:Ae,isCW:ShapeUtils.isClockWise(Ae),identifier:-1,boundingBox:new Box2(new Vector2(Te,ve),new Vector2(_e,ye))}});pe=pe.filter(me=>me.points.length>1);for(let me=0;me<pe.length;me++)pe[me].identifier=me;const he=pe.map(me=>ce(me,pe,fe,de,Z.userData?Z.userData.style.fillRule:void 0)),ge=[];return pe.forEach(me=>{if(!he[me.identifier].isHole){const ye=new Shape$2;ye.curves=me.curves,he.filter(_e=>_e.isHole&&_e.for===me.identifier).forEach(_e=>{const Te=pe[_e.identifier],be=new Path;be.curves=Te.curves,ye.holes.push(be)}),ge.push(ye)}}),ge}static getStrokeStyle(Z,te,ne,ie,oe){return Z=Z!==void 0?Z:1,te=te!==void 0?te:"#000",ne=ne!==void 0?ne:"miter",ie=ie!==void 0?ie:"butt",oe=oe!==void 0?oe:4,{strokeColor:te,strokeWidth:Z,strokeLineJoin:ne,strokeLineCap:ie,strokeMiterLimit:oe}}static pointsToStroke(Z,te,ne,ie){const oe=[],se=[],ae=[];if(K.pointsToStrokeWithBuffers(Z,te,ne,ie,oe,se,ae)===0)return null;const le=new BufferGeometry;return le.setAttribute("position",new Float32BufferAttribute(oe,3)),le.setAttribute("normal",new Float32BufferAttribute(se,3)),le.setAttribute("uv",new Float32BufferAttribute(ae,2)),le}static pointsToStrokeWithBuffers(Z,te,ne,ie,oe,se,ae,le){const ce=new Vector2,fe=new Vector2,de=new Vector2,pe=new Vector2,he=new Vector2,ge=new Vector2,me=new Vector2,Ae=new Vector2,ye=new Vector2,ve=new Vector2,_e=new Vector2,Te=new Vector2,be=new Vector2,Re=new Vector2,we=new Vector2,Pe=new Vector2,Ie=new Vector2;ne=ne!==void 0?ne:12,ie=ie!==void 0?ie:.001,le=le!==void 0?le:0,Z=yt(Z);const $e=Z.length;if($e<2)return 0;const Ue=Z[0].equals(Z[$e-1]);let ke,Ge=Z[0],He;const ze=te.strokeWidth/2,Ke=1/($e-1);let tt=0,Je,ot,Fe,ct,ht=!1,lt=0,Qe=le*3,Ze=le*2;it(Z[0],Z[1],ce).multiplyScalar(ze),Ae.copy(Z[0]).sub(ce),ye.copy(Z[0]).add(ce),ve.copy(Ae),_e.copy(ye);for(let Ut=1;Ut<$e;Ut++){ke=Z[Ut],Ut===$e-1?Ue?He=Z[1]:He=void 0:He=Z[Ut+1];const bt=ce;if(it(Ge,ke,bt),de.copy(bt).multiplyScalar(ze),Te.copy(ke).sub(de),be.copy(ke).add(de),Je=tt+Ke,ot=!1,He!==void 0){it(ke,He,fe),de.copy(fe).multiplyScalar(ze),Re.copy(ke).sub(de),we.copy(ke).add(de),Fe=!0,de.subVectors(He,Ge),bt.dot(de)<0&&(Fe=!1),Ut===1&&(ht=Fe),de.subVectors(He,ke),de.normalize();const Ot=Math.abs(bt.dot(de));if(Ot>Number.EPSILON){const Mt=ze/Ot;de.multiplyScalar(-Mt),pe.subVectors(ke,Ge),he.copy(pe).setLength(Mt).add(de),Pe.copy(he).negate();const _t=he.length(),pt=pe.length();pe.divideScalar(pt),ge.subVectors(He,ke);const ft=ge.length();switch(ge.divideScalar(ft),pe.dot(Pe)<pt&&ge.dot(Pe)<ft&&(ot=!0),Ie.copy(he).add(ke),Pe.add(ke),ct=!1,ot?Fe?(we.copy(Pe),be.copy(Pe)):(Re.copy(Pe),Te.copy(Pe)):St(),te.strokeLineJoin){case"bevel":Et(Fe,ot,Je);break;case"round":Nt(Fe,ot),Fe?Tt(ke,Te,Re,Je,0):Tt(ke,we,be,Je,1);break;case"miter":case"miter-clip":default:const st=ze*te.strokeMiterLimit/_t;if(st<1)if(te.strokeLineJoin!=="miter-clip"){Et(Fe,ot,Je);break}else Nt(Fe,ot),Fe?(ge.subVectors(Ie,Te).multiplyScalar(st).add(Te),me.subVectors(Ie,Re).multiplyScalar(st).add(Re),nt(Te,Je,0),nt(ge,Je,0),nt(ke,Je,.5),nt(ke,Je,.5),nt(ge,Je,0),nt(me,Je,0),nt(ke,Je,.5),nt(me,Je,0),nt(Re,Je,0)):(ge.subVectors(Ie,be).multiplyScalar(st).add(be),me.subVectors(Ie,we).multiplyScalar(st).add(we),nt(be,Je,1),nt(ge,Je,1),nt(ke,Je,.5),nt(ke,Je,.5),nt(ge,Je,1),nt(me,Je,1),nt(ke,Je,.5),nt(me,Je,1),nt(we,Je,1));else ot?(Fe?(nt(ye,tt,1),nt(Ae,tt,0),nt(Ie,Je,0),nt(ye,tt,1),nt(Ie,Je,0),nt(Pe,Je,1)):(nt(ye,tt,1),nt(Ae,tt,0),nt(Ie,Je,1),nt(Ae,tt,0),nt(Pe,Je,0),nt(Ie,Je,1)),Fe?Re.copy(Ie):we.copy(Ie)):Fe?(nt(Te,Je,0),nt(Ie,Je,0),nt(ke,Je,.5),nt(ke,Je,.5),nt(Ie,Je,0),nt(Re,Je,0)):(nt(be,Je,1),nt(Ie,Je,1),nt(ke,Je,.5),nt(ke,Je,.5),nt(Ie,Je,1),nt(we,Je,1)),ct=!0;break}}else St()}else St();!Ue&&Ut===$e-1&&zt(Z[0],ve,_e,Fe,!0,tt),tt=Je,Ge=ke,Ae.copy(Re),ye.copy(we)}if(!Ue)zt(ke,Te,be,Fe,!1,Je);else if(ot&&oe){let Ut=Ie,bt=Pe;ht!==Fe&&(Ut=Pe,bt=Ie),Fe?(ct||ht)&&(bt.toArray(oe,0*3),bt.toArray(oe,3*3),ct&&Ut.toArray(oe,1*3)):(ct||!ht)&&(bt.toArray(oe,1*3),bt.toArray(oe,3*3),ct&&Ut.toArray(oe,0*3))}return lt;function it(Ut,bt,Ot){return Ot.subVectors(bt,Ut),Ot.set(-Ot.y,Ot.x).normalize()}function nt(Ut,bt,Ot){oe&&(oe[Qe]=Ut.x,oe[Qe+1]=Ut.y,oe[Qe+2]=0,se&&(se[Qe]=0,se[Qe+1]=0,se[Qe+2]=1),Qe+=3,ae&&(ae[Ze]=bt,ae[Ze+1]=Ot,Ze+=2)),lt+=3}function Tt(Ut,bt,Ot,Mt,_t){ce.copy(bt).sub(Ut).normalize(),fe.copy(Ot).sub(Ut).normalize();let pt=Math.PI;const ft=ce.dot(fe);Math.abs(ft)<1&&(pt=Math.abs(Math.acos(ft))),pt/=ne,de.copy(bt);for(let st=0,vt=ne-1;st<vt;st++)pe.copy(de).rotateAround(Ut,pt),nt(de,Mt,_t),nt(pe,Mt,_t),nt(Ut,Mt,.5),de.copy(pe);nt(pe,Mt,_t),nt(Ot,Mt,_t),nt(Ut,Mt,.5)}function St(){nt(ye,tt,1),nt(Ae,tt,0),nt(Te,Je,0),nt(ye,tt,1),nt(Te,Je,0),nt(be,Je,1)}function Et(Ut,bt,Ot){bt?Ut?(nt(ye,tt,1),nt(Ae,tt,0),nt(Te,Je,0),nt(ye,tt,1),nt(Te,Je,0),nt(Pe,Je,1),nt(Te,Ot,0),nt(Re,Ot,0),nt(Pe,Ot,.5)):(nt(ye,tt,1),nt(Ae,tt,0),nt(be,Je,1),nt(Ae,tt,0),nt(Pe,Je,0),nt(be,Je,1),nt(be,Ot,1),nt(Pe,Ot,0),nt(we,Ot,1)):Ut?(nt(Te,Ot,0),nt(Re,Ot,0),nt(ke,Ot,.5)):(nt(be,Ot,1),nt(we,Ot,0),nt(ke,Ot,.5))}function Nt(Ut,bt){bt&&(Ut?(nt(ye,tt,1),nt(Ae,tt,0),nt(Te,Je,0),nt(ye,tt,1),nt(Te,Je,0),nt(Pe,Je,1),nt(Te,tt,0),nt(ke,Je,.5),nt(Pe,Je,1),nt(ke,Je,.5),nt(Re,tt,0),nt(Pe,Je,1)):(nt(ye,tt,1),nt(Ae,tt,0),nt(be,Je,1),nt(Ae,tt,0),nt(Pe,Je,0),nt(be,Je,1),nt(be,tt,1),nt(Pe,Je,0),nt(ke,Je,.5),nt(ke,Je,.5),nt(Pe,Je,0),nt(we,tt,1)))}function zt(Ut,bt,Ot,Mt,_t,pt){switch(te.strokeLineCap){case"round":_t?Tt(Ut,Ot,bt,pt,.5):Tt(Ut,bt,Ot,pt,.5);break;case"square":if(_t)ce.subVectors(bt,Ut),fe.set(ce.y,-ce.x),de.addVectors(ce,fe).add(Ut),pe.subVectors(fe,ce).add(Ut),Mt?(de.toArray(oe,1*3),pe.toArray(oe,0*3),pe.toArray(oe,3*3)):(de.toArray(oe,1*3),ae[3*2+1]===1?pe.toArray(oe,3*3):de.toArray(oe,3*3),pe.toArray(oe,0*3));else{ce.subVectors(Ot,Ut),fe.set(ce.y,-ce.x),de.addVectors(ce,fe).add(Ut),pe.subVectors(fe,ce).add(Ut);const ft=oe.length;Mt?(de.toArray(oe,ft-1*3),pe.toArray(oe,ft-2*3),pe.toArray(oe,ft-4*3)):(pe.toArray(oe,ft-2*3),de.toArray(oe,ft-1*3),pe.toArray(oe,ft-4*3))}break}}function yt(Ut){let bt=!1;for(let Mt=1,_t=Ut.length-1;Mt<_t;Mt++)if(Ut[Mt].distanceTo(Ut[Mt+1])<ie){bt=!0;break}if(!bt)return Ut;const Ot=[];Ot.push(Ut[0]);for(let Mt=1,_t=Ut.length-1;Mt<_t;Mt++)Ut[Mt].distanceTo(Ut[Mt+1])>=ie&&Ot.push(Ut[Mt]);return Ot.push(Ut[Ut.length-1]),Ot}}}return K})(),_object_pattern=/^[og]\s*(.+)?/,_material_library_pattern=/^mtllib /,_material_use_pattern=/^usemtl /,_map_use_pattern=/^usemap /,_vA$2=new Vector3,_vB$2=new Vector3,_vC$2=new Vector3,_ab=new Vector3,_cb=new Vector3;function ParserState(){const K={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(_,Z){if(this.object&&this.object.fromDeclaration===!1){this.object.name=_,this.object.fromDeclaration=Z!==!1;return}const te=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:_||"",fromDeclaration:Z!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(ne,ie){const oe=this._finalize(!1);oe&&(oe.inherited||oe.groupCount<=0)&&this.materials.splice(oe.index,1);const se={index:this.materials.length,name:ne||"",mtllib:Array.isArray(ie)&&ie.length>0?ie[ie.length-1]:"",smooth:oe!==void 0?oe.smooth:this.smooth,groupStart:oe!==void 0?oe.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(ae){const le={index:typeof ae=="number"?ae:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return le.clone=this.clone.bind(le),le}};return this.materials.push(se),se},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(ne){const ie=this.currentMaterial();if(ie&&ie.groupEnd===-1&&(ie.groupEnd=this.geometry.vertices.length/3,ie.groupCount=ie.groupEnd-ie.groupStart,ie.inherited=!1),ne&&this.materials.length>1)for(let oe=this.materials.length-1;oe>=0;oe--)this.materials[oe].groupCount<=0&&this.materials.splice(oe,1);return ne&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),ie}},te&&te.name&&typeof te.clone=="function"){const ne=te.clone(0);ne.inherited=!0,this.object.materials.push(ne)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(_,Z){const te=parseInt(_,10);return(te>=0?te-1:te+Z/3)*3},parseNormalIndex:function(_,Z){const te=parseInt(_,10);return(te>=0?te-1:te+Z/3)*3},parseUVIndex:function(_,Z){const te=parseInt(_,10);return(te>=0?te-1:te+Z/2)*2},addVertex:function(_,Z,te){const ne=this.vertices,ie=this.object.geometry.vertices;ie.push(ne[_+0],ne[_+1],ne[_+2]),ie.push(ne[Z+0],ne[Z+1],ne[Z+2]),ie.push(ne[te+0],ne[te+1],ne[te+2])},addVertexPoint:function(_){const Z=this.vertices;this.object.geometry.vertices.push(Z[_+0],Z[_+1],Z[_+2])},addVertexLine:function(_){const Z=this.vertices;this.object.geometry.vertices.push(Z[_+0],Z[_+1],Z[_+2])},addNormal:function(_,Z,te){const ne=this.normals,ie=this.object.geometry.normals;ie.push(ne[_+0],ne[_+1],ne[_+2]),ie.push(ne[Z+0],ne[Z+1],ne[Z+2]),ie.push(ne[te+0],ne[te+1],ne[te+2])},addFaceNormal:function(_,Z,te){const ne=this.vertices,ie=this.object.geometry.normals;_vA$2.fromArray(ne,_),_vB$2.fromArray(ne,Z),_vC$2.fromArray(ne,te),_cb.subVectors(_vC$2,_vB$2),_ab.subVectors(_vA$2,_vB$2),_cb.cross(_ab),_cb.normalize(),ie.push(_cb.x,_cb.y,_cb.z),ie.push(_cb.x,_cb.y,_cb.z),ie.push(_cb.x,_cb.y,_cb.z)},addColor:function(_,Z,te){const ne=this.colors,ie=this.object.geometry.colors;ne[_]!==void 0&&ie.push(ne[_+0],ne[_+1],ne[_+2]),ne[Z]!==void 0&&ie.push(ne[Z+0],ne[Z+1],ne[Z+2]),ne[te]!==void 0&&ie.push(ne[te+0],ne[te+1],ne[te+2])},addUV:function(_,Z,te){const ne=this.uvs,ie=this.object.geometry.uvs;ie.push(ne[_+0],ne[_+1]),ie.push(ne[Z+0],ne[Z+1]),ie.push(ne[te+0],ne[te+1])},addDefaultUV:function(){const _=this.object.geometry.uvs;_.push(0,0),_.push(0,0),_.push(0,0)},addUVLine:function(_){const Z=this.uvs;this.object.geometry.uvs.push(Z[_+0],Z[_+1])},addFace:function(_,Z,te,ne,ie,oe,se,ae,le){const ce=this.vertices.length;let fe=this.parseVertexIndex(_,ce),de=this.parseVertexIndex(Z,ce),pe=this.parseVertexIndex(te,ce);if(this.addVertex(fe,de,pe),this.addColor(fe,de,pe),se!==void 0&&se!==""){const he=this.normals.length;fe=this.parseNormalIndex(se,he),de=this.parseNormalIndex(ae,he),pe=this.parseNormalIndex(le,he),this.addNormal(fe,de,pe)}else this.addFaceNormal(fe,de,pe);if(ne!==void 0&&ne!==""){const he=this.uvs.length;fe=this.parseUVIndex(ne,he),de=this.parseUVIndex(ie,he),pe=this.parseUVIndex(oe,he),this.addUV(fe,de,pe),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(_){this.object.geometry.type="Points";const Z=this.vertices.length;for(let te=0,ne=_.length;te<ne;te++){const ie=this.parseVertexIndex(_[te],Z);this.addVertexPoint(ie),this.addColor(ie)}},addLineGeometry:function(_,Z){this.object.geometry.type="Line";const te=this.vertices.length,ne=this.uvs.length;for(let ie=0,oe=_.length;ie<oe;ie++)this.addVertexLine(this.parseVertexIndex(_[ie],te));for(let ie=0,oe=Z.length;ie<oe;ie++)this.addUVLine(this.parseUVIndex(Z[ie],ne))}};return K.startObject("",!1),K}class OBJLoader extends Loader{constructor(_){super(_),this.materials=null}load(_,Z,te,ne){const ie=this,oe=new FileLoader(this.manager);oe.setPath(this.path),oe.setRequestHeader(this.requestHeader),oe.setWithCredentials(this.withCredentials),oe.load(_,function(se){try{Z(ie.parse(se))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}setMaterials(_){return this.materials=_,this}parse(_){const Z=new ParserState;_.indexOf(`\r
`)!==-1&&(_=_.replace(/\r\n/g,`
`)),_.indexOf(`\\
`)!==-1&&(_=_.replace(/\\\n/g,""));const te=_.split(`
`);let ne="",ie="",oe=0,se=[];const ae=typeof"".trimLeft=="function";for(let fe=0,de=te.length;fe<de;fe++)if(ne=te[fe],ne=ae?ne.trimLeft():ne.trim(),oe=ne.length,oe!==0&&(ie=ne.charAt(0),ie!=="#"))if(ie==="v"){const pe=ne.split(/\s+/);switch(pe[0]){case"v":Z.vertices.push(parseFloat(pe[1]),parseFloat(pe[2]),parseFloat(pe[3])),pe.length>=7?Z.colors.push(parseFloat(pe[4]),parseFloat(pe[5]),parseFloat(pe[6])):Z.colors.push(void 0,void 0,void 0);break;case"vn":Z.normals.push(parseFloat(pe[1]),parseFloat(pe[2]),parseFloat(pe[3]));break;case"vt":Z.uvs.push(parseFloat(pe[1]),parseFloat(pe[2]));break}}else if(ie==="f"){const he=ne.substr(1).trim().split(/\s+/),ge=[];for(let Ae=0,ye=he.length;Ae<ye;Ae++){const ve=he[Ae];if(ve.length>0){const _e=ve.split("/");ge.push(_e)}}const me=ge[0];for(let Ae=1,ye=ge.length-1;Ae<ye;Ae++){const ve=ge[Ae],_e=ge[Ae+1];Z.addFace(me[0],ve[0],_e[0],me[1],ve[1],_e[1],me[2],ve[2],_e[2])}}else if(ie==="l"){const pe=ne.substring(1).trim().split(" ");let he=[];const ge=[];if(ne.indexOf("/")===-1)he=pe;else for(let me=0,Ae=pe.length;me<Ae;me++){const ye=pe[me].split("/");ye[0]!==""&&he.push(ye[0]),ye[1]!==""&&ge.push(ye[1])}Z.addLineGeometry(he,ge)}else if(ie==="p"){const he=ne.substr(1).trim().split(" ");Z.addPointGeometry(he)}else if((se=_object_pattern.exec(ne))!==null){const pe=(" "+se[0].substr(1).trim()).substr(1);Z.startObject(pe)}else if(_material_use_pattern.test(ne))Z.object.startMaterial(ne.substring(7).trim(),Z.materialLibraries);else if(_material_library_pattern.test(ne))Z.materialLibraries.push(ne.substring(7).trim());else if(_map_use_pattern.test(ne))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(ie==="s"){if(se=ne.split(" "),se.length>1){const he=se[1].trim().toLowerCase();Z.object.smooth=he!=="0"&&he!=="off"}else Z.object.smooth=!0;const pe=Z.object.currentMaterial();pe&&(pe.smooth=Z.object.smooth)}else{if(ne==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+ne+'"')}Z.finalize();const le=new Group;if(le.materialLibraries=[].concat(Z.materialLibraries),!(Z.objects.length===1&&Z.objects[0].geometry.vertices.length===0)===!0)for(let fe=0,de=Z.objects.length;fe<de;fe++){const pe=Z.objects[fe],he=pe.geometry,ge=pe.materials,me=he.type==="Line",Ae=he.type==="Points";let ye=!1;if(he.vertices.length===0)continue;const ve=new BufferGeometry;ve.setAttribute("position",new Float32BufferAttribute(he.vertices,3)),he.normals.length>0&&ve.setAttribute("normal",new Float32BufferAttribute(he.normals,3)),he.colors.length>0&&(ye=!0,ve.setAttribute("color",new Float32BufferAttribute(he.colors,3))),he.hasUVIndices===!0&&ve.setAttribute("uv",new Float32BufferAttribute(he.uvs,2));const _e=[];for(let be=0,Re=ge.length;be<Re;be++){const we=ge[be],Pe=we.name+"_"+we.smooth+"_"+ye;let Ie=Z.materials[Pe];if(this.materials!==null){if(Ie=this.materials.create(we.name),me&&Ie&&!(Ie instanceof LineBasicMaterial)){const $e=new LineBasicMaterial;Material.prototype.copy.call($e,Ie),$e.color.copy(Ie.color),Ie=$e}else if(Ae&&Ie&&!(Ie instanceof PointsMaterial)){const $e=new PointsMaterial({size:10,sizeAttenuation:!1});Material.prototype.copy.call($e,Ie),$e.color.copy(Ie.color),$e.map=Ie.map,Ie=$e}}Ie===void 0&&(me?Ie=new LineBasicMaterial:Ae?Ie=new PointsMaterial({size:1,sizeAttenuation:!1}):Ie=new MeshPhongMaterial,Ie.name=we.name,Ie.flatShading=!we.smooth,Ie.vertexColors=ye,Z.materials[Pe]=Ie),_e.push(Ie)}let Te;if(_e.length>1){for(let be=0,Re=ge.length;be<Re;be++){const we=ge[be];ve.addGroup(we.groupStart,we.groupCount,be)}me?Te=new LineSegments(ve,_e):Ae?Te=new Points$1(ve,_e):Te=new Mesh(ve,_e)}else me?Te=new LineSegments(ve,_e[0]):Ae?Te=new Points$1(ve,_e[0]):Te=new Mesh(ve,_e[0]);Te.name=pe.name,le.add(Te)}else if(Z.vertices.length>0){const fe=new PointsMaterial({size:1,sizeAttenuation:!1}),de=new BufferGeometry;de.setAttribute("position",new Float32BufferAttribute(Z.vertices,3)),Z.colors.length>0&&Z.colors[0]!==void 0&&(de.setAttribute("color",new Float32BufferAttribute(Z.colors,3)),fe.vertexColors=!0);const pe=new Points$1(de,fe);le.add(pe)}return le}}const _taskCache=new WeakMap;class DRACOLoader extends Loader{constructor(_){super(_),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(_){return this.decoderPath=_,this}setDecoderConfig(_){return this.decoderConfig=_,this}setWorkerLimit(_){return this.workerLimit=_,this}load(_,Z,te,ne){const ie=new FileLoader(this.manager);ie.setPath(this.path),ie.setResponseType("arraybuffer"),ie.setRequestHeader(this.requestHeader),ie.setWithCredentials(this.withCredentials),ie.load(_,oe=>{const se={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(oe,se).then(Z).catch(ne)},te,ne)}decodeDracoFile(_,Z,te,ne){const ie={attributeIDs:te||this.defaultAttributeIDs,attributeTypes:ne||this.defaultAttributeTypes,useUniqueIDs:!!te};this.decodeGeometry(_,ie).then(Z)}decodeGeometry(_,Z){for(const ae in Z.attributeTypes){const le=Z.attributeTypes[ae];le.BYTES_PER_ELEMENT!==void 0&&(Z.attributeTypes[ae]=le.name)}const te=JSON.stringify(Z);if(_taskCache.has(_)){const ae=_taskCache.get(_);if(ae.key===te)return ae.promise;if(_.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let ne;const ie=this.workerNextTaskID++,oe=_.byteLength,se=this._getWorker(ie,oe).then(ae=>(ne=ae,new Promise((le,ce)=>{ne._callbacks[ie]={resolve:le,reject:ce},ne.postMessage({type:"decode",id:ie,taskConfig:Z,buffer:_},[_])}))).then(ae=>this._createGeometry(ae.geometry));return se.catch(()=>!0).then(()=>{ne&&ie&&this._releaseTask(ne,ie)}),_taskCache.set(_,{key:te,promise:se}),se}_createGeometry(_){const Z=new BufferGeometry;_.index&&Z.setIndex(new BufferAttribute(_.index.array,1));for(let te=0;te<_.attributes.length;te++){const ne=_.attributes[te],ie=ne.name,oe=ne.array,se=ne.itemSize;Z.setAttribute(ie,new BufferAttribute(oe,se))}return Z}_loadLibrary(_,Z){const te=new FileLoader(this.manager);return te.setPath(this.decoderPath),te.setResponseType(Z),te.setWithCredentials(this.withCredentials),new Promise((ne,ie)=>{te.load(_,ne,void 0,ie)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const _=typeof WebAssembly!="object"||this.decoderConfig.type==="js",Z=[];return _?Z.push(this._loadLibrary("draco_decoder.js","text")):(Z.push(this._loadLibrary("draco_wasm_wrapper.js","text")),Z.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(Z).then(te=>{const ne=te[0];_||(this.decoderConfig.wasmBinary=te[1]);const ie=DRACOWorker.toString(),oe=["/* draco decoder */",ne,"","/* worker */",ie.substring(ie.indexOf("{")+1,ie.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([oe]))}),this.decoderPending}_getWorker(_,Z){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const ne=new Worker(this.workerSourceURL);ne._callbacks={},ne._taskCosts={},ne._taskLoad=0,ne.postMessage({type:"init",decoderConfig:this.decoderConfig}),ne.onmessage=function(ie){const oe=ie.data;switch(oe.type){case"decode":ne._callbacks[oe.id].resolve(oe);break;case"error":ne._callbacks[oe.id].reject(oe);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+oe.type+'"')}},this.workerPool.push(ne)}else this.workerPool.sort(function(ne,ie){return ne._taskLoad>ie._taskLoad?-1:1});const te=this.workerPool[this.workerPool.length-1];return te._taskCosts[_]=Z,te._taskLoad+=Z,te})}_releaseTask(_,Z){_._taskLoad-=_._taskCosts[Z],delete _._callbacks[Z],delete _._taskCosts[Z]}debug(){console.log("Task load: ",this.workerPool.map(_=>_._taskLoad))}dispose(){for(let _=0;_<this.workerPool.length;++_)this.workerPool[_].terminate();return this.workerPool.length=0,this}}function DRACOWorker(){let K,_;onmessage=function(oe){const se=oe.data;switch(se.type){case"init":K=se.decoderConfig,_=new Promise(function(ce){K.onModuleLoaded=function(fe){ce({draco:fe})},DracoDecoderModule(K)});break;case"decode":const ae=se.buffer,le=se.taskConfig;_.then(ce=>{const fe=ce.draco,de=new fe.Decoder,pe=new fe.DecoderBuffer;pe.Init(new Int8Array(ae),ae.byteLength);try{const he=Z(fe,de,pe,le),ge=he.attributes.map(me=>me.array.buffer);he.index&&ge.push(he.index.array.buffer),self.postMessage({type:"decode",id:se.id,geometry:he},ge)}catch(he){console.error(he),self.postMessage({type:"error",id:se.id,error:he.message})}finally{fe.destroy(pe),fe.destroy(de)}});break}};function Z(oe,se,ae,le){const ce=le.attributeIDs,fe=le.attributeTypes;let de,pe;const he=se.GetEncodedGeometryType(ae);if(he===oe.TRIANGULAR_MESH)de=new oe.Mesh,pe=se.DecodeBufferToMesh(ae,de);else if(he===oe.POINT_CLOUD)de=new oe.PointCloud,pe=se.DecodeBufferToPointCloud(ae,de);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!pe.ok()||de.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+pe.error_msg());const ge={index:null,attributes:[]};for(const me in ce){const Ae=self[fe[me]];let ye,ve;if(le.useUniqueIDs)ve=ce[me],ye=se.GetAttributeByUniqueId(de,ve);else{if(ve=se.GetAttributeId(de,oe[ce[me]]),ve===-1)continue;ye=se.GetAttribute(de,ve)}ge.attributes.push(ne(oe,se,de,me,Ae,ye))}return he===oe.TRIANGULAR_MESH&&(ge.index=te(oe,se,de)),oe.destroy(de),ge}function te(oe,se,ae){const ce=ae.num_faces()*3,fe=ce*4,de=oe._malloc(fe);se.GetTrianglesUInt32Array(ae,fe,de);const pe=new Uint32Array(oe.HEAPF32.buffer,de,ce).slice();return oe._free(de),{array:pe,itemSize:1}}function ne(oe,se,ae,le,ce,fe){const de=fe.num_components(),he=ae.num_points()*de,ge=he*ce.BYTES_PER_ELEMENT,me=ie(oe,ce),Ae=oe._malloc(ge);se.GetAttributeDataArrayForAllPoints(ae,fe,me,ge,Ae);const ye=new ce(oe.HEAPF32.buffer,Ae,he).slice();return oe._free(Ae),{name:le,array:ye,itemSize:de}}function ie(oe,se){switch(se){case Float32Array:return oe.DT_FLOAT32;case Int8Array:return oe.DT_INT8;case Int16Array:return oe.DT_INT16;case Int32Array:return oe.DT_INT32;case Uint8Array:return oe.DT_UINT8;case Uint16Array:return oe.DT_UINT16;case Uint32Array:return oe.DT_UINT32}}}class PCDLoader extends Loader{constructor(_){super(_),this.littleEndian=!0}load(_,Z,te,ne){const ie=this,oe=new FileLoader(ie.manager);oe.setPath(ie.path),oe.setResponseType("arraybuffer"),oe.setRequestHeader(ie.requestHeader),oe.setWithCredentials(ie.withCredentials),oe.load(_,function(se){try{Z(ie.parse(se,_))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}parse(_,Z){function te(he,ge){const me=he.length,Ae=new Uint8Array(ge);let ye=0,ve=0,_e,Te,be;do if(_e=he[ye++],_e<32){if(_e++,ve+_e>ge)throw new Error("Output buffer is not large enough");if(ye+_e>me)throw new Error("Invalid compressed data");do Ae[ve++]=he[ye++];while(--_e)}else{if(Te=_e>>5,be=ve-((_e&31)<<8)-1,ye>=me)throw new Error("Invalid compressed data");if(Te===7&&(Te+=he[ye++],ye>=me))throw new Error("Invalid compressed data");if(be-=he[ye++],ve+Te+2>ge)throw new Error("Output buffer is not large enough");if(be<0)throw new Error("Invalid compressed data");if(be>=ve)throw new Error("Invalid compressed data");do Ae[ve++]=Ae[be++];while(--Te+2)}while(ye<me);return Ae}function ne(he){const ge={},me=he.search(/[\r\n]DATA\s(\S*)\s/i),Ae=/[\r\n]DATA\s(\S*)\s/i.exec(he.substr(me-1));if(ge.data=Ae[1],ge.headerLen=Ae[0].length+me,ge.str=he.substr(0,ge.headerLen),ge.str=ge.str.replace(/\#.*/gi,""),ge.version=/VERSION (.*)/i.exec(ge.str),ge.fields=/FIELDS (.*)/i.exec(ge.str),ge.size=/SIZE (.*)/i.exec(ge.str),ge.type=/TYPE (.*)/i.exec(ge.str),ge.count=/COUNT (.*)/i.exec(ge.str),ge.width=/WIDTH (.*)/i.exec(ge.str),ge.height=/HEIGHT (.*)/i.exec(ge.str),ge.viewpoint=/VIEWPOINT (.*)/i.exec(ge.str),ge.points=/POINTS (.*)/i.exec(ge.str),ge.version!==null&&(ge.version=parseFloat(ge.version[1])),ge.fields!==null&&(ge.fields=ge.fields[1].split(" ")),ge.type!==null&&(ge.type=ge.type[1].split(" ")),ge.width!==null&&(ge.width=parseInt(ge.width[1])),ge.height!==null&&(ge.height=parseInt(ge.height[1])),ge.viewpoint!==null&&(ge.viewpoint=ge.viewpoint[1]),ge.points!==null&&(ge.points=parseInt(ge.points[1],10)),ge.points===null&&(ge.points=ge.width*ge.height),ge.size!==null&&(ge.size=ge.size[1].split(" ").map(function(ve){return parseInt(ve,10)})),ge.count!==null)ge.count=ge.count[1].split(" ").map(function(ve){return parseInt(ve,10)});else{ge.count=[];for(let ve=0,_e=ge.fields.length;ve<_e;ve++)ge.count.push(1)}ge.offset={};let ye=0;for(let ve=0,_e=ge.fields.length;ve<_e;ve++)ge.data==="ascii"?ge.offset[ge.fields[ve]]=ve:(ge.offset[ge.fields[ve]]=ye,ye+=ge.size[ve]*ge.count[ve]);return ge.rowSize=ye,ge}const ie=decodeText$1(new Uint8Array(_)),oe=ne(ie),se=[],ae=[],le=[];if(oe.data==="ascii"){const he=oe.offset,me=ie.substr(oe.headerLen).split(`
`);for(let Ae=0,ye=me.length;Ae<ye;Ae++){if(me[Ae]==="")continue;const ve=me[Ae].split(" ");if(he.x!==void 0&&(se.push(parseFloat(ve[he.x])),se.push(parseFloat(ve[he.y])),se.push(parseFloat(ve[he.z]))),he.rgb!==void 0){const _e=parseFloat(ve[he.rgb]),Te=_e>>16&255,be=_e>>8&255,Re=_e>>0&255;le.push(Te/255,be/255,Re/255)}he.normal_x!==void 0&&(ae.push(parseFloat(ve[he.normal_x])),ae.push(parseFloat(ve[he.normal_y])),ae.push(parseFloat(ve[he.normal_z])))}}if(oe.data==="binary_compressed"){const he=new Uint32Array(_.slice(oe.headerLen,oe.headerLen+8)),ge=he[0],me=he[1],Ae=te(new Uint8Array(_,oe.headerLen+8,ge),me),ye=new DataView(Ae.buffer),ve=oe.offset;for(let _e=0;_e<oe.points;_e++)ve.x!==void 0&&(se.push(ye.getFloat32(oe.points*ve.x+oe.size[0]*_e,this.littleEndian)),se.push(ye.getFloat32(oe.points*ve.y+oe.size[1]*_e,this.littleEndian)),se.push(ye.getFloat32(oe.points*ve.z+oe.size[2]*_e,this.littleEndian))),ve.rgb!==void 0&&(le.push(ye.getUint8(oe.points*ve.rgb+oe.size[3]*_e+2)/255),le.push(ye.getUint8(oe.points*ve.rgb+oe.size[3]*_e+1)/255),le.push(ye.getUint8(oe.points*ve.rgb+oe.size[3]*_e+0)/255)),ve.normal_x!==void 0&&(ae.push(ye.getFloat32(oe.points*ve.normal_x+oe.size[4]*_e,this.littleEndian)),ae.push(ye.getFloat32(oe.points*ve.normal_y+oe.size[5]*_e,this.littleEndian)),ae.push(ye.getFloat32(oe.points*ve.normal_z+oe.size[6]*_e,this.littleEndian)))}if(oe.data==="binary"){const he=new DataView(_,oe.headerLen),ge=oe.offset;for(let me=0,Ae=0;me<oe.points;me++,Ae+=oe.rowSize)ge.x!==void 0&&(se.push(he.getFloat32(Ae+ge.x,this.littleEndian)),se.push(he.getFloat32(Ae+ge.y,this.littleEndian)),se.push(he.getFloat32(Ae+ge.z,this.littleEndian))),ge.rgb!==void 0&&(le.push(he.getUint8(Ae+ge.rgb+2)/255),le.push(he.getUint8(Ae+ge.rgb+1)/255),le.push(he.getUint8(Ae+ge.rgb+0)/255)),ge.normal_x!==void 0&&(ae.push(he.getFloat32(Ae+ge.normal_x,this.littleEndian)),ae.push(he.getFloat32(Ae+ge.normal_y,this.littleEndian)),ae.push(he.getFloat32(Ae+ge.normal_z,this.littleEndian)))}const ce=new BufferGeometry;se.length>0&&ce.setAttribute("position",new Float32BufferAttribute(se,3)),ae.length>0&&ce.setAttribute("normal",new Float32BufferAttribute(ae,3)),le.length>0&&ce.setAttribute("color",new Float32BufferAttribute(le,3)),ce.computeBoundingSphere();const fe=new PointsMaterial({size:.005});le.length>0?fe.vertexColors=!0:fe.color.setHex(Math.random()*16777215);const de=new Points$1(ce,fe);let pe=Z.split("").reverse().join("");return pe=/([^\/]*)/.exec(pe),pe=pe[1].split("").reverse().join(""),de.name=pe,de}}class PLYLoader extends Loader{constructor(_){super(_),this.propertyNameMapping={}}load(_,Z,te,ne){const ie=this,oe=new FileLoader(this.manager);oe.setPath(this.path),oe.setResponseType("arraybuffer"),oe.setRequestHeader(this.requestHeader),oe.setWithCredentials(this.withCredentials),oe.load(_,function(se){try{Z(ie.parse(se))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}setPropertyNameMapping(_){this.propertyNameMapping=_}parse(_){function Z(pe){const he=/ply([\s\S]*)end_header\r?\n/;let ge="",me=0;const Ae=he.exec(pe);Ae!==null&&(ge=Ae[1],me=new Blob([Ae[0]]).size);const ye={comments:[],elements:[],headerLength:me,objInfo:""},ve=ge.split(`
`);let _e;function Te(be,Re){const we={type:be[0]};return we.type==="list"?(we.name=be[3],we.countType=be[1],we.itemType=be[2]):we.name=be[1],we.name in Re&&(we.name=Re[we.name]),we}for(let be=0;be<ve.length;be++){let Re=ve[be];if(Re=Re.trim(),Re==="")continue;const we=Re.split(/\s+/),Pe=we.shift();switch(Re=we.join(" "),Pe){case"format":ye.format=we[0],ye.version=we[1];break;case"comment":ye.comments.push(Re);break;case"element":_e!==void 0&&ye.elements.push(_e),_e={},_e.name=we[0],_e.count=parseInt(we[1]),_e.properties=[];break;case"property":_e.properties.push(Te(we,de.propertyNameMapping));break;case"obj_info":ye.objInfo=Re;break;default:console.log("unhandled",Pe,we)}}return _e!==void 0&&ye.elements.push(_e),ye}function te(pe,he){switch(he){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(pe);case"float":case"double":case"float32":case"float64":return parseFloat(pe)}}function ne(pe,he){const ge=he.split(/\s+/),me={};for(let Ae=0;Ae<pe.length;Ae++)if(pe[Ae].type==="list"){const ye=[],ve=te(ge.shift(),pe[Ae].countType);for(let _e=0;_e<ve;_e++)ye.push(te(ge.shift(),pe[Ae].itemType));me[pe[Ae].name]=ye}else me[pe[Ae].name]=te(ge.shift(),pe[Ae].type);return me}function ie(pe,he){const ge={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};let me;const Ae=/end_header\s([\s\S]*)$/;let ye="";(me=Ae.exec(pe))!==null&&(ye=me[1]);const ve=ye.split(`
`);let _e=0,Te=0;for(let be=0;be<ve.length;be++){let Re=ve[be];if(Re=Re.trim(),Re==="")continue;Te>=he.elements[_e].count&&(_e++,Te=0);const we=ne(he.elements[_e].properties,Re);se(ge,he.elements[_e].name,we),Te++}return oe(ge)}function oe(pe){let he=new BufferGeometry;return pe.indices.length>0&&he.setIndex(pe.indices),he.setAttribute("position",new Float32BufferAttribute(pe.vertices,3)),pe.normals.length>0&&he.setAttribute("normal",new Float32BufferAttribute(pe.normals,3)),pe.uvs.length>0&&he.setAttribute("uv",new Float32BufferAttribute(pe.uvs,2)),pe.colors.length>0&&he.setAttribute("color",new Float32BufferAttribute(pe.colors,3)),pe.faceVertexUvs.length>0&&(he=he.toNonIndexed(),he.setAttribute("uv",new Float32BufferAttribute(pe.faceVertexUvs,2))),he.computeBoundingSphere(),he}function se(pe,he,ge){if(he==="vertex")pe.vertices.push(ge.x,ge.y,ge.z),"nx"in ge&&"ny"in ge&&"nz"in ge&&pe.normals.push(ge.nx,ge.ny,ge.nz),"s"in ge&&"t"in ge&&pe.uvs.push(ge.s,ge.t),"red"in ge&&"green"in ge&&"blue"in ge&&pe.colors.push(ge.red/255,ge.green/255,ge.blue/255);else if(he==="face"){const me=ge.vertex_indices||ge.vertex_index,Ae=ge.texcoord;me.length===3?(pe.indices.push(me[0],me[1],me[2]),Ae&&Ae.length===6&&(pe.faceVertexUvs.push(Ae[0],Ae[1]),pe.faceVertexUvs.push(Ae[2],Ae[3]),pe.faceVertexUvs.push(Ae[4],Ae[5]))):me.length===4&&(pe.indices.push(me[0],me[1],me[3]),pe.indices.push(me[1],me[2],me[3]))}}function ae(pe,he,ge,me){switch(ge){case"int8":case"char":return[pe.getInt8(he),1];case"uint8":case"uchar":return[pe.getUint8(he),1];case"int16":case"short":return[pe.getInt16(he,me),2];case"uint16":case"ushort":return[pe.getUint16(he,me),2];case"int32":case"int":return[pe.getInt32(he,me),4];case"uint32":case"uint":return[pe.getUint32(he,me),4];case"float32":case"float":return[pe.getFloat32(he,me),4];case"float64":case"double":return[pe.getFloat64(he,me),8]}}function le(pe,he,ge,me){const Ae={};let ye,ve=0;for(let _e=0;_e<ge.length;_e++)if(ge[_e].type==="list"){const Te=[];ye=ae(pe,he+ve,ge[_e].countType,me);const be=ye[0];ve+=ye[1];for(let Re=0;Re<be;Re++)ye=ae(pe,he+ve,ge[_e].itemType,me),Te.push(ye[0]),ve+=ye[1];Ae[ge[_e].name]=Te}else ye=ae(pe,he+ve,ge[_e].type,me),Ae[ge[_e].name]=ye[0],ve+=ye[1];return[Ae,ve]}function ce(pe,he){const ge={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},me=he.format==="binary_little_endian",Ae=new DataView(pe,he.headerLength);let ye,ve=0;for(let _e=0;_e<he.elements.length;_e++)for(let Te=0;Te<he.elements[_e].count;Te++){ye=le(Ae,ve,he.elements[_e].properties,me),ve+=ye[1];const be=ye[0];se(ge,he.elements[_e].name,be)}return oe(ge)}let fe;const de=this;if(_ instanceof ArrayBuffer){const pe=decodeText$1(new Uint8Array(_)),he=Z(pe);fe=he.format==="ascii"?ie(pe,he):ce(_,he)}else fe=ie(_,Z(_));return fe}}const _box$1=new Box3,_vector=new Vector3;class LineSegmentsGeometry extends InstancedBufferGeometry{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const _=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],Z=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],te=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(te),this.setAttribute("position",new Float32BufferAttribute(_,3)),this.setAttribute("uv",new Float32BufferAttribute(Z,2))}applyMatrix4(_){const Z=this.attributes.instanceStart,te=this.attributes.instanceEnd;return Z!==void 0&&(Z.applyMatrix4(_),te.applyMatrix4(_),Z.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(_){let Z;_ instanceof Float32Array?Z=_:Array.isArray(_)&&(Z=new Float32Array(_));const te=new InstancedInterleavedBuffer(Z,6,1);return this.setAttribute("instanceStart",new InterleavedBufferAttribute(te,3,0)),this.setAttribute("instanceEnd",new InterleavedBufferAttribute(te,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(_,Z=3){let te;_ instanceof Float32Array?te=_:Array.isArray(_)&&(te=new Float32Array(_));const ne=new InstancedInterleavedBuffer(te,Z*2,1);return this.setAttribute("instanceColorStart",new InterleavedBufferAttribute(ne,Z,0)),this.setAttribute("instanceColorEnd",new InterleavedBufferAttribute(ne,Z,Z)),this}fromWireframeGeometry(_){return this.setPositions(_.attributes.position.array),this}fromEdgesGeometry(_){return this.setPositions(_.attributes.position.array),this}fromMesh(_){return this.fromWireframeGeometry(new WireframeGeometry(_.geometry)),this}fromLineSegments(_){const Z=_.geometry;return this.setPositions(Z.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this.attributes.instanceStart,Z=this.attributes.instanceEnd;_!==void 0&&Z!==void 0&&(this.boundingBox.setFromBufferAttribute(_),_box$1.setFromBufferAttribute(Z),this.boundingBox.union(_box$1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$2),this.boundingBox===null&&this.computeBoundingBox();const _=this.attributes.instanceStart,Z=this.attributes.instanceEnd;if(_!==void 0&&Z!==void 0){const te=this.boundingSphere.center;this.boundingBox.getCenter(te);let ne=0;for(let ie=0,oe=_.count;ie<oe;ie++)_vector.fromBufferAttribute(_,ie),ne=Math.max(ne,te.distanceToSquared(_vector)),_vector.fromBufferAttribute(Z,ie),ne=Math.max(ne,te.distanceToSquared(_vector));this.boundingSphere.radius=Math.sqrt(ne),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(_){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(_)}}class LineGeometry extends LineSegmentsGeometry{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(_){const Z=_.length-3,te=new Float32Array(2*Z);for(let ne=0;ne<Z;ne+=3)te[2*ne]=_[ne],te[2*ne+1]=_[ne+1],te[2*ne+2]=_[ne+2],te[2*ne+3]=_[ne+3],te[2*ne+4]=_[ne+4],te[2*ne+5]=_[ne+5];return super.setPositions(te),this}setColors(_,Z=3){const te=_.length-Z,ne=new Float32Array(2*te);if(Z===3)for(let ie=0;ie<te;ie+=Z)ne[2*ie]=_[ie],ne[2*ie+1]=_[ie+1],ne[2*ie+2]=_[ie+2],ne[2*ie+3]=_[ie+3],ne[2*ie+4]=_[ie+4],ne[2*ie+5]=_[ie+5];else for(let ie=0;ie<te;ie+=Z)ne[2*ie]=_[ie],ne[2*ie+1]=_[ie+1],ne[2*ie+2]=_[ie+2],ne[2*ie+3]=_[ie+3],ne[2*ie+4]=_[ie+4],ne[2*ie+5]=_[ie+5],ne[2*ie+6]=_[ie+6],ne[2*ie+7]=_[ie+7];return super.setColors(ne,Z),this}fromLine(_){const Z=_.geometry;return this.setPositions(Z.attributes.position.array),this}}class LineMaterial extends ShaderMaterial{constructor(_){super({type:"LineMaterial",uniforms:UniformsUtils.clone(UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${version$4>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(Z){this.uniforms.diffuse.value=Z}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(Z){Z===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(Z){this.uniforms.linewidth.value=Z}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(Z){!!Z!="USE_DASH"in this.defines&&(this.needsUpdate=!0),Z===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(Z){this.uniforms.dashScale.value=Z}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(Z){this.uniforms.dashSize.value=Z}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(Z){this.uniforms.dashOffset.value=Z}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(Z){this.uniforms.gapSize.value=Z}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(Z){this.uniforms.opacity.value=Z}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(Z){this.uniforms.resolution.value.copy(Z)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(Z){!!Z!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),Z===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(_)}}const _viewport=new Vector4,_start=new Vector3,_end=new Vector3,_start4=new Vector4,_end4=new Vector4,_ssOrigin=new Vector4,_ssOrigin3=new Vector3,_mvMatrix=new Matrix4,_line=new Line3,_closestPoint=new Vector3,_box=new Box3,_sphere$1=new Sphere$2,_clipToWorldVector=new Vector4;let _ray$1,_lineWidth;function getWorldSpaceHalfWidth(K,_,Z){return _clipToWorldVector.set(0,0,-_,1).applyMatrix4(K.projectionMatrix),_clipToWorldVector.multiplyScalar(1/_clipToWorldVector.w),_clipToWorldVector.x=_lineWidth/Z.width,_clipToWorldVector.y=_lineWidth/Z.height,_clipToWorldVector.applyMatrix4(K.projectionMatrixInverse),_clipToWorldVector.multiplyScalar(1/_clipToWorldVector.w),Math.abs(Math.max(_clipToWorldVector.x,_clipToWorldVector.y))}function raycastWorldUnits(K,_){const Z=K.matrixWorld,te=K.geometry,ne=te.attributes.instanceStart,ie=te.attributes.instanceEnd,oe=Math.min(te.instanceCount,ne.count);for(let se=0,ae=oe;se<ae;se++){_line.start.fromBufferAttribute(ne,se),_line.end.fromBufferAttribute(ie,se),_line.applyMatrix4(Z);const le=new Vector3,ce=new Vector3;_ray$1.distanceSqToSegment(_line.start,_line.end,ce,le),ce.distanceTo(le)<_lineWidth*.5&&_.push({point:ce,pointOnLine:le,distance:_ray$1.origin.distanceTo(ce),object:K,face:null,faceIndex:se,uv:null,[UV1]:null})}}function raycastScreenSpace(K,_,Z){const te=_.projectionMatrix,ie=K.material.resolution,oe=K.matrixWorld,se=K.geometry,ae=se.attributes.instanceStart,le=se.attributes.instanceEnd,ce=Math.min(se.instanceCount,ae.count),fe=-_.near;_ray$1.at(1,_ssOrigin),_ssOrigin.w=1,_ssOrigin.applyMatrix4(_.matrixWorldInverse),_ssOrigin.applyMatrix4(te),_ssOrigin.multiplyScalar(1/_ssOrigin.w),_ssOrigin.x*=ie.x/2,_ssOrigin.y*=ie.y/2,_ssOrigin.z=0,_ssOrigin3.copy(_ssOrigin),_mvMatrix.multiplyMatrices(_.matrixWorldInverse,oe);for(let de=0,pe=ce;de<pe;de++){if(_start4.fromBufferAttribute(ae,de),_end4.fromBufferAttribute(le,de),_start4.w=1,_end4.w=1,_start4.applyMatrix4(_mvMatrix),_end4.applyMatrix4(_mvMatrix),_start4.z>fe&&_end4.z>fe)continue;if(_start4.z>fe){const ve=_start4.z-_end4.z,_e=(_start4.z-fe)/ve;_start4.lerp(_end4,_e)}else if(_end4.z>fe){const ve=_end4.z-_start4.z,_e=(_end4.z-fe)/ve;_end4.lerp(_start4,_e)}_start4.applyMatrix4(te),_end4.applyMatrix4(te),_start4.multiplyScalar(1/_start4.w),_end4.multiplyScalar(1/_end4.w),_start4.x*=ie.x/2,_start4.y*=ie.y/2,_end4.x*=ie.x/2,_end4.y*=ie.y/2,_line.start.copy(_start4),_line.start.z=0,_line.end.copy(_end4),_line.end.z=0;const ge=_line.closestPointToPointParameter(_ssOrigin3,!0);_line.at(ge,_closestPoint);const me=MathUtils.lerp(_start4.z,_end4.z,ge),Ae=me>=-1&&me<=1,ye=_ssOrigin3.distanceTo(_closestPoint)<_lineWidth*.5;if(Ae&&ye){_line.start.fromBufferAttribute(ae,de),_line.end.fromBufferAttribute(le,de),_line.start.applyMatrix4(oe),_line.end.applyMatrix4(oe);const ve=new Vector3,_e=new Vector3;_ray$1.distanceSqToSegment(_line.start,_line.end,_e,ve),Z.push({point:_e,pointOnLine:ve,distance:_ray$1.origin.distanceTo(_e),object:K,face:null,faceIndex:de,uv:null,[UV1]:null})}}}class LineSegments2 extends Mesh{constructor(_=new LineSegmentsGeometry,Z=new LineMaterial({color:Math.random()*16777215})){super(_,Z),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const _=this.geometry,Z=_.attributes.instanceStart,te=_.attributes.instanceEnd,ne=new Float32Array(2*Z.count);for(let oe=0,se=0,ae=Z.count;oe<ae;oe++,se+=2)_start.fromBufferAttribute(Z,oe),_end.fromBufferAttribute(te,oe),ne[se]=se===0?0:ne[se-1],ne[se+1]=ne[se]+_start.distanceTo(_end);const ie=new InstancedInterleavedBuffer(ne,2,1);return _.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute(ie,1,0)),_.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(ie,1,1)),this}raycast(_,Z){const te=this.material.worldUnits,ne=_.camera;ne===null&&!te&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const ie=_.params.Line2!==void 0&&_.params.Line2.threshold||0;_ray$1=_.ray;const oe=this.matrixWorld,se=this.geometry,ae=this.material;_lineWidth=ae.linewidth+ie,se.boundingSphere===null&&se.computeBoundingSphere(),_sphere$1.copy(se.boundingSphere).applyMatrix4(oe);let le;if(te)le=_lineWidth*.5;else{const fe=Math.max(ne.near,_sphere$1.distanceToPoint(_ray$1.origin));le=getWorldSpaceHalfWidth(ne,fe,ae.resolution)}if(_sphere$1.radius+=le,_ray$1.intersectsSphere(_sphere$1)===!1)return;se.boundingBox===null&&se.computeBoundingBox(),_box.copy(se.boundingBox).applyMatrix4(oe);let ce;if(te)ce=_lineWidth*.5;else{const fe=Math.max(ne.near,_box.distanceToPoint(_ray$1.origin));ce=getWorldSpaceHalfWidth(ne,fe,ae.resolution)}_box.expandByScalar(ce),_ray$1.intersectsBox(_box)!==!1&&(te?raycastWorldUnits(this,Z):raycastScreenSpace(this,ne,Z))}onBeforeRender(_){const Z=this.material.uniforms;Z&&Z.resolution&&(_.getViewport(_viewport),this.material.uniforms.resolution.value.set(_viewport.z,_viewport.w))}}class Line2 extends LineSegments2{constructor(_=new LineGeometry,Z=new LineMaterial({color:Math.random()*16777215})){super(_,Z),this.isLine2=!0,this.type="Line2"}}const isIterable$1=K=>Symbol.iterator in K,hasIterableEntries$1=K=>"entries"in K,compareEntries$1=(K,_)=>{const Z=K instanceof Map?K:new Map(K.entries()),te=_ instanceof Map?_:new Map(_.entries());if(Z.size!==te.size)return!1;for(const[ne,ie]of Z)if(!Object.is(ie,te.get(ne)))return!1;return!0},compareIterables$1=(K,_)=>{const Z=K[Symbol.iterator](),te=_[Symbol.iterator]();let ne=Z.next(),ie=te.next();for(;!ne.done&&!ie.done;){if(!Object.is(ne.value,ie.value))return!1;ne=Z.next(),ie=te.next()}return!!ne.done&&!!ie.done};function shallow$9(K,_){return Object.is(K,_)?!0:typeof K!="object"||K===null||typeof _!="object"||_===null||Object.getPrototypeOf(K)!==Object.getPrototypeOf(_)?!1:isIterable$1(K)&&isIterable$1(_)?hasIterableEntries$1(K)&&hasIterableEntries$1(_)?compareEntries$1(K,_):compareIterables$1(K,_):compareEntries$1({entries:()=>Object.entries(K)},{entries:()=>Object.entries(_)})}const context$7=reactExports.createContext([]);function Select$2({box:K,multiple:_,children:Z,onChange:te,onChangePointerUp:ne,border:ie="1px solid #55aaff",backgroundColor:oe="rgba(75, 160, 255, 0.1)",filter:se=le=>le,...ae}){const[le,ce]=reactExports.useState(!1),{setEvents:fe,camera:de,raycaster:pe,gl:he,controls:ge,size:me,get:Ae}=useThree(),[ye,ve]=reactExports.useState(!1),[_e,Te]=reactExports.useReducer((Pe,{object:Ie,shift:$e})=>Ie===void 0?[]:Array.isArray(Ie)?Ie:$e?Pe.includes(Ie)?Pe.filter(Ue=>Ue!==Ie):[Ie,...Pe]:Pe[0]===Ie?[]:[Ie],[]);reactExports.useEffect(()=>{le?te==null||te(_e):ne==null||ne(_e)},[_e,le]);const be=reactExports.useCallback(Pe=>{Pe.stopPropagation(),Te({object:se([Pe.object])[0],shift:_&&Pe.shiftKey})},[]),Re=reactExports.useCallback(Pe=>!ye&&Te({}),[ye]),we=reactExports.useRef(null);return reactExports.useEffect(()=>{if(!K||!_)return;const Pe=new SelectionBox(de,we.current),Ie=document.createElement("div");Ie.style.pointerEvents="none",Ie.style.border=ie,Ie.style.backgroundColor=oe,Ie.style.position="fixed";const $e=new Vector2,Ue=new Vector2,ke=new Vector2,Ge=Ae().events.enabled,He=ge==null?void 0:ge.enabled;let ze=!1;function Ke(Qe,Ze){const{offsetX:it,offsetY:nt}=Qe,{width:Tt,height:St}=me;Ze.set(it/Tt*2-1,-(nt/St)*2+1)}function tt(Qe){var Ze;ge&&(ge.enabled=!1),fe({enabled:!1}),ce(ze=!0),(Ze=he.domElement.parentElement)==null||Ze.appendChild(Ie),Ie.style.left=`${Qe.clientX}px`,Ie.style.top=`${Qe.clientY}px`,Ie.style.width="0px",Ie.style.height="0px",$e.x=Qe.clientX,$e.y=Qe.clientY}function Je(Qe){ke.x=Math.max($e.x,Qe.clientX),ke.y=Math.max($e.y,Qe.clientY),Ue.x=Math.min($e.x,Qe.clientX),Ue.y=Math.min($e.y,Qe.clientY),Ie.style.left=`${Ue.x}px`,Ie.style.top=`${Ue.y}px`,Ie.style.width=`${ke.x-Ue.x}px`,Ie.style.height=`${ke.y-Ue.y}px`}function ot(){if(ze){var Qe;ge&&(ge.enabled=He),fe({enabled:Ge}),ce(ze=!1),(Qe=Ie.parentElement)==null||Qe.removeChild(Ie)}}function Fe(Qe){Qe.shiftKey&&(tt(Qe),Ke(Qe,Pe.startPoint))}let ct=[];function ht(Qe){if(ze){Je(Qe),Ke(Qe,Pe.endPoint);const Ze=Pe.select().sort(it=>it.uuid).filter(it=>it.isMesh);shallow$9(Ze,ct)||(ct=Ze,Te({object:se(Ze)}))}}function lt(Qe){ze&&ot()}return document.addEventListener("pointerdown",Fe,{passive:!0}),document.addEventListener("pointermove",ht,{passive:!0,capture:!0}),document.addEventListener("pointerup",lt,{passive:!0}),()=>{document.removeEventListener("pointerdown",Fe),document.removeEventListener("pointermove",ht,!0),document.removeEventListener("pointerup",lt)}},[me.width,me.height,pe,de,ge,he]),reactExports.createElement("group",_extends$3({ref:we,onClick:be,onPointerOver:()=>ve(!0),onPointerOut:()=>ve(!1),onPointerMissed:Re},ae),reactExports.createElement(context$7.Provider,{value:_e},Z))}function useSelect(){return reactExports.useContext(context$7)}const Billboard=reactExports.forwardRef(function({children:_,follow:Z=!0,lockX:te=!1,lockY:ne=!1,lockZ:ie=!1,...oe},se){const ae=reactExports.useRef(null),le=reactExports.useRef(null),ce=new Quaternion;return useFrame(({camera:fe})=>{if(!Z||!le.current)return;const de=ae.current.rotation.clone();le.current.updateMatrix(),le.current.updateWorldMatrix(!1,!1),le.current.getWorldQuaternion(ce),fe.getWorldQuaternion(ae.current.quaternion).premultiply(ce.invert()),te&&(ae.current.rotation.x=de.x),ne&&(ae.current.rotation.y=de.y),ie&&(ae.current.rotation.z=de.z)}),reactExports.useImperativeHandle(se,()=>le.current,[]),reactExports.createElement("group",_extends$3({ref:le},oe),reactExports.createElement("group",{ref:ae},_))}),ScreenSpace=reactExports.forwardRef(({children:K,depth:_=-1,...Z},te)=>{const ne=reactExports.useRef(null);return reactExports.useImperativeHandle(te,()=>ne.current,[]),useFrame(({camera:ie})=>{ne.current.quaternion.copy(ie.quaternion),ne.current.position.copy(ie.position)}),reactExports.createElement("group",_extends$3({ref:ne},Z),reactExports.createElement("group",{"position-z":-_},K))}),tV0=new Vector3,tV1=new Vector3,tV2=new Vector3,getPoint2=(K,_,Z)=>{const te=Z.width/2,ne=Z.height/2;_.updateMatrixWorld(!1);const ie=K.project(_);return ie.x=ie.x*te+te,ie.y=-(ie.y*ne)+ne,ie},getPoint3=(K,_,Z,te=1)=>{const ne=tV0.set(K.x/Z.width*2-1,-(K.y/Z.height)*2+1,te);return ne.unproject(_),ne},calculateScaleFactor=(K,_,Z,te)=>{const ne=getPoint2(tV2.copy(K),Z,te);let ie=0;for(let oe=0;oe<2;++oe){const se=tV1.copy(ne).setComponent(oe,ne.getComponent(oe)+_),ae=getPoint3(se,Z,te,se.z);ie=Math.max(ie,K.distanceTo(ae))}return ie},Line$1=reactExports.forwardRef(function({points:_,color:Z=16777215,vertexColors:te,linewidth:ne,lineWidth:ie,segments:oe,dashed:se,...ae},le){var ce,fe;const de=useThree(Ae=>Ae.size),pe=reactExports.useMemo(()=>oe?new LineSegments2:new Line2,[oe]),[he]=reactExports.useState(()=>new LineMaterial),ge=(te==null||(ce=te[0])==null?void 0:ce.length)===4?4:3,me=reactExports.useMemo(()=>{const Ae=oe?new LineSegmentsGeometry:new LineGeometry,ye=_.map(ve=>{const _e=Array.isArray(ve);return ve instanceof Vector3||ve instanceof Vector4?[ve.x,ve.y,ve.z]:ve instanceof Vector2?[ve.x,ve.y,0]:_e&&ve.length===3?[ve[0],ve[1],ve[2]]:_e&&ve.length===2?[ve[0],ve[1],0]:ve});if(Ae.setPositions(ye.flat()),te){Z=16777215;const ve=te.map(_e=>_e instanceof Color$1?_e.toArray():_e);Ae.setColors(ve.flat(),ge)}return Ae},[_,oe,te,ge]);return reactExports.useLayoutEffect(()=>{pe.computeLineDistances()},[_,pe]),reactExports.useLayoutEffect(()=>{se?he.defines.USE_DASH="":delete he.defines.USE_DASH,he.needsUpdate=!0},[se,he]),reactExports.useEffect(()=>()=>{me.dispose(),he.dispose()},[me]),reactExports.createElement("primitive",_extends$3({object:pe,ref:le},ae),reactExports.createElement("primitive",{object:me,attach:"geometry"}),reactExports.createElement("primitive",_extends$3({object:he,attach:"material",color:Z,vertexColors:!!te,resolution:[de.width,de.height],linewidth:(fe=ne??ie)!==null&&fe!==void 0?fe:1,dashed:se,transparent:ge===4},ae)))}),v$5=new Vector3,QuadraticBezierLine=reactExports.forwardRef(function({start:_=[0,0,0],end:Z=[0,0,0],mid:te,segments:ne=20,...ie},oe){const se=reactExports.useRef(null);reactExports.useImperativeHandle(oe,()=>se.current);const[ae]=reactExports.useState(()=>new QuadraticBezierCurve3(void 0,void 0,void 0)),le=reactExports.useCallback((fe,de,pe,he=20)=>(fe instanceof Vector3?ae.v0.copy(fe):ae.v0.set(...fe),de instanceof Vector3?ae.v2.copy(de):ae.v2.set(...de),pe instanceof Vector3?ae.v1.copy(pe):Array.isArray(pe)?ae.v1.set(...pe):ae.v1.copy(ae.v0.clone().add(ae.v2.clone().sub(ae.v0)).add(v$5.set(0,ae.v0.y-ae.v2.y,0))),ae.getPoints(he)),[]);reactExports.useLayoutEffect(()=>{se.current.setPoints=(fe,de,pe)=>{const he=le(fe,de,pe);se.current.geometry&&se.current.geometry.setPositions(he.map(ge=>ge.toArray()).flat())}},[]);const ce=reactExports.useMemo(()=>le(_,Z,te,ne),[_,Z,te,ne]);return reactExports.createElement(Line$1,_extends$3({ref:se,points:ce},ie))}),CubicBezierLine=reactExports.forwardRef(function({start:_,end:Z,midA:te,midB:ne,segments:ie=20,...oe},se){const ae=reactExports.useMemo(()=>{const le=_ instanceof Vector3?_:new Vector3(..._),ce=Z instanceof Vector3?Z:new Vector3(...Z),fe=te instanceof Vector3?te:new Vector3(...te),de=ne instanceof Vector3?ne:new Vector3(...ne);return new CubicBezierCurve3(le,fe,de,ce).getPoints(ie)},[_,Z,te,ne,ie]);return reactExports.createElement(Line$1,_extends$3({ref:se,points:ae},oe))}),CatmullRomLine=reactExports.forwardRef(function({points:_,closed:Z=!1,curveType:te="centripetal",tension:ne=.5,segments:ie=20,vertexColors:oe,...se},ae){const le=reactExports.useMemo(()=>{const de=_.map(pe=>pe instanceof Vector3?pe:new Vector3(...pe));return new CatmullRomCurve3(de,Z,te,ne)},[_,Z,te,ne]),ce=reactExports.useMemo(()=>le.getPoints(ie),[le,ie]),fe=reactExports.useMemo(()=>{if(!oe||oe.length<2)return;if(oe.length===ie+1)return oe;const de=oe.map(ge=>ge instanceof Color$1?ge:new Color$1(...ge));Z&&de.push(de[0].clone());const pe=[de[0]],he=ie/(de.length-1);for(let ge=1;ge<ie;ge++){const me=ge%he/he,Ae=Math.floor(ge/he);pe.push(de[Ae].clone().lerp(de[Ae+1],me))}return pe.push(de[de.length-1]),pe},[oe,ie]);return reactExports.createElement(Line$1,_extends$3({ref:ae,points:ce,vertexColors:fe},se))}),PositionalAudio=reactExports.forwardRef(({url:K,distance:_=1,loop:Z=!0,autoplay:te,...ne},ie)=>{const oe=reactExports.useRef(null);reactExports.useImperativeHandle(ie,()=>oe.current,[]);const se=useThree(({camera:ce})=>ce),[ae]=reactExports.useState(()=>new AudioListener),le=useLoader(AudioLoader,K);return reactExports.useEffect(()=>{const ce=oe.current;ce&&(ce.setBuffer(le),ce.setRefDistance(_),ce.setLoop(Z),te&&!ce.isPlaying&&ce.play())},[le,se,_,Z]),reactExports.useEffect(()=>{const ce=oe.current;return se.add(ae),()=>{se.remove(ae),ce&&(ce.isPlaying&&ce.stop(),ce.source&&ce.source._connected&&ce.disconnect())}},[]),reactExports.createElement("positionalAudio",_extends$3({ref:oe,args:[ae]},ne))});function workerBootstrap(){var K=Object.create(null);function _(ne,ie){var oe=ne.id,se=ne.name,ae=ne.dependencies;ae===void 0&&(ae=[]);var le=ne.init;le===void 0&&(le=function(){});var ce=ne.getTransferables;if(ce===void 0&&(ce=null),!K[oe])try{ae=ae.map(function(de){return de&&de.isWorkerModule&&(_(de,function(pe){if(pe instanceof Error)throw pe}),de=K[de.id].value),de}),le=te("<"+se+">.init",le),ce&&(ce=te("<"+se+">.getTransferables",ce));var fe=null;typeof le=="function"?fe=le.apply(void 0,ae):console.error("worker module init function failed to rehydrate"),K[oe]={id:oe,value:fe,getTransferables:ce},ie(fe)}catch(de){de&&de.noLog||console.error(de),ie(de)}}function Z(ne,ie){var oe,se=ne.id,ae=ne.args;(!K[se]||typeof K[se].value!="function")&&ie(new Error("Worker module "+se+": not found or its 'init' did not return a function"));try{var le=(oe=K[se]).value.apply(oe,ae);le&&typeof le.then=="function"?le.then(ce,function(fe){return ie(fe instanceof Error?fe:new Error(""+fe))}):ce(le)}catch(fe){ie(fe)}function ce(fe){try{var de=K[se].getTransferables&&K[se].getTransferables(fe);(!de||!Array.isArray(de)||!de.length)&&(de=void 0),ie(fe,de)}catch(pe){console.error(pe),ie(pe)}}}function te(ne,ie){var oe=void 0;self.troikaDefine=function(ae){return oe=ae};var se=URL.createObjectURL(new Blob(["/** "+ne.replace(/\*/g,"")+` **/

troikaDefine(
`+ie+`
)`],{type:"application/javascript"}));try{importScripts(se)}catch(ae){console.error(ae)}return URL.revokeObjectURL(se),delete self.troikaDefine,oe}self.addEventListener("message",function(ne){var ie=ne.data,oe=ie.messageId,se=ie.action,ae=ie.data;try{se==="registerModule"&&_(ae,function(le){le instanceof Error?postMessage({messageId:oe,success:!1,error:le.message}):postMessage({messageId:oe,success:!0,result:{isCallable:typeof le=="function"}})}),se==="callModule"&&Z(ae,function(le,ce){le instanceof Error?postMessage({messageId:oe,success:!1,error:le.message}):postMessage({messageId:oe,success:!0,result:le},ce||void 0)})}catch(le){postMessage({messageId:oe,success:!1,error:le.stack})}})}function defineMainThreadModule(K){var _=function(){for(var Z=[],te=arguments.length;te--;)Z[te]=arguments[te];return _._getInitResult().then(function(ne){if(typeof ne=="function")return ne.apply(void 0,Z);throw new Error("Worker module function was called but `init` did not return a callable function")})};return _._getInitResult=function(){var Z=K.dependencies,te=K.init;Z=Array.isArray(Z)?Z.map(function(ie){return ie&&(ie=ie.onMainThread||ie,ie._getInitResult&&(ie=ie._getInitResult())),ie}):[];var ne=Promise.all(Z).then(function(ie){return te.apply(null,ie)});return _._getInitResult=function(){return ne},ne},_}var supportsWorkers=function(){var K=!1;if(typeof window<"u"&&typeof window.document<"u")try{var _=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));_.terminate(),K=!0}catch(Z){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+Z.message+"]")}return supportsWorkers=function(){return K},K},_workerModuleId=0,_messageId=0,_allowInitAsString=!1,workers=Object.create(null),registeredModules=Object.create(null),openRequests=Object.create(null);function defineWorkerModule(K){if((!K||typeof K.init!="function")&&!_allowInitAsString)throw new Error("requires `options.init` function");var _=K.dependencies,Z=K.init,te=K.getTransferables,ne=K.workerId,ie=defineMainThreadModule(K);ne==null&&(ne="#default");var oe="workerModule"+ ++_workerModuleId,se=K.name||oe,ae=null;_=_&&_.map(function(ce){return typeof ce=="function"&&!ce.workerModuleData&&(_allowInitAsString=!0,ce=defineWorkerModule({workerId:ne,name:"<"+se+"> function dependency: "+ce.name,init:`function(){return (
`+stringifyFunction(ce)+`
)}`}),_allowInitAsString=!1),ce&&ce.workerModuleData&&(ce=ce.workerModuleData),ce});function le(){for(var ce=[],fe=arguments.length;fe--;)ce[fe]=arguments[fe];if(!supportsWorkers())return ie.apply(void 0,ce);if(!ae){ae=callWorker(ne,"registerModule",le.workerModuleData);var de=function(){ae=null,registeredModules[ne].delete(de)};(registeredModules[ne]||(registeredModules[ne]=new Set)).add(de)}return ae.then(function(pe){var he=pe.isCallable;if(he)return callWorker(ne,"callModule",{id:oe,args:ce});throw new Error("Worker module function was called but `init` did not return a callable function")})}return le.workerModuleData={isWorkerModule:!0,id:oe,name:se,dependencies:_,init:stringifyFunction(Z),getTransferables:te&&stringifyFunction(te)},le.onMainThread=ie,le}function terminateWorker(K){registeredModules[K]&&registeredModules[K].forEach(function(_){_()}),workers[K]&&(workers[K].terminate(),delete workers[K])}function stringifyFunction(K){var _=K.toString();return!/^function/.test(_)&&/^\w+\s*\(/.test(_)&&(_="function "+_),_}function getWorker(K){var _=workers[K];if(!_){var Z=stringifyFunction(workerBootstrap);_=workers[K]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+K.replace(/\*/g,"")+` **/

;(`+Z+")()"],{type:"application/javascript"}))),_.onmessage=function(te){var ne=te.data,ie=ne.messageId,oe=openRequests[ie];if(!oe)throw new Error("WorkerModule response with empty or unknown messageId");delete openRequests[ie],oe(ne)}}return _}function callWorker(K,_,Z){return new Promise(function(te,ne){var ie=++_messageId;openRequests[ie]=function(oe){oe.success?te(oe.result):ne(new Error("Error in worker "+_+" call: "+oe.error))},getWorker(K).postMessage({messageId:ie,action:_,data:Z})})}function SDFGenerator(){var K=function(_){function Z(Je,ot,Fe,ct,ht,lt,Qe,Ze){var it=1-Qe;Ze.x=it*it*Je+2*it*Qe*Fe+Qe*Qe*ht,Ze.y=it*it*ot+2*it*Qe*ct+Qe*Qe*lt}function te(Je,ot,Fe,ct,ht,lt,Qe,Ze,it,nt){var Tt=1-it;nt.x=Tt*Tt*Tt*Je+3*Tt*Tt*it*Fe+3*Tt*it*it*ht+it*it*it*Qe,nt.y=Tt*Tt*Tt*ot+3*Tt*Tt*it*ct+3*Tt*it*it*lt+it*it*it*Ze}function ne(Je,ot){for(var Fe=/([MLQCZ])([^MLQCZ]*)/g,ct,ht,lt,Qe,Ze;ct=Fe.exec(Je);){var it=ct[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(nt){return parseFloat(nt)});switch(ct[1]){case"M":Qe=ht=it[0],Ze=lt=it[1];break;case"L":(it[0]!==Qe||it[1]!==Ze)&&ot("L",Qe,Ze,Qe=it[0],Ze=it[1]);break;case"Q":{ot("Q",Qe,Ze,Qe=it[2],Ze=it[3],it[0],it[1]);break}case"C":{ot("C",Qe,Ze,Qe=it[4],Ze=it[5],it[0],it[1],it[2],it[3]);break}case"Z":(Qe!==ht||Ze!==lt)&&ot("L",Qe,Ze,ht,lt);break}}}function ie(Je,ot,Fe){Fe===void 0&&(Fe=16);var ct={x:0,y:0};ne(Je,function(ht,lt,Qe,Ze,it,nt,Tt,St,Et){switch(ht){case"L":ot(lt,Qe,Ze,it);break;case"Q":{for(var Nt=lt,zt=Qe,yt=1;yt<Fe;yt++)Z(lt,Qe,nt,Tt,Ze,it,yt/(Fe-1),ct),ot(Nt,zt,ct.x,ct.y),Nt=ct.x,zt=ct.y;break}case"C":{for(var Ut=lt,bt=Qe,Ot=1;Ot<Fe;Ot++)te(lt,Qe,nt,Tt,St,Et,Ze,it,Ot/(Fe-1),ct),ot(Ut,bt,ct.x,ct.y),Ut=ct.x,bt=ct.y;break}}})}var oe="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",se="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",ae=new WeakMap,le={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function ce(Je,ot){var Fe=Je.getContext?Je.getContext("webgl",le):Je,ct=ae.get(Fe);if(!ct){let Tt=function(Ut){var bt=lt[Ut];if(!bt&&(bt=lt[Ut]=Fe.getExtension(Ut),!bt))throw new Error(Ut+" not supported");return bt},St=function(Ut,bt){var Ot=Fe.createShader(bt);return Fe.shaderSource(Ot,Ut),Fe.compileShader(Ot),Ot},Et=function(Ut,bt,Ot,Mt){if(!Qe[Ut]){var _t={},pt={},ft=Fe.createProgram();Fe.attachShader(ft,St(bt,Fe.VERTEX_SHADER)),Fe.attachShader(ft,St(Ot,Fe.FRAGMENT_SHADER)),Fe.linkProgram(ft),Qe[Ut]={program:ft,transaction:function(vt){Fe.useProgram(ft),vt({setUniform:function(Lt,Vt){for(var Le=[],De=arguments.length-2;De-- >0;)Le[De]=arguments[De+2];var Be=pt[Vt]||(pt[Vt]=Fe.getUniformLocation(ft,Vt));Fe["uniform"+Lt].apply(Fe,[Be].concat(Le))},setAttribute:function(Lt,Vt,Le,De,Be){var rt=_t[Lt];rt||(rt=_t[Lt]={buf:Fe.createBuffer(),loc:Fe.getAttribLocation(ft,Lt),data:null}),Fe.bindBuffer(Fe.ARRAY_BUFFER,rt.buf),Fe.vertexAttribPointer(rt.loc,Vt,Fe.FLOAT,!1,0,0),Fe.enableVertexAttribArray(rt.loc),ht?Fe.vertexAttribDivisor(rt.loc,De):Tt("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(rt.loc,De),Be!==rt.data&&(Fe.bufferData(Fe.ARRAY_BUFFER,Be,Le),rt.data=Be)}})}}}Qe[Ut].transaction(Mt)},Nt=function(Ut,bt){it++;try{Fe.activeTexture(Fe.TEXTURE0+it);var Ot=Ze[Ut];Ot||(Ot=Ze[Ut]=Fe.createTexture(),Fe.bindTexture(Fe.TEXTURE_2D,Ot),Fe.texParameteri(Fe.TEXTURE_2D,Fe.TEXTURE_MIN_FILTER,Fe.NEAREST),Fe.texParameteri(Fe.TEXTURE_2D,Fe.TEXTURE_MAG_FILTER,Fe.NEAREST)),Fe.bindTexture(Fe.TEXTURE_2D,Ot),bt(Ot,it)}finally{it--}},zt=function(Ut,bt,Ot){var Mt=Fe.createFramebuffer();nt.push(Mt),Fe.bindFramebuffer(Fe.FRAMEBUFFER,Mt),Fe.activeTexture(Fe.TEXTURE0+bt),Fe.bindTexture(Fe.TEXTURE_2D,Ut),Fe.framebufferTexture2D(Fe.FRAMEBUFFER,Fe.COLOR_ATTACHMENT0,Fe.TEXTURE_2D,Ut,0);try{Ot(Mt)}finally{Fe.deleteFramebuffer(Mt),Fe.bindFramebuffer(Fe.FRAMEBUFFER,nt[--nt.length-1]||null)}},yt=function(){lt={},Qe={},Ze={},it=-1,nt.length=0};var ht=typeof WebGL2RenderingContext<"u"&&Fe instanceof WebGL2RenderingContext,lt={},Qe={},Ze={},it=-1,nt=[];Fe.canvas.addEventListener("webglcontextlost",function(Ut){yt(),Ut.preventDefault()},!1),ae.set(Fe,ct={gl:Fe,isWebGL2:ht,getExtension:Tt,withProgram:Et,withTexture:Nt,withTextureFramebuffer:zt,handleContextLoss:yt})}ot(ct)}function fe(Je,ot,Fe,ct,ht,lt,Qe,Ze){Qe===void 0&&(Qe=15),Ze===void 0&&(Ze=null),ce(Je,function(it){var nt=it.gl,Tt=it.withProgram,St=it.withTexture;St("copy",function(Et,Nt){nt.texImage2D(nt.TEXTURE_2D,0,nt.RGBA,ht,lt,0,nt.RGBA,nt.UNSIGNED_BYTE,ot),Tt("copy",oe,se,function(zt){var yt=zt.setUniform,Ut=zt.setAttribute;Ut("aUV",2,nt.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),yt("1i","image",Nt),nt.bindFramebuffer(nt.FRAMEBUFFER,Ze||null),nt.disable(nt.BLEND),nt.colorMask(Qe&8,Qe&4,Qe&2,Qe&1),nt.viewport(Fe,ct,ht,lt),nt.scissor(Fe,ct,ht,lt),nt.drawArrays(nt.TRIANGLES,0,3)})})})}function de(Je,ot,Fe){var ct=Je.width,ht=Je.height;ce(Je,function(lt){var Qe=lt.gl,Ze=new Uint8Array(ct*ht*4);Qe.readPixels(0,0,ct,ht,Qe.RGBA,Qe.UNSIGNED_BYTE,Ze),Je.width=ot,Je.height=Fe,fe(Qe,Ze,0,0,ct,ht)})}var pe=Object.freeze({__proto__:null,withWebGLContext:ce,renderImageData:fe,resizeWebGLCanvasWithoutClearing:de});function he(Je,ot,Fe,ct,ht,lt){lt===void 0&&(lt=1);var Qe=new Uint8Array(Je*ot),Ze=ct[2]-ct[0],it=ct[3]-ct[1],nt=[];ie(Fe,function(Ut,bt,Ot,Mt){nt.push({x1:Ut,y1:bt,x2:Ot,y2:Mt,minX:Math.min(Ut,Ot),minY:Math.min(bt,Mt),maxX:Math.max(Ut,Ot),maxY:Math.max(bt,Mt)})}),nt.sort(function(Ut,bt){return Ut.maxX-bt.maxX});for(var Tt=0;Tt<Je;Tt++)for(var St=0;St<ot;St++){var Et=zt(ct[0]+Ze*(Tt+.5)/Je,ct[1]+it*(St+.5)/ot),Nt=Math.pow(1-Math.abs(Et)/ht,lt)/2;Et<0&&(Nt=1-Nt),Nt=Math.max(0,Math.min(255,Math.round(Nt*255))),Qe[St*Je+Tt]=Nt}return Qe;function zt(Ut,bt){for(var Ot=1/0,Mt=1/0,_t=nt.length;_t--;){var pt=nt[_t];if(pt.maxX+Mt<=Ut)break;if(Ut+Mt>pt.minX&&bt-Mt<pt.maxY&&bt+Mt>pt.minY){var ft=Ae(Ut,bt,pt.x1,pt.y1,pt.x2,pt.y2);ft<Ot&&(Ot=ft,Mt=Math.sqrt(Ot))}}return yt(Ut,bt)&&(Mt=-Mt),Mt}function yt(Ut,bt){for(var Ot=0,Mt=nt.length;Mt--;){var _t=nt[Mt];if(_t.maxX<=Ut)break;var pt=_t.y1>bt!=_t.y2>bt&&Ut<(_t.x2-_t.x1)*(bt-_t.y1)/(_t.y2-_t.y1)+_t.x1;pt&&(Ot+=_t.y1<_t.y2?1:-1)}return Ot!==0}}function ge(Je,ot,Fe,ct,ht,lt,Qe,Ze,it,nt){lt===void 0&&(lt=1),Ze===void 0&&(Ze=0),it===void 0&&(it=0),nt===void 0&&(nt=0),me(Je,ot,Fe,ct,ht,lt,Qe,null,Ze,it,nt)}function me(Je,ot,Fe,ct,ht,lt,Qe,Ze,it,nt,Tt){lt===void 0&&(lt=1),it===void 0&&(it=0),nt===void 0&&(nt=0),Tt===void 0&&(Tt=0);for(var St=he(Je,ot,Fe,ct,ht,lt),Et=new Uint8Array(St.length*4),Nt=0;Nt<St.length;Nt++)Et[Nt*4+Tt]=St[Nt];fe(Qe,Et,it,nt,Je,ot,1<<3-Tt,Ze)}function Ae(Je,ot,Fe,ct,ht,lt){var Qe=ht-Fe,Ze=lt-ct,it=Qe*Qe+Ze*Ze,nt=it?Math.max(0,Math.min(1,((Je-Fe)*Qe+(ot-ct)*Ze)/it)):0,Tt=Je-(Fe+nt*Qe),St=ot-(ct+nt*Ze);return Tt*Tt+St*St}var ye=Object.freeze({__proto__:null,generate:he,generateIntoCanvas:ge,generateIntoFramebuffer:me}),ve="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",_e="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",Te="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",be=new Float32Array([0,0,2,0,0,2]),Re=null,we=!1,Pe={},Ie=new WeakMap;function $e(Je){if(!we&&!He(Je))throw new Error("WebGL generation not supported")}function Ue(Je,ot,Fe,ct,ht,lt,Qe){if(lt===void 0&&(lt=1),Qe===void 0&&(Qe=null),!Qe&&(Qe=Re,!Qe)){var Ze=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Ze)throw new Error("OffscreenCanvas or DOM canvas not supported");Qe=Re=Ze.getContext("webgl",{depth:!1})}$e(Qe);var it=new Uint8Array(Je*ot*4);ce(Qe,function(Et){var Nt=Et.gl,zt=Et.withTexture,yt=Et.withTextureFramebuffer;zt("readable",function(Ut,bt){Nt.texImage2D(Nt.TEXTURE_2D,0,Nt.RGBA,Je,ot,0,Nt.RGBA,Nt.UNSIGNED_BYTE,null),yt(Ut,bt,function(Ot){Ge(Je,ot,Fe,ct,ht,lt,Nt,Ot,0,0,0),Nt.readPixels(0,0,Je,ot,Nt.RGBA,Nt.UNSIGNED_BYTE,it)})})});for(var nt=new Uint8Array(Je*ot),Tt=0,St=0;Tt<it.length;Tt+=4)nt[St++]=it[Tt];return nt}function ke(Je,ot,Fe,ct,ht,lt,Qe,Ze,it,nt){lt===void 0&&(lt=1),Ze===void 0&&(Ze=0),it===void 0&&(it=0),nt===void 0&&(nt=0),Ge(Je,ot,Fe,ct,ht,lt,Qe,null,Ze,it,nt)}function Ge(Je,ot,Fe,ct,ht,lt,Qe,Ze,it,nt,Tt){lt===void 0&&(lt=1),it===void 0&&(it=0),nt===void 0&&(nt=0),Tt===void 0&&(Tt=0),$e(Qe);var St=[];ie(Fe,function(Et,Nt,zt,yt){St.push(Et,Nt,zt,yt)}),St=new Float32Array(St),ce(Qe,function(Et){var Nt=Et.gl,zt=Et.isWebGL2,yt=Et.getExtension,Ut=Et.withProgram,bt=Et.withTexture,Ot=Et.withTextureFramebuffer,Mt=Et.handleContextLoss;if(bt("rawDistances",function(_t,pt){(Je!==_t._lastWidth||ot!==_t._lastHeight)&&Nt.texImage2D(Nt.TEXTURE_2D,0,Nt.RGBA,_t._lastWidth=Je,_t._lastHeight=ot,0,Nt.RGBA,Nt.UNSIGNED_BYTE,null),Ut("main",ve,_e,function(ft){var st=ft.setAttribute,vt=ft.setUniform,Pt=!zt&&yt("ANGLE_instanced_arrays"),Lt=!zt&&yt("EXT_blend_minmax");st("aUV",2,Nt.STATIC_DRAW,0,be),st("aLineSegment",4,Nt.DYNAMIC_DRAW,1,St),vt.apply(void 0,["4f","uGlyphBounds"].concat(ct)),vt("1f","uMaxDistance",ht),vt("1f","uExponent",lt),Ot(_t,pt,function(Vt){Nt.enable(Nt.BLEND),Nt.colorMask(!0,!0,!0,!0),Nt.viewport(0,0,Je,ot),Nt.scissor(0,0,Je,ot),Nt.blendFunc(Nt.ONE,Nt.ONE),Nt.blendEquationSeparate(Nt.FUNC_ADD,zt?Nt.MAX:Lt.MAX_EXT),Nt.clear(Nt.COLOR_BUFFER_BIT),zt?Nt.drawArraysInstanced(Nt.TRIANGLES,0,3,St.length/4):Pt.drawArraysInstancedANGLE(Nt.TRIANGLES,0,3,St.length/4)})}),Ut("post",oe,Te,function(ft){ft.setAttribute("aUV",2,Nt.STATIC_DRAW,0,be),ft.setUniform("1i","tex",pt),Nt.bindFramebuffer(Nt.FRAMEBUFFER,Ze),Nt.disable(Nt.BLEND),Nt.colorMask(Tt===0,Tt===1,Tt===2,Tt===3),Nt.viewport(it,nt,Je,ot),Nt.scissor(it,nt,Je,ot),Nt.drawArrays(Nt.TRIANGLES,0,3)})}),Nt.isContextLost())throw Mt(),new Error("webgl context lost")})}function He(Je){var ot=!Je||Je===Re?Pe:Je.canvas||Je,Fe=Ie.get(ot);if(Fe===void 0){we=!0;var ct=null;try{var ht=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],lt=Ue(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,Je);Fe=lt&&ht.length===lt.length&&lt.every(function(Qe,Ze){return Qe===ht[Ze]}),Fe||(ct="bad trial run results",console.info(ht,lt))}catch(Qe){Fe=!1,ct=Qe.message}ct&&console.warn("WebGL SDF generation not supported:",ct),we=!1,Ie.set(ot,Fe)}return Fe}var ze=Object.freeze({__proto__:null,generate:Ue,generateIntoCanvas:ke,generateIntoFramebuffer:Ge,isSupported:He});function Ke(Je,ot,Fe,ct,ht,lt){ht===void 0&&(ht=Math.max(ct[2]-ct[0],ct[3]-ct[1])/2),lt===void 0&&(lt=1);try{return Ue.apply(ze,arguments)}catch(Qe){return console.info("WebGL SDF generation failed, falling back to JS",Qe),he.apply(ye,arguments)}}function tt(Je,ot,Fe,ct,ht,lt,Qe,Ze,it,nt){ht===void 0&&(ht=Math.max(ct[2]-ct[0],ct[3]-ct[1])/2),lt===void 0&&(lt=1),Ze===void 0&&(Ze=0),it===void 0&&(it=0),nt===void 0&&(nt=0);try{return ke.apply(ze,arguments)}catch(Tt){return console.info("WebGL SDF generation failed, falling back to JS",Tt),ge.apply(ye,arguments)}}return _.forEachPathCommand=ne,_.generate=Ke,_.generateIntoCanvas=tt,_.javascript=ye,_.pathToLineSegments=ie,_.webgl=ze,_.webglUtils=pe,Object.defineProperty(_,"__esModule",{value:!0}),_}({});return K}function bidiFactory(){var K=function(_){var Z={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},te={},ne={};te.L=1,ne[1]="L",Object.keys(Z).forEach(function(Mt,_t){te[Mt]=1<<_t+1,ne[te[Mt]]=Mt}),Object.freeze(te);var ie=te.LRI|te.RLI|te.FSI,oe=te.L|te.R|te.AL,se=te.B|te.S|te.WS|te.ON|te.FSI|te.LRI|te.RLI|te.PDI,ae=te.BN|te.RLE|te.LRE|te.RLO|te.LRO|te.PDF,le=te.S|te.WS|te.B|ie|te.PDI|ae,ce=null;function fe(){if(!ce){ce=new Map;var Mt=function(pt){if(Z.hasOwnProperty(pt)){var ft=0;Z[pt].split(",").forEach(function(st){var vt=st.split("+"),Pt=vt[0],Lt=vt[1];Pt=parseInt(Pt,36),Lt=Lt?parseInt(Lt,36):0,ce.set(ft+=Pt,te[pt]);for(var Vt=0;Vt<Lt;Vt++)ce.set(++ft,te[pt])})}};for(var _t in Z)Mt(_t)}}function de(Mt){return fe(),ce.get(Mt.codePointAt(0))||te.L}function pe(Mt){return ne[de(Mt)]}var he={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function ge(Mt,_t){var pt=36,ft=0,st=new Map,vt=_t&&new Map,Pt;return Mt.split(",").forEach(function Lt(Vt){if(Vt.indexOf("+")!==-1)for(var Le=+Vt;Le--;)Lt(Pt);else{Pt=Vt;var De=Vt.split(">"),Be=De[0],rt=De[1];Be=String.fromCodePoint(ft+=parseInt(Be,pt)),rt=String.fromCodePoint(ft+=parseInt(rt,pt)),st.set(Be,rt),_t&&vt.set(rt,Be)}}),{map:st,reverseMap:vt}}var me,Ae,ye;function ve(){if(!me){var Mt=ge(he.pairs,!0),_t=Mt.map,pt=Mt.reverseMap;me=_t,Ae=pt,ye=ge(he.canonical,!1).map}}function _e(Mt){return ve(),me.get(Mt)||null}function Te(Mt){return ve(),Ae.get(Mt)||null}function be(Mt){return ve(),ye.get(Mt)||null}var Re=te.L,we=te.R,Pe=te.EN,Ie=te.ES,$e=te.ET,Ue=te.AN,ke=te.CS,Ge=te.B,He=te.S,ze=te.ON,Ke=te.BN,tt=te.NSM,Je=te.AL,ot=te.LRO,Fe=te.RLO,ct=te.LRE,ht=te.RLE,lt=te.PDF,Qe=te.LRI,Ze=te.RLI,it=te.FSI,nt=te.PDI;function Tt(Mt,_t){for(var pt=125,ft=new Uint32Array(Mt.length),st=0;st<Mt.length;st++)ft[st]=de(Mt[st]);var vt=new Map;function Pt(Ir,Gr){var Kr=ft[Ir];ft[Ir]=Gr,vt.set(Kr,vt.get(Kr)-1),Kr&se&&vt.set(se,vt.get(se)-1),vt.set(Gr,(vt.get(Gr)||0)+1),Gr&se&&vt.set(se,(vt.get(se)||0)+1)}for(var Lt=new Uint8Array(Mt.length),Vt=new Map,Le=[],De=null,Be=0;Be<Mt.length;Be++)De||Le.push(De={start:Be,end:Mt.length-1,level:_t==="rtl"?1:_t==="ltr"?0:wi(Be,!1)}),ft[Be]&Ge&&(De.end=Be,De=null);for(var rt=ht|ct|Fe|ot|ie|nt|lt|Ge,at=function(Ir){return Ir+(Ir&1?1:2)},xt=function(Ir){return Ir+(Ir&1?2:1)},Ct=0;Ct<Le.length;Ct++){De=Le[Ct];var Qt=[{_level:De.level,_override:0,_isolate:0}],qt=void 0,It=0,Gt=0,Jt=0;vt.clear();for(var kt=De.start;kt<=De.end;kt++){var Ht=ft[kt];if(qt=Qt[Qt.length-1],vt.set(Ht,(vt.get(Ht)||0)+1),Ht&se&&vt.set(se,(vt.get(se)||0)+1),Ht&rt)if(Ht&(ht|ct)){Lt[kt]=qt._level;var Yt=(Ht===ht?xt:at)(qt._level);Yt<=pt&&!It&&!Gt?Qt.push({_level:Yt,_override:0,_isolate:0}):It||Gt++}else if(Ht&(Fe|ot)){Lt[kt]=qt._level;var hn=(Ht===Fe?xt:at)(qt._level);hn<=pt&&!It&&!Gt?Qt.push({_level:hn,_override:Ht&Fe?we:Re,_isolate:0}):It||Gt++}else if(Ht&ie){Ht&it&&(Ht=wi(kt+1,!0)===1?Ze:Qe),Lt[kt]=qt._level,qt._override&&Pt(kt,qt._override);var _n=(Ht===Ze?xt:at)(qt._level);_n<=pt&&It===0&&Gt===0?(Jt++,Qt.push({_level:_n,_override:0,_isolate:1,_isolInitIndex:kt})):It++}else if(Ht&nt){if(It>0)It--;else if(Jt>0){for(Gt=0;!Qt[Qt.length-1]._isolate;)Qt.pop();var xn=Qt[Qt.length-1]._isolInitIndex;xn!=null&&(Vt.set(xn,kt),Vt.set(kt,xn)),Qt.pop(),Jt--}qt=Qt[Qt.length-1],Lt[kt]=qt._level,qt._override&&Pt(kt,qt._override)}else Ht&lt?(It===0&&(Gt>0?Gt--:!qt._isolate&&Qt.length>1&&(Qt.pop(),qt=Qt[Qt.length-1])),Lt[kt]=qt._level):Ht&Ge&&(Lt[kt]=De.level);else Lt[kt]=qt._level,qt._override&&Ht!==Ke&&Pt(kt,qt._override)}for(var Ln=[],Vn=null,kn=De.start;kn<=De.end;kn++){var Rn=ft[kn];if(!(Rn&ae)){var or=Lt[kn],pr=Rn&ie,vr=Rn===nt;Vn&&or===Vn._level?(Vn._end=kn,Vn._endsWithIsolInit=pr):Ln.push(Vn={_start:kn,_end:kn,_level:or,_startsWithPDI:vr,_endsWithIsolInit:pr})}}for(var Nr=[],Sr=0;Sr<Ln.length;Sr++){var Pr=Ln[Sr];if(!Pr._startsWithPDI||Pr._startsWithPDI&&!Vt.has(Pr._start)){for(var Dr=[Vn=Pr],Cr=void 0;Vn&&Vn._endsWithIsolInit&&(Cr=Vt.get(Vn._end))!=null;)for(var Kn=Sr+1;Kn<Ln.length;Kn++)if(Ln[Kn]._start===Cr){Dr.push(Vn=Ln[Kn]);break}for(var Er=[],$r=0;$r<Dr.length;$r++)for(var gt=Dr[$r],wt=gt._start;wt<=gt._end;wt++)Er.push(wt);for(var jt=Lt[Er[0]],rn=De.level,un=Er[0]-1;un>=0;un--)if(!(ft[un]&ae)){rn=Lt[un];break}var dn=Er[Er.length-1],Tn=Lt[dn],Sn=De.level;if(!(ft[dn]&ie)){for(var At=dn+1;At<=De.end;At++)if(!(ft[At]&ae)){Sn=Lt[At];break}}Nr.push({_seqIndices:Er,_sosType:Math.max(rn,jt)%2?we:Re,_eosType:Math.max(Sn,Tn)%2?we:Re})}}for(var Dt=0;Dt<Nr.length;Dt++){var $t=Nr[Dt],Bt=$t._seqIndices,Wt=$t._sosType,tn=$t._eosType,cn=Lt[Bt[0]]&1?we:Re;if(vt.get(tt))for(var An=0;An<Bt.length;An++){var En=Bt[An];if(ft[En]&tt){for(var Bn=Wt,In=An-1;In>=0;In--)if(!(ft[Bt[In]]&ae)){Bn=ft[Bt[In]];break}Pt(En,Bn&(ie|nt)?ze:Bn)}}if(vt.get(Pe))for(var Cn=0;Cn<Bt.length;Cn++){var wn=Bt[Cn];if(ft[wn]&Pe)for(var bn=Cn-1;bn>=-1;bn--){var nr=bn===-1?Wt:ft[Bt[bn]];if(nr&oe){nr===Je&&Pt(wn,Ue);break}}}if(vt.get(Je))for(var Fn=0;Fn<Bt.length;Fn++){var On=Bt[Fn];ft[On]&Je&&Pt(On,we)}if(vt.get(Ie)||vt.get(ke))for(var Nn=1;Nn<Bt.length-1;Nn++){var mr=Bt[Nn];if(ft[mr]&(Ie|ke)){for(var zn=0,Zn=0,Un=Nn-1;Un>=0&&(zn=ft[Bt[Un]],!!(zn&ae));Un--);for(var er=Nn+1;er<Bt.length&&(Zn=ft[Bt[er]],!!(Zn&ae));er++);zn===Zn&&(ft[mr]===Ie?zn===Pe:zn&(Pe|Ue))&&Pt(mr,zn)}}if(vt.get(Pe))for(var Jn=0;Jn<Bt.length;Jn++){var rr=Bt[Jn];if(ft[rr]&Pe){for(var sr=Jn-1;sr>=0&&ft[Bt[sr]]&($e|ae);sr--)Pt(Bt[sr],Pe);for(Jn++;Jn<Bt.length&&ft[Bt[Jn]]&($e|ae|Pe);Jn++)ft[Bt[Jn]]!==Pe&&Pt(Bt[Jn],Pe)}}if(vt.get($e)||vt.get(Ie)||vt.get(ke))for(var fr=0;fr<Bt.length;fr++){var hr=Bt[fr];if(ft[hr]&($e|Ie|ke)){Pt(hr,ze);for(var _r=fr-1;_r>=0&&ft[Bt[_r]]&ae;_r--)Pt(Bt[_r],ze);for(var Vr=fr+1;Vr<Bt.length&&ft[Bt[Vr]]&ae;Vr++)Pt(Bt[Vr],ze)}}if(vt.get(Pe))for(var Hn=0,qn=Wt;Hn<Bt.length;Hn++){var mt=Bt[Hn],Ve=ft[mt];Ve&Pe?qn===Re&&Pt(mt,Re):Ve&oe&&(qn=Ve)}if(vt.get(se)){var We=we|Pe|Ue,Ye=We|Re,qe=[];{for(var dt=[],Ft=0;Ft<Bt.length;Ft++)if(ft[Bt[Ft]]&se){var Xt=Mt[Bt[Ft]],an=void 0;if(_e(Xt)!==null)if(dt.length<63)dt.push({char:Xt,seqIndex:Ft});else break;else if((an=Te(Xt))!==null)for(var Kt=dt.length-1;Kt>=0;Kt--){var on=dt[Kt].char;if(on===an||on===Te(be(Xt))||_e(be(on))===Xt){qe.push([dt[Kt].seqIndex,Ft]),dt.length=Kt;break}}}qe.sort(function(Ir,Gr){return Ir[0]-Gr[0]})}for(var sn=0;sn<qe.length;sn++){for(var nn=qe[sn],mn=nn[0],yn=nn[1],vn=!1,Mn=0,Yn=mn+1;Yn<yn;Yn++){var jn=Bt[Yn];if(ft[jn]&Ye){vn=!0;var Wn=ft[jn]&We?we:Re;if(Wn===cn){Mn=Wn;break}}}if(vn&&!Mn){Mn=Wt;for(var ir=mn-1;ir>=0;ir--){var gr=Bt[ir];if(ft[gr]&Ye){var wr=ft[gr]&We?we:Re;wr!==cn?Mn=wr:Mn=cn;break}}}if(Mn){if(ft[Bt[mn]]=ft[Bt[yn]]=Mn,Mn!==cn){for(var ei=mn+1;ei<Bt.length;ei++)if(!(ft[Bt[ei]]&ae)){de(Mt[Bt[ei]])&tt&&(ft[Bt[ei]]=Mn);break}}if(Mn!==cn){for(var Or=yn+1;Or<Bt.length;Or++)if(!(ft[Bt[Or]]&ae)){de(Mt[Bt[Or]])&tt&&(ft[Bt[Or]]=Mn);break}}}}for(var kr=0;kr<Bt.length;kr++)if(ft[Bt[kr]]&se){for(var Wi=kr,Qi=kr,no=Wt,Xi=kr-1;Xi>=0;Xi--)if(ft[Bt[Xi]]&ae)Wi=Xi;else{no=ft[Bt[Xi]]&We?we:Re;break}for(var ui=tn,pi=kr+1;pi<Bt.length;pi++)if(ft[Bt[pi]]&(se|ae))Qi=pi;else{ui=ft[Bt[pi]]&We?we:Re;break}for(var Ci=Wi;Ci<=Qi;Ci++)ft[Bt[Ci]]=no===ui?no:cn;kr=Qi}}}for(var jr=De.start;jr<=De.end;jr++){var ro=Lt[jr],qr=ft[jr];if(ro&1?qr&(Re|Pe|Ue)&&Lt[jr]++:qr&we?Lt[jr]++:qr&(Ue|Pe)&&(Lt[jr]+=2),qr&ae&&(Lt[jr]=jr===0?De.level:Lt[jr-1]),jr===De.end||de(Mt[jr])&(He|Ge))for(var Yr=jr;Yr>=0&&de(Mt[Yr])&le;Yr--)Lt[Yr]=De.level}}return{levels:Lt,paragraphs:Le};function wi(Ir,Gr){for(var Kr=Ir;Kr<Mt.length;Kr++){var hi=ft[Kr];if(hi&(we|Je))return 1;if(hi&(Ge|Re)||Gr&&hi===nt)return 0;if(hi&ie){var io=Ei(Kr);Kr=io===-1?Mt.length:io}}return 0}function Ei(Ir){for(var Gr=1,Kr=Ir+1;Kr<Mt.length;Kr++){var hi=ft[Kr];if(hi&Ge)break;if(hi&nt){if(--Gr===0)return Kr}else hi&ie&&Gr++}return-1}}var St="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Et;function Nt(){if(!Et){var Mt=ge(St,!0),_t=Mt.map,pt=Mt.reverseMap;pt.forEach(function(ft,st){_t.set(st,ft)}),Et=_t}}function zt(Mt){return Nt(),Et.get(Mt)||null}function yt(Mt,_t,pt,ft){var st=Mt.length;pt=Math.max(0,pt==null?0:+pt),ft=Math.min(st-1,ft==null?st-1:+ft);for(var vt=new Map,Pt=pt;Pt<=ft;Pt++)if(_t[Pt]&1){var Lt=zt(Mt[Pt]);Lt!==null&&vt.set(Pt,Lt)}return vt}function Ut(Mt,_t,pt,ft){var st=Mt.length;pt=Math.max(0,pt==null?0:+pt),ft=Math.min(st-1,ft==null?st-1:+ft);var vt=[];return _t.paragraphs.forEach(function(Pt){var Lt=Math.max(pt,Pt.start),Vt=Math.min(ft,Pt.end);if(Lt<Vt){for(var Le=_t.levels.slice(Lt,Vt+1),De=Vt;De>=Lt&&de(Mt[De])&le;De--)Le[De]=Pt.level;for(var Be=Pt.level,rt=1/0,at=0;at<Le.length;at++){var xt=Le[at];xt>Be&&(Be=xt),xt<rt&&(rt=xt|1)}for(var Ct=Be;Ct>=rt;Ct--)for(var Qt=0;Qt<Le.length;Qt++)if(Le[Qt]>=Ct){for(var qt=Qt;Qt+1<Le.length&&Le[Qt+1]>=Ct;)Qt++;Qt>qt&&vt.push([qt+Lt,Qt+Lt])}}}),vt}function bt(Mt,_t,pt,ft){var st=Ot(Mt,_t,pt,ft),vt=[].concat(Mt);return st.forEach(function(Pt,Lt){vt[Lt]=(_t.levels[Pt]&1?zt(Mt[Pt]):null)||Mt[Pt]}),vt.join("")}function Ot(Mt,_t,pt,ft){for(var st=Ut(Mt,_t,pt,ft),vt=[],Pt=0;Pt<Mt.length;Pt++)vt[Pt]=Pt;return st.forEach(function(Lt){for(var Vt=Lt[0],Le=Lt[1],De=vt.slice(Vt,Le+1),Be=De.length;Be--;)vt[Le-Be]=De[Be]}),vt}return _.closingToOpeningBracket=Te,_.getBidiCharType=de,_.getBidiCharTypeName=pe,_.getCanonicalBracket=be,_.getEmbeddingLevels=Tt,_.getMirroredCharacter=zt,_.getMirroredCharactersMap=yt,_.getReorderSegments=Ut,_.getReorderedIndices=Ot,_.getReorderedString=bt,_.openingToClosingBracket=_e,Object.defineProperty(_,"__esModule",{value:!0}),_}({});return K}const voidMainRegExp=/\bvoid\s+main\s*\(\s*\)\s*{/g;function expandShaderIncludes(K){const _=/^[ \t]*#include +<([\w\d./]+)>/gm;function Z(te,ne){let ie=ShaderChunk[ne];return ie?expandShaderIncludes(ie):te}return K.replace(_,Z)}const _lut=[];for(let K=0;K<256;K++)_lut[K]=(K<16?"0":"")+K.toString(16);function generateUUID(){const K=Math.random()*4294967295|0,_=Math.random()*4294967295|0,Z=Math.random()*4294967295|0,te=Math.random()*4294967295|0;return(_lut[K&255]+_lut[K>>8&255]+_lut[K>>16&255]+_lut[K>>24&255]+"-"+_lut[_&255]+_lut[_>>8&255]+"-"+_lut[_>>16&15|64]+_lut[_>>24&255]+"-"+_lut[Z&63|128]+_lut[Z>>8&255]+"-"+_lut[Z>>16&255]+_lut[Z>>24&255]+_lut[te&255]+_lut[te>>8&255]+_lut[te>>16&255]+_lut[te>>24&255]).toUpperCase()}const assign$9=Object.assign||function(){let K=arguments[0];for(let _=1,Z=arguments.length;_<Z;_++){let te=arguments[_];if(te)for(let ne in te)Object.prototype.hasOwnProperty.call(te,ne)&&(K[ne]=te[ne])}return K},epoch=Date.now(),CONSTRUCTOR_CACHE=new WeakMap,SHADER_UPGRADE_CACHE=new Map;let materialInstanceId=1e10;function createDerivedMaterial(K,_){const Z=getKeyForOptions(_);let te=CONSTRUCTOR_CACHE.get(K);if(te||CONSTRUCTOR_CACHE.set(K,te=Object.create(null)),te[Z])return new te[Z];const ne=`_onBeforeCompile${Z}`,ie=function(le,ce){K.onBeforeCompile.call(this,le,ce);const fe=this.customProgramCacheKey()+"|"+le.vertexShader+"|"+le.fragmentShader;let de=SHADER_UPGRADE_CACHE[fe];if(!de){const pe=upgradeShaders(this,le,_,Z);de=SHADER_UPGRADE_CACHE[fe]=pe}le.vertexShader=de.vertexShader,le.fragmentShader=de.fragmentShader,assign$9(le.uniforms,this.uniforms),_.timeUniform&&(le.uniforms[_.timeUniform]={get value(){return Date.now()-epoch}}),this[ne]&&this[ne](le)},oe=function(){return se(_.chained?K:K.clone())},se=function(le){const ce=Object.create(le,ae);return Object.defineProperty(ce,"baseMaterial",{value:K}),Object.defineProperty(ce,"id",{value:materialInstanceId++}),ce.uuid=generateUUID(),ce.uniforms=assign$9({},le.uniforms,_.uniforms),ce.defines=assign$9({},le.defines,_.defines),ce.defines[`TROIKA_DERIVED_MATERIAL_${Z}`]="",ce.extensions=assign$9({},le.extensions,_.extensions),ce._listeners=void 0,ce},ae={constructor:{value:oe},isDerivedMaterial:{value:!0},type:{get:()=>K.type,set:le=>{K.type=le}},isDerivedFrom:{writable:!0,configurable:!0,value:function(le){const ce=this.baseMaterial;return le===ce||ce.isDerivedMaterial&&ce.isDerivedFrom(le)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return K.customProgramCacheKey()+"|"+Z}},onBeforeCompile:{get(){return ie},set(le){this[ne]=le}},copy:{writable:!0,configurable:!0,value:function(le){return K.copy.call(this,le),!K.isShaderMaterial&&!K.isDerivedMaterial&&(assign$9(this.extensions,le.extensions),assign$9(this.defines,le.defines),assign$9(this.uniforms,UniformsUtils.clone(le.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const le=new K.constructor;return se(le).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let le=this._depthMaterial;return le||(le=this._depthMaterial=createDerivedMaterial(K.isDerivedMaterial?K.getDepthMaterial():new MeshDepthMaterial({depthPacking:RGBADepthPacking}),_),le.defines.IS_DEPTH_MATERIAL="",le.uniforms=this.uniforms),le}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let le=this._distanceMaterial;return le||(le=this._distanceMaterial=createDerivedMaterial(K.isDerivedMaterial?K.getDistanceMaterial():new MeshDistanceMaterial,_),le.defines.IS_DISTANCE_MATERIAL="",le.uniforms=this.uniforms),le}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:le,_distanceMaterial:ce}=this;le&&le.dispose(),ce&&ce.dispose(),K.dispose.call(this)}}};return te[Z]=oe,new oe}function upgradeShaders(K,{vertexShader:_,fragmentShader:Z},te,ne){let{vertexDefs:ie,vertexMainIntro:oe,vertexMainOutro:se,vertexTransform:ae,fragmentDefs:le,fragmentMainIntro:ce,fragmentMainOutro:fe,fragmentColorTransform:de,customRewriter:pe,timeUniform:he}=te;if(ie=ie||"",oe=oe||"",se=se||"",le=le||"",ce=ce||"",fe=fe||"",(ae||pe)&&(_=expandShaderIncludes(_)),(de||pe)&&(Z=Z.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),Z=expandShaderIncludes(Z)),pe){let ge=pe({vertexShader:_,fragmentShader:Z});_=ge.vertexShader,Z=ge.fragmentShader}if(de){let ge=[];Z=Z.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,me=>(ge.push(me),"")),fe=`${de}
${ge.join(`
`)}
${fe}`}if(he){const ge=`
uniform float ${he};
`;ie=ge+ie,le=ge+le}return ae&&(_=`vec3 troika_position_${ne};
vec3 troika_normal_${ne};
vec2 troika_uv_${ne};
${_}
`,ie=`${ie}
void troikaVertexTransform${ne}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${ae}
}
`,oe=`
troika_position_${ne} = vec3(position);
troika_normal_${ne} = vec3(normal);
troika_uv_${ne} = vec2(uv);
troikaVertexTransform${ne}(troika_position_${ne}, troika_normal_${ne}, troika_uv_${ne});
${oe}
`,_=_.replace(/\b(position|normal|uv)\b/g,(ge,me,Ae,ye)=>/\battribute\s+vec[23]\s+$/.test(ye.substr(0,Ae))?me:`troika_${me}_${ne}`),K.map&&K.map.channel>0||(_=_.replace(/\bMAP_UV\b/g,`troika_uv_${ne}`))),_=injectIntoShaderCode(_,ne,ie,oe,se),Z=injectIntoShaderCode(Z,ne,le,ce,fe),{vertexShader:_,fragmentShader:Z}}function injectIntoShaderCode(K,_,Z,te,ne){return(te||ne||Z)&&(K=K.replace(voidMainRegExp,`
${Z}
void troikaOrigMain${_}() {`),K+=`
void main() {
  ${te}
  troikaOrigMain${_}();
  ${ne}
}`),K}function optionsJsonReplacer(K,_){return K==="uniforms"?void 0:typeof _=="function"?_.toString():_}let _idCtr=0;const optionsHashesToIds=new Map;function getKeyForOptions(K){const _=JSON.stringify(K,optionsJsonReplacer);let Z=optionsHashesToIds.get(_);return Z==null&&optionsHashesToIds.set(_,Z=++_idCtr),Z}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function typrFactory(){return typeof window>"u"&&(self.window=self),function(K){var _={parse:function(ne){var ie=_._bin,oe=new Uint8Array(ne);if(ie.readASCII(oe,0,4)=="ttcf"){var se=4;ie.readUshort(oe,se),se+=2,ie.readUshort(oe,se),se+=2;var ae=ie.readUint(oe,se);se+=4;for(var le=[],ce=0;ce<ae;ce++){var fe=ie.readUint(oe,se);se+=4,le.push(_._readFont(oe,fe))}return le}return[_._readFont(oe,0)]},_readFont:function(ne,ie){var oe=_._bin,se=ie;oe.readFixed(ne,ie),ie+=4;var ae=oe.readUshort(ne,ie);ie+=2,oe.readUshort(ne,ie),ie+=2,oe.readUshort(ne,ie),ie+=2,oe.readUshort(ne,ie),ie+=2;for(var le=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],ce={_data:ne,_offset:se},fe={},de=0;de<ae;de++){var pe=oe.readASCII(ne,ie,4);ie+=4,oe.readUint(ne,ie),ie+=4;var he=oe.readUint(ne,ie);ie+=4;var ge=oe.readUint(ne,ie);ie+=4,fe[pe]={offset:he,length:ge}}for(de=0;de<le.length;de++){var me=le[de];fe[me]&&(ce[me.trim()]=_[me.trim()].parse(ne,fe[me].offset,fe[me].length,ce))}return ce},_tabOffset:function(ne,ie,oe){for(var se=_._bin,ae=se.readUshort(ne,oe+4),le=oe+12,ce=0;ce<ae;ce++){var fe=se.readASCII(ne,le,4);le+=4,se.readUint(ne,le),le+=4;var de=se.readUint(ne,le);if(le+=4,se.readUint(ne,le),le+=4,fe==ie)return de}return 0}};_._bin={readFixed:function(ne,ie){return(ne[ie]<<8|ne[ie+1])+(ne[ie+2]<<8|ne[ie+3])/65540},readF2dot14:function(ne,ie){return _._bin.readShort(ne,ie)/16384},readInt:function(ne,ie){return _._bin._view(ne).getInt32(ie)},readInt8:function(ne,ie){return _._bin._view(ne).getInt8(ie)},readShort:function(ne,ie){return _._bin._view(ne).getInt16(ie)},readUshort:function(ne,ie){return _._bin._view(ne).getUint16(ie)},readUshorts:function(ne,ie,oe){for(var se=[],ae=0;ae<oe;ae++)se.push(_._bin.readUshort(ne,ie+2*ae));return se},readUint:function(ne,ie){return _._bin._view(ne).getUint32(ie)},readUint64:function(ne,ie){return 4294967296*_._bin.readUint(ne,ie)+_._bin.readUint(ne,ie+4)},readASCII:function(ne,ie,oe){for(var se="",ae=0;ae<oe;ae++)se+=String.fromCharCode(ne[ie+ae]);return se},readUnicode:function(ne,ie,oe){for(var se="",ae=0;ae<oe;ae++){var le=ne[ie++]<<8|ne[ie++];se+=String.fromCharCode(le)}return se},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(ne,ie,oe){var se=_._bin._tdec;return se&&ie==0&&oe==ne.length?se.decode(ne):_._bin.readASCII(ne,ie,oe)},readBytes:function(ne,ie,oe){for(var se=[],ae=0;ae<oe;ae++)se.push(ne[ie+ae]);return se},readASCIIArray:function(ne,ie,oe){for(var se=[],ae=0;ae<oe;ae++)se.push(String.fromCharCode(ne[ie+ae]));return se},_view:function(ne){return ne._dataView||(ne._dataView=ne.buffer?new DataView(ne.buffer,ne.byteOffset,ne.byteLength):new DataView(new Uint8Array(ne).buffer))}},_._lctf={},_._lctf.parse=function(ne,ie,oe,se,ae){var le=_._bin,ce={},fe=ie;le.readFixed(ne,ie),ie+=4;var de=le.readUshort(ne,ie);ie+=2;var pe=le.readUshort(ne,ie);ie+=2;var he=le.readUshort(ne,ie);return ie+=2,ce.scriptList=_._lctf.readScriptList(ne,fe+de),ce.featureList=_._lctf.readFeatureList(ne,fe+pe),ce.lookupList=_._lctf.readLookupList(ne,fe+he,ae),ce},_._lctf.readLookupList=function(ne,ie,oe){var se=_._bin,ae=ie,le=[],ce=se.readUshort(ne,ie);ie+=2;for(var fe=0;fe<ce;fe++){var de=se.readUshort(ne,ie);ie+=2;var pe=_._lctf.readLookupTable(ne,ae+de,oe);le.push(pe)}return le},_._lctf.readLookupTable=function(ne,ie,oe){var se=_._bin,ae=ie,le={tabs:[]};le.ltype=se.readUshort(ne,ie),ie+=2,le.flag=se.readUshort(ne,ie),ie+=2;var ce=se.readUshort(ne,ie);ie+=2;for(var fe=le.ltype,de=0;de<ce;de++){var pe=se.readUshort(ne,ie);ie+=2;var he=oe(ne,fe,ae+pe,le);le.tabs.push(he)}return le},_._lctf.numOfOnes=function(ne){for(var ie=0,oe=0;oe<32;oe++)ne>>>oe&1&&ie++;return ie},_._lctf.readClassDef=function(ne,ie){var oe=_._bin,se=[],ae=oe.readUshort(ne,ie);if(ie+=2,ae==1){var le=oe.readUshort(ne,ie);ie+=2;var ce=oe.readUshort(ne,ie);ie+=2;for(var fe=0;fe<ce;fe++)se.push(le+fe),se.push(le+fe),se.push(oe.readUshort(ne,ie)),ie+=2}if(ae==2){var de=oe.readUshort(ne,ie);for(ie+=2,fe=0;fe<de;fe++)se.push(oe.readUshort(ne,ie)),ie+=2,se.push(oe.readUshort(ne,ie)),ie+=2,se.push(oe.readUshort(ne,ie)),ie+=2}return se},_._lctf.getInterval=function(ne,ie){for(var oe=0;oe<ne.length;oe+=3){var se=ne[oe],ae=ne[oe+1];if(ne[oe+2],se<=ie&&ie<=ae)return oe}return-1},_._lctf.readCoverage=function(ne,ie){var oe=_._bin,se={};se.fmt=oe.readUshort(ne,ie),ie+=2;var ae=oe.readUshort(ne,ie);return ie+=2,se.fmt==1&&(se.tab=oe.readUshorts(ne,ie,ae)),se.fmt==2&&(se.tab=oe.readUshorts(ne,ie,3*ae)),se},_._lctf.coverageIndex=function(ne,ie){var oe=ne.tab;if(ne.fmt==1)return oe.indexOf(ie);if(ne.fmt==2){var se=_._lctf.getInterval(oe,ie);if(se!=-1)return oe[se+2]+(ie-oe[se])}return-1},_._lctf.readFeatureList=function(ne,ie){var oe=_._bin,se=ie,ae=[],le=oe.readUshort(ne,ie);ie+=2;for(var ce=0;ce<le;ce++){var fe=oe.readASCII(ne,ie,4);ie+=4;var de=oe.readUshort(ne,ie);ie+=2;var pe=_._lctf.readFeatureTable(ne,se+de);pe.tag=fe.trim(),ae.push(pe)}return ae},_._lctf.readFeatureTable=function(ne,ie){var oe=_._bin,se=ie,ae={},le=oe.readUshort(ne,ie);ie+=2,le>0&&(ae.featureParams=se+le);var ce=oe.readUshort(ne,ie);ie+=2,ae.tab=[];for(var fe=0;fe<ce;fe++)ae.tab.push(oe.readUshort(ne,ie+2*fe));return ae},_._lctf.readScriptList=function(ne,ie){var oe=_._bin,se=ie,ae={},le=oe.readUshort(ne,ie);ie+=2;for(var ce=0;ce<le;ce++){var fe=oe.readASCII(ne,ie,4);ie+=4;var de=oe.readUshort(ne,ie);ie+=2,ae[fe.trim()]=_._lctf.readScriptTable(ne,se+de)}return ae},_._lctf.readScriptTable=function(ne,ie){var oe=_._bin,se=ie,ae={},le=oe.readUshort(ne,ie);ie+=2,le>0&&(ae.default=_._lctf.readLangSysTable(ne,se+le));var ce=oe.readUshort(ne,ie);ie+=2;for(var fe=0;fe<ce;fe++){var de=oe.readASCII(ne,ie,4);ie+=4;var pe=oe.readUshort(ne,ie);ie+=2,ae[de.trim()]=_._lctf.readLangSysTable(ne,se+pe)}return ae},_._lctf.readLangSysTable=function(ne,ie){var oe=_._bin,se={};oe.readUshort(ne,ie),ie+=2,se.reqFeature=oe.readUshort(ne,ie),ie+=2;var ae=oe.readUshort(ne,ie);return ie+=2,se.features=oe.readUshorts(ne,ie,ae),se},_.CFF={},_.CFF.parse=function(ne,ie,oe){var se=_._bin;(ne=new Uint8Array(ne.buffer,ie,oe))[ie=0],ne[++ie],ne[++ie],ne[++ie],ie++;var ae=[];ie=_.CFF.readIndex(ne,ie,ae);for(var le=[],ce=0;ce<ae.length-1;ce++)le.push(se.readASCII(ne,ie+ae[ce],ae[ce+1]-ae[ce]));ie+=ae[ae.length-1];var fe=[];ie=_.CFF.readIndex(ne,ie,fe);var de=[];for(ce=0;ce<fe.length-1;ce++)de.push(_.CFF.readDict(ne,ie+fe[ce],ie+fe[ce+1]));ie+=fe[fe.length-1];var pe=de[0],he=[];ie=_.CFF.readIndex(ne,ie,he);var ge=[];for(ce=0;ce<he.length-1;ce++)ge.push(se.readASCII(ne,ie+he[ce],he[ce+1]-he[ce]));if(ie+=he[he.length-1],_.CFF.readSubrs(ne,ie,pe),pe.CharStrings){ie=pe.CharStrings,he=[],ie=_.CFF.readIndex(ne,ie,he);var me=[];for(ce=0;ce<he.length-1;ce++)me.push(se.readBytes(ne,ie+he[ce],he[ce+1]-he[ce]));pe.CharStrings=me}if(pe.ROS){ie=pe.FDArray;var Ae=[];for(ie=_.CFF.readIndex(ne,ie,Ae),pe.FDArray=[],ce=0;ce<Ae.length-1;ce++){var ye=_.CFF.readDict(ne,ie+Ae[ce],ie+Ae[ce+1]);_.CFF._readFDict(ne,ye,ge),pe.FDArray.push(ye)}ie+=Ae[Ae.length-1],ie=pe.FDSelect,pe.FDSelect=[];var ve=ne[ie];if(ie++,ve!=3)throw ve;var _e=se.readUshort(ne,ie);for(ie+=2,ce=0;ce<_e+1;ce++)pe.FDSelect.push(se.readUshort(ne,ie),ne[ie+2]),ie+=3}return pe.Encoding&&(pe.Encoding=_.CFF.readEncoding(ne,pe.Encoding,pe.CharStrings.length)),pe.charset&&(pe.charset=_.CFF.readCharset(ne,pe.charset,pe.CharStrings.length)),_.CFF._readFDict(ne,pe,ge),pe},_.CFF._readFDict=function(ne,ie,oe){var se;for(var ae in ie.Private&&(se=ie.Private[1],ie.Private=_.CFF.readDict(ne,se,se+ie.Private[0]),ie.Private.Subrs&&_.CFF.readSubrs(ne,se+ie.Private.Subrs,ie.Private)),ie)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(ae)!=-1&&(ie[ae]=oe[ie[ae]-426+35])},_.CFF.readSubrs=function(ne,ie,oe){var se=_._bin,ae=[];ie=_.CFF.readIndex(ne,ie,ae);var le,ce=ae.length;le=ce<1240?107:ce<33900?1131:32768,oe.Bias=le,oe.Subrs=[];for(var fe=0;fe<ae.length-1;fe++)oe.Subrs.push(se.readBytes(ne,ie+ae[fe],ae[fe+1]-ae[fe]))},_.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],_.CFF.glyphByUnicode=function(ne,ie){for(var oe=0;oe<ne.charset.length;oe++)if(ne.charset[oe]==ie)return oe;return-1},_.CFF.glyphBySE=function(ne,ie){return ie<0||ie>255?-1:_.CFF.glyphByUnicode(ne,_.CFF.tableSE[ie])},_.CFF.readEncoding=function(ne,ie,oe){_._bin;var se=[".notdef"],ae=ne[ie];if(ie++,ae!=0)throw"error: unknown encoding format: "+ae;var le=ne[ie];ie++;for(var ce=0;ce<le;ce++)se.push(ne[ie+ce]);return se},_.CFF.readCharset=function(ne,ie,oe){var se=_._bin,ae=[".notdef"],le=ne[ie];if(ie++,le==0)for(var ce=0;ce<oe;ce++){var fe=se.readUshort(ne,ie);ie+=2,ae.push(fe)}else{if(le!=1&&le!=2)throw"error: format: "+le;for(;ae.length<oe;){fe=se.readUshort(ne,ie),ie+=2;var de=0;for(le==1?(de=ne[ie],ie++):(de=se.readUshort(ne,ie),ie+=2),ce=0;ce<=de;ce++)ae.push(fe),fe++}}return ae},_.CFF.readIndex=function(ne,ie,oe){var se=_._bin,ae=se.readUshort(ne,ie)+1,le=ne[ie+=2];if(ie++,le==1)for(var ce=0;ce<ae;ce++)oe.push(ne[ie+ce]);else if(le==2)for(ce=0;ce<ae;ce++)oe.push(se.readUshort(ne,ie+2*ce));else if(le==3)for(ce=0;ce<ae;ce++)oe.push(16777215&se.readUint(ne,ie+3*ce-1));else if(ae!=1)throw"unsupported offset size: "+le+", count: "+ae;return(ie+=ae*le)-1},_.CFF.getCharString=function(ne,ie,oe){var se=_._bin,ae=ne[ie],le=ne[ie+1];ne[ie+2],ne[ie+3],ne[ie+4];var ce=1,fe=null,de=null;ae<=20&&(fe=ae,ce=1),ae==12&&(fe=100*ae+le,ce=2),21<=ae&&ae<=27&&(fe=ae,ce=1),ae==28&&(de=se.readShort(ne,ie+1),ce=3),29<=ae&&ae<=31&&(fe=ae,ce=1),32<=ae&&ae<=246&&(de=ae-139,ce=1),247<=ae&&ae<=250&&(de=256*(ae-247)+le+108,ce=2),251<=ae&&ae<=254&&(de=256*-(ae-251)-le-108,ce=2),ae==255&&(de=se.readInt(ne,ie+1)/65535,ce=5),oe.val=de??"o"+fe,oe.size=ce},_.CFF.readCharString=function(ne,ie,oe){for(var se=ie+oe,ae=_._bin,le=[];ie<se;){var ce=ne[ie],fe=ne[ie+1];ne[ie+2],ne[ie+3],ne[ie+4];var de=1,pe=null,he=null;ce<=20&&(pe=ce,de=1),ce==12&&(pe=100*ce+fe,de=2),ce!=19&&ce!=20||(pe=ce,de=2),21<=ce&&ce<=27&&(pe=ce,de=1),ce==28&&(he=ae.readShort(ne,ie+1),de=3),29<=ce&&ce<=31&&(pe=ce,de=1),32<=ce&&ce<=246&&(he=ce-139,de=1),247<=ce&&ce<=250&&(he=256*(ce-247)+fe+108,de=2),251<=ce&&ce<=254&&(he=256*-(ce-251)-fe-108,de=2),ce==255&&(he=ae.readInt(ne,ie+1)/65535,de=5),le.push(he??"o"+pe),ie+=de}return le},_.CFF.readDict=function(ne,ie,oe){for(var se=_._bin,ae={},le=[];ie<oe;){var ce=ne[ie],fe=ne[ie+1];ne[ie+2],ne[ie+3],ne[ie+4];var de=1,pe=null,he=null;if(ce==28&&(he=se.readShort(ne,ie+1),de=3),ce==29&&(he=se.readInt(ne,ie+1),de=5),32<=ce&&ce<=246&&(he=ce-139,de=1),247<=ce&&ce<=250&&(he=256*(ce-247)+fe+108,de=2),251<=ce&&ce<=254&&(he=256*-(ce-251)-fe-108,de=2),ce==255)throw he=se.readInt(ne,ie+1)/65535,de=5,"unknown number";if(ce==30){var ge=[];for(de=1;;){var me=ne[ie+de];de++;var Ae=me>>4,ye=15&me;if(Ae!=15&&ge.push(Ae),ye!=15&&ge.push(ye),ye==15)break}for(var ve="",_e=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],Te=0;Te<ge.length;Te++)ve+=_e[ge[Te]];he=parseFloat(ve)}ce<=21&&(pe=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][ce],de=1,ce==12&&(pe=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][fe],de=2)),pe!=null?(ae[pe]=le.length==1?le[0]:le,le=[]):le.push(he),ie+=de}return ae},_.cmap={},_.cmap.parse=function(ne,ie,oe){ne=new Uint8Array(ne.buffer,ie,oe),ie=0;var se=_._bin,ae={};se.readUshort(ne,ie),ie+=2;var le=se.readUshort(ne,ie);ie+=2;var ce=[];ae.tables=[];for(var fe=0;fe<le;fe++){var de=se.readUshort(ne,ie);ie+=2;var pe=se.readUshort(ne,ie);ie+=2;var he=se.readUint(ne,ie);ie+=4;var ge="p"+de+"e"+pe,me=ce.indexOf(he);if(me==-1){var Ae;me=ae.tables.length,ce.push(he);var ye=se.readUshort(ne,he);ye==0?Ae=_.cmap.parse0(ne,he):ye==4?Ae=_.cmap.parse4(ne,he):ye==6?Ae=_.cmap.parse6(ne,he):ye==12?Ae=_.cmap.parse12(ne,he):console.debug("unknown format: "+ye,de,pe,he),ae.tables.push(Ae)}if(ae[ge]!=null)throw"multiple tables for one platform+encoding";ae[ge]=me}return ae},_.cmap.parse0=function(ne,ie){var oe=_._bin,se={};se.format=oe.readUshort(ne,ie),ie+=2;var ae=oe.readUshort(ne,ie);ie+=2,oe.readUshort(ne,ie),ie+=2,se.map=[];for(var le=0;le<ae-6;le++)se.map.push(ne[ie+le]);return se},_.cmap.parse4=function(ne,ie){var oe=_._bin,se=ie,ae={};ae.format=oe.readUshort(ne,ie),ie+=2;var le=oe.readUshort(ne,ie);ie+=2,oe.readUshort(ne,ie),ie+=2;var ce=oe.readUshort(ne,ie);ie+=2;var fe=ce/2;ae.searchRange=oe.readUshort(ne,ie),ie+=2,ae.entrySelector=oe.readUshort(ne,ie),ie+=2,ae.rangeShift=oe.readUshort(ne,ie),ie+=2,ae.endCount=oe.readUshorts(ne,ie,fe),ie+=2*fe,ie+=2,ae.startCount=oe.readUshorts(ne,ie,fe),ie+=2*fe,ae.idDelta=[];for(var de=0;de<fe;de++)ae.idDelta.push(oe.readShort(ne,ie)),ie+=2;for(ae.idRangeOffset=oe.readUshorts(ne,ie,fe),ie+=2*fe,ae.glyphIdArray=[];ie<se+le;)ae.glyphIdArray.push(oe.readUshort(ne,ie)),ie+=2;return ae},_.cmap.parse6=function(ne,ie){var oe=_._bin,se={};se.format=oe.readUshort(ne,ie),ie+=2,oe.readUshort(ne,ie),ie+=2,oe.readUshort(ne,ie),ie+=2,se.firstCode=oe.readUshort(ne,ie),ie+=2;var ae=oe.readUshort(ne,ie);ie+=2,se.glyphIdArray=[];for(var le=0;le<ae;le++)se.glyphIdArray.push(oe.readUshort(ne,ie)),ie+=2;return se},_.cmap.parse12=function(ne,ie){var oe=_._bin,se={};se.format=oe.readUshort(ne,ie),ie+=2,ie+=2,oe.readUint(ne,ie),ie+=4,oe.readUint(ne,ie),ie+=4;var ae=oe.readUint(ne,ie);ie+=4,se.groups=[];for(var le=0;le<ae;le++){var ce=ie+12*le,fe=oe.readUint(ne,ce+0),de=oe.readUint(ne,ce+4),pe=oe.readUint(ne,ce+8);se.groups.push([fe,de,pe])}return se},_.glyf={},_.glyf.parse=function(ne,ie,oe,se){for(var ae=[],le=0;le<se.maxp.numGlyphs;le++)ae.push(null);return ae},_.glyf._parseGlyf=function(ne,ie){var oe=_._bin,se=ne._data,ae=_._tabOffset(se,"glyf",ne._offset)+ne.loca[ie];if(ne.loca[ie]==ne.loca[ie+1])return null;var le={};if(le.noc=oe.readShort(se,ae),ae+=2,le.xMin=oe.readShort(se,ae),ae+=2,le.yMin=oe.readShort(se,ae),ae+=2,le.xMax=oe.readShort(se,ae),ae+=2,le.yMax=oe.readShort(se,ae),ae+=2,le.xMin>=le.xMax||le.yMin>=le.yMax)return null;if(le.noc>0){le.endPts=[];for(var ce=0;ce<le.noc;ce++)le.endPts.push(oe.readUshort(se,ae)),ae+=2;var fe=oe.readUshort(se,ae);if(ae+=2,se.length-ae<fe)return null;le.instructions=oe.readBytes(se,ae,fe),ae+=fe;var de=le.endPts[le.noc-1]+1;for(le.flags=[],ce=0;ce<de;ce++){var pe=se[ae];if(ae++,le.flags.push(pe),(8&pe)!=0){var he=se[ae];ae++;for(var ge=0;ge<he;ge++)le.flags.push(pe),ce++}}for(le.xs=[],ce=0;ce<de;ce++){var me=(2&le.flags[ce])!=0,Ae=(16&le.flags[ce])!=0;me?(le.xs.push(Ae?se[ae]:-se[ae]),ae++):Ae?le.xs.push(0):(le.xs.push(oe.readShort(se,ae)),ae+=2)}for(le.ys=[],ce=0;ce<de;ce++)me=(4&le.flags[ce])!=0,Ae=(32&le.flags[ce])!=0,me?(le.ys.push(Ae?se[ae]:-se[ae]),ae++):Ae?le.ys.push(0):(le.ys.push(oe.readShort(se,ae)),ae+=2);var ye=0,ve=0;for(ce=0;ce<de;ce++)ye+=le.xs[ce],ve+=le.ys[ce],le.xs[ce]=ye,le.ys[ce]=ve}else{var _e;le.parts=[];do{_e=oe.readUshort(se,ae),ae+=2;var Te={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(le.parts.push(Te),Te.glyphIndex=oe.readUshort(se,ae),ae+=2,1&_e){var be=oe.readShort(se,ae);ae+=2;var Re=oe.readShort(se,ae);ae+=2}else be=oe.readInt8(se,ae),ae++,Re=oe.readInt8(se,ae),ae++;2&_e?(Te.m.tx=be,Te.m.ty=Re):(Te.p1=be,Te.p2=Re),8&_e?(Te.m.a=Te.m.d=oe.readF2dot14(se,ae),ae+=2):64&_e?(Te.m.a=oe.readF2dot14(se,ae),ae+=2,Te.m.d=oe.readF2dot14(se,ae),ae+=2):128&_e&&(Te.m.a=oe.readF2dot14(se,ae),ae+=2,Te.m.b=oe.readF2dot14(se,ae),ae+=2,Te.m.c=oe.readF2dot14(se,ae),ae+=2,Te.m.d=oe.readF2dot14(se,ae),ae+=2)}while(32&_e);if(256&_e){var we=oe.readUshort(se,ae);for(ae+=2,le.instr=[],ce=0;ce<we;ce++)le.instr.push(se[ae]),ae++}}return le},_.GDEF={},_.GDEF.parse=function(ne,ie,oe,se){var ae=ie;ie+=4;var le=_._bin.readUshort(ne,ie);return{glyphClassDef:le===0?null:_._lctf.readClassDef(ne,ae+le)}},_.GPOS={},_.GPOS.parse=function(ne,ie,oe,se){return _._lctf.parse(ne,ie,oe,se,_.GPOS.subt)},_.GPOS.subt=function(ne,ie,oe,se){var ae=_._bin,le=oe,ce={};if(ce.fmt=ae.readUshort(ne,oe),oe+=2,ie==1||ie==2||ie==3||ie==7||ie==8&&ce.fmt<=2){var fe=ae.readUshort(ne,oe);oe+=2,ce.coverage=_._lctf.readCoverage(ne,fe+le)}if(ie==1&&ce.fmt==1){var de=ae.readUshort(ne,oe);oe+=2,de!=0&&(ce.pos=_.GPOS.readValueRecord(ne,oe,de))}else if(ie==2&&ce.fmt>=1&&ce.fmt<=2){de=ae.readUshort(ne,oe),oe+=2;var pe=ae.readUshort(ne,oe);oe+=2;var he=_._lctf.numOfOnes(de),ge=_._lctf.numOfOnes(pe);if(ce.fmt==1){ce.pairsets=[];var me=ae.readUshort(ne,oe);oe+=2;for(var Ae=0;Ae<me;Ae++){var ye=le+ae.readUshort(ne,oe);oe+=2;var ve=ae.readUshort(ne,ye);ye+=2;for(var _e=[],Te=0;Te<ve;Te++){var be=ae.readUshort(ne,ye);ye+=2,de!=0&&(Ue=_.GPOS.readValueRecord(ne,ye,de),ye+=2*he),pe!=0&&(ke=_.GPOS.readValueRecord(ne,ye,pe),ye+=2*ge),_e.push({gid2:be,val1:Ue,val2:ke})}ce.pairsets.push(_e)}}if(ce.fmt==2){var Re=ae.readUshort(ne,oe);oe+=2;var we=ae.readUshort(ne,oe);oe+=2;var Pe=ae.readUshort(ne,oe);oe+=2;var Ie=ae.readUshort(ne,oe);for(oe+=2,ce.classDef1=_._lctf.readClassDef(ne,le+Re),ce.classDef2=_._lctf.readClassDef(ne,le+we),ce.matrix=[],Ae=0;Ae<Pe;Ae++){var $e=[];for(Te=0;Te<Ie;Te++){var Ue=null,ke=null;de!=0&&(Ue=_.GPOS.readValueRecord(ne,oe,de),oe+=2*he),pe!=0&&(ke=_.GPOS.readValueRecord(ne,oe,pe),oe+=2*ge),$e.push({val1:Ue,val2:ke})}ce.matrix.push($e)}}}else if(ie==4&&ce.fmt==1)ce.markCoverage=_._lctf.readCoverage(ne,ae.readUshort(ne,oe)+le),ce.baseCoverage=_._lctf.readCoverage(ne,ae.readUshort(ne,oe+2)+le),ce.markClassCount=ae.readUshort(ne,oe+4),ce.markArray=_.GPOS.readMarkArray(ne,ae.readUshort(ne,oe+6)+le),ce.baseArray=_.GPOS.readBaseArray(ne,ae.readUshort(ne,oe+8)+le,ce.markClassCount);else if(ie==6&&ce.fmt==1)ce.mark1Coverage=_._lctf.readCoverage(ne,ae.readUshort(ne,oe)+le),ce.mark2Coverage=_._lctf.readCoverage(ne,ae.readUshort(ne,oe+2)+le),ce.markClassCount=ae.readUshort(ne,oe+4),ce.mark1Array=_.GPOS.readMarkArray(ne,ae.readUshort(ne,oe+6)+le),ce.mark2Array=_.GPOS.readBaseArray(ne,ae.readUshort(ne,oe+8)+le,ce.markClassCount);else{if(ie==9&&ce.fmt==1){var Ge=ae.readUshort(ne,oe);oe+=2;var He=ae.readUint(ne,oe);if(oe+=4,se.ltype==9)se.ltype=Ge;else if(se.ltype!=Ge)throw"invalid extension substitution";return _.GPOS.subt(ne,se.ltype,le+He)}console.debug("unsupported GPOS table LookupType",ie,"format",ce.fmt)}return ce},_.GPOS.readValueRecord=function(ne,ie,oe){var se=_._bin,ae=[];return ae.push(1&oe?se.readShort(ne,ie):0),ie+=1&oe?2:0,ae.push(2&oe?se.readShort(ne,ie):0),ie+=2&oe?2:0,ae.push(4&oe?se.readShort(ne,ie):0),ie+=4&oe?2:0,ae.push(8&oe?se.readShort(ne,ie):0),ie+=8&oe?2:0,ae},_.GPOS.readBaseArray=function(ne,ie,oe){var se=_._bin,ae=[],le=ie,ce=se.readUshort(ne,ie);ie+=2;for(var fe=0;fe<ce;fe++){for(var de=[],pe=0;pe<oe;pe++)de.push(_.GPOS.readAnchorRecord(ne,le+se.readUshort(ne,ie))),ie+=2;ae.push(de)}return ae},_.GPOS.readMarkArray=function(ne,ie){var oe=_._bin,se=[],ae=ie,le=oe.readUshort(ne,ie);ie+=2;for(var ce=0;ce<le;ce++){var fe=_.GPOS.readAnchorRecord(ne,oe.readUshort(ne,ie+2)+ae);fe.markClass=oe.readUshort(ne,ie),se.push(fe),ie+=4}return se},_.GPOS.readAnchorRecord=function(ne,ie){var oe=_._bin,se={};return se.fmt=oe.readUshort(ne,ie),se.x=oe.readShort(ne,ie+2),se.y=oe.readShort(ne,ie+4),se},_.GSUB={},_.GSUB.parse=function(ne,ie,oe,se){return _._lctf.parse(ne,ie,oe,se,_.GSUB.subt)},_.GSUB.subt=function(ne,ie,oe,se){var ae=_._bin,le=oe,ce={};if(ce.fmt=ae.readUshort(ne,oe),oe+=2,ie!=1&&ie!=2&&ie!=4&&ie!=5&&ie!=6)return null;if(ie==1||ie==2||ie==4||ie==5&&ce.fmt<=2||ie==6&&ce.fmt<=2){var fe=ae.readUshort(ne,oe);oe+=2,ce.coverage=_._lctf.readCoverage(ne,le+fe)}if(ie==1&&ce.fmt>=1&&ce.fmt<=2){if(ce.fmt==1)ce.delta=ae.readShort(ne,oe),oe+=2;else if(ce.fmt==2){var de=ae.readUshort(ne,oe);oe+=2,ce.newg=ae.readUshorts(ne,oe,de),oe+=2*ce.newg.length}}else if(ie==2&&ce.fmt==1){de=ae.readUshort(ne,oe),oe+=2,ce.seqs=[];for(var pe=0;pe<de;pe++){var he=ae.readUshort(ne,oe)+le;oe+=2;var ge=ae.readUshort(ne,he);ce.seqs.push(ae.readUshorts(ne,he+2,ge))}}else if(ie==4)for(ce.vals=[],de=ae.readUshort(ne,oe),oe+=2,pe=0;pe<de;pe++){var me=ae.readUshort(ne,oe);oe+=2,ce.vals.push(_.GSUB.readLigatureSet(ne,le+me))}else if(ie==5&&ce.fmt==2){if(ce.fmt==2){var Ae=ae.readUshort(ne,oe);oe+=2,ce.cDef=_._lctf.readClassDef(ne,le+Ae),ce.scset=[];var ye=ae.readUshort(ne,oe);for(oe+=2,pe=0;pe<ye;pe++){var ve=ae.readUshort(ne,oe);oe+=2,ce.scset.push(ve==0?null:_.GSUB.readSubClassSet(ne,le+ve))}}}else if(ie==6&&ce.fmt==3){if(ce.fmt==3){for(pe=0;pe<3;pe++){de=ae.readUshort(ne,oe),oe+=2;for(var _e=[],Te=0;Te<de;Te++)_e.push(_._lctf.readCoverage(ne,le+ae.readUshort(ne,oe+2*Te)));oe+=2*de,pe==0&&(ce.backCvg=_e),pe==1&&(ce.inptCvg=_e),pe==2&&(ce.ahedCvg=_e)}de=ae.readUshort(ne,oe),oe+=2,ce.lookupRec=_.GSUB.readSubstLookupRecords(ne,oe,de)}}else{if(ie==7&&ce.fmt==1){var be=ae.readUshort(ne,oe);oe+=2;var Re=ae.readUint(ne,oe);if(oe+=4,se.ltype==9)se.ltype=be;else if(se.ltype!=be)throw"invalid extension substitution";return _.GSUB.subt(ne,se.ltype,le+Re)}console.debug("unsupported GSUB table LookupType",ie,"format",ce.fmt)}return ce},_.GSUB.readSubClassSet=function(ne,ie){var oe=_._bin.readUshort,se=ie,ae=[],le=oe(ne,ie);ie+=2;for(var ce=0;ce<le;ce++){var fe=oe(ne,ie);ie+=2,ae.push(_.GSUB.readSubClassRule(ne,se+fe))}return ae},_.GSUB.readSubClassRule=function(ne,ie){var oe=_._bin.readUshort,se={},ae=oe(ne,ie),le=oe(ne,ie+=2);ie+=2,se.input=[];for(var ce=0;ce<ae-1;ce++)se.input.push(oe(ne,ie)),ie+=2;return se.substLookupRecords=_.GSUB.readSubstLookupRecords(ne,ie,le),se},_.GSUB.readSubstLookupRecords=function(ne,ie,oe){for(var se=_._bin.readUshort,ae=[],le=0;le<oe;le++)ae.push(se(ne,ie),se(ne,ie+2)),ie+=4;return ae},_.GSUB.readChainSubClassSet=function(ne,ie){var oe=_._bin,se=ie,ae=[],le=oe.readUshort(ne,ie);ie+=2;for(var ce=0;ce<le;ce++){var fe=oe.readUshort(ne,ie);ie+=2,ae.push(_.GSUB.readChainSubClassRule(ne,se+fe))}return ae},_.GSUB.readChainSubClassRule=function(ne,ie){for(var oe=_._bin,se={},ae=["backtrack","input","lookahead"],le=0;le<ae.length;le++){var ce=oe.readUshort(ne,ie);ie+=2,le==1&&ce--,se[ae[le]]=oe.readUshorts(ne,ie,ce),ie+=2*se[ae[le]].length}return ce=oe.readUshort(ne,ie),ie+=2,se.subst=oe.readUshorts(ne,ie,2*ce),ie+=2*se.subst.length,se},_.GSUB.readLigatureSet=function(ne,ie){var oe=_._bin,se=ie,ae=[],le=oe.readUshort(ne,ie);ie+=2;for(var ce=0;ce<le;ce++){var fe=oe.readUshort(ne,ie);ie+=2,ae.push(_.GSUB.readLigature(ne,se+fe))}return ae},_.GSUB.readLigature=function(ne,ie){var oe=_._bin,se={chain:[]};se.nglyph=oe.readUshort(ne,ie),ie+=2;var ae=oe.readUshort(ne,ie);ie+=2;for(var le=0;le<ae-1;le++)se.chain.push(oe.readUshort(ne,ie)),ie+=2;return se},_.head={},_.head.parse=function(ne,ie,oe){var se=_._bin,ae={};return se.readFixed(ne,ie),ie+=4,ae.fontRevision=se.readFixed(ne,ie),ie+=4,se.readUint(ne,ie),ie+=4,se.readUint(ne,ie),ie+=4,ae.flags=se.readUshort(ne,ie),ie+=2,ae.unitsPerEm=se.readUshort(ne,ie),ie+=2,ae.created=se.readUint64(ne,ie),ie+=8,ae.modified=se.readUint64(ne,ie),ie+=8,ae.xMin=se.readShort(ne,ie),ie+=2,ae.yMin=se.readShort(ne,ie),ie+=2,ae.xMax=se.readShort(ne,ie),ie+=2,ae.yMax=se.readShort(ne,ie),ie+=2,ae.macStyle=se.readUshort(ne,ie),ie+=2,ae.lowestRecPPEM=se.readUshort(ne,ie),ie+=2,ae.fontDirectionHint=se.readShort(ne,ie),ie+=2,ae.indexToLocFormat=se.readShort(ne,ie),ie+=2,ae.glyphDataFormat=se.readShort(ne,ie),ie+=2,ae},_.hhea={},_.hhea.parse=function(ne,ie,oe){var se=_._bin,ae={};return se.readFixed(ne,ie),ie+=4,ae.ascender=se.readShort(ne,ie),ie+=2,ae.descender=se.readShort(ne,ie),ie+=2,ae.lineGap=se.readShort(ne,ie),ie+=2,ae.advanceWidthMax=se.readUshort(ne,ie),ie+=2,ae.minLeftSideBearing=se.readShort(ne,ie),ie+=2,ae.minRightSideBearing=se.readShort(ne,ie),ie+=2,ae.xMaxExtent=se.readShort(ne,ie),ie+=2,ae.caretSlopeRise=se.readShort(ne,ie),ie+=2,ae.caretSlopeRun=se.readShort(ne,ie),ie+=2,ae.caretOffset=se.readShort(ne,ie),ie+=2,ie+=8,ae.metricDataFormat=se.readShort(ne,ie),ie+=2,ae.numberOfHMetrics=se.readUshort(ne,ie),ie+=2,ae},_.hmtx={},_.hmtx.parse=function(ne,ie,oe,se){for(var ae=_._bin,le={aWidth:[],lsBearing:[]},ce=0,fe=0,de=0;de<se.maxp.numGlyphs;de++)de<se.hhea.numberOfHMetrics&&(ce=ae.readUshort(ne,ie),ie+=2,fe=ae.readShort(ne,ie),ie+=2),le.aWidth.push(ce),le.lsBearing.push(fe);return le},_.kern={},_.kern.parse=function(ne,ie,oe,se){var ae=_._bin,le=ae.readUshort(ne,ie);if(ie+=2,le==1)return _.kern.parseV1(ne,ie-2,oe,se);var ce=ae.readUshort(ne,ie);ie+=2;for(var fe={glyph1:[],rval:[]},de=0;de<ce;de++){ie+=2,oe=ae.readUshort(ne,ie),ie+=2;var pe=ae.readUshort(ne,ie);ie+=2;var he=pe>>>8;if((he&=15)!=0)throw"unknown kern table format: "+he;ie=_.kern.readFormat0(ne,ie,fe)}return fe},_.kern.parseV1=function(ne,ie,oe,se){var ae=_._bin;ae.readFixed(ne,ie),ie+=4;var le=ae.readUint(ne,ie);ie+=4;for(var ce={glyph1:[],rval:[]},fe=0;fe<le;fe++){ae.readUint(ne,ie),ie+=4;var de=ae.readUshort(ne,ie);ie+=2,ae.readUshort(ne,ie),ie+=2;var pe=de>>>8;if((pe&=15)!=0)throw"unknown kern table format: "+pe;ie=_.kern.readFormat0(ne,ie,ce)}return ce},_.kern.readFormat0=function(ne,ie,oe){var se=_._bin,ae=-1,le=se.readUshort(ne,ie);ie+=2,se.readUshort(ne,ie),ie+=2,se.readUshort(ne,ie),ie+=2,se.readUshort(ne,ie),ie+=2;for(var ce=0;ce<le;ce++){var fe=se.readUshort(ne,ie);ie+=2;var de=se.readUshort(ne,ie);ie+=2;var pe=se.readShort(ne,ie);ie+=2,fe!=ae&&(oe.glyph1.push(fe),oe.rval.push({glyph2:[],vals:[]}));var he=oe.rval[oe.rval.length-1];he.glyph2.push(de),he.vals.push(pe),ae=fe}return ie},_.loca={},_.loca.parse=function(ne,ie,oe,se){var ae=_._bin,le=[],ce=se.head.indexToLocFormat,fe=se.maxp.numGlyphs+1;if(ce==0)for(var de=0;de<fe;de++)le.push(ae.readUshort(ne,ie+(de<<1))<<1);if(ce==1)for(de=0;de<fe;de++)le.push(ae.readUint(ne,ie+(de<<2)));return le},_.maxp={},_.maxp.parse=function(ne,ie,oe){var se=_._bin,ae={},le=se.readUint(ne,ie);return ie+=4,ae.numGlyphs=se.readUshort(ne,ie),ie+=2,le==65536&&(ae.maxPoints=se.readUshort(ne,ie),ie+=2,ae.maxContours=se.readUshort(ne,ie),ie+=2,ae.maxCompositePoints=se.readUshort(ne,ie),ie+=2,ae.maxCompositeContours=se.readUshort(ne,ie),ie+=2,ae.maxZones=se.readUshort(ne,ie),ie+=2,ae.maxTwilightPoints=se.readUshort(ne,ie),ie+=2,ae.maxStorage=se.readUshort(ne,ie),ie+=2,ae.maxFunctionDefs=se.readUshort(ne,ie),ie+=2,ae.maxInstructionDefs=se.readUshort(ne,ie),ie+=2,ae.maxStackElements=se.readUshort(ne,ie),ie+=2,ae.maxSizeOfInstructions=se.readUshort(ne,ie),ie+=2,ae.maxComponentElements=se.readUshort(ne,ie),ie+=2,ae.maxComponentDepth=se.readUshort(ne,ie),ie+=2),ae},_.name={},_.name.parse=function(ne,ie,oe){var se=_._bin,ae={};se.readUshort(ne,ie),ie+=2;var le=se.readUshort(ne,ie);ie+=2,se.readUshort(ne,ie);for(var ce,fe=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],de=ie+=2,pe=0;pe<le;pe++){var he=se.readUshort(ne,ie);ie+=2;var ge=se.readUshort(ne,ie);ie+=2;var me=se.readUshort(ne,ie);ie+=2;var Ae=se.readUshort(ne,ie);ie+=2;var ye=se.readUshort(ne,ie);ie+=2;var ve=se.readUshort(ne,ie);ie+=2;var _e,Te=fe[Ae],be=de+12*le+ve;if(he==0)_e=se.readUnicode(ne,be,ye/2);else if(he==3&&ge==0)_e=se.readUnicode(ne,be,ye/2);else if(ge==0)_e=se.readASCII(ne,be,ye);else if(ge==1)_e=se.readUnicode(ne,be,ye/2);else if(ge==3)_e=se.readUnicode(ne,be,ye/2);else{if(he!=1)throw"unknown encoding "+ge+", platformID: "+he;_e=se.readASCII(ne,be,ye),console.debug("reading unknown MAC encoding "+ge+" as ASCII")}var Re="p"+he+","+me.toString(16);ae[Re]==null&&(ae[Re]={}),ae[Re][Te!==void 0?Te:Ae]=_e,ae[Re]._lang=me}for(var we in ae)if(ae[we].postScriptName!=null&&ae[we]._lang==1033)return ae[we];for(var we in ae)if(ae[we].postScriptName!=null&&ae[we]._lang==0)return ae[we];for(var we in ae)if(ae[we].postScriptName!=null&&ae[we]._lang==3084)return ae[we];for(var we in ae)if(ae[we].postScriptName!=null)return ae[we];for(var we in ae){ce=we;break}return console.debug("returning name table with languageID "+ae[ce]._lang),ae[ce]},_["OS/2"]={},_["OS/2"].parse=function(ne,ie,oe){var se=_._bin.readUshort(ne,ie);ie+=2;var ae={};if(se==0)_["OS/2"].version0(ne,ie,ae);else if(se==1)_["OS/2"].version1(ne,ie,ae);else if(se==2||se==3||se==4)_["OS/2"].version2(ne,ie,ae);else{if(se!=5)throw"unknown OS/2 table version: "+se;_["OS/2"].version5(ne,ie,ae)}return ae},_["OS/2"].version0=function(ne,ie,oe){var se=_._bin;return oe.xAvgCharWidth=se.readShort(ne,ie),ie+=2,oe.usWeightClass=se.readUshort(ne,ie),ie+=2,oe.usWidthClass=se.readUshort(ne,ie),ie+=2,oe.fsType=se.readUshort(ne,ie),ie+=2,oe.ySubscriptXSize=se.readShort(ne,ie),ie+=2,oe.ySubscriptYSize=se.readShort(ne,ie),ie+=2,oe.ySubscriptXOffset=se.readShort(ne,ie),ie+=2,oe.ySubscriptYOffset=se.readShort(ne,ie),ie+=2,oe.ySuperscriptXSize=se.readShort(ne,ie),ie+=2,oe.ySuperscriptYSize=se.readShort(ne,ie),ie+=2,oe.ySuperscriptXOffset=se.readShort(ne,ie),ie+=2,oe.ySuperscriptYOffset=se.readShort(ne,ie),ie+=2,oe.yStrikeoutSize=se.readShort(ne,ie),ie+=2,oe.yStrikeoutPosition=se.readShort(ne,ie),ie+=2,oe.sFamilyClass=se.readShort(ne,ie),ie+=2,oe.panose=se.readBytes(ne,ie,10),ie+=10,oe.ulUnicodeRange1=se.readUint(ne,ie),ie+=4,oe.ulUnicodeRange2=se.readUint(ne,ie),ie+=4,oe.ulUnicodeRange3=se.readUint(ne,ie),ie+=4,oe.ulUnicodeRange4=se.readUint(ne,ie),ie+=4,oe.achVendID=[se.readInt8(ne,ie),se.readInt8(ne,ie+1),se.readInt8(ne,ie+2),se.readInt8(ne,ie+3)],ie+=4,oe.fsSelection=se.readUshort(ne,ie),ie+=2,oe.usFirstCharIndex=se.readUshort(ne,ie),ie+=2,oe.usLastCharIndex=se.readUshort(ne,ie),ie+=2,oe.sTypoAscender=se.readShort(ne,ie),ie+=2,oe.sTypoDescender=se.readShort(ne,ie),ie+=2,oe.sTypoLineGap=se.readShort(ne,ie),ie+=2,oe.usWinAscent=se.readUshort(ne,ie),ie+=2,oe.usWinDescent=se.readUshort(ne,ie),ie+=2},_["OS/2"].version1=function(ne,ie,oe){var se=_._bin;return ie=_["OS/2"].version0(ne,ie,oe),oe.ulCodePageRange1=se.readUint(ne,ie),ie+=4,oe.ulCodePageRange2=se.readUint(ne,ie),ie+=4},_["OS/2"].version2=function(ne,ie,oe){var se=_._bin;return ie=_["OS/2"].version1(ne,ie,oe),oe.sxHeight=se.readShort(ne,ie),ie+=2,oe.sCapHeight=se.readShort(ne,ie),ie+=2,oe.usDefault=se.readUshort(ne,ie),ie+=2,oe.usBreak=se.readUshort(ne,ie),ie+=2,oe.usMaxContext=se.readUshort(ne,ie),ie+=2},_["OS/2"].version5=function(ne,ie,oe){var se=_._bin;return ie=_["OS/2"].version2(ne,ie,oe),oe.usLowerOpticalPointSize=se.readUshort(ne,ie),ie+=2,oe.usUpperOpticalPointSize=se.readUshort(ne,ie),ie+=2},_.post={},_.post.parse=function(ne,ie,oe){var se=_._bin,ae={};return ae.version=se.readFixed(ne,ie),ie+=4,ae.italicAngle=se.readFixed(ne,ie),ie+=4,ae.underlinePosition=se.readShort(ne,ie),ie+=2,ae.underlineThickness=se.readShort(ne,ie),ie+=2,ae},_==null&&(_={}),_.U==null&&(_.U={}),_.U.codeToGlyph=function(ne,ie){var oe=ne.cmap,se=-1;if(oe.p0e4!=null?se=oe.p0e4:oe.p3e1!=null?se=oe.p3e1:oe.p1e0!=null?se=oe.p1e0:oe.p0e3!=null&&(se=oe.p0e3),se==-1)throw"no familiar platform and encoding!";var ae=oe.tables[se];if(ae.format==0)return ie>=ae.map.length?0:ae.map[ie];if(ae.format==4){for(var le=-1,ce=0;ce<ae.endCount.length;ce++)if(ie<=ae.endCount[ce]){le=ce;break}return le==-1||ae.startCount[le]>ie?0:65535&(ae.idRangeOffset[le]!=0?ae.glyphIdArray[ie-ae.startCount[le]+(ae.idRangeOffset[le]>>1)-(ae.idRangeOffset.length-le)]:ie+ae.idDelta[le])}if(ae.format==12){if(ie>ae.groups[ae.groups.length-1][1])return 0;for(ce=0;ce<ae.groups.length;ce++){var fe=ae.groups[ce];if(fe[0]<=ie&&ie<=fe[1])return fe[2]+(ie-fe[0])}return 0}throw"unknown cmap table format "+ae.format},_.U.glyphToPath=function(ne,ie){var oe={cmds:[],crds:[]};if(ne.SVG&&ne.SVG.entries[ie]){var se=ne.SVG.entries[ie];return se==null?oe:(typeof se=="string"&&(se=_.SVG.toPath(se),ne.SVG.entries[ie]=se),se)}if(ne.CFF){var ae={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:ne.CFF.Private?ne.CFF.Private.defaultWidthX:0,open:!1},le=ne.CFF,ce=ne.CFF.Private;if(le.ROS){for(var fe=0;le.FDSelect[fe+2]<=ie;)fe+=2;ce=le.FDArray[le.FDSelect[fe+1]].Private}_.U._drawCFF(ne.CFF.CharStrings[ie],ae,le,ce,oe)}else ne.glyf&&_.U._drawGlyf(ie,ne,oe);return oe},_.U._drawGlyf=function(ne,ie,oe){var se=ie.glyf[ne];se==null&&(se=ie.glyf[ne]=_.glyf._parseGlyf(ie,ne)),se!=null&&(se.noc>-1?_.U._simpleGlyph(se,oe):_.U._compoGlyph(se,ie,oe))},_.U._simpleGlyph=function(ne,ie){for(var oe=0;oe<ne.noc;oe++){for(var se=oe==0?0:ne.endPts[oe-1]+1,ae=ne.endPts[oe],le=se;le<=ae;le++){var ce=le==se?ae:le-1,fe=le==ae?se:le+1,de=1&ne.flags[le],pe=1&ne.flags[ce],he=1&ne.flags[fe],ge=ne.xs[le],me=ne.ys[le];if(le==se)if(de){if(!pe){_.U.P.moveTo(ie,ge,me);continue}_.U.P.moveTo(ie,ne.xs[ce],ne.ys[ce])}else pe?_.U.P.moveTo(ie,ne.xs[ce],ne.ys[ce]):_.U.P.moveTo(ie,(ne.xs[ce]+ge)/2,(ne.ys[ce]+me)/2);de?pe&&_.U.P.lineTo(ie,ge,me):he?_.U.P.qcurveTo(ie,ge,me,ne.xs[fe],ne.ys[fe]):_.U.P.qcurveTo(ie,ge,me,(ge+ne.xs[fe])/2,(me+ne.ys[fe])/2)}_.U.P.closePath(ie)}},_.U._compoGlyph=function(ne,ie,oe){for(var se=0;se<ne.parts.length;se++){var ae={cmds:[],crds:[]},le=ne.parts[se];_.U._drawGlyf(le.glyphIndex,ie,ae);for(var ce=le.m,fe=0;fe<ae.crds.length;fe+=2){var de=ae.crds[fe],pe=ae.crds[fe+1];oe.crds.push(de*ce.a+pe*ce.b+ce.tx),oe.crds.push(de*ce.c+pe*ce.d+ce.ty)}for(fe=0;fe<ae.cmds.length;fe++)oe.cmds.push(ae.cmds[fe])}},_.U._getGlyphClass=function(ne,ie){var oe=_._lctf.getInterval(ie,ne);return oe==-1?0:ie[oe+2]},_.U._applySubs=function(ne,ie,oe,se){for(var ae=ne.length-ie-1,le=0;le<oe.tabs.length;le++)if(oe.tabs[le]!=null){var ce,fe=oe.tabs[le];if(!fe.coverage||(ce=_._lctf.coverageIndex(fe.coverage,ne[ie]))!=-1){if(oe.ltype==1)ne[ie],fe.fmt==1?ne[ie]=ne[ie]+fe.delta:ne[ie]=fe.newg[ce];else if(oe.ltype==4)for(var de=fe.vals[ce],pe=0;pe<de.length;pe++){var he=de[pe],ge=he.chain.length;if(!(ge>ae)){for(var me=!0,Ae=0,ye=0;ye<ge;ye++){for(;ne[ie+Ae+(1+ye)]==-1;)Ae++;he.chain[ye]!=ne[ie+Ae+(1+ye)]&&(me=!1)}if(me){for(ne[ie]=he.nglyph,ye=0;ye<ge+Ae;ye++)ne[ie+ye+1]=-1;break}}}else if(oe.ltype==5&&fe.fmt==2)for(var ve=_._lctf.getInterval(fe.cDef,ne[ie]),_e=fe.cDef[ve+2],Te=fe.scset[_e],be=0;be<Te.length;be++){var Re=Te[be],we=Re.input;if(!(we.length>ae)){for(me=!0,ye=0;ye<we.length;ye++){var Pe=_._lctf.getInterval(fe.cDef,ne[ie+1+ye]);if(ve==-1&&fe.cDef[Pe+2]!=we[ye]){me=!1;break}}if(me){var Ie=Re.substLookupRecords;for(pe=0;pe<Ie.length;pe+=2)Ie[pe],Ie[pe+1]}}}else if(oe.ltype==6&&fe.fmt==3){if(!_.U._glsCovered(ne,fe.backCvg,ie-fe.backCvg.length)||!_.U._glsCovered(ne,fe.inptCvg,ie)||!_.U._glsCovered(ne,fe.ahedCvg,ie+fe.inptCvg.length))continue;var $e=fe.lookupRec;for(be=0;be<$e.length;be+=2){ve=$e[be];var Ue=se[$e[be+1]];_.U._applySubs(ne,ie+ve,Ue,se)}}}}},_.U._glsCovered=function(ne,ie,oe){for(var se=0;se<ie.length;se++)if(_._lctf.coverageIndex(ie[se],ne[oe+se])==-1)return!1;return!0},_.U.glyphsToPath=function(ne,ie,oe){for(var se={cmds:[],crds:[]},ae=0,le=0;le<ie.length;le++){var ce=ie[le];if(ce!=-1){for(var fe=le<ie.length-1&&ie[le+1]!=-1?ie[le+1]:0,de=_.U.glyphToPath(ne,ce),pe=0;pe<de.crds.length;pe+=2)se.crds.push(de.crds[pe]+ae),se.crds.push(de.crds[pe+1]);for(oe&&se.cmds.push(oe),pe=0;pe<de.cmds.length;pe++)se.cmds.push(de.cmds[pe]);oe&&se.cmds.push("X"),ae+=ne.hmtx.aWidth[ce],le<ie.length-1&&(ae+=_.U.getPairAdjustment(ne,ce,fe))}}return se},_.U.P={},_.U.P.moveTo=function(ne,ie,oe){ne.cmds.push("M"),ne.crds.push(ie,oe)},_.U.P.lineTo=function(ne,ie,oe){ne.cmds.push("L"),ne.crds.push(ie,oe)},_.U.P.curveTo=function(ne,ie,oe,se,ae,le,ce){ne.cmds.push("C"),ne.crds.push(ie,oe,se,ae,le,ce)},_.U.P.qcurveTo=function(ne,ie,oe,se,ae){ne.cmds.push("Q"),ne.crds.push(ie,oe,se,ae)},_.U.P.closePath=function(ne){ne.cmds.push("Z")},_.U._drawCFF=function(ne,ie,oe,se,ae){for(var le=ie.stack,ce=ie.nStems,fe=ie.haveWidth,de=ie.width,pe=ie.open,he=0,ge=ie.x,me=ie.y,Ae=0,ye=0,ve=0,_e=0,Te=0,be=0,Re=0,we=0,Pe=0,Ie=0,$e={val:0,size:0};he<ne.length;){_.CFF.getCharString(ne,he,$e);var Ue=$e.val;if(he+=$e.size,Ue=="o1"||Ue=="o18")le.length%2!=0&&!fe&&(de=le.shift()+se.nominalWidthX),ce+=le.length>>1,le.length=0,fe=!0;else if(Ue=="o3"||Ue=="o23")le.length%2!=0&&!fe&&(de=le.shift()+se.nominalWidthX),ce+=le.length>>1,le.length=0,fe=!0;else if(Ue=="o4")le.length>1&&!fe&&(de=le.shift()+se.nominalWidthX,fe=!0),pe&&_.U.P.closePath(ae),me+=le.pop(),_.U.P.moveTo(ae,ge,me),pe=!0;else if(Ue=="o5")for(;le.length>0;)ge+=le.shift(),me+=le.shift(),_.U.P.lineTo(ae,ge,me);else if(Ue=="o6"||Ue=="o7")for(var ke=le.length,Ge=Ue=="o6",He=0;He<ke;He++){var ze=le.shift();Ge?ge+=ze:me+=ze,Ge=!Ge,_.U.P.lineTo(ae,ge,me)}else if(Ue=="o8"||Ue=="o24"){ke=le.length;for(var Ke=0;Ke+6<=ke;)Ae=ge+le.shift(),ye=me+le.shift(),ve=Ae+le.shift(),_e=ye+le.shift(),ge=ve+le.shift(),me=_e+le.shift(),_.U.P.curveTo(ae,Ae,ye,ve,_e,ge,me),Ke+=6;Ue=="o24"&&(ge+=le.shift(),me+=le.shift(),_.U.P.lineTo(ae,ge,me))}else{if(Ue=="o11")break;if(Ue=="o1234"||Ue=="o1235"||Ue=="o1236"||Ue=="o1237")Ue=="o1234"&&(ye=me,ve=(Ae=ge+le.shift())+le.shift(),Ie=_e=ye+le.shift(),be=_e,we=me,ge=(Re=(Te=(Pe=ve+le.shift())+le.shift())+le.shift())+le.shift(),_.U.P.curveTo(ae,Ae,ye,ve,_e,Pe,Ie),_.U.P.curveTo(ae,Te,be,Re,we,ge,me)),Ue=="o1235"&&(Ae=ge+le.shift(),ye=me+le.shift(),ve=Ae+le.shift(),_e=ye+le.shift(),Pe=ve+le.shift(),Ie=_e+le.shift(),Te=Pe+le.shift(),be=Ie+le.shift(),Re=Te+le.shift(),we=be+le.shift(),ge=Re+le.shift(),me=we+le.shift(),le.shift(),_.U.P.curveTo(ae,Ae,ye,ve,_e,Pe,Ie),_.U.P.curveTo(ae,Te,be,Re,we,ge,me)),Ue=="o1236"&&(Ae=ge+le.shift(),ye=me+le.shift(),ve=Ae+le.shift(),Ie=_e=ye+le.shift(),be=_e,Re=(Te=(Pe=ve+le.shift())+le.shift())+le.shift(),we=be+le.shift(),ge=Re+le.shift(),_.U.P.curveTo(ae,Ae,ye,ve,_e,Pe,Ie),_.U.P.curveTo(ae,Te,be,Re,we,ge,me)),Ue=="o1237"&&(Ae=ge+le.shift(),ye=me+le.shift(),ve=Ae+le.shift(),_e=ye+le.shift(),Pe=ve+le.shift(),Ie=_e+le.shift(),Te=Pe+le.shift(),be=Ie+le.shift(),Re=Te+le.shift(),we=be+le.shift(),Math.abs(Re-ge)>Math.abs(we-me)?ge=Re+le.shift():me=we+le.shift(),_.U.P.curveTo(ae,Ae,ye,ve,_e,Pe,Ie),_.U.P.curveTo(ae,Te,be,Re,we,ge,me));else if(Ue=="o14"){if(le.length>0&&!fe&&(de=le.shift()+oe.nominalWidthX,fe=!0),le.length==4){var tt=le.shift(),Je=le.shift(),ot=le.shift(),Fe=le.shift(),ct=_.CFF.glyphBySE(oe,ot),ht=_.CFF.glyphBySE(oe,Fe);_.U._drawCFF(oe.CharStrings[ct],ie,oe,se,ae),ie.x=tt,ie.y=Je,_.U._drawCFF(oe.CharStrings[ht],ie,oe,se,ae)}pe&&(_.U.P.closePath(ae),pe=!1)}else if(Ue=="o19"||Ue=="o20")le.length%2!=0&&!fe&&(de=le.shift()+se.nominalWidthX),ce+=le.length>>1,le.length=0,fe=!0,he+=ce+7>>3;else if(Ue=="o21")le.length>2&&!fe&&(de=le.shift()+se.nominalWidthX,fe=!0),me+=le.pop(),ge+=le.pop(),pe&&_.U.P.closePath(ae),_.U.P.moveTo(ae,ge,me),pe=!0;else if(Ue=="o22")le.length>1&&!fe&&(de=le.shift()+se.nominalWidthX,fe=!0),ge+=le.pop(),pe&&_.U.P.closePath(ae),_.U.P.moveTo(ae,ge,me),pe=!0;else if(Ue=="o25"){for(;le.length>6;)ge+=le.shift(),me+=le.shift(),_.U.P.lineTo(ae,ge,me);Ae=ge+le.shift(),ye=me+le.shift(),ve=Ae+le.shift(),_e=ye+le.shift(),ge=ve+le.shift(),me=_e+le.shift(),_.U.P.curveTo(ae,Ae,ye,ve,_e,ge,me)}else if(Ue=="o26")for(le.length%2&&(ge+=le.shift());le.length>0;)Ae=ge,ye=me+le.shift(),ge=ve=Ae+le.shift(),me=(_e=ye+le.shift())+le.shift(),_.U.P.curveTo(ae,Ae,ye,ve,_e,ge,me);else if(Ue=="o27")for(le.length%2&&(me+=le.shift());le.length>0;)ye=me,ve=(Ae=ge+le.shift())+le.shift(),_e=ye+le.shift(),ge=ve+le.shift(),me=_e,_.U.P.curveTo(ae,Ae,ye,ve,_e,ge,me);else if(Ue=="o10"||Ue=="o29"){var lt=Ue=="o10"?se:oe;if(le.length==0)console.debug("error: empty stack");else{var Qe=le.pop(),Ze=lt.Subrs[Qe+lt.Bias];ie.x=ge,ie.y=me,ie.nStems=ce,ie.haveWidth=fe,ie.width=de,ie.open=pe,_.U._drawCFF(Ze,ie,oe,se,ae),ge=ie.x,me=ie.y,ce=ie.nStems,fe=ie.haveWidth,de=ie.width,pe=ie.open}}else if(Ue=="o30"||Ue=="o31"){var it=le.length,nt=(Ke=0,Ue=="o31");for(Ke+=it-(ke=-3&it);Ke<ke;)nt?(ye=me,ve=(Ae=ge+le.shift())+le.shift(),me=(_e=ye+le.shift())+le.shift(),ke-Ke==5?(ge=ve+le.shift(),Ke++):ge=ve,nt=!1):(Ae=ge,ye=me+le.shift(),ve=Ae+le.shift(),_e=ye+le.shift(),ge=ve+le.shift(),ke-Ke==5?(me=_e+le.shift(),Ke++):me=_e,nt=!0),_.U.P.curveTo(ae,Ae,ye,ve,_e,ge,me),Ke+=4}else{if((Ue+"").charAt(0)=="o")throw console.debug("Unknown operation: "+Ue,ne),Ue;le.push(Ue)}}}ie.x=ge,ie.y=me,ie.nStems=ce,ie.haveWidth=fe,ie.width=de,ie.open=pe};var Z=_,te={Typr:Z};return K.Typr=Z,K.default=te,Object.defineProperty(K,"__esModule",{value:!0}),K}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function woff2otfFactory(){return function(K){var _=Uint8Array,Z=Uint16Array,te=Uint32Array,ne=new _([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ie=new _([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),oe=new _([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),se=function(Ue,ke){for(var Ge=new Z(31),He=0;He<31;++He)Ge[He]=ke+=1<<Ue[He-1];var ze=new te(Ge[30]);for(He=1;He<30;++He)for(var Ke=Ge[He];Ke<Ge[He+1];++Ke)ze[Ke]=Ke-Ge[He]<<5|He;return[Ge,ze]},ae=se(ne,2),le=ae[0],ce=ae[1];le[28]=258,ce[258]=28;for(var fe=se(ie,0)[0],de=new Z(32768),pe=0;pe<32768;++pe){var he=(43690&pe)>>>1|(21845&pe)<<1;he=(61680&(he=(52428&he)>>>2|(13107&he)<<2))>>>4|(3855&he)<<4,de[pe]=((65280&he)>>>8|(255&he)<<8)>>>1}var ge=function(Ue,ke,Ge){for(var He=Ue.length,ze=0,Ke=new Z(ke);ze<He;++ze)++Ke[Ue[ze]-1];var tt,Je=new Z(ke);for(ze=0;ze<ke;++ze)Je[ze]=Je[ze-1]+Ke[ze-1]<<1;{tt=new Z(1<<ke);var ot=15-ke;for(ze=0;ze<He;++ze)if(Ue[ze])for(var Fe=ze<<4|Ue[ze],ct=ke-Ue[ze],ht=Je[Ue[ze]-1]++<<ct,lt=ht|(1<<ct)-1;ht<=lt;++ht)tt[de[ht]>>>ot]=Fe}return tt},me=new _(288);for(pe=0;pe<144;++pe)me[pe]=8;for(pe=144;pe<256;++pe)me[pe]=9;for(pe=256;pe<280;++pe)me[pe]=7;for(pe=280;pe<288;++pe)me[pe]=8;var Ae=new _(32);for(pe=0;pe<32;++pe)Ae[pe]=5;var ye=ge(me,9),ve=ge(Ae,5),_e=function(Ue){for(var ke=Ue[0],Ge=1;Ge<Ue.length;++Ge)Ue[Ge]>ke&&(ke=Ue[Ge]);return ke},Te=function(Ue,ke,Ge){var He=ke/8|0;return(Ue[He]|Ue[He+1]<<8)>>(7&ke)&Ge},be=function(Ue,ke){var Ge=ke/8|0;return(Ue[Ge]|Ue[Ge+1]<<8|Ue[Ge+2]<<16)>>(7&ke)},Re=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],we=function(Ue,ke,Ge){var He=new Error(ke||Re[Ue]);if(He.code=Ue,Error.captureStackTrace&&Error.captureStackTrace(He,we),!Ge)throw He;return He},Pe=function(Ue,ke,Ge){var He=Ue.length;if(!He||Ge&&!Ge.l&&He<5)return ke||new _(0);var ze=!ke||Ge,Ke=!Ge||Ge.i;Ge||(Ge={}),ke||(ke=new _(3*He));var tt,Je=function(qt){var It=ke.length;if(qt>It){var Gt=new _(Math.max(2*It,qt));Gt.set(ke),ke=Gt}},ot=Ge.f||0,Fe=Ge.p||0,ct=Ge.b||0,ht=Ge.l,lt=Ge.d,Qe=Ge.m,Ze=Ge.n,it=8*He;do{if(!ht){Ge.f=ot=Te(Ue,Fe,1);var nt=Te(Ue,Fe+1,3);if(Fe+=3,!nt){var Tt=Ue[(pt=((tt=Fe)/8|0)+(7&tt&&1)+4)-4]|Ue[pt-3]<<8,St=pt+Tt;if(St>He){Ke&&we(0);break}ze&&Je(ct+Tt),ke.set(Ue.subarray(pt,St),ct),Ge.b=ct+=Tt,Ge.p=Fe=8*St;continue}if(nt==1)ht=ye,lt=ve,Qe=9,Ze=5;else if(nt==2){var Et=Te(Ue,Fe,31)+257,Nt=Te(Ue,Fe+10,15)+4,zt=Et+Te(Ue,Fe+5,31)+1;Fe+=14;for(var yt=new _(zt),Ut=new _(19),bt=0;bt<Nt;++bt)Ut[oe[bt]]=Te(Ue,Fe+3*bt,7);Fe+=3*Nt;var Ot=_e(Ut),Mt=(1<<Ot)-1,_t=ge(Ut,Ot);for(bt=0;bt<zt;){var pt,ft=_t[Te(Ue,Fe,Mt)];if(Fe+=15&ft,(pt=ft>>>4)<16)yt[bt++]=pt;else{var st=0,vt=0;for(pt==16?(vt=3+Te(Ue,Fe,3),Fe+=2,st=yt[bt-1]):pt==17?(vt=3+Te(Ue,Fe,7),Fe+=3):pt==18&&(vt=11+Te(Ue,Fe,127),Fe+=7);vt--;)yt[bt++]=st}}var Pt=yt.subarray(0,Et),Lt=yt.subarray(Et);Qe=_e(Pt),Ze=_e(Lt),ht=ge(Pt,Qe),lt=ge(Lt,Ze)}else we(1);if(Fe>it){Ke&&we(0);break}}ze&&Je(ct+131072);for(var Vt=(1<<Qe)-1,Le=(1<<Ze)-1,De=Fe;;De=Fe){var Be=(st=ht[be(Ue,Fe)&Vt])>>>4;if((Fe+=15&st)>it){Ke&&we(0);break}if(st||we(2),Be<256)ke[ct++]=Be;else{if(Be==256){De=Fe,ht=null;break}var rt=Be-254;if(Be>264){var at=ne[bt=Be-257];rt=Te(Ue,Fe,(1<<at)-1)+le[bt],Fe+=at}var xt=lt[be(Ue,Fe)&Le],Ct=xt>>>4;if(xt||we(3),Fe+=15&xt,Lt=fe[Ct],Ct>3&&(at=ie[Ct],Lt+=be(Ue,Fe)&(1<<at)-1,Fe+=at),Fe>it){Ke&&we(0);break}ze&&Je(ct+131072);for(var Qt=ct+rt;ct<Qt;ct+=4)ke[ct]=ke[ct-Lt],ke[ct+1]=ke[ct+1-Lt],ke[ct+2]=ke[ct+2-Lt],ke[ct+3]=ke[ct+3-Lt];ct=Qt}}Ge.l=ht,Ge.p=De,Ge.b=ct,ht&&(ot=1,Ge.m=Qe,Ge.d=lt,Ge.n=Ze)}while(!ot);return ct==ke.length?ke:function(qt,It,Gt){(Gt==null||Gt>qt.length)&&(Gt=qt.length);var Jt=new(qt instanceof Z?Z:qt instanceof te?te:_)(Gt-It);return Jt.set(qt.subarray(It,Gt)),Jt}(ke,0,ct)},Ie=new _(0),$e=typeof TextDecoder<"u"&&new TextDecoder;try{$e.decode(Ie,{stream:!0})}catch{}return K.convert_streams=function(Ue){var ke=new DataView(Ue),Ge=0;function He(){var Et=ke.getUint16(Ge);return Ge+=2,Et}function ze(){var Et=ke.getUint32(Ge);return Ge+=4,Et}function Ke(Et){Tt.setUint16(St,Et),St+=2}function tt(Et){Tt.setUint32(St,Et),St+=4}for(var Je={signature:ze(),flavor:ze(),length:ze(),numTables:He(),reserved:He(),totalSfntSize:ze(),majorVersion:He(),minorVersion:He(),metaOffset:ze(),metaLength:ze(),metaOrigLength:ze(),privOffset:ze(),privLength:ze()},ot=0;Math.pow(2,ot)<=Je.numTables;)ot++;ot--;for(var Fe=16*Math.pow(2,ot),ct=16*Je.numTables-Fe,ht=12,lt=[],Qe=0;Qe<Je.numTables;Qe++)lt.push({tag:ze(),offset:ze(),compLength:ze(),origLength:ze(),origChecksum:ze()}),ht+=16;var Ze,it=new Uint8Array(12+16*lt.length+lt.reduce(function(Et,Nt){return Et+Nt.origLength+4},0)),nt=it.buffer,Tt=new DataView(nt),St=0;return tt(Je.flavor),Ke(Je.numTables),Ke(Fe),Ke(ot),Ke(ct),lt.forEach(function(Et){tt(Et.tag),tt(Et.origChecksum),tt(ht),tt(Et.origLength),Et.outOffset=ht,(ht+=Et.origLength)%4!=0&&(ht+=4-ht%4)}),lt.forEach(function(Et){var Nt,zt=Ue.slice(Et.offset,Et.offset+Et.compLength);if(Et.compLength!=Et.origLength){var yt=new Uint8Array(Et.origLength);Nt=new Uint8Array(zt,2),Pe(Nt,yt)}else yt=new Uint8Array(zt);it.set(yt,Et.outOffset);var Ut=0;(ht=Et.outOffset+Et.origLength)%4!=0&&(Ut=4-ht%4),it.set(new Uint8Array(Ut).buffer,Et.outOffset+Et.origLength),Ze=ht+Ut}),nt.slice(0,Ze)},Object.defineProperty(K,"__esModule",{value:!0}),K}({}).convert_streams}function parserFactory(K,_){const Z={M:2,L:2,Q:4,C:6,Z:0},te={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},ne=1,ie=2,oe=4,se=8,ae=16,le=32;let ce;function fe(Re){if(!ce){const we={R:ie,L:ne,D:oe,C:ae,U:le,T:se};ce=new Map;for(let Pe in te){let Ie=0;te[Pe].split(",").forEach($e=>{let[Ue,ke]=$e.split("+");Ue=parseInt(Ue,36),ke=ke?parseInt(ke,36):0,ce.set(Ie+=Ue,we[Pe]);for(let Ge=ke;Ge--;)ce.set(++Ie,we[Pe])})}}return ce.get(Re)||le}const de=1,pe=2,he=3,ge=4,me=[null,"isol","init","fina","medi"];function Ae(Re){const we=new Uint8Array(Re.length);let Pe=le,Ie=de,$e=-1;for(let Ue=0;Ue<Re.length;Ue++){const ke=Re.codePointAt(Ue);let Ge=fe(ke)|0,He=de;Ge&se||(Pe&(ne|oe|ae)?Ge&(ie|oe|ae)?(He=he,(Ie===de||Ie===he)&&we[$e]++):Ge&(ne|le)&&(Ie===pe||Ie===ge)&&we[$e]--:Pe&(ie|le)&&(Ie===pe||Ie===ge)&&we[$e]--,Ie=we[Ue]=He,Pe=Ge,$e=Ue,ke>65535&&Ue++)}return we}function ye(Re,we){const Pe=[];for(let $e=0;$e<we.length;$e++){const Ue=we.codePointAt($e);Ue>65535&&$e++,Pe.push(K.U.codeToGlyph(Re,Ue))}const Ie=Re.GSUB;if(Ie){const{lookupList:$e,featureList:Ue}=Ie;let ke;const Ge=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,He=[];Ue.forEach(ze=>{if(Ge.test(ze.tag))for(let Ke=0;Ke<ze.tab.length;Ke++){if(He[ze.tab[Ke]])continue;He[ze.tab[Ke]]=!0;const tt=$e[ze.tab[Ke]],Je=/^(isol|init|fina|medi)$/.test(ze.tag);Je&&!ke&&(ke=Ae(we));for(let ot=0;ot<Pe.length;ot++)(!ke||!Je||me[ke[ot]]===ze.tag)&&K.U._applySubs(Pe,ot,tt,$e)}})}return Pe}function ve(Re,we){const Pe=new Int16Array(we.length*3);let Ie=0;for(;Ie<we.length;Ie++){const Ge=we[Ie];if(Ge===-1)continue;Pe[Ie*3+2]=Re.hmtx.aWidth[Ge];const He=Re.GPOS;if(He){const ze=He.lookupList;for(let Ke=0;Ke<ze.length;Ke++){const tt=ze[Ke];for(let Je=0;Je<tt.tabs.length;Je++){const ot=tt.tabs[Je];if(tt.ltype===1){if(K._lctf.coverageIndex(ot.coverage,Ge)!==-1&&ot.pos){ke(ot.pos,Ie);break}}else if(tt.ltype===2){let Fe=null,ct=$e();if(ct!==-1){const ht=K._lctf.coverageIndex(ot.coverage,we[ct]);if(ht!==-1){if(ot.fmt===1){const lt=ot.pairsets[ht];for(let Qe=0;Qe<lt.length;Qe++)lt[Qe].gid2===Ge&&(Fe=lt[Qe])}else if(ot.fmt===2){const lt=K.U._getGlyphClass(we[ct],ot.classDef1),Qe=K.U._getGlyphClass(Ge,ot.classDef2);Fe=ot.matrix[lt][Qe]}if(Fe){Fe.val1&&ke(Fe.val1,ct),Fe.val2&&ke(Fe.val2,Ie);break}}}}else if(tt.ltype===4){const Fe=K._lctf.coverageIndex(ot.markCoverage,Ge);if(Fe!==-1){const ct=$e(Ue),ht=ct===-1?-1:K._lctf.coverageIndex(ot.baseCoverage,we[ct]);if(ht!==-1){const lt=ot.markArray[Fe],Qe=ot.baseArray[ht][lt.markClass];Pe[Ie*3]=Qe.x-lt.x+Pe[ct*3]-Pe[ct*3+2],Pe[Ie*3+1]=Qe.y-lt.y+Pe[ct*3+1];break}}}else if(tt.ltype===6){const Fe=K._lctf.coverageIndex(ot.mark1Coverage,Ge);if(Fe!==-1){const ct=$e();if(ct!==-1){const ht=we[ct];if(_e(Re,ht)===3){const lt=K._lctf.coverageIndex(ot.mark2Coverage,ht);if(lt!==-1){const Qe=ot.mark1Array[Fe],Ze=ot.mark2Array[lt][Qe.markClass];Pe[Ie*3]=Ze.x-Qe.x+Pe[ct*3]-Pe[ct*3+2],Pe[Ie*3+1]=Ze.y-Qe.y+Pe[ct*3+1];break}}}}}}}}else if(Re.kern&&!Re.cff){const ze=$e();if(ze!==-1){const Ke=Re.kern.glyph1.indexOf(we[ze]);if(Ke!==-1){const tt=Re.kern.rval[Ke].glyph2.indexOf(Ge);tt!==-1&&(Pe[ze*3+2]+=Re.kern.rval[Ke].vals[tt])}}}}return Pe;function $e(Ge){for(let He=Ie-1;He>=0;He--)if(we[He]!==-1&&(!Ge||Ge(we[He])))return He;return-1}function Ue(Ge){return _e(Re,Ge)===1}function ke(Ge,He){for(let ze=0;ze<3;ze++)Pe[He*3+ze]+=Ge[ze]||0}}function _e(Re,we){const Pe=Re.GDEF&&Re.GDEF.glyphClassDef;return Pe?K.U._getGlyphClass(we,Pe):0}function Te(...Re){for(let we=0;we<Re.length;we++)if(typeof Re[we]=="number")return Re[we]}function be(Re){const we=Object.create(null),Pe=Re["OS/2"],Ie=Re.hhea,$e=Re.head.unitsPerEm,Ue=Te(Pe&&Pe.sTypoAscender,Ie&&Ie.ascender,$e),ke={unitsPerEm:$e,ascender:Ue,descender:Te(Pe&&Pe.sTypoDescender,Ie&&Ie.descender,0),capHeight:Te(Pe&&Pe.sCapHeight,Ue),xHeight:Te(Pe&&Pe.sxHeight,Ue),lineGap:Te(Pe&&Pe.sTypoLineGap,Ie&&Ie.lineGap),supportsCodePoint(Ge){return K.U.codeToGlyph(Re,Ge)>0},forEachGlyph(Ge,He,ze,Ke){let tt=0;const Je=1/ke.unitsPerEm*He,ot=ye(Re,Ge);let Fe=0;const ct=ve(Re,ot);return ot.forEach((ht,lt)=>{if(ht!==-1){let Qe=we[ht];if(!Qe){const{cmds:Ze,crds:it}=K.U.glyphToPath(Re,ht);let nt="",Tt=0;for(let yt=0,Ut=Ze.length;yt<Ut;yt++){const bt=Z[Ze[yt]];nt+=Ze[yt];for(let Ot=1;Ot<=bt;Ot++)nt+=(Ot>1?",":"")+it[Tt++]}let St,Et,Nt,zt;if(it.length){St=Et=1/0,Nt=zt=-1/0;for(let yt=0,Ut=it.length;yt<Ut;yt+=2){let bt=it[yt],Ot=it[yt+1];bt<St&&(St=bt),Ot<Et&&(Et=Ot),bt>Nt&&(Nt=bt),Ot>zt&&(zt=Ot)}}else St=Nt=Et=zt=0;Qe=we[ht]={index:ht,advanceWidth:Re.hmtx.aWidth[ht],xMin:St,yMin:Et,xMax:Nt,yMax:zt,path:nt}}Ke.call(null,Qe,tt+ct[lt*3]*Je,ct[lt*3+1]*Je,Fe),tt+=ct[lt*3+2]*Je,ze&&(tt+=ze*He)}Fe+=Ge.codePointAt(Fe)>65535?2:1}),tt}};return ke}return function(we){const Pe=new Uint8Array(we,0,4),Ie=K._bin.readASCII(Pe,0,4);if(Ie==="wOFF")we=_(we);else if(Ie==="wOF2")throw new Error("woff2 fonts not supported");return be(K.parse(we)[0])}}const workerModule=defineWorkerModule({name:"Typr Font Parser",dependencies:[typrFactory,woff2otfFactory,parserFactory],init(K,_,Z){const te=K(),ne=_();return Z(te,ne)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function unicodeFontResolverClientFactory(){return function(K){var _=function(){this.buckets=new Map};_.prototype.add=function(ve){var _e=ve>>5;this.buckets.set(_e,(this.buckets.get(_e)||0)|1<<(31&ve))},_.prototype.has=function(ve){var _e=this.buckets.get(ve>>5);return _e!==void 0&&(_e&1<<(31&ve))!=0},_.prototype.serialize=function(){var ve=[];return this.buckets.forEach(function(_e,Te){ve.push((+Te).toString(36)+":"+_e.toString(36))}),ve.join(",")},_.prototype.deserialize=function(ve){var _e=this;this.buckets.clear(),ve.split(",").forEach(function(Te){var be=Te.split(":");_e.buckets.set(parseInt(be[0],36),parseInt(be[1],36))})};var Z=Math.pow(2,8),te=Z-1,ne=~te;function ie(ve){var _e=function(be){return be&ne}(ve).toString(16),Te=function(be){return(be&ne)+Z-1}(ve).toString(16);return"codepoint-index/plane"+(ve>>16)+"/"+_e+"-"+Te+".json"}function oe(ve,_e){var Te=ve&te,be=_e.codePointAt(Te/6|0);return((be=(be||48)-48)&1<<Te%6)!=0}function se(ve,_e){var Te;(Te=ve,Te.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(be){return be.split("-").map(function(Re){return parseInt(Re.trim(),16)})})).forEach(function(be){var Re=be[0],we=be[1];we===void 0&&(we=Re),_e(Re,we)})}function ae(ve,_e){se(ve,function(Te,be){for(var Re=Te;Re<=be;Re++)_e(Re)})}var le={},ce={},fe=new WeakMap,de="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function pe(ve){var _e=fe.get(ve);return _e||(_e=new _,ae(ve.ranges,function(Te){return _e.add(Te)}),fe.set(ve,_e)),_e}var he,ge=new Map;function me(ve,_e,Te){return ve[_e]?_e:ve[Te]?Te:function(be){for(var Re in be)return Re}(ve)}function Ae(ve,_e){var Te=_e;if(!ve.includes(Te)){Te=1/0;for(var be=0;be<ve.length;be++)Math.abs(ve[be]-_e)<Math.abs(Te-_e)&&(Te=ve[be])}return Te}function ye(ve){return he||(he=new Set,ae("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(_e){he.add(_e)})),he.has(ve)}return K.CodePointSet=_,K.clearCache=function(){le={},ce={}},K.getFontsForString=function(ve,_e){_e===void 0&&(_e={});var Te,be=_e.lang;be===void 0&&(be=new RegExp("\\p{Script=Hangul}","u").test(Te=ve)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(Te)?"ja":"en");var Re=_e.category;Re===void 0&&(Re="sans-serif");var we=_e.style;we===void 0&&(we="normal");var Pe=_e.weight;Pe===void 0&&(Pe=400);var Ie=(_e.dataUrl||de).replace(/\/$/g,""),$e=new Map,Ue=new Uint8Array(ve.length),ke={},Ge={},He=new Array(ve.length),ze=new Map,Ke=!1;function tt(Fe){var ct=ge.get(Fe);return ct||(ct=fetch(Ie+"/"+Fe).then(function(ht){if(!ht.ok)throw new Error(ht.statusText);return ht.json().then(function(lt){if(!Array.isArray(lt)||lt[0]!==1)throw new Error("Incorrect schema version; need 1, got "+lt[0]);return lt[1]})}).catch(function(ht){if(Ie!==de)return Ke||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+Ie+'", trying default CDN. '+ht.message),Ke=!0),Ie=de,ge.delete(Fe),tt(Fe);throw ht}),ge.set(Fe,ct)),ct}for(var Je=function(Fe){var ct=ve.codePointAt(Fe),ht=ie(ct);He[Fe]=ht,le[ht]||ze.has(ht)||ze.set(ht,tt(ht).then(function(lt){le[ht]=lt})),ct>65535&&(Fe++,ot=Fe)},ot=0;ot<ve.length;ot++)Je(ot);return Promise.all(ze.values()).then(function(){ze.clear();for(var Fe=function(ht){var lt=ve.codePointAt(ht),Qe=null,Ze=le[He[ht]],it=void 0;for(var nt in Ze){var Tt=Ge[nt];if(Tt===void 0&&(Tt=Ge[nt]=new RegExp(nt).test(be||"en")),Tt){for(var St in it=nt,Ze[nt])if(oe(lt,Ze[nt][St])){Qe=St;break}break}}if(!Qe){e:for(var Et in Ze)if(Et!==it){for(var Nt in Ze[Et])if(oe(lt,Ze[Et][Nt])){Qe=Nt;break e}}}Qe||(console.debug("No font coverage for U+"+lt.toString(16)),Qe="latin"),He[ht]=Qe,ce[Qe]||ze.has(Qe)||ze.set(Qe,tt("font-meta/"+Qe+".json").then(function(zt){ce[Qe]=zt})),lt>65535&&(ht++,ct=ht)},ct=0;ct<ve.length;ct++)Fe(ct);return Promise.all(ze.values())}).then(function(){for(var Fe,ct=null,ht=0;ht<ve.length;ht++){var lt=ve.codePointAt(ht);if(ct&&(ye(lt)||pe(ct).has(lt)))Ue[ht]=Ue[ht-1];else{ct=ce[He[ht]];var Qe=ke[ct.id];if(!Qe){var Ze=ct.typeforms,it=me(Ze,Re,"sans-serif"),nt=me(Ze[it],we,"normal"),Tt=Ae((Fe=Ze[it])===null||Fe===void 0?void 0:Fe[nt],Pe);Qe=ke[ct.id]=Ie+"/font-files/"+ct.id+"/"+it+"."+nt+"."+Tt+".woff"}var St=$e.get(Qe);St==null&&(St=$e.size,$e.set(Qe,St)),Ue[ht]=St}lt>65535&&(ht++,Ue[ht]=Ue[ht-1])}return{fontUrls:Array.from($e.keys()),chars:Ue}})},Object.defineProperty(K,"__esModule",{value:!0}),K}({})}function createFontResolver(K,_){const Z=Object.create(null),te=Object.create(null);function ne(oe,se){const ae=le=>{console.error(`Failure loading font ${oe}`,le)};try{const le=new XMLHttpRequest;le.open("get",oe,!0),le.responseType="arraybuffer",le.onload=function(){if(le.status>=400)ae(new Error(le.statusText));else if(le.status>0)try{const ce=K(le.response);ce.src=oe,se(ce)}catch(ce){ae(ce)}},le.onerror=ae,le.send()}catch(le){ae(le)}}function ie(oe,se){let ae=Z[oe];ae?se(ae):te[oe]?te[oe].push(se):(te[oe]=[se],ne(oe,le=>{le.src=oe,Z[oe]=le,te[oe].forEach(ce=>ce(le)),delete te[oe]}))}return function(oe,se,{lang:ae,fonts:le=[],style:ce="normal",weight:fe="normal",unicodeFontsURL:de}={}){const pe=new Uint8Array(oe.length),he=[];oe.length||ye();const ge=new Map,me=[];if(ce!=="italic"&&(ce="normal"),typeof fe!="number"&&(fe=fe==="bold"?700:400),le&&!Array.isArray(le)&&(le=[le]),le=le.slice().filter(_e=>!_e.lang||_e.lang.test(ae)).reverse(),le.length){let Re=0;(function we(Pe=0){for(let Ie=Pe,$e=oe.length;Ie<$e;Ie++){const Ue=oe.codePointAt(Ie);if(Re===1&&he[pe[Ie-1]].supportsCodePoint(Ue)||Ie>0&&/\s/.test(oe[Ie]))pe[Ie]=pe[Ie-1],Re===2&&(me[me.length-1][1]=Ie);else for(let ke=pe[Ie],Ge=le.length;ke<=Ge;ke++)if(ke===Ge){const He=Re===2?me[me.length-1]:me[me.length]=[Ie,Ie];He[1]=Ie,Re=2}else{pe[Ie]=ke;const{src:He,unicodeRange:ze}=le[ke];if(!ze||ve(Ue,ze)){const Ke=Z[He];if(!Ke){ie(He,()=>{we(Ie)});return}if(Ke.supportsCodePoint(Ue)){let tt=ge.get(Ke);typeof tt!="number"&&(tt=he.length,he.push(Ke),ge.set(Ke,tt)),pe[Ie]=tt,Re=1;break}}}Ue>65535&&Ie+1<$e&&(pe[Ie+1]=pe[Ie],Ie++,Re===2&&(me[me.length-1][1]=Ie))}Ae()})()}else me.push([0,oe.length-1]),Ae();function Ae(){if(me.length){const _e=me.map(Te=>oe.substring(Te[0],Te[1]+1)).join(`
`);_.getFontsForString(_e,{lang:ae||void 0,style:ce,weight:fe,dataUrl:de}).then(({fontUrls:Te,chars:be})=>{const Re=he.length;let we=0;me.forEach(Ie=>{for(let $e=0,Ue=Ie[1]-Ie[0];$e<=Ue;$e++)pe[Ie[0]+$e]=be[we++]+Re;we++});let Pe=0;Te.forEach((Ie,$e)=>{ie(Ie,Ue=>{he[$e+Re]=Ue,++Pe===Te.length&&ye()})})})}else ye()}function ye(){se({chars:pe,fonts:he})}function ve(_e,Te){for(let be=0;be<Te.length;be++){const[Re,we=Re]=Te[be];if(Re<=_e&&_e<=we)return!0}return!1}}}const fontResolverWorkerModule=defineWorkerModule({name:"FontResolver",dependencies:[createFontResolver,workerModule,unicodeFontResolverClientFactory],init(K,_,Z){return K(_,Z())}});function createTypesetter(K,_){const te=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,ne="[^\\S\\u00A0]",ie=new RegExp(`${ne}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function oe({text:he,lang:ge,fonts:me,style:Ae,weight:ye,preResolvedFonts:ve,unicodeFontsURL:_e},Te){const be=({chars:Re,fonts:we})=>{let Pe,Ie;const $e=[];for(let Ue=0;Ue<Re.length;Ue++)Re[Ue]!==Ie?(Ie=Re[Ue],$e.push(Pe={start:Ue,end:Ue,fontObj:we[Re[Ue]]})):Pe.end=Ue;Te($e)};ve?be(ve):K(he,be,{lang:ge,fonts:me,style:Ae,weight:ye,unicodeFontsURL:_e})}function se({text:he="",font:ge,lang:me,sdfGlyphSize:Ae=64,fontSize:ye=400,fontWeight:ve=1,fontStyle:_e="normal",letterSpacing:Te=0,lineHeight:be="normal",maxWidth:Re=1/0,direction:we,textAlign:Pe="left",textIndent:Ie=0,whiteSpace:$e="normal",overflowWrap:Ue="normal",anchorX:ke=0,anchorY:Ge=0,metricsOnly:He=!1,unicodeFontsURL:ze,preResolvedFonts:Ke=null,includeCaretPositions:tt=!1,chunkedBoundsSize:Je=8192,colorRanges:ot=null},Fe){const ct=fe(),ht={fontLoad:0,typesetting:0};he.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),he=he.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),ye=+ye,Te=+Te,Re=+Re,be=be||"normal",Ie=+Ie,oe({text:he,lang:me,style:_e,weight:ve,fonts:typeof ge=="string"?[{src:ge}]:ge,unicodeFontsURL:ze,preResolvedFonts:Ke},lt=>{ht.fontLoad=fe()-ct;const Qe=isFinite(Re);let Ze=null,it=null,nt=null,Tt=null,St=null,Et=null,Nt=null,zt=null,yt=0,Ut=0,bt=$e!=="nowrap";const Ot=new Map,Mt=fe();let _t=Ie,pt=0,ft=new de;const st=[ft];lt.forEach(Le=>{const{fontObj:De}=Le,{ascender:Be,descender:rt,unitsPerEm:at,lineGap:xt,capHeight:Ct,xHeight:Qt}=De;let qt=Ot.get(De);if(!qt){const Ht=ye/at,Yt=be==="normal"?(Be-rt+xt)*Ht:be*ye,hn=(Yt-(Be-rt)*Ht)/2,_n=Math.min(Yt,(Be-rt)*Ht),xn=(Be+rt)/2*Ht+_n/2;qt={index:Ot.size,src:De.src,fontObj:De,fontSizeMult:Ht,unitsPerEm:at,ascender:Be*Ht,descender:rt*Ht,capHeight:Ct*Ht,xHeight:Qt*Ht,lineHeight:Yt,baseline:-hn-Be*Ht,caretTop:xn,caretBottom:xn-_n},Ot.set(De,qt)}const{fontSizeMult:It}=qt,Gt=he.slice(Le.start,Le.end+1);let Jt,kt;De.forEachGlyph(Gt,ye,Te,(Ht,Yt,hn,_n)=>{Yt+=pt,_n+=Le.start,Jt=Yt,kt=Ht;const xn=he.charAt(_n),Ln=Ht.advanceWidth*It,Vn=ft.count;let kn;if("isEmpty"in Ht||(Ht.isWhitespace=!!xn&&new RegExp(ne).test(xn),Ht.canBreakAfter=!!xn&&ie.test(xn),Ht.isEmpty=Ht.xMin===Ht.xMax||Ht.yMin===Ht.yMax||te.test(xn)),!Ht.isWhitespace&&!Ht.isEmpty&&Ut++,bt&&Qe&&!Ht.isWhitespace&&Yt+Ln+_t>Re&&Vn){if(ft.glyphAt(Vn-1).glyphObj.canBreakAfter)kn=new de,_t=-Yt;else for(let or=Vn;or--;)if(or===0&&Ue==="break-word"){kn=new de,_t=-Yt;break}else if(ft.glyphAt(or).glyphObj.canBreakAfter){kn=ft.splitAt(or+1);const pr=kn.glyphAt(0).x;_t-=pr;for(let vr=kn.count;vr--;)kn.glyphAt(vr).x-=pr;break}kn&&(ft.isSoftWrapped=!0,ft=kn,st.push(ft),yt=Re)}let Rn=ft.glyphAt(ft.count);Rn.glyphObj=Ht,Rn.x=Yt+_t,Rn.y=hn,Rn.width=Ln,Rn.charIndex=_n,Rn.fontData=qt,xn===`
`&&(ft=new de,st.push(ft),_t=-(Yt+Ln+Te*ye)+Ie)}),pt=Jt+kt.advanceWidth*It+Te*ye});let vt=0;st.forEach(Le=>{let De=!0;for(let Be=Le.count;Be--;){const rt=Le.glyphAt(Be);De&&!rt.glyphObj.isWhitespace&&(Le.width=rt.x+rt.width,Le.width>yt&&(yt=Le.width),De=!1);let{lineHeight:at,capHeight:xt,xHeight:Ct,baseline:Qt}=rt.fontData;at>Le.lineHeight&&(Le.lineHeight=at);const qt=Qt-Le.baseline;qt<0&&(Le.baseline+=qt,Le.cap+=qt,Le.ex+=qt),Le.cap=Math.max(Le.cap,Le.baseline+xt),Le.ex=Math.max(Le.ex,Le.baseline+Ct)}Le.baseline-=vt,Le.cap-=vt,Le.ex-=vt,vt+=Le.lineHeight});let Pt=0,Lt=0;if(ke&&(typeof ke=="number"?Pt=-ke:typeof ke=="string"&&(Pt=-yt*(ke==="left"?0:ke==="center"?.5:ke==="right"?1:le(ke)))),Ge&&(typeof Ge=="number"?Lt=-Ge:typeof Ge=="string"&&(Lt=Ge==="top"?0:Ge==="top-baseline"?-st[0].baseline:Ge==="top-cap"?-st[0].cap:Ge==="top-ex"?-st[0].ex:Ge==="middle"?vt/2:Ge==="bottom"?vt:Ge==="bottom-baseline"?-st[st.length-1].baseline:le(Ge)*vt)),!He){const Le=_.getEmbeddingLevels(he,we);Ze=new Uint16Array(Ut),it=new Uint8Array(Ut),nt=new Float32Array(Ut*2),Tt={},Nt=[1/0,1/0,-1/0,-1/0],zt=[],tt&&(Et=new Float32Array(he.length*4)),ot&&(St=new Uint8Array(Ut*3));let De=0,Be=-1,rt=-1,at,xt;if(st.forEach((Ct,Qt)=>{let{count:qt,width:It}=Ct;if(qt>0){let Gt=0;for(let _n=qt;_n--&&Ct.glyphAt(_n).glyphObj.isWhitespace;)Gt++;let Jt=0,kt=0;if(Pe==="center")Jt=(yt-It)/2;else if(Pe==="right")Jt=yt-It;else if(Pe==="justify"&&Ct.isSoftWrapped){let _n=0;for(let xn=qt-Gt;xn--;)Ct.glyphAt(xn).glyphObj.isWhitespace&&_n++;kt=(yt-It)/_n}if(kt||Jt){let _n=0;for(let xn=0;xn<qt;xn++){let Ln=Ct.glyphAt(xn);const Vn=Ln.glyphObj;Ln.x+=Jt+_n,kt!==0&&Vn.isWhitespace&&xn<qt-Gt&&(_n+=kt,Ln.width+=kt)}}const Ht=_.getReorderSegments(he,Le,Ct.glyphAt(0).charIndex,Ct.glyphAt(Ct.count-1).charIndex);for(let _n=0;_n<Ht.length;_n++){const[xn,Ln]=Ht[_n];let Vn=1/0,kn=-1/0;for(let Rn=0;Rn<qt;Rn++)if(Ct.glyphAt(Rn).charIndex>=xn){let or=Rn,pr=Rn;for(;pr<qt;pr++){let vr=Ct.glyphAt(pr);if(vr.charIndex>Ln)break;pr<qt-Gt&&(Vn=Math.min(Vn,vr.x),kn=Math.max(kn,vr.x+vr.width))}for(let vr=or;vr<pr;vr++){const Nr=Ct.glyphAt(vr);Nr.x=kn-(Nr.x+Nr.width-Vn)}break}}let Yt;const hn=_n=>Yt=_n;for(let _n=0;_n<qt;_n++){const xn=Ct.glyphAt(_n);Yt=xn.glyphObj;const Ln=Yt.index,Vn=Le.levels[xn.charIndex]&1;if(Vn){const kn=_.getMirroredCharacter(he[xn.charIndex]);kn&&xn.fontData.fontObj.forEachGlyph(kn,0,0,hn)}if(tt){const{charIndex:kn,fontData:Rn}=xn,or=xn.x+Pt,pr=xn.x+xn.width+Pt;Et[kn*4]=Vn?pr:or,Et[kn*4+1]=Vn?or:pr,Et[kn*4+2]=Ct.baseline+Rn.caretBottom+Lt,Et[kn*4+3]=Ct.baseline+Rn.caretTop+Lt;const vr=kn-Be;vr>1&&ce(Et,Be,vr),Be=kn}if(ot){const{charIndex:kn}=xn;for(;kn>rt;)rt++,ot.hasOwnProperty(rt)&&(xt=ot[rt])}if(!Yt.isWhitespace&&!Yt.isEmpty){const kn=De++,{fontSizeMult:Rn,src:or,index:pr}=xn.fontData,vr=Tt[or]||(Tt[or]={});vr[Ln]||(vr[Ln]={path:Yt.path,pathBounds:[Yt.xMin,Yt.yMin,Yt.xMax,Yt.yMax]});const Nr=xn.x+Pt,Sr=xn.y+Ct.baseline+Lt;nt[kn*2]=Nr,nt[kn*2+1]=Sr;const Pr=Nr+Yt.xMin*Rn,Dr=Sr+Yt.yMin*Rn,Cr=Nr+Yt.xMax*Rn,Kn=Sr+Yt.yMax*Rn;Pr<Nt[0]&&(Nt[0]=Pr),Dr<Nt[1]&&(Nt[1]=Dr),Cr>Nt[2]&&(Nt[2]=Cr),Kn>Nt[3]&&(Nt[3]=Kn),kn%Je===0&&(at={start:kn,end:kn,rect:[1/0,1/0,-1/0,-1/0]},zt.push(at)),at.end++;const Er=at.rect;if(Pr<Er[0]&&(Er[0]=Pr),Dr<Er[1]&&(Er[1]=Dr),Cr>Er[2]&&(Er[2]=Cr),Kn>Er[3]&&(Er[3]=Kn),Ze[kn]=Ln,it[kn]=pr,ot){const $r=kn*3;St[$r]=xt>>16&255,St[$r+1]=xt>>8&255,St[$r+2]=xt&255}}}}}),Et){const Ct=he.length-Be;Ct>1&&ce(Et,Be,Ct)}}const Vt=[];Ot.forEach(({index:Le,src:De,unitsPerEm:Be,ascender:rt,descender:at,lineHeight:xt,capHeight:Ct,xHeight:Qt})=>{Vt[Le]={src:De,unitsPerEm:Be,ascender:rt,descender:at,lineHeight:xt,capHeight:Ct,xHeight:Qt}}),ht.typesetting=fe()-Mt,Fe({glyphIds:Ze,glyphFontIndices:it,glyphPositions:nt,glyphData:Tt,fontData:Vt,caretPositions:Et,glyphColors:St,chunkedBounds:zt,fontSize:ye,topBaseline:Lt+st[0].baseline,blockBounds:[Pt,Lt-vt,Pt+yt,Lt],visibleBounds:Nt,timings:ht})})}function ae(he,ge){se({...he,metricsOnly:!0},me=>{const[Ae,ye,ve,_e]=me.blockBounds;ge({width:ve-Ae,height:_e-ye})})}function le(he){let ge=he.match(/^([\d.]+)%$/),me=ge?parseFloat(ge[1]):NaN;return isNaN(me)?0:me/100}function ce(he,ge,me){const Ae=he[ge*4],ye=he[ge*4+1],ve=he[ge*4+2],_e=he[ge*4+3],Te=(ye-Ae)/me;for(let be=0;be<me;be++){const Re=(ge+be)*4;he[Re]=Ae+Te*be,he[Re+1]=Ae+Te*(be+1),he[Re+2]=ve,he[Re+3]=_e}}function fe(){return(self.performance||Date).now()}function de(){this.data=[]}const pe=["glyphObj","x","y","width","charIndex","fontData"];return de.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/pe.length)},glyphAt(he){let ge=de.flyweight;return ge.data=this.data,ge.index=he,ge},splitAt(he){let ge=new de;return ge.data=this.data.splice(he*pe.length),ge}},de.flyweight=pe.reduce((he,ge,me,Ae)=>(Object.defineProperty(he,ge,{get(){return this.data[this.index*pe.length+me]},set(ye){this.data[this.index*pe.length+me]=ye}}),he),{data:null,index:0}),{typeset:se,measure:ae}}const now=()=>(self.performance||Date).now(),mainThreadGenerator=SDFGenerator();let warned;function generateSDF(K,_,Z,te,ne,ie,oe,se,ae,le,ce=!0){return ce?generateSDF_GL(K,_,Z,te,ne,ie,oe,se,ae,le).then(null,fe=>(warned||(console.warn("WebGL SDF generation failed, falling back to JS",fe),warned=!0),generateSDF_JS_Worker(K,_,Z,te,ne,ie,oe,se,ae,le))):generateSDF_JS_Worker(K,_,Z,te,ne,ie,oe,se,ae,le)}const queue=[],chunkTimeBudget=5;let timer=0;function nextChunk(){const K=now();for(;queue.length&&now()-K<chunkTimeBudget;)queue.shift()();timer=queue.length?setTimeout(nextChunk,0):0}const generateSDF_GL=(...K)=>new Promise((_,Z)=>{queue.push(()=>{const te=now();try{mainThreadGenerator.webgl.generateIntoCanvas(...K),_({timing:now()-te})}catch(ne){Z(ne)}}),timer||(timer=setTimeout(nextChunk,0))}),threadCount=4,idleTimeout=2e3,threads={};let callNum=0;function generateSDF_JS_Worker(K,_,Z,te,ne,ie,oe,se,ae,le){const ce="TroikaTextSDFGenerator_JS_"+callNum++%threadCount;let fe=threads[ce];return fe||(fe=threads[ce]={workerModule:defineWorkerModule({name:ce,workerId:ce,dependencies:[SDFGenerator,now],init(de,pe){const he=de().javascript.generate;return function(...ge){const me=pe();return{textureData:he(...ge),timing:pe()-me}}},getTransferables(de){return[de.textureData.buffer]}}),requests:0,idleTimer:null}),fe.requests++,clearTimeout(fe.idleTimer),fe.workerModule(K,_,Z,te,ne,ie).then(({textureData:de,timing:pe})=>{const he=now(),ge=new Uint8Array(de.length*4);for(let me=0;me<de.length;me++)ge[me*4+le]=de[me];return mainThreadGenerator.webglUtils.renderImageData(oe,ge,se,ae,K,_,1<<3-le),pe+=now()-he,--fe.requests===0&&(fe.idleTimer=setTimeout(()=>{terminateWorker(ce)},idleTimeout)),{timing:pe}})}function warmUpSDFCanvas(K){K._warm||(mainThreadGenerator.webgl.isSupported(K),K._warm=!0)}const resizeWebGLCanvasWithoutClearing=mainThreadGenerator.webglUtils.resizeWebGLCanvasWithoutClearing,CONFIG={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},tempColor=new Color$1;function now$1(){return(self.performance||Date).now()}const atlases=Object.create(null);function getTextRenderInfo(K,_){K=assign$8({},K);const Z=now$1(),te=[];if(K.font&&te.push({label:"user",src:toAbsoluteURL(K.font)}),K.font=te,K.text=""+K.text,K.sdfGlyphSize=K.sdfGlyphSize||CONFIG.sdfGlyphSize,K.unicodeFontsURL=K.unicodeFontsURL||CONFIG.unicodeFontsURL,K.colorRanges!=null){let de={};for(let pe in K.colorRanges)if(K.colorRanges.hasOwnProperty(pe)){let he=K.colorRanges[pe];typeof he!="number"&&(he=tempColor.set(he).getHex()),de[pe]=he}K.colorRanges=de}Object.freeze(K);const{textureWidth:ne,sdfExponent:ie}=CONFIG,{sdfGlyphSize:oe}=K,se=ne/oe*4;let ae=atlases[oe];if(!ae){const de=document.createElement("canvas");de.width=ne,de.height=oe*256/se,ae=atlases[oe]={glyphCount:0,sdfGlyphSize:oe,sdfCanvas:de,sdfTexture:new Texture$1(de,void 0,void 0,void 0,LinearFilter,LinearFilter),contextLost:!1,glyphsByFont:new Map},ae.sdfTexture.generateMipmaps=!1,initContextLossHandling(ae)}const{sdfTexture:le,sdfCanvas:ce}=ae;typesetInWorker(K).then(de=>{const{glyphIds:pe,glyphFontIndices:he,fontData:ge,glyphPositions:me,fontSize:Ae,timings:ye}=de,ve=[],_e=new Float32Array(pe.length*4);let Te=0,be=0;const Re=now$1(),we=ge.map(ke=>{let Ge=ae.glyphsByFont.get(ke.src);return Ge||ae.glyphsByFont.set(ke.src,Ge=new Map),Ge});pe.forEach((ke,Ge)=>{const He=he[Ge],{src:ze,unitsPerEm:Ke}=ge[He];let tt=we[He].get(ke);if(!tt){const{path:ht,pathBounds:lt}=de.glyphData[ze][ke],Qe=Math.max(lt[2]-lt[0],lt[3]-lt[1])/oe*(CONFIG.sdfMargin*oe+.5),Ze=ae.glyphCount++,it=[lt[0]-Qe,lt[1]-Qe,lt[2]+Qe,lt[3]+Qe];we[He].set(ke,tt={path:ht,atlasIndex:Ze,sdfViewBox:it}),ve.push(tt)}const{sdfViewBox:Je}=tt,ot=me[be++],Fe=me[be++],ct=Ae/Ke;_e[Te++]=ot+Je[0]*ct,_e[Te++]=Fe+Je[1]*ct,_e[Te++]=ot+Je[2]*ct,_e[Te++]=Fe+Je[3]*ct,pe[Ge]=tt.atlasIndex}),ye.quads=(ye.quads||0)+(now$1()-Re);const Pe=now$1();ye.sdf={};const Ie=ce.height,$e=Math.ceil(ae.glyphCount/se),Ue=Math.pow(2,Math.ceil(Math.log2($e*oe)));Ue>Ie&&(console.info(`Increasing SDF texture size ${Ie}->${Ue}`),resizeWebGLCanvasWithoutClearing(ce,ne,Ue),le.dispose()),Promise.all(ve.map(ke=>generateGlyphSDF(ke,ae,K.gpuAccelerateSDF).then(({timing:Ge})=>{ye.sdf[ke.atlasIndex]=Ge}))).then(()=>{ve.length&&!ae.contextLost&&(safariPre15Workaround(ae),le.needsUpdate=!0),ye.sdfTotal=now$1()-Pe,ye.total=now$1()-Z,_(Object.freeze({parameters:K,sdfTexture:le,sdfGlyphSize:oe,sdfExponent:ie,glyphBounds:_e,glyphAtlasIndices:pe,glyphColors:de.glyphColors,caretPositions:de.caretPositions,chunkedBounds:de.chunkedBounds,ascender:de.ascender,descender:de.descender,lineHeight:de.lineHeight,capHeight:de.capHeight,xHeight:de.xHeight,topBaseline:de.topBaseline,blockBounds:de.blockBounds,visibleBounds:de.visibleBounds,timings:de.timings}))})}),Promise.resolve().then(()=>{ae.contextLost||warmUpSDFCanvas(ce)})}function generateGlyphSDF({path:K,atlasIndex:_,sdfViewBox:Z},{sdfGlyphSize:te,sdfCanvas:ne,contextLost:ie},oe){if(ie)return Promise.resolve({timing:-1});const{textureWidth:se,sdfExponent:ae}=CONFIG,le=Math.max(Z[2]-Z[0],Z[3]-Z[1]),ce=Math.floor(_/4),fe=ce%(se/te)*te,de=Math.floor(ce/(se/te))*te,pe=_%4;return generateSDF(te,te,K,Z,le,ae,ne,fe,de,pe,oe)}function initContextLossHandling(K){const _=K.sdfCanvas;_.addEventListener("webglcontextlost",Z=>{console.log("Context Lost",Z),Z.preventDefault(),K.contextLost=!0}),_.addEventListener("webglcontextrestored",Z=>{console.log("Context Restored",Z),K.contextLost=!1;const te=[];K.glyphsByFont.forEach(ne=>{ne.forEach(ie=>{te.push(generateGlyphSDF(ie,K,!0))})}),Promise.all(te).then(()=>{safariPre15Workaround(K),K.sdfTexture.needsUpdate=!0})})}function preloadFont({font:K,characters:_,sdfGlyphSize:Z},te){let ne=Array.isArray(_)?_.join(`
`):""+_;getTextRenderInfo({font:K,sdfGlyphSize:Z,text:ne},te)}function assign$8(K,_){for(let Z in _)_.hasOwnProperty(Z)&&(K[Z]=_[Z]);return K}let linkEl;function toAbsoluteURL(K){return linkEl||(linkEl=typeof document>"u"?{}:document.createElement("a")),linkEl.href=K,linkEl.href}function safariPre15Workaround(K){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:_,sdfTexture:Z}=K,{width:te,height:ne}=_,ie=K.sdfCanvas.getContext("webgl");let oe=Z.image.data;(!oe||oe.length!==te*ne*4)&&(oe=new Uint8Array(te*ne*4),Z.image={width:te,height:ne,data:oe},Z.flipY=!1,Z.isDataTexture=!0),ie.readPixels(0,0,te,ne,ie.RGBA,ie.UNSIGNED_BYTE,oe)}}const typesetterWorkerModule=defineWorkerModule({name:"Typesetter",dependencies:[createTypesetter,fontResolverWorkerModule,bidiFactory],init(K,_,Z){return K(_,Z())}}),typesetInWorker=defineWorkerModule({name:"Typesetter",dependencies:[typesetterWorkerModule],init(K){return function(_){return new Promise(Z=>{K.typeset(_,Z)})}},getTransferables(K){const _=[];for(let Z in K)K[Z]&&K[Z].buffer&&_.push(K[Z].buffer);return _}});typesetInWorker.onMainThread;const templateGeometries={};function getTemplateGeometry(K){let _=templateGeometries[K];return _||(_=templateGeometries[K]=new PlaneGeometry(1,1,K,K).translate(.5,.5,0)),_}const glyphBoundsAttrName="aTroikaGlyphBounds",glyphIndexAttrName="aTroikaGlyphIndex",glyphColorAttrName="aTroikaGlyphColor";class GlyphsGeometry extends InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Sphere$2,this.boundingBox=new Box3}computeBoundingSphere(){}computeBoundingBox(){}set detail(_){if(_!==this._detail){this._detail=_,(typeof _!="number"||_<1)&&(_=1);let Z=getTemplateGeometry(_);["position","normal","uv"].forEach(te=>{this.attributes[te]=Z.attributes[te].clone()}),this.setIndex(Z.getIndex().clone())}}get detail(){return this._detail}set curveRadius(_){_!==this._curveRadius&&(this._curveRadius=_,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(_,Z,te,ne,ie){this.updateAttributeData(glyphBoundsAttrName,_,4),this.updateAttributeData(glyphIndexAttrName,Z,1),this.updateAttributeData(glyphColorAttrName,ie,3),this._blockBounds=te,this._chunkedBounds=ne,this.instanceCount=Z.length,this._updateBounds()}_updateBounds(){const _=this._blockBounds;if(_){const{curveRadius:Z,boundingBox:te}=this;if(Z){const{PI:ne,floor:ie,min:oe,max:se,sin:ae,cos:le}=Math,ce=ne/2,fe=ne*2,de=Math.abs(Z),pe=_[0]/de,he=_[2]/de,ge=ie((pe+ce)/fe)!==ie((he+ce)/fe)?-de:oe(ae(pe)*de,ae(he)*de),me=ie((pe-ce)/fe)!==ie((he-ce)/fe)?de:se(ae(pe)*de,ae(he)*de),Ae=ie((pe+ne)/fe)!==ie((he+ne)/fe)?de*2:se(de-le(pe)*de,de-le(he)*de);te.min.set(ge,_[1],Z<0?-Ae:0),te.max.set(me,_[3],Z<0?0:Ae)}else te.min.set(_[0],_[1],0),te.max.set(_[2],_[3],0);te.getBoundingSphere(this.boundingSphere)}}applyClipRect(_){let Z=this.getAttribute(glyphIndexAttrName).count,te=this._chunkedBounds;if(te)for(let ne=te.length;ne--;){Z=te[ne].end;let ie=te[ne].rect;if(ie[1]<_.w&&ie[3]>_.y&&ie[0]<_.z&&ie[2]>_.x)break}this.instanceCount=Z}updateAttributeData(_,Z,te){const ne=this.getAttribute(_);Z?ne&&ne.array.length===Z.length?(ne.array.set(Z),ne.needsUpdate=!0):(this.setAttribute(_,new InstancedBufferAttribute(Z,te)),delete this._maxInstanceCount,this.dispose()):ne&&this.deleteAttribute(_)}}const VERTEX_DEFS=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,VERTEX_TRANSFORM=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,FRAGMENT_DEFS=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,FRAGMENT_TRANSFORM=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function createTextDerivedMaterial(K){const _=createDerivedMaterial(K,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Vector4(0,0,0,0)},uTroikaClipRect:{value:new Vector4(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Color$1},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:VERTEX_DEFS,vertexTransform:VERTEX_TRANSFORM,fragmentDefs:FRAGMENT_DEFS,fragmentColorTransform:FRAGMENT_TRANSFORM,customRewriter({vertexShader:Z,fragmentShader:te}){let ne=/\buniform\s+vec3\s+diffuse\b/;return ne.test(te)&&(te=te.replace(ne,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),ne.test(Z)||(Z=Z.replace(voidMainRegExp,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:Z,fragmentShader:te}}});return _.transparent=!0,_.forceSinglePass=!0,Object.defineProperties(_,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),_}const defaultMaterial=new MeshBasicMaterial({color:16777215,side:DoubleSide,transparent:!0}),defaultStrokeColor=8421504,tempMat4=new Matrix4,tempVec3a=new Vector3,tempVec3b=new Vector3,tempArray=[],origin=new Vector3,defaultOrient="+x+y";function first(K){return Array.isArray(K)?K[0]:K}let getFlatRaycastMesh=()=>{const K=new Mesh(new PlaneGeometry(1,1),defaultMaterial);return getFlatRaycastMesh=()=>K,K},getCurvedRaycastMesh=()=>{const K=new Mesh(new PlaneGeometry(1,1,32,1),defaultMaterial);return getCurvedRaycastMesh=()=>K,K};const syncStartEvent={type:"syncstart"},syncCompleteEvent={type:"synccomplete"},SYNCABLE_PROPS=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],COPYABLE_PROPS=SYNCABLE_PROPS.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Text$1=class extends Mesh{constructor(){const _=new GlyphsGeometry;super(_,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=defaultStrokeColor,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=defaultOrient,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(_){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(_):(this._isSyncing=!0,this.dispatchEvent(syncStartEvent),getTextRenderInfo({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},Z=>{this._isSyncing=!1,this._textRenderInfo=Z,this.geometry.updateGlyphs(Z.glyphBounds,Z.glyphAtlasIndices,Z.blockBounds,Z.chunkedBounds,Z.glyphColors);const te=this._queuedSyncs;te&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{te.forEach(ne=>ne&&ne())})),this.dispatchEvent(syncCompleteEvent),_&&_()})))}onBeforeRender(_,Z,te,ne,ie,oe){this.sync(),ie.isTroikaTextMaterial&&this._prepareForRender(ie)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(_){return createTextDerivedMaterial(_)}get material(){let _=this._derivedMaterial;const Z=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=defaultMaterial.clone());if((!_||!_.isDerivedFrom(Z))&&(_=this._derivedMaterial=this.createDerivedMaterial(Z),Z.addEventListener("dispose",function te(){Z.removeEventListener("dispose",te),_.dispose()})),this.hasOutline()){let te=_._outlineMtl;return te||(te=_._outlineMtl=Object.create(_,{id:{value:_.id+.1}}),te.isTextOutlineMaterial=!0,te.depthWrite=!1,te.map=null,_.addEventListener("dispose",function ne(){_.removeEventListener("dispose",ne),te.dispose()})),[te,_]}else return _}set material(_){_&&_.isTroikaTextMaterial?(this._derivedMaterial=_,this._baseMaterial=_.baseMaterial):this._baseMaterial=_}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(_){this.geometry.detail=_}get curveRadius(){return this.geometry.curveRadius}set curveRadius(_){this.geometry.curveRadius=_}get customDepthMaterial(){return first(this.material).getDepthMaterial()}set customDepthMaterial(_){}get customDistanceMaterial(){return first(this.material).getDistanceMaterial()}set customDistanceMaterial(_){}_prepareForRender(_){const Z=_.isTextOutlineMaterial,te=_.uniforms,ne=this.textRenderInfo;if(ne){const{sdfTexture:se,blockBounds:ae}=ne;te.uTroikaSDFTexture.value=se,te.uTroikaSDFTextureSize.value.set(se.image.width,se.image.height),te.uTroikaSDFGlyphSize.value=ne.sdfGlyphSize,te.uTroikaSDFExponent.value=ne.sdfExponent,te.uTroikaTotalBounds.value.fromArray(ae),te.uTroikaUseGlyphColors.value=!Z&&!!ne.glyphColors;let le=0,ce=0,fe=0,de,pe,he,ge=0,me=0;if(Z){let{outlineWidth:ye,outlineOffsetX:ve,outlineOffsetY:_e,outlineBlur:Te,outlineOpacity:be}=this;le=this._parsePercent(ye)||0,ce=Math.max(0,this._parsePercent(Te)||0),de=be,ge=this._parsePercent(ve)||0,me=this._parsePercent(_e)||0}else fe=Math.max(0,this._parsePercent(this.strokeWidth)||0),fe&&(he=this.strokeColor,te.uTroikaStrokeColor.value.set(he??defaultStrokeColor),pe=this.strokeOpacity,pe==null&&(pe=1)),de=this.fillOpacity;te.uTroikaEdgeOffset.value=le,te.uTroikaPositionOffset.value.set(ge,me),te.uTroikaBlurRadius.value=ce,te.uTroikaStrokeWidth.value=fe,te.uTroikaStrokeOpacity.value=pe,te.uTroikaFillOpacity.value=de??1,te.uTroikaCurveRadius.value=this.curveRadius||0;let Ae=this.clipRect;if(Ae&&Array.isArray(Ae)&&Ae.length===4)te.uTroikaClipRect.value.fromArray(Ae);else{const ye=(this.fontSize||.1)*100;te.uTroikaClipRect.value.set(ae[0]-ye,ae[1]-ye,ae[2]+ye,ae[3]+ye)}this.geometry.applyClipRect(te.uTroikaClipRect.value)}te.uTroikaSDFDebug.value=!!this.debugSDF,_.polygonOffset=!!this.depthOffset,_.polygonOffsetFactor=_.polygonOffsetUnits=this.depthOffset||0;const ie=Z?this.outlineColor||0:this.color;if(ie==null)delete _.color;else{const se=_.hasOwnProperty("color")?_.color:_.color=new Color$1;(ie!==se._input||typeof ie=="object")&&se.set(se._input=ie)}let oe=this.orientation||defaultOrient;if(oe!==_._orientation){let se=te.uTroikaOrient.value;oe=oe.replace(/[^-+xyz]/g,"");let ae=oe!==defaultOrient&&oe.match(/^([-+])([xyz])([-+])([xyz])$/);if(ae){let[,le,ce,fe,de]=ae;tempVec3a.set(0,0,0)[ce]=le==="-"?1:-1,tempVec3b.set(0,0,0)[de]=fe==="-"?-1:1,tempMat4.lookAt(origin,tempVec3a.cross(tempVec3b),tempVec3b),se.setFromMatrix4(tempMat4)}else se.identity();_._orientation=oe}}_parsePercent(_){if(typeof _=="string"){let Z=_.match(/^(-?[\d.]+)%$/),te=Z?parseFloat(Z[1]):NaN;_=(isNaN(te)?0:te/100)*this.fontSize}return _}localPositionToTextCoords(_,Z=new Vector2){Z.copy(_);const te=this.curveRadius;return te&&(Z.x=Math.atan2(_.x,Math.abs(te)-Math.abs(_.z))*Math.abs(te)),Z}worldPositionToTextCoords(_,Z=new Vector2){return tempVec3a.copy(_),this.localPositionToTextCoords(this.worldToLocal(tempVec3a),Z)}raycast(_,Z){const{textRenderInfo:te,curveRadius:ne}=this;if(te){const ie=te.blockBounds,oe=ne?getCurvedRaycastMesh():getFlatRaycastMesh(),se=oe.geometry,{position:ae,uv:le}=se.attributes;for(let ce=0;ce<le.count;ce++){let fe=ie[0]+le.getX(ce)*(ie[2]-ie[0]);const de=ie[1]+le.getY(ce)*(ie[3]-ie[1]);let pe=0;ne&&(pe=ne-Math.cos(fe/ne)*ne,fe=Math.sin(fe/ne)*ne),ae.setXYZ(ce,fe,de,pe)}se.boundingSphere=this.geometry.boundingSphere,se.boundingBox=this.geometry.boundingBox,oe.matrixWorld=this.matrixWorld,oe.material.side=this.material.side,tempArray.length=0,oe.raycast(_,tempArray);for(let ce=0;ce<tempArray.length;ce++)tempArray[ce].object=this,Z.push(tempArray[ce])}}copy(_){const Z=this.geometry;return super.copy(_),this.geometry=Z,COPYABLE_PROPS.forEach(te=>{this[te]=_[te]}),this}clone(){return new this.constructor().copy(this)}};SYNCABLE_PROPS.forEach(K=>{const _="_private_"+K;Object.defineProperty(Text$1.prototype,K,{get(){return this[_]},set(Z){Z!==this[_]&&(this[_]=Z,this._needsSync=!0)}})});new Box3;new Color$1;const Text=reactExports.forwardRef(({sdfGlyphSize:K=64,anchorX:_="center",anchorY:Z="middle",font:te,fontSize:ne=1,children:ie,characters:oe,onSync:se,...ae},le)=>{const ce=useThree(({invalidate:he})=>he),[fe]=reactExports.useState(()=>new Text$1),[de,pe]=reactExports.useMemo(()=>{const he=[];let ge="";return reactExports.Children.forEach(ie,me=>{typeof me=="string"||typeof me=="number"?ge+=me:he.push(me)}),[he,ge]},[ie]);return suspend$1(()=>new Promise(he=>preloadFont({font:te,characters:oe},he)),["troika-text",te,oe]),reactExports.useLayoutEffect(()=>void fe.sync(()=>{ce(),se&&se(fe)})),reactExports.useEffect(()=>()=>fe.dispose(),[fe]),reactExports.createElement("primitive",_extends$3({object:fe,ref:le,font:te,text:pe,anchorX:_,anchorY:Z,fontSize:ne,sdfGlyphSize:K},ae),de)});let fontLoader=null;async function loadFontData(K){return typeof K=="string"?await(await fetch(K)).json():K}function parseFontData(K){return fontLoader||(fontLoader=new FontLoader),fontLoader.parse(K)}async function loader$1(K){const _=await loadFontData(K);return parseFontData(_)}function useFont(K){return suspend$1(loader$1,[K])}useFont.preload=K=>preload(loader$1,[K]);useFont.clear=K=>clear$1([K]);const types$8=["string","number"],getTextFromChildren=K=>{let _="";const Z=[];return reactExports.Children.forEach(K,te=>{types$8.includes(typeof te)?_+=te+"":Z.push(te)}),[_,...Z]},Text3D=reactExports.forwardRef(({font:K,letterSpacing:_=0,lineHeight:Z=1,size:te=1,height:ne=.2,bevelThickness:ie=.1,bevelSize:oe=.01,bevelEnabled:se=!1,bevelOffset:ae=0,bevelSegments:le=4,curveSegments:ce=8,smooth:fe,children:de,...pe},he)=>{reactExports.useMemo(()=>extend$6({RenamedTextGeometry:TextGeometry}),[]);const ge=reactExports.useRef(null),me=useFont(K),Ae=reactExports.useMemo(()=>({font:me,size:te,height:ne,bevelThickness:ie,bevelSize:oe,bevelEnabled:se,bevelSegments:le,bevelOffset:ae,curveSegments:ce,letterSpacing:_,lineHeight:Z}),[me,te,ne,ie,oe,se,le,ae,ce,_,Z]),[ye,...ve]=reactExports.useMemo(()=>getTextFromChildren(de),[de]),_e=reactExports.useMemo(()=>[ye,Ae],[ye,Ae]);return reactExports.useLayoutEffect(()=>{fe&&(ge.current.geometry=mergeVertices(ge.current.geometry,fe),ge.current.geometry.computeVertexNormals())},[_e,fe]),reactExports.useImperativeHandle(he,()=>ge.current,[]),reactExports.createElement("mesh",_extends$3({},pe,{ref:ge}),reactExports.createElement("renamedTextGeometry",{args:_e}),ve)}),isWebGL2Available=()=>{try{var K=document.createElement("canvas");return!!(window.WebGL2RenderingContext&&K.getContext("webgl2"))}catch{return!1}},Effects=reactExports.forwardRef(({children:K,multisamping:_=8,renderIndex:Z=1,disableRender:te,disableGamma:ne,disableRenderPass:ie,depthBuffer:oe=!0,stencilBuffer:se=!1,anisotropy:ae=1,colorSpace:le,type:ce,...fe},de)=>{reactExports.useMemo(()=>extend$6({EffectComposer:EffectComposer$2,RenderPass:RenderPass$1,ShaderPass}),[]);const pe=reactExports.useRef(null);reactExports.useImperativeHandle(de,()=>pe.current,[]);const{scene:he,camera:ge,gl:me,size:Ae,viewport:ye}=useThree(),[ve]=reactExports.useState(()=>{const Te=new WebGLRenderTarget(Ae.width,Ae.height,{type:ce||HalfFloatType,format:RGBAFormat,depthBuffer:oe,stencilBuffer:se,anisotropy:ae});return ce===UnsignedByteType&&le!=null&&(Te.texture.colorSpace=le),Te.samples=_,Te});reactExports.useEffect(()=>{var Te,be;(Te=pe.current)==null||Te.setSize(Ae.width,Ae.height),(be=pe.current)==null||be.setPixelRatio(ye.dpr)},[me,Ae,ye.dpr]),useFrame(()=>{var Te;te||(Te=pe.current)==null||Te.render()},Z);const _e=[];return ie||_e.push(reactExports.createElement("renderPass",{key:"renderpass",attach:`passes-${_e.length}`,args:[he,ge]})),ne||_e.push(reactExports.createElement("shaderPass",{attach:`passes-${_e.length}`,key:"gammapass",args:[GammaCorrectionShader]})),reactExports.Children.forEach(K,Te=>{Te&&_e.push(reactExports.cloneElement(Te,{key:_e.length,attach:`passes-${_e.length}`}))}),reactExports.createElement("effectComposer",_extends$3({ref:pe,args:[me,ve]},fe),_e)});let GradientType=function(K){return K.Linear="linear",K.Radial="radial",K}({});function GradientTexture({stops:K,colors:_,size:Z=1024,width:te=16,type:ne=GradientType.Linear,innerCircleRadius:ie=0,outerCircleRadius:oe="auto",...se}){const ae=useThree(ce=>ce.gl),le=reactExports.useMemo(()=>{const ce=document.createElement("canvas"),fe=ce.getContext("2d");ce.width=te,ce.height=Z;let de;if(ne===GradientType.Linear)de=fe.createLinearGradient(0,0,0,Z);else{const ge=ce.width/2,me=ce.height/2,Ae=oe!=="auto"?Math.abs(Number(oe)):Math.sqrt(ge**2+me**2);de=fe.createRadialGradient(ge,me,Math.abs(ie),ge,me,Ae)}const pe=new Color$1;let he=K.length;for(;he--;)de.addColorStop(K[he],pe.set(_[he]).getStyle());return fe.save(),fe.fillStyle=de,fe.fillRect(0,0,te,Z),fe.restore(),ce},[K]);return reactExports.createElement("canvasTexture",_extends$3({colorSpace:ae.outputColorSpace,args:[le],attach:"map"},se))}function shaderMaterial(K,_,Z,te){var ne;return ne=class extends ShaderMaterial{constructor(ie){super({vertexShader:_,fragmentShader:Z,...ie});for(const oe in K)this.uniforms[oe]=new Uniform(K[oe]),Object.defineProperty(this,oe,{get(){return this.uniforms[oe].value},set(se){this.uniforms[oe].value=se}});this.uniforms=UniformsUtils.clone(this.uniforms),te==null||te(this)}},ne.key=MathUtils.generateUUID(),ne}const IsObject=K=>K===Object(K)&&!Array.isArray(K)&&typeof K!="function";function useTexture(K,_){const Z=useThree(ie=>ie.gl),te=useLoader(TextureLoader,IsObject(K)?Object.values(K):K);return reactExports.useLayoutEffect(()=>{_==null||_(te)},[_]),reactExports.useEffect(()=>{if("initTexture"in Z){let ie=[];Array.isArray(te)?ie=te:te instanceof Texture$1?ie=[te]:IsObject(te)&&(ie=Object.values(te)),ie.forEach(oe=>{oe instanceof Texture$1&&Z.initTexture(oe)})}},[Z,te]),reactExports.useMemo(()=>{if(IsObject(K)){const ie={};let oe=0;for(const se in K)ie[se]=te[oe++];return ie}else return te},[K,te])}useTexture.preload=K=>useLoader.preload(TextureLoader,K);useTexture.clear=K=>useLoader.clear(TextureLoader,K);const Texture=({children:K,input:_,onLoad:Z})=>{const te=useTexture(_,Z);return reactExports.createElement(reactExports.Fragment,null,K==null?void 0:K(te))},getVersion=()=>parseInt(REVISION.replace(/\D+/g,"")),version$3=getVersion(),ImageMaterialImpl=shaderMaterial({color:new Color$1("white"),scale:new Vector2(1,1),imageBounds:new Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},`
  varying vec2 vUv;
  varying vec2 vPos;
  void main() {
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
    vUv = uv;
    vPos = position.xy;
  }
`,`
  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44
  varying vec2 vUv;
  varying vec2 vPos;
  uniform vec2 scale;
  uniform vec2 imageBounds;
  uniform float resolution;
  uniform vec3 color;
  uniform sampler2D map;
  uniform float radius;
  uniform float zoom;
  uniform float grayscale;
  uniform float opacity;
  const vec3 luma = vec3(.299, 0.587, 0.114);
  vec4 toGrayscale(vec4 color, float intensity) {
    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);
  }
  vec2 aspect(vec2 size) {
    return size / min(size.x, size.y);
  }
  
  const float PI = 3.14159265;
    
  // from https://iquilezles.org/articles/distfunctions
  float udRoundBox( vec2 p, vec2 b, float r ) {
    return length(max(abs(p)-b+r,0.0))-r;
  }

  void main() {
    vec2 s = aspect(scale);
    vec2 i = aspect(imageBounds);
    float rs = s.x / s.y;
    float ri = i.x / i.y;
    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);
    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;
    vec2 uv = vUv * s / new + offset;
    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);

    vec2 res = vec2(scale * resolution);
    vec2 halfRes = 0.5 * res;
    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    
	  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));
    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);
    
    #include <tonemapping_fragment>
    #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
  }
`),ImageBase=reactExports.forwardRef(({children:K,color:_,segments:Z=1,scale:te=1,zoom:ne=1,grayscale:ie=0,opacity:oe=1,radius:se=0,texture:ae,toneMapped:le,transparent:ce,side:fe,...de},pe)=>{extend$6({ImageMaterial:ImageMaterialImpl});const he=reactExports.useRef(null),ge=useThree(ve=>ve.size),me=Array.isArray(te)?[te[0],te[1]]:[te,te],Ae=[ae.image.width,ae.image.height],ye=Math.max(ge.width,ge.height);return reactExports.useImperativeHandle(pe,()=>he.current,[]),reactExports.useLayoutEffect(()=>{he.current.geometry.parameters&&he.current.material.scale.set(me[0]*he.current.geometry.parameters.width,me[1]*he.current.geometry.parameters.height)},[me[0],me[1]]),reactExports.createElement("mesh",_extends$3({ref:he,scale:Array.isArray(te)?[...te,1]:te},de),reactExports.createElement("planeGeometry",{args:[1,1,Z,Z]}),reactExports.createElement("imageMaterial",{color:_,map:ae,zoom:ne,grayscale:ie,opacity:oe,scale:me,imageBounds:Ae,resolution:ye,radius:se,toneMapped:le,transparent:ce,side:fe,key:ImageMaterialImpl.key}),K)}),ImageWithUrl=reactExports.forwardRef(({url:K,..._},Z)=>{const te=useTexture(K);return reactExports.createElement(ImageBase,_extends$3({},_,{texture:te,ref:Z}))}),ImageWithTexture=reactExports.forwardRef(({url:K,..._},Z)=>reactExports.createElement(ImageBase,_extends$3({},_,{ref:Z}))),Image$1=reactExports.forwardRef((K,_)=>{if(K.url)return reactExports.createElement(ImageWithUrl,_extends$3({},K,{ref:_}));if(K.texture)return reactExports.createElement(ImageWithTexture,_extends$3({},K,{ref:_}));throw new Error("<Image /> requires a url or texture")}),Edges$1=reactExports.forwardRef(({threshold:K=15,geometry:_,...Z},te)=>{const ne=reactExports.useRef(null);reactExports.useImperativeHandle(te,()=>ne.current,[]);const ie=reactExports.useMemo(()=>[0,0,0,1,0,0],[]),oe=reactExports.useRef(null),se=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{const ae=ne.current.parent,le=_??(ae==null?void 0:ae.geometry);if(!le||oe.current===le&&se.current===K)return;oe.current=le,se.current=K;const fe=new EdgesGeometry(le,K).attributes.position.array;ne.current.geometry.setPositions(fe),ne.current.geometry.attributes.instanceStart.needsUpdate=!0,ne.current.geometry.attributes.instanceEnd.needsUpdate=!0,ne.current.computeLineDistances()}),reactExports.createElement(Line$1,_extends$3({segments:!0,points:ie,ref:ne,raycast:()=>null},Z))}),OutlinesMaterial=shaderMaterial({screenspace:!1,color:new Color$1("black"),opacity:1,thickness:.05,size:new Vector2},`#include <common>
   #include <morphtarget_pars_vertex>
   #include <skinning_pars_vertex>
   #include <clipping_planes_pars_vertex>
   uniform float thickness;
   uniform bool screenspace;
   uniform vec2 size;
   void main() {
     #if defined (USE_SKINNING)
	     #include <beginnormal_vertex>
       #include <morphnormal_vertex>
       #include <skinbase_vertex>
       #include <skinnormal_vertex>
       #include <defaultnormal_vertex>
     #endif
     #include <begin_vertex>
	   #include <morphtarget_vertex>
	   #include <skinning_vertex>
     #include <project_vertex>
     #include <clipping_planes_vertex>
     vec4 tNormal = vec4(normal, 0.0);
     vec4 tPosition = vec4(transformed, 1.0);
     #ifdef USE_INSTANCING
       tNormal = instanceMatrix * tNormal;
       tPosition = instanceMatrix * tPosition;
     #endif
     if (screenspace) {
       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;
       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); 
     } else {
       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;
       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;
       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;
       clipPosition.xy += offset;
       gl_Position = clipPosition;
     }
   }`,`uniform vec3 color;
   uniform float opacity;
   #include <clipping_planes_pars_fragment>
   void main(){
     #include <clipping_planes_fragment>
     gl_FragColor = vec4(color, opacity);
     #include <tonemapping_fragment>
     #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
   }`);function Outlines({color:K="black",opacity:_=1,transparent:Z=!1,screenspace:te=!1,toneMapped:ne=!0,polygonOffset:ie=!1,polygonOffsetFactor:oe=0,renderOrder:se=0,thickness:ae=.05,angle:le=Math.PI,clippingPlanes:ce,...fe}){const de=reactExports.useRef(null),[pe]=reactExports.useState(()=>new OutlinesMaterial({side:BackSide})),{gl:he}=useThree(),ge=he.getDrawingBufferSize(new Vector2);reactExports.useMemo(()=>extend$6({OutlinesMaterial}),[]);const me=reactExports.useRef(0),Ae=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{const ye=de.current;if(!ye)return;const ve=ye.parent;if(ve&&ve.geometry&&(me.current!==le||Ae.current!==ve.geometry)){var _e;me.current=le,Ae.current=ve.geometry;let Te=(_e=ye.children)==null?void 0:_e[0];Te&&(le&&Te.geometry.dispose(),ye.remove(Te)),ve.skeleton?(Te=new SkinnedMesh,Te.material=pe,Te.bind(ve.skeleton,ve.bindMatrix),ye.add(Te)):ve.isInstancedMesh?(Te=new InstancedMesh(ve.geometry,pe,ve.count),Te.instanceMatrix=ve.instanceMatrix,ye.add(Te)):(Te=new Mesh,Te.material=pe,ye.add(Te)),Te.geometry=le?toCreasedNormals(ve.geometry,le):ve.geometry,Te.morphTargetInfluences=ve.morphTargetInfluences,Te.morphTargetDictionary=ve.morphTargetDictionary}}),reactExports.useLayoutEffect(()=>{const ye=de.current;if(!ye)return;const ve=ye.children[0];if(ve){ve.renderOrder=se;const _e=ye.parent;applyProps(ve,{morphTargetInfluences:_e.morphTargetInfluences,morphTargetDictionary:_e.morphTargetDictionary}),applyProps(ve.material,{transparent:Z,thickness:ae,color:K,opacity:_,size:ge,screenspace:te,toneMapped:ne,polygonOffset:ie,polygonOffsetFactor:oe,clippingPlanes:ce,clipping:ce&&ce.length>0})}}),reactExports.useEffect(()=>()=>{const ye=de.current;if(!ye)return;const ve=ye.children[0];ve&&(le&&ve.geometry.dispose(),ye.remove(ve))},[]),reactExports.createElement("group",_extends$3({ref:de},fe))}var __defProp$1=Object.defineProperty,__defNormalProp$1=(K,_,Z)=>_ in K?__defProp$1(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField$1=(K,_,Z)=>(__defNormalProp$1(K,typeof _!="symbol"?_+"":_,Z),Z);function memcpy(K,_,Z,te,ne){let ie;if(K=K.subarray||K.slice?K:K.buffer,Z=Z.subarray||Z.slice?Z:Z.buffer,K=_?K.subarray?K.subarray(_,ne&&_+ne):K.slice(_,ne&&_+ne):K,Z.set)Z.set(K,te);else for(ie=0;ie<K.length;ie++)Z[ie+te]=K[ie];return Z}function convertPoints(K){return K instanceof Float32Array?K:K instanceof BufferGeometry?K.getAttribute("position").array:K.map(_=>{const Z=Array.isArray(_);return _ instanceof Vector3?[_.x,_.y,_.z]:_ instanceof Vector2?[_.x,_.y,0]:Z&&_.length===3?[_[0],_[1],_[2]]:Z&&_.length===2?[_[0],_[1],0]:_}).flat()}class MeshLineGeometry extends BufferGeometry{constructor(){super(),__publicField$1(this,"type","MeshLine"),__publicField$1(this,"isMeshLine",!0),__publicField$1(this,"positions",[]),__publicField$1(this,"previous",[]),__publicField$1(this,"next",[]),__publicField$1(this,"side",[]),__publicField$1(this,"width",[]),__publicField$1(this,"indices_array",[]),__publicField$1(this,"uvs",[]),__publicField$1(this,"counters",[]),__publicField$1(this,"widthCallback",null),__publicField$1(this,"_attributes"),__publicField$1(this,"_points",[]),__publicField$1(this,"points"),__publicField$1(this,"matrixWorld",new Matrix4),Object.defineProperties(this,{points:{enumerable:!0,get(){return this._points},set(_){this.setPoints(_,this.widthCallback)}}})}setMatrixWorld(_){this.matrixWorld=_}setPoints(_,Z){if(_=convertPoints(_),this._points=_,this.widthCallback=Z??null,this.positions=[],this.counters=[],_.length&&_[0]instanceof Vector3)for(let te=0;te<_.length;te++){const ne=_[te],ie=te/(_.length-1);this.positions.push(ne.x,ne.y,ne.z),this.positions.push(ne.x,ne.y,ne.z),this.counters.push(ie),this.counters.push(ie)}else for(let te=0;te<_.length;te+=3){const ne=te/(_.length-1);this.positions.push(_[te],_[te+1],_[te+2]),this.positions.push(_[te],_[te+1],_[te+2]),this.counters.push(ne),this.counters.push(ne)}this.process()}compareV3(_,Z){const te=_*6,ne=Z*6;return this.positions[te]===this.positions[ne]&&this.positions[te+1]===this.positions[ne+1]&&this.positions[te+2]===this.positions[ne+2]}copyV3(_){const Z=_*6;return[this.positions[Z],this.positions[Z+1],this.positions[Z+2]]}process(){const _=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];let Z,te;this.compareV3(0,_-1)?te=this.copyV3(_-2):te=this.copyV3(0),this.previous.push(te[0],te[1],te[2]),this.previous.push(te[0],te[1],te[2]);for(let ne=0;ne<_;ne++){if(this.side.push(1),this.side.push(-1),this.widthCallback?Z=this.widthCallback(ne/(_-1)):Z=1,this.width.push(Z),this.width.push(Z),this.uvs.push(ne/(_-1),0),this.uvs.push(ne/(_-1),1),ne<_-1){te=this.copyV3(ne),this.previous.push(te[0],te[1],te[2]),this.previous.push(te[0],te[1],te[2]);const ie=ne*2;this.indices_array.push(ie,ie+1,ie+2),this.indices_array.push(ie+2,ie+1,ie+3)}ne>0&&(te=this.copyV3(ne),this.next.push(te[0],te[1],te[2]),this.next.push(te[0],te[1],te[2]))}this.compareV3(_-1,0)?te=this.copyV3(1):te=this.copyV3(_-1),this.next.push(te[0],te[1],te[2]),this.next.push(te[0],te[1],te[2]),!this._attributes||this._attributes.position.count!==this.counters.length?this._attributes={position:new BufferAttribute(new Float32Array(this.positions),3),previous:new BufferAttribute(new Float32Array(this.previous),3),next:new BufferAttribute(new Float32Array(this.next),3),side:new BufferAttribute(new Float32Array(this.side),1),width:new BufferAttribute(new Float32Array(this.width),1),uv:new BufferAttribute(new Float32Array(this.uvs),2),index:new BufferAttribute(new Uint16Array(this.indices_array),1),counters:new BufferAttribute(new Float32Array(this.counters),1)}:(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}advance({x:_,y:Z,z:te}){const ne=this._attributes.position.array,ie=this._attributes.previous.array,oe=this._attributes.next.array,se=ne.length;memcpy(ne,0,ie,0,se),memcpy(ne,6,ne,0,se-6),ne[se-6]=_,ne[se-5]=Z,ne[se-4]=te,ne[se-3]=_,ne[se-2]=Z,ne[se-1]=te,memcpy(ne,6,oe,0,se-6),oe[se-6]=_,oe[se-5]=Z,oe[se-4]=te,oe[se-3]=_,oe[se-2]=Z,oe[se-1]=te,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0}}const vertexShader$1=`
  #include <common>
  #include <logdepthbuf_pars_vertex>
  #include <fog_pars_vertex>
  #include <clipping_planes_pars_vertex>

  attribute vec3 previous;
  attribute vec3 next;
  attribute float side;
  attribute float width;
  attribute float counters;
  
  uniform vec2 resolution;
  uniform float lineWidth;
  uniform vec3 color;
  uniform float opacity;
  uniform float sizeAttenuation;
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  vec2 fix(vec4 i, float aspect) {
    vec2 res = i.xy / i.w;
    res.x *= aspect;
    return res;
  }
  
  void main() {
    float aspect = resolution.x / resolution.y;
    vColor = vec4(color, opacity);
    vUV = uv;
    vCounters = counters;
  
    mat4 m = projectionMatrix * modelViewMatrix;
    vec4 finalPosition = m * vec4(position, 1.0) * aspect;
    vec4 prevPos = m * vec4(previous, 1.0);
    vec4 nextPos = m * vec4(next, 1.0);
  
    vec2 currentP = fix(finalPosition, aspect);
    vec2 prevP = fix(prevPos, aspect);
    vec2 nextP = fix(nextPos, aspect);
  
    float w = lineWidth * width;
  
    vec2 dir;
    if (nextP == currentP) dir = normalize(currentP - prevP);
    else if (prevP == currentP) dir = normalize(nextP - currentP);
    else {
      vec2 dir1 = normalize(currentP - prevP);
      vec2 dir2 = normalize(nextP - currentP);
      dir = normalize(dir1 + dir2);
  
      vec2 perp = vec2(-dir1.y, dir1.x);
      vec2 miter = vec2(-dir.y, dir.x);
      //w = clamp(w / dot(miter, perp), 0., 4. * lineWidth * width);
    }
  
    //vec2 normal = (cross(vec3(dir, 0.), vec3(0., 0., 1.))).xy;
    vec4 normal = vec4(-dir.y, dir.x, 0., 1.);
    normal.xy *= .5 * w;
    //normal *= projectionMatrix;
    if (sizeAttenuation == 0.) {
      normal.xy *= finalPosition.w;
      normal.xy /= (vec4(resolution, 0., 1.) * projectionMatrix).xy * aspect;
    }
  
    finalPosition.xy += normal.xy * side;
    gl_Position = finalPosition;
    #include <logdepthbuf_vertex>
    #include <fog_vertex>
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    #include <clipping_planes_vertex>
    #include <fog_vertex>
  }
`,version$2=parseInt(REVISION.replace(/\D+/g,"")),colorspace_fragment=version$2>=154?"colorspace_fragment":"encodings_fragment",fragmentShader$1=`
  #include <fog_pars_fragment>
  #include <logdepthbuf_pars_fragment>
  #include <clipping_planes_pars_fragment>
  
  uniform sampler2D map;
  uniform sampler2D alphaMap;
  uniform float useGradient;
  uniform float useMap;
  uniform float useAlphaMap;
  uniform float useDash;
  uniform float dashArray;
  uniform float dashOffset;
  uniform float dashRatio;
  uniform float visibility;
  uniform float alphaTest;
  uniform vec2 repeat;
  uniform vec3 gradient[2];
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  void main() {
    #include <logdepthbuf_fragment>
    vec4 diffuseColor = vColor;
    if (useGradient == 1.) diffuseColor = vec4(mix(gradient[0], gradient[1], vCounters), 1.0);
    if (useMap == 1.) diffuseColor *= texture2D(map, vUV * repeat);
    if (useAlphaMap == 1.) diffuseColor.a *= texture2D(alphaMap, vUV * repeat).a;
    if (diffuseColor.a < alphaTest) discard;
    if (useDash == 1.) diffuseColor.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));
    diffuseColor.a *= step(vCounters, visibility);
    #include <clipping_planes_fragment>
    gl_FragColor = diffuseColor;     
    #include <fog_fragment>
    #include <tonemapping_fragment>
    #include <${colorspace_fragment}>
  }
`;class MeshLineMaterial extends ShaderMaterial{constructor(_){super({uniforms:{...UniformsLib.fog,lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new Color$1(16777215)},gradient:{value:[new Color$1(16711680),new Color$1(65280)]},opacity:{value:1},resolution:{value:new Vector2(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},useGradient:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new Vector2(1,1)}},vertexShader:vertexShader$1,fragmentShader:fragmentShader$1}),__publicField$1(this,"lineWidth"),__publicField$1(this,"map"),__publicField$1(this,"useMap"),__publicField$1(this,"alphaMap"),__publicField$1(this,"useAlphaMap"),__publicField$1(this,"color"),__publicField$1(this,"gradient"),__publicField$1(this,"resolution"),__publicField$1(this,"sizeAttenuation"),__publicField$1(this,"dashArray"),__publicField$1(this,"dashOffset"),__publicField$1(this,"dashRatio"),__publicField$1(this,"useDash"),__publicField$1(this,"useGradient"),__publicField$1(this,"visibility"),__publicField$1(this,"repeat"),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get(){return this.uniforms.lineWidth.value},set(Z){this.uniforms.lineWidth.value=Z}},map:{enumerable:!0,get(){return this.uniforms.map.value},set(Z){this.uniforms.map.value=Z}},useMap:{enumerable:!0,get(){return this.uniforms.useMap.value},set(Z){this.uniforms.useMap.value=Z}},alphaMap:{enumerable:!0,get(){return this.uniforms.alphaMap.value},set(Z){this.uniforms.alphaMap.value=Z}},useAlphaMap:{enumerable:!0,get(){return this.uniforms.useAlphaMap.value},set(Z){this.uniforms.useAlphaMap.value=Z}},color:{enumerable:!0,get(){return this.uniforms.color.value},set(Z){this.uniforms.color.value=Z}},gradient:{enumerable:!0,get(){return this.uniforms.gradient.value},set(Z){this.uniforms.gradient.value=Z}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(Z){this.uniforms.opacity.value=Z}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(Z){this.uniforms.resolution.value.copy(Z)}},sizeAttenuation:{enumerable:!0,get(){return this.uniforms.sizeAttenuation.value},set(Z){this.uniforms.sizeAttenuation.value=Z}},dashArray:{enumerable:!0,get(){return this.uniforms.dashArray.value},set(Z){this.uniforms.dashArray.value=Z,this.useDash=Z!==0?1:0}},dashOffset:{enumerable:!0,get(){return this.uniforms.dashOffset.value},set(Z){this.uniforms.dashOffset.value=Z}},dashRatio:{enumerable:!0,get(){return this.uniforms.dashRatio.value},set(Z){this.uniforms.dashRatio.value=Z}},useDash:{enumerable:!0,get(){return this.uniforms.useDash.value},set(Z){this.uniforms.useDash.value=Z}},useGradient:{enumerable:!0,get(){return this.uniforms.useGradient.value},set(Z){this.uniforms.useGradient.value=Z}},visibility:{enumerable:!0,get(){return this.uniforms.visibility.value},set(Z){this.uniforms.visibility.value=Z}},alphaTest:{enumerable:!0,get(){return this.uniforms.alphaTest.value},set(Z){this.uniforms.alphaTest.value=Z}},repeat:{enumerable:!0,get(){return this.uniforms.repeat.value},set(Z){this.uniforms.repeat.value.copy(Z)}}}),this.setValues(_)}copy(_){return super.copy(_),this.lineWidth=_.lineWidth,this.map=_.map,this.useMap=_.useMap,this.alphaMap=_.alphaMap,this.useAlphaMap=_.useAlphaMap,this.color.copy(_.color),this.gradient=_.gradient,this.opacity=_.opacity,this.resolution.copy(_.resolution),this.sizeAttenuation=_.sizeAttenuation,this.dashArray=_.dashArray,this.dashOffset=_.dashOffset,this.dashRatio=_.dashRatio,this.useDash=_.useDash,this.useGradient=_.useGradient,this.visibility=_.visibility,this.alphaTest=_.alphaTest,this.repeat.copy(_.repeat),this}}const defaults={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},shiftLeft=(K,_=1)=>(K.set(K.subarray(_)),K.fill(-1/0,-_),K);function useTrail(K,_){const{length:Z,local:te,decay:ne,interval:ie,stride:oe}={...defaults,..._},se=reactExports.useRef(null),[ae]=reactExports.useState(()=>new Vector3);reactExports.useLayoutEffect(()=>{K&&(se.current=Float32Array.from({length:Z*10*3},(fe,de)=>K.position.getComponent(de%3)))},[Z,K]);const le=reactExports.useRef(new Vector3),ce=reactExports.useRef(0);return useFrame(()=>{if(K&&se.current){if(ce.current===0){let fe;te?fe=K.position:(K.getWorldPosition(ae),fe=ae);const de=1*ne;for(let pe=0;pe<de;pe++)fe.distanceTo(le.current)<oe||(shiftLeft(se.current,3),se.current.set(fe.toArray(),se.current.length-3));le.current.copy(fe)}ce.current++,ce.current=ce.current%ie}}),se}const Trail=reactExports.forwardRef((K,_)=>{const{children:Z}=K,{width:te,length:ne,decay:ie,local:oe,stride:se,interval:ae}={...defaults,...K},{color:le="hotpink",attenuation:ce,target:fe}=K,de=useThree(_e=>_e.size),pe=useThree(_e=>_e.scene),he=reactExports.useRef(null),[ge,me]=reactExports.useState(null),Ae=useTrail(ge,{length:ne,decay:ie,local:oe,stride:se,interval:ae});reactExports.useEffect(()=>{const _e=(fe==null?void 0:fe.current)||he.current.children.find(Te=>Te instanceof Object3D);_e&&me(_e)},[Ae,fe]);const ye=reactExports.useMemo(()=>new MeshLineGeometry,[]),ve=reactExports.useMemo(()=>{var _e,Te;const be=new MeshLineMaterial({lineWidth:.1*te,color:le,sizeAttenuation:1,resolution:new Vector2(de.width,de.height)});let Re;if(Z)if(Array.isArray(Z))Re=Z.find(we=>{const Pe=we;return typeof Pe.type=="string"&&Pe.type==="meshLineMaterial"});else{const we=Z;typeof we.type=="string"&&we.type==="meshLineMaterial"&&(Re=we)}return typeof((_e=Re)==null?void 0:_e.props)=="object"&&((Te=Re)==null?void 0:Te.props)!==null&&be.setValues(Re.props),be},[te,le,de,Z]);return reactExports.useEffect(()=>{ve.uniforms.resolution.value.set(de.width,de.height)},[de]),useFrame(()=>{Ae.current&&ye.setPoints(Ae.current,ce)}),reactExports.createElement("group",null,createPortal(reactExports.createElement("mesh",{ref:_,geometry:ye,material:ve}),pe),reactExports.createElement("group",{ref:he},Z))});function useSurfaceSampler(K,_=16,Z,te,ne){const[ie,oe]=reactExports.useState(()=>{const se=Array.from({length:_},()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]).flat();return new InstancedBufferAttribute(Float32Array.from(se),16)});return reactExports.useLayoutEffect(()=>{if(typeof K.current>"u")return;const se=new MeshSurfaceSampler(K.current);te&&se.setWeightAttribute(te),se.build();const ae=new Vector3,le=new Vector3,ce=new Color$1,fe=new Object3D;K.current.updateMatrixWorld(!0);for(let de=0;de<_;de++)se.sample(ae,le,ce),typeof Z=="function"?Z({dummy:fe,sampledMesh:K.current,position:ae,normal:le,color:ce},de):fe.position.copy(ae),fe.updateMatrix(),ne!=null&&ne.current&&ne.current.setMatrixAt(de,fe.matrix),fe.matrix.toArray(ie.array,de*16);ne!=null&&ne.current&&(ne.current.instanceMatrix.needsUpdate=!0),ie.needsUpdate=!0,oe(new InstancedBufferAttribute(ie.array,ie.itemSize).copy(ie))},[K,ne,te,_,Z]),ie}function Sampler({children:K,weight:_,transform:Z,instances:te,mesh:ne,count:ie=16,...oe}){const se=reactExports.useRef(null),ae=reactExports.useRef(null),le=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{var ce,fe;ae.current=(ce=te==null?void 0:te.current)!==null&&ce!==void 0?ce:se.current.children.find(de=>de.hasOwnProperty("instanceMatrix")),le.current=(fe=ne==null?void 0:ne.current)!==null&&fe!==void 0?fe:se.current.children.find(de=>de.type==="Mesh")},[K,ne==null?void 0:ne.current,te==null?void 0:te.current]),useSurfaceSampler(le,ie,Z,_,ae),reactExports.createElement("group",_extends$3({ref:se},oe),K)}const ComputedAttribute=({compute:K,name:_,...Z})=>{const[te]=reactExports.useState(()=>new BufferAttribute(new Float32Array(0),1)),ne=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{if(ne.current){var ie;const oe=(ie=ne.current.parent)!==null&&ie!==void 0?ie:ne.current.__r3f.parent.object,se=K(oe);ne.current.copy(se)}},[K]),reactExports.createElement("primitive",_extends$3({ref:ne,object:te,attach:`attributes-${_}`},Z))};function createSpread(K,{keys:_=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:Z,inject:te,castShadow:ne,receiveShadow:ie}){let oe={};for(const se of _)oe[se]=K[se];return Z&&(oe.geometry&&Z!=="materialsOnly"&&(oe.geometry=oe.geometry.clone()),oe.material&&Z!=="geometriesOnly"&&(oe.material=oe.material.clone())),te&&(typeof te=="function"?oe={...oe,children:te(K)}:reactExports.isValidElement(te)?oe={...oe,children:te}:oe={...oe,...te}),K instanceof Mesh&&(ne&&(oe.castShadow=!0),ie&&(oe.receiveShadow=!0)),oe}const Clone=reactExports.forwardRef(({isChild:K=!1,object:_,children:Z,deep:te,castShadow:ne,receiveShadow:ie,inject:oe,keys:se,...ae},le)=>{const ce={keys:se,deep:te,inject:oe,castShadow:ne,receiveShadow:ie};if(_=reactExports.useMemo(()=>{if(K===!1&&!Array.isArray(_)){let he=!1;if(_.traverse(ge=>{ge.isSkinnedMesh&&(he=!0)}),he)return SkeletonUtils.clone(_)}return _},[_,K]),Array.isArray(_))return reactExports.createElement("group",_extends$3({},ae,{ref:le}),_.map(he=>reactExports.createElement(Clone,_extends$3({key:he.uuid,object:he},ce))),Z);const{children:fe,...de}=createSpread(_,ce),pe=_.type[0].toLowerCase()+_.type.slice(1);return reactExports.createElement(pe,_extends$3({},de,ae,{ref:le}),_.children.map(he=>he.type==="Bone"?reactExports.createElement("primitive",_extends$3({key:he.uuid,object:he},ce)):reactExports.createElement(Clone,_extends$3({key:he.uuid,object:he},ce,{isChild:!0}))),Z,fe)}),globalContext$1=reactExports.createContext(null),MarchingCubes=reactExports.forwardRef(({resolution:K=28,maxPolyCount:_=1e4,enableUvs:Z=!1,enableColors:te=!1,children:ne,...ie},oe)=>{const se=reactExports.useRef(null);reactExports.useImperativeHandle(oe,()=>se.current,[]);const ae=reactExports.useMemo(()=>new MarchingCubes$1(K,null,Z,te,_),[K,_,Z,te]),le=reactExports.useMemo(()=>({getParent:()=>se}),[]);return useFrame(()=>{ae.update(),ae.reset()},-1),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("primitive",_extends$3({object:ae,ref:se},ie),reactExports.createElement(globalContext$1.Provider,{value:le},ne)))}),MarchingCube=reactExports.forwardRef(({strength:K=.5,subtract:_=12,color:Z,...te},ne)=>{const{getParent:ie}=reactExports.useContext(globalContext$1),oe=reactExports.useMemo(()=>ie(),[ie]),se=reactExports.useRef(null);reactExports.useImperativeHandle(ne,()=>se.current,[]);const ae=new Vector3;return useFrame(le=>{!oe.current||!se.current||(se.current.getWorldPosition(ae),oe.current.addBall(.5+ae.x*.5,.5+ae.y*.5,.5+ae.z*.5,K,_,Z))}),reactExports.createElement("group",_extends$3({ref:se},te))}),MarchingPlane=reactExports.forwardRef(({planeType:K="x",strength:_=.5,subtract:Z=12,...te},ne)=>{const{getParent:ie}=reactExports.useContext(globalContext$1),oe=reactExports.useMemo(()=>ie(),[ie]),se=reactExports.useRef(null);reactExports.useImperativeHandle(ne,()=>se.current,[]);const ae=reactExports.useMemo(()=>K==="x"?"addPlaneX":K==="y"?"addPlaneY":"addPlaneZ",[K]);return useFrame(()=>{!oe.current||!se.current||oe.current[ae](_,Z)}),reactExports.createElement("group",_extends$3({ref:se},te))});function isArray$2(K){return Array.isArray(K)}function vecToArray(K=[0,0,0]){return isArray$2(K)?K:K instanceof Vector3||K instanceof Euler?[K.x,K.y,K.z]:[K,K,K]}const Decal=reactExports.forwardRef(function({debug:_,depthTest:Z=!1,polygonOffsetFactor:te=-10,map:ne,mesh:ie,children:oe,position:se,rotation:ae,scale:le,...ce},fe){const de=reactExports.useRef(null);reactExports.useImperativeHandle(fe,()=>de.current);const pe=reactExports.useRef(null),he=reactExports.useRef({position:new Vector3,rotation:new Euler,scale:new Vector3(1,1,1)});return reactExports.useLayoutEffect(()=>{const ge=(ie==null?void 0:ie.current)||de.current.parent,me=de.current;if(!(ge instanceof Mesh))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');if(ge){applyProps(he.current,{position:se,scale:le});const Ae=ge.matrixWorld.clone();if(ge.matrixWorld.identity(),!ae||typeof ae=="number"){const ye=new Object3D;ye.position.copy(he.current.position);const ve=ge.geometry.attributes.position.array;ge.geometry.attributes.normal===void 0&&ge.geometry.computeVertexNormals();const _e=ge.geometry.attributes.normal.array;let Te=1/0,be=new Vector3;const Re=ye.position.x,we=ye.position.y,Pe=ye.position.z,Ie=ve.length;let $e=-1;for(let Ue=0;Ue<Ie;Ue+=3){const ke=ve[Ue],Ge=ve[Ue+1],He=ve[Ue+2],ze=ke-Re,Ke=Ge-we,tt=He-Pe,Je=ze*ze+Ke*Ke+tt*tt;Je<Te&&(Te=Je,$e=Ue)}be.fromArray(_e,$e),ye.lookAt(ye.position.clone().add(be)),ye.rotateZ(Math.PI),ye.rotateY(Math.PI),typeof ae=="number"&&ye.rotateZ(ae),applyProps(he.current,{rotation:ye.rotation})}else applyProps(he.current,{rotation:ae});return pe.current&&applyProps(pe.current,he.current),me.geometry=new DecalGeometry(ge,he.current.position,he.current.rotation,he.current.scale),ge.matrixWorld=Ae,()=>{me.geometry.dispose()}}},[ie,...vecToArray(se),...vecToArray(le),...vecToArray(ae)]),reactExports.useLayoutEffect(()=>{pe.current&&pe.current.traverse(ge=>ge.raycast=()=>null)},[_]),reactExports.createElement("mesh",_extends$3({ref:de,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":te,"material-depthTest":Z,"material-map":ne},ce),oe,_&&reactExports.createElement("mesh",{ref:pe},reactExports.createElement("boxGeometry",null),reactExports.createElement("meshNormalMaterial",{wireframe:!0}),reactExports.createElement("axesHelper",null)))}),Svg$1=reactExports.forwardRef(function({src:_,skipFill:Z,skipStrokes:te,fillMaterial:ne,strokeMaterial:ie,fillMeshProps:oe,strokeMeshProps:se,...ae},le){const ce=useLoader(SVGLoader,_.startsWith("<svg")?`data:image/svg+xml;utf8,${_}`:_),fe=reactExports.useMemo(()=>te?[]:ce.paths.map(pe=>{var he;return((he=pe.userData)==null?void 0:he.style.stroke)===void 0||pe.userData.style.stroke==="none"?null:pe.subPaths.map(ge=>SVGLoader.pointsToStroke(ge.getPoints(),pe.userData.style))}),[ce,te]);reactExports.useEffect(()=>()=>fe.forEach(pe=>pe&&pe.map(he=>he.dispose())),[fe]);let de=0;return reactExports.createElement("object3D",_extends$3({ref:le},ae),reactExports.createElement("object3D",{scale:[1,-1,1]},ce.paths.map((pe,he)=>{var ge,me;return reactExports.createElement(reactExports.Fragment,{key:he},!Z&&((ge=pe.userData)==null?void 0:ge.style.fill)!==void 0&&pe.userData.style.fill!=="none"&&SVGLoader.createShapes(pe).map((Ae,ye)=>reactExports.createElement("mesh",_extends$3({key:ye},oe,{renderOrder:de++}),reactExports.createElement("shapeGeometry",{args:[Ae]}),reactExports.createElement("meshBasicMaterial",_extends$3({color:pe.userData.style.fill,opacity:pe.userData.style.fillOpacity,transparent:!0,side:DoubleSide,depthWrite:!1},ne)))),!te&&((me=pe.userData)==null?void 0:me.style.stroke)!==void 0&&pe.userData.style.stroke!=="none"&&pe.subPaths.map((Ae,ye)=>reactExports.createElement("mesh",_extends$3({key:ye,geometry:fe[he][ye]},se,{renderOrder:de++}),reactExports.createElement("meshBasicMaterial",_extends$3({color:pe.userData.style.stroke,opacity:pe.userData.style.strokeOpacity,transparent:!0,side:DoubleSide,depthWrite:!1},ie)))))})))});function AsciiRenderer({renderIndex:K=1,bgColor:_="black",fgColor:Z="white",characters:te=" .:-+*=%@#",invert:ne=!0,color:ie=!1,resolution:oe=.15}){const{size:se,gl:ae,scene:le,camera:ce}=useThree(),fe=reactExports.useMemo(()=>{const de=new AsciiEffect(ae,te,{invert:ne,color:ie,resolution:oe});return de.domElement.style.position="absolute",de.domElement.style.top="0px",de.domElement.style.left="0px",de.domElement.style.pointerEvents="none",de},[te,ne,ie,oe]);return reactExports.useLayoutEffect(()=>{fe.domElement.style.color=Z,fe.domElement.style.backgroundColor=_},[Z,_]),reactExports.useEffect(()=>(ae.domElement.style.opacity="0",ae.domElement.parentNode.appendChild(fe.domElement),()=>{ae.domElement.style.opacity="1",ae.domElement.parentNode.removeChild(fe.domElement)}),[fe]),reactExports.useEffect(()=>{fe.setSize(se.width,se.height)},[fe,se]),useFrame(de=>{fe.render(le,ce)},K),reactExports.createElement(reactExports.Fragment,null)}const SplatMaterial=shaderMaterial({alphaTest:0,viewport:new Vector2(1980,1080),focal:1e3,centerAndScaleTexture:null,covAndColorTexture:null},`
    precision highp sampler2D;
    precision highp usampler2D;
    out vec4 vColor;
    out vec3 vPosition;
    uniform vec2 resolution;
    uniform vec2 viewport;
    uniform float focal;
    attribute uint splatIndex;
    uniform sampler2D centerAndScaleTexture;
    uniform usampler2D covAndColorTexture;    

    vec2 unpackInt16(in uint value) {
      int v = int(value);
      int v0 = v >> 16;
      int v1 = (v & 0xFFFF);
      if((v & 0x8000) != 0)
        v1 |= 0xFFFF0000;
      return vec2(float(v1), float(v0));
    }

    void main () {
      ivec2 texSize = textureSize(centerAndScaleTexture, 0);
      ivec2 texPos = ivec2(splatIndex%uint(texSize.x), splatIndex/uint(texSize.x));
      vec4 centerAndScaleData = texelFetch(centerAndScaleTexture, texPos, 0);
      vec4 center = vec4(centerAndScaleData.xyz, 1);
      vec4 camspace = modelViewMatrix * center;
      vec4 pos2d = projectionMatrix * camspace;

      float bounds = 1.2 * pos2d.w;
      if (pos2d.z < -pos2d.w || pos2d.x < -bounds || pos2d.x > bounds
        || pos2d.y < -bounds || pos2d.y > bounds) {
        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);
        return;
      }

      uvec4 covAndColorData = texelFetch(covAndColorTexture, texPos, 0);
      vec2 cov3D_M11_M12 = unpackInt16(covAndColorData.x) * centerAndScaleData.w;
      vec2 cov3D_M13_M22 = unpackInt16(covAndColorData.y) * centerAndScaleData.w;
      vec2 cov3D_M23_M33 = unpackInt16(covAndColorData.z) * centerAndScaleData.w;
      mat3 Vrk = mat3(
        cov3D_M11_M12.x, cov3D_M11_M12.y, cov3D_M13_M22.x,
        cov3D_M11_M12.y, cov3D_M13_M22.y, cov3D_M23_M33.x,
        cov3D_M13_M22.x, cov3D_M23_M33.x, cov3D_M23_M33.y
      );

      mat3 J = mat3(
        focal / camspace.z, 0., -(focal * camspace.x) / (camspace.z * camspace.z),
        0., focal / camspace.z, -(focal * camspace.y) / (camspace.z * camspace.z),
        0., 0., 0.
      );

      mat3 W = transpose(mat3(modelViewMatrix));
      mat3 T = W * J;
      mat3 cov = transpose(T) * Vrk * T;
      vec2 vCenter = vec2(pos2d) / pos2d.w;
      float diagonal1 = cov[0][0] + 0.3;
      float offDiagonal = cov[0][1];
      float diagonal2 = cov[1][1] + 0.3;
      float mid = 0.5 * (diagonal1 + diagonal2);
      float radius = length(vec2((diagonal1 - diagonal2) / 2.0, offDiagonal));
      float lambda1 = mid + radius;
      float lambda2 = max(mid - radius, 0.1);
      vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));
      vec2 v1 = min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector;
      vec2 v2 = min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x);
      uint colorUint = covAndColorData.w;
      vColor = vec4(
        float(colorUint & uint(0xFF)) / 255.0,
        float((colorUint >> uint(8)) & uint(0xFF)) / 255.0,
        float((colorUint >> uint(16)) & uint(0xFF)) / 255.0,
        float(colorUint >> uint(24)) / 255.0
      );
      vPosition = position;

      gl_Position = vec4(
        vCenter 
          + position.x * v2 / viewport * 2.0 
          + position.y * v1 / viewport * 2.0, pos2d.z / pos2d.w, 1.0);
    }
    `,`
    #include <alphatest_pars_fragment>
    #include <alphahash_pars_fragment>
    in vec4 vColor;
    in vec3 vPosition;
    void main () {
      float A = -dot(vPosition.xy, vPosition.xy);
      if (A < -4.0) discard;
      float B = exp(A) * vColor.a;
      vec4 diffuseColor = vec4(vColor.rgb, B);
      #include <alphatest_fragment>
      #include <alphahash_fragment>
      gl_FragColor = diffuseColor;
      #include <tonemapping_fragment>
      #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `);function createWorker(K){let _=null,Z=0;function te(ne,ie=!1){const oe=_.length/16,se=-1e-4;let ae=-1/0,le=1/0;const ce=new Float32Array(oe),fe=new Int32Array(ce.buffer),de=new Int32Array(oe);let pe=0;for(let ye=0;ye<oe;ye++){const ve=ne[0]*_[ye*16+12]+ne[1]*_[ye*16+13]+ne[2]*_[ye*16+14]+ne[3];(ie||ve<0&&_[ye*16+15]>se*ve)&&(ce[pe]=ve,de[pe]=ye,pe++,ve>ae&&(ae=ve),ve<le&&(le=ve))}const he=(256*256-1)/(ae-le),ge=new Uint32Array(256*256);for(let ye=0;ye<pe;ye++)fe[ye]=(ce[ye]-le)*he|0,ge[fe[ye]]++;const me=new Uint32Array(256*256);for(let ye=1;ye<256*256;ye++)me[ye]=me[ye-1]+ge[ye-1];const Ae=new Uint32Array(pe);for(let ye=0;ye<pe;ye++)Ae[me[fe[ye]]++]=de[ye];return Ae}K.onmessage=ne=>{if(ne.data.method=="push"){Z===0&&(_=new Float32Array(ne.data.length));const ie=new Float32Array(ne.data.matrices);_.set(ie,Z),Z+=ie.length}else if(ne.data.method=="sort"&&_!==null){const ie=te(new Float32Array(ne.data.view),ne.data.hashed);K.postMessage({indices:ie,key:ne.data.key},[ie.buffer])}}}class SplatLoader extends Loader{constructor(..._){super(..._),this.gl=null,this.chunkSize=25e3}load(_,Z,te,ne){const ie={gl:this.gl,url:this.manager.resolveURL(_),worker:new Worker(URL.createObjectURL(new Blob(["(",createWorker.toString(),")(self)"],{type:"application/javascript"}))),manager:this.manager,update:(oe,se,ae)=>update(se,ie,oe,ae),connect:oe=>connect(ie,oe),loading:!1,loaded:!1,loadedVertexCount:0,chunkSize:this.chunkSize,totalDownloadBytes:0,numVertices:0,rowLength:32,maxVertexes:0,bufferTextureWidth:0,bufferTextureHeight:0,stream:null,centerAndScaleData:null,covAndColorData:null,covAndColorTexture:null,centerAndScaleTexture:null,onProgress:te};load$2(ie).then(Z).catch(oe=>{ne==null||ne(oe),ie.manager.itemError(ie.url)})}}async function load$2(K){K.manager.itemStart(K.url);const _=await fetch(K.url);if(_.body===null)throw"Failed to fetch file";let Z=_.headers.get("Content-Length");const te=Z?parseInt(Z):void 0;if(te==null)throw"Failed to get content length";K.stream=_.body.getReader(),K.totalDownloadBytes=te,K.numVertices=Math.floor(K.totalDownloadBytes/K.rowLength);const ne=K.gl.getContext();let ie=ne.getParameter(ne.MAX_TEXTURE_SIZE);return K.maxVertexes=ie*ie,K.numVertices>K.maxVertexes&&(K.numVertices=K.maxVertexes),K.bufferTextureWidth=ie,K.bufferTextureHeight=Math.floor((K.numVertices-1)/ie)+1,K.centerAndScaleData=new Float32Array(K.bufferTextureWidth*K.bufferTextureHeight*4),K.covAndColorData=new Uint32Array(K.bufferTextureWidth*K.bufferTextureHeight*4),K.centerAndScaleTexture=new DataTexture(K.centerAndScaleData,K.bufferTextureWidth,K.bufferTextureHeight,RGBAFormat,FloatType),K.centerAndScaleTexture.needsUpdate=!0,K.covAndColorTexture=new DataTexture(K.covAndColorData,K.bufferTextureWidth,K.bufferTextureHeight,RGBAIntegerFormat,UnsignedIntType),K.covAndColorTexture.internalFormat="RGBA32UI",K.covAndColorTexture.needsUpdate=!0,K}async function lazyLoad(K){K.loading=!0;let _=0,Z=0;const te=[];let ne=0;const ie=K.totalDownloadBytes!==0;for(;;)try{const{value:oe,done:se}=await K.stream.read();if(se)break;if(_+=oe.length,K.totalDownloadBytes!=null){const le=_/K.totalDownloadBytes*100;if(K.onProgress&&le-ne>1){const ce=new ProgressEvent("progress",{lengthComputable:ie,loaded:_,total:K.totalDownloadBytes});K.onProgress(ce),ne=le}}te.push(oe);const ae=_-Z;if(K.totalDownloadBytes!=null&&ae>K.rowLength*K.chunkSize){let le=Math.floor(ae/K.rowLength);const ce=new Uint8Array(ae);let fe=0;for(const he of te)ce.set(he,fe),fe+=he.length;if(te.length=0,ae>le*K.rowLength){const he=new Uint8Array(ae-le*K.rowLength);he.set(ce.subarray(ae-he.length,ae),0),te.push(he)}const de=new Uint8Array(le*K.rowLength);de.set(ce.subarray(0,de.byteLength),0);const pe=pushDataBuffer(K,de.buffer,le);if(K.worker.postMessage({method:"push",src:K.url,length:K.numVertices*16,matrices:pe.buffer},[pe.buffer]),Z+=le*K.rowLength,K.onProgress){const he=new ProgressEvent("progress",{lengthComputable:ie,loaded:K.totalDownloadBytes,total:K.totalDownloadBytes});K.onProgress(he)}}}catch(oe){console.error(oe);break}if(_-Z>0){let oe=new Uint8Array(te.reduce((ce,fe)=>ce+fe.length,0)),se=0;for(const ce of te)oe.set(ce,se),se+=ce.length;let ae=Math.floor(oe.byteLength/K.rowLength);const le=pushDataBuffer(K,oe.buffer,ae);K.worker.postMessage({method:"push",src:K.url,length:ae*16,matrices:le.buffer},[le.buffer])}K.loaded=!0,K.manager.itemEnd(K.url)}function update(K,_,Z,te){if(K.updateMatrixWorld(),_.gl.getCurrentViewport(Z.viewport),Z.material.viewport.x=Z.viewport.z,Z.material.viewport.y=Z.viewport.w,Z.material.focal=Z.viewport.w/2*Math.abs(K.projectionMatrix.elements[5]),Z.ready){if(te&&Z.sorted)return;Z.ready=!1;const ne=new Float32Array([Z.modelViewMatrix.elements[2],-Z.modelViewMatrix.elements[6],Z.modelViewMatrix.elements[10],Z.modelViewMatrix.elements[14]]);_.worker.postMessage({method:"sort",src:_.url,key:Z.uuid,view:ne.buffer,hashed:te},[ne.buffer]),te&&_.loaded&&(Z.sorted=!0)}}function connect(K,_){K.loading||lazyLoad(K),_.ready=!1,_.pm=new Matrix4,_.vm1=new Matrix4,_.vm2=new Matrix4,_.viewport=new Vector4;let Z=new Uint32Array(K.bufferTextureWidth*K.bufferTextureHeight);const te=new InstancedBufferAttribute(Z,1,!1);te.setUsage(DynamicDrawUsage);const ne=_.geometry=new InstancedBufferGeometry,ie=new Float32Array(6*3),oe=new BufferAttribute(ie,3);ne.setAttribute("position",oe),oe.setXYZ(2,-2,2,0),oe.setXYZ(1,2,2,0),oe.setXYZ(0,-2,-2,0),oe.setXYZ(5,-2,-2,0),oe.setXYZ(4,2,2,0),oe.setXYZ(3,2,-2,0),oe.needsUpdate=!0,ne.setAttribute("splatIndex",te),ne.instanceCount=1;function se(le){if(_&&le.data.key===_.uuid){let ce=new Uint32Array(le.data.indices);ne.attributes.splatIndex.set(ce),ne.attributes.splatIndex.needsUpdate=!0,ne.instanceCount=ce.length,_.ready=!0}}K.worker.addEventListener("message",se);async function ae(){for(;;){const le=K.gl.properties.get(K.centerAndScaleTexture),ce=K.gl.properties.get(K.covAndColorTexture);if(le!=null&&le.__webglTexture&&ce!=null&&ce.__webglTexture&&K.loadedVertexCount>0)break;await new Promise(fe=>setTimeout(fe,10))}_.ready=!0}return ae(),()=>K.worker.removeEventListener("message",se)}function pushDataBuffer(K,_,Z){const te=K.gl.getContext();if(K.loadedVertexCount+Z>K.maxVertexes&&(Z=K.maxVertexes-K.loadedVertexCount),Z<=0)throw"Failed to parse file";const ne=new Uint8Array(_),ie=new Float32Array(_),oe=new Float32Array(Z*16),se=new Uint8Array(K.covAndColorData.buffer),ae=new Int16Array(K.covAndColorData.buffer);for(let le=0;le<Z;le++){const ce=new Quaternion(-(ne[32*le+28+1]-128)/128,(ne[32*le+28+2]-128)/128,(ne[32*le+28+3]-128)/128,-(ne[32*le+28+0]-128)/128);ce.invert();const fe=new Vector3(ie[8*le+0],ie[8*le+1],-ie[8*le+2]),de=new Vector3(ie[8*le+3+0],ie[8*le+3+1],ie[8*le+3+2]),pe=new Matrix4;pe.makeRotationFromQuaternion(ce),pe.transpose(),pe.scale(de);const he=pe.clone();pe.transpose(),pe.premultiply(he),pe.setPosition(fe);const ge=[0,1,2,5,6,10];let me=0;for(let ve=0;ve<ge.length;ve++)Math.abs(pe.elements[ge[ve]])>me&&(me=Math.abs(pe.elements[ge[ve]]));let Ae=K.loadedVertexCount*4+le*4;K.centerAndScaleData[Ae+0]=fe.x,K.centerAndScaleData[Ae+1]=-fe.y,K.centerAndScaleData[Ae+2]=fe.z,K.centerAndScaleData[Ae+3]=me/32767,Ae=K.loadedVertexCount*8+le*4*2;for(let ve=0;ve<ge.length;ve++)ae[Ae+ve]=pe.elements[ge[ve]]*32767/me;Ae=K.loadedVertexCount*16+(le*4+3)*4;const ye=new Color$1(ne[32*le+24+0]/255,ne[32*le+24+1]/255,ne[32*le+24+2]/255);ye.convertSRGBToLinear(),se[Ae+0]=ye.r*255,se[Ae+1]=ye.g*255,se[Ae+2]=ye.b*255,se[Ae+3]=ne[32*le+24+3],pe.elements[15]=Math.max(de.x,de.y,de.z)*ne[32*le+24+3]/255;for(let ve=0;ve<16;ve++)oe[le*16+ve]=pe.elements[ve]}for(;Z>0;){let le=0,ce=0;const fe=K.loadedVertexCount%K.bufferTextureWidth,de=Math.floor(K.loadedVertexCount/K.bufferTextureWidth);K.loadedVertexCount%K.bufferTextureWidth!=0?(le=Math.min(K.bufferTextureWidth,fe+Z)-fe,ce=1):Math.floor(Z/K.bufferTextureWidth)>0?(le=K.bufferTextureWidth,ce=Math.floor(Z/K.bufferTextureWidth)):(le=Z%K.bufferTextureWidth,ce=1);const pe=K.gl.properties.get(K.centerAndScaleTexture);te.bindTexture(te.TEXTURE_2D,pe.__webglTexture),te.texSubImage2D(te.TEXTURE_2D,0,fe,de,le,ce,te.RGBA,te.FLOAT,K.centerAndScaleData,K.loadedVertexCount*4);const he=K.gl.properties.get(K.covAndColorTexture);te.bindTexture(te.TEXTURE_2D,he.__webglTexture),te.texSubImage2D(te.TEXTURE_2D,0,fe,de,le,ce,te.RGBA_INTEGER,te.UNSIGNED_INT,K.covAndColorData,K.loadedVertexCount*4),K.gl.resetState(),K.loadedVertexCount+=le*ce,Z-=le*ce}return oe}function Splat({src:K,toneMapped:_=!1,alphaTest:Z=0,alphaHash:te=!1,chunkSize:ne=25e3,...ie}){extend$6({SplatMaterial});const oe=reactExports.useRef(null),se=useThree(ce=>ce.gl),ae=useThree(ce=>ce.camera),le=useLoader(SplatLoader,K,ce=>{ce.gl=se,ce.chunkSize=ne});return reactExports.useLayoutEffect(()=>le.connect(oe.current),[K]),useFrame(()=>le.update(oe.current,ae,te)),reactExports.createElement("mesh",_extends$3({ref:oe,frustumCulled:!1},ie),reactExports.createElement("splatMaterial",{key:`${K}/${Z}/${te}${SplatMaterial.key}`,transparent:!te,depthTest:!0,alphaTest:te?0:Z,centerAndScaleTexture:le.centerAndScaleTexture,covAndColorTexture:le.covAndColorTexture,depthWrite:te?!0:Z>0,blending:te?NormalBlending:CustomBlending,blendSrcAlpha:OneFactor,alphaHash:!!te,toneMapped:_}))}function useFBO(K,_,Z){const te=useThree(de=>de.size),ne=useThree(de=>de.viewport),ie=typeof K=="number"?K:te.width*ne.dpr,oe=typeof _=="number"?_:te.height*ne.dpr,se=(typeof K=="number"?Z:K)||{},{samples:ae=0,depth:le,...ce}=se,fe=reactExports.useMemo(()=>{const de=new WebGLRenderTarget(ie,oe,{minFilter:LinearFilter,magFilter:LinearFilter,type:HalfFloatType,...ce});return le&&(de.depthTexture=new DepthTexture(ie,oe,FloatType)),de.samples=ae,de},[]);return reactExports.useLayoutEffect(()=>{fe.setSize(ie,oe),ae&&(fe.samples=ae)},[ae,fe,ie,oe]),reactExports.useEffect(()=>()=>fe.dispose(),[]),fe}const Fbo=({children:K,width:_,height:Z,...te})=>{const ne=useFBO(_,Z,te);return reactExports.createElement(reactExports.Fragment,null,K==null?void 0:K(ne))},isFunction$2=K=>typeof K=="function",OrthographicCamera=reactExports.forwardRef(({envMap:K,resolution:_=256,frames:Z=1/0,children:te,makeDefault:ne,...ie},oe)=>{const se=useThree(({set:me})=>me),ae=useThree(({camera:me})=>me),le=useThree(({size:me})=>me),ce=reactExports.useRef(null);reactExports.useImperativeHandle(oe,()=>ce.current,[]);const fe=reactExports.useRef(null),de=useFBO(_);reactExports.useLayoutEffect(()=>{ie.manual||ce.current.updateProjectionMatrix()},[le,ie]),reactExports.useLayoutEffect(()=>{ce.current.updateProjectionMatrix()}),reactExports.useLayoutEffect(()=>{if(ne){const me=ae;return se(()=>({camera:ce.current})),()=>se(()=>({camera:me}))}},[ce,ne,se]);let pe=0,he=null;const ge=isFunction$2(te);return useFrame(me=>{ge&&(Z===1/0||pe<Z)&&(fe.current.visible=!1,me.gl.setRenderTarget(de),he=me.scene.background,K&&(me.scene.background=K),me.gl.render(me.scene,ce.current),me.scene.background=he,me.gl.setRenderTarget(null),fe.current.visible=!0,pe++)}),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("orthographicCamera",_extends$3({left:le.width/-2,right:le.width/2,top:le.height/2,bottom:le.height/-2,ref:ce},ie),!ge&&te),reactExports.createElement("group",{ref:fe},ge&&te(de.texture)))}),isFunction$1=K=>typeof K=="function",PerspectiveCamera$1=reactExports.forwardRef(({envMap:K,resolution:_=256,frames:Z=1/0,makeDefault:te,children:ne,...ie},oe)=>{const se=useThree(({set:me})=>me),ae=useThree(({camera:me})=>me),le=useThree(({size:me})=>me),ce=reactExports.useRef(null);reactExports.useImperativeHandle(oe,()=>ce.current,[]);const fe=reactExports.useRef(null),de=useFBO(_);reactExports.useLayoutEffect(()=>{ie.manual||(ce.current.aspect=le.width/le.height)},[le,ie]),reactExports.useLayoutEffect(()=>{ce.current.updateProjectionMatrix()});let pe=0,he=null;const ge=isFunction$1(ne);return useFrame(me=>{ge&&(Z===1/0||pe<Z)&&(fe.current.visible=!1,me.gl.setRenderTarget(de),he=me.scene.background,K&&(me.scene.background=K),me.gl.render(me.scene,ce.current),me.scene.background=he,me.gl.setRenderTarget(null),fe.current.visible=!0,pe++)}),reactExports.useLayoutEffect(()=>{if(te){const me=ae;return se(()=>({camera:ce.current})),()=>se(()=>({camera:me}))}},[ce,te,se]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("perspectiveCamera",_extends$3({ref:ce},ie),!ge&&ne),reactExports.createElement("group",{ref:fe},ge&&ne(de.texture)))});function useCubeCamera({resolution:K=256,near:_=.1,far:Z=1e3,envMap:te,fog:ne}={}){const ie=useThree(({gl:de})=>de),oe=useThree(({scene:de})=>de),se=reactExports.useMemo(()=>{const de=new WebGLCubeRenderTarget(K);return de.texture.type=HalfFloatType,de},[K]);reactExports.useEffect(()=>()=>{se.dispose()},[se]);const ae=reactExports.useMemo(()=>new CubeCamera$1(_,Z,se),[_,Z,se]);let le,ce;const fe=reactExports.useCallback(()=>{le=oe.fog,ce=oe.background,oe.background=te||ce,oe.fog=ne||le,ae.update(ie,oe),oe.fog=le,oe.background=ce},[ie,oe,ae]);return{fbo:se,camera:ae,update:fe}}function CubeCamera({children:K,frames:_=1/0,resolution:Z,near:te,far:ne,envMap:ie,fog:oe,...se}){const ae=reactExports.useRef(null),{fbo:le,camera:ce,update:fe}=useCubeCamera({resolution:Z,near:te,far:ne,envMap:ie,fog:oe});let de=0;return useFrame(()=>{ae.current&&(_===1/0||de<_)&&(ae.current.visible=!1,fe(),ae.current.visible=!0,de++)}),reactExports.createElement("group",se,reactExports.createElement("primitive",{object:ce}),reactExports.createElement("group",{ref:ae},K==null?void 0:K(le.texture)))}const OrbitControls=reactExports.forwardRef(({makeDefault:K,camera:_,regress:Z,domElement:te,enableDamping:ne=!0,keyEvents:ie=!1,onChange:oe,onStart:se,onEnd:ae,...le},ce)=>{const fe=useThree(be=>be.invalidate),de=useThree(be=>be.camera),pe=useThree(be=>be.gl),he=useThree(be=>be.events),ge=useThree(be=>be.setEvents),me=useThree(be=>be.set),Ae=useThree(be=>be.get),ye=useThree(be=>be.performance),ve=_||de,_e=te||he.connected||pe.domElement,Te=reactExports.useMemo(()=>new OrbitControls$1(ve),[ve]);return useFrame(()=>{Te.enabled&&Te.update()},-1),reactExports.useEffect(()=>(ie&&Te.connect(ie===!0?_e:ie),Te.connect(_e),()=>void Te.dispose()),[ie,_e,Z,Te,fe]),reactExports.useEffect(()=>{const be=Pe=>{fe(),Z&&ye.regress(),oe&&oe(Pe)},Re=Pe=>{se&&se(Pe)},we=Pe=>{ae&&ae(Pe)};return Te.addEventListener("change",be),Te.addEventListener("start",Re),Te.addEventListener("end",we),()=>{Te.removeEventListener("start",Re),Te.removeEventListener("end",we),Te.removeEventListener("change",be)}},[oe,se,ae,Te,fe,ge]),reactExports.useEffect(()=>{if(K){const be=Ae().controls;return me({controls:Te}),()=>me({controls:be})}},[K,Te]),reactExports.createElement("primitive",_extends$3({ref:ce,object:Te,enableDamping:ne},le))});function RenderHud({defaultScene:K,defaultCamera:_,renderPriority:Z=1}){const{gl:te,scene:ne,camera:ie}=useThree();let oe;return useFrame(()=>{oe=te.autoClear,Z===1&&(te.autoClear=!0,te.render(K,_)),te.autoClear=!1,te.clearDepth(),te.render(ne,ie),te.autoClear=oe},Z),reactExports.createElement("group",{onPointerOver:()=>null})}function Hud({children:K,renderPriority:_=1}){const{scene:Z,camera:te}=useThree(),[ne]=reactExports.useState(()=>new Scene$1);return reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,K,reactExports.createElement(RenderHud,{defaultScene:Z,defaultCamera:te,renderPriority:_})),ne,{events:{priority:_+1}}))}const Context$1=reactExports.createContext({}),useGizmoContext=()=>reactExports.useContext(Context$1),turnRate=2*Math.PI,dummy=new Object3D,matrix=new Matrix4,[q1,q2]=[new Quaternion,new Quaternion],target$2=new Vector3,targetPosition=new Vector3,isOrbitControls=K=>"minPolarAngle"in K,isCameraControls=K=>"getTarget"in K,GizmoHelper=({alignment:K="bottom-right",margin:_=[80,80],renderPriority:Z=1,onUpdate:te,onTarget:ne,children:ie})=>{const oe=useThree(be=>be.size),se=useThree(be=>be.camera),ae=useThree(be=>be.controls),le=useThree(be=>be.invalidate),ce=reactExports.useRef(null),fe=reactExports.useRef(null),de=reactExports.useRef(!1),pe=reactExports.useRef(0),he=reactExports.useRef(new Vector3(0,0,0)),ge=reactExports.useRef(new Vector3(0,0,0));reactExports.useEffect(()=>{ge.current.copy(se.up),dummy.up.copy(se.up)},[se]);const me=reactExports.useCallback(be=>{de.current=!0,(ae||ne)&&(he.current=(ne==null?void 0:ne())||(isCameraControls(ae)?ae.getTarget(he.current):ae==null?void 0:ae.target)),pe.current=se.position.distanceTo(target$2),q1.copy(se.quaternion),targetPosition.copy(be).multiplyScalar(pe.current).add(target$2),dummy.lookAt(targetPosition),q2.copy(dummy.quaternion),le()},[ae,se,ne,le]);useFrame((be,Re)=>{if(fe.current&&ce.current){var we;if(de.current)if(q1.angleTo(q2)<.01)de.current=!1,isOrbitControls(ae)&&se.up.copy(ge.current);else{const Pe=Re*turnRate;q1.rotateTowards(q2,Pe),se.position.set(0,0,1).applyQuaternion(q1).multiplyScalar(pe.current).add(he.current),se.up.set(0,1,0).applyQuaternion(q1).normalize(),se.quaternion.copy(q1),isCameraControls(ae)&&ae.setPosition(se.position.x,se.position.y,se.position.z),te?te():ae&&ae.update(Re),le()}matrix.copy(se.matrix).invert(),(we=ce.current)==null||we.quaternion.setFromRotationMatrix(matrix)}});const Ae=reactExports.useMemo(()=>({tweenCamera:me}),[me]),[ye,ve]=_,_e=K.endsWith("-center")?0:K.endsWith("-left")?-oe.width/2+ye:oe.width/2-ye,Te=K.startsWith("center-")?0:K.startsWith("top-")?oe.height/2-ve:-oe.height/2+ve;return reactExports.createElement(Hud,{renderPriority:Z},reactExports.createElement(Context$1.Provider,{value:Ae},reactExports.createElement(OrthographicCamera,{makeDefault:!0,ref:fe,position:[0,0,200]}),reactExports.createElement("group",{ref:ce,position:[_e,Te,0]},ie)))},colors={bg:"#f0f0f0",hover:"#999",text:"black",stroke:"black"},defaultFaces=["Right","Left","Top","Bottom","Front","Back"],makePositionVector=K=>new Vector3(...K).multiplyScalar(.38),corners=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(makePositionVector),cornerDimensions=[.25,.25,.25],edges=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(makePositionVector),edgeDimensions=edges.map(K=>K.toArray().map(_=>_==0?.5:.25)),FaceMaterial=({hover:K,index:_,font:Z="20px Inter var, Arial, sans-serif",faces:te=defaultFaces,color:ne=colors.bg,hoverColor:ie=colors.hover,textColor:oe=colors.text,strokeColor:se=colors.stroke,opacity:ae=1})=>{const le=useThree(fe=>fe.gl),ce=reactExports.useMemo(()=>{const fe=document.createElement("canvas");fe.width=128,fe.height=128;const de=fe.getContext("2d");return de.fillStyle=ne,de.fillRect(0,0,fe.width,fe.height),de.strokeStyle=se,de.strokeRect(0,0,fe.width,fe.height),de.font=Z,de.textAlign="center",de.fillStyle=oe,de.fillText(te[_].toUpperCase(),64,76),new CanvasTexture(fe)},[_,te,Z,ne,oe,se]);return reactExports.createElement("meshBasicMaterial",{map:ce,"map-anisotropy":le.capabilities.getMaxAnisotropy()||1,attach:`material-${_}`,color:K?ie:"white",transparent:!0,opacity:ae})},FaceCube=K=>{const{tweenCamera:_}=useGizmoContext(),[Z,te]=reactExports.useState(null),ne=se=>{se.stopPropagation(),te(null)},ie=se=>{se.stopPropagation(),_(se.face.normal)},oe=se=>{se.stopPropagation(),te(Math.floor(se.faceIndex/2))};return reactExports.createElement("mesh",{onPointerOut:ne,onPointerMove:oe,onClick:K.onClick||ie},[...Array(6)].map((se,ae)=>reactExports.createElement(FaceMaterial,_extends$3({key:ae,index:ae,hover:Z===ae},K))),reactExports.createElement("boxGeometry",null))},EdgeCube=({onClick:K,dimensions:_,position:Z,hoverColor:te=colors.hover})=>{const{tweenCamera:ne}=useGizmoContext(),[ie,oe]=reactExports.useState(!1),se=ce=>{ce.stopPropagation(),oe(!1)},ae=ce=>{ce.stopPropagation(),oe(!0)},le=ce=>{ce.stopPropagation(),ne(Z)};return reactExports.createElement("mesh",{scale:1.01,position:Z,onPointerOver:ae,onPointerOut:se,onClick:K||le},reactExports.createElement("meshBasicMaterial",{color:ie?te:"white",transparent:!0,opacity:.6,visible:ie}),reactExports.createElement("boxGeometry",{args:_}))},GizmoViewcube=K=>reactExports.createElement("group",{scale:[60,60,60]},reactExports.createElement(FaceCube,K),edges.map((_,Z)=>reactExports.createElement(EdgeCube,_extends$3({key:Z,position:_,dimensions:edgeDimensions[Z]},K))),corners.map((_,Z)=>reactExports.createElement(EdgeCube,_extends$3({key:Z,position:_,dimensions:cornerDimensions},K))));function Axis({scale:K=[.8,.05,.05],color:_,rotation:Z}){return reactExports.createElement("group",{rotation:Z},reactExports.createElement("mesh",{position:[.4,0,0]},reactExports.createElement("boxGeometry",{args:K}),reactExports.createElement("meshBasicMaterial",{color:_,toneMapped:!1})))}function AxisHead({onClick:K,font:_,disabled:Z,arcStyle:te,label:ne,labelColor:ie,axisHeadScale:oe=1,...se}){const ae=useThree(ge=>ge.gl),le=reactExports.useMemo(()=>{const ge=document.createElement("canvas");ge.width=64,ge.height=64;const me=ge.getContext("2d");return me.beginPath(),me.arc(32,32,16,0,2*Math.PI),me.closePath(),me.fillStyle=te,me.fill(),ne&&(me.font=_,me.textAlign="center",me.fillStyle=ie,me.fillText(ne,32,41)),new CanvasTexture(ge)},[te,ne,ie,_]),[ce,fe]=reactExports.useState(!1),de=(ne?1:.75)*(ce?1.2:1)*oe,pe=ge=>{ge.stopPropagation(),fe(!0)},he=ge=>{ge.stopPropagation(),fe(!1)};return reactExports.createElement("sprite",_extends$3({scale:de,onPointerOver:Z?void 0:pe,onPointerOut:Z?void 0:K||he},se),reactExports.createElement("spriteMaterial",{map:le,"map-anisotropy":ae.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:ne?1:.75,toneMapped:!1}))}const GizmoViewport=({hideNegativeAxes:K,hideAxisHeads:_,disabled:Z,font:te="18px Inter var, Arial, sans-serif",axisColors:ne=["#ff2060","#20df80","#2080ff"],axisHeadScale:ie=1,axisScale:oe,labels:se=["X","Y","Z"],labelColor:ae="#000",onClick:le,...ce})=>{const[fe,de,pe]=ne,{tweenCamera:he}=useGizmoContext(),ge={font:te,disabled:Z,labelColor:ae,onClick:le,axisHeadScale:ie,onPointerDown:Z?void 0:me=>{he(me.object.position),me.stopPropagation()}};return reactExports.createElement("group",_extends$3({scale:40},ce),reactExports.createElement(Axis,{color:fe,rotation:[0,0,0],scale:oe}),reactExports.createElement(Axis,{color:de,rotation:[0,0,Math.PI/2],scale:oe}),reactExports.createElement(Axis,{color:pe,rotation:[0,-Math.PI/2,0],scale:oe}),!_&&reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(AxisHead,_extends$3({arcStyle:fe,position:[1,0,0],label:se[0]},ge)),reactExports.createElement(AxisHead,_extends$3({arcStyle:de,position:[0,1,0],label:se[1]},ge)),reactExports.createElement(AxisHead,_extends$3({arcStyle:pe,position:[0,0,1],label:se[2]},ge)),!K&&reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(AxisHead,_extends$3({arcStyle:fe,position:[-1,0,0]},ge)),reactExports.createElement(AxisHead,_extends$3({arcStyle:de,position:[0,-1,0]},ge)),reactExports.createElement(AxisHead,_extends$3({arcStyle:pe,position:[0,0,-1]},ge)))))},GridMaterial=shaderMaterial({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Color$1,sectionColor:new Color$1,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new Vector3,worldPlanePosition:new Vector3},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),Grid$1=reactExports.forwardRef(({args:K,cellColor:_="#000000",sectionColor:Z="#2080ff",cellSize:te=.5,sectionSize:ne=1,followCamera:ie=!1,infiniteGrid:oe=!1,fadeDistance:se=100,fadeStrength:ae=1,fadeFrom:le=1,cellThickness:ce=.5,sectionThickness:fe=1,side:de=BackSide,...pe},he)=>{extend$6({GridMaterial});const ge=reactExports.useRef(null);reactExports.useImperativeHandle(he,()=>ge.current,[]);const me=new Plane$2,Ae=new Vector3(0,1,0),ye=new Vector3(0,0,0);useFrame(Te=>{me.setFromNormalAndCoplanarPoint(Ae,ye).applyMatrix4(ge.current.matrixWorld);const be=ge.current.material,Re=be.uniforms.worldCamProjPosition,we=be.uniforms.worldPlanePosition;me.projectPoint(Te.camera.position,Re.value),we.value.set(0,0,0).applyMatrix4(ge.current.matrixWorld)});const ve={cellSize:te,sectionSize:ne,cellColor:_,sectionColor:Z,cellThickness:ce,sectionThickness:fe},_e={fadeDistance:se,fadeStrength:ae,fadeFrom:le,infiniteGrid:oe,followCamera:ie};return reactExports.createElement("mesh",_extends$3({ref:ge,frustumCulled:!1},pe),reactExports.createElement("gridMaterial",_extends$3({transparent:!0,"extensions-derivatives":!0,side:de},ve,_e)),reactExports.createElement("planeGeometry",{args:K}))}),getFirstFrame=(K,_)=>{if(Array.isArray(K))return K[0];{const Z=_??Object.keys(K)[0];return K[Z][0]}},checkIfFrameIsEmpty=K=>{for(let _=3;_<K.length;_+=4)if(K[_]!==0)return!1;return!0};function useSpriteLoader(K,_,Z,te,ne,ie){const oe=reactExports.useRef(useThree(Ue=>Ue.viewport)),se=reactExports.useRef(null),ae=reactExports.useRef(0),le=.1,ce=reactExports.useRef(K),fe=reactExports.useRef(_),de=reactExports.useRef(Z),[pe,he]=reactExports.useState(null),[ge,me]=reactExports.useState(new Texture$1),Ae=reactExports.useMemo(()=>new TextureLoader,[]),[ye,ve]=reactExports.useState(null),_e=reactExports.useCallback((Ue,ke,Ge)=>{const He=ke*(oe.current.aspect>Ue/ke?oe.current.width/Ue:oe.current.height/ke),Ke=Ue*(oe.current.aspect>Ue/ke?oe.current.width/Ue:oe.current.height/ke)*Ge,tt=He*Ge,Je=1;let ot=Math.min(Je,Ke),Fe=Math.min(Je,tt);return Ke>Je&&(ot=Je,Fe=tt/Ke*Je),new Vector3(ot,Fe,1)},[]),Te=reactExports.useCallback((Ue,ke)=>{if(Ue.image){const Ge=document.createElement("canvas"),He=Ge.getContext("2d",ie);if(!He)throw new Error("Failed to get 2d context");Ge.width=Ue.image.width,Ge.height=Ue.image.height,He.drawImage(Ue.image,0,0);const ze=Ue.image.width,Ke=Ue.image.height,tt=Math.round(Math.sqrt(ke*(ze/Ke))),Je=Math.round(ke/tt),ot=ze/tt,Fe=Ke/Je,ct=[];for(let ht=0;ht<Je;ht++)for(let lt=0;lt<tt;lt++){if(ht*tt+lt>=ke){ct.push({row:ht,col:lt});continue}const Ze=He.getImageData(lt*ot,ht*Fe,ot,Fe).data;checkIfFrameIsEmpty(Ze)&&ct.push({row:ht,col:lt})}return{rows:Je,columns:tt,frameWidth:ot,frameHeight:Fe,emptyFrames:ct}}else return{rows:0,columns:0,frameWidth:0,frameHeight:0,emptyFrames:[]}},[ie]),be=reactExports.useCallback(Ue=>{const ke=Ge=>{let He=null;for(const Ke of Ge){const{w:tt,h:Je}=Ke.frame,ot=tt*Je;(!He||ot>He.area)&&(He={w:tt,h:Je,area:ot})}return Ge.map(Ke=>{const{w:tt,h:Je}=Ke.frame,ot=tt*Je,Fe=He?ot===He.area?1:Math.sqrt(ot/He.area):1;return{...Ke,scaleRatio:Fe}})};if(Array.isArray(Ue))return ke(Ue);{const Ge={};for(const He in Ue)Ge[He]=ke(Ue[He]);return Ge}},[]),Re=reactExports.useCallback(()=>{const Ue={},ke=se.current,Ge=de.current;if(ke)if(Ge&&Array.isArray(ke.frames)){for(let He=0;He<Ge.length;He++){Ue[Ge[He]]=[];for(const ze of ke.frames){const Ke=ze.frame,tt=ze.sourceSize.w,Je=ze.sourceSize.h;typeof ze.filename=="string"&&ze.filename.toLowerCase().indexOf(Ge[He].toLowerCase())!==-1&&Ue[Ge[He]].push({...ze,frame:Ke,sourceSize:{w:tt,h:Je}})}}for(const He in Ue){const ze=be(Ue[He]);Array.isArray(ze)&&(Ue[He]=ze)}return Ue}else if(Ge&&typeof ke.frames=="object"){for(let He=0;He<Ge.length;He++){Ue[Ge[He]]=[];for(const ze in ke.frames){const Ke=ke.frames[ze],tt=Ke.frame,Je=Ke.sourceSize.w,ot=Ke.sourceSize.h;typeof ze=="string"&&ze.toLowerCase().indexOf(Ge[He].toLowerCase())!==-1&&Ue[Ge[He]].push({...Ke,frame:tt,sourceSize:{w:Je,h:ot}})}}for(const He in Ue){const ze=be(Ue[He]);Array.isArray(ze)&&(Ue[He]=ze)}return Ue}else{let He=[];return ke!=null&&ke.frames&&(Array.isArray(ke.frames)?He=ke.frames.map(ze=>({...ze,x:ze.frame.x,y:ze.frame.y,w:ze.frame.w,h:ze.frame.h})):He=Object.values(ke.frames).flat().map(ze=>({...ze,x:ze.frame.x,y:ze.frame.y,w:ze.frame.w,h:ze.frame.h}))),be(He)}return[]},[be,se]),we=reactExports.useCallback((Ue,ke)=>{let Ge=new Vector3(1,1,1);if(Ue===null){if(ke&&te){const He=ke.image.width,ze=ke.image.height;ae.current=te;const{rows:Ke,columns:tt,frameWidth:Je,frameHeight:ot,emptyFrames:Fe}=Te(ke,te),ct={frames:[],meta:{version:"1.0",size:{w:He,h:ze},rows:Ke,columns:tt,frameWidth:Je,frameHeight:ot,scale:"1"}};for(let ht=0;ht<Ke;ht++)for(let lt=0;lt<tt;lt++)(Fe??[]).some(Ze=>Ze.row===ht&&Ze.col===lt)||Array.isArray(ct.frames)&&ct.frames.push({frame:{x:lt*Je,y:ht*ot,w:Je,h:ot},scaleRatio:1,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:Je,h:ot},sourceSize:{w:Je,h:ot}});Ge=_e(Je,ot,le),se.current=ct}se.current&&se.current.frames&&(se.current.frames=be(se.current.frames))}else if(ke){se.current=Ue,se.current.frames=Re(),ae.current=Array.isArray(Ue.frames)?Ue.frames.length:Object.keys(Ue.frames).length;const{w:He,h:ze}=getFirstFrame(Ue.frames).sourceSize;Ge=_e(He,ze,le)}he(se.current),"encoding"in ke?ke.encoding=3001:"colorSpace"in ke&&(ke.colorSpace=SRGBColorSpace$2),me(ke),ve({spriteTexture:ke,spriteData:se.current,aspect:Ge})},[Te,te,Re,_e,be]),Pe=reactExports.useCallback((Ue,ke,Ge)=>{const He=fetch(Ue).then(Ke=>Ke.json()),ze=new Promise(Ke=>{Ae.load(ke,Ke)});Promise.all([He,ze]).then(Ke=>{Ge(Ke[0],Ke[1])})},[Ae]),Ie=reactExports.useCallback(Ue=>{if(!Ue&&!ce.current)throw new Error("Either textureUrl or input must be provided");const ke=Ue??ce.current;if(!ke)throw new Error("A valid texture URL must be provided");Ae.load(ke,Ge=>we(null,Ge))},[Ae,we]),$e=reactExports.useCallback((Ue,ke)=>{ke&&Ue?Pe(ke,Ue,we):Ie(Ue)},[Pe,Ie,we]);return reactExports.useLayoutEffect(()=>{fe.current&&ce.current?Pe(fe.current,ce.current,we):ce.current&&Ie();const Ue=ce.current;return()=>{Ue&&useLoader.clear(TextureLoader,Ue)}},[Pe,Ie,we]),reactExports.useLayoutEffect(()=>{ne==null||ne(ge,pe??null)},[ge,pe,ne]),{spriteObj:ye,loadJsonAndTexture:$e}}useSpriteLoader.preload=K=>useLoader.preload(TextureLoader,K);useSpriteLoader.clear=K=>useLoader.clear(TextureLoader,K);function useHelper(K,_,...Z){const te=reactExports.useRef(null),ne=useThree(ie=>ie.scene);return reactExports.useLayoutEffect(()=>{let ie;if(K&&K!=null&&K.current&&_&&(te.current=ie=new _(K.current,...Z)),ie)return ie.traverse(oe=>oe.raycast=()=>null),ne.add(ie),()=>{te.current=void 0,ne.remove(ie),ie.dispose==null||ie.dispose()}},[ne,_,K,...Z]),useFrame(()=>{var ie;return void((ie=te.current)==null||ie.update==null?void 0:ie.update())}),te}const Helper=({type:K,args:_=[]})=>{const Z=reactExports.useRef(null),te=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{te.current=Z.current.parent}),useHelper(te,K,..._),reactExports.createElement("object3D",{ref:Z})},CENTER$1=0,AVERAGE$1=1,SAH$1=2,CONTAINED$1=2,TRIANGLE_INTERSECT_COST$1=1.25,TRAVERSAL_COST$1=1,BYTES_PER_NODE$1=6*4+4+4,IS_LEAFNODE_FLAG$1=65535,FLOAT32_EPSILON$1=Math.pow(2,-24),SKIP_GENERATION$1=Symbol("SKIP_GENERATION");function getVertexCount$1(K){return K.index?K.index.count:K.attributes.position.count}function getTriCount$1(K){return getVertexCount$1(K)/3}function getIndexArray$1(K,_=ArrayBuffer){return K>65535?new Uint32Array(new _(4*K)):new Uint16Array(new _(2*K))}function ensureIndex$1(K,_){if(!K.index){const Z=K.attributes.position.count,te=_.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,ne=getIndexArray$1(Z,te);K.setIndex(new BufferAttribute(ne,1));for(let ie=0;ie<Z;ie++)ne[ie]=ie}}function getFullGeometryRange$1(K,_){const Z=getTriCount$1(K),te=_||K.drawRange,ne=te.start/3,ie=(te.start+te.count)/3,oe=Math.max(0,ne),se=Math.min(Z,ie)-oe;return[{offset:Math.floor(oe),count:Math.floor(se)}]}function getRootIndexRanges$1(K,_){if(!K.groups||!K.groups.length)return getFullGeometryRange$1(K,_);const Z=[],te=new Set,ne=_||K.drawRange,ie=ne.start/3,oe=(ne.start+ne.count)/3;for(const ae of K.groups){const le=ae.start/3,ce=(ae.start+ae.count)/3;te.add(Math.max(ie,le)),te.add(Math.min(oe,ce))}const se=Array.from(te.values()).sort((ae,le)=>ae-le);for(let ae=0;ae<se.length-1;ae++){const le=se[ae],ce=se[ae+1];Z.push({offset:Math.floor(le),count:Math.floor(ce-le)})}return Z}function hasGroupGaps$1(K,_){const Z=getTriCount$1(K),te=getRootIndexRanges$1(K,_).sort((oe,se)=>oe.offset-se.offset),ne=te[te.length-1];ne.count=Math.min(Z-ne.offset,ne.count);let ie=0;return te.forEach(({count:oe})=>ie+=oe),Z!==ie}function getBounds$1(K,_,Z,te,ne){let ie=1/0,oe=1/0,se=1/0,ae=-1/0,le=-1/0,ce=-1/0,fe=1/0,de=1/0,pe=1/0,he=-1/0,ge=-1/0,me=-1/0;for(let Ae=_*6,ye=(_+Z)*6;Ae<ye;Ae+=6){const ve=K[Ae+0],_e=K[Ae+1],Te=ve-_e,be=ve+_e;Te<ie&&(ie=Te),be>ae&&(ae=be),ve<fe&&(fe=ve),ve>he&&(he=ve);const Re=K[Ae+2],we=K[Ae+3],Pe=Re-we,Ie=Re+we;Pe<oe&&(oe=Pe),Ie>le&&(le=Ie),Re<de&&(de=Re),Re>ge&&(ge=Re);const $e=K[Ae+4],Ue=K[Ae+5],ke=$e-Ue,Ge=$e+Ue;ke<se&&(se=ke),Ge>ce&&(ce=Ge),$e<pe&&(pe=$e),$e>me&&(me=$e)}te[0]=ie,te[1]=oe,te[2]=se,te[3]=ae,te[4]=le,te[5]=ce,ne[0]=fe,ne[1]=de,ne[2]=pe,ne[3]=he,ne[4]=ge,ne[5]=me}function computeTriangleBounds$1(K,_=null,Z=null,te=null){const ne=K.attributes.position,ie=K.index?K.index.array:null,oe=getTriCount$1(K),se=ne.normalized;let ae;_===null?(ae=new Float32Array(oe*6),Z=0,te=oe):(ae=_,Z=Z||0,te=te||oe);const le=ne.array,ce=ne.offset||0;let fe=3;ne.isInterleavedBufferAttribute&&(fe=ne.data.stride);const de=["getX","getY","getZ"];for(let pe=Z;pe<Z+te;pe++){const he=pe*3,ge=pe*6;let me=he+0,Ae=he+1,ye=he+2;ie&&(me=ie[me],Ae=ie[Ae],ye=ie[ye]),se||(me=me*fe+ce,Ae=Ae*fe+ce,ye=ye*fe+ce);for(let ve=0;ve<3;ve++){let _e,Te,be;se?(_e=ne[de[ve]](me),Te=ne[de[ve]](Ae),be=ne[de[ve]](ye)):(_e=le[me+ve],Te=le[Ae+ve],be=le[ye+ve]);let Re=_e;Te<Re&&(Re=Te),be<Re&&(Re=be);let we=_e;Te>we&&(we=Te),be>we&&(we=be);const Pe=(we-Re)/2,Ie=ve*2;ae[ge+Ie+0]=Re+Pe,ae[ge+Ie+1]=Pe+(Math.abs(Re)+Pe)*FLOAT32_EPSILON$1}}return ae}function arrayToBox$1(K,_,Z){return Z.min.x=_[K],Z.min.y=_[K+1],Z.min.z=_[K+2],Z.max.x=_[K+3],Z.max.y=_[K+4],Z.max.z=_[K+5],Z}function getLongestEdgeIndex$1(K){let _=-1,Z=-1/0;for(let te=0;te<3;te++){const ne=K[te+3]-K[te];ne>Z&&(Z=ne,_=te)}return _}function copyBounds$1(K,_){_.set(K)}function unionBounds$1(K,_,Z){let te,ne;for(let ie=0;ie<3;ie++){const oe=ie+3;te=K[ie],ne=_[ie],Z[ie]=te<ne?te:ne,te=K[oe],ne=_[oe],Z[oe]=te>ne?te:ne}}function expandByTriangleBounds$1(K,_,Z){for(let te=0;te<3;te++){const ne=_[K+2*te],ie=_[K+2*te+1],oe=ne-ie,se=ne+ie;oe<Z[te]&&(Z[te]=oe),se>Z[te+3]&&(Z[te+3]=se)}}function computeSurfaceArea$1(K){const _=K[3]-K[0],Z=K[4]-K[1],te=K[5]-K[2];return 2*(_*Z+Z*te+te*_)}const BIN_COUNT$1=32,binsSort$1=(K,_)=>K.candidate-_.candidate,sahBins$1=new Array(BIN_COUNT$1).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),leftBounds$1=new Float32Array(6);function getOptimalSplit$1(K,_,Z,te,ne,ie){let oe=-1,se=0;if(ie===CENTER$1)oe=getLongestEdgeIndex$1(_),oe!==-1&&(se=(_[oe]+_[oe+3])/2);else if(ie===AVERAGE$1)oe=getLongestEdgeIndex$1(K),oe!==-1&&(se=getAverage$1(Z,te,ne,oe));else if(ie===SAH$1){const ae=computeSurfaceArea$1(K);let le=TRIANGLE_INTERSECT_COST$1*ne;const ce=te*6,fe=(te+ne)*6;for(let de=0;de<3;de++){const pe=_[de],me=(_[de+3]-pe)/BIN_COUNT$1;if(ne<BIN_COUNT$1/4){const Ae=[...sahBins$1];Ae.length=ne;let ye=0;for(let _e=ce;_e<fe;_e+=6,ye++){const Te=Ae[ye];Te.candidate=Z[_e+2*de],Te.count=0;const{bounds:be,leftCacheBounds:Re,rightCacheBounds:we}=Te;for(let Pe=0;Pe<3;Pe++)we[Pe]=1/0,we[Pe+3]=-1/0,Re[Pe]=1/0,Re[Pe+3]=-1/0,be[Pe]=1/0,be[Pe+3]=-1/0;expandByTriangleBounds$1(_e,Z,be)}Ae.sort(binsSort$1);let ve=ne;for(let _e=0;_e<ve;_e++){const Te=Ae[_e];for(;_e+1<ve&&Ae[_e+1].candidate===Te.candidate;)Ae.splice(_e+1,1),ve--}for(let _e=ce;_e<fe;_e+=6){const Te=Z[_e+2*de];for(let be=0;be<ve;be++){const Re=Ae[be];Te>=Re.candidate?expandByTriangleBounds$1(_e,Z,Re.rightCacheBounds):(expandByTriangleBounds$1(_e,Z,Re.leftCacheBounds),Re.count++)}}for(let _e=0;_e<ve;_e++){const Te=Ae[_e],be=Te.count,Re=ne-Te.count,we=Te.leftCacheBounds,Pe=Te.rightCacheBounds;let Ie=0;be!==0&&(Ie=computeSurfaceArea$1(we)/ae);let $e=0;Re!==0&&($e=computeSurfaceArea$1(Pe)/ae);const Ue=TRAVERSAL_COST$1+TRIANGLE_INTERSECT_COST$1*(Ie*be+$e*Re);Ue<le&&(oe=de,le=Ue,se=Te.candidate)}}else{for(let ve=0;ve<BIN_COUNT$1;ve++){const _e=sahBins$1[ve];_e.count=0,_e.candidate=pe+me+ve*me;const Te=_e.bounds;for(let be=0;be<3;be++)Te[be]=1/0,Te[be+3]=-1/0}for(let ve=ce;ve<fe;ve+=6){let be=~~((Z[ve+2*de]-pe)/me);be>=BIN_COUNT$1&&(be=BIN_COUNT$1-1);const Re=sahBins$1[be];Re.count++,expandByTriangleBounds$1(ve,Z,Re.bounds)}const Ae=sahBins$1[BIN_COUNT$1-1];copyBounds$1(Ae.bounds,Ae.rightCacheBounds);for(let ve=BIN_COUNT$1-2;ve>=0;ve--){const _e=sahBins$1[ve],Te=sahBins$1[ve+1];unionBounds$1(_e.bounds,Te.rightCacheBounds,_e.rightCacheBounds)}let ye=0;for(let ve=0;ve<BIN_COUNT$1-1;ve++){const _e=sahBins$1[ve],Te=_e.count,be=_e.bounds,we=sahBins$1[ve+1].rightCacheBounds;Te!==0&&(ye===0?copyBounds$1(be,leftBounds$1):unionBounds$1(be,leftBounds$1,leftBounds$1)),ye+=Te;let Pe=0,Ie=0;ye!==0&&(Pe=computeSurfaceArea$1(leftBounds$1)/ae);const $e=ne-ye;$e!==0&&(Ie=computeSurfaceArea$1(we)/ae);const Ue=TRAVERSAL_COST$1+TRIANGLE_INTERSECT_COST$1*(Pe*ye+Ie*$e);Ue<le&&(oe=de,le=Ue,se=_e.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${ie} used.`);return{axis:oe,pos:se}}function getAverage$1(K,_,Z,te){let ne=0;for(let ie=_,oe=_+Z;ie<oe;ie++)ne+=K[ie*6+te*2];return ne/Z}let MeshBVHNode$1=class{constructor(){this.boundingData=new Float32Array(6)}};function partition$1(K,_,Z,te,ne,ie){let oe=te,se=te+ne-1;const ae=ie.pos,le=ie.axis*2;for(;;){for(;oe<=se&&Z[oe*6+le]<ae;)oe++;for(;oe<=se&&Z[se*6+le]>=ae;)se--;if(oe<se){for(let ce=0;ce<3;ce++){let fe=_[oe*3+ce];_[oe*3+ce]=_[se*3+ce],_[se*3+ce]=fe}for(let ce=0;ce<6;ce++){let fe=Z[oe*6+ce];Z[oe*6+ce]=Z[se*6+ce],Z[se*6+ce]=fe}oe++,se--}else return oe}}function partition_indirect$1(K,_,Z,te,ne,ie){let oe=te,se=te+ne-1;const ae=ie.pos,le=ie.axis*2;for(;;){for(;oe<=se&&Z[oe*6+le]<ae;)oe++;for(;oe<=se&&Z[se*6+le]>=ae;)se--;if(oe<se){let ce=K[oe];K[oe]=K[se],K[se]=ce;for(let fe=0;fe<6;fe++){let de=Z[oe*6+fe];Z[oe*6+fe]=Z[se*6+fe],Z[se*6+fe]=de}oe++,se--}else return oe}}function IS_LEAF$1(K,_){return _[K+15]===65535}function OFFSET$1(K,_){return _[K+6]}function COUNT$1(K,_){return _[K+14]}function LEFT_NODE$1(K){return K+8}function RIGHT_NODE$1(K,_){return _[K+6]}function SPLIT_AXIS$1(K,_){return _[K+7]}function BOUNDING_DATA_INDEX$1(K){return K}let float32Array$1,uint32Array$1,uint16Array$1,uint8Array$1;const MAX_POINTER$1=Math.pow(2,32);function countNodes$1(K){return"count"in K?1:1+countNodes$1(K.left)+countNodes$1(K.right)}function populateBuffer$1(K,_,Z){return float32Array$1=new Float32Array(Z),uint32Array$1=new Uint32Array(Z),uint16Array$1=new Uint16Array(Z),uint8Array$1=new Uint8Array(Z),_populateBuffer$1(K,_)}function _populateBuffer$1(K,_){const Z=K/4,te=K/2,ne="count"in _,ie=_.boundingData;for(let oe=0;oe<6;oe++)float32Array$1[Z+oe]=ie[oe];if(ne)if(_.buffer){const oe=_.buffer;uint8Array$1.set(new Uint8Array(oe),K);for(let se=K,ae=K+oe.byteLength;se<ae;se+=BYTES_PER_NODE$1){const le=se/2;IS_LEAF$1(le,uint16Array$1)||(uint32Array$1[se/4+6]+=Z)}return K+oe.byteLength}else{const oe=_.offset,se=_.count;return uint32Array$1[Z+6]=oe,uint16Array$1[te+14]=se,uint16Array$1[te+15]=IS_LEAFNODE_FLAG$1,K+BYTES_PER_NODE$1}else{const oe=_.left,se=_.right,ae=_.splitAxis;let le;if(le=_populateBuffer$1(K+BYTES_PER_NODE$1,oe),le/4>MAX_POINTER$1)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return uint32Array$1[Z+6]=le/4,le=_populateBuffer$1(le,se),uint32Array$1[Z+7]=ae,le}}function generateIndirectBuffer$1(K,_){const Z=(K.index?K.index.count:K.attributes.position.count)/3,te=Z>2**16,ne=te?4:2,ie=_?new SharedArrayBuffer(Z*ne):new ArrayBuffer(Z*ne),oe=te?new Uint32Array(ie):new Uint16Array(ie);for(let se=0,ae=oe.length;se<ae;se++)oe[se]=se;return oe}function buildTree$2(K,_,Z,te,ne){const{maxDepth:ie,verbose:oe,maxLeafTris:se,strategy:ae,onProgress:le,indirect:ce}=ne,fe=K._indirectBuffer,de=K.geometry,pe=de.index?de.index.array:null,he=ce?partition_indirect$1:partition$1,ge=getTriCount$1(de),me=new Float32Array(6);let Ae=!1;const ye=new MeshBVHNode$1;return getBounds$1(_,Z,te,ye.boundingData,me),_e(ye,Z,te,me),ye;function ve(Te){le&&le(Te/ge)}function _e(Te,be,Re,we=null,Pe=0){if(!Ae&&Pe>=ie&&(Ae=!0,oe&&(console.warn(`MeshBVH: Max depth of ${ie} reached when generating BVH. Consider increasing maxDepth.`),console.warn(de))),Re<=se||Pe>=ie)return ve(be+Re),Te.offset=be,Te.count=Re,Te;const Ie=getOptimalSplit$1(Te.boundingData,we,_,be,Re,ae);if(Ie.axis===-1)return ve(be+Re),Te.offset=be,Te.count=Re,Te;const $e=he(fe,pe,_,be,Re,Ie);if($e===be||$e===be+Re)ve(be+Re),Te.offset=be,Te.count=Re;else{Te.splitAxis=Ie.axis;const Ue=new MeshBVHNode$1,ke=be,Ge=$e-be;Te.left=Ue,getBounds$1(_,ke,Ge,Ue.boundingData,me),_e(Ue,ke,Ge,me,Pe+1);const He=new MeshBVHNode$1,ze=$e,Ke=Re-Ge;Te.right=He,getBounds$1(_,ze,Ke,He.boundingData,me),_e(He,ze,Ke,me,Pe+1)}return Te}}function buildPackedTree$1(K,_){const Z=K.geometry;_.indirect&&(K._indirectBuffer=generateIndirectBuffer$1(Z,_.useSharedArrayBuffer),hasGroupGaps$1(Z,_.range)&&!_.verbose&&console.warn('MeshBVH: Provided geometry contains groups or a range that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),K._indirectBuffer||ensureIndex$1(Z,_);const te=_.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,ne=computeTriangleBounds$1(Z),ie=_.indirect?getFullGeometryRange$1(Z,_.range):getRootIndexRanges$1(Z,_.range);K._roots=ie.map(oe=>{const se=buildTree$2(K,ne,oe.offset,oe.count,_),ae=countNodes$1(se),le=new te(BYTES_PER_NODE$1*ae);return populateBuffer$1(0,se,le),le})}let SeparatingAxisBounds$1=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(_,Z){let te=1/0,ne=-1/0;for(let ie=0,oe=_.length;ie<oe;ie++){const ae=_[ie][Z];te=ae<te?ae:te,ne=ae>ne?ae:ne}this.min=te,this.max=ne}setFromPoints(_,Z){let te=1/0,ne=-1/0;for(let ie=0,oe=Z.length;ie<oe;ie++){const se=Z[ie],ae=_.dot(se);te=ae<te?ae:te,ne=ae>ne?ae:ne}this.min=te,this.max=ne}isSeparated(_){return this.min>_.max||_.min>this.max}};SeparatingAxisBounds$1.prototype.setFromBox=function(){const K=new Vector3;return function(Z,te){const ne=te.min,ie=te.max;let oe=1/0,se=-1/0;for(let ae=0;ae<=1;ae++)for(let le=0;le<=1;le++)for(let ce=0;ce<=1;ce++){K.x=ne.x*ae+ie.x*(1-ae),K.y=ne.y*le+ie.y*(1-le),K.z=ne.z*ce+ie.z*(1-ce);const fe=Z.dot(K);oe=Math.min(fe,oe),se=Math.max(fe,se)}this.min=oe,this.max=se}}();const closestPointLineToLine$1=function(){const K=new Vector3,_=new Vector3,Z=new Vector3;return function(ne,ie,oe){const se=ne.start,ae=K,le=ie.start,ce=_;Z.subVectors(se,le),K.subVectors(ne.end,ne.start),_.subVectors(ie.end,ie.start);const fe=Z.dot(ce),de=ce.dot(ae),pe=ce.dot(ce),he=Z.dot(ae),me=ae.dot(ae)*pe-de*de;let Ae,ye;me!==0?Ae=(fe*de-he*pe)/me:Ae=0,ye=(fe+Ae*de)/pe,oe.x=Ae,oe.y=ye}}(),closestPointsSegmentToSegment$1=function(){const K=new Vector2,_=new Vector3,Z=new Vector3;return function(ne,ie,oe,se){closestPointLineToLine$1(ne,ie,K);let ae=K.x,le=K.y;if(ae>=0&&ae<=1&&le>=0&&le<=1){ne.at(ae,oe),ie.at(le,se);return}else if(ae>=0&&ae<=1){le<0?ie.at(0,se):ie.at(1,se),ne.closestPointToPoint(se,!0,oe);return}else if(le>=0&&le<=1){ae<0?ne.at(0,oe):ne.at(1,oe),ie.closestPointToPoint(oe,!0,se);return}else{let ce;ae<0?ce=ne.start:ce=ne.end;let fe;le<0?fe=ie.start:fe=ie.end;const de=_,pe=Z;if(ne.closestPointToPoint(fe,!0,_),ie.closestPointToPoint(ce,!0,Z),de.distanceToSquared(fe)<=pe.distanceToSquared(ce)){oe.copy(de),se.copy(fe);return}else{oe.copy(ce),se.copy(pe);return}}}}(),sphereIntersectTriangle$1=function(){const K=new Vector3,_=new Vector3,Z=new Plane$2,te=new Line3;return function(ie,oe){const{radius:se,center:ae}=ie,{a:le,b:ce,c:fe}=oe;if(te.start=le,te.end=ce,te.closestPointToPoint(ae,!0,K).distanceTo(ae)<=se||(te.start=le,te.end=fe,te.closestPointToPoint(ae,!0,K).distanceTo(ae)<=se)||(te.start=ce,te.end=fe,te.closestPointToPoint(ae,!0,K).distanceTo(ae)<=se))return!0;const ge=oe.getPlane(Z);if(Math.abs(ge.distanceToPoint(ae))<=se){const Ae=ge.projectPoint(ae,_);if(oe.containsPoint(Ae))return!0}return!1}}(),ZERO_EPSILON$1=1e-15;function isNearZero$1(K){return Math.abs(K)<ZERO_EPSILON$1}let ExtendedTriangle$1=class extends Triangle{constructor(..._){super(..._),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new Vector3),this.satBounds=new Array(4).fill().map(()=>new SeparatingAxisBounds$1),this.points=[this.a,this.b,this.c],this.sphere=new Sphere$2,this.plane=new Plane$2,this.needsUpdate=!0}intersectsSphere(_){return sphereIntersectTriangle$1(_,this)}update(){const _=this.a,Z=this.b,te=this.c,ne=this.points,ie=this.satAxes,oe=this.satBounds,se=ie[0],ae=oe[0];this.getNormal(se),ae.setFromPoints(se,ne);const le=ie[1],ce=oe[1];le.subVectors(_,Z),ce.setFromPoints(le,ne);const fe=ie[2],de=oe[2];fe.subVectors(Z,te),de.setFromPoints(fe,ne);const pe=ie[3],he=oe[3];pe.subVectors(te,_),he.setFromPoints(pe,ne),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(se,_),this.needsUpdate=!1}};ExtendedTriangle$1.prototype.closestPointToSegment=function(){const K=new Vector3,_=new Vector3,Z=new Line3;return function(ne,ie=null,oe=null){const{start:se,end:ae}=ne,le=this.points;let ce,fe=1/0;for(let de=0;de<3;de++){const pe=(de+1)%3;Z.start.copy(le[de]),Z.end.copy(le[pe]),closestPointsSegmentToSegment$1(Z,ne,K,_),ce=K.distanceToSquared(_),ce<fe&&(fe=ce,ie&&ie.copy(K),oe&&oe.copy(_))}return this.closestPointToPoint(se,K),ce=se.distanceToSquared(K),ce<fe&&(fe=ce,ie&&ie.copy(K),oe&&oe.copy(se)),this.closestPointToPoint(ae,K),ce=ae.distanceToSquared(K),ce<fe&&(fe=ce,ie&&ie.copy(K),oe&&oe.copy(ae)),Math.sqrt(fe)}}();ExtendedTriangle$1.prototype.intersectsTriangle=function(){const K=new ExtendedTriangle$1,_=new Array(3),Z=new Array(3),te=new SeparatingAxisBounds$1,ne=new SeparatingAxisBounds$1,ie=new Vector3,oe=new Vector3,se=new Vector3,ae=new Vector3,le=new Vector3,ce=new Line3,fe=new Line3,de=new Line3,pe=new Vector3;function he(ge,me,Ae){const ye=ge.points;let ve=0,_e=-1;for(let Te=0;Te<3;Te++){const{start:be,end:Re}=ce;be.copy(ye[Te]),Re.copy(ye[(Te+1)%3]),ce.delta(oe);const we=isNearZero$1(me.distanceToPoint(be));if(isNearZero$1(me.normal.dot(oe))&&we){Ae.copy(ce),ve=2;break}const Pe=me.intersectLine(ce,pe);if(!Pe&&we&&pe.copy(be),(Pe||we)&&!isNearZero$1(pe.distanceTo(Re))){if(ve<=1)(ve===1?Ae.start:Ae.end).copy(pe),we&&(_e=ve);else if(ve>=2){(_e===1?Ae.start:Ae.end).copy(pe),ve=2;break}if(ve++,ve===2&&_e===-1)break}}return ve}return function(me,Ae=null,ye=!1){this.needsUpdate&&this.update(),me.isExtendedTriangle?me.needsUpdate&&me.update():(K.copy(me),K.update(),me=K);const ve=this.plane,_e=me.plane;if(Math.abs(ve.normal.dot(_e.normal))>1-1e-10){const Te=this.satBounds,be=this.satAxes;Z[0]=me.a,Z[1]=me.b,Z[2]=me.c;for(let Pe=0;Pe<4;Pe++){const Ie=Te[Pe],$e=be[Pe];if(te.setFromPoints($e,Z),Ie.isSeparated(te))return!1}const Re=me.satBounds,we=me.satAxes;_[0]=this.a,_[1]=this.b,_[2]=this.c;for(let Pe=0;Pe<4;Pe++){const Ie=Re[Pe],$e=we[Pe];if(te.setFromPoints($e,_),Ie.isSeparated(te))return!1}for(let Pe=0;Pe<4;Pe++){const Ie=be[Pe];for(let $e=0;$e<4;$e++){const Ue=we[$e];if(ie.crossVectors(Ie,Ue),te.setFromPoints(ie,_),ne.setFromPoints(ie,Z),te.isSeparated(ne))return!1}}return Ae&&(ye||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),Ae.start.set(0,0,0),Ae.end.set(0,0,0)),!0}else{const Te=he(this,_e,fe);if(Te===1&&me.containsPoint(fe.end))return Ae&&(Ae.start.copy(fe.end),Ae.end.copy(fe.end)),!0;if(Te!==2)return!1;const be=he(me,ve,de);if(be===1&&this.containsPoint(de.end))return Ae&&(Ae.start.copy(de.end),Ae.end.copy(de.end)),!0;if(be!==2)return!1;if(fe.delta(se),de.delta(ae),se.dot(ae)<0){let ke=de.start;de.start=de.end,de.end=ke}const Re=fe.start.dot(se),we=fe.end.dot(se),Pe=de.start.dot(se),Ie=de.end.dot(se),$e=we<Pe,Ue=Re<Ie;return Re!==Ie&&Pe!==we&&$e===Ue?!1:(Ae&&(le.subVectors(fe.start,de.start),le.dot(se)>0?Ae.start.copy(fe.start):Ae.start.copy(de.start),le.subVectors(fe.end,de.end),le.dot(se)<0?Ae.end.copy(fe.end):Ae.end.copy(de.end)),!0)}}}();ExtendedTriangle$1.prototype.distanceToPoint=function(){const K=new Vector3;return function(Z){return this.closestPointToPoint(Z,K),Z.distanceTo(K)}}();ExtendedTriangle$1.prototype.distanceToTriangle=function(){const K=new Vector3,_=new Vector3,Z=["a","b","c"],te=new Line3,ne=new Line3;return function(oe,se=null,ae=null){const le=se||ae?te:null;if(this.intersectsTriangle(oe,le))return(se||ae)&&(se&&le.getCenter(se),ae&&le.getCenter(ae)),0;let ce=1/0;for(let fe=0;fe<3;fe++){let de;const pe=Z[fe],he=oe[pe];this.closestPointToPoint(he,K),de=he.distanceToSquared(K),de<ce&&(ce=de,se&&se.copy(K),ae&&ae.copy(he));const ge=this[pe];oe.closestPointToPoint(ge,K),de=ge.distanceToSquared(K),de<ce&&(ce=de,se&&se.copy(ge),ae&&ae.copy(K))}for(let fe=0;fe<3;fe++){const de=Z[fe],pe=Z[(fe+1)%3];te.set(this[de],this[pe]);for(let he=0;he<3;he++){const ge=Z[he],me=Z[(he+1)%3];ne.set(oe[ge],oe[me]),closestPointsSegmentToSegment$1(te,ne,K,_);const Ae=K.distanceToSquared(_);Ae<ce&&(ce=Ae,se&&se.copy(K),ae&&ae.copy(_))}}return Math.sqrt(ce)}}();let OrientedBox$1=class{constructor(_,Z,te){this.isOrientedBox=!0,this.min=new Vector3,this.max=new Vector3,this.matrix=new Matrix4,this.invMatrix=new Matrix4,this.points=new Array(8).fill().map(()=>new Vector3),this.satAxes=new Array(3).fill().map(()=>new Vector3),this.satBounds=new Array(3).fill().map(()=>new SeparatingAxisBounds$1),this.alignedSatBounds=new Array(3).fill().map(()=>new SeparatingAxisBounds$1),this.needsUpdate=!1,_&&this.min.copy(_),Z&&this.max.copy(Z),te&&this.matrix.copy(te)}set(_,Z,te){this.min.copy(_),this.max.copy(Z),this.matrix.copy(te),this.needsUpdate=!0}copy(_){this.min.copy(_.min),this.max.copy(_.max),this.matrix.copy(_.matrix),this.needsUpdate=!0}};OrientedBox$1.prototype.update=function(){return function(){const _=this.matrix,Z=this.min,te=this.max,ne=this.points;for(let le=0;le<=1;le++)for(let ce=0;ce<=1;ce++)for(let fe=0;fe<=1;fe++){const de=1*le|2*ce|4*fe,pe=ne[de];pe.x=le?te.x:Z.x,pe.y=ce?te.y:Z.y,pe.z=fe?te.z:Z.z,pe.applyMatrix4(_)}const ie=this.satBounds,oe=this.satAxes,se=ne[0];for(let le=0;le<3;le++){const ce=oe[le],fe=ie[le],de=1<<le,pe=ne[de];ce.subVectors(se,pe),fe.setFromPoints(ce,ne)}const ae=this.alignedSatBounds;ae[0].setFromPointsField(ne,"x"),ae[1].setFromPointsField(ne,"y"),ae[2].setFromPointsField(ne,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();OrientedBox$1.prototype.intersectsBox=function(){const K=new SeparatingAxisBounds$1;return function(Z){this.needsUpdate&&this.update();const te=Z.min,ne=Z.max,ie=this.satBounds,oe=this.satAxes,se=this.alignedSatBounds;if(K.min=te.x,K.max=ne.x,se[0].isSeparated(K)||(K.min=te.y,K.max=ne.y,se[1].isSeparated(K))||(K.min=te.z,K.max=ne.z,se[2].isSeparated(K)))return!1;for(let ae=0;ae<3;ae++){const le=oe[ae],ce=ie[ae];if(K.setFromBox(le,Z),ce.isSeparated(K))return!1}return!0}}();OrientedBox$1.prototype.intersectsTriangle=function(){const K=new ExtendedTriangle$1,_=new Array(3),Z=new SeparatingAxisBounds$1,te=new SeparatingAxisBounds$1,ne=new Vector3;return function(oe){this.needsUpdate&&this.update(),oe.isExtendedTriangle?oe.needsUpdate&&oe.update():(K.copy(oe),K.update(),oe=K);const se=this.satBounds,ae=this.satAxes;_[0]=oe.a,_[1]=oe.b,_[2]=oe.c;for(let de=0;de<3;de++){const pe=se[de],he=ae[de];if(Z.setFromPoints(he,_),pe.isSeparated(Z))return!1}const le=oe.satBounds,ce=oe.satAxes,fe=this.points;for(let de=0;de<3;de++){const pe=le[de],he=ce[de];if(Z.setFromPoints(he,fe),pe.isSeparated(Z))return!1}for(let de=0;de<3;de++){const pe=ae[de];for(let he=0;he<4;he++){const ge=ce[he];if(ne.crossVectors(pe,ge),Z.setFromPoints(ne,_),te.setFromPoints(ne,fe),Z.isSeparated(te))return!1}}return!0}}();OrientedBox$1.prototype.closestPointToPoint=function(){return function(_,Z){return this.needsUpdate&&this.update(),Z.copy(_).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),Z}}();OrientedBox$1.prototype.distanceToPoint=function(){const K=new Vector3;return function(Z){return this.closestPointToPoint(Z,K),Z.distanceTo(K)}}();OrientedBox$1.prototype.distanceToBox=function(){const K=["x","y","z"],_=new Array(12).fill().map(()=>new Line3),Z=new Array(12).fill().map(()=>new Line3),te=new Vector3,ne=new Vector3;return function(oe,se=0,ae=null,le=null){if(this.needsUpdate&&this.update(),this.intersectsBox(oe))return(ae||le)&&(oe.getCenter(ne),this.closestPointToPoint(ne,te),oe.closestPointToPoint(te,ne),ae&&ae.copy(te),le&&le.copy(ne)),0;const ce=se*se,fe=oe.min,de=oe.max,pe=this.points;let he=1/0;for(let me=0;me<8;me++){const Ae=pe[me];ne.copy(Ae).clamp(fe,de);const ye=Ae.distanceToSquared(ne);if(ye<he&&(he=ye,ae&&ae.copy(Ae),le&&le.copy(ne),ye<ce))return Math.sqrt(ye)}let ge=0;for(let me=0;me<3;me++)for(let Ae=0;Ae<=1;Ae++)for(let ye=0;ye<=1;ye++){const ve=(me+1)%3,_e=(me+2)%3,Te=Ae<<ve|ye<<_e,be=1<<me|Ae<<ve|ye<<_e,Re=pe[Te],we=pe[be];_[ge].set(Re,we);const Ie=K[me],$e=K[ve],Ue=K[_e],ke=Z[ge],Ge=ke.start,He=ke.end;Ge[Ie]=fe[Ie],Ge[$e]=Ae?fe[$e]:de[$e],Ge[Ue]=ye?fe[Ue]:de[$e],He[Ie]=de[Ie],He[$e]=Ae?fe[$e]:de[$e],He[Ue]=ye?fe[Ue]:de[$e],ge++}for(let me=0;me<=1;me++)for(let Ae=0;Ae<=1;Ae++)for(let ye=0;ye<=1;ye++){ne.x=me?de.x:fe.x,ne.y=Ae?de.y:fe.y,ne.z=ye?de.z:fe.z,this.closestPointToPoint(ne,te);const ve=ne.distanceToSquared(te);if(ve<he&&(he=ve,ae&&ae.copy(te),le&&le.copy(ne),ve<ce))return Math.sqrt(ve)}for(let me=0;me<12;me++){const Ae=_[me];for(let ye=0;ye<12;ye++){const ve=Z[ye];closestPointsSegmentToSegment$1(Ae,ve,te,ne);const _e=te.distanceToSquared(ne);if(_e<he&&(he=_e,ae&&ae.copy(te),le&&le.copy(ne),_e<ce))return Math.sqrt(_e)}}return Math.sqrt(he)}}();let PrimitivePool$1=class{constructor(_){this._getNewPrimitive=_,this._primitives=[]}getPrimitive(){const _=this._primitives;return _.length===0?this._getNewPrimitive():_.pop()}releasePrimitive(_){this._primitives.push(_)}},ExtendedTrianglePoolBase$1=class extends PrimitivePool$1{constructor(){super(()=>new ExtendedTriangle$1)}};const ExtendedTrianglePool$1=new ExtendedTrianglePoolBase$1;let _BufferStack$1=class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const _=[];let Z=null;this.setBuffer=te=>{Z&&_.push(Z),Z=te,this.float32Array=new Float32Array(te),this.uint16Array=new Uint16Array(te),this.uint32Array=new Uint32Array(te)},this.clearBuffer=()=>{Z=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,_.length!==0&&this.setBuffer(_.pop())}}};const BufferStack$1=new _BufferStack$1;let _box1$1,_box2$1;const boxStack$1=[],boxPool$1=new PrimitivePool$1(()=>new Box3);function shapecast$1(K,_,Z,te,ne,ie){_box1$1=boxPool$1.getPrimitive(),_box2$1=boxPool$1.getPrimitive(),boxStack$1.push(_box1$1,_box2$1),BufferStack$1.setBuffer(K._roots[_]);const oe=shapecastTraverse$1(0,K.geometry,Z,te,ne,ie);BufferStack$1.clearBuffer(),boxPool$1.releasePrimitive(_box1$1),boxPool$1.releasePrimitive(_box2$1),boxStack$1.pop(),boxStack$1.pop();const se=boxStack$1.length;return se>0&&(_box2$1=boxStack$1[se-1],_box1$1=boxStack$1[se-2]),oe}function shapecastTraverse$1(K,_,Z,te,ne=null,ie=0,oe=0){const{float32Array:se,uint16Array:ae,uint32Array:le}=BufferStack$1;let ce=K*2;if(IS_LEAF$1(ce,ae)){const de=OFFSET$1(K,le),pe=COUNT$1(ce,ae);return arrayToBox$1(K,se,_box1$1),te(de,pe,!1,oe,ie+K,_box1$1)}else{let Ie=function(Ue){const{uint16Array:ke,uint32Array:Ge}=BufferStack$1;let He=Ue*2;for(;!IS_LEAF$1(He,ke);)Ue=LEFT_NODE$1(Ue),He=Ue*2;return OFFSET$1(Ue,Ge)},$e=function(Ue){const{uint16Array:ke,uint32Array:Ge}=BufferStack$1;let He=Ue*2;for(;!IS_LEAF$1(He,ke);)Ue=RIGHT_NODE$1(Ue,Ge),He=Ue*2;return OFFSET$1(Ue,Ge)+COUNT$1(He,ke)};const de=LEFT_NODE$1(K),pe=RIGHT_NODE$1(K,le);let he=de,ge=pe,me,Ae,ye,ve;if(ne&&(ye=_box1$1,ve=_box2$1,arrayToBox$1(he,se,ye),arrayToBox$1(ge,se,ve),me=ne(ye),Ae=ne(ve),Ae<me)){he=pe,ge=de;const Ue=me;me=Ae,Ae=Ue,ye=ve}ye||(ye=_box1$1,arrayToBox$1(he,se,ye));const _e=IS_LEAF$1(he*2,ae),Te=Z(ye,_e,me,oe+1,ie+he);let be;if(Te===CONTAINED$1){const Ue=Ie(he),Ge=$e(he)-Ue;be=te(Ue,Ge,!0,oe+1,ie+he,ye)}else be=Te&&shapecastTraverse$1(he,_,Z,te,ne,ie,oe+1);if(be)return!0;ve=_box2$1,arrayToBox$1(ge,se,ve);const Re=IS_LEAF$1(ge*2,ae),we=Z(ve,Re,Ae,oe+1,ie+ge);let Pe;if(we===CONTAINED$1){const Ue=Ie(ge),Ge=$e(ge)-Ue;Pe=te(Ue,Ge,!0,oe+1,ie+ge,ve)}else Pe=we&&shapecastTraverse$1(ge,_,Z,te,ne,ie,oe+1);return!!Pe}}const temp$1=new Vector3,temp1$5=new Vector3;function closestPointToPoint$1(K,_,Z={},te=0,ne=1/0){const ie=te*te,oe=ne*ne;let se=1/0,ae=null;if(K.shapecast({boundsTraverseOrder:ce=>(temp$1.copy(_).clamp(ce.min,ce.max),temp$1.distanceToSquared(_)),intersectsBounds:(ce,fe,de)=>de<se&&de<oe,intersectsTriangle:(ce,fe)=>{ce.closestPointToPoint(_,temp$1);const de=_.distanceToSquared(temp$1);return de<se&&(temp1$5.copy(temp$1),se=de,ae=fe),de<ie}}),se===1/0)return null;const le=Math.sqrt(se);return Z.point?Z.point.copy(temp1$5):Z.point=temp1$5.clone(),Z.distance=le,Z.faceIndex=ae,Z}const IS_GT_REVISION_169=parseInt(REVISION)>=169,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA$1=new Vector3,_normalB$1=new Vector3,_normalC$1=new Vector3,_intersectionPoint$1=new Vector3;function checkIntersection$1(K,_,Z,te,ne,ie,oe,se){let ae;if(ie===BackSide?ae=K.intersectTriangle(te,Z,_,!0,ne):ae=K.intersectTriangle(_,Z,te,ie!==DoubleSide,ne),ae===null)return null;const le=K.origin.distanceTo(ne);return le<oe||le>se?null:{distance:le,point:ne.clone()}}function checkBufferGeometryIntersection$1(K,_,Z,te,ne,ie,oe,se,ae,le,ce){_vA$1.fromBufferAttribute(_,ie),_vB$1.fromBufferAttribute(_,oe),_vC$1.fromBufferAttribute(_,se);const fe=checkIntersection$1(K,_vA$1,_vB$1,_vC$1,_intersectionPoint$1,ae,le,ce);if(fe){const de=new Vector3;Triangle.getBarycoord(_intersectionPoint$1,_vA$1,_vB$1,_vC$1,de),te&&(_uvA$1.fromBufferAttribute(te,ie),_uvB$1.fromBufferAttribute(te,oe),_uvC$1.fromBufferAttribute(te,se),fe.uv=Triangle.getInterpolation(_intersectionPoint$1,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),ne&&(_uvA$1.fromBufferAttribute(ne,ie),_uvB$1.fromBufferAttribute(ne,oe),_uvC$1.fromBufferAttribute(ne,se),fe.uv1=Triangle.getInterpolation(_intersectionPoint$1,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),Z&&(_normalA$1.fromBufferAttribute(Z,ie),_normalB$1.fromBufferAttribute(Z,oe),_normalC$1.fromBufferAttribute(Z,se),fe.normal=Triangle.getInterpolation(_intersectionPoint$1,_vA$1,_vB$1,_vC$1,_normalA$1,_normalB$1,_normalC$1,new Vector3),fe.normal.dot(K.direction)>0&&fe.normal.multiplyScalar(-1));const pe={a:ie,b:oe,c:se,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,pe.normal),fe.face=pe,fe.faceIndex=ie,IS_GT_REVISION_169&&(fe.barycoord=de)}return fe}function intersectTri$1(K,_,Z,te,ne,ie,oe){const se=te*3;let ae=se+0,le=se+1,ce=se+2;const fe=K.index;K.index&&(ae=fe.getX(ae),le=fe.getX(le),ce=fe.getX(ce));const{position:de,normal:pe,uv:he,uv1:ge}=K.attributes,me=checkBufferGeometryIntersection$1(Z,de,pe,he,ge,ae,le,ce,_,ie,oe);return me?(me.faceIndex=te,ne&&ne.push(me),me):null}function setTriangle$1(K,_,Z,te){const ne=K.a,ie=K.b,oe=K.c;let se=_,ae=_+1,le=_+2;Z&&(se=Z.getX(se),ae=Z.getX(ae),le=Z.getX(le)),ne.x=te.getX(se),ne.y=te.getY(se),ne.z=te.getZ(se),ie.x=te.getX(ae),ie.y=te.getY(ae),ie.z=te.getZ(ae),oe.x=te.getX(le),oe.y=te.getY(le),oe.z=te.getZ(le)}function intersectTris$1(K,_,Z,te,ne,ie,oe,se){const{geometry:ae,_indirectBuffer:le}=K;for(let ce=te,fe=te+ne;ce<fe;ce++)intersectTri$1(ae,_,Z,ce,ie,oe,se)}function intersectClosestTri$1(K,_,Z,te,ne,ie,oe){const{geometry:se,_indirectBuffer:ae}=K;let le=1/0,ce=null;for(let fe=te,de=te+ne;fe<de;fe++){let pe;pe=intersectTri$1(se,_,Z,fe,null,ie,oe),pe&&pe.distance<le&&(ce=pe,le=pe.distance)}return ce}function iterateOverTriangles$1(K,_,Z,te,ne,ie,oe){const{geometry:se}=Z,{index:ae}=se,le=se.attributes.position;for(let ce=K,fe=_+K;ce<fe;ce++){let de;if(de=ce,setTriangle$1(oe,de*3,ae,le),oe.needsUpdate=!0,te(oe,de,ne,ie))return!0}return!1}function refit$1(K,_=null){_&&Array.isArray(_)&&(_=new Set(_));const Z=K.geometry,te=Z.index?Z.index.array:null,ne=Z.attributes.position;let ie,oe,se,ae,le=0;const ce=K._roots;for(let de=0,pe=ce.length;de<pe;de++)ie=ce[de],oe=new Uint32Array(ie),se=new Uint16Array(ie),ae=new Float32Array(ie),fe(0,le),le+=ie.byteLength;function fe(de,pe,he=!1){const ge=de*2;if(se[ge+15]===IS_LEAFNODE_FLAG$1){const Ae=oe[de+6],ye=se[ge+14];let ve=1/0,_e=1/0,Te=1/0,be=-1/0,Re=-1/0,we=-1/0;for(let Pe=3*Ae,Ie=3*(Ae+ye);Pe<Ie;Pe++){let $e=te[Pe];const Ue=ne.getX($e),ke=ne.getY($e),Ge=ne.getZ($e);Ue<ve&&(ve=Ue),Ue>be&&(be=Ue),ke<_e&&(_e=ke),ke>Re&&(Re=ke),Ge<Te&&(Te=Ge),Ge>we&&(we=Ge)}return ae[de+0]!==ve||ae[de+1]!==_e||ae[de+2]!==Te||ae[de+3]!==be||ae[de+4]!==Re||ae[de+5]!==we?(ae[de+0]=ve,ae[de+1]=_e,ae[de+2]=Te,ae[de+3]=be,ae[de+4]=Re,ae[de+5]=we,!0):!1}else{const Ae=de+8,ye=oe[de+6],ve=Ae+pe,_e=ye+pe;let Te=he,be=!1,Re=!1;_?Te||(be=_.has(ve),Re=_.has(_e),Te=!be&&!Re):(be=!0,Re=!0);const we=Te||be,Pe=Te||Re;let Ie=!1;we&&(Ie=fe(Ae,pe,Te));let $e=!1;Pe&&($e=fe(ye,pe,Te));const Ue=Ie||$e;if(Ue)for(let ke=0;ke<3;ke++){const Ge=Ae+ke,He=ye+ke,ze=ae[Ge],Ke=ae[Ge+3],tt=ae[He],Je=ae[He+3];ae[de+ke]=ze<tt?ze:tt,ae[de+ke+3]=Ke>Je?Ke:Je}return Ue}}}function intersectRay$1(K,_,Z,te,ne){let ie,oe,se,ae,le,ce;const fe=1/Z.direction.x,de=1/Z.direction.y,pe=1/Z.direction.z,he=Z.origin.x,ge=Z.origin.y,me=Z.origin.z;let Ae=_[K],ye=_[K+3],ve=_[K+1],_e=_[K+3+1],Te=_[K+2],be=_[K+3+2];return fe>=0?(ie=(Ae-he)*fe,oe=(ye-he)*fe):(ie=(ye-he)*fe,oe=(Ae-he)*fe),de>=0?(se=(ve-ge)*de,ae=(_e-ge)*de):(se=(_e-ge)*de,ae=(ve-ge)*de),ie>ae||se>oe||((se>ie||isNaN(ie))&&(ie=se),(ae<oe||isNaN(oe))&&(oe=ae),pe>=0?(le=(Te-me)*pe,ce=(be-me)*pe):(le=(be-me)*pe,ce=(Te-me)*pe),ie>ce||le>oe)?!1:((le>ie||ie!==ie)&&(ie=le),(ce<oe||oe!==oe)&&(oe=ce),ie<=ne&&oe>=te)}function intersectTris_indirect$1(K,_,Z,te,ne,ie,oe,se){const{geometry:ae,_indirectBuffer:le}=K;for(let ce=te,fe=te+ne;ce<fe;ce++){let de=le?le[ce]:ce;intersectTri$1(ae,_,Z,de,ie,oe,se)}}function intersectClosestTri_indirect$1(K,_,Z,te,ne,ie,oe){const{geometry:se,_indirectBuffer:ae}=K;let le=1/0,ce=null;for(let fe=te,de=te+ne;fe<de;fe++){let pe;pe=intersectTri$1(se,_,Z,ae?ae[fe]:fe,null,ie,oe),pe&&pe.distance<le&&(ce=pe,le=pe.distance)}return ce}function iterateOverTriangles_indirect$1(K,_,Z,te,ne,ie,oe){const{geometry:se}=Z,{index:ae}=se,le=se.attributes.position;for(let ce=K,fe=_+K;ce<fe;ce++){let de;if(de=Z.resolveTriangleIndex(ce),setTriangle$1(oe,de*3,ae,le),oe.needsUpdate=!0,te(oe,de,ne,ie))return!0}return!1}function raycast$1(K,_,Z,te,ne,ie,oe){BufferStack$1.setBuffer(K._roots[_]),_raycast$3(0,K,Z,te,ne,ie,oe),BufferStack$1.clearBuffer()}function _raycast$3(K,_,Z,te,ne,ie,oe){const{float32Array:se,uint16Array:ae,uint32Array:le}=BufferStack$1,ce=K*2;if(IS_LEAF$1(ce,ae)){const de=OFFSET$1(K,le),pe=COUNT$1(ce,ae);intersectTris$1(_,Z,te,de,pe,ne,ie,oe)}else{const de=LEFT_NODE$1(K);intersectRay$1(de,se,te,ie,oe)&&_raycast$3(de,_,Z,te,ne,ie,oe);const pe=RIGHT_NODE$1(K,le);intersectRay$1(pe,se,te,ie,oe)&&_raycast$3(pe,_,Z,te,ne,ie,oe)}}const _xyzFields$3=["x","y","z"];function raycastFirst$1(K,_,Z,te,ne,ie){BufferStack$1.setBuffer(K._roots[_]);const oe=_raycastFirst$3(0,K,Z,te,ne,ie);return BufferStack$1.clearBuffer(),oe}function _raycastFirst$3(K,_,Z,te,ne,ie){const{float32Array:oe,uint16Array:se,uint32Array:ae}=BufferStack$1;let le=K*2;if(IS_LEAF$1(le,se)){const fe=OFFSET$1(K,ae),de=COUNT$1(le,se);return intersectClosestTri$1(_,Z,te,fe,de,ne,ie)}else{const fe=SPLIT_AXIS$1(K,ae),de=_xyzFields$3[fe],he=te.direction[de]>=0;let ge,me;he?(ge=LEFT_NODE$1(K),me=RIGHT_NODE$1(K,ae)):(ge=RIGHT_NODE$1(K,ae),me=LEFT_NODE$1(K));const ye=intersectRay$1(ge,oe,te,ne,ie)?_raycastFirst$3(ge,_,Z,te,ne,ie):null;if(ye){const Te=ye.point[de];if(he?Te<=oe[me+fe]:Te>=oe[me+fe+3])return ye}const _e=intersectRay$1(me,oe,te,ne,ie)?_raycastFirst$3(me,_,Z,te,ne,ie):null;return ye&&_e?ye.distance<=_e.distance?ye:_e:ye||_e||null}}const boundingBox$4=new Box3,triangle$3=new ExtendedTriangle$1,triangle2$3=new ExtendedTriangle$1,invertedMat$3=new Matrix4,obb$9=new OrientedBox$1,obb2$7=new OrientedBox$1;function intersectsGeometry$1(K,_,Z,te){BufferStack$1.setBuffer(K._roots[_]);const ne=_intersectsGeometry$3(0,K,Z,te);return BufferStack$1.clearBuffer(),ne}function _intersectsGeometry$3(K,_,Z,te,ne=null){const{float32Array:ie,uint16Array:oe,uint32Array:se}=BufferStack$1;let ae=K*2;if(ne===null&&(Z.boundingBox||Z.computeBoundingBox(),obb$9.set(Z.boundingBox.min,Z.boundingBox.max,te),ne=obb$9),IS_LEAF$1(ae,oe)){const ce=_.geometry,fe=ce.index,de=ce.attributes.position,pe=Z.index,he=Z.attributes.position,ge=OFFSET$1(K,se),me=COUNT$1(ae,oe);if(invertedMat$3.copy(te).invert(),Z.boundsTree)return arrayToBox$1(K,ie,obb2$7),obb2$7.matrix.copy(invertedMat$3),obb2$7.needsUpdate=!0,Z.boundsTree.shapecast({intersectsBounds:ye=>obb2$7.intersectsBox(ye),intersectsTriangle:ye=>{ye.a.applyMatrix4(te),ye.b.applyMatrix4(te),ye.c.applyMatrix4(te),ye.needsUpdate=!0;for(let ve=ge*3,_e=(me+ge)*3;ve<_e;ve+=3)if(setTriangle$1(triangle2$3,ve,fe,de),triangle2$3.needsUpdate=!0,ye.intersectsTriangle(triangle2$3))return!0;return!1}});for(let Ae=ge*3,ye=(me+ge)*3;Ae<ye;Ae+=3){setTriangle$1(triangle$3,Ae,fe,de),triangle$3.a.applyMatrix4(invertedMat$3),triangle$3.b.applyMatrix4(invertedMat$3),triangle$3.c.applyMatrix4(invertedMat$3),triangle$3.needsUpdate=!0;for(let ve=0,_e=pe.count;ve<_e;ve+=3)if(setTriangle$1(triangle2$3,ve,pe,he),triangle2$3.needsUpdate=!0,triangle$3.intersectsTriangle(triangle2$3))return!0}}else{const ce=K+8,fe=se[K+6];return arrayToBox$1(ce,ie,boundingBox$4),!!(ne.intersectsBox(boundingBox$4)&&_intersectsGeometry$3(ce,_,Z,te,ne)||(arrayToBox$1(fe,ie,boundingBox$4),ne.intersectsBox(boundingBox$4)&&_intersectsGeometry$3(fe,_,Z,te,ne)))}}const tempMatrix$4=new Matrix4,obb$8=new OrientedBox$1,obb2$6=new OrientedBox$1,temp1$4=new Vector3,temp2$3=new Vector3,temp3$3=new Vector3,temp4$3=new Vector3;function closestPointToGeometry$1(K,_,Z,te={},ne={},ie=0,oe=1/0){_.boundingBox||_.computeBoundingBox(),obb$8.set(_.boundingBox.min,_.boundingBox.max,Z),obb$8.needsUpdate=!0;const se=K.geometry,ae=se.attributes.position,le=se.index,ce=_.attributes.position,fe=_.index,de=ExtendedTrianglePool$1.getPrimitive(),pe=ExtendedTrianglePool$1.getPrimitive();let he=temp1$4,ge=temp2$3,me=null,Ae=null;ne&&(me=temp3$3,Ae=temp4$3);let ye=1/0,ve=null,_e=null;return tempMatrix$4.copy(Z).invert(),obb2$6.matrix.copy(tempMatrix$4),K.shapecast({boundsTraverseOrder:Te=>obb$8.distanceToBox(Te),intersectsBounds:(Te,be,Re)=>Re<ye&&Re<oe?(be&&(obb2$6.min.copy(Te.min),obb2$6.max.copy(Te.max),obb2$6.needsUpdate=!0),!0):!1,intersectsRange:(Te,be)=>{if(_.boundsTree)return _.boundsTree.shapecast({boundsTraverseOrder:we=>obb2$6.distanceToBox(we),intersectsBounds:(we,Pe,Ie)=>Ie<ye&&Ie<oe,intersectsRange:(we,Pe)=>{for(let Ie=we,$e=we+Pe;Ie<$e;Ie++){setTriangle$1(pe,3*Ie,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let Ue=Te,ke=Te+be;Ue<ke;Ue++){setTriangle$1(de,3*Ue,le,ae),de.needsUpdate=!0;const Ge=de.distanceToTriangle(pe,he,me);if(Ge<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=Ge,ve=Ue,_e=Ie),Ge<ie)return!0}}}});{const Re=getTriCount$1(_);for(let we=0,Pe=Re;we<Pe;we++){setTriangle$1(pe,3*we,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let Ie=Te,$e=Te+be;Ie<$e;Ie++){setTriangle$1(de,3*Ie,le,ae),de.needsUpdate=!0;const Ue=de.distanceToTriangle(pe,he,me);if(Ue<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=Ue,ve=Ie,_e=we),Ue<ie)return!0}}}}}),ExtendedTrianglePool$1.releasePrimitive(de),ExtendedTrianglePool$1.releasePrimitive(pe),ye===1/0?null:(te.point?te.point.copy(ge):te.point=ge.clone(),te.distance=ye,te.faceIndex=ve,ne&&(ne.point?ne.point.copy(Ae):ne.point=Ae.clone(),ne.point.applyMatrix4(tempMatrix$4),ge.applyMatrix4(tempMatrix$4),ne.distance=ge.sub(ne.point).length(),ne.faceIndex=_e),te)}function refit_indirect$1(K,_=null){_&&Array.isArray(_)&&(_=new Set(_));const Z=K.geometry,te=Z.index?Z.index.array:null,ne=Z.attributes.position;let ie,oe,se,ae,le=0;const ce=K._roots;for(let de=0,pe=ce.length;de<pe;de++)ie=ce[de],oe=new Uint32Array(ie),se=new Uint16Array(ie),ae=new Float32Array(ie),fe(0,le),le+=ie.byteLength;function fe(de,pe,he=!1){const ge=de*2;if(se[ge+15]===IS_LEAFNODE_FLAG$1){const Ae=oe[de+6],ye=se[ge+14];let ve=1/0,_e=1/0,Te=1/0,be=-1/0,Re=-1/0,we=-1/0;for(let Pe=Ae,Ie=Ae+ye;Pe<Ie;Pe++){const $e=3*K.resolveTriangleIndex(Pe);for(let Ue=0;Ue<3;Ue++){let ke=$e+Ue;ke=te?te[ke]:ke;const Ge=ne.getX(ke),He=ne.getY(ke),ze=ne.getZ(ke);Ge<ve&&(ve=Ge),Ge>be&&(be=Ge),He<_e&&(_e=He),He>Re&&(Re=He),ze<Te&&(Te=ze),ze>we&&(we=ze)}}return ae[de+0]!==ve||ae[de+1]!==_e||ae[de+2]!==Te||ae[de+3]!==be||ae[de+4]!==Re||ae[de+5]!==we?(ae[de+0]=ve,ae[de+1]=_e,ae[de+2]=Te,ae[de+3]=be,ae[de+4]=Re,ae[de+5]=we,!0):!1}else{const Ae=de+8,ye=oe[de+6],ve=Ae+pe,_e=ye+pe;let Te=he,be=!1,Re=!1;_?Te||(be=_.has(ve),Re=_.has(_e),Te=!be&&!Re):(be=!0,Re=!0);const we=Te||be,Pe=Te||Re;let Ie=!1;we&&(Ie=fe(Ae,pe,Te));let $e=!1;Pe&&($e=fe(ye,pe,Te));const Ue=Ie||$e;if(Ue)for(let ke=0;ke<3;ke++){const Ge=Ae+ke,He=ye+ke,ze=ae[Ge],Ke=ae[Ge+3],tt=ae[He],Je=ae[He+3];ae[de+ke]=ze<tt?ze:tt,ae[de+ke+3]=Ke>Je?Ke:Je}return Ue}}}function raycast_indirect$1(K,_,Z,te,ne,ie,oe){BufferStack$1.setBuffer(K._roots[_]),_raycast$2(0,K,Z,te,ne,ie,oe),BufferStack$1.clearBuffer()}function _raycast$2(K,_,Z,te,ne,ie,oe){const{float32Array:se,uint16Array:ae,uint32Array:le}=BufferStack$1,ce=K*2;if(IS_LEAF$1(ce,ae)){const de=OFFSET$1(K,le),pe=COUNT$1(ce,ae);intersectTris_indirect$1(_,Z,te,de,pe,ne,ie,oe)}else{const de=LEFT_NODE$1(K);intersectRay$1(de,se,te,ie,oe)&&_raycast$2(de,_,Z,te,ne,ie,oe);const pe=RIGHT_NODE$1(K,le);intersectRay$1(pe,se,te,ie,oe)&&_raycast$2(pe,_,Z,te,ne,ie,oe)}}const _xyzFields$2=["x","y","z"];function raycastFirst_indirect$1(K,_,Z,te,ne,ie){BufferStack$1.setBuffer(K._roots[_]);const oe=_raycastFirst$2(0,K,Z,te,ne,ie);return BufferStack$1.clearBuffer(),oe}function _raycastFirst$2(K,_,Z,te,ne,ie){const{float32Array:oe,uint16Array:se,uint32Array:ae}=BufferStack$1;let le=K*2;if(IS_LEAF$1(le,se)){const fe=OFFSET$1(K,ae),de=COUNT$1(le,se);return intersectClosestTri_indirect$1(_,Z,te,fe,de,ne,ie)}else{const fe=SPLIT_AXIS$1(K,ae),de=_xyzFields$2[fe],he=te.direction[de]>=0;let ge,me;he?(ge=LEFT_NODE$1(K),me=RIGHT_NODE$1(K,ae)):(ge=RIGHT_NODE$1(K,ae),me=LEFT_NODE$1(K));const ye=intersectRay$1(ge,oe,te,ne,ie)?_raycastFirst$2(ge,_,Z,te,ne,ie):null;if(ye){const Te=ye.point[de];if(he?Te<=oe[me+fe]:Te>=oe[me+fe+3])return ye}const _e=intersectRay$1(me,oe,te,ne,ie)?_raycastFirst$2(me,_,Z,te,ne,ie):null;return ye&&_e?ye.distance<=_e.distance?ye:_e:ye||_e||null}}const boundingBox$3=new Box3,triangle$2=new ExtendedTriangle$1,triangle2$2=new ExtendedTriangle$1,invertedMat$2=new Matrix4,obb$7=new OrientedBox$1,obb2$5=new OrientedBox$1;function intersectsGeometry_indirect$1(K,_,Z,te){BufferStack$1.setBuffer(K._roots[_]);const ne=_intersectsGeometry$2(0,K,Z,te);return BufferStack$1.clearBuffer(),ne}function _intersectsGeometry$2(K,_,Z,te,ne=null){const{float32Array:ie,uint16Array:oe,uint32Array:se}=BufferStack$1;let ae=K*2;if(ne===null&&(Z.boundingBox||Z.computeBoundingBox(),obb$7.set(Z.boundingBox.min,Z.boundingBox.max,te),ne=obb$7),IS_LEAF$1(ae,oe)){const ce=_.geometry,fe=ce.index,de=ce.attributes.position,pe=Z.index,he=Z.attributes.position,ge=OFFSET$1(K,se),me=COUNT$1(ae,oe);if(invertedMat$2.copy(te).invert(),Z.boundsTree)return arrayToBox$1(K,ie,obb2$5),obb2$5.matrix.copy(invertedMat$2),obb2$5.needsUpdate=!0,Z.boundsTree.shapecast({intersectsBounds:ye=>obb2$5.intersectsBox(ye),intersectsTriangle:ye=>{ye.a.applyMatrix4(te),ye.b.applyMatrix4(te),ye.c.applyMatrix4(te),ye.needsUpdate=!0;for(let ve=ge,_e=me+ge;ve<_e;ve++)if(setTriangle$1(triangle2$2,3*_.resolveTriangleIndex(ve),fe,de),triangle2$2.needsUpdate=!0,ye.intersectsTriangle(triangle2$2))return!0;return!1}});for(let Ae=ge,ye=me+ge;Ae<ye;Ae++){const ve=_.resolveTriangleIndex(Ae);setTriangle$1(triangle$2,3*ve,fe,de),triangle$2.a.applyMatrix4(invertedMat$2),triangle$2.b.applyMatrix4(invertedMat$2),triangle$2.c.applyMatrix4(invertedMat$2),triangle$2.needsUpdate=!0;for(let _e=0,Te=pe.count;_e<Te;_e+=3)if(setTriangle$1(triangle2$2,_e,pe,he),triangle2$2.needsUpdate=!0,triangle$2.intersectsTriangle(triangle2$2))return!0}}else{const ce=K+8,fe=se[K+6];return arrayToBox$1(ce,ie,boundingBox$3),!!(ne.intersectsBox(boundingBox$3)&&_intersectsGeometry$2(ce,_,Z,te,ne)||(arrayToBox$1(fe,ie,boundingBox$3),ne.intersectsBox(boundingBox$3)&&_intersectsGeometry$2(fe,_,Z,te,ne)))}}const tempMatrix$3=new Matrix4,obb$6=new OrientedBox$1,obb2$4=new OrientedBox$1,temp1$3=new Vector3,temp2$2=new Vector3,temp3$2=new Vector3,temp4$2=new Vector3;function closestPointToGeometry_indirect$1(K,_,Z,te={},ne={},ie=0,oe=1/0){_.boundingBox||_.computeBoundingBox(),obb$6.set(_.boundingBox.min,_.boundingBox.max,Z),obb$6.needsUpdate=!0;const se=K.geometry,ae=se.attributes.position,le=se.index,ce=_.attributes.position,fe=_.index,de=ExtendedTrianglePool$1.getPrimitive(),pe=ExtendedTrianglePool$1.getPrimitive();let he=temp1$3,ge=temp2$2,me=null,Ae=null;ne&&(me=temp3$2,Ae=temp4$2);let ye=1/0,ve=null,_e=null;return tempMatrix$3.copy(Z).invert(),obb2$4.matrix.copy(tempMatrix$3),K.shapecast({boundsTraverseOrder:Te=>obb$6.distanceToBox(Te),intersectsBounds:(Te,be,Re)=>Re<ye&&Re<oe?(be&&(obb2$4.min.copy(Te.min),obb2$4.max.copy(Te.max),obb2$4.needsUpdate=!0),!0):!1,intersectsRange:(Te,be)=>{if(_.boundsTree){const Re=_.boundsTree;return Re.shapecast({boundsTraverseOrder:we=>obb2$4.distanceToBox(we),intersectsBounds:(we,Pe,Ie)=>Ie<ye&&Ie<oe,intersectsRange:(we,Pe)=>{for(let Ie=we,$e=we+Pe;Ie<$e;Ie++){const Ue=Re.resolveTriangleIndex(Ie);setTriangle$1(pe,3*Ue,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let ke=Te,Ge=Te+be;ke<Ge;ke++){const He=K.resolveTriangleIndex(ke);setTriangle$1(de,3*He,le,ae),de.needsUpdate=!0;const ze=de.distanceToTriangle(pe,he,me);if(ze<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=ze,ve=ke,_e=Ie),ze<ie)return!0}}}})}else{const Re=getTriCount$1(_);for(let we=0,Pe=Re;we<Pe;we++){setTriangle$1(pe,3*we,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let Ie=Te,$e=Te+be;Ie<$e;Ie++){const Ue=K.resolveTriangleIndex(Ie);setTriangle$1(de,3*Ue,le,ae),de.needsUpdate=!0;const ke=de.distanceToTriangle(pe,he,me);if(ke<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=ke,ve=Ie,_e=we),ke<ie)return!0}}}}}),ExtendedTrianglePool$1.releasePrimitive(de),ExtendedTrianglePool$1.releasePrimitive(pe),ye===1/0?null:(te.point?te.point.copy(ge):te.point=ge.clone(),te.distance=ye,te.faceIndex=ve,ne&&(ne.point?ne.point.copy(Ae):ne.point=Ae.clone(),ne.point.applyMatrix4(tempMatrix$3),ge.applyMatrix4(tempMatrix$3),ne.distance=ge.sub(ne.point).length(),ne.faceIndex=_e),te)}function isSharedArrayBufferSupported$1(){return typeof SharedArrayBuffer<"u"}const _bufferStack1$1=new BufferStack$1.constructor,_bufferStack2$1=new BufferStack$1.constructor,_boxPool$1=new PrimitivePool$1(()=>new Box3),_leftBox1$1=new Box3,_rightBox1$1=new Box3,_leftBox2$1=new Box3,_rightBox2$1=new Box3;let _active$1=!1;function bvhcast$1(K,_,Z,te){if(_active$1)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");_active$1=!0;const ne=K._roots,ie=_._roots;let oe,se=0,ae=0;const le=new Matrix4().copy(Z).invert();for(let ce=0,fe=ne.length;ce<fe;ce++){_bufferStack1$1.setBuffer(ne[ce]),ae=0;const de=_boxPool$1.getPrimitive();arrayToBox$1(0,_bufferStack1$1.float32Array,de),de.applyMatrix4(le);for(let pe=0,he=ie.length;pe<he&&(_bufferStack2$1.setBuffer(ie[pe]),oe=_traverse$1(0,0,Z,le,te,se,ae,0,0,de),_bufferStack2$1.clearBuffer(),ae+=ie[pe].length,!oe);pe++);if(_boxPool$1.releasePrimitive(de),_bufferStack1$1.clearBuffer(),se+=ne[ce].length,oe)break}return _active$1=!1,oe}function _traverse$1(K,_,Z,te,ne,ie=0,oe=0,se=0,ae=0,le=null,ce=!1){let fe,de;ce?(fe=_bufferStack2$1,de=_bufferStack1$1):(fe=_bufferStack1$1,de=_bufferStack2$1);const pe=fe.float32Array,he=fe.uint32Array,ge=fe.uint16Array,me=de.float32Array,Ae=de.uint32Array,ye=de.uint16Array,ve=K*2,_e=_*2,Te=IS_LEAF$1(ve,ge),be=IS_LEAF$1(_e,ye);let Re=!1;if(be&&Te)ce?Re=ne(OFFSET$1(_,Ae),COUNT$1(_*2,ye),OFFSET$1(K,he),COUNT$1(K*2,ge),ae,oe+_,se,ie+K):Re=ne(OFFSET$1(K,he),COUNT$1(K*2,ge),OFFSET$1(_,Ae),COUNT$1(_*2,ye),se,ie+K,ae,oe+_);else if(be){const we=_boxPool$1.getPrimitive();arrayToBox$1(_,me,we),we.applyMatrix4(Z);const Pe=LEFT_NODE$1(K),Ie=RIGHT_NODE$1(K,he);arrayToBox$1(Pe,pe,_leftBox1$1),arrayToBox$1(Ie,pe,_rightBox1$1);const $e=we.intersectsBox(_leftBox1$1),Ue=we.intersectsBox(_rightBox1$1);Re=$e&&_traverse$1(_,Pe,te,Z,ne,oe,ie,ae,se+1,we,!ce)||Ue&&_traverse$1(_,Ie,te,Z,ne,oe,ie,ae,se+1,we,!ce),_boxPool$1.releasePrimitive(we)}else{const we=LEFT_NODE$1(_),Pe=RIGHT_NODE$1(_,Ae);arrayToBox$1(we,me,_leftBox2$1),arrayToBox$1(Pe,me,_rightBox2$1);const Ie=le.intersectsBox(_leftBox2$1),$e=le.intersectsBox(_rightBox2$1);if(Ie&&$e)Re=_traverse$1(K,we,Z,te,ne,ie,oe,se,ae+1,le,ce)||_traverse$1(K,Pe,Z,te,ne,ie,oe,se,ae+1,le,ce);else if(Ie)if(Te)Re=_traverse$1(K,we,Z,te,ne,ie,oe,se,ae+1,le,ce);else{const Ue=_boxPool$1.getPrimitive();Ue.copy(_leftBox2$1).applyMatrix4(Z);const ke=LEFT_NODE$1(K),Ge=RIGHT_NODE$1(K,he);arrayToBox$1(ke,pe,_leftBox1$1),arrayToBox$1(Ge,pe,_rightBox1$1);const He=Ue.intersectsBox(_leftBox1$1),ze=Ue.intersectsBox(_rightBox1$1);Re=He&&_traverse$1(we,ke,te,Z,ne,oe,ie,ae,se+1,Ue,!ce)||ze&&_traverse$1(we,Ge,te,Z,ne,oe,ie,ae,se+1,Ue,!ce),_boxPool$1.releasePrimitive(Ue)}else if($e)if(Te)Re=_traverse$1(K,Pe,Z,te,ne,ie,oe,se,ae+1,le,ce);else{const Ue=_boxPool$1.getPrimitive();Ue.copy(_rightBox2$1).applyMatrix4(Z);const ke=LEFT_NODE$1(K),Ge=RIGHT_NODE$1(K,he);arrayToBox$1(ke,pe,_leftBox1$1),arrayToBox$1(Ge,pe,_rightBox1$1);const He=Ue.intersectsBox(_leftBox1$1),ze=Ue.intersectsBox(_rightBox1$1);Re=He&&_traverse$1(Pe,ke,te,Z,ne,oe,ie,ae,se+1,Ue,!ce)||ze&&_traverse$1(Pe,Ge,te,Z,ne,oe,ie,ae,se+1,Ue,!ce),_boxPool$1.releasePrimitive(Ue)}}return Re}const obb$5=new OrientedBox$1,tempBox$1=new Box3,DEFAULT_OPTIONS$1={strategy:CENTER$1,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0,range:null};let MeshBVH$1=class ql{static serialize(_,Z={}){Z={cloneBuffers:!0,...Z};const te=_.geometry,ne=_._roots,ie=_._indirectBuffer,oe=te.getIndex();let se;return Z.cloneBuffers?se={roots:ne.map(ae=>ae.slice()),index:oe?oe.array.slice():null,indirectBuffer:ie?ie.slice():null}:se={roots:ne,index:oe?oe.array:null,indirectBuffer:ie},se}static deserialize(_,Z,te={}){te={setIndex:!0,indirect:!!_.indirectBuffer,...te};const{index:ne,roots:ie,indirectBuffer:oe}=_,se=new ql(Z,{...te,[SKIP_GENERATION$1]:!0});if(se._roots=ie,se._indirectBuffer=oe||null,te.setIndex){const ae=Z.getIndex();if(ae===null){const le=new BufferAttribute(_.index,1,!1);Z.setIndex(le)}else ae.array!==ne&&(ae.array.set(ne),ae.needsUpdate=!0)}return se}get indirect(){return!!this._indirectBuffer}constructor(_,Z={}){if(_.isBufferGeometry){if(_.index&&_.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(Z=Object.assign({...DEFAULT_OPTIONS$1,[SKIP_GENERATION$1]:!1},Z),Z.useSharedArrayBuffer&&!isSharedArrayBufferSupported$1())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=_,this._roots=null,this._indirectBuffer=null,Z[SKIP_GENERATION$1]||(buildPackedTree$1(this,Z),!_.boundingBox&&Z.setBoundingBox&&(_.boundingBox=this.getBoundingBox(new Box3))),this.resolveTriangleIndex=Z.indirect?te=>this._indirectBuffer[te]:te=>te}refit(_=null){return(this.indirect?refit_indirect$1:refit$1)(this,_)}traverse(_,Z=0){const te=this._roots[Z],ne=new Uint32Array(te),ie=new Uint16Array(te);oe(0);function oe(se,ae=0){const le=se*2,ce=ie[le+15]===IS_LEAFNODE_FLAG$1;if(ce){const fe=ne[se+6],de=ie[le+14];_(ae,ce,new Float32Array(te,se*4,6),fe,de)}else{const fe=se+BYTES_PER_NODE$1/4,de=ne[se+6],pe=ne[se+7];_(ae,ce,new Float32Array(te,se*4,6),pe)||(oe(fe,ae+1),oe(de,ae+1))}}}raycast(_,Z=FrontSide,te=0,ne=1/0){const ie=this._roots,oe=this.geometry,se=[],ae=Z.isMaterial,le=Array.isArray(Z),ce=oe.groups,fe=ae?Z.side:Z,de=this.indirect?raycast_indirect$1:raycast$1;for(let pe=0,he=ie.length;pe<he;pe++){const ge=le?Z[ce[pe].materialIndex].side:fe,me=se.length;if(de(this,pe,ge,_,se,te,ne),le){const Ae=ce[pe].materialIndex;for(let ye=me,ve=se.length;ye<ve;ye++)se[ye].face.materialIndex=Ae}}return se}raycastFirst(_,Z=FrontSide,te=0,ne=1/0){const ie=this._roots,oe=this.geometry,se=Z.isMaterial,ae=Array.isArray(Z);let le=null;const ce=oe.groups,fe=se?Z.side:Z,de=this.indirect?raycastFirst_indirect$1:raycastFirst$1;for(let pe=0,he=ie.length;pe<he;pe++){const ge=ae?Z[ce[pe].materialIndex].side:fe,me=de(this,pe,ge,_,te,ne);me!=null&&(le==null||me.distance<le.distance)&&(le=me,ae&&(me.face.materialIndex=ce[pe].materialIndex))}return le}intersectsGeometry(_,Z){let te=!1;const ne=this._roots,ie=this.indirect?intersectsGeometry_indirect$1:intersectsGeometry$1;for(let oe=0,se=ne.length;oe<se&&(te=ie(this,oe,_,Z),!te);oe++);return te}shapecast(_){const Z=ExtendedTrianglePool$1.getPrimitive(),te=this.indirect?iterateOverTriangles_indirect$1:iterateOverTriangles$1;let{boundsTraverseOrder:ne,intersectsBounds:ie,intersectsRange:oe,intersectsTriangle:se}=_;if(oe&&se){const fe=oe;oe=(de,pe,he,ge,me)=>fe(de,pe,he,ge,me)?!0:te(de,pe,this,se,he,ge,Z)}else oe||(se?oe=(fe,de,pe,he)=>te(fe,de,this,se,pe,he,Z):oe=(fe,de,pe)=>pe);let ae=!1,le=0;const ce=this._roots;for(let fe=0,de=ce.length;fe<de;fe++){const pe=ce[fe];if(ae=shapecast$1(this,fe,ie,oe,ne,le),ae)break;le+=pe.byteLength}return ExtendedTrianglePool$1.releasePrimitive(Z),ae}bvhcast(_,Z,te){let{intersectsRanges:ne,intersectsTriangles:ie}=te;const oe=ExtendedTrianglePool$1.getPrimitive(),se=this.geometry.index,ae=this.geometry.attributes.position,le=this.indirect?he=>{const ge=this.resolveTriangleIndex(he);setTriangle$1(oe,ge*3,se,ae)}:he=>{setTriangle$1(oe,he*3,se,ae)},ce=ExtendedTrianglePool$1.getPrimitive(),fe=_.geometry.index,de=_.geometry.attributes.position,pe=_.indirect?he=>{const ge=_.resolveTriangleIndex(he);setTriangle$1(ce,ge*3,fe,de)}:he=>{setTriangle$1(ce,he*3,fe,de)};if(ie){const he=(ge,me,Ae,ye,ve,_e,Te,be)=>{for(let Re=Ae,we=Ae+ye;Re<we;Re++){pe(Re),ce.a.applyMatrix4(Z),ce.b.applyMatrix4(Z),ce.c.applyMatrix4(Z),ce.needsUpdate=!0;for(let Pe=ge,Ie=ge+me;Pe<Ie;Pe++)if(le(Pe),oe.needsUpdate=!0,ie(oe,ce,Pe,Re,ve,_e,Te,be))return!0}return!1};if(ne){const ge=ne;ne=function(me,Ae,ye,ve,_e,Te,be,Re){return ge(me,Ae,ye,ve,_e,Te,be,Re)?!0:he(me,Ae,ye,ve,_e,Te,be,Re)}}else ne=he}return bvhcast$1(this,_,Z,ne)}intersectsBox(_,Z){return obb$5.set(_.min,_.max,Z),obb$5.needsUpdate=!0,this.shapecast({intersectsBounds:te=>obb$5.intersectsBox(te),intersectsTriangle:te=>obb$5.intersectsTriangle(te)})}intersectsSphere(_){return this.shapecast({intersectsBounds:Z=>_.intersectsBox(Z),intersectsTriangle:Z=>Z.intersectsSphere(_)})}closestPointToGeometry(_,Z,te={},ne={},ie=0,oe=1/0){return(this.indirect?closestPointToGeometry_indirect$1:closestPointToGeometry$1)(this,_,Z,te,ne,ie,oe)}closestPointToPoint(_,Z={},te=0,ne=1/0){return closestPointToPoint$1(this,_,Z,te,ne)}getBoundingBox(_){return _.makeEmpty(),this._roots.forEach(te=>{arrayToBox$1(0,new Float32Array(te),tempBox$1),_.union(tempBox$1)}),_}};function convertRaycastIntersect$1(K,_,Z){return K===null?null:(K.point.applyMatrix4(_.matrixWorld),K.distance=K.point.distanceTo(Z.ray.origin),K.object=_,K)}const ray$3=new Ray,direction$1=new Vector3,tmpInverseMatrix$1=new Matrix4,origMeshRaycastFunc$1=Mesh.prototype.raycast,origBatchedRaycastFunc$1=BatchedMesh.prototype.raycast,_worldScale$1=new Vector3,_mesh$2=new Mesh,_batchIntersects$1=[];function acceleratedRaycast$1(K,_){this.isBatchedMesh?acceleratedBatchedMeshRaycast$1.call(this,K,_):acceleratedMeshRaycast$1.call(this,K,_)}function acceleratedBatchedMeshRaycast$1(K,_){if(this.boundsTrees){const Z=this.boundsTrees,te=this._drawInfo||this._instanceInfo,ne=this._drawRanges||this._geometryInfo,ie=this.matrixWorld;_mesh$2.material=this.material,_mesh$2.geometry=this.geometry;const oe=_mesh$2.geometry.boundsTree,se=_mesh$2.geometry.drawRange;_mesh$2.geometry.boundingSphere===null&&(_mesh$2.geometry.boundingSphere=new Sphere$2);for(let ae=0,le=te.length;ae<le;ae++){if(!this.getVisibleAt(ae))continue;const ce=te[ae].geometryIndex;if(_mesh$2.geometry.boundsTree=Z[ce],this.getMatrixAt(ae,_mesh$2.matrixWorld).premultiply(ie),!_mesh$2.geometry.boundsTree){this.getBoundingBoxAt(ce,_mesh$2.geometry.boundingBox),this.getBoundingSphereAt(ce,_mesh$2.geometry.boundingSphere);const fe=ne[ce];_mesh$2.geometry.setDrawRange(fe.start,fe.count)}_mesh$2.raycast(K,_batchIntersects$1);for(let fe=0,de=_batchIntersects$1.length;fe<de;fe++){const pe=_batchIntersects$1[fe];pe.object=this,pe.batchId=ae,_.push(pe)}_batchIntersects$1.length=0}_mesh$2.geometry.boundsTree=oe,_mesh$2.geometry.drawRange=se,_mesh$2.material=null,_mesh$2.geometry=null}else origBatchedRaycastFunc$1.call(this,K,_)}function acceleratedMeshRaycast$1(K,_){if(this.geometry.boundsTree){if(this.material===void 0)return;tmpInverseMatrix$1.copy(this.matrixWorld).invert(),ray$3.copy(K.ray).applyMatrix4(tmpInverseMatrix$1),_worldScale$1.setFromMatrixScale(this.matrixWorld),direction$1.copy(ray$3.direction).multiply(_worldScale$1);const Z=direction$1.length(),te=K.near/Z,ne=K.far/Z,ie=this.geometry.boundsTree;if(K.firstHitOnly===!0){const oe=convertRaycastIntersect$1(ie.raycastFirst(ray$3,this.material,te,ne),this,K);oe&&_.push(oe)}else{const oe=ie.raycast(ray$3,this.material,te,ne);for(let se=0,ae=oe.length;se<ae;se++){const le=convertRaycastIntersect$1(oe[se],this,K);le&&_.push(le)}}}else origMeshRaycastFunc$1.call(this,K,_)}function computeBoundsTree(K={}){return this.boundsTree=new MeshBVH$1(this,K),this.boundsTree}function disposeBoundsTree(){this.boundsTree=null}function countToStringFormat$1(K){switch(K){case 1:return"R";case 2:return"RG";case 3:return"RGBA";case 4:return"RGBA"}throw new Error}function countToFormat$1(K){switch(K){case 1:return RedFormat;case 2:return RGFormat;case 3:return RGBAFormat;case 4:return RGBAFormat}}function countToIntFormat$1(K){switch(K){case 1:return RedIntegerFormat;case 2:return RGIntegerFormat;case 3:return RGBAIntegerFormat;case 4:return RGBAIntegerFormat}}let VertexAttributeTexture$1=class extends DataTexture{constructor(){super(),this.minFilter=NearestFilter,this.magFilter=NearestFilter,this.generateMipmaps=!1,this.overrideItemSize=null,this._forcedType=null}updateFrom(_){const Z=this.overrideItemSize,te=_.itemSize,ne=_.count;if(Z!==null){if(te*ne%Z!==0)throw new Error("VertexAttributeTexture: overrideItemSize must divide evenly into buffer length.");_.itemSize=Z,_.count=ne*te/Z}const ie=_.itemSize,oe=_.count,se=_.normalized,ae=_.array.constructor,le=ae.BYTES_PER_ELEMENT;let ce=this._forcedType,fe=ie;if(ce===null)switch(ae){case Float32Array:ce=FloatType;break;case Uint8Array:case Uint16Array:case Uint32Array:ce=UnsignedIntType;break;case Int8Array:case Int16Array:case Int32Array:ce=IntType;break}let de,pe,he,ge,me=countToStringFormat$1(ie);switch(ce){case FloatType:he=1,pe=countToFormat$1(ie),se&&le===1?(ge=ae,me+="8",ae===Uint8Array?de=UnsignedByteType:(de=ByteType,me+="_SNORM")):(ge=Float32Array,me+="32F",de=FloatType);break;case IntType:me+=le*8+"I",he=se?Math.pow(2,ae.BYTES_PER_ELEMENT*8-1):1,pe=countToIntFormat$1(ie),le===1?(ge=Int8Array,de=ByteType):le===2?(ge=Int16Array,de=ShortType):(ge=Int32Array,de=IntType);break;case UnsignedIntType:me+=le*8+"UI",he=se?Math.pow(2,ae.BYTES_PER_ELEMENT*8-1):1,pe=countToIntFormat$1(ie),le===1?(ge=Uint8Array,de=UnsignedByteType):le===2?(ge=Uint16Array,de=UnsignedShortType):(ge=Uint32Array,de=UnsignedIntType);break}fe===3&&(pe===RGBAFormat||pe===RGBAIntegerFormat)&&(fe=4);const Ae=Math.ceil(Math.sqrt(oe))||1,ye=fe*Ae*Ae,ve=new ge(ye),_e=_.normalized;_.normalized=!1;for(let Te=0;Te<oe;Te++){const be=fe*Te;ve[be]=_.getX(Te)/he,ie>=2&&(ve[be+1]=_.getY(Te)/he),ie>=3&&(ve[be+2]=_.getZ(Te)/he,fe===4&&(ve[be+3]=1)),ie>=4&&(ve[be+3]=_.getW(Te)/he)}_.normalized=_e,this.internalFormat=me,this.format=pe,this.type=de,this.image.width=Ae,this.image.height=Ae,this.image.data=ve,this.needsUpdate=!0,this.dispose(),_.itemSize=te,_.count=ne}},UIntVertexAttributeTexture$1=class extends VertexAttributeTexture$1{constructor(){super(),this._forcedType=UnsignedIntType}},FloatVertexAttributeTexture$1=class extends VertexAttributeTexture$1{constructor(){super(),this._forcedType=FloatType}},MeshBVHUniformStruct$1=class{constructor(){this.index=new UIntVertexAttributeTexture$1,this.position=new FloatVertexAttributeTexture$1,this.bvhBounds=new DataTexture,this.bvhContents=new DataTexture,this._cachedIndexAttr=null,this.index.overrideItemSize=3}updateFrom(_){const{geometry:Z}=_;if(bvhToTextures$1(_,this.bvhBounds,this.bvhContents),this.position.updateFrom(Z.attributes.position),_.indirect){const te=_._indirectBuffer;if(this._cachedIndexAttr===null||this._cachedIndexAttr.count!==te.length)if(Z.index)this._cachedIndexAttr=Z.index.clone();else{const ne=getIndexArray$1(getVertexCount$1(Z));this._cachedIndexAttr=new BufferAttribute(ne,1,!1)}dereferenceIndex$1(Z,te,this._cachedIndexAttr),this.index.updateFrom(this._cachedIndexAttr)}else this.index.updateFrom(Z.index)}dispose(){const{index:_,position:Z,bvhBounds:te,bvhContents:ne}=this;_&&_.dispose(),Z&&Z.dispose(),te&&te.dispose(),ne&&ne.dispose()}};function dereferenceIndex$1(K,_,Z){const te=Z.array,ne=K.index?K.index.array:null;for(let ie=0,oe=_.length;ie<oe;ie++){const se=3*ie,ae=3*_[ie];for(let le=0;le<3;le++)te[se+le]=ne?ne[ae+le]:ae+le}}function bvhToTextures$1(K,_,Z){const te=K._roots;if(te.length!==1)throw new Error("MeshBVHUniformStruct: Multi-root BVHs not supported.");const ne=te[0],ie=new Uint16Array(ne),oe=new Uint32Array(ne),se=new Float32Array(ne),ae=ne.byteLength/BYTES_PER_NODE$1,le=2*Math.ceil(Math.sqrt(ae/2)),ce=new Float32Array(4*le*le),fe=Math.ceil(Math.sqrt(ae)),de=new Uint32Array(2*fe*fe);for(let pe=0;pe<ae;pe++){const he=pe*BYTES_PER_NODE$1/4,ge=he*2,me=he;for(let Ae=0;Ae<3;Ae++)ce[8*pe+0+Ae]=se[me+0+Ae],ce[8*pe+4+Ae]=se[me+3+Ae];if(IS_LEAF$1(ge,ie)){const Ae=COUNT$1(ge,ie),ye=OFFSET$1(he,oe),ve=4294901760|Ae;de[pe*2+0]=ve,de[pe*2+1]=ye}else{const Ae=4*RIGHT_NODE$1(he,oe)/BYTES_PER_NODE$1,ye=SPLIT_AXIS$1(he,oe);de[pe*2+0]=ye,de[pe*2+1]=Ae}}_.image.data=ce,_.image.width=le,_.image.height=le,_.format=RGBAFormat,_.type=FloatType,_.internalFormat="RGBA32F",_.minFilter=NearestFilter,_.magFilter=NearestFilter,_.generateMipmaps=!1,_.needsUpdate=!0,_.dispose(),Z.image.data=de,Z.image.width=fe,Z.image.height=fe,Z.format=RGIntegerFormat,Z.type=UnsignedIntType,Z.internalFormat="RG32UI",Z.minFilter=NearestFilter,Z.magFilter=NearestFilter,Z.generateMipmaps=!1,Z.needsUpdate=!0,Z.dispose()}const common_functions$1=`

// A stack of uint32 indices can can store the indices for
// a perfectly balanced tree with a depth up to 31. Lower stack
// depth gets higher performance.
//
// However not all trees are balanced. Best value to set this to
// is the trees max depth.
#ifndef BVH_STACK_DEPTH
#define BVH_STACK_DEPTH 60
#endif

#ifndef INFINITY
#define INFINITY 1e20
#endif

// Utilities
uvec4 uTexelFetch1D( usampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

ivec4 iTexelFetch1D( isampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 texelFetch1D( sampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 textureSampleBarycoord( sampler2D tex, vec3 barycoord, uvec3 faceIndices ) {

	return
		barycoord.x * texelFetch1D( tex, faceIndices.x ) +
		barycoord.y * texelFetch1D( tex, faceIndices.y ) +
		barycoord.z * texelFetch1D( tex, faceIndices.z );

}

void ndcToCameraRay(
	vec2 coord, mat4 cameraWorld, mat4 invProjectionMatrix,
	out vec3 rayOrigin, out vec3 rayDirection
) {

	// get camera look direction and near plane for camera clipping
	vec4 lookDirection = cameraWorld * vec4( 0.0, 0.0, - 1.0, 0.0 );
	vec4 nearVector = invProjectionMatrix * vec4( 0.0, 0.0, - 1.0, 1.0 );
	float near = abs( nearVector.z / nearVector.w );

	// get the camera direction and position from camera matrices
	vec4 origin = cameraWorld * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec4 direction = invProjectionMatrix * vec4( coord, 0.5, 1.0 );
	direction /= direction.w;
	direction = cameraWorld * direction - origin;

	// slide the origin along the ray until it sits at the near clip plane position
	origin.xyz += direction.xyz * near / dot( direction, lookDirection );

	rayOrigin = origin.xyz;
	rayDirection = direction.xyz;

}
`,bvh_ray_functions$1=`

#ifndef TRI_INTERSECT_EPSILON
#define TRI_INTERSECT_EPSILON 1e-5
#endif

// Raycasting
bool intersectsBounds( vec3 rayOrigin, vec3 rayDirection, vec3 boundsMin, vec3 boundsMax, out float dist ) {

	// https://www.reddit.com/r/opengl/comments/8ntzz5/fast_glsl_ray_box_intersection/
	// https://tavianator.com/2011/ray_box.html
	vec3 invDir = 1.0 / rayDirection;

	// find intersection distances for each plane
	vec3 tMinPlane = invDir * ( boundsMin - rayOrigin );
	vec3 tMaxPlane = invDir * ( boundsMax - rayOrigin );

	// get the min and max distances from each intersection
	vec3 tMinHit = min( tMaxPlane, tMinPlane );
	vec3 tMaxHit = max( tMaxPlane, tMinPlane );

	// get the furthest hit distance
	vec2 t = max( tMinHit.xx, tMinHit.yz );
	float t0 = max( t.x, t.y );

	// get the minimum hit distance
	t = min( tMaxHit.xx, tMaxHit.yz );
	float t1 = min( t.x, t.y );

	// set distance to 0.0 if the ray starts inside the box
	dist = max( t0, 0.0 );

	return t1 >= dist;

}

bool intersectsTriangle(
	vec3 rayOrigin, vec3 rayDirection, vec3 a, vec3 b, vec3 c,
	out vec3 barycoord, out vec3 norm, out float dist, out float side
) {

	// https://stackoverflow.com/questions/42740765/intersection-between-line-and-triangle-in-3d
	vec3 edge1 = b - a;
	vec3 edge2 = c - a;
	norm = cross( edge1, edge2 );

	float det = - dot( rayDirection, norm );
	float invdet = 1.0 / det;

	vec3 AO = rayOrigin - a;
	vec3 DAO = cross( AO, rayDirection );

	vec4 uvt;
	uvt.x = dot( edge2, DAO ) * invdet;
	uvt.y = - dot( edge1, DAO ) * invdet;
	uvt.z = dot( AO, norm ) * invdet;
	uvt.w = 1.0 - uvt.x - uvt.y;

	// set the hit information
	barycoord = uvt.wxy; // arranged in A, B, C order
	dist = uvt.z;
	side = sign( det );
	norm = side * normalize( norm );

	// add an epsilon to avoid misses between triangles
	uvt += vec4( TRI_INTERSECT_EPSILON );

	return all( greaterThanEqual( uvt, vec4( 0.0 ) ) );

}

bool intersectTriangles(
	// geometry info and triangle range
	sampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// outputs
	inout float minDistance, inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	bool found = false;
	vec3 localBarycoord, localNormal;
	float localDist, localSide;
	for ( uint i = offset, l = offset + count; i < l; i ++ ) {

		uvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;
		vec3 a = texelFetch1D( positionAttr, indices.x ).rgb;
		vec3 b = texelFetch1D( positionAttr, indices.y ).rgb;
		vec3 c = texelFetch1D( positionAttr, indices.z ).rgb;

		if (
			intersectsTriangle( rayOrigin, rayDirection, a, b, c, localBarycoord, localNormal, localDist, localSide )
			&& localDist < minDistance
		) {

			found = true;
			minDistance = localDist;

			faceIndices = uvec4( indices.xyz, i );
			faceNormal = localNormal;

			side = localSide;
			barycoord = localBarycoord;
			dist = localDist;

		}

	}

	return found;

}

bool intersectsBVHNodeBounds( vec3 rayOrigin, vec3 rayDirection, sampler2D bvhBounds, uint currNodeIndex, out float dist ) {

	uint cni2 = currNodeIndex * 2u;
	vec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;
	vec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;
	return intersectsBounds( rayOrigin, rayDirection, boundsMin, boundsMax, dist );

}

// use a macro to hide the fact that we need to expand the struct into separate fields
#define	bvhIntersectFirstHit(		bvh,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)	_bvhIntersectFirstHit(		bvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)

bool _bvhIntersectFirstHit(
	// bvh info
	sampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// output variables split into separate variables due to output precision
	inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	// stack needs to be twice as long as the deepest tree we expect because
	// we push both the left and right child onto the stack every traversal
	int ptr = 0;
	uint stack[ BVH_STACK_DEPTH ];
	stack[ 0 ] = 0u;

	float triangleDistance = INFINITY;
	bool found = false;
	while ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {

		uint currNodeIndex = stack[ ptr ];
		ptr --;

		// check if we intersect the current bounds
		float boundsHitDistance;
		if (
			! intersectsBVHNodeBounds( rayOrigin, rayDirection, bvh_bvhBounds, currNodeIndex, boundsHitDistance )
			|| boundsHitDistance > triangleDistance
		) {

			continue;

		}

		uvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;
		bool isLeaf = bool( boundsInfo.x & 0xffff0000u );

		if ( isLeaf ) {

			uint count = boundsInfo.x & 0x0000ffffu;
			uint offset = boundsInfo.y;

			found = intersectTriangles(
				bvh_position, bvh_index, offset, count,
				rayOrigin, rayDirection, triangleDistance,
				faceIndices, faceNormal, barycoord, side, dist
			) || found;

		} else {

			uint leftIndex = currNodeIndex + 1u;
			uint splitAxis = boundsInfo.x & 0x0000ffffu;
			uint rightIndex = boundsInfo.y;

			bool leftToRight = rayDirection[ splitAxis ] >= 0.0;
			uint c1 = leftToRight ? leftIndex : rightIndex;
			uint c2 = leftToRight ? rightIndex : leftIndex;

			// set c2 in the stack so we traverse it later. We need to keep track of a pointer in
			// the stack while we traverse. The second pointer added is the one that will be
			// traversed first
			ptr ++;
			stack[ ptr ] = c2;

			ptr ++;
			stack[ ptr ] = c1;

		}

	}

	return found;

}
`,bvh_struct_definitions$1=`
struct BVH {

	usampler2D index;
	sampler2D position;

	sampler2D bvhBounds;
	usampler2D bvhContents;

};
`,shaderStructs=bvh_struct_definitions$1,shaderIntersectFunction=`
	${common_functions$1}
	${bvh_ray_functions$1}
`,isMesh=K=>K.isMesh;function useBVH(K,_){_={strategy:SAH$1,verbose:!1,setBoundingBox:!0,maxDepth:40,maxLeafTris:10,indirect:!1,..._},reactExports.useEffect(()=>{if(K.current){K.current.raycast=acceleratedRaycast$1;const Z=K.current.geometry;return Z.computeBoundsTree=computeBoundsTree,Z.disposeBoundsTree=disposeBoundsTree,Z.computeBoundsTree(_),()=>{Z.boundsTree&&Z.disposeBoundsTree()}}},[K,JSON.stringify(_)])}const Bvh=reactExports.forwardRef(({enabled:K=!0,firstHitOnly:_=!1,children:Z,strategy:te=SAH$1,verbose:ne=!1,setBoundingBox:ie=!0,maxDepth:oe=40,maxLeafTris:se=10,indirect:ae=!1,...le},ce)=>{const fe=reactExports.useRef(null),de=useThree(pe=>pe.raycaster);return reactExports.useImperativeHandle(ce,()=>fe.current,[]),reactExports.useEffect(()=>{if(K){const pe={strategy:te,verbose:ne,setBoundingBox:ie,maxDepth:oe,maxLeafTris:se,indirect:ae},he=fe.current;return de.firstHitOnly=_,he.traverse(ge=>{isMesh(ge)&&!ge.geometry.boundsTree&&ge.raycast===Mesh.prototype.raycast&&(ge.raycast=acceleratedRaycast$1,ge.geometry.computeBoundsTree=computeBoundsTree,ge.geometry.disposeBoundsTree=disposeBoundsTree,ge.geometry.computeBoundsTree(pe))}),()=>{delete de.firstHitOnly,he.traverse(ge=>{isMesh(ge)&&ge.geometry.boundsTree&&(ge.geometry.disposeBoundsTree(),ge.raycast=Mesh.prototype.raycast)})}}},[]),reactExports.createElement("group",_extends$3({ref:fe},le),Z)});function useIntersect(K){const _=reactExports.useRef(null),Z=reactExports.useRef(!1),te=reactExports.useRef(!1),ne=reactExports.useRef(K);return reactExports.useLayoutEffect(()=>void(ne.current=K),[K]),reactExports.useEffect(()=>{const ie=_.current;if(ie){const oe=addEffect(()=>(Z.current=!1,!0)),se=ie.onBeforeRender;ie.onBeforeRender=()=>Z.current=!0;const ae=addAfterEffect(()=>(Z.current!==te.current&&(ne.current==null||ne.current(te.current=Z.current)),!0));return()=>{ie.onBeforeRender=se,oe(),ae()}}},[]),_}const boundingBox$2=new Box3,boundingBoxSize=new Vector3,BBAnchor=({anchor:K,..._})=>{const Z=reactExports.useRef(null),te=reactExports.useRef(null);return reactExports.useEffect(()=>{var ne;(ne=Z.current)!=null&&(ne=ne.parent)!=null&&ne.parent&&(te.current=Z.current.parent,Z.current.parent.parent.add(Z.current))},[]),useFrame(()=>{te.current&&(boundingBox$2.setFromObject(te.current),boundingBox$2.getSize(boundingBoxSize),Z.current.position.set(te.current.position.x+boundingBoxSize.x*(Array.isArray(K)?K[0]:K.x)/2,te.current.position.y+boundingBoxSize.y*(Array.isArray(K)?K[1]:K.y)/2,te.current.position.z+boundingBoxSize.z*(Array.isArray(K)?K[2]:K.z)/2))}),reactExports.createElement("group",_extends$3({ref:Z},_))},Center=reactExports.forwardRef(function({children:_,disable:Z,disableX:te,disableY:ne,disableZ:ie,left:oe,right:se,top:ae,bottom:le,front:ce,back:fe,onCentered:de,precise:pe=!0,cacheKey:he=0,...ge},me){const Ae=reactExports.useRef(null),ye=reactExports.useRef(null),ve=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{ye.current.matrixWorld.identity();const _e=new Box3().setFromObject(ve.current,pe),Te=new Vector3,be=new Sphere$2,Re=_e.max.x-_e.min.x,we=_e.max.y-_e.min.y,Pe=_e.max.z-_e.min.z;_e.getCenter(Te),_e.getBoundingSphere(be);const Ie=ae?we/2:le?-we/2:0,$e=oe?-Re/2:se?Re/2:0,Ue=ce?Pe/2:fe?-Pe/2:0;ye.current.position.set(Z||te?0:-Te.x+$e,Z||ne?0:-Te.y+Ie,Z||ie?0:-Te.z+Ue),typeof de<"u"&&de({parent:Ae.current.parent,container:Ae.current,width:Re,height:we,depth:Pe,boundingBox:_e,boundingSphere:be,center:Te,verticalAlignment:Ie,horizontalAlignment:$e,depthAlignment:Ue})},[he,de,ae,oe,ce,Z,te,ne,ie,pe,se,le,fe]),reactExports.useImperativeHandle(me,()=>Ae.current,[]),reactExports.createElement("group",_extends$3({ref:Ae},ge),reactExports.createElement("group",{ref:ye},reactExports.createElement("group",{ref:ve},_)))}),setUpdateRange=(K,_)=>{K.updateRanges[0]=_};function isFunctionChild(K){return typeof K=="function"}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_mesh$1=new Mesh;class PositionMesh extends Group{constructor(){super(),this.color=new Color$1("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var _;return(_=this.instance.current)==null?void 0:_.geometry}raycast(_,Z){const te=this.instance.current;if(!te||!te.geometry||!te.material)return;_mesh$1.geometry=te.geometry;const ne=te.matrixWorld,ie=te.userData.instances.indexOf(this.instanceKey);if(!(ie===-1||ie>te.count)){te.getMatrixAt(ie,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(ne,_instanceLocalMatrix),_mesh$1.matrixWorld=_instanceWorldMatrix,te.material instanceof Material?_mesh$1.material.side=te.material.side:_mesh$1.material.side=te.material[0].side,_mesh$1.raycast(_,_instanceIntersects);for(let oe=0,se=_instanceIntersects.length;oe<se;oe++){const ae=_instanceIntersects[oe];ae.instanceId=ie,ae.object=this,Z.push(ae)}_instanceIntersects.length=0}}}const globalContext=reactExports.createContext(null),parentMatrix$2=new Matrix4,instanceMatrix=new Matrix4,tempMatrix$2=new Matrix4,translation$1=new Vector3,rotation$1=new Quaternion,scale$1=new Vector3,isInstancedBufferAttribute=K=>K.isInstancedBufferAttribute,Instance=reactExports.forwardRef(({context:K,children:_,...Z},te)=>{reactExports.useMemo(()=>extend$6({PositionMesh}),[]);const ne=reactExports.useRef(null);reactExports.useImperativeHandle(te,()=>ne.current,[]);const{subscribe:ie,getParent:oe}=reactExports.useContext(K||globalContext);return reactExports.useLayoutEffect(()=>ie(ne),[]),reactExports.createElement("positionMesh",_extends$3({instance:oe(),instanceKey:ne,ref:ne},Z),_)}),Instances=reactExports.forwardRef(({context:K,children:_,range:Z,limit:te=1e3,frames:ne=1/0,...ie},oe)=>{const[{localContext:se,instance:ae}]=reactExports.useState(()=>{const ye=reactExports.createContext(null);return{localContext:ye,instance:reactExports.forwardRef((ve,_e)=>reactExports.createElement(Instance,_extends$3({context:ye},ve,{ref:_e})))}}),le=reactExports.useRef(null);reactExports.useImperativeHandle(oe,()=>le.current,[]);const[ce,fe]=reactExports.useState([]),[[de,pe]]=reactExports.useState(()=>{const ye=new Float32Array(te*16);for(let ve=0;ve<te;ve++)tempMatrix$2.identity().toArray(ye,ve*16);return[ye,new Float32Array([...new Array(te*3)].map(()=>1))]});reactExports.useEffect(()=>{le.current.instanceMatrix.needsUpdate=!0});let he=0,ge=0;const me=reactExports.useRef([]);reactExports.useLayoutEffect(()=>{me.current=Object.entries(le.current.geometry.attributes).filter(([ye,ve])=>isInstancedBufferAttribute(ve))}),useFrame(()=>{if(ne===1/0||he<ne){le.current.updateMatrix(),le.current.updateMatrixWorld(),parentMatrix$2.copy(le.current.matrixWorld).invert(),ge=Math.min(te,Z!==void 0?Z:te,ce.length),le.current.count=ge,setUpdateRange(le.current.instanceMatrix,{start:0,count:ge*16}),setUpdateRange(le.current.instanceColor,{start:0,count:ge*3});for(let ye=0;ye<ce.length;ye++){const ve=ce[ye].current;ve.matrixWorld.decompose(translation$1,rotation$1,scale$1),instanceMatrix.compose(translation$1,rotation$1,scale$1).premultiply(parentMatrix$2),instanceMatrix.toArray(de,ye*16),le.current.instanceMatrix.needsUpdate=!0,ve.color.toArray(pe,ye*3),le.current.instanceColor.needsUpdate=!0}he++}});const Ae=reactExports.useMemo(()=>({getParent:()=>le,subscribe:ye=>(fe(ve=>[...ve,ye]),()=>fe(ve=>ve.filter(_e=>_e.current!==ye.current)))}),[]);return reactExports.createElement("instancedMesh",_extends$3({userData:{instances:ce,limit:te,frames:ne},matrixAutoUpdate:!1,ref:le,args:[null,null,0],raycast:()=>null},ie),reactExports.createElement("instancedBufferAttribute",{attach:"instanceMatrix",args:[de,16],usage:DynamicDrawUsage}),reactExports.createElement("instancedBufferAttribute",{attach:"instanceColor",args:[pe,3],usage:DynamicDrawUsage}),isFunctionChild(_)?reactExports.createElement(se.Provider,{value:Ae},_(ae)):K?reactExports.createElement(K.Provider,{value:Ae},_):reactExports.createElement(globalContext.Provider,{value:Ae},_))}),Merged=reactExports.forwardRef(function({meshes:_,children:Z,...te},ne){const ie=Array.isArray(_);if(!ie)for(const ae of Object.keys(_))_[ae].isMesh||delete _[ae];const oe=ae=>ie?Z(...ae):Z(Object.keys(_).filter(le=>_[le].isMesh).reduce((le,ce,fe)=>({...le,[ce]:ae[fe]}),{})),se=(ie?_:Object.values(_)).map(({geometry:ae,material:le})=>reactExports.createElement(Instances,_extends$3({key:ae.uuid,geometry:ae,material:le},te)));return reactExports.createElement("group",{ref:ne},renderRecursive(oe,se))});function renderRecursive(K,_,Z=[]){if(!_[0])return K(Z);function te(ne){return renderRecursive(K,_.slice(1),Z.concat([ne]))}return typeof _[0]=="function"?_[0]({results:Z,render:te}):reactExports.cloneElement(_[0],{children:te})}function createInstances(){const K=reactExports.createContext(null);return[reactExports.forwardRef((_,Z)=>reactExports.createElement(Instances,_extends$3({ref:Z,context:K},_))),reactExports.forwardRef((_,Z)=>reactExports.createElement(Instance,_extends$3({ref:Z,context:K},_)))]}const InstancedAttribute=reactExports.forwardRef(({name:K,defaultValue:_,normalized:Z,usage:te=DynamicDrawUsage},ne)=>{const ie=reactExports.useRef(null);reactExports.useImperativeHandle(ne,()=>ie.current,[]),reactExports.useLayoutEffect(()=>{const se=ie.current.__r3f.parent.object;se.geometry.attributes[K]=ie.current;const ae=Array.isArray(_)?_:[_],le=Array.from({length:se.userData.limit},()=>ae).flat();return ie.current.array=new Float32Array(le),ie.current.itemSize=ae.length,ie.current.count=le.length/ie.current.itemSize,()=>{delete se.geometry.attributes[K]}},[K]);let oe=0;return useFrame(()=>{const se=ie.current.__r3f.parent.object;if(se.userData.frames===1/0||oe<se.userData.frames){for(let ae=0;ae<se.userData.instances.length;ae++){const ce=se.userData.instances[ae].current[K];ce!==void 0&&(ie.current.set(Array.isArray(ce)?ce:typeof ce.toArray=="function"?ce.toArray():[ce],ae*ie.current.itemSize),ie.current.needsUpdate=!0)}oe++}}),reactExports.createElement("instancedBufferAttribute",{ref:ie,usage:te,normalized:Z})}),context$6=reactExports.createContext(null);function useSpriteAnimator(){return reactExports.useContext(context$6)}function isSpriteData(K){return K!==null&&"meta"in K&&"frames"in K}const geometry=new PlaneGeometry(1,1),SpriteAnimator=reactExports.forwardRef(({startFrame:K=0,endFrame:_,fps:Z=30,frameName:te="",textureDataURL:ne,textureImageURL:ie,loop:oe=!1,numberOfFrames:se=1,autoPlay:ae=!0,animationNames:le,onStart:ce,onEnd:fe,onLoopEnd:de,onFrame:pe,play:he,pause:ge=!1,flipX:me=!1,alphaTest:Ae=0,children:ye,asSprite:ve=!1,offset:_e,playBackwards:Te=!1,resetOnEnd:be=!1,maxItems:Re=1,instanceItems:we=[[0,0,0]],spriteDataset:Pe,canvasRenderingContext2DSettings:Ie,roundFramePosition:$e=!1,meshProps:Ue={},...ke},Ge)=>{const He=reactExports.useRef(new Group),ze=reactExports.useRef(null),Ke=reactExports.useRef(null),tt=reactExports.useRef(null),Je=reactExports.useRef(window.performance.now()),ot=reactExports.useRef(K),Fe=reactExports.useRef(te),ct=Z>0?1e3/Z:0,[ht,lt]=reactExports.useState(new Texture$1),Qe=reactExports.useRef(0),[Ze,it]=reactExports.useState(new Vector3(1,1,1)),nt=me?-1:1,Tt=reactExports.useRef(ge),St=reactExports.useRef(_e),Et=reactExports.useRef(!1),{spriteObj:Nt,loadJsonAndTexture:zt}=useSpriteLoader(null,null,le,se,void 0,Ie),yt=reactExports.useRef(te),Ut=reactExports.useCallback((st,vt)=>{if(vt===null)se&&(Qe.current=se,Te&&(ot.current=se-1),ze.current=vt);else{var Pt,Lt;ze.current=vt,ze.current&&Array.isArray(ze.current.frames)?Qe.current=ze.current.frames.length:ze.current&&typeof ze.current=="object"&&yt.current?Qe.current=ze.current.frames[yt.current].length:Qe.current=0,Te&&(ot.current=Qe.current-1);const{w:Vt,h:Le}=getFirstFrame((Pt=(Lt=ze.current)==null?void 0:Lt.frames)!==null&&Pt!==void 0?Pt:[],yt.current).sourceSize,De=Mt(Vt,Le);it(De),Ke.current&&(Ke.current.map=st)}lt(st)},[se,Te]),bt=reactExports.useCallback(()=>{if(!ze.current)return;const{meta:{size:st},frames:vt}=ze.current,{w:Pt,h:Lt}=Array.isArray(vt)?vt[0].sourceSize:te?vt[te]?vt[te][0].sourceSize:{w:0,h:0}:{w:0,h:0};Ke.current&&Ke.current.map&&(Ke.current.map.wrapS=Ke.current.map.wrapT=RepeatWrapping,Ke.current.map.center.set(0,0),Ke.current.map.repeat.set(1*nt/(st.w/Pt),1/(st.h/Lt)));const Le=1/((st.h-1)/Lt);Ke.current&&Ke.current.map&&(Ke.current.map.offset.x=0,Ke.current.map.offset.y=1-Le),ce&&ce({currentFrameName:te??"",currentFrame:ot.current})},[nt,te,ce]),Ot=reactExports.useMemo(()=>({current:St.current,offset:St.current,imageUrl:ie,hasEnded:!1,ref:Ge}),[ie,Ge]);reactExports.useImperativeHandle(Ge,()=>He.current,[]),reactExports.useLayoutEffect(()=>{St.current=_e},[_e]);const Mt=(st,vt)=>{var Pt;const Lt=new Vector3,Vt=vt/st;return Lt.set(1,Vt,1),(Pt=tt.current)==null||Pt.scale.copy(Lt),Lt};reactExports.useEffect(()=>{if(Pe){var st;Ut(Pe==null||(st=Pe.spriteTexture)==null?void 0:st.clone(),Pe.spriteData)}else ie&&ne&&zt(ie,ne)},[zt,Pe,ne,ie,Ut]),reactExports.useEffect(()=>{if(Nt){var st;Ut(Nt==null||(st=Nt.spriteTexture)==null?void 0:st.clone(),Nt==null?void 0:Nt.spriteData)}},[Nt,Ut]),reactExports.useEffect(()=>{if(Ot.hasEnded=!1,ze.current&&Te===!0){var st;ot.current=((st=ze.current.frames.length)!==null&&st!==void 0?st:0)-1}else ot.current=0},[Te,Ot]),reactExports.useLayoutEffect(()=>{bt()},[ht,me,bt]),reactExports.useEffect(()=>{ae&&(Tt.current=!1)},[ae]),reactExports.useLayoutEffect(()=>{if(Fe.current!==te&&te&&(ot.current=0,Fe.current=te,Ot.hasEnded=!1,ct<=0&&(ot.current=_||K||0),ze.current)){const{w:st,h:vt}=getFirstFrame(ze.current.frames,te).sourceSize,Pt=Mt(st,vt);it(Pt)}},[te,ct,Ot,_,K]);const _t=()=>{if(!isSpriteData(ze.current))return;const{meta:{size:st},frames:vt}=ze.current,{w:Pt,h:Lt}=getFirstFrame(vt,te).sourceSize,Vt=Array.isArray(vt)?vt:te?vt[te]:[],Le=_||Vt.length-1;var De=_e===void 0?Ot.current:_e;if(ct<=0){ot.current=_||K||0,pt(Pt,Lt,st,Vt);return}const Be=window.performance.now(),rt=Be-Je.current;if(!(rt<=ct)){var at=Te?ot.current<0:ot.current>Le,xt=Te?ot.current===Le:ot.current===0,Ct=Te?ot.current<0:ot.current>=Le;if(at){if(ot.current=oe?K??0:0,Te&&(ot.current=Le),oe?de==null||de({currentFrameName:te??"",currentFrame:ot.current}):(fe==null||fe({currentFrameName:te??"",currentFrame:ot.current}),Ot.hasEnded=!be,be&&(Tt.current=!0)),!oe)return}else xt&&(ce==null||ce({currentFrameName:te??"",currentFrame:ot.current}));De!==void 0&&Ct?Et.current===!1&&(fe==null||fe({currentFrameName:te??"",currentFrame:ot.current}),Et.current=!0):Et.current=!1,!(rt<=ct)&&(Je.current=Be-rt%ct,pt(Pt,Lt,st,Vt))}},pt=(st,vt,Pt,Lt)=>{var Vt=_e===void 0?Ot.current:_e;const Le=ot.current;let De=0,Be=0;Mt(st,vt);const rt=$e?Math.round((Pt.w-1)/st):(Pt.w-1)/st,at=$e?Math.round((Pt.h-1)/vt):(Pt.h-1)/vt;if(!Lt[Le])return;const{frame:{x:xt,y:Ct},sourceSize:{w:Qt,h:qt}}=Lt[Le],It=1/rt,Gt=1/at;if(Ke.current&&Ke.current.map&&(De=nt>0?It*(xt/Qt):It*(xt/Qt)-Ke.current.map.repeat.x,Be=Math.abs(1-Gt)-Gt*(Ct/qt),Ke.current.map.offset.x=De,Ke.current.map.offset.y=Be),Vt!=null){let Jt=Math.floor(Vt*Lt.length);Jt=Math.max(0,Math.min(Jt,Lt.length-1)),isNaN(Jt)&&(Jt=0),ot.current=Jt}else Te?ot.current-=1:ot.current+=1};useFrame((st,vt)=>{var Pt,Lt;!((Pt=ze.current)!=null&&Pt.frames)||!((Lt=Ke.current)!=null&&Lt.map)||Tt.current||!Ot.hasEnded&&(ae||he)&&(_t(),pe==null||pe({currentFrameName:Fe.current,currentFrame:ot.current}))});function ft(st=new Vector3(1,1,1),vt=1){if(typeof vt=="number")return st.multiplyScalar(vt);if(Array.isArray(vt))return st.multiply(new Vector3(...vt));if(vt instanceof Vector3)return st.multiply(vt)}return reactExports.createElement("group",_extends$3({},ke,{ref:He,scale:ft(Ze,ke.scale)}),reactExports.createElement(context$6.Provider,{value:Ot},ve&&reactExports.createElement(Billboard,null,reactExports.createElement("mesh",_extends$3({ref:tt,scale:1,geometry},Ue),reactExports.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:DoubleSide,ref:Ke,map:ht,transparent:!0,alphaTest:Ae??0}))),!ve&&reactExports.createElement(Instances,_extends$3({geometry,limit:Re??1},Ue),reactExports.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:DoubleSide,ref:Ke,map:ht,transparent:!0,alphaTest:Ae??0}),(we??[0]).map((st,vt)=>reactExports.createElement(Instance,_extends$3({key:vt,ref:(we==null?void 0:we.length)===1?tt:null,position:st,scale:1},Ue)))),ye))}),CurveModifier=reactExports.forwardRef(({children:K,curve:_},Z)=>{const[te]=reactExports.useState(()=>new Scene$1),[ne,ie]=reactExports.useState(),oe=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{oe.current=new Flow(te.children[0]),ie(oe.current.object3D)},[K]),reactExports.useEffect(()=>{var se;_&&((se=oe.current)==null||se.updateCurve(0,_))},[_]),reactExports.useImperativeHandle(Z,()=>oe.current),reactExports.createElement(reactExports.Fragment,null,createPortal(K,te),ne&&reactExports.createElement("primitive",{object:ne}))});var distort=`#define GLSLIFY 1
vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}`;class DistortMaterialImpl extends MeshPhysicalMaterial{constructor(_={}){super(_),this.setValues(_),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(_){_.uniforms.time=this._time,_.uniforms.radius=this._radius,_.uniforms.distort=this._distort,_.vertexShader=`
      uniform float time;
      uniform float radius;
      uniform float distort;
      ${distort}
      ${_.vertexShader}
    `,_.vertexShader=_.vertexShader.replace("#include <begin_vertex>",`
        float updateTime = time / 50.0;
        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));
        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));
        `)}get time(){return this._time.value}set time(_){this._time.value=_}get distort(){return this._distort.value}set distort(_){this._distort.value=_}get radius(){return this._radius.value}set radius(_){this._radius.value=_}}const MeshDistortMaterial=reactExports.forwardRef(({speed:K=1,..._},Z)=>{const[te]=reactExports.useState(()=>new DistortMaterialImpl);return useFrame(ne=>te&&(te.time=ne.clock.elapsedTime*K)),reactExports.createElement("primitive",_extends$3({object:te,ref:Z,attach:"material"},_))});class WobbleMaterialImpl extends MeshStandardMaterial{constructor(_={}){super(_),this.setValues(_),this._time={value:0},this._factor={value:1}}onBeforeCompile(_){_.uniforms.time=this._time,_.uniforms.factor=this._factor,_.vertexShader=`
      uniform float time;
      uniform float factor;
      ${_.vertexShader}
    `,_.vertexShader=_.vertexShader.replace("#include <begin_vertex>",`float theta = sin( time + position.y ) / 2.0 * factor;
        float c = cos( theta );
        float s = sin( theta );
        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );
        vec3 transformed = vec3( position ) * m;
        vNormal = vNormal * m;`)}get time(){return this._time.value}set time(_){this._time.value=_}get factor(){return this._factor.value}set factor(_){this._factor.value=_}}const MeshWobbleMaterial=reactExports.forwardRef(({speed:K=1,..._},Z)=>{const[te]=reactExports.useState(()=>new WobbleMaterialImpl);return useFrame(ne=>te&&(te.time=ne.clock.elapsedTime*K)),reactExports.createElement("primitive",_extends$3({object:te,ref:Z,attach:"material"},_))});class ConvolutionMaterial extends ShaderMaterial{constructor(_=new Vector2){super({uniforms:{inputBuffer:new Uniform(null),depthBuffer:new Uniform(null),resolution:new Uniform(new Vector2),texelSize:new Uniform(new Vector2),halfTexelSize:new Uniform(new Vector2),kernel:new Uniform(0),scale:new Uniform(1),cameraNear:new Uniform(0),cameraFar:new Uniform(1),minDepthThreshold:new Uniform(0),maxDepthThreshold:new Uniform(1),depthScale:new Uniform(0),depthToBlurRatioBias:new Uniform(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:NoBlending,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(_.x,_.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(_,Z){this.uniforms.texelSize.value.set(_,Z),this.uniforms.halfTexelSize.value.set(_,Z).multiplyScalar(.5)}setResolution(_){this.uniforms.resolution.value.copy(_)}}class BlurPass{constructor({gl:_,resolution:Z,width:te=500,height:ne=500,minDepthThreshold:ie=0,maxDepthThreshold:oe=1,depthScale:se=0,depthToBlurRatioBias:ae=.25}){this.renderToScreen=!1,this.renderTargetA=new WebGLRenderTarget(Z,Z,{minFilter:LinearFilter,magFilter:LinearFilter,stencilBuffer:!1,depthBuffer:!1,type:HalfFloatType}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new ConvolutionMaterial,this.convolutionMaterial.setTexelSize(1/te,1/ne),this.convolutionMaterial.setResolution(new Vector2(te,ne)),this.scene=new Scene$1,this.camera=new Camera$1,this.convolutionMaterial.uniforms.minDepthThreshold.value=ie,this.convolutionMaterial.uniforms.maxDepthThreshold.value=oe,this.convolutionMaterial.uniforms.depthScale.value=se,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=ae,this.convolutionMaterial.defines.USE_DEPTH=se>0;const le=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),ce=new Float32Array([0,0,2,0,0,2]),fe=new BufferGeometry;fe.setAttribute("position",new BufferAttribute(le,3)),fe.setAttribute("uv",new BufferAttribute(ce,2)),this.screen=new Mesh(fe,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(_,Z,te){const ne=this.scene,ie=this.camera,oe=this.renderTargetA,se=this.renderTargetB;let ae=this.convolutionMaterial,le=ae.uniforms;le.depthBuffer.value=Z.depthTexture;const ce=ae.kernel;let fe=Z,de,pe,he;for(pe=0,he=ce.length-1;pe<he;++pe)de=pe&1?se:oe,le.kernel.value=ce[pe],le.inputBuffer.value=fe.texture,_.setRenderTarget(de),_.render(ne,ie),fe=de;le.kernel.value=ce[pe],le.inputBuffer.value=fe.texture,_.setRenderTarget(this.renderToScreen?null:te),_.render(ne,ie)}}let MeshReflectorMaterial$1=class extends MeshStandardMaterial{constructor(_={}){super(_),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(_)}onBeforeCompile(_){var Z;(Z=_.defines)!=null&&Z.USE_UV||(_.defines.USE_UV=""),_.uniforms.hasBlur=this._hasBlur,_.uniforms.tDiffuse=this._tDiffuse,_.uniforms.tDepth=this._tDepth,_.uniforms.distortionMap=this._distortionMap,_.uniforms.tDiffuseBlur=this._tDiffuseBlur,_.uniforms.textureMatrix=this._textureMatrix,_.uniforms.mirror=this._mirror,_.uniforms.mixBlur=this._mixBlur,_.uniforms.mixStrength=this._blurStrength,_.uniforms.minDepthThreshold=this._minDepthThreshold,_.uniforms.maxDepthThreshold=this._maxDepthThreshold,_.uniforms.depthScale=this._depthScale,_.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,_.uniforms.distortion=this._distortion,_.uniforms.mixContrast=this._mixContrast,_.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${_.vertexShader}`,_.vertexShader=_.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),_.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
			  uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${_.fragmentShader}`,_.fragmentShader=_.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(_){this._tDiffuse.value=_}get tDepth(){return this._tDepth.value}set tDepth(_){this._tDepth.value=_}get distortionMap(){return this._distortionMap.value}set distortionMap(_){this._distortionMap.value=_}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(_){this._tDiffuseBlur.value=_}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(_){this._textureMatrix.value=_}get hasBlur(){return this._hasBlur.value}set hasBlur(_){this._hasBlur.value=_}get mirror(){return this._mirror.value}set mirror(_){this._mirror.value=_}get mixBlur(){return this._mixBlur.value}set mixBlur(_){this._mixBlur.value=_}get mixStrength(){return this._blurStrength.value}set mixStrength(_){this._blurStrength.value=_}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(_){this._minDepthThreshold.value=_}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(_){this._maxDepthThreshold.value=_}get depthScale(){return this._depthScale.value}set depthScale(_){this._depthScale.value=_}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(_){this._depthToBlurRatioBias.value=_}get distortion(){return this._distortion.value}set distortion(_){this._distortion.value=_}get mixContrast(){return this._mixContrast.value}set mixContrast(_){this._mixContrast.value=_}};const MeshReflectorMaterial=reactExports.forwardRef(({mixBlur:K=0,mixStrength:_=1,resolution:Z=256,blur:te=[0,0],minDepthThreshold:ne=.9,maxDepthThreshold:ie=1,depthScale:oe=0,depthToBlurRatioBias:se=.25,mirror:ae=0,distortion:le=1,mixContrast:ce=1,distortionMap:fe,reflectorOffset:de=0,...pe},he)=>{extend$6({MeshReflectorMaterialImpl:MeshReflectorMaterial$1});const ge=useThree(({gl:ht})=>ht),me=useThree(({camera:ht})=>ht),Ae=useThree(({scene:ht})=>ht);te=Array.isArray(te)?te:[te,te];const ye=te[0]+te[1]>0,ve=te[0],_e=te[1],Te=reactExports.useRef(null);reactExports.useImperativeHandle(he,()=>Te.current,[]);const[be]=reactExports.useState(()=>new Plane$2),[Re]=reactExports.useState(()=>new Vector3),[we]=reactExports.useState(()=>new Vector3),[Pe]=reactExports.useState(()=>new Vector3),[Ie]=reactExports.useState(()=>new Matrix4),[$e]=reactExports.useState(()=>new Vector3(0,0,-1)),[Ue]=reactExports.useState(()=>new Vector4),[ke]=reactExports.useState(()=>new Vector3),[Ge]=reactExports.useState(()=>new Vector3),[He]=reactExports.useState(()=>new Vector4),[ze]=reactExports.useState(()=>new Matrix4),[Ke]=reactExports.useState(()=>new PerspectiveCamera$2),tt=reactExports.useCallback(()=>{var ht;const lt=Te.current.parent||((ht=Te.current)==null||(ht=ht.__r3f.parent)==null?void 0:ht.object);if(!lt||(we.setFromMatrixPosition(lt.matrixWorld),Pe.setFromMatrixPosition(me.matrixWorld),Ie.extractRotation(lt.matrixWorld),Re.set(0,0,1),Re.applyMatrix4(Ie),we.addScaledVector(Re,de),ke.subVectors(we,Pe),ke.dot(Re)>0))return;ke.reflect(Re).negate(),ke.add(we),Ie.extractRotation(me.matrixWorld),$e.set(0,0,-1),$e.applyMatrix4(Ie),$e.add(Pe),Ge.subVectors(we,$e),Ge.reflect(Re).negate(),Ge.add(we),Ke.position.copy(ke),Ke.up.set(0,1,0),Ke.up.applyMatrix4(Ie),Ke.up.reflect(Re),Ke.lookAt(Ge),Ke.far=me.far,Ke.updateMatrixWorld(),Ke.projectionMatrix.copy(me.projectionMatrix),ze.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ze.multiply(Ke.projectionMatrix),ze.multiply(Ke.matrixWorldInverse),ze.multiply(lt.matrixWorld),be.setFromNormalAndCoplanarPoint(Re,we),be.applyMatrix4(Ke.matrixWorldInverse),Ue.set(be.normal.x,be.normal.y,be.normal.z,be.constant);const Qe=Ke.projectionMatrix;He.x=(Math.sign(Ue.x)+Qe.elements[8])/Qe.elements[0],He.y=(Math.sign(Ue.y)+Qe.elements[9])/Qe.elements[5],He.z=-1,He.w=(1+Qe.elements[10])/Qe.elements[14],Ue.multiplyScalar(2/Ue.dot(He)),Qe.elements[2]=Ue.x,Qe.elements[6]=Ue.y,Qe.elements[10]=Ue.z+1,Qe.elements[14]=Ue.w},[me,de]),[Je,ot,Fe,ct]=reactExports.useMemo(()=>{const ht={minFilter:LinearFilter,magFilter:LinearFilter,type:HalfFloatType},lt=new WebGLRenderTarget(Z,Z,ht);lt.depthBuffer=!0,lt.depthTexture=new DepthTexture(Z,Z),lt.depthTexture.format=DepthFormat,lt.depthTexture.type=UnsignedShortType;const Qe=new WebGLRenderTarget(Z,Z,ht),Ze=new BlurPass({gl:ge,resolution:Z,width:ve,height:_e,minDepthThreshold:ne,maxDepthThreshold:ie,depthScale:oe,depthToBlurRatioBias:se}),it={mirror:ae,textureMatrix:ze,mixBlur:K,tDiffuse:lt.texture,tDepth:lt.depthTexture,tDiffuseBlur:Qe.texture,hasBlur:ye,mixStrength:_,minDepthThreshold:ne,maxDepthThreshold:ie,depthScale:oe,depthToBlurRatioBias:se,distortion:le,distortionMap:fe,mixContrast:ce,"defines-USE_BLUR":ye?"":void 0,"defines-USE_DEPTH":oe>0?"":void 0,"defines-USE_DISTORTION":fe?"":void 0};return[lt,Qe,Ze,it]},[ge,ve,_e,ze,Z,ae,ye,K,_,ne,ie,oe,se,le,fe,ce]);return useFrame(()=>{var ht;const lt=Te.current.parent||((ht=Te.current)==null||(ht=ht.__r3f.parent)==null?void 0:ht.object);if(!lt)return;lt.visible=!1;const Qe=ge.xr.enabled,Ze=ge.shadowMap.autoUpdate;tt(),ge.xr.enabled=!1,ge.shadowMap.autoUpdate=!1,ge.setRenderTarget(Je),ge.state.buffers.depth.setMask(!0),ge.autoClear||ge.clear(),ge.render(Ae,Ke),ye&&Fe.render(ge,Je,ot),ge.xr.enabled=Qe,ge.shadowMap.autoUpdate=Ze,lt.visible=!0,ge.setRenderTarget(null)}),reactExports.createElement("meshReflectorMaterialImpl",_extends$3({attach:"material",key:"key"+ct["defines-USE_BLUR"]+ct["defines-USE_DEPTH"]+ct["defines-USE_DISTORTION"],ref:Te},ct,pe))}),MeshRefractionMaterial$1=shaderMaterial({envMap:null,bounces:3,ior:2.4,correctMips:!0,aberrationStrength:.01,fresnel:0,bvh:new MeshBVHUniformStruct$1,color:new Color$1("white"),opacity:1,resolution:new Vector2,viewMatrixInverse:new Matrix4,projectionMatrixInverse:new Matrix4},`
  uniform mat4 viewMatrixInverse;

  varying vec3 vWorldPosition;
  varying vec3 vNormal;
  varying mat4 vModelMatrixInverse;

  #include <color_pars_vertex>

  void main() {
    #include <color_vertex>

    vec4 transformedNormal = vec4(normal, 0.0);
    vec4 transformedPosition = vec4(position, 1.0);
    #ifdef USE_INSTANCING
      transformedNormal = instanceMatrix * transformedNormal;
      transformedPosition = instanceMatrix * transformedPosition;
    #endif

    #ifdef USE_INSTANCING
      vModelMatrixInverse = inverse(modelMatrix * instanceMatrix);
    #else
      vModelMatrixInverse = inverse(modelMatrix);
    #endif

    vWorldPosition = (modelMatrix * transformedPosition).xyz;
    vNormal = normalize((viewMatrixInverse * vec4(normalMatrix * transformedNormal.xyz, 0.0)).xyz);
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * transformedPosition;
  }`,`
  #define ENVMAP_TYPE_CUBE_UV
  precision highp isampler2D;
  precision highp usampler2D;
  varying vec3 vWorldPosition;
  varying vec3 vNormal;
  varying mat4 vModelMatrixInverse;

  #include <color_pars_fragment>

  #ifdef ENVMAP_TYPE_CUBEM
    uniform samplerCube envMap;
  #else
    uniform sampler2D envMap;
  #endif

  uniform float bounces;
  ${shaderStructs}
  ${shaderIntersectFunction}
  uniform BVH bvh;
  uniform float ior;
  uniform bool correctMips;
  uniform vec2 resolution;
  uniform float fresnel;
  uniform mat4 modelMatrix;
  uniform mat4 projectionMatrixInverse;
  uniform mat4 viewMatrixInverse;
  uniform float aberrationStrength;
  uniform vec3 color;
  uniform float opacity;

  float fresnelFunc(vec3 viewDirection, vec3 worldNormal) {
    return pow( 1.0 + dot( viewDirection, worldNormal), 10.0 );
  }

  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 normal, float ior, mat4 modelMatrixInverse) {
    vec3 rayOrigin = ro;
    vec3 rayDirection = rd;
    rayDirection = refract(rayDirection, normal, 1.0 / ior);
    rayOrigin = vWorldPosition + rayDirection * 0.001;
    rayOrigin = (modelMatrixInverse * vec4(rayOrigin, 1.0)).xyz;
    rayDirection = normalize((modelMatrixInverse * vec4(rayDirection, 0.0)).xyz);
    for(float i = 0.0; i < bounces; i++) {
      uvec4 faceIndices = uvec4( 0u );
      vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );
      vec3 barycoord = vec3( 0.0 );
      float side = 1.0;
      float dist = 0.0;
      bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );
      vec3 hitPos = rayOrigin + rayDirection * max(dist - 0.001, 0.0);
      vec3 tempDir = refract(rayDirection, faceNormal, ior);
      if (length(tempDir) != 0.0) {
        rayDirection = tempDir;
        break;
      }
      rayDirection = reflect(rayDirection, faceNormal);
      rayOrigin = hitPos + rayDirection * 0.01;
    }
    rayDirection = normalize((modelMatrix * vec4(rayDirection, 0.0)).xyz);
    return rayDirection;
  }

  #include <common>
  #include <cube_uv_reflection_fragment>

  #ifdef ENVMAP_TYPE_CUBEM
    vec4 textureGradient(samplerCube envMap, vec3 rayDirection, vec3 directionCamPerfect) {
      return textureGrad(envMap, rayDirection, dFdx(correctMips ? directionCamPerfect: rayDirection), dFdy(correctMips ? directionCamPerfect: rayDirection));
    }
  #else
    vec4 textureGradient(sampler2D envMap, vec3 rayDirection, vec3 directionCamPerfect) {
      vec2 uvv = equirectUv( rayDirection );
      vec2 smoothUv = equirectUv( directionCamPerfect );
      return textureGrad(envMap, uvv, dFdx(correctMips ? smoothUv : uvv), dFdy(correctMips ? smoothUv : uvv));
    }
  #endif

  void main() {
    vec2 uv = gl_FragCoord.xy / resolution;
    vec3 directionCamPerfect = (projectionMatrixInverse * vec4(uv * 2.0 - 1.0, 0.0, 1.0)).xyz;
    directionCamPerfect = (viewMatrixInverse * vec4(directionCamPerfect, 0.0)).xyz;
    directionCamPerfect = normalize(directionCamPerfect);
    vec3 normal = vNormal;
    vec3 rayOrigin = cameraPosition;
    vec3 rayDirection = normalize(vWorldPosition - cameraPosition);

    vec4 diffuseColor = vec4(color, opacity);
    #include <color_fragment>

    #ifdef CHROMATIC_ABERRATIONS
      vec3 rayDirectionG = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);
      #ifdef FAST_CHROMA
        vec3 rayDirectionR = normalize(rayDirectionG + 1.0 * vec3(aberrationStrength / 2.0));
        vec3 rayDirectionB = normalize(rayDirectionG - 1.0 * vec3(aberrationStrength / 2.0));
      #else
        vec3 rayDirectionR = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 - aberrationStrength), 1.0), vModelMatrixInverse);
        vec3 rayDirectionB = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 + aberrationStrength), 1.0), vModelMatrixInverse);
      #endif
      float finalColorR = textureGradient(envMap, rayDirectionR, directionCamPerfect).r;
      float finalColorG = textureGradient(envMap, rayDirectionG, directionCamPerfect).g;
      float finalColorB = textureGradient(envMap, rayDirectionB, directionCamPerfect).b;
      diffuseColor.rgb *= vec3(finalColorR, finalColorG, finalColorB);
    #else
      rayDirection = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);
      diffuseColor.rgb *= textureGradient(envMap, rayDirection, directionCamPerfect).rgb;
    #endif

    vec3 viewDirection = normalize(vWorldPosition - cameraPosition);
    float nFresnel = fresnelFunc(viewDirection, normal) * fresnel;
    gl_FragColor = vec4(mix(diffuseColor.rgb, vec3(1.0), nFresnel), diffuseColor.a);

    #include <tonemapping_fragment>
    #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
  }`),isCubeTexture=K=>K&&K.isCubeTexture;function MeshRefractionMaterial({aberrationStrength:K=0,fastChroma:_=!0,envMap:Z,...te}){extend$6({MeshRefractionMaterial:MeshRefractionMaterial$1});const ne=reactExports.useRef(null),{size:ie}=useThree(),oe=reactExports.useMemo(()=>{var se,ae;const le={},ce=isCubeTexture(Z),de=((se=ce?(ae=Z.image[0])==null?void 0:ae.width:Z.image.width)!==null&&se!==void 0?se:1024)/4,pe=Math.floor(Math.log2(de)),he=Math.pow(2,pe),ge=3*Math.max(he,16*7),me=4*he;return ce&&(le.ENVMAP_TYPE_CUBEM=""),le.CUBEUV_TEXEL_WIDTH=`${1/ge}`,le.CUBEUV_TEXEL_HEIGHT=`${1/me}`,le.CUBEUV_MAX_MIP=`${pe}.0`,K>0&&(le.CHROMATIC_ABERRATIONS=""),_&&(le.FAST_CHROMA=""),le},[K,_]);return reactExports.useLayoutEffect(()=>{var se;const ae=(se=ne.current)==null||(se=se.__r3f)==null||(se=se.parent)==null||(se=se.object)==null?void 0:se.geometry;ae&&(ne.current.bvh=new MeshBVHUniformStruct$1,ne.current.bvh.updateFrom(new MeshBVH$1(ae.clone().toNonIndexed(),{strategy:SAH$1})))},[]),useFrame(({camera:se})=>{ne.current.viewMatrixInverse=se.matrixWorld,ne.current.projectionMatrixInverse=se.projectionMatrixInverse}),reactExports.createElement("meshRefractionMaterial",_extends$3({key:JSON.stringify(oe),defines:oe,ref:ne,resolution:[ie.width,ie.height],aberrationStrength:K,envMap:Z},te))}const DiscardMaterial=shaderMaterial({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class MeshTransmissionMaterialImpl extends MeshPhysicalMaterial{constructor(_=6,Z=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new Color$1("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=te=>{te.uniforms={...te.uniforms,...this.uniforms},this.anisotropy>0&&(te.defines.USE_ANISOTROPY=""),Z?te.defines.USE_SAMPLER="":te.defines.USE_TRANSMISSION="",te.fragmentShader=`
      uniform float chromaticAberration;         
      uniform float anisotropicBlur;      
      uniform float time;
      uniform float distortion;
      uniform float distortionScale;
      uniform float temporalDistortion;
      uniform sampler2D buffer;

      vec3 random3(vec3 c) {
        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
        vec3 r;
        r.z = fract(512.0*j);
        j *= .125;
        r.x = fract(512.0*j);
        j *= .125;
        r.y = fract(512.0*j);
        return r-0.5;
      }

      uint hash( uint x ) {
        x += ( x << 10u );
        x ^= ( x >>  6u );
        x += ( x <<  3u );
        x ^= ( x >> 11u );
        x += ( x << 15u );
        return x;
      }

      // Compound versions of the hashing algorithm I whipped together.
      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }
      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }
      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }

      // Construct a float with half-open range [0:1] using low 23 bits.
      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.
      float floatConstruct( uint m ) {
        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask
        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32
        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)
        m |= ieeeOne;                          // Add fractional part to 1.0
        float  f = uintBitsToFloat( m );       // Range [1:2]
        return f - 1.0;                        // Range [0:1]
      }

      // Pseudo-random value in half-open range [0:1].
      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }
      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float rand(float seed) {
        float result = randomBase(vec3(gl_FragCoord.xy, seed));
        return result;
      }

      const float F3 =  0.3333333;
      const float G3 =  0.1666667;

      float snoise(vec3 p) {
        vec3 s = floor(p + dot(p, vec3(F3)));
        vec3 x = p - s + dot(s, vec3(G3));
        vec3 e = step(vec3(0.0), x - x.yzx);
        vec3 i1 = e*(1.0 - e.zxy);
        vec3 i2 = 1.0 - e.zxy*(1.0 - e);
        vec3 x1 = x - i1 + G3;
        vec3 x2 = x - i2 + 2.0*G3;
        vec3 x3 = x - 1.0 + 3.0*G3;
        vec4 w, d;
        w.x = dot(x, x);
        w.y = dot(x1, x1);
        w.z = dot(x2, x2);
        w.w = dot(x3, x3);
        w = max(0.6 - w, 0.0);
        d.x = dot(random3(s), x);
        d.y = dot(random3(s + i1), x1);
        d.z = dot(random3(s + i2), x2);
        d.w = dot(random3(s + 1.0), x3);
        w *= w;
        w *= w;
        d *= w;
        return dot(d, vec4(52.0));
      }

      float snoiseFractal(vec3 m) {
        return 0.5333333* snoise(m)
              +0.2666667* snoise(2.0*m)
              +0.1333333* snoise(4.0*m)
              +0.0666667* snoise(8.0*m);
      }
`+te.fragmentShader,te.fragmentShader=te.fragmentShader.replace("#include <transmission_pars_fragment>",`
        #ifdef USE_TRANSMISSION
          // Transmission code is based on glTF-Sampler-Viewer
          // https://github.com/KhronosGroup/glTF-Sample-Viewer
          uniform float _transmission;
          uniform float thickness;
          uniform float attenuationDistance;
          uniform vec3 attenuationColor;
          #ifdef USE_TRANSMISSIONMAP
            uniform sampler2D transmissionMap;
          #endif
          #ifdef USE_THICKNESSMAP
            uniform sampler2D thicknessMap;
          #endif
          uniform vec2 transmissionSamplerSize;
          uniform sampler2D transmissionSamplerMap;
          uniform mat4 modelMatrix;
          uniform mat4 projectionMatrix;
          varying vec3 vWorldPosition;
          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
            // Direction of refracted light.
            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
            // Compute rotation-independant scaling of the model matrix.
            vec3 modelScale;
            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
            // The thickness is specified in local space.
            return normalize( refractionVector ) * thickness * modelScale;
          }
          float applyIorToRoughness( const in float roughness, const in float ior ) {
            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
            // an IOR of 1.5 results in the default amount of microfacet refraction.
            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
          }
          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            
            #ifdef USE_SAMPLER
              #ifdef texture2DLodEXT
                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);
              #else
                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);
              #endif
            #else
              return texture2D(buffer, fragCoord.xy);
            #endif
          }
          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
            if ( isinf( attenuationDistance ) ) {
              // Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.
              return radiance;
            } else {
              // Compute light attenuation using Beer's law.
              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
              return transmittance * radiance;
            }
          }
          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
            const in vec3 attenuationColor, const in float attenuationDistance ) {
            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
            vec3 refractedRayExit = position + transmissionRay;
            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
            vec2 refractionCoords = ndcPos.xy / ndcPos.w;
            refractionCoords += 1.0;
            refractionCoords /= 2.0;
            // Sample framebuffer to get pixel the refracted ray hits.
            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
            // Get the specular component.
            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
          }
        #endif
`),te.fragmentShader=te.fragmentShader.replace("#include <transmission_fragment>",`  
        // Improve the refraction to use the world pos
        material.transmission = _transmission;
        material.transmissionAlpha = 1.0;
        material.thickness = thickness;
        material.attenuationDistance = attenuationDistance;
        material.attenuationColor = attenuationColor;
        #ifdef USE_TRANSMISSIONMAP
          material.transmission *= texture2D( transmissionMap, vUv ).r;
        #endif
        #ifdef USE_THICKNESSMAP
          material.thickness *= texture2D( thicknessMap, vUv ).g;
        #endif
        
        vec3 pos = vWorldPosition;
        float runningSeed = 0.0;
        vec3 v = normalize( cameraPosition - pos );
        vec3 n = inverseTransformDirection( normal, viewMatrix );
        vec3 transmission = vec3(0.0);
        float transmissionR, transmissionB, transmissionG;
        float randomCoords = rand(runningSeed++);
        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);
        vec3 distortionNormal = vec3(0.0);
        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;
        if (distortion > 0.0) {
          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));
        }
        for (float i = 0.0; i < ${_}.0; i ++) {
          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);
          transmissionR = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(${_}),
            material.attenuationColor, material.attenuationDistance
          ).r;
          transmissionG = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(${_})) , material.thickness + thickness_smear * (i + randomCoords) / float(${_}),
            material.attenuationColor, material.attenuationDistance
          ).g;
          transmissionB = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(${_})), material.thickness + thickness_smear * (i + randomCoords) / float(${_}),
            material.attenuationColor, material.attenuationDistance
          ).b;
          transmission.r += transmissionR;
          transmission.g += transmissionG;
          transmission.b += transmissionB;
        }
        transmission /= ${_}.0;
        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
`)},Object.keys(this.uniforms).forEach(te=>Object.defineProperty(this,te,{get:()=>this.uniforms[te].value,set:ne=>this.uniforms[te].value=ne}))}}const MeshTransmissionMaterial=reactExports.forwardRef(({buffer:K,transmissionSampler:_=!1,backside:Z=!1,side:te=FrontSide,transmission:ne=1,thickness:ie=0,backsideThickness:oe=0,backsideEnvMapIntensity:se=1,samples:ae=10,resolution:le,backsideResolution:ce,background:fe,anisotropy:de,anisotropicBlur:pe,...he},ge)=>{extend$6({MeshTransmissionMaterial:MeshTransmissionMaterialImpl});const me=reactExports.useRef(null),[Ae]=reactExports.useState(()=>new DiscardMaterial),ye=useFBO(ce||le),ve=useFBO(le);let _e,Te,be,Re;return useFrame(we=>{if(me.current.time=we.clock.elapsedTime,me.current.buffer===ve.texture&&!_){var Pe;Re=(Pe=me.current.__r3f.parent)==null?void 0:Pe.object,Re&&(be=we.gl.toneMapping,_e=we.scene.background,Te=me.current.envMapIntensity,we.gl.toneMapping=NoToneMapping,fe&&(we.scene.background=fe),Re.material=Ae,Z&&(we.gl.setRenderTarget(ye),we.gl.render(we.scene,we.camera),Re.material=me.current,Re.material.buffer=ye.texture,Re.material.thickness=oe,Re.material.side=BackSide,Re.material.envMapIntensity=se),we.gl.setRenderTarget(ve),we.gl.render(we.scene,we.camera),Re.material=me.current,Re.material.thickness=ie,Re.material.side=te,Re.material.buffer=ve.texture,Re.material.envMapIntensity=Te,we.scene.background=_e,we.gl.setRenderTarget(null),we.gl.toneMapping=be)}}),reactExports.useImperativeHandle(ge,()=>me.current,[]),reactExports.createElement("meshTransmissionMaterial",_extends$3({args:[ae,_],ref:me},he,{buffer:K||ve.texture,_transmission:ne,anisotropicBlur:pe??de,transmission:_?ne:0,thickness:ie,side:te}))}),MeshDiscardMaterial=reactExports.forwardRef((K,_)=>(extend$6({DiscardMaterialImpl:DiscardMaterial}),reactExports.createElement("discardMaterialImpl",_extends$3({ref:_},K)))),opaque_fragment=version$3>=154?"opaque_fragment":"output_fragment";class PointMaterialImpl extends PointsMaterial{constructor(_){super(_),this.onBeforeCompile=(Z,te)=>{const{isWebGL2:ne}=te.capabilities;Z.fragmentShader=Z.fragmentShader.replace(`#include <${opaque_fragment}>`,`
        ${ne?`#include <${opaque_fragment}>`:`#extension GL_OES_standard_derivatives : enable
#include <${opaque_fragment}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const PointMaterial=reactExports.forwardRef((K,_)=>{const[Z]=reactExports.useState(()=>new PointMaterialImpl(null));return reactExports.createElement("primitive",_extends$3({},K,{object:Z,ref:_,attach:"material"}))}),pcss=({focus:K=0,size:_=25,samples:Z=10}={})=>`
#define PENUMBRA_FILTER_SIZE float(${_})
#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))
vec3 randRGB(vec2 uv) {
  return vec3(
    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),
    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),
    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)
  );
}

vec3 lowPassRandRGB(vec2 uv) {
  // 3x3 convolution (average)
  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9
  vec3 result = vec3(0);
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));
  result *= 0.111111111; // 1.0 / 9.0
  return result;
}
vec3 highPassRandRGB(vec2 uv) {
  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal
  // hp(x) = x - lp(x)
  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;
}


vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}
float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation
  return (zReceiver - zBlocker) / zBlocker;
}
float findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float blockerDepthSum = float(${K});
  float blockers = 0.0;

  int j = 0;
  vec2 offset = vec2(0.);
  float depth = 0.;

  #pragma unroll_loop_start
  for(int i = 0; i < ${Z}; i ++) {
    offset = (vogelDiskSample(j, ${Z}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;
    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));
    if (depth < compare) {
      blockerDepthSum += depth;
      blockers++;
    }
    j++;
  }
  #pragma unroll_loop_end

  if (blockers > 0.0) {
    return blockerDepthSum / blockers;
  }
  return -1.0;
}

        
float vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float shadow = 0.0f;
  int j = 0;
  vec2 vogelSample = vec2(0.0);
  vec2 offset = vec2(0.0);
  #pragma unroll_loop_start
  for (int i = 0; i < ${Z}; i++) {
    vogelSample = vogelDiskSample(j, ${Z}, angle) * texelSize;
    offset = vogelSample * (1.0 + filterRadius * float(${_}));
    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    j++;
  }
  #pragma unroll_loop_end
  return shadow * 1.0 / ${Z}.0;
}

float PCSS (sampler2D shadowMap, vec4 coords) {
  vec2 uv = coords.xy;
  float zReceiver = coords.z; // Assumed to be eye-space z in this code
  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;
  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);
  if (avgBlockerDepth == -1.0) {
    return 1.0;
  }
  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);
  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);
}`;function reset(K,_,Z){_.traverse(te=>{te.material&&(K.properties.remove(te.material),te.material.dispose==null||te.material.dispose())}),K.info.programs.length=0,K.compile(_,Z)}function SoftShadows({focus:K=0,samples:_=10,size:Z=25}){const te=useThree(oe=>oe.gl),ne=useThree(oe=>oe.scene),ie=useThree(oe=>oe.camera);return reactExports.useEffect(()=>{const oe=ShaderChunk.shadowmap_pars_fragment;return ShaderChunk.shadowmap_pars_fragment=ShaderChunk.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP",`#ifdef USE_SHADOWMAP
`+pcss({size:Z,samples:_,focus:K})).replace("#if defined( SHADOWMAP_TYPE_PCF )",`
return PCSS(shadowMap, shadowCoord);
#if defined( SHADOWMAP_TYPE_PCF )`),reset(te,ne,ie),()=>{ShaderChunk.shadowmap_pars_fragment=oe,reset(te,ne,ie)}},[K,Z,_]),null}function create$c(K,_){const Z=K+"Geometry";return reactExports.forwardRef(({args:te,children:ne,...ie},oe)=>{const se=reactExports.useRef(null);return reactExports.useImperativeHandle(oe,()=>se.current),reactExports.useLayoutEffect(()=>void(_==null?void 0:_(se.current))),reactExports.createElement("mesh",_extends$3({ref:se},ie),reactExports.createElement(Z,{attach:"geometry",args:te}),ne)})}const Box$1=create$c("box"),Circle$1=create$c("circle"),Cone$1=create$c("cone"),Cylinder$1=create$c("cylinder"),Sphere$1=create$c("sphere"),Plane$1=create$c("plane"),Tube$1=create$c("tube"),Torus$1=create$c("torus"),TorusKnot$1=create$c("torusKnot"),Tetrahedron$1=create$c("tetrahedron"),Ring$1=create$c("ring"),Polyhedron$1=create$c("polyhedron"),Icosahedron$1=create$c("icosahedron"),Octahedron$1=create$c("octahedron"),Dodecahedron$1=create$c("dodecahedron"),Extrude$1=create$c("extrude"),Lathe$1=create$c("lathe"),Capsule$1=create$c("capsule"),Shape$1=create$c("shape",({geometry:K})=>{const _=K.attributes.position,Z=new Box3().setFromBufferAttribute(_),te=new Vector3;Z.getSize(te);const ne=[];let ie=0,oe=0,se=0,ae=0;for(let le=0;le<_.count;le++)ie=_.getX(le),oe=_.getY(le),se=(ie-Z.min.x)/te.x,ae=(oe-Z.min.y)/te.y,ne.push(se,ae);K.setAttribute("uv",new Float32BufferAttribute(ne,2))}),eps=1e-5;function createShape(K,_,Z){const te=new Shape$2,ne=Z-eps;return te.absarc(eps,eps,eps,-Math.PI/2,-Math.PI,!0),te.absarc(eps,_-ne*2,eps,Math.PI,Math.PI/2,!0),te.absarc(K-ne*2,_-ne*2,eps,Math.PI/2,0,!0),te.absarc(K-ne*2,eps,eps,0,-Math.PI/2,!0),te}const RoundedBox=reactExports.forwardRef(function({args:[_=1,Z=1,te=1]=[],radius:ne=.05,steps:ie=1,smoothness:oe=4,bevelSegments:se=4,creaseAngle:ae=.4,children:le,...ce},fe){const de=reactExports.useMemo(()=>createShape(_,Z,ne),[_,Z,ne]),pe=reactExports.useMemo(()=>({depth:te-ne*2,bevelEnabled:!0,bevelSegments:se*2,steps:ie,bevelSize:ne-eps,bevelThickness:ne,curveSegments:oe}),[te,ne,oe]),he=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{he.current&&(he.current.center(),toCreasedNormals(he.current,ae))},[de,pe]),reactExports.createElement("mesh",_extends$3({ref:fe},ce),reactExports.createElement("extrudeGeometry",{ref:he,args:[de,pe]}),le)});function createScreenQuadGeometry(){const K=new BufferGeometry,_=new Float32Array([-1,-1,3,-1,-1,3]);return K.boundingSphere=new Sphere$2,K.boundingSphere.set(new Vector3,1/0),K.setAttribute("position",new BufferAttribute(_,2)),K}const ScreenQuad=reactExports.forwardRef(function({children:_,...Z},te){const ne=reactExports.useMemo(createScreenQuadGeometry,[]);return reactExports.createElement("mesh",_extends$3({ref:te,geometry:ne,frustumCulled:!1},Z),_)}),Resize=reactExports.forwardRef(({children:K,width:_,height:Z,depth:te,box3:ne,precise:ie=!0,...oe},se)=>{const ae=reactExports.useRef(null),le=reactExports.useRef(null),ce=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{le.current.matrixWorld.identity();let fe=ne||new Box3().setFromObject(ce.current,ie);const de=fe.max.x-fe.min.x,pe=fe.max.y-fe.min.y,he=fe.max.z-fe.min.z;let ge=Math.max(de,pe,he);_&&(ge=de),Z&&(ge=pe),te&&(ge=he),le.current.scale.setScalar(1/ge)},[_,Z,te,ne,ie]),reactExports.useImperativeHandle(se,()=>ae.current,[]),reactExports.createElement("group",_extends$3({ref:ae},oe),reactExports.createElement("group",{ref:le},reactExports.createElement("group",{ref:ce},K)))});var AnimationState=function(K){return K[K.NONE=0]="NONE",K[K.START=1]="START",K[K.ACTIVE=2]="ACTIVE",K}(AnimationState||{});const isOrthographic=K=>K&&K.isOrthographicCamera,isBox3=K=>K&&K.isBox3,interpolateFuncDefault=K=>1-Math.exp(-5*K)+.007*K,context$5=reactExports.createContext(null);function Bounds({children:K,maxDuration:_=1,margin:Z=1.2,observe:te,fit:ne,clip:ie,interpolateFunc:oe=interpolateFuncDefault,onFit:se}){const ae=reactExports.useRef(null),{camera:le,size:ce,invalidate:fe}=useThree(),de=useThree(Te=>Te.controls),pe=reactExports.useRef(se);pe.current=se;const he=reactExports.useRef({camPos:new Vector3,camRot:new Quaternion,camZoom:1}),ge=reactExports.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),me=reactExports.useRef(AnimationState.NONE),Ae=reactExports.useRef(0),[ye]=reactExports.useState(()=>new Box3),ve=reactExports.useMemo(()=>{function Te(){const be=ye.getSize(new Vector3),Re=ye.getCenter(new Vector3),we=Math.max(be.x,be.y,be.z),Pe=isOrthographic(le)?we*4:we/(2*Math.atan(Math.PI*le.fov/360)),Ie=isOrthographic(le)?we*4:Pe/le.aspect,$e=Z*Math.max(Pe,Ie);return{box:ye,size:be,center:Re,distance:$e}}return{getSize:Te,refresh(be){if(isBox3(be))ye.copy(be);else{const Re=be||ae.current;if(!Re)return this;Re.updateWorldMatrix(!0,!0),ye.setFromObject(Re)}if(ye.isEmpty()){const Re=le.position.length()||10;ye.setFromCenterAndSize(new Vector3,new Vector3(Re,Re,Re))}return he.current.camPos.copy(le.position),he.current.camRot.copy(le.quaternion),isOrthographic(le)&&(he.current.camZoom=le.zoom),ge.current.camPos=void 0,ge.current.camRot=void 0,ge.current.camZoom=void 0,ge.current.camUp=void 0,ge.current.target=void 0,this},reset(){const{center:be,distance:Re}=Te(),we=le.position.clone().sub(be).normalize();ge.current.camPos=be.clone().addScaledVector(we,Re),ge.current.target=be.clone();const Pe=new Matrix4().lookAt(ge.current.camPos,ge.current.target,le.up);return ge.current.camRot=new Quaternion().setFromRotationMatrix(Pe),me.current=AnimationState.START,Ae.current=0,this},moveTo(be){return ge.current.camPos=Array.isArray(be)?new Vector3(...be):be.clone(),me.current=AnimationState.START,Ae.current=0,this},lookAt({target:be,up:Re}){ge.current.target=Array.isArray(be)?new Vector3(...be):be.clone(),Re?ge.current.camUp=Array.isArray(Re)?new Vector3(...Re):Re.clone():ge.current.camUp=le.up.clone();const we=new Matrix4().lookAt(ge.current.camPos||le.position,ge.current.target,ge.current.camUp);return ge.current.camRot=new Quaternion().setFromRotationMatrix(we),me.current=AnimationState.START,Ae.current=0,this},to({position:be,target:Re}){return this.moveTo(be).lookAt({target:Re})},fit(){if(!isOrthographic(le))return this.reset();let be=0,Re=0;const we=[new Vector3(ye.min.x,ye.min.y,ye.min.z),new Vector3(ye.min.x,ye.max.y,ye.min.z),new Vector3(ye.min.x,ye.min.y,ye.max.z),new Vector3(ye.min.x,ye.max.y,ye.max.z),new Vector3(ye.max.x,ye.max.y,ye.max.z),new Vector3(ye.max.x,ye.max.y,ye.min.z),new Vector3(ye.max.x,ye.min.y,ye.max.z),new Vector3(ye.max.x,ye.min.y,ye.min.z)],Pe=ge.current.camPos||le.position,Ie=ge.current.target||(de==null?void 0:de.target),$e=ge.current.camUp||le.up,Ue=Ie?new Matrix4().lookAt(Pe,Ie,$e).setPosition(Pe).invert():le.matrixWorldInverse;for(const He of we)He.applyMatrix4(Ue),be=Math.max(be,Math.abs(He.y)),Re=Math.max(Re,Math.abs(He.x));be*=2,Re*=2;const ke=(le.top-le.bottom)/be,Ge=(le.right-le.left)/Re;return ge.current.camZoom=Math.min(ke,Ge)/Z,me.current=AnimationState.START,Ae.current=0,pe.current&&pe.current(this.getSize()),this},clip(){const{distance:be}=Te();return le.near=be/100,le.far=be*100,le.updateProjectionMatrix(),de&&(de.maxDistance=be*10,de.update()),fe(),this}}},[ye,le,de,Z,fe]);reactExports.useLayoutEffect(()=>{if(de){const Te=()=>{if(de&&ge.current.target&&me.current!==AnimationState.NONE){const be=new Vector3().setFromMatrixColumn(le.matrix,2),Re=he.current.camPos.distanceTo(de.target),we=(ge.current.camPos||he.current.camPos).distanceTo(ge.current.target),Pe=(1-Ae.current)*Re+Ae.current*we;de.target.copy(le.position).addScaledVector(be,-Pe),de.update()}me.current=AnimationState.NONE};return de.addEventListener("start",Te),()=>de.removeEventListener("start",Te)}},[de]);const _e=reactExports.useRef(0);return reactExports.useLayoutEffect(()=>{(te||_e.current++===0)&&(ve.refresh(),ne&&ve.reset().fit(),ie&&ve.clip())},[ce,ie,ne,te,le,de]),useFrame((Te,be)=>{if(me.current===AnimationState.START)me.current=AnimationState.ACTIVE,fe();else if(me.current===AnimationState.ACTIVE){if(Ae.current+=be/_,Ae.current>=1)ge.current.camPos&&le.position.copy(ge.current.camPos),ge.current.camRot&&le.quaternion.copy(ge.current.camRot),ge.current.camUp&&le.up.copy(ge.current.camUp),ge.current.camZoom&&isOrthographic(le)&&(le.zoom=ge.current.camZoom),le.updateMatrixWorld(),le.updateProjectionMatrix(),de&&ge.current.target&&(de.target.copy(ge.current.target),de.update()),me.current=AnimationState.NONE;else{const Re=oe(Ae.current);ge.current.camPos&&le.position.lerpVectors(he.current.camPos,ge.current.camPos,Re),ge.current.camRot&&le.quaternion.slerpQuaternions(he.current.camRot,ge.current.camRot,Re),ge.current.camUp&&le.up.set(0,1,0).applyQuaternion(le.quaternion),ge.current.camZoom&&isOrthographic(le)&&(le.zoom=(1-Re)*he.current.camZoom+Re*ge.current.camZoom),le.updateMatrixWorld(),le.updateProjectionMatrix()}fe()}}),reactExports.createElement("group",{ref:ae},reactExports.createElement(context$5.Provider,{value:ve},K))}function useBounds(){return reactExports.useContext(context$5)}const CameraShake=reactExports.forwardRef(({intensity:K=1,decay:_,decayRate:Z=.65,maxYaw:te=.1,maxPitch:ne=.1,maxRoll:ie=.1,yawFrequency:oe=.1,pitchFrequency:se=.1,rollFrequency:ae=.1},le)=>{const ce=useThree(ye=>ye.camera),fe=useThree(ye=>ye.controls),de=reactExports.useRef(K),pe=reactExports.useRef(ce.rotation.clone()),[he]=reactExports.useState(()=>new SimplexNoise),[ge]=reactExports.useState(()=>new SimplexNoise),[me]=reactExports.useState(()=>new SimplexNoise),Ae=()=>{(de.current<0||de.current>1)&&(de.current=de.current<0?0:1)};return reactExports.useImperativeHandle(le,()=>({getIntensity:()=>de.current,setIntensity:ye=>{de.current=ye,Ae()}}),[]),reactExports.useEffect(()=>{if(fe){const ye=()=>void(pe.current=ce.rotation.clone());return fe.addEventListener("change",ye),ye(),()=>void fe.removeEventListener("change",ye)}},[ce,fe]),useFrame((ye,ve)=>{const _e=Math.pow(de.current,2),Te=te*_e*he.noise(ye.clock.elapsedTime*oe,1),be=ne*_e*ge.noise(ye.clock.elapsedTime*se,1),Re=ie*_e*me.noise(ye.clock.elapsedTime*ae,1);ce.rotation.set(pe.current.x+be,pe.current.y+Te,pe.current.z+Re),_&&de.current>0&&(de.current-=Z*ve,Ae())}),null}),Float=reactExports.forwardRef(({children:K,enabled:_=!0,speed:Z=1,rotationIntensity:te=1,floatIntensity:ne=1,floatingRange:ie=[-.1,.1],autoInvalidate:oe=!1,...se},ae)=>{const le=reactExports.useRef(null);reactExports.useImperativeHandle(ae,()=>le.current,[]);const ce=reactExports.useRef(Math.random()*1e4);return useFrame(fe=>{var de,pe;if(!_||Z===0)return;oe&&fe.invalidate();const he=ce.current+fe.clock.elapsedTime;le.current.rotation.x=Math.cos(he/4*Z)/8*te,le.current.rotation.y=Math.sin(he/4*Z)/8*te,le.current.rotation.z=Math.sin(he/4*Z)/20*te;let ge=Math.sin(he/4*Z)/10;ge=MathUtils.mapLinear(ge,-.1,.1,(de=ie==null?void 0:ie[0])!==null&&de!==void 0?de:-.1,(pe=ie==null?void 0:ie[1])!==null&&pe!==void 0?pe:.1),le.current.position.y=ge*ne,le.current.updateMatrix()}),reactExports.createElement("group",se,reactExports.createElement("group",{ref:le,matrixAutoUpdate:!1},K))}),getBufferForType=(K,_,Z)=>{let te;switch(K){case UnsignedByteType:te=new Uint8ClampedArray(_*Z*4);break;case HalfFloatType:te=new Uint16Array(_*Z*4);break;case UnsignedIntType:te=new Uint32Array(_*Z*4);break;case ByteType:te=new Int8Array(_*Z*4);break;case ShortType:te=new Int16Array(_*Z*4);break;case IntType:te=new Int32Array(_*Z*4);break;case FloatType:te=new Float32Array(_*Z*4);break;default:throw new Error("Unsupported data type")}return te};let _canReadPixelsResult;const canReadPixels=(K,_,Z,te)=>{if(_canReadPixelsResult!==void 0)return _canReadPixelsResult;const ne=new WebGLRenderTarget(1,1,te);_.setRenderTarget(ne);const ie=new Mesh(new PlaneGeometry,new MeshBasicMaterial({color:16777215}));_.render(ie,Z),_.setRenderTarget(null);const oe=getBufferForType(K,ne.width,ne.height);return _.readRenderTargetPixels(ne,0,0,ne.width,ne.height,oe),ne.dispose(),ie.geometry.dispose(),ie.material.dispose(),_canReadPixelsResult=oe[0]!==0,_canReadPixelsResult};class QuadRenderer{constructor(_){var Z,te,ne,ie,oe,se,ae,le,ce,fe,de,pe,he,ge,me,Ae;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(ve){throw this._renderer.setRenderTarget(null),ve}this._renderer.setRenderTarget(null)},this._width=_.width,this._height=_.height,this._type=_.type,this._colorSpace=_.colorSpace;const ye={format:RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((Z=_.renderTargetOptions)===null||Z===void 0?void 0:Z.anisotropy)!==void 0?(te=_.renderTargetOptions)===null||te===void 0?void 0:te.anisotropy:1,generateMipmaps:((ne=_.renderTargetOptions)===null||ne===void 0?void 0:ne.generateMipmaps)!==void 0?(ie=_.renderTargetOptions)===null||ie===void 0?void 0:ie.generateMipmaps:!1,magFilter:((oe=_.renderTargetOptions)===null||oe===void 0?void 0:oe.magFilter)!==void 0?(se=_.renderTargetOptions)===null||se===void 0?void 0:se.magFilter:LinearFilter,minFilter:((ae=_.renderTargetOptions)===null||ae===void 0?void 0:ae.minFilter)!==void 0?(le=_.renderTargetOptions)===null||le===void 0?void 0:le.minFilter:LinearFilter,samples:((ce=_.renderTargetOptions)===null||ce===void 0?void 0:ce.samples)!==void 0?(fe=_.renderTargetOptions)===null||fe===void 0?void 0:fe.samples:void 0,wrapS:((de=_.renderTargetOptions)===null||de===void 0?void 0:de.wrapS)!==void 0?(pe=_.renderTargetOptions)===null||pe===void 0?void 0:pe.wrapS:ClampToEdgeWrapping,wrapT:((he=_.renderTargetOptions)===null||he===void 0?void 0:he.wrapT)!==void 0?(ge=_.renderTargetOptions)===null||ge===void 0?void 0:ge.wrapT:ClampToEdgeWrapping};if(this._material=_.material,_.renderer?this._renderer=_.renderer:(this._renderer=QuadRenderer.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Scene$1,this._camera=new OrthographicCamera$1,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!canReadPixels(this._type,this._renderer,this._camera,ye)){let ve;switch(this._type){case HalfFloatType:ve=this._renderer.extensions.has("EXT_color_buffer_float")?FloatType:void 0;break}ve!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${FloatType}`),this._type=ve):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Mesh(new PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new WebGLRenderTarget(this.width,this.height,ye),this._renderTarget.texture.mapping=((me=_.renderTargetOptions)===null||me===void 0?void 0:me.mapping)!==void 0?(Ae=_.renderTargetOptions)===null||Ae===void 0?void 0:Ae.mapping:UVMapping}static instantiateRenderer(){const _=new WebGLRenderer;return _.setSize(128,128),_}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const _=getBufferForType(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,_),_}toDataTexture(_){const Z=new DataTexture(this.toArray(),this.width,this.height,RGBAFormat,this._type,(_==null?void 0:_.mapping)||UVMapping,(_==null?void 0:_.wrapS)||ClampToEdgeWrapping,(_==null?void 0:_.wrapT)||ClampToEdgeWrapping,(_==null?void 0:_.magFilter)||LinearFilter,(_==null?void 0:_.minFilter)||LinearFilter,(_==null?void 0:_.anisotropy)||1,LinearSRGBColorSpace$2);return Z.generateMipmaps=(_==null?void 0:_.generateMipmaps)!==void 0?_==null?void 0:_.generateMipmaps:!1,Z}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(_){this.disposeOnDemandRenderer(),_&&this.renderTarget.dispose(),this.material instanceof ShaderMaterial&&Object.values(this.material.uniforms).forEach(Z=>{Z.value instanceof Texture$1&&Z.value.dispose()}),Object.values(this.material).forEach(Z=>{Z instanceof Texture$1&&Z.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(_){this._width=_,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(_){this._height=_,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(_){this._renderTarget=_,this._width=_.width,this._height=_.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const vertexShader=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,fragmentShader=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class GainMapDecoderMaterial extends ShaderMaterial{constructor({gamma:_,offsetHdr:Z,offsetSdr:te,gainMapMin:ne,gainMapMax:ie,maxDisplayBoost:oe,hdrCapacityMin:se,hdrCapacityMax:ae,sdr:le,gainMap:ce}){super({name:"GainMapDecoderMaterial",vertexShader,fragmentShader,uniforms:{sdr:{value:le},gainMap:{value:ce},gamma:{value:new Vector3(1/_[0],1/_[1],1/_[2])},offsetHdr:{value:new Vector3().fromArray(Z)},offsetSdr:{value:new Vector3().fromArray(te)},gainMapMin:{value:new Vector3().fromArray(ne)},gainMapMax:{value:new Vector3().fromArray(ie)},weightFactor:{value:(Math.log2(oe)-se)/(ae-se)}},blending:NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=oe,this._hdrCapacityMin=se,this._hdrCapacityMax=ae,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(_){this.uniforms.sdr.value=_}get gainMap(){return this.uniforms.gainMap.value}set gainMap(_){this.uniforms.gainMap.value=_}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(_){this.uniforms.offsetHdr.value.fromArray(_)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(_){this.uniforms.offsetSdr.value.fromArray(_)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(_){this.uniforms.gainMapMin.value.fromArray(_)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(_){this.uniforms.gainMapMax.value.fromArray(_)}get gamma(){const _=this.uniforms.gamma.value;return[1/_.x,1/_.y,1/_.z]}set gamma(_){const Z=this.uniforms.gamma.value;Z.x=1/_[0],Z.y=1/_[1],Z.z=1/_[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(_){this._hdrCapacityMin=_,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(_){this._hdrCapacityMax=_,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(_){this._maxDisplayBoost=Math.max(1,Math.min(65504,_)),this.calculateWeight()}calculateWeight(){const _=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,_))}}class GainMapNotFoundError extends Error{}class XMPMetadataNotFoundError extends Error{}const getXMLValue=(K,_,Z)=>{const te=new RegExp(`${_}="([^"]*)"`,"i").exec(K);if(te)return te[1];const ne=new RegExp(`<${_}[^>]*>([\\s\\S]*?)</${_}>`,"i").exec(K);if(ne){const ie=ne[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return ie&&ie.length===3?ie.map(oe=>oe.replace(/<\/?rdf:li>/g,"")):ne[1].trim()}if(Z!==void 0)return Z;throw new Error(`Can't find ${_} in gainmap metadata`)},extractXMP=K=>{let _;typeof TextDecoder<"u"?_=new TextDecoder().decode(K):_=K.toString();let Z=_.indexOf("<x:xmpmeta");for(;Z!==-1;){const te=_.indexOf("x:xmpmeta>",Z),ne=_.slice(Z,te+10);try{const ie=getXMLValue(ne,"hdrgm:GainMapMin","0"),oe=getXMLValue(ne,"hdrgm:GainMapMax"),se=getXMLValue(ne,"hdrgm:Gamma","1"),ae=getXMLValue(ne,"hdrgm:OffsetSDR","0.015625"),le=getXMLValue(ne,"hdrgm:OffsetHDR","0.015625"),ce=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(ne),fe=ce?ce[1]:"0",de=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(ne);if(!de)throw new Error("Incomplete gainmap metadata");const pe=de[1];return{gainMapMin:Array.isArray(ie)?ie.map(he=>parseFloat(he)):[parseFloat(ie),parseFloat(ie),parseFloat(ie)],gainMapMax:Array.isArray(oe)?oe.map(he=>parseFloat(he)):[parseFloat(oe),parseFloat(oe),parseFloat(oe)],gamma:Array.isArray(se)?se.map(he=>parseFloat(he)):[parseFloat(se),parseFloat(se),parseFloat(se)],offsetSdr:Array.isArray(ae)?ae.map(he=>parseFloat(he)):[parseFloat(ae),parseFloat(ae),parseFloat(ae)],offsetHdr:Array.isArray(le)?le.map(he=>parseFloat(he)):[parseFloat(le),parseFloat(le),parseFloat(le)],hdrCapacityMin:parseFloat(fe),hdrCapacityMax:parseFloat(pe)}}catch{}Z=_.indexOf("<x:xmpmeta",te)}};class MPFExtractor{constructor(_){this.options={debug:_&&_.debug!==void 0?_.debug:!1,extractFII:_&&_.extractFII!==void 0?_.extractFII:!0,extractNonFII:_&&_.extractNonFII!==void 0?_.extractNonFII:!0}}extract(_){return new Promise((Z,te)=>{const ne=this.options.debug,ie=new DataView(_.buffer);if(ie.getUint16(0)!==65496){te(new Error("Not a valid jpeg"));return}const oe=ie.byteLength;let se=2,ae=0,le;for(;se<oe;){if(++ae>250){te(new Error(`Found no marker after ${ae} loops 😵`));return}if(ie.getUint8(se)!==255){te(new Error(`Not a valid marker at offset 0x${se.toString(16)}, found: 0x${ie.getUint8(se).toString(16)}`));return}if(le=ie.getUint8(se+1),ne&&console.log(`Marker: ${le.toString(16)}`),le===226){ne&&console.log("Found APP2 marker (0xffe2)");const ce=se+4;if(ie.getUint32(ce)===1297106432){const fe=ce+4;let de;if(ie.getUint16(fe)===18761)de=!1;else if(ie.getUint16(fe)===19789)de=!0;else{te(new Error("No valid endianness marker found in TIFF header"));return}if(ie.getUint16(fe+2,!de)!==42){te(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const pe=ie.getUint32(fe+4,!de);if(pe<8){te(new Error("Not valid TIFF data! (First offset less than 8)"));return}const he=fe+pe,ge=ie.getUint16(he,!de),me=he+2;let Ae=0;for(let Te=me;Te<me+12*ge;Te+=12)ie.getUint16(Te,!de)===45057&&(Ae=ie.getUint32(Te+8,!de));const ve=he+2+ge*12+4,_e=[];for(let Te=ve;Te<ve+Ae*16;Te+=16){const be={MPType:ie.getUint32(Te,!de),size:ie.getUint32(Te+4,!de),dataOffset:ie.getUint32(Te+8,!de),dependantImages:ie.getUint32(Te+12,!de),start:-1,end:-1,isFII:!1};be.dataOffset?(be.start=fe+be.dataOffset,be.isFII=!1):(be.start=0,be.isFII=!0),be.end=be.start+be.size,_e.push(be)}if(this.options.extractNonFII&&_e.length){const Te=new Blob([ie]),be=[];for(const Re of _e){if(Re.isFII&&!this.options.extractFII)continue;const we=Te.slice(Re.start,Re.end+1,"image/jpeg");be.push(we)}Z(be)}}}se+=2+ie.getUint16(se+2)}})}}const extractGainmapFromJPEG=async K=>{const _=extractXMP(K);if(!_)throw new XMPMetadataNotFoundError("Gain map XMP metadata not found");const te=await new MPFExtractor({extractFII:!0,extractNonFII:!0}).extract(K);if(te.length!==2)throw new GainMapNotFoundError("Gain map recovery image not found");return{sdr:new Uint8Array(await te[0].arrayBuffer()),gainMap:new Uint8Array(await te[1].arrayBuffer()),metadata:_}},getHTMLImageFromBlob=K=>new Promise((_,Z)=>{const te=document.createElement("img");te.onload=()=>{_(te)},te.onerror=ne=>{Z(ne)},te.src=URL.createObjectURL(K)});class LoaderBase extends Loader{constructor(_,Z){super(Z),_&&(this._renderer=_),this._internalLoadingManager=new LoadingManager}setRenderer(_){return this._renderer=_,this}setRenderTargetOptions(_){return this._renderTargetOptions=_,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const _=new GainMapDecoderMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Texture$1,sdr:new Texture$1});return new QuadRenderer({width:16,height:16,type:HalfFloatType,colorSpace:LinearSRGBColorSpace$2,material:_,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(_,Z,te,ne){const ie=ne?new Blob([ne],{type:"image/jpeg"}):void 0,oe=new Blob([te],{type:"image/jpeg"});let se,ae,le=!1;if(typeof createImageBitmap>"u"){const de=await Promise.all([ie?getHTMLImageFromBlob(ie):Promise.resolve(void 0),getHTMLImageFromBlob(oe)]);ae=de[0],se=de[1],le=!0}else{const de=await Promise.all([ie?createImageBitmap(ie,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(oe,{imageOrientation:"flipY"})]);ae=de[0],se=de[1]}const ce=new Texture$1(ae||new ImageData(2,2),UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,LinearSRGBColorSpace$2);ce.flipY=le,ce.needsUpdate=!0;const fe=new Texture$1(se,UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,SRGBColorSpace$2);fe.flipY=le,fe.needsUpdate=!0,_.width=se.width,_.height=se.height,_.material.gainMap=ce,_.material.sdr=fe,_.material.gainMapMin=Z.gainMapMin,_.material.gainMapMax=Z.gainMapMax,_.material.offsetHdr=Z.offsetHdr,_.material.offsetSdr=Z.offsetSdr,_.material.gamma=Z.gamma,_.material.hdrCapacityMin=Z.hdrCapacityMin,_.material.hdrCapacityMax=Z.hdrCapacityMax,_.material.maxDisplayBoost=Math.pow(2,Z.hdrCapacityMax),_.material.needsUpdate=!0,_.render()}}class GainMapLoader extends LoaderBase{load([_,Z,te],ne,ie,oe){const se=this.prepareQuadRenderer();let ae,le,ce;const fe=async()=>{if(ae&&le&&ce){try{await this.render(se,ce,ae,le)}catch(Pe){this.manager.itemError(_),this.manager.itemError(Z),this.manager.itemError(te),typeof oe=="function"&&oe(Pe),se.disposeOnDemandRenderer();return}typeof ne=="function"&&ne(se),this.manager.itemEnd(_),this.manager.itemEnd(Z),this.manager.itemEnd(te),se.disposeOnDemandRenderer()}};let de=!0,pe=0,he=0,ge=!0,me=0,Ae=0,ye=!0,ve=0,_e=0;const Te=()=>{if(typeof ie=="function"){const Pe=pe+me+ve,Ie=he+Ae+_e,$e=de&&ge&&ye;ie(new ProgressEvent("progress",{lengthComputable:$e,loaded:Ie,total:Pe}))}};this.manager.itemStart(_),this.manager.itemStart(Z),this.manager.itemStart(te);const be=new FileLoader(this._internalLoadingManager);be.setResponseType("arraybuffer"),be.setRequestHeader(this.requestHeader),be.setPath(this.path),be.setWithCredentials(this.withCredentials),be.load(_,async Pe=>{if(typeof Pe=="string")throw new Error("Invalid sdr buffer");ae=Pe,await fe()},Pe=>{de=Pe.lengthComputable,he=Pe.loaded,pe=Pe.total,Te()},Pe=>{this.manager.itemError(_),typeof oe=="function"&&oe(Pe)});const Re=new FileLoader(this._internalLoadingManager);Re.setResponseType("arraybuffer"),Re.setRequestHeader(this.requestHeader),Re.setPath(this.path),Re.setWithCredentials(this.withCredentials),Re.load(Z,async Pe=>{if(typeof Pe=="string")throw new Error("Invalid gainmap buffer");le=Pe,await fe()},Pe=>{ge=Pe.lengthComputable,Ae=Pe.loaded,me=Pe.total,Te()},Pe=>{this.manager.itemError(Z),typeof oe=="function"&&oe(Pe)});const we=new FileLoader(this._internalLoadingManager);return we.setRequestHeader(this.requestHeader),we.setPath(this.path),we.setWithCredentials(this.withCredentials),we.load(te,async Pe=>{if(typeof Pe!="string")throw new Error("Invalid metadata string");ce=JSON.parse(Pe),await fe()},Pe=>{ye=Pe.lengthComputable,_e=Pe.loaded,ve=Pe.total,Te()},Pe=>{this.manager.itemError(te),typeof oe=="function"&&oe(Pe)}),se}}class HDRJPGLoader extends LoaderBase{load(_,Z,te,ne){const ie=this.prepareQuadRenderer(),oe=new FileLoader(this._internalLoadingManager);return oe.setResponseType("arraybuffer"),oe.setRequestHeader(this.requestHeader),oe.setPath(this.path),oe.setWithCredentials(this.withCredentials),this.manager.itemStart(_),oe.load(_,async se=>{if(typeof se=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const ae=new Uint8Array(se);let le,ce,fe;try{const de=await extractGainmapFromJPEG(ae);le=de.sdr,ce=de.gainMap,fe=de.metadata}catch(de){if(de instanceof XMPMetadataNotFoundError||de instanceof GainMapNotFoundError)console.warn(`Failure to reconstruct an HDR image from ${_}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),fe={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},le=ae;else throw de}try{await this.render(ie,fe,le,ce)}catch(de){this.manager.itemError(_),typeof ne=="function"&&ne(de),ie.disposeOnDemandRenderer();return}typeof Z=="function"&&Z(ie),this.manager.itemEnd(_),ie.disposeOnDemandRenderer()},te,se=>{this.manager.itemError(_),typeof ne=="function"&&ne(se)}),ie}}const presetsObj={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},CUBEMAP_ROOT="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",isArray$1=K=>Array.isArray(K),defaultFiles=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function useEnvironment({files:K=defaultFiles,path:_="",preset:Z=void 0,colorSpace:te=void 0,extensions:ne}={}){Z&&(validatePreset(Z),K=presetsObj[Z],_=CUBEMAP_ROOT);const ie=isArray$1(K),{extension:oe,isCubemap:se}=getExtension(K),ae=getLoader(oe);if(!ae)throw new Error("useEnvironment: Unrecognized file extension: "+K);const le=useThree(pe=>pe.gl);reactExports.useLayoutEffect(()=>{if(oe!=="webp"&&oe!=="jpg"&&oe!=="jpeg")return;function pe(){useLoader.clear(ae,ie?[K]:K)}le.domElement.addEventListener("webglcontextlost",pe,{once:!0})},[K,le.domElement]);const ce=useLoader(ae,ie?[K]:K,pe=>{(oe==="webp"||oe==="jpg"||oe==="jpeg")&&pe.setRenderer(le),pe.setPath==null||pe.setPath(_),ne&&ne(pe)});let fe=ie?ce[0]:ce;if(oe==="jpg"||oe==="jpeg"||oe==="webp"){var de;fe=(de=fe.renderTarget)==null?void 0:de.texture}return fe.mapping=se?CubeReflectionMapping:EquirectangularReflectionMapping,fe.colorSpace=te??(se?"srgb":"srgb-linear"),fe}const preloadDefaultOptions={files:defaultFiles,path:"",preset:void 0,extensions:void 0};useEnvironment.preload=K=>{const _={...preloadDefaultOptions,...K};let{files:Z,path:te=""}=_;const{preset:ne,extensions:ie}=_;ne&&(validatePreset(ne),Z=presetsObj[ne],te=CUBEMAP_ROOT);const{extension:oe}=getExtension(Z);if(oe==="webp"||oe==="jpg"||oe==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const se=getLoader(oe);if(!se)throw new Error("useEnvironment: Unrecognized file extension: "+Z);useLoader.preload(se,isArray$1(Z)?[Z]:Z,ae=>{ae.setPath==null||ae.setPath(te),ie&&ie(ae)})};const clearDefaultOptins={files:defaultFiles,preset:void 0};useEnvironment.clear=K=>{const _={...clearDefaultOptins,...K};let{files:Z}=_;const{preset:te}=_;te&&(validatePreset(te),Z=presetsObj[te]);const{extension:ne}=getExtension(Z),ie=getLoader(ne);if(!ie)throw new Error("useEnvironment: Unrecognized file extension: "+Z);useLoader.clear(ie,isArray$1(Z)?[Z]:Z)};function validatePreset(K){if(!(K in presetsObj))throw new Error("Preset must be one of: "+Object.keys(presetsObj).join(", "))}function getExtension(K){var _;const Z=isArray$1(K)&&K.length===6,te=isArray$1(K)&&K.length===3&&K.some(oe=>oe.endsWith("json")),ne=isArray$1(K)?K[0]:K;return{extension:Z?"cube":te?"webp":ne.startsWith("data:application/exr")?"exr":ne.startsWith("data:application/hdr")?"hdr":ne.startsWith("data:image/jpeg")?"jpg":(_=ne.split(".").pop())==null||(_=_.split("?"))==null||(_=_.shift())==null?void 0:_.toLowerCase(),isCubemap:Z,isGainmap:te}}function getLoader(K){return K==="cube"?CubeTextureLoader:K==="hdr"?RGBELoader:K==="exr"?EXRLoader:K==="jpg"||K==="jpeg"?HDRJPGLoader:K==="webp"?GainMapLoader:null}const isRef=K=>K.current&&K.current.isScene,resolveScene=K=>isRef(K)?K.current:K;function setEnvProps(K,_,Z,te,ne={}){var ie,oe,se,ae;ne={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...ne};const le=resolveScene(_||Z),ce=le.background,fe=le.environment,de={backgroundBlurriness:le.backgroundBlurriness,backgroundIntensity:le.backgroundIntensity,backgroundRotation:(ie=(oe=le.backgroundRotation)==null||oe.clone==null?void 0:oe.clone())!==null&&ie!==void 0?ie:[0,0,0],environmentIntensity:le.environmentIntensity,environmentRotation:(se=(ae=le.environmentRotation)==null||ae.clone==null?void 0:ae.clone())!==null&&se!==void 0?se:[0,0,0]};return K!=="only"&&(le.environment=te),K&&(le.background=te),applyProps(le,ne),()=>{K!=="only"&&(le.environment=fe),K&&(le.background=ce),applyProps(le,de)}}function EnvironmentMap({scene:K,background:_=!1,map:Z,...te}){const ne=useThree(ie=>ie.scene);return reactExports.useLayoutEffect(()=>{if(Z)return setEnvProps(_,K,ne,Z,te)}),null}function EnvironmentCube({background:K=!1,scene:_,blur:Z,backgroundBlurriness:te,backgroundIntensity:ne,backgroundRotation:ie,environmentIntensity:oe,environmentRotation:se,...ae}){const le=useEnvironment(ae),ce=useThree(fe=>fe.scene);return reactExports.useLayoutEffect(()=>setEnvProps(K,_,ce,le,{backgroundBlurriness:Z??te,backgroundIntensity:ne,backgroundRotation:ie,environmentIntensity:oe,environmentRotation:se})),reactExports.useEffect(()=>()=>{le.dispose()},[le]),null}function EnvironmentPortal({children:K,near:_=.1,far:Z=1e3,resolution:te=256,frames:ne=1,map:ie,background:oe=!1,blur:se,backgroundBlurriness:ae,backgroundIntensity:le,backgroundRotation:ce,environmentIntensity:fe,environmentRotation:de,scene:pe,files:he,path:ge,preset:me=void 0,extensions:Ae}){const ye=useThree(we=>we.gl),ve=useThree(we=>we.scene),_e=reactExports.useRef(null),[Te]=reactExports.useState(()=>new Scene$1),be=reactExports.useMemo(()=>{const we=new WebGLCubeRenderTarget(te);return we.texture.type=HalfFloatType,we},[te]);reactExports.useEffect(()=>()=>{be.dispose()},[be]),reactExports.useLayoutEffect(()=>{if(ne===1){const we=ye.autoClear;ye.autoClear=!0,_e.current.update(ye,Te),ye.autoClear=we}return setEnvProps(oe,pe,ve,be.texture,{backgroundBlurriness:se??ae,backgroundIntensity:le,backgroundRotation:ce,environmentIntensity:fe,environmentRotation:de})},[K,Te,be.texture,pe,ve,oe,ne,ye]);let Re=1;return useFrame(()=>{if(ne===1/0||Re<ne){const we=ye.autoClear;ye.autoClear=!0,_e.current.update(ye,Te),ye.autoClear=we,Re++}}),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,K,reactExports.createElement("cubeCamera",{ref:_e,args:[_,Z,be]}),he||me?reactExports.createElement(EnvironmentCube,{background:!0,files:he,preset:me,path:ge,extensions:Ae}):ie?reactExports.createElement(EnvironmentMap,{background:!0,map:ie,extensions:Ae}):null),Te))}function EnvironmentGround(K){var _,Z,te,ne;const ie=useEnvironment(K),oe=K.map||ie;reactExports.useMemo(()=>extend$6({GroundProjectedEnvImpl:GroundProjectedEnv}),[]),reactExports.useEffect(()=>()=>{ie.dispose()},[ie]);const se=reactExports.useMemo(()=>[oe],[oe]),ae=(_=K.ground)==null?void 0:_.height,le=(Z=K.ground)==null?void 0:Z.radius,ce=(te=(ne=K.ground)==null?void 0:ne.scale)!==null&&te!==void 0?te:1e3;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(EnvironmentMap,_extends$3({},K,{map:oe})),reactExports.createElement("groundProjectedEnvImpl",{args:se,scale:ce,height:ae,radius:le}))}function Environment(K){return K.ground?reactExports.createElement(EnvironmentGround,K):K.map?reactExports.createElement(EnvironmentMap,K):K.children?reactExports.createElement(EnvironmentPortal,K):reactExports.createElement(EnvironmentCube,K)}const ContactShadows=reactExports.forwardRef(({scale:K=10,frames:_=1/0,opacity:Z=1,width:te=1,height:ne=1,blur:ie=1,near:oe=0,far:se=10,resolution:ae=512,smooth:le=!0,color:ce="#000000",depthWrite:fe=!1,renderOrder:de,...pe},he)=>{const ge=reactExports.useRef(null),me=useThree(Ge=>Ge.scene),Ae=useThree(Ge=>Ge.gl),ye=reactExports.useRef(null);te=te*(Array.isArray(K)?K[0]:K||1),ne=ne*(Array.isArray(K)?K[1]:K||1);const[ve,_e,Te,be,Re,we,Pe]=reactExports.useMemo(()=>{const Ge=new WebGLRenderTarget(ae,ae),He=new WebGLRenderTarget(ae,ae);He.texture.generateMipmaps=Ge.texture.generateMipmaps=!1;const ze=new PlaneGeometry(te,ne).rotateX(Math.PI/2),Ke=new Mesh(ze),tt=new MeshDepthMaterial;tt.depthTest=tt.depthWrite=!1,tt.onBeforeCompile=Fe=>{Fe.uniforms={...Fe.uniforms,ucolor:{value:new Color$1(ce)}},Fe.fragmentShader=Fe.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),Fe.fragmentShader=Fe.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Je=new ShaderMaterial(HorizontalBlurShader),ot=new ShaderMaterial(VerticalBlurShader);return ot.depthTest=Je.depthTest=!1,[Ge,ze,tt,Ke,Je,ot,He]},[ae,te,ne,K,ce]),Ie=Ge=>{be.visible=!0,be.material=Re,Re.uniforms.tDiffuse.value=ve.texture,Re.uniforms.h.value=Ge*1/256,Ae.setRenderTarget(Pe),Ae.render(be,ye.current),be.material=we,we.uniforms.tDiffuse.value=Pe.texture,we.uniforms.v.value=Ge*1/256,Ae.setRenderTarget(ve),Ae.render(be,ye.current),be.visible=!1};let $e=0,Ue,ke;return useFrame(()=>{ye.current&&(_===1/0||$e<_)&&($e++,Ue=me.background,ke=me.overrideMaterial,ge.current.visible=!1,me.background=null,me.overrideMaterial=Te,Ae.setRenderTarget(ve),Ae.render(me,ye.current),Ie(ie),le&&Ie(ie*.4),Ae.setRenderTarget(null),ge.current.visible=!0,me.overrideMaterial=ke,me.background=Ue)}),reactExports.useImperativeHandle(he,()=>ge.current,[]),reactExports.createElement("group",_extends$3({"rotation-x":Math.PI/2},pe,{ref:ge}),reactExports.createElement("mesh",{renderOrder:de,geometry:_e,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},reactExports.createElement("meshBasicMaterial",{transparent:!0,map:ve.texture,opacity:Z,depthWrite:fe})),reactExports.createElement("orthographicCamera",{ref:ye,args:[-te/2,te/2,ne/2,-ne/2,oe,se]}))});function isLight(K){return K.isLight}function isGeometry(K){return!!K.geometry}const accumulativeContext=reactExports.createContext(null),SoftShadowMaterial=shaderMaterial({color:new Color$1,blend:2,alphaTest:.75,opacity:0,map:null},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vUv = uv;
   }`,`varying vec2 vUv;
   uniform sampler2D map;
   uniform vec3 color;
   uniform float opacity;
   uniform float alphaTest;
   uniform float blend;
   void main() {
     vec4 sampledDiffuseColor = texture2D(map, vUv);
     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);
     #include <tonemapping_fragment>
     #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),AccumulativeShadows=reactExports.forwardRef(({children:K,temporal:_,frames:Z=40,limit:te=1/0,blend:ne=20,scale:ie=10,opacity:oe=1,alphaTest:se=.75,color:ae="black",colorBlend:le=2,resolution:ce=1024,toneMapped:fe=!0,...de},pe)=>{extend$6({SoftShadowMaterial});const he=useThree(be=>be.gl),ge=useThree(be=>be.scene),me=useThree(be=>be.camera),Ae=useThree(be=>be.invalidate),ye=reactExports.useRef(null),ve=reactExports.useRef(null),[_e]=reactExports.useState(()=>new ProgressiveLightMap(he,ge,ce));reactExports.useLayoutEffect(()=>{_e.configure(ye.current)},[]);const Te=reactExports.useMemo(()=>({lights:new Map,temporal:!!_,frames:Math.max(2,Z),blend:Math.max(2,Z===1/0?ne:Z),count:0,getMesh:()=>ye.current,reset:()=>{_e.clear();const be=ye.current.material;be.opacity=0,be.alphaTest=0,Te.count=0},update:(be=1)=>{const Re=ye.current.material;Te.temporal?(Re.opacity=Math.min(oe,Re.opacity+oe/Te.blend),Re.alphaTest=Math.min(se,Re.alphaTest+se/Te.blend)):(Re.opacity=oe,Re.alphaTest=se),ve.current.visible=!0,_e.prepare();for(let we=0;we<be;we++)Te.lights.forEach(Pe=>Pe.update()),_e.update(me,Te.blend);ve.current.visible=!1,_e.finish()}}),[_e,me,ge,_,Z,ne,oe,se]);return reactExports.useLayoutEffect(()=>{Te.reset(),!Te.temporal&&Te.frames!==1/0&&Te.update(Te.blend)}),reactExports.useImperativeHandle(pe,()=>Te,[Te]),useFrame(()=>{(Te.temporal||Te.frames===1/0)&&Te.count<Te.frames&&Te.count<te&&(Ae(),Te.update(),Te.count++)}),reactExports.createElement("group",de,reactExports.createElement("group",{traverse:()=>null,ref:ve},reactExports.createElement(accumulativeContext.Provider,{value:Te},K)),reactExports.createElement("mesh",{receiveShadow:!0,ref:ye,scale:ie,rotation:[-Math.PI/2,0,0]},reactExports.createElement("planeGeometry",null),reactExports.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:fe,color:ae,blend:le,map:_e.progressiveLightMap2.texture})))}),RandomizedLight=reactExports.forwardRef(({castShadow:K=!0,bias:_=.001,mapSize:Z=512,size:te=5,near:ne=.5,far:ie=500,frames:oe=1,position:se=[0,0,0],radius:ae=1,amount:le=8,intensity:ce=version$3>=155?Math.PI:1,ambient:fe=.5,...de},pe)=>{const he=reactExports.useRef(null),ge=new Vector3(...se).length(),me=reactExports.useContext(accumulativeContext),Ae=reactExports.useCallback(()=>{let ve;if(he.current)for(let _e=0;_e<he.current.children.length;_e++)if(ve=he.current.children[_e],Math.random()>fe)ve.position.set(se[0]+MathUtils.randFloatSpread(ae),se[1]+MathUtils.randFloatSpread(ae),se[2]+MathUtils.randFloatSpread(ae));else{let Te=Math.acos(2*Math.random()-1)-Math.PI/2,be=2*Math.PI*Math.random();ve.position.set(Math.cos(Te)*Math.cos(be)*ge,Math.abs(Math.cos(Te)*Math.sin(be)*ge),Math.sin(Te)*ge)}},[ae,fe,ge,...se]),ye=reactExports.useMemo(()=>({update:Ae}),[Ae]);return reactExports.useImperativeHandle(pe,()=>ye,[ye]),reactExports.useLayoutEffect(()=>{var ve;const _e=he.current;return me&&((ve=me.lights)==null||ve.set(_e.uuid,ye)),()=>{var Te;return void(me==null||(Te=me.lights)==null?void 0:Te.delete(_e.uuid))}},[me,ye]),reactExports.createElement("group",_extends$3({ref:he},de),Array.from({length:le},(ve,_e)=>reactExports.createElement("directionalLight",{key:_e,castShadow:K,"shadow-bias":_,"shadow-mapSize":[Z,Z],intensity:ce/le},reactExports.createElement("orthographicCamera",{attach:"shadow-camera",args:[-te,te,te,-te,ne,ie]}))))});class ProgressiveLightMap{constructor(_,Z,te=1024){this.renderer=_,this.res=te,this.scene=Z,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new Color$1,this.clearAlpha=0;const ne={type:HalfFloatType,magFilter:NearestFilter,minFilter:NearestFilter};this.progressiveLightMap1=new WebGLRenderTarget(this.res,this.res,ne),this.progressiveLightMap2=new WebGLRenderTarget(this.res,this.res,ne),this.discardMat=new DiscardMaterial,this.targetMat=new MeshLambertMaterial({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=ie=>{ie.vertexShader=`varying vec2 vUv;
`+ie.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const oe=ie.fragmentShader.indexOf("void main() {");ie.fragmentShader=`varying vec2 vUv;
`+ie.fragmentShader.slice(0,oe)+`uniform sampler2D previousShadowMap;
	uniform float averagingWindow;
`+ie.fragmentShader.slice(oe-1,-1)+`
vec3 texelOld = texture2D(previousShadowMap, vUv).rgb;
        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);
      }`,ie.uniforms.previousShadowMap=this.previousShadowMap,ie.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(_=>{isGeometry(_)?this.meshes.push({object:_,material:_.material}):isLight(_)&&this.lights.push({object:_,intensity:_.intensity})})}prepare(){this.lights.forEach(_=>_.object.intensity=0),this.meshes.forEach(_=>_.object.material=this.discardMat)}finish(){this.lights.forEach(_=>_.object.intensity=_.intensity),this.meshes.forEach(_=>_.object.material=_.material)}configure(_){this.object=_}update(_,Z=100){if(!this.object)return;this.averagingWindow.value=Z,this.object.material=this.targetMat;const te=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,ne=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,ie=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(te),this.previousShadowMap.value=ne.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,_),this.renderer.setRenderTarget(null),this.scene.background=ie}}const presets={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function Refit({radius:K,adjustCamera:_}){const Z=useBounds();return reactExports.useEffect(()=>{_&&Z.refresh().clip().fit()},[K,_]),null}function Stage({children:K,center:_,adjustCamera:Z=!0,intensity:te=.5,shadows:ne="contact",environment:ie="city",preset:oe="rembrandt",...se}){var ae,le,ce,fe,de,pe,he,ge;const me=typeof oe=="string"?presets[oe]:oe,[{radius:Ae,height:ye},ve]=reactExports.useState({radius:0,width:0,height:0,depth:0}),_e=(ae=ne==null?void 0:ne.bias)!==null&&ae!==void 0?ae:-1e-4,Te=(le=ne==null?void 0:ne.normalBias)!==null&&le!==void 0?le:0,be=(ce=ne==null?void 0:ne.size)!==null&&ce!==void 0?ce:1024,Re=(fe=ne==null?void 0:ne.offset)!==null&&fe!==void 0?fe:0,we=ne==="contact"||(ne==null?void 0:ne.type)==="contact",Pe=ne==="accumulative"||(ne==null?void 0:ne.type)==="accumulative",Ie={...typeof ne=="object"?ne:{}},$e=ie?typeof ie=="string"?{preset:ie}:ie:null,Ue=reactExports.useCallback(ke=>{const{width:Ge,height:He,depth:ze,boundingSphere:Ke}=ke;ve({radius:Ke.radius,width:Ge,height:He,depth:ze}),_!=null&&_.onCentered&&_.onCentered(ke)},[]);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("ambientLight",{intensity:te/3}),reactExports.createElement("spotLight",{penumbra:1,position:[me.main[0]*Ae,me.main[1]*Ae,me.main[2]*Ae],intensity:te*2,castShadow:!!ne,"shadow-bias":_e,"shadow-normalBias":Te,"shadow-mapSize":be}),reactExports.createElement("pointLight",{position:[me.fill[0]*Ae,me.fill[1]*Ae,me.fill[2]*Ae],intensity:te}),reactExports.createElement(Bounds,_extends$3({fit:!!Z,clip:!!Z,margin:Number(Z),observe:!0},se),reactExports.createElement(Refit,{radius:Ae,adjustCamera:Z}),reactExports.createElement(Center,_extends$3({},_,{position:[0,Re/2,0],onCentered:Ue}),K)),reactExports.createElement("group",{position:[0,-ye/2-Re/2,0]},we&&reactExports.createElement(ContactShadows,_extends$3({scale:Ae*4,far:Ae,blur:2},Ie)),Pe&&reactExports.createElement(AccumulativeShadows,_extends$3({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:Ae*4},Ie),reactExports.createElement(RandomizedLight,{amount:(de=Ie.amount)!==null&&de!==void 0?de:8,radius:(pe=Ie.radius)!==null&&pe!==void 0?pe:Ae,ambient:(he=Ie.ambient)!==null&&he!==void 0?he:.5,intensity:(ge=Ie.intensity)!==null&&ge!==void 0?ge:1,position:[me.main[0]*Ae,me.main[1]*Ae,me.main[2]*Ae],size:Ae*4,bias:-_e,mapSize:be}))),ie&&reactExports.createElement(Environment,$e))}const easeInExpo=K=>K===0?0:Math.pow(2,10*K-10);function Backdrop({children:K,floor:_=.25,segments:Z=20,receiveShadow:te,...ne}){const ie=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{let oe=0;const se=Z/Z/2,ae=ie.current.attributes.position;for(let le=0;le<Z+1;le++)for(let ce=0;ce<Z+1;ce++)ae.setXYZ(oe++,le/Z-se+(le===0?-_:0),ce/Z-se,easeInExpo(le/Z));ae.needsUpdate=!0,ie.current.computeVertexNormals()},[Z,_]),reactExports.createElement("group",ne,reactExports.createElement("mesh",{receiveShadow:te,rotation:[-Math.PI/2,0,Math.PI/2]},reactExports.createElement("planeGeometry",{ref:ie,args:[1,1,Z,Z]}),K))}const Shadow=reactExports.forwardRef(({fog:K=!1,renderOrder:_,depthWrite:Z=!1,colorStop:te=0,color:ne="black",opacity:ie=.5,...oe},se)=>{const ae=reactExports.useMemo(()=>{const le=document.createElement("canvas");le.width=128,le.height=128;const ce=le.getContext("2d"),fe=ce.createRadialGradient(le.width/2,le.height/2,0,le.width/2,le.height/2,le.width/2);return fe.addColorStop(te,new Color$1(ne).getStyle()),fe.addColorStop(1,"rgba(0,0,0,0)"),ce.fillStyle=fe,ce.fillRect(0,0,le.width,le.height),le},[ne,te]);return reactExports.createElement("mesh",_extends$3({renderOrder:_,ref:se,"rotation-x":-Math.PI/2},oe),reactExports.createElement("planeGeometry",null),reactExports.createElement("meshBasicMaterial",{transparent:!0,opacity:ie,fog:K,depthWrite:Z,side:DoubleSide},reactExports.createElement("canvasTexture",{attach:"map",args:[ae]})))});function createNormalMaterial(K=FrontSide){const _={value:new Matrix4};return Object.assign(new MeshNormalMaterial({side:K}),{viewMatrix:_,onBeforeCompile:Z=>{Z.uniforms.viewMatrix=_,Z.fragmentShader=`vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
           return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
         }
`+Z.fragmentShader.replace("#include <normal_fragment_maps>",`#include <normal_fragment_maps>
           normal = inverseTransformDirection( normal, viewMatrix );
`)}})}const CausticsProjectionMaterial=shaderMaterial({causticsTexture:null,causticsTextureB:null,color:new Color$1,lightProjMatrix:new Matrix4,lightViewMatrix:new Matrix4},`varying vec3 vWorldPosition;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vec4 worldPosition = modelMatrix * vec4(position, 1.);
     vWorldPosition = worldPosition.xyz;
   }`,`varying vec3 vWorldPosition;
  uniform vec3 color;
  uniform sampler2D causticsTexture;
  uniform sampler2D causticsTextureB;
  uniform mat4 lightProjMatrix;
  uniform mat4 lightViewMatrix;
   void main() {
    // Apply caustics
    vec4 lightSpacePos = lightProjMatrix * lightViewMatrix * vec4(vWorldPosition, 1.0);
    lightSpacePos.xyz /= lightSpacePos.w;
    lightSpacePos.xyz = lightSpacePos.xyz * 0.5 + 0.5;
    vec3 front = texture2D(causticsTexture, lightSpacePos.xy).rgb;
    vec3 back = texture2D(causticsTextureB, lightSpacePos.xy).rgb;
    gl_FragColor = vec4((front + back) * color, 1.0);
    #include <tonemapping_fragment>
    #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),CausticsMaterial=shaderMaterial({cameraMatrixWorld:new Matrix4,cameraProjectionMatrixInv:new Matrix4,normalTexture:null,depthTexture:null,lightDir:new Vector3(0,1,0),lightPlaneNormal:new Vector3(0,1,0),lightPlaneConstant:0,near:.1,far:100,modelMatrix:new Matrix4,worldRadius:1/40,ior:1.1,bounces:0,resolution:1024,size:10,intensity:.5},`
  varying vec2 vUv;
  void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }`,`
  uniform mat4 cameraMatrixWorld;
  uniform mat4 cameraProjectionMatrixInv;
  uniform vec3 lightDir;
  uniform vec3 lightPlaneNormal;
  uniform float lightPlaneConstant;
  uniform float near;
  uniform float far;
  uniform float time;
  uniform float worldRadius;
  uniform float resolution;
  uniform float size;
  uniform float intensity;
  uniform float ior;
  precision highp isampler2D;
  precision highp usampler2D;
  uniform sampler2D normalTexture;
  uniform sampler2D depthTexture;
  uniform float bounces;
  varying vec2 vUv;
  vec3 WorldPosFromDepth(float depth, vec2 coord) {
    float z = depth * 2.0 - 1.0;
    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
    vec4 viewSpacePosition = cameraProjectionMatrixInv * clipSpacePosition;
    // Perspective division
    viewSpacePosition /= viewSpacePosition.w;
    vec4 worldSpacePosition = cameraMatrixWorld * viewSpacePosition;
    return worldSpacePosition.xyz;
  }
  float sdPlane( vec3 p, vec3 n, float h ) {
    // n must be normalized
    return dot(p,n) + h;
  }
  float planeIntersect( vec3 ro, vec3 rd, vec4 p ) {
    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);
  }
  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 pos, vec3 normal, float ior, out vec3 rayOrigin, out vec3 rayDirection) {
    rayOrigin = ro;
    rayDirection = rd;
    rayDirection = refract(rayDirection, normal, 1.0 / ior);
    rayOrigin = pos + rayDirection * 0.1;
    return rayDirection;
  }
  void main() {
    // Each sample consists of random offset in the x and y direction
    float caustic = 0.0;
    float causticTexelSize = (1.0 / resolution) * size * 2.0;
    float texelsNeeded = worldRadius / causticTexelSize;
    float sampleRadius = texelsNeeded / resolution;
    float sum = 0.0;
    if (texture2D(depthTexture, vUv).x == 1.0) {
      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
      return;
    }
    vec2 offset1 = vec2(-0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset2 = vec2(-0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset3 = vec2(0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset4 = vec2(0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 uv1 = vUv + offset1 * sampleRadius;
    vec2 uv2 = vUv + offset2 * sampleRadius;
    vec2 uv3 = vUv + offset3 * sampleRadius;
    vec2 uv4 = vUv + offset4 * sampleRadius;
    vec3 normal1 = texture2D(normalTexture, uv1, -10.0).rgb * 2.0 - 1.0;
    vec3 normal2 = texture2D(normalTexture, uv2, -10.0).rgb * 2.0 - 1.0;
    vec3 normal3 = texture2D(normalTexture, uv3, -10.0).rgb * 2.0 - 1.0;
    vec3 normal4 = texture2D(normalTexture, uv4, -10.0).rgb * 2.0 - 1.0;
    float depth1 = texture2D(depthTexture, uv1, -10.0).x;
    float depth2 = texture2D(depthTexture, uv2, -10.0).x;
    float depth3 = texture2D(depthTexture, uv3, -10.0).x;
    float depth4 = texture2D(depthTexture, uv4, -10.0).x;
    // Sanity check the depths
    if (depth1 == 1.0 || depth2 == 1.0 || depth3 == 1.0 || depth4 == 1.0) {
      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
      return;
    }
    vec3 pos1 = WorldPosFromDepth(depth1, uv1);
    vec3 pos2 = WorldPosFromDepth(depth2, uv2);
    vec3 pos3 = WorldPosFromDepth(depth3, uv3);
    vec3 pos4 = WorldPosFromDepth(depth4, uv4);
    vec3 originPos1 = WorldPosFromDepth(0.0, uv1);
    vec3 originPos2 = WorldPosFromDepth(0.0, uv2);
    vec3 originPos3 = WorldPosFromDepth(0.0, uv3);
    vec3 originPos4 = WorldPosFromDepth(0.0, uv4);
    vec3 endPos1, endPos2, endPos3, endPos4;
    vec3 endDir1, endDir2, endDir3, endDir4;
    totalInternalReflection(originPos1, lightDir, pos1, normal1, ior, endPos1, endDir1);
    totalInternalReflection(originPos2, lightDir, pos2, normal2, ior, endPos2, endDir2);
    totalInternalReflection(originPos3, lightDir, pos3, normal3, ior, endPos3, endDir3);
    totalInternalReflection(originPos4, lightDir, pos4, normal4, ior, endPos4, endDir4);
    float lightPosArea = length(cross(originPos2 - originPos1, originPos3 - originPos1)) + length(cross(originPos3 - originPos1, originPos4 - originPos1));
    float t1 = planeIntersect(endPos1, endDir1, vec4(lightPlaneNormal, lightPlaneConstant));
    float t2 = planeIntersect(endPos2, endDir2, vec4(lightPlaneNormal, lightPlaneConstant));
    float t3 = planeIntersect(endPos3, endDir3, vec4(lightPlaneNormal, lightPlaneConstant));
    float t4 = planeIntersect(endPos4, endDir4, vec4(lightPlaneNormal, lightPlaneConstant));
    vec3 finalPos1 = endPos1 + endDir1 * t1;
    vec3 finalPos2 = endPos2 + endDir2 * t2;
    vec3 finalPos3 = endPos3 + endDir3 * t3;
    vec3 finalPos4 = endPos4 + endDir4 * t4;
    float finalArea = length(cross(finalPos2 - finalPos1, finalPos3 - finalPos1)) + length(cross(finalPos3 - finalPos1, finalPos4 - finalPos1));
    caustic += intensity * (lightPosArea / finalArea);
    // Calculate the area of the triangle in light spaces
    gl_FragColor = vec4(vec3(max(caustic, 0.0)), 1.0);
  }`),NORMALPROPS={depth:!0,minFilter:LinearFilter,magFilter:LinearFilter,type:UnsignedByteType},CAUSTICPROPS={minFilter:LinearMipmapLinearFilter,magFilter:LinearFilter,type:FloatType,generateMipmaps:!0},Caustics=reactExports.forwardRef(({debug:K,children:_,frames:Z=1,ior:te=1.1,color:ne="white",causticsOnly:ie=!1,backside:oe=!1,backsideIOR:se=1.1,worldRadius:ae=.3125,intensity:le=.05,resolution:ce=2024,lightSource:fe=[5,5,5],...de},pe)=>{extend$6({CausticsProjectionMaterial});const he=reactExports.useRef(null),ge=reactExports.useRef(null),me=reactExports.useRef(null),Ae=reactExports.useRef(null),ye=useThree(Ze=>Ze.gl),ve=useHelper(K&&ge,CameraHelper),_e=useFBO(ce,ce,NORMALPROPS),Te=useFBO(ce,ce,NORMALPROPS),be=useFBO(ce,ce,CAUSTICPROPS),Re=useFBO(ce,ce,CAUSTICPROPS),[we]=reactExports.useState(()=>createNormalMaterial()),[Pe]=reactExports.useState(()=>createNormalMaterial(BackSide)),[Ie]=reactExports.useState(()=>new CausticsMaterial),[$e]=reactExports.useState(()=>new FullScreenQuad$1(Ie));reactExports.useLayoutEffect(()=>{he.current.updateWorldMatrix(!1,!0)});let Ue=0;const ke=new Vector3,Ge=new Frustum$1,He=new Matrix4,ze=new Plane$2,Ke=new Vector3,tt=new Vector3,Je=new Box3,ot=new Vector3,Fe=[],ct=[],ht=[],lt=[],Qe=new Vector3;for(let Ze=0;Ze<8;Ze++)Fe.push(new Vector3),ct.push(new Vector3),ht.push(new Vector3),lt.push(new Vector3);return useFrame(()=>{if(Z===1/0||Ue++<Z){var Ze,it;Array.isArray(fe)?Ke.fromArray(fe).normalize():Ke.copy(he.current.worldToLocal(fe.current.getWorldPosition(ke)).normalize()),tt.copy(Ke).multiplyScalar(-1),(Ze=me.current.parent)==null||Ze.matrixWorld.identity(),Je.setFromObject(me.current,!0),Fe[0].set(Je.min.x,Je.min.y,Je.min.z),Fe[1].set(Je.min.x,Je.min.y,Je.max.z),Fe[2].set(Je.min.x,Je.max.y,Je.min.z),Fe[3].set(Je.min.x,Je.max.y,Je.max.z),Fe[4].set(Je.max.x,Je.min.y,Je.min.z),Fe[5].set(Je.max.x,Je.min.y,Je.max.z),Fe[6].set(Je.max.x,Je.max.y,Je.min.z),Fe[7].set(Je.max.x,Je.max.y,Je.max.z);for(let _t=0;_t<8;_t++)ct[_t].copy(Fe[_t]);Je.getCenter(ot),Fe.map(_t=>_t.sub(ot));const nt=ze.set(tt,0);Fe.map((_t,pt)=>nt.projectPoint(_t,ht[pt]));const Tt=ht.reduce((_t,pt)=>_t.add(pt),ke.set(0,0,0)).divideScalar(ht.length),St=ht.map(_t=>_t.distanceTo(Tt)).reduce((_t,pt)=>Math.max(_t,pt)),Et=Fe.map(_t=>_t.dot(Ke)).reduce((_t,pt)=>Math.max(_t,pt));ge.current.position.copy(Qe.copy(Ke).multiplyScalar(Et).add(ot)),ge.current.lookAt(me.current.localToWorld(ot));const Nt=He.lookAt(ge.current.position,ot,ke.set(0,1,0));ge.current.left=-St,ge.current.right=St,ge.current.top=St,ge.current.bottom=-St;const zt=ke.set(0,St,0).applyMatrix4(Nt),yt=(ge.current.position.y+zt.y)/Ke.y;ge.current.near=.1,ge.current.far=yt,ge.current.updateProjectionMatrix(),ge.current.updateMatrixWorld();const Ut=ct.map((_t,pt)=>_t.add(lt[pt].copy(Ke).multiplyScalar(-_t.y/Ke.y))),bt=Ut.reduce((_t,pt)=>_t.add(pt),ke.set(0,0,0)).divideScalar(Ut.length),Ot=2*Ut.map(_t=>Math.hypot(_t.x-bt.x,_t.z-bt.z)).reduce((_t,pt)=>Math.max(_t,pt));Ae.current.scale.setScalar(Ot),Ae.current.position.copy(bt),K&&((it=ve.current)==null||it.update()),Pe.viewMatrix.value=we.viewMatrix.value=ge.current.matrixWorldInverse;const Mt=Ge.setFromProjectionMatrix(He.multiplyMatrices(ge.current.projectionMatrix,ge.current.matrixWorldInverse)).planes[4];Ie.cameraMatrixWorld=ge.current.matrixWorld,Ie.cameraProjectionMatrixInv=ge.current.projectionMatrixInverse,Ie.lightDir=tt,Ie.lightPlaneNormal=Mt.normal,Ie.lightPlaneConstant=Mt.constant,Ie.near=ge.current.near,Ie.far=ge.current.far,Ie.resolution=ce,Ie.size=St,Ie.intensity=le,Ie.worldRadius=ae,me.current.visible=!0,ye.setRenderTarget(_e),ye.clear(),me.current.overrideMaterial=we,ye.render(me.current,ge.current),ye.setRenderTarget(Te),ye.clear(),oe&&(me.current.overrideMaterial=Pe,ye.render(me.current,ge.current)),me.current.overrideMaterial=null,Ie.ior=te,Ae.current.material.lightProjMatrix=ge.current.projectionMatrix,Ae.current.material.lightViewMatrix=ge.current.matrixWorldInverse,Ie.normalTexture=_e.texture,Ie.depthTexture=_e.depthTexture,ye.setRenderTarget(be),ye.clear(),$e.render(ye),Ie.ior=se,Ie.normalTexture=Te.texture,Ie.depthTexture=Te.depthTexture,ye.setRenderTarget(Re),ye.clear(),oe&&$e.render(ye),ye.setRenderTarget(null),ie&&(me.current.visible=!1)}}),reactExports.useImperativeHandle(pe,()=>he.current,[]),reactExports.createElement("group",_extends$3({ref:he},de),reactExports.createElement("scene",{ref:me},reactExports.createElement("orthographicCamera",{ref:ge,up:[0,1,0]}),_),reactExports.createElement("mesh",{renderOrder:2,ref:Ae,"rotation-x":-Math.PI/2},reactExports.createElement("planeGeometry",null),reactExports.createElement("causticsProjectionMaterial",{transparent:!0,color:ne,causticsTexture:be.texture,causticsTextureB:Re.texture,blending:CustomBlending,blendSrc:OneFactor,blendDst:SrcAlphaFactor,depthWrite:!1}),K&&reactExports.createElement(Edges$1,null,reactExports.createElement("lineBasicMaterial",{color:"#ffff00",toneMapped:!1}))))});class SpotLightMaterial extends ShaderMaterial{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new Vector3(0,0,0)},lightColor:{value:new Color$1("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:`
        varying vec3 vNormal;
        varying float vViewZ;
        varying float vIntensity;
        uniform vec3 spotPosition;
        uniform float attenuation;

        #include <common>
        #include <logdepthbuf_pars_vertex>

        void main() {
          // compute intensity
          vNormal = normalize(normalMatrix * normal);
          vec4 worldPosition = modelMatrix * vec4(position, 1);
          vec4 viewPosition = viewMatrix * worldPosition;
          vViewZ = viewPosition.z;

          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);

          gl_Position = projectionMatrix * viewPosition;

          #include <logdepthbuf_vertex>
        }
      `,fragmentShader:`
        varying vec3 vNormal;
        varying float vViewZ;
        varying float vIntensity;

        uniform vec3 lightColor;
        uniform float anglePower;
        uniform sampler2D depth;
        uniform vec2 resolution;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float opacity;

        #include <packing>
        #include <logdepthbuf_pars_fragment>

        float readDepth(sampler2D depthSampler, vec2 uv) {
          float fragCoordZ = texture(depthSampler, uv).r;

          // https://github.com/mrdoob/three.js/issues/23072
          #ifdef USE_LOGDEPTHBUF
            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));
          #else
            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);
          #endif

          return viewZ;
        }

        void main() {
          #include <logdepthbuf_fragment>

          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));
          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);
          float intensity = vIntensity * angleIntensity;

          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry
          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;
          if (isSoft) {
            vec2 uv = gl_FragCoord.xy / resolution;
            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));
          }

          gl_FragColor = vec4(lightColor, intensity * opacity);

          #include <tonemapping_fragment>
          #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
        }
      `})}}var SpotlightShadowShader=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D uShadowMap;uniform float uTime;void main(){vec3 color=texture2D(uShadowMap,vUv).xyz;gl_FragColor=vec4(color,1.);}`;const isSpotLight=K=>K==null?void 0:K.isSpotLight;function VolumetricMesh({opacity:K=1,radiusTop:_,radiusBottom:Z,depthBuffer:te,color:ne="white",distance:ie=5,angle:oe=.15,attenuation:se=5,anglePower:ae=5}){const le=reactExports.useRef(null),ce=useThree(me=>me.size),fe=useThree(me=>me.camera),de=useThree(me=>me.viewport.dpr),[pe]=reactExports.useState(()=>new SpotLightMaterial),[he]=reactExports.useState(()=>new Vector3);_=_===void 0?.1:_,Z=Z===void 0?oe*7:Z,useFrame(()=>{pe.uniforms.spotPosition.value.copy(le.current.getWorldPosition(he)),le.current.lookAt(le.current.parent.target.getWorldPosition(he))});const ge=reactExports.useMemo(()=>{const me=new CylinderGeometry(_,Z,ie,128,64,!0);return me.applyMatrix4(new Matrix4().makeTranslation(0,-ie/2,0)),me.applyMatrix4(new Matrix4().makeRotationX(-Math.PI/2)),me},[ie,_,Z]);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("mesh",{ref:le,geometry:ge,raycast:()=>null},reactExports.createElement("primitive",{object:pe,attach:"material","uniforms-opacity-value":K,"uniforms-lightColor-value":ne,"uniforms-attenuation-value":se,"uniforms-anglePower-value":ae,"uniforms-depth-value":te,"uniforms-cameraNear-value":fe.near,"uniforms-cameraFar-value":fe.far,"uniforms-resolution-value":te?[ce.width*de,ce.height*de]:[0,0]})))}function useCommon(K,_,Z,te,ne){const[[ie,oe]]=reactExports.useState(()=>[new Vector3,new Vector3]);reactExports.useLayoutEffect(()=>{if(isSpotLight(K.current))K.current.shadow.mapSize.set(Z,te),K.current.shadow.needsUpdate=!0;else throw new Error("SpotlightShadow must be a child of a SpotLight")},[K,Z,te]),useFrame(()=>{if(!K.current)return;const se=K.current.position,ae=K.current.target.position;oe.copy(ae).sub(se);var le=oe.length();oe.normalize().multiplyScalar(le*ne),ie.copy(se).add(oe),_.current.position.copy(ie),_.current.lookAt(K.current.target.position)})}function SpotlightShadowWithShader({distance:K=.4,alphaTest:_=.5,map:Z,shader:te=SpotlightShadowShader,width:ne=512,height:ie=512,scale:oe=1,children:se,...ae}){const le=reactExports.useRef(null),ce=ae.spotlightRef,fe=ae.debug;useCommon(ce,le,ne,ie,K);const de=reactExports.useMemo(()=>new WebGLRenderTarget(ne,ie,{format:RGBAFormat,stencilBuffer:!1}),[ne,ie]),pe=reactExports.useRef({uShadowMap:{value:Z},uTime:{value:0}});reactExports.useEffect(()=>void(pe.current.uShadowMap.value=Z),[Z]);const he=reactExports.useMemo(()=>new FullScreenQuad$1(new ShaderMaterial({uniforms:pe.current,vertexShader:`
          varying vec2 vUv;

          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
          `,fragmentShader:te})),[te]);return reactExports.useEffect(()=>()=>{he.material.dispose(),he.dispose()},[he]),reactExports.useEffect(()=>()=>de.dispose(),[de]),useFrame(({gl:ge},me)=>{pe.current.uTime.value+=me,ge.setRenderTarget(de),he.render(ge),ge.setRenderTarget(null)}),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("mesh",{ref:le,scale:oe,castShadow:!0},reactExports.createElement("planeGeometry",null),reactExports.createElement("meshBasicMaterial",{transparent:!0,side:DoubleSide,alphaTest:_,alphaMap:de.texture,"alphaMap-wrapS":RepeatWrapping,"alphaMap-wrapT":RepeatWrapping,opacity:fe?1:0},se)))}function SpotlightShadowWithoutShader({distance:K=.4,alphaTest:_=.5,map:Z,width:te=512,height:ne=512,scale:ie,children:oe,...se}){const ae=reactExports.useRef(null),le=se.spotlightRef,ce=se.debug;return useCommon(le,ae,te,ne,K),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("mesh",{ref:ae,scale:ie,castShadow:!0},reactExports.createElement("planeGeometry",null),reactExports.createElement("meshBasicMaterial",{transparent:!0,side:DoubleSide,alphaTest:_,alphaMap:Z,"alphaMap-wrapS":RepeatWrapping,"alphaMap-wrapT":RepeatWrapping,opacity:ce?1:0},oe)))}function SpotLightShadow(K){return K.shader?reactExports.createElement(SpotlightShadowWithShader,K):reactExports.createElement(SpotlightShadowWithoutShader,K)}const SpotLight$1=reactExports.forwardRef(({opacity:K=1,radiusTop:_,radiusBottom:Z,depthBuffer:te,color:ne="white",distance:ie=5,angle:oe=.15,attenuation:se=5,anglePower:ae=5,volumetric:le=!0,debug:ce=!1,children:fe,...de},pe)=>{const he=reactExports.useRef(null);return reactExports.useImperativeHandle(pe,()=>he.current,[]),reactExports.createElement("group",null,ce&&he.current&&reactExports.createElement("spotLightHelper",{args:[he.current]}),reactExports.createElement("spotLight",_extends$3({ref:he,angle:oe,color:ne,distance:ie,castShadow:!0},de),le&&reactExports.createElement(VolumetricMesh,{debug:ce,opacity:K,radiusTop:_,radiusBottom:Z,depthBuffer:te,color:ne,distance:ie,angle:oe,attenuation:se,anglePower:ae})),fe&&reactExports.cloneElement(fe,{spotlightRef:he,debug:ce}))}),Lightformer=reactExports.forwardRef(({light:K,args:_,map:Z,toneMapped:te=!1,color:ne="white",form:ie="rect",intensity:oe=1,scale:se=1,target:ae=[0,0,0],children:le,...ce},fe)=>{const de=reactExports.useRef(null);return reactExports.useImperativeHandle(fe,()=>de.current,[]),reactExports.useLayoutEffect(()=>{!le&&!ce.material&&(applyProps(de.current.material,{color:ne}),de.current.material.color.multiplyScalar(oe))},[ne,oe,le,ce.material]),reactExports.useLayoutEffect(()=>{ce.rotation||de.current.quaternion.identity(),ae&&!ce.rotation&&(typeof ae=="boolean"?de.current.lookAt(0,0,0):de.current.lookAt(Array.isArray(ae)?new Vector3(...ae):ae))},[ae,ce.rotation]),se=Array.isArray(se)&&se.length===2?[se[0],se[1],1]:se,reactExports.createElement("mesh",_extends$3({ref:de,scale:se},ce),ie==="circle"?reactExports.createElement("ringGeometry",{args:_||[0,.5,64]}):ie==="ring"?reactExports.createElement("ringGeometry",{args:_||[.25,.5,64]}):ie==="rect"||ie==="plane"?reactExports.createElement("planeGeometry",{args:_||[1,1]}):ie==="box"?reactExports.createElement("boxGeometry",{args:_||[1,1,1]}):reactExports.createElement(ie,{args:_}),le||reactExports.createElement("meshBasicMaterial",{toneMapped:te,map:Z,side:DoubleSide}),K&&reactExports.createElement("pointLight",_extends$3({castShadow:!0},K)))});function calcPosFromAngles(K,_,Z=new Vector3){const te=Math.PI*(K-.5),ne=2*Math.PI*(_-.5);return Z.x=Math.cos(ne),Z.y=Math.sin(te),Z.z=Math.sin(ne),Z}const Sky=reactExports.forwardRef(({inclination:K=.6,azimuth:_=.1,distance:Z=1e3,mieCoefficient:te=.005,mieDirectionalG:ne=.8,rayleigh:ie=.5,turbidity:oe=10,sunPosition:se=calcPosFromAngles(K,_),...ae},le)=>{const ce=reactExports.useMemo(()=>new Vector3().setScalar(Z),[Z]),[fe]=reactExports.useState(()=>new Sky$1);return reactExports.createElement("primitive",_extends$3({object:fe,ref:le,"material-uniforms-mieCoefficient-value":te,"material-uniforms-mieDirectionalG-value":ne,"material-uniforms-rayleigh-value":ie,"material-uniforms-sunPosition-value":se,"material-uniforms-turbidity-value":oe,scale:ce},ae))});class StarfieldMaterial extends ShaderMaterial{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}const genStar=K=>new Vector3().setFromSpherical(new Spherical(K,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),Stars=reactExports.forwardRef(({radius:K=100,depth:_=50,count:Z=5e3,saturation:te=0,factor:ne=4,fade:ie=!1,speed:oe=1},se)=>{const ae=reactExports.useRef(null),[le,ce,fe]=reactExports.useMemo(()=>{const pe=[],he=[],ge=Array.from({length:Z},()=>(.5+.5*Math.random())*ne),me=new Color$1;let Ae=K+_;const ye=_/Z;for(let ve=0;ve<Z;ve++)Ae-=ye*Math.random(),pe.push(...genStar(Ae).toArray()),me.setHSL(ve/Z,te,.9),he.push(me.r,me.g,me.b);return[new Float32Array(pe),new Float32Array(he),new Float32Array(ge)]},[Z,_,ne,K,te]);useFrame(pe=>ae.current&&(ae.current.uniforms.time.value=pe.clock.elapsedTime*oe));const[de]=reactExports.useState(()=>new StarfieldMaterial);return reactExports.createElement("points",{ref:se},reactExports.createElement("bufferGeometry",null,reactExports.createElement("bufferAttribute",{attach:"attributes-position",args:[le,3]}),reactExports.createElement("bufferAttribute",{attach:"attributes-color",args:[ce,3]}),reactExports.createElement("bufferAttribute",{attach:"attributes-size",args:[fe,1]})),reactExports.createElement("primitive",{ref:ae,object:de,attach:"material",blending:AdditiveBlending,"uniforms-fade-value":ie,depthWrite:!1,transparent:!0,vertexColors:!0}))}),CLOUD_URL="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",parentMatrix$1=new Matrix4,translation=new Vector3,rotation=new Quaternion,cpos=new Vector3,cquat=new Quaternion,scale=new Vector3,context$4=reactExports.createContext(null),Clouds=reactExports.forwardRef(({children:K,material:_=MeshLambertMaterial,texture:Z=CLOUD_URL,range:te,limit:ne=200,frustumCulled:ie,...oe},se)=>{var ae,le;const ce=reactExports.useMemo(()=>class extends _{constructor(){super();const we=parseInt(REVISION.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=Pe=>{Pe.vertexShader=`attribute float cloudOpacity;
               varying float vOpacity;
              `+Pe.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = cloudOpacity;
                `),Pe.fragmentShader=`varying float vOpacity;
              `+Pe.fragmentShader.replace(`#include <${we}>`,`#include <${we}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}},[_]);extend$6({CloudMaterial:ce});const fe=reactExports.useRef(null),de=reactExports.useRef([]),pe=reactExports.useMemo(()=>new Float32Array(Array.from({length:ne},()=>1)),[ne]),he=reactExports.useMemo(()=>new Float32Array(Array.from({length:ne},()=>[1,1,1]).flat()),[ne]),ge=useTexture(Z);let me=0,Ae=0,ye;const ve=new Quaternion,_e=new Vector3(0,0,1),Te=new Vector3;useFrame((we,Pe)=>{for(me=we.clock.elapsedTime,parentMatrix$1.copy(fe.current.matrixWorld).invert(),we.camera.matrixWorld.decompose(cpos,cquat,scale),Ae=0;Ae<de.current.length;Ae++)ye=de.current[Ae],ye.ref.current.matrixWorld.decompose(translation,rotation,scale),translation.add(Te.copy(ye.position).applyQuaternion(rotation).multiply(scale)),rotation.copy(cquat).multiply(ve.setFromAxisAngle(_e,ye.rotation+=Pe*ye.rotationFactor)),scale.multiplyScalar(ye.volume+(1+Math.sin(me*ye.density*ye.speed))/2*ye.growth),ye.matrix.compose(translation,rotation,scale).premultiply(parentMatrix$1),ye.dist=translation.distanceTo(cpos);for(de.current.sort((Ie,$e)=>$e.dist-Ie.dist),Ae=0;Ae<de.current.length;Ae++)ye=de.current[Ae],pe[Ae]=ye.opacity*(ye.dist<ye.fade-1?ye.dist/ye.fade:1),fe.current.setMatrixAt(Ae,ye.matrix),fe.current.setColorAt(Ae,ye.color);fe.current.geometry.attributes.cloudOpacity.needsUpdate=!0,fe.current.instanceMatrix.needsUpdate=!0,fe.current.instanceColor&&(fe.current.instanceColor.needsUpdate=!0)}),reactExports.useLayoutEffect(()=>{const we=Math.min(ne,te!==void 0?te:ne,de.current.length);fe.current.count=we,setUpdateRange(fe.current.instanceMatrix,{start:0,count:we*16}),fe.current.instanceColor&&setUpdateRange(fe.current.instanceColor,{start:0,count:we*3}),setUpdateRange(fe.current.geometry.attributes.cloudOpacity,{start:0,count:we})});let be=[(ae=ge.image.width)!==null&&ae!==void 0?ae:1,(le=ge.image.height)!==null&&le!==void 0?le:1];const Re=Math.max(be[0],be[1]);return be=[be[0]/Re,be[1]/Re],reactExports.createElement("group",_extends$3({ref:se},oe),reactExports.createElement(context$4.Provider,{value:de},K,reactExports.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:fe,args:[null,null,ne],frustumCulled:ie},reactExports.createElement("instancedBufferAttribute",{usage:DynamicDrawUsage,attach:"instanceColor",args:[he,3]}),reactExports.createElement("planeGeometry",{args:[...be]},reactExports.createElement("instancedBufferAttribute",{usage:DynamicDrawUsage,attach:"attributes-cloudOpacity",args:[pe,1]})),reactExports.createElement("cloudMaterial",{key:_.name,map:ge,transparent:!0,depthWrite:!1}))))}),CloudInstance=reactExports.forwardRef(({opacity:K=1,speed:_=0,bounds:Z=[5,1,1],segments:te=20,color:ne="#ffffff",fade:ie=10,volume:oe=6,smallestVolume:se=.25,distribute:ae=null,growth:le=4,concentrate:ce="inside",seed:fe=Math.random(),...de},pe)=>{function he(){const ve=Math.sin(fe++)*1e4;return ve-Math.floor(ve)}const ge=reactExports.useContext(context$4),me=reactExports.useRef(null),Ae=reactExports.useId(),ye=reactExports.useMemo(()=>[...new Array(te)].map((ve,_e)=>({segments:te,bounds:new Vector3(1,1,1),position:new Vector3,uuid:Ae,index:_e,ref:me,dist:0,matrix:new Matrix4,color:new Color$1,rotation:_e*(Math.PI/te)})),[te,Ae]);return reactExports.useLayoutEffect(()=>{ye.forEach((ve,_e)=>{applyProps(ve,{volume:oe,color:ne,speed:_,growth:le,opacity:K,fade:ie,bounds:Z,density:Math.max(.5,he()),rotationFactor:Math.max(.2,.5*he())*_});const Te=ae==null?void 0:ae(ve,_e);if(Te||te>1){var be;ve.position.copy(ve.bounds).multiply((be=Te==null?void 0:Te.point)!==null&&be!==void 0?be:{x:he()*2-1,y:he()*2-1,z:he()*2-1})}const Re=Math.abs(ve.position.x),we=Math.abs(ve.position.y),Pe=Math.abs(ve.position.z),Ie=Math.max(Re,we,Pe);ve.length=1,Re===Ie&&(ve.length-=Re/ve.bounds.x),we===Ie&&(ve.length-=we/ve.bounds.y),Pe===Ie&&(ve.length-=Pe/ve.bounds.z),ve.volume=((Te==null?void 0:Te.volume)!==void 0?Te.volume:Math.max(Math.max(0,se),ce==="random"?he():ce==="inside"?ve.length:1-ve.length))*oe})},[ce,Z,ie,ne,K,le,oe,fe,te,_]),reactExports.useLayoutEffect(()=>{const ve=ye;return ge.current=[...ge.current,...ve],()=>{ge.current=ge.current.filter(_e=>_e.uuid!==Ae)}},[ye]),reactExports.useImperativeHandle(pe,()=>me.current,[]),reactExports.createElement("group",_extends$3({ref:me},de))}),Cloud=reactExports.forwardRef((K,_)=>reactExports.useContext(context$4)?reactExports.createElement(CloudInstance,_extends$3({ref:_},K)):reactExports.createElement(Clouds,null,reactExports.createElement(CloudInstance,_extends$3({ref:_},K))));class SparklesImplMaterial extends ShaderMaterial{constructor(){super({uniforms:{time:{value:0},pixelRatio:{value:1}},vertexShader:`
        uniform float pixelRatio;
        uniform float time;
        attribute float size;  
        attribute float speed;  
        attribute float opacity;
        attribute vec3 noise;
        attribute vec3 color;
        varying vec3 vColor;
        varying float vOpacity;

        void main() {
          vec4 modelPosition = modelMatrix * vec4(position, 1.0);
          modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;
          modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;
          modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;
          vec4 viewPosition = viewMatrix * modelPosition;
          vec4 projectionPostion = projectionMatrix * viewPosition;
          gl_Position = projectionPostion;
          gl_PointSize = size * 25. * pixelRatio;
          gl_PointSize *= (1.0 / - viewPosition.z);
          vColor = color;
          vOpacity = opacity;
        }
      `,fragmentShader:`
        varying vec3 vColor;
        varying float vOpacity;
        void main() {
          float distanceToCenter = distance(gl_PointCoord, vec2(0.5));
          float strength = 0.05 / distanceToCenter - 0.1;
          gl_FragColor = vec4(vColor, strength * vOpacity);
          #include <tonemapping_fragment>
          #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
        }
      `})}get time(){return this.uniforms.time.value}set time(_){this.uniforms.time.value=_}get pixelRatio(){return this.uniforms.pixelRatio.value}set pixelRatio(_){this.uniforms.pixelRatio.value=_}}const isFloat32Array=K=>K&&K.constructor===Float32Array,expandColor=K=>[K.r,K.g,K.b],isVector=K=>K instanceof Vector2||K instanceof Vector3||K instanceof Vector4,normalizeVector$1=K=>Array.isArray(K)?K:isVector(K)?K.toArray():[K,K,K];function usePropAsIsOrAsAttribute(K,_,Z){return reactExports.useMemo(()=>{if(_!==void 0){if(isFloat32Array(_))return _;if(_ instanceof Color$1){const te=Array.from({length:K*3},()=>expandColor(_)).flat();return Float32Array.from(te)}else if(isVector(_)||Array.isArray(_)){const te=Array.from({length:K*3},()=>normalizeVector$1(_)).flat();return Float32Array.from(te)}return Float32Array.from({length:K},()=>_)}return Float32Array.from({length:K},Z)},[_])}const Sparkles=reactExports.forwardRef(({noise:K=1,count:_=100,speed:Z=1,opacity:te=1,scale:ne=1,size:ie,color:oe,children:se,...ae},le)=>{reactExports.useMemo(()=>extend$6({SparklesImplMaterial}),[]);const ce=reactExports.useRef(null),fe=useThree(ve=>ve.viewport.dpr),de=normalizeVector$1(ne),pe=reactExports.useMemo(()=>Float32Array.from(Array.from({length:_},()=>de.map(MathUtils.randFloatSpread)).flat()),[_,...de]),he=usePropAsIsOrAsAttribute(_,ie,Math.random),ge=usePropAsIsOrAsAttribute(_,te),me=usePropAsIsOrAsAttribute(_,Z),Ae=usePropAsIsOrAsAttribute(_*3,K),ye=usePropAsIsOrAsAttribute(oe===void 0?_*3:_,isFloat32Array(oe)?oe:new Color$1(oe),()=>1);return useFrame(ve=>{ce.current&&ce.current.material&&(ce.current.material.time=ve.clock.elapsedTime)}),reactExports.useImperativeHandle(le,()=>ce.current,[]),reactExports.createElement("points",_extends$3({key:`particle-${_}-${JSON.stringify(ne)}`},ae,{ref:ce}),reactExports.createElement("bufferGeometry",null,reactExports.createElement("bufferAttribute",{attach:"attributes-position",args:[pe,3]}),reactExports.createElement("bufferAttribute",{attach:"attributes-size",args:[he,1]}),reactExports.createElement("bufferAttribute",{attach:"attributes-opacity",args:[ge,1]}),reactExports.createElement("bufferAttribute",{attach:"attributes-speed",args:[me,1]}),reactExports.createElement("bufferAttribute",{attach:"attributes-color",args:[ye,3]}),reactExports.createElement("bufferAttribute",{attach:"attributes-noise",args:[Ae,3]})),se||reactExports.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:fe,depthWrite:!1}))}),_inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere$2,_position=new Vector3;class PositionPoint extends Group{constructor(){super(),this.size=0,this.color=new Color$1("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var _;return(_=this.instance.current)==null?void 0:_.geometry}raycast(_,Z){var te,ne;const ie=this.instance.current;if(!ie||!ie.geometry)return;const oe=ie.userData.instances.indexOf(this.instanceKey);if(oe===-1||oe>ie.geometry.drawRange.count)return;const se=(te=(ne=_.params.Points)==null?void 0:ne.threshold)!==null&&te!==void 0?te:1;if(_sphere.set(this.getWorldPosition(_position),se),_.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(ie.matrixWorld).invert(),_ray.copy(_.ray).applyMatrix4(_inverseMatrix);const ae=se/((this.scale.x+this.scale.y+this.scale.z)/3),le=ae*ae,ce=_ray.distanceSqToPoint(this.position);if(ce<le){const fe=new Vector3;_ray.closestPointToPoint(this.position,fe),fe.applyMatrix4(this.matrixWorld);const de=_.ray.origin.distanceTo(fe);if(de<_.near||de>_.far)return;Z.push({distance:de,distanceToRay:Math.sqrt(ce),point:fe,index:oe,face:null,object:this})}}}let i$a,positionRef;const context$3=reactExports.createContext(null),parentMatrix=new Matrix4,position$7=new Vector3,PointsInstances=reactExports.forwardRef(({children:K,range:_,limit:Z=1e3,...te},ne)=>{const ie=reactExports.useRef(null);reactExports.useImperativeHandle(ne,()=>ie.current,[]);const[oe,se]=reactExports.useState([]),[[ae,le,ce]]=reactExports.useState(()=>[new Float32Array(Z*3),Float32Array.from({length:Z*3},()=>1),Float32Array.from({length:Z},()=>1)]);reactExports.useEffect(()=>{ie.current.geometry.attributes.position.needsUpdate=!0}),useFrame(()=>{for(ie.current.updateMatrix(),ie.current.updateMatrixWorld(),parentMatrix.copy(ie.current.matrixWorld).invert(),ie.current.geometry.drawRange.count=Math.min(Z,_!==void 0?_:Z,oe.length),i$a=0;i$a<oe.length;i$a++)positionRef=oe[i$a].current,positionRef.getWorldPosition(position$7).applyMatrix4(parentMatrix),position$7.toArray(ae,i$a*3),ie.current.geometry.attributes.position.needsUpdate=!0,positionRef.matrixWorldNeedsUpdate=!0,positionRef.color.toArray(le,i$a*3),ie.current.geometry.attributes.color.needsUpdate=!0,ce.set([positionRef.size],i$a),ie.current.geometry.attributes.size.needsUpdate=!0});const fe=reactExports.useMemo(()=>({getParent:()=>ie,subscribe:de=>(se(pe=>[...pe,de]),()=>se(pe=>pe.filter(he=>he.current!==de.current)))}),[]);return reactExports.createElement("points",_extends$3({userData:{instances:oe},matrixAutoUpdate:!1,ref:ie,raycast:()=>null},te),reactExports.createElement("bufferGeometry",null,reactExports.createElement("bufferAttribute",{attach:"attributes-position",args:[ae,3],usage:DynamicDrawUsage}),reactExports.createElement("bufferAttribute",{attach:"attributes-color",args:[le,3],usage:DynamicDrawUsage}),reactExports.createElement("bufferAttribute",{attach:"attributes-size",args:[ce,1],usage:DynamicDrawUsage})),reactExports.createElement(context$3.Provider,{value:fe},K))}),Point=reactExports.forwardRef(({children:K,..._},Z)=>{reactExports.useMemo(()=>extend$6({PositionPoint}),[]);const te=reactExports.useRef(null);reactExports.useImperativeHandle(Z,()=>te.current,[]);const{subscribe:ne,getParent:ie}=reactExports.useContext(context$3);return reactExports.useLayoutEffect(()=>ne(te),[]),reactExports.createElement("positionPoint",_extends$3({instance:ie(),instanceKey:te,ref:te},_),K)}),PointsBuffer=reactExports.forwardRef(({children:K,positions:_,colors:Z,sizes:te,stride:ne=3,...ie},oe)=>{const se=reactExports.useRef(null);return reactExports.useImperativeHandle(oe,()=>se.current,[]),useFrame(()=>{const ae=se.current.geometry.attributes;ae.position.needsUpdate=!0,Z&&(ae.color.needsUpdate=!0),te&&(ae.size.needsUpdate=!0)}),reactExports.createElement("points",_extends$3({ref:se},ie),reactExports.createElement("bufferGeometry",null,reactExports.createElement("bufferAttribute",{attach:"attributes-position",args:[_,ne],usage:DynamicDrawUsage}),Z&&reactExports.createElement("bufferAttribute",{attach:"attributes-color",args:[Z,ne],count:Z.length/ne,usage:DynamicDrawUsage}),te&&reactExports.createElement("bufferAttribute",{attach:"attributes-size",args:[te,1],count:te.length/ne,usage:DynamicDrawUsage})),K)}),Points=reactExports.forwardRef((K,_)=>K.positions instanceof Float32Array?reactExports.createElement(PointsBuffer,_extends$3({},K,{ref:_})):reactExports.createElement(PointsInstances,_extends$3({},K,{ref:_}))),context$2=reactExports.createContext(null),Segments=reactExports.forwardRef((K,_)=>{reactExports.useMemo(()=>extend$6({SegmentObject}),[]);const{limit:Z=1e3,lineWidth:te=1,children:ne,...ie}=K,[oe,se]=reactExports.useState([]),[ae]=reactExports.useState(()=>new Line2),[le]=reactExports.useState(()=>new LineMaterial),[ce]=reactExports.useState(()=>new LineSegmentsGeometry),[fe]=reactExports.useState(()=>new Vector2(512,512)),[de]=reactExports.useState(()=>Array(Z*6).fill(0)),[pe]=reactExports.useState(()=>Array(Z*6).fill(0)),he=reactExports.useMemo(()=>({subscribe:ge=>(se(me=>[...me,ge]),()=>se(me=>me.filter(Ae=>Ae.current!==ge.current)))}),[]);return useFrame(()=>{for(let me=0;me<Z;me++){var ge;const Ae=(ge=oe[me])==null?void 0:ge.current;Ae&&(de[me*6+0]=Ae.start.x,de[me*6+1]=Ae.start.y,de[me*6+2]=Ae.start.z,de[me*6+3]=Ae.end.x,de[me*6+4]=Ae.end.y,de[me*6+5]=Ae.end.z,pe[me*6+0]=Ae.color.r,pe[me*6+1]=Ae.color.g,pe[me*6+2]=Ae.color.b,pe[me*6+3]=Ae.color.r,pe[me*6+4]=Ae.color.g,pe[me*6+5]=Ae.color.b)}ce.setColors(pe),ce.setPositions(de),ae.computeLineDistances()}),reactExports.createElement("primitive",{object:ae,ref:_},reactExports.createElement("primitive",{object:ce,attach:"geometry"}),reactExports.createElement("primitive",_extends$3({object:le,attach:"material",vertexColors:!0,resolution:fe,linewidth:te},ie)),reactExports.createElement(context$2.Provider,{value:he},ne))});class SegmentObject{constructor(){this.color=new Color$1("white"),this.start=new Vector3(0,0,0),this.end=new Vector3(0,0,0)}}const normPos=K=>K instanceof Vector3?K:new Vector3(...typeof K=="number"?[K,K,K]:K),Segment=reactExports.forwardRef(({color:K,start:_,end:Z},te)=>{const ne=reactExports.useContext(context$2);if(!ne)throw"Segment must used inside Segments component.";const ie=reactExports.useRef(null);return reactExports.useImperativeHandle(te,()=>ie.current,[]),reactExports.useLayoutEffect(()=>ne.subscribe(ie),[]),reactExports.createElement("segmentObject",{ref:ie,color:K,start:normPos(_),end:normPos(Z)})}),Detailed=reactExports.forwardRef(({children:K,hysteresis:_=0,distances:Z,...te},ne)=>{const ie=reactExports.useRef(null);return reactExports.useImperativeHandle(ne,()=>ie.current,[]),reactExports.useLayoutEffect(()=>{const{current:oe}=ie;oe.levels.length=0,oe.children.forEach((se,ae)=>oe.levels.push({object:se,hysteresis:_,distance:Z[ae]}))}),useFrame(oe=>{var se;return(se=ie.current)==null?void 0:se.update(oe.camera)}),reactExports.createElement("lOD",_extends$3({ref:ie},te),K)});function Preload({all:K,scene:_,camera:Z}){const te=useThree(({gl:oe})=>oe),ne=useThree(({camera:oe})=>oe),ie=useThree(({scene:oe})=>oe);return reactExports.useLayoutEffect(()=>{const oe=[];K&&(_||ie).traverse(le=>{le.visible===!1&&(oe.push(le),le.visible=!0)}),te.compile(_||ie,Z||ne);const se=new WebGLCubeRenderTarget(128);new CubeCamera$1(.01,1e5,se).update(te,_||ie),se.dispose(),oe.forEach(le=>le.visible=!1)},[]),null}function BakeShadows(){const K=useThree(_=>_.gl);return reactExports.useEffect(()=>(K.shadowMap.autoUpdate=!1,K.shadowMap.needsUpdate=!0,()=>{K.shadowMap.autoUpdate=K.shadowMap.needsUpdate=!0}),[K.shadowMap]),null}function AdaptiveDpr({pixelated:K}){const _=useThree(oe=>oe.gl),Z=useThree(oe=>oe.internal.active),te=useThree(oe=>oe.performance.current),ne=useThree(oe=>oe.viewport.initialDpr),ie=useThree(oe=>oe.setDpr);return reactExports.useEffect(()=>{const oe=_.domElement;return()=>{Z&&ie(ne),K&&oe&&(oe.style.imageRendering="auto")}},[]),reactExports.useEffect(()=>{ie(te*ne),K&&_.domElement&&(_.domElement.style.imageRendering=te===1?"auto":"pixelated")},[te]),null}function AdaptiveEvents(){const K=useThree(te=>te.get),_=useThree(te=>te.setEvents),Z=useThree(te=>te.performance.current);return reactExports.useEffect(()=>{const te=K().events.enabled;return()=>_({enabled:te})},[]),reactExports.useEffect(()=>_({enabled:Z===1}),[Z]),null}const context$1=reactExports.createContext(null);function PerformanceMonitor({iterations:K=10,ms:_=250,threshold:Z=.75,step:te=.1,factor:ne=.5,flipflops:ie=1/0,bounds:oe=de=>de>100?[60,100]:[40,60],onIncline:se,onDecline:ae,onChange:le,onFallback:ce,children:fe}){const de=Math.pow(10,0),[pe,he]=reactExports.useState(()=>({fps:0,index:0,factor:ne,flipped:0,refreshrate:0,fallback:!1,frames:[],averages:[],subscriptions:new Map,subscribe:me=>{const Ae=Symbol();return pe.subscriptions.set(Ae,me.current),()=>void pe.subscriptions.delete(Ae)}}));let ge=0;return useFrame(()=>{const{frames:me,averages:Ae}=pe;if(!pe.fallback&&Ae.length<K){me.push(performance.now());const ye=me[me.length-1]-me[0];if(ye>=_){if(pe.fps=Math.round(me.length/ye*1e3*de)/de,pe.refreshrate=Math.max(pe.refreshrate,pe.fps),Ae[pe.index++%K]=pe.fps,Ae.length===K){const[ve,_e]=oe(pe.refreshrate),Te=Ae.filter(Re=>Re>=_e),be=Ae.filter(Re=>Re<ve);Te.length>K*Z&&(pe.factor=Math.min(1,pe.factor+te),pe.flipped++,se&&se(pe),pe.subscriptions.forEach(Re=>Re.onIncline&&Re.onIncline(pe))),be.length>K*Z&&(pe.factor=Math.max(0,pe.factor-te),pe.flipped++,ae&&ae(pe),pe.subscriptions.forEach(Re=>Re.onDecline&&Re.onDecline(pe))),ge!==pe.factor&&(ge=pe.factor,le&&le(pe),pe.subscriptions.forEach(Re=>Re.onChange&&Re.onChange(pe))),pe.flipped>ie&&!pe.fallback&&(pe.fallback=!0,ce&&ce(pe),pe.subscriptions.forEach(Re=>Re.onFallback&&Re.onFallback(pe))),pe.averages=[]}pe.frames=[]}}}),reactExports.createElement(context$1.Provider,{value:pe},fe)}function usePerformanceMonitor({onIncline:K,onDecline:_,onChange:Z,onFallback:te}){const ne=reactExports.useContext(context$1),ie=reactExports.useRef({onIncline:K,onDecline:_,onChange:Z,onFallback:te});reactExports.useLayoutEffect(()=>{ie.current.onIncline=K,ie.current.onDecline=_,ie.current.onChange=Z,ie.current.onFallback=te},[K,_,Z,te]),reactExports.useLayoutEffect(()=>ne.subscribe(ie),[ne])}const RenderTexture=reactExports.forwardRef(({children:K,compute:_,width:Z,height:te,samples:ne=8,renderPriority:ie=0,eventPriority:oe=0,frames:se=1/0,stencilBuffer:ae=!1,depthBuffer:le=!0,generateMipmaps:ce=!1,...fe},de)=>{const{size:pe,viewport:he}=useThree(),ge=useFBO((Z||pe.width)*he.dpr,(te||pe.height)*he.dpr,{samples:ne,stencilBuffer:ae,depthBuffer:le,generateMipmaps:ce}),[me]=reactExports.useState(()=>new Scene$1),Ae=reactExports.useCallback((ye,ve,_e)=>{var Te,be;let Re=(Te=ge.texture)==null||(Te=Te.__r3f.parent)==null?void 0:Te.object;for(;Re&&!(Re instanceof Object3D);){var we;Re=(we=Re.__r3f.parent)==null?void 0:we.object}if(!Re)return!1;_e.raycaster.camera||_e.events.compute(ye,_e,(be=_e.previousRoot)==null?void 0:be.getState());const[Pe]=_e.raycaster.intersectObject(Re);if(!Pe)return!1;const Ie=Pe.uv;if(!Ie)return!1;ve.raycaster.setFromCamera(ve.pointer.set(Ie.x*2-1,Ie.y*2-1),ve.camera)},[]);return reactExports.useImperativeHandle(de,()=>ge.texture,[ge]),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(Container$5,{renderPriority:ie,frames:se,fbo:ge},K,reactExports.createElement("group",{onPointerOver:()=>null})),me,{events:{compute:_||Ae,priority:oe}}),reactExports.createElement("primitive",_extends$3({object:ge.texture},fe)))});function Container$5({frames:K,renderPriority:_,children:Z,fbo:te}){let ne=0,ie,oe,se,ae;return useFrame(le=>{(K===1/0||ne<K)&&(ie=le.gl.autoClear,oe=le.gl.xr.enabled,se=le.gl.getRenderTarget(),ae=le.gl.xr.isPresenting,le.gl.autoClear=!0,le.gl.xr.enabled=!1,le.gl.xr.isPresenting=!1,le.gl.setRenderTarget(te),le.gl.render(le.scene,le.camera),le.gl.setRenderTarget(se),le.gl.autoClear=ie,le.gl.xr.enabled=oe,le.gl.xr.isPresenting=ae,ne++)},_),reactExports.createElement(reactExports.Fragment,null,Z)}const RenderCubeTexture=reactExports.forwardRef(({children:K,compute:_,renderPriority:Z=-1,eventPriority:te=0,frames:ne=1/0,stencilBuffer:ie=!1,depthBuffer:oe=!0,generateMipmaps:se=!1,resolution:ae=896,near:le=.1,far:ce=1e3,flip:fe=!1,position:de,rotation:pe,scale:he,quaternion:ge,matrix:me,matrixAutoUpdate:Ae,...ye},ve)=>{const{size:_e,viewport:Te}=useThree(),be=reactExports.useRef(null),Re=reactExports.useMemo(()=>{const Pe=new WebGLCubeRenderTarget(Math.max((ae||_e.width)*Te.dpr,(ae||_e.height)*Te.dpr),{stencilBuffer:ie,depthBuffer:oe,generateMipmaps:se});return Pe.texture.isRenderTargetTexture=!fe,Pe.texture.flipY=!0,Pe.texture.type=HalfFloatType,Pe},[ae,fe]);reactExports.useEffect(()=>()=>Re.dispose(),[Re]);const[we]=reactExports.useState(()=>new Scene$1);return reactExports.useImperativeHandle(ve,()=>({scene:we,fbo:Re,camera:be.current}),[Re]),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(Container$4,{renderPriority:Z,frames:ne,camera:be},K,reactExports.createElement("group",{onPointerOver:()=>null})),we,{events:{compute:_,priority:te}}),reactExports.createElement("primitive",_extends$3({object:Re.texture},ye)),reactExports.createElement("cubeCamera",{ref:be,args:[le,ce,Re],position:de,rotation:pe,scale:he,quaternion:ge,matrix:me,matrixAutoUpdate:Ae}))});function Container$4({frames:K,renderPriority:_,children:Z,camera:te}){let ne=0;return useFrame(ie=>{(K===1/0||ne<K)&&(te.current.update(ie.gl,ie.scene),ne++)},_),reactExports.createElement(reactExports.Fragment,null,Z)}const Mask=reactExports.forwardRef(({id:K=1,colorWrite:_=!1,depthWrite:Z=!1,...te},ne)=>{const ie=reactExports.useRef(null),oe=reactExports.useMemo(()=>({colorWrite:_,depthWrite:Z,stencilWrite:!0,stencilRef:K,stencilFunc:AlwaysStencilFunc,stencilFail:ReplaceStencilOp,stencilZFail:ReplaceStencilOp,stencilZPass:ReplaceStencilOp}),[K,_,Z]);return reactExports.useLayoutEffect(()=>{Object.assign(ie.current.material,oe)}),reactExports.useImperativeHandle(ne,()=>ie.current,[]),reactExports.createElement("mesh",_extends$3({ref:ie,renderOrder:-K},te))});function useMask(K,_=!1){return{stencilWrite:!0,stencilRef:K,stencilFunc:_?NotEqualStencilFunc:EqualStencilFunc,stencilFail:KeepStencilOp,stencilZFail:KeepStencilOp,stencilZPass:KeepStencilOp}}function Fisheye({renderPriority:K=1,zoom:_=0,segments:Z=64,children:te,resolution:ne=896,...ie}){const oe=reactExports.useRef(null),se=reactExports.useRef(null),{width:ae,height:le}=useThree(me=>me.size),[ce]=reactExports.useState(()=>new OrthographicCamera$1);reactExports.useLayoutEffect(()=>{ce.position.set(0,0,100),ce.zoom=100,ce.left=ae/-2,ce.right=ae/2,ce.top=le/2,ce.bottom=le/-2,ce.updateProjectionMatrix()},[ae,le]);const fe=Math.sqrt(ae*ae+le*le)/100*(.5+_/2),de=new Vector3,pe=new Sphere$2(new Vector3,fe),he=new Matrix3,ge=reactExports.useCallback((me,Ae,ye)=>{if(Ae.pointer.set(me.offsetX/Ae.size.width*2-1,-(me.offsetY/Ae.size.height)*2+1),Ae.raycaster.setFromCamera(Ae.pointer,ce),Ae.raycaster.ray.intersectSphere(pe,de))de.normalize();else return;he.getNormalMatrix(se.current.camera.matrixWorld),se.current.camera.getWorldPosition(Ae.raycaster.ray.origin),Ae.raycaster.ray.direction.set(0,0,1).reflect(de),Ae.raycaster.ray.direction.x*=-1,Ae.raycaster.ray.direction.applyNormalMatrix(he).multiplyScalar(-1)},[]);return useFrame(me=>{K&&me.gl.render(oe.current,ce)},K),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("mesh",_extends$3({ref:oe},ie,{scale:fe}),reactExports.createElement("sphereGeometry",{args:[1,Z,Z]}),reactExports.createElement("meshBasicMaterial",null,reactExports.createElement(RenderCubeTexture,{compute:ge,attach:"envMap",flip:!0,resolution:ne,ref:se},te,reactExports.createElement(UpdateCubeCamera,{api:se})))))}function UpdateCubeCamera({api:K}){const _=new Vector3,Z=new Quaternion,te=new Vector3,ne=new Euler(0,Math.PI,0);return useFrame(ie=>{ie.camera.matrixWorld.decompose(_,Z,te),K.current.camera.position.copy(_),K.current.camera.quaternion.setFromEuler(ne).premultiply(Z)}),null}const PortalMaterialImpl=shaderMaterial({blur:0,map:null,sdf:null,blend:0,size:0,resolution:new Vector2},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
     vUv = uv;
   }`,`uniform sampler2D sdf;
   uniform sampler2D map;
   uniform float blur;
   uniform float size;
   uniform float time;
   uniform vec2 resolution;
   varying vec2 vUv;
   #include <packing>
   void main() {
     vec2 uv = gl_FragCoord.xy / resolution.xy;
     vec4 t = texture2D(map, uv);
     float k = blur;
     float d = texture2D(sdf, vUv).r/size;
     float alpha = 1.0 - smoothstep(0.0, 1.0, clamp(d/k + 1.0, 0.0, 1.0));
     gl_FragColor = vec4(t.rgb, blur == 0.0 ? t.a : t.a * alpha);
     #include <tonemapping_fragment>
     #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),MeshPortalMaterial=reactExports.forwardRef(({children:K,events:_=void 0,blur:Z=0,eventPriority:te=0,renderPriority:ne=0,worldUnits:ie=!1,resolution:oe=512,...se},ae)=>{extend$6({PortalMaterialImpl});const le=reactExports.useRef(null),{scene:ce,gl:fe,size:de,viewport:pe,setEvents:he}=useThree(),ge=useFBO(oe,oe),[me,Ae]=reactExports.useState(0);useFrame(()=>{const be=le.current.blend>0?Math.max(1,ne):0;me!==be&&Ae(be)}),reactExports.useEffect(()=>{_!==void 0&&he({enabled:!_})},[_]);const[ye,ve]=reactExports.useState(!0),_e=useIntersect(ve);reactExports.useLayoutEffect(()=>{var be;_e.current=(be=le.current)==null||(be=be.__r3f.parent)==null?void 0:be.object},[]),reactExports.useLayoutEffect(()=>{if(_e.current&&Z&&le.current.sdf===null){const be=new Mesh(_e.current.geometry,new MeshBasicMaterial),Re=new Box3().setFromBufferAttribute(be.geometry.attributes.position),we=new OrthographicCamera$1(Re.min.x*(1+2/oe),Re.max.x*(1+2/oe),Re.max.y*(1+2/oe),Re.min.y*(1+2/oe),.1,1e3);we.position.set(0,0,1),we.lookAt(0,0,0),fe.setRenderTarget(ge),fe.render(be,we);const Ie=makeSDFGenerator(oe,oe,fe)(ge.texture),$e=new Float32Array(oe*oe);fe.readRenderTargetPixels(Ie,0,0,oe,oe,$e);let Ue=1/0;for(let ke=0;ke<$e.length;ke++)$e[ke]<Ue&&(Ue=$e[ke]);Ue=-Ue,le.current.size=Ue,le.current.sdf=Ie.texture,fe.setRenderTarget(null)}},[oe,Z]),reactExports.useImperativeHandle(ae,()=>le.current);const Te=reactExports.useCallback((be,Re,we)=>{var Pe;if(!_e.current)return!1;if(Re.pointer.set(be.offsetX/Re.size.width*2-1,-(be.offsetY/Re.size.height)*2+1),Re.raycaster.setFromCamera(Re.pointer,Re.camera),((Pe=le.current)==null?void 0:Pe.blend)===0){const[Ie]=Re.raycaster.intersectObject(_e.current);if(!Ie)return Re.raycaster.camera=void 0,!1}},[]);return reactExports.createElement("portalMaterialImpl",_extends$3({ref:le,blur:Z,blend:0,resolution:[de.width*pe.dpr,de.height*pe.dpr],attach:"material"},se),reactExports.createElement(RenderTexture,{attach:"map",frames:ye?1/0:0,eventPriority:te,renderPriority:ne,compute:Te},K,reactExports.createElement(ManagePortalScene,{events:_,rootScene:ce,priority:me,material:le,worldUnits:ie})))});function ManagePortalScene({events:K=void 0,rootScene:_,material:Z,priority:te,worldUnits:ne}){const ie=useThree(fe=>fe.scene),oe=useThree(fe=>fe.setEvents),se=useFBO(),ae=useFBO();reactExports.useLayoutEffect(()=>{ie.matrixAutoUpdate=!1},[]),reactExports.useEffect(()=>{K!==void 0&&oe({enabled:K})},[K]);const[le,ce]=reactExports.useMemo(()=>{const fe={value:0};return[new FullScreenQuad$1(new ShaderMaterial({uniforms:{a:{value:se.texture},b:{value:ae.texture},blend:fe},vertexShader:`
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          }`,fragmentShader:`
          uniform sampler2D a;
          uniform sampler2D b;
          uniform float blend;
          varying vec2 vUv;
          #include <packing>
          void main() {
            vec4 ta = texture2D(a, vUv);
            vec4 tb = texture2D(b, vUv);
            gl_FragColor = mix(tb, ta, blend);
            #include <tonemapping_fragment>
            #include <${version$3>=154?"colorspace_fragment":"encodings_fragment"}>
          }`})),fe]},[]);return useFrame(fe=>{var de;let pe=Z==null||(de=Z.current)==null||(de=de.__r3f.parent)==null?void 0:de.object;if(pe){if(ne)ie.matrixWorld.identity();else{var he;te&&((he=Z.current)==null?void 0:he.blend)===1&&pe.updateWorldMatrix(!0,!1),ie.matrixWorld.copy(pe.matrixWorld)}if(te){var ge,me,Ae;((ge=Z.current)==null?void 0:ge.blend)>0&&((me=Z.current)==null?void 0:me.blend)<1?(ce.value=Z.current.blend,fe.gl.setRenderTarget(se),fe.gl.render(ie,fe.camera),fe.gl.setRenderTarget(ae),fe.gl.render(_,fe.camera),fe.gl.setRenderTarget(null),le.render(fe.gl)):((Ae=Z.current)==null?void 0:Ae.blend)===1&&fe.gl.render(ie,fe.camera)}}},te),reactExports.createElement(reactExports.Fragment,null)}const makeSDFGenerator=(K,_,Z)=>{let te=new WebGLRenderTarget(K,_,{minFilter:LinearMipmapLinearFilter,magFilter:LinearFilter,type:FloatType,format:RedFormat,generateMipmaps:!0}),ne=new WebGLRenderTarget(K,_,{minFilter:NearestFilter,magFilter:NearestFilter}),ie=new WebGLRenderTarget(K,_,{minFilter:NearestFilter,magFilter:NearestFilter}),oe=new WebGLRenderTarget(K,_,{minFilter:NearestFilter,magFilter:NearestFilter}),se=new WebGLRenderTarget(K,_,{minFilter:NearestFilter,magFilter:NearestFilter}),ae=new WebGLRenderTarget(K,_,{minFilter:NearestFilter,magFilter:NearestFilter,type:FloatType,format:RedFormat}),le=new WebGLRenderTarget(K,_,{minFilter:NearestFilter,magFilter:NearestFilter,type:FloatType,format:RedFormat});const ce=new FullScreenQuad$1(new ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        uniform sampler2D tex;
        varying vec2 vUv;
        #include <packing>
        void main() {
          gl_FragColor = pack2HalfToRGBA(vUv * (round(texture2D(tex, vUv).x)));
        }`})),fe=new FullScreenQuad$1(new ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        uniform sampler2D tex;
        varying vec2 vUv;
        #include <packing>
        void main() {
          gl_FragColor = pack2HalfToRGBA(vUv * (1.0 - round(texture2D(tex, vUv).x)));
        }`})),de=new FullScreenQuad$1(new ShaderMaterial({uniforms:{tex:{value:null},offset:{value:0},level:{value:0},maxSteps:{value:0}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D tex;
        uniform float offset;
        uniform float level;
        uniform float maxSteps;
        #include <packing>
        void main() {
          float closestDist = 9999999.9;
          vec2 closestPos = vec2(0.0);
          for (float x = -1.0; x <= 1.0; x += 1.0) {
            for (float y = -1.0; y <= 1.0; y += 1.0) {
              vec2 voffset = vUv;
              voffset += vec2(x, y) * vec2(${1/K}, ${1/_}) * offset;
              vec2 pos = unpackRGBATo2Half(texture2D(tex, voffset));
              float dist = distance(pos.xy, vUv);
              if(pos.x != 0.0 && pos.y != 0.0 && dist < closestDist) {
                closestDist = dist;
                closestPos = pos;
              }
            }
          }
          gl_FragColor = pack2HalfToRGBA(closestPos);
        }`})),pe=new FullScreenQuad$1(new ShaderMaterial({uniforms:{tex:{value:null},size:{value:new Vector2(K,_)}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D tex;
        uniform vec2 size;
        #include <packing>
        void main() {
          gl_FragColor = vec4(distance(size * unpackRGBATo2Half(texture2D(tex, vUv)), size * vUv), 0.0, 0.0, 0.0);
        }`})),he=new FullScreenQuad$1(new ShaderMaterial({uniforms:{inside:{value:le.texture},outside:{value:ae.texture},tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D inside;
        uniform sampler2D outside;
        uniform sampler2D tex;
        #include <packing>
        void main() {
          float i = texture2D(inside, vUv).x;
          float o =texture2D(outside, vUv).x;
          if (texture2D(tex, vUv).x == 0.0) {
            gl_FragColor = vec4(o, 0.0, 0.0, 0.0);
          } else {
            gl_FragColor = vec4(-i, 0.0, 0.0, 0.0);
          }
        }`}));return ge=>{let me=te;ge.minFilter=NearestFilter,ge.magFilter=NearestFilter,ce.material.uniforms.tex.value=ge,Z.setRenderTarget(ne),ce.render(Z);const Ae=Math.ceil(Math.log(Math.max(K,_))/Math.log(2));let ye=ne,ve=null;for(let _e=0;_e<Ae;_e++){const Te=Math.pow(2,Ae-_e-1);ve=ye===ne?oe:ne,de.material.uniforms.level.value=_e,de.material.uniforms.maxSteps.value=Ae,de.material.uniforms.offset.value=Te,de.material.uniforms.tex.value=ye.texture,Z.setRenderTarget(ve),de.render(Z),ye=ve}Z.setRenderTarget(ae),pe.material.uniforms.tex.value=ve.texture,pe.render(Z),fe.material.uniforms.tex.value=ge,Z.setRenderTarget(ie),fe.render(Z),ye=ie;for(let _e=0;_e<Ae;_e++){const Te=Math.pow(2,Ae-_e-1);ve=ye===ie?se:ie,de.material.uniforms.level.value=_e,de.material.uniforms.maxSteps.value=Ae,de.material.uniforms.offset.value=Te,de.material.uniforms.tex.value=ye.texture,Z.setRenderTarget(ve),de.render(Z),ye=ve}return Z.setRenderTarget(le),pe.material.uniforms.tex.value=ve.texture,pe.render(Z),Z.setRenderTarget(me),he.material.uniforms.tex.value=ge,he.render(Z),Z.setRenderTarget(null),me}},__vite_import_meta_env__$4={},createStoreImpl$3=K=>{let _;const Z=new Set,te=(ce,fe)=>{const de=typeof ce=="function"?ce(_):ce;if(!Object.is(de,_)){const pe=_;_=fe??(typeof de!="object"||de===null)?de:Object.assign({},_,de),Z.forEach(he=>he(_,pe))}},ne=()=>_,ae={setState:te,getState:ne,getInitialState:()=>le,subscribe:ce=>(Z.add(ce),()=>Z.delete(ce)),destroy:()=>{(__vite_import_meta_env__$4?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),Z.clear()}},le=_=K(te,ne,ae);return ae},createStore$4=K=>K?createStoreImpl$3(K):createStoreImpl$3;var withSelector$1={exports:{}},withSelector_production$1={},shim$1={exports:{}},useSyncExternalStoreShim_production$1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production$1;function requireUseSyncExternalStoreShim_production$1(){if(hasRequiredUseSyncExternalStoreShim_production$1)return useSyncExternalStoreShim_production$1;hasRequiredUseSyncExternalStoreShim_production$1=1;var K=reactExports;function _(fe,de){return fe===de&&(fe!==0||1/fe===1/de)||fe!==fe&&de!==de}var Z=typeof Object.is=="function"?Object.is:_,te=K.useState,ne=K.useEffect,ie=K.useLayoutEffect,oe=K.useDebugValue;function se(fe,de){var pe=de(),he=te({inst:{value:pe,getSnapshot:de}}),ge=he[0].inst,me=he[1];return ie(function(){ge.value=pe,ge.getSnapshot=de,ae(ge)&&me({inst:ge})},[fe,pe,de]),ne(function(){return ae(ge)&&me({inst:ge}),fe(function(){ae(ge)&&me({inst:ge})})},[fe]),oe(pe),pe}function ae(fe){var de=fe.getSnapshot;fe=fe.value;try{var pe=de();return!Z(fe,pe)}catch{return!0}}function le(fe,de){return de()}var ce=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?le:se;return useSyncExternalStoreShim_production$1.useSyncExternalStore=K.useSyncExternalStore!==void 0?K.useSyncExternalStore:ce,useSyncExternalStoreShim_production$1}var hasRequiredShim$1;function requireShim$1(){return hasRequiredShim$1||(hasRequiredShim$1=1,shim$1.exports=requireUseSyncExternalStoreShim_production$1()),shim$1.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production$1;function requireWithSelector_production$1(){if(hasRequiredWithSelector_production$1)return withSelector_production$1;hasRequiredWithSelector_production$1=1;var K=reactExports,_=requireShim$1();function Z(le,ce){return le===ce&&(le!==0||1/le===1/ce)||le!==le&&ce!==ce}var te=typeof Object.is=="function"?Object.is:Z,ne=_.useSyncExternalStore,ie=K.useRef,oe=K.useEffect,se=K.useMemo,ae=K.useDebugValue;return withSelector_production$1.useSyncExternalStoreWithSelector=function(le,ce,fe,de,pe){var he=ie(null);if(he.current===null){var ge={hasValue:!1,value:null};he.current=ge}else ge=he.current;he=se(function(){function Ae(be){if(!ye){if(ye=!0,ve=be,be=de(be),pe!==void 0&&ge.hasValue){var Re=ge.value;if(pe(Re,be))return _e=Re}return _e=be}if(Re=_e,te(ve,be))return Re;var we=de(be);return pe!==void 0&&pe(Re,we)?(ve=be,Re):(ve=be,_e=we)}var ye=!1,ve,_e,Te=fe===void 0?null:fe;return[function(){return Ae(ce())},Te===null?void 0:function(){return Ae(Te())}]},[ce,fe,de,pe]);var me=ne(le,he[0],he[1]);return oe(function(){ge.hasValue=!0,ge.value=me},[me]),ae(me),me},withSelector_production$1}withSelector$1.exports=requireWithSelector_production$1();var withSelectorExports$1=withSelector$1.exports;const useSyncExternalStoreExports$1=getDefaultExportFromCjs$1(withSelectorExports$1),__vite_import_meta_env__$3={},{useDebugValue:useDebugValue$1}=React,{useSyncExternalStoreWithSelector:useSyncExternalStoreWithSelector$2}=useSyncExternalStoreExports$1;let didWarnAboutEqualityFn$1=!1;const identity$5=K=>K;function useStore$1(K,_=identity$5,Z){(__vite_import_meta_env__$3?"production":void 0)!=="production"&&Z&&!didWarnAboutEqualityFn$1&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn$1=!0);const te=useSyncExternalStoreWithSelector$2(K.subscribe,K.getState,K.getServerState||K.getInitialState,_,Z);return useDebugValue$1(te),te}const createImpl$1=K=>{(__vite_import_meta_env__$3?"production":void 0)!=="production"&&typeof K!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const _=typeof K=="function"?createStore$4(K):K,Z=(te,ne)=>useStore$1(_,te,ne);return Object.assign(Z,_),Z},create$b=K=>K?createImpl$1(K):createImpl$1;var _window$document,_window$navigator;const useIsomorphicLayoutEffect$1=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?React.useLayoutEffect:React.useEffect;function tunnel(){const K=create$b(_=>({current:new Array,version:0,set:_}));return{In:({children:_})=>{const Z=K(ne=>ne.set),te=K(ne=>ne.version);return useIsomorphicLayoutEffect$1(()=>{Z(ne=>({version:ne.version+1}))},[]),useIsomorphicLayoutEffect$1(()=>(Z(({current:ne})=>({current:[...ne,_]})),()=>Z(({current:ne})=>({current:ne.filter(ie=>ie!==_)}))),[_,te]),null},Out:()=>{const _=K(Z=>Z.current);return React.createElement(React.Fragment,null,_)}}}const isOrthographicCamera=K=>K&&K.isOrthographicCamera,col=new Color$1,tracked=tunnel();function computeContainerPosition(K,_){const{right:Z,top:te,left:ne,bottom:ie,width:oe,height:se}=_,ae=_.bottom<0||te>K.height||Z<0||_.left>K.width,ce=K.top+K.height-ie,fe=ne-K.left;return{position:{width:oe,height:se,left:fe,top:te,bottom:ce,right:Z},isOffscreen:ae}}function prepareSkissor(K,{left:_,bottom:Z,width:te,height:ne}){let ie;const oe=te/ne;return isOrthographicCamera(K.camera)?K.camera.manual?K.camera.updateProjectionMatrix():(K.camera.left!==te/-2||K.camera.right!==te/2||K.camera.top!==ne/2||K.camera.bottom!==ne/-2)&&(Object.assign(K.camera,{left:te/-2,right:te/2,top:ne/2,bottom:ne/-2}),K.camera.updateProjectionMatrix()):K.camera.aspect!==oe&&(K.camera.aspect=oe,K.camera.updateProjectionMatrix()),ie=K.gl.autoClear,K.gl.autoClear=!1,K.gl.setViewport(_,Z,te,ne),K.gl.setScissor(_,Z,te,ne),K.gl.setScissorTest(!0),ie}function finishSkissor(K,_){K.gl.setScissorTest(!1),K.gl.autoClear=_}function clear(K){K.gl.getClearColor(col),K.gl.setClearColor(col,K.gl.getClearAlpha()),K.gl.clear(!0,!0)}function Container$3({visible:K=!0,canvasSize:_,scene:Z,index:te,children:ne,frames:ie,rect:oe,track:se}){const ae=useThree(),[le,ce]=reactExports.useState(!1);let fe=0;return useFrame(de=>{if(ie===1/0||fe<=ie){var pe;se&&(oe.current=(pe=se.current)==null?void 0:pe.getBoundingClientRect()),fe++}if(oe.current){const{position:he,isOffscreen:ge}=computeContainerPosition(_,oe.current);if(le!==ge&&ce(ge),K&&!le&&oe.current){const me=prepareSkissor(de,he);de.gl.render(ne?de.scene:Z,de.camera),finishSkissor(de,me)}}},te),reactExports.useLayoutEffect(()=>{const de=oe.current;if(de&&(!K||!le)){const{position:pe}=computeContainerPosition(_,de),he=prepareSkissor(ae,pe);clear(ae),finishSkissor(ae,he)}},[K,le]),reactExports.useEffect(()=>{if(!se)return;const de=oe.current,pe=ae.get().events.connected;return ae.setEvents({connected:se.current}),()=>{if(de){const{position:he}=computeContainerPosition(_,de),ge=prepareSkissor(ae,he);clear(ae),finishSkissor(ae,ge)}ae.setEvents({connected:pe})}},[se]),reactExports.createElement(reactExports.Fragment,null,ne,reactExports.createElement("group",{onPointerOver:()=>null}))}const CanvasView=reactExports.forwardRef(({track:K,visible:_=!0,index:Z=1,id:te,style:ne,className:ie,frames:oe=1/0,children:se,...ae},le)=>{var ce,fe,de,pe;const he=reactExports.useRef(null),{size:ge,scene:me}=useThree(),[Ae]=reactExports.useState(()=>new Scene$1),[ye,ve]=reactExports.useReducer(()=>!0,!1),_e=reactExports.useCallback((Te,be)=>{if(he.current&&K&&K.current&&Te.target===K.current){const{width:Re,height:we,left:Pe,top:Ie}=he.current,$e=Te.clientX-Pe,Ue=Te.clientY-Ie;be.pointer.set($e/Re*2-1,-(Ue/we)*2+1),be.raycaster.setFromCamera(be.pointer,be.camera)}},[he,K]);return reactExports.useEffect(()=>{var Te;K&&(he.current=(Te=K.current)==null?void 0:Te.getBoundingClientRect()),ve()},[K]),reactExports.createElement("group",_extends$3({ref:le},ae),ye&&createPortal(reactExports.createElement(Container$3,{visible:_,canvasSize:ge,frames:oe,scene:me,track:K,rect:he,index:Z},se),Ae,{events:{compute:_e,priority:Z},size:{width:(ce=he.current)==null?void 0:ce.width,height:(fe=he.current)==null?void 0:fe.height,top:(de=he.current)==null?void 0:de.top,left:(pe=he.current)==null?void 0:pe.left}}))}),HtmlView=reactExports.forwardRef(({as:K="div",id:_,visible:Z,className:te,style:ne,index:ie=1,track:oe,frames:se=1/0,children:ae,...le},ce)=>{const fe=reactExports.useId(),de=reactExports.useRef(null);return reactExports.useImperativeHandle(ce,()=>de.current),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(K,_extends$3({ref:de,id:_,className:te,style:ne},le)),reactExports.createElement(tracked.In,null,reactExports.createElement(CanvasView,{visible:Z,key:fe,track:de,frames:se,index:ie},ae)))}),View=(()=>{const K=reactExports.forwardRef((_,Z)=>reactExports.useContext(context$8)?reactExports.createElement(CanvasView,_extends$3({ref:Z},_)):reactExports.createElement(HtmlView,_extends$3({ref:Z},_)));return K.Port=()=>reactExports.createElement(tracked.Out,null),K})(),context=reactExports.createContext(null),vec1$1=new Vector3,vec2$1=new Vector3,calculateOffset$1=(K,_,Z,te)=>{const ne=_.dot(_),ie=_.dot(K)-_.dot(Z),oe=_.dot(te);return oe===0?-ie/ne:(vec1$1.copy(te).multiplyScalar(ne/oe).sub(_),vec2$1.copy(te).multiplyScalar(ie/oe).add(Z).sub(K),-vec1$1.dot(vec2$1)/vec1$1.dot(vec1$1))},upV$1=new Vector3(0,1,0),offsetMatrix$1=new Matrix4,AxisArrow=({direction:K,axis:_})=>{const{translation:Z,translationLimits:te,annotations:ne,annotationsClass:ie,depthTest:oe,scale:se,lineWidth:ae,fixed:le,axisColors:ce,hoveredColor:fe,opacity:de,onDragStart:pe,onDrag:he,onDragEnd:ge,userData:me}=reactExports.useContext(context),Ae=useThree(Ke=>Ke.controls),ye=reactExports.useRef(null),ve=reactExports.useRef(null),_e=reactExports.useRef(null),Te=reactExports.useRef(0),[be,Re]=reactExports.useState(!1),we=reactExports.useCallback(Ke=>{ne&&(ye.current.innerText=`${Z.current[_].toFixed(2)}`,ye.current.style.display="block"),Ke.stopPropagation();const tt=new Matrix4().extractRotation(ve.current.matrixWorld),Je=Ke.point.clone(),ot=new Vector3().setFromMatrixPosition(ve.current.matrixWorld),Fe=K.clone().applyMatrix4(tt).normalize();_e.current={clickPoint:Je,dir:Fe},Te.current=Z.current[_],pe({component:"Arrow",axis:_,origin:ot,directions:[Fe]}),Ae&&(Ae.enabled=!1),Ke.target.setPointerCapture(Ke.pointerId)},[ne,K,Ae,pe,Z,_]),Pe=reactExports.useCallback(Ke=>{if(Ke.stopPropagation(),be||Re(!0),_e.current){const{clickPoint:tt,dir:Je}=_e.current,[ot,Fe]=(te==null?void 0:te[_])||[void 0,void 0];let ct=calculateOffset$1(tt,Je,Ke.ray.origin,Ke.ray.direction);ot!==void 0&&(ct=Math.max(ct,ot-Te.current)),Fe!==void 0&&(ct=Math.min(ct,Fe-Te.current)),Z.current[_]=Te.current+ct,ne&&(ye.current.innerText=`${Z.current[_].toFixed(2)}`),offsetMatrix$1.makeTranslation(Je.x*ct,Je.y*ct,Je.z*ct),he(offsetMatrix$1)}},[ne,he,be,Z,te,_]),Ie=reactExports.useCallback(Ke=>{ne&&(ye.current.style.display="none"),Ke.stopPropagation(),_e.current=null,ge(),Ae&&(Ae.enabled=!0),Ke.target.releasePointerCapture(Ke.pointerId)},[ne,Ae,ge]),$e=reactExports.useCallback(Ke=>{Ke.stopPropagation(),Re(!1)},[]),{cylinderLength:Ue,coneWidth:ke,coneLength:Ge,matrixL:He}=reactExports.useMemo(()=>{const Ke=le?ae/se*1.6:se/20,tt=le?.2:se/5,Je=le?1-tt:se-tt,ot=new Quaternion().setFromUnitVectors(upV$1,K.clone().normalize()),Fe=new Matrix4().makeRotationFromQuaternion(ot);return{cylinderLength:Je,coneWidth:Ke,coneLength:tt,matrixL:Fe}},[K,se,ae,le]),ze=be?fe:ce[_];return reactExports.createElement("group",{ref:ve},reactExports.createElement("group",{matrix:He,matrixAutoUpdate:!1,onPointerDown:we,onPointerMove:Pe,onPointerUp:Ie,onPointerOut:$e},ne&&reactExports.createElement(Html,{position:[0,-Ge,0]},reactExports.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:ie,ref:ye})),reactExports.createElement("mesh",{visible:!1,position:[0,(Ue+Ge)/2,0],userData:me},reactExports.createElement("cylinderGeometry",{args:[ke*1.4,ke*1.4,Ue+Ge,8,1]})),reactExports.createElement(Line$1,{transparent:!0,raycast:()=>null,depthTest:oe,points:[0,0,0,0,Ue,0],lineWidth:ae,side:DoubleSide,color:ze,opacity:de,polygonOffset:!0,renderOrder:1,polygonOffsetFactor:-10,fog:!1}),reactExports.createElement("mesh",{raycast:()=>null,position:[0,Ue+Ge/2,0],renderOrder:500},reactExports.createElement("coneGeometry",{args:[ke,Ge,24,1]}),reactExports.createElement("meshBasicMaterial",{transparent:!0,depthTest:oe,color:ze,opacity:de,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},clickDir=new Vector3,intersectionDir=new Vector3,toDegrees=K=>K*180/Math.PI,toRadians=K=>K*Math.PI/180,calculateAngle=(K,_,Z,te,ne)=>{clickDir.copy(K).sub(Z),intersectionDir.copy(_).sub(Z);const ie=te.dot(te),oe=ne.dot(ne),se=clickDir.dot(te)/ie,ae=clickDir.dot(ne)/oe,le=intersectionDir.dot(te)/ie,ce=intersectionDir.dot(ne)/oe,fe=Math.atan2(ae,se);return Math.atan2(ce,le)-fe},fmod=(K,_)=>{let Z=Math.floor(K/_);return Z=Z<0?Z+1:Z,K-Z*_},minimizeAngle=K=>{let _=fmod(K,2*Math.PI);return Math.abs(_)<1e-6?0:(_<0&&(_+=2*Math.PI),_)},rotMatrix=new Matrix4,posNew=new Vector3,ray$2=new Ray,intersection$1=new Vector3,AxisRotator=({dir1:K,dir2:_,axis:Z})=>{const{rotationLimits:te,annotations:ne,annotationsClass:ie,depthTest:oe,scale:se,lineWidth:ae,fixed:le,axisColors:ce,hoveredColor:fe,opacity:de,onDragStart:pe,onDrag:he,onDragEnd:ge,userData:me}=reactExports.useContext(context),Ae=useThree(ze=>ze.controls),ye=reactExports.useRef(null),ve=reactExports.useRef(null),_e=reactExports.useRef(0),Te=reactExports.useRef(0),be=reactExports.useRef(null),[Re,we]=reactExports.useState(!1),Pe=reactExports.useCallback(ze=>{ne&&(ye.current.innerText=`${toDegrees(Te.current).toFixed(0)}º`,ye.current.style.display="block"),ze.stopPropagation();const Ke=ze.point.clone(),tt=new Vector3().setFromMatrixPosition(ve.current.matrixWorld),Je=new Vector3().setFromMatrixColumn(ve.current.matrixWorld,0).normalize(),ot=new Vector3().setFromMatrixColumn(ve.current.matrixWorld,1).normalize(),Fe=new Vector3().setFromMatrixColumn(ve.current.matrixWorld,2).normalize(),ct=new Plane$2().setFromNormalAndCoplanarPoint(Fe,tt);be.current={clickPoint:Ke,origin:tt,e1:Je,e2:ot,normal:Fe,plane:ct},pe({component:"Rotator",axis:Z,origin:tt,directions:[Je,ot,Fe]}),Ae&&(Ae.enabled=!1),ze.target.setPointerCapture(ze.pointerId)},[ne,Ae,pe,Z]),Ie=reactExports.useCallback(ze=>{if(ze.stopPropagation(),Re||we(!0),be.current){const{clickPoint:Ke,origin:tt,e1:Je,e2:ot,normal:Fe,plane:ct}=be.current,[ht,lt]=(te==null?void 0:te[Z])||[void 0,void 0];ray$2.copy(ze.ray),ray$2.intersectPlane(ct,intersection$1),ray$2.direction.negate(),ray$2.intersectPlane(ct,intersection$1);let Qe=calculateAngle(Ke,intersection$1,tt,Je,ot),Ze=toDegrees(Qe);ze.shiftKey&&(Ze=Math.round(Ze/10)*10,Qe=toRadians(Ze)),ht!==void 0&&lt!==void 0&&lt-ht<2*Math.PI?(Qe=minimizeAngle(Qe),Qe=Qe>Math.PI?Qe-2*Math.PI:Qe,Qe=MathUtils.clamp(Qe,ht-_e.current,lt-_e.current),Te.current=_e.current+Qe):(Te.current=minimizeAngle(_e.current+Qe),Te.current=Te.current>Math.PI?Te.current-2*Math.PI:Te.current),ne&&(Ze=toDegrees(Te.current),ye.current.innerText=`${Ze.toFixed(0)}º`),rotMatrix.makeRotationAxis(Fe,Qe),posNew.copy(tt).applyMatrix4(rotMatrix).sub(tt).negate(),rotMatrix.setPosition(posNew),he(rotMatrix)}},[ne,he,Re,te,Z]),$e=reactExports.useCallback(ze=>{ne&&(ye.current.style.display="none"),ze.stopPropagation(),_e.current=Te.current,be.current=null,ge(),Ae&&(Ae.enabled=!0),ze.target.releasePointerCapture(ze.pointerId)},[ne,Ae,ge]),Ue=reactExports.useCallback(ze=>{ze.stopPropagation(),we(!1)},[]),ke=reactExports.useMemo(()=>{const ze=K.clone().normalize(),Ke=_.clone().normalize();return new Matrix4().makeBasis(ze,Ke,ze.clone().cross(Ke))},[K,_]),Ge=le?.65:se*.65,He=reactExports.useMemo(()=>{const Ke=[];for(let tt=0;tt<=32;tt++){const Je=tt*(Math.PI/2)/32;Ke.push(new Vector3(Math.cos(Je)*Ge,Math.sin(Je)*Ge,0))}return Ke},[Ge]);return reactExports.createElement("group",{ref:ve,onPointerDown:Pe,onPointerMove:Ie,onPointerUp:$e,onPointerOut:Ue,matrix:ke,matrixAutoUpdate:!1},ne&&reactExports.createElement(Html,{position:[Ge,Ge,0]},reactExports.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:ie,ref:ye})),reactExports.createElement(Line$1,{points:He,lineWidth:ae*4,visible:!1,userData:me}),reactExports.createElement(Line$1,{transparent:!0,raycast:()=>null,depthTest:oe,points:He,lineWidth:ae,side:DoubleSide,color:Re?fe:ce[Z],opacity:de,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))},decomposeIntoBasis=(K,_,Z)=>{const te=Math.abs(K.x)>=Math.abs(K.y)&&Math.abs(K.x)>=Math.abs(K.z)?0:Math.abs(K.y)>=Math.abs(K.x)&&Math.abs(K.y)>=Math.abs(K.z)?1:2,ne=[0,1,2].sort((he,ge)=>Math.abs(_.getComponent(ge))-Math.abs(_.getComponent(he))),ie=te===ne[0]?ne[1]:ne[0],oe=K.getComponent(te),se=K.getComponent(ie),ae=_.getComponent(te),le=_.getComponent(ie),ce=Z.getComponent(te),de=(Z.getComponent(ie)-ce*(se/oe))/(le-ae*(se/oe));return[(ce-de*ae)/oe,de]},ray$1=new Ray,intersection=new Vector3,offsetMatrix=new Matrix4,PlaneSlider=({dir1:K,dir2:_,axis:Z})=>{const{translation:te,translationLimits:ne,annotations:ie,annotationsClass:oe,depthTest:se,scale:ae,lineWidth:le,fixed:ce,axisColors:fe,hoveredColor:de,opacity:pe,onDragStart:he,onDrag:ge,onDragEnd:me,userData:Ae}=reactExports.useContext(context),ye=useThree(Je=>Je.controls),ve=reactExports.useRef(null),_e=reactExports.useRef(null),Te=reactExports.useRef(null),be=reactExports.useRef(0),Re=reactExports.useRef(0),[we,Pe]=reactExports.useState(!1),Ie=reactExports.useCallback(Je=>{ie&&(ve.current.innerText=`${te.current[(Z+1)%3].toFixed(2)}, ${te.current[(Z+2)%3].toFixed(2)}`,ve.current.style.display="block"),Je.stopPropagation();const ot=Je.point.clone(),Fe=new Vector3().setFromMatrixPosition(_e.current.matrixWorld),ct=new Vector3().setFromMatrixColumn(_e.current.matrixWorld,0).normalize(),ht=new Vector3().setFromMatrixColumn(_e.current.matrixWorld,1).normalize(),lt=new Vector3().setFromMatrixColumn(_e.current.matrixWorld,2).normalize(),Qe=new Plane$2().setFromNormalAndCoplanarPoint(lt,Fe);Te.current={clickPoint:ot,e1:ct,e2:ht,plane:Qe},be.current=te.current[(Z+1)%3],Re.current=te.current[(Z+2)%3],he({component:"Slider",axis:Z,origin:Fe,directions:[ct,ht,lt]}),ye&&(ye.enabled=!1),Je.target.setPointerCapture(Je.pointerId)},[ie,ye,he,Z]),$e=reactExports.useCallback(Je=>{if(Je.stopPropagation(),we||Pe(!0),Te.current){const{clickPoint:ot,e1:Fe,e2:ct,plane:ht}=Te.current,[lt,Qe]=(ne==null?void 0:ne[(Z+1)%3])||[void 0,void 0],[Ze,it]=(ne==null?void 0:ne[(Z+2)%3])||[void 0,void 0];ray$1.copy(Je.ray),ray$1.intersectPlane(ht,intersection),ray$1.direction.negate(),ray$1.intersectPlane(ht,intersection),intersection.sub(ot);let[nt,Tt]=decomposeIntoBasis(Fe,ct,intersection);lt!==void 0&&(nt=Math.max(nt,lt-be.current)),Qe!==void 0&&(nt=Math.min(nt,Qe-be.current)),Ze!==void 0&&(Tt=Math.max(Tt,Ze-Re.current)),it!==void 0&&(Tt=Math.min(Tt,it-Re.current)),te.current[(Z+1)%3]=be.current+nt,te.current[(Z+2)%3]=Re.current+Tt,ie&&(ve.current.innerText=`${te.current[(Z+1)%3].toFixed(2)}, ${te.current[(Z+2)%3].toFixed(2)}`),offsetMatrix.makeTranslation(nt*Fe.x+Tt*ct.x,nt*Fe.y+Tt*ct.y,nt*Fe.z+Tt*ct.z),ge(offsetMatrix)}},[ie,ge,we,te,ne,Z]),Ue=reactExports.useCallback(Je=>{ie&&(ve.current.style.display="none"),Je.stopPropagation(),Te.current=null,me(),ye&&(ye.enabled=!0),Je.target.releasePointerCapture(Je.pointerId)},[ie,ye,me]),ke=reactExports.useCallback(Je=>{Je.stopPropagation(),Pe(!1)},[]),Ge=reactExports.useMemo(()=>{const Je=K.clone().normalize(),ot=_.clone().normalize();return new Matrix4().makeBasis(Je,ot,Je.clone().cross(ot))},[K,_]),He=ce?1/7:ae/7,ze=ce?.225:ae*.225,Ke=we?de:fe[Z],tt=reactExports.useMemo(()=>[new Vector3(0,0,0),new Vector3(0,ze,0),new Vector3(ze,ze,0),new Vector3(ze,0,0),new Vector3(0,0,0)],[ze]);return reactExports.createElement("group",{ref:_e,matrix:Ge,matrixAutoUpdate:!1},ie&&reactExports.createElement(Html,{position:[0,0,0]},reactExports.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:oe,ref:ve})),reactExports.createElement("group",{position:[He*1.7,He*1.7,0]},reactExports.createElement("mesh",{visible:!0,onPointerDown:Ie,onPointerMove:$e,onPointerUp:Ue,onPointerOut:ke,scale:ze,userData:Ae},reactExports.createElement("planeGeometry",null),reactExports.createElement("meshBasicMaterial",{transparent:!0,depthTest:se,color:Ke,polygonOffset:!0,polygonOffsetFactor:-10,side:DoubleSide,fog:!1})),reactExports.createElement(Line$1,{position:[-ze/2,-ze/2,0],transparent:!0,depthTest:se,points:tt,lineWidth:le,color:Ke,opacity:pe,polygonOffset:!0,polygonOffsetFactor:-10,userData:Ae,fog:!1})))},vec1=new Vector3,vec2=new Vector3,calculateOffset=(K,_,Z,te)=>{const ne=_.dot(_),ie=_.dot(K)-_.dot(Z),oe=_.dot(te);return oe===0?-ie/ne:(vec1.copy(te).multiplyScalar(ne/oe).sub(_),vec2.copy(te).multiplyScalar(ie/oe).add(Z).sub(K),-vec1.dot(vec2)/vec1.dot(vec1))},upV=new Vector3(0,1,0),scaleV=new Vector3,scaleMatrix=new Matrix4,ScalingSphere=({direction:K,axis:_})=>{const{scaleLimits:Z,annotations:te,annotationsClass:ne,depthTest:ie,scale:oe,lineWidth:se,fixed:ae,axisColors:le,hoveredColor:ce,opacity:fe,onDragStart:de,onDrag:pe,onDragEnd:he,userData:ge}=reactExports.useContext(context),me=useThree(tt=>tt.size),Ae=useThree(tt=>tt.controls),ye=reactExports.useRef(null),ve=reactExports.useRef(null),_e=reactExports.useRef(null),Te=reactExports.useRef(1),be=reactExports.useRef(1),Re=reactExports.useRef(null),[we,Pe]=reactExports.useState(!1),Ie=ae?1.2:1.2*oe,$e=reactExports.useCallback(tt=>{te&&(ye.current.innerText=`${be.current.toFixed(2)}`,ye.current.style.display="block"),tt.stopPropagation();const Je=new Matrix4().extractRotation(ve.current.matrixWorld),ot=tt.point.clone(),Fe=new Vector3().setFromMatrixPosition(ve.current.matrixWorld),ct=K.clone().applyMatrix4(Je).normalize(),ht=ve.current.matrixWorld.clone(),lt=ht.clone().invert(),Qe=ae?1/calculateScaleFactor(ve.current.getWorldPosition(vec1),oe,tt.camera,me):1;Re.current={clickPoint:ot,dir:ct,mPLG:ht,mPLGInv:lt,offsetMultiplier:Qe},de({component:"Sphere",axis:_,origin:Fe,directions:[ct]}),Ae&&(Ae.enabled=!1),tt.target.setPointerCapture(tt.pointerId)},[te,Ae,K,de,_,ae,oe,me]),Ue=reactExports.useCallback(tt=>{if(tt.stopPropagation(),we||Pe(!0),Re.current){const{clickPoint:Je,dir:ot,mPLG:Fe,mPLGInv:ct,offsetMultiplier:ht}=Re.current,[lt,Qe]=(Z==null?void 0:Z[_])||[1e-5,void 0],it=calculateOffset(Je,ot,tt.ray.origin,tt.ray.direction)*ht,nt=ae?it:it/oe;let Tt=Math.pow(2,nt*.2);tt.shiftKey&&(Tt=Math.round(Tt*10)/10),Tt=Math.max(Tt,lt/Te.current),Qe!==void 0&&(Tt=Math.min(Tt,Qe/Te.current)),be.current=Te.current*Tt,_e.current.position.set(0,Ie+it,0),te&&(ye.current.innerText=`${be.current.toFixed(2)}`),scaleV.set(1,1,1),scaleV.setComponent(_,Tt),scaleMatrix.makeScale(scaleV.x,scaleV.y,scaleV.z).premultiply(Fe).multiply(ct),pe(scaleMatrix)}},[te,Ie,pe,we,Z,_]),ke=reactExports.useCallback(tt=>{te&&(ye.current.style.display="none"),tt.stopPropagation(),Te.current=be.current,Re.current=null,_e.current.position.set(0,Ie,0),he(),Ae&&(Ae.enabled=!0),tt.target.releasePointerCapture(tt.pointerId)},[te,Ae,he,Ie]),Ge=reactExports.useCallback(tt=>{tt.stopPropagation(),Pe(!1)},[]),{radius:He,matrixL:ze}=reactExports.useMemo(()=>{const tt=ae?se/oe*1.8:oe/22.5,Je=new Quaternion().setFromUnitVectors(upV,K.clone().normalize()),ot=new Matrix4().makeRotationFromQuaternion(Je);return{radius:tt,matrixL:ot}},[K,oe,se,ae]),Ke=we?ce:le[_];return reactExports.createElement("group",{ref:ve},reactExports.createElement("group",{matrix:ze,matrixAutoUpdate:!1,onPointerDown:$e,onPointerMove:Ue,onPointerUp:ke,onPointerOut:Ge},te&&reactExports.createElement(Html,{position:[0,Ie/2,0]},reactExports.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:ne,ref:ye})),reactExports.createElement("mesh",{ref:_e,position:[0,Ie,0],renderOrder:500,userData:ge},reactExports.createElement("sphereGeometry",{args:[He,12,12]}),reactExports.createElement("meshBasicMaterial",{transparent:!0,depthTest:ie,color:Ke,opacity:fe,polygonOffset:!0,polygonOffsetFactor:-10}))))},mL0=new Matrix4,mW0=new Matrix4,mP=new Matrix4,mPInv=new Matrix4,mW=new Matrix4,mL=new Matrix4,mL0Inv=new Matrix4,mdL=new Matrix4,mG=new Matrix4,bb=new Box3,bbObj=new Box3,vCenter=new Vector3,vSize=new Vector3,vAnchorOffset=new Vector3,vPosition=new Vector3,vScale=new Vector3,xDir=new Vector3(1,0,0),yDir=new Vector3(0,1,0),zDir=new Vector3(0,0,1),PivotControls=reactExports.forwardRef(({enabled:K=!0,matrix:_,onDragStart:Z,onDrag:te,onDragEnd:ne,autoTransform:ie=!0,anchor:oe,disableAxes:se=!1,disableSliders:ae=!1,disableRotations:le=!1,disableScaling:ce=!1,activeAxes:fe=[!0,!0,!0],offset:de=[0,0,0],rotation:pe=[0,0,0],scale:he=1,lineWidth:ge=4,fixed:me=!1,translationLimits:Ae,rotationLimits:ye,scaleLimits:ve,depthTest:_e=!0,axisColors:Te=["#ff2060","#20df80","#2080ff"],hoveredColor:be="#ffff40",annotations:Re=!1,annotationsClass:we,opacity:Pe=1,visible:Ie=!0,userData:$e,children:Ue,...ke},Ge)=>{const He=useThree(Qe=>Qe.invalidate),ze=reactExports.useRef(null),Ke=reactExports.useRef(null),tt=reactExports.useRef(null),Je=reactExports.useRef(null),ot=reactExports.useRef([0,0,0]),Fe=reactExports.useRef(new Vector3(1,1,1)),ct=reactExports.useRef(new Vector3(1,1,1));reactExports.useLayoutEffect(()=>{oe&&(Je.current.updateWorldMatrix(!0,!0),mPInv.copy(Je.current.matrixWorld).invert(),bb.makeEmpty(),Je.current.traverse(Qe=>{Qe.geometry&&(Qe.geometry.boundingBox||Qe.geometry.computeBoundingBox(),mL.copy(Qe.matrixWorld).premultiply(mPInv),bbObj.copy(Qe.geometry.boundingBox),bbObj.applyMatrix4(mL),bb.union(bbObj))}),vCenter.copy(bb.max).add(bb.min).multiplyScalar(.5),vSize.copy(bb.max).sub(bb.min).multiplyScalar(.5),vAnchorOffset.copy(vSize).multiply(new Vector3(...oe)).add(vCenter),vPosition.set(...de).add(vAnchorOffset),tt.current.position.copy(vPosition),He())});const ht=reactExports.useMemo(()=>({onDragStart:Qe=>{mL0.copy(Ke.current.matrix),mW0.copy(Ke.current.matrixWorld),Z&&Z(Qe),He()},onDrag:Qe=>{mP.copy(ze.current.matrixWorld),mPInv.copy(mP).invert(),mW.copy(mW0).premultiply(Qe),mL.copy(mW).premultiply(mPInv),mL0Inv.copy(mL0).invert(),mdL.copy(mL).multiply(mL0Inv),ie&&Ke.current.matrix.copy(mL),te&&te(mL,mdL,mW,Qe),He()},onDragEnd:()=>{ne&&ne(),He()},translation:ot,translationLimits:Ae,rotationLimits:ye,axisColors:Te,hoveredColor:be,opacity:Pe,scale:he,lineWidth:ge,fixed:me,depthTest:_e,userData:$e,annotations:Re,annotationsClass:we}),[Z,te,ne,ot,Ae,ye,ve,_e,he,ge,me,...Te,be,Pe,$e,ie,Re,we]),lt=new Vector3;return useFrame(Qe=>{if(me){const Ze=calculateScaleFactor(tt.current.getWorldPosition(lt),he,Qe.camera,Qe.size);Fe.current.setScalar(Ze)}_&&_ instanceof Matrix4&&(Ke.current.matrix=_),Ke.current.updateWorldMatrix(!0,!0),mG.makeRotationFromEuler(tt.current.rotation).setPosition(tt.current.position).premultiply(Ke.current.matrixWorld),ct.current.setFromMatrixScale(mG),vScale.copy(Fe.current).divide(ct.current),(Math.abs(tt.current.scale.x-vScale.x)>1e-4||Math.abs(tt.current.scale.y-vScale.y)>1e-4||Math.abs(tt.current.scale.z-vScale.z)>1e-4)&&(tt.current.scale.copy(vScale),Qe.invalidate())}),reactExports.useImperativeHandle(Ge,()=>Ke.current,[]),reactExports.createElement(context.Provider,{value:ht},reactExports.createElement("group",{ref:ze},reactExports.createElement("group",_extends$3({ref:Ke,matrix:_,matrixAutoUpdate:!1},ke),reactExports.createElement("group",{visible:Ie,ref:tt,position:de,rotation:pe},K&&reactExports.createElement(reactExports.Fragment,null,!se&&fe[0]&&reactExports.createElement(AxisArrow,{axis:0,direction:xDir}),!se&&fe[1]&&reactExports.createElement(AxisArrow,{axis:1,direction:yDir}),!se&&fe[2]&&reactExports.createElement(AxisArrow,{axis:2,direction:zDir}),!ae&&fe[0]&&fe[1]&&reactExports.createElement(PlaneSlider,{axis:2,dir1:xDir,dir2:yDir}),!ae&&fe[0]&&fe[2]&&reactExports.createElement(PlaneSlider,{axis:1,dir1:zDir,dir2:xDir}),!ae&&fe[2]&&fe[1]&&reactExports.createElement(PlaneSlider,{axis:0,dir1:yDir,dir2:zDir}),!le&&fe[0]&&fe[1]&&reactExports.createElement(AxisRotator,{axis:2,dir1:xDir,dir2:yDir}),!le&&fe[0]&&fe[2]&&reactExports.createElement(AxisRotator,{axis:1,dir1:zDir,dir2:xDir}),!le&&fe[2]&&fe[1]&&reactExports.createElement(AxisRotator,{axis:0,dir1:yDir,dir2:zDir}),!ce&&fe[0]&&reactExports.createElement(ScalingSphere,{axis:0,direction:xDir}),!ce&&fe[1]&&reactExports.createElement(ScalingSphere,{axis:1,direction:yDir}),!ce&&fe[2]&&reactExports.createElement(ScalingSphere,{axis:2,direction:zDir}))),reactExports.createElement("group",{ref:Je},Ue))))}),defaultLookAt=new Vector3(0,0,-1),normal=function(){const K=new Vector3,_=new Vector3,Z=new Vector3,te=new Vector3,ne=new Vector3;return function(ie,oe,se,ae){return K.copy(ie),_.copy(oe),Z.copy(se),te.copy(_).sub(K),ne.copy(Z).sub(K),ae.crossVectors(ne,te).normalize()}}();function mean(K,_){return K.clone().add(_).multiplyScalar(.5)}const Facemesh=reactExports.forwardRef(({points:K=FacemeshDatas.SAMPLE_FACELANDMARKER_RESULT.faceLandmarks[0],face:_,facialTransformationMatrix:Z,faceBlendshapes:te,offset:ne,offsetScalar:ie=80,width:oe,height:se,depth:ae=1,verticalTri:le=[159,386,152],origin:ce,eyes:fe=!0,eyesAsOrigin:de=!1,debug:pe=!1,children:he,...ge},me)=>{var Ae;_&&(K=_.keypoints,console.warn("Facemesh `face` prop is deprecated: use `points` instead"));const ye=reactExports.useRef(null),ve=reactExports.useRef(null),_e=reactExports.useRef(null),Te=reactExports.useRef(null),be=reactExports.useRef(null),Re=reactExports.useRef(null),we=reactExports.useRef(null),[Pe]=reactExports.useState(()=>new Vector3),[Ie]=reactExports.useState(()=>new Object3D),[$e]=reactExports.useState(()=>new Quaternion),[Ue]=reactExports.useState(()=>new Vector3),{invalidate:ke}=useThree();reactExports.useEffect(()=>{var Je;(Je=be.current)==null||Je.geometry.setIndex(FacemeshDatas.TRIANGULATION)},[]);const[Ge]=reactExports.useState(()=>new Vector3);reactExports.useEffect(()=>{var Je,ot;const Fe=(Je=be.current)==null?void 0:Je.geometry;if(!Fe)return;if(Fe.setFromPoints(K),Fe.setDrawRange(0,FacemeshDatas.TRIANGULATION.length),Z)if(Ie.matrix.fromArray(Z.data),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.rotation.y*=-1,Ie.rotation.z*=-1,$e.setFromEuler(Ie.rotation),ne){var ct;Ie.position.y*=-1,Ie.position.z*=-1,(ct=ye.current)==null||ct.position.copy(Ie.position.divideScalar(ie))}else{var ht;(ht=ye.current)==null||ht.position.set(0,0,0)}else normal(K[le[0]],K[le[1]],K[le[2]],Pe),$e.setFromUnitVectors(defaultLookAt,Pe);const lt=$e.clone().invert();if(Fe.computeBoundingBox(),pe&&ke(),Fe.center(),Fe.applyQuaternion(lt),(ot=Te.current)==null||ot.setRotationFromQuaternion($e),fe){if(!te)console.warn("Facemesh `eyes` option only works if `faceBlendshapes` is provided: skipping.");else if(Re.current&&we.current&&_e.current)if(de){const Qe=Re.current._computeSphere(Fe),Ze=we.current._computeSphere(Fe);ce=mean(Qe.center,Ze.center).negate(),Re.current._update(Fe,te,Qe),we.current._update(Fe,te,Ze)}else Re.current._update(Fe,te),we.current._update(Fe,te)}if(_e.current){if(ce!==void 0)if(typeof ce=="number"){const Qe=Fe.getAttribute("position");Ue.set(-Qe.getX(ce),-Qe.getY(ce),-Qe.getZ(ce))}else ce.isVector3&&Ue.copy(ce);else Ue.setScalar(0);_e.current.position.copy(Ue)}if(ve.current){let Qe=1;(oe||se||ae)&&(Fe.boundingBox.getSize(Ge),oe&&(Qe=oe/Ge.x),se&&(Qe=se/Ge.y),ae&&(Qe=ae/Ge.z)),ve.current.scale.setScalar(Qe!==1?Qe:1)}Fe.computeVertexNormals(),Fe.attributes.position.needsUpdate=!0},[K,Z,te,Ie,ne,ie,oe,se,ae,le,ce,fe,pe,ke,Pe,$e,Ge,Ue]);const He=reactExports.useMemo(()=>({outerRef:Te,meshRef:be,eyeRightRef:Re,eyeLeftRef:we}),[]);reactExports.useImperativeHandle(me,()=>He,[He]);const[ze]=reactExports.useState(()=>new Vector3),Ke=(Ae=be.current)==null?void 0:Ae.geometry.boundingBox,tt=(Ke==null?void 0:Ke.getSize(ze).z)||1;return reactExports.createElement("group",ge,reactExports.createElement("group",{ref:ye},reactExports.createElement("group",{ref:Te},reactExports.createElement("group",{ref:ve},pe?reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("axesHelper",{args:[tt]}),reactExports.createElement(Line$1,{points:[[0,0,0],[0,0,-tt]],color:65535})):null,reactExports.createElement("group",{ref:_e},fe&&te&&reactExports.createElement("group",{name:"eyes"},reactExports.createElement(FacemeshEye,{side:"left",ref:Re,debug:pe}),reactExports.createElement(FacemeshEye,{side:"right",ref:we,debug:pe})),reactExports.createElement("mesh",{ref:be,name:"face"},he,pe?reactExports.createElement(reactExports.Fragment,null,Ke&&reactExports.createElement("box3Helper",{args:[Ke]})):null))))))}),FacemeshEyeDefaults={contourLandmarks:{right:[33,133,159,145,153],left:[263,362,386,374,380]},blendshapes:{right:[14,16,18,12],left:[13,15,17,11]},color:{right:"red",left:"#00ff00"},fov:{horizontal:100,vertical:90}},FacemeshEye=reactExports.forwardRef(({side:K,debug:_=!0},Z)=>{const te=reactExports.useRef(null),ne=reactExports.useRef(null),[ie]=reactExports.useState(()=>new Sphere$2),oe=reactExports.useCallback(fe=>{const de=fe.getAttribute("position"),he=FacemeshEyeDefaults.contourLandmarks[K].map(ge=>new Vector3(de.getX(ge),de.getY(ge),de.getZ(ge)));return ie.center.set(0,0,0),he.forEach(ge=>ie.center.add(ge)),ie.center.divideScalar(he.length),ie.radius=he[0].sub(he[1]).length()/2,ie},[ie,K]),[se]=reactExports.useState(()=>new Euler),ae=reactExports.useCallback((fe,de,pe)=>{if(te.current){var he;(he=pe)!==null&&he!==void 0||(pe=oe(fe)),te.current.position.copy(pe.center),te.current.scale.setScalar(pe.radius)}if(de&&ne.current){const ge=FacemeshEyeDefaults.blendshapes[K],me=de.categories[ge[0]].score,Ae=de.categories[ge[1]].score,ye=de.categories[ge[2]].score,ve=de.categories[ge[3]].score,_e=FacemeshEyeDefaults.fov.horizontal*MathUtils.DEG2RAD,Te=FacemeshEyeDefaults.fov.vertical*MathUtils.DEG2RAD,be=_e*.5*(ve-ye),Re=Te*.5*(me-Ae)*(K==="left"?1:-1);se.set(be,Re,0),ne.current.setRotationFromEuler(se)}},[oe,K,se]),le=reactExports.useMemo(()=>({eyeMeshRef:te,irisDirRef:ne,_computeSphere:oe,_update:ae}),[oe,ae]);reactExports.useImperativeHandle(Z,()=>le,[le]);const ce=FacemeshEyeDefaults.color[K];return reactExports.createElement("group",null,reactExports.createElement("group",{ref:te},_&&reactExports.createElement("axesHelper",null),reactExports.createElement("group",{ref:ne},reactExports.createElement(reactExports.Fragment,null,_&&reactExports.createElement(Line$1,{points:[[0,0,0],[0,0,-2]],lineWidth:1,color:ce})))))}),FacemeshDatas={TRIANGULATION:[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255],SAMPLE_FACE:{keypoints:[{x:356.2804412841797,y:295.1960563659668,z:-23.786449432373047,name:"lips"},{x:354.8859405517578,y:264.69520568847656,z:-36.718435287475586},{x:355.2180862426758,y:275.3360366821289,z:-21.183712482452393},{x:347.349853515625,y:242.4400234222412,z:-25.093655586242676},{x:354.40135955810547,y:256.67933464050293,z:-38.23572635650635},{x:353.7689971923828,y:247.54886627197266,z:-34.5475435256958},{x:352.1288299560547,y:227.34312057495117,z:-13.095386028289795},{x:303.5013198852539,y:234.67002868652344,z:12.500141859054565,name:"rightEye"},{x:351.09378814697266,y:211.87547206878662,z:-6.413471698760986},{x:350.7115936279297,y:202.1251630783081,z:-6.413471698760986},{x:348.33667755126953,y:168.7741756439209,z:6.483500003814697,name:"faceOval"},{x:356.4806365966797,y:299.2995357513428,z:-23.144519329071045},{x:356.5511703491211,y:302.66146659851074,z:-21.020312309265137},{x:356.6239547729492,y:304.1536331176758,z:-18.137459754943848,name:"lips"},{x:356.5807342529297,y:305.1840591430664,z:-18.767719268798828,name:"lips"},{x:356.8241500854492,y:308.25711250305176,z:-20.16829490661621},{x:357.113037109375,y:312.26277351379395,z:-22.10575819015503},{x:357.34962463378906,y:317.1123218536377,z:-21.837315559387207,name:"lips"},{x:357.6658630371094,y:325.51036834716797,z:-16.27002477645874},{x:355.0201416015625,y:269.36279296875,z:-33.73054027557373},{x:348.5237503051758,y:270.33411026000977,z:-24.93025302886963},{x:279.97331619262695,y:213.24176788330078,z:47.759642601013184,name:"faceOval"},{x:322.66529083251953,y:238.5027265548706,z:5.535193085670471},{x:316.0983657836914,y:239.94489669799805,z:5.777376294136047},{x:309.9431610107422,y:240.24518966674805,z:7.510589361190796},{x:301.31994247436523,y:237.86138534545898,z:13.118728399276733},{x:328.14266204833984,y:235.80496788024902,z:6.646900177001953},{x:313.7326431274414,y:222.11161136627197,z:3.9887237548828125},{x:320.45196533203125,y:221.87729358673096,z:4.601476192474365},{x:307.35679626464844,y:223.63793849945068,z:5.932023525238037},{x:303.0031204223633,y:226.3743782043457,z:8.479321002960205},{x:296.80023193359375,y:242.94299125671387,z:15.931552648544312},{x:332.2352981567383,y:340.77341079711914,z:-10.165848731994629},{x:301.38587951660156,y:233.46447944641113,z:14.764405488967896,name:"rightEye"},{x:279.0147018432617,y:244.37155723571777,z:45.77549457550049},{x:289.60548400878906,y:239.1807460784912,z:23.191204071044922},{x:320.32257080078125,y:267.1292781829834,z:-4.954537749290466},{x:347.64583587646484,y:294.4955062866211,z:-23.062820434570312,name:"lips"},{x:349.28138732910156,y:303.1095886230469,z:-20.238323211669922},{x:338.9453125,y:298.19186210632324,z:-19.456336498260498,name:"lips"},{x:333.36788177490234,y:302.6706790924072,z:-14.776077270507812,name:"lips"},{x:342.89188385009766,y:304.3561363220215,z:-17.752301692962646},{x:337.7375030517578,y:306.0098361968994,z:-13.410515785217285},{x:325.6159210205078,y:316.22995376586914,z:-6.681914925575256},{x:349.0104675292969,y:264.9818515777588,z:-36.274919509887695},{x:347.7138900756836,y:257.5664806365967,z:-37.67549514770508},{x:291.79357528686523,y:218.88171672821045,z:11.578094959259033,name:"rightEyebrow"},{x:332.2689437866211,y:247.56946563720703,z:-3.3730539679527283},{x:332.0074462890625,y:267.1201229095459,z:-19.969879388809204},{x:331.27952575683594,y:263.6967658996582,z:-17.47218608856201},{x:301.04373931884766,y:269.56552505493164,z:3.61815482378006},{x:347.4863815307617,y:249.0706443786621,z:-32.633421421051025},{x:307.26118087768555,y:208.2646894454956,z:1.1591226607561111,name:"rightEyebrow"},{x:297.91919708251953,y:212.22604751586914,z:5.914516448974609,name:"rightEyebrow"},{x:285.1651382446289,y:197.98450469970703,z:36.391637325286865,name:"faceOval"},{x:337.04097747802734,y:211.25229835510254,z:-4.548954665660858},{x:326.5912628173828,y:223.16698551177979,z:6.670243740081787},{x:320.05664825439453,y:309.5834255218506,z:-4.055835008621216},{x:289.6866226196289,y:314.617395401001,z:53.875489234924316,name:"faceOval"},{x:337.4256896972656,y:270.8755302429199,z:-17.67060160636902},{x:343.69922637939453,y:273.0000400543213,z:-18.756048679351807},{x:327.4242401123047,y:309.22399520874023,z:-4.703601002693176,name:"lips"},{x:330.37220001220703,y:308.3323001861572,z:-6.442649960517883},{x:293.87027740478516,y:207.7961826324463,z:9.821539521217346,name:"rightEyebrow"},{x:332.11437225341797,y:271.22812271118164,z:-16.64351224899292},{x:320.1197814941406,y:207.40366458892822,z:-2.48164564371109,name:"rightEyebrow"},{x:318.59575271606445,y:201.07443809509277,z:-3.110446035861969,name:"rightEyebrow"},{x:310.72303771972656,y:175.75075149536133,z:13.328815698623657,name:"faceOval"},{x:289.67578887939453,y:202.29835510253906,z:21.370456218719482},{x:315.30879974365234,y:187.35260009765625,z:5.0304025411605835},{x:287.8936767578125,y:216.54793739318848,z:17.81065821647644,name:"rightEyebrow"},{x:283.9391899108887,y:215.01142501831055,z:32.04984903335571},{x:348.35330963134766,y:299.4155788421631,z:-22.47924566268921},{x:341.1790466308594,y:301.8221855163574,z:-18.977805376052856},{x:335.69713592529297,y:304.4266891479492,z:-14.682706594467163},{x:339.4615173339844,y:272.3654365539551,z:-16.38674020767212},{x:328.99600982666016,y:308.86685371398926,z:-5.616893768310547},{x:332.00313568115234,y:309.1875743865967,z:-10.335084199905396},{x:331.0068130493164,y:307.9274368286133,z:-6.681914925575256,name:"lips"},{x:341.13792419433594,y:266.4876937866211,z:-26.56425952911377},{x:339.02950286865234,y:305.6663703918457,z:-12.33674168586731,name:"lips"},{x:344.22935485839844,y:304.9452781677246,z:-15.161235332489014,name:"lips"},{x:350.1844024658203,y:304.374303817749,z:-17.5305438041687,name:"lips"},{x:348.52630615234375,y:325.9562301635742,z:-16.164982318878174},{x:348.6581802368164,y:317.1624183654785,z:-21.510512828826904,name:"lips"},{x:348.9766311645508,y:312.1923065185547,z:-21.708929538726807},{x:349.2427444458008,y:308.0660820007324,z:-19.643079042434692},{x:349.67491149902344,y:305.42747497558594,z:-18.16080331802368,name:"lips"},{x:337.95589447021484,y:306.6535949707031,z:-12.803598642349243,name:"lips"},{x:337.06878662109375,y:307.63169288635254,z:-14.274203777313232},{x:335.77449798583984,y:309.8449516296387,z:-15.698124170303345},{x:334.6099090576172,y:312.7997016906738,z:-14.764405488967896,name:"lips"},{x:327.2330856323242,y:293.80866050720215,z:-11.864047050476074},{x:280.97679138183594,y:279.79928970336914,z:68.90834331512451,name:"faceOval"},{x:355.13843536376953,y:271.7875671386719,z:-25.350427627563477},{x:334.7235870361328,y:307.4656391143799,z:-9.302158951759338,name:"lips"},{x:333.5293960571289,y:307.89782524108887,z:-10.200862884521484},{x:346.29688262939453,y:276.4256286621094,z:-19.748122692108154},{x:335.16246795654297,y:276.22097969055176,z:-12.313398122787476},{x:345.09132385253906,y:274.7082996368408,z:-19.304605722427368},{x:325.4267883300781,y:252.95130729675293,z:-1.6661019623279572},{x:315.347843170166,y:259.05200958251953,z:-.25604281574487686},{x:330.44933319091797,y:267.7570152282715,z:-14.017432928085327},{x:294.96768951416016,y:185.26001930236816,z:23.903164863586426,name:"faceOval"},{x:299.63531494140625,y:192.7913761138916,z:12.640198469161987},{x:304.5452117919922,y:202.4142837524414,z:3.244667649269104,name:"rightEyebrow"},{x:331.6915512084961,y:320.0467872619629,z:-10.632705688476562},{x:334.5911407470703,y:201.27566814422607,z:-6.133356094360352,name:"rightEyebrow"},{x:331.4815902709961,y:185.44180870056152,z:.6627205014228821},{x:328.05816650390625,y:170.8385467529297,z:7.358860373497009,name:"faceOval"},{x:304.49764251708984,y:239.76297855377197,z:10.387605428695679},{x:290.6382179260254,y:248.85257720947266,z:19.03616428375244},{x:331.5682601928711,y:233.20727348327637,z:7.837390303611755},{x:295.5115509033203,y:228.9834451675415,z:14.41426157951355},{x:336.94332122802734,y:241.8259334564209,z:-5.27842104434967},{x:336.2792205810547,y:262.7049922943115,z:-26.12074375152588},{x:284.4102478027344,y:255.3262710571289,z:25.467140674591064},{x:295.1420593261719,y:253.02655220031738,z:12.430112361907959},{x:303.5196113586426,y:254.20703887939453,z:6.139191389083862},{x:315.73450088500977,y:251.64799690246582,z:3.3788898587226868},{x:324.69661712646484,y:247.56494522094727,z:2.3328344523906708},{x:331.57970428466797,y:243.02241325378418,z:1.1423448473215103},{x:345.6210708618164,y:229.9976634979248,z:-10.825285911560059},{x:286.26644134521484,y:270.37991523742676,z:21.708929538726807},{x:290.2525520324707,y:228.4921360015869,z:17.71728754043579},{x:351.65367126464844,y:269.3400764465332,z:-33.450424671173096},{x:333.1378936767578,y:253.88388633728027,z:-7.230473756790161},{x:277.8318977355957,y:246.95331573486328,z:68.20805549621582,name:"faceOval"},{x:336.6680908203125,y:238.10003757476807,z:.7688578963279724},{x:329.95800018310547,y:269.18323516845703,z:-7.207130789756775},{x:299.17491912841797,y:234.13324356079102,z:15.95489501953125},{x:335.61729431152344,y:258.71752738952637,z:-23.016133308410645},{x:284.1079330444336,y:297.0343494415283,z:63.25934886932373,name:"faceOval"},{x:331.44542694091797,y:230.6892442703247,z:9.92658257484436,name:"rightEye"},{x:341.41536712646484,y:253.01264762878418,z:-29.038610458374023},{x:303.5472869873047,y:327.5896739959717,z:16.725212335586548},{x:304.7756576538086,y:337.4389457702637,z:27.38126277923584,name:"faceOval"},{x:280.80501556396484,y:275.32050132751465,z:45.0752067565918},{x:295.43582916259766,y:318.4501647949219,z:26.2608003616333},{x:281.4303207397461,y:228.7355661392212,z:40.94350814819336},{x:331.2549591064453,y:349.4216537475586,z:-7.376367449760437},{x:352.4247741699219,y:271.7330074310303,z:-24.953596591949463},{x:327.5672912597656,y:260.41900634765625,z:-5.456410646438599},{x:284.5432472229004,y:241.7647933959961,z:29.668869972229004},{x:310,y:235.66174507141113,z:8.502663969993591,name:"rightEye"},{x:315.7071113586426,y:235.7572603225708,z:6.938687562942505,name:"rightEye"},{x:330.41088104248047,y:311.04143142700195,z:-9.325502514839172,name:"lips"},{x:288.5377502441406,y:285.31983375549316,z:21.837315559387207},{x:344.55039978027344,y:359.4300842285156,z:-6.705257892608643,name:"faceOval"},{x:323.41880798339844,y:351.67362213134766,z:7.802375555038452,name:"faceOval"},{x:314.64088439941406,y:346.11894607543945,z:16.36339783668518,name:"faceOval"},{x:349.4945526123047,y:184.8434829711914,z:-.21847527474164963},{x:359.24694061279297,y:359.8348903656006,z:-8.403456211090088,name:"faceOval"},{x:321.26182556152344,y:234.64492321014404,z:6.90950870513916,name:"rightEye"},{x:326.318359375,y:232.90250301361084,z:8.029969334602356,name:"rightEye"},{x:329.6211624145508,y:231.6195774078369,z:9.722331762313843,name:"rightEye"},{x:285.9398078918457,y:228.2351303100586,z:24.650139808654785},{x:325.79288482666016,y:227.88007736206055,z:7.469738721847534,name:"rightEye"},{x:320.1699447631836,y:227.5934886932373,z:6.168370842933655,name:"rightEye"},{x:314.85408782958984,y:227.85282611846924,z:6.2675780057907104,name:"rightEye"},{x:309.3084907531738,y:229.1516876220703,z:7.7031683921813965,name:"rightEye"},{x:305.5621337890625,y:230.92366218566895,z:9.722331762313843,name:"rightEye"},{x:277.8681945800781,y:228.5354232788086,z:59.71122741699219,name:"faceOval"},{x:306.1444664001465,y:235.1954698562622,z:10.603528022766113,name:"rightEye"},{x:355.4478454589844,y:281.96210861206055,z:-20.565123558044434},{x:333.02661895751953,y:288.0105400085449,z:-14.72939133644104},{x:337.15728759765625,y:269.2059516906738,z:-19.8414945602417},{x:345.9898376464844,y:283.5453128814697,z:-20.4834246635437},{x:351.48963928222656,y:219.98916149139404,z:-7.0378947257995605},{x:312.39574432373047,y:336.50628089904785,z:8.671900033950806},{x:321.32152557373047,y:343.1755256652832,z:.9067271649837494},{x:343.78379821777344,y:353.2975959777832,z:-14.355905055999756},{x:296.8791389465332,y:327.91497230529785,z:41.01353645324707,name:"faceOval"},{x:329.6939468383789,y:229.27897453308105,z:8.934508562088013,name:"rightEye"},{x:341.6905212402344,y:241.4073657989502,z:-14.589333534240723},{x:359.03079986572266,y:353.48859786987305,z:-15.803166627883911},{x:333.1861877441406,y:356.43213272094727,z:-1.0234417766332626,name:"faceOval"},{x:283.97483825683594,y:291.4318656921387,z:41.94725513458252},{x:343.33770751953125,y:305.830135345459,z:-15.756480693817139,name:"lips"},{x:342.40283966064453,y:307.7453899383545,z:-17.4021577835083},{x:341.53621673583984,y:311.0595703125,z:-19.047834873199463},{x:340.9107208251953,y:315.4837703704834,z:-18.5576331615448,name:"lips"},{x:339.1478729248047,y:323.42233657836914,z:-14.367576837539673},{x:333.3201599121094,y:307.4406337738037,z:-9.617288708686829},{x:331.2411117553711,y:306.9811820983887,z:-9.669809937477112},{x:329.23255920410156,y:306.0508346557617,z:-9.582273960113525,name:"lips"},{x:322.4586486816406,y:301.33323669433594,z:-7.720675468444824},{x:297.1712112426758,y:286.9552803039551,z:8.240055441856384},{x:341.3060760498047,y:235.4432201385498,z:-7.504753470420837},{x:336.9318389892578,y:224.3451976776123,z:5.829898118972778},{x:332.65323638916016,y:226.70403957366943,z:8.105834126472473},{x:334.67357635498047,y:306.4397621154785,z:-8.981193900108337,name:"lips"},{x:297.4601936340332,y:306.29210472106934,z:15.476365089416504},{x:342.9119110107422,y:222.37077713012695,z:-2.754466235637665},{x:335.4629898071289,y:332.20250129699707,z:-11.823196411132812},{x:353.2412338256836,y:240.56339263916016,z:-27.147831916809082},{x:346.3080596923828,y:236.41446590423584,z:-18.452589511871338},{x:352.6475143432617,y:234.1420555114746,z:-19.748122692108154},{x:337.3209762573242,y:253.39937210083008,z:-16.024924516677856},{x:358.6122131347656,y:344.90861892700195,z:-18.592647314071655},{x:358.1117248535156,y:334.64990615844727,z:-17.49552845954895},{x:346.4450454711914,y:335.0321102142334,z:-16.32838249206543},{x:319.17640686035156,y:320.2833938598633,z:-3.276764452457428},{x:325.2540588378906,y:276.2369728088379,z:-6.460157036781311},{x:326.7214584350586,y:327.3939514160156,z:-7.417217493057251},{x:310.7190132141113,y:277.2265148162842,z:-3.5452082753181458},{x:319.78355407714844,y:284.8238182067871,z:-6.4543211460113525},{x:305.773983001709,y:290.83580017089844,z:.06907138042151928},{x:344.4001770019531,y:344.85408782958984,z:-16.946970224380493},{x:333.1879425048828,y:258.74256134033203,z:-11.90489649772644},{x:313.80598068237305,y:327.08919525146484,z:2.2277912497520447},{x:322.9637908935547,y:334.6819496154785,z:-3.3643004298210144},{x:313.4055519104004,y:311.2166690826416,z:-1.1175429821014404},{x:291.0865783691406,y:298.2831001281738,z:22.467575073242188},{x:305.6580924987793,y:313.3707904815674,z:5.561453700065613},{x:288.23760986328125,y:305.9941864013672,z:36.765122413635254},{x:315.10692596435547,y:296.26991271972656,z:-4.604393839836121},{x:337.50518798828125,y:247.5944423675537,z:-10.597691535949707},{x:338.8450622558594,y:265.47778129577637,z:-27.778091430664062},{x:334.25254821777344,y:269.0671920776367,z:-20.938611030578613},{x:341.64512634277344,y:259.6387195587158,z:-32.189905643463135},{x:331.44081115722656,y:219.0976095199585,z:4.207563698291779},{x:320.56339263916016,y:216.49658203125,z:2.930997312068939},{x:311.21912002563477,y:216.57853603363037,z:2.9674705862998962},{x:303.46256256103516,y:218.54614734649658,z:5.357203483581543},{x:297.99999237060547,y:222.505202293396,z:9.325502514839172},{x:294.93839263916016,y:236.39654159545898,z:18.534289598464966},{x:278.87489318847656,y:259.7095584869385,z:45.68212032318115},{x:300.3782653808594,y:245.38593292236328,z:12.278382778167725},{x:307.06348419189453,y:246.36857986450195,z:8.164191246032715},{x:315.5229187011719,y:245.3949737548828,z:5.503097176551819},{x:323.71395111083984,y:242.75178909301758,z:4.6335723996162415},{x:330.2785873413086,y:239.34658527374268,z:4.937030673027039},{x:334.6982192993164,y:236.0460376739502,z:4.823233783245087},{x:279.3412208557129,y:263.5196113586426,z:70.91583728790283,name:"faceOval"},{x:334.65972900390625,y:271.6648578643799,z:-17.775644063949585},{x:342.05677032470703,y:246.99846267700195,z:-20.84523916244507},{x:344.0357971191406,y:264.5701503753662,z:-32.936880588531494},{x:348.25531005859375,y:268.6645030975342,z:-30.695960521697998},{x:344.12227630615234,y:266.34212493896484,z:-29.808926582336426},{x:337.12318420410156,y:274.2556858062744,z:-15.768152475357056},{x:349.49047088623047,y:269.071683883667,z:-32.51670837402344},{x:350.1683044433594,y:271.4691352844238,z:-24.93025302886963},{x:333.9634704589844,y:230.56639194488525,z:8.89949381351471},{x:338.2147979736328,y:231.4807891845703,z:4.6715047955513},{x:340.4712677001953,y:231.74463272094727,z:-.34996166825294495},{x:303.28975677490234,y:232.24980354309082,z:11.916568279266357,name:"rightEye"},{x:299.4649124145508,y:229.53842639923096,z:12.325069904327393},{x:359.09618377685547,y:241.77349090576172,z:-24.650139808654785},{x:399.46216583251953,y:229.89503860473633,z:15.919880867004395,name:"leftEye"},{x:361.38919830322266,y:269.6129894256592,z:-24.510080814361572},{x:416.9973373413086,y:206.0895538330078,z:53.26857566833496,name:"faceOval"},{x:381.32179260253906,y:235.5476474761963,z:7.6214683055877686},{x:387.8068542480469,y:236.25958442687988,z:8.345099091529846},{x:393.95751953125,y:235.8660364151001,z:10.475142002105713},{x:401.84600830078125,y:232.77019500732422,z:16.760226488113403},{x:375.70568084716797,y:233.48456382751465,z:8.234220147132874},{x:388.17752838134766,y:218.94717693328857,z:6.810300946235657},{x:381.64928436279297,y:219.2656660079956,z:6.711093783378601},{x:394.4760513305664,y:219.66821193695068,z:9.173773527145386},{x:398.8843536376953,y:221.8837022781372,z:12.03328251838684},{x:406.5454864501953,y:237.12156772613525,z:19.7131085395813},{x:383.87447357177734,y:337.6932907104492,z:-8.631049990653992},{x:401.2682342529297,y:228.5916566848755,z:18.359217643737793,name:"leftEye"},{x:422.0449447631836,y:236.73934936523438,z:51.16771221160889},{x:412.69153594970703,y:232.80198097229004,z:27.52131938934326},{x:387.3497772216797,y:263.298397064209,z:-2.8609684109687805},{x:364.5124053955078,y:293.39221000671387,z:-22.397546768188477,name:"lips"},{x:363.62987518310547,y:302.1291446685791,z:-19.643079042434692},{x:373.2334518432617,y:295.8647060394287,z:-18.125789165496826,name:"lips"},{x:378.83365631103516,y:299.5177745819092,z:-13.153743743896484,name:"lips"},{x:369.91477966308594,y:302.5704002380371,z:-16.65518283843994},{x:374.9167251586914,y:303.5416603088379,z:-11.963253021240234},{x:387.58888244628906,y:312.2716999053955,z:-4.680258631706238},{x:360.6635284423828,y:264.31986808776855,z:-35.94811677932739},{x:361.04564666748047,y:256.8225860595703,z:-37.278664112091064},{x:408.3855438232422,y:213.52088928222656,z:15.756480693817139,name:"leftEyebrow"},{x:373.2946014404297,y:245.38101196289062,z:-1.9316278398036957},{x:376.83860778808594,y:264.3721103668213,z:-18.510947227478027},{x:376.9546127319336,y:261.0010528564453,z:-15.989909172058105},{x:406.1498260498047,y:263.5030174255371,z:7.072908878326416},{x:360.07205963134766,y:248.3631706237793,z:-32.16656446456909},{x:393.11119079589844,y:205.10473251342773,z:3.7786373496055603,name:"leftEyebrow"},{x:402.12791442871094,y:207.89000988006592,z:9.383859634399414,name:"leftEyebrow"},{x:410.8693313598633,y:191.6182279586792,z:41.27030849456787,name:"faceOval"},{x:364.9509811401367,y:210.40483474731445,z:-3.758212625980377},{x:375.94444274902344,y:221.1331844329834,z:8.368442058563232},{x:392.1904754638672,y:305.0360298156738,z:-1.752179116010666},{x:419.50225830078125,y:307.25592613220215,z:58.96425247192383,name:"faceOval"},{x:372.0027160644531,y:268.7212657928467,z:-16.631840467453003},{x:366.1614227294922,y:271.6237449645996,z:-18.219159841537476},{x:385.00938415527344,y:305.3863334655762,z:-2.567722797393799},{x:381.99771881103516,y:304.9723720550537,z:-4.575215280056},{x:405.078125,y:203.21216583251953,z:13.713973760604858,name:"leftEyebrow"},{x:377.13207244873047,y:268.4710121154785,z:-15.266278982162476},{x:380.9713363647461,y:205.36980628967285,z:-.7250899076461792,name:"leftEyebrow"},{x:381.7788314819336,y:198.9268398284912,z:-1.184653863310814,name:"leftEyebrow"},{x:385.5204772949219,y:172.1484375,z:16.04826807975769,name:"faceOval"},{x:407.94189453125,y:196.76236152648926,z:25.723915100097656},{x:383.03890228271484,y:184.5157527923584,z:7.393874526023865},{x:411.61781311035156,y:210.79241752624512,z:22.315845489501953,name:"leftEyebrow"},{x:414.30870056152344,y:208.4643030166626,z:37.021894454956055},{x:364.28722381591797,y:298.35777282714844,z:-21.86065673828125},{x:371.3682556152344,y:299.78848457336426,z:-17.834001779556274},{x:376.88201904296875,y:301.6696071624756,z:-13.153743743896484},{x:370.2193832397461,y:270.49095153808594,z:-15.569736957550049},{x:383.5081100463867,y:305.2726364135742,z:-3.673594295978546},{x:380.73760986328125,y:305.96869468688965,z:-8.660228252410889},{x:381.2334442138672,y:304.63574409484863,z:-4.820316135883331,name:"lips"},{x:368.1698989868164,y:264.8884963989258,z:-25.653886795043945},{x:373.5087203979492,y:303.4233856201172,z:-10.95950722694397,name:"lips"},{x:368.4544372558594,y:303.29601287841797,z:-14.169161319732666,name:"lips"},{x:362.76554107666016,y:303.5735607147217,z:-16.911956071853638,name:"lips"},{x:366.60980224609375,y:324.8870658874512,z:-15.616422891616821},{x:365.7067108154297,y:315.95678329467773,z:-20.903596878051758,name:"lips"},{x:365.0083923339844,y:311.2232208251953,z:-21.066999435424805},{x:364.1508102416992,y:307.0583438873291,z:-18.907777070999146},{x:363.37512969970703,y:304.5721435546875,z:-17.42550015449524,name:"lips"},{x:374.580078125,y:304.3059539794922,z:-11.40302300453186,name:"lips"},{x:375.55362701416016,y:305.0998020172119,z:-12.861957550048828},{x:377.2437286376953,y:307.1674346923828,z:-14.215847253799438},{x:378.68587493896484,y:309.9015712738037,z:-13.223772048950195,name:"lips"},{x:383.8992691040039,y:290.29629707336426,z:-9.97326910495758},{x:423.3871841430664,y:271.91688537597656,z:74.37058925628662,name:"faceOval"},{x:377.68043518066406,y:304.62209701538086,z:-7.603961229324341,name:"lips"},{x:379.00428771972656,y:304.9314594268799,z:-8.57852816581726},{x:364.00279998779297,y:275.2813911437988,z:-19.25792098045349},{x:374.68231201171875,y:273.82555961608887,z:-11.28047227859497},{x:365.0354766845703,y:273.4548568725586,z:-18.791062831878662},{x:380.61901092529297,y:249.8848056793213,z:.15501167625188828},{x:391.14158630371094,y:254.7934627532959,z:2.0906515419483185},{x:378.1761169433594,y:264.9612236022949,z:-12.605184316635132},{x:400.9540557861328,y:179.99592304229736,z:27.82477855682373,name:"faceOval"},{x:398.0038833618164,y:188.50656509399414,z:16.094952821731567},{x:394.8717498779297,y:199.0359592437744,z:6.226727366447449,name:"leftEyebrow"},{x:382.10926055908203,y:316.83926582336426,z:-8.946179747581482},{x:366.51588439941406,y:200.32583713531494,z:-5.24632453918457,name:"leftEyebrow"},{x:367.4893569946289,y:183.87210845947266,z:1.9039081037044525},{x:368.6243438720703,y:168.8127565383911,z:8.736093044281006,name:"faceOval"},{x:398.96175384521484,y:234.9675178527832,z:13.713973760604858},{x:412.9645538330078,y:242.23042488098145,z:23.272905349731445},{x:372.05257415771484,y:231.41919136047363,z:9.226294755935669},{x:406.0722351074219,y:223.58965873718262,z:18.370890617370605},{x:368.27442169189453,y:240.2039337158203,z:-4.166713654994965},{x:372.3575210571289,y:260.66442489624023,z:-24.976940155029297},{x:419.2244338989258,y:247.9079246520996,z:30.299127101898193},{x:409.43885803222656,y:246.60913467407227,z:16.398411989212036},{x:401.69139862060547,y:248.76328468322754,z:9.395531415939331},{x:389.7608184814453,y:247.56915092468262,z:5.841569304466248},{x:380.5461883544922,y:244.55984115600586,z:4.263003468513489},{x:373.25817108154297,y:240.80214500427246,z:2.5356262922286987},{x:358.77086639404297,y:229.35615062713623,z:-10.387605428695679},{x:419.5793914794922,y:262.8478717803955,z:26.5175724029541},{x:410.8808898925781,y:222.51372814178467,z:22.199130058288574},{x:358.45714569091797,y:268.91467094421387,z:-33.17030906677246},{x:373.4129333496094,y:251.6385841369629,z:-5.771540403366089},{x:422.5408172607422,y:239.23919677734375,z:74.04378890991211,name:"faceOval"},{x:367.8171920776367,y:236.58040523529053,z:1.820748895406723},{x:378.51959228515625,y:266.2532329559326,z:-5.74819803237915},{x:403.3472442626953,y:229.05112266540527,z:19.689764976501465},{x:372.34840393066406,y:256.6451168060303,z:-21.872329711914062},{x:422.54566192626953,y:289.1587829589844,z:68.67491245269775,name:"faceOval"},{x:371.9297409057617,y:228.90116214752197,z:11.432201862335205,name:"leftEye"},{x:366.21360778808594,y:251.6158962249756,z:-28.19826364517212},{x:409.1571807861328,y:321.3156223297119,z:20.2266526222229},{x:408.52943420410156,y:331.44238471984863,z:31.09278917312622,name:"faceOval"},{x:424.2788314819336,y:267.1992301940918,z:50.467424392700195},{x:415.60352325439453,y:311.6528606414795,z:30.579242706298828},{x:418.12793731689453,y:221.59927368164062,z:46.26569747924805},{x:385.68286895751953,y:346.0184955596924,z:-5.70151150226593},{x:357.82936096191406,y:271.3758373260498,z:-24.836881160736084},{x:379.588623046875,y:257.5071716308594,z:-3.755294680595398},{x:417.4592590332031,y:234.71948146820068,z:34.5475435256958},{x:393.4684371948242,y:231.58967971801758,z:11.408859491348267,name:"leftEye"},{x:387.8864288330078,y:232.14245796203613,z:9.51808214187622,name:"leftEye"},{x:382.4981689453125,y:307.5654888153076,z:-7.522260546684265,name:"lips"},{x:419.00169372558594,y:277.8332805633545,z:26.424202919006348},{x:373.62953186035156,y:357.6375102996826,z:-5.75986921787262,name:"faceOval"},{x:392.8708267211914,y:347.72446632385254,z:10.154176950454712,name:"faceOval"},{x:400.3953552246094,y:341.0005187988281,z:19.39797878265381,name:"faceOval"},{x:382.25440979003906,y:231.66935920715332,z:8.998700976371765,name:"leftEye"},{x:377.14550018310547,y:230.4228687286377,z:9.804032444953918,name:"leftEye"},{x:373.8358688354492,y:229.64950561523438,z:11.292144060134888,name:"leftEye"},{x:414.5794677734375,y:221.67891025543213,z:29.412097930908203},{x:377.00672149658203,y:225.66201210021973,z:9.360517263412476,name:"leftEye"},{x:382.29530334472656,y:224.8431158065796,z:8.32175612449646,name:"leftEye"},{x:387.5133514404297,y:224.49507236480713,z:8.917000889778137,name:"leftEye"},{x:393.15906524658203,y:225.24795055389404,z:10.737749338150024,name:"leftEye"},{x:397.05554962158203,y:226.55359268188477,z:13.002015352249146,name:"leftEye"},{x:420.5299377441406,y:221.014666557312,z:65.40690422058105,name:"faceOval"},{x:397.06920623779297,y:230.6661558151245,z:13.807345628738403,name:"leftEye"},{x:377.94647216796875,y:285.1647090911865,z:-13.305472135543823},{x:372.1118927001953,y:267.1267318725586,z:-18.83774757385254},{x:364.9968719482422,y:282.24411964416504,z:-19.818150997161865},{x:401.973876953125,y:331.20131492614746,z:11.566424369812012},{x:394.3083190917969,y:338.86693954467773,z:3.142542541027069},{x:373.9820861816406,y:351.4504623413086,z:-13.50388765335083},{x:414.3888854980469,y:321.24735832214355,z:45.51872253417969,name:"faceOval"},{x:373.44234466552734,y:227.33163356781006,z:10.626870393753052,name:"leftEye"},{x:364.0731430053711,y:240.31539916992188,z:-13.807345628738403},{x:384.2658233642578,y:353.3793067932129,z:.7385850697755814,name:"faceOval"},{x:423.20526123046875,y:283.5176181793213,z:47.152724266052246},{x:369.42798614501953,y:304.0898895263672,z:-14.647691249847412,name:"lips"},{x:370.63812255859375,y:305.90051651000977,z:-16.211668252944946},{x:371.91192626953125,y:309.0167713165283,z:-17.84567356109619},{x:373.0583953857422,y:313.3545398712158,z:-17.378815412521362,name:"lips"},{x:375.39905548095703,y:321.09289169311523,z:-13.118728399276733},{x:379.2567825317383,y:304.3582534790039,z:-7.924926280975342},{x:381.18797302246094,y:303.7031364440918,z:-7.843226194381714},{x:383.0918502807617,y:302.4884605407715,z:-7.6506465673446655,name:"lips"},{x:389.09461975097656,y:297.1475315093994,z:-5.5497825145721436},{x:411.6408920288086,y:280.24898529052734,z:12.02161192893982},{x:363.3110809326172,y:234.27620887756348,z:-6.775286793708801},{x:366.0474395751953,y:223.29872131347656,z:6.827808618545532},{x:370.34427642822266,y:225.1457118988037,z:9.558931589126587},{x:377.5371551513672,y:303.60079765319824,z:-7.358860373497009,name:"lips"},{x:412.9557800292969,y:299.53579902648926,z:19.39797878265381},{x:360.0810241699219,y:221.72012329101562,z:-2.153385728597641},{x:379.82784271240234,y:329.47723388671875,z:-10.48097848892212},{x:359.08477783203125,y:235.7911491394043,z:-18.079102039337158},{x:369.6688461303711,y:251.5407943725586,z:-14.962821006774902},{x:369.5555114746094,y:333.5307312011719,z:-15.67478060722351},{x:394.0193176269531,y:315.6973171234131,z:-.9920747578144073},{x:383.78997802734375,y:272.7268695831299,z:-4.689012169837952},{x:387.67765045166016,y:323.6722755432129,z:-5.640236139297485},{x:397.8769302368164,y:272.1331214904785,z:-.9395531564950943},{x:389.87476348876953,y:280.5630111694336,z:-4.29218202829361},{x:403.83888244628906,y:285.1167869567871,z:3.0229100584983826},{x:372.5467300415039,y:343.1070327758789,z:-16.153310537338257},{x:374.1112518310547,y:256.3721466064453,z:-10.574349164962769},{x:399.73785400390625,y:321.77515983581543,z:4.849494695663452},{x:392.03365325927734,y:330.56447982788086,z:-1.3407598435878754},{x:398.59134674072266,y:305.93902587890625,z:1.517290621995926},{x:417.95997619628906,y:290.9716987609863,z:26.89105987548828},{x:406.04541778564453,y:307.35154151916504,z:8.666064143180847},{x:420.75328826904297,y:298.40752601623535,z:41.78385257720947},{x:395.4522705078125,y:291.4153575897217,z:-2.1752697229385376},{x:368.6452102661133,y:245.8882999420166,z:-9.453888535499573},{x:370.34900665283203,y:263.56690406799316,z:-26.75100326538086},{x:374.98477935791016,y:266.6126346588135,z:-19.77146625518799},{x:366.99840545654297,y:258.12140464782715,z:-31.372904777526855},{x:371.00616455078125,y:217.63479709625244,z:5.60522198677063},{x:381.30577087402344,y:214.14087295532227,z:4.983716309070587},{x:390.1496124267578,y:213.38221549987793,z:5.593550801277161},{x:397.7696990966797,y:214.3659782409668,z:8.57852816581726},{x:403.1652069091797,y:217.65509605407715,z:13.013685941696167},{x:407.3551940917969,y:230.72525024414062,z:22.444231510162354},{x:424.0876770019531,y:251.7839241027832,z:51.16771221160889},{x:403.50196838378906,y:239.88757610321045,z:15.803166627883911},{x:397.31719970703125,y:241.49806022644043,z:11.233787536621094},{x:388.99425506591797,y:241.4366912841797,z:7.948269248008728},{x:380.7804489135742,y:239.78078842163086,z:6.600214838981628},{x:374.01336669921875,y:237.11946487426758,z:6.349278092384338},{x:369.39125061035156,y:234.35351371765137,z:5.987462401390076},{x:422.9730987548828,y:255.76455116271973,z:76.61150932312012,name:"faceOval"},{x:374.73915100097656,y:269.24214363098145,z:-16.608498096466064},{x:364.61681365966797,y:245.71088790893555,z:-20.02823829650879},{x:365.3834533691406,y:263.34174156188965,z:-32.32996463775635},{x:361.58252716064453,y:267.8273677825928,z:-30.345816612243652},{x:365.37208557128906,y:265.0249671936035,z:-29.178667068481445},{x:372.72605895996094,y:272.05135345458984,z:-14.834434986114502},{x:360.48614501953125,y:268.34827423095703,z:-32.189905643463135},{x:359.9516296386719,y:270.8049201965332,z:-24.650139808654785},{x:369.5049285888672,y:229.01945114135742,z:10.107489824295044},{x:365.5447769165039,y:230.24096488952637,z:5.593550801277161},{x:363.50669860839844,y:230.6208372116089,z:.43622106313705444},{x:399.3529510498047,y:227.65677452087402,z:15.35965085029602,name:"leftEye"},{x:402.5693130493164,y:224.60190296173096,z:15.931552648544312}],box:{xMin:277.8318977355957,yMin:168.7741756439209,xMax:424.2788314819336,yMax:359.8348903656006,width:146.4469337463379,height:191.0607147216797}},SAMPLE_FACELANDMARKER_RESULT:{faceLandmarks:[[{x:.5760777592658997,y:.8639070391654968,z:-.030997956171631813},{x:.572094738483429,y:.7886289358139038,z:-.07189624011516571},{x:.5723551511764526,y:.8075382709503174,z:-.03578168898820877},{x:.5548420548439026,y:.7188365459442139,z:-.057787876576185226},{x:.5706077814102173,y:.7674974799156189,z:-.07740399986505508},{x:.5681378245353699,y:.7387768030166626,z:-.07356284558773041},{x:.5621535181999207,y:.6681165099143982,z:-.04189874976873398},{x:.46613582968711853,y:.6679812073707581,z:.011289681307971478},{x:.5579932928085327,y:.6174106597900391,z:-.03502821549773216},{x:.5563451647758484,y:.5905600190162659,z:-.03928658738732338},{x:.5487832427024841,y:.4900572597980499,z:-.029898937791585922},{x:.5765544176101685,y:.8692144751548767,z:-.02831427752971649},{x:.5771114230155945,y:.873644232749939,z:-.02345779910683632},{x:.5771905779838562,y:.877016007900238,z:-.016658689826726913},{x:.5778058767318726,y:.8770116567611694,z:-.014505492523312569},{x:.5783766508102417,y:.8835000991821289,z:-.015996402129530907},{x:.5792440176010132,y:.8913810849189758,z:-.01924579218029976},{x:.5796768069267273,y:.8996334671974182,z:-.018261712044477463},{x:.5817288160324097,y:.9255813956260681,z:-.007126849144697189},{x:.5726592540740967,y:.7992473244667053,z:-.0643521398305893},{x:.5579419136047363,y:.7996989488601685,z:-.04566684365272522},{x:.4216199815273285,y:.5958762764930725,z:.06776496022939682},{x:.5052269697189331,y:.6796539425849915,z:-.0010737782577052712},{x:.49243026971817017,y:.6838865876197815,z:-.0005227324436418712},{x:.4796970784664154,y:.6856290102005005,z:.002684245817363262},{x:.4618356227874756,y:.6764569878578186,z:.013439622707664967},{x:.5160380601882935,y:.6737282276153564,z:-17607348127057776e-21},{x:.48070961236953735,y:.6255870461463928,z:-.008339674212038517},{x:.49719780683517456,y:.6256808042526245,z:-.008027955889701843},{x:.46674346923828125,y:.6317623853683472,z:-.004460199736058712},{x:.4582492709159851,y:.641118049621582,z:.0011905613355338573},{x:.45408669114112854,y:.6911458969116211,z:.020514748990535736},{x:.535312294960022,y:.9619986414909363,z:.012499462813138962},{x:.4608460068702698,y:.6628725528717041,z:.01517564244568348},{x:.4206731915473938,y:.6828458309173584,z:.07848648726940155},{x:.4390624463558197,y:.6796106696128845,z:.03283142298460007},{x:.5029968619346619,y:.7701570391654968,z:-.009734481573104858},{x:.5595027208328247,y:.8607323169708252,z:-.030043255537748337},{x:.5621269941329956,y:.8738374710083008,z:-.021709579974412918},{x:.5451499819755554,y:.865527331829071,z:-.022014077752828598},{x:.5351184010505676,y:.8705098032951355,z:-.011602800339460373},{x:.5495014190673828,y:.8744956254959106,z:-.016490943729877472},{x:.5395170450210571,y:.8759440779685974,z:-.007333362940698862},{x:.5183624029159546,y:.8959754705429077,z:.010520773939788342},{x:.5604349374771118,y:.7895449995994568,z:-.07082037627696991},{x:.557381272315979,y:.7687489986419678,z:-.07590588927268982},{x:.4432901442050934,y:.6308897733688354,z:.0027153254486620426},{x:.5258325338363647,y:.7151225805282593,z:-.014676518738269806},{x:.5271827578544617,y:.7833116054534912,z:-.037643320858478546},{x:.5257382988929749,y:.7717816233634949,z:-.03401920944452286},{x:.46516409516334534,y:.7705106735229492,z:.0065747760236263275},{x:.5558893084526062,y:.7420997619628906,z:-.0694495290517807},{x:.4720408320426941,y:.6066038608551025,z:-.021204356104135513},{x:.45432573556900024,y:.6158540844917297,z:-.011054684408009052},{x:.4305151402950287,y:.5608053803443909,z:.0396830290555954},{x:.5310865640640259,y:.6157484650611877,z:-.03081176057457924},{x:.5114666223526001,y:.6329749226570129,z:-.00335998204536736},{x:.506435751914978,y:.8786543607711792,z:.012980876490473747},{x:.4480472207069397,y:.8640613555908203,z:.12569651007652283},{x:.5372058153152466,y:.7942581176757812,z:-.03168361634016037},{x:.5488379597663879,y:.8001630306243896,z:-.03280917927622795},{x:.5213388204574585,y:.8794381618499756,z:.011892606504261494},{x:.5242055654525757,y:.8789222240447998,z:.008370225317776203},{x:.4477175176143646,y:.6039950251579285,z:-.0050799972377717495},{x:.526964008808136,y:.7916748523712158,z:-.02968614175915718},{x:.4971255660057068,y:.6050706505775452,z:-.028175678104162216},{x:.4938119053840637,y:.5882453918457031,z:-.03210941329598427},{x:.4757143557071686,y:.5094879865646362,z:-.01300730835646391},{x:.43947282433509827,y:.5816648006439209,z:.01415177434682846},{x:.485664039850235,y:.5477864146232605,z:-.023685332387685776},{x:.43635931611061096,y:.6226438283920288,z:.013606148771941662},{x:.42910251021385193,y:.6102726459503174,z:.03926564007997513},{x:.5605402588844299,y:.8680099248886108,z:-.027318159118294716},{x:.5474816560745239,y:.8702861070632935,z:-.019686367362737656},{x:.5373021364212036,y:.8728838562965393,z:-.010484928265213966},{x:.540735125541687,y:.7979167103767395,z:-.029073253273963928},{x:.5228585004806519,y:.87913578748703,z:.009915109723806381},{x:.530497670173645,y:.8815253973007202,z:.0020524784922599792},{x:.5259912610054016,y:.8790552616119385,z:.007895970717072487},{x:.5433906316757202,y:.7882310748100281,z:-.05121905356645584},{x:.541388213634491,y:.8777219653129578,z:-.00466804439201951},{x:.5515822172164917,y:.8767023086547852,z:-.010475946590304375},{x:.5637003779411316,y:.877059817314148,z:-.015273625031113625},{x:.5640299320220947,y:.9263423085212708,z:-.00658724969252944},{x:.5642300248146057,y:.8993074893951416,z:-.017653480172157288},{x:.5637336373329163,y:.8910360932350159,z:-.01852807030081749},{x:.5637134313583374,y:.8837276697158813,z:-.01482592523097992},{x:.564205527305603,y:.8768964409828186,z:-.01331155002117157},{x:.5419867634773254,y:.8778373599052429,z:-.0037720394320786},{x:.5404468774795532,y:.880696177482605,z:-.005610354244709015},{x:.5392338633537292,y:.8845721483230591,z:-.007352025713771582},{x:.538469672203064,y:.8891173601150513,z:-.005154991988092661},{x:.5189250111579895,y:.8452741503715515,z:-.009755070321261883},{x:.4258975088596344,y:.7662280797958374,z:.1387351155281067},{x:.5725725293159485,y:.8041572570800781,z:-.04583907872438431},{x:.5342061519622803,y:.8785833120346069,z:.002659974154084921},{x:.5324031114578247,y:.8804071545600891,z:.0017832003068178892},{x:.5538818836212158,y:.8078407645225525,z:-.03254539892077446},{x:.5325431823730469,y:.8026832938194275,z:-.019140373915433884},{x:.5514076948165894,y:.8043903112411499,z:-.03313535451889038},{x:.5131856203079224,y:.7284771800041199,z:-.009399853646755219},{x:.49331504106521606,y:.7443980574607849,z:-.005225230939686298},{x:.5239617824554443,y:.7807451486587524,z:-.025881027802824974},{x:.4473606050014496,y:.5315827131271362,z:.011164786294102669},{x:.45718759298324585,y:.5604941248893738,z:-.005943301599472761},{x:.4670005738735199,y:.5909327268600464,z:-.019681761041283607},{x:.5311570167541504,y:.9076261520385742,z:.00389476353302598},{x:.5249923467636108,y:.5893563628196716,z:-.037981919944286346},{x:.5166932344436646,y:.5429551005363464,z:-.03319704160094261},{x:.5085030198097229,y:.49676206707954407,z:-.02691275253891945},{x:.4687720239162445,y:.6834565997123718,z:.008113506250083447},{x:.4426414966583252,y:.7069531679153442,z:.028577271848917007},{x:.5230373740196228,y:.6675713658332825,z:.001773772411979735},{x:.4481240212917328,y:.6527872085571289,z:.012414850294589996},{x:.5339856743812561,y:.7012367844581604,z:-.020220188423991203},{x:.5347223281860352,y:.7761190533638,z:-.05141595005989075},{x:.4315067231655121,y:.7211957573890686,z:.04381405934691429},{x:.45203351974487305,y:.7206180095672607,z:.017288070172071457},{x:.46892452239990234,y:.7265436053276062,z:.005602988880127668},{x:.49314674735069275,y:.7202282547950745,z:-.0006408205372281373},{x:.5104925632476807,y:.7091827392578125,z:-.00362918758764863},{x:.5232142210006714,y:.698553740978241,z:-.00787867046892643},{x:.5497883558273315,y:.6743605136871338,z:-.036349106580019},{x:.43658503890037537,y:.7627100348472595,z:.042555369436740875},{x:.4397648870944977,y:.6528646349906921,z:.017956094816327095},{x:.5653332471847534,y:.7992802858352661,z:-.06365057826042175},{x:.5285563468933105,y:.736810564994812,z:-.018836988136172295},{x:.4180678725242615,y:.6792560815811157,z:.12284679710865021},{x:.5328429937362671,y:.6865872144699097,z:-.010484723374247551},{x:.5230283141136169,y:.7809416055679321,z:-.011922398582100868},{x:.4551771283149719,y:.6650775074958801,z:.01774493046104908},{x:.5337203741073608,y:.7618928551673889,z:-.04697106033563614},{x:.43463975191116333,y:.8133478164672852,z:.1354849934577942},{x:.5225707292556763,y:.6605283617973328,z:.004980515688657761},{x:.5441933870315552,y:.7497199773788452,z:-.06091512367129326},{x:.4774007797241211,y:.9159183502197266,z:.059622734785079956},{x:.48068761825561523,y:.9364941716194153,z:.08404944837093353},{x:.4268292486667633,y:.7657528519630432,z:.09051097184419632},{x:.46051913499832153,y:.8880485892295837,z:.0738474428653717},{x:.4243420660495758,y:.6434382200241089,z:.06230505183339119},{x:.5342157483100891,y:.9835634231567383,z:.021662971004843712},{x:.5668109655380249,y:.8042187094688416,z:-.044937074184417725},{x:.5176341533660889,y:.7530587315559387,z:-.012967454269528389},{x:.430206298828125,y:.6835605502128601,z:.04612284153699875},{x:.4794231951236725,y:.6732114553451538,z:.003970044665038586},{x:.49073347449302673,y:.6722435355186462,z:.0008692514384165406},{x:.5294116139411926,y:.884677529335022,z:.004413890186697245},{x:.4430122375488281,y:.80235356092453,z:.04987282305955887},{x:.5603825449943542,y:1.0092442035675049,z:.026417359709739685},{x:.5186598300933838,y:.9828659892082214,z:.0513598807156086},{x:.5010536909103394,y:.9640932679176331,z:.06591596454381943},{x:.5524769425392151,y:.539441704750061,z:-.035816047340631485},{x:.5879997611045837,y:1.0091472864151,z:.02285068854689598},{x:.5016193985939026,y:.6684437990188599,z:.00028415941051207483},{x:.511952817440033,y:.6642197370529175,z:.0021144719794392586},{x:.5194343328475952,y:.6623469591140747,z:.004674181342124939},{x:.4321230351924896,y:.6496355533599854,z:.03124697133898735},{x:.508686363697052,y:.6479565501213074,z:-.00044765998609364033},{x:.4963986277580261,y:.6431032419204712,z:-.0032507688738405704},{x:.4845542013645172,y:.6430778503417969,z:-.002903624437749386},{x:.4733612537384033,y:.647506833076477,z:.00023347247042693198},{x:.4668654501438141,y:.653346598148346,z:.004762572236359119},{x:.41815051436424255,y:.633708119392395,z:.09809435904026031},{x:.47159942984580994,y:.6711485385894775,z:.007849935442209244},{x:.5734396576881409,y:.8256140351295471,z:-.03155219927430153},{x:.5306524038314819,y:.8337990641593933,z:-.018351426348090172},{x:.5371729135513306,y:.7910830974578857,z:-.037286680191755295},{x:.5549534559249878,y:.8275275826454163,z:-.030664825811982155},{x:.5597432255744934,y:.6418541669845581,z:-.03318847343325615},{x:.4958484172821045,y:.9429569244384766,z:.048340678215026855},{x:.5140507817268372,y:.9634028077125549,z:.03589847311377525},{x:.5587693452835083,y:.9951097369194031,z:.00908728688955307},{x:.46411189436912537,y:.9051855206489563,z:.10601935535669327},{x:.5181609392166138,y:.6554316878318787,z:.002546071307733655},{x:.5436590909957886,y:.7085841298103333,z:-.03844436630606651},{x:.5872187614440918,y:.9960382580757141,z:.0063423276878893375},{x:.5379653573036194,y:.9989125728607178,z:.03636329993605614},{x:.4350326955318451,y:.8088565468788147,z:.09147704392671585},{x:.5523084998130798,y:.8773422837257385,z:-.009068487212061882},{x:.5510149598121643,y:.8816931843757629,z:-.011043853126466274},{x:.5503793954849243,y:.88776695728302,z:-.01348799467086792},{x:.5501549243927002,y:.8954370617866516,z:-.012142189778387547},{x:.546072781085968,y:.9192524552345276,z:-.003157563041895628},{x:.5314661860466003,y:.8771666884422302,z:.0005075141089037061},{x:.5293324589729309,y:.8762547969818115,z:.00039177737198770046},{x:.5275698900222778,y:.8750609755516052,z:47732755774632096e-21},{x:.5104271173477173,y:.8607332110404968,z:.0012934643309563398},{x:.45938700437545776,y:.8134918212890625,z:.023569690063595772},{x:.5418947339057922,y:.6864100694656372,z:-.027333909645676613},{x:.531914234161377,y:.6456130743026733,z:-.005434140563011169},{x:.523697018623352,y:.647885262966156,z:-.0002466466394253075},{x:.5338191390037537,y:.8783687353134155,z:.002268768846988678},{x:.46226605772972107,y:.8610277771949768,z:.04718952998518944},{x:.5434442758560181,y:.6456181406974792,z:-.02327350154519081},{x:.5399754643440247,y:.940219521522522,z:.005075343884527683},{x:.5661457777023315,y:.71457839012146,z:-.06242101639509201},{x:.5523148775100708,y:.6974870562553406,z:-.04863070324063301},{x:.5639959573745728,y:.6923378109931946,z:-.05180761218070984},{x:.5367592573165894,y:.7423217296600342,z:-.03623027727007866},{x:.5853689908981323,y:.9752064943313599,z:-.002361974213272333},{x:.5835235118865967,y:.9493685960769653,z:-.003941743168979883},{x:.5615018606185913,y:.949194610118866,z:-.0015953965485095978},{x:.5068561434745789,y:.9048219323158264,z:.01862684078514576},{x:.5134067535400391,y:.7971825003623962,z:-.008485661819577217},{x:.5223897099494934,y:.925589919090271,z:.01249657291918993},{x:.48500555753707886,y:.7959478497505188,z:-.0032065745908766985},{x:.5037734508514404,y:.8184596300125122,z:-.004932103678584099},{x:.4766361117362976,y:.828806459903717,z:.01027688942849636},{x:.5589827299118042,y:.974656343460083,z:.0009666886180639267},{x:.5294582843780518,y:.7541216611862183,z:-.025603046640753746},{x:.4973002076148987,y:.9208990931510925,z:.031931452453136444},{x:.5163551568984985,y:.9432790875434875,z:.024321340024471283},{x:.49399662017822266,y:.8814862370491028,z:.018687399104237556},{x:.44948166608810425,y:.836137592792511,z:.05702034756541252},{x:.47898444533348083,y:.8836610913276672,z:.03150695189833641},{x:.4454479217529297,y:.8499438166618347,z:.08868525922298431},{x:.49572959542274475,y:.8452823758125305,z:.0036111653316766024},{x:.5362502336502075,y:.7222585678100586,z:-.027912352234125137},{x:.5393770337104797,y:.7850722074508667,z:-.05415399745106697},{x:.531399667263031,y:.7898418307304382,z:-.03883346915245056},{x:.5451627373695374,y:.7717036604881287,z:-.06480253487825394},{x:.5206395983695984,y:.6287745833396912,z:-.010521138086915016},{x:.4974782466888428,y:.6191938519477844,z:-.014098240062594414},{x:.4774145185947418,y:.6193130612373352,z:-.013643337413668633},{x:.4616098403930664,y:.6259890198707581,z:-.008448202162981033},{x:.4516478478908539,y:.6368461847305298,z:9050309745362028e-20},{x:.4485096037387848,y:.6719120740890503,z:.022984720766544342},{x:.42177659273147583,y:.7240667343139648,z:.08511673659086227},{x:.4616215229034424,y:.6988231539726257,z:.014238474890589714},{x:.4755798876285553,y:.7034608721733093,z:.00625590980052948},{x:.4924992024898529,y:.7005885243415833,z:.0009391739731654525},{x:.5082254409790039,y:.693384051322937,z:-.0009464038303121924},{x:.5203112959861755,y:.6849707961082458,z:-.0022114769089967012},{x:.52867591381073,y:.6779075860977173,z:-.002962538506835699},{x:.4213953912258148,y:.7219811677932739,z:.1350894570350647},{x:.5320829749107361,y:.794858992099762,z:-.03181503340601921},{x:.5452795028686523,y:.7286570072174072,z:-.04771539941430092},{x:.5496407747268677,y:.7866933345794678,z:-.06452003121376038},{x:.557040274143219,y:.7962084412574768,z:-.05837344378232956},{x:.549176812171936,y:.7895247936248779,z:-.057761140167713165},{x:.5362890362739563,y:.8005836606025696,z:-.026903774589300156},{x:.560200035572052,y:.7983731031417847,z:-.06172555685043335},{x:.5616944432258606,y:.8022753596305847,z:-.045200999826192856},{x:.5273328423500061,y:.6611284017562866,z:.0029021520167589188},{x:.534850537776947,y:.6660012006759644,z:-.005215510260313749},{x:.5394860506057739,y:.6701375246047974,z:-.014931917190551758},{x:.4634307324886322,y:.658291757106781,z:.009295716881752014},{x:.4538393020629883,y:.6519932150840759,z:.00930330716073513},{x:.5776031613349915,y:.7159298658370972,z:-.057365912944078445},{x:.6504855155944824,y:.6461779475212097,z:.014184834435582161},{x:.5860154032707214,y:.7962266206741333,z:-.04522843658924103},{x:.6842049360275269,y:.5631637573242188,z:.07207967340946198},{x:.6152560710906982,y:.6674962639808655,z:.0007529259892180562},{x:.6280948519706726,y:.6684326529502869,z:.0016892586136236787},{x:.6408625245094299,y:.6663892269134521,z:.005331226624548435},{x:.6557814478874207,y:.6534678936004639,z:.01646413467824459},{x:.6035663485527039,y:.6639701724052429,z:.0013799630105495453},{x:.6329053044319153,y:.608010470867157,z:-.006195899099111557},{x:.6167260408401489,y:.6117533445358276,z:-.006319951266050339},{x:.6471013426780701,y:.6112449765205383,z:-.0017843559617176652},{x:.6560901999473572,y:.6185776591300964,z:.004047257360070944},{x:.6666946411132812,y:.6651176810264587,z:.023647578433156013},{x:.6311345100402832,y:.9495396018028259,z:.014004078693687916},{x:.6544655561447144,y:.6397901773452759,z:.01809609681367874},{x:.6965808868408203,y:.6482675075531006,z:.08304904401302338},{x:.679817259311676,y:.650188148021698,z:.03632688894867897},{x:.6336516737937927,y:.7541458010673523,z:-.007742783520370722},{x:.5921701192855835,y:.8567668199539185,z:-.029399123042821884},{x:.591663658618927,y:.870215654373169,z:-.02103729173541069},{x:.6068367958068848,y:.8584195375442505,z:-.020668085664510727},{x:.6176617741584778,y:.860965371131897,z:-.009790095500648022},{x:.6040634512901306,y:.8686612844467163,z:-.015289564616978168},{x:.6143736839294434,y:.8671170473098755,z:-.005712216719985008},{x:.6373105049133301,y:.8815656900405884,z:.012672550976276398},{x:.5832505822181702,y:.7866312861442566,z:-.07051534950733185},{x:.5836675763130188,y:.7658692598342896,z:-.07566110789775848},{x:.6709531545639038,y:.604898989200592,z:.005951565690338612},{x:.6029891967773438,y:.705652117729187,z:-.013388276100158691},{x:.6131622195243835,y:.7728396058082581,z:-.036248479038476944},{x:.6123163104057312,y:.7612020373344421,z:-.03264721855521202},{x:.6696187853813171,y:.744706928730011,z:.009673702530562878},{x:.5803102254867554,y:.7385968565940857,z:-.0689152330160141},{x:.6404349207878113,y:.5877999663352966,z:-.01929756999015808},{x:.6588467955589294,y:.5929454565048218,z:-.008487257175147533},{x:.6720337867736816,y:.530631422996521,z:.043437421321868896},{x:.584305465221405,y:.6099005341529846,z:-.030301367864012718},{x:.6034283638000488,y:.6217452883720398,z:-.001970183802768588},{x:.6460927724838257,y:.8608663082122803,z:.015541625209152699},{x:.6957815289497375,y:.8326103091239929,z:.13015234470367432},{x:.6043362617492676,y:.7861682772636414,z:-.030476901680231094},{x:.594293475151062,y:.7942103147506714,z:-.032218821346759796},{x:.6324057579040527,y:.8665139675140381,z:.014255806803703308},{x:.6296147704124451,y:.8667733669281006,z:.010388285852968693},{x:.663644552230835,y:.5798642635345459,z:-.0022301070857793093},{x:.6140630841255188,y:.7809288501739502,z:-.02835679054260254},{x:.615908145904541,y:.5921698212623596,z:-.026804860681295395},{x:.617181122303009,y:.5748661756515503,z:-.03060605563223362},{x:.6222207546234131,y:.49137672781944275,z:-.011151673272252083},{x:.6669357419013977,y:.5541607141494751,z:.017466170713305473},{x:.6182981729507446,y:.5320425629615784,z:-.021793590858578682},{x:.6760554313659668,y:.595052182674408,z:.017115700989961624},{x:.6801463961601257,y:.5800720453262329,z:.043127160519361496},{x:.5922210812568665,y:.8644017577171326,z:-.02662893570959568},{x:.6054555177688599,y:.8637874722480774,z:-.018363753333687782},{x:.6161889433860779,y:.8641164898872375,z:-.008808949030935764},{x:.6017249822616577,y:.7901403307914734,z:-.028126630932092667},{x:.631446123123169,y:.8664817810058594,z:.012112865224480629},{x:.6249198913574219,y:.8716511130332947,z:.003882825840264559},{x:.6281915903091431,y:.867301881313324,z:.009891441091895103},{x:.5986843109130859,y:.7813931703567505,z:-.050227612257003784},{x:.6126407384872437,y:.869275689125061,z:-.0031255714129656553},{x:.6027271151542664,y:.8711842894554138,z:-.009324162267148495},{x:.59088134765625,y:.8742044568061829,z:-.014608660712838173},{x:.5984604358673096,y:.9216185212135315,z:-.005981989670544863},{x:.5950398445129395,y:.8964707255363464,z:-.01703473925590515},{x:.5941568613052368,y:.8882410526275635,z:-.017784785479307175},{x:.5928806662559509,y:.8803883194923401,z:-.014153128489851952},{x:.5909661054611206,y:.8748103976249695,z:-.012609979137778282},{x:.6128016710281372,y:.8702545762062073,z:-.0022550546564161777},{x:.6150846481323242,y:.8726804256439209,z:-.00414019962772727},{x:.6173093914985657,y:.8770190477371216,z:-.005970994010567665},{x:.619335412979126,y:.8814800977706909,z:-.0036864024586975574},{x:.6292637586593628,y:.8314558267593384,z:-.007714875973761082},{x:.702275276184082,y:.7320667505264282,z:.1433621346950531},{x:.6204835176467896,y:.8689177632331848,z:.0044869170524179935},{x:.6223508715629578,y:.8704851269721985,z:.00352082890458405},{x:.590448260307312,y:.8029727935791016,z:-.03200828656554222},{x:.6097423434257507,y:.7933741211891174,z:-.018042555078864098},{x:.59229576587677,y:.7993767261505127,z:-.032564569264650345},{x:.6171364188194275,y:.7153720259666443,z:-.007672437466681004},{x:.6389747858047485,y:.726390540599823,z:-.002999067772179842},{x:.6151940226554871,y:.769412100315094,z:-.024427521973848343},{x:.6526776552200317,y:.505868136882782,z:.01412637997418642},{x:.6475822329521179,y:.5375454425811768,z:-.0033899128902703524},{x:.6433356404304504,y:.5714520215988159,z:-.017428796738386154},{x:.626949667930603,y:.8962116837501526,z:.005602736957371235},{x:.5868416428565979,y:.5829002261161804,z:-.03727729618549347},{x:.5877229571342468,y:.5345035791397095,z:-.032396964728832245},{x:.5887066125869751,y:.48655083775520325,z:-.025856535881757736},{x:.6507197618484497,y:.6612282991409302,z:.011114613153040409},{x:.6803066730499268,y:.677992045879364,z:.032125361263751984},{x:.5963194370269775,y:.6598632335662842,z:.002976928371936083},{x:.667536199092865,y:.6274255514144897,z:.015618261881172657},{x:.5930740833282471,y:.6940041780471802,z:-.019217798486351967},{x:.6053346395492554,y:.7676517963409424,z:-.050308309495449066},{x:.6934473514556885,y:.6884298920631409,z:.04794462397694588},{x:.6738007664680481,y:.6934011578559875,z:.020697161555290222},{x:.6588084697723389,y:.7033141851425171,z:.008462334051728249},{x:.6346072554588318,y:.7029502391815186,z:.001542167621664703},{x:.6157816648483276,y:.6966525912284851,z:-.002009218093007803},{x:.6015574336051941,y:.688928484916687,z:-.006588225718587637},{x:.5746836066246033,y:.6711069345474243,z:-.03597589209675789},{x:.6947521567344666,y:.7309479117393494,z:.046707939356565475},{x:.6759101152420044,y:.6249120831489563,z:.021654341369867325},{x:.5794773101806641,y:.7971615195274353,z:-.06339326500892639},{x:.6041849851608276,y:.727514922618866,z:-.017512541264295578},{x:.6968844532966614,y:.6440950036048889,z:.12727996706962585},{x:.5910853147506714,y:.679325520992279,z:-.009497715160250664},{x:.6157375574111938,y:.7695677280426025,z:-.010624290443956852},{x:.6606494784355164,y:.6410489678382874,z:.0208158977329731},{x:.6040687561035156,y:.7531470656394958,z:-.045887019485235214},{x:.7012156248092651,y:.780247151851654,z:.14028730988502502},{x:.595149576663971,y:.6527782678604126,z:.006308757700026035},{x:.5925500392913818,y:.7436665892601013,z:-.060151755809783936},{x:.6780198812484741,y:.8905693888664246,z:.0626060739159584},{x:.676746666431427,y:.9113880395889282,z:.08726003766059875},{x:.7030686140060425,y:.7312687635421753,z:.09529774636030197},{x:.688987135887146,y:.8588417172431946,z:.07752864807844162},{x:.6883691549301147,y:.6109960675239563,z:.06669612973928452},{x:.6358906030654907,y:.9702065587043762,z:.023120900616049767},{x:.5781539678573608,y:.8023634552955627,z:-.044763918966054916},{x:.6170316934585571,y:.7408350706100464,z:-.011375460773706436},{x:.688542366027832,y:.6516284346580505,z:.050206027925014496},{x:.6385149359703064,y:.6540714502334595,z:.006462941411882639},{x:.6279382109642029,y:.6563615798950195,z:.003062846139073372},{x:.6268895268440247,y:.8736732006072998,z:.00627936702221632},{x:.6944946050643921,y:.7709181308746338,z:.053824134171009064},{x:.614617109298706,y:1.0022112131118774,z:.02719894051551819},{x:.6493719220161438,y:.9665167927742004,z:.053563784807920456},{x:.6624587178230286,y:.943530797958374,z:.068605437874794},{x:.6162528991699219,y:.6558693051338196,z:.002187855076044798},{x:.6058168411254883,y:.654328465461731,z:.0036193584091961384},{x:.5987918972969055,y:.6536934971809387,z:.006134530063718557},{x:.6831037402153015,y:.6195642948150635,z:.03511790186166763},{x:.6062582731246948,y:.6356398463249207,z:.001280312892049551},{x:.6174948811531067,y:.62776118516922,z:-.0013642468256875873},{x:.6297246217727661,y:.6253792643547058,z:-.0007034156005829573},{x:.6407091617584229,y:.627578616142273,z:.0028144705574959517},{x:.6479622721672058,y:.6322650909423828,z:.00750273372977972},{x:.6915091276168823,y:.5990704298019409,z:.10270945727825165},{x:.6457163095474243,y:.6504453420639038,z:.010696077719330788},{x:.6164222955703735,y:.8231936097145081,z:-.016772059723734856},{x:.6042401194572449,y:.7830976843833923,z:-.03630910441279411},{x:.5922216773033142,y:.8228387236595154,z:-.029992375522851944},{x:.6646111011505127,y:.92097008228302,z:.050967294722795486},{x:.651232898235321,y:.9460107088088989,z:.038000158965587616},{x:.6140977144241333,y:.9882472157478333,z:.009882091544568539},{x:.6870781183242798,y:.8768675327301025,z:.10980932414531708},{x:.5986856818199158,y:.6456438899040222,z:.003999010659754276},{x:.585981547832489,y:.7034481763839722,z:-.0377722829580307},{x:.6342031359672546,y:.9867448806762695,z:.03786521404981613},{x:.7013950943946838,y:.776049017906189,z:.09598205983638763},{x:.6030206680297852,y:.8719133138656616,z:-.007931148633360863},{x:.6050592064857483,y:.8767156004905701,z:-.009791925549507141},{x:.6073468923568726,y:.8831382393836975,z:-.012361008673906326},{x:.6087977290153503,y:.890143632888794,z:-.01098148338496685},{x:.6147705316543579,y:.9110084772109985,z:-.0018823575228452682},{x:.622577965259552,y:.8670604825019836,z:.002609190298244357},{x:.6241236329078674,y:.8651344180107117,z:.0025534380692988634},{x:.6257084608078003,y:.8638408184051514,z:.0023300074972212315},{x:.639931321144104,y:.8449671268463135,z:.0038123116828501225},{x:.6810906529426575,y:.7856625318527222,z:.02717764675617218},{x:.583532452583313,y:.6811994910240173,z:-.026588857173919678},{x:.5855660438537598,y:.6393819451332092,z:-.004512844607234001},{x:.5932201743125916,y:.6398029327392578,z:.0008020466193556786},{x:.6200879812240601,y:.8683351874351501,z:.00417016725987196},{x:.6842559576034546,y:.8330534100532532,z:.050836317241191864},{x:.5754412412643433,y:.6418221592903137,z:-.022838059812784195},{x:.6232790350914001,y:.9295297265052795,z:.006339520215988159},{x:.5764067769050598,y:.694546639919281,z:-.04825803264975548},{x:.59778892993927,y:.7343927621841431,z:-.035004377365112305},{x:.6042810678482056,y:.9441440105438232,z:-.0010970570147037506},{x:.6496372222900391,y:.8869078159332275,z:.021036235615611076},{x:.6274012327194214,y:.7830310463905334,z:-.006658440921455622},{x:.637792706489563,y:.9104999899864197,z:.014290250837802887},{x:.6549934148788452,y:.7748609185218811,z:-.0006672973395325243},{x:.6404005289077759,y:.801220715045929,z:-.0026642554439604282},{x:.6671456694602966,y:.8045546412467957,z:.013180811889469624},{x:.6107483506202698,y:.9680658578872681,z:.001778992242179811},{x:.6060343980789185,y:.744587242603302,z:-.024382334202528},{x:.6602751612663269,y:.8998945355415344,z:.0344940721988678},{x:.6463775038719177,y:.9262562394142151,z:.02617623284459114},{x:.6579852104187012,y:.8602304458618164,z:.021586716175079346},{x:.6926165223121643,y:.8053340315818787,z:.061075080186128616},{x:.6724731922149658,y:.8594399690628052,z:.03457934781908989},{x:.6975721716880798,y:.8183245062828064,z:.09300774335861206},{x:.6512877941131592,y:.8258221745491028,z:.006324059329926968},{x:.594887375831604,y:.7148372530937195,z:-.026898479089140892},{x:.6017440557479858,y:.7773507833480835,z:-.05312420800328255},{x:.6096571683883667,y:.7806998491287231,z:-.037646256387233734},{x:.5952993035316467,y:.7654367685317993,z:-.06398405134677887},{x:.5950021147727966,y:.6201304793357849,z:-.009297547861933708},{x:.6165438890457153,y:.6052900552749634,z:-.012455573305487633},{x:.6362661719322205,y:.6015968918800354,z:-.011649220250546932},{x:.6522727608680725,y:.6046400666236877,z:-.005903332494199276},{x:.6625409722328186,y:.6128141283988953,z:.0030042496509850025},{x:.6688099503517151,y:.6457712054252625,z:.026322703808546066},{x:.7013440728187561,y:.6893666386604309,z:.08984331786632538},{x:.6608623266220093,y:.6749406456947327,z:.0172116681933403},{x:.6482325196266174,y:.6823726296424866,z:.008881398476660252},{x:.6313265562057495,y:.6842025518417358,z:.0031308617908507586},{x:.6147016286849976,y:.6809731721878052,z:.0007630771724507213},{x:.6018834114074707,y:.6755372285842896,z:-.0008834321051836014},{x:.5925027132034302,y:.670681357383728,z:-.001968748401850462},{x:.700127363204956,y:.6871103644371033,z:.13980500400066376},{x:.6095665693283081,y:.7853189706802368,z:-.03074747882783413},{x:.5880423784255981,y:.7229287028312683,z:-.04691500961780548},{x:.5930182337760925,y:.7811514139175415,z:-.06398335844278336},{x:.5867722034454346,y:.7922660112380981,z:-.05794971063733101},{x:.5933279991149902,y:.7842848896980286,z:-.05714067071676254},{x:.6063535809516907,y:.7920218706130981,z:-.02590685710310936},{x:.5839452743530273,y:.794978141784668,z:-.0615212507545948},{x:.5828126072883606,y:.8000800013542175,z:-.0449722595512867},{x:.5909603834152222,y:.6541213393211365,z:.003991890233010054},{x:.5852181911468506,y:.6602938771247864,z:-.004428438376635313},{x:.5825737714767456,y:.6651063561439514,z:-.014345290139317513},{x:.6517343521118164,y:.6362385153770447,z:.012151890434324741},{x:.6615052819252014,y:.6281577944755554,z:.0123682152479887},{x:.4856873154640198,y:.6568945646286011,z:.000720038078725338},{x:.49988406896591187,y:.6547410488128662,z:.0006949726957827806},{x:.48438939452171326,y:.6392973065376282,z:.000705525919329375},{x:.47143134474754333,y:.6589511632919312,z:.0006980331381782889},{x:.48704618215560913,y:.6752797961235046,z:.0006921177846379578},{x:.6243702173233032,y:.640461802482605,z:-6592126737814397e-20},{x:.6390967965126038,y:.6385173797607422,z:-.00016105435497593135},{x:.6230536699295044,y:.6224825382232666,z:-.00016136496560648084},{x:.6095397472381592,y:.641917884349823,z:-.0001803556369850412},{x:.6250996589660645,y:.6586247682571411,z:-.0001785515050869435}]],faceBlendshapes:[{categories:[{index:0,score:5187174338061595e-21,categoryName:"_neutral",displayName:""},{index:1,score:.24521504342556,categoryName:"browDownLeft",displayName:""},{index:2,score:.1987743377685547,categoryName:"browDownRight",displayName:""},{index:3,score:.013400448486208916,categoryName:"browInnerUp",displayName:""},{index:4,score:.012361560948193073,categoryName:"browOuterUpLeft",displayName:""},{index:5,score:.019305096939206123,categoryName:"browOuterUpRight",displayName:""},{index:6,score:28426356948330067e-21,categoryName:"cheekPuff",displayName:""},{index:7,score:34500112633395474e-23,categoryName:"cheekSquintLeft",displayName:""},{index:8,score:483789051486383e-21,categoryName:"cheekSquintRight",displayName:""},{index:9,score:.07650448381900787,categoryName:"eyeBlinkLeft",displayName:""},{index:10,score:.05070012807846069,categoryName:"eyeBlinkRight",displayName:""},{index:11,score:.13978900015354156,categoryName:"eyeLookDownLeft",displayName:""},{index:12,score:.14198613166809082,categoryName:"eyeLookDownRight",displayName:""},{index:13,score:.2177766114473343,categoryName:"eyeLookInLeft",displayName:""},{index:14,score:.014739357866346836,categoryName:"eyeLookInRight",displayName:""},{index:15,score:.02361512929201126,categoryName:"eyeLookOutLeft",displayName:""},{index:16,score:.19679604470729828,categoryName:"eyeLookOutRight",displayName:""},{index:17,score:.04874616861343384,categoryName:"eyeLookUpLeft",displayName:""},{index:18,score:.049392376095056534,categoryName:"eyeLookUpRight",displayName:""},{index:19,score:.34944331645965576,categoryName:"eyeSquintLeft",displayName:""},{index:20,score:.2939716875553131,categoryName:"eyeSquintRight",displayName:""},{index:21,score:.005955042317509651,categoryName:"eyeWideLeft",displayName:""},{index:22,score:.006776117719709873,categoryName:"eyeWideRight",displayName:""},{index:23,score:16942436559475027e-21,categoryName:"jawForward",displayName:""},{index:24,score:.0045165494084358215,categoryName:"jawLeft",displayName:""},{index:25,score:.07803940027952194,categoryName:"jawOpen",displayName:""},{index:26,score:2090057751047425e-20,categoryName:"jawRight",displayName:""},{index:27,score:.06032035872340202,categoryName:"mouthClose",displayName:""},{index:28,score:.00228882092051208,categoryName:"mouthDimpleLeft",displayName:""},{index:29,score:.00781762320548296,categoryName:"mouthDimpleRight",displayName:""},{index:30,score:.0017093931091949344,categoryName:"mouthFrownLeft",displayName:""},{index:31,score:.0019319106359034777,categoryName:"mouthFrownRight",displayName:""},{index:32,score:8485237776767462e-20,categoryName:"mouthFunnel",displayName:""},{index:33,score:.0009051355300471187,categoryName:"mouthLeft",displayName:""},{index:34,score:.0003630454302765429,categoryName:"mouthLowerDownLeft",displayName:""},{index:35,score:.00017601238505449146,categoryName:"mouthLowerDownRight",displayName:""},{index:36,score:.12865161895751953,categoryName:"mouthPressLeft",displayName:""},{index:37,score:.20137207210063934,categoryName:"mouthPressRight",displayName:""},{index:38,score:.0022203284315764904,categoryName:"mouthPucker",displayName:""},{index:39,score:.0009096377179957926,categoryName:"mouthRight",displayName:""},{index:40,score:.34189721941947937,categoryName:"mouthRollLower",displayName:""},{index:41,score:.11409689486026764,categoryName:"mouthRollUpper",displayName:""},{index:42,score:.17172536253929138,categoryName:"mouthShrugLower",displayName:""},{index:43,score:.004038424696773291,categoryName:"mouthShrugUpper",displayName:""},{index:44,score:.00023205230536404997,categoryName:"mouthSmileLeft",displayName:""},{index:45,score:.00019313619122840464,categoryName:"mouthSmileRight",displayName:""},{index:46,score:.0018571305554360151,categoryName:"mouthStretchLeft",displayName:""},{index:47,score:.0023813238367438316,categoryName:"mouthStretchRight",displayName:""},{index:48,score:24323100660694763e-21,categoryName:"mouthUpperUpLeft",displayName:""},{index:49,score:3161552012898028e-20,categoryName:"mouthUpperUpRight",displayName:""},{index:50,score:108198406678639e-21,categoryName:"noseSneerLeft",displayName:""},{index:51,score:12652527630052646e-22,categoryName:"noseSneerRight",displayName:""}],headIndex:-1,headName:""}],facialTransformationMatrixes:[{rows:4,columns:4,data:[.9947517514228821,.10230544209480286,.0013679931871592999,0,-.10230997204780579,.9947447776794434,.003816320328041911,0,-.000970348424743861,-.0039362297393381596,.9999914169311523,0,2.8888821601867676,-7.808934211730957,-30.52109146118164,1]}]}},FaceLandmarkerContext=reactExports.createContext({}),FaceLandmarkerDefaults={basePath:"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.17/wasm",options:{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",outputFaceBlendshapes:!0,outputFacialTransformationMatrixes:!0}},FaceLandmarker=reactExports.forwardRef(({basePath:K=FaceLandmarkerDefaults.basePath,options:_=FaceLandmarkerDefaults.options,children:Z},te)=>{const ne=JSON.stringify(_),ie=suspend$1(async()=>{const{FilesetResolver:oe,FaceLandmarker:se}=await __vitePreload(async()=>{const{FilesetResolver:le,FaceLandmarker:ce}=await import("./chunk-Cg0OFbR3.js");return{FilesetResolver:le,FaceLandmarker:ce}},[]),ae=await oe.forVisionTasks(K);return se.createFromOptions(ae,_)},[K,ne]);return reactExports.useEffect(()=>()=>{ie==null||ie.close(),clear$1([K,ne])},[ie,K,ne]),reactExports.useImperativeHandle(te,()=>ie,[ie]),reactExports.createElement(FaceLandmarkerContext.Provider,{value:ie},Z)});function useFaceLandmarker(){return reactExports.useContext(FaceLandmarkerContext)}const CENTER=0,AVERAGE=1,SAH=2,CONTAINED=2,TRIANGLE_INTERSECT_COST=1.25,TRAVERSAL_COST=1,BYTES_PER_NODE=6*4+4+4,IS_LEAFNODE_FLAG=65535,FLOAT32_EPSILON=Math.pow(2,-24),SKIP_GENERATION=Symbol("SKIP_GENERATION");function getVertexCount(K){return K.index?K.index.count:K.attributes.position.count}function getTriCount(K){return getVertexCount(K)/3}function getIndexArray(K,_=ArrayBuffer){return K>65535?new Uint32Array(new _(4*K)):new Uint16Array(new _(2*K))}function ensureIndex(K,_){if(!K.index){const Z=K.attributes.position.count,te=_.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,ne=getIndexArray(Z,te);K.setIndex(new BufferAttribute(ne,1));for(let ie=0;ie<Z;ie++)ne[ie]=ie}}function getFullGeometryRange(K,_){const Z=getTriCount(K),te=_||K.drawRange,ne=te.start/3,ie=(te.start+te.count)/3,oe=Math.max(0,ne),se=Math.min(Z,ie)-oe;return[{offset:Math.floor(oe),count:Math.floor(se)}]}function getRootIndexRanges(K,_){if(!K.groups||!K.groups.length)return getFullGeometryRange(K,_);const Z=[],te=new Set,ne=_||K.drawRange,ie=ne.start/3,oe=(ne.start+ne.count)/3;for(const ae of K.groups){const le=ae.start/3,ce=(ae.start+ae.count)/3;te.add(Math.max(ie,le)),te.add(Math.min(oe,ce))}const se=Array.from(te.values()).sort((ae,le)=>ae-le);for(let ae=0;ae<se.length-1;ae++){const le=se[ae],ce=se[ae+1];Z.push({offset:Math.floor(le),count:Math.floor(ce-le)})}return Z}function hasGroupGaps(K,_){const Z=getTriCount(K),te=getRootIndexRanges(K,_).sort((oe,se)=>oe.offset-se.offset),ne=te[te.length-1];ne.count=Math.min(Z-ne.offset,ne.count);let ie=0;return te.forEach(({count:oe})=>ie+=oe),Z!==ie}function getBounds(K,_,Z,te,ne){let ie=1/0,oe=1/0,se=1/0,ae=-1/0,le=-1/0,ce=-1/0,fe=1/0,de=1/0,pe=1/0,he=-1/0,ge=-1/0,me=-1/0;for(let Ae=_*6,ye=(_+Z)*6;Ae<ye;Ae+=6){const ve=K[Ae+0],_e=K[Ae+1],Te=ve-_e,be=ve+_e;Te<ie&&(ie=Te),be>ae&&(ae=be),ve<fe&&(fe=ve),ve>he&&(he=ve);const Re=K[Ae+2],we=K[Ae+3],Pe=Re-we,Ie=Re+we;Pe<oe&&(oe=Pe),Ie>le&&(le=Ie),Re<de&&(de=Re),Re>ge&&(ge=Re);const $e=K[Ae+4],Ue=K[Ae+5],ke=$e-Ue,Ge=$e+Ue;ke<se&&(se=ke),Ge>ce&&(ce=Ge),$e<pe&&(pe=$e),$e>me&&(me=$e)}te[0]=ie,te[1]=oe,te[2]=se,te[3]=ae,te[4]=le,te[5]=ce,ne[0]=fe,ne[1]=de,ne[2]=pe,ne[3]=he,ne[4]=ge,ne[5]=me}function computeTriangleBounds(K,_=null,Z=null,te=null){const ne=K.attributes.position,ie=K.index?K.index.array:null,oe=getTriCount(K),se=ne.normalized;let ae;_===null?(ae=new Float32Array(oe*6*4),Z=0,te=oe):(ae=_,Z=Z||0,te=te||oe);const le=ne.array,ce=ne.offset||0;let fe=3;ne.isInterleavedBufferAttribute&&(fe=ne.data.stride);const de=["getX","getY","getZ"];for(let pe=Z;pe<Z+te;pe++){const he=pe*3,ge=pe*6;let me=he+0,Ae=he+1,ye=he+2;ie&&(me=ie[me],Ae=ie[Ae],ye=ie[ye]),se||(me=me*fe+ce,Ae=Ae*fe+ce,ye=ye*fe+ce);for(let ve=0;ve<3;ve++){let _e,Te,be;se?(_e=ne[de[ve]](me),Te=ne[de[ve]](Ae),be=ne[de[ve]](ye)):(_e=le[me+ve],Te=le[Ae+ve],be=le[ye+ve]);let Re=_e;Te<Re&&(Re=Te),be<Re&&(Re=be);let we=_e;Te>we&&(we=Te),be>we&&(we=be);const Pe=(we-Re)/2,Ie=ve*2;ae[ge+Ie+0]=Re+Pe,ae[ge+Ie+1]=Pe+(Math.abs(Re)+Pe)*FLOAT32_EPSILON}}return ae}function arrayToBox(K,_,Z){return Z.min.x=_[K],Z.min.y=_[K+1],Z.min.z=_[K+2],Z.max.x=_[K+3],Z.max.y=_[K+4],Z.max.z=_[K+5],Z}function getLongestEdgeIndex(K){let _=-1,Z=-1/0;for(let te=0;te<3;te++){const ne=K[te+3]-K[te];ne>Z&&(Z=ne,_=te)}return _}function copyBounds(K,_){_.set(K)}function unionBounds(K,_,Z){let te,ne;for(let ie=0;ie<3;ie++){const oe=ie+3;te=K[ie],ne=_[ie],Z[ie]=te<ne?te:ne,te=K[oe],ne=_[oe],Z[oe]=te>ne?te:ne}}function expandByTriangleBounds(K,_,Z){for(let te=0;te<3;te++){const ne=_[K+2*te],ie=_[K+2*te+1],oe=ne-ie,se=ne+ie;oe<Z[te]&&(Z[te]=oe),se>Z[te+3]&&(Z[te+3]=se)}}function computeSurfaceArea(K){const _=K[3]-K[0],Z=K[4]-K[1],te=K[5]-K[2];return 2*(_*Z+Z*te+te*_)}const BIN_COUNT=32,binsSort=(K,_)=>K.candidate-_.candidate,sahBins=new Array(BIN_COUNT).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),leftBounds=new Float32Array(6);function getOptimalSplit(K,_,Z,te,ne,ie){let oe=-1,se=0;if(ie===CENTER)oe=getLongestEdgeIndex(_),oe!==-1&&(se=(_[oe]+_[oe+3])/2);else if(ie===AVERAGE)oe=getLongestEdgeIndex(K),oe!==-1&&(se=getAverage(Z,te,ne,oe));else if(ie===SAH){const ae=computeSurfaceArea(K);let le=TRIANGLE_INTERSECT_COST*ne;const ce=te*6,fe=(te+ne)*6;for(let de=0;de<3;de++){const pe=_[de],me=(_[de+3]-pe)/BIN_COUNT;if(ne<BIN_COUNT/4){const Ae=[...sahBins];Ae.length=ne;let ye=0;for(let _e=ce;_e<fe;_e+=6,ye++){const Te=Ae[ye];Te.candidate=Z[_e+2*de],Te.count=0;const{bounds:be,leftCacheBounds:Re,rightCacheBounds:we}=Te;for(let Pe=0;Pe<3;Pe++)we[Pe]=1/0,we[Pe+3]=-1/0,Re[Pe]=1/0,Re[Pe+3]=-1/0,be[Pe]=1/0,be[Pe+3]=-1/0;expandByTriangleBounds(_e,Z,be)}Ae.sort(binsSort);let ve=ne;for(let _e=0;_e<ve;_e++){const Te=Ae[_e];for(;_e+1<ve&&Ae[_e+1].candidate===Te.candidate;)Ae.splice(_e+1,1),ve--}for(let _e=ce;_e<fe;_e+=6){const Te=Z[_e+2*de];for(let be=0;be<ve;be++){const Re=Ae[be];Te>=Re.candidate?expandByTriangleBounds(_e,Z,Re.rightCacheBounds):(expandByTriangleBounds(_e,Z,Re.leftCacheBounds),Re.count++)}}for(let _e=0;_e<ve;_e++){const Te=Ae[_e],be=Te.count,Re=ne-Te.count,we=Te.leftCacheBounds,Pe=Te.rightCacheBounds;let Ie=0;be!==0&&(Ie=computeSurfaceArea(we)/ae);let $e=0;Re!==0&&($e=computeSurfaceArea(Pe)/ae);const Ue=TRAVERSAL_COST+TRIANGLE_INTERSECT_COST*(Ie*be+$e*Re);Ue<le&&(oe=de,le=Ue,se=Te.candidate)}}else{for(let ve=0;ve<BIN_COUNT;ve++){const _e=sahBins[ve];_e.count=0,_e.candidate=pe+me+ve*me;const Te=_e.bounds;for(let be=0;be<3;be++)Te[be]=1/0,Te[be+3]=-1/0}for(let ve=ce;ve<fe;ve+=6){let be=~~((Z[ve+2*de]-pe)/me);be>=BIN_COUNT&&(be=BIN_COUNT-1);const Re=sahBins[be];Re.count++,expandByTriangleBounds(ve,Z,Re.bounds)}const Ae=sahBins[BIN_COUNT-1];copyBounds(Ae.bounds,Ae.rightCacheBounds);for(let ve=BIN_COUNT-2;ve>=0;ve--){const _e=sahBins[ve],Te=sahBins[ve+1];unionBounds(_e.bounds,Te.rightCacheBounds,_e.rightCacheBounds)}let ye=0;for(let ve=0;ve<BIN_COUNT-1;ve++){const _e=sahBins[ve],Te=_e.count,be=_e.bounds,we=sahBins[ve+1].rightCacheBounds;Te!==0&&(ye===0?copyBounds(be,leftBounds):unionBounds(be,leftBounds,leftBounds)),ye+=Te;let Pe=0,Ie=0;ye!==0&&(Pe=computeSurfaceArea(leftBounds)/ae);const $e=ne-ye;$e!==0&&(Ie=computeSurfaceArea(we)/ae);const Ue=TRAVERSAL_COST+TRIANGLE_INTERSECT_COST*(Pe*ye+Ie*$e);Ue<le&&(oe=de,le=Ue,se=_e.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${ie} used.`);return{axis:oe,pos:se}}function getAverage(K,_,Z,te){let ne=0;for(let ie=_,oe=_+Z;ie<oe;ie++)ne+=K[ie*6+te*2];return ne/Z}class MeshBVHNode{constructor(){this.boundingData=new Float32Array(6)}}function partition(K,_,Z,te,ne,ie){let oe=te,se=te+ne-1;const ae=ie.pos,le=ie.axis*2;for(;;){for(;oe<=se&&Z[oe*6+le]<ae;)oe++;for(;oe<=se&&Z[se*6+le]>=ae;)se--;if(oe<se){for(let ce=0;ce<3;ce++){let fe=_[oe*3+ce];_[oe*3+ce]=_[se*3+ce],_[se*3+ce]=fe}for(let ce=0;ce<6;ce++){let fe=Z[oe*6+ce];Z[oe*6+ce]=Z[se*6+ce],Z[se*6+ce]=fe}oe++,se--}else return oe}}function partition_indirect(K,_,Z,te,ne,ie){let oe=te,se=te+ne-1;const ae=ie.pos,le=ie.axis*2;for(;;){for(;oe<=se&&Z[oe*6+le]<ae;)oe++;for(;oe<=se&&Z[se*6+le]>=ae;)se--;if(oe<se){let ce=K[oe];K[oe]=K[se],K[se]=ce;for(let fe=0;fe<6;fe++){let de=Z[oe*6+fe];Z[oe*6+fe]=Z[se*6+fe],Z[se*6+fe]=de}oe++,se--}else return oe}}function IS_LEAF(K,_){return _[K+15]===65535}function OFFSET(K,_){return _[K+6]}function COUNT(K,_){return _[K+14]}function LEFT_NODE(K){return K+8}function RIGHT_NODE(K,_){return _[K+6]}function SPLIT_AXIS(K,_){return _[K+7]}function BOUNDING_DATA_INDEX(K){return K}let float32Array,uint32Array,uint16Array,uint8Array;const MAX_POINTER=Math.pow(2,32);function countNodes(K){return"count"in K?1:1+countNodes(K.left)+countNodes(K.right)}function populateBuffer(K,_,Z){return float32Array=new Float32Array(Z),uint32Array=new Uint32Array(Z),uint16Array=new Uint16Array(Z),uint8Array=new Uint8Array(Z),_populateBuffer(K,_)}function _populateBuffer(K,_){const Z=K/4,te=K/2,ne="count"in _,ie=_.boundingData;for(let oe=0;oe<6;oe++)float32Array[Z+oe]=ie[oe];if(ne)if(_.buffer){const oe=_.buffer;uint8Array.set(new Uint8Array(oe),K);for(let se=K,ae=K+oe.byteLength;se<ae;se+=BYTES_PER_NODE){const le=se/2;IS_LEAF(le,uint16Array)||(uint32Array[se/4+6]+=Z)}return K+oe.byteLength}else{const oe=_.offset,se=_.count;return uint32Array[Z+6]=oe,uint16Array[te+14]=se,uint16Array[te+15]=IS_LEAFNODE_FLAG,K+BYTES_PER_NODE}else{const oe=_.left,se=_.right,ae=_.splitAxis;let le;if(le=_populateBuffer(K+BYTES_PER_NODE,oe),le/4>MAX_POINTER)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return uint32Array[Z+6]=le/4,le=_populateBuffer(le,se),uint32Array[Z+7]=ae,le}}function generateIndirectBuffer(K,_){const Z=(K.index?K.index.count:K.attributes.position.count)/3,te=Z>2**16,ne=te?4:2,ie=_?new SharedArrayBuffer(Z*ne):new ArrayBuffer(Z*ne),oe=te?new Uint32Array(ie):new Uint16Array(ie);for(let se=0,ae=oe.length;se<ae;se++)oe[se]=se;return oe}function buildTree$1(K,_,Z,te,ne){const{maxDepth:ie,verbose:oe,maxLeafTris:se,strategy:ae,onProgress:le,indirect:ce}=ne,fe=K._indirectBuffer,de=K.geometry,pe=de.index?de.index.array:null,he=ce?partition_indirect:partition,ge=getTriCount(de),me=new Float32Array(6);let Ae=!1;const ye=new MeshBVHNode;return getBounds(_,Z,te,ye.boundingData,me),_e(ye,Z,te,me),ye;function ve(Te){le&&le(Te/ge)}function _e(Te,be,Re,we=null,Pe=0){if(!Ae&&Pe>=ie&&(Ae=!0,oe&&(console.warn(`MeshBVH: Max depth of ${ie} reached when generating BVH. Consider increasing maxDepth.`),console.warn(de))),Re<=se||Pe>=ie)return ve(be+Re),Te.offset=be,Te.count=Re,Te;const Ie=getOptimalSplit(Te.boundingData,we,_,be,Re,ae);if(Ie.axis===-1)return ve(be+Re),Te.offset=be,Te.count=Re,Te;const $e=he(fe,pe,_,be,Re,Ie);if($e===be||$e===be+Re)ve(be+Re),Te.offset=be,Te.count=Re;else{Te.splitAxis=Ie.axis;const Ue=new MeshBVHNode,ke=be,Ge=$e-be;Te.left=Ue,getBounds(_,ke,Ge,Ue.boundingData,me),_e(Ue,ke,Ge,me,Pe+1);const He=new MeshBVHNode,ze=$e,Ke=Re-Ge;Te.right=He,getBounds(_,ze,Ke,He.boundingData,me),_e(He,ze,Ke,me,Pe+1)}return Te}}function buildPackedTree(K,_){const Z=K.geometry;_.indirect&&(K._indirectBuffer=generateIndirectBuffer(Z,_.useSharedArrayBuffer),hasGroupGaps(Z,_.range)&&!_.verbose&&console.warn('MeshBVH: Provided geometry contains groups or a range that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),K._indirectBuffer||ensureIndex(Z,_);const te=_.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,ne=computeTriangleBounds(Z),ie=_.indirect?getFullGeometryRange(Z,_.range):getRootIndexRanges(Z,_.range);K._roots=ie.map(oe=>{const se=buildTree$1(K,ne,oe.offset,oe.count,_),ae=countNodes(se),le=new te(BYTES_PER_NODE*ae);return populateBuffer(0,se,le),le})}class SeparatingAxisBounds{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(_,Z){let te=1/0,ne=-1/0;for(let ie=0,oe=_.length;ie<oe;ie++){const ae=_[ie][Z];te=ae<te?ae:te,ne=ae>ne?ae:ne}this.min=te,this.max=ne}setFromPoints(_,Z){let te=1/0,ne=-1/0;for(let ie=0,oe=Z.length;ie<oe;ie++){const se=Z[ie],ae=_.dot(se);te=ae<te?ae:te,ne=ae>ne?ae:ne}this.min=te,this.max=ne}isSeparated(_){return this.min>_.max||_.min>this.max}}SeparatingAxisBounds.prototype.setFromBox=function(){const K=new Vector3;return function(Z,te){const ne=te.min,ie=te.max;let oe=1/0,se=-1/0;for(let ae=0;ae<=1;ae++)for(let le=0;le<=1;le++)for(let ce=0;ce<=1;ce++){K.x=ne.x*ae+ie.x*(1-ae),K.y=ne.y*le+ie.y*(1-le),K.z=ne.z*ce+ie.z*(1-ce);const fe=Z.dot(K);oe=Math.min(fe,oe),se=Math.max(fe,se)}this.min=oe,this.max=se}}();const closestPointLineToLine=function(){const K=new Vector3,_=new Vector3,Z=new Vector3;return function(ne,ie,oe){const se=ne.start,ae=K,le=ie.start,ce=_;Z.subVectors(se,le),K.subVectors(ne.end,ne.start),_.subVectors(ie.end,ie.start);const fe=Z.dot(ce),de=ce.dot(ae),pe=ce.dot(ce),he=Z.dot(ae),me=ae.dot(ae)*pe-de*de;let Ae,ye;me!==0?Ae=(fe*de-he*pe)/me:Ae=0,ye=(fe+Ae*de)/pe,oe.x=Ae,oe.y=ye}}(),closestPointsSegmentToSegment=function(){const K=new Vector2,_=new Vector3,Z=new Vector3;return function(ne,ie,oe,se){closestPointLineToLine(ne,ie,K);let ae=K.x,le=K.y;if(ae>=0&&ae<=1&&le>=0&&le<=1){ne.at(ae,oe),ie.at(le,se);return}else if(ae>=0&&ae<=1){le<0?ie.at(0,se):ie.at(1,se),ne.closestPointToPoint(se,!0,oe);return}else if(le>=0&&le<=1){ae<0?ne.at(0,oe):ne.at(1,oe),ie.closestPointToPoint(oe,!0,se);return}else{let ce;ae<0?ce=ne.start:ce=ne.end;let fe;le<0?fe=ie.start:fe=ie.end;const de=_,pe=Z;if(ne.closestPointToPoint(fe,!0,_),ie.closestPointToPoint(ce,!0,Z),de.distanceToSquared(fe)<=pe.distanceToSquared(ce)){oe.copy(de),se.copy(fe);return}else{oe.copy(ce),se.copy(pe);return}}}}(),sphereIntersectTriangle=function(){const K=new Vector3,_=new Vector3,Z=new Plane$2,te=new Line3;return function(ie,oe){const{radius:se,center:ae}=ie,{a:le,b:ce,c:fe}=oe;if(te.start=le,te.end=ce,te.closestPointToPoint(ae,!0,K).distanceTo(ae)<=se||(te.start=le,te.end=fe,te.closestPointToPoint(ae,!0,K).distanceTo(ae)<=se)||(te.start=ce,te.end=fe,te.closestPointToPoint(ae,!0,K).distanceTo(ae)<=se))return!0;const ge=oe.getPlane(Z);if(Math.abs(ge.distanceToPoint(ae))<=se){const Ae=ge.projectPoint(ae,_);if(oe.containsPoint(Ae))return!0}return!1}}(),ZERO_EPSILON=1e-15;function isNearZero(K){return Math.abs(K)<ZERO_EPSILON}class ExtendedTriangle extends Triangle{constructor(..._){super(..._),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new Vector3),this.satBounds=new Array(4).fill().map(()=>new SeparatingAxisBounds),this.points=[this.a,this.b,this.c],this.sphere=new Sphere$2,this.plane=new Plane$2,this.needsUpdate=!0}intersectsSphere(_){return sphereIntersectTriangle(_,this)}update(){const _=this.a,Z=this.b,te=this.c,ne=this.points,ie=this.satAxes,oe=this.satBounds,se=ie[0],ae=oe[0];this.getNormal(se),ae.setFromPoints(se,ne);const le=ie[1],ce=oe[1];le.subVectors(_,Z),ce.setFromPoints(le,ne);const fe=ie[2],de=oe[2];fe.subVectors(Z,te),de.setFromPoints(fe,ne);const pe=ie[3],he=oe[3];pe.subVectors(te,_),he.setFromPoints(pe,ne),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(se,_),this.needsUpdate=!1}}ExtendedTriangle.prototype.closestPointToSegment=function(){const K=new Vector3,_=new Vector3,Z=new Line3;return function(ne,ie=null,oe=null){const{start:se,end:ae}=ne,le=this.points;let ce,fe=1/0;for(let de=0;de<3;de++){const pe=(de+1)%3;Z.start.copy(le[de]),Z.end.copy(le[pe]),closestPointsSegmentToSegment(Z,ne,K,_),ce=K.distanceToSquared(_),ce<fe&&(fe=ce,ie&&ie.copy(K),oe&&oe.copy(_))}return this.closestPointToPoint(se,K),ce=se.distanceToSquared(K),ce<fe&&(fe=ce,ie&&ie.copy(K),oe&&oe.copy(se)),this.closestPointToPoint(ae,K),ce=ae.distanceToSquared(K),ce<fe&&(fe=ce,ie&&ie.copy(K),oe&&oe.copy(ae)),Math.sqrt(fe)}}();ExtendedTriangle.prototype.intersectsTriangle=function(){const K=new ExtendedTriangle,_=new Array(3),Z=new Array(3),te=new SeparatingAxisBounds,ne=new SeparatingAxisBounds,ie=new Vector3,oe=new Vector3,se=new Vector3,ae=new Vector3,le=new Vector3,ce=new Line3,fe=new Line3,de=new Line3,pe=new Vector3;function he(ge,me,Ae){const ye=ge.points;let ve=0,_e=-1;for(let Te=0;Te<3;Te++){const{start:be,end:Re}=ce;be.copy(ye[Te]),Re.copy(ye[(Te+1)%3]),ce.delta(oe);const we=isNearZero(me.distanceToPoint(be));if(isNearZero(me.normal.dot(oe))&&we){Ae.copy(ce),ve=2;break}const Pe=me.intersectLine(ce,pe);if(!Pe&&we&&pe.copy(be),(Pe||we)&&!isNearZero(pe.distanceTo(Re))){if(ve<=1)(ve===1?Ae.start:Ae.end).copy(pe),we&&(_e=ve);else if(ve>=2){(_e===1?Ae.start:Ae.end).copy(pe),ve=2;break}if(ve++,ve===2&&_e===-1)break}}return ve}return function(me,Ae=null,ye=!1){this.needsUpdate&&this.update(),me.isExtendedTriangle?me.needsUpdate&&me.update():(K.copy(me),K.update(),me=K);const ve=this.plane,_e=me.plane;if(Math.abs(ve.normal.dot(_e.normal))>1-1e-10){const Te=this.satBounds,be=this.satAxes;Z[0]=me.a,Z[1]=me.b,Z[2]=me.c;for(let Pe=0;Pe<4;Pe++){const Ie=Te[Pe],$e=be[Pe];if(te.setFromPoints($e,Z),Ie.isSeparated(te))return!1}const Re=me.satBounds,we=me.satAxes;_[0]=this.a,_[1]=this.b,_[2]=this.c;for(let Pe=0;Pe<4;Pe++){const Ie=Re[Pe],$e=we[Pe];if(te.setFromPoints($e,_),Ie.isSeparated(te))return!1}for(let Pe=0;Pe<4;Pe++){const Ie=be[Pe];for(let $e=0;$e<4;$e++){const Ue=we[$e];if(ie.crossVectors(Ie,Ue),te.setFromPoints(ie,_),ne.setFromPoints(ie,Z),te.isSeparated(ne))return!1}}return Ae&&(ye||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),Ae.start.set(0,0,0),Ae.end.set(0,0,0)),!0}else{const Te=he(this,_e,fe);if(Te===1&&me.containsPoint(fe.end))return Ae&&(Ae.start.copy(fe.end),Ae.end.copy(fe.end)),!0;if(Te!==2)return!1;const be=he(me,ve,de);if(be===1&&this.containsPoint(de.end))return Ae&&(Ae.start.copy(de.end),Ae.end.copy(de.end)),!0;if(be!==2)return!1;if(fe.delta(se),de.delta(ae),se.dot(ae)<0){let ke=de.start;de.start=de.end,de.end=ke}const Re=fe.start.dot(se),we=fe.end.dot(se),Pe=de.start.dot(se),Ie=de.end.dot(se),$e=we<Pe,Ue=Re<Ie;return Re!==Ie&&Pe!==we&&$e===Ue?!1:(Ae&&(le.subVectors(fe.start,de.start),le.dot(se)>0?Ae.start.copy(fe.start):Ae.start.copy(de.start),le.subVectors(fe.end,de.end),le.dot(se)<0?Ae.end.copy(fe.end):Ae.end.copy(de.end)),!0)}}}();ExtendedTriangle.prototype.distanceToPoint=function(){const K=new Vector3;return function(Z){return this.closestPointToPoint(Z,K),Z.distanceTo(K)}}();ExtendedTriangle.prototype.distanceToTriangle=function(){const K=new Vector3,_=new Vector3,Z=["a","b","c"],te=new Line3,ne=new Line3;return function(oe,se=null,ae=null){const le=se||ae?te:null;if(this.intersectsTriangle(oe,le))return(se||ae)&&(se&&le.getCenter(se),ae&&le.getCenter(ae)),0;let ce=1/0;for(let fe=0;fe<3;fe++){let de;const pe=Z[fe],he=oe[pe];this.closestPointToPoint(he,K),de=he.distanceToSquared(K),de<ce&&(ce=de,se&&se.copy(K),ae&&ae.copy(he));const ge=this[pe];oe.closestPointToPoint(ge,K),de=ge.distanceToSquared(K),de<ce&&(ce=de,se&&se.copy(ge),ae&&ae.copy(K))}for(let fe=0;fe<3;fe++){const de=Z[fe],pe=Z[(fe+1)%3];te.set(this[de],this[pe]);for(let he=0;he<3;he++){const ge=Z[he],me=Z[(he+1)%3];ne.set(oe[ge],oe[me]),closestPointsSegmentToSegment(te,ne,K,_);const Ae=K.distanceToSquared(_);Ae<ce&&(ce=Ae,se&&se.copy(K),ae&&ae.copy(_))}}return Math.sqrt(ce)}}();class OrientedBox{constructor(_,Z,te){this.isOrientedBox=!0,this.min=new Vector3,this.max=new Vector3,this.matrix=new Matrix4,this.invMatrix=new Matrix4,this.points=new Array(8).fill().map(()=>new Vector3),this.satAxes=new Array(3).fill().map(()=>new Vector3),this.satBounds=new Array(3).fill().map(()=>new SeparatingAxisBounds),this.alignedSatBounds=new Array(3).fill().map(()=>new SeparatingAxisBounds),this.needsUpdate=!1,_&&this.min.copy(_),Z&&this.max.copy(Z),te&&this.matrix.copy(te)}set(_,Z,te){this.min.copy(_),this.max.copy(Z),this.matrix.copy(te),this.needsUpdate=!0}copy(_){this.min.copy(_.min),this.max.copy(_.max),this.matrix.copy(_.matrix),this.needsUpdate=!0}}OrientedBox.prototype.update=function(){return function(){const _=this.matrix,Z=this.min,te=this.max,ne=this.points;for(let le=0;le<=1;le++)for(let ce=0;ce<=1;ce++)for(let fe=0;fe<=1;fe++){const de=1*le|2*ce|4*fe,pe=ne[de];pe.x=le?te.x:Z.x,pe.y=ce?te.y:Z.y,pe.z=fe?te.z:Z.z,pe.applyMatrix4(_)}const ie=this.satBounds,oe=this.satAxes,se=ne[0];for(let le=0;le<3;le++){const ce=oe[le],fe=ie[le],de=1<<le,pe=ne[de];ce.subVectors(se,pe),fe.setFromPoints(ce,ne)}const ae=this.alignedSatBounds;ae[0].setFromPointsField(ne,"x"),ae[1].setFromPointsField(ne,"y"),ae[2].setFromPointsField(ne,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();OrientedBox.prototype.intersectsBox=function(){const K=new SeparatingAxisBounds;return function(Z){this.needsUpdate&&this.update();const te=Z.min,ne=Z.max,ie=this.satBounds,oe=this.satAxes,se=this.alignedSatBounds;if(K.min=te.x,K.max=ne.x,se[0].isSeparated(K)||(K.min=te.y,K.max=ne.y,se[1].isSeparated(K))||(K.min=te.z,K.max=ne.z,se[2].isSeparated(K)))return!1;for(let ae=0;ae<3;ae++){const le=oe[ae],ce=ie[ae];if(K.setFromBox(le,Z),ce.isSeparated(K))return!1}return!0}}();OrientedBox.prototype.intersectsTriangle=function(){const K=new ExtendedTriangle,_=new Array(3),Z=new SeparatingAxisBounds,te=new SeparatingAxisBounds,ne=new Vector3;return function(oe){this.needsUpdate&&this.update(),oe.isExtendedTriangle?oe.needsUpdate&&oe.update():(K.copy(oe),K.update(),oe=K);const se=this.satBounds,ae=this.satAxes;_[0]=oe.a,_[1]=oe.b,_[2]=oe.c;for(let de=0;de<3;de++){const pe=se[de],he=ae[de];if(Z.setFromPoints(he,_),pe.isSeparated(Z))return!1}const le=oe.satBounds,ce=oe.satAxes,fe=this.points;for(let de=0;de<3;de++){const pe=le[de],he=ce[de];if(Z.setFromPoints(he,fe),pe.isSeparated(Z))return!1}for(let de=0;de<3;de++){const pe=ae[de];for(let he=0;he<4;he++){const ge=ce[he];if(ne.crossVectors(pe,ge),Z.setFromPoints(ne,_),te.setFromPoints(ne,fe),Z.isSeparated(te))return!1}}return!0}}();OrientedBox.prototype.closestPointToPoint=function(){return function(_,Z){return this.needsUpdate&&this.update(),Z.copy(_).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),Z}}();OrientedBox.prototype.distanceToPoint=function(){const K=new Vector3;return function(Z){return this.closestPointToPoint(Z,K),Z.distanceTo(K)}}();OrientedBox.prototype.distanceToBox=function(){const K=["x","y","z"],_=new Array(12).fill().map(()=>new Line3),Z=new Array(12).fill().map(()=>new Line3),te=new Vector3,ne=new Vector3;return function(oe,se=0,ae=null,le=null){if(this.needsUpdate&&this.update(),this.intersectsBox(oe))return(ae||le)&&(oe.getCenter(ne),this.closestPointToPoint(ne,te),oe.closestPointToPoint(te,ne),ae&&ae.copy(te),le&&le.copy(ne)),0;const ce=se*se,fe=oe.min,de=oe.max,pe=this.points;let he=1/0;for(let me=0;me<8;me++){const Ae=pe[me];ne.copy(Ae).clamp(fe,de);const ye=Ae.distanceToSquared(ne);if(ye<he&&(he=ye,ae&&ae.copy(Ae),le&&le.copy(ne),ye<ce))return Math.sqrt(ye)}let ge=0;for(let me=0;me<3;me++)for(let Ae=0;Ae<=1;Ae++)for(let ye=0;ye<=1;ye++){const ve=(me+1)%3,_e=(me+2)%3,Te=Ae<<ve|ye<<_e,be=1<<me|Ae<<ve|ye<<_e,Re=pe[Te],we=pe[be];_[ge].set(Re,we);const Ie=K[me],$e=K[ve],Ue=K[_e],ke=Z[ge],Ge=ke.start,He=ke.end;Ge[Ie]=fe[Ie],Ge[$e]=Ae?fe[$e]:de[$e],Ge[Ue]=ye?fe[Ue]:de[$e],He[Ie]=de[Ie],He[$e]=Ae?fe[$e]:de[$e],He[Ue]=ye?fe[Ue]:de[$e],ge++}for(let me=0;me<=1;me++)for(let Ae=0;Ae<=1;Ae++)for(let ye=0;ye<=1;ye++){ne.x=me?de.x:fe.x,ne.y=Ae?de.y:fe.y,ne.z=ye?de.z:fe.z,this.closestPointToPoint(ne,te);const ve=ne.distanceToSquared(te);if(ve<he&&(he=ve,ae&&ae.copy(te),le&&le.copy(ne),ve<ce))return Math.sqrt(ve)}for(let me=0;me<12;me++){const Ae=_[me];for(let ye=0;ye<12;ye++){const ve=Z[ye];closestPointsSegmentToSegment(Ae,ve,te,ne);const _e=te.distanceToSquared(ne);if(_e<he&&(he=_e,ae&&ae.copy(te),le&&le.copy(ne),_e<ce))return Math.sqrt(_e)}}return Math.sqrt(he)}}();class PrimitivePool{constructor(_){this._getNewPrimitive=_,this._primitives=[]}getPrimitive(){const _=this._primitives;return _.length===0?this._getNewPrimitive():_.pop()}releasePrimitive(_){this._primitives.push(_)}}class ExtendedTrianglePoolBase extends PrimitivePool{constructor(){super(()=>new ExtendedTriangle)}}const ExtendedTrianglePool=new ExtendedTrianglePoolBase;class _BufferStack{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const _=[];let Z=null;this.setBuffer=te=>{Z&&_.push(Z),Z=te,this.float32Array=new Float32Array(te),this.uint16Array=new Uint16Array(te),this.uint32Array=new Uint32Array(te)},this.clearBuffer=()=>{Z=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,_.length!==0&&this.setBuffer(_.pop())}}}const BufferStack=new _BufferStack;let _box1,_box2;const boxStack=[],boxPool=new PrimitivePool(()=>new Box3);function shapecast(K,_,Z,te,ne,ie){_box1=boxPool.getPrimitive(),_box2=boxPool.getPrimitive(),boxStack.push(_box1,_box2),BufferStack.setBuffer(K._roots[_]);const oe=shapecastTraverse(0,K.geometry,Z,te,ne,ie);BufferStack.clearBuffer(),boxPool.releasePrimitive(_box1),boxPool.releasePrimitive(_box2),boxStack.pop(),boxStack.pop();const se=boxStack.length;return se>0&&(_box2=boxStack[se-1],_box1=boxStack[se-2]),oe}function shapecastTraverse(K,_,Z,te,ne=null,ie=0,oe=0){const{float32Array:se,uint16Array:ae,uint32Array:le}=BufferStack;let ce=K*2;if(IS_LEAF(ce,ae)){const de=OFFSET(K,le),pe=COUNT(ce,ae);return arrayToBox(K,se,_box1),te(de,pe,!1,oe,ie+K,_box1)}else{let Ie=function(Ue){const{uint16Array:ke,uint32Array:Ge}=BufferStack;let He=Ue*2;for(;!IS_LEAF(He,ke);)Ue=LEFT_NODE(Ue),He=Ue*2;return OFFSET(Ue,Ge)},$e=function(Ue){const{uint16Array:ke,uint32Array:Ge}=BufferStack;let He=Ue*2;for(;!IS_LEAF(He,ke);)Ue=RIGHT_NODE(Ue,Ge),He=Ue*2;return OFFSET(Ue,Ge)+COUNT(He,ke)};const de=LEFT_NODE(K),pe=RIGHT_NODE(K,le);let he=de,ge=pe,me,Ae,ye,ve;if(ne&&(ye=_box1,ve=_box2,arrayToBox(he,se,ye),arrayToBox(ge,se,ve),me=ne(ye),Ae=ne(ve),Ae<me)){he=pe,ge=de;const Ue=me;me=Ae,Ae=Ue,ye=ve}ye||(ye=_box1,arrayToBox(he,se,ye));const _e=IS_LEAF(he*2,ae),Te=Z(ye,_e,me,oe+1,ie+he);let be;if(Te===CONTAINED){const Ue=Ie(he),Ge=$e(he)-Ue;be=te(Ue,Ge,!0,oe+1,ie+he,ye)}else be=Te&&shapecastTraverse(he,_,Z,te,ne,ie,oe+1);if(be)return!0;ve=_box2,arrayToBox(ge,se,ve);const Re=IS_LEAF(ge*2,ae),we=Z(ve,Re,Ae,oe+1,ie+ge);let Pe;if(we===CONTAINED){const Ue=Ie(ge),Ge=$e(ge)-Ue;Pe=te(Ue,Ge,!0,oe+1,ie+ge,ve)}else Pe=we&&shapecastTraverse(ge,_,Z,te,ne,ie,oe+1);return!!Pe}}const temp=new Vector3,temp1$2=new Vector3;function closestPointToPoint(K,_,Z={},te=0,ne=1/0){const ie=te*te,oe=ne*ne;let se=1/0,ae=null;if(K.shapecast({boundsTraverseOrder:ce=>(temp.copy(_).clamp(ce.min,ce.max),temp.distanceToSquared(_)),intersectsBounds:(ce,fe,de)=>de<se&&de<oe,intersectsTriangle:(ce,fe)=>{ce.closestPointToPoint(_,temp);const de=_.distanceToSquared(temp);return de<se&&(temp1$2.copy(temp),se=de,ae=fe),de<ie}}),se===1/0)return null;const le=Math.sqrt(se);return Z.point?Z.point.copy(temp1$2):Z.point=temp1$2.clone(),Z.distance=le,Z.faceIndex=ae,Z}const _vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3;function checkIntersection(K,_,Z,te,ne,ie,oe,se){let ae;if(ie===BackSide?ae=K.intersectTriangle(te,Z,_,!0,ne):ae=K.intersectTriangle(_,Z,te,ie!==DoubleSide,ne),ae===null)return null;const le=K.origin.distanceTo(ne);return le<oe||le>se?null:{distance:le,point:ne.clone()}}function checkBufferGeometryIntersection(K,_,Z,te,ne,ie,oe,se,ae,le,ce){_vA.fromBufferAttribute(_,ie),_vB.fromBufferAttribute(_,oe),_vC.fromBufferAttribute(_,se);const fe=checkIntersection(K,_vA,_vB,_vC,_intersectionPoint,ae,le,ce);if(fe){te&&(_uvA.fromBufferAttribute(te,ie),_uvB.fromBufferAttribute(te,oe),_uvC.fromBufferAttribute(te,se),fe.uv=Triangle.getInterpolation(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2)),ne&&(_uvA.fromBufferAttribute(ne,ie),_uvB.fromBufferAttribute(ne,oe),_uvC.fromBufferAttribute(ne,se),fe.uv1=Triangle.getInterpolation(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2)),Z&&(_normalA.fromBufferAttribute(Z,ie),_normalB.fromBufferAttribute(Z,oe),_normalC.fromBufferAttribute(Z,se),fe.normal=Triangle.getInterpolation(_intersectionPoint,_vA,_vB,_vC,_normalA,_normalB,_normalC,new Vector3),fe.normal.dot(K.direction)>0&&fe.normal.multiplyScalar(-1));const de={a:ie,b:oe,c:se,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA,_vB,_vC,de.normal),fe.face=de,fe.faceIndex=ie}return fe}function intersectTri(K,_,Z,te,ne,ie,oe){const se=te*3;let ae=se+0,le=se+1,ce=se+2;const fe=K.index;K.index&&(ae=fe.getX(ae),le=fe.getX(le),ce=fe.getX(ce));const{position:de,normal:pe,uv:he,uv1:ge}=K.attributes,me=checkBufferGeometryIntersection(Z,de,pe,he,ge,ae,le,ce,_,ie,oe);return me?(me.faceIndex=te,ne&&ne.push(me),me):null}function setTriangle(K,_,Z,te){const ne=K.a,ie=K.b,oe=K.c;let se=_,ae=_+1,le=_+2;Z&&(se=Z.getX(se),ae=Z.getX(ae),le=Z.getX(le)),ne.x=te.getX(se),ne.y=te.getY(se),ne.z=te.getZ(se),ie.x=te.getX(ae),ie.y=te.getY(ae),ie.z=te.getZ(ae),oe.x=te.getX(le),oe.y=te.getY(le),oe.z=te.getZ(le)}function intersectTris(K,_,Z,te,ne,ie,oe,se){const{geometry:ae,_indirectBuffer:le}=K;for(let ce=te,fe=te+ne;ce<fe;ce++)intersectTri(ae,_,Z,ce,ie,oe,se)}function intersectClosestTri(K,_,Z,te,ne,ie,oe){const{geometry:se,_indirectBuffer:ae}=K;let le=1/0,ce=null;for(let fe=te,de=te+ne;fe<de;fe++){let pe;pe=intersectTri(se,_,Z,fe,null,ie,oe),pe&&pe.distance<le&&(ce=pe,le=pe.distance)}return ce}function iterateOverTriangles(K,_,Z,te,ne,ie,oe){const{geometry:se}=Z,{index:ae}=se,le=se.attributes.position;for(let ce=K,fe=_+K;ce<fe;ce++){let de;if(de=ce,setTriangle(oe,de*3,ae,le),oe.needsUpdate=!0,te(oe,de,ne,ie))return!0}return!1}function refit(K,_=null){_&&Array.isArray(_)&&(_=new Set(_));const Z=K.geometry,te=Z.index?Z.index.array:null,ne=Z.attributes.position;let ie,oe,se,ae,le=0;const ce=K._roots;for(let de=0,pe=ce.length;de<pe;de++)ie=ce[de],oe=new Uint32Array(ie),se=new Uint16Array(ie),ae=new Float32Array(ie),fe(0,le),le+=ie.byteLength;function fe(de,pe,he=!1){const ge=de*2;if(se[ge+15]===IS_LEAFNODE_FLAG){const Ae=oe[de+6],ye=se[ge+14];let ve=1/0,_e=1/0,Te=1/0,be=-1/0,Re=-1/0,we=-1/0;for(let Pe=3*Ae,Ie=3*(Ae+ye);Pe<Ie;Pe++){let $e=te[Pe];const Ue=ne.getX($e),ke=ne.getY($e),Ge=ne.getZ($e);Ue<ve&&(ve=Ue),Ue>be&&(be=Ue),ke<_e&&(_e=ke),ke>Re&&(Re=ke),Ge<Te&&(Te=Ge),Ge>we&&(we=Ge)}return ae[de+0]!==ve||ae[de+1]!==_e||ae[de+2]!==Te||ae[de+3]!==be||ae[de+4]!==Re||ae[de+5]!==we?(ae[de+0]=ve,ae[de+1]=_e,ae[de+2]=Te,ae[de+3]=be,ae[de+4]=Re,ae[de+5]=we,!0):!1}else{const Ae=de+8,ye=oe[de+6],ve=Ae+pe,_e=ye+pe;let Te=he,be=!1,Re=!1;_?Te||(be=_.has(ve),Re=_.has(_e),Te=!be&&!Re):(be=!0,Re=!0);const we=Te||be,Pe=Te||Re;let Ie=!1;we&&(Ie=fe(Ae,pe,Te));let $e=!1;Pe&&($e=fe(ye,pe,Te));const Ue=Ie||$e;if(Ue)for(let ke=0;ke<3;ke++){const Ge=Ae+ke,He=ye+ke,ze=ae[Ge],Ke=ae[Ge+3],tt=ae[He],Je=ae[He+3];ae[de+ke]=ze<tt?ze:tt,ae[de+ke+3]=Ke>Je?Ke:Je}return Ue}}}function intersectRay(K,_,Z,te,ne){let ie,oe,se,ae,le,ce;const fe=1/Z.direction.x,de=1/Z.direction.y,pe=1/Z.direction.z,he=Z.origin.x,ge=Z.origin.y,me=Z.origin.z;let Ae=_[K],ye=_[K+3],ve=_[K+1],_e=_[K+3+1],Te=_[K+2],be=_[K+3+2];return fe>=0?(ie=(Ae-he)*fe,oe=(ye-he)*fe):(ie=(ye-he)*fe,oe=(Ae-he)*fe),de>=0?(se=(ve-ge)*de,ae=(_e-ge)*de):(se=(_e-ge)*de,ae=(ve-ge)*de),ie>ae||se>oe||((se>ie||isNaN(ie))&&(ie=se),(ae<oe||isNaN(oe))&&(oe=ae),pe>=0?(le=(Te-me)*pe,ce=(be-me)*pe):(le=(be-me)*pe,ce=(Te-me)*pe),ie>ce||le>oe)?!1:((le>ie||ie!==ie)&&(ie=le),(ce<oe||oe!==oe)&&(oe=ce),ie<=ne&&oe>=te)}function intersectTris_indirect(K,_,Z,te,ne,ie,oe,se){const{geometry:ae,_indirectBuffer:le}=K;for(let ce=te,fe=te+ne;ce<fe;ce++){let de=le?le[ce]:ce;intersectTri(ae,_,Z,de,ie,oe,se)}}function intersectClosestTri_indirect(K,_,Z,te,ne,ie,oe){const{geometry:se,_indirectBuffer:ae}=K;let le=1/0,ce=null;for(let fe=te,de=te+ne;fe<de;fe++){let pe;pe=intersectTri(se,_,Z,ae?ae[fe]:fe,null,ie,oe),pe&&pe.distance<le&&(ce=pe,le=pe.distance)}return ce}function iterateOverTriangles_indirect(K,_,Z,te,ne,ie,oe){const{geometry:se}=Z,{index:ae}=se,le=se.attributes.position;for(let ce=K,fe=_+K;ce<fe;ce++){let de;if(de=Z.resolveTriangleIndex(ce),setTriangle(oe,de*3,ae,le),oe.needsUpdate=!0,te(oe,de,ne,ie))return!0}return!1}function raycast(K,_,Z,te,ne,ie,oe){BufferStack.setBuffer(K._roots[_]),_raycast$1(0,K,Z,te,ne,ie,oe),BufferStack.clearBuffer()}function _raycast$1(K,_,Z,te,ne,ie,oe){const{float32Array:se,uint16Array:ae,uint32Array:le}=BufferStack,ce=K*2;if(IS_LEAF(ce,ae)){const de=OFFSET(K,le),pe=COUNT(ce,ae);intersectTris(_,Z,te,de,pe,ne,ie,oe)}else{const de=LEFT_NODE(K);intersectRay(de,se,te,ie,oe)&&_raycast$1(de,_,Z,te,ne,ie,oe);const pe=RIGHT_NODE(K,le);intersectRay(pe,se,te,ie,oe)&&_raycast$1(pe,_,Z,te,ne,ie,oe)}}const _xyzFields$1=["x","y","z"];function raycastFirst(K,_,Z,te,ne,ie){BufferStack.setBuffer(K._roots[_]);const oe=_raycastFirst$1(0,K,Z,te,ne,ie);return BufferStack.clearBuffer(),oe}function _raycastFirst$1(K,_,Z,te,ne,ie){const{float32Array:oe,uint16Array:se,uint32Array:ae}=BufferStack;let le=K*2;if(IS_LEAF(le,se)){const fe=OFFSET(K,ae),de=COUNT(le,se);return intersectClosestTri(_,Z,te,fe,de,ne,ie)}else{const fe=SPLIT_AXIS(K,ae),de=_xyzFields$1[fe],he=te.direction[de]>=0;let ge,me;he?(ge=LEFT_NODE(K),me=RIGHT_NODE(K,ae)):(ge=RIGHT_NODE(K,ae),me=LEFT_NODE(K));const ye=intersectRay(ge,oe,te,ne,ie)?_raycastFirst$1(ge,_,Z,te,ne,ie):null;if(ye){const Te=ye.point[de];if(he?Te<=oe[me+fe]:Te>=oe[me+fe+3])return ye}const _e=intersectRay(me,oe,te,ne,ie)?_raycastFirst$1(me,_,Z,te,ne,ie):null;return ye&&_e?ye.distance<=_e.distance?ye:_e:ye||_e||null}}const boundingBox$1=new Box3,triangle$1=new ExtendedTriangle,triangle2$1=new ExtendedTriangle,invertedMat$1=new Matrix4,obb$4=new OrientedBox,obb2$3=new OrientedBox;function intersectsGeometry(K,_,Z,te){BufferStack.setBuffer(K._roots[_]);const ne=_intersectsGeometry$1(0,K,Z,te);return BufferStack.clearBuffer(),ne}function _intersectsGeometry$1(K,_,Z,te,ne=null){const{float32Array:ie,uint16Array:oe,uint32Array:se}=BufferStack;let ae=K*2;if(ne===null&&(Z.boundingBox||Z.computeBoundingBox(),obb$4.set(Z.boundingBox.min,Z.boundingBox.max,te),ne=obb$4),IS_LEAF(ae,oe)){const ce=_.geometry,fe=ce.index,de=ce.attributes.position,pe=Z.index,he=Z.attributes.position,ge=OFFSET(K,se),me=COUNT(ae,oe);if(invertedMat$1.copy(te).invert(),Z.boundsTree)return arrayToBox(K,ie,obb2$3),obb2$3.matrix.copy(invertedMat$1),obb2$3.needsUpdate=!0,Z.boundsTree.shapecast({intersectsBounds:ye=>obb2$3.intersectsBox(ye),intersectsTriangle:ye=>{ye.a.applyMatrix4(te),ye.b.applyMatrix4(te),ye.c.applyMatrix4(te),ye.needsUpdate=!0;for(let ve=ge*3,_e=(me+ge)*3;ve<_e;ve+=3)if(setTriangle(triangle2$1,ve,fe,de),triangle2$1.needsUpdate=!0,ye.intersectsTriangle(triangle2$1))return!0;return!1}});for(let Ae=ge*3,ye=(me+ge)*3;Ae<ye;Ae+=3){setTriangle(triangle$1,Ae,fe,de),triangle$1.a.applyMatrix4(invertedMat$1),triangle$1.b.applyMatrix4(invertedMat$1),triangle$1.c.applyMatrix4(invertedMat$1),triangle$1.needsUpdate=!0;for(let ve=0,_e=pe.count;ve<_e;ve+=3)if(setTriangle(triangle2$1,ve,pe,he),triangle2$1.needsUpdate=!0,triangle$1.intersectsTriangle(triangle2$1))return!0}}else{const ce=K+8,fe=se[K+6];return arrayToBox(ce,ie,boundingBox$1),!!(ne.intersectsBox(boundingBox$1)&&_intersectsGeometry$1(ce,_,Z,te,ne)||(arrayToBox(fe,ie,boundingBox$1),ne.intersectsBox(boundingBox$1)&&_intersectsGeometry$1(fe,_,Z,te,ne)))}}const tempMatrix$1=new Matrix4,obb$3=new OrientedBox,obb2$2=new OrientedBox,temp1$1=new Vector3,temp2$1=new Vector3,temp3$1=new Vector3,temp4$1=new Vector3;function closestPointToGeometry(K,_,Z,te={},ne={},ie=0,oe=1/0){_.boundingBox||_.computeBoundingBox(),obb$3.set(_.boundingBox.min,_.boundingBox.max,Z),obb$3.needsUpdate=!0;const se=K.geometry,ae=se.attributes.position,le=se.index,ce=_.attributes.position,fe=_.index,de=ExtendedTrianglePool.getPrimitive(),pe=ExtendedTrianglePool.getPrimitive();let he=temp1$1,ge=temp2$1,me=null,Ae=null;ne&&(me=temp3$1,Ae=temp4$1);let ye=1/0,ve=null,_e=null;return tempMatrix$1.copy(Z).invert(),obb2$2.matrix.copy(tempMatrix$1),K.shapecast({boundsTraverseOrder:Te=>obb$3.distanceToBox(Te),intersectsBounds:(Te,be,Re)=>Re<ye&&Re<oe?(be&&(obb2$2.min.copy(Te.min),obb2$2.max.copy(Te.max),obb2$2.needsUpdate=!0),!0):!1,intersectsRange:(Te,be)=>{if(_.boundsTree)return _.boundsTree.shapecast({boundsTraverseOrder:we=>obb2$2.distanceToBox(we),intersectsBounds:(we,Pe,Ie)=>Ie<ye&&Ie<oe,intersectsRange:(we,Pe)=>{for(let Ie=we,$e=we+Pe;Ie<$e;Ie++){setTriangle(pe,3*Ie,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let Ue=Te,ke=Te+be;Ue<ke;Ue++){setTriangle(de,3*Ue,le,ae),de.needsUpdate=!0;const Ge=de.distanceToTriangle(pe,he,me);if(Ge<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=Ge,ve=Ue,_e=Ie),Ge<ie)return!0}}}});{const Re=getTriCount(_);for(let we=0,Pe=Re;we<Pe;we++){setTriangle(pe,3*we,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let Ie=Te,$e=Te+be;Ie<$e;Ie++){setTriangle(de,3*Ie,le,ae),de.needsUpdate=!0;const Ue=de.distanceToTriangle(pe,he,me);if(Ue<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=Ue,ve=Ie,_e=we),Ue<ie)return!0}}}}}),ExtendedTrianglePool.releasePrimitive(de),ExtendedTrianglePool.releasePrimitive(pe),ye===1/0?null:(te.point?te.point.copy(ge):te.point=ge.clone(),te.distance=ye,te.faceIndex=ve,ne&&(ne.point?ne.point.copy(Ae):ne.point=Ae.clone(),ne.point.applyMatrix4(tempMatrix$1),ge.applyMatrix4(tempMatrix$1),ne.distance=ge.sub(ne.point).length(),ne.faceIndex=_e),te)}function refit_indirect(K,_=null){_&&Array.isArray(_)&&(_=new Set(_));const Z=K.geometry,te=Z.index?Z.index.array:null,ne=Z.attributes.position;let ie,oe,se,ae,le=0;const ce=K._roots;for(let de=0,pe=ce.length;de<pe;de++)ie=ce[de],oe=new Uint32Array(ie),se=new Uint16Array(ie),ae=new Float32Array(ie),fe(0,le),le+=ie.byteLength;function fe(de,pe,he=!1){const ge=de*2;if(se[ge+15]===IS_LEAFNODE_FLAG){const Ae=oe[de+6],ye=se[ge+14];let ve=1/0,_e=1/0,Te=1/0,be=-1/0,Re=-1/0,we=-1/0;for(let Pe=Ae,Ie=Ae+ye;Pe<Ie;Pe++){const $e=3*K.resolveTriangleIndex(Pe);for(let Ue=0;Ue<3;Ue++){let ke=$e+Ue;ke=te?te[ke]:ke;const Ge=ne.getX(ke),He=ne.getY(ke),ze=ne.getZ(ke);Ge<ve&&(ve=Ge),Ge>be&&(be=Ge),He<_e&&(_e=He),He>Re&&(Re=He),ze<Te&&(Te=ze),ze>we&&(we=ze)}}return ae[de+0]!==ve||ae[de+1]!==_e||ae[de+2]!==Te||ae[de+3]!==be||ae[de+4]!==Re||ae[de+5]!==we?(ae[de+0]=ve,ae[de+1]=_e,ae[de+2]=Te,ae[de+3]=be,ae[de+4]=Re,ae[de+5]=we,!0):!1}else{const Ae=de+8,ye=oe[de+6],ve=Ae+pe,_e=ye+pe;let Te=he,be=!1,Re=!1;_?Te||(be=_.has(ve),Re=_.has(_e),Te=!be&&!Re):(be=!0,Re=!0);const we=Te||be,Pe=Te||Re;let Ie=!1;we&&(Ie=fe(Ae,pe,Te));let $e=!1;Pe&&($e=fe(ye,pe,Te));const Ue=Ie||$e;if(Ue)for(let ke=0;ke<3;ke++){const Ge=Ae+ke,He=ye+ke,ze=ae[Ge],Ke=ae[Ge+3],tt=ae[He],Je=ae[He+3];ae[de+ke]=ze<tt?ze:tt,ae[de+ke+3]=Ke>Je?Ke:Je}return Ue}}}function raycast_indirect(K,_,Z,te,ne,ie,oe){BufferStack.setBuffer(K._roots[_]),_raycast(0,K,Z,te,ne,ie,oe),BufferStack.clearBuffer()}function _raycast(K,_,Z,te,ne,ie,oe){const{float32Array:se,uint16Array:ae,uint32Array:le}=BufferStack,ce=K*2;if(IS_LEAF(ce,ae)){const de=OFFSET(K,le),pe=COUNT(ce,ae);intersectTris_indirect(_,Z,te,de,pe,ne,ie,oe)}else{const de=LEFT_NODE(K);intersectRay(de,se,te,ie,oe)&&_raycast(de,_,Z,te,ne,ie,oe);const pe=RIGHT_NODE(K,le);intersectRay(pe,se,te,ie,oe)&&_raycast(pe,_,Z,te,ne,ie,oe)}}const _xyzFields=["x","y","z"];function raycastFirst_indirect(K,_,Z,te,ne,ie){BufferStack.setBuffer(K._roots[_]);const oe=_raycastFirst(0,K,Z,te,ne,ie);return BufferStack.clearBuffer(),oe}function _raycastFirst(K,_,Z,te,ne,ie){const{float32Array:oe,uint16Array:se,uint32Array:ae}=BufferStack;let le=K*2;if(IS_LEAF(le,se)){const fe=OFFSET(K,ae),de=COUNT(le,se);return intersectClosestTri_indirect(_,Z,te,fe,de,ne,ie)}else{const fe=SPLIT_AXIS(K,ae),de=_xyzFields[fe],he=te.direction[de]>=0;let ge,me;he?(ge=LEFT_NODE(K),me=RIGHT_NODE(K,ae)):(ge=RIGHT_NODE(K,ae),me=LEFT_NODE(K));const ye=intersectRay(ge,oe,te,ne,ie)?_raycastFirst(ge,_,Z,te,ne,ie):null;if(ye){const Te=ye.point[de];if(he?Te<=oe[me+fe]:Te>=oe[me+fe+3])return ye}const _e=intersectRay(me,oe,te,ne,ie)?_raycastFirst(me,_,Z,te,ne,ie):null;return ye&&_e?ye.distance<=_e.distance?ye:_e:ye||_e||null}}const boundingBox=new Box3,triangle=new ExtendedTriangle,triangle2=new ExtendedTriangle,invertedMat=new Matrix4,obb$2=new OrientedBox,obb2$1=new OrientedBox;function intersectsGeometry_indirect(K,_,Z,te){BufferStack.setBuffer(K._roots[_]);const ne=_intersectsGeometry(0,K,Z,te);return BufferStack.clearBuffer(),ne}function _intersectsGeometry(K,_,Z,te,ne=null){const{float32Array:ie,uint16Array:oe,uint32Array:se}=BufferStack;let ae=K*2;if(ne===null&&(Z.boundingBox||Z.computeBoundingBox(),obb$2.set(Z.boundingBox.min,Z.boundingBox.max,te),ne=obb$2),IS_LEAF(ae,oe)){const ce=_.geometry,fe=ce.index,de=ce.attributes.position,pe=Z.index,he=Z.attributes.position,ge=OFFSET(K,se),me=COUNT(ae,oe);if(invertedMat.copy(te).invert(),Z.boundsTree)return arrayToBox(K,ie,obb2$1),obb2$1.matrix.copy(invertedMat),obb2$1.needsUpdate=!0,Z.boundsTree.shapecast({intersectsBounds:ye=>obb2$1.intersectsBox(ye),intersectsTriangle:ye=>{ye.a.applyMatrix4(te),ye.b.applyMatrix4(te),ye.c.applyMatrix4(te),ye.needsUpdate=!0;for(let ve=ge,_e=me+ge;ve<_e;ve++)if(setTriangle(triangle2,3*_.resolveTriangleIndex(ve),fe,de),triangle2.needsUpdate=!0,ye.intersectsTriangle(triangle2))return!0;return!1}});for(let Ae=ge,ye=me+ge;Ae<ye;Ae++){const ve=_.resolveTriangleIndex(Ae);setTriangle(triangle,3*ve,fe,de),triangle.a.applyMatrix4(invertedMat),triangle.b.applyMatrix4(invertedMat),triangle.c.applyMatrix4(invertedMat),triangle.needsUpdate=!0;for(let _e=0,Te=pe.count;_e<Te;_e+=3)if(setTriangle(triangle2,_e,pe,he),triangle2.needsUpdate=!0,triangle.intersectsTriangle(triangle2))return!0}}else{const ce=K+8,fe=se[K+6];return arrayToBox(ce,ie,boundingBox),!!(ne.intersectsBox(boundingBox)&&_intersectsGeometry(ce,_,Z,te,ne)||(arrayToBox(fe,ie,boundingBox),ne.intersectsBox(boundingBox)&&_intersectsGeometry(fe,_,Z,te,ne)))}}const tempMatrix=new Matrix4,obb$1=new OrientedBox,obb2=new OrientedBox,temp1=new Vector3,temp2=new Vector3,temp3=new Vector3,temp4=new Vector3;function closestPointToGeometry_indirect(K,_,Z,te={},ne={},ie=0,oe=1/0){_.boundingBox||_.computeBoundingBox(),obb$1.set(_.boundingBox.min,_.boundingBox.max,Z),obb$1.needsUpdate=!0;const se=K.geometry,ae=se.attributes.position,le=se.index,ce=_.attributes.position,fe=_.index,de=ExtendedTrianglePool.getPrimitive(),pe=ExtendedTrianglePool.getPrimitive();let he=temp1,ge=temp2,me=null,Ae=null;ne&&(me=temp3,Ae=temp4);let ye=1/0,ve=null,_e=null;return tempMatrix.copy(Z).invert(),obb2.matrix.copy(tempMatrix),K.shapecast({boundsTraverseOrder:Te=>obb$1.distanceToBox(Te),intersectsBounds:(Te,be,Re)=>Re<ye&&Re<oe?(be&&(obb2.min.copy(Te.min),obb2.max.copy(Te.max),obb2.needsUpdate=!0),!0):!1,intersectsRange:(Te,be)=>{if(_.boundsTree){const Re=_.boundsTree;return Re.shapecast({boundsTraverseOrder:we=>obb2.distanceToBox(we),intersectsBounds:(we,Pe,Ie)=>Ie<ye&&Ie<oe,intersectsRange:(we,Pe)=>{for(let Ie=we,$e=we+Pe;Ie<$e;Ie++){const Ue=Re.resolveTriangleIndex(Ie);setTriangle(pe,3*Ue,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let ke=Te,Ge=Te+be;ke<Ge;ke++){const He=K.resolveTriangleIndex(ke);setTriangle(de,3*He,le,ae),de.needsUpdate=!0;const ze=de.distanceToTriangle(pe,he,me);if(ze<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=ze,ve=ke,_e=Ie),ze<ie)return!0}}}})}else{const Re=getTriCount(_);for(let we=0,Pe=Re;we<Pe;we++){setTriangle(pe,3*we,fe,ce),pe.a.applyMatrix4(Z),pe.b.applyMatrix4(Z),pe.c.applyMatrix4(Z),pe.needsUpdate=!0;for(let Ie=Te,$e=Te+be;Ie<$e;Ie++){const Ue=K.resolveTriangleIndex(Ie);setTriangle(de,3*Ue,le,ae),de.needsUpdate=!0;const ke=de.distanceToTriangle(pe,he,me);if(ke<ye&&(ge.copy(he),Ae&&Ae.copy(me),ye=ke,ve=Ie,_e=we),ke<ie)return!0}}}}}),ExtendedTrianglePool.releasePrimitive(de),ExtendedTrianglePool.releasePrimitive(pe),ye===1/0?null:(te.point?te.point.copy(ge):te.point=ge.clone(),te.distance=ye,te.faceIndex=ve,ne&&(ne.point?ne.point.copy(Ae):ne.point=Ae.clone(),ne.point.applyMatrix4(tempMatrix),ge.applyMatrix4(tempMatrix),ne.distance=ge.sub(ne.point).length(),ne.faceIndex=_e),te)}function isSharedArrayBufferSupported(){return typeof SharedArrayBuffer<"u"}const _bufferStack1=new BufferStack.constructor,_bufferStack2=new BufferStack.constructor,_boxPool=new PrimitivePool(()=>new Box3),_leftBox1=new Box3,_rightBox1=new Box3,_leftBox2=new Box3,_rightBox2=new Box3;let _active=!1;function bvhcast(K,_,Z,te){if(_active)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");_active=!0;const ne=K._roots,ie=_._roots;let oe,se=0,ae=0;const le=new Matrix4().copy(Z).invert();for(let ce=0,fe=ne.length;ce<fe;ce++){_bufferStack1.setBuffer(ne[ce]),ae=0;const de=_boxPool.getPrimitive();arrayToBox(0,_bufferStack1.float32Array,de),de.applyMatrix4(le);for(let pe=0,he=ie.length;pe<he&&(_bufferStack2.setBuffer(ie[pe]),oe=_traverse(0,0,Z,le,te,se,ae,0,0,de),_bufferStack2.clearBuffer(),ae+=ie[pe].length,!oe);pe++);if(_boxPool.releasePrimitive(de),_bufferStack1.clearBuffer(),se+=ne[ce].length,oe)break}return _active=!1,oe}function _traverse(K,_,Z,te,ne,ie=0,oe=0,se=0,ae=0,le=null,ce=!1){let fe,de;ce?(fe=_bufferStack2,de=_bufferStack1):(fe=_bufferStack1,de=_bufferStack2);const pe=fe.float32Array,he=fe.uint32Array,ge=fe.uint16Array,me=de.float32Array,Ae=de.uint32Array,ye=de.uint16Array,ve=K*2,_e=_*2,Te=IS_LEAF(ve,ge),be=IS_LEAF(_e,ye);let Re=!1;if(be&&Te)ce?Re=ne(OFFSET(_,Ae),COUNT(_*2,ye),OFFSET(K,he),COUNT(K*2,ge),ae,oe+_,se,ie+K):Re=ne(OFFSET(K,he),COUNT(K*2,ge),OFFSET(_,Ae),COUNT(_*2,ye),se,ie+K,ae,oe+_);else if(be){const we=_boxPool.getPrimitive();arrayToBox(_,me,we),we.applyMatrix4(Z);const Pe=LEFT_NODE(K),Ie=RIGHT_NODE(K,he);arrayToBox(Pe,pe,_leftBox1),arrayToBox(Ie,pe,_rightBox1);const $e=we.intersectsBox(_leftBox1),Ue=we.intersectsBox(_rightBox1);Re=$e&&_traverse(_,Pe,te,Z,ne,oe,ie,ae,se+1,we,!ce)||Ue&&_traverse(_,Ie,te,Z,ne,oe,ie,ae,se+1,we,!ce),_boxPool.releasePrimitive(we)}else{const we=LEFT_NODE(_),Pe=RIGHT_NODE(_,Ae);arrayToBox(we,me,_leftBox2),arrayToBox(Pe,me,_rightBox2);const Ie=le.intersectsBox(_leftBox2),$e=le.intersectsBox(_rightBox2);if(Ie&&$e)Re=_traverse(K,we,Z,te,ne,ie,oe,se,ae+1,le,ce)||_traverse(K,Pe,Z,te,ne,ie,oe,se,ae+1,le,ce);else if(Ie)if(Te)Re=_traverse(K,we,Z,te,ne,ie,oe,se,ae+1,le,ce);else{const Ue=_boxPool.getPrimitive();Ue.copy(_leftBox2).applyMatrix4(Z);const ke=LEFT_NODE(K),Ge=RIGHT_NODE(K,he);arrayToBox(ke,pe,_leftBox1),arrayToBox(Ge,pe,_rightBox1);const He=Ue.intersectsBox(_leftBox1),ze=Ue.intersectsBox(_rightBox1);Re=He&&_traverse(we,ke,te,Z,ne,oe,ie,ae,se+1,Ue,!ce)||ze&&_traverse(we,Ge,te,Z,ne,oe,ie,ae,se+1,Ue,!ce),_boxPool.releasePrimitive(Ue)}else if($e)if(Te)Re=_traverse(K,Pe,Z,te,ne,ie,oe,se,ae+1,le,ce);else{const Ue=_boxPool.getPrimitive();Ue.copy(_rightBox2).applyMatrix4(Z);const ke=LEFT_NODE(K),Ge=RIGHT_NODE(K,he);arrayToBox(ke,pe,_leftBox1),arrayToBox(Ge,pe,_rightBox1);const He=Ue.intersectsBox(_leftBox1),ze=Ue.intersectsBox(_rightBox1);Re=He&&_traverse(Pe,ke,te,Z,ne,oe,ie,ae,se+1,Ue,!ce)||ze&&_traverse(Pe,Ge,te,Z,ne,oe,ie,ae,se+1,Ue,!ce),_boxPool.releasePrimitive(Ue)}}return Re}const obb=new OrientedBox,tempBox=new Box3,DEFAULT_OPTIONS={strategy:CENTER,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0,range:null};class MeshBVH{static serialize(_,Z={}){Z={cloneBuffers:!0,...Z};const te=_.geometry,ne=_._roots,ie=_._indirectBuffer,oe=te.getIndex();let se;return Z.cloneBuffers?se={roots:ne.map(ae=>ae.slice()),index:oe?oe.array.slice():null,indirectBuffer:ie?ie.slice():null}:se={roots:ne,index:oe?oe.array:null,indirectBuffer:ie},se}static deserialize(_,Z,te={}){te={setIndex:!0,indirect:!!_.indirectBuffer,...te};const{index:ne,roots:ie,indirectBuffer:oe}=_,se=new MeshBVH(Z,{...te,[SKIP_GENERATION]:!0});if(se._roots=ie,se._indirectBuffer=oe||null,te.setIndex){const ae=Z.getIndex();if(ae===null){const le=new BufferAttribute(_.index,1,!1);Z.setIndex(le)}else ae.array!==ne&&(ae.array.set(ne),ae.needsUpdate=!0)}return se}get indirect(){return!!this._indirectBuffer}constructor(_,Z={}){if(_.isBufferGeometry){if(_.index&&_.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(Z=Object.assign({...DEFAULT_OPTIONS,[SKIP_GENERATION]:!1},Z),Z.useSharedArrayBuffer&&!isSharedArrayBufferSupported())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=_,this._roots=null,this._indirectBuffer=null,Z[SKIP_GENERATION]||(buildPackedTree(this,Z),!_.boundingBox&&Z.setBoundingBox&&(_.boundingBox=this.getBoundingBox(new Box3))),this.resolveTriangleIndex=Z.indirect?te=>this._indirectBuffer[te]:te=>te}refit(_=null){return(this.indirect?refit_indirect:refit)(this,_)}traverse(_,Z=0){const te=this._roots[Z],ne=new Uint32Array(te),ie=new Uint16Array(te);oe(0);function oe(se,ae=0){const le=se*2,ce=ie[le+15]===IS_LEAFNODE_FLAG;if(ce){const fe=ne[se+6],de=ie[le+14];_(ae,ce,new Float32Array(te,se*4,6),fe,de)}else{const fe=se+BYTES_PER_NODE/4,de=ne[se+6],pe=ne[se+7];_(ae,ce,new Float32Array(te,se*4,6),pe)||(oe(fe,ae+1),oe(de,ae+1))}}}raycast(_,Z=FrontSide,te=0,ne=1/0){const ie=this._roots,oe=this.geometry,se=[],ae=Z.isMaterial,le=Array.isArray(Z),ce=oe.groups,fe=ae?Z.side:Z,de=this.indirect?raycast_indirect:raycast;for(let pe=0,he=ie.length;pe<he;pe++){const ge=le?Z[ce[pe].materialIndex].side:fe,me=se.length;if(de(this,pe,ge,_,se,te,ne),le){const Ae=ce[pe].materialIndex;for(let ye=me,ve=se.length;ye<ve;ye++)se[ye].face.materialIndex=Ae}}return se}raycastFirst(_,Z=FrontSide,te=0,ne=1/0){const ie=this._roots,oe=this.geometry,se=Z.isMaterial,ae=Array.isArray(Z);let le=null;const ce=oe.groups,fe=se?Z.side:Z,de=this.indirect?raycastFirst_indirect:raycastFirst;for(let pe=0,he=ie.length;pe<he;pe++){const ge=ae?Z[ce[pe].materialIndex].side:fe,me=de(this,pe,ge,_,te,ne);me!=null&&(le==null||me.distance<le.distance)&&(le=me,ae&&(me.face.materialIndex=ce[pe].materialIndex))}return le}intersectsGeometry(_,Z){let te=!1;const ne=this._roots,ie=this.indirect?intersectsGeometry_indirect:intersectsGeometry;for(let oe=0,se=ne.length;oe<se&&(te=ie(this,oe,_,Z),!te);oe++);return te}shapecast(_){const Z=ExtendedTrianglePool.getPrimitive(),te=this.indirect?iterateOverTriangles_indirect:iterateOverTriangles;let{boundsTraverseOrder:ne,intersectsBounds:ie,intersectsRange:oe,intersectsTriangle:se}=_;if(oe&&se){const fe=oe;oe=(de,pe,he,ge,me)=>fe(de,pe,he,ge,me)?!0:te(de,pe,this,se,he,ge,Z)}else oe||(se?oe=(fe,de,pe,he)=>te(fe,de,this,se,pe,he,Z):oe=(fe,de,pe)=>pe);let ae=!1,le=0;const ce=this._roots;for(let fe=0,de=ce.length;fe<de;fe++){const pe=ce[fe];if(ae=shapecast(this,fe,ie,oe,ne,le),ae)break;le+=pe.byteLength}return ExtendedTrianglePool.releasePrimitive(Z),ae}bvhcast(_,Z,te){let{intersectsRanges:ne,intersectsTriangles:ie}=te;const oe=ExtendedTrianglePool.getPrimitive(),se=this.geometry.index,ae=this.geometry.attributes.position,le=this.indirect?he=>{const ge=this.resolveTriangleIndex(he);setTriangle(oe,ge*3,se,ae)}:he=>{setTriangle(oe,he*3,se,ae)},ce=ExtendedTrianglePool.getPrimitive(),fe=_.geometry.index,de=_.geometry.attributes.position,pe=_.indirect?he=>{const ge=_.resolveTriangleIndex(he);setTriangle(ce,ge*3,fe,de)}:he=>{setTriangle(ce,he*3,fe,de)};if(ie){const he=(ge,me,Ae,ye,ve,_e,Te,be)=>{for(let Re=Ae,we=Ae+ye;Re<we;Re++){pe(Re),ce.a.applyMatrix4(Z),ce.b.applyMatrix4(Z),ce.c.applyMatrix4(Z),ce.needsUpdate=!0;for(let Pe=ge,Ie=ge+me;Pe<Ie;Pe++)if(le(Pe),oe.needsUpdate=!0,ie(oe,ce,Pe,Re,ve,_e,Te,be))return!0}return!1};if(ne){const ge=ne;ne=function(me,Ae,ye,ve,_e,Te,be,Re){return ge(me,Ae,ye,ve,_e,Te,be,Re)?!0:he(me,Ae,ye,ve,_e,Te,be,Re)}}else ne=he}return bvhcast(this,_,Z,ne)}intersectsBox(_,Z){return obb.set(_.min,_.max,Z),obb.needsUpdate=!0,this.shapecast({intersectsBounds:te=>obb.intersectsBox(te),intersectsTriangle:te=>obb.intersectsTriangle(te)})}intersectsSphere(_){return this.shapecast({intersectsBounds:Z=>_.intersectsBox(Z),intersectsTriangle:Z=>Z.intersectsSphere(_)})}closestPointToGeometry(_,Z,te={},ne={},ie=0,oe=1/0){return(this.indirect?closestPointToGeometry_indirect:closestPointToGeometry)(this,_,Z,te,ne,ie,oe)}closestPointToPoint(_,Z={},te=0,ne=1/0){return closestPointToPoint(this,_,Z,te,ne)}getBoundingBox(_){return _.makeEmpty(),this._roots.forEach(te=>{arrayToBox(0,new Float32Array(te),tempBox),_.union(tempBox)}),_}}function convertRaycastIntersect(K,_,Z){return K===null?null:(K.point.applyMatrix4(_.matrixWorld),K.distance=K.point.distanceTo(Z.ray.origin),K.object=_,K)}const ray=new Ray,direction=new Vector3,tmpInverseMatrix=new Matrix4,origMeshRaycastFunc=Mesh.prototype.raycast,origBatchedRaycastFunc=BatchedMesh.prototype.raycast,_worldScale=new Vector3,_mesh=new Mesh,_batchIntersects=[];function acceleratedRaycast(K,_){this.isBatchedMesh?acceleratedBatchedMeshRaycast.call(this,K,_):acceleratedMeshRaycast.call(this,K,_)}function acceleratedBatchedMeshRaycast(K,_){if(this.boundsTrees){const Z=this.boundsTrees,te=this._drawInfo,ne=this._drawRanges,ie=this.matrixWorld;_mesh.material=this.material,_mesh.geometry=this.geometry;const oe=_mesh.geometry.boundsTree,se=_mesh.geometry.drawRange;_mesh.geometry.boundingSphere===null&&(_mesh.geometry.boundingSphere=new Sphere$2);for(let ae=0,le=te.length;ae<le;ae++){if(!this.getVisibleAt(ae))continue;const ce=te[ae].geometryIndex;if(_mesh.geometry.boundsTree=Z[ce],this.getMatrixAt(ae,_mesh.matrixWorld).premultiply(ie),!_mesh.geometry.boundsTree){this.getBoundingBoxAt(ce,_mesh.geometry.boundingBox),this.getBoundingSphereAt(ce,_mesh.geometry.boundingSphere);const fe=ne[ce];_mesh.geometry.setDrawRange(fe.start,fe.count)}_mesh.raycast(K,_batchIntersects);for(let fe=0,de=_batchIntersects.length;fe<de;fe++){const pe=_batchIntersects[fe];pe.object=this,pe.batchId=ae,_.push(pe)}_batchIntersects.length=0}_mesh.geometry.boundsTree=oe,_mesh.geometry.drawRange=se,_mesh.material=null,_mesh.geometry=null}else origBatchedRaycastFunc.call(this,K,_)}function acceleratedMeshRaycast(K,_){if(this.geometry.boundsTree){if(this.material===void 0)return;tmpInverseMatrix.copy(this.matrixWorld).invert(),ray.copy(K.ray).applyMatrix4(tmpInverseMatrix),_worldScale.setFromMatrixScale(this.matrixWorld),direction.copy(ray.direction).multiply(_worldScale);const Z=direction.length(),te=K.near/Z,ne=K.far/Z,ie=this.geometry.boundsTree;if(K.firstHitOnly===!0){const oe=convertRaycastIntersect(ie.raycastFirst(ray,this.material,te,ne),this,K);oe&&_.push(oe)}else{const oe=ie.raycast(ray,this.material,te,ne);for(let se=0,ae=oe.length;se<ae;se++){const le=convertRaycastIntersect(oe[se],this,K);le&&_.push(le)}}}else origMeshRaycastFunc.call(this,K,_)}function countToStringFormat(K){switch(K){case 1:return"R";case 2:return"RG";case 3:return"RGBA";case 4:return"RGBA"}throw new Error}function countToFormat(K){switch(K){case 1:return RedFormat;case 2:return RGFormat;case 3:return RGBAFormat;case 4:return RGBAFormat}}function countToIntFormat(K){switch(K){case 1:return RedIntegerFormat;case 2:return RGIntegerFormat;case 3:return RGBAIntegerFormat;case 4:return RGBAIntegerFormat}}class VertexAttributeTexture extends DataTexture{constructor(){super(),this.minFilter=NearestFilter,this.magFilter=NearestFilter,this.generateMipmaps=!1,this.overrideItemSize=null,this._forcedType=null}updateFrom(_){const Z=this.overrideItemSize,te=_.itemSize,ne=_.count;if(Z!==null){if(te*ne%Z!==0)throw new Error("VertexAttributeTexture: overrideItemSize must divide evenly into buffer length.");_.itemSize=Z,_.count=ne*te/Z}const ie=_.itemSize,oe=_.count,se=_.normalized,ae=_.array.constructor,le=ae.BYTES_PER_ELEMENT;let ce=this._forcedType,fe=ie;if(ce===null)switch(ae){case Float32Array:ce=FloatType;break;case Uint8Array:case Uint16Array:case Uint32Array:ce=UnsignedIntType;break;case Int8Array:case Int16Array:case Int32Array:ce=IntType;break}let de,pe,he,ge,me=countToStringFormat(ie);switch(ce){case FloatType:he=1,pe=countToFormat(ie),se&&le===1?(ge=ae,me+="8",ae===Uint8Array?de=UnsignedByteType:(de=ByteType,me+="_SNORM")):(ge=Float32Array,me+="32F",de=FloatType);break;case IntType:me+=le*8+"I",he=se?Math.pow(2,ae.BYTES_PER_ELEMENT*8-1):1,pe=countToIntFormat(ie),le===1?(ge=Int8Array,de=ByteType):le===2?(ge=Int16Array,de=ShortType):(ge=Int32Array,de=IntType);break;case UnsignedIntType:me+=le*8+"UI",he=se?Math.pow(2,ae.BYTES_PER_ELEMENT*8-1):1,pe=countToIntFormat(ie),le===1?(ge=Uint8Array,de=UnsignedByteType):le===2?(ge=Uint16Array,de=UnsignedShortType):(ge=Uint32Array,de=UnsignedIntType);break}fe===3&&(pe===RGBAFormat||pe===RGBAIntegerFormat)&&(fe=4);const Ae=Math.ceil(Math.sqrt(oe))||1,ye=fe*Ae*Ae,ve=new ge(ye),_e=_.normalized;_.normalized=!1;for(let Te=0;Te<oe;Te++){const be=fe*Te;ve[be]=_.getX(Te)/he,ie>=2&&(ve[be+1]=_.getY(Te)/he),ie>=3&&(ve[be+2]=_.getZ(Te)/he,fe===4&&(ve[be+3]=1)),ie>=4&&(ve[be+3]=_.getW(Te)/he)}_.normalized=_e,this.internalFormat=me,this.format=pe,this.type=de,this.image.width=Ae,this.image.height=Ae,this.image.data=ve,this.needsUpdate=!0,this.dispose(),_.itemSize=te,_.count=ne}}class UIntVertexAttributeTexture extends VertexAttributeTexture{constructor(){super(),this._forcedType=UnsignedIntType}}class FloatVertexAttributeTexture extends VertexAttributeTexture{constructor(){super(),this._forcedType=FloatType}}class MeshBVHUniformStruct{constructor(){this.index=new UIntVertexAttributeTexture,this.position=new FloatVertexAttributeTexture,this.bvhBounds=new DataTexture,this.bvhContents=new DataTexture,this._cachedIndexAttr=null,this.index.overrideItemSize=3}updateFrom(_){const{geometry:Z}=_;if(bvhToTextures(_,this.bvhBounds,this.bvhContents),this.position.updateFrom(Z.attributes.position),_.indirect){const te=_._indirectBuffer;if(this._cachedIndexAttr===null||this._cachedIndexAttr.count!==te.length)if(Z.index)this._cachedIndexAttr=Z.index.clone();else{const ne=getIndexArray(getVertexCount(Z));this._cachedIndexAttr=new BufferAttribute(ne,1,!1)}dereferenceIndex(Z,te,this._cachedIndexAttr),this.index.updateFrom(this._cachedIndexAttr)}else this.index.updateFrom(Z.index)}dispose(){const{index:_,position:Z,bvhBounds:te,bvhContents:ne}=this;_&&_.dispose(),Z&&Z.dispose(),te&&te.dispose(),ne&&ne.dispose()}}function dereferenceIndex(K,_,Z){const te=Z.array,ne=K.index?K.index.array:null;for(let ie=0,oe=_.length;ie<oe;ie++){const se=3*ie,ae=3*_[ie];for(let le=0;le<3;le++)te[se+le]=ne?ne[ae+le]:ae+le}}function bvhToTextures(K,_,Z){const te=K._roots;if(te.length!==1)throw new Error("MeshBVHUniformStruct: Multi-root BVHs not supported.");const ne=te[0],ie=new Uint16Array(ne),oe=new Uint32Array(ne),se=new Float32Array(ne),ae=ne.byteLength/BYTES_PER_NODE,le=2*Math.ceil(Math.sqrt(ae/2)),ce=new Float32Array(4*le*le),fe=Math.ceil(Math.sqrt(ae)),de=new Uint32Array(2*fe*fe);for(let pe=0;pe<ae;pe++){const he=pe*BYTES_PER_NODE/4,ge=he*2,me=he;for(let Ae=0;Ae<3;Ae++)ce[8*pe+0+Ae]=se[me+0+Ae],ce[8*pe+4+Ae]=se[me+3+Ae];if(IS_LEAF(ge,ie)){const Ae=COUNT(ge,ie),ye=OFFSET(he,oe),ve=4294901760|Ae;de[pe*2+0]=ve,de[pe*2+1]=ye}else{const Ae=4*RIGHT_NODE(he,oe)/BYTES_PER_NODE,ye=SPLIT_AXIS(he,oe);de[pe*2+0]=ye,de[pe*2+1]=Ae}}_.image.data=ce,_.image.width=le,_.image.height=le,_.format=RGBAFormat,_.type=FloatType,_.internalFormat="RGBA32F",_.minFilter=NearestFilter,_.magFilter=NearestFilter,_.generateMipmaps=!1,_.needsUpdate=!0,_.dispose(),Z.image.data=de,Z.image.width=fe,Z.image.height=fe,Z.format=RGIntegerFormat,Z.type=UnsignedIntType,Z.internalFormat="RG32UI",Z.minFilter=NearestFilter,Z.magFilter=NearestFilter,Z.generateMipmaps=!1,Z.needsUpdate=!0,Z.dispose()}const common_functions=`

// A stack of uint32 indices can can store the indices for
// a perfectly balanced tree with a depth up to 31. Lower stack
// depth gets higher performance.
//
// However not all trees are balanced. Best value to set this to
// is the trees max depth.
#ifndef BVH_STACK_DEPTH
#define BVH_STACK_DEPTH 60
#endif

#ifndef INFINITY
#define INFINITY 1e20
#endif

// Utilities
uvec4 uTexelFetch1D( usampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

ivec4 iTexelFetch1D( isampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 texelFetch1D( sampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 textureSampleBarycoord( sampler2D tex, vec3 barycoord, uvec3 faceIndices ) {

	return
		barycoord.x * texelFetch1D( tex, faceIndices.x ) +
		barycoord.y * texelFetch1D( tex, faceIndices.y ) +
		barycoord.z * texelFetch1D( tex, faceIndices.z );

}

void ndcToCameraRay(
	vec2 coord, mat4 cameraWorld, mat4 invProjectionMatrix,
	out vec3 rayOrigin, out vec3 rayDirection
) {

	// get camera look direction and near plane for camera clipping
	vec4 lookDirection = cameraWorld * vec4( 0.0, 0.0, - 1.0, 0.0 );
	vec4 nearVector = invProjectionMatrix * vec4( 0.0, 0.0, - 1.0, 1.0 );
	float near = abs( nearVector.z / nearVector.w );

	// get the camera direction and position from camera matrices
	vec4 origin = cameraWorld * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec4 direction = invProjectionMatrix * vec4( coord, 0.5, 1.0 );
	direction /= direction.w;
	direction = cameraWorld * direction - origin;

	// slide the origin along the ray until it sits at the near clip plane position
	origin.xyz += direction.xyz * near / dot( direction, lookDirection );

	rayOrigin = origin.xyz;
	rayDirection = direction.xyz;

}
`,bvh_ray_functions=`

#ifndef TRI_INTERSECT_EPSILON
#define TRI_INTERSECT_EPSILON 1e-5
#endif

// Raycasting
bool intersectsBounds( vec3 rayOrigin, vec3 rayDirection, vec3 boundsMin, vec3 boundsMax, out float dist ) {

	// https://www.reddit.com/r/opengl/comments/8ntzz5/fast_glsl_ray_box_intersection/
	// https://tavianator.com/2011/ray_box.html
	vec3 invDir = 1.0 / rayDirection;

	// find intersection distances for each plane
	vec3 tMinPlane = invDir * ( boundsMin - rayOrigin );
	vec3 tMaxPlane = invDir * ( boundsMax - rayOrigin );

	// get the min and max distances from each intersection
	vec3 tMinHit = min( tMaxPlane, tMinPlane );
	vec3 tMaxHit = max( tMaxPlane, tMinPlane );

	// get the furthest hit distance
	vec2 t = max( tMinHit.xx, tMinHit.yz );
	float t0 = max( t.x, t.y );

	// get the minimum hit distance
	t = min( tMaxHit.xx, tMaxHit.yz );
	float t1 = min( t.x, t.y );

	// set distance to 0.0 if the ray starts inside the box
	dist = max( t0, 0.0 );

	return t1 >= dist;

}

bool intersectsTriangle(
	vec3 rayOrigin, vec3 rayDirection, vec3 a, vec3 b, vec3 c,
	out vec3 barycoord, out vec3 norm, out float dist, out float side
) {

	// https://stackoverflow.com/questions/42740765/intersection-between-line-and-triangle-in-3d
	vec3 edge1 = b - a;
	vec3 edge2 = c - a;
	norm = cross( edge1, edge2 );

	float det = - dot( rayDirection, norm );
	float invdet = 1.0 / det;

	vec3 AO = rayOrigin - a;
	vec3 DAO = cross( AO, rayDirection );

	vec4 uvt;
	uvt.x = dot( edge2, DAO ) * invdet;
	uvt.y = - dot( edge1, DAO ) * invdet;
	uvt.z = dot( AO, norm ) * invdet;
	uvt.w = 1.0 - uvt.x - uvt.y;

	// set the hit information
	barycoord = uvt.wxy; // arranged in A, B, C order
	dist = uvt.z;
	side = sign( det );
	norm = side * normalize( norm );

	// add an epsilon to avoid misses between triangles
	uvt += vec4( TRI_INTERSECT_EPSILON );

	return all( greaterThanEqual( uvt, vec4( 0.0 ) ) );

}

bool intersectTriangles(
	// geometry info and triangle range
	sampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// outputs
	inout float minDistance, inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	bool found = false;
	vec3 localBarycoord, localNormal;
	float localDist, localSide;
	for ( uint i = offset, l = offset + count; i < l; i ++ ) {

		uvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;
		vec3 a = texelFetch1D( positionAttr, indices.x ).rgb;
		vec3 b = texelFetch1D( positionAttr, indices.y ).rgb;
		vec3 c = texelFetch1D( positionAttr, indices.z ).rgb;

		if (
			intersectsTriangle( rayOrigin, rayDirection, a, b, c, localBarycoord, localNormal, localDist, localSide )
			&& localDist < minDistance
		) {

			found = true;
			minDistance = localDist;

			faceIndices = uvec4( indices.xyz, i );
			faceNormal = localNormal;

			side = localSide;
			barycoord = localBarycoord;
			dist = localDist;

		}

	}

	return found;

}

bool intersectsBVHNodeBounds( vec3 rayOrigin, vec3 rayDirection, sampler2D bvhBounds, uint currNodeIndex, out float dist ) {

	uint cni2 = currNodeIndex * 2u;
	vec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;
	vec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;
	return intersectsBounds( rayOrigin, rayDirection, boundsMin, boundsMax, dist );

}

// use a macro to hide the fact that we need to expand the struct into separate fields
#define	bvhIntersectFirstHit(		bvh,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)	_bvhIntersectFirstHit(		bvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)

bool _bvhIntersectFirstHit(
	// bvh info
	sampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// output variables split into separate variables due to output precision
	inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	// stack needs to be twice as long as the deepest tree we expect because
	// we push both the left and right child onto the stack every traversal
	int ptr = 0;
	uint stack[ BVH_STACK_DEPTH ];
	stack[ 0 ] = 0u;

	float triangleDistance = INFINITY;
	bool found = false;
	while ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {

		uint currNodeIndex = stack[ ptr ];
		ptr --;

		// check if we intersect the current bounds
		float boundsHitDistance;
		if (
			! intersectsBVHNodeBounds( rayOrigin, rayDirection, bvh_bvhBounds, currNodeIndex, boundsHitDistance )
			|| boundsHitDistance > triangleDistance
		) {

			continue;

		}

		uvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;
		bool isLeaf = bool( boundsInfo.x & 0xffff0000u );

		if ( isLeaf ) {

			uint count = boundsInfo.x & 0x0000ffffu;
			uint offset = boundsInfo.y;

			found = intersectTriangles(
				bvh_position, bvh_index, offset, count,
				rayOrigin, rayDirection, triangleDistance,
				faceIndices, faceNormal, barycoord, side, dist
			) || found;

		} else {

			uint leftIndex = currNodeIndex + 1u;
			uint splitAxis = boundsInfo.x & 0x0000ffffu;
			uint rightIndex = boundsInfo.y;

			bool leftToRight = rayDirection[ splitAxis ] >= 0.0;
			uint c1 = leftToRight ? leftIndex : rightIndex;
			uint c2 = leftToRight ? rightIndex : leftIndex;

			// set c2 in the stack so we traverse it later. We need to keep track of a pointer in
			// the stack while we traverse. The second pointer added is the one that will be
			// traversed first
			ptr ++;
			stack[ ptr ] = c2;

			ptr ++;
			stack[ ptr ] = c1;

		}

	}

	return found;

}
`,bvh_struct_definitions=`
struct BVH {

	usampler2D index;
	sampler2D position;

	sampler2D bvhBounds;
	usampler2D bvhContents;

};
`;function $6ed0406888f73fc4$var$setRef(K,_){typeof K=="function"?K(_):K!=null&&(K.current=_)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...K){return _=>K.forEach(Z=>$6ed0406888f73fc4$var$setRef(Z,_))}function $6ed0406888f73fc4$export$c7b2cbe3552a0d05(...K){return reactExports.useCallback($6ed0406888f73fc4$export$43e446d32b3d21af(...K),K)}const $5e63c961fc1ce211$export$8c6ed5c666ac1360$1=reactExports.forwardRef((K,_)=>{const{children:Z,...te}=K,ne=reactExports.Children.toArray(Z),ie=ne.find($5e63c961fc1ce211$var$isSlottable$1);if(ie){const oe=ie.props.children,se=ne.map(ae=>ae===ie?reactExports.Children.count(oe)>1?reactExports.Children.only(null):reactExports.isValidElement(oe)?oe.props.children:null:ae);return reactExports.createElement($5e63c961fc1ce211$var$SlotClone$1,_extends$3({},te,{ref:_}),reactExports.isValidElement(oe)?reactExports.cloneElement(oe,void 0,se):null)}return reactExports.createElement($5e63c961fc1ce211$var$SlotClone$1,_extends$3({},te,{ref:_}),Z)});$5e63c961fc1ce211$export$8c6ed5c666ac1360$1.displayName="Slot";const $5e63c961fc1ce211$var$SlotClone$1=reactExports.forwardRef((K,_)=>{const{children:Z,...te}=K;return reactExports.isValidElement(Z)?reactExports.cloneElement(Z,{...$5e63c961fc1ce211$var$mergeProps$1(te,Z.props),ref:$6ed0406888f73fc4$export$43e446d32b3d21af(_,Z.ref)}):reactExports.Children.count(Z)>1?reactExports.Children.only(null):null});$5e63c961fc1ce211$var$SlotClone$1.displayName="SlotClone";const $5e63c961fc1ce211$export$d9f1ccf0bdb05d45$1=({children:K})=>reactExports.createElement(reactExports.Fragment,null,K);function $5e63c961fc1ce211$var$isSlottable$1(K){return reactExports.isValidElement(K)&&K.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45$1}function $5e63c961fc1ce211$var$mergeProps$1(K,_){const Z={..._};for(const te in _){const ne=K[te],ie=_[te];/^on[A-Z]/.test(te)?ne&&ie?Z[te]=(...se)=>{ie(...se),ne(...se)}:ne&&(Z[te]=ne):te==="style"?Z[te]={...ne,...ie}:te==="className"&&(Z[te]=[ne,ie].filter(Boolean).join(" "))}return{...K,...Z}}const $8927f6f2acc4f386$var$NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],$8927f6f2acc4f386$export$250ffa63cdc0d034=$8927f6f2acc4f386$var$NODES.reduce((K,_)=>{const Z=reactExports.forwardRef((te,ne)=>{const{asChild:ie,...oe}=te,se=ie?$5e63c961fc1ce211$export$8c6ed5c666ac1360$1:_;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),reactExports.createElement(se,_extends$3({},oe,{ref:ne}))});return Z.displayName=`Primitive.${_}`,{...K,[_]:Z}},{});function $8927f6f2acc4f386$export$6d1a0317bde7de7f(K,_){K&&reactDomExports.flushSync(()=>K.dispatchEvent(_))}const $f1701beae083dbae$export$602eac185826482c=reactExports.forwardRef((K,_)=>{var Z;const{container:te=globalThis==null||(Z=globalThis.document)===null||Z===void 0?void 0:Z.body,...ne}=K;return te?ReactDOM.createPortal(reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$3({},ne,{ref:_})),te):null}),$f1701beae083dbae$export$be92b6f5f03c0fe9=$f1701beae083dbae$export$602eac185826482c;var has=Object.prototype.hasOwnProperty;function dequal(K,_){var Z,te;if(K===_)return!0;if(K&&_&&(Z=K.constructor)===_.constructor){if(Z===Date)return K.getTime()===_.getTime();if(Z===RegExp)return K.toString()===_.toString();if(Z===Array){if((te=K.length)===_.length)for(;te--&&dequal(K[te],_[te]););return te===-1}if(!Z||typeof K=="object"){te=0;for(Z in K)if(has.call(K,Z)&&++te&&!has.call(_,Z)||!(Z in _)||!dequal(K[Z],_[Z]))return!1;return Object.keys(_).length===te}}return K!==K&&_!==_}function shallow$8(K,_){if(Object.is(K,_))return!0;if(typeof K!="object"||K===null||typeof _!="object"||_===null)return!1;const Z=Object.keys(K);if(Z.length!==Object.keys(_).length)return!1;for(let te=0;te<Z.length;te++)if(!Object.prototype.hasOwnProperty.call(_,Z[te])||!Object.is(K[Z[te]],_[Z[te]]))return!1;return!0}var Rule=function(_,Z,te,ne){this.name=_,this.fn=Z,this.args=te,this.modifiers=ne};Rule.prototype._test=function(_){var Z=this.fn;try{testAux(this.modifiers.slice(),Z,this)(_)}catch{Z=function(){return!1}}try{return testAux(this.modifiers.slice(),Z,this)(_)}catch{return!1}};Rule.prototype._check=function(_){try{testAux(this.modifiers.slice(),this.fn,this)(_)}catch{if(testAux(this.modifiers.slice(),function(te){return te},this)(!1))return}if(!testAux(this.modifiers.slice(),this.fn,this)(_))throw null};Rule.prototype._testAsync=function(_){var Z=this;return new Promise(function(te,ne){testAsyncAux(Z.modifiers.slice(),Z.fn,Z)(_).then(function(ie){ie?te(_):ne(null)}).catch(function(ie){return ne(ie)})})};function pickFn(K,_){return _===void 0&&(_="simple"),typeof K=="object"?K[_]:K}function testAux(K,_,Z){if(K.length){var te=K.shift(),ne=testAux(K,_,Z);return te.perform(ne,Z)}else return pickFn(_)}function testAsyncAux(K,_,Z){if(K.length){var te=K.shift(),ne=testAsyncAux(K,_,Z);return te.performAsync(ne,Z)}else return function(ie){return Promise.resolve(pickFn(_,"async")(ie))}}var Modifier=function(_,Z,te){this.name=_,this.perform=Z,this.performAsync=te},ValidationError=function(K){function _(Z,te,ne,ie){for(var oe=[],se=arguments.length-4;se-- >0;)oe[se]=arguments[se+4];K.call(this,oe),K.captureStackTrace&&K.captureStackTrace(this,_),this.rule=Z,this.value=te,this.cause=ne,this.target=ie}return K&&(_.__proto__=K),_.prototype=Object.create(K&&K.prototype),_.prototype.constructor=_,_}(Error),Context=function(_,Z){_===void 0&&(_=[]),Z===void 0&&(Z=[]),this.chain=_,this.nextRuleModifiers=Z};Context.prototype._applyRule=function(_,Z){var te=this;return function(){for(var ne=[],ie=arguments.length;ie--;)ne[ie]=arguments[ie];return te.chain.push(new Rule(Z,_.apply(te,ne),ne,te.nextRuleModifiers)),te.nextRuleModifiers=[],te}};Context.prototype._applyModifier=function(_,Z){return this.nextRuleModifiers.push(new Modifier(Z,_.simple,_.async)),this};Context.prototype._clone=function(){return new Context(this.chain.slice(),this.nextRuleModifiers.slice())};Context.prototype.test=function(_){return this.chain.every(function(Z){return Z._test(_)})};Context.prototype.testAll=function(_){var Z=[];return this.chain.forEach(function(te){try{te._check(_)}catch(ne){Z.push(new ValidationError(te,_,ne))}}),Z};Context.prototype.check=function(_){this.chain.forEach(function(Z){try{Z._check(_)}catch(te){throw new ValidationError(Z,_,te)}})};Context.prototype.testAsync=function(_){var Z=this;return new Promise(function(te,ne){executeAsyncRules(_,Z.chain.slice(),te,ne)})};function executeAsyncRules(K,_,Z,te){if(_.length){var ne=_.shift();ne._testAsync(K).then(function(){executeAsyncRules(K,_,Z,te)},function(ie){te(new ValidationError(ne,K,ie))})}else Z(K)}var consideredEmpty=function(K,_){return _&&typeof K=="string"&&K.trim().length===0?!0:K==null};function optional(K,_){return _===void 0&&(_=!1),{simple:function(Z){return consideredEmpty(Z,_)||K.check(Z)===void 0},async:function(Z){return consideredEmpty(Z,_)||K.testAsync(Z)}}}function v8n(){return typeof Proxy<"u"?proxyContext(new Context):proxylessContext(new Context)}var customRules={};v8n.extend=function(K){Object.assign(customRules,K)};v8n.clearCustomRules=function(){customRules={}};function proxyContext(K){return new Proxy(K,{get:function(Z,te){if(te in Z)return Z[te];var ne=proxyContext(K._clone());if(te in availableModifiers)return ne._applyModifier(availableModifiers[te],te);if(te in customRules)return ne._applyRule(customRules[te],te);if(te in availableRules)return ne._applyRule(availableRules[te],te)}})}function proxylessContext(K){var _=function(ne,ie){return Object.keys(ne).forEach(function(oe){ie[oe]=function(){for(var se=[],ae=arguments.length;ae--;)se[ae]=arguments[ae];var le=proxylessContext(ie._clone()),ce=le._applyRule(ne[oe],oe).apply(void 0,se);return ce}}),ie},Z=_(availableRules,K),te=_(customRules,Z);return Object.keys(availableModifiers).forEach(function(ne){Object.defineProperty(te,ne,{get:function(){var ie=proxylessContext(te._clone());return ie._applyModifier(availableModifiers[ne],ne)}})}),te}var availableModifiers={not:{simple:function(K){return function(_){return!K(_)}},async:function(K){return function(_){return Promise.resolve(K(_)).then(function(Z){return!Z}).catch(function(){return!0})}}},some:{simple:function(K){return function(_){return split$1(_).some(function(Z){try{return K(Z)}catch{return!1}})}},async:function(K){return function(_){return Promise.all(split$1(_).map(function(Z){try{return K(Z).catch(function(){return!1})}catch{return!1}})).then(function(Z){return Z.some(Boolean)})}}},every:{simple:function(K){return function(_){return _!==!1&&split$1(_).every(K)}},async:function(K){return function(_){return Promise.all(split$1(_).map(K)).then(function(Z){return Z.every(Boolean)})}}},strict:{simple:function(K,_){return function(Z){return isSchemaRule(_)&&Z&&typeof Z=="object"?Object.keys(_.args[0]).length===Object.keys(Z).length&&K(Z):K(Z)}},async:function(K,_){return function(Z){return Promise.resolve(K(Z)).then(function(te){return isSchemaRule(_)&&Z&&typeof Z=="object"?Object.keys(_.args[0]).length===Object.keys(Z).length&&te:te}).catch(function(){return!1})}}}};function isSchemaRule(K){return K&&K.name==="schema"&&K.args.length>0&&typeof K.args[0]=="object"}function split$1(K){return typeof K=="string"?K.split(""):K}var availableRules={equal:function(K){return function(_){return _==K}},exact:function(K){return function(_){return _===K}},number:function(K){return K===void 0&&(K=!0),function(_){return typeof _=="number"&&(K||isFinite(_))}},integer:function(){return function(K){var _=Number.isInteger||isIntegerPolyfill;return _(K)}},numeric:function(){return function(K){return!isNaN(parseFloat(K))&&isFinite(K)}},string:function(){return testType("string")},boolean:function(){return testType("boolean")},undefined:function(){return testType("undefined")},null:function(){return testType("null")},array:function(){return testType("array")},object:function(){return testType("object")},instanceOf:function(K){return function(_){return _ instanceof K}},pattern:function(K){return function(_){return K.test(_)}},lowercase:function(){return function(K){return typeof K=="boolean"||K===K.toLowerCase()&&K.trim()!==""}},uppercase:function(){return function(K){return K===K.toUpperCase()&&K.trim()!==""}},vowel:function(){return function(K){return/^[aeiou]+$/i.test(K)}},consonant:function(){return function(K){return/^(?=[^aeiou])([a-z]+)$/i.test(K)}},first:function(K){return function(_){return _[0]==K}},last:function(K){return function(_){return _[_.length-1]==K}},empty:function(){return function(K){return K.length===0}},length:function(K,_){return function(Z){return Z.length>=K&&Z.length<=(_||K)}},minLength:function(K){return function(_){return _.length>=K}},maxLength:function(K){return function(_){return _.length<=K}},negative:function(){return function(K){return K<0}},positive:function(){return function(K){return K>=0}},between:function(K,_){return function(Z){return Z>=K&&Z<=_}},range:function(K,_){return function(Z){return Z>=K&&Z<=_}},lessThan:function(K){return function(_){return _<K}},lessThanOrEqual:function(K){return function(_){return _<=K}},greaterThan:function(K){return function(_){return _>K}},greaterThanOrEqual:function(K){return function(_){return _>=K}},even:function(){return function(K){return K%2===0}},odd:function(){return function(K){return K%2!==0}},includes:function(K){return function(_){return~_.indexOf(K)}},schema:function(K){return testSchema(K)},passesAnyOf:function(){for(var K=[],_=arguments.length;_--;)K[_]=arguments[_];return function(Z){return K.some(function(te){return te.test(Z)})}},optional};function testType(K){return function(_){return Array.isArray(_)&&K==="array"||_===null&&K==="null"||typeof _===K}}function isIntegerPolyfill(K){return typeof K=="number"&&isFinite(K)&&Math.floor(K)===K}function testSchema(K){return{simple:function(_){var Z=[];if(Object.keys(K).forEach(function(te){var ne=K[te];try{ne.check((_||{})[te])}catch(ie){ie.target=te,Z.push(ie)}}),Z.length>0)throw Z;return!0},async:function(_){var Z=[],te=Object.keys(K).map(function(ne){var ie=K[ne];return ie.testAsync((_||{})[ne]).catch(function(oe){oe.target=ne,Z.push(oe)})});return Promise.all(te).then(function(){if(Z.length>0)throw Z;return!0})}}}var e$2="colors",t$2="sizes",r$4="space",n$4={gap:r$4,gridGap:r$4,columnGap:r$4,gridColumnGap:r$4,rowGap:r$4,gridRowGap:r$4,inset:r$4,insetBlock:r$4,insetBlockEnd:r$4,insetBlockStart:r$4,insetInline:r$4,insetInlineEnd:r$4,insetInlineStart:r$4,margin:r$4,marginTop:r$4,marginRight:r$4,marginBottom:r$4,marginLeft:r$4,marginBlock:r$4,marginBlockEnd:r$4,marginBlockStart:r$4,marginInline:r$4,marginInlineEnd:r$4,marginInlineStart:r$4,padding:r$4,paddingTop:r$4,paddingRight:r$4,paddingBottom:r$4,paddingLeft:r$4,paddingBlock:r$4,paddingBlockEnd:r$4,paddingBlockStart:r$4,paddingInline:r$4,paddingInlineEnd:r$4,paddingInlineStart:r$4,top:r$4,right:r$4,bottom:r$4,left:r$4,scrollMargin:r$4,scrollMarginTop:r$4,scrollMarginRight:r$4,scrollMarginBottom:r$4,scrollMarginLeft:r$4,scrollMarginX:r$4,scrollMarginY:r$4,scrollMarginBlock:r$4,scrollMarginBlockEnd:r$4,scrollMarginBlockStart:r$4,scrollMarginInline:r$4,scrollMarginInlineEnd:r$4,scrollMarginInlineStart:r$4,scrollPadding:r$4,scrollPaddingTop:r$4,scrollPaddingRight:r$4,scrollPaddingBottom:r$4,scrollPaddingLeft:r$4,scrollPaddingX:r$4,scrollPaddingY:r$4,scrollPaddingBlock:r$4,scrollPaddingBlockEnd:r$4,scrollPaddingBlockStart:r$4,scrollPaddingInline:r$4,scrollPaddingInlineEnd:r$4,scrollPaddingInlineStart:r$4,fontSize:"fontSizes",background:e$2,backgroundColor:e$2,backgroundImage:e$2,borderImage:e$2,border:e$2,borderBlock:e$2,borderBlockEnd:e$2,borderBlockStart:e$2,borderBottom:e$2,borderBottomColor:e$2,borderColor:e$2,borderInline:e$2,borderInlineEnd:e$2,borderInlineStart:e$2,borderLeft:e$2,borderLeftColor:e$2,borderRight:e$2,borderRightColor:e$2,borderTop:e$2,borderTopColor:e$2,caretColor:e$2,color:e$2,columnRuleColor:e$2,fill:e$2,outline:e$2,outlineColor:e$2,stroke:e$2,textDecorationColor:e$2,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:t$2,minBlockSize:t$2,maxBlockSize:t$2,inlineSize:t$2,minInlineSize:t$2,maxInlineSize:t$2,width:t$2,minWidth:t$2,maxWidth:t$2,height:t$2,minHeight:t$2,maxHeight:t$2,flexBasis:t$2,gridTemplateColumns:t$2,gridTemplateRows:t$2,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i$9=(K,_)=>typeof _=="function"?{"()":Function.prototype.toString.call(_)}:_,o$3=()=>{const K=Object.create(null);return(_,Z,...te)=>{const ne=(ie=>JSON.stringify(ie,i$9))(_);return ne in K?K[ne]:K[ne]=Z(_,...te)}},l$3=Symbol.for("sxs.internal"),s$5=(K,_)=>Object.defineProperties(K,Object.getOwnPropertyDescriptors(_)),a$3=K=>{for(const _ in K)return!0;return!1},{hasOwnProperty:c$4}=Object.prototype,d$4=K=>K.includes("-")?K:K.replace(/[A-Z]/g,_=>"-"+_.toLowerCase()),g$4=/\s+(?![^()]*\))/,p$5=K=>_=>K(...typeof _=="string"?String(_).split(g$4):[_]),u$h={appearance:K=>({WebkitAppearance:K,appearance:K}),backfaceVisibility:K=>({WebkitBackfaceVisibility:K,backfaceVisibility:K}),backdropFilter:K=>({WebkitBackdropFilter:K,backdropFilter:K}),backgroundClip:K=>({WebkitBackgroundClip:K,backgroundClip:K}),boxDecorationBreak:K=>({WebkitBoxDecorationBreak:K,boxDecorationBreak:K}),clipPath:K=>({WebkitClipPath:K,clipPath:K}),content:K=>({content:K.includes('"')||K.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(K)?K:`"${K}"`}),hyphens:K=>({WebkitHyphens:K,hyphens:K}),maskImage:K=>({WebkitMaskImage:K,maskImage:K}),maskSize:K=>({WebkitMaskSize:K,maskSize:K}),tabSize:K=>({MozTabSize:K,tabSize:K}),textSizeAdjust:K=>({WebkitTextSizeAdjust:K,textSizeAdjust:K}),userSelect:K=>({WebkitUserSelect:K,userSelect:K}),marginBlock:p$5((K,_)=>({marginBlockStart:K,marginBlockEnd:_||K})),marginInline:p$5((K,_)=>({marginInlineStart:K,marginInlineEnd:_||K})),maxSize:p$5((K,_)=>({maxBlockSize:K,maxInlineSize:_||K})),minSize:p$5((K,_)=>({minBlockSize:K,minInlineSize:_||K})),paddingBlock:p$5((K,_)=>({paddingBlockStart:K,paddingBlockEnd:_||K})),paddingInline:p$5((K,_)=>({paddingInlineStart:K,paddingInlineEnd:_||K}))},h$5=/([\d.]+)([^]*)/,f$4=(K,_)=>K.length?K.reduce((Z,te)=>(Z.push(..._.map(ne=>ne.includes("&")?ne.replace(/&/g,/[ +>|~]/.test(te)&&/&.*&/.test(ne)?`:is(${te})`:te):te+" "+ne)),Z),[]):_,m$5=(K,_)=>K in b$4&&typeof _=="string"?_.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(Z,te,ne,ie)=>te+(ne==="stretch"?`-moz-available${ie};${d$4(K)}:${te}-webkit-fill-available`:`-moz-fit-content${ie};${d$4(K)}:${te}fit-content`)+ie):String(_),b$4={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},S$3=K=>K?K+"-":"",k$3=(K,_,Z)=>K.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(te,ne,ie,oe,se)=>oe=="$"==!!ie?te:(ne||oe=="--"?"calc(":"")+"var(--"+(oe==="$"?S$3(_)+(se.includes("$")?"":S$3(Z))+se.replace(/\$/g,"-"):se)+")"+(ne||oe=="--"?"*"+(ne||"")+(ie||"1")+")":"")),y$4=/\s*,\s*(?![^()]*\))/,B=Object.prototype.toString,$$3=(K,_,Z,te,ne)=>{let ie,oe,se;const ae=(le,ce,fe)=>{let de,pe;const he=ge=>{for(de in ge){const ye=de.charCodeAt(0)===64,ve=ye&&Array.isArray(ge[de])?ge[de]:[ge[de]];for(pe of ve){const _e=/[A-Z]/.test(Ae=de)?Ae:Ae.replace(/-[^]/g,be=>be[1].toUpperCase()),Te=typeof pe=="object"&&pe&&pe.toString===B&&(!te.utils[_e]||!ce.length);if(_e in te.utils&&!Te){const be=te.utils[_e];if(be!==oe){oe=be,he(be(pe)),oe=null;continue}}else if(_e in u$h){const be=u$h[_e];if(be!==se){se=be,he(be(pe)),se=null;continue}}if(ye&&(me=de.slice(1)in te.media?"@media "+te.media[de.slice(1)]:de,de=me.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(be,Re,we,Pe,Ie,$e)=>{const Ue=h$5.test(Re),ke=.0625*(Ue?-1:1),[Ge,He]=Ue?[Pe,Re]:[Re,Pe];return"("+(we[0]==="="?"":we[0]===">"===Ue?"max-":"min-")+Ge+":"+(we[0]!=="="&&we.length===1?He.replace(h$5,(ze,Ke,tt)=>Number(Ke)+ke*(we===">"?1:-1)+tt):He)+(Ie?") and ("+(Ie[0]===">"?"min-":"max-")+Ge+":"+(Ie.length===1?$e.replace(h$5,(ze,Ke,tt)=>Number(Ke)+ke*(Ie===">"?-1:1)+tt):$e):"")+")"})),Te){const be=ye?fe.concat(de):[...fe],Re=ye?[...ce]:f$4(ce,de.split(y$4));ie!==void 0&&ne(x$3(...ie)),ie=void 0,ae(pe,Re,be)}else ie===void 0&&(ie=[[],ce,fe]),de=ye||de.charCodeAt(0)!==36?de:`--${S$3(te.prefix)}${de.slice(1).replace(/\$/g,"-")}`,pe=Te?pe:typeof pe=="number"?pe&&_e in I$2?String(pe)+"px":String(pe):k$3(m$5(_e,pe??""),te.prefix,te.themeMap[_e]),ie[0].push(`${ye?`${de} `:`${d$4(de)}:`}${pe}`)}}var me,Ae};he(le),ie!==void 0&&ne(x$3(...ie)),ie=void 0};ae(K,_,Z)},x$3=(K,_,Z)=>`${Z.map(te=>`${te}{`).join("")}${_.length?`${_.join(",")}{`:""}${K.join(";")}${_.length?"}":""}${Array(Z.length?Z.length+1:0).join("}")}`,I$2={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},R$2=K=>String.fromCharCode(K+(K>25?39:97)),z$1=K=>(_=>{let Z,te="";for(Z=Math.abs(_);Z>52;Z=Z/52|0)te=R$2(Z%52)+te;return R$2(Z%52)+te})(((_,Z)=>{let te=Z.length;for(;te;)_=33*_^Z.charCodeAt(--te);return _})(5381,JSON.stringify(K))>>>0),W$1=["themed","global","styled","onevar","resonevar","allvar","inline"],j$1=K=>{if(K.href&&!K.href.startsWith(location.origin))return!1;try{return!!K.cssRules}catch{return!1}},E$1=K=>{let _;const Z=()=>{const{cssRules:ne}=_.sheet;return[].map.call(ne,(ie,oe)=>{const{cssText:se}=ie;let ae="";if(se.startsWith("--sxs"))return"";if(ne[oe-1]&&(ae=ne[oe-1].cssText).startsWith("--sxs")){if(!ie.cssRules.length)return"";for(const le in _.rules)if(_.rules[le].group===ie)return`--sxs{--sxs:${[..._.rules[le].cache].join(" ")}}${se}`;return ie.cssRules.length?`${ae}${se}`:""}return se}).join("")},te=()=>{if(_){const{rules:se,sheet:ae}=_;if(!ae.deleteRule){for(;Object(Object(ae.cssRules)[0]).type===3;)ae.cssRules.splice(0,1);ae.cssRules=[]}for(const le in se)delete se[le]}const ne=Object(K).styleSheets||[];for(const se of ne)if(j$1(se)){for(let ae=0,le=se.cssRules;le[ae];++ae){const ce=Object(le[ae]);if(ce.type!==1)continue;const fe=Object(le[ae+1]);if(fe.type!==4)continue;++ae;const{cssText:de}=ce;if(!de.startsWith("--sxs"))continue;const pe=de.slice(14,-3).trim().split(/\s+/),he=W$1[pe[0]];he&&(_||(_={sheet:se,reset:te,rules:{},toString:Z}),_.rules[he]={group:fe,index:ae,cache:new Set(pe)})}if(_)break}if(!_){const se=(ae,le)=>({type:le,cssRules:[],insertRule(ce,fe){this.cssRules.splice(fe,0,se(ce,{import:3,undefined:1}[(ce.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return ae==="@media{}"?`@media{${[].map.call(this.cssRules,ce=>ce.cssText).join("")}}`:ae}});_={sheet:K?(K.head||K).appendChild(document.createElement("style")).sheet:se("","text/css"),rules:{},reset:te,toString:Z}}const{sheet:ie,rules:oe}=_;for(let se=W$1.length-1;se>=0;--se){const ae=W$1[se];if(!oe[ae]){const le=W$1[se+1],ce=oe[le]?oe[le].index:ie.cssRules.length;ie.insertRule("@media{}",ce),ie.insertRule(`--sxs{--sxs:${se}}`,ce),oe[ae]={group:ie.cssRules[ce+1],index:ce,cache:new Set([se])}}v$4(oe[ae])}};return te(),_},v$4=K=>{const _=K.group;let Z=_.cssRules.length;K.apply=te=>{try{_.insertRule(te,Z),++Z}catch{}}},T$3=Symbol(),w$2=o$3(),M$1=(K,_)=>w$2(K,()=>(...Z)=>{let te={type:null,composers:new Set};for(const ne of Z)if(ne!=null)if(ne[l$3]){te.type==null&&(te.type=ne[l$3].type);for(const ie of ne[l$3].composers)te.composers.add(ie)}else ne.constructor!==Object||ne.$$typeof?te.type==null&&(te.type=ne):te.composers.add(C$1(ne,K));return te.type==null&&(te.type="span"),te.composers.size||te.composers.add(["PJLV",{},[],[],{},[]]),P$1(K,te,_)}),C$1=({variants:K,compoundVariants:_,defaultVariants:Z,...te},ne)=>{const ie=`${S$3(ne.prefix)}c-${z$1(te)}`,oe=[],se=[],ae=Object.create(null),le=[];for(const de in Z)ae[de]=String(Z[de]);if(typeof K=="object"&&K)for(const de in K){ce=ae,fe=de,c$4.call(ce,fe)||(ae[de]="undefined");const pe=K[de];for(const he in pe){const ge={[de]:String(he)};String(he)==="undefined"&&le.push(de);const me=pe[he],Ae=[ge,me,!a$3(me)];oe.push(Ae)}}var ce,fe;if(typeof _=="object"&&_)for(const de of _){let{css:pe,...he}=de;pe=typeof pe=="object"&&pe||{};for(const me in he)he[me]=String(he[me]);const ge=[he,pe,!a$3(pe)];se.push(ge)}return[ie,te,oe,se,ae,le]},P$1=(K,_,Z)=>{const[te,ne,ie,oe]=L$3(_.composers),se=typeof _.type=="function"||_.type.$$typeof?(fe=>{function de(){for(let pe=0;pe<de[T$3].length;pe++){const[he,ge]=de[T$3][pe];fe.rules[he].apply(ge)}return de[T$3]=[],null}return de[T$3]=[],de.rules={},W$1.forEach(pe=>de.rules[pe]={apply:he=>de[T$3].push([pe,he])}),de})(Z):null,ae=(se||Z).rules,le=`.${te}${ne.length>1?`:where(.${ne.slice(1).join(".")})`:""}`,ce=fe=>{fe=typeof fe=="object"&&fe||A$1;const{css:de,...pe}=fe,he={};for(const Ae in ie)if(delete pe[Ae],Ae in fe){let ye=fe[Ae];typeof ye=="object"&&ye?he[Ae]={"@initial":ie[Ae],...ye}:(ye=String(ye),he[Ae]=ye!=="undefined"||oe.has(Ae)?ye:ie[Ae])}else he[Ae]=ie[Ae];const ge=new Set([...ne]);for(const[Ae,ye,ve,_e]of _.composers){Z.rules.styled.cache.has(Ae)||(Z.rules.styled.cache.add(Ae),$$3(ye,[`.${Ae}`],[],K,Re=>{ae.styled.apply(Re)}));const Te=O$1(ve,he,K.media),be=O$1(_e,he,K.media,!0);for(const Re of Te)if(Re!==void 0)for(const[we,Pe,Ie]of Re){const $e=`${Ae}-${z$1(Pe)}-${we}`;ge.add($e);const Ue=(Ie?Z.rules.resonevar:Z.rules.onevar).cache,ke=Ie?ae.resonevar:ae.onevar;Ue.has($e)||(Ue.add($e),$$3(Pe,[`.${$e}`],[],K,Ge=>{ke.apply(Ge)}))}for(const Re of be)if(Re!==void 0)for(const[we,Pe]of Re){const Ie=`${Ae}-${z$1(Pe)}-${we}`;ge.add(Ie),Z.rules.allvar.cache.has(Ie)||(Z.rules.allvar.cache.add(Ie),$$3(Pe,[`.${Ie}`],[],K,$e=>{ae.allvar.apply($e)}))}}if(typeof de=="object"&&de){const Ae=`${te}-i${z$1(de)}-css`;ge.add(Ae),Z.rules.inline.cache.has(Ae)||(Z.rules.inline.cache.add(Ae),$$3(de,[`.${Ae}`],[],K,ye=>{ae.inline.apply(ye)}))}for(const Ae of String(fe.className||"").trim().split(/\s+/))Ae&&ge.add(Ae);const me=pe.className=[...ge].join(" ");return{type:_.type,className:me,selector:le,props:pe,toString:()=>me,deferredInjector:se}};return s$5(ce,{className:te,selector:le,[l$3]:_,toString:()=>(Z.rules.styled.cache.has(te)||ce(),te)})},L$3=K=>{let _="";const Z=[],te={},ne=[];for(const[ie,,,,oe,se]of K){_===""&&(_=ie),Z.push(ie),ne.push(...se);for(const ae in oe){const le=oe[ae];(te[ae]===void 0||le!=="undefined"||se.includes(le))&&(te[ae]=le)}}return[_,Z,te,new Set(ne)]},O$1=(K,_,Z,te)=>{const ne=[];e:for(let[ie,oe,se]of K){if(se)continue;let ae,le=0,ce=!1;for(ae in ie){const fe=ie[ae];let de=_[ae];if(de!==fe){if(typeof de!="object"||!de)continue e;{let pe,he,ge=0;for(const me in de){if(fe===String(de[me])){if(me!=="@initial"){const Ae=me.slice(1);(he=he||[]).push(Ae in Z?Z[Ae]:me.replace(/^@media ?/,"")),ce=!0}le+=ge,pe=!0}++ge}if(he&&he.length&&(oe={["@media "+he.join(", ")]:oe}),!pe)continue e}}}(ne[le]=ne[le]||[]).push([te?"cv":`${ae}-${ie[ae]}`,oe,ce])}return ne},A$1={},N$2=o$3(),D$2=(K,_)=>N$2(K,()=>(...Z)=>{const te=()=>{for(let ne of Z){ne=typeof ne=="object"&&ne||{};let ie=z$1(ne);if(!_.rules.global.cache.has(ie)){if(_.rules.global.cache.add(ie),"@import"in ne){let oe=[].indexOf.call(_.sheet.cssRules,_.rules.themed.group)-1;for(let se of[].concat(ne["@import"]))se=se.includes('"')||se.includes("'")?se:`"${se}"`,_.sheet.insertRule(`@import ${se};`,oe++);delete ne["@import"]}$$3(ne,[],[],K,oe=>{_.rules.global.apply(oe)})}}return""};return s$5(te,{toString:te})}),H$2=o$3(),V$1=(K,_)=>H$2(K,()=>Z=>{const te=`${S$3(K.prefix)}k-${z$1(Z)}`,ne=()=>{if(!_.rules.global.cache.has(te)){_.rules.global.cache.add(te);const ie=[];$$3(Z,[],[],K,se=>ie.push(se));const oe=`@keyframes ${te}{${ie.join("")}}`;_.rules.global.apply(oe)}return te};return s$5(ne,{get name(){return ne()},toString:ne})}),G=class{constructor(K,_,Z,te){this.token=K==null?"":String(K),this.value=_==null?"":String(_),this.scale=Z==null?"":String(Z),this.prefix=te==null?"":String(te)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+S$3(this.prefix)+S$3(this.scale)+this.token}toString(){return this.computedValue}},F$1=o$3(),J$1=(K,_)=>F$1(K,()=>(Z,te)=>{te=typeof Z=="object"&&Z||Object(te);const ne=`.${Z=(Z=typeof Z=="string"?Z:"")||`${S$3(K.prefix)}t-${z$1(te)}`}`,ie={},oe=[];for(const ae in te){ie[ae]={};for(const le in te[ae]){const ce=`--${S$3(K.prefix)}${ae}-${le}`,fe=k$3(String(te[ae][le]),K.prefix,ae);ie[ae][le]=new G(le,fe,ae,K.prefix),oe.push(`${ce}:${fe}`)}}const se=()=>{if(oe.length&&!_.rules.themed.cache.has(Z)){_.rules.themed.cache.add(Z);const ae=`${te===K.theme?":root,":""}.${Z}{${oe.join(";")}}`;_.rules.themed.apply(ae)}return Z};return{...ie,get className(){return se()},selector:ne,toString:se}}),U$1=o$3(),Y$1=o$3(),q$1=K=>{const _=(Z=>{let te=!1;const ne=U$1(Z,ie=>{te=!0;const oe="prefix"in(ie=typeof ie=="object"&&ie||{})?String(ie.prefix):"",se=typeof ie.media=="object"&&ie.media||{},ae=typeof ie.root=="object"?ie.root||null:globalThis.document||null,le=typeof ie.theme=="object"&&ie.theme||{},ce={prefix:oe,media:se,theme:le,themeMap:typeof ie.themeMap=="object"&&ie.themeMap||{...n$4},utils:typeof ie.utils=="object"&&ie.utils||{}},fe=E$1(ae),de={css:M$1(ce,fe),globalCss:D$2(ce,fe),keyframes:V$1(ce,fe),createTheme:J$1(ce,fe),reset(){fe.reset(),de.theme.toString()},theme:{},sheet:fe,config:ce,prefix:oe,getCssText:fe.toString,toString:fe.toString};return String(de.theme=de.createTheme(le)),de});return te||ne.reset(),ne})(K);return _.styled=(({config:Z,sheet:te})=>Y$1(Z,()=>{const ne=M$1(Z,te);return(...ie)=>{const oe=ne(...ie),se=oe[l$3].type,ae=React.forwardRef((le,ce)=>{const fe=le&&le.as||se,{props:de,deferredInjector:pe}=oe(le);return delete de.as,de.ref=ce,pe?React.createElement(React.Fragment,null,React.createElement(fe,de),React.createElement(pe,null)):React.createElement(fe,de)});return ae.className=oe.className,ae.displayName=`Styled.${se.displayName||se.name||se}`,ae.selector=oe.selector,ae.toString=()=>oe.selector,ae[l$3]=oe[l$3],ae}}))(_),_};function $e42e1063c40fb3ef$export$b9ecd428b558ff10(K,_,{checkForDefaultPrevented:Z=!0}={}){return function(ne){if(K==null||K(ne),Z===!1||!ne.defaultPrevented)return _==null?void 0:_(ne)}}function $c512c27ab02ef895$export$50c7b4e9d9f19c1(K,_=[]){let Z=[];function te(ie,oe){const se=reactExports.createContext(oe),ae=Z.length;Z=[...Z,oe];function le(fe){const{scope:de,children:pe,...he}=fe,ge=(de==null?void 0:de[K][ae])||se,me=reactExports.useMemo(()=>he,Object.values(he));return reactExports.createElement(ge.Provider,{value:me},pe)}function ce(fe,de){const pe=(de==null?void 0:de[K][ae])||se,he=reactExports.useContext(pe);if(he)return he;if(oe!==void 0)return oe;throw new Error(`\`${fe}\` must be used within \`${ie}\``)}return le.displayName=ie+"Provider",[le,ce]}const ne=()=>{const ie=Z.map(oe=>reactExports.createContext(oe));return function(se){const ae=(se==null?void 0:se[K])||ie;return reactExports.useMemo(()=>({[`__scope${K}`]:{...se,[K]:ae}}),[se,ae])}};return ne.scopeName=K,[te,$c512c27ab02ef895$var$composeContextScopes(ne,..._)]}function $c512c27ab02ef895$var$composeContextScopes(...K){const _=K[0];if(K.length===1)return _;const Z=()=>{const te=K.map(ne=>({useScope:ne(),scopeName:ne.scopeName}));return function(ie){const oe=te.reduce((se,{useScope:ae,scopeName:le})=>{const fe=ae(ie)[`__scope${le}`];return{...se,...fe}},{});return reactExports.useMemo(()=>({[`__scope${_.scopeName}`]:oe}),[oe])}};return Z.scopeName=_.scopeName,Z}function $b1b2314f5f9a1d84$export$25bec8c6f54ee79a(K){const _=reactExports.useRef(K);return reactExports.useEffect(()=>{_.current=K}),reactExports.useMemo(()=>(...Z)=>{var te;return(te=_.current)===null||te===void 0?void 0:te.call(_,...Z)},[])}function $addc16e1bbe58fd0$export$3a72a57244d6e765(K,_=globalThis==null?void 0:globalThis.document){const Z=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(K);reactExports.useEffect(()=>{const te=ne=>{ne.key==="Escape"&&Z(ne)};return _.addEventListener("keydown",te),()=>_.removeEventListener("keydown",te)},[Z,_])}const $5cb92bef7577960e$var$CONTEXT_UPDATE="dismissableLayer.update",$5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",$5cb92bef7577960e$var$FOCUS_OUTSIDE="dismissableLayer.focusOutside";let $5cb92bef7577960e$var$originalBodyPointerEvents;const $5cb92bef7577960e$var$DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$5cb92bef7577960e$export$177fb62ff3ec1f22=reactExports.forwardRef((K,_)=>{var Z;const{disableOutsidePointerEvents:te=!1,onEscapeKeyDown:ne,onPointerDownOutside:ie,onFocusOutside:oe,onInteractOutside:se,onDismiss:ae,...le}=K,ce=reactExports.useContext($5cb92bef7577960e$var$DismissableLayerContext),[fe,de]=reactExports.useState(null),pe=(Z=fe==null?void 0:fe.ownerDocument)!==null&&Z!==void 0?Z:globalThis==null?void 0:globalThis.document,[,he]=reactExports.useState({}),ge=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,we=>de(we)),me=Array.from(ce.layers),[Ae]=[...ce.layersWithOutsidePointerEventsDisabled].slice(-1),ye=me.indexOf(Ae),ve=fe?me.indexOf(fe):-1,_e=ce.layersWithOutsidePointerEventsDisabled.size>0,Te=ve>=ye,be=$5cb92bef7577960e$var$usePointerDownOutside(we=>{const Pe=we.target,Ie=[...ce.branches].some($e=>$e.contains(Pe));!Te||Ie||(ie==null||ie(we),se==null||se(we),we.defaultPrevented||ae==null||ae())},pe),Re=$5cb92bef7577960e$var$useFocusOutside(we=>{const Pe=we.target;[...ce.branches].some($e=>$e.contains(Pe))||(oe==null||oe(we),se==null||se(we),we.defaultPrevented||ae==null||ae())},pe);return $addc16e1bbe58fd0$export$3a72a57244d6e765(we=>{ve===ce.layers.size-1&&(ne==null||ne(we),!we.defaultPrevented&&ae&&(we.preventDefault(),ae()))},pe),reactExports.useEffect(()=>{if(fe)return te&&(ce.layersWithOutsidePointerEventsDisabled.size===0&&($5cb92bef7577960e$var$originalBodyPointerEvents=pe.body.style.pointerEvents,pe.body.style.pointerEvents="none"),ce.layersWithOutsidePointerEventsDisabled.add(fe)),ce.layers.add(fe),$5cb92bef7577960e$var$dispatchUpdate(),()=>{te&&ce.layersWithOutsidePointerEventsDisabled.size===1&&(pe.body.style.pointerEvents=$5cb92bef7577960e$var$originalBodyPointerEvents)}},[fe,pe,te,ce]),reactExports.useEffect(()=>()=>{fe&&(ce.layers.delete(fe),ce.layersWithOutsidePointerEventsDisabled.delete(fe),$5cb92bef7577960e$var$dispatchUpdate())},[fe,ce]),reactExports.useEffect(()=>{const we=()=>he({});return document.addEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,we),()=>document.removeEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,we)},[]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$3({},le,{ref:ge,style:{pointerEvents:_e?Te?"auto":"none":void 0,...K.style},onFocusCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onFocusCapture,Re.onFocusCapture),onBlurCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onBlurCapture,Re.onBlurCapture),onPointerDownCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onPointerDownCapture,be.onPointerDownCapture)}))});function $5cb92bef7577960e$var$usePointerDownOutside(K,_=globalThis==null?void 0:globalThis.document){const Z=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(K),te=reactExports.useRef(!1),ne=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const ie=se=>{if(se.target&&!te.current){let le=function(){$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE,Z,ae,{discrete:!0})};const ae={originalEvent:se};se.pointerType==="touch"?(_.removeEventListener("click",ne.current),ne.current=le,_.addEventListener("click",ne.current,{once:!0})):le()}te.current=!1},oe=window.setTimeout(()=>{_.addEventListener("pointerdown",ie)},0);return()=>{window.clearTimeout(oe),_.removeEventListener("pointerdown",ie),_.removeEventListener("click",ne.current)}},[_,Z]),{onPointerDownCapture:()=>te.current=!0}}function $5cb92bef7577960e$var$useFocusOutside(K,_=globalThis==null?void 0:globalThis.document){const Z=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(K),te=reactExports.useRef(!1);return reactExports.useEffect(()=>{const ne=ie=>{ie.target&&!te.current&&$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$FOCUS_OUTSIDE,Z,{originalEvent:ie},{discrete:!1})};return _.addEventListener("focusin",ne),()=>_.removeEventListener("focusin",ne)},[_,Z]),{onFocusCapture:()=>te.current=!0,onBlurCapture:()=>te.current=!1}}function $5cb92bef7577960e$var$dispatchUpdate(){const K=new CustomEvent($5cb92bef7577960e$var$CONTEXT_UPDATE);document.dispatchEvent(K)}function $5cb92bef7577960e$var$handleAndDispatchCustomEvent(K,_,Z,{discrete:te}){const ne=Z.originalEvent.target,ie=new CustomEvent(K,{bubbles:!1,cancelable:!0,detail:Z});_&&ne.addEventListener(K,_,{once:!0}),te?$8927f6f2acc4f386$export$6d1a0317bde7de7f(ne,ie):ne.dispatchEvent(ie)}const $9f79659886946c16$export$e5c5a5f917a5871c=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},$1746a345f3d73bb7$var$useReactId=$2AODx$react.useId||(()=>{});let $1746a345f3d73bb7$var$count=0;function $1746a345f3d73bb7$export$f680877a34711e37(K){const[_,Z]=reactExports.useState($1746a345f3d73bb7$var$useReactId());return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{Z(te=>te??String($1746a345f3d73bb7$var$count++))},[K]),_?`radix-${_}`:""}function t$1(K){return K.split("-")[0]}function e$1(K){return K.split("-")[1]}function n$3(K){return["top","bottom"].includes(t$1(K))?"x":"y"}function r$3(K){return K==="y"?"height":"width"}function i$8(K,_,Z){let{reference:te,floating:ne}=K;const ie=te.x+te.width/2-ne.width/2,oe=te.y+te.height/2-ne.height/2,se=n$3(_),ae=r$3(se),le=te[ae]/2-ne[ae]/2,ce=se==="x";let fe;switch(t$1(_)){case"top":fe={x:ie,y:te.y-ne.height};break;case"bottom":fe={x:ie,y:te.y+te.height};break;case"right":fe={x:te.x+te.width,y:oe};break;case"left":fe={x:te.x-ne.width,y:oe};break;default:fe={x:te.x,y:te.y}}switch(e$1(_)){case"start":fe[se]-=le*(Z&&ce?-1:1);break;case"end":fe[se]+=le*(Z&&ce?-1:1)}return fe}const o$2=async(K,_,Z)=>{const{placement:te="bottom",strategy:ne="absolute",middleware:ie=[],platform:oe}=Z,se=await(oe.isRTL==null?void 0:oe.isRTL(_));let ae=await oe.getElementRects({reference:K,floating:_,strategy:ne}),{x:le,y:ce}=i$8(ae,te,se),fe=te,de={},pe=0;for(let he=0;he<ie.length;he++){const{name:ge,fn:me}=ie[he],{x:Ae,y:ye,data:ve,reset:_e}=await me({x:le,y:ce,initialPlacement:te,placement:fe,strategy:ne,middlewareData:de,rects:ae,platform:oe,elements:{reference:K,floating:_}});le=Ae??le,ce=ye??ce,de={...de,[ge]:{...de[ge],...ve}},_e&&pe<=50&&(pe++,typeof _e=="object"&&(_e.placement&&(fe=_e.placement),_e.rects&&(ae=_e.rects===!0?await oe.getElementRects({reference:K,floating:_,strategy:ne}):_e.rects),{x:le,y:ce}=i$8(ae,fe,se)),he=-1)}return{x:le,y:ce,placement:fe,strategy:ne,middlewareData:de}};function a$2(K){return typeof K!="number"?function(_){return{top:0,right:0,bottom:0,left:0,..._}}(K):{top:K,right:K,bottom:K,left:K}}function l$2(K){return{...K,top:K.y,left:K.x,right:K.x+K.width,bottom:K.y+K.height}}async function s$4(K,_){var Z;_===void 0&&(_={});const{x:te,y:ne,platform:ie,rects:oe,elements:se,strategy:ae}=K,{boundary:le="clippingAncestors",rootBoundary:ce="viewport",elementContext:fe="floating",altBoundary:de=!1,padding:pe=0}=_,he=a$2(pe),ge=se[de?fe==="floating"?"reference":"floating":fe],me=l$2(await ie.getClippingRect({element:(Z=await(ie.isElement==null?void 0:ie.isElement(ge)))==null||Z?ge:ge.contextElement||await(ie.getDocumentElement==null?void 0:ie.getDocumentElement(se.floating)),boundary:le,rootBoundary:ce,strategy:ae})),Ae=l$2(ie.convertOffsetParentRelativeRectToViewportRelativeRect?await ie.convertOffsetParentRelativeRectToViewportRelativeRect({rect:fe==="floating"?{...oe.floating,x:te,y:ne}:oe.reference,offsetParent:await(ie.getOffsetParent==null?void 0:ie.getOffsetParent(se.floating)),strategy:ae}):oe[fe]);return{top:me.top-Ae.top+he.top,bottom:Ae.bottom-me.bottom+he.bottom,left:me.left-Ae.left+he.left,right:Ae.right-me.right+he.right}}const c$3=Math.min,f$3=Math.max;function u$g(K,_,Z){return f$3(K,c$3(_,Z))}const m$4=K=>({name:"arrow",options:K,async fn(_){const{element:Z,padding:te=0}=K??{},{x:ne,y:ie,placement:oe,rects:se,platform:ae}=_;if(Z==null)return{};const le=a$2(te),ce={x:ne,y:ie},fe=n$3(oe),de=e$1(oe),pe=r$3(fe),he=await ae.getDimensions(Z),ge=fe==="y"?"top":"left",me=fe==="y"?"bottom":"right",Ae=se.reference[pe]+se.reference[fe]-ce[fe]-se.floating[pe],ye=ce[fe]-se.reference[fe],ve=await(ae.getOffsetParent==null?void 0:ae.getOffsetParent(Z));let _e=ve?fe==="y"?ve.clientHeight||0:ve.clientWidth||0:0;_e===0&&(_e=se.floating[pe]);const Te=Ae/2-ye/2,be=le[ge],Re=_e-he[pe]-le[me],we=_e/2-he[pe]/2+Te,Pe=u$g(be,we,Re),Ie=(de==="start"?le[ge]:le[me])>0&&we!==Pe&&se.reference[pe]<=se.floating[pe];return{[fe]:ce[fe]-(Ie?we<be?be-we:Re-we:0),data:{[fe]:Pe,centerOffset:we-Pe}}}}),g$3={left:"right",right:"left",bottom:"top",top:"bottom"};function d$3(K){return K.replace(/left|right|bottom|top/g,_=>g$3[_])}function p$4(K,_,Z){Z===void 0&&(Z=!1);const te=e$1(K),ne=n$3(K),ie=r$3(ne);let oe=ne==="x"?te===(Z?"end":"start")?"right":"left":te==="start"?"bottom":"top";return _.reference[ie]>_.floating[ie]&&(oe=d$3(oe)),{main:oe,cross:d$3(oe)}}const h$4={start:"end",end:"start"};function y$3(K){return K.replace(/start|end/g,_=>h$4[_])}const x$2=["top","right","bottom","left"];x$2.reduce((K,_)=>K.concat(_,_+"-start",_+"-end"),[]);const b$3=function(K){return K===void 0&&(K={}),{name:"flip",options:K,async fn(_){var Z;const{placement:te,middlewareData:ne,rects:ie,initialPlacement:oe,platform:se,elements:ae}=_,{mainAxis:le=!0,crossAxis:ce=!0,fallbackPlacements:fe,fallbackStrategy:de="bestFit",flipAlignment:pe=!0,...he}=K,ge=t$1(te),me=fe||(ge===oe||!pe?[d$3(oe)]:function(we){const Pe=d$3(we);return[y$3(we),Pe,y$3(Pe)]}(oe)),Ae=[oe,...me],ye=await s$4(_,he),ve=[];let _e=((Z=ne.flip)==null?void 0:Z.overflows)||[];if(le&&ve.push(ye[ge]),ce){const{main:we,cross:Pe}=p$4(te,ie,await(se.isRTL==null?void 0:se.isRTL(ae.floating)));ve.push(ye[we],ye[Pe])}if(_e=[..._e,{placement:te,overflows:ve}],!ve.every(we=>we<=0)){var Te,be;const we=((Te=(be=ne.flip)==null?void 0:be.index)!=null?Te:0)+1,Pe=Ae[we];if(Pe)return{data:{index:we,overflows:_e},reset:{placement:Pe}};let Ie="bottom";switch(de){case"bestFit":{var Re;const $e=(Re=_e.map(Ue=>[Ue,Ue.overflows.filter(ke=>ke>0).reduce((ke,Ge)=>ke+Ge,0)]).sort((Ue,ke)=>Ue[1]-ke[1])[0])==null?void 0:Re[0].placement;$e&&(Ie=$e);break}case"initialPlacement":Ie=oe}if(te!==Ie)return{reset:{placement:Ie}}}return{}}}};function R$1(K,_){return{top:K.top-_.height,right:K.right-_.width,bottom:K.bottom-_.height,left:K.left-_.width}}function A(K){return x$2.some(_=>K[_]>=0)}const P=function(K){let{strategy:_="referenceHidden",...Z}=K===void 0?{}:K;return{name:"hide",async fn(te){const{rects:ne}=te;switch(_){case"referenceHidden":{const ie=R$1(await s$4(te,{...Z,elementContext:"reference"}),ne.reference);return{data:{referenceHiddenOffsets:ie,referenceHidden:A(ie)}}}case"escaped":{const ie=R$1(await s$4(te,{...Z,altBoundary:!0}),ne.floating);return{data:{escapedOffsets:ie,escaped:A(ie)}}}default:return{}}}}},T$2=function(K){return K===void 0&&(K=0),{name:"offset",options:K,async fn(_){const{x:Z,y:te}=_,ne=await async function(ie,oe){const{placement:se,platform:ae,elements:le}=ie,ce=await(ae.isRTL==null?void 0:ae.isRTL(le.floating)),fe=t$1(se),de=e$1(se),pe=n$3(se)==="x",he=["left","top"].includes(fe)?-1:1,ge=ce&&pe?-1:1,me=typeof oe=="function"?oe(ie):oe;let{mainAxis:Ae,crossAxis:ye,alignmentAxis:ve}=typeof me=="number"?{mainAxis:me,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...me};return de&&typeof ve=="number"&&(ye=de==="end"?-1*ve:ve),pe?{x:ye*ge,y:Ae*he}:{x:Ae*he,y:ye*ge}}(_,K);return{x:Z+ne.x,y:te+ne.y,data:ne}}}};function O(K){return K==="x"?"y":"x"}const D$1=function(K){return K===void 0&&(K={}),{name:"shift",options:K,async fn(_){const{x:Z,y:te,placement:ne}=_,{mainAxis:ie=!0,crossAxis:oe=!1,limiter:se={fn:me=>{let{x:Ae,y:ye}=me;return{x:Ae,y:ye}}},...ae}=K,le={x:Z,y:te},ce=await s$4(_,ae),fe=n$3(t$1(ne)),de=O(fe);let pe=le[fe],he=le[de];if(ie){const me=fe==="y"?"bottom":"right";pe=u$g(pe+ce[fe==="y"?"top":"left"],pe,pe-ce[me])}if(oe){const me=de==="y"?"bottom":"right";he=u$g(he+ce[de==="y"?"top":"left"],he,he-ce[me])}const ge=se.fn({..._,[fe]:pe,[de]:he});return{...ge,data:{x:ge.x-Z,y:ge.y-te}}}}},L$2=function(K){return K===void 0&&(K={}),{options:K,fn(_){const{x:Z,y:te,placement:ne,rects:ie,middlewareData:oe}=_,{offset:se=0,mainAxis:ae=!0,crossAxis:le=!0}=K,ce={x:Z,y:te},fe=n$3(ne),de=O(fe);let pe=ce[fe],he=ce[de];const ge=typeof se=="function"?se({...ie,placement:ne}):se,me=typeof ge=="number"?{mainAxis:ge,crossAxis:0}:{mainAxis:0,crossAxis:0,...ge};if(ae){const Te=fe==="y"?"height":"width",be=ie.reference[fe]-ie.floating[Te]+me.mainAxis,Re=ie.reference[fe]+ie.reference[Te]-me.mainAxis;pe<be?pe=be:pe>Re&&(pe=Re)}if(le){var Ae,ye,ve,_e;const Te=fe==="y"?"width":"height",be=["top","left"].includes(t$1(ne)),Re=ie.reference[de]-ie.floating[Te]+(be&&(Ae=(ye=oe.offset)==null?void 0:ye[de])!=null?Ae:0)+(be?0:me.crossAxis),we=ie.reference[de]+ie.reference[Te]+(be?0:(ve=(_e=oe.offset)==null?void 0:_e[de])!=null?ve:0)-(be?me.crossAxis:0);he<Re?he=Re:he>we&&(he=we)}return{[fe]:pe,[de]:he}}}},k$2=function(K){return K===void 0&&(K={}),{name:"size",options:K,async fn(_){const{placement:Z,rects:te,platform:ne,elements:ie}=_,{apply:oe,...se}=K,ae=await s$4(_,se),le=t$1(Z),ce=e$1(Z);let fe,de;le==="top"||le==="bottom"?(fe=le,de=ce===(await(ne.isRTL==null?void 0:ne.isRTL(ie.floating))?"start":"end")?"left":"right"):(de=le,fe=ce==="end"?"top":"bottom");const pe=f$3(ae.left,0),he=f$3(ae.right,0),ge=f$3(ae.top,0),me=f$3(ae.bottom,0),Ae={availableHeight:te.floating.height-(["left","right"].includes(Z)?2*(ge!==0||me!==0?ge+me:f$3(ae.top,ae.bottom)):ae[fe]),availableWidth:te.floating.width-(["top","bottom"].includes(Z)?2*(pe!==0||he!==0?pe+he:f$3(ae.left,ae.right)):ae[de])},ye=await ne.getDimensions(ie.floating);oe==null||oe({..._,...Ae});const ve=await ne.getDimensions(ie.floating);return ye.width!==ve.width||ye.height!==ve.height?{reset:{rects:!0}}:{}}}};function n$2(K){return K&&K.document&&K.location&&K.alert&&K.setInterval}function o$1(K){if(K==null)return window;if(!n$2(K)){const _=K.ownerDocument;return _&&_.defaultView||window}return K}function i$7(K){return o$1(K).getComputedStyle(K)}function r$2(K){return n$2(K)?"":K?(K.nodeName||"").toLowerCase():""}function l$1(){const K=navigator.userAgentData;return K!=null&&K.brands?K.brands.map(_=>_.brand+"/"+_.version).join(" "):navigator.userAgent}function c$2(K){return K instanceof o$1(K).HTMLElement}function f$2(K){return K instanceof o$1(K).Element}function s$3(K){return typeof ShadowRoot>"u"?!1:K instanceof o$1(K).ShadowRoot||K instanceof ShadowRoot}function u$f(K){const{overflow:_,overflowX:Z,overflowY:te}=i$7(K);return/auto|scroll|overlay|hidden/.test(_+te+Z)}function d$2(K){return["table","td","th"].includes(r$2(K))}function h$3(K){const _=/firefox/i.test(l$1()),Z=i$7(K);return Z.transform!=="none"||Z.perspective!=="none"||Z.contain==="paint"||["transform","perspective"].includes(Z.willChange)||_&&Z.willChange==="filter"||_&&!!Z.filter&&Z.filter!=="none"}function a$1(){return!/^((?!chrome|android).)*safari/i.test(l$1())}const g$2=Math.min,p$3=Math.max,m$3=Math.round;function w$1(K,_,Z){var te,ne,ie,oe;_===void 0&&(_=!1),Z===void 0&&(Z=!1);const se=K.getBoundingClientRect();let ae=1,le=1;_&&c$2(K)&&(ae=K.offsetWidth>0&&m$3(se.width)/K.offsetWidth||1,le=K.offsetHeight>0&&m$3(se.height)/K.offsetHeight||1);const ce=f$2(K)?o$1(K):window,fe=!a$1()&&Z,de=(se.left+(fe&&(te=(ne=ce.visualViewport)==null?void 0:ne.offsetLeft)!=null?te:0))/ae,pe=(se.top+(fe&&(ie=(oe=ce.visualViewport)==null?void 0:oe.offsetTop)!=null?ie:0))/le,he=se.width/ae,ge=se.height/le;return{width:he,height:ge,top:pe,right:de+he,bottom:pe+ge,left:de,x:de,y:pe}}function v$3(K){return(_=K,(_ instanceof o$1(_).Node?K.ownerDocument:K.document)||window.document).documentElement;var _}function y$2(K){return f$2(K)?{scrollLeft:K.scrollLeft,scrollTop:K.scrollTop}:{scrollLeft:K.pageXOffset,scrollTop:K.pageYOffset}}function x$1(K){return w$1(v$3(K)).left+y$2(K).scrollLeft}function b$2(K,_,Z){const te=c$2(_),ne=v$3(_),ie=w$1(K,te&&function(ae){const le=w$1(ae);return m$3(le.width)!==ae.offsetWidth||m$3(le.height)!==ae.offsetHeight}(_),Z==="fixed");let oe={scrollLeft:0,scrollTop:0};const se={x:0,y:0};if(te||!te&&Z!=="fixed")if((r$2(_)!=="body"||u$f(ne))&&(oe=y$2(_)),c$2(_)){const ae=w$1(_,!0);se.x=ae.x+_.clientLeft,se.y=ae.y+_.clientTop}else ne&&(se.x=x$1(ne));return{x:ie.left+oe.scrollLeft-se.x,y:ie.top+oe.scrollTop-se.y,width:ie.width,height:ie.height}}function L$1(K){return r$2(K)==="html"?K:K.assignedSlot||K.parentNode||(s$3(K)?K.host:null)||v$3(K)}function R(K){return c$2(K)&&getComputedStyle(K).position!=="fixed"?K.offsetParent:null}function T$1(K){const _=o$1(K);let Z=R(K);for(;Z&&d$2(Z)&&getComputedStyle(Z).position==="static";)Z=R(Z);return Z&&(r$2(Z)==="html"||r$2(Z)==="body"&&getComputedStyle(Z).position==="static"&&!h$3(Z))?_:Z||function(te){let ne=L$1(te);for(s$3(ne)&&(ne=ne.host);c$2(ne)&&!["html","body"].includes(r$2(ne));){if(h$3(ne))return ne;ne=ne.parentNode}return null}(K)||_}function W(K){if(c$2(K))return{width:K.offsetWidth,height:K.offsetHeight};const _=w$1(K);return{width:_.width,height:_.height}}function E(K){const _=L$1(K);return["html","body","#document"].includes(r$2(_))?K.ownerDocument.body:c$2(_)&&u$f(_)?_:E(_)}function H$1(K,_){var Z;_===void 0&&(_=[]);const te=E(K),ne=te===((Z=K.ownerDocument)==null?void 0:Z.body),ie=o$1(te),oe=ne?[ie].concat(ie.visualViewport||[],u$f(te)?te:[]):te,se=_.concat(oe);return ne?se:se.concat(H$1(oe))}function C(K,_,Z){return _==="viewport"?l$2(function(te,ne){const ie=o$1(te),oe=v$3(te),se=ie.visualViewport;let ae=oe.clientWidth,le=oe.clientHeight,ce=0,fe=0;if(se){ae=se.width,le=se.height;const de=a$1();(de||!de&&ne==="fixed")&&(ce=se.offsetLeft,fe=se.offsetTop)}return{width:ae,height:le,x:ce,y:fe}}(K,Z)):f$2(_)?function(te,ne){const ie=w$1(te,!1,ne==="fixed"),oe=ie.top+te.clientTop,se=ie.left+te.clientLeft;return{top:oe,left:se,x:se,y:oe,right:se+te.clientWidth,bottom:oe+te.clientHeight,width:te.clientWidth,height:te.clientHeight}}(_,Z):l$2(function(te){var ne;const ie=v$3(te),oe=y$2(te),se=(ne=te.ownerDocument)==null?void 0:ne.body,ae=p$3(ie.scrollWidth,ie.clientWidth,se?se.scrollWidth:0,se?se.clientWidth:0),le=p$3(ie.scrollHeight,ie.clientHeight,se?se.scrollHeight:0,se?se.clientHeight:0);let ce=-oe.scrollLeft+x$1(te);const fe=-oe.scrollTop;return i$7(se||ie).direction==="rtl"&&(ce+=p$3(ie.clientWidth,se?se.clientWidth:0)-ae),{width:ae,height:le,x:ce,y:fe}}(v$3(K)))}function S$2(K){const _=H$1(K),Z=["absolute","fixed"].includes(i$7(K).position)&&c$2(K)?T$1(K):K;return f$2(Z)?_.filter(te=>f$2(te)&&function(ne,ie){const oe=ie.getRootNode==null?void 0:ie.getRootNode();if(ne.contains(ie))return!0;if(oe&&s$3(oe)){let se=ie;do{if(se&&ne===se)return!0;se=se.parentNode||se.host}while(se)}return!1}(te,Z)&&r$2(te)!=="body"):[]}const D={getClippingRect:function(K){let{element:_,boundary:Z,rootBoundary:te,strategy:ne}=K;const ie=[...Z==="clippingAncestors"?S$2(_):[].concat(Z),te],oe=ie[0],se=ie.reduce((ae,le)=>{const ce=C(_,le,ne);return ae.top=p$3(ce.top,ae.top),ae.right=g$2(ce.right,ae.right),ae.bottom=g$2(ce.bottom,ae.bottom),ae.left=p$3(ce.left,ae.left),ae},C(_,oe,ne));return{width:se.right-se.left,height:se.bottom-se.top,x:se.left,y:se.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(K){let{rect:_,offsetParent:Z,strategy:te}=K;const ne=c$2(Z),ie=v$3(Z);if(Z===ie)return _;let oe={scrollLeft:0,scrollTop:0};const se={x:0,y:0};if((ne||!ne&&te!=="fixed")&&((r$2(Z)!=="body"||u$f(ie))&&(oe=y$2(Z)),c$2(Z))){const ae=w$1(Z,!0);se.x=ae.x+Z.clientLeft,se.y=ae.y+Z.clientTop}return{..._,x:_.x-oe.scrollLeft+se.x,y:_.y-oe.scrollTop+se.y}},isElement:f$2,getDimensions:W,getOffsetParent:T$1,getDocumentElement:v$3,getElementRects:K=>{let{reference:_,floating:Z,strategy:te}=K;return{reference:b$2(_,T$1(Z),te),floating:{...W(Z),x:0,y:0}}},getClientRects:K=>Array.from(K.getClientRects()),isRTL:K=>i$7(K).direction==="rtl"};function N$1(K,_,Z,te){te===void 0&&(te={});const{ancestorScroll:ne=!0,ancestorResize:ie=!0,elementResize:oe=!0,animationFrame:se=!1}=te,ae=ne&&!se,le=ie&&!se,ce=ae||le?[...f$2(K)?H$1(K):[],...H$1(_)]:[];ce.forEach(he=>{ae&&he.addEventListener("scroll",Z,{passive:!0}),le&&he.addEventListener("resize",Z)});let fe,de=null;if(oe){let he=!0;de=new ResizeObserver(()=>{he||Z(),he=!1}),f$2(K)&&!se&&de.observe(K),de.observe(_)}let pe=se?w$1(K):null;return se&&function he(){const ge=w$1(K);!pe||ge.x===pe.x&&ge.y===pe.y&&ge.width===pe.width&&ge.height===pe.height||Z(),pe=ge,fe=requestAnimationFrame(he)}(),Z(),()=>{var he;ce.forEach(ge=>{ae&&ge.removeEventListener("scroll",Z),le&&ge.removeEventListener("resize",Z)}),(he=de)==null||he.disconnect(),de=null,se&&cancelAnimationFrame(fe)}}const z=(K,_,Z)=>o$2(K,_,{platform:D,...Z});var index$3=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual(K,_){if(K===_)return!0;if(typeof K!=typeof _)return!1;if(typeof K=="function"&&K.toString()===_.toString())return!0;let Z,te,ne;if(K&&_&&typeof K=="object"){if(Array.isArray(K)){if(Z=K.length,Z!=_.length)return!1;for(te=Z;te--!==0;)if(!deepEqual(K[te],_[te]))return!1;return!0}if(ne=Object.keys(K),Z=ne.length,Z!==Object.keys(_).length)return!1;for(te=Z;te--!==0;)if(!Object.prototype.hasOwnProperty.call(_,ne[te]))return!1;for(te=Z;te--!==0;){const ie=ne[te];if(!(ie==="_owner"&&K.$$typeof)&&!deepEqual(K[ie],_[ie]))return!1}return!0}return K!==K&&_!==_}function useLatestRef(K){const _=reactExports.useRef(K);return index$3(()=>{_.current=K}),_}function useFloating(K){let{middleware:_,placement:Z="bottom",strategy:te="absolute",whileElementsMounted:ne}=K===void 0?{}:K;const ie=reactExports.useRef(null),oe=reactExports.useRef(null),se=useLatestRef(ne),ae=reactExports.useRef(null),[le,ce]=reactExports.useState({x:null,y:null,strategy:te,placement:Z,middlewareData:{}}),[fe,de]=reactExports.useState(_);deepEqual(fe==null?void 0:fe.map(ve=>{let{options:_e}=ve;return _e}),_==null?void 0:_.map(ve=>{let{options:_e}=ve;return _e}))||de(_);const pe=reactExports.useCallback(()=>{!ie.current||!oe.current||z(ie.current,oe.current,{middleware:fe,placement:Z,strategy:te}).then(ve=>{he.current&&reactDomExports.flushSync(()=>{ce(ve)})})},[fe,Z,te]);index$3(()=>{he.current&&pe()},[pe]);const he=reactExports.useRef(!1);index$3(()=>(he.current=!0,()=>{he.current=!1}),[]);const ge=reactExports.useCallback(()=>{if(typeof ae.current=="function"&&(ae.current(),ae.current=null),ie.current&&oe.current)if(se.current){const ve=se.current(ie.current,oe.current,pe);ae.current=ve}else pe()},[pe,se]),me=reactExports.useCallback(ve=>{ie.current=ve,ge()},[ge]),Ae=reactExports.useCallback(ve=>{oe.current=ve,ge()},[ge]),ye=reactExports.useMemo(()=>({reference:ie,floating:oe}),[]);return reactExports.useMemo(()=>({...le,update:pe,refs:ye,reference:me,floating:Ae}),[le,pe,ye,me,Ae])}const arrow=K=>{const{element:_,padding:Z}=K;function te(ne){return Object.prototype.hasOwnProperty.call(ne,"current")}return{name:"arrow",options:K,fn(ne){return te(_)?_.current!=null?m$4({element:_.current,padding:Z}).fn(ne):{}:_?m$4({element:_,padding:Z}).fn(ne):{}}}},$7e8f5cd07187803e$export$21b07c8f274aebd5=reactExports.forwardRef((K,_)=>{const{children:Z,width:te=10,height:ne=5,...ie}=K;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.svg,_extends$3({},ie,{ref:_,width:te,height:ne,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),K.asChild?Z:reactExports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),$7e8f5cd07187803e$export$be92b6f5f03c0fe9=$7e8f5cd07187803e$export$21b07c8f274aebd5;function $db6c3485150b8e66$export$1ab7ae714698c4b8(K){const[_,Z]=reactExports.useState(void 0);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(K){Z({width:K.offsetWidth,height:K.offsetHeight});const te=new ResizeObserver(ne=>{if(!Array.isArray(ne)||!ne.length)return;const ie=ne[0];let oe,se;if("borderBoxSize"in ie){const ae=ie.borderBoxSize,le=Array.isArray(ae)?ae[0]:ae;oe=le.inlineSize,se=le.blockSize}else oe=K.offsetWidth,se=K.offsetHeight;Z({width:oe,height:se})});return te.observe(K,{box:"border-box"}),()=>te.unobserve(K)}else Z(void 0)},[K]),_}const $cf1ac5d9fe0e8206$var$POPPER_NAME="Popper",[$cf1ac5d9fe0e8206$var$createPopperContext,$cf1ac5d9fe0e8206$export$722aac194ae923]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cf1ac5d9fe0e8206$var$POPPER_NAME),[$cf1ac5d9fe0e8206$var$PopperProvider,$cf1ac5d9fe0e8206$var$usePopperContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$POPPER_NAME),$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9=K=>{const{__scopePopper:_,children:Z}=K,[te,ne]=reactExports.useState(null);return reactExports.createElement($cf1ac5d9fe0e8206$var$PopperProvider,{scope:_,anchor:te,onAnchorChange:ne},Z)},$cf1ac5d9fe0e8206$var$ANCHOR_NAME="PopperAnchor",$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d=reactExports.forwardRef((K,_)=>{const{__scopePopper:Z,virtualRef:te,...ne}=K,ie=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$ANCHOR_NAME,Z),oe=reactExports.useRef(null),se=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,oe);return reactExports.useEffect(()=>{ie.onAnchorChange((te==null?void 0:te.current)||oe.current)}),te?null:reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$3({},ne,{ref:se}))}),$cf1ac5d9fe0e8206$var$CONTENT_NAME="PopperContent",[$cf1ac5d9fe0e8206$var$PopperContentProvider,$cf1ac5d9fe0e8206$var$useContentContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME),[$cf1ac5d9fe0e8206$var$PositionContextProvider,$cf1ac5d9fe0e8206$var$usePositionContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME,{hasParent:!1,positionUpdateFns:new Set}),$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc=reactExports.forwardRef((K,_)=>{var Z,te,ne,ie,oe,se,ae,le;const{__scopePopper:ce,side:fe="bottom",sideOffset:de=0,align:pe="center",alignOffset:he=0,arrowPadding:ge=0,collisionBoundary:me=[],collisionPadding:Ae=0,sticky:ye="partial",hideWhenDetached:ve=!1,avoidCollisions:_e=!0,onPlaced:Te,...be}=K,Re=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME,ce),[we,Pe]=reactExports.useState(null),Ie=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,st=>Pe(st)),[$e,Ue]=reactExports.useState(null),ke=$db6c3485150b8e66$export$1ab7ae714698c4b8($e),Ge=(Z=ke==null?void 0:ke.width)!==null&&Z!==void 0?Z:0,He=(te=ke==null?void 0:ke.height)!==null&&te!==void 0?te:0,ze=fe+(pe!=="center"?"-"+pe:""),Ke=typeof Ae=="number"?Ae:{top:0,right:0,bottom:0,left:0,...Ae},tt=Array.isArray(me)?me:[me],Je=tt.length>0,ot={padding:Ke,boundary:tt.filter($cf1ac5d9fe0e8206$var$isNotNull),altBoundary:Je},{reference:Fe,floating:ct,strategy:ht,x:lt,y:Qe,placement:Ze,middlewareData:it,update:nt}=useFloating({strategy:"fixed",placement:ze,whileElementsMounted:N$1,middleware:[$cf1ac5d9fe0e8206$var$anchorCssProperties(),T$2({mainAxis:de+He,alignmentAxis:he}),_e?D$1({mainAxis:!0,crossAxis:!1,limiter:ye==="partial"?L$2():void 0,...ot}):void 0,$e?arrow({element:$e,padding:ge}):void 0,_e?b$3({...ot}):void 0,k$2({...ot,apply:({elements:st,availableWidth:vt,availableHeight:Pt})=>{st.floating.style.setProperty("--radix-popper-available-width",`${vt}px`),st.floating.style.setProperty("--radix-popper-available-height",`${Pt}px`)}}),$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:Ge,arrowHeight:He}),ve?P({strategy:"referenceHidden"}):void 0].filter($cf1ac5d9fe0e8206$var$isDefined)});$9f79659886946c16$export$e5c5a5f917a5871c(()=>{Fe(Re.anchor)},[Fe,Re.anchor]);const Tt=lt!==null&&Qe!==null,[St,Et]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(Ze),Nt=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Te);$9f79659886946c16$export$e5c5a5f917a5871c(()=>{Tt&&(Nt==null||Nt())},[Tt,Nt]);const zt=(ne=it.arrow)===null||ne===void 0?void 0:ne.x,yt=(ie=it.arrow)===null||ie===void 0?void 0:ie.y,Ut=((oe=it.arrow)===null||oe===void 0?void 0:oe.centerOffset)!==0,[bt,Ot]=reactExports.useState();$9f79659886946c16$export$e5c5a5f917a5871c(()=>{we&&Ot(window.getComputedStyle(we).zIndex)},[we]);const{hasParent:Mt,positionUpdateFns:_t}=$cf1ac5d9fe0e8206$var$usePositionContext($cf1ac5d9fe0e8206$var$CONTENT_NAME,ce),pt=!Mt;reactExports.useLayoutEffect(()=>{if(!pt)return _t.add(nt),()=>{_t.delete(nt)}},[pt,_t,nt]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{pt&&Tt&&Array.from(_t).reverse().forEach(st=>requestAnimationFrame(st))},[pt,Tt,_t]);const ft={"data-side":St,"data-align":Et,...be,ref:Ie,style:{...be.style,animation:Tt?void 0:"none",opacity:(se=it.hide)!==null&&se!==void 0&&se.referenceHidden?0:void 0}};return reactExports.createElement("div",{ref:ct,"data-radix-popper-content-wrapper":"",style:{position:ht,left:0,top:0,transform:Tt?`translate3d(${Math.round(lt)}px, ${Math.round(Qe)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:bt,"--radix-popper-transform-origin":[(ae=it.transformOrigin)===null||ae===void 0?void 0:ae.x,(le=it.transformOrigin)===null||le===void 0?void 0:le.y].join(" ")},dir:K.dir},reactExports.createElement($cf1ac5d9fe0e8206$var$PopperContentProvider,{scope:ce,placedSide:St,onArrowChange:Ue,arrowX:zt,arrowY:yt,shouldHideArrow:Ut},pt?reactExports.createElement($cf1ac5d9fe0e8206$var$PositionContextProvider,{scope:ce,hasParent:!0,positionUpdateFns:_t},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,ft)):reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,ft)))}),$cf1ac5d9fe0e8206$var$ARROW_NAME="PopperArrow",$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},$cf1ac5d9fe0e8206$export$79d62cd4e10a3fd0=reactExports.forwardRef(function(_,Z){const{__scopePopper:te,...ne}=_,ie=$cf1ac5d9fe0e8206$var$useContentContext($cf1ac5d9fe0e8206$var$ARROW_NAME,te),oe=$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE[ie.placedSide];return reactExports.createElement("span",{ref:ie.onArrowChange,style:{position:"absolute",left:ie.arrowX,top:ie.arrowY,[oe]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[ie.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[ie.placedSide],visibility:ie.shouldHideArrow?"hidden":void 0}},reactExports.createElement($7e8f5cd07187803e$export$be92b6f5f03c0fe9,_extends$3({},ne,{ref:Z,style:{...ne.style,display:"block"}})))});function $cf1ac5d9fe0e8206$var$isDefined(K){return K!==void 0}function $cf1ac5d9fe0e8206$var$isNotNull(K){return K!==null}const $cf1ac5d9fe0e8206$var$anchorCssProperties=()=>({name:"anchorCssProperties",fn(K){const{rects:_,elements:Z}=K,{width:te,height:ne}=_.reference;return Z.floating.style.setProperty("--radix-popper-anchor-width",`${te}px`),Z.floating.style.setProperty("--radix-popper-anchor-height",`${ne}px`),{}}}),$cf1ac5d9fe0e8206$var$transformOrigin=K=>({name:"transformOrigin",options:K,fn(_){var Z,te,ne,ie,oe;const{placement:se,rects:ae,middlewareData:le}=_,fe=((Z=le.arrow)===null||Z===void 0?void 0:Z.centerOffset)!==0,de=fe?0:K.arrowWidth,pe=fe?0:K.arrowHeight,[he,ge]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(se),me={start:"0%",center:"50%",end:"100%"}[ge],Ae=((te=(ne=le.arrow)===null||ne===void 0?void 0:ne.x)!==null&&te!==void 0?te:0)+de/2,ye=((ie=(oe=le.arrow)===null||oe===void 0?void 0:oe.y)!==null&&ie!==void 0?ie:0)+pe/2;let ve="",_e="";return he==="bottom"?(ve=fe?me:`${Ae}px`,_e=`${-pe}px`):he==="top"?(ve=fe?me:`${Ae}px`,_e=`${ae.floating.height+pe}px`):he==="right"?(ve=`${-pe}px`,_e=fe?me:`${ye}px`):he==="left"&&(ve=`${ae.floating.width+pe}px`,_e=fe?me:`${ye}px`),{data:{x:ve,y:_e}}}});function $cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(K){const[_,Z="center"]=K.split("-");return[_,Z]}const $cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9,$cf1ac5d9fe0e8206$export$b688253958b8dfe7=$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d,$cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2=$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc,$cf1ac5d9fe0e8206$export$21b07c8f274aebd5=$cf1ac5d9fe0e8206$export$79d62cd4e10a3fd0;function $fe963b355347cc68$export$3e6543de14f8614f(K,_){return reactExports.useReducer((Z,te)=>{const ne=_[Z][te];return ne??Z},K)}const $921a889cee6df7e8$export$99c2b779aa4e8b8b=K=>{const{present:_,children:Z}=K,te=$921a889cee6df7e8$var$usePresence(_),ne=typeof Z=="function"?Z({present:te.isPresent}):reactExports.Children.only(Z),ie=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(te.ref,ne.ref);return typeof Z=="function"||te.isPresent?reactExports.cloneElement(ne,{ref:ie}):null};$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";function $921a889cee6df7e8$var$usePresence(K){const[_,Z]=reactExports.useState(),te=reactExports.useRef({}),ne=reactExports.useRef(K),ie=reactExports.useRef("none"),oe=K?"mounted":"unmounted",[se,ae]=$fe963b355347cc68$export$3e6543de14f8614f(oe,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const le=$921a889cee6df7e8$var$getAnimationName(te.current);ie.current=se==="mounted"?le:"none"},[se]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{const le=te.current,ce=ne.current;if(ce!==K){const de=ie.current,pe=$921a889cee6df7e8$var$getAnimationName(le);K?ae("MOUNT"):pe==="none"||(le==null?void 0:le.display)==="none"?ae("UNMOUNT"):ae(ce&&de!==pe?"ANIMATION_OUT":"UNMOUNT"),ne.current=K}},[K,ae]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(_){const le=fe=>{const pe=$921a889cee6df7e8$var$getAnimationName(te.current).includes(fe.animationName);fe.target===_&&pe&&reactDomExports.flushSync(()=>ae("ANIMATION_END"))},ce=fe=>{fe.target===_&&(ie.current=$921a889cee6df7e8$var$getAnimationName(te.current))};return _.addEventListener("animationstart",ce),_.addEventListener("animationcancel",le),_.addEventListener("animationend",le),()=>{_.removeEventListener("animationstart",ce),_.removeEventListener("animationcancel",le),_.removeEventListener("animationend",le)}}else ae("ANIMATION_END")},[_,ae]),{isPresent:["mounted","unmountSuspended"].includes(se),ref:reactExports.useCallback(le=>{le&&(te.current=getComputedStyle(le)),Z(le)},[])}}function $921a889cee6df7e8$var$getAnimationName(K){return(K==null?void 0:K.animationName)||"none"}const $5e63c961fc1ce211$export$8c6ed5c666ac1360=reactExports.forwardRef((K,_)=>{const{children:Z,...te}=K,ne=reactExports.Children.toArray(Z),ie=ne.find($5e63c961fc1ce211$var$isSlottable);if(ie){const oe=ie.props.children,se=ne.map(ae=>ae===ie?reactExports.Children.count(oe)>1?reactExports.Children.only(null):reactExports.isValidElement(oe)?oe.props.children:null:ae);return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$3({},te,{ref:_}),reactExports.isValidElement(oe)?reactExports.cloneElement(oe,void 0,se):null)}return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$3({},te,{ref:_}),Z)});$5e63c961fc1ce211$export$8c6ed5c666ac1360.displayName="Slot";const $5e63c961fc1ce211$var$SlotClone=reactExports.forwardRef((K,_)=>{const{children:Z,...te}=K;return reactExports.isValidElement(Z)?reactExports.cloneElement(Z,{...$5e63c961fc1ce211$var$mergeProps(te,Z.props),ref:$6ed0406888f73fc4$export$43e446d32b3d21af(_,Z.ref)}):reactExports.Children.count(Z)>1?reactExports.Children.only(null):null});$5e63c961fc1ce211$var$SlotClone.displayName="SlotClone";const $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:K})=>reactExports.createElement(reactExports.Fragment,null,K);function $5e63c961fc1ce211$var$isSlottable(K){return reactExports.isValidElement(K)&&K.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(K,_){const Z={..._};for(const te in _){const ne=K[te],ie=_[te];/^on[A-Z]/.test(te)?ne&&ie?Z[te]=(...se)=>{ie(...se),ne(...se)}:ne&&(Z[te]=ne):te==="style"?Z[te]={...ne,...ie}:te==="className"&&(Z[te]=[ne,ie].filter(Boolean).join(" "))}return{...K,...Z}}function $71cd76cc60e0454e$export$6f32135080cb4c3({prop:K,defaultProp:_,onChange:Z=()=>{}}){const[te,ne]=$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:_,onChange:Z}),ie=K!==void 0,oe=ie?K:te,se=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Z),ae=reactExports.useCallback(le=>{if(ie){const fe=typeof le=="function"?le(K):le;fe!==K&&se(fe)}else ne(le)},[ie,K,ne,se]);return[oe,ae]}function $71cd76cc60e0454e$var$useUncontrolledState({defaultProp:K,onChange:_}){const Z=reactExports.useState(K),[te]=Z,ne=reactExports.useRef(te),ie=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(_);return reactExports.useEffect(()=>{ne.current!==te&&(ie(te),ne.current=te)},[te,ne,ie]),Z}const $ea1ef594cf570d83$export$439d29a4e110a164=reactExports.forwardRef((K,_)=>reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$3({},K,{ref:_,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...K.style}}))),$ea1ef594cf570d83$export$be92b6f5f03c0fe9=$ea1ef594cf570d83$export$439d29a4e110a164,[$a093c7e1ec25a057$var$createTooltipContext,$a093c7e1ec25a057$export$1c540a2224f0d865]=$c512c27ab02ef895$export$50c7b4e9d9f19c1("Tooltip",[$cf1ac5d9fe0e8206$export$722aac194ae923]),$a093c7e1ec25a057$var$usePopperScope=$cf1ac5d9fe0e8206$export$722aac194ae923(),$a093c7e1ec25a057$var$PROVIDER_NAME="TooltipProvider",$a093c7e1ec25a057$var$TOOLTIP_OPEN="tooltip.open",[$a093c7e1ec25a057$var$TooltipProviderContextProvider,$a093c7e1ec25a057$var$useTooltipProviderContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$PROVIDER_NAME),$a093c7e1ec25a057$var$TOOLTIP_NAME="Tooltip",[$a093c7e1ec25a057$var$TooltipContextProvider,$a093c7e1ec25a057$var$useTooltipContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$TOOLTIP_NAME),$a093c7e1ec25a057$export$28c660c63b792dea=K=>{const{__scopeTooltip:_,children:Z,open:te,defaultOpen:ne=!1,onOpenChange:ie,disableHoverableContent:oe,delayDuration:se}=K,ae=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$TOOLTIP_NAME,K.__scopeTooltip),le=$a093c7e1ec25a057$var$usePopperScope(_),[ce,fe]=reactExports.useState(null),de=$1746a345f3d73bb7$export$f680877a34711e37(),pe=reactExports.useRef(0),he=oe??ae.disableHoverableContent,ge=se??ae.delayDuration,me=reactExports.useRef(!1),[Ae=!1,ye]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:te,defaultProp:ne,onChange:Re=>{Re?(ae.onOpen(),document.dispatchEvent(new CustomEvent($a093c7e1ec25a057$var$TOOLTIP_OPEN))):ae.onClose(),ie==null||ie(Re)}}),ve=reactExports.useMemo(()=>Ae?me.current?"delayed-open":"instant-open":"closed",[Ae]),_e=reactExports.useCallback(()=>{window.clearTimeout(pe.current),me.current=!1,ye(!0)},[ye]),Te=reactExports.useCallback(()=>{window.clearTimeout(pe.current),ye(!1)},[ye]),be=reactExports.useCallback(()=>{window.clearTimeout(pe.current),pe.current=window.setTimeout(()=>{me.current=!0,ye(!0)},ge)},[ge,ye]);return reactExports.useEffect(()=>()=>window.clearTimeout(pe.current),[]),reactExports.createElement($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,le,reactExports.createElement($a093c7e1ec25a057$var$TooltipContextProvider,{scope:_,contentId:de,open:Ae,stateAttribute:ve,trigger:ce,onTriggerChange:fe,onTriggerEnter:reactExports.useCallback(()=>{ae.isOpenDelayed?be():_e()},[ae.isOpenDelayed,be,_e]),onTriggerLeave:reactExports.useCallback(()=>{he?Te():window.clearTimeout(pe.current)},[Te,he]),onOpen:_e,onClose:Te,disableHoverableContent:he},Z))},$a093c7e1ec25a057$var$TRIGGER_NAME="TooltipTrigger",$a093c7e1ec25a057$export$8c610744efcf8a1d=reactExports.forwardRef((K,_)=>{const{__scopeTooltip:Z,...te}=K,ne=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$TRIGGER_NAME,Z),ie=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$TRIGGER_NAME,Z),oe=$a093c7e1ec25a057$var$usePopperScope(Z),se=reactExports.useRef(null),ae=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,se,ne.onTriggerChange),le=reactExports.useRef(!1),ce=reactExports.useRef(!1),fe=reactExports.useCallback(()=>le.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",fe),[fe]),reactExports.createElement($cf1ac5d9fe0e8206$export$b688253958b8dfe7,_extends$3({asChild:!0},oe),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$3({"aria-describedby":ne.open?ne.contentId:void 0,"data-state":ne.stateAttribute},te,{ref:ae,onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onPointerMove,de=>{de.pointerType!=="touch"&&!ce.current&&!ie.isPointerInTransitRef.current&&(ne.onTriggerEnter(),ce.current=!0)}),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onPointerLeave,()=>{ne.onTriggerLeave(),ce.current=!1}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onPointerDown,()=>{le.current=!0,document.addEventListener("pointerup",fe,{once:!0})}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onFocus,()=>{le.current||ne.onOpen()}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onBlur,ne.onClose),onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(K.onClick,ne.onClose)})))}),$a093c7e1ec25a057$var$PORTAL_NAME="TooltipPortal",[$a093c7e1ec25a057$var$PortalProvider,$a093c7e1ec25a057$var$usePortalContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$PORTAL_NAME,{forceMount:void 0}),$a093c7e1ec25a057$var$CONTENT_NAME="TooltipContent",$a093c7e1ec25a057$export$e9003e2be37ec060=reactExports.forwardRef((K,_)=>{const Z=$a093c7e1ec25a057$var$usePortalContext($a093c7e1ec25a057$var$CONTENT_NAME,K.__scopeTooltip),{forceMount:te=Z.forceMount,side:ne="top",...ie}=K,oe=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,K.__scopeTooltip);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:te||oe.open},oe.disableHoverableContent?reactExports.createElement($a093c7e1ec25a057$var$TooltipContentImpl,_extends$3({side:ne},ie,{ref:_})):reactExports.createElement($a093c7e1ec25a057$var$TooltipContentHoverable,_extends$3({side:ne},ie,{ref:_})))}),$a093c7e1ec25a057$var$TooltipContentHoverable=reactExports.forwardRef((K,_)=>{const Z=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,K.__scopeTooltip),te=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$CONTENT_NAME,K.__scopeTooltip),ne=reactExports.useRef(null),ie=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,ne),[oe,se]=reactExports.useState(null),{trigger:ae,onClose:le}=Z,ce=ne.current,{onPointerInTransitChange:fe}=te,de=reactExports.useCallback(()=>{se(null),fe(!1)},[fe]),pe=reactExports.useCallback((he,ge)=>{const me=he.currentTarget,Ae={x:he.clientX,y:he.clientY},ye=$a093c7e1ec25a057$var$getExitSideFromRect(Ae,me.getBoundingClientRect()),ve=ye==="right"||ye==="bottom"?-5:5,Te=ye==="right"||ye==="left"?{x:he.clientX+ve,y:he.clientY}:{x:he.clientX,y:he.clientY+ve},be=$a093c7e1ec25a057$var$getPointsFromRect(ge.getBoundingClientRect()),Re=$a093c7e1ec25a057$var$getHull([Te,...be]);se(Re),fe(!0)},[fe]);return reactExports.useEffect(()=>()=>de(),[de]),reactExports.useEffect(()=>{if(ae&&ce){const he=me=>pe(me,ce),ge=me=>pe(me,ae);return ae.addEventListener("pointerleave",he),ce.addEventListener("pointerleave",ge),()=>{ae.removeEventListener("pointerleave",he),ce.removeEventListener("pointerleave",ge)}}},[ae,ce,pe,de]),reactExports.useEffect(()=>{if(oe){const he=ge=>{const me=ge.target,Ae={x:ge.clientX,y:ge.clientY},ye=(ae==null?void 0:ae.contains(me))||(ce==null?void 0:ce.contains(me)),ve=!$a093c7e1ec25a057$var$isPointInPolygon(Ae,oe);ye?de():ve&&(de(),le())};return document.addEventListener("pointermove",he),()=>document.removeEventListener("pointermove",he)}},[ae,ce,oe,le,de]),reactExports.createElement($a093c7e1ec25a057$var$TooltipContentImpl,_extends$3({},K,{ref:ie}))}),[$a093c7e1ec25a057$var$VisuallyHiddenContentContextProvider,$a093c7e1ec25a057$var$useVisuallyHiddenContentContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$TOOLTIP_NAME,{isInside:!1}),$a093c7e1ec25a057$var$TooltipContentImpl=reactExports.forwardRef((K,_)=>{const{__scopeTooltip:Z,children:te,"aria-label":ne,onEscapeKeyDown:ie,onPointerDownOutside:oe,...se}=K,ae=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,Z),le=$a093c7e1ec25a057$var$usePopperScope(Z),{onClose:ce}=ae;return reactExports.useEffect(()=>(document.addEventListener($a093c7e1ec25a057$var$TOOLTIP_OPEN,ce),()=>document.removeEventListener($a093c7e1ec25a057$var$TOOLTIP_OPEN,ce)),[ce]),reactExports.useEffect(()=>{if(ae.trigger){const fe=de=>{const pe=de.target;pe!=null&&pe.contains(ae.trigger)&&ce()};return window.addEventListener("scroll",fe,{capture:!0}),()=>window.removeEventListener("scroll",fe,{capture:!0})}},[ae.trigger,ce]),reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:ie,onPointerDownOutside:oe,onFocusOutside:fe=>fe.preventDefault(),onDismiss:ce},reactExports.createElement($cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2,_extends$3({"data-state":ae.stateAttribute},le,se,{ref:_,style:{...se.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),reactExports.createElement($5e63c961fc1ce211$export$d9f1ccf0bdb05d45,null,te),reactExports.createElement($a093c7e1ec25a057$var$VisuallyHiddenContentContextProvider,{scope:Z,isInside:!0},reactExports.createElement($ea1ef594cf570d83$export$be92b6f5f03c0fe9,{id:ae.contentId,role:"tooltip"},ne||te))))}),$a093c7e1ec25a057$var$ARROW_NAME="TooltipArrow",$a093c7e1ec25a057$export$c27ee0ad710f7559=reactExports.forwardRef((K,_)=>{const{__scopeTooltip:Z,...te}=K,ne=$a093c7e1ec25a057$var$usePopperScope(Z);return $a093c7e1ec25a057$var$useVisuallyHiddenContentContext($a093c7e1ec25a057$var$ARROW_NAME,Z).isInside?null:reactExports.createElement($cf1ac5d9fe0e8206$export$21b07c8f274aebd5,_extends$3({},ne,te,{ref:_}))});function $a093c7e1ec25a057$var$getExitSideFromRect(K,_){const Z=Math.abs(_.top-K.y),te=Math.abs(_.bottom-K.y),ne=Math.abs(_.right-K.x),ie=Math.abs(_.left-K.x);switch(Math.min(Z,te,ne,ie)){case ie:return"left";case ne:return"right";case Z:return"top";case te:return"bottom";default:return null}}function $a093c7e1ec25a057$var$getPointsFromRect(K){const{top:_,right:Z,bottom:te,left:ne}=K;return[{x:ne,y:_},{x:Z,y:_},{x:Z,y:te},{x:ne,y:te}]}function $a093c7e1ec25a057$var$isPointInPolygon(K,_){const{x:Z,y:te}=K;let ne=!1;for(let ie=0,oe=_.length-1;ie<_.length;oe=ie++){const se=_[ie].x,ae=_[ie].y,le=_[oe].x,ce=_[oe].y;ae>te!=ce>te&&Z<(le-se)*(te-ae)/(ce-ae)+se&&(ne=!ne)}return ne}function $a093c7e1ec25a057$var$getHull(K){const _=K.slice();return _.sort((Z,te)=>Z.x<te.x?-1:Z.x>te.x?1:Z.y<te.y?-1:Z.y>te.y?1:0),$a093c7e1ec25a057$var$getHullPresorted(_)}function $a093c7e1ec25a057$var$getHullPresorted(K){if(K.length<=1)return K.slice();const _=[];for(let te=0;te<K.length;te++){const ne=K[te];for(;_.length>=2;){const ie=_[_.length-1],oe=_[_.length-2];if((ie.x-oe.x)*(ne.y-oe.y)>=(ie.y-oe.y)*(ne.x-oe.x))_.pop();else break}_.push(ne)}_.pop();const Z=[];for(let te=K.length-1;te>=0;te--){const ne=K[te];for(;Z.length>=2;){const ie=Z[Z.length-1],oe=Z[Z.length-2];if((ie.x-oe.x)*(ne.y-oe.y)>=(ie.y-oe.y)*(ne.x-oe.x))Z.pop();else break}Z.push(ne)}return Z.pop(),_.length===1&&Z.length===1&&_[0].x===Z[0].x&&_[0].y===Z[0].y?_:_.concat(Z)}const $a093c7e1ec25a057$export$be92b6f5f03c0fe9=$a093c7e1ec25a057$export$28c660c63b792dea,$a093c7e1ec25a057$export$41fb9f06171c75f4=$a093c7e1ec25a057$export$8c610744efcf8a1d,$a093c7e1ec25a057$export$7c6e2c02157bb7d2=$a093c7e1ec25a057$export$e9003e2be37ec060,$a093c7e1ec25a057$export$21b07c8f274aebd5=$a093c7e1ec25a057$export$c27ee0ad710f7559;function _objectWithoutPropertiesLoose$2(K,_){if(K==null)return{};var Z={},te=Object.keys(K),ne,ie;for(ie=0;ie<te.length;ie++)ne=te[ie],!(_.indexOf(ne)>=0)&&(Z[ne]=K[ne]);return Z}function _objectWithoutProperties$1(K,_){if(K==null)return{};var Z=_objectWithoutPropertiesLoose$2(K,_),te,ne;if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(K);for(ne=0;ne<ie.length;ne++)te=ie[ne],!(_.indexOf(te)>=0)&&Object.prototype.propertyIsEnumerable.call(K,te)&&(Z[te]=K[te])}return Z}let LevaErrors;(function(K){K[K.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",K[K.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",K[K.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",K[K.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",K[K.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",K[K.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",K[K.THEME_ERROR=6]="THEME_ERROR",K[K.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",K[K.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",K[K.EMPTY_KEY=9]="EMPTY_KEY"})(LevaErrors||(LevaErrors={}));const ErrorList={[LevaErrors.UNSUPPORTED_INPUT]:(K,_)=>[`An input with type \`${K}\` input was found at path \`${_}\` but it's not supported yet.`],[LevaErrors.NO_COMPONENT_FOR_TYPE]:(K,_)=>[`Type \`${K}\` found at path \`${_}\` can't be displayed in panel because no component supports it yet.`],[LevaErrors.UNKNOWN_INPUT]:(K,_)=>[`input at path \`${K}\` is not recognized.`,_],[LevaErrors.DUPLICATE_KEYS]:(K,_,Z)=>[`Key \`${K}\` of path \`${_}\` already exists at path \`${Z}\`. Even nested keys need to be unique. Rename one of the keys.`],[LevaErrors.ALREADY_REGISTERED_TYPE]:K=>[`Type ${K} has already been registered. You can't register a component with the same type.`],[LevaErrors.CLIPBOARD_ERROR]:K=>["Error copying the value",K],[LevaErrors.THEME_ERROR]:(K,_)=>[`Error accessing the theme \`${K}.${_}\` value.`],[LevaErrors.PATH_DOESNT_EXIST]:K=>[`Error getting the value at path \`${K}\`. There is probably an error in your \`render\` function.`],[LevaErrors.PATH_DOESNT_EXIST]:K=>[`Error accessing the value at path \`${K}\``],[LevaErrors.INPUT_TYPE_OVERRIDE]:(K,_,Z)=>[`Input at path \`${K}\` already exists with type: \`${_}\`. Its type cannot be overridden with type \`${Z}\`.`],[LevaErrors.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function _log(K,_,...Z){const[te,...ne]=ErrorList[_](...Z);console[K]("LEVA: "+te,...ne)}const warn=_log.bind(null,"warn"),log=_log.bind(null,"log"),_excluded$a=["value"],_excluded2$4=["schema"],_excluded3$1=["value"],Schemas=[],Plugins={};function getValueType(K){let{value:_}=K,Z=_objectWithoutProperties$1(K,_excluded$a);for(let te of Schemas){const ne=te(_,Z);if(ne)return ne}}function register(K,_){let{schema:Z}=_,te=_objectWithoutProperties$1(_,_excluded2$4);if(K in Plugins){warn(LevaErrors.ALREADY_REGISTERED_TYPE,K);return}Schemas.push((ne,ie)=>Z(ne,ie)&&K),Plugins[K]=te}function createInternalPlugin(K){return K}function normalize$3$2(K,_,Z,te){const{normalize:ne}=Plugins[K];if(ne)return ne(_,Z,te);if(typeof _!="object"||!("value"in _))return{value:_};const{value:ie}=_,oe=_objectWithoutProperties$1(_,_excluded3$1);return{value:ie,settings:oe}}function sanitize$4(K,_,Z,te,ne,ie){const{sanitize:oe}=Plugins[K];return oe?oe(_,Z,te,ne,ie):_}function format$2(K,_,Z){const{format:te}=Plugins[K];return te?te(_,Z):_}function _defineProperty$2(K,_,Z){return _ in K?Object.defineProperty(K,_,{value:Z,enumerable:!0,configurable:!0,writable:!0}):K[_]=Z,K}function ownKeys$2(K,_){var Z=Object.keys(K);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(K);_&&(te=te.filter(function(ne){return Object.getOwnPropertyDescriptor(K,ne).enumerable})),Z.push.apply(Z,te)}return Z}function _objectSpread2(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_]!=null?arguments[_]:{};_%2?ownKeys$2(Object(Z),!0).forEach(function(te){_defineProperty$2(K,te,Z[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(Z)):ownKeys$2(Object(Z)).forEach(function(te){Object.defineProperty(K,te,Object.getOwnPropertyDescriptor(Z,te))})}return K}const clamp$2=(K,_,Z)=>K>Z?Z:K<_?_:K,parseNumber=K=>{if(K===""||typeof K=="number")return K;try{const _=evaluate(K);if(!isNaN(_))return _}catch{}return parseFloat(K)},log10=Math.log(10);function getStep(K){let _=Math.abs(+String(K).replace(".",""));if(_===0)return .01;for(;_!==0&&_%10===0;)_/=10;const Z=Math.floor(Math.log(_)/log10)+1,te=Math.floor(Math.log10(Math.abs(K))),ne=Math.pow(10,te-Z);return Math.max(ne,.001)}const range=(K,_,Z)=>Z===_?0:(clamp$2(K,_,Z)-_)/(Z-_),invertedRange=(K,_,Z)=>K*(Z-_)+_,getUid=()=>"_"+Math.random().toString(36).substr(2,9),parens=/\(([0-9+\-*/^ .]+)\)/,exp=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,mul=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,div=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,add=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,sub=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function evaluate(K){if(isNaN(Number(K)))if(parens.test(K)){const _=K.replace(parens,(Z,te)=>String(evaluate(te)));return evaluate(_)}else if(exp.test(K)){const _=K.replace(exp,(Z,te,ne)=>String(Math.pow(Number(te),Number(ne))));return evaluate(_)}else if(mul.test(K)){const _=K.replace(mul,(Z,te,ne)=>String(Number(te)*Number(ne)));return evaluate(_)}else if(div.test(K)){const _=K.replace(div,(Z,te,ne)=>{if(ne!=0)return String(Number(te)/Number(ne));throw new Error("Division by zero")});return evaluate(_)}else if(add.test(K)){const _=K.replace(add,(Z,te,ne)=>String(Number(te)+Number(ne)));return evaluate(_)}else if(sub.test(K)){const _=K.replace(sub,(Z,te,ne)=>String(Number(te)-Number(ne)));return evaluate(_)}else return Number(K);return Number(K)}function pick$1(K,_){return _.reduce((Z,te)=>(K&&K.hasOwnProperty(te)&&(Z[te]=K[te]),Z),{})}function omit(K,_){const Z=_objectSpread2({},K);return _.forEach(te=>te in K&&delete Z[te]),Z}function mapArrayToKeys(K,_){return K.reduce((Z,te,ne)=>Object.assign(Z,{[_[ne]]:te}),{})}function isObject$b(K){return Object.prototype.toString.call(K)==="[object Object]"}const isEmptyObject=K=>isObject$b(K)&&Object.keys(K).length===0;let SpecialInputs;(function(K){K.BUTTON="BUTTON",K.BUTTON_GROUP="BUTTON_GROUP",K.MONITOR="MONITOR",K.FOLDER="FOLDER"})(SpecialInputs||(SpecialInputs={}));let LevaInputs;(function(K){K.SELECT="SELECT",K.IMAGE="IMAGE",K.NUMBER="NUMBER",K.COLOR="COLOR",K.STRING="STRING",K.BOOLEAN="BOOLEAN",K.INTERVAL="INTERVAL",K.VECTOR3D="VECTOR3D",K.VECTOR2D="VECTOR2D"})(LevaInputs||(LevaInputs={}));const _excluded$9$1=["type","__customInput"],_excluded2$3=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],_excluded3$2=["type"];function parseOptions$1(K,_,Z={},te){var ne,ie;if(typeof K!="object"||Array.isArray(K))return{type:te,input:K,options:_objectSpread2({key:_,label:_,optional:!1,disabled:!1,order:0},Z)};if("__customInput"in K){const{type:Te,__customInput:be}=K,Re=_objectWithoutProperties$1(K,_excluded$9$1);return parseOptions$1(be,_,Re,Te)}const{render:oe,label:se,optional:ae,order:le=0,disabled:ce,hint:fe,onChange:de,onEditStart:pe,onEditEnd:he,transient:ge}=K,me=_objectWithoutProperties$1(K,_excluded2$3),Ae=_objectSpread2({render:oe,key:_,label:se??_,hint:fe,transient:ge??!!de,onEditStart:pe,onEditEnd:he,disabled:ce,optional:ae,order:le},Z);let{type:ye}=me,ve=_objectWithoutProperties$1(me,_excluded3$2);if(ye=te??ye,ye in SpecialInputs)return{type:ye,input:ve,options:Ae};let _e;return te&&isObject$b(ve)&&"value"in ve?_e=ve.value:_e=isEmptyObject(ve)?void 0:ve,{type:ye,input:_e,options:_objectSpread2(_objectSpread2({},Ae),{},{onChange:de,optional:(ne=Ae.optional)!==null&&ne!==void 0?ne:!1,disabled:(ie=Ae.disabled)!==null&&ie!==void 0?ie:!1})}}function normalizeInput(K,_,Z,te){const ne=parseOptions$1(K,_),{type:ie,input:oe,options:se}=ne;if(ie)return ie in SpecialInputs?ne:{type:ie,input:normalize$3$2(ie,oe,Z,te),options:se};let ae=getValueType(oe);return ae?{type:ae,input:normalize$3$2(ae,oe,Z,te),options:se}:(ae=getValueType({value:oe}),ae?{type:ae,input:normalize$3$2(ae,{value:oe},Z,te),options:se}:!1)}function updateInput(K,_,Z,te,ne){const{value:ie,type:oe,settings:se}=K;K.value=sanitizeValue({type:oe,value:ie,settings:se},_,Z,te),K.fromPanel=ne}const ValueError=function(_,Z,te){this.type="LEVA_ERROR",this.message="LEVA: "+_,this.previousValue=Z,this.error=te};function sanitizeValue({type:K,value:_,settings:Z},te,ne,ie){const oe=K!=="SELECT"&&typeof te=="function"?te(_):te;let se;try{se=sanitize$4(K,oe,Z,_,ne,ie)}catch(ae){throw new ValueError(`The value \`${te}\` did not result in a correct value.`,_,ae)}return dequal(se,_)?_:se}const debounce=(K,_,Z=!1)=>{let te=0;return function(){const ne=arguments,ie=Z&&!te,oe=()=>K.apply(this,ne);window.clearTimeout(te),te=window.setTimeout(oe,_),ie&&oe()}},multiplyStep=K=>K.shiftKey?5:K.altKey?1/5:1,_excluded$8$1=["value"],_excluded2$2$1=["min","max"],schema$3$1=K=>{if(typeof K=="number")return!0;if(typeof K=="string"){const _=parseFloat(K);return isNaN(_)?!1:K.substring((""+_).length).trim().length<4}return!1},sanitize$3=(K,{min:_=-1/0,max:Z=1/0,suffix:te})=>{const ne=parseFloat(K);if(K===""||isNaN(ne))throw Error("Invalid number");const ie=clamp$2(ne,_,Z);return te?ie+te:ie},format$1$1=(K,{pad:_=0,suffix:Z})=>{const te=parseFloat(K).toFixed(_);return Z?te+Z:te},normalize$2$2=K=>{let{value:_}=K,Z=_objectWithoutProperties$1(K,_excluded$8$1);const{min:te=-1/0,max:ne=1/0}=Z,ie=_objectWithoutProperties$1(Z,_excluded2$2$1);let oe=parseFloat(_);const se=typeof _=="string"?_.substring((""+oe).length):void 0;oe=clamp$2(oe,te,ne);let ae=Z.step;ae||(Number.isFinite(te)?Number.isFinite(ne)?ae=+(Math.abs(ne-te)/100).toPrecision(1):ae=+(Math.abs(oe-te)/100).toPrecision(1):Number.isFinite(ne)&&(ae=+(Math.abs(ne-oe)/100).toPrecision(1)));const le=ae?getStep(ae)*10:getStep(oe);ae=ae||le/10;const ce=Math.round(clamp$2(Math.log10(1/le),0,2));return{value:se?oe+se:oe,settings:_objectSpread2({initialValue:oe,step:ae,pad:ce,min:te,max:ne,suffix:se},ie)}},sanitizeStep$1=(K,{step:_,initialValue:Z})=>{const te=Math.round((K-Z)/_);return Z+te*_};var props$3=Object.freeze({__proto__:null,schema:schema$3$1,sanitize:sanitize$3,format:format$1$1,normalize:normalize$2$2,sanitizeStep:sanitizeStep$1});function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_];for(var te in Z)Object.prototype.hasOwnProperty.call(Z,te)&&(K[te]=Z[te])}return K},_extends$2.apply(this,arguments)}const InputContext=reactExports.createContext({});function useInputContext(){return reactExports.useContext(InputContext)}const ThemeContext=reactExports.createContext(null),StoreContext=reactExports.createContext(null),PanelSettingsContext=reactExports.createContext(null);function useStoreContext(){return reactExports.useContext(StoreContext)}function usePanelSettingsContext(){return reactExports.useContext(PanelSettingsContext)}function LevaStoreProvider({children:K,store:_}){return React.createElement(StoreContext.Provider,{value:_},K)}const getDefaultTheme=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function createStateClass(K,_){const[Z,te]=K.split(" "),ne={};return Z!=="none"&&(ne.boxShadow=`${_.inset?"inset ":""}0 0 0 $borderWidths${[_.key]} $colors${Z!=="default"&&Z||_.borderColor}`),te&&(ne.backgroundColor=te),ne}const utils$5={$inputStyle:()=>K=>createStateClass(K,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>K=>createStateClass(K,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>K=>createStateClass(K,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>K=>createStateClass(K,{key:"$active",borderColor:"$accent1",inset:!0})},{styled,css,createTheme,globalCss,keyframes}=q$1({prefix:"leva",theme:getDefaultTheme(),utils:_objectSpread2(_objectSpread2({},utils$5),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:K=>({"&:focus":utils$5.$focusStyle()(K)}),$focusWithin:K=>({"&:focus-within":utils$5.$focusStyle()(K)}),$hover:K=>({"&:hover":utils$5.$hoverStyle()(K)}),$active:K=>({"&:active":utils$5.$activeStyle()(K)})})}),globalStyles=globalCss({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function mergeTheme(K){const _=getDefaultTheme();if(!K)return{theme:_,className:""};Object.keys(K).forEach(te=>{Object.assign(_[te],K[te])});const Z=createTheme(_);return{theme:_,className:Z.className}}function useTh(K,_){const{theme:Z}=reactExports.useContext(ThemeContext);if(!(K in Z)||!(_ in Z[K]))return warn(LevaErrors.THEME_ERROR,K,_),"";let te=_;for(;;){let ne=Z[K][te];if(typeof ne=="string"&&ne.charAt(0)==="$")te=ne.substr(1);else return ne}}const StyledInput=styled("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),InnerLabel=styled("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${StyledInput}`]:{paddingLeft:0}}),InnerNumberLabel=styled(InnerLabel,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),InputContainer=styled("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),_excluded$7$1=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],_excluded2$1$1=["onUpdate"];function ValueInput(K){let{innerLabel:_,value:Z,onUpdate:te,onChange:ne,onKeyDown:ie,type:oe,id:se,inputType:ae="text",rows:le=0}=K,ce=_objectWithoutProperties$1(K,_excluded$7$1);const{id:fe,emitOnEditStart:de,emitOnEditEnd:pe,disabled:he}=useInputContext(),ge=se||fe,me=reactExports.useRef(null),Ae=le>0,ye=Ae?"textarea":"input",ve=reactExports.useCallback(be=>Re=>{const we=Re.currentTarget.value;be(we)},[]);React.useEffect(()=>{const be=me.current,Re=ve(we=>{te(we),pe()});return be==null||be.addEventListener("blur",Re),()=>be==null?void 0:be.removeEventListener("blur",Re)},[ve,te,pe]);const _e=reactExports.useCallback(be=>{be.key==="Enter"&&ve(te)(be)},[ve,te]),Te=Object.assign({as:ye},Ae?{rows:le}:{},ce);return React.createElement(InputContainer,{textArea:Ae},_&&typeof _=="string"?React.createElement(InnerLabel,null,_):_,React.createElement(StyledInput,_extends$2({levaType:oe,ref:me,id:ge,type:ae,autoComplete:"off",spellCheck:"false",value:Z,onChange:ve(ne),onFocus:()=>de(),onKeyPress:_e,onKeyDown:ie,disabled:he},Te)))}function NumberInput(K){let{onUpdate:_}=K,Z=_objectWithoutProperties$1(K,_excluded2$1$1);const te=reactExports.useCallback(ie=>_(parseNumber(ie)),[_]),ne=reactExports.useCallback(ie=>{const oe=ie.key==="ArrowUp"?1:ie.key==="ArrowDown"?-1:0;if(oe){ie.preventDefault();const se=ie.altKey?.1:ie.shiftKey?10:1;_(ae=>parseFloat(ae)+oe*se)}},[_]);return React.createElement(ValueInput,_extends$2({},Z,{onUpdate:te,onKeyDown:ne,type:"number"}))}const StyledFolder=styled("div",{}),StyledWrapper=styled("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),StyledTitle=styled("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & > svg`]:{opacity:1}}),StyledContent=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${StyledFolder}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),StyledRow=styled("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${StyledContent} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),StyledInputRow=styled(StyledRow,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),CopyLabelContainer=styled("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),StyledOptionalToggle=styled("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),StyledLabel=styled("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),StyledInputWrapper$1=styled("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${StyledLabel}`]:{pointerEvents:"auto"}}}}}),Overlay=styled("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),StyledToolTipContent=styled("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),ToolTipArrow=styled($a093c7e1ec25a057$export$21b07c8f274aebd5,{fill:"$toolTipBackground"});function Portal({children:K}){const{className:_}=reactExports.useContext(ThemeContext);return React.createElement($f1701beae083dbae$export$be92b6f5f03c0fe9,{className:_},K)}const _excluded$6$1=["align"];function OptionalToggle(){const{id:K,disable:_,disabled:Z}=useInputContext();return React.createElement(React.Fragment,null,React.createElement(StyledOptionalToggle,{id:K+"__disable",type:"checkbox",checked:!Z,onChange:()=>_(!Z)}),React.createElement("label",{htmlFor:K+"__disable"}))}function RawLabel(K){const{id:_,optional:Z,hint:te}=useInputContext(),ne=K.htmlFor||(_?{htmlFor:_}:null),ie=!te&&typeof K.children=="string"?{title:K.children}:null;return React.createElement(React.Fragment,null,Z&&React.createElement(OptionalToggle,null),te!==void 0?React.createElement($a093c7e1ec25a057$export$be92b6f5f03c0fe9,null,React.createElement($a093c7e1ec25a057$export$41fb9f06171c75f4,{asChild:!0},React.createElement(StyledLabel,_extends$2({},ne,K))),React.createElement($a093c7e1ec25a057$export$7c6e2c02157bb7d2,{side:"top",sideOffset:2},React.createElement(StyledToolTipContent,null,te,React.createElement(ToolTipArrow,null)))):React.createElement(StyledLabel,_extends$2({},ne,ie,K)))}function Label(K){let{align:_}=K,Z=_objectWithoutProperties$1(K,_excluded$6$1);const{value:te,label:ne,key:ie,disabled:oe}=useInputContext(),{hideCopyButton:se}=usePanelSettingsContext(),ae=!se&&ie!==void 0,[le,ce]=reactExports.useState(!1),fe=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[ie]:te??""})),ce(!0)}catch{warn(LevaErrors.CLIPBOARD_ERROR,{[ie]:te})}};return React.createElement(CopyLabelContainer,{align:_,onPointerLeave:()=>ce(!1)},React.createElement(RawLabel,Z),ae&&!oe&&React.createElement("div",{title:`Click to copy ${typeof ne=="string"?ne:ie} value`},le?React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),React.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):React.createElement("svg",{onClick:fe,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),React.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const _excluded$5$1=["toggled"],Svg=styled("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function Chevron(K){let{toggled:_}=K,Z=_objectWithoutProperties$1(K,_excluded$5$1);return React.createElement(Svg,_extends$2({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${_?0:-90}deg)`}},Z),React.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const _excluded$4$1=["input"];function Row(K){let{input:_}=K,Z=_objectWithoutProperties$1(K,_excluded$4$1);return _?React.createElement(StyledInputRow,Z):React.createElement(StyledRow,Z)}function useInputSetters({value:K,type:_,settings:Z,setValue:te}){const[ne,ie]=reactExports.useState(format$2(_,K,Z)),oe=reactExports.useRef(K),se=reactExports.useRef(Z);se.current=Z;const ae=reactExports.useCallback(ce=>ie(format$2(_,ce,se.current)),[_]),le=reactExports.useCallback(ce=>{try{te(ce)}catch(fe){const{type:de,previousValue:pe}=fe;if(de!=="LEVA_ERROR")throw fe;ae(pe)}},[ae,te]);return reactExports.useEffect(()=>{dequal(K,oe.current)||ae(K),oe.current=K},[K,ae]),{displayValue:ne,onChange:ie,onUpdate:le}}function useDrag(K,_){const{emitOnEditStart:Z,emitOnEditEnd:te}=useInputContext();return useDrag$1(ne=>{ne.first&&(document.body.classList.add("leva__panel__dragged"),Z==null||Z());const ie=K(ne);return ne.last&&(document.body.classList.remove("leva__panel__dragged"),te==null||te()),ie},_)}function useCanvas2d(K){const _=reactExports.useRef(null),Z=reactExports.useRef(null),te=reactExports.useRef(!1);return reactExports.useEffect(()=>{const ne=debounce(()=>{_.current.width=_.current.offsetWidth*window.devicePixelRatio,_.current.height=_.current.offsetHeight*window.devicePixelRatio,K(_.current,Z.current)},250);return window.addEventListener("resize",ne),te.current||(ne(),te.current=!0),()=>window.removeEventListener("resize",ne)},[K]),reactExports.useEffect(()=>{Z.current=_.current.getContext("2d")},[]),[_,Z]}function useTransform(){const K=reactExports.useRef(null),_=reactExports.useRef({x:0,y:0}),Z=reactExports.useCallback(te=>{Object.assign(_.current,te),K.current&&(K.current.style.transform=`translate3d(${_.current.x}px, ${_.current.y}px, 0)`)},[]);return[K,Z]}const _excluded$3$1=["__refCount"],getInputAtPath=(K,_)=>{if(!K[_])return null;const Z=K[_];return _objectWithoutProperties$1(Z,_excluded$3$1)};function useInput(K){const _=useStoreContext(),[Z,te]=reactExports.useState(getInputAtPath(_.getData(),K)),ne=reactExports.useCallback(le=>_.setValueAtPath(K,le,!0),[K,_]),ie=reactExports.useCallback(le=>_.setSettingsAtPath(K,le),[K,_]),oe=reactExports.useCallback(le=>_.disableInputAtPath(K,le),[K,_]),se=reactExports.useCallback(()=>_.emitOnEditStart(K),[K,_]),ae=reactExports.useCallback(()=>_.emitOnEditEnd(K),[K,_]);return reactExports.useEffect(()=>{te(getInputAtPath(_.getData(),K));const le=_.useStore.subscribe(ce=>getInputAtPath(ce.data,K),te,{equalityFn:shallow$8});return()=>le()},[_,K]),[Z,{set:ne,setSettings:ie,disable:oe,storeId:_.storeId,emitOnEditStart:se,emitOnEditEnd:ae}]}const RangeGrid=styled("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Range$1=styled("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),Scrubber=styled("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),RangeWrapper=styled("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Indicator=styled("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function RangeSlider({value:K,min:_,max:Z,onDrag:te,step:ne,initialValue:ie}){const oe=reactExports.useRef(null),se=reactExports.useRef(null),ae=reactExports.useRef(0),le=useTh("sizes","scrubberWidth"),ce=useDrag(({event:de,first:pe,xy:[he],movement:[ge],memo:me})=>{if(pe){const{width:ye,left:ve}=oe.current.getBoundingClientRect();ae.current=ye-parseFloat(le),me=(de==null?void 0:de.target)===se.current?K:invertedRange((he-ve)/ye,_,Z)}const Ae=me+invertedRange(ge/ae.current,0,Z-_);return te(sanitizeStep$1(Ae,{step:ne,initialValue:ie})),me}),fe=range(K,_,Z);return React.createElement(RangeWrapper,_extends$2({ref:oe},ce()),React.createElement(Range$1,null,React.createElement(Indicator,{style:{left:0,right:`${(1-fe)*100}%`}})),React.createElement(Scrubber,{ref:se,style:{left:`calc(${fe} * (100% - ${le}))`}}))}const DraggableLabel=React.memo(({label:K,onUpdate:_,step:Z,innerLabelTrim:te})=>{const[ne,ie]=reactExports.useState(!1),oe=useDrag(({active:se,delta:[ae],event:le,memo:ce=0,first:fe,last:de,target:pe})=>(fe&&pe.requestPointerLock(),de&&document.exitPointerLock(),ie(se),ce+=ae/2,Math.abs(ce)>=1&&(_(he=>parseFloat(he)+Math.floor(ce)*Z*multiplyStep(le)),ce=0),ce));return React.createElement(InnerNumberLabel,_extends$2({dragging:ne,title:K.length>1?K:""},oe()),K.slice(0,te))});function Number$1({label:K,id:_,displayValue:Z,onUpdate:te,onChange:ne,settings:ie,innerLabelTrim:oe=1}){const se=oe>0&&React.createElement(DraggableLabel,{label:K,step:ie.step,onUpdate:te,innerLabelTrim:oe});return React.createElement(NumberInput,{id:_,value:String(Z),onUpdate:te,onChange:ne,innerLabel:se})}function NumberComponent(){const K=useInputContext(),{label:_,value:Z,onUpdate:te,settings:ne,id:ie}=K,{min:oe,max:se}=ne,ae=se!==1/0&&oe!==-1/0;return React.createElement(Row,{input:!0},React.createElement(Label,null,_),React.createElement(RangeGrid,{hasRange:ae},ae&&React.createElement(RangeSlider,_extends$2({value:parseFloat(Z),onDrag:te},ne)),React.createElement(Number$1,_extends$2({},K,{id:ie,label:"value",innerLabelTrim:ae?0:1}))))}const{sanitizeStep}=props$3,rest=_objectWithoutProperties$1(props$3,["sanitizeStep"]);var number$6=_objectSpread2({component:NumberComponent},rest);const schema$2$1=(K,_)=>v8n().schema({options:v8n().passesAnyOf(v8n().object(),v8n().array())}).test(_),sanitize$2$1=(K,{values:_})=>{if(_.indexOf(K)<0)throw Error("Selected value doesn't match Select options");return K},format$3=(K,{values:_})=>_.indexOf(K),normalize$1$2=K=>{let{value:_,options:Z}=K,te,ne;return Array.isArray(Z)?(ne=Z,te=Z.map(ie=>String(ie))):(ne=Object.values(Z),te=Object.keys(Z)),"value"in K?ne.includes(_)||(te.unshift(String(_)),ne.unshift(_)):_=ne[0],Object.values(Z).includes(_)||(Z[String(_)]=_),{value:_,settings:{keys:te,values:ne}}};var props$2$1=Object.freeze({__proto__:null,schema:schema$2$1,sanitize:sanitize$2$1,format:format$3,normalize:normalize$1$2});const SelectContainer=styled("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),NativeSelect=styled("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),PresentationalSelect=styled("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${NativeSelect}:focus + &`]:{$focusStyle:""},[`${NativeSelect}:hover + &`]:{$hoverStyle:""}});function Select$1({displayValue:K,value:_,onUpdate:Z,id:te,settings:ne,disabled:ie}){const{keys:oe,values:se}=ne,ae=reactExports.useRef();return _===se[K]&&(ae.current=oe[K]),React.createElement(SelectContainer,null,React.createElement(NativeSelect,{id:te,value:K,onChange:le=>Z(se[Number(le.currentTarget.value)]),disabled:ie},oe.map((le,ce)=>React.createElement("option",{key:le,value:ce},le))),React.createElement(PresentationalSelect,null,ae.current),React.createElement(Chevron,{toggled:!0}))}function SelectComponent(){const{label:K,value:_,displayValue:Z,onUpdate:te,id:ne,disabled:ie,settings:oe}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,K),React.createElement(Select$1,{id:ne,value:_,displayValue:Z,onUpdate:te,settings:oe,disabled:ie}))}var select=_objectSpread2({component:SelectComponent},props$2$1);const schema$1$2=K=>v8n().string().test(K),sanitize$1$1=K=>{if(typeof K!="string")throw Error("Invalid string");return K},normalize$b=({value:K,editable:_=!0,rows:Z=!1})=>({value:K,settings:{editable:_,rows:typeof Z=="number"?Z:Z?5:0}});var props$1$1=Object.freeze({__proto__:null,schema:schema$1$2,sanitize:sanitize$1$1,normalize:normalize$b});const _excluded$2$1=["displayValue","onUpdate","onChange","editable"],NonEditableString=styled("div",{whiteSpace:"pre-wrap"});function String$1(K){let{displayValue:_,onUpdate:Z,onChange:te,editable:ne=!0}=K,ie=_objectWithoutProperties$1(K,_excluded$2$1);return ne?React.createElement(ValueInput,_extends$2({value:_,onUpdate:Z,onChange:te},ie)):React.createElement(NonEditableString,null,_)}function StringComponent(){const{label:K,settings:_,displayValue:Z,onUpdate:te,onChange:ne}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,K),React.createElement(String$1,_extends$2({displayValue:Z,onUpdate:te,onChange:ne},_)))}var string$2=_objectSpread2({component:StringComponent},props$1$1);const schema$4=K=>v8n().boolean().test(K),sanitize$5=K=>{if(typeof K!="boolean")throw Error("Invalid boolean");return K};var props$4=Object.freeze({__proto__:null,schema:schema$4,sanitize:sanitize$5});const StyledInputWrapper=styled("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function Boolean$1({value:K,onUpdate:_,id:Z,disabled:te}){return React.createElement(StyledInputWrapper,null,React.createElement("input",{id:Z,type:"checkbox",checked:K,onChange:ne=>_(ne.currentTarget.checked),disabled:te}),React.createElement("label",{htmlFor:Z},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function BooleanComponent(){const{label:K,value:_,onUpdate:Z,disabled:te,id:ne}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,K),React.createElement(Boolean$1,{value:_,onUpdate:Z,id:ne,disabled:te}))}var boolean$4=_objectSpread2({component:BooleanComponent},props$4);const _excluded$1$1=["locked"];function Coordinate({value:K,id:_,valueKey:Z,settings:te,onUpdate:ne,innerLabelTrim:ie}){const oe=reactExports.useRef(K[Z]);oe.current=K[Z];const se=reactExports.useCallback(le=>ne({[Z]:sanitizeValue({type:"NUMBER",value:oe.current,settings:te},le)}),[ne,te,Z]),ae=useInputSetters({type:"NUMBER",value:K[Z],settings:te,setValue:se});return React.createElement(Number$1,{id:_,label:Z,value:K[Z],displayValue:ae.displayValue,onUpdate:ae.onUpdate,onChange:ae.onChange,settings:te,innerLabelTrim:ie})}const Container$2=styled("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function Lock(K){let{locked:_}=K,Z=_objectWithoutProperties$1(K,_excluded$1$1);return React.createElement("svg",_extends$2({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Z),_?React.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):React.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function Vector({value:K,onUpdate:_,settings:Z,innerLabelTrim:te}){const{id:ne,setSettings:ie}=useInputContext(),{lock:oe,locked:se}=Z;return React.createElement(Container$2,{withLock:oe},oe&&React.createElement(Lock,{locked:se,onClick:()=>ie({locked:!se})}),Object.keys(K).map((ae,le)=>React.createElement(Coordinate,{id:le===0?ne:`${ne}.${ae}`,key:ae,valueKey:ae,value:K,settings:Z[ae],onUpdate:_,innerLabelTrim:te})))}const normalizeKeyedNumberSettings=(K,_)=>{const Z={};let te=0,ne=1/0;Object.entries(K).forEach(([ie,oe])=>{Z[ie]=normalize$2$2(_objectSpread2({value:oe},_[ie])).settings,te=Math.max(te,Z[ie].step),ne=Math.min(ne,Z[ie].pad)});for(let ie in Z){const{step:oe,min:se,max:ae}=_[ie]||{};!isFinite(oe)&&(!isFinite(se)||!isFinite(ae))&&(Z[ie].step=te,Z[ie].pad=ne)}return Z},_excluded$b=["lock"],_excluded2$5=["value"];function getVectorSchema(K){const _=v8n().array().length(K).every.number(),Z=te=>{if(!te||typeof te!="object")return!1;const ne=Object.values(te);return ne.length===K&&ne.every(ie=>isFinite(ie))};return te=>_.test(te)||Z(te)}function getVectorType(K){return Array.isArray(K)?"array":"object"}function convert$8(K,_,Z){return getVectorType(K)===_?K:_==="array"?Object.values(K):mapArrayToKeys(K,Z)}const sanitizeVector=(K,_,Z)=>{const te=convert$8(K,"object",_.keys);for(let oe in te)te[oe]=sanitize$3(te[oe],_[oe]);const ne=Object.keys(te);let ie={};if(ne.length===_.keys.length)ie=te;else{const oe=convert$8(Z,"object",_.keys);if(ne.length===1&&_.locked){const se=ne[0],ae=te[se],le=oe[se],ce=le!==0?ae/le:1;for(let fe in oe)fe===se?ie[se]=ae:ie[fe]=oe[fe]*ce}else ie=_objectSpread2(_objectSpread2({},oe),te)}return convert$8(ie,_.format,_.keys)},formatVector=(K,_)=>convert$8(K,"object",_.keys),isNumberSettings=K=>!!K&&("step"in K||"min"in K||"max"in K);function normalizeVector(K,_,Z=[]){const{lock:te=!1}=_,ne=_objectWithoutProperties$1(_,_excluded$b),ie=Array.isArray(K)?"array":"object",oe=ie==="object"?Object.keys(K):Z,se=convert$8(K,"object",oe),ae=isNumberSettings(ne)?oe.reduce((ce,fe)=>Object.assign(ce,{[fe]:ne}),{}):ne,le=normalizeKeyedNumberSettings(se,ae);return{value:ie==="array"?K:se,settings:_objectSpread2(_objectSpread2({},le),{},{format:ie,keys:oe,lock:te,locked:!1})}}function getVectorPlugin(K){return{schema:getVectorSchema(K.length),normalize:_=>{let{value:Z}=_,te=_objectWithoutProperties$1(_,_excluded2$5);return normalizeVector(Z,te,K)},format:(_,Z)=>formatVector(_,Z),sanitize:(_,Z,te)=>sanitizeVector(_,Z,te)}}var r$1={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(K){return typeof K=="string"?K.length>0:typeof K=="number"},n$1=function(K,_,Z){return _===void 0&&(_=0),Z===void 0&&(Z=Math.pow(10,_)),Math.round(Z*K)/Z+0},e=function(K,_,Z){return _===void 0&&(_=0),Z===void 0&&(Z=1),K>Z?Z:K>_?K:_},u$e=function(K){return(K=isFinite(K)?K%360:0)>0?K:K+360},a=function(K){return{r:e(K.r,0,255),g:e(K.g,0,255),b:e(K.b,0,255),a:e(K.a)}},o=function(K){return{r:n$1(K.r),g:n$1(K.g),b:n$1(K.b),a:n$1(K.a,3)}},i$6=/^#([0-9a-f]{3,8})$/i,s$2=function(K){var _=K.toString(16);return _.length<2?"0"+_:_},h$2=function(K){var _=K.r,Z=K.g,te=K.b,ne=K.a,ie=Math.max(_,Z,te),oe=ie-Math.min(_,Z,te),se=oe?ie===_?(Z-te)/oe:ie===Z?2+(te-_)/oe:4+(_-Z)/oe:0;return{h:60*(se<0?se+6:se),s:ie?oe/ie*100:0,v:ie/255*100,a:ne}},b$1=function(K){var _=K.h,Z=K.s,te=K.v,ne=K.a;_=_/360*6,Z/=100,te/=100;var ie=Math.floor(_),oe=te*(1-Z),se=te*(1-(_-ie)*Z),ae=te*(1-(1-_+ie)*Z),le=ie%6;return{r:255*[te,se,oe,oe,ae,te][le],g:255*[ae,te,te,se,oe,oe][le],b:255*[oe,oe,ae,te,te,se][le],a:ne}},g$1=function(K){return{h:u$e(K.h),s:e(K.s,0,100),l:e(K.l,0,100),a:e(K.a)}},d$1=function(K){return{h:n$1(K.h),s:n$1(K.s),l:n$1(K.l),a:n$1(K.a,3)}},f$1=function(K){return b$1((Z=(_=K).s,{h:_.h,s:(Z*=((te=_.l)<50?te:100-te)/100)>0?2*Z/(te+Z)*100:0,v:te+Z,a:_.a}));var _,Z,te},c$1=function(K){return{h:(_=h$2(K)).h,s:(ne=(200-(Z=_.s))*(te=_.v)/100)>0&&ne<200?Z*te/100/(ne<=100?ne:200-ne)*100:0,l:ne/2,a:_.a};var _,Z,te,ne},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p$2=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$2=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m$2=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y$1={string:[[function(K){var _=i$6.exec(K);return _?(K=_[1]).length<=4?{r:parseInt(K[0]+K[0],16),g:parseInt(K[1]+K[1],16),b:parseInt(K[2]+K[2],16),a:K.length===4?n$1(parseInt(K[3]+K[3],16)/255,2):1}:K.length===6||K.length===8?{r:parseInt(K.substr(0,2),16),g:parseInt(K.substr(2,2),16),b:parseInt(K.substr(4,2),16),a:K.length===8?n$1(parseInt(K.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(K){var _=v$2.exec(K)||m$2.exec(K);return _?_[2]!==_[4]||_[4]!==_[6]?null:a({r:Number(_[1])/(_[2]?100/255:1),g:Number(_[3])/(_[4]?100/255:1),b:Number(_[5])/(_[6]?100/255:1),a:_[7]===void 0?1:Number(_[7])/(_[8]?100:1)}):null},"rgb"],[function(K){var _=l.exec(K)||p$2.exec(K);if(!_)return null;var Z,te,ne=g$1({h:(Z=_[1],te=_[2],te===void 0&&(te="deg"),Number(Z)*(r$1[te]||1)),s:Number(_[3]),l:Number(_[4]),a:_[5]===void 0?1:Number(_[5])/(_[6]?100:1)});return f$1(ne)},"hsl"]],object:[[function(K){var _=K.r,Z=K.g,te=K.b,ne=K.a,ie=ne===void 0?1:ne;return t(_)&&t(Z)&&t(te)?a({r:Number(_),g:Number(Z),b:Number(te),a:Number(ie)}):null},"rgb"],[function(K){var _=K.h,Z=K.s,te=K.l,ne=K.a,ie=ne===void 0?1:ne;if(!t(_)||!t(Z)||!t(te))return null;var oe=g$1({h:Number(_),s:Number(Z),l:Number(te),a:Number(ie)});return f$1(oe)},"hsl"],[function(K){var _=K.h,Z=K.s,te=K.v,ne=K.a,ie=ne===void 0?1:ne;if(!t(_)||!t(Z)||!t(te))return null;var oe=function(se){return{h:u$e(se.h),s:e(se.s,0,100),v:e(se.v,0,100),a:e(se.a)}}({h:Number(_),s:Number(Z),v:Number(te),a:Number(ie)});return b$1(oe)},"hsv"]]},N=function(K,_){for(var Z=0;Z<_.length;Z++){var te=_[Z][0](K);if(te)return[te,_[Z][1]]}return[null,void 0]},x=function(K){return typeof K=="string"?N(K.trim(),y$1.string):typeof K=="object"&&K!==null?N(K,y$1.object):[null,void 0]},I$1=function(K){return x(K)[1]},M=function(K,_){var Z=c$1(K);return{h:Z.h,s:e(Z.s+100*_,0,100),l:Z.l,a:Z.a}},H=function(K){return(299*K.r+587*K.g+114*K.b)/1e3/255},$$2=function(K,_){var Z=c$1(K);return{h:Z.h,s:Z.s,l:e(Z.l+100*_,0,100),a:Z.a}},j=function(){function K(_){this.parsed=x(_)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return K.prototype.isValid=function(){return this.parsed!==null},K.prototype.brightness=function(){return n$1(H(this.rgba),2)},K.prototype.isDark=function(){return H(this.rgba)<.5},K.prototype.isLight=function(){return H(this.rgba)>=.5},K.prototype.toHex=function(){return _=o(this.rgba),Z=_.r,te=_.g,ne=_.b,oe=(ie=_.a)<1?s$2(n$1(255*ie)):"","#"+s$2(Z)+s$2(te)+s$2(ne)+oe;var _,Z,te,ne,ie,oe},K.prototype.toRgb=function(){return o(this.rgba)},K.prototype.toRgbString=function(){return _=o(this.rgba),Z=_.r,te=_.g,ne=_.b,(ie=_.a)<1?"rgba("+Z+", "+te+", "+ne+", "+ie+")":"rgb("+Z+", "+te+", "+ne+")";var _,Z,te,ne,ie},K.prototype.toHsl=function(){return d$1(c$1(this.rgba))},K.prototype.toHslString=function(){return _=d$1(c$1(this.rgba)),Z=_.h,te=_.s,ne=_.l,(ie=_.a)<1?"hsla("+Z+", "+te+"%, "+ne+"%, "+ie+")":"hsl("+Z+", "+te+"%, "+ne+"%)";var _,Z,te,ne,ie},K.prototype.toHsv=function(){return _=h$2(this.rgba),{h:n$1(_.h),s:n$1(_.s),v:n$1(_.v),a:n$1(_.a,3)};var _},K.prototype.invert=function(){return w({r:255-(_=this.rgba).r,g:255-_.g,b:255-_.b,a:_.a});var _},K.prototype.saturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,_))},K.prototype.desaturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,-_))},K.prototype.grayscale=function(){return w(M(this.rgba,-1))},K.prototype.lighten=function(_){return _===void 0&&(_=.1),w($$2(this.rgba,_))},K.prototype.darken=function(_){return _===void 0&&(_=.1),w($$2(this.rgba,-_))},K.prototype.rotate=function(_){return _===void 0&&(_=15),this.hue(this.hue()+_)},K.prototype.alpha=function(_){return typeof _=="number"?w({r:(Z=this.rgba).r,g:Z.g,b:Z.b,a:_}):n$1(this.rgba.a,3);var Z},K.prototype.hue=function(_){var Z=c$1(this.rgba);return typeof _=="number"?w({h:_,s:Z.s,l:Z.l,a:Z.a}):n$1(Z.h)},K.prototype.isEqual=function(_){return this.toHex()===w(_).toHex()},K}(),w=function(K){return K instanceof j?K:new j(K)},S$1=[],k$1=function(K){K.forEach(function(_){S$1.indexOf(_)<0&&(_(j,y$1),S$1.push(_))})};function namesPlugin(K,_){var Z={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},te={};for(var ne in Z)te[Z[ne]]=ne;var ie={};K.prototype.toName=function(oe){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var se,ae,le=te[this.toHex()];if(le)return le;if(oe!=null&&oe.closest){var ce=this.toRgb(),fe=1/0,de="black";if(!ie.length)for(var pe in Z)ie[pe]=new K(Z[pe]).toRgb();for(var he in Z){var ge=(se=ce,ae=ie[he],Math.pow(se.r-ae.r,2)+Math.pow(se.g-ae.g,2)+Math.pow(se.b-ae.b,2));ge<fe&&(fe=ge,de=he)}return de}},_.string.push([function(oe){var se=oe.toLowerCase(),ae=se==="transparent"?"#0000":Z[se];return ae?new K(ae).toRgb():null},"name"])}function u$d(){return(u$d=Object.assign||function(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_];for(var te in Z)Object.prototype.hasOwnProperty.call(Z,te)&&(K[te]=Z[te])}return K}).apply(this,arguments)}function c(K,_){if(K==null)return{};var Z,te,ne={},ie=Object.keys(K);for(te=0;te<ie.length;te++)_.indexOf(Z=ie[te])>=0||(ne[Z]=K[Z]);return ne}function i$5(K){var _=reactExports.useRef(K),Z=reactExports.useRef(function(te){_.current&&_.current(te)});return _.current=K,Z.current}var s$1=function(K,_,Z){return _===void 0&&(_=0),Z===void 0&&(Z=1),K>Z?Z:K<_?_:K},f=function(K){return"touches"in K},v$1=function(K){return K&&K.ownerDocument.defaultView||self},d=function(K,_,Z){var te=K.getBoundingClientRect(),ne=f(_)?function(ie,oe){for(var se=0;se<ie.length;se++)if(ie[se].identifier===oe)return ie[se];return ie[0]}(_.touches,Z):_;return{left:s$1((ne.pageX-(te.left+v$1(K).pageXOffset))/te.width),top:s$1((ne.pageY-(te.top+v$1(K).pageYOffset))/te.height)}},h$1=function(K){!f(K)&&K.preventDefault()},m$1=React.memo(function(K){var _=K.onMove,Z=K.onKey,te=c(K,["onMove","onKey"]),ne=reactExports.useRef(null),ie=i$5(_),oe=i$5(Z),se=reactExports.useRef(null),ae=reactExports.useRef(!1),le=reactExports.useMemo(function(){var pe=function(me){h$1(me),(f(me)?me.touches.length>0:me.buttons>0)&&ne.current?ie(d(ne.current,me,se.current)):ge(!1)},he=function(){return ge(!1)};function ge(me){var Ae=ae.current,ye=v$1(ne.current),ve=me?ye.addEventListener:ye.removeEventListener;ve(Ae?"touchmove":"mousemove",pe),ve(Ae?"touchend":"mouseup",he)}return[function(me){var Ae=me.nativeEvent,ye=ne.current;if(ye&&(h$1(Ae),!function(_e,Te){return Te&&!f(_e)}(Ae,ae.current)&&ye)){if(f(Ae)){ae.current=!0;var ve=Ae.changedTouches||[];ve.length&&(se.current=ve[0].identifier)}ye.focus(),ie(d(ye,Ae,se.current)),ge(!0)}},function(me){var Ae=me.which||me.keyCode;Ae<37||Ae>40||(me.preventDefault(),oe({left:Ae===39?.05:Ae===37?-.05:0,top:Ae===40?.05:Ae===38?-.05:0}))},ge]},[oe,ie]),ce=le[0],fe=le[1],de=le[2];return reactExports.useEffect(function(){return de},[de]),React.createElement("div",u$d({},te,{onTouchStart:ce,onMouseDown:ce,className:"react-colorful__interactive",ref:ne,onKeyDown:fe,tabIndex:0,role:"slider"}))}),g=function(K){return K.filter(Boolean).join(" ")},p$1=function(K){var _=K.color,Z=K.left,te=K.top,ne=te===void 0?.5:te,ie=g(["react-colorful__pointer",K.className]);return React.createElement("div",{className:ie,style:{top:100*ne+"%",left:100*Z+"%"}},React.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:_}}))},b=function(K,_,Z){return _===void 0&&(_=0),Z===void 0&&(Z=Math.pow(10,_)),Math.round(Z*K)/Z},y=function(K){var _=K.s,Z=K.v,te=K.a,ne=(200-_)*Z/100;return{h:b(K.h),s:b(ne>0&&ne<200?_*Z/100/(ne<=100?ne:200-ne)*100:0),l:b(ne/2),a:b(te,2)}},q=function(K){var _=y(K);return"hsl("+_.h+", "+_.s+"%, "+_.l+"%)"},k=function(K){var _=y(K);return"hsla("+_.h+", "+_.s+"%, "+_.l+"%, "+_.a+")"},I=function(K){var _=K.h,Z=K.s,te=K.v,ne=K.a;_=_/360*6,Z/=100,te/=100;var ie=Math.floor(_),oe=te*(1-Z),se=te*(1-(_-ie)*Z),ae=te*(1-(1-_+ie)*Z),le=ie%6;return{r:b(255*[te,se,oe,oe,ae,te][le]),g:b(255*[ae,te,te,se,oe,oe][le]),b:b(255*[oe,oe,ae,te,te,se][le]),a:b(ne,2)}},L=function(K){var _=K.r,Z=K.g,te=K.b,ne=K.a,ie=Math.max(_,Z,te),oe=ie-Math.min(_,Z,te),se=oe?ie===_?(Z-te)/oe:ie===Z?2+(te-_)/oe:4+(_-Z)/oe:0;return{h:b(60*(se<0?se+6:se)),s:b(ie?oe/ie*100:0),v:b(ie/255*100),a:ne}},S=React.memo(function(K){var _=K.hue,Z=K.onChange,te=g(["react-colorful__hue",K.className]);return React.createElement("div",{className:te},React.createElement(m$1,{onMove:function(ne){Z({h:360*ne.left})},onKey:function(ne){Z({h:s$1(_+360*ne.left,0,360)})},"aria-label":"Hue","aria-valuenow":b(_),"aria-valuemax":"360","aria-valuemin":"0"},React.createElement(p$1,{className:"react-colorful__hue-pointer",left:_/360,color:q({h:_,s:100,v:100,a:1})})))}),T=React.memo(function(K){var _=K.hsva,Z=K.onChange,te={backgroundColor:q({h:_.h,s:100,v:100,a:1})};return React.createElement("div",{className:"react-colorful__saturation",style:te},React.createElement(m$1,{onMove:function(ne){Z({s:100*ne.left,v:100-100*ne.top})},onKey:function(ne){Z({s:s$1(_.s+100*ne.left,0,100),v:s$1(_.v-100*ne.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+b(_.s)+"%, Brightness "+b(_.v)+"%"},React.createElement(p$1,{className:"react-colorful__saturation-pointer",top:1-_.v/100,left:_.s/100,color:q(_)})))}),F=function(K,_){if(K===_)return!0;for(var Z in K)if(K[Z]!==_[Z])return!1;return!0};function Y(K,_,Z){var te=i$5(Z),ne=reactExports.useState(function(){return K.toHsva(_)}),ie=ne[0],oe=ne[1],se=reactExports.useRef({color:_,hsva:ie});reactExports.useEffect(function(){if(!K.equal(_,se.current.color)){var le=K.toHsva(_);se.current={hsva:le,color:_},oe(le)}},[_,K]),reactExports.useEffect(function(){var le;F(ie,se.current.hsva)||K.equal(le=K.fromHsva(ie),se.current.color)||(se.current={hsva:ie,color:le},te(le))},[ie,K,te]);var ae=reactExports.useCallback(function(le){oe(function(ce){return Object.assign({},ce,le)})},[]);return[ie,ae]}var V=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,$$1=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},J=new Map,Q=function(K){V(function(){var _=K.current?K.current.ownerDocument:document;if(_!==void 0&&!J.has(_)){var Z=_.createElement("style");Z.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,J.set(_,Z);var te=$$1();te&&Z.setAttribute("nonce",te),_.head.appendChild(Z)}},[])},U=function(K){var _=K.className,Z=K.colorModel,te=K.color,ne=te===void 0?Z.defaultColor:te,ie=K.onChange,oe=c(K,["className","colorModel","color","onChange"]),se=reactExports.useRef(null);Q(se);var ae=Y(Z,ne,ie),le=ae[0],ce=ae[1],fe=g(["react-colorful",_]);return React.createElement("div",u$d({},oe,{ref:se,className:fe}),React.createElement(T,{hsva:le,onChange:ce}),React.createElement(S,{hue:le.h,onChange:ce,className:"react-colorful__last-control"}))},ee=function(K){var _=K.className,Z=K.hsva,te=K.onChange,ne={backgroundImage:"linear-gradient(90deg, "+k(Object.assign({},Z,{a:0}))+", "+k(Object.assign({},Z,{a:1}))+")"},ie=g(["react-colorful__alpha",_]),oe=b(100*Z.a);return React.createElement("div",{className:ie},React.createElement("div",{className:"react-colorful__alpha-gradient",style:ne}),React.createElement(m$1,{onMove:function(se){te({a:se.left})},onKey:function(se){te({a:s$1(Z.a+se.left)})},"aria-label":"Alpha","aria-valuetext":oe+"%","aria-valuenow":oe,"aria-valuemin":"0","aria-valuemax":"100"},React.createElement(p$1,{className:"react-colorful__alpha-pointer",left:Z.a,color:k(Z)})))},re=function(K){var _=K.className,Z=K.colorModel,te=K.color,ne=te===void 0?Z.defaultColor:te,ie=K.onChange,oe=c(K,["className","colorModel","color","onChange"]),se=reactExports.useRef(null);Q(se);var ae=Y(Z,ne,ie),le=ae[0],ce=ae[1],fe=g(["react-colorful",_]);return React.createElement("div",u$d({},oe,{ref:se,className:fe}),React.createElement(T,{hsva:le,onChange:ce}),React.createElement(S,{hue:le.h,onChange:ce}),React.createElement(ee,{hsva:le,onChange:ce,className:"react-colorful__last-control"}))},xe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:L,fromHsva:I,equal:F},Ce=function(K){return React.createElement(re,u$d({},K,{colorModel:xe}))},Me={defaultColor:{r:0,g:0,b:0},toHsva:function(K){return L({r:K.r,g:K.g,b:K.b,a:1})},fromHsva:function(K){return{r:(_=I(K)).r,g:_.g,b:_.b};var _},equal:F},Ne=function(K){return React.createElement(U,u$d({},K,{colorModel:Me}))},propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var K="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=K,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var K=requireReactPropTypesSecret();function _(){}function Z(){}return Z.resetWarningCache=_,factoryWithThrowingShims=function(){function te(oe,se,ae,le,ce,fe){if(fe!==K){var de=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw de.name="Invariant Violation",de}}te.isRequired=te;function ne(){return te}var ie={array:te,bigint:te,bool:te,func:te,number:te,object:te,string:te,symbol:te,any:te,arrayOf:ne,element:te,elementType:te,instanceOf:ne,node:te,objectOf:ne,oneOf:ne,oneOfType:ne,shape:ne,exact:ne,checkPropTypes:Z,resetWarningCache:_};return ie.PropTypes=ie,ie},factoryWithThrowingShims}propTypes.exports=requireFactoryWithThrowingShims()();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs$1(propTypesExports);function __awaiter$1(K,_,Z,te){function ne(ie){return ie instanceof Z?ie:new Z(function(oe){oe(ie)})}return new(Z||(Z=Promise))(function(ie,oe){function se(ce){try{le(te.next(ce))}catch(fe){oe(fe)}}function ae(ce){try{le(te.throw(ce))}catch(fe){oe(fe)}}function le(ce){ce.done?ie(ce.value):ne(ce.value).then(se,ae)}le((te=te.apply(K,_||[])).next())})}function __generator$1(K,_){var Z={label:0,sent:function(){if(ie[0]&1)throw ie[1];return ie[1]},trys:[],ops:[]},te,ne,ie,oe=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return oe.next=se(0),oe.throw=se(1),oe.return=se(2),typeof Symbol=="function"&&(oe[Symbol.iterator]=function(){return this}),oe;function se(le){return function(ce){return ae([le,ce])}}function ae(le){if(te)throw new TypeError("Generator is already executing.");for(;oe&&(oe=0,le[0]&&(Z=0)),Z;)try{if(te=1,ne&&(ie=le[0]&2?ne.return:le[0]?ne.throw||((ie=ne.return)&&ie.call(ne),0):ne.next)&&!(ie=ie.call(ne,le[1])).done)return ie;switch(ne=0,ie&&(le=[le[0]&2,ie.value]),le[0]){case 0:case 1:ie=le;break;case 4:return Z.label++,{value:le[1],done:!1};case 5:Z.label++,ne=le[1],le=[0];continue;case 7:le=Z.ops.pop(),Z.trys.pop();continue;default:if(ie=Z.trys,!(ie=ie.length>0&&ie[ie.length-1])&&(le[0]===6||le[0]===2)){Z=0;continue}if(le[0]===3&&(!ie||le[1]>ie[0]&&le[1]<ie[3])){Z.label=le[1];break}if(le[0]===6&&Z.label<ie[1]){Z.label=ie[1],ie=le;break}if(ie&&Z.label<ie[2]){Z.label=ie[2],Z.ops.push(le);break}ie[2]&&Z.ops.pop(),Z.trys.pop();continue}le=_.call(K,Z)}catch(ce){le=[6,ce],ne=0}finally{te=ie=0}if(le[0]&5)throw le[1];return{value:le[0]?le[1]:void 0,done:!0}}}function __read(K,_){var Z=typeof Symbol=="function"&&K[Symbol.iterator];if(!Z)return K;var te=Z.call(K),ne,ie=[],oe;try{for(;(_===void 0||_-- >0)&&!(ne=te.next()).done;)ie.push(ne.value)}catch(se){oe={error:se}}finally{try{ne&&!ne.done&&(Z=te.return)&&Z.call(te)}finally{if(oe)throw oe.error}}return ie}function __spread(){for(var K=[],_=0;_<arguments.length;_++)K=K.concat(__read(arguments[_]));return K}typeof SuppressedError=="function"&&SuppressedError;var COMMON_MIME_TYPES=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function toFileWithPath(K,_){var Z=withMimeType(K);if(typeof Z.path!="string"){var te=K.webkitRelativePath;Object.defineProperty(Z,"path",{value:typeof _=="string"?_:typeof te=="string"&&te.length>0?te:K.name,writable:!1,configurable:!1,enumerable:!0})}return Z}function withMimeType(K){var _=K.name,Z=_&&_.lastIndexOf(".")!==-1;if(Z&&!K.type){var te=_.split(".").pop().toLowerCase(),ne=COMMON_MIME_TYPES.get(te);ne&&Object.defineProperty(K,"type",{value:ne,writable:!1,configurable:!1,enumerable:!0})}return K}var FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(K){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(_){return isObject$a(K)&&isDataTransfer(K)?[2,getDataTransferFiles(K.dataTransfer,K.type)]:isChangeEvt(K)?[2,getInputFiles(K)]:Array.isArray(K)&&K.every(function(Z){return"getFile"in Z&&typeof Z.getFile=="function"})?[2,getFsHandleFiles(K)]:[2,[]]})})}function isDataTransfer(K){return isObject$a(K.dataTransfer)}function isChangeEvt(K){return isObject$a(K)&&isObject$a(K.target)}function isObject$a(K){return typeof K=="object"&&K!==null}function getInputFiles(K){return fromList(K.target.files).map(function(_){return toFileWithPath(_)})}function getFsHandleFiles(K){return __awaiter$1(this,void 0,void 0,function(){var _;return __generator$1(this,function(Z){switch(Z.label){case 0:return[4,Promise.all(K.map(function(te){return te.getFile()}))];case 1:return _=Z.sent(),[2,_.map(function(te){return toFileWithPath(te)})]}})})}function getDataTransferFiles(K,_){return __awaiter$1(this,void 0,void 0,function(){var Z,te;return __generator$1(this,function(ne){switch(ne.label){case 0:return K===null?[2,[]]:K.items?(Z=fromList(K.items).filter(function(ie){return ie.kind==="file"}),_!=="drop"?[2,Z]:[4,Promise.all(Z.map(toFilePromises))]):[3,2];case 1:return te=ne.sent(),[2,noIgnoredFiles(flatten(te))];case 2:return[2,noIgnoredFiles(fromList(K.files).map(function(ie){return toFileWithPath(ie)}))]}})})}function noIgnoredFiles(K){return K.filter(function(_){return FILES_TO_IGNORE.indexOf(_.name)===-1})}function fromList(K){if(K===null)return[];for(var _=[],Z=0;Z<K.length;Z++){var te=K[Z];_.push(te)}return _}function toFilePromises(K){if(typeof K.webkitGetAsEntry!="function")return fromDataTransferItem(K);var _=K.webkitGetAsEntry();return _&&_.isDirectory?fromDirEntry(_):fromDataTransferItem(K)}function flatten(K){return K.reduce(function(_,Z){return __spread(_,Array.isArray(Z)?flatten(Z):[Z])},[])}function fromDataTransferItem(K){var _=K.getAsFile();if(!_)return Promise.reject(K+" is not a File");var Z=toFileWithPath(_);return Promise.resolve(Z)}function fromEntry(K){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(_){return[2,K.isDirectory?fromDirEntry(K):fromFileEntry(K)]})})}function fromDirEntry(K){var _=K.createReader();return new Promise(function(Z,te){var ne=[];function ie(){var oe=this;_.readEntries(function(se){return __awaiter$1(oe,void 0,void 0,function(){var ae,le,ce;return __generator$1(this,function(fe){switch(fe.label){case 0:if(se.length)return[3,5];fe.label=1;case 1:return fe.trys.push([1,3,,4]),[4,Promise.all(ne)];case 2:return ae=fe.sent(),Z(ae),[3,4];case 3:return le=fe.sent(),te(le),[3,4];case 4:return[3,6];case 5:ce=Promise.all(se.map(fromEntry)),ne.push(ce),ie(),fe.label=6;case 6:return[2]}})})},function(se){te(se)})}ie()})}function fromFileEntry(K){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(_){return[2,new Promise(function(Z,te){K.file(function(ne){var ie=toFileWithPath(ne,K.fullPath);Z(ie)},function(ne){te(ne)})})]})})}var _default$1=function(K,_){if(K&&_){var Z=Array.isArray(_)?_:_.split(",");if(Z.length===0)return!0;var te=K.name||"",ne=(K.type||"").toLowerCase(),ie=ne.replace(/\/.*$/,"");return Z.some(function(oe){var se=oe.trim().toLowerCase();return se.charAt(0)==="."?te.toLowerCase().endsWith(se):se.endsWith("/*")?ie===se.replace(/\/.*$/,""):ne===se})}return!0};function ownKeys$1(K,_){var Z=Object.keys(K);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(K);_&&(te=te.filter(function(ne){return Object.getOwnPropertyDescriptor(K,ne).enumerable})),Z.push.apply(Z,te)}return Z}function _objectSpread$1(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_]!=null?arguments[_]:{};_%2?ownKeys$1(Object(Z),!0).forEach(function(te){_defineProperty$1(K,te,Z[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(Z)):ownKeys$1(Object(Z)).forEach(function(te){Object.defineProperty(K,te,Object.getOwnPropertyDescriptor(Z,te))})}return K}function _defineProperty$1(K,_,Z){return _ in K?Object.defineProperty(K,_,{value:Z,enumerable:!0,configurable:!0,writable:!0}):K[_]=Z,K}function _slicedToArray$1(K,_){return _arrayWithHoles$1(K)||_iterableToArrayLimit$1(K,_)||_unsupportedIterableToArray$1(K,_)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(K,_){if(K){if(typeof K=="string")return _arrayLikeToArray$1(K,_);var Z=Object.prototype.toString.call(K).slice(8,-1);if(Z==="Object"&&K.constructor&&(Z=K.constructor.name),Z==="Map"||Z==="Set")return Array.from(K);if(Z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Z))return _arrayLikeToArray$1(K,_)}}function _arrayLikeToArray$1(K,_){(_==null||_>K.length)&&(_=K.length);for(var Z=0,te=new Array(_);Z<_;Z++)te[Z]=K[Z];return te}function _iterableToArrayLimit$1(K,_){var Z=K==null?null:typeof Symbol<"u"&&K[Symbol.iterator]||K["@@iterator"];if(Z!=null){var te=[],ne=!0,ie=!1,oe,se;try{for(Z=Z.call(K);!(ne=(oe=Z.next()).done)&&(te.push(oe.value),!(_&&te.length===_));ne=!0);}catch(ae){ie=!0,se=ae}finally{try{!ne&&Z.return!=null&&Z.return()}finally{if(ie)throw se}}return te}}function _arrayWithHoles$1(K){if(Array.isArray(K))return K}var FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function(_){_=Array.isArray(_)&&_.length===1?_[0]:_;var Z=Array.isArray(_)?"one of ".concat(_.join(", ")):_;return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(Z)}},getTooLargeRejectionErr=function(_){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(_," ").concat(_===1?"byte":"bytes")}},getTooSmallRejectionErr=function(_){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(_," ").concat(_===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(K,_){var Z=K.type==="application/x-moz-file"||_default$1(K,_);return[Z,Z?null:getInvalidTypeRejectionErr(_)]}function fileMatchSize(K,_,Z){if(isDefined(K.size))if(isDefined(_)&&isDefined(Z)){if(K.size>Z)return[!1,getTooLargeRejectionErr(Z)];if(K.size<_)return[!1,getTooSmallRejectionErr(_)]}else{if(isDefined(_)&&K.size<_)return[!1,getTooSmallRejectionErr(_)];if(isDefined(Z)&&K.size>Z)return[!1,getTooLargeRejectionErr(Z)]}return[!0,null]}function isDefined(K){return K!=null}function allFilesAccepted(K){var _=K.files,Z=K.accept,te=K.minSize,ne=K.maxSize,ie=K.multiple,oe=K.maxFiles;return!ie&&_.length>1||ie&&oe>=1&&_.length>oe?!1:_.every(function(se){var ae=fileAccepted(se,Z),le=_slicedToArray$1(ae,1),ce=le[0],fe=fileMatchSize(se,te,ne),de=_slicedToArray$1(fe,1),pe=de[0];return ce&&pe})}function isPropagationStopped(K){return typeof K.isPropagationStopped=="function"?K.isPropagationStopped():typeof K.cancelBubble<"u"?K.cancelBubble:!1}function isEvtWithFiles(K){return K.dataTransfer?Array.prototype.some.call(K.dataTransfer.types,function(_){return _==="Files"||_==="application/x-moz-file"}):!!K.target&&!!K.target.files}function onDocumentDragOver(K){K.preventDefault()}function isIe(K){return K.indexOf("MSIE")!==-1||K.indexOf("Trident/")!==-1}function isEdge(K){return K.indexOf("Edge/")!==-1}function isIeOrEdge(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(K)||isEdge(K)}function composeEventHandlers(){for(var K=arguments.length,_=new Array(K),Z=0;Z<K;Z++)_[Z]=arguments[Z];return function(te){for(var ne=arguments.length,ie=new Array(ne>1?ne-1:0),oe=1;oe<ne;oe++)ie[oe-1]=arguments[oe];return _.some(function(se){return!isPropagationStopped(te)&&se&&se.apply(void 0,[te].concat(ie)),isPropagationStopped(te)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function filePickerOptionsTypes(K){return K=typeof K=="string"?K.split(","):K,[{description:"everything",accept:Array.isArray(K)?K.filter(function(_){return _==="audio/*"||_==="video/*"||_==="image/*"||_==="text/*"||/\w+\/[-+.\w]+/g.test(_)}).reduce(function(_,Z){return _objectSpread$1(_objectSpread$1({},_),{},_defineProperty$1({},Z,[]))},{}):{}}]}function isAbort(K){return K instanceof DOMException&&(K.name==="AbortError"||K.code===K.ABORT_ERR)}function isSecurityError(K){return K instanceof DOMException&&(K.name==="SecurityError"||K.code===K.SECURITY_ERR)}var _excluded$9=["children"],_excluded2$2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(K){return _arrayWithoutHoles(K)||_iterableToArray(K)||_unsupportedIterableToArray(K)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(K){if(typeof Symbol<"u"&&K[Symbol.iterator]!=null||K["@@iterator"]!=null)return Array.from(K)}function _arrayWithoutHoles(K){if(Array.isArray(K))return _arrayLikeToArray(K)}function _slicedToArray(K,_){return _arrayWithHoles(K)||_iterableToArrayLimit(K,_)||_unsupportedIterableToArray(K,_)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(K,_){if(K){if(typeof K=="string")return _arrayLikeToArray(K,_);var Z=Object.prototype.toString.call(K).slice(8,-1);if(Z==="Object"&&K.constructor&&(Z=K.constructor.name),Z==="Map"||Z==="Set")return Array.from(K);if(Z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Z))return _arrayLikeToArray(K,_)}}function _arrayLikeToArray(K,_){(_==null||_>K.length)&&(_=K.length);for(var Z=0,te=new Array(_);Z<_;Z++)te[Z]=K[Z];return te}function _iterableToArrayLimit(K,_){var Z=K==null?null:typeof Symbol<"u"&&K[Symbol.iterator]||K["@@iterator"];if(Z!=null){var te=[],ne=!0,ie=!1,oe,se;try{for(Z=Z.call(K);!(ne=(oe=Z.next()).done)&&(te.push(oe.value),!(_&&te.length===_));ne=!0);}catch(ae){ie=!0,se=ae}finally{try{!ne&&Z.return!=null&&Z.return()}finally{if(ie)throw se}}return te}}function _arrayWithHoles(K){if(Array.isArray(K))return K}function ownKeys(K,_){var Z=Object.keys(K);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(K);_&&(te=te.filter(function(ne){return Object.getOwnPropertyDescriptor(K,ne).enumerable})),Z.push.apply(Z,te)}return Z}function _objectSpread(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_]!=null?arguments[_]:{};_%2?ownKeys(Object(Z),!0).forEach(function(te){_defineProperty(K,te,Z[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(Z)):ownKeys(Object(Z)).forEach(function(te){Object.defineProperty(K,te,Object.getOwnPropertyDescriptor(Z,te))})}return K}function _defineProperty(K,_,Z){return _ in K?Object.defineProperty(K,_,{value:Z,enumerable:!0,configurable:!0,writable:!0}):K[_]=Z,K}function _objectWithoutProperties(K,_){if(K==null)return{};var Z=_objectWithoutPropertiesLoose$1(K,_),te,ne;if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(K);for(ne=0;ne<ie.length;ne++)te=ie[ne],!(_.indexOf(te)>=0)&&Object.prototype.propertyIsEnumerable.call(K,te)&&(Z[te]=K[te])}return Z}function _objectWithoutPropertiesLoose$1(K,_){if(K==null)return{};var Z={},te=Object.keys(K),ne,ie;for(ie=0;ie<te.length;ie++)ne=te[ie],!(_.indexOf(ne)>=0)&&(Z[ne]=K[ne]);return Z}var Dropzone=reactExports.forwardRef(function(K,_){var Z=K.children,te=_objectWithoutProperties(K,_excluded$9),ne=useDropzone(te),ie=ne.open,oe=_objectWithoutProperties(ne,_excluded2$2);return reactExports.useImperativeHandle(_,function(){return{open:ie}},[ie]),React.createElement(reactExports.Fragment,null,Z(_objectSpread(_objectSpread({},oe),{},{open:ie})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function useDropzone(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=_objectSpread(_objectSpread({},defaultProps),K),Z=_.accept,te=_.disabled,ne=_.getFilesFromEvent,ie=_.maxSize,oe=_.minSize,se=_.multiple,ae=_.maxFiles,le=_.onDragEnter,ce=_.onDragLeave,fe=_.onDragOver,de=_.onDrop,pe=_.onDropAccepted,he=_.onDropRejected,ge=_.onFileDialogCancel,me=_.onFileDialogOpen,Ae=_.useFsAccessApi,ye=_.preventDropOnDocument,ve=_.noClick,_e=_.noKeyboard,Te=_.noDrag,be=_.noDragEventsBubbling,Re=_.validator,we=reactExports.useMemo(function(){return typeof me=="function"?me:noop},[me]),Pe=reactExports.useMemo(function(){return typeof ge=="function"?ge:noop},[ge]),Ie=reactExports.useRef(null),$e=reactExports.useRef(null),Ue=reactExports.useReducer(reducer,initialState),ke=_slicedToArray(Ue,2),Ge=ke[0],He=ke[1],ze=Ge.isFocused,Ke=Ge.isFileDialogActive,tt=Ge.draggedFiles,Je=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&Ae&&canUseFileSystemAccessAPI()),ot=function(){!Je.current&&Ke&&setTimeout(function(){if($e.current){var Pt=$e.current.files;Pt.length||(He({type:"closeDialog"}),Pe())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",ot,!1),function(){window.removeEventListener("focus",ot,!1)}},[$e,Ke,Pe,Je]);var Fe=reactExports.useRef([]),ct=function(Pt){Ie.current&&Ie.current.contains(Pt.target)||(Pt.preventDefault(),Fe.current=[])};reactExports.useEffect(function(){return ye&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",ct,!1)),function(){ye&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",ct))}},[Ie,ye]);var ht=reactExports.useCallback(function(vt){vt.preventDefault(),vt.persist(),bt(vt),Fe.current=[].concat(_toConsumableArray(Fe.current),[vt.target]),isEvtWithFiles(vt)&&Promise.resolve(ne(vt)).then(function(Pt){isPropagationStopped(vt)&&!be||(He({draggedFiles:Pt,isDragActive:!0,type:"setDraggedFiles"}),le&&le(vt))})},[ne,le,be]),lt=reactExports.useCallback(function(vt){vt.preventDefault(),vt.persist(),bt(vt);var Pt=isEvtWithFiles(vt);if(Pt&&vt.dataTransfer)try{vt.dataTransfer.dropEffect="copy"}catch{}return Pt&&fe&&fe(vt),!1},[fe,be]),Qe=reactExports.useCallback(function(vt){vt.preventDefault(),vt.persist(),bt(vt);var Pt=Fe.current.filter(function(Vt){return Ie.current&&Ie.current.contains(Vt)}),Lt=Pt.indexOf(vt.target);Lt!==-1&&Pt.splice(Lt,1),Fe.current=Pt,!(Pt.length>0)&&(He({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),isEvtWithFiles(vt)&&ce&&ce(vt))},[Ie,ce,be]),Ze=reactExports.useCallback(function(vt,Pt){var Lt=[],Vt=[];vt.forEach(function(Le){var De=fileAccepted(Le,Z),Be=_slicedToArray(De,2),rt=Be[0],at=Be[1],xt=fileMatchSize(Le,oe,ie),Ct=_slicedToArray(xt,2),Qt=Ct[0],qt=Ct[1],It=Re?Re(Le):null;if(rt&&Qt&&!It)Lt.push(Le);else{var Gt=[at,qt];It&&(Gt=Gt.concat(It)),Vt.push({file:Le,errors:Gt.filter(function(Jt){return Jt})})}}),(!se&&Lt.length>1||se&&ae>=1&&Lt.length>ae)&&(Lt.forEach(function(Le){Vt.push({file:Le,errors:[TOO_MANY_FILES_REJECTION]})}),Lt.splice(0)),He({acceptedFiles:Lt,fileRejections:Vt,type:"setFiles"}),de&&de(Lt,Vt,Pt),Vt.length>0&&he&&he(Vt,Pt),Lt.length>0&&pe&&pe(Lt,Pt)},[He,se,Z,oe,ie,ae,de,pe,he,Re]),it=reactExports.useCallback(function(vt){vt.preventDefault(),vt.persist(),bt(vt),Fe.current=[],isEvtWithFiles(vt)&&Promise.resolve(ne(vt)).then(function(Pt){isPropagationStopped(vt)&&!be||Ze(Pt,vt)}),He({type:"reset"})},[ne,Ze,be]),nt=reactExports.useCallback(function(){if(Je.current){He({type:"openDialog"}),we();var vt={multiple:se,types:filePickerOptionsTypes(Z)};window.showOpenFilePicker(vt).then(function(Pt){return ne(Pt)}).then(function(Pt){Ze(Pt,null),He({type:"closeDialog"})}).catch(function(Pt){isAbort(Pt)?(Pe(Pt),He({type:"closeDialog"})):isSecurityError(Pt)&&(Je.current=!1,$e.current&&($e.current.value=null,$e.current.click()))});return}$e.current&&(He({type:"openDialog"}),we(),$e.current.value=null,$e.current.click())},[He,we,Pe,Ae,Ze,Z,se]),Tt=reactExports.useCallback(function(vt){!Ie.current||!Ie.current.isEqualNode(vt.target)||(vt.key===" "||vt.key==="Enter"||vt.keyCode===32||vt.keyCode===13)&&(vt.preventDefault(),nt())},[Ie,nt]),St=reactExports.useCallback(function(){He({type:"focus"})},[]),Et=reactExports.useCallback(function(){He({type:"blur"})},[]),Nt=reactExports.useCallback(function(){ve||(isIeOrEdge()?setTimeout(nt,0):nt())},[ve,nt]),zt=function(Pt){return te?null:Pt},yt=function(Pt){return _e?null:zt(Pt)},Ut=function(Pt){return Te?null:zt(Pt)},bt=function(Pt){be&&Pt.stopPropagation()},Ot=reactExports.useMemo(function(){return function(){var vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Pt=vt.refKey,Lt=Pt===void 0?"ref":Pt,Vt=vt.role,Le=vt.onKeyDown,De=vt.onFocus,Be=vt.onBlur,rt=vt.onClick,at=vt.onDragEnter,xt=vt.onDragOver,Ct=vt.onDragLeave,Qt=vt.onDrop,qt=_objectWithoutProperties(vt,_excluded3);return _objectSpread(_objectSpread(_defineProperty({onKeyDown:yt(composeEventHandlers(Le,Tt)),onFocus:yt(composeEventHandlers(De,St)),onBlur:yt(composeEventHandlers(Be,Et)),onClick:zt(composeEventHandlers(rt,Nt)),onDragEnter:Ut(composeEventHandlers(at,ht)),onDragOver:Ut(composeEventHandlers(xt,lt)),onDragLeave:Ut(composeEventHandlers(Ct,Qe)),onDrop:Ut(composeEventHandlers(Qt,it)),role:typeof Vt=="string"&&Vt!==""?Vt:"button"},Lt,Ie),!te&&!_e?{tabIndex:0}:{}),qt)}},[Ie,Tt,St,Et,Nt,ht,lt,Qe,it,_e,Te,te]),Mt=reactExports.useCallback(function(vt){vt.stopPropagation()},[]),_t=reactExports.useMemo(function(){return function(){var vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Pt=vt.refKey,Lt=Pt===void 0?"ref":Pt,Vt=vt.onChange,Le=vt.onClick,De=_objectWithoutProperties(vt,_excluded4),Be=_defineProperty({accept:Z,multiple:se,type:"file",style:{display:"none"},onChange:zt(composeEventHandlers(Vt,it)),onClick:zt(composeEventHandlers(Le,Mt)),tabIndex:-1},Lt,$e);return _objectSpread(_objectSpread({},Be),De)}},[$e,Z,se,it,te]),pt=tt.length,ft=pt>0&&allFilesAccepted({files:tt,accept:Z,minSize:oe,maxSize:ie,multiple:se,maxFiles:ae}),st=pt>0&&!ft;return _objectSpread(_objectSpread({},Ge),{},{isDragAccept:ft,isDragReject:st,isFocused:ze&&!te,getRootProps:Ot,getInputProps:_t,rootRef:Ie,inputRef:$e,open:zt(nt)})}function reducer(K,_){switch(_.type){case"focus":return _objectSpread(_objectSpread({},K),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},K),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},K),{},{isFileDialogActive:!1});case"setDraggedFiles":var Z=_.isDragActive,te=_.draggedFiles;return _objectSpread(_objectSpread({},K),{},{draggedFiles:te,isDragActive:Z});case"setFiles":return _objectSpread(_objectSpread({},K),{},{acceptedFiles:_.acceptedFiles,fileRejections:_.fileRejections});case"reset":return _objectSpread({},initialState);default:return K}}function noop(){}function createStore$3(K){let _;const Z=new Set,te=(le,ce)=>{const fe=typeof le=="function"?le(_):le;if(fe!==_){const de=_;_=ce?fe:Object.assign({},_,fe),Z.forEach(pe=>pe(_,de))}},ne=()=>_,ie=(le,ce=ne,fe=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let de=ce(_);function pe(){const he=ce(_);if(!fe(de,he)){const ge=de;le(de=he,ge)}}return Z.add(pe),()=>Z.delete(pe)},ae={setState:te,getState:ne,subscribe:(le,ce,fe)=>ce||fe?ie(le,ce,fe):(Z.add(le),()=>Z.delete(le)),destroy:()=>Z.clear()};return _=K(te,ne,ae),ae}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create$a(K){const _=typeof K=="function"?createStore$3(K):K,Z=(te=_.getState,ne=Object.is)=>{const[,ie]=reactExports.useReducer(me=>me+1,0),oe=_.getState(),se=reactExports.useRef(oe),ae=reactExports.useRef(te),le=reactExports.useRef(ne),ce=reactExports.useRef(!1),fe=reactExports.useRef();fe.current===void 0&&(fe.current=te(oe));let de,pe=!1;(se.current!==oe||ae.current!==te||le.current!==ne||ce.current)&&(de=te(oe),pe=!ne(fe.current,de)),useIsomorphicLayoutEffect(()=>{pe&&(fe.current=de),se.current=oe,ae.current=te,le.current=ne,ce.current=!1});const he=reactExports.useRef(oe);useIsomorphicLayoutEffect(()=>{const me=()=>{try{const ye=_.getState(),ve=ae.current(ye);le.current(fe.current,ve)||(se.current=ye,fe.current=ve,ie())}catch{ce.current=!0,ie()}},Ae=_.subscribe(me);return _.getState()!==he.current&&me(),Ae},[]);const ge=pe?de:fe.current;return reactExports.useDebugValue(ge),ge};return Object.assign(Z,_),Z[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const te=[Z,_];return{next(){const ne=te.length<=0;return{value:te.shift(),done:ne}}}},Z}const subscribeWithSelector=K=>(_,Z,te)=>{const ne=te.subscribe;return te.subscribe=(oe,se,ae)=>{let le=oe;if(se){const ce=(ae==null?void 0:ae.equalityFn)||Object.is;let fe=oe(te.getState());le=de=>{const pe=oe(de);if(!ce(fe,pe)){const he=fe;se(fe=pe,he)}},ae!=null&&ae.fireImmediately&&se(fe,fe)}return ne(le)},K(_,Z,te)};/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isobject=function(_){return _!=null&&typeof _=="object"&&Array.isArray(_)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isObject$9=isobject;function isObjectObject(K){return isObject$9(K)===!0&&Object.prototype.toString.call(K)==="[object Object]"}var isPlainObject$3=function(_){var Z,te;return!(isObjectObject(_)===!1||(Z=_.constructor,typeof Z!="function")||(te=Z.prototype,isObjectObject(te)===!1)||te.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isPlainObject$2=isPlainObject$3,isExtendable$4=function(_){return isPlainObject$2(_)||typeof _=="function"||Array.isArray(_)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var forIn$1=function(_,Z,te){for(var ne in _)if(Z.call(te,_[ne],ne,_)===!1)break},isExtendable$3=isExtendable$4,forIn=forIn$1;function mixinDeep(K,_){for(var Z=arguments.length,te=0;++te<Z;){var ne=arguments[te];isObject$8(ne)&&forIn(ne,copy,K)}return K}function copy(K,_){if(isValidKey$1(_)){var Z=this[_];isObject$8(K)&&isObject$8(Z)?mixinDeep(Z,K):this[_]=K}}function isObject$8(K){return isExtendable$3(K)&&!Array.isArray(K)}function isValidKey$1(K){return K!=="__proto__"&&K!=="constructor"&&K!=="prototype"}var mixinDeep_1=mixinDeep;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var getValue$1=function(K,_,Z,te,ne){if(!isObject$7(K)||!_)return K;if(_=toString$4(_),Z&&(_+="."+toString$4(Z)),te&&(_+="."+toString$4(te)),ne&&(_+="."+toString$4(ne)),_ in K)return K[_];for(var ie=_.split("."),oe=ie.length,se=-1;K&&++se<oe;){for(var ae=ie[se];ae[ae.length-1]==="\\";)ae=ae.slice(0,-1)+"."+ie[++se];K=K[ae]}return K};function isObject$7(K){return K!==null&&(typeof K=="object"||typeof K=="function")}function toString$4(K){return K?Array.isArray(K)?K.join("."):K:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var assignSymbols$1=function(K,_){if(K===null||typeof K>"u")throw new TypeError("expected first argument to be an object.");if(typeof _>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return K;for(var Z=Object.prototype.propertyIsEnumerable,te=Object(K),ne=arguments.length,ie=0;++ie<ne;)for(var oe=Object(arguments[ie]),se=Object.getOwnPropertySymbols(oe),ae=0;ae<se.length;ae++){var le=se[ae];Z.call(oe,le)&&(te[le]=oe[le])}return te},isExtendable$2=isExtendable$4,assignSymbols=assignSymbols$1,extendShallow$1=Object.assign||function(K){if(K===null||typeof K>"u")throw new TypeError("Cannot convert undefined or null to object");isObject$6(K)||(K={});for(var _=1;_<arguments.length;_++){var Z=arguments[_];isString(Z)&&(Z=toObject(Z)),isObject$6(Z)&&(assign$7(K,Z),assignSymbols(K,Z))}return K};function assign$7(K,_){for(var Z in _)hasOwn$2(_,Z)&&(K[Z]=_[Z])}function isString(K){return K&&typeof K=="string"}function toObject(K){var _={};for(var Z in K)_[Z]=K[Z];return _}function isObject$6(K){return K&&typeof K=="object"||isExtendable$2(K)}function hasOwn$2(K,_){return Object.prototype.hasOwnProperty.call(K,_)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var extend$5=extendShallow$1,splitString=function(K,_,Z){if(typeof K!="string")throw new TypeError("expected a string");typeof _=="function"&&(Z=_,_=null),typeof _=="string"&&(_={sep:_});var te=extend$5({sep:"."},_),ne=te.quotes||['"',"'","`"],ie;te.brackets===!0?ie={"<":">","(":")","[":"]","{":"}"}:te.brackets&&(ie=te.brackets);var oe=[],se=[],ae=[""],le=te.sep,ce=K.length,fe=-1,de;function pe(){if(ie&&se.length)return ie[se[se.length-1]]}for(;++fe<ce;){var he=K[fe],ge=K[fe+1],me={val:he,idx:fe,arr:ae,str:K};if(oe.push(me),he==="\\"){me.val=keepEscaping(te,K,fe)===!0?he+ge:ge,me.escaped=!0,typeof Z=="function"&&Z(me),ae[ae.length-1]+=me.val,fe++;continue}if(ie&&ie[he]){se.push(he);var Ae=pe(),ye=fe+1;if(K.indexOf(Ae,ye+1)!==-1)for(;se.length&&ye<ce;){var ve=K[++ye];if(ve==="\\"){ve++;continue}if(ne.indexOf(ve)!==-1){ye=getClosingQuote(K,ve,ye+1);continue}if(Ae=pe(),se.length&&K.indexOf(Ae,ye+1)===-1)break;if(ie[ve]){se.push(ve);continue}Ae===ve&&se.pop()}if(de=ye,de===-1){ae[ae.length-1]+=he;continue}he=K.slice(fe,de+1),me.val=he,me.idx=fe=de}if(ne.indexOf(he)!==-1){if(de=getClosingQuote(K,he,fe+1),de===-1){ae[ae.length-1]+=he;continue}keepQuotes(he,te)===!0?he=K.slice(fe,de+1):he=K.slice(fe+1,de),me.val=he,me.idx=fe=de}if(typeof Z=="function"&&(Z(me,oe),he=me.val,fe=me.idx),me.val===le&&me.split!==!1){ae.push("");continue}ae[ae.length-1]+=me.val}return ae};function getClosingQuote(K,_,Z,te){var ne=K.indexOf(_,Z);return K.charAt(ne-1)==="\\"?getClosingQuote(K,_,ne+1):ne}function keepQuotes(K,_){return _.keepDoubleQuotes===!0&&K==='"'||_.keepSingleQuotes===!0&&K==="'"?!0:_.keepQuotes}function keepEscaping(K,_,Z){return typeof K.keepEscaping=="function"?K.keepEscaping(_,Z):K.keepEscaping===!0||_[Z+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable$1=function(_){return typeof _<"u"&&_!==null&&(typeof _=="object"||typeof _=="function")},isObject$5=isExtendable$1,extendShallow=function(_){isObject$5(_)||(_={});for(var Z=arguments.length,te=1;te<Z;te++){var ne=arguments[te];isObject$5(ne)&&assign$6(_,ne)}return _};function assign$6(K,_){for(var Z in _)hasOwn$1(_,Z)&&(K[Z]=_[Z])}function hasOwn$1(K,_){return Object.prototype.hasOwnProperty.call(K,_)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable=function(_){return typeof _<"u"&&_!==null&&(typeof _=="object"||typeof _=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var split=splitString,extend$4=extendShallow,isPlainObject$1=isPlainObject$3,isObject$4=isExtendable,setValue=function(K,_,Z){if(!isObject$4(K)||(Array.isArray(_)&&(_=[].concat.apply([],_).join(".")),typeof _!="string"))return K;for(var te=split(_,{sep:".",brackets:!0}).filter(isValidKey),ne=te.length,ie=-1,oe=K;++ie<ne;){var se=te[ie];if(ie!==ne-1){isObject$4(oe[se])||(oe[se]={}),oe=oe[se];continue}isPlainObject$1(oe[se])&&isPlainObject$1(Z)?oe[se]=extend$4({},oe[se],Z):oe[se]=Z}return K};function isValidKey(K){return K!=="__proto__"&&K!=="constructor"&&K!=="prototype"}var isObject$3=isExtendable$4,merge$6=mixinDeep_1,get=getValue$1,set$1=setValue,mergeValue=function(_,Z,te){if(!isObject$3(_))throw new TypeError("expected an object");if(typeof Z!="string"||te==null)return merge$6.apply(null,arguments);if(typeof te=="string")return set$1(_,Z,te),_;var ne=get(_,Z);return isObject$3(te)&&isObject$3(ne)&&(te=merge$6({},ne,te)),set$1(_,Z,te),_};const merge$7=getDefaultExportFromCjs$1(mergeValue),join$2=(...K)=>K.filter(Boolean).join(".");function getKeyPath(K){const _=K.split(".");return[_.pop(),_.join(".")||void 0]}function getValuesForPaths(K,_){return Object.entries(pick$1(K,_)).reduce((Z,[,{value:te,disabled:ne,key:ie}])=>(Z[ie]=ne?void 0:te,Z),{})}function useCompareMemoize(K,_){const Z=reactExports.useRef();return dequal(K,Z.current)||(Z.current=K),Z.current}function useDeepMemo(K,_){return reactExports.useMemo(K,useCompareMemoize(_))}function useToggle(K){const _=reactExports.useRef(null),Z=reactExports.useRef(null),te=reactExports.useRef(!0);return reactExports.useLayoutEffect(()=>{K||(_.current.style.height="0px",_.current.style.overflow="hidden")},[]),reactExports.useEffect(()=>{if(te.current){te.current=!1;return}let ne;const ie=_.current,oe=()=>{K&&(ie.style.removeProperty("height"),ie.style.removeProperty("overflow"),Z.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};ie.addEventListener("transitionend",oe,{once:!0});const{height:se}=Z.current.getBoundingClientRect();return ie.style.height=se+"px",K||(ie.style.overflow="hidden",ne=window.setTimeout(()=>ie.style.height="0px",50)),()=>{ie.removeEventListener("transitionend",oe),clearTimeout(ne)}},[K]),{wrapperRef:_,contentRef:Z}}const useVisiblePaths=K=>{const[_,Z]=reactExports.useState(K.getVisiblePaths());return reactExports.useEffect(()=>{Z(K.getVisiblePaths());const te=K.useStore.subscribe(K.getVisiblePaths,Z,{equalityFn:shallow$8});return()=>te()},[K]),_};function useValuesForPath(K,_,Z){return K.useStore(ne=>{const ie=_objectSpread2(_objectSpread2({},Z),ne.data);return getValuesForPaths(ie,_)},shallow$8)}function usePopin(K=3){const _=reactExports.useRef(null),Z=reactExports.useRef(null),[te,ne]=reactExports.useState(!1),ie=reactExports.useCallback(()=>ne(!0),[]),oe=reactExports.useCallback(()=>ne(!1),[]);return reactExports.useLayoutEffect(()=>{if(te){const{bottom:se,top:ae,left:le}=_.current.getBoundingClientRect(),{height:ce}=Z.current.getBoundingClientRect(),fe=se+ce>window.innerHeight-40?"up":"down";Z.current.style.position="fixed",Z.current.style.zIndex="10000",Z.current.style.left=le+"px",fe==="down"?Z.current.style.top=se+K+"px":Z.current.style.bottom=window.innerHeight-ae+K+"px"}},[K,te]),{popinRef:_,wrapperRef:Z,shown:te,show:ie,hide:oe}}k$1([namesPlugin]);const convertMap={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};v8n.extend({color:()=>K=>w(K).isValid()});const schema$2=K=>v8n().color().test(K);function convert$7(K,{format:_,hasAlpha:Z,isString:te}){const ne=convertMap[_]+(te&&_!=="hex"?"String":""),ie=K[ne]();return typeof ie=="object"&&!Z?omit(ie,["a"]):ie}const sanitize$2=(K,_)=>{const Z=w(K);if(!Z.isValid())throw Error("Invalid color");return convert$7(Z,_)},format$1=(K,_)=>convert$7(w(K),_objectSpread2(_objectSpread2({},_),{},{isString:!0,format:"hex"})),normalize$3$1=({value:K})=>{const _=I$1(K),Z=_==="name"?"hex":_,te=typeof K=="object"?"a"in K:_==="hex"&&K.length===8||/^(rgba)|(hsla)|(hsva)/.test(K),ne={format:Z,hasAlpha:te,isString:typeof K=="string"};return{value:sanitize$2(K,ne),settings:ne}};var props$2=Object.freeze({__proto__:null,schema:schema$2,sanitize:sanitize$2,format:format$1,normalize:normalize$3$1});const ColorPreview=styled("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),PickerContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),PickerWrapper=styled("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function convertToRgb(K,_){return _!=="rgb"?w(K).toRgb():K}function Color({value:K,displayValue:_,settings:Z,onUpdate:te}){const{emitOnEditStart:ne,emitOnEditEnd:ie}=useInputContext(),{format:oe,hasAlpha:se}=Z,{popinRef:ae,wrapperRef:le,shown:ce,show:fe,hide:de}=usePopin(),pe=reactExports.useRef(0),[he,ge]=reactExports.useState(()=>convertToRgb(K,oe)),me=se?Ce:Ne,Ae=()=>{ge(convertToRgb(K,oe)),fe(),ne()},ye=()=>{de(),ie(),window.clearTimeout(pe.current)},ve=()=>{pe.current=window.setTimeout(ye,500)};return reactExports.useEffect(()=>()=>window.clearTimeout(pe.current),[]),React.createElement(React.Fragment,null,React.createElement(ColorPreview,{ref:ae,active:ce,onClick:()=>Ae(),style:{color:_}}),ce&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:ye}),React.createElement(PickerWrapper,{ref:le,onMouseEnter:()=>window.clearTimeout(pe.current),onMouseLeave:_e=>_e.buttons===0&&ve()},React.createElement(me,{color:he,onChange:te}))))}function ColorComponent(){const{value:K,displayValue:_,label:Z,onChange:te,onUpdate:ne,settings:ie}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,Z),React.createElement(PickerContainer,null,React.createElement(Color,{value:K,displayValue:_,onChange:te,onUpdate:ne,settings:ie}),React.createElement(ValueInput,{value:_,onChange:te,onUpdate:ne})))}var color$3=_objectSpread2({component:ColorComponent},props$2);function Vector3dComponent(){const{label:K,displayValue:_,onUpdate:Z,settings:te}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,K),React.createElement(Vector,{value:_,settings:te,onUpdate:Z}))}var vector3d=_objectSpread2({component:Vector3dComponent},getVectorPlugin(["x","y","z"]));const JoystickTrigger=styled("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),JoystickPlayground=styled("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function Joystick({value:K,settings:_,onUpdate:Z}){const te=reactExports.useRef(),ne=reactExports.useRef(0),ie=reactExports.useRef(0),oe=reactExports.useRef(1),[se,ae]=reactExports.useState(!1),[le,ce]=reactExports.useState(!1),[fe,de]=useTransform(),pe=reactExports.useRef(null),he=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{if(se){const{top:Ue,left:ke,width:Ge,height:He}=pe.current.getBoundingClientRect();he.current.style.left=ke+Ge/2+"px",he.current.style.top=Ue+He/2+"px"}},[se]);const{keys:[ge,me],joystick:Ae}=_,ye=Ae==="invertY"?1:-1,{[ge]:{step:ve},[me]:{step:_e}}=_,Te=useTh("sizes","joystickWidth"),be=useTh("sizes","joystickHeight"),Re=parseFloat(Te)*.8/2,we=parseFloat(be)*.8/2,Pe=reactExports.useCallback(()=>{te.current||(ce(!0),ne.current&&de({x:ne.current*Re}),ie.current&&de({y:ie.current*-we}),te.current=window.setInterval(()=>{Z(Ue=>{const ke=ve*ne.current*oe.current,Ge=ye*_e*ie.current*oe.current;return Array.isArray(Ue)?{[ge]:Ue[0]+ke,[me]:Ue[1]+Ge}:{[ge]:Ue[ge]+ke,[me]:Ue[me]+Ge}})},16))},[Re,we,Z,de,ve,_e,ge,me,ye]),Ie=reactExports.useCallback(()=>{window.clearTimeout(te.current),te.current=void 0,ce(!1)},[]);reactExports.useEffect(()=>{function Ue(ke){oe.current=multiplyStep(ke)}return window.addEventListener("keydown",Ue),window.addEventListener("keyup",Ue),()=>{window.clearTimeout(te.current),window.removeEventListener("keydown",Ue),window.removeEventListener("keyup",Ue)}},[]);const $e=useDrag(({first:Ue,active:ke,delta:[Ge,He],movement:[ze,Ke]})=>{Ue&&ae(!0);const tt=clamp$2(ze,-Re,Re),Je=clamp$2(Ke,-we,we);ne.current=Math.abs(ze)>Math.abs(tt)?Math.sign(ze-tt):0,ie.current=Math.abs(Ke)>Math.abs(Je)?Math.sign(Je-Ke):0;let ot=K[ge],Fe=K[me];ke?(ne.current||(ot+=Ge*ve*oe.current,de({x:tt})),ie.current||(Fe-=ye*He*_e*oe.current,de({y:Je})),ne.current||ie.current?Pe():Ie(),Z({[ge]:ot,[me]:Fe})):(ae(!1),ne.current=0,ie.current=0,de({x:0,y:0}),Ie())});return React.createElement(JoystickTrigger,_extends$2({ref:pe},$e()),se&&React.createElement(Portal,null,React.createElement(JoystickPlayground,{ref:he,isOutOfBounds:le},React.createElement("div",null),React.createElement("span",{ref:fe}))))}const Container$1=styled("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function Vector2dComponent(){const{label:K,displayValue:_,onUpdate:Z,settings:te}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,K),React.createElement(Container$1,{withJoystick:!!te.joystick},te.joystick&&React.createElement(Joystick,{value:_,settings:te,onUpdate:Z}),React.createElement(Vector,{value:_,settings:te,onUpdate:Z})))}const _excluded$7=["joystick"],plugin=getVectorPlugin(["x","y"]),normalize$2$1=K=>{let{joystick:_=!0}=K,Z=_objectWithoutProperties$1(K,_excluded$7);const{value:te,settings:ne}=plugin.normalize(Z);return{value:te,settings:_objectSpread2(_objectSpread2({},ne),{},{joystick:_})}};var vector2d=_objectSpread2(_objectSpread2({component:Vector2dComponent},plugin),{},{normalize:normalize$2$1});const sanitize$1=K=>{if(K!==void 0){if(K instanceof File)try{return URL.createObjectURL(K)}catch{return}if(typeof K=="string"&&K.indexOf("blob:")===0)return K;throw Error("Invalid image format [undefined | blob | File].")}},schema$1$1=(K,_)=>typeof _=="object"&&"image"in _,normalize$1$1=({image:K})=>({value:K});var props$1=Object.freeze({__proto__:null,sanitize:sanitize$1,schema:schema$1$1,normalize:normalize$1$1});const ImageContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),DropZone=styled("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),ImagePreview=styled("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),ImageLargePreview=styled("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),Instructions=styled("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),Remove=styled("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function ImageComponent(){const{label:K,value:_,onUpdate:Z,disabled:te}=useInputContext(),{popinRef:ne,wrapperRef:ie,shown:oe,show:se,hide:ae}=usePopin(),le=reactExports.useCallback(he=>{he.length&&Z(he[0])},[Z]),ce=reactExports.useCallback(he=>{he.stopPropagation(),Z(void 0)},[Z]),{getRootProps:fe,getInputProps:de,isDragAccept:pe}=useDropzone({maxFiles:1,accept:"image/*",onDrop:le,disabled:te});return React.createElement(Row,{input:!0},React.createElement(Label,null,K),React.createElement(ImageContainer,null,React.createElement(ImagePreview,{ref:ne,hasImage:!!_,onPointerDown:()=>!!_&&se(),onPointerUp:ae,style:{backgroundImage:_?`url(${_})`:"none"}}),oe&&!!_&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:ae,style:{cursor:"pointer"}}),React.createElement(ImageLargePreview,{ref:ie,style:{backgroundImage:`url(${_})`}})),React.createElement(DropZone,fe({isDragAccept:pe}),React.createElement("input",de()),React.createElement(Instructions,null,pe?"drop image":"click or drop")),React.createElement(Remove,{onClick:ce,disabled:!_})))}var image$1=_objectSpread2({component:ImageComponent},props$1);const number$5=v8n().number(),schema$3=(K,_)=>v8n().array().length(2).every.number().test(K)&&v8n().schema({min:number$5,max:number$5}).test(_),format=K=>({min:K[0],max:K[1]}),sanitize=(K,{bounds:[_,Z]},te)=>{const ne=Array.isArray(K)?format(K):K,ie={min:te[0],max:te[1]},{min:oe,max:se}=_objectSpread2(_objectSpread2({},ie),ne);return[clamp$2(Number(oe),_,Math.max(_,se)),clamp$2(Number(se),Math.min(Z,oe),Z)]},normalize$a=({value:K,min:_,max:Z})=>{const te={min:_,max:Z},ne=normalizeKeyedNumberSettings(format(K),{min:te,max:te}),ie=[_,Z],oe=_objectSpread2(_objectSpread2({},ne),{},{bounds:ie});return{value:sanitize(format(K),oe,K),settings:oe}};var props=Object.freeze({__proto__:null,schema:schema$3,format,sanitize,normalize:normalize$a});const _excluded$6=["value","bounds","onDrag"],_excluded2$1=["bounds"],Container=styled("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function IntervalSlider(K){let{value:_,bounds:[Z,te],onDrag:ne}=K,ie=_objectWithoutProperties$1(K,_excluded$6);const oe=reactExports.useRef(null),se=reactExports.useRef(null),ae=reactExports.useRef(null),le=reactExports.useRef(0),ce=useTh("sizes","scrubberWidth"),fe=useDrag(({event:he,first:ge,xy:[me],movement:[Ae],memo:ye={}})=>{if(ge){const{width:_e,left:Te}=oe.current.getBoundingClientRect();le.current=_e-parseFloat(ce);const be=(he==null?void 0:he.target)===se.current||(he==null?void 0:he.target)===ae.current;ye.pos=invertedRange((me-Te)/_e,Z,te);const Re=Math.abs(ye.pos-_.min)-Math.abs(ye.pos-_.max);ye.key=Re<0||Re===0&&ye.pos<=_.min?"min":"max",be&&(ye.pos=_[ye.key])}const ve=ye.pos+invertedRange(Ae/le.current,0,te-Z);return ne({[ye.key]:sanitizeStep(ve,ie[ye.key])}),ye}),de=`calc(${range(_.min,Z,te)} * (100% - ${ce} - 8px) + 4px)`,pe=`calc(${1-range(_.max,Z,te)} * (100% - ${ce} - 8px) + 4px)`;return React.createElement(RangeWrapper,_extends$2({ref:oe},fe()),React.createElement(Range$1,null,React.createElement(Indicator,{style:{left:de,right:pe}})),React.createElement(Scrubber,{position:"left",ref:se,style:{left:de}}),React.createElement(Scrubber,{position:"right",ref:ae,style:{right:pe}}))}function IntervalComponent(){const{label:K,displayValue:_,onUpdate:Z,settings:te}=useInputContext(),ne=_objectWithoutProperties$1(te,_excluded2$1);return React.createElement(React.Fragment,null,React.createElement(Row,{input:!0},React.createElement(Label,null,K),React.createElement(Container,null,React.createElement(IntervalSlider,_extends$2({value:_},te,{onDrag:Z})),React.createElement(Vector,{value:_,settings:ne,onUpdate:Z,innerLabelTrim:0}))))}var interval=_objectSpread2({component:IntervalComponent},props);const createEventEmitter=()=>{const K=new Map;return{on:(_,Z)=>{let te=K.get(_);te===void 0&&(te=new Set,K.set(_,te)),te.add(Z)},off:(_,Z)=>{const te=K.get(_);te!==void 0&&(te.delete(Z),te.size===0&&K.delete(_))},emit:(_,...Z)=>{const te=K.get(_);if(te!==void 0)for(const ne of te)ne(...Z)}}},_excluded$5=["type","value"],_excluded2=["onChange","transient","onEditStart","onEditEnd"],Store$1=function(){const _=create$a(subscribeWithSelector(()=>({data:{}}))),Z=createEventEmitter();this.storeId=getUid(),this.useStore=_;const te={},ne=new Set;this.getVisiblePaths=()=>{const oe=this.getData(),se=Object.keys(oe),ae=[];Object.entries(te).forEach(([ce,fe])=>{fe.render&&se.some(de=>de.indexOf(ce)===0)&&!fe.render(this.get)&&ae.push(ce+".")});const le=[];return ne.forEach(ce=>{ce in oe&&oe[ce].__refCount>0&&ae.every(fe=>ce.indexOf(fe)===-1)&&(!oe[ce].render||oe[ce].render(this.get))&&le.push(ce)}),le},this.setOrderedPaths=oe=>{oe.forEach(se=>ne.add(se))},this.orderPaths=oe=>(this.setOrderedPaths(oe),oe),this.disposePaths=oe=>{_.setState(se=>{const ae=se.data;return oe.forEach(le=>{if(le in ae){const ce=ae[le];ce.__refCount--,ce.__refCount===0&&ce.type in SpecialInputs&&delete ae[le]}}),{data:ae}})},this.dispose=()=>{_.setState(()=>({data:{}}))},this.getFolderSettings=oe=>te[oe]||{},this.getData=()=>_.getState().data,this.addData=(oe,se)=>{_.setState(ae=>{const le=ae.data;return Object.entries(oe).forEach(([ce,fe])=>{let de=le[ce];if(de){const{type:pe,value:he}=fe,ge=_objectWithoutProperties$1(fe,_excluded$5);pe!==de.type?warn(LevaErrors.INPUT_TYPE_OVERRIDE,pe):((de.__refCount===0||se)&&Object.assign(de,ge),de.__refCount++)}else le[ce]=_objectSpread2(_objectSpread2({},fe),{},{__refCount:1})}),{data:le}})},this.setValueAtPath=(oe,se,ae)=>{_.setState(le=>{const ce=le.data;return updateInput(ce[oe],se,oe,this,ae),{data:ce}})},this.setSettingsAtPath=(oe,se)=>{_.setState(ae=>{const le=ae.data;return le[oe].settings=_objectSpread2(_objectSpread2({},le[oe].settings),se),{data:le}})},this.disableInputAtPath=(oe,se)=>{_.setState(ae=>{const le=ae.data;return le[oe].disabled=se,{data:le}})},this.set=(oe,se)=>{_.setState(ae=>{const le=ae.data;return Object.entries(oe).forEach(([ce,fe])=>{try{updateInput(le[ce],fe,void 0,void 0,se)}catch{}}),{data:le}})},this.getInput=oe=>{try{return this.getData()[oe]}catch{warn(LevaErrors.PATH_DOESNT_EXIST,oe)}},this.get=oe=>{var se;return(se=this.getInput(oe))===null||se===void 0?void 0:se.value},this.emitOnEditStart=oe=>{Z.emit(`onEditStart:${oe}`,this.get(oe),oe,_objectSpread2(_objectSpread2({},this.getInput(oe)),{},{get:this.get}))},this.emitOnEditEnd=oe=>{Z.emit(`onEditEnd:${oe}`,this.get(oe),oe,_objectSpread2(_objectSpread2({},this.getInput(oe)),{},{get:this.get}))},this.subscribeToEditStart=(oe,se)=>{const ae=`onEditStart:${oe}`;return Z.on(ae,se),()=>Z.off(ae,se)},this.subscribeToEditEnd=(oe,se)=>{const ae=`onEditEnd:${oe}`;return Z.on(ae,se),()=>Z.off(ae,se)};const ie=(oe,se,ae)=>{const le={};return Object.entries(oe).forEach(([ce,fe])=>{if(ce==="")return warn(LevaErrors.EMPTY_KEY);let de=join$2(se,ce);if(fe.type===SpecialInputs.FOLDER){const pe=ie(fe.schema,de,ae);Object.assign(le,pe),de in te||(te[de]=fe.settings)}else if(ce in ae)warn(LevaErrors.DUPLICATE_KEYS,ce,de,ae[ce].path);else{const pe=normalizeInput(fe,ce,de,le);if(pe){const{type:he,options:ge,input:me}=pe,{onChange:Ae,transient:ye,onEditStart:ve,onEditEnd:_e}=ge,Te=_objectWithoutProperties$1(ge,_excluded2);le[de]=_objectSpread2(_objectSpread2(_objectSpread2({type:he},Te),me),{},{fromPanel:!0}),ae[ce]={path:de,onChange:Ae,transient:ye,onEditStart:ve,onEditEnd:_e}}else warn(LevaErrors.UNKNOWN_INPUT,de,fe)}}),le};this.getDataFromSchema=oe=>{const se={};return[ie(oe,"",se),se]}},levaStore=new Store$1;function useCreateStore(){return reactExports.useMemo(()=>new Store$1,[])}const defaultSettings$2={collapsed:!1};function folder$1(K,_){return{type:SpecialInputs.FOLDER,schema:K,settings:_objectSpread2(_objectSpread2({},defaultSettings$2),_)}}const defaultSettings$1={disabled:!1};function button(K,_){return{type:SpecialInputs.BUTTON,onClick:K,settings:_objectSpread2(_objectSpread2({},defaultSettings$1),_)}}function buttonGroup(K){return{type:SpecialInputs.BUTTON_GROUP,opts:K}}const defaultSettings={graph:!1,interval:100};function monitor(K,_){return{type:SpecialInputs.MONITOR,objectOrFn:K,settings:_objectSpread2(_objectSpread2({},defaultSettings),_)}}const isInput=K=>"__levaInput"in K,buildTree=(K,_)=>{const Z={},te=_?_.toLowerCase():null;return K.forEach(ne=>{const[ie,oe]=getKeyPath(ne);(!te||ie.toLowerCase().indexOf(te)>-1)&&merge$7(Z,oe,{[ie]:{__levaInput:!0,path:ne}})}),Z},_excluded$4=["type","label","path","valueKey","value","settings","setValue","disabled"];function ControlInput(K){let{type:_,label:Z,path:te,valueKey:ne,value:ie,settings:oe,setValue:se,disabled:ae}=K,le=_objectWithoutProperties$1(K,_excluded$4);const{displayValue:ce,onChange:fe,onUpdate:de}=useInputSetters({type:_,value:ie,settings:oe,setValue:se}),pe=Plugins[_].component;return pe?React.createElement(InputContext.Provider,{value:_objectSpread2({key:ne,path:te,id:""+te,label:Z,displayValue:ce,value:ie,onChange:fe,onUpdate:de,settings:oe,setValue:se,disabled:ae},le)},React.createElement(StyledInputWrapper$1,{disabled:ae},React.createElement(pe,null))):(warn(LevaErrors.NO_COMPONENT_FOR_TYPE,_,te),null)}const StyledButton=styled("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function Button$1({onClick:K,settings:_,label:Z}){const te=useStoreContext();return React.createElement(Row,null,React.createElement(StyledButton,{disabled:_.disabled,onClick:()=>K(te.get)},Z))}const StyledButtonGroup=styled("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),StyledButtonGroupButton=styled("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),getOpts=({label:K,opts:_})=>{let Z=typeof K=="string"&&K.trim()===""?null:K,te=_;return typeof _.opts=="object"&&(te.label!==void 0&&(Z=_.label),te=_.opts),{label:Z,opts:te}};function ButtonGroup(K){const{label:_,opts:Z}=getOpts(K),te=useStoreContext();return React.createElement(Row,{input:!!_},_&&React.createElement(Label,null,_),React.createElement(StyledButtonGroup,null,Object.entries(Z).map(([ne,ie])=>React.createElement(StyledButtonGroupButton,{key:ne,onClick:()=>ie(te.get)},ne))))}const Canvas=styled("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),POINTS=100;function push(K,_){K.push(_),K.length>POINTS&&K.shift()}const MonitorCanvas=reactExports.forwardRef(function({initialValue:K},_){const Z=useTh("colors","highlight3"),te=useTh("colors","elevation2"),ne=useTh("colors","highlight1"),[ie,oe]=reactExports.useMemo(()=>[w(ne).alpha(.4).toRgbString(),w(ne).alpha(.1).toRgbString()],[ne]),se=reactExports.useRef([K]),ae=reactExports.useRef(K),le=reactExports.useRef(K),ce=reactExports.useRef(),fe=reactExports.useCallback((he,ge)=>{if(!he)return;const{width:me,height:Ae}=he,ye=new Path2D,ve=me/POINTS,_e=Ae*.05;for(let Re=0;Re<se.current.length;Re++){const we=range(se.current[Re],ae.current,le.current),Pe=ve*Re,Ie=Ae-we*(Ae-_e*2)-_e;ye.lineTo(Pe,Ie)}ge.clearRect(0,0,me,Ae);const Te=new Path2D(ye);Te.lineTo(ve*(se.current.length+1),Ae),Te.lineTo(0,Ae),Te.lineTo(0,0);const be=ge.createLinearGradient(0,0,0,Ae);be.addColorStop(0,ie),be.addColorStop(1,oe),ge.fillStyle=be,ge.fill(Te),ge.strokeStyle=te,ge.lineJoin="round",ge.lineWidth=14,ge.stroke(ye),ge.strokeStyle=Z,ge.lineWidth=2,ge.stroke(ye)},[Z,te,ie,oe]),[de,pe]=useCanvas2d(fe);return reactExports.useImperativeHandle(_,()=>({frame:he=>{(ae.current===void 0||he<ae.current)&&(ae.current=he),(le.current===void 0||he>le.current)&&(le.current=he),push(se.current,he),ce.current=requestAnimationFrame(()=>fe(de.current,pe.current))}}),[de,pe,fe]),reactExports.useEffect(()=>()=>cancelAnimationFrame(ce.current),[]),React.createElement(Canvas,{ref:de})}),parse$a=K=>Number.isFinite(K)?K.toPrecision(2):K.toString(),MonitorLog=reactExports.forwardRef(function({initialValue:K},_){const[Z,te]=reactExports.useState(parse$a(K));return reactExports.useImperativeHandle(_,()=>({frame:ne=>te(parse$a(ne))}),[]),React.createElement("div",null,Z)});function getValue(K){return typeof K=="function"?K():K.current}function Monitor({label:K,objectOrFn:_,settings:Z}){const te=reactExports.useRef(),ne=reactExports.useRef(getValue(_));return reactExports.useEffect(()=>{const ie=window.setInterval(()=>{var oe;document.hidden||(oe=te.current)===null||oe===void 0||oe.frame(getValue(_))},Z.interval);return()=>window.clearInterval(ie)},[_,Z.interval]),React.createElement(Row,{input:!0},React.createElement(Label,{align:"top"},K),Z.graph?React.createElement(MonitorCanvas,{ref:te,initialValue:ne.current}):React.createElement(MonitorLog,{ref:te,initialValue:ne.current}))}const _excluded$3=["type","label","key"],specialComponents={[SpecialInputs.BUTTON]:Button$1,[SpecialInputs.BUTTON_GROUP]:ButtonGroup,[SpecialInputs.MONITOR]:Monitor},Control=React.memo(({path:K})=>{const[_,{set:Z,setSettings:te,disable:ne,storeId:ie,emitOnEditStart:oe,emitOnEditEnd:se}]=useInput(K);if(!_)return null;const{type:ae,label:le,key:ce}=_,fe=_objectWithoutProperties$1(_,_excluded$3);if(ae in SpecialInputs){const de=specialComponents[ae];return React.createElement(de,_extends$2({label:le,path:K},fe))}return ae in Plugins?React.createElement(ControlInput,_extends$2({key:ie+K,type:ae,label:le,storeId:ie,path:K,valueKey:ce,setValue:Z,setSettings:te,disable:ne,emitOnEditStart:oe,emitOnEditEnd:se},fe)):(log(LevaErrors.UNSUPPORTED_INPUT,ae,K),null)});function FolderTitle({toggle:K,toggled:_,name:Z}){return React.createElement(StyledTitle,{onClick:()=>K()},React.createElement(Chevron,{toggled:_}),React.createElement("div",null,Z))}const Folder=({name:K,path:_,tree:Z})=>{const te=useStoreContext(),ne=join$2(_,K),{collapsed:ie,color:oe}=te.getFolderSettings(ne),[se,ae]=reactExports.useState(!ie),le=reactExports.useRef(null),ce=useTh("colors","folderWidgetColor"),fe=useTh("colors","folderTextColor");return reactExports.useLayoutEffect(()=>{le.current.style.setProperty("--leva-colors-folderWidgetColor",oe||ce),le.current.style.setProperty("--leva-colors-folderTextColor",oe||fe)},[oe,ce,fe]),React.createElement(StyledFolder,{ref:le},React.createElement(FolderTitle,{name:K,toggled:se,toggle:()=>ae(de=>!de)}),React.createElement(TreeWrapper,{parent:ne,tree:Z,toggled:se}))},TreeWrapper=React.memo(({isRoot:K=!1,fill:_=!1,flat:Z=!1,parent:te,tree:ne,toggled:ie})=>{const{wrapperRef:oe,contentRef:se}=useToggle(ie),ae=useStoreContext(),le=([fe,de])=>{var pe;return(isInput(de)?(pe=ae.getInput(de.path))===null||pe===void 0?void 0:pe.order:ae.getFolderSettings(join$2(te,fe)).order)||0},ce=Object.entries(ne).sort((fe,de)=>le(fe)-le(de));return React.createElement(StyledWrapper,{ref:oe,isRoot:K,fill:_,flat:Z},React.createElement(StyledContent,{ref:se,isRoot:K,toggled:ie},ce.map(([fe,de])=>isInput(de)?React.createElement(Control,{key:de.path,valueKey:de.valueKey,path:de.path}):React.createElement(Folder,{key:fe,name:fe,path:te,tree:de}))))}),StyledRoot=styled("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${StyledInputRow}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),iconWidth=40,Icon=styled("i",{$flexCenter:"",width:iconWidth,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),StyledTitleWithFilter=styled("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),FilterWrapper=styled("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${Icon}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),StyledFilterInput=styled("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),TitleContainer=styled("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:iconWidth}}}}),FilterInput=React.forwardRef(({setFilter:K,toggle:_},Z)=>{const[te,ne]=reactExports.useState(""),ie=reactExports.useMemo(()=>debounce(K,250),[K]),oe=()=>{K(""),ne("")},se=ae=>{const le=ae.currentTarget.value;_(!0),ne(le)};return reactExports.useEffect(()=>{ie(te)},[te,ie]),React.createElement(React.Fragment,null,React.createElement(StyledFilterInput,{ref:Z,value:te,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:ae=>ae.stopPropagation(),onChange:se}),React.createElement(Icon,{onClick:()=>oe(),style:{visibility:te?"visible":"hidden"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function TitleWithFilter({setFilter:K,onDrag:_,onDragStart:Z,onDragEnd:te,toggle:ne,toggled:ie,title:oe,drag:se,filterEnabled:ae,from:le}){const[ce,fe]=reactExports.useState(!1),de=reactExports.useRef(null);reactExports.useEffect(()=>{var he,ge;ce?(he=de.current)===null||he===void 0||he.focus():(ge=de.current)===null||ge===void 0||ge.blur()},[ce]);const pe=useDrag(({offset:[he,ge],first:me,last:Ae})=>{_({x:he,y:ge}),me&&Z({x:he,y:ge}),Ae&&te({x:he,y:ge})},{filterTaps:!0,from:({offset:[he,ge]})=>[(le==null?void 0:le.x)||he,(le==null?void 0:le.y)||ge]});return reactExports.useEffect(()=>{const he=ge=>{ge.key==="L"&&ge.shiftKey&&ge.metaKey&&fe(me=>!me)};return window.addEventListener("keydown",he),()=>window.removeEventListener("keydown",he)},[]),React.createElement(React.Fragment,null,React.createElement(StyledTitleWithFilter,{mode:se?"drag":void 0},React.createElement(Icon,{active:!ie,onClick:()=>ne()},React.createElement(Chevron,{toggled:ie,width:12,height:8})),React.createElement(TitleContainer,_extends$2({},se?pe():{},{drag:se,filterEnabled:ae}),oe===void 0&&se?React.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},React.createElement("circle",{cx:"2",cy:"2",r:"2"}),React.createElement("circle",{cx:"14",cy:"2",r:"2"}),React.createElement("circle",{cx:"26",cy:"2",r:"2"}),React.createElement("circle",{cx:"2",cy:"12",r:"2"}),React.createElement("circle",{cx:"14",cy:"12",r:"2"}),React.createElement("circle",{cx:"26",cy:"12",r:"2"})):oe),ae&&React.createElement(Icon,{active:ce,onClick:()=>fe(he=>!he)},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},React.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),React.createElement(FilterWrapper,{toggled:ce},React.createElement(FilterInput,{ref:de,setFilter:K,toggle:ne})))}const _excluded$2=["store","hidden","theme","collapsed"];function LevaRoot(K){let{store:_,hidden:Z=!1,theme:te,collapsed:ne=!1}=K,ie=_objectWithoutProperties$1(K,_excluded$2);const oe=useDeepMemo(()=>mergeTheme(te),[te]),[se,ae]=reactExports.useState(!ne),le=typeof ne=="object"?!ne.collapsed:se,ce=reactExports.useMemo(()=>typeof ne=="object"?fe=>{typeof fe=="function"?ne.onChange(!fe(!ne.collapsed)):ne.onChange(!fe)}:ae,[ne]);return!_||Z?null:React.createElement(ThemeContext.Provider,{value:oe},React.createElement(LevaCore,_extends$2({store:_},ie,{toggled:le,setToggle:ce,rootClass:oe.className})))}const LevaCore=React.memo(({store:K,rootClass:_,fill:Z=!1,flat:te=!1,neverHide:ne=!1,oneLineLabels:ie=!1,titleBar:oe={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:se=!1,toggled:ae,setToggle:le})=>{var ce,fe;const de=useVisiblePaths(K),[pe,he]=reactExports.useState(""),ge=reactExports.useMemo(()=>buildTree(de,pe),[de,pe]),[me,Ae]=useTransform(),ye=ne||de.length>0,ve=typeof oe=="object"&&oe.title||void 0,_e=typeof oe=="object"&&(ce=oe.drag)!==null&&ce!==void 0?ce:!0,Te=typeof oe=="object"&&(fe=oe.filter)!==null&&fe!==void 0?fe:!0,be=typeof oe=="object"&&oe.position||void 0,Re=typeof oe=="object"&&oe.onDrag||void 0,we=typeof oe=="object"&&oe.onDragStart||void 0,Pe=typeof oe=="object"&&oe.onDragEnd||void 0;return React.useEffect(()=>{Ae({x:be==null?void 0:be.x,y:be==null?void 0:be.y})},[be,Ae]),globalStyles(),React.createElement(PanelSettingsContext.Provider,{value:{hideCopyButton:se}},React.createElement(StyledRoot,{ref:me,className:_,fill:Z,flat:te,oneLineLabels:ie,hideTitleBar:!oe,style:{display:ye?"block":"none"}},oe&&React.createElement(TitleWithFilter,{onDrag:Ie=>{Ae(Ie),Re==null||Re(Ie)},onDragStart:Ie=>we==null?void 0:we(Ie),onDragEnd:Ie=>Pe==null?void 0:Pe(Ie),setFilter:he,toggle:Ie=>le($e=>Ie??!$e),toggled:ae,title:ve,drag:_e,filterEnabled:Te,from:be}),ye&&React.createElement(StoreContext.Provider,{value:K},React.createElement(TreeWrapper,{isRoot:!0,fill:Z,flat:te,tree:ge,toggled:ae}))))}),_excluded$1=["isRoot"];let rootInitialized=!1,rootEl=null;function Leva(K){let{isRoot:_=!1}=K,Z=_objectWithoutProperties$1(K,_excluded$1);return reactExports.useEffect(()=>(rootInitialized=!0,!_&&rootEl&&(rootEl.remove(),rootEl=null),()=>{_||(rootInitialized=!1)}),[_]),React.createElement(LevaRoot,_extends$2({store:levaStore},Z))}function useRenderRoot(K){reactExports.useEffect(()=>{K&&!rootInitialized&&(rootEl||(rootEl=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(rootEl),createRoot$1(rootEl).render(React.createElement(Leva,{isRoot:!0})))),rootInitialized=!0)},[K])}const _excluded$8=["store"];function LevaPanel(K){let{store:_}=K,Z=_objectWithoutProperties$1(K,_excluded$8);const te=useStoreContext(),ne=_===void 0?te:_;return React.createElement(LevaRoot,_extends$2({store:ne},Z))}function parseArgs(K,_,Z,te,ne){let ie,oe,se,ae,le;return typeof K=="string"?(oe=K,ie=_,Array.isArray(Z)?le=Z:Z&&("store"in Z?(ae=Z,le=te):(se=Z,Array.isArray(te)?le=te:(ae=te,le=ne)))):(ie=K,Array.isArray(_)?le=_:(ae=_,le=Z)),{schema:ie,folderName:oe,folderSettings:se,hookSettings:ae,deps:le||[]}}function useControls(K,_,Z,te,ne){const{folderName:ie,schema:oe,folderSettings:se,hookSettings:ae,deps:le}=parseArgs(K,_,Z,te,ne),ce=typeof oe=="function",fe=reactExports.useRef(!1),de=reactExports.useRef(!0),pe=useDeepMemo(()=>{fe.current=!0;const $e=typeof oe=="function"?oe():oe;return ie?{[ie]:folder$1($e,se)}:$e},le),he=!(ae!=null&&ae.store);useRenderRoot(he);const[ge]=reactExports.useState(()=>(ae==null?void 0:ae.store)||levaStore),[me,Ae]=reactExports.useMemo(()=>ge.getDataFromSchema(pe),[ge,pe]),[ye,ve,_e,Te,be]=reactExports.useMemo(()=>{const $e=[],Ue=[],ke={},Ge={},He={};return Object.values(Ae).forEach(({path:ze,onChange:Ke,onEditStart:tt,onEditEnd:Je,transient:ot})=>{$e.push(ze),Ke?(ke[ze]=Ke,ot||Ue.push(ze)):Ue.push(ze),tt&&(Ge[ze]=tt),Je&&(He[ze]=Je)}),[$e,Ue,ke,Ge,He]},[Ae]),Re=reactExports.useMemo(()=>ge.orderPaths(ye),[ye,ge]),we=useValuesForPath(ge,ve,me),Pe=reactExports.useCallback($e=>{const Ue=Object.entries($e).reduce((ke,[Ge,He])=>Object.assign(ke,{[Ae[Ge].path]:He}),{});ge.set(Ue,!1)},[ge,Ae]),Ie=reactExports.useCallback($e=>ge.get(Ae[$e].path),[ge,Ae]);return reactExports.useEffect(()=>{const $e=!de.current&&fe.current;return ge.addData(me,$e),de.current=!1,fe.current=!1,()=>ge.disposePaths(Re)},[ge,Re,me]),reactExports.useEffect(()=>{const $e=[];return Object.entries(_e).forEach(([Ue,ke])=>{ke(ge.get(Ue),Ue,_objectSpread2({initial:!0,get:ge.get},ge.getInput(Ue)));const Ge=ge.useStore.subscribe(He=>{const ze=He.data[Ue];return[ze.disabled?void 0:ze.value,ze]},([He,ze])=>ke(He,Ue,_objectSpread2({initial:!1,get:ge.get},ze)),{equalityFn:shallow$8});$e.push(Ge)}),()=>$e.forEach(Ue=>Ue())},[ge,_e]),reactExports.useEffect(()=>{const $e=[];return Object.entries(Te).forEach(([Ue,ke])=>$e.push(ge.subscribeToEditStart(Ue,ke))),Object.entries(be).forEach(([Ue,ke])=>$e.push(ge.subscribeToEditEnd(Ue,ke))),()=>$e.forEach(Ue=>Ue())},[Te,be,ge]),ce?[we,Pe,Ie]:we}register(LevaInputs.SELECT,select);register(LevaInputs.IMAGE,image$1);register(LevaInputs.NUMBER,number$6);register(LevaInputs.COLOR,color$3);register(LevaInputs.STRING,string$2);register(LevaInputs.BOOLEAN,boolean$4);register(LevaInputs.INTERVAL,interval);register(LevaInputs.VECTOR3D,vector3d);register(LevaInputs.VECTOR2D,vector2d);const LEVA=Object.freeze(Object.defineProperty({__proto__:null,Leva,get LevaInputs(){return LevaInputs},LevaPanel,LevaStoreProvider,button,buttonGroup,folder:folder$1,levaStore,monitor,useControls,useCreateStore,useStoreContext},Symbol.toStringTag,{value:"Module"}));var dist$1={},useWebsocket={},constants$3={};(function(K){Object.defineProperty(K,"__esModule",{value:!0}),K.isEventSourceSupported=K.isReactNative=K.ReadyState=K.DEFAULT_HEARTBEAT=K.UNPARSABLE_JSON_OBJECT=K.DEFAULT_RECONNECT_INTERVAL_MS=K.DEFAULT_RECONNECT_LIMIT=K.SOCKET_IO_PING_CODE=K.SOCKET_IO_PATH=K.SOCKET_IO_PING_INTERVAL=K.DEFAULT_EVENT_SOURCE_OPTIONS=K.EMPTY_EVENT_HANDLERS=K.DEFAULT_OPTIONS=void 0;var _=1,Z=1e3*_;K.DEFAULT_OPTIONS={},K.EMPTY_EVENT_HANDLERS={},K.DEFAULT_EVENT_SOURCE_OPTIONS={withCredentials:!1,events:K.EMPTY_EVENT_HANDLERS},K.SOCKET_IO_PING_INTERVAL=25*Z,K.SOCKET_IO_PATH="/socket.io/?EIO=3&transport=websocket",K.SOCKET_IO_PING_CODE="2",K.DEFAULT_RECONNECT_LIMIT=20,K.DEFAULT_RECONNECT_INTERVAL_MS=5e3,K.UNPARSABLE_JSON_OBJECT={},K.DEFAULT_HEARTBEAT={message:"ping",timeout:6e4,interval:25e3};var te;(function(ie){ie[ie.UNINSTANTIATED=-1]="UNINSTANTIATED",ie[ie.CONNECTING=0]="CONNECTING",ie[ie.OPEN=1]="OPEN",ie[ie.CLOSING=2]="CLOSING",ie[ie.CLOSED=3]="CLOSED"})(te||(K.ReadyState=te={}));var ne=function(){try{return"EventSource"in globalThis}catch{return!1}};K.isReactNative=typeof navigator<"u"&&navigator.product==="ReactNative",K.isEventSourceSupported=!K.isReactNative&&ne()})(constants$3);var createOrJoin={},globals={};(function(K){Object.defineProperty(K,"__esModule",{value:!0}),K.resetWebSockets=K.sharedWebSockets=void 0,K.sharedWebSockets={};var _=function(Z){if(Z&&K.sharedWebSockets.hasOwnProperty(Z))delete K.sharedWebSockets[Z];else for(var te in K.sharedWebSockets)K.sharedWebSockets.hasOwnProperty(te)&&delete K.sharedWebSockets[te]};K.resetWebSockets=_})(globals);var attachListener={},socketIo={};Object.defineProperty(socketIo,"__esModule",{value:!0});socketIo.setUpSocketIOPing=socketIo.appendQueryParams=socketIo.parseSocketIOUrl=void 0;var constants_1$7=constants$3,parseSocketIOUrl=function(K){if(K){var _=/^https|wss/.test(K),Z=K.replace(/^(https?|wss?)(:\/\/)?/,""),te=Z.replace(/\/$/,""),ne=_?"wss":"ws";return"".concat(ne,"://").concat(te).concat(constants_1$7.SOCKET_IO_PATH)}else if(K===""){var _=/^https/.test(window.location.protocol),ne=_?"wss":"ws",ie=window.location.port?":".concat(window.location.port):"";return"".concat(ne,"://").concat(window.location.hostname).concat(ie).concat(constants_1$7.SOCKET_IO_PATH)}return K};socketIo.parseSocketIOUrl=parseSocketIOUrl;var appendQueryParams=function(K,_){_===void 0&&(_={});var Z=/\?([\w]+=[\w]+)/,te=Z.test(K),ne="".concat(Object.entries(_).reduce(function(ie,oe){var se=oe[0],ae=oe[1];return ie+"".concat(se,"=").concat(ae,"&")},"").slice(0,-1));return"".concat(K).concat(te?"&":"?").concat(ne)};socketIo.appendQueryParams=appendQueryParams;var setUpSocketIOPing=function(K,_){_===void 0&&(_=constants_1$7.SOCKET_IO_PING_INTERVAL);var Z=function(){return K(constants_1$7.SOCKET_IO_PING_CODE)};return window.setInterval(Z,_)};socketIo.setUpSocketIOPing=setUpSocketIOPing;var heartbeat$1={};Object.defineProperty(heartbeat$1,"__esModule",{value:!0});heartbeat$1.heartbeat=heartbeat;var constants_1$6=constants$3;function getLastMessageTime(K){return Array.isArray(K)?K.reduce(function(_,Z){return _.current>Z.current?_:Z}).current:K.current}function heartbeat(K,_,Z){var te=Z||{},ne=te.interval,ie=ne===void 0?constants_1$6.DEFAULT_HEARTBEAT.interval:ne,oe=te.timeout,se=oe===void 0?constants_1$6.DEFAULT_HEARTBEAT.timeout:oe,ae=te.message,le=ae===void 0?constants_1$6.DEFAULT_HEARTBEAT.message:ae,ce=Math.max(100,ie/10),fe=Date.now(),de=setInterval(function(){var pe=Date.now(),he=getLastMessageTime(_);if(he+se<=pe)console.warn("Heartbeat timed out, closing connection, last message received ".concat(pe-he,"ms ago, last ping sent ").concat(pe-fe,"ms ago")),K.close();else if(he+ie<=pe&&fe+ie<=pe)try{typeof le=="function"?K.send(le()):K.send(le),fe=pe}catch(ge){console.error("Heartbeat failed, closing connection",ge instanceof Error?ge.message:ge),K.close()}},ce);return K.addEventListener("close",function(){clearInterval(de)}),function(){}}var util={},manageSubscribers={};(function(K){Object.defineProperty(K,"__esModule",{value:!0}),K.resetSubscribers=K.removeSubscriber=K.addSubscriber=K.hasSubscribers=K.getSubscribers=void 0;var _={},Z=[],te=function(ae){return(0,K.hasSubscribers)(ae)?Array.from(_[ae]):Z};K.getSubscribers=te;var ne=function(ae){var le;return((le=_[ae])===null||le===void 0?void 0:le.size)>0};K.hasSubscribers=ne;var ie=function(ae,le){_[ae]=_[ae]||new Set,_[ae].add(le)};K.addSubscriber=ie;var oe=function(ae,le){_[ae].delete(le)};K.removeSubscriber=oe;var se=function(ae){if(ae&&_.hasOwnProperty(ae))delete _[ae];else for(var le in _)_.hasOwnProperty(le)&&delete _[le]};K.resetSubscribers=se})(manageSubscribers);Object.defineProperty(util,"__esModule",{value:!0});util.assertIsWebSocket=assertIsWebSocket;util.resetGlobalState=resetGlobalState;var globals_1$2=globals,manage_subscribers_1$2=manageSubscribers;function assertIsWebSocket(K,_){if(!_&&!(K instanceof WebSocket))throw new Error("")}function resetGlobalState(K){(0,manage_subscribers_1$2.resetSubscribers)(K),(0,globals_1$2.resetWebSockets)(K)}var __assign$4=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign$4=Object.assign||function(K){for(var _,Z=1,te=arguments.length;Z<te;Z++){_=arguments[Z];for(var ne in _)Object.prototype.hasOwnProperty.call(_,ne)&&(K[ne]=_[ne])}return K},__assign$4.apply(this,arguments)};Object.defineProperty(attachListener,"__esModule",{value:!0});attachListener.attachListeners=void 0;var socket_io_1$1=socketIo,heartbeat_1$1=heartbeat$1,constants_1$5=constants$3,util_1$1=util,bindMessageHandler$1=function(K,_,Z,te){K.onmessage=function(ne){var ie;_.current.onMessage&&_.current.onMessage(ne),typeof(te==null?void 0:te.current)=="number"&&(te.current=Date.now()),!(typeof _.current.filter=="function"&&_.current.filter(ne)!==!0)&&(_.current.heartbeat&&typeof _.current.heartbeat!="boolean"&&((ie=_.current.heartbeat)===null||ie===void 0?void 0:ie.returnMessage)===ne.data||Z(ne))}},bindOpenHandler$1=function(K,_,Z,te,ne){K.onopen=function(ie){if(_.current.onOpen&&_.current.onOpen(ie),te.current=0,Z(constants_1$5.ReadyState.OPEN),_.current.heartbeat&&K instanceof WebSocket){var oe=typeof _.current.heartbeat=="boolean"?void 0:_.current.heartbeat;ne.current=Date.now(),(0,heartbeat_1$1.heartbeat)(K,ne,oe)}}},bindCloseHandler$1=function(K,_,Z,te,ne){if(constants_1$5.isEventSourceSupported&&K instanceof EventSource)return function(){};(0,util_1$1.assertIsWebSocket)(K,_.current.skipAssert);var ie;return K.onclose=function(oe){var se;if(_.current.onClose&&_.current.onClose(oe),Z(constants_1$5.ReadyState.CLOSED),_.current.shouldReconnect&&_.current.shouldReconnect(oe)){var ae=(se=_.current.reconnectAttempts)!==null&&se!==void 0?se:constants_1$5.DEFAULT_RECONNECT_LIMIT;if(ne.current<ae){var le=typeof _.current.reconnectInterval=="function"?_.current.reconnectInterval(ne.current):_.current.reconnectInterval;ie=window.setTimeout(function(){ne.current++,te()},le??constants_1$5.DEFAULT_RECONNECT_INTERVAL_MS)}else _.current.onReconnectStop&&_.current.onReconnectStop(ae),console.warn("Max reconnect attempts of ".concat(ae," exceeded"))}},function(){return ie&&window.clearTimeout(ie)}},bindErrorHandler$1=function(K,_,Z,te,ne){var ie;return K.onerror=function(oe){var se;if(_.current.onError&&_.current.onError(oe),constants_1$5.isEventSourceSupported&&K instanceof EventSource&&(_.current.onClose&&_.current.onClose(__assign$4(__assign$4({},oe),{code:1006,reason:"An error occurred with the EventSource: ".concat(oe),wasClean:!1})),Z(constants_1$5.ReadyState.CLOSED),K.close()),_.current.retryOnError)if(ne.current<((se=_.current.reconnectAttempts)!==null&&se!==void 0?se:constants_1$5.DEFAULT_RECONNECT_LIMIT)){var ae=typeof _.current.reconnectInterval=="function"?_.current.reconnectInterval(ne.current):_.current.reconnectInterval;ie=window.setTimeout(function(){ne.current++,te()},ae??constants_1$5.DEFAULT_RECONNECT_INTERVAL_MS)}else _.current.onReconnectStop&&_.current.onReconnectStop(_.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(_.current.reconnectAttempts," exceeded"))},function(){return ie&&window.clearTimeout(ie)}},attachListeners=function(K,_,Z,te,ne,ie,oe){var se=_.setLastMessage,ae=_.setReadyState,le,ce,fe;return Z.current.fromSocketIO&&(le=(0,socket_io_1$1.setUpSocketIOPing)(oe)),bindMessageHandler$1(K,Z,se,ie),bindOpenHandler$1(K,Z,ae,ne,ie),ce=bindCloseHandler$1(K,Z,ae,te,ne),fe=bindErrorHandler$1(K,Z,ae,te,ne),function(){ae(constants_1$5.ReadyState.CLOSING),ce(),fe(),K.close(),le&&clearInterval(le)}};attachListener.attachListeners=attachListeners;var attachSharedListeners$1={},__assign$3=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign$3=Object.assign||function(K){for(var _,Z=1,te=arguments.length;Z<te;Z++){_=arguments[Z];for(var ne in _)Object.prototype.hasOwnProperty.call(_,ne)&&(K[ne]=_[ne])}return K},__assign$3.apply(this,arguments)};Object.defineProperty(attachSharedListeners$1,"__esModule",{value:!0});attachSharedListeners$1.attachSharedListeners=void 0;var globals_1$1=globals,constants_1$4=constants$3,manage_subscribers_1$1=manageSubscribers,socket_io_1=socketIo,heartbeat_1=heartbeat$1,bindMessageHandler=function(K,_,Z){K.onmessage=function(te){(0,manage_subscribers_1$1.getSubscribers)(_).forEach(function(ne){var ie;ne.optionsRef.current.onMessage&&ne.optionsRef.current.onMessage(te),typeof((ie=ne==null?void 0:ne.lastMessageTime)===null||ie===void 0?void 0:ie.current)=="number"&&(ne.lastMessageTime.current=Date.now()),!(typeof ne.optionsRef.current.filter=="function"&&ne.optionsRef.current.filter(te)!==!0)&&(Z&&typeof Z!="boolean"&&(Z==null?void 0:Z.returnMessage)===te.data||ne.setLastMessage(te))})}},bindOpenHandler=function(K,_,Z){K.onopen=function(te){var ne=(0,manage_subscribers_1$1.getSubscribers)(_);ne.forEach(function(ie){ie.reconnectCount.current=0,ie.optionsRef.current.onOpen&&ie.optionsRef.current.onOpen(te),ie.setReadyState(constants_1$4.ReadyState.OPEN),Z&&K instanceof WebSocket&&(ie.lastMessageTime.current=Date.now())}),Z&&K instanceof WebSocket&&(0,heartbeat_1.heartbeat)(K,ne.map(function(ie){return ie.lastMessageTime}),typeof Z=="boolean"?void 0:Z)}},bindCloseHandler=function(K,_){K instanceof WebSocket&&(K.onclose=function(Z){(0,manage_subscribers_1$1.getSubscribers)(_).forEach(function(te){te.optionsRef.current.onClose&&te.optionsRef.current.onClose(Z),te.setReadyState(constants_1$4.ReadyState.CLOSED)}),delete globals_1$1.sharedWebSockets[_],(0,manage_subscribers_1$1.getSubscribers)(_).forEach(function(te){var ne;if(te.optionsRef.current.shouldReconnect&&te.optionsRef.current.shouldReconnect(Z)){var ie=(ne=te.optionsRef.current.reconnectAttempts)!==null&&ne!==void 0?ne:constants_1$4.DEFAULT_RECONNECT_LIMIT;if(te.reconnectCount.current<ie){var oe=typeof te.optionsRef.current.reconnectInterval=="function"?te.optionsRef.current.reconnectInterval(te.reconnectCount.current):te.optionsRef.current.reconnectInterval;setTimeout(function(){te.reconnectCount.current++,te.reconnect.current()},oe??constants_1$4.DEFAULT_RECONNECT_INTERVAL_MS)}else te.optionsRef.current.onReconnectStop&&te.optionsRef.current.onReconnectStop(te.optionsRef.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(ie," exceeded"))}})})},bindErrorHandler=function(K,_){K.onerror=function(Z){(0,manage_subscribers_1$1.getSubscribers)(_).forEach(function(te){te.optionsRef.current.onError&&te.optionsRef.current.onError(Z),constants_1$4.isEventSourceSupported&&K instanceof EventSource&&(te.optionsRef.current.onClose&&te.optionsRef.current.onClose(__assign$3(__assign$3({},Z),{code:1006,reason:"An error occurred with the EventSource: ".concat(Z),wasClean:!1})),te.setReadyState(constants_1$4.ReadyState.CLOSED))}),constants_1$4.isEventSourceSupported&&K instanceof EventSource&&K.close()}},attachSharedListeners=function(K,_,Z,te){var ne;return Z.current.fromSocketIO&&(ne=(0,socket_io_1.setUpSocketIOPing)(te)),bindMessageHandler(K,_,Z.current.heartbeat),bindCloseHandler(K,_),bindOpenHandler(K,_,Z.current.heartbeat),bindErrorHandler(K,_),function(){ne&&clearInterval(ne)}};attachSharedListeners$1.attachSharedListeners=attachSharedListeners;Object.defineProperty(createOrJoin,"__esModule",{value:!0});createOrJoin.createOrJoinSocket=void 0;var globals_1=globals,constants_1$3=constants$3,attach_listener_1=attachListener,attach_shared_listeners_1=attachSharedListeners$1,manage_subscribers_1=manageSubscribers,cleanSubscribers=function(K,_,Z,te,ne){return function(){if((0,manage_subscribers_1.removeSubscriber)(K,_),!(0,manage_subscribers_1.hasSubscribers)(K)){try{var ie=globals_1.sharedWebSockets[K];ie instanceof WebSocket&&(ie.onclose=function(oe){Z.current.onClose&&Z.current.onClose(oe),te(constants_1$3.ReadyState.CLOSED)}),ie.close()}catch{}ne&&ne(),delete globals_1.sharedWebSockets[K]}}},createOrJoinSocket=function(K,_,Z,te,ne,ie,oe,se,ae){if(!constants_1$3.isEventSourceSupported&&te.current.eventSourceOptions)throw constants_1$3.isReactNative?new Error("EventSource is not supported in ReactNative"):new Error("EventSource is not supported");if(te.current.share){var le=null;globals_1.sharedWebSockets[_]===void 0?(globals_1.sharedWebSockets[_]=te.current.eventSourceOptions?new EventSource(_,te.current.eventSourceOptions):new WebSocket(_,te.current.protocols),K.current=globals_1.sharedWebSockets[_],Z(constants_1$3.ReadyState.CONNECTING),le=(0,attach_shared_listeners_1.attachSharedListeners)(globals_1.sharedWebSockets[_],_,te,ae)):(K.current=globals_1.sharedWebSockets[_],Z(globals_1.sharedWebSockets[_].readyState));var ce={setLastMessage:ne,setReadyState:Z,optionsRef:te,reconnectCount:oe,lastMessageTime:se,reconnect:ie};return(0,manage_subscribers_1.addSubscriber)(_,ce),cleanSubscribers(_,ce,te,Z,le)}else{if(K.current=te.current.eventSourceOptions?new EventSource(_,te.current.eventSourceOptions):new WebSocket(_,te.current.protocols),Z(constants_1$3.ReadyState.CONNECTING),!K.current)throw new Error("WebSocket failed to be created");return(0,attach_listener_1.attachListeners)(K.current,{setLastMessage:ne,setReadyState:Z},te,ie.current,oe,se,ae)}};createOrJoin.createOrJoinSocket=createOrJoinSocket;var getUrl={};(function(K){var _=commonjsGlobal&&commonjsGlobal.__awaiter||function(ae,le,ce,fe){function de(pe){return pe instanceof ce?pe:new ce(function(he){he(pe)})}return new(ce||(ce=Promise))(function(pe,he){function ge(ye){try{Ae(fe.next(ye))}catch(ve){he(ve)}}function me(ye){try{Ae(fe.throw(ye))}catch(ve){he(ve)}}function Ae(ye){ye.done?pe(ye.value):de(ye.value).then(ge,me)}Ae((fe=fe.apply(ae,le||[])).next())})},Z=commonjsGlobal&&commonjsGlobal.__generator||function(ae,le){var ce={label:0,sent:function(){if(pe[0]&1)throw pe[1];return pe[1]},trys:[],ops:[]},fe,de,pe,he=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return he.next=ge(0),he.throw=ge(1),he.return=ge(2),typeof Symbol=="function"&&(he[Symbol.iterator]=function(){return this}),he;function ge(Ae){return function(ye){return me([Ae,ye])}}function me(Ae){if(fe)throw new TypeError("Generator is already executing.");for(;he&&(he=0,Ae[0]&&(ce=0)),ce;)try{if(fe=1,de&&(pe=Ae[0]&2?de.return:Ae[0]?de.throw||((pe=de.return)&&pe.call(de),0):de.next)&&!(pe=pe.call(de,Ae[1])).done)return pe;switch(de=0,pe&&(Ae=[Ae[0]&2,pe.value]),Ae[0]){case 0:case 1:pe=Ae;break;case 4:return ce.label++,{value:Ae[1],done:!1};case 5:ce.label++,de=Ae[1],Ae=[0];continue;case 7:Ae=ce.ops.pop(),ce.trys.pop();continue;default:if(pe=ce.trys,!(pe=pe.length>0&&pe[pe.length-1])&&(Ae[0]===6||Ae[0]===2)){ce=0;continue}if(Ae[0]===3&&(!pe||Ae[1]>pe[0]&&Ae[1]<pe[3])){ce.label=Ae[1];break}if(Ae[0]===6&&ce.label<pe[1]){ce.label=pe[1],pe=Ae;break}if(pe&&ce.label<pe[2]){ce.label=pe[2],ce.ops.push(Ae);break}pe[2]&&ce.ops.pop(),ce.trys.pop();continue}Ae=le.call(ae,ce)}catch(ye){Ae=[6,ye],de=0}finally{fe=pe=0}if(Ae[0]&5)throw Ae[1];return{value:Ae[0]?Ae[1]:void 0,done:!0}}},te=commonjsGlobal&&commonjsGlobal.__spreadArray||function(ae,le,ce){if(ce||arguments.length===2)for(var fe=0,de=le.length,pe;fe<de;fe++)(pe||!(fe in le))&&(pe||(pe=Array.prototype.slice.call(le,0,fe)),pe[fe]=le[fe]);return ae.concat(pe||Array.prototype.slice.call(le))};Object.defineProperty(K,"__esModule",{value:!0}),K.getUrl=void 0;var ne=socketIo,ie=constants$3,oe=function(ae){return new Promise(function(le){return window.setTimeout(le,ae)})},se=function(ae,le){for(var ce=[],fe=2;fe<arguments.length;fe++)ce[fe-2]=arguments[fe];return _(void 0,te([ae,le],ce,!0),void 0,function(de,pe,he){var ge,me,Ae,ye,ve,_e,Te,be;return he===void 0&&(he=0),Z(this,function(Re){switch(Re.label){case 0:if(typeof de!="function")return[3,10];Re.label=1;case 1:return Re.trys.push([1,3,,9]),[4,de()];case 2:return ge=Re.sent(),[3,9];case 3:return Re.sent(),pe.current.retryOnError?(me=(_e=pe.current.reconnectAttempts)!==null&&_e!==void 0?_e:ie.DEFAULT_RECONNECT_LIMIT,he<me?(Ae=typeof pe.current.reconnectInterval=="function"?pe.current.reconnectInterval(he):pe.current.reconnectInterval,[4,oe(Ae??ie.DEFAULT_RECONNECT_INTERVAL_MS)]):[3,5]):[3,7];case 4:return Re.sent(),[2,(0,K.getUrl)(de,pe,he+1)];case 5:return(be=(Te=pe.current).onReconnectStop)===null||be===void 0||be.call(Te,he),[2,null];case 6:return[3,8];case 7:return[2,null];case 8:return[3,9];case 9:return[3,11];case 10:ge=de,Re.label=11;case 11:return ye=pe.current.fromSocketIO?(0,ne.parseSocketIOUrl)(ge):ge,ve=pe.current.queryParams?(0,ne.appendQueryParams)(ye,pe.current.queryParams):ye,[2,ve]}})})};K.getUrl=se})(getUrl);var proxy={};(function(K){Object.defineProperty(K,"__esModule",{value:!0}),K.websocketWrapper=void 0;var _=function(Z,te){return new Proxy(Z,{get:function(ne,ie){var oe=ne[ie];return ie==="reconnect"?te:typeof oe=="function"?(console.error("Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket."),function(){}):oe},set:function(ne,ie,oe){return/^on/.test(ie)?(console.warn("The websocket's event handlers should be defined through the options object passed into useWebSocket."),!1):(ne[ie]=oe,!0)}})};K.websocketWrapper=_,K.default=K.websocketWrapper})(proxy);var __assign$2=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign$2=Object.assign||function(K){for(var _,Z=1,te=arguments.length;Z<te;Z++){_=arguments[Z];for(var ne in _)Object.prototype.hasOwnProperty.call(_,ne)&&(K[ne]=_[ne])}return K},__assign$2.apply(this,arguments)},__awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(K,_,Z,te){function ne(ie){return ie instanceof Z?ie:new Z(function(oe){oe(ie)})}return new(Z||(Z=Promise))(function(ie,oe){function se(ce){try{le(te.next(ce))}catch(fe){oe(fe)}}function ae(ce){try{le(te.throw(ce))}catch(fe){oe(fe)}}function le(ce){ce.done?ie(ce.value):ne(ce.value).then(se,ae)}le((te=te.apply(K,_||[])).next())})},__generator=commonjsGlobal&&commonjsGlobal.__generator||function(K,_){var Z={label:0,sent:function(){if(ie[0]&1)throw ie[1];return ie[1]},trys:[],ops:[]},te,ne,ie,oe=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return oe.next=se(0),oe.throw=se(1),oe.return=se(2),typeof Symbol=="function"&&(oe[Symbol.iterator]=function(){return this}),oe;function se(le){return function(ce){return ae([le,ce])}}function ae(le){if(te)throw new TypeError("Generator is already executing.");for(;oe&&(oe=0,le[0]&&(Z=0)),Z;)try{if(te=1,ne&&(ie=le[0]&2?ne.return:le[0]?ne.throw||((ie=ne.return)&&ie.call(ne),0):ne.next)&&!(ie=ie.call(ne,le[1])).done)return ie;switch(ne=0,ie&&(le=[le[0]&2,ie.value]),le[0]){case 0:case 1:ie=le;break;case 4:return Z.label++,{value:le[1],done:!1};case 5:Z.label++,ne=le[1],le=[0];continue;case 7:le=Z.ops.pop(),Z.trys.pop();continue;default:if(ie=Z.trys,!(ie=ie.length>0&&ie[ie.length-1])&&(le[0]===6||le[0]===2)){Z=0;continue}if(le[0]===3&&(!ie||le[1]>ie[0]&&le[1]<ie[3])){Z.label=le[1];break}if(le[0]===6&&Z.label<ie[1]){Z.label=ie[1],ie=le;break}if(ie&&Z.label<ie[2]){Z.label=ie[2],Z.ops.push(le);break}ie[2]&&Z.ops.pop(),Z.trys.pop();continue}le=_.call(K,Z)}catch(ce){le=[6,ce],ne=0}finally{te=ie=0}if(le[0]&5)throw le[1];return{value:le[0]?le[1]:void 0,done:!0}}},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(K){return K&&K.__esModule?K:{default:K}};Object.defineProperty(useWebsocket,"__esModule",{value:!0});useWebsocket.useWebSocket=void 0;var react_1$2=reactExports,react_dom_1=reactDomExports,constants_1$2=constants$3,create_or_join_1=createOrJoin,get_url_1=getUrl,proxy_1=__importDefault(proxy),util_1=util,useWebSocket$1=function(K,_,Z){_===void 0&&(_=constants_1$2.DEFAULT_OPTIONS),Z===void 0&&(Z=!0);var te=(0,react_1$2.useState)(null),ne=te[0],ie=te[1],oe=(0,react_1$2.useState)({}),se=oe[0],ae=oe[1],le=(0,react_1$2.useMemo)(function(){if(!_.disableJson&&ne)try{return JSON.parse(ne.data)}catch{return constants_1$2.UNPARSABLE_JSON_OBJECT}return null},[ne,_.disableJson]),ce=(0,react_1$2.useRef)(null),fe=(0,react_1$2.useRef)(null),de=(0,react_1$2.useRef)(function(){}),pe=(0,react_1$2.useRef)(0),he=(0,react_1$2.useRef)(Date.now()),ge=(0,react_1$2.useRef)([]),me=(0,react_1$2.useRef)(null),Ae=(0,react_1$2.useRef)(_);Ae.current=_;var ye=ce.current&&se[ce.current]!==void 0?se[ce.current]:K!==null&&Z===!0?constants_1$2.ReadyState.CONNECTING:constants_1$2.ReadyState.UNINSTANTIATED,ve=_.queryParams?JSON.stringify(_.queryParams):null,_e=(0,react_1$2.useCallback)(function(Re,we){var Pe;if(we===void 0&&(we=!0),constants_1$2.isEventSourceSupported&&fe.current instanceof EventSource){console.warn("Unable to send a message from an eventSource");return}((Pe=fe.current)===null||Pe===void 0?void 0:Pe.readyState)===constants_1$2.ReadyState.OPEN?((0,util_1.assertIsWebSocket)(fe.current,Ae.current.skipAssert),fe.current.send(Re)):we&&ge.current.push(Re)},[]),Te=(0,react_1$2.useCallback)(function(Re,we){we===void 0&&(we=!0),_e(JSON.stringify(Re),we)},[_e]),be=(0,react_1$2.useCallback)(function(){return Ae.current.share!==!0||constants_1$2.isEventSourceSupported&&fe.current instanceof EventSource?fe.current:(me.current===null&&fe.current&&((0,util_1.assertIsWebSocket)(fe.current,Ae.current.skipAssert),me.current=(0,proxy_1.default)(fe.current,de)),me.current)},[]);return(0,react_1$2.useEffect)(function(){if(K!==null&&Z===!0){var Re,we=!1,Pe=!0,Ie=function(){return __awaiter(void 0,void 0,void 0,function(){var $e,Ue,ke;return __generator(this,function(Ge){switch(Ge.label){case 0:return $e=ce,[4,(0,get_url_1.getUrl)(K,Ae)];case 1:return $e.current=Ge.sent(),ce.current===null?(console.error("Failed to get a valid URL. WebSocket connection aborted."),ce.current="ABORTED",(0,react_dom_1.flushSync)(function(){return ae(function(He){return __assign$2(__assign$2({},He),{ABORTED:constants_1$2.ReadyState.CLOSED})})}),[2]):(Ue=function(He){we||(0,react_dom_1.flushSync)(function(){return ie(He)})},ke=function(He){we||(0,react_dom_1.flushSync)(function(){return ae(function(ze){var Ke;return __assign$2(__assign$2({},ze),ce.current&&(Ke={},Ke[ce.current]=He,Ke))})})},Pe&&(Re=(0,create_or_join_1.createOrJoinSocket)(fe,ce.current,ke,Ae,Ue,de,pe,he,_e)),[2])}})})};return de.current=function(){we||(me.current&&(me.current=null),Re==null||Re(),Ie())},Ie(),function(){we=!0,Pe=!1,me.current&&(me.current=null),Re==null||Re(),ie(null)}}else(K===null||Z===!1)&&(pe.current=0,ae(function($e){var Ue;return __assign$2(__assign$2({},$e),ce.current&&(Ue={},Ue[ce.current]=constants_1$2.ReadyState.CLOSED,Ue))}))},[K,Z,ve,_e]),(0,react_1$2.useEffect)(function(){ye===constants_1$2.ReadyState.OPEN&&ge.current.splice(0).forEach(function(Re){_e(Re)})},[ye]),{sendMessage:_e,sendJsonMessage:Te,lastMessage:ne,lastJsonMessage:le,readyState:ye,getWebSocket:be}};useWebsocket.useWebSocket=useWebSocket$1;var useSocketIo={},__assign$1=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign$1=Object.assign||function(K){for(var _,Z=1,te=arguments.length;Z<te;Z++){_=arguments[Z];for(var ne in _)Object.prototype.hasOwnProperty.call(_,ne)&&(K[ne]=_[ne])}return K},__assign$1.apply(this,arguments)};Object.defineProperty(useSocketIo,"__esModule",{value:!0});useSocketIo.useSocketIO=void 0;var react_1$1=reactExports,use_websocket_1$1=useWebsocket,constants_1$1=constants$3,emptyEvent={type:"empty",payload:null},getSocketData=function(K){if(!K||!K.data)return emptyEvent;var _=K.data.match(/\[.*]/);if(!_)return emptyEvent;var Z=JSON.parse(_);return!Array.isArray(Z)||!Z[1]?emptyEvent:{type:Z[0],payload:Z[1]}},useSocketIO=function(K,_,Z){_===void 0&&(_=constants_1$1.DEFAULT_OPTIONS),Z===void 0&&(Z=!0);var te=(0,react_1$1.useMemo)(function(){return __assign$1(__assign$1({},_),{fromSocketIO:!0})},[]),ne=(0,use_websocket_1$1.useWebSocket)(K,te,Z),ie=ne.sendMessage,oe=ne.sendJsonMessage,se=ne.lastMessage,ae=ne.readyState,le=ne.getWebSocket,ce=(0,react_1$1.useMemo)(function(){return getSocketData(se)},[se]);return{sendMessage:ie,sendJsonMessage:oe,lastMessage:ce,lastJsonMessage:ce,readyState:ae,getWebSocket:le}};useSocketIo.useSocketIO=useSocketIO;var useEventSource$1={},__assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign=Object.assign||function(K){for(var _,Z=1,te=arguments.length;Z<te;Z++){_=arguments[Z];for(var ne in _)Object.prototype.hasOwnProperty.call(_,ne)&&(K[ne]=_[ne])}return K},__assign.apply(this,arguments)},__rest=commonjsGlobal&&commonjsGlobal.__rest||function(K,_){var Z={};for(var te in K)Object.prototype.hasOwnProperty.call(K,te)&&_.indexOf(te)<0&&(Z[te]=K[te]);if(K!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ne=0,te=Object.getOwnPropertySymbols(K);ne<te.length;ne++)_.indexOf(te[ne])<0&&Object.prototype.propertyIsEnumerable.call(K,te[ne])&&(Z[te[ne]]=K[te[ne]]);return Z};Object.defineProperty(useEventSource$1,"__esModule",{value:!0});useEventSource$1.useEventSource=void 0;var react_1=reactExports,use_websocket_1=useWebsocket,constants_1=constants$3,useEventSource=function(K,_,Z){_===void 0&&(_=constants_1.DEFAULT_EVENT_SOURCE_OPTIONS);var te=_.withCredentials,ne=_.events,ie=__rest(_,["withCredentials","events"]);Z===void 0&&(Z=!0);var oe=__assign(__assign({},ie),{eventSourceOptions:{withCredentials:te}}),se=(0,react_1.useRef)(constants_1.EMPTY_EVENT_HANDLERS);ne&&(se.current=ne);var ae=(0,use_websocket_1.useWebSocket)(K,oe,Z),le=ae.lastMessage,ce=ae.readyState,fe=ae.getWebSocket;return(0,react_1.useEffect)(function(){le!=null&&le.type&&Object.entries(se.current).forEach(function(de){var pe=de[0],he=de[1];pe===le.type&&he(le)})},[le]),{lastEvent:le,readyState:ce,getEventSource:fe}};useEventSource$1.useEventSource=useEventSource;(function(K){Object.defineProperty(K,"__esModule",{value:!0}),K.resetGlobalState=K.useEventSource=K.ReadyState=K.useSocketIO=K.default=void 0;var _=useWebsocket;Object.defineProperty(K,"default",{enumerable:!0,get:function(){return _.useWebSocket}});var Z=useSocketIo;Object.defineProperty(K,"useSocketIO",{enumerable:!0,get:function(){return Z.useSocketIO}});var te=constants$3;Object.defineProperty(K,"ReadyState",{enumerable:!0,get:function(){return te.ReadyState}});var ne=useEventSource$1;Object.defineProperty(K,"useEventSource",{enumerable:!0,get:function(){return ne.useEventSource}});var ie=util;Object.defineProperty(K,"resetGlobalState",{enumerable:!0,get:function(){return ie.resetGlobalState}})})(dist$1);const index$2=getDefaultExportFromCjs$1(dist$1);function _extends$1(){return _extends$1=Object.assign||function(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_];for(var te in Z)Object.prototype.hasOwnProperty.call(Z,te)&&(K[te]=Z[te])}return K},_extends$1.apply(this,arguments)}function useGamepads(K){var _=reactExports.useRef([]),Z=reactExports.useRef(),te="ongamepadconnected"in window,ne=function(le){var ce;_.current=_extends$1({},_.current,(ce={},ce[le.index]=le,ce)),K(_.current)},ie=function(le){ne(le.gamepad)},oe=function(){for(var le=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],ce=0;ce<le.length;ce++){var fe=le[ce];fe&&fe!==null&&ne(fe)}};reactExports.useEffect(function(){return window.addEventListener("gamepadconnected",ie),window.removeEventListener("gamepadconnected",ie)});var se=function ae(){te||oe(),Z.current=requestAnimationFrame(ae)};return reactExports.useEffect(function(){return Z.current=requestAnimationFrame(se),function(){return cancelAnimationFrame(Z.current)}}),_.current}function clamp$1(K,_,Z){return Math.max(_,Math.min(Z,K))}const ButtonTouchThreshold=.05,AxisTouchThreshold=.1;function updateXRControllerGamepadState(K,_,Z){const te=_.gamepad;if(te==null)return;const ne=Z.components;for(const ie in ne){let oe=K[ie];oe==null&&(K[ie]=oe={});const{gamepadIndices:se}=ne[ie];let ae=!1,le=!1;if(se.button!=null&&se.button<te.buttons.length){const ce=te.buttons[se.button];oe.button=clamp$1(ce.value,0,1),ae||(ae=ce.pressed||oe.button===1),le||(le=ce.touched||oe.button>ButtonTouchThreshold)}se.xAxis!=null&&se.xAxis<te.axes.length&&(oe.xAxis=clamp$1(te.axes[se.xAxis],-1,1),le||(le=Math.abs(oe.xAxis)>AxisTouchThreshold)),se.yAxis!=null&&se.yAxis<te.axes.length&&(oe.yAxis=clamp$1(te.axes[se.yAxis],-1,1),le||(le=Math.abs(oe.yAxis)>AxisTouchThreshold)),oe.state=ae?"pressed":le?"touched":"default"}}function toTrianglesDrawMode(K,_){if(_===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),K;if(_===TriangleFanDrawMode||_===TriangleStripDrawMode){let Z=K.getIndex();if(Z===null){const oe=[],se=K.getAttribute("position");if(se!==void 0){for(let ae=0;ae<se.count;ae++)oe.push(ae);K.setIndex(oe),Z=K.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),K}const te=Z.count-2,ne=[];if(_===TriangleFanDrawMode)for(let oe=1;oe<=te;oe++)ne.push(Z.getX(0)),ne.push(Z.getX(oe)),ne.push(Z.getX(oe+1));else for(let oe=0;oe<te;oe++)oe%2===0?(ne.push(Z.getX(oe)),ne.push(Z.getX(oe+1)),ne.push(Z.getX(oe+2))):(ne.push(Z.getX(oe+2)),ne.push(Z.getX(oe+1)),ne.push(Z.getX(oe)));ne.length/3!==te&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const ie=K.clone();return ie.setIndex(ne),ie.clearGroups(),ie}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_),K}class GLTFLoader extends Loader{constructor(_){super(_),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(Z){return new GLTFMaterialsClearcoatExtension(Z)}),this.register(function(Z){return new GLTFMaterialsDispersionExtension(Z)}),this.register(function(Z){return new GLTFTextureBasisUExtension(Z)}),this.register(function(Z){return new GLTFTextureWebPExtension(Z)}),this.register(function(Z){return new GLTFTextureAVIFExtension(Z)}),this.register(function(Z){return new GLTFMaterialsSheenExtension(Z)}),this.register(function(Z){return new GLTFMaterialsTransmissionExtension(Z)}),this.register(function(Z){return new GLTFMaterialsVolumeExtension(Z)}),this.register(function(Z){return new GLTFMaterialsIorExtension(Z)}),this.register(function(Z){return new GLTFMaterialsEmissiveStrengthExtension(Z)}),this.register(function(Z){return new GLTFMaterialsSpecularExtension(Z)}),this.register(function(Z){return new GLTFMaterialsIridescenceExtension(Z)}),this.register(function(Z){return new GLTFMaterialsAnisotropyExtension(Z)}),this.register(function(Z){return new GLTFMaterialsBumpExtension(Z)}),this.register(function(Z){return new GLTFLightsExtension(Z)}),this.register(function(Z){return new GLTFMeshoptCompression(Z)}),this.register(function(Z){return new GLTFMeshGpuInstancing(Z)})}load(_,Z,te,ne){const ie=this;let oe;if(this.resourcePath!=="")oe=this.resourcePath;else if(this.path!==""){const le=LoaderUtils.extractUrlBase(_);oe=LoaderUtils.resolveURL(le,this.path)}else oe=LoaderUtils.extractUrlBase(_);this.manager.itemStart(_);const se=function(le){ne?ne(le):console.error(le),ie.manager.itemError(_),ie.manager.itemEnd(_)},ae=new FileLoader(this.manager);ae.setPath(this.path),ae.setResponseType("arraybuffer"),ae.setRequestHeader(this.requestHeader),ae.setWithCredentials(this.withCredentials),ae.load(_,function(le){try{ie.parse(le,oe,function(ce){Z(ce),ie.manager.itemEnd(_)},se)}catch(ce){se(ce)}},te,se)}setDRACOLoader(_){return this.dracoLoader=_,this}setKTX2Loader(_){return this.ktx2Loader=_,this}setMeshoptDecoder(_){return this.meshoptDecoder=_,this}register(_){return this.pluginCallbacks.indexOf(_)===-1&&this.pluginCallbacks.push(_),this}unregister(_){return this.pluginCallbacks.indexOf(_)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_),1),this}parse(_,Z,te,ne){let ie;const oe={},se={},ae=new TextDecoder;if(typeof _=="string")ie=JSON.parse(_);else if(_ instanceof ArrayBuffer)if(ae.decode(new Uint8Array(_,0,4))===BINARY_EXTENSION_HEADER_MAGIC){try{oe[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(_)}catch(fe){ne&&ne(fe);return}ie=JSON.parse(oe[EXTENSIONS.KHR_BINARY_GLTF].content)}else ie=JSON.parse(ae.decode(_));else ie=_;if(ie.asset===void 0||ie.asset.version[0]<2){ne&&ne(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const le=new GLTFParser(ie,{path:Z||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});le.fileLoader.setRequestHeader(this.requestHeader);for(let ce=0;ce<this.pluginCallbacks.length;ce++){const fe=this.pluginCallbacks[ce](le);fe.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),se[fe.name]=fe,oe[fe.name]=!0}if(ie.extensionsUsed)for(let ce=0;ce<ie.extensionsUsed.length;++ce){const fe=ie.extensionsUsed[ce],de=ie.extensionsRequired||[];switch(fe){case EXTENSIONS.KHR_MATERIALS_UNLIT:oe[fe]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:oe[fe]=new GLTFDracoMeshCompressionExtension(ie,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:oe[fe]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:oe[fe]=new GLTFMeshQuantizationExtension;break;default:de.indexOf(fe)>=0&&se[fe]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+fe+'".')}}le.setExtensions(oe),le.setPlugins(se),le.parse(te,ne)}parseAsync(_,Z){const te=this;return new Promise(function(ne,ie){te.parse(_,Z,ne,ie)})}}function GLTFRegistry(){let K={};return{get:function(_){return K[_]},add:function(_,Z){K[_]=Z},remove:function(_){delete K[_]},removeAll:function(){K={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _=this.parser,Z=this.parser.json.nodes||[];for(let te=0,ne=Z.length;te<ne;te++){const ie=Z[te];ie.extensions&&ie.extensions[this.name]&&ie.extensions[this.name].light!==void 0&&_._addNodeRef(this.cache,ie.extensions[this.name].light)}}_loadLight(_){const Z=this.parser,te="light:"+_;let ne=Z.cache.get(te);if(ne)return ne;const ie=Z.json,ae=((ie.extensions&&ie.extensions[this.name]||{}).lights||[])[_];let le;const ce=new Color$1(16777215);ae.color!==void 0&&ce.setRGB(ae.color[0],ae.color[1],ae.color[2],LinearSRGBColorSpace$2);const fe=ae.range!==void 0?ae.range:0;switch(ae.type){case"directional":le=new DirectionalLight$1(ce),le.target.position.set(0,0,-1),le.add(le.target);break;case"point":le=new PointLight$1(ce),le.distance=fe;break;case"spot":le=new SpotLight$2(ce),le.distance=fe,ae.spot=ae.spot||{},ae.spot.innerConeAngle=ae.spot.innerConeAngle!==void 0?ae.spot.innerConeAngle:0,ae.spot.outerConeAngle=ae.spot.outerConeAngle!==void 0?ae.spot.outerConeAngle:Math.PI/4,le.angle=ae.spot.outerConeAngle,le.penumbra=1-ae.spot.innerConeAngle/ae.spot.outerConeAngle,le.target.position.set(0,0,-1),le.add(le.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+ae.type)}return le.position.set(0,0,0),assignExtrasToUserData(le,ae),ae.intensity!==void 0&&(le.intensity=ae.intensity),le.name=Z.createUniqueName(ae.name||"light_"+_),ne=Promise.resolve(le),Z.cache.add(te,ne),ne}getDependency(_,Z){if(_==="light")return this._loadLight(Z)}createNodeAttachment(_){const Z=this,te=this.parser,ie=te.json.nodes[_],se=(ie.extensions&&ie.extensions[this.name]||{}).light;return se===void 0?null:this._loadLight(se).then(function(ae){return te._getNodeRef(Z.cache,se,ae)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_,Z,te){const ne=[];_.color=new Color$1(1,1,1),_.opacity=1;const ie=Z.pbrMetallicRoughness;if(ie){if(Array.isArray(ie.baseColorFactor)){const oe=ie.baseColorFactor;_.color.setRGB(oe[0],oe[1],oe[2],LinearSRGBColorSpace$2),_.opacity=oe[3]}ie.baseColorTexture!==void 0&&ne.push(te.assignTexture(_,"map",ie.baseColorTexture,SRGBColorSpace$2))}return Promise.all(ne)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_,Z){const ne=this.parser.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=ne.extensions[this.name].emissiveStrength;return ie!==void 0&&(Z.emissiveIntensity=ie),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];if(oe.clearcoatFactor!==void 0&&(Z.clearcoat=oe.clearcoatFactor),oe.clearcoatTexture!==void 0&&ie.push(te.assignTexture(Z,"clearcoatMap",oe.clearcoatTexture)),oe.clearcoatRoughnessFactor!==void 0&&(Z.clearcoatRoughness=oe.clearcoatRoughnessFactor),oe.clearcoatRoughnessTexture!==void 0&&ie.push(te.assignTexture(Z,"clearcoatRoughnessMap",oe.clearcoatRoughnessTexture)),oe.clearcoatNormalTexture!==void 0&&(ie.push(te.assignTexture(Z,"clearcoatNormalMap",oe.clearcoatNormalTexture)),oe.clearcoatNormalTexture.scale!==void 0)){const se=oe.clearcoatNormalTexture.scale;Z.clearcoatNormalScale=new Vector2(se,se)}return Promise.all(ie)}}class GLTFMaterialsDispersionExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_DISPERSION}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const ne=this.parser.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=ne.extensions[this.name];return Z.dispersion=ie.dispersion!==void 0?ie.dispersion:0,Promise.resolve()}}class GLTFMaterialsIridescenceExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return oe.iridescenceFactor!==void 0&&(Z.iridescence=oe.iridescenceFactor),oe.iridescenceTexture!==void 0&&ie.push(te.assignTexture(Z,"iridescenceMap",oe.iridescenceTexture)),oe.iridescenceIor!==void 0&&(Z.iridescenceIOR=oe.iridescenceIor),Z.iridescenceThicknessRange===void 0&&(Z.iridescenceThicknessRange=[100,400]),oe.iridescenceThicknessMinimum!==void 0&&(Z.iridescenceThicknessRange[0]=oe.iridescenceThicknessMinimum),oe.iridescenceThicknessMaximum!==void 0&&(Z.iridescenceThicknessRange[1]=oe.iridescenceThicknessMaximum),oe.iridescenceThicknessTexture!==void 0&&ie.push(te.assignTexture(Z,"iridescenceThicknessMap",oe.iridescenceThicknessTexture)),Promise.all(ie)}}class GLTFMaterialsSheenExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[];Z.sheenColor=new Color$1(0,0,0),Z.sheenRoughness=0,Z.sheen=1;const oe=ne.extensions[this.name];if(oe.sheenColorFactor!==void 0){const se=oe.sheenColorFactor;Z.sheenColor.setRGB(se[0],se[1],se[2],LinearSRGBColorSpace$2)}return oe.sheenRoughnessFactor!==void 0&&(Z.sheenRoughness=oe.sheenRoughnessFactor),oe.sheenColorTexture!==void 0&&ie.push(te.assignTexture(Z,"sheenColorMap",oe.sheenColorTexture,SRGBColorSpace$2)),oe.sheenRoughnessTexture!==void 0&&ie.push(te.assignTexture(Z,"sheenRoughnessMap",oe.sheenRoughnessTexture)),Promise.all(ie)}}class GLTFMaterialsTransmissionExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return oe.transmissionFactor!==void 0&&(Z.transmission=oe.transmissionFactor),oe.transmissionTexture!==void 0&&ie.push(te.assignTexture(Z,"transmissionMap",oe.transmissionTexture)),Promise.all(ie)}}class GLTFMaterialsVolumeExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];Z.thickness=oe.thicknessFactor!==void 0?oe.thicknessFactor:0,oe.thicknessTexture!==void 0&&ie.push(te.assignTexture(Z,"thicknessMap",oe.thicknessTexture)),Z.attenuationDistance=oe.attenuationDistance||1/0;const se=oe.attenuationColor||[1,1,1];return Z.attenuationColor=new Color$1().setRGB(se[0],se[1],se[2],LinearSRGBColorSpace$2),Promise.all(ie)}}class GLTFMaterialsIorExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const ne=this.parser.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=ne.extensions[this.name];return Z.ior=ie.ior!==void 0?ie.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];Z.specularIntensity=oe.specularFactor!==void 0?oe.specularFactor:1,oe.specularTexture!==void 0&&ie.push(te.assignTexture(Z,"specularIntensityMap",oe.specularTexture));const se=oe.specularColorFactor||[1,1,1];return Z.specularColor=new Color$1().setRGB(se[0],se[1],se[2],LinearSRGBColorSpace$2),oe.specularColorTexture!==void 0&&ie.push(te.assignTexture(Z,"specularColorMap",oe.specularColorTexture,SRGBColorSpace$2)),Promise.all(ie)}}class GLTFMaterialsBumpExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_MATERIALS_BUMP}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return Z.bumpScale=oe.bumpFactor!==void 0?oe.bumpFactor:1,oe.bumpTexture!==void 0&&ie.push(te.assignTexture(Z,"bumpMap",oe.bumpTexture)),Promise.all(ie)}}class GLTFMaterialsAnisotropyExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(_){const te=this.parser.json.materials[_];return!te.extensions||!te.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,Z){const te=this.parser,ne=te.json.materials[_];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const ie=[],oe=ne.extensions[this.name];return oe.anisotropyStrength!==void 0&&(Z.anisotropy=oe.anisotropyStrength),oe.anisotropyRotation!==void 0&&(Z.anisotropyRotation=oe.anisotropyRotation),oe.anisotropyTexture!==void 0&&ie.push(te.assignTexture(Z,"anisotropyMap",oe.anisotropyTexture)),Promise.all(ie)}}class GLTFTextureBasisUExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(_){const Z=this.parser,te=Z.json,ne=te.textures[_];if(!ne.extensions||!ne.extensions[this.name])return null;const ie=ne.extensions[this.name],oe=Z.options.ktx2Loader;if(!oe){if(te.extensionsRequired&&te.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return Z.loadTextureImage(_,ie.source,oe)}}class GLTFTextureWebPExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_){const Z=this.name,te=this.parser,ne=te.json,ie=ne.textures[_];if(!ie.extensions||!ie.extensions[Z])return null;const oe=ie.extensions[Z],se=ne.images[oe.source];let ae=te.textureLoader;if(se.uri){const le=te.options.manager.getHandler(se.uri);le!==null&&(ae=le)}return this.detectSupport().then(function(le){if(le)return te.loadTextureImage(_,oe.source,ae);if(ne.extensionsRequired&&ne.extensionsRequired.indexOf(Z)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return te.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const Z=new Image;Z.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",Z.onload=Z.onerror=function(){_(Z.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_){const Z=this.name,te=this.parser,ne=te.json,ie=ne.textures[_];if(!ie.extensions||!ie.extensions[Z])return null;const oe=ie.extensions[Z],se=ne.images[oe.source];let ae=te.textureLoader;if(se.uri){const le=te.options.manager.getHandler(se.uri);le!==null&&(ae=le)}return this.detectSupport().then(function(le){if(le)return te.loadTextureImage(_,oe.source,ae);if(ne.extensionsRequired&&ne.extensionsRequired.indexOf(Z)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return te.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const Z=new Image;Z.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",Z.onload=Z.onerror=function(){_(Z.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(_){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=_}loadBufferView(_){const Z=this.parser.json,te=Z.bufferViews[_];if(te.extensions&&te.extensions[this.name]){const ne=te.extensions[this.name],ie=this.parser.getDependency("buffer",ne.buffer),oe=this.parser.options.meshoptDecoder;if(!oe||!oe.supported){if(Z.extensionsRequired&&Z.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return ie.then(function(se){const ae=ne.byteOffset||0,le=ne.byteLength||0,ce=ne.count,fe=ne.byteStride,de=new Uint8Array(se,ae,le);return oe.decodeGltfBufferAsync?oe.decodeGltfBufferAsync(ce,fe,de,ne.mode,ne.filter).then(function(pe){return pe.buffer}):oe.ready.then(function(){const pe=new ArrayBuffer(ce*fe);return oe.decodeGltfBuffer(new Uint8Array(pe),ce,fe,de,ne.mode,ne.filter),pe})})}else return null}}class GLTFMeshGpuInstancing{constructor(_){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=_}createNodeMesh(_){const Z=this.parser.json,te=Z.nodes[_];if(!te.extensions||!te.extensions[this.name]||te.mesh===void 0)return null;const ne=Z.meshes[te.mesh];for(const le of ne.primitives)if(le.mode!==WEBGL_CONSTANTS.TRIANGLES&&le.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&le.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&le.mode!==void 0)return null;const oe=te.extensions[this.name].attributes,se=[],ae={};for(const le in oe)se.push(this.parser.getDependency("accessor",oe[le]).then(ce=>(ae[le]=ce,ae[le])));return se.length<1?null:(se.push(this.parser.createNodeMesh(_)),Promise.all(se).then(le=>{const ce=le.pop(),fe=ce.isGroup?ce.children:[ce],de=le[0].count,pe=[];for(const he of fe){const ge=new Matrix4,me=new Vector3,Ae=new Quaternion,ye=new Vector3(1,1,1),ve=new InstancedMesh(he.geometry,he.material,de);for(let _e=0;_e<de;_e++)ae.TRANSLATION&&me.fromBufferAttribute(ae.TRANSLATION,_e),ae.ROTATION&&Ae.fromBufferAttribute(ae.ROTATION,_e),ae.SCALE&&ye.fromBufferAttribute(ae.SCALE,_e),ve.setMatrixAt(_e,ge.compose(me,Ae,ye));for(const _e in ae)if(_e==="_COLOR_0"){const Te=ae[_e];ve.instanceColor=new InstancedBufferAttribute(Te.array,Te.itemSize,Te.normalized)}else _e!=="TRANSLATION"&&_e!=="ROTATION"&&_e!=="SCALE"&&he.geometry.setAttribute(_e,ae[_e]);Object3D.prototype.copy.call(ve,he),this.parser.assignFinalMaterial(ve),pe.push(ve)}return ce.isGroup?(ce.clear(),ce.add(...pe),ce):pe[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(_){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const Z=new DataView(_,0,BINARY_EXTENSION_HEADER_LENGTH),te=new TextDecoder;if(this.header={magic:te.decode(new Uint8Array(_.slice(0,4))),version:Z.getUint32(4,!0),length:Z.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const ne=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,ie=new DataView(_,BINARY_EXTENSION_HEADER_LENGTH);let oe=0;for(;oe<ne;){const se=ie.getUint32(oe,!0);oe+=4;const ae=ie.getUint32(oe,!0);if(oe+=4,ae===BINARY_EXTENSION_CHUNK_TYPES.JSON){const le=new Uint8Array(_,BINARY_EXTENSION_HEADER_LENGTH+oe,se);this.content=te.decode(le)}else if(ae===BINARY_EXTENSION_CHUNK_TYPES.BIN){const le=BINARY_EXTENSION_HEADER_LENGTH+oe;this.body=_.slice(le,le+se)}oe+=se}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(_,Z){if(!Z)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=_,this.dracoLoader=Z,this.dracoLoader.preload()}decodePrimitive(_,Z){const te=this.json,ne=this.dracoLoader,ie=_.extensions[this.name].bufferView,oe=_.extensions[this.name].attributes,se={},ae={},le={};for(const ce in oe){const fe=ATTRIBUTES[ce]||ce.toLowerCase();se[fe]=oe[ce]}for(const ce in _.attributes){const fe=ATTRIBUTES[ce]||ce.toLowerCase();if(oe[ce]!==void 0){const de=te.accessors[_.attributes[ce]],pe=WEBGL_COMPONENT_TYPES[de.componentType];le[fe]=pe.name,ae[fe]=de.normalized===!0}}return Z.getDependency("bufferView",ie).then(function(ce){return new Promise(function(fe,de){ne.decodeDracoFile(ce,function(pe){for(const he in pe.attributes){const ge=pe.attributes[he],me=ae[he];me!==void 0&&(ge.normalized=me)}fe(pe)},se,le,LinearSRGBColorSpace$2,de)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(_,Z){return(Z.texCoord===void 0||Z.texCoord===_.channel)&&Z.offset===void 0&&Z.rotation===void 0&&Z.scale===void 0||(_=_.clone(),Z.texCoord!==void 0&&(_.channel=Z.texCoord),Z.offset!==void 0&&_.offset.fromArray(Z.offset),Z.rotation!==void 0&&(_.rotation=Z.rotation),Z.scale!==void 0&&_.repeat.fromArray(Z.scale),_.needsUpdate=!0),_}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(_,Z,te,ne){super(_,Z,te,ne)}copySampleValue_(_){const Z=this.resultBuffer,te=this.sampleValues,ne=this.valueSize,ie=_*ne*3+ne;for(let oe=0;oe!==ne;oe++)Z[oe]=te[ie+oe];return Z}interpolate_(_,Z,te,ne){const ie=this.resultBuffer,oe=this.sampleValues,se=this.valueSize,ae=se*2,le=se*3,ce=ne-Z,fe=(te-Z)/ce,de=fe*fe,pe=de*fe,he=_*le,ge=he-le,me=-2*pe+3*de,Ae=pe-de,ye=1-me,ve=Ae-de+fe;for(let _e=0;_e!==se;_e++){const Te=oe[ge+_e+se],be=oe[ge+_e+ae]*ce,Re=oe[he+_e+se],we=oe[he+_e]*ce;ie[_e]=ye*Te+ve*be+me*Re+Ae*we}return ie}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(_,Z,te,ne){const ie=super.interpolate_(_,Z,te,ne);return _q.fromArray(ie).normalize().toArray(ie),ie}}const WEBGL_CONSTANTS={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(K){return K.DefaultMaterial===void 0&&(K.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),K.DefaultMaterial}function addUnknownExtensionsToUserData(K,_,Z){for(const te in Z.extensions)K[te]===void 0&&(_.userData.gltfExtensions=_.userData.gltfExtensions||{},_.userData.gltfExtensions[te]=Z.extensions[te])}function assignExtrasToUserData(K,_){_.extras!==void 0&&(typeof _.extras=="object"?Object.assign(K.userData,_.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_.extras))}function addMorphTargets(K,_,Z){let te=!1,ne=!1,ie=!1;for(let le=0,ce=_.length;le<ce;le++){const fe=_[le];if(fe.POSITION!==void 0&&(te=!0),fe.NORMAL!==void 0&&(ne=!0),fe.COLOR_0!==void 0&&(ie=!0),te&&ne&&ie)break}if(!te&&!ne&&!ie)return Promise.resolve(K);const oe=[],se=[],ae=[];for(let le=0,ce=_.length;le<ce;le++){const fe=_[le];if(te){const de=fe.POSITION!==void 0?Z.getDependency("accessor",fe.POSITION):K.attributes.position;oe.push(de)}if(ne){const de=fe.NORMAL!==void 0?Z.getDependency("accessor",fe.NORMAL):K.attributes.normal;se.push(de)}if(ie){const de=fe.COLOR_0!==void 0?Z.getDependency("accessor",fe.COLOR_0):K.attributes.color;ae.push(de)}}return Promise.all([Promise.all(oe),Promise.all(se),Promise.all(ae)]).then(function(le){const ce=le[0],fe=le[1],de=le[2];return te&&(K.morphAttributes.position=ce),ne&&(K.morphAttributes.normal=fe),ie&&(K.morphAttributes.color=de),K.morphTargetsRelative=!0,K})}function updateMorphTargets(K,_){if(K.updateMorphTargets(),_.weights!==void 0)for(let Z=0,te=_.weights.length;Z<te;Z++)K.morphTargetInfluences[Z]=_.weights[Z];if(_.extras&&Array.isArray(_.extras.targetNames)){const Z=_.extras.targetNames;if(K.morphTargetInfluences.length===Z.length){K.morphTargetDictionary={};for(let te=0,ne=Z.length;te<ne;te++)K.morphTargetDictionary[Z[te]]=te}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(K){let _;const Z=K.extensions&&K.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(Z?_="draco:"+Z.bufferView+":"+Z.indices+":"+createAttributesKey(Z.attributes):_=K.indices+":"+createAttributesKey(K.attributes)+":"+K.mode,K.targets!==void 0)for(let te=0,ne=K.targets.length;te<ne;te++)_+=":"+createAttributesKey(K.targets[te]);return _}function createAttributesKey(K){let _="";const Z=Object.keys(K).sort();for(let te=0,ne=Z.length;te<ne;te++)_+=Z[te]+":"+K[Z[te]]+";";return _}function getNormalizedComponentScale(K){switch(K){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(K){return K.search(/\.jpe?g($|\?)/i)>0||K.search(/^data\:image\/jpeg/)===0?"image/jpeg":K.search(/\.webp($|\?)/i)>0||K.search(/^data\:image\/webp/)===0?"image/webp":K.search(/\.ktx2($|\?)/i)>0||K.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(_={},Z={}){this.json=_,this.extensions={},this.plugins={},this.options=Z,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let te=!1,ne=-1,ie=!1,oe=-1;if(typeof navigator<"u"){const se=navigator.userAgent;te=/^((?!chrome|android).)*safari/i.test(se)===!0;const ae=se.match(/Version\/(\d+)/);ne=te&&ae?parseInt(ae[1],10):-1,ie=se.indexOf("Firefox")>-1,oe=ie?se.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||te&&ne<17||ie&&oe<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_){this.extensions=_}setPlugins(_){this.plugins=_}parse(_,Z){const te=this,ne=this.json,ie=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(oe){return oe._markDefs&&oe._markDefs()}),Promise.all(this._invokeAll(function(oe){return oe.beforeRoot&&oe.beforeRoot()})).then(function(){return Promise.all([te.getDependencies("scene"),te.getDependencies("animation"),te.getDependencies("camera")])}).then(function(oe){const se={scene:oe[0][ne.scene||0],scenes:oe[0],animations:oe[1],cameras:oe[2],asset:ne.asset,parser:te,userData:{}};return addUnknownExtensionsToUserData(ie,se,ne),assignExtrasToUserData(se,ne),Promise.all(te._invokeAll(function(ae){return ae.afterRoot&&ae.afterRoot(se)})).then(function(){for(const ae of se.scenes)ae.updateMatrixWorld();_(se)})}).catch(Z)}_markDefs(){const _=this.json.nodes||[],Z=this.json.skins||[],te=this.json.meshes||[];for(let ne=0,ie=Z.length;ne<ie;ne++){const oe=Z[ne].joints;for(let se=0,ae=oe.length;se<ae;se++)_[oe[se]].isBone=!0}for(let ne=0,ie=_.length;ne<ie;ne++){const oe=_[ne];oe.mesh!==void 0&&(this._addNodeRef(this.meshCache,oe.mesh),oe.skin!==void 0&&(te[oe.mesh].isSkinnedMesh=!0)),oe.camera!==void 0&&this._addNodeRef(this.cameraCache,oe.camera)}}_addNodeRef(_,Z){Z!==void 0&&(_.refs[Z]===void 0&&(_.refs[Z]=_.uses[Z]=0),_.refs[Z]++)}_getNodeRef(_,Z,te){if(_.refs[Z]<=1)return te;const ne=te.clone(),ie=(oe,se)=>{const ae=this.associations.get(oe);ae!=null&&this.associations.set(se,ae);for(const[le,ce]of oe.children.entries())ie(ce,se.children[le])};return ie(te,ne),ne.name+="_instance_"+_.uses[Z]++,ne}_invokeOne(_){const Z=Object.values(this.plugins);Z.push(this);for(let te=0;te<Z.length;te++){const ne=_(Z[te]);if(ne)return ne}return null}_invokeAll(_){const Z=Object.values(this.plugins);Z.unshift(this);const te=[];for(let ne=0;ne<Z.length;ne++){const ie=_(Z[ne]);ie&&te.push(ie)}return te}getDependency(_,Z){const te=_+":"+Z;let ne=this.cache.get(te);if(!ne){switch(_){case"scene":ne=this.loadScene(Z);break;case"node":ne=this._invokeOne(function(ie){return ie.loadNode&&ie.loadNode(Z)});break;case"mesh":ne=this._invokeOne(function(ie){return ie.loadMesh&&ie.loadMesh(Z)});break;case"accessor":ne=this.loadAccessor(Z);break;case"bufferView":ne=this._invokeOne(function(ie){return ie.loadBufferView&&ie.loadBufferView(Z)});break;case"buffer":ne=this.loadBuffer(Z);break;case"material":ne=this._invokeOne(function(ie){return ie.loadMaterial&&ie.loadMaterial(Z)});break;case"texture":ne=this._invokeOne(function(ie){return ie.loadTexture&&ie.loadTexture(Z)});break;case"skin":ne=this.loadSkin(Z);break;case"animation":ne=this._invokeOne(function(ie){return ie.loadAnimation&&ie.loadAnimation(Z)});break;case"camera":ne=this.loadCamera(Z);break;default:if(ne=this._invokeOne(function(ie){return ie!=this&&ie.getDependency&&ie.getDependency(_,Z)}),!ne)throw new Error("Unknown type: "+_);break}this.cache.add(te,ne)}return ne}getDependencies(_){let Z=this.cache.get(_);if(!Z){const te=this,ne=this.json[_+(_==="mesh"?"es":"s")]||[];Z=Promise.all(ne.map(function(ie,oe){return te.getDependency(_,oe)})),this.cache.add(_,Z)}return Z}loadBuffer(_){const Z=this.json.buffers[_],te=this.fileLoader;if(Z.type&&Z.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+Z.type+" buffer type is not supported.");if(Z.uri===void 0&&_===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const ne=this.options;return new Promise(function(ie,oe){te.load(LoaderUtils.resolveURL(Z.uri,ne.path),ie,void 0,function(){oe(new Error('THREE.GLTFLoader: Failed to load buffer "'+Z.uri+'".'))})})}loadBufferView(_){const Z=this.json.bufferViews[_];return this.getDependency("buffer",Z.buffer).then(function(te){const ne=Z.byteLength||0,ie=Z.byteOffset||0;return te.slice(ie,ie+ne)})}loadAccessor(_){const Z=this,te=this.json,ne=this.json.accessors[_];if(ne.bufferView===void 0&&ne.sparse===void 0){const oe=WEBGL_TYPE_SIZES[ne.type],se=WEBGL_COMPONENT_TYPES[ne.componentType],ae=ne.normalized===!0,le=new se(ne.count*oe);return Promise.resolve(new BufferAttribute(le,oe,ae))}const ie=[];return ne.bufferView!==void 0?ie.push(this.getDependency("bufferView",ne.bufferView)):ie.push(null),ne.sparse!==void 0&&(ie.push(this.getDependency("bufferView",ne.sparse.indices.bufferView)),ie.push(this.getDependency("bufferView",ne.sparse.values.bufferView))),Promise.all(ie).then(function(oe){const se=oe[0],ae=WEBGL_TYPE_SIZES[ne.type],le=WEBGL_COMPONENT_TYPES[ne.componentType],ce=le.BYTES_PER_ELEMENT,fe=ce*ae,de=ne.byteOffset||0,pe=ne.bufferView!==void 0?te.bufferViews[ne.bufferView].byteStride:void 0,he=ne.normalized===!0;let ge,me;if(pe&&pe!==fe){const Ae=Math.floor(de/pe),ye="InterleavedBuffer:"+ne.bufferView+":"+ne.componentType+":"+Ae+":"+ne.count;let ve=Z.cache.get(ye);ve||(ge=new le(se,Ae*pe,ne.count*pe/ce),ve=new InterleavedBuffer(ge,pe/ce),Z.cache.add(ye,ve)),me=new InterleavedBufferAttribute(ve,ae,de%pe/ce,he)}else se===null?ge=new le(ne.count*ae):ge=new le(se,de,ne.count*ae),me=new BufferAttribute(ge,ae,he);if(ne.sparse!==void 0){const Ae=WEBGL_TYPE_SIZES.SCALAR,ye=WEBGL_COMPONENT_TYPES[ne.sparse.indices.componentType],ve=ne.sparse.indices.byteOffset||0,_e=ne.sparse.values.byteOffset||0,Te=new ye(oe[1],ve,ne.sparse.count*Ae),be=new le(oe[2],_e,ne.sparse.count*ae);se!==null&&(me=new BufferAttribute(me.array.slice(),me.itemSize,me.normalized)),me.normalized=!1;for(let Re=0,we=Te.length;Re<we;Re++){const Pe=Te[Re];if(me.setX(Pe,be[Re*ae]),ae>=2&&me.setY(Pe,be[Re*ae+1]),ae>=3&&me.setZ(Pe,be[Re*ae+2]),ae>=4&&me.setW(Pe,be[Re*ae+3]),ae>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}me.normalized=he}return me})}loadTexture(_){const Z=this.json,te=this.options,ie=Z.textures[_].source,oe=Z.images[ie];let se=this.textureLoader;if(oe.uri){const ae=te.manager.getHandler(oe.uri);ae!==null&&(se=ae)}return this.loadTextureImage(_,ie,se)}loadTextureImage(_,Z,te){const ne=this,ie=this.json,oe=ie.textures[_],se=ie.images[Z],ae=(se.uri||se.bufferView)+":"+oe.sampler;if(this.textureCache[ae])return this.textureCache[ae];const le=this.loadImageSource(Z,te).then(function(ce){ce.flipY=!1,ce.name=oe.name||se.name||"",ce.name===""&&typeof se.uri=="string"&&se.uri.startsWith("data:image/")===!1&&(ce.name=se.uri);const de=(ie.samplers||{})[oe.sampler]||{};return ce.magFilter=WEBGL_FILTERS[de.magFilter]||LinearFilter,ce.minFilter=WEBGL_FILTERS[de.minFilter]||LinearMipmapLinearFilter,ce.wrapS=WEBGL_WRAPPINGS[de.wrapS]||RepeatWrapping,ce.wrapT=WEBGL_WRAPPINGS[de.wrapT]||RepeatWrapping,ce.generateMipmaps=!ce.isCompressedTexture&&ce.minFilter!==NearestFilter&&ce.minFilter!==LinearFilter,ne.associations.set(ce,{textures:_}),ce}).catch(function(){return null});return this.textureCache[ae]=le,le}loadImageSource(_,Z){const te=this,ne=this.json,ie=this.options;if(this.sourceCache[_]!==void 0)return this.sourceCache[_].then(fe=>fe.clone());const oe=ne.images[_],se=self.URL||self.webkitURL;let ae=oe.uri||"",le=!1;if(oe.bufferView!==void 0)ae=te.getDependency("bufferView",oe.bufferView).then(function(fe){le=!0;const de=new Blob([fe],{type:oe.mimeType});return ae=se.createObjectURL(de),ae});else if(oe.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_+" is missing URI and bufferView");const ce=Promise.resolve(ae).then(function(fe){return new Promise(function(de,pe){let he=de;Z.isImageBitmapLoader===!0&&(he=function(ge){const me=new Texture$1(ge);me.needsUpdate=!0,de(me)}),Z.load(LoaderUtils.resolveURL(fe,ie.path),he,void 0,pe)})}).then(function(fe){return le===!0&&se.revokeObjectURL(ae),assignExtrasToUserData(fe,oe),fe.userData.mimeType=oe.mimeType||getImageURIMimeType(oe.uri),fe}).catch(function(fe){throw console.error("THREE.GLTFLoader: Couldn't load texture",ae),fe});return this.sourceCache[_]=ce,ce}assignTexture(_,Z,te,ne){const ie=this;return this.getDependency("texture",te.index).then(function(oe){if(!oe)return null;if(te.texCoord!==void 0&&te.texCoord>0&&(oe=oe.clone(),oe.channel=te.texCoord),ie.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const se=te.extensions!==void 0?te.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(se){const ae=ie.associations.get(oe);oe=ie.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(oe,se),ie.associations.set(oe,ae)}}return ne!==void 0&&(oe.colorSpace=ne),_[Z]=oe,oe})}assignFinalMaterial(_){const Z=_.geometry;let te=_.material;const ne=Z.attributes.tangent===void 0,ie=Z.attributes.color!==void 0,oe=Z.attributes.normal===void 0;if(_.isPoints){const se="PointsMaterial:"+te.uuid;let ae=this.cache.get(se);ae||(ae=new PointsMaterial,Material.prototype.copy.call(ae,te),ae.color.copy(te.color),ae.map=te.map,ae.sizeAttenuation=!1,this.cache.add(se,ae)),te=ae}else if(_.isLine){const se="LineBasicMaterial:"+te.uuid;let ae=this.cache.get(se);ae||(ae=new LineBasicMaterial,Material.prototype.copy.call(ae,te),ae.color.copy(te.color),ae.map=te.map,this.cache.add(se,ae)),te=ae}if(ne||ie||oe){let se="ClonedMaterial:"+te.uuid+":";ne&&(se+="derivative-tangents:"),ie&&(se+="vertex-colors:"),oe&&(se+="flat-shading:");let ae=this.cache.get(se);ae||(ae=te.clone(),ie&&(ae.vertexColors=!0),oe&&(ae.flatShading=!0),ne&&(ae.normalScale&&(ae.normalScale.y*=-1),ae.clearcoatNormalScale&&(ae.clearcoatNormalScale.y*=-1)),this.cache.add(se,ae),this.associations.set(ae,this.associations.get(te))),te=ae}_.material=te}getMaterialType(){return MeshStandardMaterial}loadMaterial(_){const Z=this,te=this.json,ne=this.extensions,ie=te.materials[_];let oe;const se={},ae=ie.extensions||{},le=[];if(ae[EXTENSIONS.KHR_MATERIALS_UNLIT]){const fe=ne[EXTENSIONS.KHR_MATERIALS_UNLIT];oe=fe.getMaterialType(),le.push(fe.extendParams(se,ie,Z))}else{const fe=ie.pbrMetallicRoughness||{};if(se.color=new Color$1(1,1,1),se.opacity=1,Array.isArray(fe.baseColorFactor)){const de=fe.baseColorFactor;se.color.setRGB(de[0],de[1],de[2],LinearSRGBColorSpace$2),se.opacity=de[3]}fe.baseColorTexture!==void 0&&le.push(Z.assignTexture(se,"map",fe.baseColorTexture,SRGBColorSpace$2)),se.metalness=fe.metallicFactor!==void 0?fe.metallicFactor:1,se.roughness=fe.roughnessFactor!==void 0?fe.roughnessFactor:1,fe.metallicRoughnessTexture!==void 0&&(le.push(Z.assignTexture(se,"metalnessMap",fe.metallicRoughnessTexture)),le.push(Z.assignTexture(se,"roughnessMap",fe.metallicRoughnessTexture))),oe=this._invokeOne(function(de){return de.getMaterialType&&de.getMaterialType(_)}),le.push(Promise.all(this._invokeAll(function(de){return de.extendMaterialParams&&de.extendMaterialParams(_,se)})))}ie.doubleSided===!0&&(se.side=DoubleSide);const ce=ie.alphaMode||ALPHA_MODES.OPAQUE;if(ce===ALPHA_MODES.BLEND?(se.transparent=!0,se.depthWrite=!1):(se.transparent=!1,ce===ALPHA_MODES.MASK&&(se.alphaTest=ie.alphaCutoff!==void 0?ie.alphaCutoff:.5)),ie.normalTexture!==void 0&&oe!==MeshBasicMaterial&&(le.push(Z.assignTexture(se,"normalMap",ie.normalTexture)),se.normalScale=new Vector2(1,1),ie.normalTexture.scale!==void 0)){const fe=ie.normalTexture.scale;se.normalScale.set(fe,fe)}if(ie.occlusionTexture!==void 0&&oe!==MeshBasicMaterial&&(le.push(Z.assignTexture(se,"aoMap",ie.occlusionTexture)),ie.occlusionTexture.strength!==void 0&&(se.aoMapIntensity=ie.occlusionTexture.strength)),ie.emissiveFactor!==void 0&&oe!==MeshBasicMaterial){const fe=ie.emissiveFactor;se.emissive=new Color$1().setRGB(fe[0],fe[1],fe[2],LinearSRGBColorSpace$2)}return ie.emissiveTexture!==void 0&&oe!==MeshBasicMaterial&&le.push(Z.assignTexture(se,"emissiveMap",ie.emissiveTexture,SRGBColorSpace$2)),Promise.all(le).then(function(){const fe=new oe(se);return ie.name&&(fe.name=ie.name),assignExtrasToUserData(fe,ie),Z.associations.set(fe,{materials:_}),ie.extensions&&addUnknownExtensionsToUserData(ne,fe,ie),fe})}createUniqueName(_){const Z=PropertyBinding.sanitizeNodeName(_||"");return Z in this.nodeNamesUsed?Z+"_"+ ++this.nodeNamesUsed[Z]:(this.nodeNamesUsed[Z]=0,Z)}loadGeometries(_){const Z=this,te=this.extensions,ne=this.primitiveCache;function ie(se){return te[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(se,Z).then(function(ae){return addPrimitiveAttributes(ae,se,Z)})}const oe=[];for(let se=0,ae=_.length;se<ae;se++){const le=_[se],ce=createPrimitiveKey(le),fe=ne[ce];if(fe)oe.push(fe.promise);else{let de;le.extensions&&le.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?de=ie(le):de=addPrimitiveAttributes(new BufferGeometry,le,Z),ne[ce]={primitive:le,promise:de},oe.push(de)}}return Promise.all(oe)}loadMesh(_){const Z=this,te=this.json,ne=this.extensions,ie=te.meshes[_],oe=ie.primitives,se=[];for(let ae=0,le=oe.length;ae<le;ae++){const ce=oe[ae].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",oe[ae].material);se.push(ce)}return se.push(Z.loadGeometries(oe)),Promise.all(se).then(function(ae){const le=ae.slice(0,ae.length-1),ce=ae[ae.length-1],fe=[];for(let pe=0,he=ce.length;pe<he;pe++){const ge=ce[pe],me=oe[pe];let Ae;const ye=le[pe];if(me.mode===WEBGL_CONSTANTS.TRIANGLES||me.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||me.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||me.mode===void 0)Ae=ie.isSkinnedMesh===!0?new SkinnedMesh(ge,ye):new Mesh(ge,ye),Ae.isSkinnedMesh===!0&&Ae.normalizeSkinWeights(),me.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?Ae.geometry=toTrianglesDrawMode(Ae.geometry,TriangleStripDrawMode):me.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(Ae.geometry=toTrianglesDrawMode(Ae.geometry,TriangleFanDrawMode));else if(me.mode===WEBGL_CONSTANTS.LINES)Ae=new LineSegments(ge,ye);else if(me.mode===WEBGL_CONSTANTS.LINE_STRIP)Ae=new Line$2(ge,ye);else if(me.mode===WEBGL_CONSTANTS.LINE_LOOP)Ae=new LineLoop(ge,ye);else if(me.mode===WEBGL_CONSTANTS.POINTS)Ae=new Points$1(ge,ye);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+me.mode);Object.keys(Ae.geometry.morphAttributes).length>0&&updateMorphTargets(Ae,ie),Ae.name=Z.createUniqueName(ie.name||"mesh_"+_),assignExtrasToUserData(Ae,ie),me.extensions&&addUnknownExtensionsToUserData(ne,Ae,me),Z.assignFinalMaterial(Ae),fe.push(Ae)}for(let pe=0,he=fe.length;pe<he;pe++)Z.associations.set(fe[pe],{meshes:_,primitives:pe});if(fe.length===1)return ie.extensions&&addUnknownExtensionsToUserData(ne,fe[0],ie),fe[0];const de=new Group;ie.extensions&&addUnknownExtensionsToUserData(ne,de,ie),Z.associations.set(de,{meshes:_});for(let pe=0,he=fe.length;pe<he;pe++)de.add(fe[pe]);return de})}loadCamera(_){let Z;const te=this.json.cameras[_],ne=te[te.type];if(!ne){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return te.type==="perspective"?Z=new PerspectiveCamera$2(MathUtils.radToDeg(ne.yfov),ne.aspectRatio||1,ne.znear||1,ne.zfar||2e6):te.type==="orthographic"&&(Z=new OrthographicCamera$1(-ne.xmag,ne.xmag,ne.ymag,-ne.ymag,ne.znear,ne.zfar)),te.name&&(Z.name=this.createUniqueName(te.name)),assignExtrasToUserData(Z,te),Promise.resolve(Z)}loadSkin(_){const Z=this.json.skins[_],te=[];for(let ne=0,ie=Z.joints.length;ne<ie;ne++)te.push(this._loadNodeShallow(Z.joints[ne]));return Z.inverseBindMatrices!==void 0?te.push(this.getDependency("accessor",Z.inverseBindMatrices)):te.push(null),Promise.all(te).then(function(ne){const ie=ne.pop(),oe=ne,se=[],ae=[];for(let le=0,ce=oe.length;le<ce;le++){const fe=oe[le];if(fe){se.push(fe);const de=new Matrix4;ie!==null&&de.fromArray(ie.array,le*16),ae.push(de)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Z.joints[le])}return new Skeleton(se,ae)})}loadAnimation(_){const Z=this.json,te=this,ne=Z.animations[_],ie=ne.name?ne.name:"animation_"+_,oe=[],se=[],ae=[],le=[],ce=[];for(let fe=0,de=ne.channels.length;fe<de;fe++){const pe=ne.channels[fe],he=ne.samplers[pe.sampler],ge=pe.target,me=ge.node,Ae=ne.parameters!==void 0?ne.parameters[he.input]:he.input,ye=ne.parameters!==void 0?ne.parameters[he.output]:he.output;ge.node!==void 0&&(oe.push(this.getDependency("node",me)),se.push(this.getDependency("accessor",Ae)),ae.push(this.getDependency("accessor",ye)),le.push(he),ce.push(ge))}return Promise.all([Promise.all(oe),Promise.all(se),Promise.all(ae),Promise.all(le),Promise.all(ce)]).then(function(fe){const de=fe[0],pe=fe[1],he=fe[2],ge=fe[3],me=fe[4],Ae=[];for(let ye=0,ve=de.length;ye<ve;ye++){const _e=de[ye],Te=pe[ye],be=he[ye],Re=ge[ye],we=me[ye];if(_e===void 0)continue;_e.updateMatrix&&_e.updateMatrix();const Pe=te._createAnimationTracks(_e,Te,be,Re,we);if(Pe)for(let Ie=0;Ie<Pe.length;Ie++)Ae.push(Pe[Ie])}return new AnimationClip(ie,void 0,Ae)})}createNodeMesh(_){const Z=this.json,te=this,ne=Z.nodes[_];return ne.mesh===void 0?null:te.getDependency("mesh",ne.mesh).then(function(ie){const oe=te._getNodeRef(te.meshCache,ne.mesh,ie);return ne.weights!==void 0&&oe.traverse(function(se){if(se.isMesh)for(let ae=0,le=ne.weights.length;ae<le;ae++)se.morphTargetInfluences[ae]=ne.weights[ae]}),oe})}loadNode(_){const Z=this.json,te=this,ne=Z.nodes[_],ie=te._loadNodeShallow(_),oe=[],se=ne.children||[];for(let le=0,ce=se.length;le<ce;le++)oe.push(te.getDependency("node",se[le]));const ae=ne.skin===void 0?Promise.resolve(null):te.getDependency("skin",ne.skin);return Promise.all([ie,Promise.all(oe),ae]).then(function(le){const ce=le[0],fe=le[1],de=le[2];de!==null&&ce.traverse(function(pe){pe.isSkinnedMesh&&pe.bind(de,_identityMatrix)});for(let pe=0,he=fe.length;pe<he;pe++)ce.add(fe[pe]);return ce})}_loadNodeShallow(_){const Z=this.json,te=this.extensions,ne=this;if(this.nodeCache[_]!==void 0)return this.nodeCache[_];const ie=Z.nodes[_],oe=ie.name?ne.createUniqueName(ie.name):"",se=[],ae=ne._invokeOne(function(le){return le.createNodeMesh&&le.createNodeMesh(_)});return ae&&se.push(ae),ie.camera!==void 0&&se.push(ne.getDependency("camera",ie.camera).then(function(le){return ne._getNodeRef(ne.cameraCache,ie.camera,le)})),ne._invokeAll(function(le){return le.createNodeAttachment&&le.createNodeAttachment(_)}).forEach(function(le){se.push(le)}),this.nodeCache[_]=Promise.all(se).then(function(le){let ce;if(ie.isBone===!0?ce=new Bone:le.length>1?ce=new Group:le.length===1?ce=le[0]:ce=new Object3D,ce!==le[0])for(let fe=0,de=le.length;fe<de;fe++)ce.add(le[fe]);if(ie.name&&(ce.userData.name=ie.name,ce.name=oe),assignExtrasToUserData(ce,ie),ie.extensions&&addUnknownExtensionsToUserData(te,ce,ie),ie.matrix!==void 0){const fe=new Matrix4;fe.fromArray(ie.matrix),ce.applyMatrix4(fe)}else ie.translation!==void 0&&ce.position.fromArray(ie.translation),ie.rotation!==void 0&&ce.quaternion.fromArray(ie.rotation),ie.scale!==void 0&&ce.scale.fromArray(ie.scale);return ne.associations.has(ce)||ne.associations.set(ce,{}),ne.associations.get(ce).nodes=_,ce}),this.nodeCache[_]}loadScene(_){const Z=this.extensions,te=this.json.scenes[_],ne=this,ie=new Group;te.name&&(ie.name=ne.createUniqueName(te.name)),assignExtrasToUserData(ie,te),te.extensions&&addUnknownExtensionsToUserData(Z,ie,te);const oe=te.nodes||[],se=[];for(let ae=0,le=oe.length;ae<le;ae++)se.push(ne.getDependency("node",oe[ae]));return Promise.all(se).then(function(ae){for(let ce=0,fe=ae.length;ce<fe;ce++)ie.add(ae[ce]);const le=ce=>{const fe=new Map;for(const[de,pe]of ne.associations)(de instanceof Material||de instanceof Texture$1)&&fe.set(de,pe);return ce.traverse(de=>{const pe=ne.associations.get(de);pe!=null&&fe.set(de,pe)}),fe};return ne.associations=le(ie),ie})}_createAnimationTracks(_,Z,te,ne,ie){const oe=[],se=_.name?_.name:_.uuid,ae=[];PATH_PROPERTIES[ie.path]===PATH_PROPERTIES.weights?_.traverse(function(de){de.morphTargetInfluences&&ae.push(de.name?de.name:de.uuid)}):ae.push(se);let le;switch(PATH_PROPERTIES[ie.path]){case PATH_PROPERTIES.weights:le=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:le=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.translation:case PATH_PROPERTIES.scale:le=VectorKeyframeTrack;break;default:switch(te.itemSize){case 1:le=NumberKeyframeTrack;break;case 2:case 3:default:le=VectorKeyframeTrack;break}break}const ce=ne.interpolation!==void 0?INTERPOLATION[ne.interpolation]:InterpolateLinear,fe=this._getArrayFromAccessor(te);for(let de=0,pe=ae.length;de<pe;de++){const he=new le(ae[de]+"."+PATH_PROPERTIES[ie.path],Z.array,fe,ce);ne.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(he),oe.push(he)}return oe}_getArrayFromAccessor(_){let Z=_.array;if(_.normalized){const te=getNormalizedComponentScale(Z.constructor),ne=new Float32Array(Z.length);for(let ie=0,oe=Z.length;ie<oe;ie++)ne[ie]=Z[ie]*te;Z=ne}return Z}_createCubicSplineTrackInterpolant(_){_.createInterpolant=function(te){const ne=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new ne(this.times,this.values,this.getValueSize()/3,te)},_.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function computeBounds(K,_,Z){const te=_.attributes,ne=new Box3;if(te.POSITION!==void 0){const se=Z.json.accessors[te.POSITION],ae=se.min,le=se.max;if(ae!==void 0&&le!==void 0){if(ne.set(new Vector3(ae[0],ae[1],ae[2]),new Vector3(le[0],le[1],le[2])),se.normalized){const ce=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[se.componentType]);ne.min.multiplyScalar(ce),ne.max.multiplyScalar(ce)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const ie=_.targets;if(ie!==void 0){const se=new Vector3,ae=new Vector3;for(let le=0,ce=ie.length;le<ce;le++){const fe=ie[le];if(fe.POSITION!==void 0){const de=Z.json.accessors[fe.POSITION],pe=de.min,he=de.max;if(pe!==void 0&&he!==void 0){if(ae.setX(Math.max(Math.abs(pe[0]),Math.abs(he[0]))),ae.setY(Math.max(Math.abs(pe[1]),Math.abs(he[1]))),ae.setZ(Math.max(Math.abs(pe[2]),Math.abs(he[2]))),de.normalized){const ge=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[de.componentType]);ae.multiplyScalar(ge)}se.max(ae)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}ne.expandByVector(se)}K.boundingBox=ne;const oe=new Sphere$2;ne.getCenter(oe.center),oe.radius=ne.min.distanceTo(ne.max)/2,K.boundingSphere=oe}function addPrimitiveAttributes(K,_,Z){const te=_.attributes,ne=[];function ie(oe,se){return Z.getDependency("accessor",oe).then(function(ae){K.setAttribute(se,ae)})}for(const oe in te){const se=ATTRIBUTES[oe]||oe.toLowerCase();se in K.attributes||ne.push(ie(te[oe],se))}if(_.indices!==void 0&&!K.index){const oe=Z.getDependency("accessor",_.indices).then(function(se){K.setIndex(se)});ne.push(oe)}return ColorManagement.workingColorSpace!==LinearSRGBColorSpace$2&&"COLOR_0"in te&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${ColorManagement.workingColorSpace}" not supported.`),assignExtrasToUserData(K,_),computeBounds(K,_,Z),Promise.all(ne).then(function(){return _.targets!==void 0?addMorphTargets(K,_.targets,Z):K})}function createHandPoseState(K){return{data:new Float32Array(K.size*16)}}function updateXRHandPoseState(K,_,Z,te,ne){const ie=te.getReferenceSpace();ie==null||_==null||_.session.visibilityState==="visible-blurred"||_.session.visibilityState==="hidden"||updateXRHandPoseData(_,ie,Z,K.data)}const invertedWirstHelper=new Matrix4,matrixHelper$3=new Matrix4;function updateXRHandPoseData(K,_,Z,te){if(!K.fillPoses(Z.values(),_,te))return!1;invertedWirstHelper.fromArray(te,0),invertedWirstHelper.invert();for(let ie=0;ie<te.length;ie+=16)matrixHelper$3.fromArray(te,ie),matrixHelper$3.premultiply(invertedWirstHelper),matrixHelper$3.toArray(te,ie);return!0}function clone(K){const _=new Map,Z=new Map,te=K.clone();return parallelTraverse(K,te,function(ne,ie){_.set(ie,ne),Z.set(ne,ie)}),te.traverse(function(ne){if(!ne.isSkinnedMesh)return;const ie=ne,oe=_.get(ne),se=oe.skeleton.bones;ie.skeleton=oe.skeleton.clone(),ie.bindMatrix.copy(oe.bindMatrix),ie.skeleton.bones=se.map(function(ae){return Z.get(ae)}),ie.bind(ie.skeleton,ie.bindMatrix)}),te}function parallelTraverse(K,_,Z){Z(K,_);for(let te=0;te<K.children.length;te++)parallelTraverse(K.children[te],_.children[te],Z)}const DefaultDefaultXRHandProfileId="generic-hand";function getXRHandAssetPath(K,_){const Z=(_==null?void 0:_.baseAssetPath)??DefaultAssetBasePath,te=(_==null?void 0:_.defaultXRHandProfileId)??DefaultDefaultXRHandProfileId;return new URL(`${te}/${K}.glb`,Z).href}function cloneXRHandGltf({scene:K}){const _=clone(K),Z=_.getObjectByProperty("type","SkinnedMesh");if(Z==null)throw new Error("missing SkinnedMesh in loaded XRHand model");return Z.frustumCulled=!1,_}function configureXRHandModel(K,_){K.renderOrder=(_==null?void 0:_.renderOrder)??0,K.traverse(Z=>{Z instanceof Mesh&&Z.material instanceof Material&&(Z.material.colorWrite=(_==null?void 0:_.colorWrite)??!0)})}function createXRHandState(K,_,Z,te,ne){return{id:K,isPrimary:ne,type:"hand",inputSource:_,pose:createHandPoseState(_.hand),assetPath:getXRHandAssetPath(_.handedness,Z),events:te}}function updateXRHandState({inputSource:K,pose:_},Z,te){updateXRHandPoseState(_,Z,K.hand,te,K.handedness)}const joints=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"];function createUpdateXRHandVisuals(K,_,Z){const te=new Float32Array(K.size*16),ne=joints.map(ie=>{const oe=_.getObjectByName(ie);if(oe==null)throw new Error(`missing joint "${ie}" in hand model`);return oe.matrixAutoUpdate=!1,oe});return ie=>{const oe=typeof Z=="function"?Z():Z;if(ie==null||oe==null)return;ie.fillPoses(K.values(),oe,te);const se=ne.length;for(let ae=0;ae<se;ae++)ne[ae].matrix.fromArray(te,ae*16)}}function isXRInputSourceState(K){return K!=null&&typeof K=="object"&&"inputSource"in K}function setupEvents(K,_){const Z=te=>_.push(te);return K.addEventListener("selectstart",Z),K.addEventListener("selectend",Z),K.addEventListener("select",Z),K.addEventListener("squeeze",Z),K.addEventListener("squeezestart",Z),K.addEventListener("squeezeend",Z),()=>{K.removeEventListener("selectstart",Z),K.removeEventListener("selectend",Z),K.removeEventListener("select",Z),K.removeEventListener("squeeze",Z),K.removeEventListener("squeezestart",Z),K.removeEventListener("squeezeend",Z)}}let idCounter=0;function createSyncXRInputSourceStates(K,_){const Z=new Map,te=new XRControllerLayoutLoader(_),ne=new Map;return(ie,oe,se)=>{var le;if(se==="remove-all"){for(const ce of Z.values())ce();return oe}const ae=[...oe];for(const{added:ce,isPrimary:fe,removed:de}of se){if(de!=null)for(const pe of de){const he=ae.findIndex(({inputSource:ge,isPrimary:me})=>me===fe&&ge===pe);he!==-1&&(ae.splice(he,1),(le=Z.get(pe))==null||le(),Z.delete(pe))}if(ce!=null)for(const pe of ce){const he=[];let ge=setupEvents(ie,he);const me=`${pe.handedness}-${pe.hand?"hand":"nohand"}-${pe.targetRayMode}-${pe.profiles.join(",")}`;let Ae;if((Ae=ne.get(me))==null&&ne.set(me,Ae=`${idCounter++}`),pe.hand!=null)ae.push(createXRHandState(Ae,pe,_,he,fe));else switch(pe.targetRayMode){case"gaze":ae.push({id:Ae,isPrimary:fe,type:"gaze",inputSource:pe,events:he});break;case"screen":ae.push({id:Ae,isPrimary:fe,type:"screenInput",inputSource:pe,events:he});break;case"transient-pointer":ae.push({id:Ae,isPrimary:fe,type:"transientPointer",inputSource:pe,events:he});break;case"tracked-pointer":let ye=!1;const ve=ge;ge=()=>{ve(),ye=!0};const _e=createXRControllerState(Ae,pe,te,he,fe);_e instanceof Promise?_e.then(Te=>!ye&&K(Te)).catch(console.error):ae.push(_e);break}Z.set(pe,ge)}}return ae}}function setupSyncIsVisible(K,_){const Z=(te,ne)=>{ne!=null&&te.visibilityState===ne.visibilityState||_(te.visibilityState==="visible")};return Z(K.getState()),K.subscribe(Z)}class PointerCursorMaterial extends MeshBasicMaterial{constructor(){super({transparent:!0,toneMapped:!1,depthWrite:!1})}onBeforeCompile(_,Z){super.onBeforeCompile(_,Z),_.vertexShader=`varying vec2 vLocalPosition;
`+_.vertexShader,_.vertexShader=_.vertexShader.replace("#include <color_vertex>",`#include <color_vertex>
        vLocalPosition = position.xy * 2.0;`),_.fragmentShader=`varying vec2 vLocalPosition;
`+_.fragmentShader,_.fragmentShader=_.fragmentShader.replace("#include <color_fragment>",`#include <color_fragment>
          float value = max(0.0, 1.0 - sqrt(dot(vLocalPosition, vLocalPosition)));
          diffuseColor.a = diffuseColor.a * value * value;`)}}const ZAxis=new Vector3(0,0,1),quaternionHelper$6=new Quaternion,offsetHelper=new Vector3;function updatePointerCursorModel(K,_,Z,te,ne){var ae;const ie=te.getIntersection();if(ie==null||!te.getEnabled()||ie.object.isVoidObject===!0||!isVisble(K)){_.visible=!1;return}_.visible=!0;const oe=typeof ne.color=="function"?ne.color(te):ne.color;Array.isArray(oe)?Z.color.set(...oe):Z.color.set(oe??"white"),Z.opacity=typeof ne.opacity=="function"?ne.opacity(te):ne.opacity??.4,_.position.copy(ie.pointOnFace),_.scale.setScalar(ne.size??.1);const se=ie.normal??((ae=ie.face)==null?void 0:ae.normal);se!=null&&(quaternionHelper$6.setFromUnitVectors(ZAxis,se),ie.object.getWorldQuaternion(_.quaternion),_.quaternion.multiply(quaternionHelper$6),offsetHelper.set(0,0,ne.cursorOffset??.01),offsetHelper.applyQuaternion(_.quaternion),_.position.add(offsetHelper)),_.updateMatrix()}function isVisble({visible:K,parent:_}){return K?_==null?!0:isVisble(_):!1}class PointerRayMaterial extends MeshBasicMaterial{constructor(){super({transparent:!0,toneMapped:!1})}onBeforeCompile(_,Z){super.onBeforeCompile(_,Z),_.vertexShader=`varying float vFade;
`+_.vertexShader,_.vertexShader=_.vertexShader.replace("#include <color_vertex>",`#include <color_vertex>
            vFade = position.z + 0.5;`),_.fragmentShader=`varying float vFade;
`+_.fragmentShader,_.fragmentShader=_.fragmentShader.replace("#include <color_fragment>",`#include <color_fragment>
              diffuseColor.a *= vFade;`)}}function updatePointerRayModel(K,_,Z,te){const ne=Z.getIntersection();if(!Z.getEnabled()||ne==null){K.visible=!1;return}K.visible=!0;const ie=typeof te.color=="function"?te.color(Z):te.color;Array.isArray(ie)?_.color.set(...ie):_.color.set(ie??"white"),_.opacity=typeof te.opacity=="function"?te.opacity(Z):te.opacity??.4;const oe=Math.min(te.maxLength??1,ne.distance);K.position.z=-oe/2;const se=te.size??.005;K.scale.set(se,se,oe),K.updateMatrix()}function bindXRInputSourceEvent(K,_,Z,te){const ne=ie=>{_!="all"&&ie.inputSource!=_||te(ie)};return K.addEventListener(Z,ne),()=>K.removeEventListener(Z,ne)}function bindPointerXRInputSourceEvent(K,_,Z,te,ne,ie={}){const oe=fe=>{fe.inputSource===Z&&K.down(Object.assign(fe,{button:ie.button??0}))},se=fe=>{fe.inputSource===Z&&K.up(Object.assign(fe,{button:ie.button??0}))},ae=`${te}start`,le=`${te}end`,ce=ne.length;for(let fe=0;fe<ce;fe++){const de=ne[fe];switch(de.type){case ae:oe(de);break;case le:se(de);break}}return _.addEventListener(ae,oe),_.addEventListener(le,se),()=>{_.removeEventListener(ae,oe),_.removeEventListener(le,se)}}function defaultGrabPointerOpacity(K){var _;return K.getButtonsDown().size>0?.6:map$2(((_=K.getIntersection())==null?void 0:_.distance)??1/0,.07,0,.2,.4)}function defaultRayPointerOpacity(K){return K.getButtonsDown().size>0?.6:.4}function defaultTouchPointerOpacity(K){var _;return map$2(((_=K.getIntersection())==null?void 0:_.distance)??1/0,.1,.03,.2,.6)}function map$2(K,_,Z,te,ne){return te+Math.max(0,Math.min(1,(K-_)/(Z-_)))*(ne-te)}function createGetXRSpaceMatrix(K,_){return(Z,te)=>{if(K===_)return Z.identity(),!0;const ne=typeof _=="function"?_():_;if(ne==null)return!1;const ie=te==null?void 0:te.getPose(K,ne);return ie==null?!1:(Z.fromArray(ie.transform.matrix),!0)}}function getSpaceFromAncestors(K,_,Z,te){te==null||te.copy(K.matrix);const ne=getXRSpaceFromAncestorsRec(K.parent,te);return ne??(te!=null&&computeOriginReferenceSpaceOffset(K,_,te),Z)}function computeOriginReferenceSpaceOffset(K,_,Z){if(K.updateWorldMatrix(!0,!1),_==null){Z.copy(K.matrixWorld);return}_.updateWorldMatrix(!0,!1),Z.copy(_.matrixWorld).invert().multiply(K.matrixWorld)}function getXRSpaceFromAncestorsRec(K,_){if(K!=null)return K.xrSpace!=null?K.xrSpace:(_==null||_.premultiply(K.matrix),getXRSpaceFromAncestorsRec(K.parent,_))}class HtmlEvent{constructor(_){Dn(this,"nativeEvent");Dn(this,"NONE",0);Dn(this,"CAPTURING_PHASE",1);Dn(this,"AT_TARGET",2);Dn(this,"BUBBLING_PHASE",3);Dn(this,"relatedTarget",null);this.nativeEvent=_}get altKey(){return this.getFromNative("altKey",!1)}get button(){return this.getFromNative("button",0)}get buttons(){return this.getFromNative("buttons",0)}get clientX(){return this.getFromNative("clientX",0)}get clientY(){return this.getFromNative("clientY",0)}get ctrlKey(){return this.getFromNative("ctrlKey",!1)}get layerX(){return this.getFromNative("layerX",0)}get layerY(){return this.getFromNative("layerY",0)}get metaKey(){return this.getFromNative("metaKey",!1)}get movementX(){return this.getFromNative("movementX",0)}get movementY(){return this.getFromNative("movementY",0)}get offsetX(){return this.getFromNative("offsetX",0)}get offsetY(){return this.getFromNative("offsetY",0)}get pageX(){return this.getFromNative("pageX",0)}get pageY(){return this.getFromNative("pageY",0)}get screenX(){return this.getFromNative("screenX",0)}get screenY(){return this.getFromNative("screenY",0)}get shiftKey(){return this.getFromNative("shiftKey",!1)}get x(){return this.getFromNative("x",0)}get y(){return this.getFromNative("y",0)}get detail(){return this.getFromNative("detail",0)}get view(){return this.getFromNative("view",null)}get which(){return this.getFromNative("which",0)}get cancelBubble(){return this.getFromNative("cancelBubble",!1)}get composed(){return this.getFromNative("composed",!1)}get eventPhase(){return this.getFromNative("eventPhase",0)}get isTrusted(){return this.getFromNative("isTrusted",!1)}get returnValue(){return this.getFromNative("returnValue",!1)}get timeStamp(){return this.getFromNative("timeStamp",0)}get cancelable(){return this.getFromNative("cancelable",!1)}get defaultPrevented(){return this.getFromNative("defaultPrevented",!1)}getFromNative(_,Z){return _ in this.nativeEvent?this.nativeEvent[_]:Z}}const helperVector=new Vector3;class PointerEvent extends HtmlEvent{constructor(Z,te,ne,ie,oe,se,ae=oe.object,le=ae,ce={stopped:!te,stoppedImmediate:!1}){super(ne);Dn(this,"type");Dn(this,"bubbles");Dn(this,"internalPointer");Dn(this,"intersection");Dn(this,"camera");Dn(this,"currentObject");Dn(this,"object");Dn(this,"propagationState");Dn(this,"_pointer");Dn(this,"_ray");Dn(this,"_intersections",[]);Dn(this,"_unprojectedPoint");this.type=Z,this.bubbles=te,this.internalPointer=ie,this.intersection=oe,this.camera=se,this.currentObject=ae,this.object=le,this.propagationState=ce}get pointerId(){return this.internalPointer.id}get pointerType(){return this.internalPointer.type}get pointerState(){return this.internalPointer.state}get distance(){return this.intersection.distance}get distanceToRay(){return this.intersection.distanceToRay}get point(){return this.intersection.point}get index(){return this.intersection.index}get face(){return this.intersection.face}get faceIndex(){return this.intersection.faceIndex}get uv(){return this.intersection.uv}get uv1(){return this.intersection.uv1}get normal(){return this.intersection.normal}get instanceId(){return this.intersection.instanceId}get pointOnLine(){return this.intersection.pointOnLine}get batchId(){return this.intersection.batchId}get pointerPosition(){return this.intersection.pointerPosition}get pointerQuaternion(){return this.intersection.pointerQuaternion}get pointOnFace(){return this.intersection.pointOnFace}get localPoint(){return this.intersection.localPoint}get details(){return this.intersection.details}get target(){return this.object}get currentTarget(){return this.currentObject}get eventObject(){return this.currentObject}get srcElement(){return this.currentObject}get pointer(){return this._pointer==null&&(helperVector.copy(this.intersection.point).project(this.camera),this._pointer=new Vector2(helperVector.x,helperVector.y)),this._pointer}get ray(){if(this._ray!=null)return this._ray;switch(this.intersection.details.type){case"screen-ray":case"ray":case"sphere":return this._ray=new Ray(this.intersection.pointerPosition,new Vector3(0,0,-1).applyQuaternion(this.intersection.pointerQuaternion));case"lines":return this._ray=new Ray(this.intersection.details.line.start,this.intersection.details.line.end.clone().sub(this.intersection.details.line.start).normalize())}}get intersections(){return this._intersections==null&&(this._intersections=[{...this.intersection,eventObject:this.currentObject}]),this._intersections}get unprojectedPoint(){if(this._unprojectedPoint==null){const Z=this.pointer;this._unprojectedPoint=new Vector3(Z.x,Z.y,0).unproject(this.camera)}return this._unprojectedPoint}get stopped(){return this.propagationState.stoppedImmediate||this.propagationState.stopped}get stoppedImmediate(){return this.propagationState.stoppedImmediate}get delta(){throw new Error("not supported")}stopPropagation(){this.propagationState.stopped=!0}stopImmediatePropagation(){this.propagationState.stoppedImmediate=!0}retarget(Z){return new PointerEvent(this.type,this.bubbles,this.nativeEvent,this.internalPointer,this.intersection,this.camera,Z,this.target,this.propagationState)}}class WheelEvent extends PointerEvent{get deltaX(){return this.nativeEvent.deltaX}get deltaY(){return this.nativeEvent.deltaY}get deltaZ(){return this.nativeEvent.deltaZ}constructor(_,Z,te,ne,ie,oe){super("wheel",!0,_,Z,te,ne,ie,oe)}retarget(_){return new WheelEvent(this.nativeEvent,this.internalPointer,this.intersection,this.camera,_,this.target)}}function emitPointerEvent(K){emitPointerEventRec(K,K.currentObject)}function emitPointerEventRec(K,_){if(_==null)return;const Z=getObjectListeners(_,K.type);if(Z!=null&&Z.length>0){const te=K.retarget(_),ne=Z.length;for(let ie=0;ie<ne&&!te.stoppedImmediate;ie++)Z[ie](te)}K.stopped||emitPointerEventRec(K,_.parent)}const r3fEventToHandlerMap={click:"onClick",contextmenu:"onContextMenu",dblclick:"onDoubleClick",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",pointerup:"onPointerUp",wheel:"onWheel"},listenerNames=Object.keys(r3fEventToHandlerMap);function getObjectListeners(K,_){var te;if(K._listeners!=null&&_ in K._listeners)return K._listeners[_];let Z;if(K.isVoidObject&&_==="click"&&((te=K.parent)==null?void 0:te.__r3f)!=null&&(Z=K.parent.__r3f.root.getState().onPointerMissed),K.__r3f!=null&&(Z=K.__r3f.handlers[r3fEventToHandlerMap[_]]),Z!=null)return[Z]}const VoidObjectRadius=1e10,VoidObjectGeometry=new SphereGeometry(VoidObjectRadius),sceneVoidObjectMap=new Map;function getVoidObject(K){let _=sceneVoidObjectMap.get(K);return _==null&&(_=new Mesh(VoidObjectGeometry),_.isVoidObject=!0,_.parent=K,_.pointerEventsOrder=-1/0,sceneVoidObjectMap.set(K,_)),_}function computeIntersectionWorldPlane(K,_,Z){var ne;const te=_.normal??((ne=_.face)==null?void 0:ne.normal);return te==null?!1:(K.setFromNormalAndCoplanarPoint(te,_.localPoint),K.applyMatrix4(Z),!0)}function isPointerEventsAllowed(K,_,Z){if(_==="none"||_==="listener"&&!K)return!1;if(Z==="all")return!0;if(typeof Z=="function")return({id:ie,type:oe,state:se})=>Z(ie,oe,se);let te,ne;return"deny"in Z?(ne=!0,te=Z.deny):(ne=!1,te=Z.allow),Array.isArray(te)?ie=>invertIf(te.includes(ie.type),ne):ie=>invertIf(te===ie.type,ne)}function invertIf(K,_){return _?!K:K}function intersectPointerEventTargets(K,_,Z,te=!1,ne,ie,oe){const se=te||hasObjectListeners(K,_),ae=_.pointerEvents??ne,le=ae??_.defaultPointerEvents??"listener",ce=_.pointerEventsType??ie??"all",fe=_.pointerEventsOrder??oe??0,de=isPointerEventsAllowed(se,le,ce),pe=Z.length;if(pe===1)(de===!0||typeof de=="function"&&de(Z[0]))&&filterAndInteresct(Z[0],_,le,ce,fe);else if(de===!0)for(let me=0;me<pe;me++)filterAndInteresct(Z[me],_,le,ce,fe);else if(typeof de=="function")for(let me=0;me<pe;me++){const Ae=Z[me];de(Ae)&&filterAndInteresct(Ae,_,le,ce,fe)}if(_.children.length===0||_.intersectChildren===!1)return;const he=_.interactableDescendants??_.children,ge=he.length;for(let me=0;me<ge;me++)intersectPointerEventTargets(K,he[me],Z,se,ae,ce,fe)}function hasObjectListeners(K,_){var ne;if(_.ancestorsHaveListeners||K==="pointer"&&_.ancestorsHavePointerListeners||K==="wheel"&&_.ancestorsHaveWheelListeners||_.__r3f!=null&&((ne=_.__r3f)==null?void 0:ne.eventCount)>0&&(K==="wheel"&&_.__r3f.handlers.onWheel!=null||K==="pointer"&&Object.keys(_.__r3f.handlers).some(ie=>ie!="onWheel")))return!0;if(_._listeners==null)return!1;if(K==="wheel"){const ie=_._listeners.wheel;return ie!=null&&ie.length>0}const Z=Object.entries(_._listeners),te=Z.length;for(let ie=0;ie<te;ie++){const oe=Z[ie];if(oe[0]!=="wheel"&&listenerNames.includes(oe[0])&&oe[1]!=null&&oe[1].length>0)return!0}return!1}function filterAndInteresct({intersector:K,options:_},Z,te,ne,ie){var oe;((oe=_.filter)==null?void 0:oe.call(_,Z,te,ne,ie))!==!1&&K.executeIntersection(Z,ie)}function getDominantIntersectionIndex(K,_,{customSort:Z=defaultSort}={},te){let ne,ie,oe;const se=K.length;for(let ae=0;ae<se;ae++){const le=K[ae];if((te==null?void 0:te(le))===!1)continue;const ce=_==null?void 0:_[ae];(ne==null||Z(le,ce,ne,ie)<0)&&(oe=ae,ne=le,ie=ce)}return oe}function defaultSort(K,_=0,Z,te=0){return _!=te?te-_:K.distance-Z.distance}const VoidObjectDistance=1e7;function voidObjectIntersectionFromRay(K,_,Z,te,ne,ie=0){const oe=_.direction.clone().multiplyScalar(VoidObjectDistance),se=VoidObjectDistance;return{distance:se+ie,object:getVoidObject(K),point:oe,normal:_.origin.clone().sub(oe).normalize(),details:Z(oe,se),pointerPosition:te,pointerQuaternion:ne,pointOnFace:oe,localPoint:oe}}function pushTimes(K,_,Z){for(;Z>0;)K.push(_),--Z}const buttonsDownTimeKey=Symbol("buttonsDownTime"),buttonsClickTimeKey=Symbol("buttonsClickTime");globalThis.pointerEventspointerMap??(globalThis.pointerEventspointerMap=new Map);Object3D.prototype.setPointerCapture=function(K){var _;(_=getPointerById(K))==null||_.setCapture(this)};Object3D.prototype.releasePointerCapture=function(K){const _=getPointerById(K);_==null||!_.hasCaptured(this)||_.setCapture(void 0)};Object3D.prototype.hasPointerCapture=function(K){var _;return((_=getPointerById(K))==null?void 0:_.hasCaptured(this))??!1};function getPointerById(K){var _;return(_=globalThis.pointerEventspointerMap)==null?void 0:_.get(K)}let Pointer$1=class{constructor(_,Z,te,ne,ie,oe,se,ae,le={}){Dn(this,"id");Dn(this,"type");Dn(this,"state");Dn(this,"intersector");Dn(this,"getCamera");Dn(this,"onMoveCommited");Dn(this,"parentSetPointerCapture");Dn(this,"parentReleasePointerCapture");Dn(this,"options");Dn(this,"prevIntersection");Dn(this,"intersection");Dn(this,"prevEnabled",!0);Dn(this,"enabled",!0);Dn(this,"wheelIntersection");Dn(this,"pointerEntered",[]);Dn(this,"pointerEnteredHelper",[]);Dn(this,"pointerCapture");Dn(this,"buttonsDownTime",new Map);Dn(this,"buttonsDown",new Set);Dn(this,"wasMoved",!1);Dn(this,"onFirstMove",[]);var ce;this.id=_,this.type=Z,this.state=te,this.intersector=ne,this.getCamera=ie,this.onMoveCommited=oe,this.parentSetPointerCapture=se,this.parentReleasePointerCapture=ae,this.options=le,(ce=globalThis.pointerEventspointerMap)==null||ce.set(_,this)}getPointerCapture(){return this.pointerCapture}hasCaptured(_){var Z;return((Z=this.pointerCapture)==null?void 0:Z.object)===_}setCapture(_){var Z,te,ne;((Z=this.pointerCapture)==null?void 0:Z.object)!==_&&(this.pointerCapture!=null&&((te=this.parentReleasePointerCapture)==null||te.call(this),this.pointerCapture=void 0),_!=null&&this.intersection!=null&&(this.pointerCapture={object:_,intersection:this.intersection},(ne=this.parentSetPointerCapture)==null||ne.call(this)))}getButtonsDown(){return this.buttonsDown}getIntersection(){return this.intersection}getEnabled(){return this.enabled}setEnabled(_,Z,te=!0){var ne;this.enabled!==_&&(!_&&this.pointerCapture!=null&&((ne=this.parentReleasePointerCapture)==null||ne.call(this),this.pointerCapture=void 0),this.enabled=_,te&&this.commit(Z,!1))}computeIntersection(_,Z,te){return this.pointerCapture!=null?this.intersector.intersectPointerCapture(this.pointerCapture,te):(this.intersector.startIntersection(te),intersectPointerEventTargets(_,Z,[this]),this.intersector.finalizeIntersection(Z))}setIntersection(_){this.intersection=_}commit(_,Z){var ae;const te=this.getCamera(),ne=this.prevEnabled?this.prevIntersection:void 0,ie=this.enabled?this.intersection:void 0;ne!=null&&ne.object!=(ie==null?void 0:ie.object)&&emitPointerEvent(new PointerEvent("pointerout",!0,_,this,ne,te));const oe=this.pointerEntered;this.pointerEntered=[],this.pointerEnteredHelper.length=0,computeEnterLeave(ie==null?void 0:ie.object,this.pointerEntered,oe,this.pointerEnteredHelper);const se=oe.length;for(let le=0;le<se;le++){const ce=oe[le];emitPointerEvent(new PointerEvent("pointerleave",!1,_,this,ne,te,ce))}ie!=null&&(ne==null?void 0:ne.object)!=ie.object&&emitPointerEvent(new PointerEvent("pointerover",!0,_,this,ie,te));for(let le=this.pointerEnteredHelper.length-1;le>=0;le--){const ce=this.pointerEnteredHelper[le];emitPointerEvent(new PointerEvent("pointerenter",!1,_,this,ie,te,ce))}if(Z&&ie!=null&&emitPointerEvent(new PointerEvent("pointermove",!0,_,this,ie,te)),this.prevIntersection=this.intersection,this.prevEnabled=this.enabled,!this.wasMoved&&this.intersector.isReady()){this.wasMoved=!0;const le=this.onFirstMove.length;for(let ce=0;ce<le;ce++)this.onFirstMove[ce](te);this.onFirstMove.length=0}(ae=this.onMoveCommited)==null||ae.call(this,this)}move(_,Z){this.intersection=this.computeIntersection("pointer",_,Z),this.commit(Z,!0)}emitMove(_){this.intersection!=null&&emitPointerEvent(new PointerEvent("pointermove",!0,_,this,this.intersection,this.getCamera()))}down(_){if(this.buttonsDown.add(_.button),!this.enabled)return;if(!this.wasMoved){this.onFirstMove.push(this.down.bind(this,_));return}if(this.intersection==null)return;emitPointerEvent(new PointerEvent("pointerdown",!0,_,this,this.intersection,this.getCamera()));const{object:Z}=this.intersection;Z[buttonsDownTimeKey]??(Z[buttonsDownTimeKey]=new Map),Z[buttonsDownTimeKey].set(_.button,_.timeStamp),this.buttonsDownTime.set(_.button,_.timeStamp)}up(_){if(this.buttonsDown.delete(_.button),!this.enabled)return;if(!this.wasMoved){this.onFirstMove.push(this.up.bind(this,_));return}if(this.intersection==null)return;const{clickThesholdMs:Z,contextMenuButton:te=2,dblClickThresholdMs:ne=500,clickThresholdMs:ie=Z??300}=this.options;this.pointerCapture=void 0;const oe=getIsClicked(this.buttonsDownTime,this.intersection.object[buttonsDownTimeKey],_.button,_.timeStamp,ie),se=this.getCamera();if(oe&&_.button===te&&emitPointerEvent(new PointerEvent("contextmenu",!0,_,this,this.intersection,se)),emitPointerEvent(new PointerEvent("pointerup",!0,_,this,this.intersection,se)),!oe||_.button===te)return;emitPointerEvent(new PointerEvent("click",!0,_,this,this.intersection,se));const{object:ae}=this.intersection,le=ae[buttonsClickTimeKey]??(ae[buttonsClickTimeKey]=new Map),ce=le.get(_.button);if(ce==null||_.timeStamp-ce>ne){le.set(_.button,_.timeStamp);return}emitPointerEvent(new PointerEvent("dblclick",!0,_,this,this.intersection,se)),le.delete(_.button)}cancel(_){if(this.enabled){if(!this.wasMoved){this.onFirstMove.push(this.cancel.bind(this,_));return}this.intersection!=null&&emitPointerEvent(new PointerEvent("pointercancel",!0,_,this,this.intersection,this.getCamera()))}}wheel(_,Z,te=!1){if(!this.enabled)return;if(!this.wasMoved&&te){this.onFirstMove.push(this.wheel.bind(this,_,Z,te));return}te||(this.wheelIntersection=this.computeIntersection("wheel",_,Z));const ne=te?this.intersection:this.wheelIntersection;ne!=null&&emitPointerEvent(new WheelEvent(Z,this,ne,this.getCamera()))}emitWheel(_,Z=!1){if(!this.enabled)return;if(!this.wasMoved&&Z){this.onFirstMove.push(this.emitWheel.bind(this,_,Z));return}const te=Z?this.intersection:this.wheelIntersection;te!=null&&emitPointerEvent(new WheelEvent(_,this,te,this.getCamera()))}exit(_){var Z;this.wasMoved&&(this.pointerCapture!=null&&((Z=this.parentReleasePointerCapture)==null||Z.call(this),this.pointerCapture=void 0),this.intersection=void 0,this.commit(_,!1)),this.onFirstMove.length=0,this.wasMoved=!1}};function computeEnterLeave(K,_,Z,te){if(K==null)return;const ne=Z.indexOf(K);ne!=-1?Z.splice(ne,1):te.push(K),_.push(K),computeEnterLeave(K.parent,_,Z,te)}function getIsClicked(K,_,Z,te,ne){if(_==null)return!1;const ie=_.get(Z);return!(ie==null||te-ie>ne||ie!=K.get(Z))}function updateAndCheckWorldTransformation(K){return K.transformReady===!1?!1:K.parent==null?(K.matrixWorld.copy(K.matrix),!0):updateAndCheckWorldTransformation(K.parent)?(K.matrixWorld.multiplyMatrices(K.parent.matrixWorld,K.matrix),!0):!1}const triangleHelper1=new Triangle,triangleHelper2=new Triangle,aVec2Helper=new Vector2,bVec2Helper=new Vector2,cVec2Helper=new Vector2,pointHelper=new Vector3,inverseMatrix=new Matrix4,localPointHelper=new Vector3;function getClosestUV(K,_,Z){localPointHelper.copy(_).applyMatrix4(inverseMatrix.copy(Z.matrixWorld).invert());const te=Z.geometry.attributes.uv;if(te==null||!(te instanceof BufferAttribute))return!1;let ne;return loopThroughTriangles(Z,(ie,oe,se)=>{Z.getVertexPosition(ie,triangleHelper1.a),Z.getVertexPosition(oe,triangleHelper1.b),Z.getVertexPosition(se,triangleHelper1.c);const ae=triangleHelper1.closestPointToPoint(localPointHelper,pointHelper).distanceTo(localPointHelper);ne!=null&&ae>=ne||(ne=ae,triangleHelper2.copy(triangleHelper1),aVec2Helper.fromBufferAttribute(te,ie),bVec2Helper.fromBufferAttribute(te,oe),cVec2Helper.fromBufferAttribute(te,se))}),ne==null?!1:(triangleHelper2.closestPointToPoint(localPointHelper,pointHelper),triangleHelper2.getInterpolation(pointHelper,aVec2Helper,bVec2Helper,cVec2Helper,K),!0)}function loopThroughTriangles(K,_){const Z=K.geometry.drawRange;if(K.geometry.index!=null){const oe=K.geometry.index,se=Math.max(0,Z.start),ae=Math.min(oe.count,Z.start+Z.count);for(let le=se;le<ae;le+=3)_(oe.getX(le),oe.getX(le+1),oe.getX(le+2));return}const te=K.geometry.attributes.position;if(te==null)return;const ne=Math.max(0,Z.start),ie=Math.min(te.count,Z.start+Z.count);for(let oe=ne;oe<ie;oe+=3)_(oe,oe+1,oe+2)}const invertedMatrixHelper$2=new Matrix4,lineHelper=new Line3,scaleHelper$5=new Vector3,planeHelper$2=new Plane$2,rayHelper=new Ray,point2Helper$2=new Vector2,defaultLinePoints=[new Vector3(0,0,0),new Vector3(0,0,1)];class LinesIntersector{constructor(_,Z){Dn(this,"space");Dn(this,"options");Dn(this,"raycasters",[]);Dn(this,"fromMatrixWorld",new Matrix4);Dn(this,"ready");Dn(this,"intersects",[]);Dn(this,"pointerEventsOrders",[]);Dn(this,"raycasterIndices",[]);this.space=_,this.options=Z}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){const _=this.space.current;return _==null?this.ready=!1:(this.ready=updateAndCheckWorldTransformation(_),this.ready?(this.fromMatrixWorld.copy(_.matrixWorld),!0):!1)}intersectPointerCapture({intersection:_,object:Z}){const te=_.details;if(te.type!="lines")throw new Error(`unable to process a pointer capture of type "${_.details.type}" with a lines intersector`);if(!this.prepareTransformation())return _;const ne=this.options.linePoints??defaultLinePoints;lineHelper.set(ne[te.lineIndex],ne[te.lineIndex+1]).applyMatrix4(this.fromMatrixWorld);const ie=lineHelper.at(te.distanceOnLine/lineHelper.distance(),new Vector3);_.object.updateWorldMatrix(!0,!1),computeIntersectionWorldPlane(planeHelper$2,_,_.object.matrixWorld);const oe=rayHelper.intersectPlane(planeHelper$2,new Vector3)??ie,se=new Vector3,ae=new Quaternion;this.fromMatrixWorld.decompose(se,ae,scaleHelper$5);let le=_.uv;return _.object instanceof Mesh&&getClosestUV(point2Helper$2,ie,_.object)&&(le=point2Helper$2.clone()),{..._,object:Z,uv:le,pointOnFace:oe,point:ie,pointerPosition:se,pointerQuaternion:ae}}startIntersection(){if(!this.prepareTransformation())return;const _=this.options.linePoints??defaultLinePoints,Z=_.length-1;for(let te=0;te<Z;te++){const ne=_[te],ie=_[te+1],oe=this.raycasters[te]??(this.raycasters[te]=new Raycaster);oe.ray.origin.copy(ne).applyMatrix4(this.fromMatrixWorld),oe.ray.direction.copy(ie).applyMatrix4(this.fromMatrixWorld),oe.ray.direction.sub(oe.ray.origin);const se=oe.ray.direction.length();oe.ray.direction.divideScalar(se),oe.far=se}this.raycasters.length=Z}executeIntersection(_,Z){if(!this.isReady())return;const te=this.intersects.length,ne=this.raycasters.length;for(let ie=0;ie<ne;ie++){const oe=this.raycasters[ie],se=this.intersects.length;_.raycast(oe,this.intersects),pushTimes(this.raycasterIndices,ie,this.intersects.length-se)}pushTimes(this.pointerEventsOrders,Z,this.intersects.length-te)}finalizeIntersection(_){const Z=new Vector3().setFromMatrixPosition(this.fromMatrixWorld),te=new Quaternion().setFromRotationMatrix(this.fromMatrixWorld),ne=getDominantIntersectionIndex(this.intersects,this.pointerEventsOrders,this.options),ie=ne==null?void 0:this.intersects[ne],oe=ne==null?void 0:this.raycasterIndices[ne];if(this.intersects.length=0,this.raycasterIndices.length=0,this.pointerEventsOrders.length=0,ie==null||oe==null){const le=this.raycasters.length-1,ce=this.raycasters.reduce((de,pe,he)=>he===le?de:de+pe.far,0),fe=this.raycasters[le];return voidObjectIntersectionFromRay(_,fe.ray,(de,pe)=>({line:new Line3(fe.ray.origin.clone(),de),lineIndex:this.raycasters.length-1,distanceOnLine:pe,type:"lines"}),Z,te,ce)}let se=ie.distance;for(let le=0;le<oe;le++)se+=this.raycasters[le].far;ie.object.updateWorldMatrix(!0,!1);const ae=this.raycasters[oe];return Object.assign(ie,{details:{lineIndex:oe,distanceOnLine:ie.distance,type:"lines",line:new Line3(ae.ray.origin.clone(),ae.ray.direction.clone().multiplyScalar(ae.far).add(ae.ray.origin))},distance:se,pointerPosition:Z,pointerQuaternion:te,pointOnFace:ie.point,localPoint:ie.point.clone().applyMatrix4(invertedMatrixHelper$2.copy(ie.object.matrixWorld).invert())})}}const invertedMatrixHelper$1=new Matrix4,scaleHelper$4=new Vector3,NegZAxis=new Vector3(0,0,-1),planeHelper$1=new Plane$2,point2Helper$1=new Vector2;class RayIntersector{constructor(_,Z){Dn(this,"space");Dn(this,"options");Dn(this,"raycaster",new Raycaster);Dn(this,"raycasterQuaternion",new Quaternion);Dn(this,"worldScale",0);Dn(this,"ready");Dn(this,"intersects",[]);Dn(this,"pointerEventsOrders",[]);this.space=_,this.options=Z}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){var Z;const _=this.space.current;return _==null?this.ready=!1:(this.ready=updateAndCheckWorldTransformation(_),this.ready?(_.matrixWorld.decompose(this.raycaster.ray.origin,this.raycasterQuaternion,scaleHelper$4),this.worldScale=scaleHelper$4.x,this.raycaster.ray.direction.copy(((Z=this.options)==null?void 0:Z.direction)??NegZAxis).applyQuaternion(this.raycasterQuaternion),!0):!1)}intersectPointerCapture({intersection:_,object:Z}){if(_.details.type!="ray")throw new Error(`unable to process a pointer capture of type "${_.details.type}" with a ray intersector`);if(!this.prepareTransformation())return _;_.object.updateWorldMatrix(!0,!1),computeIntersectionWorldPlane(planeHelper$1,_,_.object.matrixWorld);const{ray:te}=this.raycaster,ne=te.intersectPlane(planeHelper$1,new Vector3)??_.point,ie=te.direction.clone().multiplyScalar(_.pointerPosition.distanceTo(_.point)).add(te.origin);let oe=_.uv;return _.object instanceof Mesh&&getClosestUV(point2Helper$1,ie,_.object)&&(oe=point2Helper$1.clone()),{..._,uv:oe,object:Z,pointOnFace:ne,point:ie,pointerPosition:te.origin.clone(),pointerQuaternion:this.raycasterQuaternion.clone()}}startIntersection(){this.prepareTransformation()}executeIntersection(_,Z){if(!this.isReady())return;const te=this.intersects.length;_.raycast(this.raycaster,this.intersects),pushTimes(this.pointerEventsOrders,Z,this.intersects.length-te)}finalizeIntersection(_){const Z=this.raycaster.ray.origin.clone(),te=this.raycasterQuaternion.clone();let ne;if(this.options.minDistance!=null){const se=this.options.minDistance/this.worldScale;ne=ae=>ae.distance>=se}const ie=getDominantIntersectionIndex(this.intersects,this.pointerEventsOrders,this.options,ne),oe=ie==null?void 0:this.intersects[ie];return this.intersects.length=0,this.pointerEventsOrders.length=0,oe==null?voidObjectIntersectionFromRay(_,this.raycaster.ray,()=>({type:"ray"}),Z,te):(oe.object.updateWorldMatrix(!0,!1),Object.assign(oe,{details:{type:"ray"},pointerPosition:Z,pointerQuaternion:te,pointOnFace:oe.point,localPoint:oe.point.clone().applyMatrix4(invertedMatrixHelper$1.copy(oe.object.matrixWorld).invert())}))}}const directionHelper$1=new Vector3;class ScreenRayIntersector{constructor(_,Z){Dn(this,"prepareTransformation");Dn(this,"options");Dn(this,"raycaster",new Raycaster);Dn(this,"cameraQuaternion",new Quaternion);Dn(this,"fromPosition",new Vector3);Dn(this,"fromQuaternion",new Quaternion);Dn(this,"coords",new Vector2);Dn(this,"viewPlane",new Plane$2);Dn(this,"intersects",[]);Dn(this,"pointerEventsOrders",[]);this.prepareTransformation=_,this.options=Z}isReady(){return!0}intersectPointerCapture({intersection:_,object:Z},te){const ne=_.details;if(ne.type!="screen-ray")throw new Error(`unable to process a pointer capture of type "${_.details.type}" with a camera ray intersector`);if(!this.startIntersection(te))return _;this.viewPlane.constant-=ne.distanceViewPlane;const ie=this.raycaster.ray.intersectPlane(this.viewPlane,new Vector3);if(ie==null)return _;_.object.updateWorldMatrix(!0,!1),computeIntersectionWorldPlane(this.viewPlane,_,_.object.matrixWorld);let oe=_.uv;return _.object instanceof Mesh&&getClosestUV(point2Helper$1,ie,_.object)&&(oe=point2Helper$1.clone()),{..._,details:{...ne,direction:this.raycaster.ray.direction.clone(),screenPoint:this.coords.clone()},uv:oe,object:Z,point:ie,pointOnFace:ie,pointerPosition:this.raycaster.ray.origin.clone(),pointerQuaternion:this.cameraQuaternion.clone()}}startIntersection(_){const Z=this.prepareTransformation(_,this.coords);return Z==null?!1:(Z.updateWorldMatrix(!0,!1),Z.matrixWorld.decompose(this.fromPosition,this.fromQuaternion,scaleHelper$4),this.raycaster.setFromCamera(this.coords,Z),this.viewPlane.setFromNormalAndCoplanarPoint(Z.getWorldDirection(directionHelper$1),this.raycaster.ray.origin),!0)}executeIntersection(_,Z){const te=this.intersects.length;_.raycast(this.raycaster,this.intersects),pushTimes(this.pointerEventsOrders,Z,this.intersects.length-te)}finalizeIntersection(_){const Z=this.fromPosition.clone(),te=this.cameraQuaternion.clone(),ne=this.raycaster.ray.direction.clone(),ie=getDominantIntersectionIndex(this.intersects,this.pointerEventsOrders,this.options),oe=ie==null?void 0:this.intersects[ie];return this.intersects.length=0,this.pointerEventsOrders.length=0,oe==null?voidObjectIntersectionFromRay(_,this.raycaster.ray,(se,ae)=>({type:"screen-ray",distanceViewPlane:ae,screenPoint:this.coords.clone(),direction:ne}),Z,te):(oe.object.updateWorldMatrix(!0,!1),invertedMatrixHelper$1.copy(oe.object.matrixWorld).invert(),Object.assign(oe,{details:{type:"screen-ray",distanceViewPlane:this.viewPlane.distanceToPoint(oe.point),screenPoint:this.coords.clone(),direction:ne},pointOnFace:oe.point,pointerPosition:Z,pointerQuaternion:te,localPoint:oe.point.clone().applyMatrix4(invertedMatrixHelper$1)}))}}const scaleHelper$3=new Vector3,point2Helper=new Vector2;class SphereIntersector{constructor(_,Z,te){Dn(this,"space");Dn(this,"getSphereRadius");Dn(this,"options");Dn(this,"fromPosition",new Vector3);Dn(this,"fromQuaternion",new Quaternion);Dn(this,"collisionSphere",new Sphere$2);Dn(this,"ready");Dn(this,"intersects",[]);this.space=_,this.getSphereRadius=Z,this.options=te}isReady(){return this.ready??this.prepareTransformation()}prepareTransformation(){const _=this.space.current;return _==null?this.ready=!1:(this.ready=updateAndCheckWorldTransformation(_),this.ready?(_.matrixWorld.decompose(this.fromPosition,this.fromQuaternion,scaleHelper$3),!0):!1)}intersectPointerCapture({intersection:_,object:Z}){if(_.details.type!="sphere")throw new Error(`unable to process a pointer capture of type "${_.details.type}" with a sphere intersector`);if(!this.prepareTransformation())return _;oldInputDevicePointOffset.copy(_.point).sub(_.pointerPosition),inputDeviceQuaternionOffset.copy(_.pointerQuaternion).invert().multiply(this.fromQuaternion);const te=oldInputDevicePointOffset.clone().applyQuaternion(inputDeviceQuaternionOffset).add(this.fromPosition);_.object.updateWorldMatrix(!0,!1),computeIntersectionWorldPlane(planeHelper,_,_.object.matrixWorld);const ne=planeHelper.projectPoint(this.fromPosition,new Vector3);let ie=_.uv;return _.object instanceof Mesh&&getClosestUV(point2Helper,te,_.object)&&(ie=point2Helper.clone()),{details:{type:"sphere"},uv:ie,distance:te.distanceTo(ne),pointerPosition:this.fromPosition.clone(),pointerQuaternion:this.fromQuaternion.clone(),object:Z,point:te,pointOnFace:ne,face:_.face,localPoint:_.localPoint}}startIntersection(){this.prepareTransformation()&&(this.collisionSphere.center.copy(this.fromPosition),this.collisionSphere.radius=this.getSphereRadius())}executeIntersection(_){this.isReady()&&intersectSphereWithObject(this.collisionSphere,_,this.intersects)}finalizeIntersection(_){const Z=this.fromPosition.clone(),te=this.fromQuaternion.clone(),ne=getDominantIntersectionIndex(this.intersects,void 0,this.options),ie=ne==null?void 0:this.intersects[ne];return this.intersects.length=0,ie==null?{details:{type:"sphere"},distance:0,point:Z,object:getVoidObject(_),pointerPosition:Z,pointerQuaternion:te,pointOnFace:Z,localPoint:Z}:(ie.object.updateWorldMatrix(!0,!1),Object.assign(ie,{details:{type:"sphere"},pointOnFace:ie.point,pointerPosition:this.fromPosition.clone(),pointerQuaternion:this.fromQuaternion.clone(),localPoint:ie.point.clone().applyMatrix4(invertedMatrixHelper.copy(ie.object.matrixWorld).invert())}))}}const matrixHelper$2=new Matrix4;function intersectSphereWithObject(K,_,Z){if(_.updateWorldMatrix(!0,!1),_.spherecast!=null){_.spherecast(K,Z);return}if(_ instanceof InstancedMesh){_.geometry.boundingSphere==null&&_.geometry.computeBoundingSphere(),_.geometry.boundingBox==null&&_.geometry.computeBoundingBox();for(let ne=0;ne<_.count;ne++){if(_.getMatrixAt(ne,matrixHelper$2),matrixHelper$2.premultiply(_.matrixWorld),!isSphereIntersectingMesh(K,_,matrixHelper$2))continue;const ie=intersectSphereMesh(K,_,matrixHelper$2,ne);ie!=null&&Z.push(ie)}}if(!(_ instanceof Mesh)||!isSphereIntersectingMesh(K,_,_.matrixWorld))return;invertedMatrixHelper.copy(_.matrixWorld).invert();const te=intersectSphereMesh(K,_,_.matrixWorld);te!=null&&Z.push(te)}const oldInputDevicePointOffset=new Vector3,inputDeviceQuaternionOffset=new Quaternion,planeHelper=new Plane$2,helperSphere=new Sphere$2;function isSphereIntersectingMesh(K,{geometry:_},Z){return _.boundingSphere==null&&_.computeBoundingSphere(),helperSphere.copy(_.boundingSphere).applyMatrix4(Z),helperSphere.center.distanceToSquared(K.center)<(K.radius+helperSphere.radius)**2}const vectorHelper$5=new Vector3,boxSizeHelper=new Vector3,boxCenterHelper=new Vector3,vec0_0001=new Vector3(1e-4,1e-4,1e-4),invertedMatrixHelper=new Matrix4;function intersectSphereMesh(K,_,Z,te){invertedMatrixHelper.copy(Z).invert(),helperSphere.copy(K).applyMatrix4(invertedMatrixHelper);const{geometry:ne}=_;ne.boundingBox==null&&ne.computeBoundingBox(),ne.boundingBox.getSize(boxSizeHelper),ne.boundingBox.getCenter(boxCenterHelper),ne.boundingBox.clampPoint(helperSphere.center,vectorHelper$5),vectorHelper$5.applyMatrix4(Z);const ie=vectorHelper$5.distanceToSquared(K.center);if(ie>K.radius*K.radius)return;boxSizeHelper.max(vec0_0001);const oe=helperSphere.center.clone().sub(boxCenterHelper);oe.divide(boxSizeHelper),maximizeAxisVector(oe);const se=vectorHelper$5.clone();let ae;return getClosestUV(point2Helper,se,_)&&(ae=point2Helper.clone()),{distance:Math.sqrt(ie),face:{a:0,b:0,c:0,materialIndex:0,normal:oe},uv:ae,normal:oe,point:se,instanceId:te,object:_}}function maximizeAxisVector(K){const _=Math.abs(K.x),Z=Math.abs(K.y),te=Math.abs(K.z);if(_>=Z&&_>=te){K.set(K.x<0?-1:1,0,0);return}if(Z>=_&&Z>=te){K.set(0,K.y<0?-1:1,0);return}K.set(0,0,K.z<0?-1:1)}function createGrabPointer(K,_,Z,te={},ne="grab"){return new Pointer$1(generateUniquePointerId(),ne,Z,new SphereIntersector(_,()=>te.radius??.07,te),K,void 0,void 0,void 0,te)}function createRayPointer(K,_,Z,te={},ne="ray"){return new Pointer$1(generateUniquePointerId(),ne,Z,new RayIntersector(_,te),K,void 0,void 0,void 0,te)}function createLinesPointer(K,_,Z,te={},ne="lines"){return new Pointer$1(generateUniquePointerId(),ne,Z,new LinesIntersector(_,te),K,void 0,void 0,void 0,te)}function createTouchPointer(K,_,Z,te={},ne="touch"){return new Pointer$1(generateUniquePointerId(),ne,Z,new SphereIntersector(_,()=>te.hoverRadius??.1,te),K,createUpdateTouchPointer(te),void 0,void 0,te)}function createUpdateTouchPointer(K){let _=!1;return Z=>{if(!Z.getEnabled())return;const te=Z.getIntersection(),ne=computeIsPointerDown(te,K.downRadius??.03);if(ne===_)return;const ie={timeStamp:performance.now(),button:K.button??0};ne?Z.down(ie):Z.up(ie),_=ne}}function computeIsPointerDown(K,_){return K==null?!1:K.distance<=_}let pointerIdCounter=23412;function generateUniquePointerId(){return pointerIdCounter++}function htmlEventToCoords(K,_,Z){if(!(_ instanceof globalThis.MouseEvent))return Z.set(0,0);const{width:te,height:ne,top:ie,left:oe}=K.getBoundingClientRect(),se=_.clientX-oe,ae=_.clientY-ie;return Z.set(se/te*2-1,-(ae/ne)*2+1)}function forwardHtmlEvents(K,_,Z,te){return forwardEvents(K,typeof _=="function"?_:()=>_,Z,htmlEventToCoords.bind(null,K),K.setPointerCapture.bind(K),ne=>{K.hasPointerCapture(ne)&&K.releasePointerCapture(ne)},{pointerTypePrefix:"screen-",...te})}function portalEventToCoords(K,_){return!(K instanceof PointerEvent)||K.uv==null?_.set(0,0):_.copy(K.uv).multiplyScalar(2).addScalar(-1)}function forwardObjectEvents(K,_,Z,te){return forwardEvents(K,_,Z,portalEventToCoords,K.setPointerCapture.bind(K),K.releasePointerCapture.bind(K),te)}function forwardEvents(K,_,Z,te,ne,ie,oe={}){const se=(oe==null?void 0:oe.forwardPointerCapture)??!0,ae=new Map,le=oe.pointerTypePrefix??"forward-",ce=(Re,we)=>{let Pe=ae.get(Re.pointerId);return Pe!=null||(Pe=new Pointer$1(generateUniquePointerId(),`${le}${Re.pointerType}`,Re.pointerState,new ScreenRayIntersector((Ie,$e)=>(te(Ie,$e),_()),oe),_,void 0,se?ne.bind(null,Re.pointerId):void 0,se?ie.bind(null,Re.pointerId):void 0,oe),we!="move"&&we!="wheel"&&(Pe.setIntersection(Pe.computeIntersection("pointer",Z,Re)),Pe.commit(Re,!1)),ae.set(Re.pointerId,Pe)),Pe},fe=new Map,de=new Map,pe=[],he=[],ge=(Re,we,Pe)=>{switch(Re){case"move":Pe.move(Z,we);return;case"wheel":Pe.wheel(Z,we);return;case"cancel":Pe.cancel(we);return;case"down":if(!hasButton(we))return;Pe.down(we);return;case"up":if(!hasButton(we))return;Pe.up(we);return;case"exit":de.delete(Pe),fe.delete(Pe),Pe.exit(we);return}},me=(Re,we)=>{const Pe=ce(we,Re);Re==="move"&&de.set(Pe,we),Re==="wheel"&&fe.set(Pe,we),oe.batchEvents??!0?he.push({type:Re,event:we}):ge(Re,we,Pe)},Ae=me.bind(null,"move"),ye=me.bind(null,"cancel"),ve=me.bind(null,"down"),_e=me.bind(null,"up"),Te=me.bind(null,"wheel"),be=me.bind(null,"exit");return K.addEventListener("pointermove",Ae),K.addEventListener("pointercancel",ye),K.addEventListener("pointerdown",ve),K.addEventListener("pointerup",_e),K.addEventListener("wheel",Te),K.addEventListener("pointerleave",be),{destroy(){K.removeEventListener("pointermove",Ae),K.removeEventListener("pointercancel",ye),K.removeEventListener("pointerdown",ve),K.removeEventListener("pointerup",_e),K.removeEventListener("wheel",Te),K.removeEventListener("pointerleave",be),de.clear(),fe.clear()},update(){const Re=he.length;for(let we=0;we<Re;we++){const{type:Pe,event:Ie}=he[we],$e=ce(Ie,Pe);if(Pe==="move"&&(pe.push($e),de.get($e)!=Ie)){$e.emitMove(Ie);continue}if(Pe==="wheel"&&fe.get($e)!=Ie){$e.emitWheel(Ie);continue}ge(Pe,Ie,$e)}if(he.length=0,oe.intersectEveryFrame??!1)for(const[we,Pe]of de.entries())pe.includes(we)||we.move(Z,Pe);pe.length=0}}}function hasButton(K){return K.button!=null}let CombinedPointer$1=class Aa{constructor(_){Dn(this,"enableMultiplePointers");Dn(this,"pointers",[]);Dn(this,"isDefaults",[]);Dn(this,"enabled",!0);Dn(this,"activePointer");Dn(this,"nonCapturedPointers",[]);this.enableMultiplePointers=_}register(_,Z=!1){return this.pointers.push(_),this.isDefaults.push(Z),this.unregister.bind(this,_)}unregister(_){const Z=this.pointers.indexOf(_);Z!==-1&&(this.isDefaults.splice(Z,1),this.pointers.splice(Z,1))}startIntersection(_,Z){const te=this.pointers.length;let ne=!1;for(let ie=0;ie<te;ie++){const oe=this.pointers[ie];if(oe instanceof Aa){oe.startIntersection(_,Z);continue}const se=oe.getPointerCapture();if(se!=null){ne=!0,oe.setIntersection(oe.intersector.intersectPointerCapture(se,Z));continue}_.push(oe),oe.intersector.startIntersection(Z)}return ne}getIntersection(){var _;return(_=this.activePointer)==null?void 0:_.getIntersection()}getPointerCapture(){var _;return(_=this.activePointer)==null?void 0:_.getPointerCapture()}computeActivePointer(){let _;this.activePointer=void 0;const Z=this.pointers.length;for(let te=0;te<Z;te++){const ne=this.pointers[te];ne instanceof Aa&&ne.computeActivePointer();const ie=ne.getIntersection(),oe=ne.getPointerCapture()!=null?-1/0:ie!=null&&ie.object.isVoidObject?1/0:(ie==null?void 0:ie.distance)??1/0,se=this.isDefaults[te];(_==null||se&&oe===_||oe<_)&&(this.activePointer=ne,_=oe)}}commit(_,Z,te=!0){if(this.enableMultiplePointers){const ie=this.pointers.length;for(let oe=0;oe<ie;oe++)this.pointers[oe].commit(_,Z);return}te&&this.computeActivePointer();const ne=this.pointers.length;for(let ie=0;ie<ne;ie++){const oe=this.pointers[ie];oe.setEnabled(oe===this.activePointer,_,!1),oe.commit(_,Z,!1)}}move(_,Z){if(!this.enabled)return;if(this.nonCapturedPointers.length=0,!this.startIntersection(this.nonCapturedPointers,Z)||this.enableMultiplePointers){intersectPointerEventTargets("pointer",_,this.nonCapturedPointers);const ne=this.nonCapturedPointers.length;for(let ie=0;ie<ne;ie++){const oe=this.nonCapturedPointers[ie];oe.setIntersection(oe.intersector.finalizeIntersection(_))}}this.commit(Z,!0)}setEnabled(_,Z){this.enabled=_;const te=this.pointers.length;for(let ne=0;ne<te;ne++){const ie=this.pointers[ne];ie.setEnabled(_&&(this.enableMultiplePointers||ie==this.activePointer),Z)}}};const __vite_import_meta_env__$2={},createStoreImpl$2=K=>{let _;const Z=new Set,te=(ce,fe)=>{const de=typeof ce=="function"?ce(_):ce;if(!Object.is(de,_)){const pe=_;_=fe??(typeof de!="object"||de===null)?de:Object.assign({},_,de),Z.forEach(he=>he(_,pe))}},ne=()=>_,ae={setState:te,getState:ne,getInitialState:()=>le,subscribe:ce=>(Z.add(ce),()=>Z.delete(ce)),destroy:()=>{(__vite_import_meta_env__$2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),Z.clear()}},le=_=K(te,ne,ae);return ae},createStore$2=K=>K?createStoreImpl$2(K):createStoreImpl$2,vectorHelper$4=new Vector3,directionHelper=new Vector3,positionHelper$2=new Vector3,quaternionHelper$5=new Quaternion;function isFacingCamera(K,_,Z,te){return _.getWorldQuaternion(quaternionHelper$5),directionHelper.copy(Z).applyQuaternion(quaternionHelper$5),_.getWorldPosition(positionHelper$2),K.getWorldPosition(vectorHelper$4),vectorHelper$4.sub(positionHelper$2),vectorHelper$4.angleTo(directionHelper)<te/2}function isAppleVisionPro(){return navigator.userAgent.includes("Macintosh")&&navigator.xr!=null}function buildXRSessionInit(K,_,{anchors:Z=!0,handTracking:te=!isAppleVisionPro(),layers:ne=!0,meshDetection:ie=!0,planeDetection:oe=!0,customSessionInit:se,depthSensing:ae=!1,hitTest:le=!0,domOverlay:ce=!0,bodyTracking:fe=!1,bounded:de}={}){if(se!=null)return se;const pe=de==null?["local-floor"]:de?["bounded-floor"]:["unbounded","local-floor"],he=[];ce instanceof Element&&(ce=!0),addXRSessionFeature(Z,"anchors",pe,he),addXRSessionFeature(te,"hand-tracking",pe,he),addXRSessionFeature(ne,"layers",pe,he),addXRSessionFeature(ie,"mesh-detection",pe,he),addXRSessionFeature(oe,"plane-detection",pe,he),addXRSessionFeature(ae,"depth-sensing",pe,he),addXRSessionFeature(ce,"dom-overlay",pe,he),addXRSessionFeature(le,"hit-test",pe,he),addXRSessionFeature(fe,"body-tracking",pe,he);const ge={requiredFeatures:pe,optionalFeatures:he};return _!=null&&(ge.domOverlay={root:_}),ae&&Object.assign(ge,{depthSensing:{usagePreference:["gpu-optimized"],dataFormatPreference:[]}}),ge}function addXRSessionFeature(K,_,Z,te){if(K!==!1){if(K===!0){te.push(_);return}Z.push(_)}}function resolveInputSourceImplementation(K,_,Z){return typeof K=="function"?K:(typeof K=="object"&&(_!=null&&hasKey(K,_)?K=K[_]:"default"in K&&(K=K.default)),K===!1?!1:K===!0?Z:K??Z)}function hasKey(K,_){return _ in K}const baseInitialState={session:void 0,mediaBinding:void 0,originReferenceSpace:void 0,visibilityState:void 0,mode:null,frameRate:void 0,inputSourceStates:[],detectedMeshes:[],detectedPlanes:[],layerEntries:[]};async function injectEmulator(K,_,Z){var oe,se;if(typeof navigator>"u")return!1;const[te,ne]=await Promise.all([(oe=navigator.xr)==null?void 0:oe.isSessionSupported("immersive-vr").catch(ae=>(console.error(ae),!1)),(se=navigator.xr)==null?void 0:se.isSessionSupported("immersive-ar").catch(ae=>(console.error(ae),!1))]);if(ne||te)return!1;const{emulate:ie}=await __vitePreload(async()=>{const{emulate:ae}=await import("./chunk-JV_3G-wq.js");return{emulate:ae}},__vite__mapDeps([0,1,2,3]));return Z&&window.alert("emulator started"),K.setState({emulator:ie(_===!0?"metaQuest3":_)}),!0}function createXRStore$1(K){const _=typeof HTMLElement>"u"?void 0:(K==null?void 0:K.domOverlay)instanceof HTMLElement?K.domOverlay:document.createElement("div"),Z=createStore$2(()=>({...baseInitialState,controller:K==null?void 0:K.controller,hand:K==null?void 0:K.hand,gaze:K==null?void 0:K.gaze,screenInput:K==null?void 0:K.screenInput,transientPointer:K==null?void 0:K.transientPointer,domOverlayRoot:_})),te=Z.subscribe(({session:pe},{session:he})=>{he!=null&&pe==null&&fe!=null&&offerSession(fe,K,_).catch(console.error)}),ne=(K==null?void 0:K.emulate)??"metaQuest3";let ie;if(typeof window<"u"&&ne!=!1){const pe=(typeof ne=="object"?ne.inject:void 0)??{hostname:"localhost"};(pe===!0||typeof pe!="boolean"&&window.location.hostname===pe.hostname)&&injectEmulator(Z,ne,!1).then(ge=>{!ge||fe==null||offerSession(fe,K,_)});const he=ge=>{ge.altKey&&ge.metaKey&&ge.code==="KeyE"&&injectEmulator(Z,ne,!0).then(me=>{!me||fe==null||offerSession(fe,K,_)})};window.addEventListener("keydown",he),ie=()=>window.removeEventListener("keydown",he)}let oe;if(_!=null){if(_.parentNode==null){const pe=ge=>{_.style.display=ge.session!=null?"block":"none"},he=Z.subscribe(pe);pe(Z.getState()),document.body.appendChild(_),oe=()=>{_.remove(),he()}}document.body.append(_)}const se=createSyncXRInputSourceStates(pe=>Z.setState({inputSourceStates:[...Z.getState().inputSourceStates,pe]}),K),ae=createBindToSession(Z,se,(K==null?void 0:K.secondaryInputSources)??!1),le=setupSessionGrantedListener(K==null?void 0:K.enterGrantedSession,pe=>enterXRSession(_,pe,K,fe)),ce=[];let fe;const de=()=>{Z.setState(ae(fe.getSession()))};return Object.assign(Z,{addLayerEntry(pe){Z.getState().session!=null&&Z.setState({layerEntries:[...Z.getState().layerEntries,pe]})},removeLayerEntry(pe){Z.getState().session!=null&&Z.setState({layerEntries:Z.getState().layerEntries.filter(he=>he!=pe)})},requestFrame(){return new Promise(pe=>ce.push(pe))},setWebXRManager(pe){if(fe===pe)return;fe==null||fe.removeEventListener("sessionstart",de),fe=pe,fe.addEventListener("sessionstart",de);const{foveation:he,bounded:ge}=K??{};fe.setReferenceSpaceType(ge?"bounded-floor":"local-floor"),he!=null&&fe.setFoveation(he),offerSession(fe,K,_).catch(console.error)},setFrameRate(pe){const{session:he}=Z.getState();he!=null&&setFrameRate(he,pe)},setHand(pe,he){if(he==null){Z.setState({hand:pe});return}const ge=Z.getState().hand,me={};typeof ge=="object"&&Object.assign(me,ge),Object.assign(me,{default:resolveInputSourceImplementation(ge,void 0,{}),[he]:pe}),Z.setState({hand:me})},setController(pe,he){if(he==null){Z.setState({controller:pe});return}const ge=Z.getState().controller,me={};typeof ge=="object"&&Object.assign(me,ge),Object.assign(me,{default:resolveInputSourceImplementation(ge,void 0,{}),[he]:pe}),Z.setState({controller:me})},setTransientPointer(pe,he){if(he==null){Z.setState({transientPointer:pe});return}const ge=Z.getState().transientPointer,me={};typeof ge=="object"&&Object.assign(me,ge),Object.assign(me,{default:resolveInputSourceImplementation(ge,void 0,{}),[he]:pe}),Z.setState({transientPointer:me})},setGaze(pe){Z.setState({gaze:pe})},setScreenInput(pe){Z.setState({screenInput:pe})},destroy(){fe==null||fe.removeEventListener("sessionstart",de),ie==null||ie(),oe==null||oe(),le==null||le(),te(),ae(void 0)},enterXR:pe=>enterXRSession(_,pe,K,fe),enterAR:()=>enterXRSession(_,"immersive-ar",K,fe),enterVR:()=>enterXRSession(_,"immersive-vr",K,fe),onBeforeFrame(pe,he,ge){let me;const Ae=(fe==null?void 0:fe.getReferenceSpace())??void 0,ye=Z.getState(),ve=he.parent??pe;if(ye.origin!=ve&&(me??(me={}),me.origin=ve),Ae!=ye.originReferenceSpace&&(me??(me={}),me.originReferenceSpace=Ae),ve.xrSpace=Ae,ye.origin!=ve&&ye.origin!=null&&(ye.origin.xrSpace=void 0),ge!=null&&(fe!=null&&updateSession(Z,ge,fe),ye.body!=ge.body&&(me??(me={}),me.body=ge.body)),me!=null&&Z.setState(me),ge!=null){const _e=ce.length;for(let Te=0;Te<_e;Te++)ce[Te](ge);ce.length=0}},onBeforeRender(){const{session:pe,layerEntries:he}=Z.getState();if(pe==null||fe==null)return;const ge=pe==null?void 0:pe.renderState.layers;if(ge==null)return;he.sort((ye,ve)=>ye.renderOrder-ve.renderOrder);let me=!1;const Ae=he.map(({layer:ye},ve)=>(ye!=ge[ve]&&(me=!0),ye));me&&(Ae.push(fe.getBaseLayer()),pe.updateRenderState({layers:Ae}))}})}async function offerSession(K,_,Z){var oe;const te=(_==null?void 0:_.offerSession)??!0;if(((oe=navigator.xr)==null?void 0:oe.offerSession)==null||te===!1)return;let ne;te===!0?ne=await navigator.xr.isSessionSupported("immersive-ar")??!1?"immersive-ar":"immersive-vr":ne=te;const ie=await navigator.xr.offerSession(ne,buildXRSessionInit(ne,Z,_));setupXRSession(ie,K,_)}async function setFrameRate(K,_){if(_===!1)return;const{supportedFrameRates:Z}=K;if(Z==null||Z.length===0)return;if(typeof _=="function"){const ne=_(Z);return ne===!1?void 0:K.updateTargetFrameRate(ne)}const te=_==="high"?1:_==="mid"?.5:0;return K.updateTargetFrameRate(Z[Math.ceil((Z.length-1)*te)])}async function enterXRSession(K,_,Z,te){if(typeof navigator>"u"||navigator.xr==null)return Promise.reject(new Error("WebXR not supported"));if(te==null)return Promise.reject(new Error("not connected to three.js. You either might be missing the <XR> component or the canvas is not yet loaded?"));const ne=await navigator.xr.requestSession(_,buildXRSessionInit(_,K,Z));return setupXRSession(ne,te,Z),ne}function setupXRSession(K,_,Z){setFrameRate(K,(Z==null?void 0:Z.frameRate)??"high"),setupXRManager(_,K,Z)}function setupXRManager(K,_,Z){if(K==null)return;const te=XRWebGLLayer.getNativeFramebufferScaleFactor(_);let ne=Z==null?void 0:Z.frameBufferScaling;typeof ne=="function"&&(ne=ne(te)),typeof ne=="string"&&(ne=ne==="high"?te:ne==="mid"?1:.5),ne!=null&&(K==null||K.setFramebufferScaleFactor(ne)),K==null||K.setSession(_)}const allSessionModes=["immersive-ar","immersive-vr","inline"];function setupSessionGrantedListener(K=allSessionModes,_){var te;if(typeof navigator>"u"||K===!1)return;K===!0&&(K=allSessionModes);const Z=async()=>{var ne;for(const ie of K)await((ne=navigator.xr)==null?void 0:ne.isSessionSupported(ie))&&_(ie)};return(te=navigator.xr)==null||te.addEventListener("sessiongranted",Z),()=>{var ne;return(ne=navigator.xr)==null?void 0:ne.removeEventListener("sessiongranted",Z)}}function createBindToSession(K,_,Z){let te;return ne=>{if(te==null||te(),ne==null)return{};const ie=[];let oe;const se=()=>{oe=void 0,K.setState({inputSourceStates:_(ne,K.getState().inputSourceStates,ie)}),ie.length=0},ae=(ge,me)=>{ie.push({isPrimary:ge,added:me.added,removed:me.removed}),oe==null&&(Z?oe=setTimeout(se,100):se())},le=ae.bind(null,!0);ne.addEventListener("inputsourceschange",le);let ce;if(Z){const ge=ae.bind(null,!1);ne.addEventListener("trackedsourceschange",ge),ce=()=>ne.removeEventListener("trackedsourceschange",ge)}const fe=()=>K.setState({frameRate:ne.frameRate,visibilityState:ne.visibilityState});ne.addEventListener("frameratechange",fe),ne.addEventListener("visibilitychange",fe);const de=()=>{te==null||te(),te=void 0,K.setState({emulator:K.getState().emulator,...baseInitialState})};ne.addEventListener("end",de);const pe=[{isPrimary:!0,added:ne.inputSources}];Z&&pe.push({isPrimary:!1,added:ne.trackedSources});const he=_(ne,[],pe);return te=()=>{ce==null||ce(),clearTimeout(oe),_(ne,K.getState().inputSourceStates,"remove-all"),ne.removeEventListener("end",de),ne.removeEventListener("frameratechange",fe),ne.removeEventListener("visibilitychange",fe),ne.removeEventListener("inputsourceschange",le)},{inputSourceStates:he,frameRate:ne.frameRate,visibilityState:ne.visibilityState,detectedMeshes:[],detectedPlanes:[],mode:ne.environmentBlendMode==="opaque"?"immersive-vr":"immersive-ar",session:ne,mediaBinding:typeof XRMediaBinding>"u"?void 0:new XRMediaBinding(ne)}}}function updateSession(K,_,Z){const te=Z.getReferenceSpace(),{detectedMeshes:ne,detectedPlanes:ie,session:oe,inputSourceStates:se}=K.getState();if(te==null||oe==null)return;const ae=updateDetectedEntities(ie,_.detectedPlanes),le=updateDetectedEntities(ne,_.detectedMeshes);(ie!=ae||ne!=le)&&K.setState({detectedPlanes:ae,detectedMeshes:le});const ce=se.length;for(let fe=0;fe<ce;fe++){const de=se[fe];switch(de.type){case"controller":updateXRControllerState(de);break;case"hand":updateXRHandState(de,_,Z);break}}}const emptyArray=[];function updateDetectedEntities(K,_){return _==null?emptyArray:K!=null&&equalContent(_,K)?K:Array.from(_)}function equalContent(K,_){if(K.size!=_.length)return!1;for(const Z of _)if(!K.has(Z))return!1;return!0}new BoxGeometry;new PlaneGeometry;async function loadXRControllerModel(K,_=DefaultGltfLoader){const{scene:Z}=await _.loadAsync(K.assetPath);return Z.clone(!0)}function configureXRControllerModel(K,_){K.renderOrder=(_==null?void 0:_.renderOrder)??0,K.traverse(Z=>{Z instanceof Mesh&&Z.material instanceof Material&&(Z.material.colorWrite=(_==null?void 0:_.colorWrite)??!0)})}function createUpdateXRControllerVisuals(K,_,Z){const te=[];for(const ne in _.components){const ie=_.components[ne];let oe=Z[ne];oe==null&&(Z[ne]=oe={state:"default"}),te.push(...Object.values(ie.visualResponses).map(se=>createUpdateVisualResponse(K,oe,se)))}return()=>{const ne=te.length;for(let ie=0;ie<ne;ie++)te[ie]()}}function createUpdateVisualResponse(K,_,Z){const te=K.getObjectByName(Z.valueNodeName);if(_.object=te,te==null)return()=>{};if(Z.valueNodeProperty==="visibility")return()=>te.visible=Z.states.includes(_.state);const ne=K.getObjectByName(Z.minNodeName),ie=K.getObjectByName(Z.maxNodeName);return ne==null||ie==null?()=>{}:()=>{const oe=getVisualReponseValue(_,Z);te.quaternion.slerpQuaternions(ne.quaternion,ie.quaternion,oe),te.position.lerpVectors(ne.position,ie.position,oe),te.updateMatrix()}}function getVisualReponseValue(K,{componentProperty:_,states:Z}){const te=Z.includes(K.state);switch(_){case"xAxis":return te?getNormalizesAxis(K).x:.5;case"yAxis":return te?getNormalizesAxis(K).y:.5;case"button":return te?K.button??0:0;case"state":return te?1:0}}const vector2Helper=new Vector2;function getNormalizesAxis({xAxis:K=0,yAxis:_=0}){if(vector2Helper.lengthSq()>1){const te=Math.atan2(_,K);vector2Helper.set(Math.cos(te),Math.sin(te))}else vector2Helper.set(K,_);return vector2Helper.multiplyScalar(.5).addScalar(.5),vector2Helper}function updateXRMeshGeometry(K,_){if(_!=null&&_.createdAt!=null&&_.createdAt>=K.lastChangedTime)return _;const Z=new BufferGeometry;return Z.setIndex(new BufferAttribute(K.indices,1)),Z.setAttribute("position",new BufferAttribute(K.vertices,3)),Object.assign(Z,{creationTime:K.lastChangedTime})}function updateXRPlaneGeometry(K,_){return _!=null&&_.createdAt!=null&&_.createdAt>=K.lastChangedTime?_:Object.assign(createGeometryFromPolygon(K.polygon),{createdAt:K.lastChangedTime})}const boxHelper=new Box2,sizeHelper=new Vector2;function createGeometryFromPolygon(K){if(K.length===0)return new BufferGeometry;const _=new Shape$2,Z=K.map(({x:ne,z:ie})=>new Vector2(ne,ie));boxHelper.setFromPoints(Z),boxHelper.getSize(sizeHelper);for(const ne of Z)ne.sub(boxHelper.min),ne.divide(sizeHelper);_.setFromPoints(Z);const te=new ShapeGeometry(_);return te.scale(sizeHelper.x,sizeHelper.y,1),te.translate(boxHelper.min.x,boxHelper.min.y,0),te.rotateX(Math.PI/2),te}function toDOMPointInit(K,_=1){if(K!=null)return{x:K.x,y:K.y,z:K.z,w:"w"in K?K.w:_}}const DefaultCentralAngle=60/180*Math.PI,DefaultCentralHorizontalAngle=60/180*Math.PI,DefaultLowerVerticalAngle=-30/180*Math.PI,DefaultUpperVerticalAngle=30/180*Math.PI;function createXRLayer(K,_,Z,te,ne,ie,oe){return K instanceof HTMLVideoElement?createXRVideoLayer(K,_,Z,ne,ie,oe):createXRNormalLayer(K,_.origin,Z,te,ne,ie,oe)}function createXRVideoLayer(K,_,Z,te,{invertStereo:ne,layout:ie,shape:oe="quad"},se={}){var pe;const ae=getSpaceFromAncestors(te,_.origin,Z,matrixHelper$1),le=matrixToRigidTransform(matrixHelper$1,scaleHelper$2),ce={invertStereo:ne,layout:ie,space:ae,transform:le};applyXRLayerScale(oe,ce,se.centralAngle,scaleHelper$2);const fe=`create${capitalize(oe)}Layer`,de=(pe=_.mediaBinding)==null?void 0:pe[fe](K,ce);if(de!=null)return updateXRLayerProperties(de,se),de}function createXRNormalLayer(K,_,Z,te,ne,{shape:ie="quad",...oe},se={}){var pe;const ae=getSpaceFromAncestors(ne,_,Z,matrixHelper$1),le=matrixToRigidTransform(matrixHelper$1,scaleHelper$2),ce={...oe,isStatic:!(K instanceof WebGLRenderTarget),textureType:"texture",viewPixelWidth:oe.layout==="stereo-left-right"?K.width/2:K.width,viewPixelHeight:oe.layout==="stereo-top-bottom"?K.height/2:K.height,space:ae,transform:le};applyXRLayerScale(ie,ce,se.centralAngle,scaleHelper$2);const fe=`create${capitalize(ie)}Layer`,de=(pe=te.getBinding())==null?void 0:pe[fe](ce);if(de!=null)return updateXRLayerProperties(de,se),de}const matrixHelper$1=new Matrix4,vectorHelper$3=new Vector3,quaternionHelper$4=new Quaternion,scaleHelper$2=new Vector3;function matrixToRigidTransform(K,_=scaleHelper$2){return K.decompose(vectorHelper$3,quaternionHelper$4,_),new XRRigidTransform(toDOMPointInit(vectorHelper$3),toDOMPointInit(quaternionHelper$4))}function setXRLayerRenderTarget(K,_,Z,te){if(Z!=null&&te!=null){const ne=K.xr.getBinding().getSubImage(Z.layer,te);K.setRenderTargetTextures(_,ne.colorTexture)}K.setRenderTarget(_)}function createXRLayerGeometry(K,_){switch(K){case"cylinder":const Z=_.centralAngle??DefaultCentralAngle;return new CylinderGeometry(1,1,1,32,1,!0,Math.PI-Z/2,Z).scale(-1,1,1);case"equirect":{const te=_.centralHorizontalAngle??DefaultCentralHorizontalAngle,ne=_.upperVerticalAngle??DefaultUpperVerticalAngle;return new SphereGeometry(1,32,16,-Math.PI/2-te/2,te,Math.PI/2-ne,ne-(_.lowerVerticalAngle??DefaultLowerVerticalAngle)).scale(-1,1,1)}case"quad":return new PlaneGeometry}}function capitalize(K){return`${K[0].toUpperCase()}${K.slice(1)}`}function updateXRLayerProperties(K,_={}){if(K.chromaticAberrationCorrection=_.chromaticAberrationCorrection,K.quality=_.quality??"default",K.blendTextureSourceAlpha=_.blendTextureSourceAlpha??!1,K instanceof XRCylinderLayer){K.centralAngle=(_==null?void 0:_.centralAngle)??DefaultCentralAngle;return}K instanceof XREquirectLayer&&(K.centralHorizontalAngle=(_==null?void 0:_.centralHorizontalAngle)??DefaultCentralHorizontalAngle,K.lowerVerticalAngle=(_==null?void 0:_.lowerVerticalAngle)??DefaultLowerVerticalAngle,K.upperVerticalAngle=(_==null?void 0:_.upperVerticalAngle)??DefaultUpperVerticalAngle)}function setupXRImageLayer(K,_,Z,te){let ne=!1;const ie=async()=>{const oe=await _.requestFrame();ne||writeContentToXRLayer(K,Z,oe,te)};return Z.addEventListener("redraw",ie),ie(),()=>{ne=!0,Z.removeEventListener("redraw",ie)}}async function waitForXRLayerSrcSize(K){if(K instanceof HTMLImageElement&&!K.complete&&await new Promise(_=>{const Z=()=>{_(),K.removeEventListener("load",Z)};K.addEventListener("load",Z)}),K instanceof HTMLVideoElement&&K.readyState<1)return new Promise(_=>{const Z=()=>{_(),K.removeEventListener("loadedmetadata",Z)};K.addEventListener("loadedmetadata",Z)})}function getXRLayerSrcTexture(K){if(K instanceof WebGLRenderTarget)return K.texture;const _=K instanceof HTMLVideoElement?new VideoTexture(K):new Texture$1(K);return _.colorSpace=SRGBColorSpace$2,_.needsUpdate=!0,_}function writeContentToXRLayer(K,_,Z,te){const ne=K.getContext(),ie=K.xr.getBinding().getSubImage(_,Z);K.state.bindTexture(ne.TEXTURE_2D,ie.colorTexture),ne.pixelStorei(ne.UNPACK_FLIP_Y_WEBGL,!0),ne.texSubImage2D(ne.TEXTURE_2D,0,0,0,te.width,te.height,ne.RGBA,ne.UNSIGNED_BYTE,te)}function updateXRLayerTransform(K,_,Z,te){K.originReferenceSpace!=null&&(_.space=getSpaceFromAncestors(te,K.origin,K.originReferenceSpace,matrixHelper$1),_.transform=matrixToRigidTransform(matrixHelper$1,scaleHelper$2),applyXRLayerScale(getLayerShape(_),_,Z,scaleHelper$2))}function applyXRLayerScale(K,_,Z,te){if(K==="cylinder"){const ie=(te.x+te.z)/2,oe=ie*(Z??DefaultCentralAngle);_.radius=ie,_.aspectRatio=oe/te.y}else K==="quad"?(_.width=te.x/2,_.height=te.y/2):_.radius=(te.x+te.y+te.z)/3}function getLayerShape(K){return K instanceof XRCylinderLayer?"cylinder":K instanceof XREquirectLayer?"equirect":"quad"}function createXRLayerRenderTarget(K,_,Z){return new WebGLRenderTarget(K*Z,_*Z,{minFilter:LinearFilter,magFilter:LinearFilter,type:HalfFloatType,depthTexture:new DepthTexture(K,_)})}function makeTeleportTarget(K,_,Z){K.traverse(ne=>ne.userData.teleportTarget=!0);const te=ne=>{if("point"in ne&&ne.point instanceof Vector3){const ie=typeof _=="function"?_():_,oe=new Vector3().setFromMatrixPosition(ie.matrix).negate().setComponent(1,0).add(ne.point);Z(oe,ne)}};return K.addEventListener("pointerup",te),()=>{K.traverse(ne=>ne.userData.teleportTarget=!1),K.removeEventListener("pointerup",te)}}const eulerHelper$1=new Euler(0,0,0,"YXZ"),quaternionHelper$3=new Quaternion;function syncTeleportPointerRayGroup(K,_,Z){K.updateWorldMatrix(!0,!1),K.matrixWorld.decompose(_.position,quaternionHelper$3,_.scale),eulerHelper$1.setFromQuaternion(quaternionHelper$3),eulerHelper$1.z=0,eulerHelper$1.x=clamp$1(eulerHelper$1.x-10*Math.PI/180,-Math.PI/2,1.1*Math.PI/4),quaternionHelper$3.setFromEuler(eulerHelper$1),_.quaternion.slerp(quaternionHelper$3,Z/100)}function isTeleportTarget(K){return K.userData.teleportTarget===!0}function buildTeleportTargetFilter(K={}){return(_,Z,te,ne)=>!(!isTeleportTarget(_)||K.filter!=null&&!K.filter(_,Z,te,ne))}function createTeleportRayLine(){return new QuadraticBezierCurve3(new Vector3(0,0,0),new Vector3(0,0,-8),new Vector3(0,-20,-15)).getPoints(20)}let TeleportPointerRayModel$1=class extends Mesh{constructor(Z){const te=new MeshLineGeometry,ne=new Float32Array(Z.length*3);for(let se=0;se<Z.length;se++)Z[se].toArray(ne,se*3);te.setPoints(ne);const ie=(Z.length*3-3)/(Z.length*3-1),oe=new MeshLineMaterial({lineWidth:.1,resolution:void 0,visibility:ie});super(te,oe);Dn(this,"multiplier");Dn(this,"lineLengths");Dn(this,"options",{});this.material.transparent=!0,this.multiplier=ie,this.material=oe,this.lineLengths=Z.slice(0,-1).map((se,ae)=>se.distanceTo(Z[ae+1]))}update(Z){const te=Z.getEnabled(),ne=Z.getIntersection();if(!te||Z.getButtonsDown().size===0||ne==null){this.visible=!1;return}if(this.visible=!0,ne.details.type!="lines"){this.material.visibility=this.multiplier;return}const{distanceOnLine:ie,lineIndex:oe}=ne.details,se=this.lineLengths[oe];this.material.visibility=this.multiplier*(oe+ie/se)/this.lineLengths.length;const{color:ae="white",opacity:le=.4,size:ce=.01}=this.options;this.material.lineWidth=ce,this.material.opacity=typeof le=="function"?le(Z):le;const fe=typeof ae=="function"?ae(Z):ae;Array.isArray(fe)?this.material.color.set(...fe):this.material.color.set(fe)}};const matrixHelper=new Matrix4,vectorHelper$2=new Vector3,scaleHelper$1=new Vector3,quaternionHelper$2=new Quaternion;async function createXRHitTestSource(K,_,Z,te=["point","plane","mesh"]){var ce;typeof Z=="string"&&(Z=await _.requestReferenceSpace(Z));const ne=Array.isArray(te)?te:[te];let ie,oe,se;const ae=K.getState();if(Z instanceof XRSpace)ie={space:Z,entityTypes:ne},se=ae.origin;else{const fe=getSpaceFromAncestors(Z,ae.origin,ae.originReferenceSpace,matrixHelper);if(fe==null)return;matrixHelper.decompose(vectorHelper$2,quaternionHelper$2,scaleHelper$1);const de=toDOMPointInit(vectorHelper$2);vectorHelper$2.set(0,0,-1).applyQuaternion(quaternionHelper$2);const pe=new XRRay(de,toDOMPointInit(vectorHelper$2,0));se=Z,ie={space:fe,offsetRay:pe,entityTypes:ne},oe=fe}const le=await((ce=_==null?void 0:_.requestHitTestSource)==null?void 0:ce.call(_,ie));if(le!=null)return{source:le,getWorldMatrix:computeWorldMatrixFromXRHitTestResult.bind(null,K,oe,se)}}async function requestXRHitTest(K,_,Z){var le;const te=K.getState().session;if(te==null)return;const ne=await createXRHitTestSource(K,te,_,Z);if(ne==null)return;const{source:ie,getWorldMatrix:oe}=ne,se=await K.requestFrame(),ae=((le=se.getHitTestResults)==null?void 0:le.call(se,ie))??[];if(ie.cancel(),ae!=null)return{results:ae,getWorldMatrix:oe}}function computeWorldMatrixFromXRHitTestResult(K,_,Z,te,ne){if(_??(_=K.getState().originReferenceSpace),_==null)return!1;const ie=ne.getPose(_);return ie==null?!1:(te.fromArray(ie.transform.matrix),Z!=null&&(Z.updateWorldMatrix(!0,!1),te.premultiply(Z.matrixWorld)),!0)}const OneVector=new Vector3(1,1,1),ZeroVector=new Vector3(0,0,0),NeutralQuaternion=new Quaternion,matrixHelper1=new Matrix4,matrixHelper2=new Matrix4,quaternionHelper$1=new Quaternion,positionHelper$1=new Vector3,vectorHelper$1=new Vector3;async function requestXRAnchor(K,_){var ne,ie,oe;if(_.relativeTo==="hit-test-result")return(ie=(ne=_.hitTestResult).createAnchor)==null?void 0:ie.call(ne,new XRRigidTransform(toDOMPointInit(_.offsetPosition),toDOMPointInit(_.offsetQuaternion)));let Z,te;if(_.relativeTo==="world"){Z=_.frame??await K.requestFrame();const{origin:se,originReferenceSpace:ae}=K.getState();if(ae==null)return;te=ae;const{worldPosition:le,worldQuaternion:ce}=_;se!=null?(se.updateWorldMatrix(!0,!1),matrixHelper1.copy(se.matrixWorld).invert(),matrixHelper2.compose(le,ce,OneVector).multiply(matrixHelper1),matrixHelper2.decompose(positionHelper$1,quaternionHelper$1,vectorHelper$1)):(positionHelper$1.copy(le),quaternionHelper$1.copy(ce))}else{Z=_.frame??await K.requestFrame(),te=_.space;const{offsetPosition:se,offsetQuaternion:ae}=_;positionHelper$1.copy(se??ZeroVector),quaternionHelper$1.copy(ae??NeutralQuaternion)}return(oe=Z.createAnchor)==null?void 0:oe.call(Z,new XRRigidTransform(toDOMPointInit(positionHelper$1),toDOMPointInit(quaternionHelper$1)),te)}const defaultSpeed=2,defaultSmoothTurningSpeed=2,defaultSnapDegrees=45,defaultDeadZone=.5,thumbstickPropName="xr-standard-thumbstick",vectorHelper=new Vector3,quaternionHelper=new Quaternion,eulerHelper=new Euler,positionHelper=new Vector3,scaleHelper=new Vector3;function createXRControllerLocomotionUpdate(){let K=!0;return(_,Z,te,ne,ie={},oe={},se="left",...ae)=>{var ve;const{inputSourceStates:le}=Z.getState(),ce=se==="left"?"right":"left",fe=le.find(_e=>isControllerWithHandedness(_e,se)),de=le.find(_e=>isControllerWithHandedness(_e,ce));if(fe==null||de==null)return;const pe=fe.gamepad[thumbstickPropName],he=(pe==null?void 0:pe.xAxis)??0,ge=(pe==null?void 0:pe.yAxis)??0,me=((ve=de.gamepad[thumbstickPropName])==null?void 0:ve.xAxis)??0;let Ae;oe!==!1&&(oe===!0&&(oe={}),oe.type==="smooth"?Math.abs(me)>(oe.deadZone??defaultDeadZone)&&(Ae=(me<0?-1:1)*ne*(oe.speed??defaultSmoothTurningSpeed)):Math.abs(me)<(oe.deadZone??defaultDeadZone)?K=!0:K&&(K=!1,Ae=(me>0?-1:1)*MathUtils.degToRad(oe.degrees??defaultSnapDegrees)));const ye=he!=0||ge!=0;if(ie!==!1&&ye){ie===!0&&(ie={});const{speed:_e=defaultSpeed}=ie;vectorHelper.set(he*_e,0,ge*_e),te.matrixWorld.decompose(positionHelper,quaternionHelper,scaleHelper),vectorHelper.applyQuaternion(quaternionHelper),Ae&&vectorHelper.applyEuler(eulerHelper.set(0,Ae,0,"YXZ"))}if(!(!ye&&Ae==null)){if(typeof _=="function"){_(vectorHelper,Ae??0,...ae);return}_!=null&&(_.position.x+=vectorHelper.x*ne,_.position.z+=vectorHelper.z*ne,_.rotation.y+=Ae??0)}}}function isControllerWithHandedness(K,_){return K.type==="controller"&&K.inputSource.handedness===_}const DefaultGltfLoader=new GLTFLoader,DefaultAssetBasePath="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/";function syncAsync(K,..._){let Z=K();for(const te of _)Z instanceof Promise?Z=Z.then(te):Z=te(Z);return Z}const DefaultDefaultControllerProfileId="generic-trigger";class XRControllerLayoutLoader{constructor(_){Dn(this,"baseAssetPath");Dn(this,"defaultProfileId");Dn(this,"profilesListCache");Dn(this,"profileCacheMap",new Map);Dn(this,"loadAsync",this.load);this.baseAssetPath=(_==null?void 0:_.baseAssetPath)??DefaultAssetBasePath,this.defaultProfileId=(_==null?void 0:_.defaultControllerProfileId)??DefaultDefaultControllerProfileId}load(_,Z){return syncAsync(()=>this.loadProfile(_),te=>{for(const ne in te.layouts)if(ne.includes(Z))return te.layouts[ne];throw new Error(`No matching layout for "${Z}", in profile ${te.profileId} with layouts ${Object.keys(te.layouts).join(", ")}.`)})}loadProfile(_){return syncAsync(()=>this.profilesListCache??fetchJson(new URL("profilesList.json",this.baseAssetPath).href).then(Z=>this.profilesListCache=Z),Z=>{const te=_.length;let ne;for(let ie=0;ie<te&&(ne=Z[_[ie]],ne==null);ie++);if(ne??(ne=Z[this.defaultProfileId]),ne==null)throw new Error(`no matching profile found for profiles "${_.join(", ")}" in profile list ${JSON.stringify(Z)}`);return this.loadProfileFromPath(ne.path)})}loadProfileFromPath(_){const Z=this.profileCacheMap.get(_);if(Z!=null)return Z;const te=new URL(_,this.baseAssetPath).href;return fetchJson(te).then(ne=>{for(const ie in ne.layouts){const oe=ne.layouts[ie];oe!=null&&(oe.assetPath=new URL(oe.assetPath,te).href)}return this.profileCacheMap.set(_,ne),ne})}}async function fetchJson(K){let _=await fetch(K);return _.ok?_.json():Promise.reject(new Error(_.statusText))}function createXRControllerState(K,_,Z,te,ne){return syncAsync(()=>Z.load(_.profiles,_.handedness),ie=>{const oe={};return updateXRControllerGamepadState(oe,_,ie),{id:K,isPrimary:ne,events:te,type:"controller",inputSource:_,gamepad:oe,layout:ie}})}function updateXRControllerState({gamepad:K,inputSource:_,layout:Z}){updateXRControllerGamepadState(K,_,Z)}const xrContext=reactExports.createContext(void 0),xrInputSourceStateContext=reactExports.createContext(void 0),xrSpaceContext=reactExports.createContext(void 0),combinedPointerContext=reactExports.createContext(void 0),__vite_import_meta_env__$1={},createStoreImpl$1=K=>{let _;const Z=new Set,te=(ce,fe)=>{const de=typeof ce=="function"?ce(_):ce;if(!Object.is(de,_)){const pe=_;_=fe??(typeof de!="object"||de===null)?de:Object.assign({},_,de),Z.forEach(he=>he(_,pe))}},ne=()=>_,ae={setState:te,getState:ne,getInitialState:()=>le,subscribe:ce=>(Z.add(ce),()=>Z.delete(ce)),destroy:()=>{(__vite_import_meta_env__$1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),Z.clear()}},le=_=K(te,ne,ae);return ae},createStore$1=K=>K?createStoreImpl$1(K):createStoreImpl$1,__vite_import_meta_env__={},{useDebugValue}=React,{useSyncExternalStoreWithSelector:useSyncExternalStoreWithSelector$1}=useSyncExternalStoreExports$1;let didWarnAboutEqualityFn=!1;const identity$4=K=>K;function useStore(K,_=identity$4,Z){(__vite_import_meta_env__?"production":void 0)!=="production"&&Z&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const te=useSyncExternalStoreWithSelector$1(K.subscribe,K.getState,K.getServerState||K.getInitialState,_,Z);return useDebugValue(te),te}const createImpl=K=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&typeof K!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const _=typeof K=="function"?createStore$1(K):K,Z=(te,ne)=>useStore(_,te,ne);return Object.assign(Z,_),Z},create$9=K=>K?createImpl(K):createImpl;function shallow$1$1(K,_){if(Object.is(K,_))return!0;if(typeof K!="object"||K===null||typeof _!="object"||_===null)return!1;if(K instanceof Map&&_ instanceof Map){if(K.size!==_.size)return!1;for(const[te,ne]of K)if(!Object.is(ne,_.get(te)))return!1;return!0}if(K instanceof Set&&_ instanceof Set){if(K.size!==_.size)return!1;for(const te of K)if(!_.has(te))return!1;return!0}const Z=Object.keys(K);if(Z.length!==Object.keys(_).length)return!1;for(const te of Z)if(!Object.prototype.hasOwnProperty.call(_,te)||!Object.is(K[te],_[te]))return!1;return!0}const XRControllerComponent=reactExports.forwardRef(({id:K,children:_,onPress:Z,onRelease:te},ne)=>{const ie=useXRInputSourceStateContext("controller"),[oe,se]=reactExports.useState(void 0);if(reactExports.useImperativeHandle(ne,()=>oe,[oe]),useXRControllerButtonEvent(ie,K,ae=>ae==="pressed"?Z==null?void 0:Z():te==null?void 0:te()),useFrame(()=>{var ae;return se((ae=ie.gamepad[K])==null?void 0:ae.object)}),oe!=null)return createPortal(_,oe)});function useXRControllerButtonEvent(K,_,Z){const te=reactExports.useRef(void 0);useFrame(()=>{var ie;const ne=(ie=K==null?void 0:K.gamepad[_])==null?void 0:ie.state;ne!=null&&ne!=te.current&&Z(ne),te.current=ne})}const LoadXRControllerModelSymbol=Symbol("loadXRControllerModel"),XRControllerModel=reactExports.forwardRef((K,_)=>{const Z=useXRInputSourceStateContext("controller"),te=suspend$1(loadXRControllerModel,[Z.layout,void 0,LoadXRControllerModelSymbol]);configureXRControllerModel(te,K),Z.object=te,reactExports.useImperativeHandle(_,()=>te,[te]);const ne=reactExports.useMemo(()=>createUpdateXRControllerVisuals(te,Z.layout,Z.gamepad),[te,Z.layout,Z.gamepad]);return useFrame(ne),jsxRuntimeExports.jsx(XRSpace$1,{space:"grip-space",children:jsxRuntimeExports.jsx("primitive",{object:te})})}),LoadXRControllerLayoutSymbol=Symbol("loadXRControllerLayout");function useLoadXRControllerLayout(K,_,{baseAssetPath:Z,defaultControllerProfileId:te}={}){const ne=reactExports.useMemo(()=>new XRControllerLayoutLoader({baseAssetPath:Z,defaultControllerProfileId:te}),[Z,te]);return suspend$1(()=>{const ie=ne.loadAsync(K,_);return ie instanceof Promise?ie:Promise.resolve(ie)},[LoadXRControllerLayoutSymbol,_,...K])}function useLoadXRControllerModel(K){return suspend$1(loadXRControllerModel,[K,void 0,LoadXRControllerModelSymbol])}const XRHandModel=reactExports.forwardRef((K,_)=>{const Z=useXRInputSourceStateContext("hand"),te=useLoader(GLTFLoader,Z.assetPath),ne=reactExports.useMemo(()=>cloneXRHandGltf(te),[te]);configureXRHandModel(ne,K),Z.object=ne,reactExports.useImperativeHandle(_,()=>ne,[ne]);const ie=useXRSpace(),oe=reactExports.useMemo(()=>createUpdateXRHandVisuals(Z.inputSource.hand,ne,ie),[Z.inputSource,ne,ie]);return useFrame((se,ae,le)=>oe(le)),jsxRuntimeExports.jsx("primitive",{object:ne})}),XRHandJoint=reactExports.forwardRef(({joint:K,children:_},Z)=>jsxRuntimeExports.jsx(XRSpace$1,{ref:Z,space:K,children:_}));function CombinedPointer({children:K}){const _=reactExports.useMemo(()=>new CombinedPointer$1(!1),[]);return useSetupPointer(_),jsxRuntimeExports.jsx(combinedPointerContext.Provider,{value:_,children:K})}function clearObject(K){for(const _ of Object.keys(K))delete K[_]}function useGrabPointer(K,_,Z,te){const ne=reactExports.useMemo(()=>({}),[]);clearObject(ne),Object.assign(ne,Z);const ie=useStore$3(),oe=reactExports.useMemo(()=>createGrabPointer(()=>ie.getState().camera,K,_,ne,te),[ie,K,_,ne,te]);return useSetupPointer(oe,Z==null?void 0:Z.makeDefault),oe}function useRayPointer(K,_,Z,te){const ne=reactExports.useMemo(()=>({}),[]);clearObject(ne),Object.assign(ne,Z);const ie=useStore$3(),oe=reactExports.useMemo(()=>createRayPointer(()=>ie.getState().camera,K,_,ne,te),[ie,K,_,ne,te]);return useSetupPointer(oe,Z==null?void 0:Z.makeDefault),oe}function useLinesPointer(K,_,Z,te){const ne=reactExports.useMemo(()=>({}),[]);clearObject(ne),Object.assign(ne,Z);const ie=useStore$3(),oe=reactExports.useMemo(()=>createLinesPointer(()=>ie.getState().camera,K,_,ne,te),[ie,K,_,ne,te]);return useSetupPointer(oe,Z==null?void 0:Z.makeDefault),oe}function useTouchPointer(K,_,Z,te){const ne=reactExports.useMemo(()=>({}),[]);clearObject(ne),Object.assign(ne,Z);const ie=useStore$3(),oe=reactExports.useMemo(()=>createTouchPointer(()=>ie.getState().camera,K,_,ne,te),[ie,K,_,ne,te]);return useSetupPointer(oe,Z==null?void 0:Z.makeDefault),oe}const PointerRayModel=reactExports.forwardRef((K,_)=>{const Z=reactExports.useMemo(()=>{const ne=K.materialClass??PointerRayMaterial;return new ne},[K.materialClass]),te=reactExports.useRef(null);return reactExports.useImperativeHandle(_,()=>te.current,[]),useFrame(()=>te.current!=null&&updatePointerRayModel(te.current,Z,K.pointer,K)),jsxRuntimeExports.jsx("mesh",{matrixAutoUpdate:!1,renderOrder:K.renderOrder??2,ref:te,material:Z,children:jsxRuntimeExports.jsx("boxGeometry",{})})}),PointerCursorModel=reactExports.forwardRef((K,_)=>{const Z=reactExports.useMemo(()=>{const oe=K.materialClass??PointerCursorMaterial;return new oe},[K.materialClass]),te=reactExports.useRef(null),ne=reactExports.useRef(null);reactExports.useImperativeHandle(_,()=>te.current,[]),useFrame(()=>te.current!=null&&ne.current!=null&&updatePointerCursorModel(ne.current,te.current,Z,K.pointer,K));const ie=useThree(oe=>oe.scene);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("group",{ref:ne}),createPortal(jsxRuntimeExports.jsx("mesh",{renderOrder:K.renderOrder??1,ref:te,matrixAutoUpdate:!1,material:Z,children:jsxRuntimeExports.jsx("planeGeometry",{})}),ie)]})});function usePointerXRInputSourceEvents(K,_,Z,te){const ne=useXR(ie=>ie.session);reactExports.useEffect(()=>{if(ne!=null)return bindPointerXRInputSourceEvent(K,ne,_,Z,te)},[Z,_,K,ne,te])}function useSetupPointer(K,_=!1){const Z=reactExports.useContext(combinedPointerContext);if(Z==null)throw new Error("xr pointers can only be used inside the XR component");reactExports.useEffect(()=>{const te=Z.register(K,_);return()=>{te()}},[Z,K,_]),reactExports.useEffect(()=>{if(K instanceof Pointer$1)return()=>K.exit({timeStamp:performance.now()})},[K])}function TeleportTarget({children:K,onTeleport:_}){const Z=reactExports.useRef(null),te=reactExports.useRef(_);te.current=_;const ne=useStore$3();return reactExports.useEffect(()=>{if(Z.current!=null)return makeTeleportTarget(Z.current,()=>ne.getState().camera,(ie,oe)=>{var se;return(se=te.current)==null?void 0:se.call(te,ie,oe)})},[ne]),jsxRuntimeExports.jsx("group",{pointerEventsType:{allow:"teleport"},ref:Z,children:K})}const TeleportPointerRayModel=reactExports.forwardRef(({pointer:K,linePoints:_,...Z},te)=>{const ne=reactExports.useMemo(()=>new TeleportPointerRayModel$1(_),[_]);return reactExports.useImperativeHandle(te,()=>ne,[ne]),ne.options=Z,useFrame(()=>ne.update(K)),jsxRuntimeExports.jsx("primitive",{object:ne})});function DefaultXRInputSourceGrabPointer(K,_,Z){const te=reactExports.useContext(xrInputSourceStateContext);if(te==null)throw new Error("DefaultXRInputSourceGrabPointer can only be used inside a XRInputSource");const ne=reactExports.useRef(null),ie=useGrabPointer(ne,te,Z);usePointerXRInputSourceEvents(ie,te.inputSource,K,te.events);const oe=Z.cursorModel;return jsxRuntimeExports.jsx(XRSpace$1,{ref:ne,space:_,children:oe!==!1&&jsxRuntimeExports.jsx(PointerCursorModel,{pointer:ie,opacity:defaultGrabPointerOpacity,...spreadable$1(oe)})})}const DefaultXRHandGrabPointer=DefaultXRInputSourceGrabPointer.bind(null,"select","index-finger-tip"),DefaultXRControllerGrabPointer=DefaultXRInputSourceGrabPointer.bind(null,"squeeze","grip-space");function DefaultXRInputSourceRayPointer(K){const _=useXRInputSourceStateContext(),Z=reactExports.useRef(null),te=useRayPointer(Z,_,K);usePointerXRInputSourceEvents(te,_.inputSource,"select",_.events);const ne=K.rayModel,ie=K.cursorModel;return jsxRuntimeExports.jsxs(XRSpace$1,{ref:Z,space:"target-ray-space",children:[ne!==!1&&jsxRuntimeExports.jsx(PointerRayModel,{pointer:te,opacity:defaultRayPointerOpacity,...spreadable$1(ne)}),ie!==!1&&jsxRuntimeExports.jsx(PointerCursorModel,{pointer:te,opacity:defaultRayPointerOpacity,...spreadable$1(ie)})]})}function DefaultXRHandTouchPointer(K){const _=useXRInputSourceStateContext("hand"),Z=reactExports.useRef(null),te=useTouchPointer(Z,_,K),ne=K.cursorModel;return jsxRuntimeExports.jsx(XRSpace$1,{ref:Z,space:_.inputSource.hand.get("index-finger-tip"),children:ne!==!1&&jsxRuntimeExports.jsx(PointerCursorModel,{pointer:te,opacity:defaultTouchPointerOpacity,...spreadable$1(ne)})})}function DefaultXRController(K){const _=K.model,Z=K.grabPointer,te=K.rayPointer,ne=K.teleportPointer??!1;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[_!==!1&&jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(XRControllerModel,{...spreadable$1(_)})}),jsxRuntimeExports.jsxs(CombinedPointer,{children:[Z!==!1&&jsxRuntimeExports.jsx(DefaultXRControllerGrabPointer,{...spreadable$1(Z)}),te!==!1&&jsxRuntimeExports.jsx(DefaultXRInputSourceRayPointer,{makeDefault:!0,minDistance:.2,...spreadable$1(te)}),ne!==!1&&jsxRuntimeExports.jsx(DefaultXRInputSourceTeleportPointer,{...spreadable$1(ne)})]})]})}function DefaultXRHand(K){var se;const _=K.model,Z=K.grabPointer,te=K.rayPointer,ne=K.touchPointer,ie=K.teleportPointer??!1,oe=te===!1?!1:(se=spreadable$1(te))==null?void 0:se.rayModel;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[_!==!1&&jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(XRHandModel,{...spreadable$1(_)})}),jsxRuntimeExports.jsxs(CombinedPointer,{children:[Z!==!1&&jsxRuntimeExports.jsx(DefaultXRHandGrabPointer,{...spreadable$1(Z)}),ne!==!1&&jsxRuntimeExports.jsx(DefaultXRHandTouchPointer,{...spreadable$1(ne)}),te!==!1&&jsxRuntimeExports.jsx(DefaultXRInputSourceRayPointer,{makeDefault:!0,minDistance:.2,...spreadable$1(te),rayModel:oe===!1?!1:{maxLength:.2,...spreadable$1(oe)}}),ie!==!1&&jsxRuntimeExports.jsx(DefaultXRInputSourceTeleportPointer,{...spreadable$1(ie)})]})]})}function DefaultXRTransientPointer(K){return jsxRuntimeExports.jsx(DefaultXRInputSourceRayPointer,{...K,rayModel:!1})}function DefaultXRGaze(K){return jsxRuntimeExports.jsx(DefaultXRInputSourceRayPointer,{...K,rayModel:!1})}function DefaultXRScreenInput(K){return jsxRuntimeExports.jsx(DefaultXRInputSourceRayPointer,{...K,cursorModel:!1,rayModel:!1})}function DefaultXRInputSourceTeleportPointer(K){const _=reactExports.useContext(xrInputSourceStateContext);if(_==null)throw new Error("DefaultXRInputSourceRayPointer can only be used inside a XRInputSource");const Z=reactExports.useRef(null),te=reactExports.useRef(null),ne=reactExports.useMemo(()=>createTeleportRayLine(),[]),ie=useLinesPointer(te,_,{...K,linePoints:ne,filter:buildTeleportTargetFilter(K)},"teleport");usePointerXRInputSourceEvents(ie,_.inputSource,"select",_.events);const oe=K.rayModel,se=K.cursorModel,ae=useThree(ce=>ce.scene),le=reactExports.useRef(null);return useFrame((ce,fe)=>{le.current!=null&&(le.current.visible=ie.getEnabled()&&ie.getButtonsDown().size>0);const de=te.current,pe=Z.current;de==null||pe==null||syncTeleportPointerRayGroup(pe,de,fe*1e3)}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(XRSpace$1,{ref:Z,space:"target-ray-space"}),createPortal(jsxRuntimeExports.jsxs("group",{ref:te,children:[oe!==!1&&jsxRuntimeExports.jsx(TeleportPointerRayModel,{linePoints:ne,pointer:ie,opacity:defaultRayPointerOpacity,...spreadable$1(oe)}),se!==!1&&jsxRuntimeExports.jsx(PointerCursorModel,{ref:le,pointer:ie,opacity:defaultRayPointerOpacity,...spreadable$1(se)})]}),ae)]})}function spreadable$1(K){if(K!==!0)return K}function useHover(K,_){let Z,te;if(_==null){const[ne,ie]=reactExports.useState(!1);Z=ie,te=ne}else Z=_;return reactExports.useEffect(()=>{const{current:ne}=K;if(ne==null)return;const ie=new Set,oe=ae=>{ie.size===0&&Z(!0,ae),ie.add(ae.pointerId)},se=ae=>{ie.delete(ae.pointerId),ie.size===0&&Z(!1,ae)};return ne.addEventListener("pointerenter",oe),ne.addEventListener("pointerleave",se),()=>{ne.removeEventListener("pointerenter",oe),ne.removeEventListener("pointerleave",se)}},[K,Z]),te}function useXRSessionVisibilityState(){return useXR(K=>K.visibilityState)}function useInitRoomCapture(){return useXR(K=>{var _,Z;return(Z=(_=K.session)==null?void 0:_.initiateRoomCapture)==null?void 0:Z.bind(K.session)})}function useXRSessionModeSupported(K,_){const Z=reactExports.useRef(_);Z.current=_;const[te,ne]=reactExports.useMemo(()=>{let ie;return[oe=>{let se=!1;return typeof navigator>"u"||navigator.xr==null?(ie=!1,()=>{}):(navigator.xr.isSessionSupported(K).then(ae=>{ie=ae,!se&&oe()}).catch(ae=>{var le;se||(le=Z.current)==null||le.call(Z,ae)}),()=>se=!0)},()=>ie]},[K]);return reactExports.useSyncExternalStore(te,ne)}const useSessionModeSupported=useXRSessionModeSupported;function useXRSessionFeatureEnabled(K){return useXR(({session:_})=>{var Z;return((Z=_==null?void 0:_.enabledFeatures)==null?void 0:Z.includes(K))??!1})}const useSessionFeatureEnabled=useXRSessionFeatureEnabled;let i$4=0;const map$1=new Map;function objectToKey(K){let _=map$1.get(K);return _==null&&map$1.set(K,_=i$4++),_}function XRElements({children:K}){const _=useXR(oe=>oe.originReferenceSpace),Z=useXR(oe=>oe.origin),te=useXRSessionVisibilityState()==="visible",ne=useStore$3(),ie=reactExports.useMemo(()=>Object.assign({},ne,{getState(){return{...ne.getState(),scene:Z}}}),[Z,ne]);return Z==null||_==null?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:reconciler.createPortal(jsxRuntimeExports.jsx(context$8.Provider,{value:ne,children:jsxRuntimeExports.jsxs(xrSpaceContext.Provider,{value:_,children:[jsxRuntimeExports.jsxs("group",{matrixAutoUpdate:!1,visible:te,children:[jsxRuntimeExports.jsx(XRControllers,{}),jsxRuntimeExports.jsx(XRHands,{}),jsxRuntimeExports.jsx(XRTransientPointers,{}),jsxRuntimeExports.jsx(XRGazes,{}),jsxRuntimeExports.jsx(XRScreenInputs,{})]}),K]})}),ie,null)})}function XRControllers(){const K=useXR(Z=>Z.inputSourceStates.filter(te=>te.type==="controller"),shallow$1$1);let _=useXR(Z=>Z.controller);return _===!1?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K.map(Z=>{const te=resolveInputSourceImplementation(_,Z.inputSource.handedness,{});return te===!1?null:jsxRuntimeExports.jsx(xrInputSourceStateContext.Provider,{value:Z,children:jsxRuntimeExports.jsx(XRSpace$1,{space:"target-ray-space",children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:typeof te=="function"?jsxRuntimeExports.jsx(te,{}):jsxRuntimeExports.jsx(DefaultXRController,{...te})})})},Z.id)})})}function XRHands(){const K=useXR(Z=>Z.inputSourceStates.filter(te=>te.type==="hand"),shallow$1$1),_=useXR(Z=>Z.hand);return _===!1?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K.map(Z=>{const te=resolveInputSourceImplementation(_,Z.inputSource.handedness,{});return te===!1?null:jsxRuntimeExports.jsx(xrInputSourceStateContext.Provider,{value:Z,children:jsxRuntimeExports.jsx(XRSpace$1,{space:"target-ray-space",children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:typeof te=="function"?jsxRuntimeExports.jsx(te,{}):jsxRuntimeExports.jsx(DefaultXRHand,{...te})})})},objectToKey(Z))})})}function XRTransientPointers(){const K=useXR(Z=>Z.inputSourceStates.filter(te=>te.type==="transientPointer"),shallow$1$1),_=useXR(Z=>Z.transientPointer);return _===!1?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K.map(Z=>{const te=resolveInputSourceImplementation(_,Z.inputSource.handedness,{});return te===!1?null:jsxRuntimeExports.jsx(xrInputSourceStateContext.Provider,{value:Z,children:jsxRuntimeExports.jsx(XRSpace$1,{space:"target-ray-space",children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:typeof te=="function"?jsxRuntimeExports.jsx(te,{}):jsxRuntimeExports.jsx(DefaultXRTransientPointer,{...te})})})},objectToKey(Z))})})}function XRGazes(){const K=useXR(Z=>Z.inputSourceStates.filter(te=>te.type==="gaze"),shallow$1$1),_=useXR(Z=>Z.gaze);return _===!1?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K.map(Z=>jsxRuntimeExports.jsx(xrInputSourceStateContext.Provider,{value:Z,children:jsxRuntimeExports.jsx(XRSpace$1,{space:"target-ray-space",children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:typeof _=="function"?jsxRuntimeExports.jsx(_,{}):jsxRuntimeExports.jsx(DefaultXRGaze,{...spreadable(_)})})})},objectToKey(Z)))})}function XRScreenInputs(){const K=useXR(Z=>Z.inputSourceStates.filter(te=>te.type==="screenInput"),shallow$1$1),_=useXR(Z=>Z.screenInput);return _===!1?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K.map(Z=>jsxRuntimeExports.jsx(xrInputSourceStateContext.Provider,{value:Z,children:jsxRuntimeExports.jsx(XRSpace$1,{space:"target-ray-space",children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:typeof _=="function"?jsxRuntimeExports.jsx(_,{}):jsxRuntimeExports.jsx(DefaultXRScreenInput,{...spreadable(_)})})})},objectToKey(Z)))})}function spreadable(K){if(K!==!0)return K}function createXRStore(K){return createXRStore$1(K)}function XR({children:K,store:_}){_.setWebXRManager(useThree(te=>te.gl.xr));const Z=useStore$3();return reactExports.useEffect(()=>{let te;return _.subscribe((ne,ie)=>{if(ne.session!==ie.session){if(ne.session!=null){const{camera:oe,gl:se}=Z.getState();te=oe,Z.setState({camera:se.xr.getCamera()});return}te!=null&&Z.setState({camera:te})}})},[Z,_]),useFrame((te,ne,ie)=>_.onBeforeFrame(te.scene,te.camera,ie),-1e3),useFrame(()=>_.onBeforeRender()),jsxRuntimeExports.jsx(xrContext.Provider,{value:_,children:jsxRuntimeExports.jsxs(RootCombinedPointer,{children:[jsxRuntimeExports.jsx(XRElements,{}),K]})})}function NotInXR({children:K}){const _=reactExports.useMemo(()=>createXRStore(),[]);return jsxRuntimeExports.jsx(xrContext.Provider,{value:_,children:K})}function RootCombinedPointer({children:K}){const _=useXRStore(),Z=reactExports.useMemo(()=>new CombinedPointer$1(!0),[]);return reactExports.useEffect(()=>setupSyncIsVisible(_,te=>Z.setEnabled(te,{timeStamp:performance.now()})),[_,Z]),useFrame(te=>Z.move(te.scene,{timeStamp:performance.now()}),-50),jsxRuntimeExports.jsx(combinedPointerContext.Provider,{value:Z,children:K})}function useXRStore(){const K=reactExports.useContext(xrContext);if(K==null)throw new Error("XR features can only be used inside the <XR> component");return K}function UNSAFE_useXRStore(){return reactExports.useContext(xrContext)}function useXR(K=Z=>Z,_){return useStore(useXRStore(),K,_)}function useXRInputSourceStates(){return useXR(K=>K.inputSourceStates)}function useXRInputSourceState(K,_){return useXR(Z=>Z.inputSourceStates.find(te=>te.type===K&&(_==null||te.inputSource.handedness===_)))}function useXRInputSourceStateContext(K){const _=reactExports.useContext(xrInputSourceStateContext);if(_==null)throw new Error("useXRInputSourceStateContext() can only be used inside the xr store config");if(K!=null&&_.type!=K)throw new Error(`useXRInputSourceStateContext(${K}) can not be used inside a component for input type "${_.type}"`);return _}function useXRInputSourceEvent(K,_,Z,te){const ne=useXR(ie=>ie.session);reactExports.useEffect(()=>{if(!(ne==null||K==null))return bindXRInputSourceEvent(ne,K,_,Z)},[_,K,ne,...te])}const XRSpace$1=reactExports.forwardRef(({space:K,children:_},Z)=>{const te=reactExports.useRef(null),ne=typeof K=="string"?useXRSpace(K):K;reactExports.useImperativeHandle(Z,()=>te.current,[]),useApplyXRSpaceMatrix(te,ne);const ie=reactExports.useCallback(oe=>{oe!=null&&(oe.transformReady=!1,oe.visible=!1),te.current=oe},[]);return jsxRuntimeExports.jsx("group",{xrSpace:ne,matrixAutoUpdate:!1,ref:ie,children:ne&&jsxRuntimeExports.jsx(xrSpaceContext.Provider,{value:ne,children:_})})});function useXRSpace(K){var ne;switch(K){case"grip-space":return useXRInputSourceStateContext().inputSource.gripSpace;case"target-ray-space":return useXRInputSourceStateContext().inputSource.targetRaySpace;case"wrist":case"thumb-metacarpal":case"thumb-phalanx-proximal":case"thumb-phalanx-distal":case"thumb-tip":case"index-finger-metacarpal":case"index-finger-phalanx-proximal":case"index-finger-phalanx-intermediate":case"index-finger-phalanx-distal":case"index-finger-tip":case"middle-finger-metacarpal":case"middle-finger-phalanx-proximal":case"middle-finger-phalanx-intermediate":case"middle-finger-phalanx-distal":case"middle-finger-tip":case"ring-finger-metacarpal":case"ring-finger-phalanx-proximal":case"ring-finger-phalanx-intermediate":case"ring-finger-phalanx-distal":case"ring-finger-tip":case"pinky-finger-metacarpal":case"pinky-finger-phalanx-proximal":case"pinky-finger-phalanx-intermediate":case"pinky-finger-phalanx-distal":case"pinky-finger-tip":return useXRInputSourceStateContext("hand").inputSource.hand.get(K);case"root":case"hips":case"spine-lower":case"spine-middle":case"spine-upper":case"chest":case"neck":case"head":case"left-shoulder":case"left-scapula":case"left-arm-upper":case"left-arm-lower":case"left-hand-wrist-twist":case"right-shoulder":case"right-scapula":case"right-arm-upper":case"right-arm-lower":case"right-hand-wrist-twist":case"left-hand-palm":case"left-hand-wrist":case"left-hand-thumb-metacarpal":case"left-hand-thumb-phalanx-proximal":case"left-hand-thumb-phalanx-distal":case"left-hand-thumb-tip":case"left-hand-index-metacarpal":case"left-hand-index-phalanx-proximal":case"left-hand-index-phalanx-intermediate":case"left-hand-index-phalanx-distal":case"left-hand-index-tip":case"left-hand-middle-metacarpal":case"left-hand-middle-phalanx-proximal":case"left-hand-middle-phalanx-intermediate":case"left-hand-middle-phalanx-distal":case"left-hand-middle-tip":case"left-hand-ring-metacarpal":case"left-hand-ring-phalanx-proximal":case"left-hand-ring-phalanx-intermediate":case"left-hand-ring-phalanx-distal":case"left-hand-ring-tip":case"left-hand-little-metacarpal":case"left-hand-little-phalanx-proximal":case"left-hand-little-phalanx-intermediate":case"left-hand-little-phalanx-distal":case"left-hand-little-tip":case"right-hand-palm":case"right-hand-wrist":case"right-hand-thumb-metacarpal":case"right-hand-thumb-phalanx-proximal":case"right-hand-thumb-phalanx-distal":case"right-hand-thumb-tip":case"right-hand-index-metacarpal":case"right-hand-index-phalanx-proximal":case"right-hand-index-phalanx-intermediate":case"right-hand-index-phalanx-distal":case"right-hand-index-tip":case"right-hand-middle-metacarpal":case"right-hand-middle-phalanx-proximal":case"right-hand-middle-phalanx-intermediate":case"right-hand-middle-phalanx-distal":case"right-hand-middle-tip":case"right-hand-ring-metacarpal":case"right-hand-ring-phalanx-proximal":case"right-hand-ring-phalanx-intermediate":case"right-hand-ring-phalanx-distal":case"right-hand-ring-tip":case"right-hand-little-metacarpal":case"right-hand-little-phalanx-proximal":case"right-hand-little-phalanx-intermediate":case"right-hand-little-phalanx-distal":case"right-hand-little-tip":case"left-upper-leg":case"left-lower-leg":case"left-foot-ankle-twist":case"left-foot-ankle":case"left-foot-subtalar":case"left-foot-transverse":case"left-foot-ball":case"right-upper-leg":case"right-lower-leg":case"right-foot-ankle-twist":case"right-foot-ankle":case"right-foot-subtalar":case"right-foot-transverse":case"right-foot-ball":return(ne=useXR(ie=>ie.body))==null?void 0:ne.get(K)}if(K==null){const ie=reactExports.useContext(xrSpaceContext);if(ie==null)throw new Error("XR objects must be placed inside the XROrigin");return ie}const[_,Z]=reactExports.useState(void 0),te=useXR(ie=>ie.session);return reactExports.useEffect(()=>{if(te==null)return;let ie=!1;return te.requestReferenceSpace(K).then(oe=>{ie||Z(oe)}),()=>void(ie=!0)},[te,K]),_}function useGetXRSpaceMatrix(K){const _=reactExports.useContext(xrSpaceContext),Z=useXR(te=>_??te.originReferenceSpace);return reactExports.useMemo(()=>K==null||Z==null?void 0:createGetXRSpaceMatrix(K,Z),[K,Z])}function useApplyXRSpaceMatrix(K,_,Z){const te=useGetXRSpaceMatrix(_);useFrame((ne,ie,oe)=>{K.current!=null&&(K.current.visible=K.current.transformReady=(te==null?void 0:te(K.current.matrix,oe))??!1),Z==null||Z(ne,ie,oe)},-100)}const XRMeshModel=reactExports.forwardRef(({mesh:K,..._},Z)=>{const te=useXRMeshGeometry(K);return jsxRuntimeExports.jsx("mesh",{ref:Z,geometry:te,..._})});function useXRMeshes(K){const _=useXR(Z=>Z.detectedMeshes);return reactExports.useMemo(()=>K==null?_:_.filter(Z=>Z.semanticLabel===K),[_,K])}function useXRMeshGeometry(K,_=!0){const[Z,te]=reactExports.useState(updateXRMeshGeometry(K,void 0));return useFrame(()=>te(ne=>updateXRMeshGeometry(K,ne))),reactExports.useEffect(()=>{if(_)return()=>Z.dispose()},[Z]),Z}const XRPlaneModel=reactExports.forwardRef(({plane:K,..._},Z)=>{const te=useXRPlaneGeometry(K);return jsxRuntimeExports.jsx("mesh",{ref:Z,geometry:te,..._})});function useXRPlanes(K){const _=useXR(Z=>Z.detectedPlanes);return reactExports.useMemo(()=>K==null?_:_.filter(Z=>Z.semanticLabel===K),[_,K])}function useXRPlaneGeometry(K,_=!0){const[Z,te]=reactExports.useState(updateXRPlaneGeometry(K,void 0));return useFrame(()=>te(ne=>updateXRPlaneGeometry(K,ne))),reactExports.useEffect(()=>{if(_)return()=>Z.dispose()},[Z]),Z}function useIsInSessionMode(K,_){const Z=useXR(te=>te.mode);return _!=null?Array.isArray(_)?!_.includes(Z):_!=Z:K!=null?Array.isArray(K)?K.includes(Z):K===Z:Z!==null}function ShowIfInSessionMode({children:K,allow:_,deny:Z}){const te=useIsInSessionMode(_,Z);return jsxRuntimeExports.jsx("group",{visible:te,children:K})}function IfInSessionMode({children:K,allow:_,deny:Z}){return useIsInSessionMode(_,Z)?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K}):null}const XROrigin=reactExports.forwardRef(({children:K,disabled:_,...Z},te)=>{const ne=useThree(se=>se.gl.xr.getCamera()),ie=reactExports.useRef(null),oe=useXR(se=>se.originReferenceSpace);return reactExports.useImperativeHandle(te,()=>ie.current,[]),reactExports.useEffect(()=>{const se=ie.current;if(!(se==null||_))return se.add(ne),()=>void se.remove(ne)},[_,ne]),jsxRuntimeExports.jsx("group",{ref:ie,...Z,children:jsxRuntimeExports.jsx(xrSpaceContext.Provider,{value:oe,children:K})})});function useXRHitTestSource(K,_){const[Z,te]=reactExports.useState();return useCreateXRHitTestSource(K,_,te),Z}function useXRHitTest(K,_,Z){const te=reactExports.useRef(void 0);useCreateXRHitTestSource(_,Z,reactExports.useCallback(ne=>te.current=ne,[])),useFrame((ne,ie,oe)=>{K==null||oe==null||te.current==null||K(oe.getHitTestResults(te.current.source),te.current.getWorldMatrix)})}function useCreateXRHitTestSource(K,_,Z){const te=useXRStore(),ne=useStore(te,ie=>ie.session);reactExports.useEffect(()=>{if(ne==null)return;let ie,oe=!1;const se=K instanceof XRSpace||typeof K=="string"?K:K==null?void 0:K.current;if(se!=null)return createXRHitTestSource(te,ne,se,_).then(ae=>{oe||(ie=ae,Z(ae))}),()=>{Z(void 0),oe=!0,ie==null||ie.source.cancel()}},[ne,te,K,_,Z])}function useXRRequestHitTest(){const K=useXRStore();return reactExports.useCallback((_,Z)=>{const te=_ instanceof XRSpace||typeof _=="string"?_:_.current;if(te!=null)return requestXRHitTest(K,te,Z)},[K])}const XRHitTest=reactExports.forwardRef(({trackableType:K,onResults:_,space:Z,...te},ne)=>{const ie=reactExports.useRef(null);return reactExports.useImperativeHandle(ne,()=>ie.current),useXRHitTest(_,Z??ie,K),jsxRuntimeExports.jsx("group",{...te,ref:ie})}),XRDomOverlay=reactExports.forwardRef((K,_)=>{const Z=useXR(ie=>ie.domOverlayRoot),{In:te,Out:ne}=reactExports.useMemo(tunnel,[]);return reactExports.useEffect(()=>{if(Z==null)return;const ie=createRoot$1(Z);return ie.render(jsxRuntimeExports.jsx(ne,{})),()=>ie.unmount()},[Z,ne]),jsxRuntimeExports.jsx(te,{children:jsxRuntimeExports.jsx("div",{...K,ref:_})})});function XRLayer({src:K,pixelWidth:_=1024,pixelHeight:Z=1024,dpr:te=1,renderPriority:ne=0,children:ie,customRender:oe,...se}){const[ae,le]=reactExports.useState(!1),ce=reactExports.useRef(null),fe=reactExports.useRef(void 0),de=reactExports.useRef(void 0);reactExports.useEffect(()=>{le(!1);let me=!1;return waitForXRLayerSrcSize(K).then(()=>!me&&le(!0)),()=>void(me=!0)},[K]);const pe=useXRSessionFeatureEnabled("layers"),he=reactExports.useMemo(()=>createXRLayerGeometry(se.shape??"quad",{centralAngle:se.centralAngle,centralHorizontalAngle:se.centralHorizontalAngle,lowerVerticalAngle:se.lowerVerticalAngle,upperVerticalAngle:se.upperVerticalAngle}),[se.centralAngle,se.centralHorizontalAngle,se.lowerVerticalAngle,se.shape,se.upperVerticalAngle]),ge=useLayerStore(_,Z,te);return useForwardEvents(ge,ce,[ae,pe]),ae?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[K==null&&jsxRuntimeExports.jsx(ChildrenToRenderTarget,{customRender:oe,store:ge,renderPriority:ne,renderTargetRef:fe,layerEntryRef:pe?de:void 0,children:ie}),pe?jsxRuntimeExports.jsx(XRLayerImplementation,{renderTargetRef:fe,layerEntryRef:de,pixelWidth:_,pixelHeight:Z,dpr:te,ref:ce,...se,src:K,geometry:he}):jsxRuntimeExports.jsx(FallbackXRLayerImplementation,{renderTargetRef:fe,ref:ce,...se,src:K,pixelWidth:_,pixelHeight:Z,dpr:te,geometry:he})]}):null}const XRLayerImplementation=reactExports.forwardRef(({src:K,shape:_,colorFormat:Z,depthFormat:te,layout:ne,mipLevels:ie,renderOrder:oe=0,blendTextureSourceAlpha:se,centralAngle:ae,centralHorizontalAngle:le,chromaticAberrationCorrection:ce,lowerVerticalAngle:fe,quality:de,upperVerticalAngle:pe,invertStereo:he,pixelWidth:ge,pixelHeight:me,dpr:Ae,renderTargetRef:ye,layerEntryRef:ve,..._e},Te)=>{const be=reactExports.useRef(null),Re=useThree(ke=>ke.gl),we=useXRStore(),Pe={blendTextureSourceAlpha:se,centralAngle:ae,centralHorizontalAngle:le,chromaticAberrationCorrection:ce,lowerVerticalAngle:fe,quality:de,upperVerticalAngle:pe},Ie=reactExports.useRef(Pe);Ie.current=Pe;const $e=reactExports.useRef(oe);$e.current=oe;const Ue=useXR(ke=>ke.originReferenceSpace);return reactExports.useEffect(()=>{if(be.current==null||Ue==null)return;const ke=K??(ye.current=createXRLayerRenderTarget(ge,me,Ae)),Ge=createXRLayer(ke,we.getState(),Ue,Re.xr,be.current,{colorFormat:Z,depthFormat:te,invertStereo:he,layout:ne,mipLevels:ie,shape:_},Ie.current);if(Ge==null)return;const He=ve.current={layer:Ge,renderOrder:$e.current};if(we.addLayerEntry(He),ke instanceof HTMLVideoElement||ke instanceof WebGLRenderTarget)return()=>{we.removeLayerEntry(He),Ge.destroy()};const ze=setupXRImageLayer(Re,we,Ge,ke);return()=>{we.removeLayerEntry(He),ze(),Ge.destroy()}},[Ue,Z,te,he,ve,ne,ie,me,ge,Ae,ye,Re,_,K,we]),ve.current!=null&&(ve.current.renderOrder=oe),ve.current!=null&&updateXRLayerProperties(ve.current.layer,Ie.current),useFrame(()=>{ve.current==null||be.current==null||updateXRLayerTransform(we.getState(),ve.current.layer,Ie.current.centralAngle,be.current)}),reactExports.useImperativeHandle(Te,()=>be.current,[]),jsxRuntimeExports.jsx("mesh",{..._e,renderOrder:-1/0,ref:be,children:jsxRuntimeExports.jsx("meshBasicMaterial",{colorWrite:!1})})}),FallbackXRLayerImplementation=reactExports.forwardRef(({src:K,renderTargetRef:_,dpr:Z,renderOrder:te,pixelWidth:ne,pixelHeight:ie,...oe},se)=>{const ae=reactExports.useRef(null);return reactExports.useEffect(()=>{if(ae.current==null)return;const le=K??(_.current=createXRLayerRenderTarget(ne,ie,Z)),ce=getXRLayerSrcTexture(le);return ae.current.map=ce,ae.current.needsUpdate=!0,()=>{if(le instanceof WebGLRenderTarget){le.dispose();return}ce.dispose()}},[K,ne,ie,Z,_]),jsxRuntimeExports.jsx("mesh",{ref:se,...oe,children:jsxRuntimeExports.jsx("meshBasicMaterial",{ref:ae,toneMapped:!1})})});function useForwardEvents(K,_,Z){reactExports.useEffect(()=>{const{current:te}=_;if(te==null)return;let ne;const ie=(se,ae)=>{if(se.camera===(ae==null?void 0:ae.camera)&&se.scene===ae.scene)return;ne==null||ne();const{destroy:le,update:ce}=forwardObjectEvents(te,()=>se.camera,se.scene),fe=addEffect(ce);ne=()=>{le(),fe()}};ie(K.getState());const oe=K.subscribe(ie);return()=>{oe(),ne==null||ne()}},[K,_,...Z])}const privateKeys=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"];function useLayerStore(K,_,Z){const te=useStore$3(),ne=reactExports.useMemo(()=>{let ie=te.getState();const oe=new PerspectiveCamera$2(50,1,.1,1e3);oe.position.set(0,0,5);const se=new Vector2;let ae={events:{enabled:!1,priority:0},size:{width:1,height:1,left:0,top:0},camera:oe,scene:new Scene$1,raycaster:new Raycaster,pointer:se,mouse:se,previousRoot:te};const le=create$9((ce,fe)=>{const de=()=>{const he={};for(const ge in ie)privateKeys.includes(ge)||(he[ge]=ie[ge]);return Object.assign(he,ae,{events:{...ie.events,...ae.events},viewport:Object.assign({},ie.viewport,ie.viewport.getCurrentViewport(oe,new Vector3,ae.size))})},pe=()=>ce(de());return{...ie,set(he){typeof he=="function"&&(he=he(fe())),Object.assign(ae,he),pe()},setPreviousState(he){ie=he,pe()},get:fe,setEvents(){},...de()}});return Object.assign(le,{setState(ce){le.getState().set(ce)}})},[te]);return reactExports.useEffect(()=>te.subscribe(ne.getState().setPreviousState),[te,ne]),reactExports.useEffect(()=>{const ie={factor:1,distance:0,dpr:Z,initialDpr:Z,left:0,top:0,getCurrentViewport:()=>ie,width:K,height:_,aspect:K/_};ne.setState({size:{width:K,height:_,top:0,left:0},viewport:ie})},[K,_,Z,ne,te]),ne}const v4Helper=new Vector4;function getSize(K){return this.getViewport(v4Helper),K.x=v4Helper.z-v4Helper.x,K.y=v4Helper.w-v4Helper.y,K}const viewportHelper=new Vector4;function ChildrenToRenderTarget({renderPriority:K,children:_,layerEntryRef:Z,renderTargetRef:te,store:ne,customRender:ie}){reactExports.useEffect(()=>{const de=(pe,he)=>{const{size:ge,camera:me}=pe;me instanceof OrthographicCamera$1?(me.left=ge.width/-2,me.right=ge.width/2,me.top=ge.height/2,me.bottom=ge.height/-2):me.aspect=ge.width/ge.height,(ge!==(he==null?void 0:he.size)||me!==he.camera)&&(me.updateProjectionMatrix(),me.updateMatrixWorld())};return de(ne.getState()),ne.subscribe(de)},[ne]);let oe,se,ae,le,ce,fe;return useFrame((de,pe,he)=>{if(te.current==null||Z!=null&&(Z.current==null||he==null))return;const ge=ne.getState(),{gl:me,scene:Ae,camera:ye}=ge;oe=me.autoClear,se=me.xr.enabled,ae=me.xr.isPresenting,le=me.getRenderTarget(),fe=me.getSize,ce=me.getDrawingBufferSize,me.getViewport(viewportHelper),me.autoClear=!0,me.xr.enabled=!1,me.xr.isPresenting=!1;const ve=te.current;me.setViewport(0,0,ve.width,ve.height),me.getSize=getSize,me.getDrawingBufferSize=getSize,setXRLayerRenderTarget(me,ve,Z==null?void 0:Z.current,he),ie!=null?ie(ve,ge,pe,he):me.render(Ae,ye),me.setRenderTarget(le),me.setViewport(viewportHelper),me.autoClear=oe,me.xr.enabled=se,me.xr.isPresenting=ae,me.getSize=fe,me.getDrawingBufferSize=ce},K),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:reconciler.createPortal(jsxRuntimeExports.jsx(context$8.Provider,{value:ne,children:_}),ne,null)})}const XRButton$1=reactExports.forwardRef(({store:K,mode:_,onError:Z,children:te,...ne},ie)=>{const oe=useStore(K,ae=>ae.session),se=useXRSessionModeSupported(_,Z);return jsxRuntimeExports.jsx("button",{ref:ie,...ne,onClick:()=>oe!=null?oe.end():K.enterXR(_).catch(Z),children:typeof te=="function"?te(se?oe!=null?"entered":"exited":"unsupported"):te})}),ARButton=reactExports.forwardRef((K,_)=>jsxRuntimeExports.jsx(XRButton$1,{ref:_,mode:"immersive-ar",...K})),VRButton=reactExports.forwardRef((K,_)=>jsxRuntimeExports.jsx(XRButton$1,{ref:_,mode:"immersive-vr",...K})),eventTranslations={onBlur:"pointerleave",onHover:"pointerenter",onMove:"pointermove",onSelect:{type:"click",filter:K=>K.pointerType==="ray"},onSelectEnd:{type:"pointerup",filter:K=>K.pointerType==="ray"},onSelectStart:{type:"pointerdown",filter:K=>K.pointerType==="ray"},onSqueeze:{type:"click",filter:K=>K.pointerType==="grab"},onSqueezeEnd:{type:"pointerup",filter:K=>K.pointerType==="grab"},onSqueezeStart:{type:"pointerdown",filter:K=>K.pointerType==="grab"}};function useInteraction(K,_,Z){const te=reactExports.useRef(Z);te.current=Z,reactExports.useEffect(()=>{const{current:ne}=K;if(ne==null)return;const ie=eventTranslations[_],oe=typeof ie=="string"?ae=>{var le;return(le=te.current)==null?void 0:le.call(te,{intersection:ae,intersections:[ae],target:ae.pointerState})}:ae=>{var le;ae instanceof PointerEvent&&!ie.filter(ae)||(le=te.current)==null||le.call(te,{intersection:ae,intersections:[ae],target:ae.pointerState})},se=typeof ie=="string"?ie:ie.type;return ne.addEventListener(se,oe),()=>ne.removeEventListener(se,oe)},[K,_])}function useXREvent(K,_,{handedness:Z}={}){const te=useXR(ie=>ie.session),ne=reactExports.useRef(_);ne.current=_,reactExports.useEffect(()=>{if(te==null)return;const ie=oe=>{var se;(se=ne.current)==null||se.call(ne,{type:oe.type,data:oe.inputSource})};return te.addEventListener(K,ie),()=>te.removeEventListener(K,ie)},[te,Z,K])}function useXRTransientPointerState(K){return K==null?useXRInputSourceStateContext("transientPointer"):useXRInputSourceState("transientPointer",K)}function useXRGazeState(){return useXRInputSourceStateContext("gaze")}function useXRScreenInputState(){return useXRInputSourceStateContext("screenInput")}function useXRHandState(K){return K==null?useXRInputSourceStateContext("hand"):useXRInputSourceState("hand",K)}function useXRControllerState(K){return K==null?useXRInputSourceStateContext("controller"):useXRInputSourceState("controller",K)}const useXRReferenceSpace=useXRSpace,Interactive=reactExports.forwardRef(({onHover:K,onBlur:_,onSelectStart:Z,onSelectEnd:te,onSelect:ne,onSqueezeStart:ie,onSqueezeEnd:oe,onSqueeze:se,onMove:ae,children:le},ce)=>{const fe=reactExports.useRef(null);return reactExports.useImperativeHandle(ce,()=>fe.current),useInteraction(fe,"onHover",K),useInteraction(fe,"onBlur",_),useInteraction(fe,"onSelectStart",Z),useInteraction(fe,"onSelectEnd",te),useInteraction(fe,"onSelect",ne),useInteraction(fe,"onSqueezeStart",ie),useInteraction(fe,"onSqueezeEnd",oe),useInteraction(fe,"onSqueeze",se),useInteraction(fe,"onMove",ae),jsxRuntimeExports.jsx("group",{ref:fe,children:le})}),RayGrab=reactExports.forwardRef(function({onSelectStart:_,onSelectEnd:Z,children:te,...ne},ie){const oe=reactExports.useRef(void 0),se=reactExports.useRef(null),ae=reactExports.useMemo(()=>new Matrix4,[]);return reactExports.useImperativeHandle(ie,()=>se.current),useFrame(()=>{const le=oe.current,ce=se.current;!ce||!le||(ce.applyMatrix4(ae),le.updateWorldMatrix(!0,!1),ce.applyMatrix4(le.matrixWorld),ce.updateMatrixWorld(),ae.copy(le.matrixWorld).invert())}),jsxRuntimeExports.jsx(Interactive,{ref:se,onSelectStart:le=>{isXRInputSourceState(le.target)&&(le.target.type==="controller"||le.target.type==="hand")&&le.target.object!=null&&(oe.current=le.target.object,le.target.object.updateWorldMatrix(!0,!1),ae.copy(le.target.object.matrixWorld).invert(),_==null||_(le))},onSelectEnd:le=>{le.target.controller===oe.current&&(oe.current=void 0),Z==null||Z(le)},...ne,children:te})});/**
 * postprocessing v6.37.4 build Sat Jun 07 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rüschen
 * @license Zlib
 */var MILLISECONDS_TO_SECONDS=1/1e3,SECONDS_TO_MILLISECONDS=1e3,Timer=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(K){typeof document<"u"&&document.hidden!==void 0&&(K?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=K)}get delta(){return this._delta*MILLISECONDS_TO_SECONDS}get fixedDelta(){return this._fixedDelta*MILLISECONDS_TO_SECONDS}set fixedDelta(K){this._fixedDelta=K*SECONDS_TO_MILLISECONDS}get elapsed(){return this._elapsed*MILLISECONDS_TO_SECONDS}update(K){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(K!==void 0?K:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(K){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},fullscreenGeometry=(()=>{const K=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),_=new Float32Array([0,0,2,0,0,2]),Z=new BufferGeometry;return Z.setAttribute("position",new BufferAttribute(K,3)),Z.setAttribute("uv",new BufferAttribute(_,2)),Z})(),Pass=class xa{static get fullscreenGeometry(){return fullscreenGeometry}constructor(_="Pass",Z=new Scene$1,te=new Camera$1){this.name=_,this.renderer=null,this.scene=Z,this.camera=te,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(_){if(this.rtt===_){const Z=this.fullscreenMaterial;Z!==null&&(Z.needsUpdate=!0),this.rtt=!_}}set mainScene(_){}set mainCamera(_){}setRenderer(_){this.renderer=_}isEnabled(){return this.enabled}setEnabled(_){this.enabled=_}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(_){let Z=this.screen;Z!==null?Z.material=_:(Z=new Mesh(xa.fullscreenGeometry,_),Z.frustumCulled=!1,this.scene===null&&(this.scene=new Scene$1),this.scene.add(Z),this.screen=Z)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(_){this.fullscreenMaterial=_}getDepthTexture(){return null}setDepthTexture(_,Z=BasicDepthPacking){}render(_,Z,te,ne,ie){throw new Error("Render method not implemented!")}setSize(_,Z){}initialize(_,Z,te){}dispose(){for(const _ of Object.keys(this)){const Z=this[_];(Z instanceof WebGLRenderTarget||Z instanceof Material||Z instanceof Texture$1||Z instanceof xa)&&this[_].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},ClearMaskPass=class extends Pass{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(K,_,Z,te,ne){const ie=K.state.buffers.stencil;ie.setLocked(!1),ie.setTest(!1)}},copy_default=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,common_default="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",CopyMaterial$1=class extends ShaderMaterial{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Uniform(null),opacity:new Uniform(1)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:copy_default,vertexShader:common_default})}set inputBuffer(_){this.uniforms.inputBuffer.value=_}setInputBuffer(_){this.uniforms.inputBuffer.value=_}getOpacity(_){return this.uniforms.opacity.value}setOpacity(_){this.uniforms.opacity.value=_}},CopyPass=class extends Pass{constructor(K,_=!0){super("CopyPass"),this.fullscreenMaterial=new CopyMaterial$1,this.needsSwap=!1,this.renderTarget=K,K===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:LinearFilter,magFilter:LinearFilter,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=_}get resize(){return this.autoResize}set resize(K){this.autoResize=K}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(K){this.autoResize=K}render(K,_,Z,te,ne){this.fullscreenMaterial.inputBuffer=_.texture,K.setRenderTarget(this.renderToScreen?null:this.renderTarget),K.render(this.scene,this.camera)}setSize(K,_){this.autoResize&&this.renderTarget.setSize(K,_)}initialize(K,_,Z){Z!==void 0&&(this.renderTarget.texture.type=Z,Z!==UnsignedByteType?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":K!==null&&K.outputColorSpace===SRGBColorSpace$2&&(this.renderTarget.texture.colorSpace=SRGBColorSpace$2))}},color$2=new Color$1,ClearPass=class extends Pass{constructor(K=!0,_=!0,Z=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=K,this.depth=_,this.stencil=Z,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(K,_,Z){this.color=K,this.depth=_,this.stencil=Z}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(K){this.overrideClearColor=K}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(K){this.overrideClearAlpha=K}render(K,_,Z,te,ne){const ie=this.overrideClearColor,oe=this.overrideClearAlpha,se=K.getClearAlpha(),ae=ie!==null,le=oe>=0;ae?(K.getClearColor(color$2),K.setClearColor(ie,le?oe:se)):le&&K.setClearAlpha(oe),K.setRenderTarget(this.renderToScreen?null:_),K.clear(this.color,this.depth,this.stencil),ae?K.setClearColor(color$2,se):le&&K.setClearAlpha(se)}},MaskPass=class extends Pass{constructor(K,_){super("MaskPass",K,_),this.needsSwap=!1,this.clearPass=new ClearPass(!1,!1,!0),this.inverse=!1}set mainScene(K){this.scene=K}set mainCamera(K){this.camera=K}get inverted(){return this.inverse}set inverted(K){this.inverse=K}get clear(){return this.clearPass.enabled}set clear(K){this.clearPass.enabled=K}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(K){this.inverted=K}render(K,_,Z,te,ne){const ie=K.getContext(),oe=K.state.buffers,se=this.scene,ae=this.camera,le=this.clearPass,ce=this.inverted?0:1,fe=1-ce;oe.color.setMask(!1),oe.depth.setMask(!1),oe.color.setLocked(!0),oe.depth.setLocked(!0),oe.stencil.setTest(!0),oe.stencil.setOp(ie.REPLACE,ie.REPLACE,ie.REPLACE),oe.stencil.setFunc(ie.ALWAYS,ce,4294967295),oe.stencil.setClear(fe),oe.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?le.render(K,null):(le.render(K,_),le.render(K,Z))),this.renderToScreen?(K.setRenderTarget(null),K.render(se,ae)):(K.setRenderTarget(_),K.render(se,ae),K.setRenderTarget(Z),K.render(se,ae)),oe.color.setLocked(!1),oe.depth.setLocked(!1),oe.stencil.setLocked(!1),oe.stencil.setFunc(ie.EQUAL,1,4294967295),oe.stencil.setOp(ie.KEEP,ie.KEEP,ie.KEEP),oe.stencil.setLocked(!0)}},EffectComposer$1=class{constructor(_=null,{depthBuffer:Z=!0,stencilBuffer:te=!1,multisampling:ne=0,frameBufferType:ie}={}){this.renderer=null,this.inputBuffer=this.createBuffer(Z,te,ie,ne),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new CopyPass,this.depthTexture=null,this.passes=[],this.timer=new Timer,this.autoRenderToScreen=!0,this.setRenderer(_)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(_){const Z=this.inputBuffer,te=this.multisampling;te>0&&_>0?(this.inputBuffer.samples=_,this.outputBuffer.samples=_,this.inputBuffer.dispose(),this.outputBuffer.dispose()):te!==_&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(Z.depthBuffer,Z.stencilBuffer,Z.texture.type,_),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(_){if(this.renderer=_,_!==null){const Z=_.getSize(new Vector2),te=_.getContext().getContextAttributes().alpha,ne=this.inputBuffer.texture.type;ne===UnsignedByteType&&_.outputColorSpace===SRGBColorSpace$2&&(this.inputBuffer.texture.colorSpace=SRGBColorSpace$2,this.outputBuffer.texture.colorSpace=SRGBColorSpace$2,this.inputBuffer.dispose(),this.outputBuffer.dispose()),_.autoClear=!1,this.setSize(Z.width,Z.height);for(const ie of this.passes)ie.initialize(_,te,ne)}}replaceRenderer(_,Z=!0){const te=this.renderer,ne=te.domElement.parentNode;return this.setRenderer(_),Z&&ne!==null&&(ne.removeChild(te.domElement),ne.appendChild(_.domElement)),te}createDepthTexture(){const _=this.depthTexture=new DepthTexture;return this.inputBuffer.depthTexture=_,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(_.format=DepthStencilFormat,_.type=UnsignedInt248Type):_.type=UnsignedIntType,_}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const _ of this.passes)_.setDepthTexture(null)}}createBuffer(_,Z,te,ne){const ie=this.renderer,oe=ie===null?new Vector2:ie.getDrawingBufferSize(new Vector2),se={minFilter:LinearFilter,magFilter:LinearFilter,stencilBuffer:Z,depthBuffer:_,type:te},ae=new WebGLRenderTarget(oe.width,oe.height,se);return ne>0&&(ae.ignoreDepthForMultisampleCopy=!1,ae.samples=ne),te===UnsignedByteType&&ie!==null&&ie.outputColorSpace===SRGBColorSpace$2&&(ae.texture.colorSpace=SRGBColorSpace$2),ae.texture.name="EffectComposer.Buffer",ae.texture.generateMipmaps=!1,ae}setMainScene(_){for(const Z of this.passes)Z.mainScene=_}setMainCamera(_){for(const Z of this.passes)Z.mainCamera=_}addPass(_,Z){const te=this.passes,ne=this.renderer,ie=ne.getDrawingBufferSize(new Vector2),oe=ne.getContext().getContextAttributes().alpha,se=this.inputBuffer.texture.type;if(_.setRenderer(ne),_.setSize(ie.width,ie.height),_.initialize(ne,oe,se),this.autoRenderToScreen&&(te.length>0&&(te[te.length-1].renderToScreen=!1),_.renderToScreen&&(this.autoRenderToScreen=!1)),Z!==void 0?te.splice(Z,0,_):te.push(_),this.autoRenderToScreen&&(te[te.length-1].renderToScreen=!0),_.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const ae=this.createDepthTexture();for(_ of te)_.setDepthTexture(ae)}else _.setDepthTexture(this.depthTexture)}removePass(_){const Z=this.passes,te=Z.indexOf(_);if(te!==-1&&Z.splice(te,1).length>0){if(this.depthTexture!==null){const oe=(ae,le)=>ae||le.needsDepthTexture;Z.reduce(oe,!1)||(_.getDepthTexture()===this.depthTexture&&_.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&te===Z.length&&(_.renderToScreen=!1,Z.length>0&&(Z[Z.length-1].renderToScreen=!0))}}removeAllPasses(){const _=this.passes;this.deleteDepthTexture(),_.length>0&&(this.autoRenderToScreen&&(_[_.length-1].renderToScreen=!1),this.passes=[])}render(_){const Z=this.renderer,te=this.copyPass;let ne=this.inputBuffer,ie=this.outputBuffer,oe=!1,se,ae,le;_===void 0&&(this.timer.update(),_=this.timer.getDelta());for(const ce of this.passes)ce.enabled&&(ce.render(Z,ne,ie,_,oe),ce.needsSwap&&(oe&&(te.renderToScreen=ce.renderToScreen,se=Z.getContext(),ae=Z.state.buffers.stencil,ae.setFunc(se.NOTEQUAL,1,4294967295),te.render(Z,ne,ie,_,oe),ae.setFunc(se.EQUAL,1,4294967295)),le=ne,ne=ie,ie=le),ce instanceof MaskPass?oe=!0:ce instanceof ClearMaskPass&&(oe=!1))}setSize(_,Z,te){const ne=this.renderer,ie=ne.getSize(new Vector2);(_===void 0||Z===void 0)&&(_=ie.width,Z=ie.height),(ie.width!==_||ie.height!==Z)&&ne.setSize(_,Z,te);const oe=ne.getDrawingBufferSize(new Vector2);this.inputBuffer.setSize(oe.width,oe.height),this.outputBuffer.setSize(oe.width,oe.height);for(const se of this.passes)se.setSize(oe.width,oe.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const _ of this.passes)_.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Pass.fullscreenGeometry.dispose()}},EffectAttribute={NONE:0,DEPTH:1,CONVOLUTION:2},EffectShaderSection={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},EffectShaderData=class{constructor(){this.shaderParts=new Map([[EffectShaderSection.FRAGMENT_HEAD,null],[EffectShaderSection.FRAGMENT_MAIN_UV,null],[EffectShaderSection.FRAGMENT_MAIN_IMAGE,null],[EffectShaderSection.VERTEX_HEAD,null],[EffectShaderSection.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=EffectAttribute.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=LinearSRGBColorSpace$2}},workaroundEnabled=!1,OverrideMaterialManager=class{constructor(K=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(K),this.meshCount=0,this.replaceMaterial=_=>{if(_.isMesh){let Z;if(_.material.flatShading)switch(_.material.side){case DoubleSide:Z=this.materialsFlatShadedDoubleSide;break;case BackSide:Z=this.materialsFlatShadedBackSide;break;default:Z=this.materialsFlatShaded;break}else switch(_.material.side){case DoubleSide:Z=this.materialsDoubleSide;break;case BackSide:Z=this.materialsBackSide;break;default:Z=this.materials;break}this.originalMaterials.set(_,_.material),_.isSkinnedMesh?_.material=Z[2]:_.isInstancedMesh?_.material=Z[1]:_.material=Z[0],++this.meshCount}}}cloneMaterial(K){if(!(K instanceof ShaderMaterial))return K.clone();const _=K.uniforms,Z=new Map;for(const ne in _){const ie=_[ne].value;ie.isRenderTargetTexture&&(_[ne].value=null,Z.set(ne,ie))}const te=K.clone();for(const ne of Z)_[ne[0]].value=ne[1],te.uniforms[ne[0]].value=ne[1];return te}setMaterial(K){if(this.disposeMaterials(),this.material=K,K!==null){const _=this.materials=[this.cloneMaterial(K),this.cloneMaterial(K),this.cloneMaterial(K)];for(const Z of _)Z.uniforms=Object.assign({},K.uniforms),Z.side=FrontSide;_[2].skinning=!0,this.materialsBackSide=_.map(Z=>{const te=this.cloneMaterial(Z);return te.uniforms=Object.assign({},K.uniforms),te.side=BackSide,te}),this.materialsDoubleSide=_.map(Z=>{const te=this.cloneMaterial(Z);return te.uniforms=Object.assign({},K.uniforms),te.side=DoubleSide,te}),this.materialsFlatShaded=_.map(Z=>{const te=this.cloneMaterial(Z);return te.uniforms=Object.assign({},K.uniforms),te.flatShading=!0,te}),this.materialsFlatShadedBackSide=_.map(Z=>{const te=this.cloneMaterial(Z);return te.uniforms=Object.assign({},K.uniforms),te.flatShading=!0,te.side=BackSide,te}),this.materialsFlatShadedDoubleSide=_.map(Z=>{const te=this.cloneMaterial(Z);return te.uniforms=Object.assign({},K.uniforms),te.flatShading=!0,te.side=DoubleSide,te})}}render(K,_,Z){const te=K.shadowMap.enabled;if(K.shadowMap.enabled=!1,workaroundEnabled){const ne=this.originalMaterials;this.meshCount=0,_.traverse(this.replaceMaterial),K.render(_,Z);for(const ie of ne)ie[0].material=ie[1];this.meshCount!==ne.size&&ne.clear()}else{const ne=_.overrideMaterial;_.overrideMaterial=this.material,K.render(_,Z),_.overrideMaterial=ne}K.shadowMap.enabled=te}disposeMaterials(){if(this.material!==null){const K=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const _ of K)_.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return workaroundEnabled}static set workaroundEnabled(K){workaroundEnabled=K}},AUTO_SIZE=-1,Resolution=class extends EventDispatcher$1{constructor(K,_=AUTO_SIZE,Z=AUTO_SIZE,te=1){super(),this.resizable=K,this.baseSize=new Vector2(1,1),this.preferredSize=new Vector2(_,Z),this.target=this.preferredSize,this.s=te,this.effectiveSize=new Vector2,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const K=this.baseSize,_=this.preferredSize,Z=this.effectiveSize,te=this.scale;_.width!==AUTO_SIZE?Z.width=_.width:_.height!==AUTO_SIZE?Z.width=Math.round(_.height*(K.width/Math.max(K.height,1))):Z.width=Math.round(K.width*te),_.height!==AUTO_SIZE?Z.height=_.height:_.width!==AUTO_SIZE?Z.height=Math.round(_.width/Math.max(K.width/Math.max(K.height,1),1)):Z.height=Math.round(K.height*te)}get width(){return this.effectiveSize.width}set width(K){this.preferredWidth=K}get height(){return this.effectiveSize.height}set height(K){this.preferredHeight=K}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(K){this.s!==K&&(this.s=K,this.preferredSize.setScalar(AUTO_SIZE),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(K){this.scale=K}get baseWidth(){return this.baseSize.width}set baseWidth(K){this.baseSize.width!==K&&(this.baseSize.width=K,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(K){this.baseWidth=K}get baseHeight(){return this.baseSize.height}set baseHeight(K){this.baseSize.height!==K&&(this.baseSize.height=K,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(K){this.baseHeight=K}setBaseSize(K,_){(this.baseSize.width!==K||this.baseSize.height!==_)&&(this.baseSize.set(K,_),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(K){this.preferredSize.width!==K&&(this.preferredSize.width=K,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(K){this.preferredWidth=K}get preferredHeight(){return this.preferredSize.height}set preferredHeight(K){this.preferredSize.height!==K&&(this.preferredSize.height=K,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(K){this.preferredHeight=K}setPreferredSize(K,_){(this.preferredSize.width!==K||this.preferredSize.height!==_)&&(this.preferredSize.set(K,_),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(K){this.s=K.scale,this.baseSize.set(K.baseWidth,K.baseHeight),this.preferredSize.set(K.preferredWidth,K.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return AUTO_SIZE}},BlendFunction={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},add_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",alpha_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",average_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",color_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",color_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",color_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",darken_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",difference_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",divide_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",exclusion_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",hard_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",hard_mix_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",hue_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",invert_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",invert_rgb_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",lighten_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",linear_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",linear_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",linear_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",luminosity_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",multiply_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",negation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",normal_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",overlay_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",pin_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",reflect_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",saturation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",screen_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",soft_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",src_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",subtract_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",vivid_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",blendFunctions=new Map([[BlendFunction.ADD,add_default],[BlendFunction.ALPHA,alpha_default],[BlendFunction.AVERAGE,average_default],[BlendFunction.COLOR,color_default],[BlendFunction.COLOR_BURN,color_burn_default],[BlendFunction.COLOR_DODGE,color_dodge_default],[BlendFunction.DARKEN,darken_default],[BlendFunction.DIFFERENCE,difference_default],[BlendFunction.DIVIDE,divide_default],[BlendFunction.DST,null],[BlendFunction.EXCLUSION,exclusion_default],[BlendFunction.HARD_LIGHT,hard_light_default],[BlendFunction.HARD_MIX,hard_mix_default],[BlendFunction.HUE,hue_default],[BlendFunction.INVERT,invert_default],[BlendFunction.INVERT_RGB,invert_rgb_default],[BlendFunction.LIGHTEN,lighten_default],[BlendFunction.LINEAR_BURN,linear_burn_default],[BlendFunction.LINEAR_DODGE,linear_dodge_default],[BlendFunction.LINEAR_LIGHT,linear_light_default],[BlendFunction.LUMINOSITY,luminosity_default],[BlendFunction.MULTIPLY,multiply_default],[BlendFunction.NEGATION,negation_default],[BlendFunction.NORMAL,normal_default],[BlendFunction.OVERLAY,overlay_default],[BlendFunction.PIN_LIGHT,pin_light_default],[BlendFunction.REFLECT,reflect_default],[BlendFunction.SATURATION,saturation_default],[BlendFunction.SCREEN,screen_default],[BlendFunction.SOFT_LIGHT,soft_light_default],[BlendFunction.SRC,src_default],[BlendFunction.SUBTRACT,subtract_default],[BlendFunction.VIVID_LIGHT,vivid_light_default]]),BlendMode=class extends EventDispatcher$1{constructor(K,_=1){super(),this._blendFunction=K,this.opacity=new Uniform(_)}getOpacity(){return this.opacity.value}setOpacity(K){this.opacity.value=K}get blendFunction(){return this._blendFunction}set blendFunction(K){this._blendFunction=K,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(K){this.blendFunction=K}getShaderCode(){return blendFunctions.get(this.blendFunction)}},Effect=class extends EventDispatcher$1{constructor(K,_,{attributes:Z=EffectAttribute.NONE,blendFunction:te=BlendFunction.NORMAL,defines:ne=new Map,uniforms:ie=new Map,extensions:oe=null,vertexShader:se=null}={}){super(),this.name=K,this.renderer=null,this.attributes=Z,this.fragmentShader=_,this.vertexShader=se,this.defines=ne,this.uniforms=ie,this.extensions=oe,this.blendMode=new BlendMode(te),this.blendMode.addEventListener("change",ae=>this.setChanged()),this._inputColorSpace=LinearSRGBColorSpace$2,this._outputColorSpace=NoColorSpace$1}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(K){this._inputColorSpace=K,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(K){this._outputColorSpace=K,this.setChanged()}set mainScene(K){}set mainCamera(K){}getName(){return this.name}setRenderer(K){this.renderer=K}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(K){this.attributes=K,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(K){this.fragmentShader=K,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(K){this.vertexShader=K,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(K,_=BasicDepthPacking){}update(K,_,Z){}setSize(K,_){}initialize(K,_,Z){}dispose(){for(const K of Object.keys(this)){const _=this[K];(_ instanceof WebGLRenderTarget||_ instanceof Material||_ instanceof Texture$1||_ instanceof Pass)&&this[K].dispose()}}},KernelSize={MEDIUM:2,LARGE:3},convolution_kawase_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,convolution_kawase_default2="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",kernelPresets=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],KawaseBlurMaterial=class extends ShaderMaterial{constructor(K=new Vector4){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Uniform(null),texelSize:new Uniform(new Vector4),scale:new Uniform(1),kernel:new Uniform(0)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_kawase_default,vertexShader:convolution_kawase_default2}),this.setTexelSize(K.x,K.y),this.kernelSize=KernelSize.MEDIUM}set inputBuffer(K){this.uniforms.inputBuffer.value=K}setInputBuffer(K){this.inputBuffer=K}get kernelSequence(){return kernelPresets[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(K){this.uniforms.scale.value=K}getScale(){return this.uniforms.scale.value}setScale(K){this.uniforms.scale.value=K}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(K){this.uniforms.kernel.value=K}setKernel(K){this.kernel=K}setTexelSize(K,_){this.uniforms.texelSize.value.set(K,_,K*.5,_*.5)}setSize(K,_){const Z=1/K,te=1/_;this.uniforms.texelSize.value.set(Z,te,Z*.5,te*.5)}},KawaseBlurPass=class extends Pass{constructor({kernelSize:K=KernelSize.MEDIUM,resolutionScale:_=.5,width:Z=Resolution.AUTO_SIZE,height:te=Resolution.AUTO_SIZE,resolutionX:ne=Z,resolutionY:ie=te}={}){super("KawaseBlurPass"),this.renderTargetA=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const oe=this.resolution=new Resolution(this,ne,ie,_);oe.addEventListener("change",se=>this.setSize(oe.baseWidth,oe.baseHeight)),this._blurMaterial=new KawaseBlurMaterial,this._blurMaterial.kernelSize=K,this.copyMaterial=new CopyMaterial$1}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(K){this._blurMaterial=K}get dithering(){return this.copyMaterial.dithering}set dithering(K){this.copyMaterial.dithering=K}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(K){this.blurMaterial.kernelSize=K}get width(){return this.resolution.width}set width(K){this.resolution.preferredWidth=K}get height(){return this.resolution.height}set height(K){this.resolution.preferredHeight=K}get scale(){return this.blurMaterial.scale}set scale(K){this.blurMaterial.scale=K}getScale(){return this.blurMaterial.scale}setScale(K){this.blurMaterial.scale=K}getKernelSize(){return this.kernelSize}setKernelSize(K){this.kernelSize=K}getResolutionScale(){return this.resolution.scale}setResolutionScale(K){this.resolution.scale=K}render(K,_,Z,te,ne){const ie=this.scene,oe=this.camera,se=this.renderTargetA,ae=this.renderTargetB,le=this.blurMaterial,ce=le.kernelSequence;let fe=_;this.fullscreenMaterial=le;for(let de=0,pe=ce.length;de<pe;++de){const he=de&1?ae:se;le.kernel=ce[de],le.inputBuffer=fe.texture,K.setRenderTarget(he),K.render(ie,oe),fe=he}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=fe.texture,K.setRenderTarget(this.renderToScreen?null:Z),K.render(ie,oe)}setSize(K,_){const Z=this.resolution;Z.setBaseSize(K,_);const te=Z.width,ne=Z.height;this.renderTargetA.setSize(te,ne),this.renderTargetB.setSize(te,ne),this.blurMaterial.setSize(K,_)}initialize(K,_,Z){Z!==void 0&&(this.renderTargetA.texture.type=Z,this.renderTargetB.texture.type=Z,Z!==UnsignedByteType?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):K!==null&&K.outputColorSpace===SRGBColorSpace$2&&(this.renderTargetA.texture.colorSpace=SRGBColorSpace$2,this.renderTargetB.texture.colorSpace=SRGBColorSpace$2))}static get AUTO_SIZE(){return Resolution.AUTO_SIZE}},luminance_default=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,LuminanceMaterial=class extends ShaderMaterial{constructor(K=!1,_=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:REVISION.replace(/\D+/g,"")},uniforms:{inputBuffer:new Uniform(null),threshold:new Uniform(0),smoothing:new Uniform(1),range:new Uniform(null)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:luminance_default,vertexShader:common_default}),this.colorOutput=K,this.luminanceRange=_}set inputBuffer(K){this.uniforms.inputBuffer.value=K}setInputBuffer(K){this.uniforms.inputBuffer.value=K}get threshold(){return this.uniforms.threshold.value}set threshold(K){this.smoothing>0||K>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=K}getThreshold(){return this.threshold}setThreshold(K){this.threshold=K}get smoothing(){return this.uniforms.smoothing.value}set smoothing(K){this.threshold>0||K>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=K}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(K){this.smoothing=K}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(K){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(K){K?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(K){return this.colorOutput}setColorOutputEnabled(K){this.colorOutput=K}get useRange(){return this.luminanceRange!==null}set useRange(K){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(K){K!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=K,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(K){this.luminanceRange=K}},LuminancePass=class extends Pass{constructor({renderTarget:K,luminanceRange:_,colorOutput:Z,resolutionScale:te=1,width:ne=Resolution.AUTO_SIZE,height:ie=Resolution.AUTO_SIZE,resolutionX:oe=ne,resolutionY:se=ie}={}){super("LuminancePass"),this.fullscreenMaterial=new LuminanceMaterial(Z,_),this.needsSwap=!1,this.renderTarget=K,this.renderTarget===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const ae=this.resolution=new Resolution(this,oe,se,te);ae.addEventListener("change",le=>this.setSize(ae.baseWidth,ae.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(K,_,Z,te,ne){const ie=this.fullscreenMaterial;ie.inputBuffer=_.texture,K.setRenderTarget(this.renderToScreen?null:this.renderTarget),K.render(this.scene,this.camera)}setSize(K,_){const Z=this.resolution;Z.setBaseSize(K,_),this.renderTarget.setSize(Z.width,Z.height)}initialize(K,_,Z){Z!==void 0&&Z!==UnsignedByteType&&(this.renderTarget.texture.type=Z,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},convolution_downsampling_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,convolution_downsampling_default2="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",DownsamplingMaterial=class extends ShaderMaterial{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Uniform(null),texelSize:new Uniform(new Vector2)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_downsampling_default,vertexShader:convolution_downsampling_default2})}set inputBuffer(K){this.uniforms.inputBuffer.value=K}setSize(K,_){this.uniforms.texelSize.value.set(1/K,1/_)}},convolution_upsampling_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,convolution_upsampling_default2="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",UpsamplingMaterial=class extends ShaderMaterial{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Uniform(null),supportBuffer:new Uniform(null),texelSize:new Uniform(new Vector2),radius:new Uniform(.85)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_upsampling_default,vertexShader:convolution_upsampling_default2})}set inputBuffer(K){this.uniforms.inputBuffer.value=K}set supportBuffer(K){this.uniforms.supportBuffer.value=K}get radius(){return this.uniforms.radius.value}set radius(K){this.uniforms.radius.value=K}setSize(K,_){this.uniforms.texelSize.value.set(1/K,1/_)}},MipmapBlurPass=class extends Pass{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new DownsamplingMaterial,this.upsamplingMaterial=new UpsamplingMaterial,this.resolution=new Vector2}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(K){if(this.levels!==K){const _=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let Z=0;Z<K;++Z){const te=_.clone();te.texture.name="Downsampling.Mipmap"+Z,this.downsamplingMipmaps.push(te)}this.upsamplingMipmaps.push(_);for(let Z=1,te=K-1;Z<te;++Z){const ne=_.clone();ne.texture.name="Upsampling.Mipmap"+Z,this.upsamplingMipmaps.push(ne)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(K){this.upsamplingMaterial.radius=K}render(K,_,Z,te,ne){const{scene:ie,camera:oe}=this,{downsamplingMaterial:se,upsamplingMaterial:ae}=this,{downsamplingMipmaps:le,upsamplingMipmaps:ce}=this;let fe=_;this.fullscreenMaterial=se;for(let de=0,pe=le.length;de<pe;++de){const he=le[de];se.setSize(fe.width,fe.height),se.inputBuffer=fe.texture,K.setRenderTarget(he),K.render(ie,oe),fe=he}this.fullscreenMaterial=ae;for(let de=ce.length-1;de>=0;--de){const pe=ce[de];ae.setSize(fe.width,fe.height),ae.inputBuffer=fe.texture,ae.supportBuffer=le[de].texture,K.setRenderTarget(pe),K.render(ie,oe),fe=pe}}setSize(K,_){const Z=this.resolution;Z.set(K,_);let te=Z.width,ne=Z.height;for(let ie=0,oe=this.downsamplingMipmaps.length;ie<oe;++ie)te=Math.round(te*.5),ne=Math.round(ne*.5),this.downsamplingMipmaps[ie].setSize(te,ne),ie<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[ie].setSize(te,ne)}initialize(K,_,Z){if(Z!==void 0){const te=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const ne of te)ne.texture.type=Z;if(Z!==UnsignedByteType)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(K!==null&&K.outputColorSpace===SRGBColorSpace$2)for(const ne of te)ne.texture.colorSpace=SRGBColorSpace$2}}dispose(){super.dispose();for(const K of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))K.dispose()}},bloom_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,BloomEffect=class extends Effect{constructor({blendFunction:K=BlendFunction.SCREEN,luminanceThreshold:_=.9,luminanceSmoothing:Z=.025,mipmapBlur:te=!1,intensity:ne=1,radius:ie=.85,levels:oe=8,kernelSize:se=KernelSize.LARGE,resolutionScale:ae=.5,width:le=Resolution.AUTO_SIZE,height:ce=Resolution.AUTO_SIZE,resolutionX:fe=le,resolutionY:de=ce}={}){super("BloomEffect",bloom_default,{blendFunction:K,uniforms:new Map([["map",new Uniform(null)],["intensity",new Uniform(ne)]])}),this.renderTarget=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new KawaseBlurPass({kernelSize:se}),this.luminancePass=new LuminancePass({colorOutput:!0}),this.luminanceMaterial.threshold=_,this.luminanceMaterial.smoothing=Z,this.mipmapBlurPass=new MipmapBlurPass,this.mipmapBlurPass.enabled=te,this.mipmapBlurPass.radius=ie,this.mipmapBlurPass.levels=oe,this.uniforms.get("map").value=te?this.mipmapBlurPass.texture:this.renderTarget.texture;const pe=this.resolution=new Resolution(this,fe,de,ae);pe.addEventListener("change",he=>this.setSize(pe.baseWidth,pe.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(K){this.resolution.preferredWidth=K}get height(){return this.resolution.height}set height(K){this.resolution.preferredHeight=K}get dithering(){return this.blurPass.dithering}set dithering(K){this.blurPass.dithering=K}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(K){this.blurPass.kernelSize=K}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(K){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(K){this.uniforms.get("intensity").value=K}getIntensity(){return this.intensity}setIntensity(K){this.intensity=K}getResolutionScale(){return this.resolution.scale}setResolutionScale(K){this.resolution.scale=K}update(K,_,Z){const te=this.renderTarget,ne=this.luminancePass;ne.enabled?(ne.render(K,_),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(K,ne.renderTarget):this.blurPass.render(K,ne.renderTarget,te)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(K,_):this.blurPass.render(K,_,te)}setSize(K,_){const Z=this.resolution;Z.setBaseSize(K,_),this.renderTarget.setSize(Z.width,Z.height),this.blurPass.resolution.copy(Z),this.luminancePass.setSize(K,_),this.mipmapBlurPass.setSize(K,_)}initialize(K,_,Z){this.blurPass.initialize(K,_,Z),this.luminancePass.initialize(K,_,Z),this.mipmapBlurPass.initialize(K,_,Z),Z!==void 0&&(this.renderTarget.texture.type=Z,K!==null&&K.outputColorSpace===SRGBColorSpace$2&&(this.renderTarget.texture.colorSpace=SRGBColorSpace$2))}},RenderPass=class extends Pass{constructor(K,_,Z=null){super("RenderPass",K,_),this.needsSwap=!1,this.clearPass=new ClearPass,this.overrideMaterialManager=Z===null?null:new OverrideMaterialManager(Z),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(K){this.scene=K}set mainCamera(K){this.camera=K}get renderToScreen(){return super.renderToScreen}set renderToScreen(K){super.renderToScreen=K,this.clearPass.renderToScreen=K}get overrideMaterial(){const K=this.overrideMaterialManager;return K!==null?K.material:null}set overrideMaterial(K){const _=this.overrideMaterialManager;K!==null?_!==null?_.setMaterial(K):this.overrideMaterialManager=new OverrideMaterialManager(K):_!==null&&(_.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(K){this.overrideMaterial=K}get clear(){return this.clearPass.enabled}set clear(K){this.clearPass.enabled=K}getSelection(){return this.selection}setSelection(K){this.selection=K}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(K){this.ignoreBackground=K}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(K){this.skipShadowMapUpdate=K}getClearPass(){return this.clearPass}render(K,_,Z,te,ne){const ie=this.scene,oe=this.camera,se=this.selection,ae=oe.layers.mask,le=ie.background,ce=K.shadowMap.autoUpdate,fe=this.renderToScreen?null:_;se!==null&&oe.layers.set(se.getLayer()),this.skipShadowMapUpdate&&(K.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(ie.background=null),this.clearPass.enabled&&this.clearPass.render(K,_),K.setRenderTarget(fe),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(K,ie,oe):K.render(ie,oe),oe.layers.mask=ae,ie.background=le,K.shadowMap.autoUpdate=ce}},depth_downsampling_default=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,depth_downsampling_default2="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",DepthDownsamplingMaterial=class extends ShaderMaterial{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Uniform(null),normalBuffer:new Uniform(null),texelSize:new Uniform(new Vector2)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:depth_downsampling_default,vertexShader:depth_downsampling_default2})}set depthBuffer(K){this.uniforms.depthBuffer.value=K}set depthPacking(K){this.defines.DEPTH_PACKING=K.toFixed(0),this.needsUpdate=!0}setDepthBuffer(K,_=BasicDepthPacking){this.depthBuffer=K,this.depthPacking=_}set normalBuffer(K){this.uniforms.normalBuffer.value=K,K!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(K){this.normalBuffer=K}setTexelSize(K,_){this.uniforms.texelSize.value.set(K,_)}setSize(K,_){this.uniforms.texelSize.value.set(1/K,1/_)}},DepthDownsamplingPass=class extends Pass{constructor({normalBuffer:K=null,resolutionScale:_=.5,width:Z=Resolution.AUTO_SIZE,height:te=Resolution.AUTO_SIZE,resolutionX:ne=Z,resolutionY:ie=te}={}){super("DepthDownsamplingPass");const oe=new DepthDownsamplingMaterial;oe.normalBuffer=K,this.fullscreenMaterial=oe,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter,depthBuffer:!1,type:FloatType}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const se=this.resolution=new Resolution(this,ne,ie,_);se.addEventListener("change",ae=>this.setSize(se.baseWidth,se.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(K,_=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=K,this.fullscreenMaterial.depthPacking=_}render(K,_,Z,te,ne){K.setRenderTarget(this.renderToScreen?null:this.renderTarget),K.render(this.scene,this.camera)}setSize(K,_){const Z=this.resolution;Z.setBaseSize(K,_),this.renderTarget.setSize(Z.width,Z.height),this.fullscreenMaterial.setSize(K,_)}initialize(K,_,Z){const te=K.getContext();if(!(te.getExtension("EXT_color_buffer_float")||te.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},effect_default=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,effect_default2="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",EffectMaterial=class extends ShaderMaterial{constructor(K,_,Z,te,ne=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:REVISION.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Uniform(null),depthBuffer:new Uniform(null),resolution:new Uniform(new Vector2),texelSize:new Uniform(new Vector2),cameraNear:new Uniform(.3),cameraFar:new Uniform(1e3),aspect:new Uniform(1),time:new Uniform(0)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:ne}),K&&this.setShaderParts(K),_&&this.setDefines(_),Z&&this.setUniforms(Z),this.copyCameraSettings(te)}set inputBuffer(K){this.uniforms.inputBuffer.value=K}setInputBuffer(K){this.uniforms.inputBuffer.value=K}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(K){this.uniforms.depthBuffer.value=K}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(K){this.defines.DEPTH_PACKING=K.toFixed(0),this.needsUpdate=!0}setDepthBuffer(K,_=BasicDepthPacking){this.depthBuffer=K,this.depthPacking=_}setShaderData(K){this.setShaderParts(K.shaderParts),this.setDefines(K.defines),this.setUniforms(K.uniforms),this.setExtensions(K.extensions)}setShaderParts(K){return this.fragmentShader=effect_default.replace(EffectShaderSection.FRAGMENT_HEAD,K.get(EffectShaderSection.FRAGMENT_HEAD)||"").replace(EffectShaderSection.FRAGMENT_MAIN_UV,K.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"").replace(EffectShaderSection.FRAGMENT_MAIN_IMAGE,K.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=effect_default2.replace(EffectShaderSection.VERTEX_HEAD,K.get(EffectShaderSection.VERTEX_HEAD)||"").replace(EffectShaderSection.VERTEX_MAIN_SUPPORT,K.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(K){for(const _ of K.entries())this.defines[_[0]]=_[1];return this.needsUpdate=!0,this}setUniforms(K){for(const _ of K.entries())this.uniforms[_[0]]=_[1];return this}setExtensions(K){this.extensions={};for(const _ of K)this.extensions[_]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(K){this.encodeOutput!==K&&(K?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(K){return this.encodeOutput}setOutputEncodingEnabled(K){this.encodeOutput=K}get time(){return this.uniforms.time.value}set time(K){this.uniforms.time.value=K}setDeltaTime(K){this.uniforms.time.value+=K}adoptCameraSettings(K){this.copyCameraSettings(K)}copyCameraSettings(K){K&&(this.uniforms.cameraNear.value=K.near,this.uniforms.cameraFar.value=K.far,K instanceof PerspectiveCamera$2?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(K,_){const Z=this.uniforms;Z.resolution.value.set(K,_),Z.texelSize.value.set(1/K,1/_),Z.aspect.value=K/_}static get Section(){return EffectShaderSection}};function prefixSubstrings(K,_,Z){for(const te of _){const ne="$1"+K+te.charAt(0).toUpperCase()+te.slice(1),ie=new RegExp("([^\\.])(\\b"+te+"\\b)","g");for(const oe of Z.entries())oe[1]!==null&&Z.set(oe[0],oe[1].replace(ie,ne))}}function integrateEffect(K,_,Z){let te=_.getFragmentShader(),ne=_.getVertexShader();const ie=te!==void 0&&/mainImage/.test(te),oe=te!==void 0&&/mainUv/.test(te);if(Z.attributes|=_.getAttributes(),te===void 0)throw new Error(`Missing fragment shader (${_.name})`);if(oe&&Z.attributes&EffectAttribute.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${_.name})`);if(!ie&&!oe)throw new Error(`Could not find mainImage or mainUv function (${_.name})`);{const se=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,ae=Z.shaderParts;let le=ae.get(EffectShaderSection.FRAGMENT_HEAD)||"",ce=ae.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"",fe=ae.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||"",de=ae.get(EffectShaderSection.VERTEX_HEAD)||"",pe=ae.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||"";const he=new Set,ge=new Set;if(oe&&(ce+=`	${K}MainUv(UV);
`,Z.uvTransformation=!0),ne!==null&&/mainSupport/.test(ne)){const ye=/mainSupport *\([\w\s]*?uv\s*?\)/.test(ne);pe+=`	${K}MainSupport(`,pe+=ye?`vUv);
`:`);
`;for(const ve of ne.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const _e of ve[1].split(/\s*,\s*/))Z.varyings.add(_e),he.add(_e),ge.add(_e);for(const ve of ne.matchAll(se))ge.add(ve[1])}for(const ye of te.matchAll(se))ge.add(ye[1]);for(const ye of _.defines.keys())ge.add(ye.replace(/\([\w\s,]*\)/g,""));for(const ye of _.uniforms.keys())ge.add(ye);ge.delete("while"),ge.delete("for"),ge.delete("if"),_.uniforms.forEach((ye,ve)=>Z.uniforms.set(K+ve.charAt(0).toUpperCase()+ve.slice(1),ye)),_.defines.forEach((ye,ve)=>Z.defines.set(K+ve.charAt(0).toUpperCase()+ve.slice(1),ye));const me=new Map([["fragment",te],["vertex",ne]]);prefixSubstrings(K,ge,Z.defines),prefixSubstrings(K,ge,me),te=me.get("fragment"),ne=me.get("vertex");const Ae=_.blendMode;if(Z.blendModes.set(Ae.blendFunction,Ae),ie){_.inputColorSpace!==null&&_.inputColorSpace!==Z.colorSpace&&(fe+=_.inputColorSpace===SRGBColorSpace$2?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),_.outputColorSpace!==NoColorSpace$1?Z.colorSpace=_.outputColorSpace:_.inputColorSpace!==null&&(Z.colorSpace=_.inputColorSpace);const ye=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;fe+=`${K}MainImage(color0, UV, `,Z.attributes&EffectAttribute.DEPTH&&ye.test(te)&&(fe+="depth, ",Z.readDepth=!0),fe+=`color1);
	`;const ve=K+"BlendOpacity";Z.uniforms.set(ve,Ae.opacity),fe+=`color0 = blend${Ae.blendFunction}(color0, color1, ${ve});

	`,le+=`uniform float ${ve};

`}if(le+=te+`
`,ne!==null&&(de+=ne+`
`),ae.set(EffectShaderSection.FRAGMENT_HEAD,le),ae.set(EffectShaderSection.FRAGMENT_MAIN_UV,ce),ae.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,fe),ae.set(EffectShaderSection.VERTEX_HEAD,de),ae.set(EffectShaderSection.VERTEX_MAIN_SUPPORT,pe),_.extensions!==null)for(const ye of _.extensions)Z.extensions.add(ye)}}var EffectPass=class extends Pass{constructor(K,..._){super("EffectPass"),this.fullscreenMaterial=new EffectMaterial(null,null,null,K),this.listener=Z=>this.handleEvent(Z),this.effects=[],this.setEffects(_),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(K){for(const _ of this.effects)_.mainScene=K}set mainCamera(K){this.fullscreenMaterial.copyCameraSettings(K);for(const _ of this.effects)_.mainCamera=K}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(K){this.fullscreenMaterial.encodeOutput=K}get dithering(){return this.fullscreenMaterial.dithering}set dithering(K){const _=this.fullscreenMaterial;_.dithering=K,_.needsUpdate=!0}setEffects(K){for(const _ of this.effects)_.removeEventListener("change",this.listener);this.effects=K.sort((_,Z)=>Z.attributes-_.attributes);for(const _ of this.effects)_.addEventListener("change",this.listener)}updateMaterial(){const K=new EffectShaderData;let _=0;for(const oe of this.effects)if(oe.blendMode.blendFunction===BlendFunction.DST)K.attributes|=oe.getAttributes()&EffectAttribute.DEPTH;else{if(K.attributes&oe.getAttributes()&EffectAttribute.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${oe.name})`);integrateEffect("e"+_++,oe,K)}let Z=K.shaderParts.get(EffectShaderSection.FRAGMENT_HEAD),te=K.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE),ne=K.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_UV);const ie=/\bblend\b/g;for(const oe of K.blendModes.values())Z+=oe.getShaderCode().replace(ie,`blend${oe.blendFunction}`)+`
`;K.attributes&EffectAttribute.DEPTH?(K.readDepth&&(te=`float depth = readDepth(UV);

	`+te),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,K.colorSpace===SRGBColorSpace$2&&(te+=`color0 = sRGBToLinear(color0);
	`),K.uvTransformation?(ne=`vec2 transformedUv = vUv;
`+ne,K.defines.set("UV","transformedUv")):K.defines.set("UV","vUv"),K.shaderParts.set(EffectShaderSection.FRAGMENT_HEAD,Z),K.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,te),K.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_UV,ne);for(const[oe,se]of K.shaderParts)se!==null&&K.shaderParts.set(oe,se.trim().replace(/^#/,`
#`));this.skipRendering=_===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(K)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(K,_=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=K,this.fullscreenMaterial.depthPacking=_;for(const Z of this.effects)Z.setDepthTexture(K,_)}render(K,_,Z,te,ne){for(const ie of this.effects)ie.update(K,_,te);if(!this.skipRendering||this.renderToScreen){const ie=this.fullscreenMaterial;ie.inputBuffer=_.texture,ie.time+=te*this.timeScale,K.setRenderTarget(this.renderToScreen?null:Z),K.render(this.scene,this.camera)}}setSize(K,_){this.fullscreenMaterial.setSize(K,_);for(const Z of this.effects)Z.setSize(K,_)}initialize(K,_,Z){this.renderer=K;for(const te of this.effects)te.initialize(K,_,Z);this.updateMaterial(),Z!==void 0&&Z!==UnsignedByteType&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const K of this.effects)K.removeEventListener("change",this.listener),K.dispose()}handleEvent(K){switch(K.type){case"change":this.recompile();break}}},NormalPass=class extends Pass{constructor(K,_,{renderTarget:Z,resolutionScale:te=1,width:ne=Resolution.AUTO_SIZE,height:ie=Resolution.AUTO_SIZE,resolutionX:oe=ne,resolutionY:se=ie}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new RenderPass(K,_,new MeshNormalMaterial);const ae=this.renderPass;ae.ignoreBackground=!0,ae.skipShadowMapUpdate=!0;const le=ae.getClearPass();le.overrideClearColor=new Color$1(7829503),le.overrideClearAlpha=1,this.renderTarget=Z,this.renderTarget===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter}),this.renderTarget.texture.name="NormalPass.Target");const ce=this.resolution=new Resolution(this,oe,se,te);ce.addEventListener("change",fe=>this.setSize(ce.baseWidth,ce.baseHeight))}set mainScene(K){this.renderPass.mainScene=K}set mainCamera(K){this.renderPass.mainCamera=K}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(K){this.resolution.scale=K}render(K,_,Z,te,ne){const ie=this.renderToScreen?null:this.renderTarget;this.renderPass.render(K,ie,ie)}setSize(K,_){const Z=this.resolution;Z.setBaseSize(K,_),this.renderTarget.setSize(Z.width,Z.height)}};const EffectComposerContext=reactExports.createContext(null),isConvolution=K=>(K.getAttributes()&EffectAttribute.CONVOLUTION)===EffectAttribute.CONVOLUTION,EffectComposer=React.memo(reactExports.forwardRef(({children:K,camera:_,scene:Z,resolutionScale:te,enabled:ne=!0,renderPriority:ie=1,autoClear:oe=!0,depthBuffer:se,enableNormalPass:ae,stencilBuffer:le,multisampling:ce=8,frameBufferType:fe=HalfFloatType},de)=>{const{gl:pe,scene:he,camera:ge,size:me}=useThree(),Ae=Z||he,ye=_||ge,[ve,_e,Te]=reactExports.useMemo(()=>{const we=isWebGL2Available$1(),Pe=new EffectComposer$1(pe,{depthBuffer:se,stencilBuffer:le,multisampling:ce>0&&we?ce:0,frameBufferType:fe});Pe.addPass(new RenderPass(Ae,ye));let Ie=null,$e=null;return ae&&($e=new NormalPass(Ae,ye),$e.enabled=!1,Pe.addPass($e),te!==void 0&&we&&(Ie=new DepthDownsamplingPass({normalBuffer:$e.texture,resolutionScale:te}),Ie.enabled=!1,Pe.addPass(Ie))),[Pe,$e,Ie]},[ye,pe,se,le,ce,fe,Ae,ae,te]);reactExports.useEffect(()=>ve==null?void 0:ve.setSize(me.width,me.height),[ve,me]),useFrame((we,Pe)=>{if(ne){const Ie=pe.autoClear;pe.autoClear=oe,le&&!oe&&pe.clearStencil(),ve.render(Pe),pe.autoClear=Ie}},ne?ie:0);const be=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{var we;const Pe=[],Ie=(we=be.current)==null?void 0:we.__r3f;if(Ie&&ve){const $e=Ie.objects;for(let Ue=0;Ue<$e.length;Ue++){const ke=$e[Ue];if(ke instanceof Effect){const Ge=[ke];if(!isConvolution(ke)){let ze=null;for(;(ze=$e[Ue+1])instanceof Effect&&!isConvolution(ze);)Ge.push(ze),Ue++}const He=new EffectPass(ye,...Ge);Pe.push(He)}else ke instanceof Pass&&Pe.push(ke)}for(const Ue of Pe)ve==null||ve.addPass(Ue);_e&&(_e.enabled=!0),Te&&(Te.enabled=!0)}return()=>{for(const $e of Pe)ve==null||ve.removePass($e);_e&&(_e.enabled=!1),Te&&(Te.enabled=!1)}},[ve,K,ye,_e,Te]),reactExports.useEffect(()=>{const we=pe.toneMapping;return pe.toneMapping=NoToneMapping,()=>{pe.toneMapping=we}},[pe]);const Re=reactExports.useMemo(()=>({composer:ve,normalPass:_e,downSamplingPass:Te,resolutionScale:te,camera:ye,scene:Ae}),[ve,_e,Te,te,ye,Ae]);return reactExports.useImperativeHandle(de,()=>ve,[ve]),jsxRuntimeExports.jsx(EffectComposerContext.Provider,{value:Re,children:jsxRuntimeExports.jsx("group",{ref:be,children:K})})}));let i$3=0;const components=new WeakMap,wrapEffect=(K,_)=>React.forwardRef(function({blendFunction:te=_==null?void 0:_.blendFunction,opacity:ne=_==null?void 0:_.opacity,...ie},oe){let se=components.get(K);if(!se){const ce=`@react-three/postprocessing/${K.name}-${i$3++}`;extend$6({[ce]:K}),components.set(K,se=ce)}const ae=useThree(ce=>ce.camera),le=React.useMemo(()=>{var ce,fe;return[...(ce=_==null?void 0:_.args)!=null?ce:[],...(fe=ie.args)!=null?fe:[{..._,...ie}]]},[JSON.stringify(ie)]);return jsxRuntimeExports.jsx(se,{camera:ae,"blendMode-blendFunction":te,"blendMode-opacity-value":ne,...ie,ref:oe,args:le})}),Bloom=wrapEffect(BloomEffect,{blendFunction:BlendFunction.ADD}),version$1=parseInt(REVISION.replace(/\D+/g,"")),WebGLMultipleRenderTargets=version$1>=162?class extends WebGLRenderTarget{constructor(K=1,_=1,Z=1,te={}){super(K,_,{...te,count:Z}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}:class extends WebGLRenderTarget{constructor(K=1,_=1,Z=1,te={}){super(K,_,te),this.isWebGLMultipleRenderTargets=!0;const ne=this.texture;this.texture=[];for(let ie=0;ie<Z;ie++)this.texture[ie]=ne.clone(),this.texture[ie].isRenderTargetTexture=!0}setSize(K,_,Z=1){if(this.width!==K||this.height!==_||this.depth!==Z){this.width=K,this.height=_,this.depth=Z;for(let te=0,ne=this.texture.length;te<ne;te++)this.texture[te].image.width=K,this.texture[te].image.height=_,this.texture[te].image.depth=Z;this.dispose()}this.viewport.set(0,0,K,_),this.scissor.set(0,0,K,_)}copy(K){this.dispose(),this.width=K.width,this.height=K.height,this.depth=K.depth,this.scissor.copy(K.scissor),this.scissorTest=K.scissorTest,this.viewport.copy(K.viewport),this.depthBuffer=K.depthBuffer,this.stencilBuffer=K.stencilBuffer,K.depthTexture!==null&&(this.depthTexture=K.depthTexture.clone()),this.texture.length=0;for(let _=0,Z=K.texture.length;_<Z;_++)this.texture[_]=K.texture[_].clone(),this.texture[_].isRenderTargetTexture=!0;return this}};var buffer$4={},base64Js$1={};base64Js$1.byteLength=byteLength$1;base64Js$1.toByteArray=toByteArray$1;base64Js$1.fromByteArray=fromByteArray$1;var lookup$1=[],revLookup$1=[],Arr$1=typeof Uint8Array<"u"?Uint8Array:Array,code$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$2=0,len$1=code$2.length;i$2<len$1;++i$2)lookup$1[i$2]=code$2[i$2],revLookup$1[code$2.charCodeAt(i$2)]=i$2;revLookup$1[45]=62;revLookup$1[95]=63;function getLens$1(K){var _=K.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Z=K.indexOf("=");Z===-1&&(Z=_);var te=Z===_?0:4-Z%4;return[Z,te]}function byteLength$1(K){var _=getLens$1(K),Z=_[0],te=_[1];return(Z+te)*3/4-te}function _byteLength$1(K,_,Z){return(_+Z)*3/4-Z}function toByteArray$1(K){var _,Z=getLens$1(K),te=Z[0],ne=Z[1],ie=new Arr$1(_byteLength$1(K,te,ne)),oe=0,se=ne>0?te-4:te,ae;for(ae=0;ae<se;ae+=4)_=revLookup$1[K.charCodeAt(ae)]<<18|revLookup$1[K.charCodeAt(ae+1)]<<12|revLookup$1[K.charCodeAt(ae+2)]<<6|revLookup$1[K.charCodeAt(ae+3)],ie[oe++]=_>>16&255,ie[oe++]=_>>8&255,ie[oe++]=_&255;return ne===2&&(_=revLookup$1[K.charCodeAt(ae)]<<2|revLookup$1[K.charCodeAt(ae+1)]>>4,ie[oe++]=_&255),ne===1&&(_=revLookup$1[K.charCodeAt(ae)]<<10|revLookup$1[K.charCodeAt(ae+1)]<<4|revLookup$1[K.charCodeAt(ae+2)]>>2,ie[oe++]=_>>8&255,ie[oe++]=_&255),ie}function tripletToBase64$1(K){return lookup$1[K>>18&63]+lookup$1[K>>12&63]+lookup$1[K>>6&63]+lookup$1[K&63]}function encodeChunk$1(K,_,Z){for(var te,ne=[],ie=_;ie<Z;ie+=3)te=(K[ie]<<16&16711680)+(K[ie+1]<<8&65280)+(K[ie+2]&255),ne.push(tripletToBase64$1(te));return ne.join("")}function fromByteArray$1(K){for(var _,Z=K.length,te=Z%3,ne=[],ie=16383,oe=0,se=Z-te;oe<se;oe+=ie)ne.push(encodeChunk$1(K,oe,oe+ie>se?se:oe+ie));return te===1?(_=K[Z-1],ne.push(lookup$1[_>>2]+lookup$1[_<<4&63]+"==")):te===2&&(_=(K[Z-2]<<8)+K[Z-1],ne.push(lookup$1[_>>10]+lookup$1[_>>4&63]+lookup$1[_<<2&63]+"=")),ne.join("")}var ieee754$1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754$1.read=function(K,_,Z,te,ne){var ie,oe,se=ne*8-te-1,ae=(1<<se)-1,le=ae>>1,ce=-7,fe=Z?ne-1:0,de=Z?-1:1,pe=K[_+fe];for(fe+=de,ie=pe&(1<<-ce)-1,pe>>=-ce,ce+=se;ce>0;ie=ie*256+K[_+fe],fe+=de,ce-=8);for(oe=ie&(1<<-ce)-1,ie>>=-ce,ce+=te;ce>0;oe=oe*256+K[_+fe],fe+=de,ce-=8);if(ie===0)ie=1-le;else{if(ie===ae)return oe?NaN:(pe?-1:1)*(1/0);oe=oe+Math.pow(2,te),ie=ie-le}return(pe?-1:1)*oe*Math.pow(2,ie-te)};ieee754$1.write=function(K,_,Z,te,ne,ie){var oe,se,ae,le=ie*8-ne-1,ce=(1<<le)-1,fe=ce>>1,de=ne===23?Math.pow(2,-24)-Math.pow(2,-77):0,pe=te?0:ie-1,he=te?1:-1,ge=_<0||_===0&&1/_<0?1:0;for(_=Math.abs(_),isNaN(_)||_===1/0?(se=isNaN(_)?1:0,oe=ce):(oe=Math.floor(Math.log(_)/Math.LN2),_*(ae=Math.pow(2,-oe))<1&&(oe--,ae*=2),oe+fe>=1?_+=de/ae:_+=de*Math.pow(2,1-fe),_*ae>=2&&(oe++,ae/=2),oe+fe>=ce?(se=0,oe=ce):oe+fe>=1?(se=(_*ae-1)*Math.pow(2,ne),oe=oe+fe):(se=_*Math.pow(2,fe-1)*Math.pow(2,ne),oe=0));ne>=8;K[Z+pe]=se&255,pe+=he,se/=256,ne-=8);for(oe=oe<<ne|se,le+=ne;le>0;K[Z+pe]=oe&255,pe+=he,oe/=256,le-=8);K[Z+pe-he]|=ge*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(K){const _=base64Js$1,Z=ieee754$1,te=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;K.Buffer=se,K.SlowBuffer=ye,K.INSPECT_MAX_BYTES=50;const ne=2147483647;K.kMaxLength=ne,se.TYPED_ARRAY_SUPPORT=ie(),!se.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function ie(){try{const Le=new Uint8Array(1),De={foo:function(){return 42}};return Object.setPrototypeOf(De,Uint8Array.prototype),Object.setPrototypeOf(Le,De),Le.foo()===42}catch{return!1}}Object.defineProperty(se.prototype,"parent",{enumerable:!0,get:function(){if(se.isBuffer(this))return this.buffer}}),Object.defineProperty(se.prototype,"offset",{enumerable:!0,get:function(){if(se.isBuffer(this))return this.byteOffset}});function oe(Le){if(Le>ne)throw new RangeError('The value "'+Le+'" is invalid for option "size"');const De=new Uint8Array(Le);return Object.setPrototypeOf(De,se.prototype),De}function se(Le,De,Be){if(typeof Le=="number"){if(typeof De=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return fe(Le)}return ae(Le,De,Be)}se.poolSize=8192;function ae(Le,De,Be){if(typeof Le=="string")return de(Le,De);if(ArrayBuffer.isView(Le))return he(Le);if(Le==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Le);if(st(Le,ArrayBuffer)||Le&&st(Le.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(st(Le,SharedArrayBuffer)||Le&&st(Le.buffer,SharedArrayBuffer)))return ge(Le,De,Be);if(typeof Le=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const rt=Le.valueOf&&Le.valueOf();if(rt!=null&&rt!==Le)return se.from(rt,De,Be);const at=me(Le);if(at)return at;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Le[Symbol.toPrimitive]=="function")return se.from(Le[Symbol.toPrimitive]("string"),De,Be);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Le)}se.from=function(Le,De,Be){return ae(Le,De,Be)},Object.setPrototypeOf(se.prototype,Uint8Array.prototype),Object.setPrototypeOf(se,Uint8Array);function le(Le){if(typeof Le!="number")throw new TypeError('"size" argument must be of type number');if(Le<0)throw new RangeError('The value "'+Le+'" is invalid for option "size"')}function ce(Le,De,Be){return le(Le),Le<=0?oe(Le):De!==void 0?typeof Be=="string"?oe(Le).fill(De,Be):oe(Le).fill(De):oe(Le)}se.alloc=function(Le,De,Be){return ce(Le,De,Be)};function fe(Le){return le(Le),oe(Le<0?0:Ae(Le)|0)}se.allocUnsafe=function(Le){return fe(Le)},se.allocUnsafeSlow=function(Le){return fe(Le)};function de(Le,De){if((typeof De!="string"||De==="")&&(De="utf8"),!se.isEncoding(De))throw new TypeError("Unknown encoding: "+De);const Be=ve(Le,De)|0;let rt=oe(Be);const at=rt.write(Le,De);return at!==Be&&(rt=rt.slice(0,at)),rt}function pe(Le){const De=Le.length<0?0:Ae(Le.length)|0,Be=oe(De);for(let rt=0;rt<De;rt+=1)Be[rt]=Le[rt]&255;return Be}function he(Le){if(st(Le,Uint8Array)){const De=new Uint8Array(Le);return ge(De.buffer,De.byteOffset,De.byteLength)}return pe(Le)}function ge(Le,De,Be){if(De<0||Le.byteLength<De)throw new RangeError('"offset" is outside of buffer bounds');if(Le.byteLength<De+(Be||0))throw new RangeError('"length" is outside of buffer bounds');let rt;return De===void 0&&Be===void 0?rt=new Uint8Array(Le):Be===void 0?rt=new Uint8Array(Le,De):rt=new Uint8Array(Le,De,Be),Object.setPrototypeOf(rt,se.prototype),rt}function me(Le){if(se.isBuffer(Le)){const De=Ae(Le.length)|0,Be=oe(De);return Be.length===0||Le.copy(Be,0,0,De),Be}if(Le.length!==void 0)return typeof Le.length!="number"||vt(Le.length)?oe(0):pe(Le);if(Le.type==="Buffer"&&Array.isArray(Le.data))return pe(Le.data)}function Ae(Le){if(Le>=ne)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ne.toString(16)+" bytes");return Le|0}function ye(Le){return+Le!=Le&&(Le=0),se.alloc(+Le)}se.isBuffer=function(De){return De!=null&&De._isBuffer===!0&&De!==se.prototype},se.compare=function(De,Be){if(st(De,Uint8Array)&&(De=se.from(De,De.offset,De.byteLength)),st(Be,Uint8Array)&&(Be=se.from(Be,Be.offset,Be.byteLength)),!se.isBuffer(De)||!se.isBuffer(Be))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(De===Be)return 0;let rt=De.length,at=Be.length;for(let xt=0,Ct=Math.min(rt,at);xt<Ct;++xt)if(De[xt]!==Be[xt]){rt=De[xt],at=Be[xt];break}return rt<at?-1:at<rt?1:0},se.isEncoding=function(De){switch(String(De).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},se.concat=function(De,Be){if(!Array.isArray(De))throw new TypeError('"list" argument must be an Array of Buffers');if(De.length===0)return se.alloc(0);let rt;if(Be===void 0)for(Be=0,rt=0;rt<De.length;++rt)Be+=De[rt].length;const at=se.allocUnsafe(Be);let xt=0;for(rt=0;rt<De.length;++rt){let Ct=De[rt];if(st(Ct,Uint8Array))xt+Ct.length>at.length?(se.isBuffer(Ct)||(Ct=se.from(Ct)),Ct.copy(at,xt)):Uint8Array.prototype.set.call(at,Ct,xt);else if(se.isBuffer(Ct))Ct.copy(at,xt);else throw new TypeError('"list" argument must be an Array of Buffers');xt+=Ct.length}return at};function ve(Le,De){if(se.isBuffer(Le))return Le.length;if(ArrayBuffer.isView(Le)||st(Le,ArrayBuffer))return Le.byteLength;if(typeof Le!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Le);const Be=Le.length,rt=arguments.length>2&&arguments[2]===!0;if(!rt&&Be===0)return 0;let at=!1;for(;;)switch(De){case"ascii":case"latin1":case"binary":return Be;case"utf8":case"utf-8":return Ot(Le).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be*2;case"hex":return Be>>>1;case"base64":return pt(Le).length;default:if(at)return rt?-1:Ot(Le).length;De=(""+De).toLowerCase(),at=!0}}se.byteLength=ve;function _e(Le,De,Be){let rt=!1;if((De===void 0||De<0)&&(De=0),De>this.length||((Be===void 0||Be>this.length)&&(Be=this.length),Be<=0)||(Be>>>=0,De>>>=0,Be<=De))return"";for(Le||(Le="utf8");;)switch(Le){case"hex":return Je(this,De,Be);case"utf8":case"utf-8":return Ge(this,De,Be);case"ascii":return Ke(this,De,Be);case"latin1":case"binary":return tt(this,De,Be);case"base64":return ke(this,De,Be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ot(this,De,Be);default:if(rt)throw new TypeError("Unknown encoding: "+Le);Le=(Le+"").toLowerCase(),rt=!0}}se.prototype._isBuffer=!0;function Te(Le,De,Be){const rt=Le[De];Le[De]=Le[Be],Le[Be]=rt}se.prototype.swap16=function(){const De=this.length;if(De%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Be=0;Be<De;Be+=2)Te(this,Be,Be+1);return this},se.prototype.swap32=function(){const De=this.length;if(De%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Be=0;Be<De;Be+=4)Te(this,Be,Be+3),Te(this,Be+1,Be+2);return this},se.prototype.swap64=function(){const De=this.length;if(De%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Be=0;Be<De;Be+=8)Te(this,Be,Be+7),Te(this,Be+1,Be+6),Te(this,Be+2,Be+5),Te(this,Be+3,Be+4);return this},se.prototype.toString=function(){const De=this.length;return De===0?"":arguments.length===0?Ge(this,0,De):_e.apply(this,arguments)},se.prototype.toLocaleString=se.prototype.toString,se.prototype.equals=function(De){if(!se.isBuffer(De))throw new TypeError("Argument must be a Buffer");return this===De?!0:se.compare(this,De)===0},se.prototype.inspect=function(){let De="";const Be=K.INSPECT_MAX_BYTES;return De=this.toString("hex",0,Be).replace(/(.{2})/g,"$1 ").trim(),this.length>Be&&(De+=" ... "),"<Buffer "+De+">"},te&&(se.prototype[te]=se.prototype.inspect),se.prototype.compare=function(De,Be,rt,at,xt){if(st(De,Uint8Array)&&(De=se.from(De,De.offset,De.byteLength)),!se.isBuffer(De))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof De);if(Be===void 0&&(Be=0),rt===void 0&&(rt=De?De.length:0),at===void 0&&(at=0),xt===void 0&&(xt=this.length),Be<0||rt>De.length||at<0||xt>this.length)throw new RangeError("out of range index");if(at>=xt&&Be>=rt)return 0;if(at>=xt)return-1;if(Be>=rt)return 1;if(Be>>>=0,rt>>>=0,at>>>=0,xt>>>=0,this===De)return 0;let Ct=xt-at,Qt=rt-Be;const qt=Math.min(Ct,Qt),It=this.slice(at,xt),Gt=De.slice(Be,rt);for(let Jt=0;Jt<qt;++Jt)if(It[Jt]!==Gt[Jt]){Ct=It[Jt],Qt=Gt[Jt];break}return Ct<Qt?-1:Qt<Ct?1:0};function be(Le,De,Be,rt,at){if(Le.length===0)return-1;if(typeof Be=="string"?(rt=Be,Be=0):Be>2147483647?Be=2147483647:Be<-2147483648&&(Be=-2147483648),Be=+Be,vt(Be)&&(Be=at?0:Le.length-1),Be<0&&(Be=Le.length+Be),Be>=Le.length){if(at)return-1;Be=Le.length-1}else if(Be<0)if(at)Be=0;else return-1;if(typeof De=="string"&&(De=se.from(De,rt)),se.isBuffer(De))return De.length===0?-1:Re(Le,De,Be,rt,at);if(typeof De=="number")return De=De&255,typeof Uint8Array.prototype.indexOf=="function"?at?Uint8Array.prototype.indexOf.call(Le,De,Be):Uint8Array.prototype.lastIndexOf.call(Le,De,Be):Re(Le,[De],Be,rt,at);throw new TypeError("val must be string, number or Buffer")}function Re(Le,De,Be,rt,at){let xt=1,Ct=Le.length,Qt=De.length;if(rt!==void 0&&(rt=String(rt).toLowerCase(),rt==="ucs2"||rt==="ucs-2"||rt==="utf16le"||rt==="utf-16le")){if(Le.length<2||De.length<2)return-1;xt=2,Ct/=2,Qt/=2,Be/=2}function qt(Gt,Jt){return xt===1?Gt[Jt]:Gt.readUInt16BE(Jt*xt)}let It;if(at){let Gt=-1;for(It=Be;It<Ct;It++)if(qt(Le,It)===qt(De,Gt===-1?0:It-Gt)){if(Gt===-1&&(Gt=It),It-Gt+1===Qt)return Gt*xt}else Gt!==-1&&(It-=It-Gt),Gt=-1}else for(Be+Qt>Ct&&(Be=Ct-Qt),It=Be;It>=0;It--){let Gt=!0;for(let Jt=0;Jt<Qt;Jt++)if(qt(Le,It+Jt)!==qt(De,Jt)){Gt=!1;break}if(Gt)return It}return-1}se.prototype.includes=function(De,Be,rt){return this.indexOf(De,Be,rt)!==-1},se.prototype.indexOf=function(De,Be,rt){return be(this,De,Be,rt,!0)},se.prototype.lastIndexOf=function(De,Be,rt){return be(this,De,Be,rt,!1)};function we(Le,De,Be,rt){Be=Number(Be)||0;const at=Le.length-Be;rt?(rt=Number(rt),rt>at&&(rt=at)):rt=at;const xt=De.length;rt>xt/2&&(rt=xt/2);let Ct;for(Ct=0;Ct<rt;++Ct){const Qt=parseInt(De.substr(Ct*2,2),16);if(vt(Qt))return Ct;Le[Be+Ct]=Qt}return Ct}function Pe(Le,De,Be,rt){return ft(Ot(De,Le.length-Be),Le,Be,rt)}function Ie(Le,De,Be,rt){return ft(Mt(De),Le,Be,rt)}function $e(Le,De,Be,rt){return ft(pt(De),Le,Be,rt)}function Ue(Le,De,Be,rt){return ft(_t(De,Le.length-Be),Le,Be,rt)}se.prototype.write=function(De,Be,rt,at){if(Be===void 0)at="utf8",rt=this.length,Be=0;else if(rt===void 0&&typeof Be=="string")at=Be,rt=this.length,Be=0;else if(isFinite(Be))Be=Be>>>0,isFinite(rt)?(rt=rt>>>0,at===void 0&&(at="utf8")):(at=rt,rt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const xt=this.length-Be;if((rt===void 0||rt>xt)&&(rt=xt),De.length>0&&(rt<0||Be<0)||Be>this.length)throw new RangeError("Attempt to write outside buffer bounds");at||(at="utf8");let Ct=!1;for(;;)switch(at){case"hex":return we(this,De,Be,rt);case"utf8":case"utf-8":return Pe(this,De,Be,rt);case"ascii":case"latin1":case"binary":return Ie(this,De,Be,rt);case"base64":return $e(this,De,Be,rt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ue(this,De,Be,rt);default:if(Ct)throw new TypeError("Unknown encoding: "+at);at=(""+at).toLowerCase(),Ct=!0}},se.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ke(Le,De,Be){return De===0&&Be===Le.length?_.fromByteArray(Le):_.fromByteArray(Le.slice(De,Be))}function Ge(Le,De,Be){Be=Math.min(Le.length,Be);const rt=[];let at=De;for(;at<Be;){const xt=Le[at];let Ct=null,Qt=xt>239?4:xt>223?3:xt>191?2:1;if(at+Qt<=Be){let qt,It,Gt,Jt;switch(Qt){case 1:xt<128&&(Ct=xt);break;case 2:qt=Le[at+1],(qt&192)===128&&(Jt=(xt&31)<<6|qt&63,Jt>127&&(Ct=Jt));break;case 3:qt=Le[at+1],It=Le[at+2],(qt&192)===128&&(It&192)===128&&(Jt=(xt&15)<<12|(qt&63)<<6|It&63,Jt>2047&&(Jt<55296||Jt>57343)&&(Ct=Jt));break;case 4:qt=Le[at+1],It=Le[at+2],Gt=Le[at+3],(qt&192)===128&&(It&192)===128&&(Gt&192)===128&&(Jt=(xt&15)<<18|(qt&63)<<12|(It&63)<<6|Gt&63,Jt>65535&&Jt<1114112&&(Ct=Jt))}}Ct===null?(Ct=65533,Qt=1):Ct>65535&&(Ct-=65536,rt.push(Ct>>>10&1023|55296),Ct=56320|Ct&1023),rt.push(Ct),at+=Qt}return ze(rt)}const He=4096;function ze(Le){const De=Le.length;if(De<=He)return String.fromCharCode.apply(String,Le);let Be="",rt=0;for(;rt<De;)Be+=String.fromCharCode.apply(String,Le.slice(rt,rt+=He));return Be}function Ke(Le,De,Be){let rt="";Be=Math.min(Le.length,Be);for(let at=De;at<Be;++at)rt+=String.fromCharCode(Le[at]&127);return rt}function tt(Le,De,Be){let rt="";Be=Math.min(Le.length,Be);for(let at=De;at<Be;++at)rt+=String.fromCharCode(Le[at]);return rt}function Je(Le,De,Be){const rt=Le.length;(!De||De<0)&&(De=0),(!Be||Be<0||Be>rt)&&(Be=rt);let at="";for(let xt=De;xt<Be;++xt)at+=Pt[Le[xt]];return at}function ot(Le,De,Be){const rt=Le.slice(De,Be);let at="";for(let xt=0;xt<rt.length-1;xt+=2)at+=String.fromCharCode(rt[xt]+rt[xt+1]*256);return at}se.prototype.slice=function(De,Be){const rt=this.length;De=~~De,Be=Be===void 0?rt:~~Be,De<0?(De+=rt,De<0&&(De=0)):De>rt&&(De=rt),Be<0?(Be+=rt,Be<0&&(Be=0)):Be>rt&&(Be=rt),Be<De&&(Be=De);const at=this.subarray(De,Be);return Object.setPrototypeOf(at,se.prototype),at};function Fe(Le,De,Be){if(Le%1!==0||Le<0)throw new RangeError("offset is not uint");if(Le+De>Be)throw new RangeError("Trying to access beyond buffer length")}se.prototype.readUintLE=se.prototype.readUIntLE=function(De,Be,rt){De=De>>>0,Be=Be>>>0,rt||Fe(De,Be,this.length);let at=this[De],xt=1,Ct=0;for(;++Ct<Be&&(xt*=256);)at+=this[De+Ct]*xt;return at},se.prototype.readUintBE=se.prototype.readUIntBE=function(De,Be,rt){De=De>>>0,Be=Be>>>0,rt||Fe(De,Be,this.length);let at=this[De+--Be],xt=1;for(;Be>0&&(xt*=256);)at+=this[De+--Be]*xt;return at},se.prototype.readUint8=se.prototype.readUInt8=function(De,Be){return De=De>>>0,Be||Fe(De,1,this.length),this[De]},se.prototype.readUint16LE=se.prototype.readUInt16LE=function(De,Be){return De=De>>>0,Be||Fe(De,2,this.length),this[De]|this[De+1]<<8},se.prototype.readUint16BE=se.prototype.readUInt16BE=function(De,Be){return De=De>>>0,Be||Fe(De,2,this.length),this[De]<<8|this[De+1]},se.prototype.readUint32LE=se.prototype.readUInt32LE=function(De,Be){return De=De>>>0,Be||Fe(De,4,this.length),(this[De]|this[De+1]<<8|this[De+2]<<16)+this[De+3]*16777216},se.prototype.readUint32BE=se.prototype.readUInt32BE=function(De,Be){return De=De>>>0,Be||Fe(De,4,this.length),this[De]*16777216+(this[De+1]<<16|this[De+2]<<8|this[De+3])},se.prototype.readBigUInt64LE=Lt(function(De){De=De>>>0,zt(De,"offset");const Be=this[De],rt=this[De+7];(Be===void 0||rt===void 0)&&yt(De,this.length-8);const at=Be+this[++De]*2**8+this[++De]*2**16+this[++De]*2**24,xt=this[++De]+this[++De]*2**8+this[++De]*2**16+rt*2**24;return BigInt(at)+(BigInt(xt)<<BigInt(32))}),se.prototype.readBigUInt64BE=Lt(function(De){De=De>>>0,zt(De,"offset");const Be=this[De],rt=this[De+7];(Be===void 0||rt===void 0)&&yt(De,this.length-8);const at=Be*2**24+this[++De]*2**16+this[++De]*2**8+this[++De],xt=this[++De]*2**24+this[++De]*2**16+this[++De]*2**8+rt;return(BigInt(at)<<BigInt(32))+BigInt(xt)}),se.prototype.readIntLE=function(De,Be,rt){De=De>>>0,Be=Be>>>0,rt||Fe(De,Be,this.length);let at=this[De],xt=1,Ct=0;for(;++Ct<Be&&(xt*=256);)at+=this[De+Ct]*xt;return xt*=128,at>=xt&&(at-=Math.pow(2,8*Be)),at},se.prototype.readIntBE=function(De,Be,rt){De=De>>>0,Be=Be>>>0,rt||Fe(De,Be,this.length);let at=Be,xt=1,Ct=this[De+--at];for(;at>0&&(xt*=256);)Ct+=this[De+--at]*xt;return xt*=128,Ct>=xt&&(Ct-=Math.pow(2,8*Be)),Ct},se.prototype.readInt8=function(De,Be){return De=De>>>0,Be||Fe(De,1,this.length),this[De]&128?(255-this[De]+1)*-1:this[De]},se.prototype.readInt16LE=function(De,Be){De=De>>>0,Be||Fe(De,2,this.length);const rt=this[De]|this[De+1]<<8;return rt&32768?rt|4294901760:rt},se.prototype.readInt16BE=function(De,Be){De=De>>>0,Be||Fe(De,2,this.length);const rt=this[De+1]|this[De]<<8;return rt&32768?rt|4294901760:rt},se.prototype.readInt32LE=function(De,Be){return De=De>>>0,Be||Fe(De,4,this.length),this[De]|this[De+1]<<8|this[De+2]<<16|this[De+3]<<24},se.prototype.readInt32BE=function(De,Be){return De=De>>>0,Be||Fe(De,4,this.length),this[De]<<24|this[De+1]<<16|this[De+2]<<8|this[De+3]},se.prototype.readBigInt64LE=Lt(function(De){De=De>>>0,zt(De,"offset");const Be=this[De],rt=this[De+7];(Be===void 0||rt===void 0)&&yt(De,this.length-8);const at=this[De+4]+this[De+5]*2**8+this[De+6]*2**16+(rt<<24);return(BigInt(at)<<BigInt(32))+BigInt(Be+this[++De]*2**8+this[++De]*2**16+this[++De]*2**24)}),se.prototype.readBigInt64BE=Lt(function(De){De=De>>>0,zt(De,"offset");const Be=this[De],rt=this[De+7];(Be===void 0||rt===void 0)&&yt(De,this.length-8);const at=(Be<<24)+this[++De]*2**16+this[++De]*2**8+this[++De];return(BigInt(at)<<BigInt(32))+BigInt(this[++De]*2**24+this[++De]*2**16+this[++De]*2**8+rt)}),se.prototype.readFloatLE=function(De,Be){return De=De>>>0,Be||Fe(De,4,this.length),Z.read(this,De,!0,23,4)},se.prototype.readFloatBE=function(De,Be){return De=De>>>0,Be||Fe(De,4,this.length),Z.read(this,De,!1,23,4)},se.prototype.readDoubleLE=function(De,Be){return De=De>>>0,Be||Fe(De,8,this.length),Z.read(this,De,!0,52,8)},se.prototype.readDoubleBE=function(De,Be){return De=De>>>0,Be||Fe(De,8,this.length),Z.read(this,De,!1,52,8)};function ct(Le,De,Be,rt,at,xt){if(!se.isBuffer(Le))throw new TypeError('"buffer" argument must be a Buffer instance');if(De>at||De<xt)throw new RangeError('"value" argument is out of bounds');if(Be+rt>Le.length)throw new RangeError("Index out of range")}se.prototype.writeUintLE=se.prototype.writeUIntLE=function(De,Be,rt,at){if(De=+De,Be=Be>>>0,rt=rt>>>0,!at){const Qt=Math.pow(2,8*rt)-1;ct(this,De,Be,rt,Qt,0)}let xt=1,Ct=0;for(this[Be]=De&255;++Ct<rt&&(xt*=256);)this[Be+Ct]=De/xt&255;return Be+rt},se.prototype.writeUintBE=se.prototype.writeUIntBE=function(De,Be,rt,at){if(De=+De,Be=Be>>>0,rt=rt>>>0,!at){const Qt=Math.pow(2,8*rt)-1;ct(this,De,Be,rt,Qt,0)}let xt=rt-1,Ct=1;for(this[Be+xt]=De&255;--xt>=0&&(Ct*=256);)this[Be+xt]=De/Ct&255;return Be+rt},se.prototype.writeUint8=se.prototype.writeUInt8=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,1,255,0),this[Be]=De&255,Be+1},se.prototype.writeUint16LE=se.prototype.writeUInt16LE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,2,65535,0),this[Be]=De&255,this[Be+1]=De>>>8,Be+2},se.prototype.writeUint16BE=se.prototype.writeUInt16BE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,2,65535,0),this[Be]=De>>>8,this[Be+1]=De&255,Be+2},se.prototype.writeUint32LE=se.prototype.writeUInt32LE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,4,4294967295,0),this[Be+3]=De>>>24,this[Be+2]=De>>>16,this[Be+1]=De>>>8,this[Be]=De&255,Be+4},se.prototype.writeUint32BE=se.prototype.writeUInt32BE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,4,4294967295,0),this[Be]=De>>>24,this[Be+1]=De>>>16,this[Be+2]=De>>>8,this[Be+3]=De&255,Be+4};function ht(Le,De,Be,rt,at){Nt(De,rt,at,Le,Be,7);let xt=Number(De&BigInt(4294967295));Le[Be++]=xt,xt=xt>>8,Le[Be++]=xt,xt=xt>>8,Le[Be++]=xt,xt=xt>>8,Le[Be++]=xt;let Ct=Number(De>>BigInt(32)&BigInt(4294967295));return Le[Be++]=Ct,Ct=Ct>>8,Le[Be++]=Ct,Ct=Ct>>8,Le[Be++]=Ct,Ct=Ct>>8,Le[Be++]=Ct,Be}function lt(Le,De,Be,rt,at){Nt(De,rt,at,Le,Be,7);let xt=Number(De&BigInt(4294967295));Le[Be+7]=xt,xt=xt>>8,Le[Be+6]=xt,xt=xt>>8,Le[Be+5]=xt,xt=xt>>8,Le[Be+4]=xt;let Ct=Number(De>>BigInt(32)&BigInt(4294967295));return Le[Be+3]=Ct,Ct=Ct>>8,Le[Be+2]=Ct,Ct=Ct>>8,Le[Be+1]=Ct,Ct=Ct>>8,Le[Be]=Ct,Be+8}se.prototype.writeBigUInt64LE=Lt(function(De,Be=0){return ht(this,De,Be,BigInt(0),BigInt("0xffffffffffffffff"))}),se.prototype.writeBigUInt64BE=Lt(function(De,Be=0){return lt(this,De,Be,BigInt(0),BigInt("0xffffffffffffffff"))}),se.prototype.writeIntLE=function(De,Be,rt,at){if(De=+De,Be=Be>>>0,!at){const qt=Math.pow(2,8*rt-1);ct(this,De,Be,rt,qt-1,-qt)}let xt=0,Ct=1,Qt=0;for(this[Be]=De&255;++xt<rt&&(Ct*=256);)De<0&&Qt===0&&this[Be+xt-1]!==0&&(Qt=1),this[Be+xt]=(De/Ct>>0)-Qt&255;return Be+rt},se.prototype.writeIntBE=function(De,Be,rt,at){if(De=+De,Be=Be>>>0,!at){const qt=Math.pow(2,8*rt-1);ct(this,De,Be,rt,qt-1,-qt)}let xt=rt-1,Ct=1,Qt=0;for(this[Be+xt]=De&255;--xt>=0&&(Ct*=256);)De<0&&Qt===0&&this[Be+xt+1]!==0&&(Qt=1),this[Be+xt]=(De/Ct>>0)-Qt&255;return Be+rt},se.prototype.writeInt8=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,1,127,-128),De<0&&(De=255+De+1),this[Be]=De&255,Be+1},se.prototype.writeInt16LE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,2,32767,-32768),this[Be]=De&255,this[Be+1]=De>>>8,Be+2},se.prototype.writeInt16BE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,2,32767,-32768),this[Be]=De>>>8,this[Be+1]=De&255,Be+2},se.prototype.writeInt32LE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,4,2147483647,-2147483648),this[Be]=De&255,this[Be+1]=De>>>8,this[Be+2]=De>>>16,this[Be+3]=De>>>24,Be+4},se.prototype.writeInt32BE=function(De,Be,rt){return De=+De,Be=Be>>>0,rt||ct(this,De,Be,4,2147483647,-2147483648),De<0&&(De=4294967295+De+1),this[Be]=De>>>24,this[Be+1]=De>>>16,this[Be+2]=De>>>8,this[Be+3]=De&255,Be+4},se.prototype.writeBigInt64LE=Lt(function(De,Be=0){return ht(this,De,Be,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),se.prototype.writeBigInt64BE=Lt(function(De,Be=0){return lt(this,De,Be,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Qe(Le,De,Be,rt,at,xt){if(Be+rt>Le.length)throw new RangeError("Index out of range");if(Be<0)throw new RangeError("Index out of range")}function Ze(Le,De,Be,rt,at){return De=+De,Be=Be>>>0,at||Qe(Le,De,Be,4),Z.write(Le,De,Be,rt,23,4),Be+4}se.prototype.writeFloatLE=function(De,Be,rt){return Ze(this,De,Be,!0,rt)},se.prototype.writeFloatBE=function(De,Be,rt){return Ze(this,De,Be,!1,rt)};function it(Le,De,Be,rt,at){return De=+De,Be=Be>>>0,at||Qe(Le,De,Be,8),Z.write(Le,De,Be,rt,52,8),Be+8}se.prototype.writeDoubleLE=function(De,Be,rt){return it(this,De,Be,!0,rt)},se.prototype.writeDoubleBE=function(De,Be,rt){return it(this,De,Be,!1,rt)},se.prototype.copy=function(De,Be,rt,at){if(!se.isBuffer(De))throw new TypeError("argument should be a Buffer");if(rt||(rt=0),!at&&at!==0&&(at=this.length),Be>=De.length&&(Be=De.length),Be||(Be=0),at>0&&at<rt&&(at=rt),at===rt||De.length===0||this.length===0)return 0;if(Be<0)throw new RangeError("targetStart out of bounds");if(rt<0||rt>=this.length)throw new RangeError("Index out of range");if(at<0)throw new RangeError("sourceEnd out of bounds");at>this.length&&(at=this.length),De.length-Be<at-rt&&(at=De.length-Be+rt);const xt=at-rt;return this===De&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Be,rt,at):Uint8Array.prototype.set.call(De,this.subarray(rt,at),Be),xt},se.prototype.fill=function(De,Be,rt,at){if(typeof De=="string"){if(typeof Be=="string"?(at=Be,Be=0,rt=this.length):typeof rt=="string"&&(at=rt,rt=this.length),at!==void 0&&typeof at!="string")throw new TypeError("encoding must be a string");if(typeof at=="string"&&!se.isEncoding(at))throw new TypeError("Unknown encoding: "+at);if(De.length===1){const Ct=De.charCodeAt(0);(at==="utf8"&&Ct<128||at==="latin1")&&(De=Ct)}}else typeof De=="number"?De=De&255:typeof De=="boolean"&&(De=Number(De));if(Be<0||this.length<Be||this.length<rt)throw new RangeError("Out of range index");if(rt<=Be)return this;Be=Be>>>0,rt=rt===void 0?this.length:rt>>>0,De||(De=0);let xt;if(typeof De=="number")for(xt=Be;xt<rt;++xt)this[xt]=De;else{const Ct=se.isBuffer(De)?De:se.from(De,at),Qt=Ct.length;if(Qt===0)throw new TypeError('The value "'+De+'" is invalid for argument "value"');for(xt=0;xt<rt-Be;++xt)this[xt+Be]=Ct[xt%Qt]}return this};const nt={};function Tt(Le,De,Be){nt[Le]=class extends Be{constructor(){super(),Object.defineProperty(this,"message",{value:De.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Le}]`,this.stack,delete this.name}get code(){return Le}set code(at){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:at,writable:!0})}toString(){return`${this.name} [${Le}]: ${this.message}`}}}Tt("ERR_BUFFER_OUT_OF_BOUNDS",function(Le){return Le?`${Le} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Tt("ERR_INVALID_ARG_TYPE",function(Le,De){return`The "${Le}" argument must be of type number. Received type ${typeof De}`},TypeError),Tt("ERR_OUT_OF_RANGE",function(Le,De,Be){let rt=`The value of "${Le}" is out of range.`,at=Be;return Number.isInteger(Be)&&Math.abs(Be)>2**32?at=St(String(Be)):typeof Be=="bigint"&&(at=String(Be),(Be>BigInt(2)**BigInt(32)||Be<-(BigInt(2)**BigInt(32)))&&(at=St(at)),at+="n"),rt+=` It must be ${De}. Received ${at}`,rt},RangeError);function St(Le){let De="",Be=Le.length;const rt=Le[0]==="-"?1:0;for(;Be>=rt+4;Be-=3)De=`_${Le.slice(Be-3,Be)}${De}`;return`${Le.slice(0,Be)}${De}`}function Et(Le,De,Be){zt(De,"offset"),(Le[De]===void 0||Le[De+Be]===void 0)&&yt(De,Le.length-(Be+1))}function Nt(Le,De,Be,rt,at,xt){if(Le>Be||Le<De){const Ct=typeof De=="bigint"?"n":"";let Qt;throw De===0||De===BigInt(0)?Qt=`>= 0${Ct} and < 2${Ct} ** ${(xt+1)*8}${Ct}`:Qt=`>= -(2${Ct} ** ${(xt+1)*8-1}${Ct}) and < 2 ** ${(xt+1)*8-1}${Ct}`,new nt.ERR_OUT_OF_RANGE("value",Qt,Le)}Et(rt,at,xt)}function zt(Le,De){if(typeof Le!="number")throw new nt.ERR_INVALID_ARG_TYPE(De,"number",Le)}function yt(Le,De,Be){throw Math.floor(Le)!==Le?(zt(Le,Be),new nt.ERR_OUT_OF_RANGE("offset","an integer",Le)):De<0?new nt.ERR_BUFFER_OUT_OF_BOUNDS:new nt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${De}`,Le)}const Ut=/[^+/0-9A-Za-z-_]/g;function bt(Le){if(Le=Le.split("=")[0],Le=Le.trim().replace(Ut,""),Le.length<2)return"";for(;Le.length%4!==0;)Le=Le+"=";return Le}function Ot(Le,De){De=De||1/0;let Be;const rt=Le.length;let at=null;const xt=[];for(let Ct=0;Ct<rt;++Ct){if(Be=Le.charCodeAt(Ct),Be>55295&&Be<57344){if(!at){if(Be>56319){(De-=3)>-1&&xt.push(239,191,189);continue}else if(Ct+1===rt){(De-=3)>-1&&xt.push(239,191,189);continue}at=Be;continue}if(Be<56320){(De-=3)>-1&&xt.push(239,191,189),at=Be;continue}Be=(at-55296<<10|Be-56320)+65536}else at&&(De-=3)>-1&&xt.push(239,191,189);if(at=null,Be<128){if((De-=1)<0)break;xt.push(Be)}else if(Be<2048){if((De-=2)<0)break;xt.push(Be>>6|192,Be&63|128)}else if(Be<65536){if((De-=3)<0)break;xt.push(Be>>12|224,Be>>6&63|128,Be&63|128)}else if(Be<1114112){if((De-=4)<0)break;xt.push(Be>>18|240,Be>>12&63|128,Be>>6&63|128,Be&63|128)}else throw new Error("Invalid code point")}return xt}function Mt(Le){const De=[];for(let Be=0;Be<Le.length;++Be)De.push(Le.charCodeAt(Be)&255);return De}function _t(Le,De){let Be,rt,at;const xt=[];for(let Ct=0;Ct<Le.length&&!((De-=2)<0);++Ct)Be=Le.charCodeAt(Ct),rt=Be>>8,at=Be%256,xt.push(at),xt.push(rt);return xt}function pt(Le){return _.toByteArray(bt(Le))}function ft(Le,De,Be,rt){let at;for(at=0;at<rt&&!(at+Be>=De.length||at>=Le.length);++at)De[at+Be]=Le[at];return at}function st(Le,De){return Le instanceof De||Le!=null&&Le.constructor!=null&&Le.constructor.name!=null&&Le.constructor.name===De.name}function vt(Le){return Le!==Le}const Pt=function(){const Le="0123456789abcdef",De=new Array(256);for(let Be=0;Be<16;++Be){const rt=Be*16;for(let at=0;at<16;++at)De[rt+at]=Le[Be]+Le[at]}return De}();function Lt(Le){return typeof BigInt>"u"?Vt:Le}function Vt(){throw new Error("BigInt not supported")}})(buffer$4);var __defProp=Object.defineProperty,__defNormalProp=(K,_,Z)=>_ in K?__defProp(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,__publicField=(K,_,Z)=>(__defNormalProp(K,_+"",Z),Z);class FullScreenTriangleGeometry extends BufferGeometry{constructor(){super(),__publicField(this,"boundingSphere",new Sphere$2),this.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,3,-1,-1,3]),2)),this.setAttribute("uv",new BufferAttribute(new Float32Array([0,0,2,0,0,2]),2))}computeBoundingSphere(){}}const _geometry$1=new FullScreenTriangleGeometry,_camera$1=new OrthographicCamera$1;class FullScreenTriangle{constructor(_){this._mesh=new Mesh(_geometry$1,_),this._mesh.frustumCulled=!1}render(_){_.render(this._mesh,_camera$1)}get material(){return this._mesh.material}set material(_){this._mesh.material=_}dispose(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}}const EffectShader={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new Matrix4},viewMat:{value:new Matrix4},projViewMat:{value:new Matrix4},projectionMatrixInv:{value:new Matrix4},viewMatrixInv:{value:new Matrix4},cameraPos:{value:new Vector3},resolution:{value:new Vector2},time:{value:0},samples:{value:[]},samplesR:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1}},depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 1);
}`,fragmentShader:`
    #define SAMPLES 16
    #define FSAMPLES 16.0
uniform sampler2D sceneDiffuse;
uniform highp sampler2D sceneNormal;
uniform highp sampler2D sceneDepth;
uniform mat4 projectionMatrixInv;
uniform mat4 viewMatrixInv;
uniform mat4 projMat;
uniform mat4 viewMat;
uniform mat4 projViewMat;
uniform vec3 cameraPos;
uniform vec2 resolution;
uniform float time;
uniform vec3[SAMPLES] samples;
uniform float[SAMPLES] samplesR;
uniform float radius;
uniform float distanceFalloff;
uniform float near;
uniform float far;
uniform bool logDepth;
uniform bool ortho;
uniform bool screenSpaceRadius;
uniform sampler2D bluenoise;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }

    vec3 getWorldPosLog(vec3 posS) {
      vec2 uv = posS.xy;
      float z = posS.z;
      float nearZ =near;
      float farZ = far;
      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
      vec4 wpos = projectionMatrixInv * clipVec;
      return wpos.xyz / wpos.w;
    }
    vec3 getWorldPos(float depth, vec2 coord) {
      #ifdef LOGDEPTH
        return getWorldPosLog(vec3(coord, depth));
      #endif
      float z = depth * 2.0 - 1.0;
      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
      // Perspective division
     vec4 worldSpacePosition = viewSpacePosition;
     worldSpacePosition.xyz /= worldSpacePosition.w;
      return worldSpacePosition.xyz;
  }

  vec3 computeNormal(vec3 worldPos, vec2 vUv) {
    ivec2 p = ivec2(vUv * resolution);
    float c0 = texelFetch(sceneDepth, p, 0).x;
    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;

    float dl = abs((2.0 * l1 - l2) - c0);
    float dr = abs((2.0 * r1 - r2) - c0);
    float db = abs((2.0 * b1 - b2) - c0);
    float dt = abs((2.0 * t1 - t2) - c0);

    vec3 ce = getWorldPos(c0, vUv).xyz;

    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;

    return normalize(cross(dpdx, dpdy));
}

void main() {
      vec4 diffuse = texture2D(sceneDiffuse, vUv);
      float depth = texture2D(sceneDepth, vUv).x;
      if (depth == 1.0) {
        gl_FragColor = vec4(vec3(1.0), 1.0);
        return;
      }
      vec3 worldPos = getWorldPos(depth, vUv);
    //  vec3 normal = texture2D(sceneNormal, vUv).rgb;//computeNormal(worldPos, vUv);
      #ifdef HALFRES
        vec3 normal = texture2D(sceneNormal, vUv).rgb;
      #else
        vec3 normal = computeNormal(worldPos, vUv);
      #endif
      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);
      vec3 randomVec = normalize(noise.rgb * 2.0 - 1.0);
      vec3 tangent = normalize(randomVec - normal * dot(randomVec, normal));
      vec3 bitangent = cross(normal, tangent);
      mat3 tbn = mat3(tangent, bitangent, normal);
      float occluded = 0.0;
      float totalWeight = 0.0;
     /* float radiusScreen = distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(48.0, 0.0) / resolution)
      );/*vUv.x < 0.5 ? radius : min(distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(100.0, 0.0) / resolution)
      ), radius);
      float distanceFalloffScreen = radiusScreen * 0.2;*/
      float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
      float bias = (0.1 / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;
      for(float i = 0.0; i < FSAMPLES; i++) {
        vec3 sampleDirection = 
        tbn * 
        samples[int(i)];
        ;
        float moveAmt = samplesR[int(mod(i + noise.a * FSAMPLES, FSAMPLES))];
        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;
        vec4 offset = projMat * vec4(samplePos, 1.0);
        offset.xyz /= offset.w;
        offset.xyz = offset.xyz * 0.5 + 0.5;
        float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;
        /*float distSample = logDepth ? linearize_depth_log(sampleDepth, near, far) 
         (ortho ?  linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far));*/
        #ifdef LOGDEPTH
        float distSample = linearize_depth_log(sampleDepth, near, far);
        #else
        float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);
        #endif
        float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);
        float rangeCheck = smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));
        vec2 diff = gl_FragCoord.xy - ( offset.xy * resolution);
        float weight = dot(sampleDirection, normal);
          occluded += rangeCheck * weight * 
            (distSample + bias
               < distWorld ? 1.0 : 0.0) * (
          (dot(
            diff,
            diff
             
            ) < 1.0 || (sampleDepth == depth) || (
              offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0
            ) ? 0.0 : 1.0)
          );
          totalWeight += weight;
      }
      float occ = clamp(1.0 - occluded / totalWeight, 0.0, 1.0);
      gl_FragColor = vec4(0.5 + 0.5 * normal, occ);
}`},version=parseInt(REVISION.replace(/\D+/g,"")),sRGBTransferOETF=version>=167?"sRGBTransferOETF":"LinearTosRGB",EffectCompositer={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Matrix4},viewMat:{value:new Matrix4},projectionMatrixInv:{value:new Matrix4},viewMatrixInv:{value:new Matrix4},cameraPos:{value:new Vector3},resolution:{value:new Vector2},color:{value:new Vector3(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1},fog:{value:!1},fogExp:{value:!1},fogDensity:{value:0},fogNear:{value:1/0},fogFar:{value:1/0},colorMultiply:{value:!0}},depthWrite:!1,depthTest:!1,vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform highp sampler2D downsampledDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform vec2 resolution;
    uniform vec3 color;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform float intensity;
    uniform float renderMode;
    uniform float near;
    uniform float far;
    uniform bool gammaCorrection;
    uniform bool logDepth;
    uniform bool ortho;
    uniform bool screenSpaceRadius;
    uniform bool fog;
    uniform bool fogExp;
    uniform bool colorMultiply;
    uniform float fogDensity;
    uniform float fogNear;
    uniform float fogFar;
    uniform float radius;
    uniform float distanceFalloff;
    uniform vec3 cameraPos;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
       // if (logDepth) {
        #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
        #endif
      //  }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }

    #include <common>
    #include <dithering_pars_fragment>
    void main() {
        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);
        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);
        float depth = texture2D(
            sceneDepth,
            vUv
        ).x;
        #ifdef HALFRES 
        vec4 texel;
        if (depth == 1.0) {
            texel = vec4(0.0, 0.0, 0.0, 1.0);
        } else {
        vec3 worldPos = getWorldPos(depth, vUv);
        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);
       // vec4 texel = texture2D(tDiffuse, vUv);
       // Find closest depth;
       float totalWeight = 0.0;
       float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
        for(float x = -1.0; x <= 1.0; x++) {
            for(float y = -1.0; y <= 1.0; y++) {
                vec2 offset = vec2(x, y);
                ivec2 p = ivec2(
                    (vUv * resolution * 0.5) + offset
                );
                vec2 pUv = vec2(p) / (resolution * 0.5);
                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;
                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);
                vec3 normalSample = sampleInfo.xyz * 2.0 - 1.0;
                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);
                float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);
                float weight = rangeCheck;
                totalWeight += weight;
                texel += sampleInfo * weight;
            }
        }
        if (totalWeight == 0.0) {
            texel = texture2D(tDiffuse, vUv);
        } else {
            texel /= totalWeight;
        }
    }
        #else
        vec4 texel = texture2D(tDiffuse, vUv);
        #endif

        #ifdef LOGDEPTH
        texel.a = clamp(texel.a, 0.0, 1.0);
        if (texel.a == 0.0) {
          texel.a = 1.0;
        }
        #endif
     
        float finalAo = pow(texel.a, intensity);
        float fogFactor;
        float fogDepth = distance(
            cameraPos,
            getWorldPos(depth, vUv)
        );
        if (fog) {
            if (fogExp) {
                fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
            } else {
                fogFactor = smoothstep( fogNear, fogFar, fogDepth );
            }
        }
        finalAo = mix(finalAo, 1.0, fogFactor);
        vec3 aoApplied = color * mix(vec3(1.0), sceneTexel.rgb, float(colorMultiply));
        if (renderMode == 0.0) {
            gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 1.0) {
            gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 2.0) {
            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
        } else if (renderMode == 3.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(sceneTexel.rgb, aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        } else if (renderMode == 4.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(vec3(1.0), aoApplied, 1.0 - finalAo), sceneTexel.a);
            }
        }
        #include <dithering_fragment>
        if (gammaCorrection) {
            gl_FragColor = ${sRGBTransferOETF}(gl_FragColor);
        }
    }
    `},PoissionBlur={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Matrix4},viewMat:{value:new Matrix4},projectionMatrixInv:{value:new Matrix4},viewMatrixInv:{value:new Matrix4},cameraPos:{value:new Vector3},resolution:{value:new Vector2},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},depthWrite:!1,depthTest:!1,vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1.0);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform vec2 resolution;
    uniform float r;
    uniform float radius;
     uniform float worldRadius;
    uniform float index;
     uniform float near;
     uniform float far;
     uniform float distanceFalloff;
     uniform bool logDepth;
     uniform bool screenSpaceRadius;
    varying vec2 vUv;

    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        highp float z_n = 2.0 * d - 1.0;
        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     return linearize_depth(linDepth, nearZ, farZ);
   }
   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
     return nearZ + (farZ - nearZ) * d;
   }
   vec3 getWorldPosLog(vec3 posS) {
     vec2 uv = posS.xy;
     float z = posS.z;
     float nearZ =near;
     float farZ = far;
     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
     vec4 wpos = projectionMatrixInv * clipVec;
     return wpos.xyz / wpos.w;
   }
    vec3 getWorldPos(float depth, vec2 coord) {
     #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
     #endif
        
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
    #include <common>
    #define NUM_SAMPLES 16
    uniform vec2 poissonDisk[NUM_SAMPLES];
    void main() {
        const float pi = 3.14159;
        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);
        vec2 uv = vUv;
        vec4 data = texture2D(tDiffuse, vUv);
        float occlusion = data.a;
        float baseOcc = data.a;
        vec3 normal = data.rgb * 2.0 - 1.0;
        float count = 1.0;
        float d = texture2D(sceneDepth, vUv).x;
        if (d == 1.0) {
          gl_FragColor = data;
          return;
        }
        vec3 worldPos = getWorldPos(d, vUv);
        float size = radius;
        float angle;
        if (index == 0.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;
        } else if (index == 1.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;
        } else if (index == 2.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;
        } else {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;
        }

        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));
        float radiusToUse = screenSpaceRadius ? distance(
          worldPos,
          getWorldPos(d, vUv +
            vec2(worldRadius, 0.0) / resolution)
        ) : worldRadius;
        float distanceFalloffToUse =screenSpaceRadius ?
            radiusToUse * distanceFalloff
        : distanceFalloff;


        for(int i = 0; i < NUM_SAMPLES; i++) {
            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;
            vec4 dataSample = texture2D(tDiffuse, uv + offset);
            float occSample = dataSample.a;
            vec3 normalSample = dataSample.rgb * 2.0 - 1.0;
            float dSample = texture2D(sceneDepth, uv + offset).x;
            vec3 worldPosSample = getWorldPos(dSample, uv + offset);
            float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
            float rangeCheck = dSample == 1.0 ? 0.0 :exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));
            occlusion += occSample * rangeCheck;
            count += rangeCheck;
        }
        if (count > 0.0) {
          occlusion /= count;
        }
        #ifdef LOGDEPTH
          occlusion = clamp(occlusion, 0.0, 1.0);
          if (occlusion == 0.0) {
            occlusion = 1.0;
          }
        #endif
        gl_FragColor = vec4(0.5 + 0.5 * normal, occlusion);
    }
    `},DepthDownSample={uniforms:{sceneDepth:{value:null},resolution:{value:new Vector2},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new Matrix4},projectionMatrixInv:{value:new Matrix4},logDepth:{value:!1}},depthWrite:!1,depthTest:!1,vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = vec4(position, 1);
    }`,fragmentShader:`
    uniform highp sampler2D sceneDepth;
    uniform vec2 resolution;
    uniform float near;
    uniform float far;
    uniform bool logDepth;
    uniform mat4 viewMatrixInv;
    uniform mat4 projectionMatrixInv;
    varying vec2 vUv;
    layout(location = 1) out vec4 gNormal;
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
        if (logDepth) {
          return getWorldPosLog(vec3(coord, depth));
        }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }
    void main() {
        vec2 uv = vUv - vec2(0.5) / resolution;
        vec2 pixelSize = vec2(1.0) / resolution;
        vec2[] uvSamples = vec2[4](
            uv,
            uv + vec2(pixelSize.x, 0.0),
            uv + vec2(0.0, pixelSize.y),
            uv + pixelSize
        );
        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;
        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;
        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;
        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;
        float minDepth = min(min(depth00, depth10), min(depth01, depth11));
        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));
        float targetDepth = minDepth;
        // Checkerboard pattern to avoid artifacts
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { 
            targetDepth = maxDepth;
        }
        int chosenIndex = 0;
        float[] samples = float[4](depth00, depth10, depth01, depth11);
        for(int i = 0; i < 4; ++i) {
            if (samples[i] == targetDepth) {
                chosenIndex = i;
                break;
            }
        }
        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]
        ), 0.0);
       /* float[] samples = float[4](depth00, depth10, depth01, depth11);
        float c = 0.25 * (depth00 + depth10 + depth01 + depth11);
        float[] distances = float[4](depth00, depth10, depth01, depth11);
        float maxDistance = max(max(distances[0], distances[1]), max(distances[2], distances[3]));

        int remaining[3];
        int rejected[3];
        int i, j, k;

        for(i = 0, j = 0, k = 0; i < 4; ++i) {
            if (distances[i] < maxDistance) {
                remaining[j++] = i;
            } else {
                rejected[k++] = i;
            }
        }
        for(;j < 3;++j) {
            remaining[j] = rejected[--k];
        }
        vec3 s = vec3(
            samples[remaining[0]],
            samples[remaining[1]],
            samples[remaining[2]]
        );
        c = (s.x + s.y + s.z) / 3.0;

        distances[0] = abs(c - s.x);
        distances[1] = abs(c - s.y);
        distances[2] = abs(c - s.z);

        float minDistance = min(min(distances[0], distances[1]), distances[2]);

        for(i = 0; i < 3; ++i) {
            if (distances[i] == minDistance) {
                break;
            }
        }*/
      /*  gl_FragColor = vec4(samples[remaining[i]], 0.0, 0.0, 0.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[remaining[i]], uvSamples[remaining[i]]), uvSamples[remaining[i]]
        ), 0.0);*/
    }`},BlueNoise="5L7pP4UXrOIr/VZ1G3f6p89FIWU7lqc7J3DPxKjJUXODJoHQzf/aNVM+ABlvhXeBGN7iC0WkmTjEaAqOItBfBdaK5KSGV1ET5SOKl3x9JOX5w2sAl6+6KjDhVUHgbqq7DZ5EeYzbdSNxtrQLW/KkPJoOTG4u5CBUZkCKHniY9l7DUgjuz708zG1HIC8qfohi1vPjPH9Lq47ksjRrjwXD4MlVCjdAqYFGodQ8tRmHkOfq4wVRIAHvoavPHvN1lpk3X4Y1yzAPGe8S9KBs3crc4GwlU1dEOXiWol/mgQqxkNqB1xd04+0Bmpwj0GcCc4NUi+c731FUxjvaexCkCJ0qhrJJ++htWqetNC4NewClu8aFRSwrqiJEGe+qtTg4CYCHaF1wJI0sy/ZBQAI0qAMyBvVjWZlv2pdkCaro9eWDLK5I4mbb8E4d7hZr9dDJiTJm6Bmb5S+2F7yal/JPdeLUfwq7jmVLaQfhv4tWMJAt7V4sG9LuAv2oPJgSj1nnlBvPibfHM2TrlWHwGCLGxW/5Jm2TotaDL+pHDM5pn1r0UuTZ24N8S5k68bLHW9tfD+2k4zGev23ExJb4YTRKWrj82N5LjJ26lj1BkGZ0CsXLGGELoPaYQomjTqPxYqhfwOwDliNGVqux9ffuybqOKgsbB51B1GbZfG8vHDBE2JQGib1mnCmWOWAMJcHN0cKeDHYTflbDTVXajtr68mwfRje6WueQ/6yWqmZMLWNH7P27zGFhMFqaqfg11Q88g/9UA/FROe9yfq0yOO0pnNAxvepFy2BpEbcgG+mCyjCC01JWlOZlIPdf1TtlyOt7L94ToYGCukoFt4OqwOrofamjECpSgKLLmrRM+sNRAw12eaqk8KtdFk7pn2IcDQiPXCh16t1a+psi+w9towHTKPyQM0StKr61b2BnN1HU+aezFNBLfHTiXwhGTbdxLLmrsAGIVSiNAeCGE8GlB0iOv2v78kP0CTmAPUEqnHYRSDlP+L6m/rYjEK6Q85GRDJi2W20/7NLPpSOaMR++IFvpkcwRuc59j8hh9tYlc1xjdt2jmp9KJczB7U9P43inuxLOv11P5/HYH5d6gLB0CsbGC8APjh+EcCP0zFWqlaACZweLhVfv3yiyd8R3bdVg8sRKsxPvhDaPpiFp9+MN+0Ua0bsPr+lhxfZhMhlevkLbR4ZvcSRP6ApQLy3+eMh9ehCB3z5DVAaN3P6J8pi5Qa88ZQsOuCTWyH6q8yMfBw8y8nm6jaOxJhPH6Hf0I4jmALUBsWKH4gWBnyijHh7z3/1HhQzFLRDRrIQwUtu11yk7U0gDw/FatOIZOJaBx3UqbUxSZ6dboFPm5pAyyXC2wYdSWlpZx/D2C6hDO2sJM4HT9IKWWmDkZIO2si/6BKHruXIEDpfAtz3xDlIdKnnlqnkfCyy6vNOPyuoWsSWBeiN0mcfIrnOtp2j7bxjOkr25skfS/lwOC692cEp7TKSlymbsyzoWg/0AN66SvQYo6BqpNwPpTaUu25zMWlwVUdfu1EEdc0O06TI0JmHk4f6GZQbfOs//OdgtGPO6uLoadJycR8Z80rkd88QoNmimZd8vcpQKScCFkxH1RMTkPlN3K7CL/NSMOiXEvxrn9VyUPFee63uRflgaPMSsafvqMgzTt3T1RaHNLLFatQbD0Vha4YXZ/6Ake7onM65nC9cyLkteYkDfHoJtef7wCrWXTK0+vH38VUBcFJP0+uUXpkiK0gDXNA39HL/qdVcaOA16kd2gzq8aHpNSaKtgMLJC6fdLLS/I/4lUWV2+djY9Rc3QuJOUrlHFQERtXN4xJaAHZERCUQZ9ND2pEtZg8dsnilcnqmqYn3c1sRyK0ziKpHNytEyi2gmzxEFchvT1uBWxZUikkAlWuyqvvhteSG9kFhTLNM97s3X1iS2UbE6cvApgbmeJ/KqtP0NNT3bZiG9TURInCZtVsNZzYus6On0wcdMlVfqo8XLhT5ojaOk4DtCyeoQkBt1mf5luFNaLFjI/1cnPefyCQwcq5ia/4pN4NB+xE/3SEPsliJypS964SI6o5fDVa0IERR8DoeQ+1iyRLU1qGYexB61ph4pkG1rf3c2YD6By1pFCmww9B0r2VjFeaubkIdgWx4RKLQRPLENdGo8ezI5mkNtdCws19aP1uHhenD+HKa8GDeLulb2fiMRhU2xJzzz9e4yOMPvEnGEfbCiQ17nUDpcFDWthr68mhZ4WiHUkRpaVWJNExuULcGkuyVLsQj59pf6OHFR7tofhy9FMrWPCEvX1d5sCVJt8yBFiB6NoOuwMy4wlso9I2G4E5/5B2c6vIZUUY9fFujT3hpkdTuVhbhBwLCtnlIjBpN4cq+waZ0wXSrmebcl+dcrb7sPh9jKxFINkScDTBgjSUfLkC3huJJs/M4M8AOFxbbSIVpBUarYFmLpGsv+V6TJnWNTwI41tubwo7QSI1VOdRKT/Pp8U3oK2ciDbeuWnAGAANvQjGfcewdAdo6H83XzqlK/4yudtFHJSv9Y+qJskwnVToH1I0+tJ3vsLBXtlvMzLIxUj/8LcqZnrNHfVRgabFNXW0qpUvDgxnP3f54KooR3NI+2Q/VHAYFigMkQE5dLH6C6fGs/TKeE6E2jOhZQcP9/rrJjJKcLYdn5cw6XLCUe9F7quk5Yhac+nYL5HOXvp6Q/5qbiQHkuebanX77YSNx34YaWYpcEHuY1u/lEVTCQ7taPaw3oNcn/qJhMzGPZUs3XAq48wj/hCIO2d5aFdfXnS0yg57/jxzDJBwkdOgeVnyyh19Iz1UqiysT4J1eeKwUuWEYln23ydtP7g3R1BnvnxqFPAnOMgOIop2dkXPfUh/9ZKV3ZQbZNactPD4ql5Qg9CxSBnIwzlj/tseQKWRstwNbf17neGwDFFWdm/8f+nDWt/WlKV3MUiAm3ci6xXMDSL5ubPXBg/gKEE7TsZVGUcrIbdXILcMngvGs7unvlPJh6oadeBDqiAviIZ/iyiUMdQZAuf/YBAY0VP1hcgInuWoKbx31AOjyTN2OOHrlthB3ny9JKHOAc8BMvqopikPldcwIQoFxTccKKIeI815GcwaKDLsMbCsxegrzXl8E0bpic/xffU9y1DCgeKZoF2PIY77RIn6kSRdBiGd8NtNwT74dyeFBMkYraPkudN26x9NPuBt4iCOAnBFaNSKVgKiZQruw22kM1fgBKG7cPYAxdHJ8M4V/jzBn2jEJg+jk/jjV4oMmMNOpKB5oVpVh7tK529Z+5vKZ0NSY2A4YdcT0x4BdkoNEDrpsTmekSTjvx9ZBiTHrm9M/n/hGmgpjz4WEjttRfAEy5DYH5vCK/9GuVPa4hoApFaNlrFD/n2PpKOw24iKujKhVIz41p1E0HwsCd/c17OA0H0RjZi1V/rjJLexUzpmXTMIMuzaOBbU4dxvQMgyvxJvR6DyF3BaHkaqT4P3FRYlm+zh8EEGgmkNqD1WRUubDW62VqLoH8UEelIpL7C8CguWWGGCAIDPma9bnh+7IJSt0Cn6ACER2mYk8dLsrN70RUVLiE0ig+08yPY9IOtuqHf/KYsT84BwhMcVq7t8q1WVjpJGNyXdtIPIjhAzabtrX03Itn29QO3TCixE9WpkHIOdAoGvqCrw1D3x9g9Px8u0yZZuulZuGy0veSY34KDSlhsO1zx2ZMrpDBzCHPB4niwApk6NevIvmBxU3+4yaewDvgEQDJ6Of5iRxjAIpp9UO8EzNY4blj4qh8SCSZTqbe/lShE6tNU9Y5IoWHeJxPcHF9KwYQD7lFcIpcscHrcfkHJfL2lL1zczKywEF7BwkjXEirgBcvNWayatqdTVT5oLbzTmED3EOYBSXFyb2VIYk3t0dOZWJdG1nP+W7Qfyeb8MSIyUGKEA57ptPxrPHKYGZPHsuBqQuVSrn0i8KJX+rlzAqo8AawchsJ26FckxTf5+joTcw+2y8c8bushpRYEbgrdr64ltEYPV2AbVgKXV3XACoD1gbs01CExbJALkuItjfYN3+6I8kbiTYmdzBLaNC+xu9z/eXcRQV1Lo8cJoSsKyWJPuTncu5vcmfMUAWmuwhjymK1rhYR8pQMXNQg9X+5ha5fEnap+LhUL1d5SURZz9rGdOWLhrMcMKSaU3LhOQ/6a6qSCwgzQxCW2gFs53fpvfWxhH+xDHdKRV6w29nQ6rNqd9by+zm1OpzYyJwvFyOkrVXQUwt4HaapnweCa7Tj2Mp/tT4YcY3Q/tk1czgkzlV5mpDrdp1spOYB8ionAwxujjdhj5y9qEHu0uc36PAKAYsKLaEoiwPnob0pdluPWdv4sNSlG8GWViI+x/Z4DkW/kSs2iE3ADFjg4TCvgCbX3v0Hz0KZkerrpzEIukAusidDs2g/w0zgmLnZXvVr5kkpwQTLZ0L6uaTHl0LVikIuNIVPmL3fOQJqIdfzymUN0zucIrDintBn6ICl/inj5zteISv5hEMGMqtHc2ghcFJvmH3ZhIZi34vqqTFCb9pltTYz582Y3dwYaHb9khdfve1YryzEwEKbI8qm62qv+NyllC+WxLLAJjz0ZaEF2aTn35qeFmkbP6LDYcbwqWxA0WKsteB7vy8bRHE4r8LhubWDc0pbe90XckSDDAkRej0TQlmWsWwaz18Tx2phykVvwuIRzf4kt9srT8N7gsMjMs0NLAAldabFf2tiMoaaxHcZSX51WPc1BrwApMxih227qTZkcgtkdK1h314XvZKUKh/XysWYnk1ST4kiBI1B9OlfTjB3WHzTAReFLofsGtikwpIXzQBc/gOjz2Thlj36WN0sxyf4RmAFtrYt64fwm+ThjbhlmUTZzebLl4yAkAqzJSfjPBZS2H/IvkkTUdVh0qdB6EuiHEjEil5lk9BTPzxmoW4Jx543hiyy4ASdYA2DNoprsR9iwGFwFG3F2vIROy4L5CZrl230+k733JwboSNBKngsaFPtqo+q3mFFSjC1k0kIAFmKihaYSwaSF7konmYHZWmchuaq15TpneA2ADSRvA07I7US0lTOOfKrgxhzRl0uJihcEZhhYWxObjvNTJ/5sR4Aa5wOQhGClGLb746cJhQ2E6Jie1hbGgWxUH7YSKETptrTeR/xfcMNk2WM12S0XElC9klR8O7jLYekEOZdscP0ypSdoCVZAoK+2ju2PHE869Q9rxCs9DVQco4BriiPbCjN/8tBjsah4IuboR5QbmbyDpcdXVxGMxvWKIjocBuKbjb+B4HvkunbG0wX0IFCjQKoNMFIKcJSJXtkP3EO+J16uh4img0LQlBAOYwBLupu5r1NALMo0g3xkd9b4f7KoCBWHeyk24FmYUCy/PGLv0xErOTyORp8TJ5nnc2k1dOVBTJok7iHye9dwxwRVP3c7eAS8pMmJYHGpzIHz6ii2WJm8HMTPAZdA4q+ugj3PNCL/N45kyglqvQV4f/+ryDDG5RPy5HVoV9FVuJcq2dxF9Y0heVoipV6q1LyfAeuMzbsUV+rsSBmCSV+1CdKlxy0T0Y6Om0X6701URm2Ml6DIQgJ/3KO6kwcMYRrmKsY7TfxWhSXZll+1PfyRXe9HS0t1IKTQMZL7ZqQ8D/o+en57Y9XAQ9C+kZYykNr0xOMxEwu2+Cppm69mQyTm3H7QX6kHvXF201r+KVAf354qypJC5OHSeBU47bM1bTaVmdVEWQ+9CcvvHdu8Ue5UndHM+EeukmR82voQpetZ7WJjyXs+tPS60nk09gymuORoHNtbm0VuvyigiEvOsyHiRBW7V6FyTCppLPEHvesan91SlEh1/QEunq+qgREFXByDwNKcAH5s8/RFg8hP4wcPmFqX0xXGSKY087bqRLsBZe52jThx0XLkhKQUWPvI18WQQS3g2Ra1pzQ1oNFKdfJJjyaH5tJH6w0/upJobwB8KZ5cIs9LnVGxfBaHXBfvLkNpab7dpU6TdcbBIc+A4bqXE/Xt8/xsGQOdoXra4Us5nDAM6v2BNBQaGMmgMfQQV+ikTteSHvyl8wUxULiYRIEKaiDxpBJnyf9OoqQdZVJ8ahqOvuwqq5mnDUAUzUr/Lvs1wLu2F+r4eZMfJPL4gV5mKLkITmozRnTvA7VABaxZmFRtkhvU5iH9RQ1z26ku7aABokvptx7RKZBVL6dveLKOzg0NC7HAxcg5kE1wuyJiEQLOpO0ma3AtWD2Q2Wmn2oPZeDYAwVyEpxuwDy7ivmdUDSL95ol3h2JByTMovOCgxZ1q4E5nwwa7+4WtDAse6bDdr27XgAi5Px3IWbyZ/vRiECKwOMeJSuIl8A4Ds0emI3SgKVVWVO5uyiEUET+ucEq0casA+DQyhzRc8j+Plo0pxKynB/t0uXod1FVV4fX1sC4kDfwFaUDGQ4p9HYgaMqIWX3OF/S8+vcR0JS0bDapWKJwAIIQiRUzvh5YwtzkjccbbrT9Ky/qt5X7MAGA0lzh43mDF9EB6lCGuO/aFCMhdOqNryvd73KdJNy3mxtT8AqgmG4xq7eE1jKu6rV0g8UGyMatzyIMjiOCf4lIJFzAfwDbIfC72TJ/TK+cGsLR8blpjlEILjD8Mxr7IffhbFhgo12CzXRQ2O8JqBJ70+t12385tSmFC8Or+U8svOaoGoojT1/EmjRMT7x2iTUZ7Ny02VGeMZTtGy029tGN1/9k7x3mFu63lYnaWjfJT1m1zpWO3HSXpGkFqVd/m3kDMv4X9rmLOpwEeu8r6TI6C2zUG+MT6v90OU3y5hKqLhpyFLGtkZhDmUg/W1JGSmA8N1TapR4Kny+P6+DuMadZ9+xBbv06nfOjMwkoTsjG0zFmNbvlxEjw+Pl5QYK+V8Qyb+nknZ0Nb/Ofi9+V0eoNtTrtD1/0wzUGGG5u2D/J1ouO/PjXFJVx6LurVnPOyFVbZx7s3ZSjSq+7YN3wzTbFbUvP8GBh7cKieJt56SIowQ2I577+UEXrxUKMFO+XaLLCALuiJWB2vUdpsT+kQ+adoeTfwOulXhd/KZ7ygjj6PhvGT1xzfT7hTwd6dzSB4xV70CesHC0dsg2VyujlMGBKjg5snbrHHX/LNj3SsoLGSX+bZNTDDCNTXh+dCVPlj4K8+hJ/kVddrbtZw26Hx5qYiv3oNNg5blHRSPtmojhZmBQAz8sLC9nAuWNSz1dIofFtlryEKklbdkhBCcx5dhj7pinXDNlCeatCeTCEjYCpZ3HRf5QzUcRR1Tdb3gwtYtpPdgMxmWfJGoZSu1EsCJbIhS16Ed97+8br4Ar1mB1GcnZVx/HPtJl4CgbHXrrDPwlE4od8deRQYLt9IlsvCqgesMmLAVxB+igH7WGTcY/e3lLHJ4rkBgh2p1QpUBRb/cSQsJCbosFDkalbJigimldVK7TIHKSq2w8mezku9hgw8fXJxGdXoL1ggma52kXzjP78l0d0zMwtTVlt0FqnRyGLPGEjmICzgSp7XPFlUr7AeMclQ4opqwBFInziM5F8oJJ8qeuckGOnAcZZOLl1+ZhGF17pfIuujipwFJL7ChIIB2vlo0IQZGTJPNa2YjNcGUw+a/gWYLkCp+bOGIYhWr08UIE709ZEHlUoEbumzgpJv1D0+hWYNEpj+laoZIK5weO2DFwLL6UBYNrXTm9YvvxeN9U9oKsB3zKBwzFFwDgid5ESMhy68xBnVa55sCZd+l5AnzT8etYjIwF/BGwEx1jjzFv32bk6EeJulESARh8RZ48o7rKw67UZpudPa15SDnL8AL8xMV2SC0D1P53p190zhCFkMmEiir2olwxcJppl/kLm6/0QSUQLNaxi1AC3Pg1CTosX2YQr73PjEIxIlg4mJ62vP7ZyoHE55B0SX9YrrrCPtNsrJEwtn6KOSt7nLT3n3DLJTPbLulcqQ1kETP6Huts29oP+JLEqRGWgnrqMD+mhCl1XCZifjgQ39AeudE8pyu2DqnYU3PyPbJhStq1HbP+VxgseWL+hQ+4w1okADlA9WqoaRuoS7IY77Cm40cJiE6FLomUMltT+xO3Upcv5dzSh9F57hodSBnMHukcH1kd9tqlpprBQ/Ij9E+wMQXrZG5PlzwYJ6jmRdnQtRj64wC/7vsDaaMFteBOUDR4ebRrNZJHhwlNEK9Bz3k7jqOV5KJpL74p2sQnd7vLE374Jz+G7H3RUbX17SobYOe9wKkL/Ja/zeiKExOBmPo0X29bURQMxJkN4ddbrHnOkn6+M1zTZHo0efsB23WSSsByfmye2ZuTEZ12J3Y8ffT6Fcv8XVfA/k+p+xJGreKHJRVUIBqfEIlRt987/QXkssXuvLkECSpVEBs+gE1meB6Xn1RWISG6sV3+KOVjiE9wGdRHS8rmTERRnk0mDNU/+kOQYN/6jdeq0IHeh9c6xlSNICo9OcX1MmAiEuvGay43xCZgxHeZqD7etZMigoJI5V2q7xDcXcPort7AEjLwWlEf4ouzy2iPa3lxpcJWdIcHjhLZf1zg/Kv3/yN1voOmCLrI1Fe0MuFbB0TFSUt+t4Wqe2Mj1o2KS0TFQPGRlFm26IvVP9OXKIQkjfueRtMPoqLfVgDhplKvWWJA673+52FgEEgm+HwEgzOjaTuBz639XtCTwaQL/DrCeRdXun0VU3HDmNmTkc6YrNR6tTVWnbqHwykSBswchFLnvouR0KRhDhZiTYYYNWdvXzY+61Jz5IBcTJavGXr9BcHdk/3tqaLbwCbfpwjxCFSUs1xfFcRzRfMAl+QYuCpsYGz9H01poc1LyzhXwmODmUSg/xFq/RosgYikz4Om/ni9QCcr28ZPISaKrY7O+CspM/s+sHtnA9o9WgFWhcBX2LDN2/AL5uB6UxL/RaBp7EI+JHGz6MeLfvSNJnBgI9THFdUwmg1AXb9pvd7ccLqRdmcHLRT1I2VuEAghBduBm7pHNrZIjb2UVrijpZPlGL68hr+SDlC31mdis0BjP4aZFEOcw+uB17y5u7WOnho60Vcy7gRr7BZ9z5zY1uIwo+tW1YKpuQpdR0Vi7AxKmaIa4jXTjUh7MRlNM0W/Ut/CSD7atFd4soMsX7QbcrUZZaWuN0KOVCL9E09UcJlX+esWK56mre/s6UO9ks0owQ+foaVopkuKG+HZYbE1L1e0VwY2J53aCpwC77HqtpyNtoIlBVzOPtFvzBpDV9TjiP3CcTTGqLKh+m7urHvtHSB/+cGuRk4SsTma9sPCVJ19UPvaAv5WB8u57lNeUewwKpXmmKm5XZV91+FqCCT6nVrrrOgXfYmGFlVjqsSn3/yufkGIdtmdD0yVBcYFR3hDx43e3E4iuiEtP3Me9gcsBqveQdKojKR//qD2nEDY0IktMgFvH+SqVWi9mAorym92NEGbY8MeDjp553MiTXCRSASPt+Ga5q7pB9vwFQCTpaoevx0yEfrq9rMs3eU6wclBMJ9Ve8m6QuLYZ58J41YG3jW/khW92h6M/vbFIUPuopZ6VVtpciesU74Ef7ic8iSymDohGeUn4ubT0vRsXmbsjaJaYhL8f+8I5EiD5l680MJbxX/4GYrOg4iPQqpKp0qddSu/HKtznHeVyxgTwhfEORMCwnaqetVSzvidaWN9P+fXtGXfEP9cTdwx2gKVfDdICq7hecgRhIs0qlCt6+5pGlCc6kWoplHa/KjP+FJdXBU/IDoKMxRjFhSYkggIkhvRKiN/b2ud8URPF+lB87AGAwyMjr/Wju2Uj5IrppXZWjI3d14BdKE2fhALyQPmHqqA+AXd2LwvRHcBq4mhOQ4oNRWH7wpzc6Pggfcbv9kqhLxrJKEaJqA6Rxi+TDNOJstd5DoRVCDjmVspCVyHJsFEWPg9+NA8l1e4X2PDvOd5MPZAGw6LRhWqeZoSQcPf9/dGJYAyzCmttlRnx0BfrKQ/G9i5DVJft9fuJwMi3OD/0Dv1bRoxcXAyZ0wMJ6rwk9RjRTF4ZK8JviCCNuVt/BqQYiphOzWCpnbwOZt6qXuiAabQWrS4mNXQ7cEErXR/yJcbdFp5nWE1bPBjD0fmG3ovMxmOq5blpcOs0DtNQpci1t+9DKERWAO53IVV/S4yhMklvIp0j0FIQgwjdUptqmoMYGVWSI5YkTKLHZdXRDv9zs+HdFZt1QVcdlGOgATro3fg6ticCrDQKUJC7bYX50wdvetilEwVenHhlr85HMLRLTD6nDXWId4ORLwwe5IXiOhpuZTVTv+xdkTxJofqeCRM/jcZqQlU0gFVTlYlfwMi6HKR2YG4fQ8TOtgR+yV+BMZb6L5OwDc/28/xdfD7GXFaVA2ZSObiIxBwT2Zev637EuvpM6rxcogdM4FJFa0ZhF7nrqtNsqWg5M7hZMORpjd4szf/wS+Ahs1shY54Ct5J1dOBO4sdEtSnRc0P9PhgyOCt6aQW98R22DpAcNTDe72AHK40vutKTPfpokghRPuGvz0dulBPKfC3O4KVDCyWrJGO7Ikdu06A0keKlVfi0tGcpO0NhzXEh75NHyMysAMV19fq7//sPC0For1k2uFEvq8lwrMAfmP7afR69U2RqaILHe7glpc8HmVf87Qb2ohsw+Di9U+ePdHLecS66MhB/0OwdcXR5WBcWTZLGq/kiAaT+bzkjR8GIpWdv6pfIgQ+Q0xdiKvo+gNB7/Nf9knNJGxnh7LeZEFtMn517tNc74PPS0M4K3I6HHZqNPA+VZcBc/g5a2ARyqKrJ4Z3krsuA+VOJJz2KJpBMgCCWFln3u7k6/q3DETAubKG/pt3ObaNT0NI0Qug90L2ip5dHnZJUjPTvK5E96aX/4mRU2u8n8kh6MKbY7ANBro3huF06U+JvfyELQP25oIaj+n0ITQ4KT9rXZD4EtBIOj95fYNldDN3io/VMIvWNj9P/b95WEMq8UAVfG2XG0N6fSYdnBEC7sUEbatbDICH9qA8TTuW9kEt9DlFOZFP7bdfYLa/khSY8W5K/AkIIAPXtMvyVKyESjKx9nfragssxC0jFMVY94d8lOAwRocdS/l/P43cBGa3IqDa0ihGPcmwS8O8Vj16Uy55rOrnN0shhRJZdW8I7F0Q0KeHc35GFo4aJOFc25gNafBu1V/VO0qS4Qkb6wjRrnlepUWjtYyaDABZceValuOMtoDdeIITWKOJiwGPpB12lQgwkmXh9M86podb0D117mNQ8ElluFvbaS8RTKQ6lyj88dUwoJU/ofOeubhoXWBF8eNumkVJu+As3ED/AvLlrV91UowIWI2m8HBG+a3k247ZKAGYsOcWe7fTWqL8eqwM5ZFuoXbeugPKuMOAtOsN+4dSwkhrSAlfGNTzFwEmCNWtzpa9CgPbYNcmoHtO8pj8qMvlGET6nrkJoQ2lp5MEUV1E2A4ZH70JUlCLXvqTIpZlzyxdr5p/GZiD1/BuFOGbyfFzhuxaC/l3lC2jjt6GNRBa06AqqPlYtdA7kiidYa5Qi0/XpXiMDyMXNOj3kmJEaXufW0GO8+DF8OoMULX1vvjCePKNis4AmxQKLCF+cjf/wyilCJvuiyLVPSdsuRTPZ0AhpdDF/1uFmDwG7iP3qYwNsKzqd3sYdnMolCOuQOIHWy1eQpWhuV+jmSeAC5zCc0/KsOIXkZPdiw8vtB33jEBpezpGDBP4JLY2wH1J7Fzp8y8RICqVd25mDT2tDb/L1mh4fv9TOfDH5dTeATqu+diOZi+/sIt18hiTovPsVQVaqXLPRx/4R/uH/86tBMcF+WBkThKLfblcVCIECc8DgNRVX97KdrsCeIK+CvJZMfwrftcDZDZyp7G8HeKl7bPYnTKX88dXAwAyz66O2chkPDHy/2K2XcT/61XnlAKgPwtI8yP9Vu45yh55KHhJu93mL4nfo8szp/IyDjmFHtSMqqoWsj8WaVhbjXgzZxcqZcyOe7pUK6aXF/Y32LnBOt0WN28UmHRiOpL525C63I2JQPX8vvOU0fz2ij74OeJ1Apgu3JRObfdo9xGDpp7cv3TdULEfNS6Gu3EJu7drBsBsogUqUc6wAUW3ux0/1hLVI/JEKJrAGm8g72C2aJSsGAsKFW4CBvBXVlNIKa5r7HvT1BeGYBfxTR1vhNlFFNN8WQYwr39yT/13XzRGiF2IsfE8HcN0+lN1zN/OnzekVBKkFY11GgrK5CLxrE/2HCEMwQb9yOuP2rTXiZzTEETp/ismFGcTWmbM9G1Sn2D/x3G74uWYZY4rgKB2Zo2bTKS6QnM5x1Yee66Y1L7K44AyiY5K2MH5wrTwxMFh+S8LzNQ25z6sunWZyiRwFIIvSnioltUXNiOr+XMZ6O9h9HcHxZJkfF0tUm6QkU7iJ2ozXARitiL86aqVsMOpmvdIBROhUoanPtCjgft8up3hAaKpw9Qs9MzYtBA2ijHXotzarkV3zKEK0dFFQUwT74NgCmGGuSCEDmFCezXPC9BhyGhmzNa6rQeQQz+r9CmGUZjIQEPsHwe86oCOQhWaHERsv5ia9rZvJ//7UXO7B329YUkLLAiqpLRsVV5XpcfdawlJqi/BVcCqO6dr9YJTFFRMVGhfUbB9YWNvYPY6RyaydAFYq1YIBQxuNAGfYWLMAHtt2XRHoOKCLz+qf5HCVBDOPOktQ3SdJBfxUkaiD585bmTzMwU3oeXUHZ55EC99Kz9kk4ZXMIENwVVpqW2JmGIcUiutIMj2KkpjE2QD+dIZUCxcX57kH7hiuUPnKCTdaw4KN95XPeFRvMcvo5L8LexWqvaJPECzwXCs/4XPAlSMpWUzBBjK3pEnkbueMkMJQrYcnXf7PjbAoJra1VLX4YuscQLpaeYWbT+h24hCFrfcHjxxx6WTSe4AGY/KHRZCQKqTuFWt0D8RmGWmvXSdg1ptIefYPshuIVZT7CV4Ny67fvjJugy0TNYHqoCO45CB88kxrvIsih19DqjD0UqiJsTFPcGW3P/ULOG3nb8CjpgVTIoa5nO9ZYEX4uEHu8hLXrJPjV1lTQ5xTdZVagg+Wj8V0EE4yPsTc345KM6lVXqLiHtm+G6edC4GVEiPgd98g+twSYm18gCsPnjqlLcFm9e72CLJbYD+ocIZOxuVjrX6IKh9fh7WqdIZ66x9PWkDGOVVGkx7jM76Ywe16DX9ng205kg5eq+R2q2MguTJxYv/wWHliD9mOYpzZKNXYC3Wr4iBGkm54hBwkPzFhiX/VBHdVH/KJ1ZIMOHxIN6arKdxrm6EBsgwDt0mPe0MX1HRUMq8ctcmysU6xX0bzM1J07kAvq33jw1q0Pq2cyMWme8F7aVkfhzZEFdyi8fVBQav0YZqvAjZ83WKH726rBx5Bn7GHFthR6H4lFsltu+jWmsAibJ3kpWMG/QbncU7n9skIBL0MuXXtj9sJg+4Dl0XhKJ1LcrMydaIgyrgZgScP4k8YQvcsBmD26X1iYXKLzMYfZn2IfRjznsrJ1e5cnl/3a5xiNoI6n1x1U36FWckJbyx+hiSZg0QqAqeeSvzFYMlZ2REnO/a6yoQhu7PdHMYEPFIvfyGeyCU8e7rpju4DrlOhszj9rOIpNsvCkuD+TLyf5J7D/wsPkBpscFVI1q7oUSU9bN30vH5AqnO7bsf+9rGhtVjOJQ32H9hHSAzR2ape4L0Cz4WxaySm4jvuGXwkFp5NMMLrgZ8LdA+5uLuyxO5SMOmJNDBcbbLefv7z6LyxBwltnfQLd7qqpG1MmNcoLUcx73BkNF/xpdS0cKd6G646ntChXSeTZJJTFYGw39T7fqXDPKoG2cF7/ZcTvME42gXLVjTqzAER1Rt5m7GYsh0X0+XgOeW9MJqE5j/rpGzY6vUu6ACcCTzDMdZHiWELpDnvgE1hmztLcSYz0MtNyUBLqvylUJJnJu79Sku9NMHCTkgqozTnhMFfduV2NLCSYvAI5HUvQp1h/M02vKFD6eosIkGTg6mujUo1W8hy5Knf/erkBQC9LzNqPAYCgR+hczgevta88NNqSlBZryq9QNeUK7RpbvHjoNhUKAAeNYH55LeTW36KyFaXdAkBvyNP9xmRuBokPi2OhqDby6IZ61mwfzG+GmACkS+G80A4WGON5izgJWeeDK91jzusfOi0RmEsVJXwbVUr8u/J2LCQaMnHhi+wJTEPN9tS2b6W4GRGCNmtjAMgPsP357nOeD3H2tcDAPu5xQBKMHf/j4ZhXlkvvy3YmBJsjsd4pSOlfPZCnw5JvzxEXM5JIc+E2mU4CgB0mdJnH4NEsCHYNeVRDXFNuyZUE4nuvaJf1h+11AWLdAZ72D9XNRcxfb2+XHZN/SN48U7yl+sNZhg5gn/PD8wkBtnRj1zBUPIWnoMP6yGUEEzuT+VaX3x2jEIZAZsr3rs9wCfY1Ss0EdIFFzBbyruUup4EPanbSYew5tf16/ZWVup5iykttuqL4xoC/jdZWsAZeSfDSd3fP9kbyAFYXkf0Q2lmxaTkKRZrCo9XCoiUG4yP1URJ5G7+HSOhhJp0Anz0N07QZtyFUye6rcgiOFbtyoO1lkuV0iQ602MTyFK9xLqNHtNy4cJaTO6hjtiwNynVc34ZA6H7k8ai6S6eF6jIG0xJx+JfP97lzuCZr8vU5SIzImaNpiQhyvDbz23//PJcOk7hD4iIvJzfIgOGIR6ZPEJpWHZQoacbF+omeHw8aWHaNOfaIyGeG4lEryMfhtNmWh4RAIpn8dLs7ZE2eTVDwK++xDoSUgh47WDmKlZ/k6OosEUoQjk7Q+Kp7OxwgMFShAv6z4pTW8loVj2+qXLQ0T3hmIue8qHy1o/HXjm089m71t6mrrUyDftqMYtmfvQXKDlZ+K1HR/FkqPSqcjGlcPPIwbMw3wIFKBdVMJ4pFLt+oOIkWZMw8pkoYZ3byw4LmAF+7BdicGXFcb5PWtDw5XNNVc6eB9dv0rAEpgr5J+bLr010bpfGw+IkRoxDbkDFmQdEQUSElP5bViLo1ur/23KN0jEwl+rGC6AUMKxHcv+T9F1Ktpn8jSSrKxJnVkK8UD/tH5DN6nXB8mjUdFU539e9ywLtLYCwmHYVEVqnFmdubduaSd1ivIo4pTsX+mJcOAkrR1D60RIoocCBIdwJhCBM1rOE2XSlPo0U+khALvw+zfxYzwzd4roWlLJkZheFRR8QB8v4USwmAcDswUZ2P/7v7Xa51Fs7orYebYyww4YW5869Y/c6Kq2eTR9HLSjYuChTkXaDygoo8nz/yJ0KzfX8oowaNAwz8HvQdlLU9V9hjqYMURyYvPzZ60G0itmUdZwB+sY6rUkMAZZtWStbDFmnk/dQorhwr3121XQWffrK3as0g29ASwxbsZ3dZAq/96b7/XWckbjmo8+jwdE680DzoEUUivnBgowMuBQxHXoGyp+w/cSGY88rWtmwoyNNIvChs/QsZRnbdV7y8x7t2RkliJV/j8e6qfctrTsMV22zoqgQuTSNFh7U7p/Q49L0kygXNnEYXCBDgi5BeNWxu7VjULcUHI+lGj+OTCEATzWrDmaynq3wT9IAejtvh3esCu6sEu9JOsXxMDpqxm4Tzl+pt2Wa5Bq3TM5TKH4N7KLir8FGIPA569+uJ1VEL3fW8Jyigz/nEUjAVYrdCWq2MnS4hQVgcvXq9aF7Xke/k++rAtIQqckPNwjKrV2t7HCOrA1ps88Y5Rw1Zp+9itnB71j8tNiQc7mV1kUCQXkoi5fOsq1uC6hUPUL7Z69NAM6lg0c/aeiifHoi35v+pVBh7CDM1XfvYpiK5JIbIQFHafmnhHfRTnMagKcjdE7zzgtxkTPKVrObTySTT51g9bB5ro/dzn/sB24fNM2LGJuRQsmC49PLi1jTRfZaLpo8Txxxczij5Pl2vur+S1wQW3W5qyVcIUySZHtFDQHv+EYDoZG1T1J7D91vEIV8dHzUBzW1UyuxRbP+M/CM/vsas6RzmS5traXnQ0Jzv9hYXxKHcs15TQCP744XsLjzFjILYURXFnhM+nnV0iO6nwls9TR4tlz1J9/NvE8FGg5mgpZA4htS05AK0NnU2gxuqf2vjCyWlm3ypKvaX4vxh8Um1MHGB2NTeAFhbDyGm+5w2zqJAWxVlj6dVePb5yR+aMhuz05YubCQJ0BOtoYQ6PoDoW5fCwCtXj5SHvCgL/3B5z2mcXWaRTf8/GsFAfX/ntdWZWFc2xg8MJeenwZ4dZUToce43If4zVb1ex3BMAWGhgkPwR5EgktZhW3Yi+nsnZTUr9FYI160YhAraB0zMV+ouHz6hYm25/ETDM0MTmcypoGgZISSkfwYAQaHGY45yZ91K4A4Mm4fnbMk8GTc4orypT3NLBqAxYdcY/qCH82PpIkmVOEHi1NoYaUymuImLLcib5pmd2MHTB3JR+4rLdRc3gtQ9zeFdciciRiWviu3HkqaLSxJeI2rgc7OKQslItumACQow89elXmi4P3gTZeCauvMH5nF4VrBcLjjwGD+KlKqe/RWIEgT2wGqAgSuL6b+RTTPnQZzxZ5y5HQJkEEKJp5NfoB8hJBM8qn6xbOFtyzBjVBrwSS1zCJR3lEc9ODQ5Wu/xct9/2Q6qLHnmNx6XwZus/i8rEd6UsVxGtoDrm+Br0L5oUojlwdcqyVV4PIMsR60JhZwJtgX7izQWj+GOeF9DA8Wexdmv6DWjgR8LEBp9YuPAM8tJDu3uCumNqHnF2ATYX/tuVO55OgQuiUhmDmJbF9jJyifBRtxOVI9DCNLUY71IXZYTuiYcnILQ/XHuVJ8aHDStL0N+3eYNvXwHi2vEiTPnBqzsC4TsPnFVnYY042j5i7C11AVdBZ1pGSa52jM9dIL119rry0mgGxFzI8xPs+7bmMfYKh37A4HtA081olG1m9S4Zch2hoNCGVvVhd6UL7C2d5hKIBHoB+Uxarq/4aQXhh7IWjSj+ca7Vhqb4+ZwY3nHXh2S9JH4XZxQojbe/eINxYlozTYtT2rpU/xbj+W2hXjFQ+z+dQ8wh9751MP0UpjutQdxz3/FJYAEG5BF400JXWCBs7KrCRf/l+F+d9EuwVk6thOPDB+HNS9iWlLmDgXvY6K0vgiyoeA3An+jWufdAG1suUMBuJT+/w0FNJZbObUT8c5q5WtQxASQF6E+/u8UwVBs1eo8jTamCrcdhZJlADJbqn3crcDHQlBQNGq7btcGKiJXW6q0cn3F0xzf+k1JJS2testB3rx15ZPTDXm8QV5XE2qxBOdM2n6t5YbxyNOmEdsHx+hMp+y9pWkcgw1NikeXuafJvzcjaNwE1Ad6gG79S68aO7jWpKgBETYLmV4ONHhBk7Be8tjf2WVvWMDQvQdOnk448yeMv1tQKU1xev0L171e/qxkMZbmkfKnd29XRCK2hgNNJhwt1qiYWZGKz7Di6K3fGDT7DO2YQ7WU33svE/WKGbWQEvzUV2w+VNYDocI4yxQ6i3i4zU2TjmjCwu5Pk+Ja9HSwLpEoUswq3tFJ1jimthgMXd7KjSl6Qd0K+vxWT8G4/+xITHsWDGSfQTSdFQth5uVVfa8wrkDZHTGVgpJys2ik+3I0dSf6TNo6A/sVptyY/kx1hdAWKPI6t/xj6s+fPMU3hg1vkEB0RRHq/tCy3KUUhzU/d0JKxTyjvUms5iy1GbOFco0NA4t83SK9sBmtLWm4kOLLflyxqgQYP08iyXwYXzKnlQ6VTipuaspSJ9g5H5Lu3eLMnPKbhcwuEg0VZ80ppJWjUnhS3rL35erzysp+fJhxsUs86m28/UwW+IgrS5Y0zWaxlFJ8xML5wk8sg1ragF+eNajyI0Y4mwStxt1RZH2BjaAhvu+SnNNIK88thEgZEsoHv+ii+OMmXJL7dnAiINVDz3tCnqDgpQX9OguNGgZj3axcjq1UgxDw785yNIpqNiLgv57399jVmJ0/RStNswaFIs6FtnkilFZldxj6m562jL4p5g3Y9XCiXRJX6nq2PGJFifFR7EyPG4jDMnBM4t+O8ZpEp3th7TCxEw+ZG4afHl4sNFaqxyLh6+979tt0Aq9BrqI+CS2U7HJoKiGmyVU1lFa3/0O5mNC1bzRgNMy+GXyifLwJP7FwUSUmxmVRpn+gnXWoIuswPutsiciurvN6lsMG7yqEc2Y5ZI3jrPgPq0xEKPZpF7teJa0TQn8BQL4Th+hjv2ByfwKookyXEmj0d1KMcsmfKaeKK3cZZubiYqmSCrnGpYTwgPk5itKucVtjViuswQsDR6TuyGSIHYvlz7wkLg1Rr0K9kV1o8RgABlhbLrN74cVWJW6TnfXN0q12JFMpUbEa8t1+j440FA+17o8qa8PQ9igkctVROVIfB3jU5vtGm5pYYHYSDvU2TEc15pIz19ka1q6c/7WXfF8+POkApdOw7nn7Kqz6V4tru7NXgnA/u0g6+fPRT3hp/QrDQwMsjwNCZxdWrR6pgCBDJNc7/KAlwC0UZ4yWQs0KsuwbbOgcTxQPK54wiXr7s+221hzZ8RVxfoRUKM3e4lpxHC83JllxlrV760tl06f7/65qhE1jhMfivAUXIXfRMe3uY/G2TpWYzDrw5Cm5cS062Bx9lhHq9gtJp8xZwAtSdSuW/Kd7+orEAiswA76N8ezmVGYgNaYlQ/xk930LAWAtKVBC4U6R08L45IohB1kFia7XJs0TcaT2zBZoLFuOGu4iJaoAnfjL3uS6gnRH7G7A+aT6ETlmkYUfgrBuaSLLDJfhPJe01PfN0oqBTeQURasl3N8BZiQSgdr0aDv3hPTiog4NSyfAUyy98WP7dnTDWQTY+Qwzgk1uxwRqHl5MpC/84Cuw1TXfRlgJrwPop10kCHjmffnFdxCe2J3R3J5j+3H/sZn3IUu3Suy+I+dAOMWvzwExNR3RRPVelZAhtarKlXPWNjPRIVP4JsAFSRXs3o/fSYAPaV/zP8q6DltH47/rYhCLdy/LrpOsbaLf09eACcClJosNefetNElkSFSuCgeY7oTAAl+8Y2zOXJb/bgEDpoDXfQqc6lnlBr/WsmVznkBS1M7ufiqpxvKXjwvR4WxLbh5NbMNy8LsnX4UiuAi8XonbSUcVZKQOWBYUecSOMj6jMG8gHu7WNreBHY90lV7FocDprSrSbexkAtMW9KlXcnrOyLnZdodGYdxz8aw71HztIqLhRdCOB6NyzHPoS2hDy6wLk0I5Jr2t+U0A+A7EsgSn/Ih03A5CspHnVF4MOic+Lck3m61Um+GHDEe4DrHBhmgtDlRQl1XJ/V/VumCHtUDDcZCkgjVMBOmVOGYW0Rcdi1ahdjhBcFlfjA+5cRjBop1aNDvdrf7CxkLVgxiCxhRctW8wczM8+kVmIrGtkaHGlr8y2D098HXE23r7fnJFUU68zyeyM265igNOGPzFG0dIgUDWN6S3ZcfMERJdWVvpGhVEHXNLeWqHiTcF3wOt0FbJY4XHEpmkoG9MQPJJ4ueQ01+MB+SR0rCSGzlE8zod19q75LlLWgzogpnJoD4gPxUYcX+Gpc5Ly4nk+Zm8LDXcNR7SNVxLh6NAcx8ekjb/AC7ADlRnfuHaHJaBodZr7RBX9FLTvocY6kY8bavdAkQicE9bbwGLkZu6whTCJ56lOvM39ijehpTOFqR3V53nQx4hfOvwRPU2y2w7UU8yiRbcyaX6jGJ9CRvl9ybV1tebTp5MMuMnwLcx/lven0w9T0atJuiUE2WtYGiVMaP3EchABl5AsyaCpu/BKAWDFvU2vaCL2/fJBKCKLjxG6xzT4Mh4wHhH3/EqsGSoQAHu2wbHmXHj2LvoW19GXDa2oyeKRwGG1PU+S7mE/S+UmjHiDF1oqJ0R5QsdjAZYN1MzpNX5YDqWYfhfdjAXyFQaVyGKkp1oEGTR8MK6jaGfRDFd41u2Ex8ac8jKPYu3pXsk8gu+m9tr1RVzTTuDsACW4S1h32yFHX7qpXSmA0QVEcR8W9j2Juu0pcYqTmdis88VgT3gq7iYue5Hx/3K6hFQa9rZrNSDcjaSQlNn4LSqs20bypnKqpzvnnxjMdz5StbzvoAJKgVZa4DLCVoJW765/KyTF4s4YztmAT1c0pTmKJHTpa106FegDo8p2zD6uOnwpYi0vJlRMDe9wPT6964UfAf6lq3qWypUOx9q6BbKEYt7K3gWMXDNN6wAm1fNnSOnZ4JkbPq7jLQrl0wL1V7QwO/sXneKGfTgUL28I5iPVG9dA2gS7Ki005JUR7Vmw4gX4TJvy1WS74cIXD08LCF5obqcZwamuoZ+FPMJEck0TLHjyH1baPr55/Cy0ptDfRJ7d89pbP48tLMHG5dO11Z8xSSpPGQSgXDWmpsNsmm+MvxJjMCi7OFDHxxpmTtjgnOCq+c7Fi1DybfhAntviKccz+sj+OPKPYOKeYYPLvq6MpUx/chSvBccg9dfbeqetQNCs3eiCFZTU1mrDido/mib64STMgsa+IKLk9PyxGGbVSQB9GsHto6f5prAFIbRDSItDedz3t5+Nn69FFS0nEfmkF7hKBmNVce5xv65USKGBoHYxJyutSGnRIq7vMDsAMvirOEJOzNi5Kt7fypuSU2c2Npo6UH5jMOkePH0TwgpammO3Fb2FX6f11309z/mqRmQ949HHRj/wMzKNx95M9pwKf+UQkMEwisL3YVotvHhCv4y00Ui0Ql8dR7tGqFcSdYtmoAOuAodkBNs4PZSjAAF7S/szwLddFMdCyB/dWPgFUiUE+WmUUCjYrKfJLQfNNpQ4NKaF57w7Kp/isZVwQPUJyjJavN3fQNKU+F74jVBJYQEcEdw0Niinyea0l9PJ1/AcTm/LI91RZjDvLI81pnat7RKU2P4/TnIAa3hIEfeg4iGQ+wTDlURK6YjNpN5s5VkQW9w7sDYKU4XmjyZsCQLxztqd4SDQvLyuPDhURAJXKfR1c7tq3mRu4usFHPqz7HgS0X7kNxiWWR3fb3uVwbgKpmgLYkwKrXKt09COw4MjhxeZlDXKy7nNLHXAIKPtferWQnZLboonQXK81x+BB3oUidBehK1swSXxVbscj/LsfONu/xYEXYPM3aMqIYd+2hAnFvDHbdrJLhGEd3sG5PyxqhzejhQJo9wauFK3xmPYqxB99J8zYU9/yzrEZNzzbvPoR9vUlE3Ha4zspVDzHHffPZMJ1VLZkKqGCf8ZqupqMt6T+NRPfmPm2xeDgvzMrRJEL4/zzlu7Z35smvzbgeC25VP2CUrZkRxEi15A0769ojdO1d7C9OG+swj1ROMM3NgKdeBADoRMeJkRZcZ1FbQu6C0BS9NNSaoxtFzYT4lX7+PQ7BKa84yrN+ujVVef+SgnEie1G0N+eOtbZF/UU+wkeerWjloYqFiqo0vBnmxh+TwNMo9I/8lfU2XTCT0K4OoWE08ipyNHjxHvfhY6qa3x4HzdQ8+jkiO5+j91YkihS5memfpFREHP/2veN5XcRue2zCVuAub8V6vDlOvyP+PBm+owyRhMmng5wwGGIXsOkQekXrXpE/6dFjkHwwoFoj5bIFiqp+4wHpSWRbv2xGrRpd2c87FzMP6Hfj/3LWIBqFiNOAxBw+AAP1XqUBszdZhzOSQrQS4Ein4fyV7MaGsB0VsMF4bPb4lx/foTGQRJv45LpoxDd84xCawHaX7jpXUrOdkFxx2oUvY2xqpgIvcVufwd+zAnaaVTnEyDXD7S/o/xrrk4mgTjXhcjj5Rzrbr23NmuZQvpdNzny5MCR9bwvIRIqzOZZLsstZSCDYa56JTvzxgBs20dYTtTUbe21uljlWqGfSh2bYAzOpf6UguK30ZxNXgLHs6Y6urtxFA5iLYvlue5mDONW0MOtQjhqr8fRbCkYneiDkvzHkQVT4F9v9vxh2SIGPBH8bZb8ugo/BSgXojeSdNXbBAIDsB6DUNSXnwlu/bFLaCqSbvu4+YLplwO1JbtrMf9ZUfsxerAZjB7E/zl3qwgK27FswemUmSM4i37YAVhQSocuV8AcDI/CSeCDNPavESshDQ8A/lVIrAJAMdP/rHXouiNU8RL/TIvfQiuZEb6dkIKMGGOW5kT8vO8pivWnT4v7qmwuJo52AS1r/RyQ2g/7c9ZJgmMIzf0GvJJRfMNu1utRNuLWHOm9JIMcJK3qiDtVpGCDP45W1oTTMUnMC91kYhP0GHjhCW8V38xhjHgFFBfuWMsmSQ9MvNqKXiqtUhDAkIy0PW7YSKaKUv6zctAiIk+Jt17kG6LpNVOeMvJnlVBaJSkKe0HTJJUMvf8R2zna35/yh2wNlWLzIP3BJR5aRNxkV94ICOlycI1/JYRZtzvWMNoIpQrdNvyBuBydhSwhRwPo079Xk/XQZpbhzN/KK4NbdJQV0JIMP+Y5UBIM3TTYlFGYVjcvA5yVozkimco91Fx/eo+ydgAx1gMezTh+bYxCtXPYkMoPdtaElRusxlmdSV9zgF4Np+iylun3LVxCycAFxGCFsmARf6y4I6zXY0tx81aQyalr3/ih+ZjxGNWdhItgNLdEZ/BOIJpPoAveh2bKbEFxU/M0+4xqDo3Ox8MnNn8Lmv15NJigSvJV+y2W/ZogEXNiv0/nuFzZGr0pKujOShzcdkEVlMw8mNZXZCbtM9V+mfawtLxCTvo+enFWhJcFv8LVTFycDjPGBXRQKNN+z68HJtYdpH++g5WdhQpCO+DE7Qdu6TmZgtetrpU2ZlgpslOx+4hb3aXaqbdc92LCh51er8vm1GQ9uWD9+fAPRV50ixhgc5zi2Jsg1xQVxzlaELRWJ5biyF+eCwNV0oFnTbBHr3Glm9qlGVOpoOsQC8hlNG88fxeAekkCGnHFn6i5WzyO7ShDYbZ2KM4eqndyy01v+6TFhmkxgc0dndt7EzRCcEfBxSaWZwcev6MDZcuvSZQ9CNSd4Tx25TY6UAbrhikuP1vNFfPdZhCG1pe6vx4D6Ez3zIb0zDa42FPpxWvIpEeXb7YTcfZOahSpSYaWLH/vq0F3U1KO7ZxliZpoMBBYJs91IE0bOkrPNQ/USYY0qKCO3CU+AFbOYxzKWBkIglrX34377BZ18MKQCv1KWfIHEeguSpvrNH5RQOD4LeiH2gdx1MOAKphlL41F4RpxaU4dy8xERFgqoyICQq9XmQ8WJSokwqvhQM0fLtsvyCO2PAkJ3BZg5IqoR5q/GdTLgOWPFR53Nqw9Ma5vBzZcQ4+iZgetmKg5ZIn+/7Jbi+VlViXuD9CaAUtdEmnwWTS7wZWuskVvc/SDaaKV+Jz6HrZTHo3UrAu0IZDBkXWmL+mTTjdTb1A+MdhKkY/hvFNwXj1FzUngsN58u/kTdJ3Xi0hy7efR6faAOi4SKGaiOty8lxDFkiD9wq2GW1EZEsoWGw/WzxXhWDzYY8CC7WuLFHc+x19jhH+FiLXwDIARRtnkJPF2BUPZ9+grZ3tjqAWhhN3h74w5pooRQUNATy05A9HDLnILGSCtfESoSilqtqAIQ/TV2t3KhOc+teDf5t+DqZDdB8Ob9YXyklrSO73pR0QAxPvQj57c6FIR5dOciqeHZ2LRABMROo8Jk8V6JFewCL8TCd/A5MSbXLky1cW7mXobqgeEXdFDoEydKo5oCuyn+2JYI/7pIGFAzErlHZ5hOaiT17HC3zp2HpJwsIAb4/oIoZ8x8ak43Yp83Ermq55Dg8HxKGHXbXs47sh0PzQELTGFsf5eO3lYAuJjMneoYWk8W/3tW2WLntEKBZEW4hOFgo8K58Rj0vk5KLyezu1d8SO/JcuxpOJqFUM2sxBmbQ/9qqwb90R0WulpR/Ju84bQ5/fTh7po/pbBb7AQaYNdK3fatD3K4TLHAaa66MQzp/+ZGyCjzo5OXRzJ8UHyg/YpNHvvlOpwQIOjakpLHwGV4WsLDPjEIqG23ily3LL0dlkYQxj3Xx0ApCo35zYGoGOtIclYS83MnI5TwVdQ+Hg453WFQN694DaqhGaL/dm0KncXYqXLi5polgT4DOrzD4oSVhrkh8GW2PaXjOFDCLPcn4RQj8dRGIJuV81LxMPZ0UL6zpkaebhbFBxcRJe38UiTbUPDjFWk2jBqzrBvXcKmgdDcmRyJhIpuq+3DQY464AlY42z2EM0yIK0I6b+VgpanMfpdWo7OxKY8RM5tSJv340/qD8SxrYsybMuUkF8fHj7HcvxEPC5YYrH4LW1YKg6QaeFZLvPbrHZHvi4OXLKkN8cGQO8019OKqcv6QnBlj01e7qS5evoGm53rv+VmDxxCXDiOrDg+IaPeMPrn8TJ1oReXYI3yb+4HQbikxP5TQXHk4YXPUv95+KmkxGsRgTwP71YiMpqNXp0loHZeXRp9i3euKrVtxMM0e6XAoACwNtcc6sOuhZVb1htBLudzahrDFt5GkdlwHjZl5y0LbvSHwII+qYeDwRKTTzyXaInHIM+8rc5TrjUlPRVwB5LKFpQnV8e7vLv7T7V/iJTW9h9TnRtNCSGcofBWYm5P7wZcAq3AFamEW/GMbo27ldz0plt5HI53ddWkn9IuCZY+Iy0MATUh3YenRTbVgdLYtu893SuN6EL4e9V4NhlzUjI8nOS6B99ecyC1Ot8sDahQpWHbmt2YvWGyL3S9tEVLKYs+LnghBmmSl2uPWfqPobPwBHNLW21LUjfZb7jfLMTsMp3icGO1npK/rCsUgdBVKVg0Ys+/WKuTmVJoC8Oe5h3PK1TQhbpZ2ytP9nlutQPtLAEt+CVT90DfVkn7lHLOX8AfS6HLzfHeAhu1alnl19RHKV1LI0G7RPzYgVaSpX7th9f06uo2WpxjL86i/2uzK2qj/ClHbGDyQr3F9/axmq4kJ7zZFVXVVwfiFr5bhUGVZeQJHKFAcsnqPKsb8vHyB9SpFpT9U1U7D4aS9vYgqajxhC+hOkolJV2dKAxysCkWBo3SPiPUrSQYZxOWwWCoQzbV0oeaDEcgUtqI3nq9TSmpQ688/+wb26P2CHLY1H7q5lypXSrnwnnztq/jN1o9lyvLmLyGguV0VJnDCREkiUNrZqGG06MsyA+Phd9CuFoM5M1Pyk7S6TJaHdTw0ni3n5ysAup0kyxr65lFc81NcH8xSmpp+iOEtQZrH/y01k1rGMRJAGFhi+nDecpUlnrh+qBOCMZCcSCovOPJrxjZnZJDMLdpMVu+tBSVS1nKxsYjY9Dtq1/++riVfLUVhzofIcIgQQPOqHioELxU3EpCcZMoL9laa5YlOZAMEp5apx7CphrkL+fyKbBAf8ctwVd93FTo7F5Oc/alNsCgK6lHruPROtN2RybiLqx8P5LTUZXU+Aoyz08zYHasR3U8hPDKj+6arWXR9yWdJoMn45prCSURKKy3+JHgvs2Ot6v6GbEtdCumgCttv2VNoU3KOqUwqNIWHqYm4eMijTM9VWB7umEyp7UPOI8fduHJY0W9xSCZdvc2xMjo3Zdu2o/WZKDMOSh9UmLvo45IBppD2dG++HJu8kbfFdlwuIxk2KHhgHQeNKcHhFkYGRzL2VJVMOAb0Co64wvds5CaYl9ZmBm4zuGDeaO2eI1XM4+rD/HmZyRF62SabgAe8TF43VuMutigJJMfbW2UK0azGLFbOfujnHD+GGBYmSmOQbUCOY99HYvswBQA6r9hrc2jtsUUxLVjxnZ4JnIrTwIVdWCTPtpJpvlA7m01/4tbUMyz9mv1jdN1jkiHQCJXXKg8bJ+aqW6rbwbn5yDSHBTcFXIegrhHGAjJOZI1pyP83Z3vMYTAJoo8V9IwyS+U6OVg78+IhSYHDYjRs8FrF8smHQ9h4qAYxp49rRP2d5uxLAuP72GvZaYvfeLOkMrcg0PkPuq7NsXhMFmiZa6PKBH1l+oKHI5DBLdZCvCwTPdXqmnz8gLzVRb/ixLTSdit2nrzt0x+5rDeZT+ac31NKNskQs6noKlQccyD3UxzfVZFmcbpmrfPsZD0Ve34xpKWk/E9Khn4A5yVPVq+dwnv0EyYecPqXGU7R8suTW0A6NJWweLI3iSGDlQXzMYsSWkSMhFTfyA2vTDt/3wXk+mVU6bRNkZvNnyVHYiA4tmnNwdh/RVsk/EgSerfTIf5VBmuAc2IKSeL5Nbrg3acgFj80mI8SWsc3dNAGCBLLMP89gH5UnLTKq78d9SxQH/g7DVnBh/qnBdw5CDrw/uMzcdXSxWqGIFcnQZt/1aOHxUg88MN2w+FPx/V75gy2wzEVe6G51PQIR2tZsxbv62HhgjwtlzrVREw/yzlaAiuXC26cnpvQzWXp2mOgihyPCWqq38nEadX2T7f1Y5zGxEGBaT//IcL/BsquAJX5EDbX8X1p8nLWR2yyjFRvqC/jssoCJBCDJOsZvoBfXqQSEKhNARH1YfueeKBslAwLi24/wAO1BHptlf1kQFNsOPlDvlYednrEp3a4SAz/G7LIVEsZBu0EKWZu/euB/XKdkGonP6t6lgEcCOw8mceuzvEVzyoPnMyzrqoNQXJb9C8ZCXSiedKiCgNwfNkpVlHbUgE2Rb9WFScOeEad+T+jT8XlSc8rcvkIuhAv/gxRu2eb2GonLTyokjcGF1EBpCJbhy2H3lhL0rdZIw1okA5pBg2oRfQceXTPzhuNKorTEF7t1UIgDqIo7/loxyTgbtKu29o9K9KujvCqUGyPY7upcfiZLNBVKh5uXAAZjQjhlhBp0ukmO4Avxu4xAVhCtnsOIA/tAm94U3HEuSr3wq+ZLo8pyoC9EB/q3pOzQRyCTkozmJwo1Ln/2xEbtNnS2S0NUIS3yz3/mBIdxONHxqP9FW+uoGI1F415lI1nZwK0SoPA0+flaokBGEoXgZnO4GOExU7VOjdPns59ekmDxqNhEHeAF5i5N/3W2NC1XGFjTpqLrnCECiwVkOTrLtp2ehUIaejOG6+1336YQSKMSsL4zhUjw6SQKryVRz5Ldn3R5/r8AOi02RJkQXPdvPsl/FMg96E/cJmIFLmEDzr1Gkh9G3zisG4pqM/MV6XIz+CtDUh6hmJB97VzN8jaPSS90vgDjvnaNlKky2/zIhE9ObugwrftI+Oi2a4VVaB/Mwn3VmaWjsU9NOf2usbcN/GLQMjvfeU/YvyEERPKw1leXZWWk1HXzY3P9MUq6MZq1hkEgFzds51mv8mnp1i4pQprPwY0TId1szXwe5TG+R5mMD76nGPQr7/EhQWksjsgGs7Zy5QYvMcGV5tcXJR+6hlHFIAc/M6XjkKYtwm673Bi+K1tNO9i1YBePTur4I+gMsOK7f7980mcJXhgdWdhNzUN2JvFsvXq3zZRG2V30sJtJYxj0aUv1u4/ppVHi1iHnTY3gDHsrQS8YwMX5XwZ2gcFYYe2wd7ZO9swr0gb8zf/fXx8QWKPXcK1UdJk3760B/TMlpWLCbhkqVoSTsOqzgkmFmFteCCTGhNyvFhw1RrTIWzRxq8Tj5FirvKvtkp2GAVhnZ7vnr71pyI0rKwQbVxKZuqM7GAvn2mRBj5p8djlHUsh/r/eBECptpbbjP5nFyuN4mvQLZCaxeTkDUzd/kNGLIzBFv1CElQO+xmf7Dzt1f7GM1Bh+wLDCJZlhcVDXbtPuGssdEie3lZNiWcXMTjZtWAT5MCmpq6JCRuFSHZYGKcSFZ9kOYJfEqLIcWdzpTA+Hmu+ktgSUwXVSwkaa/aHdZXh7IOyrudCBalCZpgXGRNbhN2XpEY60DXXO1Ci5ayZSoxtG0WRCC50+XtgWz7qgX5MRA5S+jzXCYy7O7Nn0ljVxiBxQNCZKZMTqi6mPfy2LZx76uyRUXHjnpJJEimflHDUxyX7fFg7iJvSrsZMH6Uv2xbfQNx5eCbx3oKycUrBY22KPmgfg/w07CDVsw6tb5VxPg5/X38cQtXI47U7MAGGjO28II12T+PjaXHlstPtkUQNn0DKkCYis+kVAkA1wyAJgYKLGnKD3nlVCarYqCkNIZbiVwO2Ydjl7N6iOtvvbAfuq7VKZLo0jEdw1YdsRaHcuJQulgb51JyELzYBkP1hd03IDcZfPg5XmNvYQSOINsCSn3BuLtkCPZRalK7+S97zxvJHiJCZJM9XP785NZ8B8fqDe/Ot0BS3PH1ptErwxBtpgfOj4d/41nrSjJQf9bV1kfdBHJxYbHILxOsWkZvoP/Z4Sl0Yx3bDjTF96xf96+6uIoQ351Ce6DeTwTnkPr20YwATlnhskWIddUohklNITCq/07zkiEc3B58uiBG6d9YAc4h/7s44FN2RG1UuZWeojrOZIhElvDP4KqHcOYbqqS95o7ilQH5ONJfy+aYiB+sPpn35HfHG3duLpNvBjXc+Klf4IKrFHjeVty02xPTNnbdL4gtkqPqMLhSgR/fDXzxJbSScqewiF1wdVoJ/fGL/nGWZfVlDHOQKD+/i/mqwXqvNqxtZeRHwoe/bodk66B9soOnZp36gdzVMRRQsQiBFf+HXjRcrRf9FsGghw3+qoN0JeeMvDJrkSBPsESDai/uVOzn2Ohge+UVdi050fdWpsjP0D/QuTdYs6QyI9xnhU8WT2+KBKzoZ7Bq8fOdKPeLulUhJjT34/EOnUloqus8+pzqNh/UdUOhgTlrbkuTfsaIYDm87u/GNIl3N53uaU8bgaBjpz0jdu1f59K4KFDtwUUeEUoeYx6DEkWKHdi7dtHhQF44lbysk7PqERrsuAQu2D5tDMl7kFoGdI8r/s8rMytJzYBU40wqeFvTl0ZVLdOB6Ya9E/f8VPbGx5MdpYqYMLMyB0QxVdnoJ+tgAQVWfH+jtOHD3PsjuT8dOTSrupuvHWRHQoGI1Qj1Hc6k+Mg84FAZ/gzl3SEzuGWZKFwuo2D3EiG95D2Z1szTqAuFRmT1nEh20tkC4ysmXx6JtN0taK1iRR62s2uNW5rSAvMEJ8yotr3UhJe22brlQn8Gvcq1I0aODaHJucQKVe6SXyfcDWODMw8xf+2C7Zx5a4Qlh7pJs550DictL4OxcDXKvVmLgVWRwb3moxv4kcxzm89EERJXCl7X/BziBkGQWOHPGF+6K5NFJYOFVv4+NyFq+OPMaSWZKoydplufY+CYyL63T8MCMmwqLTmAE8h0prhi174wnx7DHZWYuRJSYZ63uz97AGOzyI3aebclnud77znbZetbWUripe+AadLQeZPtWsF+FNiaXCy/98km137lWewyc7Gamai1Hd3Ls+KMMVh0R3NKTQ08TIClDfMKwUGKy/7YZlJHU3uW60X0r74Afh02v5MJgVOYkjmors6GAaDU7yKHydfkXYd6nEjYc76xws1LDLWCNNKBtUHNyLseOyNDgmHiJ41lXvq638RzDGis8WIniOb/pbTs+HsQVGPi6mxG+CU+oflMR6/qx3pVP+GPgqa0U0lo8MVmI1cBgSnPGgrh+J+m9TVg8nivua0EQP7xai44ruC5gsAVOp9bLsDXfHQujo6IpBmpfbbU8PDavZpTuJtmflVQuOImnRQ5kKoQz2NBFjdiHH3cF9QLgDP5vz/W5trCy22Uk+TCjXjdbCCHB3rJhKYTwiyQUf8xu6yTKtIwrbw4tzFgXDODmWYEnnpDupk3b4AP3qz4AZ2En5wi6aZV287AgCF4vH8TlWLni1E5Hd93vLxSYLBWSuj3eXGFtWyWpBkIeKu+YsBh19VeakA8OePM0ILu6dYYl9DNIK3kU1ybH+A5xYhFI/EqSX3vtNs6V5eQgxYLvu0hYFjiG+n8JzqLQVROiVa8XNQDYJtDAetPFSuEtGI3B8rnbbrNo9TJn/z3lRYq0ecBIe7a03vLESwhKOm1bGTk2kPMv/Sh9wyCOmIore7JhSFT9HIjonBfi+gcdDLfFt7dpShJmW1gkcXmitWwm1cC480CraHm/or2MHphB9Q1bmt/SBXFqXJdcv5GTt3IS2fRgqThhInCjRkh7Dk1iS2vMBLSGtRPppb4FEu762JehUMQxxLQre365CKoJGvJwVde91XQ+bDp5ZsMu/QHmLgITmwGXSpQFQlQBajqquxlwIOe2cyfezaSHIoRNLcwjW+epnmAtmmWA9KU29v/cA2iuWbj9ZV7HR4anhHkjbxnzKPHnIZ7Mm5wAf2o/3xUhnfH++quS20TdhalHgNhusidPKWyKWV8ZjFLgb1fX2r7ifLyUtxuKHHIfCWXQJ/DKeU61vxmPT34MTi2Q9r7/sK1CYuHVqMBsgtfenn31bUzCoyPN89KiO5wHveqnk3uyHnJSUBVTQQ3NyRPmeRKTQvWEBZ4QWcSgMyZF0RQgvUXRcp6KflF056fwahSioP622TdcTVYi4cAwSZLWDvfjoKFLMowPQpzn6ogXHc93fFA5NZmnwslSuesOyNI1EE3RM8kzat6thkmpOiGmm69Yn8yNuxz1YuuPWekoybkee106T9WTPXo44ea9E5QH2Ig6FZn716DBa2FyXHG1B+YfnmhbEpANlOi61BoGO4+G3WMJDokJXj9GhNsFqdaLjA1pkhLP+/mGCZoYsxNI+A+sMvWyoj+PMWeR8koRz+r9pNVEWT70WhiAkNTrojdr0sBLwxIM7D4zT+cVy96ZE+ABi9CqkM9VK7iOfkJVp7AqCqQ9EZ9emn8rB8zfoQZUBrVd6YS2AqiTFt0nJ8HfPGmnBWf3Xi5CgyWoLAmHJp/AfTdHB0+Ns5DlhL6UJ+O/6xys+CWVKtL9S8fVHkpwZZMJn6jVtiUTtXjywmiVXw9a6f/G7Qd4tZtcoS3aytxXYA9aGGmEeBobjiammhUaMDicH3nlOkDvvz19NqWOvHC2SMv7OQHtDIykYerPuoLz6SQNOBtw6oX2Sj3ZLITBDcWNx9CuZYYVaE+vleXnATrwn+PnuQ34jL52tp85aIOk684SUlQ8uyO2t+eIOHndZ3oxD+BcMAba/JVxRYUAUZoEw3D80WWOz0/ul+fYbhFnffx3PgOy2LLiu82D5FMSpi+Pd4EkIFTgfv7p/0vnX1wp0VpNzyXs/5S/4z0RFS21vIF67k1ERTfFuhLM/8fdbKognohMqTNF/+oqvXXLuJB7IHeDdn1X2eParLBEpz8y9CAN2g5VdE7EimekAOhkw+tTzqeEsgyQL4iVDnWrP/RcBd6CDm16/5t+I1SAxCn9wo8knzmpg8DYP8V/vHw8Stu7cliAt+G/VR4XPNZXWF2rZBeQO75os2jFJrbtkfhN9BzHT4HGgXTjyTy8NGsiQdeOw12GjYKCyxP+34kRHZqYsn0pFvVubB0+/emKRgiGXNRWQwMSvAB1xvTprD0Zyt08BjP/4W9HGNfNBcA0Qb9qF5hdQ4dDqpKAFLoIW2gFEVKOganw3M9/4WP9ckP0/g6kaJDRurtxNgT+PjvWYEWlFa80wKYCkd/0ZChV94njjGyg0t98Pz3AL2AFAhvRRiJwdfRcQqqhWkv/o6X45d5w1YLJOye3v7rgta7Ya0jAl/an42ng5Wz4S5we7n2+1W94JnpoGyV8WW2HYjKLkKmp4hBKlNtb5y4W1MrsG/wfq2N5Xrz2kqhdPQL/YoxgCQd6Y2KNkADVu7TxugQRWVuNL0BUj3JRFyWNeCmB74Wsz54OPnbq0GFFxzSkoiJ3Rtq8yEJMKvOMMalFKH7YFHKjb2nwrKVfuUUuRtTfJDiBuaEHHoX+MUrM2bBaAsSdnY5PjqcMBn/wwojQxzt2MoOCC3OEArr09ghhsj2M0mue5ntQcmcC1R/sK3zfShGJuazS+mJUeKxk5u36CYj8+SJCq8ZEv7bNf1+BywGeDQoTDGq6Yh1xW3Suwo2O/ykazTPK/TdVOICyiwK8MuQpK+FX3mqSPzxfLwFJ/iYDjs0WgW2kqXYgm+gkNToB5+jYH83Xlt0cbtEmkkBaVGlHz61rVuWzrK1yjn5nYHKvKCrBPPRth3AKDQQB83fdrbgIeIfB3iHya5NPpEyxbzmtN5Dnk7GqrQ4uu4h3QSoHU+74zs31cWqIx4SZ2bwWLvIxUtR6gufZhNZoMcmSB5z1O9TKvHMORD+VmuiqzsyJKA1OaApB+b9x6u9FTvUkalgl0r7raV+wRqimc2D7B1z/OiSagdd5UME2igLGUcgPlMSX1VsKQp/9yDiYei87KTBA2NPCUmgaLwVdvQFFFxWp2vGCY/KCUvxt3FOu6xIgwS4Vybvbj6feUCkrQPpO/wPHJPhAobSj/aa5YrUvjHMcQkDZwfc9mvghrk/PIPvcJa5InhVBfjh3Xr9vIvA4ac+m+pywS/EqkSX55xgiyj0TB1EE0NT3W2CPFdVD88P72SpdFzHS/6XsmbGtM8JE/m8eojzd4PM1bNADliZ+XG/9hbcKg6PftVKyKKt/8Bz4lGsHyT0VKj2vDGp/qDGBajSHrqzmpEjW5LXsb5kTV6HgbMcnPW2dzQju9N1sI/gPVlgGmk0bHKOX2Ws1q4aPizhcM/XiJ5EZNUK6bZNUeFaUJVTvGxglRUY7vdnoVOe0Raho3huh1XDeTlHpk/2gBjjhUQXe8FN5A4zcRqkNtKpSVq0xyw9j3yQlQxq/Lnqklpz8lXmzHkz8sX9HJjHwyn8UAjblvN0ZFIk4liejx0lVACoKvpsT9+pQoLY4weMHRzcuVC60DUFkaqLfclS4UJti5WK4FE3dYcc0OilX50uscLJomlR6pXriD6ELNNBWOSMt50CJjPkyt3Zn/xj1dlPVP1t6XExK+b3jMoULLPOrEGvjELfAMM1qcuBb0AijkIuFca8f8xapUlkvLjmmJW7RK94r8HaPzvmHHSqX9MXdivNI4A+JHy0VCe79UZZJvzMGzpnsj+Q6k3EItDBiA12fTMlSbEOMAWCdQq9TtyUiAaAqJozMzryEg0k+yVHqCc/DyJcCE2V4WXIhEnsOc5c8f4ChWfUaONhPPWogpDs/lyVCvp3m0NSfrAJKNiVy5aNC9gZ6c9BqwYgj/cDO3kdam6gCjhR+akALFYmt4ixHkWxKhDTGs5K+CwRiKJnvxP9dbxRPCBHbiVa8gsd2GuiNHZD98MNwXMdMC0MubVodd7dnyk3UQFfCIIL1osPxY0ZJ6DvZXwtZ2I0th6aqlTMULVo+lhSIU/5qO63lTSa3MgPRJEOi0AJ8/UlZuvgqLw9dyEDQoHTKWOsq+6fzoAyvIpv14fLaY+braPd6NkSaq0RClMenK1QLH87NZriUaeuCo6SZ7/CfUt2K6VOt0AjIK2jR0vorf6R8+TVzxZb+QdLimH9pU5tQc73xW93QRPMGy/gCK+R+YzmV4fHK52GWBEBL05EEoTY6OYG1WWji66dWnVTg0uPNw839p/yjLxkCfdTaH+v6hVUCd6HlROj6W8Mil6AYGC7NI2+qkZvJh/dAw/iQspXQNwwWHr6slLIp0hBHYTDh/J7Ba7ZR6cp3iU4bSXdmzhTahYDev4yKiIHyN64EANhI5OHYv1G4KXfIOvQizYWchPhzQg5eVGNMxsqrvWVxjtIbkKuHzE+IcA2NZ83GKz0D8z5zmgRnoJGKigseP9TmMS7BgAqtqyixA/SLc1KEUWrhXOQ6kA5ZQRazp3wwSa404cppBnfsS8EsEpbr/gXyW36cZ9pt1RhzyxGxDUmnZeBz/Uf1AP+gyLIg9x04u1fThm2w/H1ZXGvVqsO1VqutV5gUhFkdkwoCjzz3F3FUr1v0njGYT2mSZYvoF/fSd1W11c5VIhkEO06US5wYRmHVPYXmZnbK5YHQ8pkIDJ0yqssqFK34CuHE8RWb+Dr4omk779QOOcYomAMYQ9ILt2KUk2uNlahW/IjGtenuGLxb/t3aFoVz4oNwMZ7iyp4td8mdzgJAfnCcYtklubGAUB9k6bGC5DSkf5VFarnGEBWz600VGR8QywZ+jIYFZbtKT2QdDOYP6k7D8qVgEZByGmRedZRWaQDTggLyNgDD6pQwEeSs82+hTxWypqwU3zuAWqfwil+mytzVnKztyvMFJyJwPFaPr4Z3mTjyxCR2Jv674JVGGMUSWb0l+GtcYtd+NBGChwr8mB2hlyccget9liJhQEb0XgXfgVRlHlbO+jlZ9CcAew0Nw+tRcWgNnz/GL9Kur7RohRhaYZBBmQA6JhvzkazHRcdZDn0zDkfBmYP1PfQjP3d6qqx6gE7vrb3lBKEfK3Y/nCe4COdpr23oZCoIpssGXmqE8CGpO2bEwkSN6uqeqR4UtWR+xsgOzNeR49PTLJpFEAkXha5YaecJ8t/KR+eG7/HKV23zPZAMvHDC1rdxQ0l+6wlIgZbUybjBe6yusL7isRuuYYwg4+8+4lia2ox8RCdvmXlt00ZshBnAIfLkSwIqUzCcsD/d1ZG6Az728L4FCIqBKpbA6bzkJ87lYQpbaHpwPpqu3S0UqNDCwgg3q9MEn02X16E4xibz/rLx7NMDtHcwMOt9r1dVU6Hws9TvJVH7THrnSFESgN5eBy53Nq2Fdb8mySTxz5CitvVE+ZjHaYS3hq9Bax+uS7TxMIT4qJE7HGdsHM1/9uPNBylhP04Lck39JMe8v2dPOSJzyQoy8m/8Fc6h+X+5/mBVA9jAsG4vmx/KdUW+NXxgRt//SS2Ib7aGILsjOz+ZZQu/NMeuAsP1pFRTN90rqIVULbJ20ZJlrjoZD1VxHEoDFFGVWCVOT3jGK+vFD06gc3yDUSnZ7ZHjGmw4ZiAglY2nm78aUpXxI4BfUHqL6YQKFDCazUIryLi53RczlaTh0ry7WN4WpWK9sPJ0J49fu6RGUMYZd3+NrRvEdOrS5n+EJOTkr4lNzo8vawcYnR/n1Dq0rCHu5o2BGBEHABJbsFLi/mlWFO1MjpvUu6UPJjXlXse6MtBROT/mQfyegWGmFRQ7Q/O+rJp471+tQF10+bvkExfBoTQrewd5UwhAUODpyeW+aK6vx2AroUo2bGBZ/ZjcsJFfMYEMsm47LdQSq7T7peI2Ex+4/9oIAJGfhidbXA9UYPNhxigFTg83CETNYfYVkoambj3vv4MZNtE/wrIfTguBNqkQk9ebLPTmY2U4UCzbYqPKO5vjaZXeVksobDAJzhVjoU7p9TdFmNMyLyCQJryBSOcm0hFk/pcwcV15KZ/+IIqeQGPkTbiY1haWSnuQYBeyW5uSPHGtYw28cQS/v3rToNAUGVBSQ6zpBt4CHvaOfEJhuDJYZCcxvPeOStdCzaoSQn9nDe8wDc1MXrJ0+9N9TAKcS6u8ANLCLY4UfHLGf884/LFIn4OLOlRcNl7FS1IJgu1/vLm4INkgHt5ISp2vC3MFJHz1zJnopnKS1AgJtCmhJRZDaW6wis8CJ0KAJW0Yy0+kWI3lJ9N8yqJht68FMNVgkgaAGi5LuKmkZWm+ztKvf9gT8hJrXZkM/QdHI6wy9BqVeWa7g7ZM1YLbUv37YSnLmGsCrl/UVi/tG+fZbzY4bGye0zH08VQpGmyd/v++fS9EtasmbkQEIYnmLZLxO+tNHp3myIGwYBZVXjlWvrCiQcsP/Fu9l0HWmLBu3gvuJ4phtJsXXllJdM8iZIQR8Z6zEMs+cqVL7+TYhxDd0c0l4sbyIEw6N+V0v3ZbUlidyekdcz/aIomGdZtmdI+1QUrrHw7eDXT+G3zbTZMXxpEgJc4zY5bH5az8eHzwoo8QUleUKpVRrsErGmSF6GPJ2OltKYL6/C4zx4rHdcfsrQTcWBmrBWMMiFiU4NGtpYeACqYafRyu8j8x7ltp3nxVbsPO0MSoaR8tv61/q+YCqHX3h4vy4HzjCYEl+4ZDtj2+mawuj4J0rBpcDw+spzuCQ2khFbks09lPGxK8HYJl0Y/lNLUxGLZ+2h6+EFSaD22bYzF7dk/EhCWh6u/v1HUVKC/r/Wl6JHtd1V68J9zdOTgbvJuQug4r4vUV3JJolQQ5tecHKqcNoYjOIs6BZTlfB+yHGfGdxTKsGxbU/4taKuH8Qpd/M7fIG5zebrpiDHV97T4jiUNt7K64/u1e/+erXV34aOjfddcKNO76EzIf1pfD+KivBsRlzlsjj17aDPq/lnKHQCLsD+3TK021HNzhZyuwpLRKS3KE0XH/0TqUOr3VqLMcsSZM6349QJDznPG+sUqeS6wwMWp28TAoDKdmjzW6f+2au71HsOzLIeWencRa5JapKkVTYpvwMIC8u2L+/hYGJmk0588rq6Nnqe041NMzU6lj1K5KmSj0ZRiVpzu2FSTl4PBYHAuhe5dtwnRQwvvNqIELVxKMFWedxxB7UO4zpYRe2x0zH4X6pI2m4g6YdCs08vR9B7omy/goQUYbUZA+wJamq7/c0FhkNm74Mp05NSCK1Dcy1+9qp82p8XVkUB4+SsVRJ/Tqtn8v2esmemr7zjCfjLicMb05JqNoL6zzz0KaYkXeStBrF9+T7EbZTo2Fa/wS5NhJvRoZc8QUfS46HX8HIZ8A6LK8zKtROnakAnEEFoonVlvYR71xYuBAXbjtxfu/bteN8WkArB3//qp+3btpi2SIMyK6rX03iCLnzOd2OrPnD6xqgVT35e6NUMpN7EJSz0DRRzyze1J+Dx3cfx0M577W84qifD51mZG8VNbBf+5PxmGGrGOmkO+Q41YnCkx51D+X3CXsNAjaz/XfcPJUXJ00vaQyfYDtmFq4kU1ZHdnep48T4IskzPsYT9or3rd/ubiYLqeBqjnGbuNWb9ZdPDxkeBmJwYTjsTU+VugQmtz5+C3QBX0piVh3d7BK+Hk4mO3q8qJVQXeIqs4hKuRvBfIwwUyKg9W1x8dv+EwESuk2Bgs1+Zc3wzx4eGasynWs3V360wH3fKXZFTckeHZdgtzTqcQPC2hCHhSXyFMyljvrneLE+c+b/YQ0XcDBam1oAPzvKmmcgER6AqnyC32Ic4HMP4FQN2rh4Y2ntrawByV+9oq/Z8hdwQEPYRYiELBCnuGGXDQbl3ZLuUo0vfKU/AuMwYfNXmNM2vkn/GRrpc5WDP+MEL80tbJDZfDNBRfpfcvVpf75u0LrkIIjnU4adaolZWzB2yjIVwNrF7zF//n4N5xHeaGc7Vh1EYRdc0h2l23qFvLBNQ5kHbmX8Yta2Vj4DU6eBN3XyJBvJf9iL4x+hw1hx/7Ej5U8EZr/Qhgoni5r9PxBfU3fdvXICGW9DzST7GV141bvyMDXblFG5PizNjJUVAWNSxIAStz6+eDAbkYeAKTj6DIR6ysFvZAloBLCgSdMFd3ol/WXDQh3BbBtLqO9hp08BfumZjLpTJGRAIHzDizXZfhbgqejNSS27BIXQLV0muwzgXGqYt9McSvtLWo1Fos3k6Nu2qGyFftqQyDz0/bmgvtZyiFce/SLYnjt2Q9BnlmUVBWOtbDPvUgOSizvJDhdiSkbLLP96MJ7dKO3eUK2nZnpb4s4b2XGF4T6gC4qo9TDv9z2SY4Rffb/RjPs76P0YiWADpPB/nQjC2tDRlxt4sdNCIjmMsLgU+cr8cpyaMSYI9maP4HHww2jTPkGKvF6H6+DFAF+jAZKT9oi23gpZ2zavE0xXPkF7a2FTNJ3bwxvsJV+o0fXZAkmouYq6B2+6ccHhnUIeL10QtZaPoZPJB7/Xry/2Nv+JJFmQ/p2NSiO5bYGA8ej1vh5QlWhaX3JMs5gMBnyyIfXIMf4im0WEUnCPAJzq9q04Tmxzy7nGKKEf31kAp6IFk95aj0AogL7iljLVJlOXNvV7BwZn4dKfuZweSEZBqy+Mvual0TVDHiwHuIuXbvaw+OkU7aeAfck0Hc6H0jgt9g6Rxb6dAuaiKEN1cUYtD88y0b9Arq1q6ML9B20/FunTnZNF+IHgsg641FfllDFpQ+dqrIPKQ8IkLx/2ppx0ivQSrehNaf5dwtBjnPHroRGzG/RWOdiW0COPzepxIqcsWjhfmBXSUD7YCvPm/qTGcSnhcriFKew6a5s0AgK03I1gEifX6y90cJBY9REbQ7yW/XB+zAXN1XZQVEs7r+0ajtx8KvVBKJksKj5YFGdhEennMbwgCJJIMdt/pJD6FIcNVegt2LiQS70DAJeiNNG86dQVNYNZmYEfo8oa002xKLh1+rHlBX40iY8Wlv7FqswQFktpyLn5oSdo1jBRz8V3aRIOmhSnrs2wxGwGBEVEXvRm8RZVvSQ0xlKMVWs9Y7nnmJ9jEVuDL08D2ES3plzvCNP3FpKQeSknFeVBXv5T1Yk0/X5vdj1J1LYa6Ffxxrv90ObLHARkCI+tz6+0i5cZTinvgIYLMVnV/OL+m4RCsTy/+9VQPsYv6X2qSSlVdQ3KM1SOntMNUBpb4C0MsDh10xHQ0cbJK0gsR6X93ru63BDYbRZmPISt1casVwVVE7+u3l55XJGJ0Ev6S+2zpNqOAH66RuzpVskXE6X8x6wHOfp5PAI/7YG3Zozh1U27IXGEEKIm13Rt/nTE3pKWA7i1NFdVQKQ0CNdqEsBkjiuM41dd5rIbR4DMnoDva07v1esxYBGU4JWJUJQyejYbI9p7pqjrpHZUNlz2exX1lTAks+WxY6CExoPlSlNNv6AIsE0VdPmHOj4m0a8bigDelTpIL1WoePLhblmhRlkPDKiZvkzz6eG8vLeJjCGJL1+VFa4QREBVyuhcpZm1ygJm9kuQ+8v4yEMw0VO+TKee6sMFRVc/kS4IirJupnw48LoR2aRk+GuDBZ25xnKFxdSYqZqvWlEcemsbzl7wvQg5z2xKxEUsquyGziyzd/X+XFl/ct9KRLzyyb6ComIL8Wam9x6LPNZXvhO0QQZmQ8T2MFjmRJ42WyRzfyLGkJKft94uO0Yy6Fflo3AoIEon3XBygpi3Je932ToU5EKoikvqkeLFACpsBN5dseemiMdHxOJKrVJDdTS0qCcTzPCyz506oyENFdelskwdghmUnWyXK2WeJX2CBXudNUBON/i8kMdtJm52REvmGqVmxe5aricuTCGLbgZtYvigT++E7xltEh/ZgUoMP+d8vaPU/HdhZaUjsgQ8OoqZeezvNR2JFm2on+IliVyYQ/58LmZ2stgKoBbs4SllwiTpNRw7ecL2WR8bbg05aTN00C8aGWtReWSsYsirJ0K0I97flI2gJRRN717wESryWahXUAFZAdyD08j9SIZQm+wq5GkoUkK5cQ3wk1x01x4fKLPgPIj6D6lZiylqvWGtl6KxCfoSQXlNZIHeDsrIRqhINxdrCinM0iMMkveNxhqrEzhnBn8F6nXVY5zUDLzOXpp338I2HycFa2pueObEof3HQgFEMnHS3/CDKwJAyYl3HyA4X5vXUE8MMa79gYELseTf0IEUJRsfSa873vl6n29lFq+GCqF1I+mB5PSyLFvgHv6hG5Hd14PAHTKhY+xzCgOwwRZxygPwNET0UiO9ynH0p3j7GAFEs+VSjl4ArhHJbySohRLfm6B7FxxYJLJxJlQr5UdD+5Vs0nM6CehSZZNYw4FzcpYoL6nS+wGGSNKLVLXgbgvzAbT4B1J4GMS16IKMlo5S/dzM/NM4NI+a1Fuk4qwaewoHqGp78vgp+SkuhLyAVhI2Or50Id4LlHwRon9o7JT3D2pibchFvFi2VTEx6cLX/qorW2YGSSmnu9+M8teW9DIRH1TfabuDIuLk16NFz3kNr5QLPGAd0JzN2IYFA140yqfi9LfBcZI3aUK/Gt2bfMMk8eqttN8c92OmUYKUaHbB9C9cpEwaOYs49MztuGtI0VMqDDHN8HiRP55BpRIJtIWbSyi0/LOC94XhzqGVyuzaVaBfg0f++sV8wy7ytxlQYA9w1ejE0XaCkpM9zbOrymf4OrEaIyQX84Z9e6wQ1czIvOihnSaq/fcFdkxJcMzE2kWcARwWT1U80dW6B+v6HdclWMyMWLYr49iKWrhm7o1yumJKxVGiv1Rx3Tw61jrh+vuNjikpFRxa0F9G7ZWs57nuhaIeT8ZRjYzuyq4WZBEXs4CyfvmZxGcS4/G2aWon2O/UkjqrfdbBUF0yavSPdNJacaaZxFQNejGDPK7SCF82XxiahbNpwFs/t07gbCJkDUvvKjqaYv1SNJBa21RKsOuGJNKO/F6HTjc1Q5t8lqLL4e83gWTT4aubYGtE+D4e9zdPPo2R3dvG7bDrCQosp62YhTaV3B/kEQGqtzvu59fbgA6lFyGe7urhYr3TWCBFYBmrEpB78fWnXUEd1z0LSzMcWL6vuh4CJYR0tg1jX4H0wkw9mkbM07MXopLJ2Rt7/aL3Hl3MjO8h/1lqNlK74QTbgkurmgd23XflEcMhjO52Y/Wsz+CqwkBCDN8SUcd0hvJ6srikURdDKw75ZZMyms8NdzvzfsXreeCzpVaPKbkgWo0BlD+qWqaXziVa7YTSezNkCD1UBphMwE3IFwG3+Oja0AILbwR+VMjirrIkRPt+DMtp+OKLpkiE15AVv3jn19brZGZkhhAsuT2sTiWSjLvxJkMICAGdQY6CcJ1bmQsycrXCCxoxrME8B5k7aYQkl31h4kmnvmUA1Uo5bGEJkzebQNuMeVIRwKr7shM3Y3iowzuO8Jm833ALhjeDbR9i+ajGdiv5nuQcBDW0PZ0CB/GHvnmE702e3iEmWKin/StmkbfvsVh9mXnjLzZCRfht3g5Fu6OpDSsq1DSVUie4hNThGTSTWkOhTKbARv54Bxp1m/BqW0CfvfUJMQYci+HzQBrAw7lHJI8klNzq1wbwtxf0zzTFIpYQcsU3ddDWDMuciKmN+BHJ47B6FkgX4uR5QSWzLqgN2wQK1aLp2hgMJGqMII4rLK56VcDk89QQhw6cy8PCM19olNpuDwdrQFvP+77wiyyKx8Z4MVJNxV5vJWOwvF+aDouZMW5HNno5d960qcPPO89qYm6Zh6UO7MyFx272aWYtu/0+UZ6eThOP3s/uMGRarrYNGVN2bkl0VbM7ZArP2AnCQLuPoIbkry4nTS/RsIdFmPg98zeYI4R0RY41FQsBym1OXnJcHtmKPjfEXuujVQGfCPrCZsaT+vFbMFWIvUy7OxquIvdi2DVp3+q3E3NGG06d/cz77wgHGWrfcy5LJIzCMZHkk6m2QnZCXYVXwMsVhJI9nJcgG/CrU5lgDb/DlVEsXG06BHIuqVfnTyLdAQZYmJlEEk43pdgF69V12XC+sB9W5Tfm3jPwiHn/VmGszkYx+Er49CLbyk3hDBSKuzDj+nzCo77ZO40EIP4ZROdSwWlf5S8wfYcAzjNdj/aZ8uknw3tur126RfCzMA+cUo5mPaZL9cVp33X0mRTUIS2vgtwDRgsSSX5xcJUWR8gZbdeqyqQEEAeDu3+BMlrgYP2SH/le2u1yfVFn5JX9VQ04X9mmABR/KOd3rAYqR+OQwLWao9MXVS1y+0OKo0FlXuirKuPaY1BQbY3Vo05Gf/+N+u4rDcFBQqiCrYhgRAEjvVW9eNCaOsukcJWEaDuo/pWCYGJLadm4ssTCPvVVEJNBfVXAcTIxH4EFtWFMJUy5of50QNXNZBl+oRuFIkdbt04DeU6j2A3vzzP+IkMahLD6zBVJv+xRBIc5fODvnJMmJRMI8kcyMFqxpeWZAHxC68tGFNyl6yyGN95SwNYXwDSIQCPlL9bzjZaWNWvs5puiP2lbEBlDw5vCHtVmb/sD8QBgOhRassChwM5o5g4lhlD4u86wmdmVmhmEXnCyLeQJ0rRtqYIWRhg72ieDnqmPvOkDTWtKR38TeJwrK/7IRYfbNspygrU6yV9YtJyw3I3uEkDgbPrpcNUpISYvzv3beFg3ZN+swedqf3IVKkcdiAezu/KpHGHPyvX9oT6qzTS342/DenW9ctM197UfFl4rk21KxSma1KnLIWlGGasMF4+G3dxTnqBscul4CqNda6Qy8ita7HCzKlYa86yljm+HQA2B5ArJoZy4LNxeT9izFuQhEoEhUTNJQj2pCc/O44h8GpQX6XgpaAvAQJLVNq0yXGFbzb3O54XQ6sm557+lT3A+VWPyCJn1MLbsssHIdFhJcMtBFQYi0bS+exQ4Rq74xNE2CIRSzi3nj5TNy2AoO0gdyBC0/2iH67UB581jmM92OHqgD4EzAzyxDauPnlIdZu0nWwB4dtxWN+meq/faIuQpK2hoRP/ULwIJ9r3xyxtXxfFwJ3YquXldSEnxoPiYD85u0OAHvKOG6+3eBraUiOgvdfp1EjiroeSLLFutuPPV9XqhAReYPaRy87OAkV5tzSqvyfufCvOMTtkpxApWsJ9n+cNM2uBWu4lj1oDjGasCfCt6cfgCzh6UbZanbL/qCgf/iHjKYaavIiRLJrU2BuzdsP97XHkXLYbbfsHVTlXSohKOXOJ+3LiR6ix9UFLo9qieejYk+P4e5wC64jGQLSxJzYt3cErx1Rtc2+xlJaEBynLN4hLl/qOrgBM7a+yswC0Mh2OieA4SR6MfM9WK/FOWbVyoUBIUAKOhhIZp2LOgukk0/DInn7sF7dRP6Nw77MaAcYg6k0gdjQN9/1wtGVSBm+6LwkI+xfcK9l+JiWepXul+/EEdV7XXp/9lUsW4RQmIkda9H38FJj3EYJTrG4hEU9YWtNd2lKI1683cXFVzSMkh+2nuu9K0JUBoAnrYkKVZpAKF9G7y5n/KMZrP2xPuUFSOaruqriffSEX9Euj/k5dgewEyQCFTif83LhkIjt5qJ1LyI4ynIznWl1SoAdecEp+I5WmKBB2fr5yw33NX94q6HIP0jW3Np2E0r1f7fUjqdxV+iCRULU+yAwPXFvTL7HqfFLj+wCfIbOg+nsW03rGTf1haLvAZA/nC52pSDnC4f0qOiA6WtK20BldZUaA6GO3m5ZOCGyemGK4a12hM3BXnbladA/yTRV+pH7IiT/9WOijGGNXzV+K4wmdmRjU3It+QwUCRat2mGkEHhOcQY06pWeQqBGjHkWcceX8/drkk+tYysHMXVk8hLhLGjUVgivK1Ra4K+RtUcZO5fkVkWQ4W8fyo2tafhGEDSsflUH7yj8wsATBE9YpskR+r7Ac8xqdxtEAfRioGXSprjbLI2DAZZz9HAYR7rUHzvh/UPpFvrLbd/hFf7sF3RimWNpiGsQRZ11RqfZkck9IJu/FPU2DYr/HWUdskJHuLufXCvDbKn0F9sM31Hn3zIuAMTUc+tQsO9ll6jnNnW9Ulo7d32jEQMqJIrWQL5+Se0a8lKRp+XhYp4IfyUaTRC58vFEjKupeFEpU4EOp1AjeALc7vZV0ovza8QSl3ru6xFpY0/ckElMOChkhLWSDHLCKaFK/qC/SIfT50GJZnkCr5SgXZRddXq8Gc6XNjIzSdCF+9YlUFKMiri/sn1Gp/dEMhARah97GidLqitLNBlF+H8XoQmdrM3GXBSCN6izNn2ON0OzpCxOuM917OZCw2ZC0DSvNuTOFCGGYf1TYgUbgK2KKc4zm/25dz3GhVpFqs6x4yhZBbiy/6FD1vXW/aIcDiSUoIhwrUtxuGGZijb47Jz8JfUTblzx4eNPbXeYpygkQo1xXonjeouTuJvAH/zH+FK50zOLAtbN9AO6xjfX09CsjKitMVlHWmmQybLoBHBPkC5IbAZxvs3cH1VAcy2X90WL6y/0SXNsGeLBdr1OWVuYg+/wUNiR7QnP2ec7jNrZZOosT6Olwn02Dh6zSwKoDnMFLfk7lBO0p9mWjex7gEFXNfxFO19qmaoISUZEgdTuy7sHgrD/36o3XeFdzLFoFnOJa4yaENBXdTSmVZacz+5IGdVkEgjQt/TxuhNGHGtQuzNDfM4iNZ28Ly9S9WkUGMNAfDRLr4ipZkJxUA6HnlOi4Yb04/Ze8rB+HEXpDGC5Jpr4fN62LQh8o6kxknE1P5/rNmz43jehFlRUvCyNi3Y5St7lC7a2ogCt3Za6M7AshQdbVV2+R2DuuiLEJz0MLhnn/1/F2Z2U3h560PrnhR0Gc/5GW5DwO/DGrR/4PvL046BKjUp1lfrtKfE4osRTS9/oB0GrNW3cYgvhU8ld61sHhKOf4P94t4n7h9zdRXDaFv4ORPHokkY+NA9QA49RmsGMfJLu1/RXuluq0J4fsUUBoa9dL9T0yDJXvGtuoln8aYrNzoapa7E8cR73/wX6KwBPpwCUUlxsBtOj0rnca7zu5FqJC5W0U8Yt529SAI0S6nmWnS8zguQLRzf/gRLaqSQ6E9T6Q84u1cs56dzBMv2eBG+zAKw2V0x1NJX1gC8M2MYZpScdXEKPG1442UFWTEUlkM9OjbR4FurtJNV4IqEu1htlgltESO0SeZMHZ1JM7bNtYegevwPSCmW+S8uEGj7FTSSV0HbDg1rOnt4Ws8DxqN2T/HOXNd5NGboZ8VTSD6g6rLWcoWOwsyeG08GPG6KHPiLRunEdTPNmY74ObRGT1VCHP7nmBYmjnH+kqK6rDyrEoNjdqc8uG8yZrHWBXU9weqD5rpQ6S/annq7P/GiYepA2ZDdJA/GbdxpHYatPgkXt5sop564gVHZamW6cq/cdADaLCXWt1WgK7y11WaQR90YOen8BECQ56pmJbLvzzfWBhUUJP+dAEEK4o4wZv2+IBAFEdNkNF3mKntsLE5PDLA/IEiV0rziyORzLJsoxRMCQV/HlpCkXsaizcHT/vxU9iadf2hOkKehGum3973fFs7uRlqxz/oDerFL0617PqG+VYIxjeRb2IRLZJGH8vp8ITzF7U7HUg8Crs3WpVY5r8wxn8tzGvUUwY5csVu15Vmm1xcs0UL/lUCkrOXdLtlaa4pHLeQgpd/vu1ZzjMOcgzfQaIwiZK+fMZjRLAHUf83TSCOkovb3xPkD0jElmb4TBqFrwn8G4KWr+RM58qhCnlVimQ390m8YLz+fNHbBRDs7GJgHSK+v5Z9cwZq4glnR2eTjnqTy8Wo7BEg24CL/RT1AKzOIE7muo8oegzn8R6qab08LzTcbb0ippsScfjQoJhsr4jKG2pMVczpCYqptZcGD5rxTHFbL3+NDnEUptRMyARhF2FMiM7pgaB/IpAna1AHa5EPt7oBdzMGg7kOdSOpxrPXbdP3l/+QCfCLMpCsxFd3VAxA/IPVvK8JaenCYCadhyZ6rJeGxTUh11+OOAjrXIJxb/EbIy8rv6h7hywPp9ZhPCcgt9BN808JhGIaKwtL85jO5nipQyAF690xJ9A2DMuCx55TSG88fN6rqBMYDI+I+DtFmoAqJB27B/xxN9xMLnQwLcLCHOx4GIFCq3/6i7gwJePjoG/HKNb0XjhuEQmYFzTgtt/uIo1bBX4C+y1jrb+R0mRj+RyaDkRus8W4WW73qbcjpjIh2tGUY6KJyhEaKiK+LHG5euQeYZO4zXoKbZOWiJTvJNNVrWugpXkIIIE4zK/g4JKATQjtaC1qbJ6khaJHxOTS2goU5zGyjmaPKvVPrBh27E7E2iZ/6omwpBARV/9EKeU1m4Msz8Q7y3MzEF0C8VIIqAxB+Fk8qG970lhV/ZIX6CsxiHqybemqil3Qv/cWKm96fPoMJWSA1dcF03dSwSyNMdvKKBCYVYLuqr2pISKPaNRJJw2R43RNE6avh/TNA1tGJ/ilW/e4LbOvIh7cS2OsbjyXcD6WS0DYaDa+og0lSxehZQiDSt2fVdtF+DO7/cEUAM3uju47Fl17rUPkRPaheA+6/jpSYK5Nh6rSwO8Pbi1y4/L0L5SStva0NcscpH0pw/3Y9+Eqw1SDVvRn2r2d8vRC6YhQywdhKWraKGBMILqjiU2l5d3jb1tnQIwi95QiTJW7MAjJD4Plr9FGRGlM4NQyAiG8wSAKUbRCpmxE+zk9YhXjiC/Rbt983pV0VzovJW+90dH65IOb2VS+Wk+MpsRgZ86uEuxeGPyB++07HlAwqFjq0sm5Lvom/rcHSaLduJrDdabujYJRWbbY2QZptvGwTHAiaqsAafE9NQa2oq6hV8+E2YRbdEcrirxyx9JVWpti7CsFfA/egMevH0MR40/X1jQzMYbw6mr01MI833RiE3EuU79cpspC8tuN6QxFB7ExHF8yrFQ4vRniEkTgKc8kT2tC2HgNJJ+l/FwYXky6qbHj1cMtBGVOw3SFMHn5l5odYVrLqhL6R4DujKq/CEsEj742QjUogvrSb9DOh1Mm5Z7n6MI+YHii3bWp2abi25FJIiX3GM/137MQVr4wwQ5IQETnYx0CoXX1nLeqLjQ2VlOulhy58iVxN5d0Q2TEV6MPr+wA6lluGEC5890db42elDUvTbbMcjHGrT7WA4eEhNLqVT35NhLruSPkwg1UCAUz94Dj23i6dqS1MPh40Oyi0W+wfoWYXIw+siweU3qKdQM/IWLUwDjgMQuiK+CTyRgR/Cg+XmfazCLiF1JChK7C2x+ROCl4t2WjYngGRxBWRQqqrNqx1EesLx8Z8GOimBJK3Ip3O0TWp1z6fhibUBvCtBpCBH7Wz0MrsYEtW/6gd/rLbB2IcMxOrxgW5u+/ZBOjd+9Zg9SRf7ln5tqXgM7wZE2rj4u7BOezWvuyca2TpJkQOR8U/bR+LRjmN6RAS7MCfYSPtJWSbZYnQL8vGmJb39SyiYiER2Via1nlShjJEe3JgCwTOTiIQJ5h+NQeEs7qWkpIDJiQHb7VwcR7T1gLGhKAqUT5DPO5zvGPny/DOh+Lo+Xhxf5wTkF5p5yY0vM1gw2UZQ2nhCedQ+PBxACaAeuBYTyBs9aNWvYATPBLUtXJ3H/+rMIUQ3Xz5MJKdV6OhLEEK73rb9hfjPlA0gKO4j120U6VHh4AJvL3WqjaY/KCbwpCzUCADZmnJdpD4p4U5ry6/YuhcWXcVV4dFm5J8qADBWw9jPITjUtkf0lhIJkzhXLTcXQBZaaunvCCxyWh6ifYzNTTCGJcUD6DyfGam2zj4qdBy7DwBaL2S2IxicF7F2ubPDvx0+DEQVydAIF4Utn+/niyxDQpGlaaG5eRQcfYEHaZeHBOfZ8x6KnSsZnB8YZbLVBcEF3Mv/87cj4r/BYDYAaUWrrm/rWPImSVpvPlB3xQvVG305B+bCj4kIW4ZWzFnX7/nApDibPZxncAV04laDsD872g54z55DZylkUKHXF7Y5iFwsc0HDovYpJ1P+XIAb4pKZnw/e2BrTZn6jCeAAvAt6Z8EdXqS/KoRwK37xhZL7w17n2PYpqnoCtRAvnU/CocUq+el+PFEwM2GkhLBAJXvVbqxBMfPWlA8XMNY1+dfsV9Uy0C+WgSzcXw/ylN23DlELK9DPZ1nzFCvyDWygh1ABv0LXhuVuDEraYOrX0J/NpbYoxjl/mfncXN1DorfumMjOo/dWEk/OvdZ8w/66CtISpGM2htGRpT929qEz+kRM+2XpAqcSS9GOrLWVVUVIm3Ez/yIqAWm019Td/ytbE6eeYJaY+mJpelcp0h+4Y1hmcF9J6cZQEJi7foY8n1psVTCzE0QYMX+ScYxKxb/bU9eproUaSNTxHeNhomtba4y/CfLAZYXndn5ndeIjFIsRWRpwX3HwrIsKxRgd52tRs/iun5uy44w8u2wZgayiPbOTWGXUn/BDqak5EZebXbdQHyE0yEhUO5HcDnE6xlAuZFDSKLDTTZz9bWcfe1wy8KhSOwh15cBRibt+faUQgl7/5na6Nl5d1o7iUWTjOhjQa4z2Pha1PNGSn0hZFeICMKGtHJ6EGQbB+HF6+M2e8YSQjJ2cnG2SVpdzXlnkzxYqwXv0s0WM8nggSh7Viq5joXNiF3RJ0A9637p1HFJd2I7GrQ4ZTOWRi8jcZaL/25Pox9feMT7VDPV6TT++0Ri3a1aLS8IABZh2dWfxnBmXDWPdvrxmBiF3eePVqd2ZM5bI9YAN23/3qVLElDeD61xvgRdjkXkl2tqif3zsX1gGp9mzEm6suh1kWL75XC2kXlrCreiNi2pfI+iWVFJDXPd3MBNp7VSAZRp1jpt3ug1pQEM470lZXwotpDljklvGxuNeKwTuKNJw0EK74nc0d851QXL9P4pxZdM7pkmbA7IU2S2Xa/AJRP2VOz3Kyp9oW6FgoQi4noNkoHeNnprbQod8n+dQSSbMzNRZIuL/riHaxoOHkaGYwROCZwqcbK1tUnU2Qt1J+3UTvklj6wOD/d8lrZG7ucjZiCyHxK5XVtzq9lDJ4N1FvARCTUfnLeOLc5bmrtGvb8mmsr0lDDyR5607k41wzglZH1fExfmsXrEjiNLSzSKGb7FVusl07/BgeCclDsQkds2G654GVeUpX7UHaqQBEmJsIyvfxvz85+WyRaoYuQfSH9WpJLeUoXpUt7+Crnl1Jqz+eARyCmzL59OUUBwBuoQAl5VddIrfG6xvDA/RZBOV5AfwjOrJ2xRo4N42rCSFCcnOY7xfewl6tVLetiM2tGLqRLc9k/owyHriX1A9BnluzfDc5xdEUKyuwzWPG+tZGNDV0WLl1JyHPflzcBpj92G0AR0lGaMSZuKui5/LUMn69X9wPKc6FVkNEHEjHjQKPQjuFCokjN+N/6DlMscpE48IhHIa0Ghrc36GwGEiPRymXWKD/di92yfjZjDM3fdHBdwSxJRSBVKHSwh6Ey1/zWZRZ4kk+KMS8HuroIw1UPa+PDVpsSIKvmqZnZisbfHFWNW/dl9n5+wM4VIzhmrETz3k9WU3s+z84SHh2f7dGT/G5WvoisBYAgwm+pqFS0A8xyhy4PiKfgS+6TgnQD5hDEerpzgFSaMcw3yvDZ0+xfL0yznf0uY8N6APiqHdoJZOWqTPnTIbeBLc5dvFdh+mvD+sDtl8BAWzYR7QkSgnx30Ru7TH5a/g4byacurCNvG0lTgpkj9w42uqBp1zMsKr2riOCQwfCRKkuSX9CGADOYGqCHh1JUsk6RwvI9OvM9fCJoL7Sap8NUQ7mAvdB2ougA01NdqxVo8NeGta0R9C7QybiN4uAtDxw2zLTG9+0we68JkqZrj9tJilUV/f4wOLc83GfstXOVF2bAJ6zf56YworQQEDj6QnC+lqyMkGAr0QuAikm0jqS7fy9bYSBz5hekPILc94b8aUau3Kt69QI1kFEmcb19aFQA4bSegA9/hFi61RDIVQ7iOBqViYdGaK8d3zH5qWIjed0hR9e6o4zELdXWhOVOcPCmZIYYXvgUsAyGUoCszsCiTdwOaPEL2kRnYh0mNSZGb6/kr8XfbyUdbEZ7mDBYy0yTDxhkrpIoJmVutN6FHk/E4cTEolaGnv7x+QxQIKZus8IEygpdtBDxj+lC5M6HaJ313pLDYbjpCA+oYl11ISRJ/fB2oIdDBHFLefQmF1uHk7vtSmIyI7Q9HG0qxu8QRWecP8ipKR1o4bGrAhR2KcGEDE6k8r2F7N9lNUZCswXi/EXaOlPb9fdsaw1Sspku1xrmyADIImEs//XiPqI3Jl8BlrsHf1mAVCBmlqE7usMbDEpilt45ia5CXzVqlIZ95Fesu48LEATS3dyXVEjwQAqVbFBttbLfXvX4LhaGKv6P3XBsKWvqEFfq1rPYdohHtQH03ehlVMpZ/BRCBFV6dffGCrIa7OngRAbORd6wsIcR/gQSxhfrfHFmb9Ws3Pk/SikwIvAIYljNbXbvIpKTROSiPcmBDp4hxLkrjR+MfBFZLV5I4usLY6WYmjhT2kzW9XAxxLYCELLIf6lg6p/GFgpoRTm+yQ6PYtmKVvdTHyBxv28y3vTiy+reYBZqmC7x0TDasiMCcA+TxdKgDY4s61MpZyI1+RUzeMfx1qh9MBXg1tI/HSKpcUj7+qTrwp35J3ezefo6UZiEWMPBtx0/tJyaej7NUmUHVRBJfB1q0bsw4yHfui2ZOPNh/6R2/I0j09t9QGeRxpuJzB6DNbaPTOmER6WTXYEGXq7DhzkvCP247uSz6r7MfaasDs419fVF4RAt4XoxkFRmk3sjrhpNSeuDoG5RpjE4pI3rH/ESPaF6RIIJBiAbVU/ct/nKrDmBQPBYlNob0WmW07GhOvvz0m/BXTsPB8qA8Iesm6PsDuOLEEm5+jbniDFyXfndwIXHgWBB1GCyGV52MU+5iXguncQS8T+WyxaPDqCCXMjwPJxGObdF8mBkG2+SpqaBQkeN+1IL8Cbb72d3ySQUR/uO+N9v36KAiKVEPx8EERU0vfKi53JWN50+LSYqgHmF0UrnnHCNpcwfX8ezokGL4sK/rgFZlXnIqg6a8EJh7DfMOwMgTwRjjZ+TrXsj7SA6EaMRroFgxXRIOGDPYZgkadllrCosfuVZqNQwAY1cDJzuD4ocR7PgZYXbCA3g9Jd1PRx7PyRTNad56qFMVIv/9AYYd32opL/KQOuEa2LIoyMUHWsHVeJEgDnTAizkdfigKSmZVUDrztoGXA+B+9B+MYT2q5BETXJUKRLiEw3upTpXnlh7hkEk8/0D3rV1lUxxSlnDzLfFArxdnXRhBNu085RxiTwTISjItGPuj0MQknBfLTi9AeLTT9QUKRG7bxHm7P2Kei6fVAeNBP31q/OVsTuBJZfKaxLodsCxObxFdyJNLV2tAt+2SCAO5/VWcDOd7Or0wzbVGwbXJr73+/PYn3VfNQ4CSxdqgXNPWDqh9ZFVRQbSeb+bFmOpdkO7C70y6dTSHVuHlIY33/KV1QHDJ226atG4ltS4fk0ZNDrmPZ2Lps6qyMYO+Wkmsyw/ECuxfXcZ0zM7vmLjkk/LsX/XG0vaL3KZb2C51I5TVf8fBJmMxHHzKvaXDwSTGiya0f8ZZ3olqbqcd2cjXM0jicXlX0cJsaB81POyuItwEiYZwsHn4gymrnlD0mfAro2YoSC7KxDdL1DQVO+0a7fN1fLkv8ElaXx46Z8EGJ/W6akIr6uEuiFIQB9fHujgNzIzAgaDEYVITJJO5XQkyimdgaTBvra1hUbw4jb8imqVpd7G9dSoQVNPatqBlbm7NLsdI/einfpw6HdFlo9bpLb/wBxf2BGK/YWhn6LhzEvBuRuBZJTDv7HV9WfnA2SyT3HV/F6f+23aOYC8rxO7QQ1FI4/0m/OAHdCwYedzx6F6TIlSh668B+Id3ZxNP3V+Z82Tt/AHYSzDsxyYC8mxyk+Za4Q6u8y70AKpUm1NPP2WMeSHfqCc5mUcG67RR+sJWZg7P5iG4FPnFmWKv1nwwk+fM0IIA5p7xmHnj1zbj89sN0hc81tzI6enBjIyPd6P5GXzsmp9IRHKS506SAEK7IxfjQLxkNK1x+M8YAYLrD1qWXqo03kTvXgYllmtbguZX1FQGpXYjbZzgqSLxcXTKqQ/GhYqBJzZtvPaYGODBTozt0Rw6/vP+hTUJGOAYcEWWr5Mqy4792lLWmElkf2k2HiF5268DSkEL2oQl+VXl2NXgbfa8xxQoI7lpuNkURcA/pNz/go3LD+w41q4eQy20ecjCwekr0XfODump0XPUm2vvNfk4P/tAVA2PLhl21zoFOrSKjd6D1AiMtz/f41uWlBWCDDY4tDRMhyGsls4GW7P8b0/dGx6VTgC6oCCWxMyJyOgl5RPaFDE/EzGGGL9XUm5X9L3crn0DvEELm/Vx6HwlGWtnfZK7dA8/zJkr9b7PBgLeFlmXyfUBxZHF8kxgW5tcxvkEz0roS70jNLvk3QNCTUIwCHnqk5NRDEaewDCzjTR5lKzNzx1RHHJNiZZJ0lXrAsSM03iKPyYNdJfMwUAvRlKP49yIx7XS9cvseBWVvGNAc2I0PmR6Xc9KjqauqjgG/Q8i16OIPtQ2Ll3qDkunTNq2O65AEFG5qycHaB2/159N4n67iMEpyNowNdkq/ZlDxsX4dRKNvBUJaYqhID70qa2Rgq8+AzqTaJhuYrqrDDO1n/0rWggrBcFsYwo7ujJZblKGamFf+3B5MTAXNUOKn5PW91Gx56gtqTqz1dYMML1dFR/KZUZom7Wky7v9EfKnYbBseAvDuBFBFFCuXnhvWc/JS4ipUIe59Ls/kL+W5lteo1xt5bkJYfug17vGw6cqrOjTG4nQXZ+RbEDCMTf5JZ4DBcuVv+tGPyucc3B6R9NMF/lc4ubulrqcBPhRUjGBILbQ+4uBJ9eUHMAj2ijfMskRMLcV5FdgqIWhiEvxNVlZSRrzTzySfBUjZHCJQtbgDZ8nRWLwk6rQKWD5aSHuJh0vBgvlNTP+a4P7p59l0FYBPtoNpiFl/dOo05KHesQCueTxj7IB6io9sqTWxTu2PK2C3ACiXWNyxs52441hxg3eco87pSRV1NUvQeac35o3tgUpXtmtl2yHh3QO1mQ55wSqIri3PtVxJ57l0nOuyav/0ixzLEq3QlLZmLb8Y2JVlrdQMjhpcC1j0DS+VHrYIB4JgyXacVu9PCRoC5Y2+p8qfeJA3OFreaabxWxz5omyn/l55+ufQkO5e9iODCdLWl2crwLrUpaMCi8EUcVXGb3Z8oBCUdwuuohn1sivwQp1O+DaRFYXIbHQibdPfq4dU8WeiYJ4WKMlNEuQr/BRIGwOrAIM3Ppjmzvh27Lyx6xK14sUHgNy2ggNG57CBbXznFP/0NVrUQef5mMdso3AJ33SJxInqYebzcZ2pEVYHYczXE/+mcptBHb4ANtGohwQabL1xmFHav/wFH/al8TKjzGnYiFLEifJHL7OJD0x/rtzWuCrDToEWPBNtRKXFZqz/kBH6gsxzy/TUzP6R+C/A456FbGm8soK/uYyafgNmX0re6fgXeehUvtDCXdAUJElJt7AMv+VMdIrrOK7TAaHo6E8Khx1rq48yOqMqtC08so9cQh/AV760CiEtSm6PBL7JKCZBV4m7t8Gbbc4TQRawpuwTFyS/vt1JBnAQUBDPdEddlJlVAfbGy+OKkohOw9BB/JY9rDZQK1o/kpfl82umHijUnj0gVqhJCsrzUxYl+ygkRPDEPZqUIo/+AtsGplmBSxL8bUE1iBc8lCtShF2iqMC1DdHIH1DcucbSNtxOF9LY4IMng4T9eTYzDr+gnOPVxWBYMambJUexTzxyvFOneFg3r4FBEHqG3QZRgnKISYUQKv9B23A8vhFRe8uNZpBtiMtXqOQlVEbO/HzkRbqVaGj4s2XRVlhO+ewkvEaTp4pNLXG1OVF6ncxf3Fq94KmGuG29LLsFI1fuX35J0TsRNGo+TCioyTrXLVEjPztNVQL1/q5tGSrMPhfJEaQxHcrnqhVVqN1gfF+JK9Pgcud/lGa+Ig7eKQpJuUN+PYhBYQ/b6ahi4nLNe5+d8rQlfK/gl3OQ3WDGWuUMOt1YlBKoX+99JWlZr6tTAVgDF0NSHs5fqbU0euO7cXKnvVB3taBFHP6/KKZCBfGqzNo6DgZgiAELh1EYOni64dmOWUuwAQCKu+L8tnTFLlL6uKkaNtO8YGlOBVU9mQFYx4aGPgGEI/HTycxYXBClfKbmSErtcsuhalOh73FnzRz/thPjvRJcRwPtZmCHs1nYjivLMWWGprl4fRUOlrCDiwNU+9TZuaVsuCxj/4DzKfcla139igH7Z+0uskWkEq/c0mrsRLlVpl8ln0G77hwK9rLKc+RLeI6KLKy3Um5C6Of3qiKNoY/7ad3EFvdP4VICsuTMTii/bee9efmKAiym0A+l3hS7SofuEJ46In7BEO+Kf597wnd6s5mL1d5zNRBdOEmfNKyPdUuCW3u/SfFQes7nYlfV/B1DOE9p/pmgK+bx+eZdZUMu44uBGlaPvej5wxU9aumiyt/uCCZ4PyO0OYfFAMMqTaYcI8GxYeHO/3tDJsJisLleLpS/gvPLbEksIm3R4OCJ21S4P//uyzQ4EJZyYmWZjtknKJbz0vFEi0zDWnZHl4kvpMSPlVI8cEAG5r0JoNN59joEsMhUcPZ1YtIDYX9cnR711x6SQEnBGgTz6d3b1iebIdotlgqE03w87xlD0+qEykcVizaOB3Z+ocaMGWybZTIdpR4niV9mDm65EzKK8VQq59iMlABk54A7zAlMdkYNmaRuWJN+bLJ7RqEZf8vrpM0+3cwD0NctuwJJA13JIJVFlPStNIXzAW4pp1OnTx3rMZQfF+o4p92WDkF2tx1MUdC14Er9l1RlYsEYnOubj2IotL4tkgKwnE219ZsjXb8PJFkzakaWhRBJAkgbR6myiYFsJgC/lellsN9g1ML0j4HX4rwIzHbq20FDkBdfqN9SUnIbJf0QQr+QxHx4f0kRekXaqKZYUXYMbRKa6OObLPOaKGft7xFAgT2pHuSw7kdfloER91zsJPWQJbkAzyDFkkgUg80kW7n7n+WBN3CMXA3lU6QR23Ipx/98577h2OGkpcp5YiTX/TikBkcza+iwBGNBi/j+GwW8tGbKxpiSNEQqUDdqfscbVMQ+OSYGoeQKSLwREfUGDjR/emc+ZAJsy3sraTZkpHFZAI69dwO1dvsOw/Q+O/2lgghmEsk6NKzmfI+OYuOG2UoagP9Le/y9UABk4VHk54+6fW891qe1yVDT2KUc5hNeePBaQwVb5BQYPt/+2xEpqsHC4GY37hXyRSGvfwYa7DGUDbMKd8vud28h67mpOl7fe4uFRe/HOKf3TFs+9RX+QpL0+C2b4R/8VfkUQOABt4tcaDV34nU/UFXBUDvPYMYe0F24AZPIWphY9bLwt+tWvmuWwhvAgPN1rxvo3hpXvQNSPsVKgFUKENrmSCjWPYCUoQfJFpepI6oqpsVwJt6IlBFGO4soABNOS2KtnF9P7E9sSLK1WWOdGvYNhxKO5/D5ACMSM3oLy6XvjzPe57hP26DKKsIbhLZqcz8tJOcm1zlVKV87cVqDh5iOgGkNIKp7JU8eBp4VRPvv6peu3DR+ROhro3GOnpo6Cdltkq395hUi+pDXzwcONA2YjC4BKvX3JGZi77wJboSzwwPelRCe5297Gau3hHdjkNfDMaoCdfo4BX1IthlFNEHUm2nTsuiPe/rOux7FSlxIwT09NqnvyBmWQYcleqlPEreuoCZRFvXL07v84AxlxNdJM/atDmCjpmzumIoYOf4uVqV/8ZnSwV78WW0S0R7AwI0EDq4B6IaI6AUBwPrNLY0eeSw24zQ6qVAgBGW5aK79Mg+Skj4XxdPl8axMl4x6nwmnAfEBIju1ssp4yr/gdi9kl+ScGW3r5NVqJ1fXRkW9O0A6JBottvWGypQioSH2C46bepNpt5dXRK28XY0hseEnW9fDBaUMHziavWy8Q7jttulrsjOd5WunqGz20rPiwX/3fdKuQgv0g4CDqGBMamo9htCyKqN0qTOxWP5MmZG0lur+eIMwtcrfYqJujT19J3dps8mrCySt1MRdmlNIykG8cIMszw/nMlRV1DmpxNn2zf3gflXm1sXSH00EqrICj29dnyNSbIteQOqjPLqBf2QDDVVCAgcCz7vER9m5X4XkTIeB4ppqaFa2UHE05QSkAhs7FkyPf40UFGlKG8GnrdKq0ZLUk9m5jleTBwhdDsYP8HCDKRE6LS48qLHD4pvSl3XFvmH8KBEmyeyNwwJzAJQd8MqhmKsdandB6Ec1bHOw8agmVGP/vvY2C60X8AnR2r2HhdkUbclW9+ozjmxmipA1AJIZnqxg4aa1Le0RHfU2vkpf68y/rFMYgCXue7eNqxoS0NkOw9a9/WcDFJOh0Grb8zYjPgaSDENIFMCM0H5OlIqq2r2FKGkaQSMzVm87r9L7fysa4xxVMD0h7CIExLBVbCe1/r/WavK3yPhHVe3XBjyVTDOqI4/90N/Cm5KnqxFrVYOHbwMIXa3GwNwVME+38OpXvNwD6l+jN8BDCRDEjGDFC+WObTdm+5/tfm0QeEfVUYFtA7gTobiCnl8rywroMyBHNClofz+W7OhssrGuos+fRhh8kBA+Ni0fYdhKK+qCZaY0LUDpn17UUKCX6dOZccCYzSsD2iSQP74pFnhlkOzACsapdT20zbjF6ZqLgELUPT8IglaX38zP6zfdyBF+NjNf247XNtmIz4QCO5iRy/GcS8jjaWMfTxI3EbUvzrprtgRQDOz/eMnyVQVbbFiTMZfhfQLeu+j6iY0Qs/QYGFdHefwzAYuVpPhVZK/tXsy6DAioLlmNDzAu1eQ5ihCnobO+MOZtSD0+uTpiOAvPwGWf52xDUHj4zbdFtZULPV4c1TmWflDGMkg/Ia6kPHprHErwFTGoBg+1D6oX8lSPdz5srAF0RbktUTmq44+USAYYowZQOVbM3BWMc603Oy9SQD3buNTgzJ7yaMBbo/pjkzVrpW5xYH0Ra11ykiz32vo4nBg9Zvm92KHWhJm7uQJV5DMPA1JHBWBMcjz/uZupwXqjoTffeHZ17N3waXUaR7cZDs94ewlhsbQrmI7/A4zJDUZj0qKiVQhn3f3AneEhDwl6GUdCBdKY14q9n6ay58twW2PRXXPJ6UE6TUs6oqH/0xgDpP3bx/mfcCUy5oo91agCPtpTfowGZ0tyw5mIOsUqvdURDhjuWLX/WIqaPlYx3zmJ3ahTcxtC5xQgKWrQskF57LaOvwYN0lzIwz/joNYkiZwLyB7Joi0CsWWRC6SapEN5TClIisNQtNPmfwKaKYb+Hguo76RtcQMXdRZWjEJNHq8KZKeg/uWWDOW6aygLP9JDrNNW7JfWDyHPR8GL+29zBAD5FY1WZXsmYfdKU1VTLLzAHERJJGTpwKZH5k0uZrDYM8zG9WX+RVDM8bsmN8cI2wKz0Td8GEq9T4DvY6FuhMsqPGHC1tkLdxuwBYP0Lu2RvjXaxodrZhKfkkIwGcfm+lFS4WMFPCz3FwWwuvNLNqv7c85xnk3aXWl49yCW0YTzTqwyKuKWSIFJum5G8BBjvxx2yDOZMh18M2WhRGX5VA0p3eAilBsGa54P+iEat2c0lLnTrXg7fzDLJrjO/213hRmT/92zHwHShntUiR+9KUWKWRcx9OrMWfefEo/p2FR7dbNWoP/P/se7JJUfBzJixcPvTzMvSTQrccDAmpwoLnh6pnsAF37U9Cakvwb0EZzywhYhfUyAZ4oAu4R1X55yrbJifKRbLIC6NaYqZxbpzV9ec4/SFSjJKEvmVGa9tHfUJayAvrPPbVHNaxlbdJOOn7f43GTTdGGufXu/daAhuYtol2y5rFVUxlDpyKCfYRz3fOyJZEjhxizetlF5kpK8kUuEpKNWnSG9VEdmcn7Tu0/U9Pho+IZiTincXepD9zQXGusmr6j19TKRCe4dmbGmRl1cDDNABYeOKT51fHc6+d1Q9T2n1UMmkd+aiSUgNIrogqtnInezaEs7HmtmpjKttWg7ulLhPvEEnGE5TqPY3iCItPzYojGET4V755b+cNmqdG6OBTlbYjDs4AAp+ho1Iq8R/eWa0/FOyB4K5JLQ/WqwpaNPuaoufHcJMEld4peiw/7uIRZ9U4otV2lACBY2PfSUUu7vJ/iZUtvPoJmd8K/BmbnNo2iumTtQxEeARnjsHdzf1JrE1L6NGFsI7t81c5GCgmWILKM5pWDA5HO53I6aju6916JkUl1YcYyk9Hwwf/waKzGbNaeXD2d1jBd+rriDyPgR5p32kxAb41vjMM5QjUrVztISMmbVDBnx2qArnLJ6ECRGZcfK4U6LCAMxRtE+Y32MobWIYqbeJLCsaF4pCXyZjPABVmN36NRAavX8RXO80JuF2m/Snmg2NL0dSW67EVH9I4fcFSjpL73r6ohLh/V+uK3786Tpz4u9p1byZEEFVjn4eK4wBNeQ7DGhdbFbRTt6/9b55EBMfJGakrqZ4U+Fgnh2uIpidUcG+iBjHE5HMRX2ZKkKLyYQElkw/Kbj2w8OvDaxd8rzWoSUnwkiP9DB4L1FBdrrf9anTqNfPehHTBlyG9cgcQLrR8tQEZN9zuxs8BV1Zf+cIk9kSStcCODphQCbZP7NYhgTuqPh967gyo6DhJVEeM/gq2arEo3NkVtX7D7mzM4zzsjwEazeZbygY6xwP5F5NLqPJ0Hxncni2XMn/GdHQmTbQF1zee4LOhZaDlBzMZLsKXcJ3sJsBmPODcSW/FKYiVgzz7wLdz0C3bFpTwedWpIZzG+H0kpS6hOFF5yNj/xUGHEQK75qxYUFuXq2vFITPVf7aaAWUF+eBV5VbBqFcUccHNaTmGaDdRTdXTurKJ8ATxX0DHWz2qNhGP4nrYJRCKI12hvvahdfR6RlR+zca42mjybVuHEEGrU2KvnHy9+mmlQDH4jYHZKC6knkne5Q28ldgrISAF0p2u8YVTy2bGLZqUkIV6zWDXi0DuZMiQhOJwUgZQNnrjzpboxif7CaCAFdxHukA5fPTubF6aLOTWCnS/EP8ZSOIyNGpkn86BVLEgxNoCo5XDdJHdnSB0Zy+5O4NQSsoKdZzikwg0eSvXAE6j6WW27irlXjNHHxiuOY/LaFsSgXv62JfK2/O09r1DMjpxv32Y457Wd8wFBf9V6i6CdLP2Z9qNFsxcP88S7N6b5FAkZAkO78T3f4mpUVnXed/QQC1AAudBr+gg118i202+jHf4m1tBvD2iwt/8PqoAWQSajReU2kDJ91lZ9cqfgKVbzge5mUlKDSh7aeClFOoVz9UEdTQyNyjj+u7JaX9DWyqtt6955fcvBJF1aKEjjPQjYV4+FQr9Fnd8NqWavBRL91OUcILzXVselzvLQtPmmvtdhkUNi8G+O+b/qcVyHvls9lJjRGbe0YWtuq9zXA02yIjtBjoQd1vY0EmEFvb3u3xiPt9Wix6NZ7ljWQVbw229SAPrh/hsIECHTLmxKxWD3/K6TUieQeqJIfpcIoOQcgmvHDyyRUevzKImeikRzg+ly1+qSicz7hh/DCm/39Fyk6M86XNkhcEgJKANNt1matUHBPuMmqkqR0Irsee0uIofjg8efSzC4Ml6OzAV1PuydANODV+SaVqKrg8qTvT2ROpiQHqoOAq3EdFRo1QW+1ak/AYmGEVA4cF99A82GRm5mLHhLHqOSqBVNF5d+tjFko2morW+bAtWqE3Mhi2uYPJEeL+puWOoJaLV9uHtQIj2GvjqEnPiF3gSNk2kq1rb+v31DDwcalu1nsmfE1n7J39uQgliDyyoBoudkZrUtnIUrDsC6iGs/DA1YU+EpC8VYQ4iw91D0O8kJIRK0Zo3YzUzYnm6vxq+9EDAP5SWf+Eyupwlhcyq7rgfu0UcsS/cyy18bZBvpooyg1q0GNkTJ+MwtXBtDoaChHEqMdF/a7GjUgboSb8jHDJrfqRhQ/bbI62r8nHoOa6UgOaJLxxg1EhXpXmkd3Rch7uNxgpPzxP/mBdrGsygnoth1z7Q/YLYJb7LwpuGREdhP+ef4imi3CBmJrq9pWR8/s43S4uxqNYHUv9ha9RBACBhuz+S4xTQTZaCKSoDHnxC8CxGhiHczvJUTlt4rrWQpu9+AvsrR2wMvwqpTTd2ETTsO/P3JJiLBUvcs0TXCPCRY2h9Nx8ZqMz8XSEqa9ByDLoNM8PxxK/62v/Wkztb9dlxfHsl4u4UjIZo5lD7knNDevOZvFRYHhwFE22lXrX+Sffrt3y9R1DKaG/GlAPLQQX/Hetzpmce0TT69U3cFZSUWj1hcJa25OoCXx3O5jXSizjPu68eF6JRu4ly0GPmihJAcdY54LAu+PeTtHdGWaRfb6RVp9zxwP+2PoTSQm+qFhD5LkhsYuT1IwWLIAUjU9P0z7IOUj2QP4sYABt2vX5hJCVUnjOBPVGQTmwyR8LSRc2WvhlmD4DMitovW8AmruHvsuxxMnY/ybXB0f6jgvY+7tMu0sJN5r4DBEBXa37SH5PepbiAlY5L6+09qF9dbg57qZdXr+Lkj+9ODwIdoY9Ogs9QXAMPBK9sNLNDM1mFaODMVpqeBBx3+/X8BkyPofOmxl+kYJsG1PP50FDBXj0A4uVUwSXOnyDvjHd5pupMiy5DyOMVDjPDi22YVTeKKPxtGz5/wLm/x/DzHO4PBKlriUyR2fdazZ8MZwZO2yzm40RwLqezNhsNT7aqhOqWBMfTbYcyVtVzrROKLQ/cw8h9MBYgLQZ5m7RtajLhjAmwWRubbOysVY9+MbTxulvSqQymjxTj0/yGmowXOk8LorLHbyciHZbi5Wipq5e028xOnXPq0SO1Ei/BmXFCr+iw4toQwld1d5KXZJaq1eDPduqLEuVRpKA9CzB7KJsTTpdrYpMaOsIFM7Wgr9Oh/caoRAohQN6A6HSrmbUuxffYlS4ymc4W40QYfauuqpQ/JTXe2l3gW1vBU3Q0CQWi+YnGMAlM7QCe806vIrrgQmejgYb3z21bFn0KNZj8qMbtk0fubcrDYYwmBhjZezZtAK7N3MQKKCODWwtmN/WYEGctudKJzRB3xrBGIXPbh2oyOsQ4psvw2packPl36ulG2AlW5rvS3xsDrZG0jPgcLNOBZVquBKudvtx5EyYnivmLREWPn30cbkfL4RsfTwuJVSFZZJFh6UkofGq/bkz/WqbPwyDk8xppCVNz7JQstijvxEWrb40THMQJebLnzyY2q2jx2SLecaR7/0b676f5ddR3aDQqQxzS6YlPvFcYbw+8vic5SAk75H9CSsEorQCVlJSk7DU5HBRkzDnV2QtTJe9fsfqy1sQNBXqUXzv+3HDVDSjlHNPKEmNGm5+zlEP/Pa0mLR8hxOG5PeuHfsO4YAaC+btxGwKVWC9Se7tv8fBJBx1n+Kox6GyPB1SVukkNQkjh9dl8s6dR8uwRo6Ep3zrpyoDHwNvpGU0zV5/27gpveUjCyrt2ZF4TOPsS/WygLkfE2dbNXsNDXjU0kggbh+REnbrOGVNbeYAoc4ZX0aRdyTYOFzlRKaGo4MoHLkMH9FMwYlY+jItBYVbIzsByLIUmu7xM7N3q4VtOAzdBtYpwYx/5yTIIJ9yh2VZWg/uPZimDRgASUeaIeF/TU+n3NBLOkQvsf4CKuJi9s4FqpE2p0HLaw6yIcFU8mcl8Jx6XPWv+eL9Uv+Eyr1QVYQfaJcVwJ6kjFn9GSZ3uvbIxaZMwi7x+nNLp60sgdzogotqc5oVT+LDsygUDk+S361me7L2BWYFkcDER/Rx+J0tgDZ6wwKRu7kFtxCpqtt19WgsF6LzpqmDlLORvOsY68JnuZgBdo7ozFmFR6uGXxbySNeCvPKl92vkVsYEYjZ70nSsNQz9WiIy0pcd4Cjnd16gHVj3X+IIr+ZH/gTnYy0JQvVtpoQKA3yqTH8ZK5WAWFLSXjNeHCwtYmaan6uJoOWW3ktmR0n9j0uxSEniCHfobcaa4adhh6U65iKCHer9DsvpoFJxkj5jhGLhPSjJ+hLddzatV/1Ocn1CE5uZoZAMtgkhUYN5zk9+VUjJxOTjDsX8kQFan+fCSw0rK8IhXNp3dynfHXSYCNq076Pn60lpsgbLC41pl75UNjAtdkXJ0OFBP9SOFxYd/qxoACmCf2c4BNjgll3P8P77ikGQPLbKe6Bprf5RR7SLTcoLj+WEriYD+XvlnCQ6gwN09MIkc6PH+xS8JfJD7iyBoSsLx/L/1AzaxG7e0eIP2dxroERhpC6jg8arrg7XQBksDHIJZIPRhy16WjWaucMUOLtxrgBU9rezETjoCtMnBYdaOAagkVHdueRkp+p0+SRoZ4ejQaCwhOiYRYYJC7NsV73oO8dwYLioC3qILoo9B/eMud5uERJdTB+L3gaZcXObntZ43fegezhpmSwHyw4dM10xfsXF1MY5XAR1XmGR9Qz8Yrc2BSBiUUf1wSye1tGQLKtmsheBI0zWEKzJu8/tdWQ84lcWgnXo9INPwDU5XiJi0OyBQbwRH1ahR14L10g9kAYWlDK/0N3VzcgYYursjTtw/2wSHmfTGJsx5NOXmMmVliBLLHGu6G0jFBLZtUkH7EzFzorhlKhKRrLqXXlXpO8crQ3CHEcZLu9XzwCc9SvkPe94gxwonijdizLHtGfLLKLF1cdtXMFa7Mf4P/JQHiBZIRXBzCKoqPaIuvh7X4/SQdEJnxbsIECUF90ZnrLUpBjTXiX4XAc3Mse7eTXKyZp8Q3Sf1S3esZyDQl+BBER4PmbGOeQ+K1112FbEeyqQZg56WiQ0jRCUmP+Kew9A1ZxSjutLVOfkpuBwoSkP4RGNoe7WrmyTXKI6nk1Tnz0oe2Vm3PjBDf8Gwhe+fwAYSAjlPra1TtCj1uu1GcdIAm6ViQn9Srqf1ym9fPIxInLxt48mCIl6DSTi4ZJ+XkJrz2dXWQqhpSF4nNWapdIjJH+p1Opedufkw0xHlr4vORb9BCJ3W8vAPdZSqI7VxbNaaOfqhI/8w7L9horVKv7MLnEr2l2XgUM6+i5Ix58xgRlYVxa+ltEdaupD5yktPEOlldMIatEHTM9j7h7hxVvQPEbtQP6BmDdVaPz2u/o7+Aiy4lsXGE+Km2ss6828uqY4y28croxcwQBaemP2+4hEA88WmmXnQTmIMFje/i5qVzP/dynhApy5GEB55hU7+jPdveexxyrULupZB1hjyqISvKscuKXOXZUnp8dPLlTkOIlOhMu9t4Vx5PLPIDK0SdUiZ95AlS0+/1macnq6hXYYejgXigt9NePxN2PY9CC0HftH0q8httvBeLZ48ootbmSIZgK7/Wm1zqq/lUDZBL6CYC5KDyLg/WfRKIQMNyN2X432uLr/f/9AoV132hvDNWvIbdgJKmzFwnqjd8+MjwrCINW480Y/0ve7EpvtXHg4WzJv5MuILg89gjdMk86QRO9Q/YKdmb+HV6eMqRTq/oudO/E6zvH3NzGgHNz/zI4Clc1kXUMDTrnDpBI2KbWe//7iI6d1A8nhX4F+4tGki7hfsA4VOK83fdLmcdAGqQRjtItVXa3J7vhE+x0h3K+fVJpM2FZDdY7gVF9ME1rtQmyQOE+F7b6vQAUregqMnIegpxtIKRhyTvfx+DFWZLf+VUZHUO+CicH8sE+9LpldACFUpG+WMfE56X+8xIB5l+Eu4ij2kBUNYythq4o1kyIEuD1kt9XQ97gS9+waaIHokWae6jm/Y8Govgmk31Z2M0SBZAIeudbA/y6RkBys3zsWVHoPxD73jIs92cougppJ3Uxf/pQcoOw/qt20epdVJgHhT5/Rg5mNf+bvQ4LJnwSxs7VE9Qc/myZF4IFBUAom49bMTIghVW6RJ2gfXkP6ovc0THTEpxZWx4zTkARVTfH75vftaIkZptS+h3ERciwL+zFBfxojqrdRqqdkYWAVmXpf+ueckOfXPrN5b9eEwl8OJWgoXwyPM73RDn5ix09+qYTUbhIRquBAIHnO03H3q5TFdSXzP+sPDF+FV61ALiJwLttts7/NF2qhFJI57p4sixeZfoEtm0Dg5wGwPCH6tc6aqO8oe5R+IkDR8TuyFEN2w2kBdTxxvejaSoap3bQlCW4svakUIjVrpe7zCbbcGL0xSe/T3hysCfb20Xj0oFitmmY1Q+1QAbHJj3MfeeZfxuvYYoF7mLnb9sF2SPQEFrRwt08qapY0ODw4ReEM3TamVg4j3BvgKWWLIeWrMXPSM+I3hBzjUn6TbqMNWIPDWj5FBYrWBwXYB71BOpmX+5iYomjHoQ7LUcQ867QRS3qZXYnBbLy/FO2tEGfzE/rGyNxED2nvMySIIs4Fx3fZIsIZn/tCkocG9krZ5TWha4eDI3zmyCQeBMYsXlRDNsMfjEEBFh6/Qhq12c9IUp606kEY5bwbG/QnU+IAyJhlftn2f8iRL5A7v4R9oAJGU2GYjNHqZUGg2z6az4YMtQyXcV9X9WBRlaYnfVIRsmuVGDhDBIoG6C8AkCK6LdXd0NgeShgVCNpx7iacd6L5r4rVi1Gco6rCBwBfwyIJs4Fhnq8IZrURn9zhkJ2FenUPijnbIom4cDNJT3zqMfvySGt4ko2KqwoGDH25QLfuWMbcuRhuQwYKgCX9VgClxETR6DM5DNjTv7F3ysG0kI8NKZ5AZDzjJnJD4VVPwVR/fNKHpzgM8QQGSapVEbQCuiSw0xjHphp0eDxZeames1Mp9WwQ2puhmhj5ql1Lv0eYJEpN8RFa01yfNY0KZkTpYzcO/Ckhbb36k9esVXSMPl1G/K7/sR9Mcqvz7tEmdFwGaO02c6azfLxlRg6byx5y5aqHXBgH+N8X+0pGSjHsaENs0tEcJU4XtLrRLBJGIFVEe3TvIYkvc3siaU1d3xi9t7TPq1L/+hMRqojqmp8jBLyo7KEuYZeOKHFM3mUkV+XkyhiFhmwxtLgSsGMbh8fE6hCR2rTOIinlmsF74yj7IpViQkLbyCbrvDt5/yX6I7Y1abrFs7QBI3D9QnlxlwbgZHvFTKeaFKcI3NvUQFQURMimQ5M+eF6vwSlYff+7/cWpYmvPrIh9BVONzVYOe2tQdAWWT5fJSYL5Upt0L6Dl/pZObBEdo+FPC4b2+iU09eJ6vb/kc2/uq9CvCUV9KB+C/CPAJdOu7vq8wf/Yxy8081PEnm7VGsIzzoFYnDvfYTUyPhdXV2yICWljxWqkyEe4e1n+SZCRACDyiLTdzj5Dq5ThMdA+CNJhV09iM2iW1Pgf2XiLDkIpNo8ugDtNdVTMEBsO+uHzrqEI+EwMOFr2gevD8TkmyjvrYH9Bw6rkARUFwc7DRpOCIaACn2Edjv7bmiS3MFeVgdj1y0Rv+v1DYqY6EwHst3CNlpq6XBW7Q/fu+F1R20aHUR5Z1LIZ7wvY0E/w99bKzAyUjG7671ZUYF6F5+Ynv4Cm0twLZ+GTrBp8VL/LMeq8XYgzYldrklMglyWJS7iWBhdA5GraO3m3rO2AorN4N62bHcpIhG8kbvIkybnRVTEWt5a5f7iIYJN61OO1gLp+lMKa9CuaUR/y9eoF3/jHgqh6iPSadglFYQ/GTsLkzIXMTFtBelXwJHtvmQtoXItuOsLGvL2IK/M295YD8SaNfSND8zTfgUXGYQRyrzsPYC1cxWOto+YkW9R3EinZBFUy/5HWXF6WeqLcPADGeJH3U642mjV9hMqA/GY+7DcN2bpls25VizlGv+FyH0qhDmmd0gUS8y90rDX+Xk6y6McJ6S7gM/DYcoTHv/2NeKg4rjMw8TqrlL9LBcLKWQxtuJxVX7ObKDCs6fNlfUj6iRrGPFdJD+ziFknCJKgixZ5RJQEQZi2MefRmUYi5crYu3Oh50a5Jf+upvNzFAo7KhxO8WRvoqnLO0wvvdcPsaVUOIcvfZoUierdTyFyoxwnJI91KCBroEodybtBGshuLseewOL8RJP+H2Oqsca/SYdeeRtivXY+FFQeTQ33eeX3DdtS0+wgHXVCCQk/CkG/az4aY+ExO9eyJRmpeKAXose57USPZEoRKo6m3uIY0rsGhjw0xAS7X1DuBTFVuo29v3dChgu70cPjpl5/xQmrPdA36PXNZRWOszr9FtTYYxG7dHUooremnYo1QnUGWsN/xygLq9TDGLLhVH/pc4pD+15uGiALFzU4PINmfD25G8LAsJea1dQlpC1s7rkYJUQqIwFNDY4Eh0dawLn8fCol/rhUCEbEHM1dJlCBpXxKfm7zt/ZpsbXgy68nEkEoLjs9rk0E9GFFZoYLZv/4qZR7nl7qBbeALu0FWvdWoNb4hCvlkME+i5nbMafn9uVxxXlpXBlOxHA7IKvKJLMXQanWkuK9A+2VI1JSDoY06+R0/g5TPJIHfO3roljfhM9ncx6Qrk66xY1H0+2UgF+oQgm28A27u9+T4rGo0sT6suA8Jdwthg1T9gojZro33dFb5pubkZ5ZHchLzsKkibaR3DHxf769V4iImNuKKrpgMMK8vcvF4YgFx9Asca63MVyNPtp5+zXPASns3bwdmsxnn1S54GTdkB4DwX4L7JXMnQGqIaS+mPgWxbIZbFcDNIrMilEIEGFczfvcACtmReTyzqnpITyfsh5QK4RKX9ZWtvUy4bWXjsLYbNV7MrrZsT82c9cmf4f8I0sSYqVIlcUYgI782imxBuEKs3OWcogWDmwlr9TGLtVSSTlyzHUW4PU9f7Wv06gLioBSoAf5esTj3FD9kKtTKQZfTKEIOcCYWcfIk4IkcfoFGKSLqsHhBpBOTfEJ6dxkBJXCSlknDrb8XJYO4/96XFd4ThAg4/Heg3u5p1kP3QG2yMuUrty2cFQaT3cWMABIB2diEu/1KfFFSKbfjTp8aUhb99C/ZA5m7h8JWsGwT5Ml9Uhw6CmNHyRA15TyVwIsOH0I1tFeVqQaoqT7wGjyqrJ9bI+WtpjMv5CAGQfj+k2aPOJZ/zLvxAtkd/Bzh9BZPEwVE0I0DI82uWK72P5+mHKig5zbXYrQE5bSNA9/gHvSND2qLV3hLPnoJp5q/NeZX7mhb2aWf7qkF8iM4HEHQ6YiYA+E+kPmfMGabHq62QBi8sSJ3yb68iTcA4YT6f+gJb6G3adGkY9eeu7XQZiQEi2fXRSKUOj/zLkyh4R3hOAX6xhT1yCvCHT2Jb9tAzSMxe0RFbM3g6b/VHgP8nyZkt45j1ZYBTwOpQIaFU7nU5focNbiclNOds9b6I+FOnBXwyAf1ViJPMKBBofmR8wg+77g5o3CiYUzQ+KdNxUo14XQc58/GKrIq3XSIefM9azql5sX7KlTsU8DGT1HlHIYnd10cJYsAEHoN0mLKcHTySHsjTFesKWsmK+siZFXhlavE6F44mweXOrX6FBoELRrvIrsst4OH+O47VaML4CK/cNrjlTodfRr3u2XZsHCcw9kXLGX/15sm10DYmP3G3387x7LDyVoplrs0pzIvfcy41eb2Ob/wM6tQNLxQKnfSbL0eyYL+RWR09qeHT/lWpCFvcISYlmdF/jMaIWDyxE/LA1tguYOSiQtSqHfgqHr1n/k5nFhnUBnU1J1eys/8qySmWwIplgfD3uNcFHlg6trf2B11Om/f7E9onO53sWHhas4nNuhBJsUn2OjOnOAFZi2dcAvexHytVxIdybjHcEdXUcp0jkab19hwZ0RddTUGjtyulBmpbfGD+4d+oynTEjmMlYS/pfoCyhEk9XbgbBf7wtFs5qleFrCmB0NrUYZLxmw+2wFqYEUy2hYP3ZxY8uhRZeFXZfhOD58zGBx7lo4yMjiBc0zvOGqVQm8d4tk1CRpyGJOGJWVU4EpHPxqgMP6hV7f0IxJugziIEJHavrZauRXe0/THYEOKpl/a4jm/fah+oAzHRBqwetjJBSjNp5LaZ3ZUNQElZJBDOF1e4muumSHF6da394Cvppq45QN1B2wYBfbx4Y9fnq5b+heTNTCmP9XhMQGniDhmdhGzfPUY5YPvTUhEcaaA2ucNDUO/xvaUVhXDIodrM/05R31bnFkjUjn34N7Aiuagl9VB9SjYsu83Ws9eoevaZVwZMC4uiZko2GtNzZCyMHRq6GKhvEGBiM1gLyvMZk3eR2dGcn19YX72JnDBY6RWncG7lGAg0YZR9lyoCyQ13gtnyBi05gPlO9yOeIYGqQrhgRpR+pAvx4czdaBMpVI7SgZMAhMSsdPUEQ9stTtwSabBmrln0uHsOMhDvi0bNRUWUmqnu3eiLgzk2XKGyTaHCe59vZZcmDkk8aOO6pTw5H+DWALBPMcCOmfIz4cF9E5zesXbQkQNDFk7vlnAcetbpid+Ce9MnTb3Clhv0lL7lyusJYCpLpalVXmQ67YNR+IIDh9vW7XeWnU3FFfdnO0yqCON1josSLVMTTaH/T3Q7Y+gOUofDwwXaGyGRB+4GRC2kk7zANlgd7PmE5kXda4IpmTbP2OqUJ/O9EXW4aslQR5PtYy3tNMamtk4Lwzb6WIFll7MVBneG5vPfEGslblvK4unzLLIvceI6WxhiZNc/nr10k9nn8ikKPz5jmA9oC+lWIE8QR4XYTcO6WZ7VMORykmWLBbTE1NQc8/TBpYSaYjlsyOK50EEwZC6/hyMiltFDU/OcVfSs/4s0Rk68qJkU5mIFxzQcySQSzLKmqQzkbb2ZlC8MLMP8Tt/ui2UK3r3IoyOWjDNfAV+2/iYAbaU/gcEuC9PqZbBCpHpobrsMSJpIpAbdk+lZArMaQfdQP2kY9Krk6TsjNb/ad7Ghc/HTlJyxRISEoijGyuLhUJB5Ch35PrR1oibmRE3vvhC5cWj/AFFMlliT5ELHoj9ieMLEG0BOkVRUXKuv2bfaF8AdXORnzTtMfXYqB8UVY5TvybX4Mkg9YXaiDDrp7KV8wVHpmx3MIlmRkznG4Q7DbYNTZBEi2yxQfQW37NrAOyCP8AXP/EHi/BLLFg/ip1tleZLojlnpdzKgSmJyi4IRDWNifCtFxTRjzh2z9DNa3KUZLZnixrksQWHwp2gRkmuu7HYPHYIQrdjih0WnNb7CL7hFDLjbfGaVLQh5Fu7SHtZTqDYzgY4QnM/x2PC8v6+qmCAMbOvWxZOIxjgpUF1ud2/e41K1bJAXPTZ0ctJLsigJDqNH6fNsXGGXNx7cwJPgP6INK3Qxc3ylfv0L1e9m37k+CqkJJTN6MvvQuae8WjO1l0JvBh6yHIrZgf/Bt/DNS1QULgHfUCLdwH6GVXxn8JChzrTEJL4dTZGD6nCwPWD+eeU/jxNc/wph/HYngIZcSTOnA7ZoHemc7pUYXx0Nr45Sbce9CyAvFnCzoIYbXxoDXYVwt/7sf509VEfvoLzjbFrRKr4vntb5dgeDiwRX6neO0yQZsOSoVjVvOOSAuP4PT+ezKgOTL5CMeBFh5fTyCTneXHNexLrs1pBpLHH3kmt/Gi6938ByjJyGR1wM7/rvRQQoS1drQjQ0vefqIJKlavxUAyi0PuILAyGGfaeCzz00DKjY1cowpRuwwf7rYPEZOByjttnqj6EUZ84F5gZp+4HJmTpMjNq0q/lyKFhwHKG0wkVp5h+gESx82VKGR+mbao8YOh23JnEy+eNJ45yos7d1gFc6GC67dt+OzE5TpAYicEpe2YtuuIHNt0hQpdLBdS8eqx9D9RSrya3h16jYIp9Ogfv58USTrQa6bOJgC6Fuw3VSohoUOQpQ/XY+PVKw2eV8Q1N6yxzymT6QIiLizm3kcA+jtFVJVj/IlTTGr7Tj6P8fQmh0ag3AJfRbLs8nmEQ1QHGUtaUv9djTgKNG5hVLyiujHLL77tNlHcYLwqquU6Z2V+WMoDwfBiMDqK39/tNhs7dXQhQTHYkold5VgNmV+WJr8ETyoKTHTS8g1RZL+KCbZw1LZoGTgR6eNleq+XGRggG9pbw1+WcW0jzJpvQle+pDWTA3yPaJogeuohg7EijR/48Se6kjwNpGStelAHWNOtzrfgmNxtH9r1eSRWLz79nRNF5th43Vy+rZ9FcwK7PlfJojQmk6yDIgDVpS2IJtFflHkl2pdrA/ZK4Grks9dfURGUNk54HimplKaYEZX5dE2M9W/60vxTLBE6XeIZ01h4YiHBHGMX+eAHZAHpSk2dFZUbQL/ylbq8VdzyOCnwzB532xAsz2XqmJFNJCZ6YuvEpyZtLa07GuhPki8MeZUI63KN4jC30SSX7/bWpsMyfpqrzmMI+cCYlmRUB0Mu4kG/untuIlFzWG2JnuSThOvNB87WuxDF4K9MPLtApA2nPV+2yMqZtQu/5eBgMzg8/6FBhddJz3kV0onK4Jbo71w6dhI4czF3ksh7/wVe0vAH8B/pVGb1v7xscPIhg6KL+hvTtq6g1+kCPpBURUhkj6yrfPgZ3/Xtc22MaQJp0ouI8smF0IW7P8ZfkCNRlxyoz5rOlXJ2YoBYf+hZJACLpIW6Ecg7s2fptIWtvuAgGvGV7dSNLkYv17ghjkJQx6tLucnApd6V56PAKNj/7Yyi6MOC9uwvXC4HnQSolMT49c6/5ZRIfWauOyw+arQBxET3gqjgZPldHDuhPDdYxffuJ1ityuwa75OUwVzCfQ3DhhKAfuieBFYqqN1i5usxjNFwKad4V39gjt2wLjcS1yX59qz0LCyVW9KbSYU9A28hy5DC7hdtdQxRU9PX4vfg8R4KZzpT7OhJe4Rwnuob88KsYJT3Xdb5uQj/iI2b9k+IAL2RazReg2nxwi3ia771jH8mWcStAs1NJu+cMgx6oarFqLe8b1HSRxQ7za0WtQhVKdhOSo+l5MyUbO7l4rtMf8vOidRDYSBoESyiDirZR/lirb7mNwOHR9B00U3KDHjR+/6/p0FjHCVpWNOzJcWfIRQkZ6XmbdXoGNbYi+/6K31kVQSpEiFHlf0XTAzQKDh03BJv6aoldSXInQfAEINY34mN7TGvaILI1iq1F8qQD9LdUyM1y1GkmIcoViAyaqPmTF6srtanuyTM4L1D0wyuj0tEVAfuycGdwEON4fnsCqlt5T6S1obgnUutprS4s5WpzQgzd4U9TRXJErli2+o2bS7A/uISBZhgh/679K/zLda6gWtuZwAvTGNdCbAN9uwZti3Hk9kKWrIq/zDHz00+fSYLcc5sgjgY5sWd/F9nGirgGojICMTxUzGmVVyjsC+0iZ7i++UKuLA2KCekIgylXj+DAZVKUFgBgXYW5+1bwyASMUltB5MhCcaMuivyyhZw3MJ7OjjmJyH+sH7zwWOwFaztw+KQpl6ETunGZ4wgXDkkep9RDpXHKdERy5R1KfOfi61l4kXklOVi+UvIPbGuKxTqSuKxjgg5aUU0X3V/EKdOugbYyeYKlYTyfe6Py6u2Z+A0k4k2giHiUVqkoC8MKxTXxmChSs68WryAMhUxyo84ORdwTONcLdmrVJbnyH+ugmyyx9iKEPADsMijuo2U3uJDa7Wnfr9gcycQq006VxIwrhk0FV/BDjqzquNOsEJXdrimGw0G+JVU4/5BNk+lE5kSCYz9cOOfNBtbtPUoVHnu1jfPwwGlaTc7GUxPcDFnEgwaHh5znVnSwPAAdXz5o6vI34Epz0NKfx11wmUjfW8nTAn60/CwPV4XjHM2yzXbq/EA9hUimpPyH+gMWQc8fiEpaTtk7l1iADxvDO8EMdlaQ0nXdXnhCuCrsoC+Uvlb9IaXpTbhDyzTzYYUPRsJ1khYU6+UMPk1YHn7mE5V3/F28Yia/wrwDdF+R6TmVzsqudzix7NyUGk46wXs0WaHIURcZDicGiV7SEhoVNTU0zgBoaSd49LNnCcmSgWRMUa0JKdpcVnfovdDcIyEcqOXD4VeP1baW1O5XKi8DuZzNuEL/drafxlkHz2RIla0Jp8ILNn7S3fdeg9UhAx9q0+SKtkZq2KsJrdjjyAjr3GfTjVIDAz98414NxYOtS7EWs2ZaFK7+4WBYoC5Hkeq4b/TVXen2W5sxGUXGVbea0PfIOieEzqtacY9iZH8JBwrLvaO9mQx8S8Xs1qoQA5mRuhLUFIcDGMj1wJK/K+vclB5Bl071Plrpq5+L4WJ77f/haemR3QBDVN+DYo/NMMFkqokI7b1nRwuzDmI5dEx4XMlGANd6UtZZVQ12+CHjwiLfAM9yPWaei6wRjGbxBRZUWxyt/lA3BanlqVbrdSdMBG5p3j4Pa9sSfYjUr77zB9h2qpnC6V8u1+XFmGBTP3y97KCCHykGfB6mbCNng2OYcDfFxSp12MaqtqOwry+xB9gUkHlnfW9DENAGqcYOxFOWwZHAJEeIuPuyLr3pc8euQGkJA6K1rmHJDoeAl370hmHY+Wk02WBNr6bOj8owlbEPXZobBQ/xU4JVN9l2GH0nnIedokXyCvBiq+jOf90wECFhhyXgaKiOos+J5t5i72+cySCooSeyr88ULT2mwUuMCLDw9Pty72PByiEtatpiqNeZF8Kladg4jD+8iY+w8ru/PveAVmrABMft/YevFyzmyB1LNidUz8yrnolKmitwK2bPJrQzSfyMg7RCZtnj801QmxB2Hh1RdODJ04NYCR84mkyeVmLrySQsPfWBiZawIPusj3W803YTrCIFZh55a7RhYSAh5uolGsv0TMC+pfZ8CJFMfhrjIkPX4iPlpoVij0m+1EDPaObMhssohxiQLjAb8un88eH/6Z8SnJxoDDY9JjIkM28xe9G9BMqE8CdRizNqXF+yzFoq+i0JXmGCunk6mGwVz7dw0Aht2yZLXL1jgrrUpP84ikBVljLiJmABWcOUt5aq4e2FLPP4IYwNw6/6kBGhUw92jqGvzzSz2IXFoSGkFThCZ6Hdi95k3hbTR+UyOtNXxKf3qOHtoG1+tO5u2H6XvCe4OZ0IsSdV2C22f4X0XRjnoLI9dkAJcmaPzyLbgrWgj/dizWHsrNz5PzGCCZ7zywhZMyk6RrEJ5ucZ5k4Fosm8+U94ZyJFHYaHthMhJSLgoHd9plpggxNFeaBMx2BdSg8d0qM1P9s3xHTr7n+uvFsfU5qJafAkyfAi/gC+OLxCw0uMl/XJ+id3bpdG4VxQwyKvZaxCWrPaRHIy9KcdR43jv9jfykGUTzB9KjyF1G0SkyMHMeY5wgAmcEp9B8ffD92GR4FQExXAD/Rm70xyf9mrg0HowJ+Y5o1trz3gJx6Em+pGPt0PvCVSXsmyA7BLMqIiL8iKyvmFzR0O7FJPoUD5dZJ1eKn4tDUJJ4Umb72XTHqR1qs8KsHPpu1Bas2jM6FoTMyoX5aScTz2RVJH0xso6SkxxuMBg3uUblz4fj83SnK1GADX8ZJtrY6l5lrbF1/ZuSi1BShVAdFnfBB3Sh1SW4KQz2mL+Y4svWwspzeGp4W6pTFKdMDjOxHzkJHkAfLjLjqf+T1Axa9og+Cl7gRTi70bSWjsQM9F19HqH1IdJOoerLMQTLpuVpFU//G6/hsxG6sFsnzMJ7n73SbIizBrcriqJQot6sKe+uP1gONUVuBIPlDJA49atkvafSdkS4NR+zciAFrwoHjdIsVSJKqDxAVrM15uFJb4cUI1Z5j3Wgo4gLqLZDMdNtYKJ1P7oBTGSBKZGTqguAYXj9FtcQ4sSbuwAvEKj0iSHfGzNYpAzMhIVEl+O5tVLe4s/3uEd9Gsrl6bogS5HKQwX3XK8Vnj7lf+5qIQiTSzRnfkEpdxxgU0LAZG7OSxjiHkVD2gFaZ1GjKhIedce7dFUwac8qA8Ut250wwH7O4rKHFECWEhhPfyyNNFFWeFrcIjCB9QkpXuz0U80DXFirexggv6bCvxlzrpYL2A02HykHogeIIum14ATyzZnKSfKNZqYUHkFr6qN2/mPO1WK01C9CpwXcl3fLEficn+qMiFNH5a/JFJBAF2ZZWJ5EP8mGzPCF9CDlr0z0YHruP+6bAUG47CNw5yDdR0WDTjq/DqDE8W+/fc6iTB4r9945YbHjR76ZqoOFAkp3KnRniRLdWK5iKvLCCH/Jf9vzHnX4LfdHlAiEucOADd6aaTJnMDTB0DnLoW9pvA/TvJPoH2GYOwUyBgDkGv7VLqRPzjz9nIWylnnWqIlm7L9YRAuucHIleKaTQCeUrXP0Wnyp2nmBxzeDiVOPsap6l6MYLHO4xg8HBAK3J1dgvBpIjcYDKZexJV5mf8c0hpw5ODKTwdkKCeeTezcPXh/9nI/FlRcIYy8sH3nKCQ0EEucVi+uinLNXGTmZXSuB5jYC2k1R6X8FYDLSs7G3qg+Wa30/SZZVsN+vbIWPDRqs9HMz/V2eXRrxClGwzMRZTnpwuqrD1GTjLUluOf9uPygJGxe+/EB6Ak5UCCsCWe2GLD5iZX8ywqGyaP9CGKOOsQ504tSVjAMPPpKo7Ex8LT3xYdh4QReijfasLvMKd8/bu689y+WY+S8IO9LXV7KYzmOOycnb7imsjeiBPCZgNd2Hd2fLIQOaLorPkKjFZcGRaNO6lp+pBPTMvw9QIbYuQZBlhu48VmV3i/3Y0m71BChUWR3cdNSS4D96YC5J0Y7ZFqMHBW6G9p9pf1EMvsoq2dzX2wSvNYXqdP47zyePLrk+nreb97cBNao7U34lHDXeFQ+HqT8XvcE26g42SyQZmHFRlH2UZ0kohpcgm7Li2wAo0IHMre/0XfRV0HtarB6og11KC3Z7/RUcqKzEPA7ZEJQgZNgBZE02MFT702HN67p516Nvqkm0Gjx83wQdQMeqxlml8LDK0V5SdTdnatEK7C+bhiQ3CLRBupVuTeGYhJY/BbrqiE1SY1vdXZ2SFuvNbcrI6ErGJV8/qH1acDEtu58Cm9IYXlR4R//8FS+sjKjiIPcuzVQ+9bV25MODrRYTzxFJYbLhp2Um/HKOncgLdKHj7tOrMZfxR6CrV1qRAGh+vD5dMMDkqvh3RtFI8M/B+95gOm4879zLjARkfVycAOqjJdoBfgWjWNsJnafTkmc7B3nIQv/Doeol9zaGW/DlpeEHHLSCVAFpPcoRFbXqIB0NIfCnsKcK8GmaNVe1S1WmDjR9kV2WjYdDpu3d+gX3edjZ363f9jQEbUhFXtuRXOQv+gmYCubqBrqUoagUdP7xj0HIFEZg93/KZ2CrZfN9t0A6WcpUJBI5WLyoLnqf11jJxzi7XP7icTGifXh8HPdPwOvmb7A1BFcfY2H1yrgpQ9LL1WPc8f4dqfuE91BNq8DtcEql3/06rGk4gsNyWI77GnH9IKwUsAFlrpUmA3zzUPojorig8/2Cbd3TjsCKM9wxliCLyKPngKsM1KFkqM6bMFtyxYYrU2eewcxYM6RkLIzuCbt2tjjkrWkSVoIS5lGaeH9ACsgsCD8uBJTg2FG+jOXwTTSCvGIWOiSPmrIKKcqEISVvUcMWhHEeUKjXTMdtBmPl8s4WipwTYa2j7rmaa0RNf7IXAOT77NGep/q0h0KdWRo5UPERTufgAqHgtum1dZEPq6OH8ILA+nokd8MXPhCko+zgkNqNlrLQew5ugiVBI+TSaF0+Nh/0lIpsCoBQWlDacVD+Vx3x3aSXTbkp6URafBo7r4W0YMJYL0MnwFM5mzSBvH459mHAZ0yzT09dEXgjVW9/ggg2LxRO6yGo5FTpGQS5EwMSjG3crtd3U4X4CO+KX5W46TC5B/X/DpEipFhWLaE6rpYO0r44KwsS9Ge9H2dfFY3QNvXA1sWHN6WR25HgQ091u/FmxcmTXpvXerH0b5xRi1MwmGmrK4ZAT1TapoD8+smzXuW4xfFWkVDOL7zk9xNtB53A3+dJrIzc5OTB601UXSFtQkX3hWaSnhB0fIWaxp9w7vGQDYtDAeTTDigrLMhVNfLUpJcIxhrMjO0Amicb+Ubauev6gApJbByzVQRTWq047GGRSYgxukHnlk5+xWTYTi31cQQCJ9ILZRJ3tV05M1AIgNeeDW2H8IBJqkzSl9nnKSajGYOD7eMyjHHWbG4SEV8CvAH8Iew6SodPSlX4spOyb4O8XdYQ2bne98jMMolgBIbc8j1VfPhmdPcqVcmf5qMjZcC2VzGSMF9s4863hYPVGq86Huy5cmg6zBz+qDU3yje9vmEr3yJ6kZhF5z8UdlkJdjq/581O9VuCR2B3lyEAfQoUZot9HdVILawreyRxAy11JlpE3UoO/fi5/5omkUs0A7Gvb5+bsteFVIW+9l+qR2dINow47smAidv0bLLEr/yqKcUanjvixyzAQCM5CVzq0r7rDR9M7wjLxBq9eBWRVmyK9TfSJqXHjL8T3l8phqzWGZrkRC5oiPO6C5Wf59fFDP+ituUaiEqytebX0Feyu7U5Leql5gBMTdDPsmK7KUOyA5TuWxjGc7dN7kJKEYpro0VWRhjMArMIGbutu6vN2OSHb6nvd508S4Q34uCRKu96bSAD7YHASNVhzXv8N8jroYf5Y7E9s4wTpkvo3BZkkWqpF0M1vka3jjUC/JuZvw9V8avX+D9bciICl12vr/bQJxDe+TN9MQwDJwOe5HRWZKtCtH/1/2brHVDE381FF3JIILjZf20UTFL4MLwmZtFv3M88Bv1x6hEyoaAlZ5p5QEWzlw8bJBt8orARhiododtduYtJBSF7octT9JzbeKdozaif0LBWL/u9RjbeVNLZ8UV44Ye6Sz56Vn8QlwftWL01WoPryii3ZZ930Zx6Ins/HGvGQmHAD+2qvuKQAs8Y6ublb+Dvhp3Y2NNMjsuzOvb6m4YtkPzbhlctKadex8tBQuo0zhmSxfDIZm5VnEDdG2vZ6kcykYFxgAz3wrkVyXQnwxyQIeYMIHQYT+257jBWD0yJIiC3PqmohMzTC/65XVgSsowG2kgnlR7pYY18nBQ8aVfJ64D79rH2pymM4xMU1Zk/OS14XiDcldhO0c0RhQxiPSY72XYxpiaKVYmzOcEvI1PzQa7+LVZ6pBIwn8ffWvhqa38b3IskTs4RBkYs9i+i9/AqdAQg2IOeWv2fuo5tEcFyefI9nATJXQchbBEQO2Cj3kaBe2X+81o97B22kYSwjOkgZybf53qZFQ6p/N0dL/VnuL1cYTGi8k6rMpkKGx4j+Mc/fcHUVNXTKhyO10FkvHiN+qSbJGepJ/aLXoLZ8RET0Bshv/4hAQgzeS7yl0n74cedqdnmAeHmQ2CyXvMM0MWpEvA2ezZIKU+WvUSaGpTt1kvMloerqnqxHLfT01Yh2n3iD29EWnrQsyjedi1I5SUgvQKBM9G+oAai15cO1con2QFz3UK7w7ZgzM+vPmbk2QqR87fzlbdTSAhrLXzqVfLnWBA/4+5aC+0BRMZ6iX9lH3QXtKU9D01K3HprdilL456y5lsl38VQaMbz9hk0LgquziMY01Znz2WE4ClHG9cF/e7stVmn89oNFUE9NZ1RAc97KzDEWHLoKwlCG6L20/2Gj7/M6PDhsvhY+FMzYRg+v/0jo2gPT0UTCfaLBDRVvKQgUSYPMG1dr6ox7ohepBUS0msHq/V7A6Y9WfKDgSLatqTzwhOXnuXAoFc1LsdlV/Nv7XHqg5TAohZGa1mOn44SyY1fyPMCxL1QmxvhBC7mxDyj9DUnBpbjdAzrBW0mUzZ51brDVW3f0A8oKL6FYBf0mwK6YxDMJogq94OPgpZyKHKBYvJXMfs6u0pYnEn/jPeTVQMK6uY9Egww5setjqwdQmwi1ea0/uoNw7QKPorCWZohFt4VB+HUy/ObjCDdxryIg/y0wXGMwFyftSyf0v/ESOVaUNOHg1aA0SQ0KOwx/oqBneMvSoxZc7SqvQaHcx3ZLg7I0FQgQ9799KuVGTfGNgWvzIMnHqMNnCyCLJMNoNQK9XA4Wkq+6tVuCUREehKj+szE6KlaSwgAPfb6JeGqIyBrjJK/wNw2yPaYB9wHia3A56M5r4OplAvdVjO1vrsc4I8LAy1zqqpo0yM1hfixHeLNDG6ufXaX/4mWxYpqL3hBHpPbnox49P3jj/wGgdZFaJe1JTer036xd0Xak5qCI6SV86xqAdAChv6sj7ESw0SU7w0leCi/08lfYfucRQHdzjO3JkA7lvHw0ouMCSCweP+ms5HlStT1HLlgQ/pkLQ0HiDkuoPtTY6fDW0UPlH3ebKJKJsiIlEwAnWQ1ExfQhfs1IRdbEO6sgyC7u2YqSye9WFoH3s0+d4P2X78UPcUsRitbiSflMds3+5ixk47wEAbwHOouv3l0AUb9zZIP32hh+8n3fJx3LXT4wqErJXRmufydvyJuKW5IkA+rD7B5y3hJGUFrf+je8x2WEZ93MMZZjKF3R4hY4E82J7y0z9znWEXqtnGce0dejOBkrf6CbP1VCh4ixhRvmOXO9yA0A2XQqeWYNfk1eUkRWlybRDBiE5SOOtjudxOpqC6Hv0XRqdL58/dsrEItVoppvb13l9MrZRKzOe/vtw9JP9aAkOa7ra6MbT/3YE4LlEJ5ticKWKe+rOGibg+N20Vx6Vg7J3byZG9+hIpULnZWH4Tq3LmlMA+oUfgAbbzPl3twbDuQozSElI95KSsXaBWevUxIWPQdY+4eolMlTtLwn+51SP6BWFEiioYy+r2Rza4OqKJPMbx7t0CZCtpMKxYQ5JCowbAH7J4Y3Eh3C04j1H/2a7qH3cVo01mg0KjVVR59qENmLLCnQ4LNMS3i2XshEK7QAIvi4D+egZPpMUywog3s+tqRiaGXIEMFp3rd3TuvLXVT9tpJGxjgQLGMKXmGL1MVjoN97by2NaOn0JoIbOQqeBIHTVbBYNON5DD3XP+rStPIfVbuHd+90TJpGh8BlfV0dLneK2wDMnndVGVvQLhvaQxu6sL3XsvtxmQzeFWUSHLeAlmTc9yNQKkXtOJWS9faewS8yotiXdJQ6EI1vpVOHgh46gljSllVDRx9qlH7i2QFU/dKpaQEbpAFUBI/eSUGbpgT2ORGcUGXXDWjQJQo+nCkQVnIMRUCP367os5Iw4Rb3LDvOi+/mwcBozzUa4WkjVcSIURKO3RTFCiY9j3O6C5MBS6Y0WbBooC0nOzhKxL8xMIIaM/tnyEzIdlABrz3f9XlCiQ0hh+C7/bNp14eUvnjcHWjBOSw8E7BjzeXkRQkpIuZSOriwZ8PiOLZxCkXFOQ4hbXa4Tu69lccJ9Hd0F1lxkg5QnAhhfx5WdcTkBH3SibBUMCLPb/cYypz6s4GGDMV5smYibldp//j9gbCEhqanpxLsoexOMik4SOt879z21iz+8V3wgG8CicQsmxcsqCc5QUqOZhnpO4qAFgzHF+noxN835P4xf5EsOcPvYWwtzK3WEYVGy5tuvxE5WZB246SGIDgeC4sMge0B4p70Tse4b6NjlPHW+90GmqnySqY83r0ilaew46qmwi4RzmOcPehbn4YPCoISjQ44RURV++dfU53vcKhkSj6cWuh75tdSSUNMysFwoP+lN2gGTwxOfrha9wWxDPpimhEBVrt6dcBIvdoUbCLTDQDZuUOVVhZP4sATqq8z7Ai0STnGxzKmAHG+3I+/tvrDN/OOTHwR6W5aWSRj+M5wmS5hfdvimlus2z4pE6RV+l6scSEX3XjFUVgbSuuufln4qZfmgBxNvIZmkPtMh4WHAtuqRVdgDOLksqdhjqc9jrNVpRsYL4L5fXaKhNXYNJfTorxbaoSpoqj6ZEp05xsc4y4Qryx7BRs3iYvuHRbCUsiCPmmGdUPXDn6H7woEjiz1YeriH6NPF5au5aVrtcw0DvEgLLKMuVq6QvzE1mu+x9AFhhIEE3jVvzGWs7x+IBGJ2hfG8Kb57q5sDsPmddrc0s2doavGt3j59SpKkbETAVxcSwwHbpAEsYTNPM1KhVl7EPpQp+gNotyPx7hI11xG47CrYE7+4xlCFpaDwvf9FWescjE9qNrcgCXvSeme0GAOo6QjsttWQcRguwWZb6OG1VPN2xZcfyUeEGLHhPkrziDDf4SHNaCcXXJ9CtFdyRMVueZNWqaoSKhpFI91MMLSXju3pGbSzJlM8FPf/oxZbRADvlZZCyb8fbb4mQVBZZ3GWV4hj4PCrLA1qQvEqs9XLsRnoal9WaSQhWRzLJmCurnGGRc6wxyAAejp0pAR70k0M8R+ziXphTbSz5jU2xp2cFe1EhegrqPqjFAtYWbYwsm9X969oYf76RSVpD5DfI8iDfFILBkfvnZaZtHikQ2tfNY1T0QOYafZ+dfiQjWZxqrDxXDWbc/jYZSbOzpgJ0HvC9wodOgTk5d5d9dmNrnM0LH8bvtI4zgktUZdf/DkYM10EF8yMhbFqvpMTi+TaLBUNd9aLSzSGAqu41xsKxsEYHFPhxozYZMPCafc4U5t8Ja7k34czb9pTsN2JFnwl8AmZSpI39KzBoEcD8fz0CAcio2KlaDIhPF8V0HkEbwc2c0mkpBazhOMI1d4cxnKG15nlJ+haP4D9g/H1z7jIEHS7enL9st+r19iJpqLFuJiKD2NT7LXyBzaAcFxIJ/fo4roeZSvHUyfgqUjSVcPiszEAuk4Fgqjxih+ln6TZW8b5sbDIvrB1Ul++c1B63XbFgHdVJTaRPzIXeh5f5u+QYvfa7pHyQV0ZUIv4SnfFMvTC0g0/fdaaBd9rcpxu/CBpbobKZgCIyVRDZGdPlZs8UGyu7+Hxb64E/k0YIIyG0d7ZSIcU1dOwyAQt25Ow5B4W/oUhgU+Gf+qB/Eqf+V11+GylEkiyGag2sSabnAwgaqTr549u7USX8FH6EnKLv1g9jl2zIU7C6GM3aeDn8kP+9aBM0Agrl165RV4/UHaXPnrBjs3YOHlrMK9jziNkwwt6+rC5FPPvSm2uVuOQouD4+Rk/8X2VoT+8bijB9PNpfsOsNhiSOVgntu7dzfzJItraFExs2ylPt0vanTgZJP3SIxPvZsgaDSBNmxIh0KPLS+EZkJ1Xy0gY8WVOZDbYF9v0GJta6+GUy7ek8lisYumJ1nyw90NF5n7L6H1aFMYqA/WI2COJA7pWaf9Ugf5pniETIJNyNXtonwZOLeCG380p2a2m5Fs4WDJIbVCtkJ77ah+h3HMvJJ0fzW8OXfnZDuzbWB935lP5zr2+vOc7CL44LjNt8p2deJJKd+d8n1mwKwxWxUjkxJRVlpIqwq1a+Sfeu1oNGDaOXyS/LVoiWAi4/RFFK77j8sVBWyTeqc13DCYWKdEbHTgEcIdtBewm3fvU99V8J4gYLJijdis2O/D+3FBz8kG/SwAXwjzKgO1TmXuA3syLPxxfnEUxttkUPpzQJgAzcN6o79tpHr3QWX3TVy4USKZJPX/G7/sFv7TB2RKaM9LvG8518UTl/oNK6/mqMpSOqsv0xRVzNjumgamqz/e3LG3e1lkrW5SquqlrDJIrN90AProjO2hsva2vAv1ZNPbHVfvH6K8KnMmDbXcZImS+YAXafdXLVILS/Q0MSKuRaLPQABT6AsH1SpBlkiSLXyhT/gT5IbfD6Z1Jx0n7l33o2uGW4lgd8BRn8WUeEHBHEn2SCXVQwlREQtvN7iSC2y8qSngF4ytc3vgOucrGccauebyUn9sdKmkhMom+XHRGLg4yr7NW/ZAq8UDCTjimw0unj204NYoihtZTNdXwgmCpqzA6Y4a3S/braI7FEXELgpjVSnB+dqkyFq3Tny2G8lAz1OtN0TZdE3wgbqL8XtsE5Ut1NayTqmPNmEhJVC0f6ZfMop0HP5VawTxA+lq1XoeRAoIGH0ojuV+9O13sh2V2zoxj5jVyNGuZDtqZVlEeSIRI05PVi7nZfKw+EuT5YTkdX/qnx/AmQXABJR8mEbt5A8Oab2RqMdG+P0zvDI0gODnGDSO2w4ZOrD1zi5LnYaIljibbOMhpDWcwsd6Ry5eUmiLQ24OpaErO6a3/sYLybm9xOJLqfn7DNg/5SKBxEfKNyyUYP4KtkSMQI5Xo7dHcIhqH4l3CRK/gB7WtFU6bj0mReNJIitL8grYbUyZpqDuMDT5s5WQsWjOEmRSbMiH7HIkEIPvRu0WxMnRCJKjGFWdlKGqK96T7jlsEHCjsPjk/9VEQ4W5qB2tRAFGJ5YGgbmyYxqxGxduvkNdd3IZKcIbvtEtH4X7aHeyV4Dcn4wkEzUNRRhISM51Av5I1mwi2lj3DP8d6K9iFzNVDCSb+eb9pBu+SEqYrvFC8WKSi8OcZDj50KV871120hgz6n6OZy1KOh8OzKNuCKFt9mVlUfJKzD9gcuL53q+oTHGGIKFz4+4/zLC13N3l3y4Fn9dzM02uGyBGoJXmF3jrwW9OguOsh1FVykE1suM6kC/e005VRngkgcn29tixbfGSx7k8JzTId+5wTXE1HgKXCtGlwA7L6FxS+RUGGP2az1Em91D7THACjjqlVdoDOltQ7Yb4S8n4kG/m/CvtFfQB0e/e/JMgICLGKds6v5THENB7WYOdJ0P5s3GQzdbeXjUAG5Y2WCUBs5LZ6xDZzv1L7jfUHqBbmnHW7U4g+UTYB/tW7B0Ya0JAbpzWFSoVQH6CbY6q9fM8ccelwWdxeWdjZm+TcmBAHpje+emw8T5mUgl7Omvks7D2xk04/HjynzVyBN2dI3dBgxTkB1keL9tMN0WgyjY0ddKI8pigHP9lOa8hb7F2bZIa/FqS6JJPPHnlyPbVl+weIG7j4ocmWH/OkvaT4qtcbnafk2ocwOkjSqUob66ehit1UDMwKXreD2R92MZugTHNe/PWAZesANg9eBbm2p+4kqK52j8MW3AhqaffDN+kK195DUM4FLVYm8BQhOF+OWoM5tTD8LImCNRenutbU6qRxpaMDXCBU37/K3Y7eobcg/IaZaBuw44FteI67Hdgufk5VqCDjlK7jDBUtVq07hpPI9ymWW/m3nNLQlusNGDSBNYXOUBDRWNnHira/1eo9GEwVgpXn2tG1PUUxT15p/fbfGXCvpsj0QlzwErC0ge/Oqlsh7E0QhpqDAcvlBJOiXDD/bv01SkM269rmghWHJPUbmpq4trj7H6cCMXMIwWgOLaTXR0w3tamzJpReC8FXDNwkxSCbmg/ag17JdPyptz7mR3k6KvXor6tFCfEv85TW7CDWLEap1AC12Ym+LK9/CxdKPnXz9Qz4xNXGn3sG1wAfthifQfjDyiCnLo2uhuMzI9yKxH4PUTt52mReMLmnHFrrLpDYcPC+cU7ge55guYhGv/ANB92YzoXrI+Hs6gdXnnfE8GGhfydGwvKBKCtpDecGnu41Mz28j9/LTVtSV9WZEoxANMgPGo4BDbY2p69ixYGQWATdyg9TRDAK7f/Lrlubat60yuVZ9wcwqZ7NBP71mX6NEgdvfK1EgMnkZzsDQl/wWDHdAoOYCo4pKwY5I/V26cKTO4aMYcV/YDdgglOtas2KtIXBJAcgotsV4YfF+CDN4T5WdX808VdXh3/UXLrAdcMDF3QIXj1HyUHIOkXBH7DXICbJt9eNiowRXiuB0d1J/FqjPFe2IlNdXnwFwpRusB5PLSv0Lk/AdI1gQmao8wwLmnoh/L9riMbMMsWAOI+5B71d+lGTKlxx4hQn4ixRfedyZUUsRcpGrgAS1XqCKzggl0/LFuyQpe9BsgvZGkEHQ4ELkl6bcLtiHZ+7uFxmRjnV7v8PP1Whug1igIT3OTMnmb/dGJPuGKY5fRdvWoatxfNU3ABi+fY7eHiPqC0gQDpAC19twVfWBtBur+ST+y7fzmSE5Q0C3mcp8/31XIdqm7sEZJHtFnXBgaTyG+fWRGAY70K10IBvKH2TE6IMzm1k92/Cn2payTupKTtojgP3uaWIgFVgV0lD0WGR0PanqiKtrBFwqznvb/rz2PgpSjWd2BESLQpxY+6tmKXZnjvY9xfR12CQ8o/aKz1t+XxCSzy0uE5f/kaFUCrwxjL8gT7SEUJshp//5/yvPFJHgJlgsvXp+gRQCSzz+vS6rl3BhMsbj/HzwJYz8GsWppOQDGVswlOHEaFE/qhImhDrt2DUfNxtt21GW7KwJRn9/mtYIjlnnwgESPEpwoLyTru3SsVGzRxnZG6x+BiseUs57lTdb3H8KG7UPeH1SSjy9wZHELnar9x5cOtOR7lOvyjWm4Ab18Q+qoMxxLCFit0V8SmOu7AU8XGY3eSXb6Ly+kaQmDkRlOstgmcj+rD34KNz7LTvLL0O1Z9J/nCjp+1flOFgtbd7Yg0t5eNrPuppxYxJfSpnJRNL4S3YTffnV+x+zVsuioseET/On2wNi/TnL2rAQIKswi7Er3Sv48D/+PLsa2WJOSk6DqcCLmusILDiz0FwKEhMewrxtNyM2IAE0/6hiopIQoUgC6U8CLirhWbfVibSnCGZlF5uywIcaUlcEaYP/evokbi1NSquO62XNnWR4+fB3M1N7LaI5pwdHYOKEjg9OaSiTtEDypKGOVxZhdQS0jEvZ46foNS4SBpwZfPn60p6pQldNUmimhWeU5LUnEpZYjPJU6hmAsh4AKaLFfJANrZ9ou428yoEIFuiY9UgOYkqtSUocWxyijxK+NTtuDdbh7NJcyLIl6CUBWQjZiL34Bk0Qe3vmT9tpIKus3r5CvEdEu5Va2Wxm8CQJT9bESzuFBeH0QIRybKFAUVqNa9tCXukd1jwLXYKWsuMuFda8R1UjVG2cvAZ+R3lBV+nLksL4Ti6lubX3hKFcSyFsG5rK9pJt5nlSGIkBLP/HFqLL/KX0S96NdOo4CS+GYPBk+lBZxz6Yie12vvUj8l4t1ik/5PmvbLOTPCcaoPeZ7APUQIKIcxcNUDin3R1okbeAUGwt7Ja3G0ntQokBhlajisyXeqbfPLrTTKpTauclKp+DGdyBsbzFHEYtIqZnlLe5wjluF/UID6EgwWPGj0FVKM59Jom3+0Y1QTb+IKqHZv/0FIEEuVItlJHSixdza2w0UN80Hyc/eUGv6SBybC/EEs9cOcLBR1eeQXXe7p7hfIhtxxBrGhk9n7jom/4LXF125WzPmMCUiNyE8iO7sVSmRf/iSNFBveZWGPeCirfJ8a43fk5jCfA3NPEJyMAamu3Q5im0DKo8aonWXtye9iE8vraixlVTAGSXFMjP3+XiOE9jrnXTDzARnt7+9gvHctQpaAI0za6N7bq9R1lb55jILwmx4Ih4OA0K1/Xx7B9jytPFBRhEO8xqXLhxotsIRjnGRvnkMK/KJ1YhE9T2mNmclLYgMSn+7dzik8BzoHt+EcXstV8yNpTspqsnS96ATq3A66NbF449w9JqViBt4gWi7yVzt3kR4XSJ8iEB5anMqG+EsSyrMQVv0sMeEysGx+yYs6G2xPJw3zqTq4RzDQXPhYra/VMlt7E8zzl4D7L3HS3kkWf4ZkmFmnjcENPQdkmohl6p/gqkOg+8McyzNxxb5Fl19DsSr3MTuSMqhSKDn95ibzYCEdrZXJiKaqu7BFBuju+jSObOPchog2IsE/u/3U/UK2mntvSnD0qNkPYoRTskBnLJ3NJamL0V4sEbryX8NMr7MKMJ0+h2+xMKY4KERpvUrd0c6ABXWHqLdY1QTugC/5dhdoLy3+KwgG5FnL0MZw6qvOvHkKQRoQrcKLuwUld15s05QxurH67A9eAr02a/vUWNBIgP6vOa69ZZuZKElWttIerRDGIAkZ54fw7HBctSZtfspPxaliwbOEH/Laxot3ZQonzvXknSVodzZHA1Jw7BcNRsYvl+KJ0Y6pMRPpIbaN/QSuHtnjUoej+vlVhq5021xMUPKxCK/D8rSRbOmduHG85/JrIimgo5wXWP83lLvRaxwCxeTGVt44fTUqsfUARmQcS3f5DbHR9SZ4nJYIEvcCjIqLezJ3I6S7xBop57j3ZyMQX0Xxr5mc6IUmrlOXM9fJG5iDZQQ9rWsGZ0Y26GzTAEsD6pjPuDa1XAT1MRpxyZ8zN53sl1YEV0E0EHvZqcnBnqMTXRh6zC9PwDXEk3OHs2zLLIjBhY5+7lDxp1X0qcm8XtWorat33mUx+kEDDgaDUdpclQq/ZM6mMYoF433nKbCKDxCozugSPVaRjNPosMDy8FujvIJSb763XuBGBIYLS9x+HZhYiUa9xod0xKV9aRt7yczWWlLgfK8qn4fULHMBSP48m/wTWfDBdTH8uDAKt5WM033+2bCpxDhmZtE+d7XP65yBTOf9/EWaCG+Gs9/5kVbWS0JlfoDH6Si2tVCzCRGfV0XZAUWfXOMJ5F9dkMagbwaeqVqqbVONDQGg8zID5MUV7IkazdAz4JLOXsn1RuZnoZNIGV2Na15+dRKYUAmXFmkWBJpPMBwT8N4bd8VZwBnhm3WzH9S0sbpoP0sgf2OmPvQ6smMyfkVK+OLjXYubmtioAhdwDb5/pLRg3PGwfHEz6v9OOe4AK8iw2cma49tV44In8Rc9jGcqSQlFXPdlC8366ke4U/ITFy0/SQBl1vWvGk40KycwWGaLf8cCtEi/4X2W8961i6lYnpfNQhGcQyC8s2oIOW+Pw545Thq3ZBEyNC8YDr/pzCEmBI8U3A4IiQJoHiD9kUMNd8wfzysC2Kqc4OGeWYsJxmDev4Jn4HV+vqpgN6xxSEMABhRMdTteHiJAgnQEX9BR2V1sNqh5EcMvQNYYa5+bblQn7Rli1UFCtQkP6ECmGkxmPNkg2CGS2mmf0/WEuTZSyPMtbbrnftPgleOmJ3jSm0m1EU9fQHQo1NZti+KczpJ8mSYIVtXzXh4rNJcL3Fm7Bbftpjmj5UnuDpPk8HvqKOj2DGJyk4R0Md1x7umiH0DTOXaLwO0EI94k7n6R8nfqiwekgUQZ1rRek0HViM5YN0JLWp4f4NRE8ErcGNSHZd58+9Kx8lmkc9ogfQmX0rX1kB8QQzNbH+eVDee0jOQNUgQcew3y+0QbifXrtLHXDIxsqsej41Kz7vfcQRE1zUnY2phYNILK8a657zyHNMzPiRhxs28s1JX2kiCMEloubOXnc8BzU+n7LM9wztf63eFWN/eWHXVivSdCWg5DfWsk2CF8aFJrOP277QEPdkWlOlewCVEkLjyd5wUn9ZzaKOJKnDQDLfliiRLTKlU8TOeQj8jOU8FfpM9tayJTDpxw6sVlZuJRAILfxn+QAGIB/W1FGDjuuVu62hFDBdvzVSfge95Ebf9pclp0GrpV3S+gwBWn5J7aGiim/fRyIN7YVVXJsnAnVeq90vDdAV0XearTqjT2Ck/AMkBW6T/ls/6VUVnFWs01wxkahKR0tRwyLRKgHefm3RWie/pTVQpUMZw+/7ozQSW+7vuZd8lsvT1iX5rwlpiaFnOnDbHsr1As6vLETd5HVbcBCGbJHcS7ax9Byd50jdYyagUtjAaHYX8ryyuR/bDkw1o4j8+hXMfbzy+CVmgrfRDyl4dn+5LxrqRAXLoDKpQREAHqdLSsVSJh1s8KnZ/SsUVq27cq+O6LMSBmhT4X3E750rmWwCsoCre6bT//oFWYALjp2SbcxnULBaTvnYDHtfEbO1m/3c9nJk8ZO5KHQTV88ivTWN/S2EXwmisTPdcupMrvI8e48QZdkZu9WHyKron7MKhGFJw6Z0KZ3tleVrvvJo89siUwByPY+Hs4gkKPBQbLQOaedcv/xeM+Ih8rl1eHEC/C65xWVciToVqSGp9HfbhVzFSrO6kBnv7mJwnRLvMEwqiNankVdJJMw4icU3lKyw/ecNSWIUddqlbThYMiq8nHjRRufs+28cq0OI9zhpvxFvFgSZE/eAYvm0x+9lZO+EH9NkBngaqU1NMYhdombNuy3awUN9p0mJQ//e9L65YbShgoc+ZUlNy+c6F6gDEHXV0JrzevPIZFAe2RyRa2dNqzLvihAAMCszYueqszzXRkSyobx5+LTLK2V3lfg3wbS9DzP3QW7VHdHbjZcttQRvtjrGveJnNn2DE2ZDIbvkCrT0H8RzbGDdmIq4P1ey+hoY/W6NuZKOz4dv4HUNznxdKV1Wf3MvqUv35r2jTKvpPWBUWNm5fytX/QJwp6qkIOsSx7Y67BSCbCDVLM8/VcMG+T0j+INrgL9sfT1ICtACH8BI0G6ViUZPVzzCmQHW2oVIwZjAoFl6+meO/pD8teO1E+1y03mCpYfW9S8qhtH2GhlFlebPf4NbezVv9xbXKWz0xezRNQWqUqtYRTUbuzK7KTvjG4rQHfzBpVmK4wDLnSIwdSzTSk1fPNeY0WOpPZTLlvQ59xwgfFrb326vT2hS1JAZ9E6sujFtKTiJ7bxI6o4cBhDaX+adXREThhR+MwA4TqD7rga/o9iY7d6TVRe14CS2S3iSQsD0R6ApnhG/2Wa0A0AY2NtWTjmabdKU+KgIRDP9RQYVjXiF1qC+xyNVG03I9vpmEpY/G/zC4nLOKgXAZ/uTikHI9Afbkhfgfgo9arWbix5eH7WUo9RQygDzwCnVSjbXc7MihEufVj6WGbK963pw8VjY3RS8IH1cy2yZbIcKLO5CgAUcXJfF2+McnDLKtXxyZaf7SPA6KJq+zF2NHyfoeTOwHhGqNcnHVr1hT73pcoyXyfvCYBnG1Bp/aR9t8hoI7CXM3UZOisWGA1SHZ2jf7k9GlRnp3mF/c1AV+JjvUsnZrsybEOQJg/dn/9eJkyykQHjbF56zgcPX6DdMG03WKUMlYz+uOZ+5DZy9E9MZOZ9GMoLFdrIPPQQLjv+GlCMpoyHPXkzIODjHAID2PrnaRpqWVHh0rnieDILKq+Emrd5RnjgE9pDUXWTmHaKuqqYlcgEz4zbi46dbWrAAFBjsQq1rLHIiPJEcwFLCOY4JNlXRXQJqCUKXk2d1RSBGzDP6HDSpo863BhVRFFF6uIpjQV7j5ebFe3UkkO/+coIo2BTAcgBqOtQ134s9a4QJvofuqBYMGOBMsWZ+sn/2AOxDx6SfAnDFGw==",bluenoiseBits=buffer$4.Buffer.from(BlueNoise,"base64");function checkTimerQuery(K,_,Z){if(_.getQueryParameter(K,_.QUERY_RESULT_AVAILABLE)){const ie=_.getQueryParameter(K,_.QUERY_RESULT)/1e6;Z.lastTime=ie}else setTimeout(()=>{checkTimerQuery(K,_,Z)},1)}class N8AOPostPass extends Pass{constructor(_,Z,te=512,ne=512){super(),this.width=te,this.height=ne,this.clear=!0,this.camera=Z,this.scene=_,this.autosetGamma=!0,this.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new Color$1(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0,colorMultiply:!0},{set:(ie,oe,se)=>{const ae=ie[oe];return ie[oe]=se,oe==="aoSamples"&&ae!==se&&this.configureAOPass(this.configuration.logarithmicDepthBuffer),oe==="denoiseSamples"&&ae!==se&&this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),oe==="halfRes"&&ae!==se&&(this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureHalfResTargets(),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.setSize(this.width,this.height)),oe==="depthAwareUpsampling"&&ae!==se&&this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),oe==="gammaCorrection"&&(this.autosetGamma=!1),!0}}),this.samples=[],this.samplesR=[],this.samplesDenoise=[],this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.configureSampleDependentPasses(),this.configureHalfResTargets(),this.copyQuad=new FullScreenTriangle(new ShaderMaterial({uniforms:{tDiffuse:{value:null}},depthWrite:!1,vertexShader:`
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = vec4(position, 1);
            }
            `,fragmentShader:`
            uniform sampler2D tDiffuse;
            varying vec2 vUv;
            void main() {
                gl_FragColor = texture2D(tDiffuse, vUv);
            }
            `})),this.writeTargetInternal=new WebGLRenderTarget(this.width,this.height,{minFilter:LinearFilter,magFilter:LinearFilter,depthBuffer:!1}),this.readTargetInternal=new WebGLRenderTarget(this.width,this.height,{minFilter:LinearFilter,magFilter:LinearFilter,depthBuffer:!1}),this.outputTargetInternal=new WebGLRenderTarget(this.width,this.height,{minFilter:LinearFilter,magFilter:LinearFilter,depthBuffer:!1}),this.bluenoise=new DataTexture(bluenoiseBits,128,128),this.bluenoise.colorSpace=NoColorSpace$1,this.bluenoise.wrapS=RepeatWrapping,this.bluenoise.wrapT=RepeatWrapping,this.bluenoise.minFilter=NearestFilter,this.bluenoise.magFilter=NearestFilter,this.bluenoise.needsUpdate=!0,this.lastTime=0,this.needsDepthTexture=!0,this.needsSwap=!0,this._r=new Vector2,this._c=new Color$1}configureHalfResTargets(){this.configuration.halfRes?(this.depthDownsampleTarget=new WebGLMultipleRenderTargets(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=RedFormat,this.depthDownsampleTarget.texture[0].type=FloatType,this.depthDownsampleTarget.texture[0].minFilter=NearestFilter,this.depthDownsampleTarget.texture[0].magFilter=NearestFilter,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=RGBAFormat,this.depthDownsampleTarget.texture[1].type=HalfFloatType,this.depthDownsampleTarget.texture[1].minFilter=NearestFilter,this.depthDownsampleTarget.texture[1].magFilter=NearestFilter,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new FullScreenTriangle(new ShaderMaterial(DepthDownSample))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}configureSampleDependentPasses(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}configureAOPass(_=!1){this.samples=this.generateHemisphereSamples(this.configuration.aoSamples),this.samplesR=this.generateHemisphereSamplesR(this.configuration.aoSamples);const Z={...EffectShader};Z.fragmentShader=Z.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),_&&(Z.fragmentShader=`#define LOGDEPTH
`+Z.fragmentShader),this.configuration.halfRes&&(Z.fragmentShader=`#define HALFRES
`+Z.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new ShaderMaterial(Z)):this.effectShaderQuad=new FullScreenTriangle(new ShaderMaterial(Z))}configureDenoisePass(_=!1){this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);const Z={...PoissionBlur};Z.fragmentShader=Z.fragmentShader.replace("16",this.configuration.denoiseSamples),_&&(Z.fragmentShader=`#define LOGDEPTH
`+Z.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new ShaderMaterial(Z)):this.poissonBlurQuad=new FullScreenTriangle(new ShaderMaterial(Z))}configureEffectCompositer(_=!1){const Z={...EffectCompositer};_&&(Z.fragmentShader=`#define LOGDEPTH
`+Z.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(Z.fragmentShader=`#define HALFRES
`+Z.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new ShaderMaterial(Z)):this.effectCompositerQuad=new FullScreenTriangle(new ShaderMaterial(Z))}generateHemisphereSamples(_){const Z=[];for(let te=0;te<_;te++){const ne=2.399963*te,ie=Math.sqrt(te+.5)/Math.sqrt(_),oe=ie*Math.cos(ne),se=ie*Math.sin(ne),ae=Math.sqrt(1-(oe*oe+se*se));Z.push(new Vector3(oe,se,ae))}return Z}generateHemisphereSamplesR(_){let Z=[];for(let te=0;te<_;te++)Z.push((te+1)/_);return Z}generateDenoiseSamples(_,Z){const te=2*Math.PI*Z/_,ne=1/_,ie=ne,oe=[];let se=ne,ae=0;for(let le=0;le<_;le++)oe.push(new Vector2(Math.cos(ae),Math.sin(ae)).multiplyScalar(Math.pow(se,.75))),se+=ie,ae+=te;return oe}setSize(_,Z){this.width=_,this.height=Z;const te=this.configuration.halfRes?.5:1;this.writeTargetInternal.setSize(_*te,Z*te),this.readTargetInternal.setSize(_*te,Z*te),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(_*te,Z*te),this.outputTargetInternal.setSize(_,Z)}setDepthTexture(_){this.depthTexture=_}render(_,Z,te){const ne=_.xr.enabled;_.xr.enabled=!1,_.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=_.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer)),Z.texture.type!==this.outputTargetInternal.texture.type&&(this.outputTargetInternal.texture.type=Z.texture.type,this.outputTargetInternal.texture.needsUpdate=!0);let ie,oe,se;this.debugMode&&(ie=_.getContext(),oe=ie.getExtension("EXT_disjoint_timer_query_webgl2"),oe===null&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1)),this.debugMode&&(se=ie.createQuery(),ie.beginQuery(oe.TIME_ELAPSED_EXT,se)),this.camera.updateMatrixWorld(),this._r.set(this.width,this.height);let ae=this.configuration.aoRadius;this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(ae*=.5),this.configuration.halfRes&&(_.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(_)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=Z.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new Vector3),this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(1/2).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.samplesR.value=this.samplesR,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=ae,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=_.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,_.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(_);for(let le=0;le<this.configuration.denoiseIterations;le++)[this.writeTargetInternal,this.readTargetInternal]=[this.readTargetInternal,this.writeTargetInternal],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new Vector3),this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(1/2).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?1/2:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=ae,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=le,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=_.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,_.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(_);this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=Z.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=_.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=ae,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.autosetGamma?this.renderToScreen:this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),this.effectCompositerQuad.material.uniforms.colorMultiply.value=this.configuration.colorMultiply,this.effectCompositerQuad.material.uniforms.cameraPos.value=this.camera.getWorldPosition(new Vector3),this.effectCompositerQuad.material.uniforms.fog.value=!!this.scene.fog,this.scene.fog&&(this.scene.fog.isFog?(this.effectCompositerQuad.material.uniforms.fogExp.value=!1,this.effectCompositerQuad.material.uniforms.fogNear.value=this.scene.fog.near,this.effectCompositerQuad.material.uniforms.fogFar.value=this.scene.fog.far):this.scene.fog.isFogExp2?(this.effectCompositerQuad.material.uniforms.fogExp.value=!0,this.effectCompositerQuad.material.uniforms.fogDensity.value=this.scene.fog.density):console.error(`Unsupported fog type ${this.scene.fog.constructor.name} in SSAOPass.`)),_.setRenderTarget(this.outputTargetInternal),this.effectCompositerQuad.render(_),_.setRenderTarget(this.renderToScreen?null:te),this.copyQuad.material.uniforms.tDiffuse.value=this.outputTargetInternal.texture,this.copyQuad.render(_),this.debugMode&&(ie.endQuery(oe.TIME_ELAPSED_EXT),checkTimerQuery(se,ie,this)),_.xr.enabled=ne}enableDebugMode(){this.debugMode=!0}disableDebugMode(){this.debugMode=!1}setDisplayMode(_){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(_)}setQualityMode(_){_==="Performance"?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):_==="Low"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):_==="Medium"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):_==="High"?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):_==="Ultra"&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}}const N8AO=reactExports.forwardRef(({halfRes:K,screenSpaceRadius:_,quality:Z,depthAwareUpsampling:te=!0,aoRadius:ne=5,aoSamples:ie=16,denoiseSamples:oe=4,denoiseRadius:se=12,distanceFalloff:ae=1,intensity:le=1,color:ce,renderMode:fe=0},de)=>{const{camera:pe,scene:he}=useThree(),ge=reactExports.useMemo(()=>new N8AOPostPass(he,pe),[pe,he]);return reactExports.useLayoutEffect(()=>{applyProps(ge.configuration,{color:ce,aoRadius:ne,distanceFalloff:ae,intensity:le,aoSamples:ie,denoiseSamples:oe,denoiseRadius:se,screenSpaceRadius:_,renderMode:fe,halfRes:K,depthAwareUpsampling:te})},[_,ce,ne,ae,le,ie,oe,se,fe,K,te,ge]),reactExports.useLayoutEffect(()=>{Z&&ge.setQualityMode(Z.charAt(0).toUpperCase()+Z.slice(1))},[ge,Z]),jsxRuntimeExports.jsx("primitive",{ref:de,object:ge})});function copyAttributeContents(K,_,Z=0){if(K.isInterleavedBufferAttribute){const te=K.itemSize;for(let ne=0,ie=K.count;ne<ie;ne++){const oe=ne+Z;_.setX(oe,K.getX(ne)),te>=2&&_.setY(oe,K.getY(ne)),te>=3&&_.setZ(oe,K.getZ(ne)),te>=4&&_.setW(oe,K.getW(ne))}}else{const te=_.array,ne=te.constructor,ie=te.BYTES_PER_ELEMENT*K.itemSize*Z;new ne(te.buffer,ie,K.array.length).set(K.array)}}function createAttributeClone(K,_=null){const Z=K.array.constructor,te=K.normalized,ne=K.itemSize,ie=_===null?K.count:_;return new BufferAttribute(new Z(ne*ie),ne,te)}function validateAttributes(K,_){if(!K&&!_)return!0;if(!!K!=!!_)return!1;const Z=K.count===_.count,te=K.normalized===_.normalized,ne=K.array.constructor===_.array.constructor,ie=K.itemSize===_.itemSize;return!(!Z||!te||!ne||!ie)}function validateMergeability(K){const _=K[0].index!==null,Z=new Set(Object.keys(K[0].attributes));if(!K[0].getAttribute("position"))throw new Error("StaticGeometryGenerator: position attribute is required.");for(let te=0;te<K.length;++te){const ne=K[te];let ie=0;if(_!==(ne.index!==null))throw new Error("StaticGeometryGenerator: All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.");for(const oe in ne.attributes){if(!Z.has(oe))throw new Error('StaticGeometryGenerator: All geometries must have compatible attributes; make sure "'+oe+'" attribute exists among all geometries, or in none of them.');ie++}if(ie!==Z.size)throw new Error("StaticGeometryGenerator: All geometries must have the same number of attributes.")}}function getTotalIndexCount(K){let _=0;for(let Z=0,te=K.length;Z<te;Z++)_+=K[Z].getIndex().count;return _}function getTotalAttributeCount(K){let _=0;for(let Z=0,te=K.length;Z<te;Z++)_+=K[Z].getAttribute("position").count;return _}function trimMismatchedAttributes(K,_,Z){K.index&&K.index.count!==_&&K.setIndex(null);const te=K.attributes;for(const ne in te)te[ne].count!==Z&&K.deleteAttribute(ne)}function mergeGeometries(K,_={},Z=new BufferGeometry){const{useGroups:te=!1,forceUpdate:ne=!1,skipAssigningAttributes:ie=[],overwriteIndex:oe=!0}=_;validateMergeability(K);const se=K[0].index!==null,ae=se?getTotalIndexCount(K):-1,le=getTotalAttributeCount(K);if(trimMismatchedAttributes(Z,ae,le),te){let fe=0;for(let de=0,pe=K.length;de<pe;de++){const he=K[de];let ge;se?ge=he.getIndex().count:ge=he.getAttribute("position").count,Z.addGroup(fe,ge,de),fe+=ge}}if(se){let fe=!1;if(Z.index||(Z.setIndex(new BufferAttribute(new Uint32Array(ae),1,!1)),fe=!0),fe||oe){let de=0,pe=0;const he=Z.getIndex();for(let ge=0,me=K.length;ge<me;ge++){const Ae=K[ge],ye=Ae.getIndex();if(!(!ne&&!fe&&ie[ge]))for(let _e=0;_e<ye.count;++_e)he.setX(de+_e,ye.getX(_e)+pe);de+=ye.count,pe+=Ae.getAttribute("position").count}}}const ce=Object.keys(K[0].attributes);for(let fe=0,de=ce.length;fe<de;fe++){let pe=!1;const he=ce[fe];if(!Z.getAttribute(he)){const Ae=K[0].getAttribute(he);Z.setAttribute(he,createAttributeClone(Ae,le)),pe=!0}let ge=0;const me=Z.getAttribute(he);for(let Ae=0,ye=K.length;Ae<ye;Ae++){const ve=K[Ae],_e=!ne&&!pe&&ie[Ae],Te=ve.getAttribute(he);_e||copyAttributeContents(Te,me,ge),ge+=Te.count}}}function updateMaterialIndexAttribute(K,_,Z){const te=K.index,ie=K.attributes.position.count,oe=te?te.count:ie;let se=K.groups;se.length===0&&(se=[{count:oe,start:0,materialIndex:0}]);let ae=K.getAttribute("materialIndex");if(!ae||ae.count!==ie){let ce;Z.length<=255?ce=new Uint8Array(ie):ce=new Uint16Array(ie),ae=new BufferAttribute(ce,1,!1),K.deleteAttribute("materialIndex"),K.setAttribute("materialIndex",ae)}const le=ae.array;for(let ce=0;ce<se.length;ce++){const fe=se[ce],de=fe.start,pe=fe.count,he=Math.min(pe,oe-de),ge=Array.isArray(_)?_[fe.materialIndex]:_,me=Z.indexOf(ge);for(let Ae=0;Ae<he;Ae++){let ye=de+Ae;te&&(ye=te.getX(ye)),le[ye]=me}}}function setCommonAttributes(K,_){if(!K.index){const Z=K.attributes.position.count,te=new Array(Z);for(let ne=0;ne<Z;ne++)te[ne]=ne;K.setIndex(te)}if(!K.attributes.normal&&_&&_.includes("normal")&&K.computeVertexNormals(),!K.attributes.uv&&_&&_.includes("uv")){const Z=K.attributes.position.count;K.setAttribute("uv",new BufferAttribute(new Float32Array(Z*2),2,!1))}if(!K.attributes.uv2&&_&&_.includes("uv2")){const Z=K.attributes.position.count;K.setAttribute("uv2",new BufferAttribute(new Float32Array(Z*2),2,!1))}if(!K.attributes.tangent&&_&&_.includes("tangent"))if(K.attributes.uv&&K.attributes.normal)K.computeTangents();else{const Z=K.attributes.position.count;K.setAttribute("tangent",new BufferAttribute(new Float32Array(Z*4),4,!1))}if(!K.attributes.color&&_&&_.includes("color")){const Z=K.attributes.position.count,te=new Float32Array(Z*4);te.fill(1),K.setAttribute("color",new BufferAttribute(te,4))}}function bufferToHash(K){let _=0;if(K.byteLength!==0){const Z=new Uint8Array(K);for(let te=0;te<K.byteLength;te++){const ne=Z[te];_=(_<<5)-_+ne,_|=0}}return _}function getGeometryHash(K){let _=K.uuid;const Z=Object.values(K.attributes);K.index&&(Z.push(K.index),_+=`index|${K.index.version}`);const te=Object.keys(Z).sort();for(const ne of te){const ie=Z[ne];_+=`${ne}_${ie.version}|`}return _}function getSkeletonHash(K){const _=K.skeleton;return _?(_.boneTexture||_.computeBoneTexture(),`${bufferToHash(_.boneTexture.image.data.buffer)}_${_.boneTexture.uuid}`):null}class MeshDiff{constructor(_=null){this.matrixWorld=new Matrix4,this.geometryHash=null,this.skeletonHash=null,this.primitiveCount=-1,_!==null&&this.updateFrom(_)}updateFrom(_){const Z=_.geometry,te=(Z.index?Z.index.count:Z.attributes.position.count)/3;this.matrixWorld.copy(_.matrixWorld),this.geometryHash=getGeometryHash(Z),this.primitiveCount=te,this.skeletonHash=getSkeletonHash(_)}didChange(_){const Z=_.geometry,te=(Z.index?Z.index.count:Z.attributes.position.count)/3;return!(this.matrixWorld.equals(_.matrixWorld)&&this.geometryHash===getGeometryHash(Z)&&this.skeletonHash===getSkeletonHash(_)&&this.primitiveCount===te)}}const _positionVector=new Vector3,_normalVector=new Vector3,_tangentVector=new Vector3,_tangentVector4=new Vector4,_morphVector=new Vector3,_temp=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_matrix=new Matrix4,_boneMatrix=new Matrix4;function boneNormalTransform(K,_,Z){const te=K.skeleton,ne=K.geometry,ie=te.bones,oe=te.boneInverses;_skinIndex.fromBufferAttribute(ne.attributes.skinIndex,_),_skinWeight.fromBufferAttribute(ne.attributes.skinWeight,_),_matrix.elements.fill(0);for(let se=0;se<4;se++){const ae=_skinWeight.getComponent(se);if(ae!==0){const le=_skinIndex.getComponent(se);_boneMatrix.multiplyMatrices(ie[le].matrixWorld,oe[le]),addScaledMatrix(_matrix,_boneMatrix,ae)}}return _matrix.multiply(K.bindMatrix).premultiply(K.bindMatrixInverse),Z.transformDirection(_matrix),Z}function applyMorphTarget(K,_,Z,te,ne){_morphVector.set(0,0,0);for(let ie=0,oe=K.length;ie<oe;ie++){const se=_[ie],ae=K[ie];se!==0&&(_temp.fromBufferAttribute(ae,te),Z?_morphVector.addScaledVector(_temp,se):_morphVector.addScaledVector(_temp.sub(ne),se))}ne.add(_morphVector)}function addScaledMatrix(K,_,Z){const te=K.elements,ne=_.elements;for(let ie=0,oe=ne.length;ie<oe;ie++)te[ie]+=ne[ie]*Z}function invertGeometry(K){const{index:_,attributes:Z}=K;if(_)for(let te=0,ne=_.count;te<ne;te+=3){const ie=_.getX(te),oe=_.getX(te+2);_.setX(te,oe),_.setX(te+2,ie)}else for(const te in Z){const ne=Z[te],ie=ne.itemSize;for(let oe=0,se=ne.count;oe<se;oe+=3)for(let ae=0;ae<ie;ae++){const le=ne.getComponent(oe,ae),ce=ne.getComponent(oe+2,ae);ne.setComponent(oe,ae,ce),ne.setComponent(oe+2,ae,le)}}return K}function convertToStaticGeometry(K,_={},Z=new BufferGeometry){_={applyWorldTransforms:!0,attributes:[],..._};const te=K.geometry,ne=_.applyWorldTransforms,ie=_.attributes.includes("normal"),oe=_.attributes.includes("tangent"),se=te.attributes,ae=Z.attributes;for(const ye in Z.attributes)(!_.attributes.includes(ye)||!(ye in te.attributes))&&Z.deleteAttribute(ye);!Z.index&&te.index&&(Z.index=te.index.clone()),ae.position||Z.setAttribute("position",createAttributeClone(se.position)),ie&&!ae.normal&&se.normal&&Z.setAttribute("normal",createAttributeClone(se.normal)),oe&&!ae.tangent&&se.tangent&&Z.setAttribute("tangent",createAttributeClone(se.tangent)),validateAttributes(te.index,Z.index),validateAttributes(se.position,ae.position),ie&&validateAttributes(se.normal,ae.normal),oe&&validateAttributes(se.tangent,ae.tangent);const le=se.position,ce=ie?se.normal:null,fe=oe?se.tangent:null,de=te.morphAttributes.position,pe=te.morphAttributes.normal,he=te.morphAttributes.tangent,ge=te.morphTargetsRelative,me=K.morphTargetInfluences,Ae=new Matrix3;Ae.getNormalMatrix(K.matrixWorld),te.index&&Z.index.array.set(te.index.array);for(let ye=0,ve=se.position.count;ye<ve;ye++)_positionVector.fromBufferAttribute(le,ye),ce&&_normalVector.fromBufferAttribute(ce,ye),fe&&(_tangentVector4.fromBufferAttribute(fe,ye),_tangentVector.fromBufferAttribute(fe,ye)),me&&(de&&applyMorphTarget(de,me,ge,ye,_positionVector),pe&&applyMorphTarget(pe,me,ge,ye,_normalVector),he&&applyMorphTarget(he,me,ge,ye,_tangentVector)),K.isSkinnedMesh&&(K.applyBoneTransform(ye,_positionVector),ce&&boneNormalTransform(K,ye,_normalVector),fe&&boneNormalTransform(K,ye,_tangentVector)),ne&&_positionVector.applyMatrix4(K.matrixWorld),ae.position.setXYZ(ye,_positionVector.x,_positionVector.y,_positionVector.z),ce&&(ne&&_normalVector.applyNormalMatrix(Ae),ae.normal.setXYZ(ye,_normalVector.x,_normalVector.y,_normalVector.z)),fe&&(ne&&_tangentVector.transformDirection(K.matrixWorld),ae.tangent.setXYZW(ye,_tangentVector.x,_tangentVector.y,_tangentVector.z,_tangentVector4.w));for(const ye in _.attributes){const ve=_.attributes[ye];ve==="position"||ve==="tangent"||ve==="normal"||!(ve in se)||(ae[ve]||Z.setAttribute(ve,createAttributeClone(se[ve])),validateAttributes(se[ve],ae[ve]),copyAttributeContents(se[ve],ae[ve]))}return K.matrixWorld.determinant()<0&&invertGeometry(Z),Z}class BakedGeometry extends BufferGeometry{constructor(){super(),this.version=0,this.hash=null,this._diff=new MeshDiff}isCompatible(_,Z){const te=_.geometry;for(let ne=0;ne<Z.length;ne++){const ie=Z[ne],oe=te.attributes[ie],se=this.attributes[ie];if(oe&&!validateAttributes(oe,se))return!1}return!0}updateFrom(_,Z){const te=this._diff;return te.didChange(_)?(convertToStaticGeometry(_,Z,this),te.updateFrom(_),this.version++,this.hash=`${this.uuid}_${this.version}`,!0):!1}}const NO_CHANGE=0,GEOMETRY_ADJUSTED=1,GEOMETRY_REBUILT=2;function flatTraverseMeshes(K,_){for(let Z=0,te=K.length;Z<te;Z++)K[Z].traverseVisible(ie=>{ie.isMesh&&_(ie)})}function getMaterials(K){const _=[];for(let Z=0,te=K.length;Z<te;Z++){const ne=K[Z];Array.isArray(ne.material)?_.push(...ne.material):_.push(ne.material)}return _}function mergeGeometryList(K,_,Z){if(K.length===0){_.setIndex(null);const te=_.attributes;for(const ne in te)_.deleteAttribute(ne);for(const ne in Z.attributes)_.setAttribute(Z.attributes[ne],new BufferAttribute(new Float32Array(0),4,!1))}else mergeGeometries(K,Z,_);for(const te in _.attributes)_.attributes[te].needsUpdate=!0}class StaticGeometryGenerator{constructor(_){this.objects=null,this.useGroups=!0,this.applyWorldTransforms=!0,this.generateMissingAttributes=!0,this.overwriteIndex=!0,this.attributes=["position","normal","color","tangent","uv","uv2"],this._intermediateGeometry=new Map,this._geometryMergeSets=new WeakMap,this._mergeOrder=[],this._dummyMesh=null,this.setObjects(_||[])}_getDummyMesh(){if(!this._dummyMesh){const _=new MeshBasicMaterial,Z=new BufferGeometry;Z.setAttribute("position",new BufferAttribute(new Float32Array(9),3)),this._dummyMesh=new Mesh(Z,_)}return this._dummyMesh}_getMeshes(){const _=[];return flatTraverseMeshes(this.objects,Z=>{_.push(Z)}),_.sort((Z,te)=>Z.uuid>te.uuid?1:Z.uuid<te.uuid?-1:0),_.length===0&&_.push(this._getDummyMesh()),_}_updateIntermediateGeometries(){const{_intermediateGeometry:_}=this,Z=this._getMeshes(),te=new Set(_.keys()),ne={attributes:this.attributes,applyWorldTransforms:this.applyWorldTransforms};for(let ie=0,oe=Z.length;ie<oe;ie++){const se=Z[ie],ae=se.uuid;te.delete(ae);let le=_.get(ae);(!le||!le.isCompatible(se,this.attributes))&&(le&&le.dispose(),le=new BakedGeometry,_.set(ae,le)),le.updateFrom(se,ne)&&this.generateMissingAttributes&&setCommonAttributes(le,this.attributes)}te.forEach(ie=>{_.delete(ie)})}setObjects(_){Array.isArray(_)?this.objects=[..._]:this.objects=[_]}generate(_=new BufferGeometry){const{useGroups:Z,overwriteIndex:te,_intermediateGeometry:ne,_geometryMergeSets:ie}=this,oe=this._getMeshes(),se=[],ae=[],le=ie.get(_)||[];this._updateIntermediateGeometries();let ce=!1;oe.length!==le.length&&(ce=!0);for(let de=0,pe=oe.length;de<pe;de++){const he=oe[de],ge=ne.get(he.uuid);ae.push(ge);const me=le[de];!me||me.uuid!==ge.uuid?(se.push(!1),ce=!0):me.version!==ge.version?se.push(!1):se.push(!0)}mergeGeometryList(ae,_,{useGroups:Z,forceUpdate:ce,skipAssigningAttributes:se,overwriteIndex:te}),ce&&_.dispose(),ie.set(_,ae.map(de=>({version:de.version,uuid:de.uuid})));let fe=NO_CHANGE;return ce?fe=GEOMETRY_REBUILT:se.includes(!1)&&(fe=GEOMETRY_ADJUSTED),{changeType:fe,materials:getMaterials(oe),geometry:_}}}function getTextures$2(K){const _=new Set;for(let Z=0,te=K.length;Z<te;Z++){const ne=K[Z];for(const ie in ne){const oe=ne[ie];oe&&oe.isTexture&&_.add(oe)}}return Array.from(_)}function getLights$1(K){const _=[],Z=new Set;for(let ne=0,ie=K.length;ne<ie;ne++)K[ne].traverse(oe=>{oe.visible&&(oe.isRectAreaLight||oe.isSpotLight||oe.isPointLight||oe.isDirectionalLight)&&(_.push(oe),oe.iesMap&&Z.add(oe.iesMap))});const te=Array.from(Z).sort((ne,ie)=>ne.uuid<ie.uuid?1:ne.uuid>ie.uuid?-1:0);return{lights:_,iesTextures:te}}class PathTracingSceneGenerator{get initialized(){return!!this.bvh}constructor(_){this.bvhOptions={},this.attributes=["position","normal","tangent","color","uv","uv2"],this.generateBVH=!0,this.bvh=null,this.geometry=new BufferGeometry,this.staticGeometryGenerator=new StaticGeometryGenerator(_),this._bvhWorker=null,this._pendingGenerate=null,this._buildAsync=!1}setObjects(_){this.staticGeometryGenerator.setObjects(_)}setBVHWorker(_){this._bvhWorker=_}async generateAsync(_=null){if(!this._bvhWorker)throw new Error('PathTracingSceneGenerator: "setBVHWorker" must be called before "generateAsync" can be called.');if(this.bvh instanceof Promise)return this._pendingGenerate||(this._pendingGenerate=new Promise(async()=>(await this.bvh,this._pendingGenerate=null,this.generateAsync(_)))),this._pendingGenerate;{this._buildAsync=!0;const Z=this.generate(_);return this._buildAsync=!1,Z.bvh=this.bvh=await Z.bvh,Z}}generate(_=null){const{staticGeometryGenerator:Z,geometry:te,attributes:ne}=this,ie=Z.objects;Z.attributes=ne,ie.forEach(fe=>{fe.traverse(de=>{de.isSkinnedMesh&&de.skeleton&&de.skeleton.update()})});const oe=Z.generate(te),se=oe.materials,ae=getTextures$2(se),{lights:le,iesTextures:ce}=getLights$1(ie);if(oe.changeType!==NO_CHANGE&&updateMaterialIndexAttribute(te,se,se),this.generateBVH){if(this.bvh instanceof Promise)throw new Error("PathTracingSceneGenerator: BVH is already building asynchronously.");if(oe.changeType===GEOMETRY_REBUILT){const fe={strategy:SAH,maxLeafTris:1,indirect:!0,onProgress:_,...this.bvhOptions};this._buildAsync?this.bvh=this._bvhWorker.generate(te,fe):this.bvh=new MeshBVH(te,fe)}else oe.changeType===GEOMETRY_ADJUSTED&&this.bvh.refit()}return{bvhChanged:oe.changeType!==NO_CHANGE,bvh:this.bvh,lights:le,iesTextures:ce,geometry:te,materials:se,textures:ae,objects:ie}}}const _camera=new OrthographicCamera$1(-1,1,1,-1,0,1);class FullscreenTriangleGeometry extends BufferGeometry{constructor(){super(),this.setAttribute("position",new Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Float32BufferAttribute([0,2,0,0,2,0],2))}}const _geometry=new FullscreenTriangleGeometry;class FullScreenQuad{constructor(_){this._mesh=new Mesh(_geometry,_)}dispose(){this._mesh.geometry.dispose()}render(_){_.render(this._mesh,_camera)}get material(){return this._mesh.material}set material(_){this._mesh.material=_}}class MaterialBase extends ShaderMaterial{set needsUpdate(_){super.needsUpdate=!0,this.dispatchEvent({type:"recompilation"})}constructor(_){super(_);for(const Z in this.uniforms)Object.defineProperty(this,Z,{get(){return this.uniforms[Z].value},set(te){this.uniforms[Z].value=te}})}setDefine(_,Z=void 0){if(Z==null){if(_ in this.defines)return delete this.defines[_],this.needsUpdate=!0,!0}else if(this.defines[_]!==Z)return this.defines[_]=Z,this.needsUpdate=!0,!0;return!1}}class BlendMaterial extends MaterialBase{constructor(_){super({blending:NoBlending,uniforms:{target1:{value:null},target2:{value:null},opacity:{value:1}},vertexShader:`

				varying vec2 vUv;

				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}`,fragmentShader:`

				uniform float opacity;

				uniform sampler2D target1;
				uniform sampler2D target2;

				varying vec2 vUv;

				void main() {

					vec4 color1 = texture2D( target1, vUv );
					vec4 color2 = texture2D( target2, vUv );

					float invOpacity = 1.0 - opacity;
					float totalAlpha = color1.a * invOpacity + color2.a * opacity;

					if ( color1.a != 0.0 || color2.a != 0.0 ) {

						gl_FragColor.rgb = color1.rgb * ( invOpacity * color1.a / totalAlpha ) + color2.rgb * ( opacity * color2.a / totalAlpha );
						gl_FragColor.a = totalAlpha;

					} else {

						gl_FragColor = vec4( 0.0 );

					}

				}`}),this.setValues(_)}}function generateSobolFunctionVariants(K=1){let _="uint";return K>1&&(_="uvec"+K),`
		${_} sobolReverseBits( ${_} x ) {

			x = ( ( ( x & 0xaaaaaaaau ) >> 1 ) | ( ( x & 0x55555555u ) << 1 ) );
			x = ( ( ( x & 0xccccccccu ) >> 2 ) | ( ( x & 0x33333333u ) << 2 ) );
			x = ( ( ( x & 0xf0f0f0f0u ) >> 4 ) | ( ( x & 0x0f0f0f0fu ) << 4 ) );
			x = ( ( ( x & 0xff00ff00u ) >> 8 ) | ( ( x & 0x00ff00ffu ) << 8 ) );
			return ( ( x >> 16 ) | ( x << 16 ) );

		}

		${_} sobolHashCombine( uint seed, ${_} v ) {

			return seed ^ ( v + ${_}( ( seed << 6 ) + ( seed >> 2 ) ) );

		}

		${_} sobolLaineKarrasPermutation( ${_} x, ${_} seed ) {

			x += seed;
			x ^= x * 0x6c50b47cu;
			x ^= x * 0xb82f1e52u;
			x ^= x * 0xc7afe638u;
			x ^= x * 0x8d22f6e6u;
			return x;

		}

		${_} nestedUniformScrambleBase2( ${_} x, ${_} seed ) {

			x = sobolLaineKarrasPermutation( x, seed );
			x = sobolReverseBits( x );
			return x;

		}
	`}function generateSobolSampleFunctions(K=1){let _="uint",Z="float",te="",ne=".r",ie="1u";return K>1&&(_="uvec"+K,Z="vec"+K,te=K+"",K===2?(ne=".rg",ie="uvec2( 1u, 2u )"):K===3?(ne=".rgb",ie="uvec3( 1u, 2u, 3u )"):(ne="",ie="uvec4( 1u, 2u, 3u, 4u )")),`

		${Z} sobol${te}( int effect ) {

			uint seed = sobolGetSeed( sobolBounceIndex, uint( effect ) );
			uint index = sobolPathIndex;

			uint shuffle_seed = sobolHashCombine( seed, 0u );
			uint shuffled_index = nestedUniformScrambleBase2( sobolReverseBits( index ), shuffle_seed );
			${Z} sobol_pt = sobolGetTexturePoint( shuffled_index )${ne};
			${_} result = ${_}( sobol_pt * 16777216.0 );

			${_} seed2 = sobolHashCombine( seed, ${ie} );
			result = nestedUniformScrambleBase2( result, seed2 );

			return SOBOL_FACTOR * ${Z}( result >> 8 );

		}
	`}const sobol_common=`

	// Utils
	const float SOBOL_FACTOR = 1.0 / 16777216.0;
	const uint SOBOL_MAX_POINTS = 256u * 256u;

	${generateSobolFunctionVariants(1)}
	${generateSobolFunctionVariants(2)}
	${generateSobolFunctionVariants(3)}
	${generateSobolFunctionVariants(4)}

	uint sobolHash( uint x ) {

		// finalizer from murmurhash3
		x ^= x >> 16;
		x *= 0x85ebca6bu;
		x ^= x >> 13;
		x *= 0xc2b2ae35u;
		x ^= x >> 16;
		return x;

	}

`,sobol_point_generation=`

	const uint SOBOL_DIRECTIONS_1[ 32 ] = uint[ 32 ](
		0x80000000u, 0xc0000000u, 0xa0000000u, 0xf0000000u,
		0x88000000u, 0xcc000000u, 0xaa000000u, 0xff000000u,
		0x80800000u, 0xc0c00000u, 0xa0a00000u, 0xf0f00000u,
		0x88880000u, 0xcccc0000u, 0xaaaa0000u, 0xffff0000u,
		0x80008000u, 0xc000c000u, 0xa000a000u, 0xf000f000u,
		0x88008800u, 0xcc00cc00u, 0xaa00aa00u, 0xff00ff00u,
		0x80808080u, 0xc0c0c0c0u, 0xa0a0a0a0u, 0xf0f0f0f0u,
		0x88888888u, 0xccccccccu, 0xaaaaaaaau, 0xffffffffu
	);

	const uint SOBOL_DIRECTIONS_2[ 32 ] = uint[ 32 ](
		0x80000000u, 0xc0000000u, 0x60000000u, 0x90000000u,
		0xe8000000u, 0x5c000000u, 0x8e000000u, 0xc5000000u,
		0x68800000u, 0x9cc00000u, 0xee600000u, 0x55900000u,
		0x80680000u, 0xc09c0000u, 0x60ee0000u, 0x90550000u,
		0xe8808000u, 0x5cc0c000u, 0x8e606000u, 0xc5909000u,
		0x6868e800u, 0x9c9c5c00u, 0xeeee8e00u, 0x5555c500u,
		0x8000e880u, 0xc0005cc0u, 0x60008e60u, 0x9000c590u,
		0xe8006868u, 0x5c009c9cu, 0x8e00eeeeu, 0xc5005555u
	);

	const uint SOBOL_DIRECTIONS_3[ 32 ] = uint[ 32 ](
		0x80000000u, 0xc0000000u, 0x20000000u, 0x50000000u,
		0xf8000000u, 0x74000000u, 0xa2000000u, 0x93000000u,
		0xd8800000u, 0x25400000u, 0x59e00000u, 0xe6d00000u,
		0x78080000u, 0xb40c0000u, 0x82020000u, 0xc3050000u,
		0x208f8000u, 0x51474000u, 0xfbea2000u, 0x75d93000u,
		0xa0858800u, 0x914e5400u, 0xdbe79e00u, 0x25db6d00u,
		0x58800080u, 0xe54000c0u, 0x79e00020u, 0xb6d00050u,
		0x800800f8u, 0xc00c0074u, 0x200200a2u, 0x50050093u
	);

	const uint SOBOL_DIRECTIONS_4[ 32 ] = uint[ 32 ](
		0x80000000u, 0x40000000u, 0x20000000u, 0xb0000000u,
		0xf8000000u, 0xdc000000u, 0x7a000000u, 0x9d000000u,
		0x5a800000u, 0x2fc00000u, 0xa1600000u, 0xf0b00000u,
		0xda880000u, 0x6fc40000u, 0x81620000u, 0x40bb0000u,
		0x22878000u, 0xb3c9c000u, 0xfb65a000u, 0xddb2d000u,
		0x78022800u, 0x9c0b3c00u, 0x5a0fb600u, 0x2d0ddb00u,
		0xa2878080u, 0xf3c9c040u, 0xdb65a020u, 0x6db2d0b0u,
		0x800228f8u, 0x400b3cdcu, 0x200fb67au, 0xb00ddb9du
	);

	uint getMaskedSobol( uint index, uint directions[ 32 ] ) {

		uint X = 0u;
		for ( int bit = 0; bit < 32; bit ++ ) {

			uint mask = ( index >> bit ) & 1u;
			X ^= mask * directions[ bit ];

		}
		return X;

	}

	vec4 generateSobolPoint( uint index ) {

		if ( index >= SOBOL_MAX_POINTS ) {

			return vec4( 0.0 );

		}

		// NOTE: this sobol "direction" is also available but we can't write out 5 components
		// uint x = index & 0x00ffffffu;
		uint x = sobolReverseBits( getMaskedSobol( index, SOBOL_DIRECTIONS_1 ) ) & 0x00ffffffu;
		uint y = sobolReverseBits( getMaskedSobol( index, SOBOL_DIRECTIONS_2 ) ) & 0x00ffffffu;
		uint z = sobolReverseBits( getMaskedSobol( index, SOBOL_DIRECTIONS_3 ) ) & 0x00ffffffu;
		uint w = sobolReverseBits( getMaskedSobol( index, SOBOL_DIRECTIONS_4 ) ) & 0x00ffffffu;

		return vec4( x, y, z, w ) * SOBOL_FACTOR;

	}

`,sobol_functions=`

	// Seeds
	uniform sampler2D sobolTexture;
	uint sobolPixelIndex = 0u;
	uint sobolPathIndex = 0u;
	uint sobolBounceIndex = 0u;

	uint sobolGetSeed( uint bounce, uint effect ) {

		return sobolHash(
			sobolHashCombine(
				sobolHashCombine(
					sobolHash( bounce ),
					sobolPixelIndex
				),
				effect
			)
		);

	}

	vec4 sobolGetTexturePoint( uint index ) {

		if ( index >= SOBOL_MAX_POINTS ) {

			index = index % SOBOL_MAX_POINTS;

		}

		uvec2 dim = uvec2( textureSize( sobolTexture, 0 ).xy );
		uint y = index / dim.x;
		uint x = index - y * dim.x;
		vec2 uv = vec2( x, y ) / vec2( dim );
		return texture( sobolTexture, uv );

	}

	${generateSobolSampleFunctions(1)}
	${generateSobolSampleFunctions(2)}
	${generateSobolSampleFunctions(3)}
	${generateSobolSampleFunctions(4)}

`;class SobolNumbersMaterial extends MaterialBase{constructor(){super({blending:NoBlending,uniforms:{resolution:{value:new Vector2}},vertexShader:`

				varying vec2 vUv;
				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}
			`,fragmentShader:`

				${sobol_common}
				${sobol_point_generation}

				varying vec2 vUv;
				uniform vec2 resolution;
				void main() {

					uint index = uint( gl_FragCoord.y ) * uint( resolution.x ) + uint( gl_FragCoord.x );
					gl_FragColor = generateSobolPoint( index );

				}
			`})}}class SobolNumberMapGenerator{generate(_,Z=256){const te=new WebGLRenderTarget(Z,Z,{type:FloatType,format:RGBAFormat,minFilter:NearestFilter,magFilter:NearestFilter,generateMipmaps:!1}),ne=_.getRenderTarget();_.setRenderTarget(te);const ie=new FullScreenQuad(new SobolNumbersMaterial);return ie.material.resolution.set(Z,Z),ie.render(_),_.setRenderTarget(ne),ie.dispose(),te}}class PhysicalCamera extends PerspectiveCamera$2{set bokehSize(_){this.fStop=this.getFocalLength()/_}get bokehSize(){return this.getFocalLength()/this.fStop}constructor(..._){super(..._),this.fStop=1.4,this.apertureBlades=0,this.apertureRotation=0,this.focusDistance=25,this.anamorphicRatio=1}copy(_,Z){return super.copy(_,Z),this.fStop=_.fStop,this.apertureBlades=_.apertureBlades,this.apertureRotation=_.apertureRotation,this.focusDistance=_.focusDistance,this.anamorphicRatio=_.anamorphicRatio,this}}class PhysicalCameraUniform{constructor(){this.bokehSize=0,this.apertureBlades=0,this.apertureRotation=0,this.focusDistance=10,this.anamorphicRatio=1}updateFrom(_){_ instanceof PhysicalCamera?(this.bokehSize=_.bokehSize,this.apertureBlades=_.apertureBlades,this.apertureRotation=_.apertureRotation,this.focusDistance=_.focusDistance,this.anamorphicRatio=_.anamorphicRatio):(this.bokehSize=0,this.apertureRotation=0,this.apertureBlades=0,this.focusDistance=10,this.anamorphicRatio=1)}}function toHalfFloatArray(K){const _=new Uint16Array(K.length);for(let Z=0,te=K.length;Z<te;++Z)_[Z]=DataUtils.toHalfFloat(K[Z]);return _}function binarySearchFindClosestIndexOf(K,_,Z=0,te=K.length){let ne=Z,ie=Z+te-1;for(;ne<ie;){const oe=ne+ie>>1;K[oe]<_?ne=oe+1:ie=oe}return ne-Z}function colorToLuminance(K,_,Z){return .2126*K+.7152*_+.0722*Z}function preprocessEnvMap(K,_=HalfFloatType){const Z=K.clone();Z.source=new Source({...Z.image});const{width:te,height:ne,data:ie}=Z.image;let oe=ie;if(Z.type!==_){_===HalfFloatType?oe=new Uint16Array(ie.length):oe=new Float32Array(ie.length);let se;ie instanceof Int8Array||ie instanceof Int16Array||ie instanceof Int32Array?se=2**(8*ie.BYTES_PER_ELEMENT-1)-1:se=2**(8*ie.BYTES_PER_ELEMENT)-1;for(let ae=0,le=ie.length;ae<le;ae++){let ce=ie[ae];Z.type===HalfFloatType&&(ce=DataUtils.fromHalfFloat(ie[ae])),Z.type!==FloatType&&Z.type!==HalfFloatType&&(ce/=se),_===HalfFloatType&&(oe[ae]=DataUtils.toHalfFloat(ce))}Z.image.data=oe,Z.type=_}if(Z.flipY){const se=oe;oe=oe.slice();for(let ae=0;ae<ne;ae++)for(let le=0;le<te;le++){const ce=ne-ae-1,fe=4*(ae*te+le),de=4*(ce*te+le);oe[de+0]=se[fe+0],oe[de+1]=se[fe+1],oe[de+2]=se[fe+2],oe[de+3]=se[fe+3]}Z.flipY=!1,Z.image.data=oe}return Z}class EquirectHdrInfoUniform{constructor(){const _=new DataTexture(toHalfFloatArray(new Float32Array([0,0,0,0])),1,1);_.type=HalfFloatType,_.format=RGBAFormat,_.minFilter=LinearFilter,_.magFilter=LinearFilter,_.wrapS=RepeatWrapping,_.wrapT=RepeatWrapping,_.generateMipmaps=!1,_.needsUpdate=!0;const Z=new DataTexture(toHalfFloatArray(new Float32Array([0,1])),1,2);Z.type=HalfFloatType,Z.format=RedFormat,Z.minFilter=LinearFilter,Z.magFilter=LinearFilter,Z.generateMipmaps=!1,Z.needsUpdate=!0;const te=new DataTexture(toHalfFloatArray(new Float32Array([0,0,1,1])),2,2);te.type=HalfFloatType,te.format=RedFormat,te.minFilter=LinearFilter,te.magFilter=LinearFilter,te.generateMipmaps=!1,te.needsUpdate=!0,this.map=_,this.marginalWeights=Z,this.conditionalWeights=te,this.totalSum=0}dispose(){this.marginalWeights.dispose(),this.conditionalWeights.dispose(),this.map.dispose()}updateFrom(_){const Z=preprocessEnvMap(_);Z.wrapS=RepeatWrapping,Z.wrapT=ClampToEdgeWrapping;const{width:te,height:ne,data:ie}=Z.image,oe=new Float32Array(te*ne),se=new Float32Array(te*ne),ae=new Float32Array(ne),le=new Float32Array(ne);let ce=0,fe=0;for(let me=0;me<ne;me++){let Ae=0;for(let ye=0;ye<te;ye++){const ve=me*te+ye,_e=DataUtils.fromHalfFloat(ie[4*ve+0]),Te=DataUtils.fromHalfFloat(ie[4*ve+1]),be=DataUtils.fromHalfFloat(ie[4*ve+2]),Re=colorToLuminance(_e,Te,be);Ae+=Re,ce+=Re,oe[ve]=Re,se[ve]=Ae}if(Ae!==0)for(let ye=me*te,ve=me*te+te;ye<ve;ye++)oe[ye]/=Ae,se[ye]/=Ae;fe+=Ae,ae[me]=Ae,le[me]=fe}if(fe!==0)for(let me=0,Ae=ae.length;me<Ae;me++)ae[me]/=fe,le[me]/=fe;const de=new Uint16Array(ne),pe=new Uint16Array(te*ne);for(let me=0;me<ne;me++){const Ae=(me+1)/ne,ye=binarySearchFindClosestIndexOf(le,Ae);de[me]=DataUtils.toHalfFloat((ye+.5)/ne)}for(let me=0;me<ne;me++)for(let Ae=0;Ae<te;Ae++){const ye=me*te+Ae,ve=(Ae+1)/te,_e=binarySearchFindClosestIndexOf(se,ve,me*te,te);pe[ye]=DataUtils.toHalfFloat((_e+.5)/te)}this.dispose();const{marginalWeights:he,conditionalWeights:ge}=this;he.image={width:ne,height:1,data:de},he.needsUpdate=!0,ge.image={width:te,height:ne,data:pe},ge.needsUpdate=!0,this.totalSum=ce,this.map=Z}}const LIGHT_PIXELS=6,RECT_AREA_LIGHT=0,CIRC_AREA_LIGHT=1,SPOT_LIGHT=2,DIR_LIGHT=3,POINT_LIGHT=4,u$c=new Vector3,v=new Vector3,m=new Matrix4,worldQuaternion=new Quaternion,eye=new Vector3,target$1=new Vector3,up=new Vector3(0,1,0);class LightsInfoUniformStruct{constructor(){const _=new DataTexture(new Float32Array(4),1,1);_.format=RGBAFormat,_.type=FloatType,_.wrapS=ClampToEdgeWrapping,_.wrapT=ClampToEdgeWrapping,_.generateMipmaps=!1,_.minFilter=NearestFilter,_.magFilter=NearestFilter,this.tex=_,this.count=0}updateFrom(_,Z=[]){const te=this.tex,ne=Math.max(_.length*LIGHT_PIXELS,1),ie=Math.ceil(Math.sqrt(ne));te.image.width!==ie&&(te.dispose(),te.image.data=new Float32Array(ie*ie*4),te.image.width=ie,te.image.height=ie);const oe=te.image.data;for(let ae=0,le=_.length;ae<le;ae++){const ce=_[ae],fe=ae*LIGHT_PIXELS*4;let de=0;for(let he=0;he<LIGHT_PIXELS*4;he++)oe[fe+he]=0;ce.getWorldPosition(v),oe[fe+de++]=v.x,oe[fe+de++]=v.y,oe[fe+de++]=v.z;let pe=RECT_AREA_LIGHT;if(ce.isRectAreaLight&&ce.isCircular?pe=CIRC_AREA_LIGHT:ce.isSpotLight?pe=SPOT_LIGHT:ce.isDirectionalLight?pe=DIR_LIGHT:ce.isPointLight&&(pe=POINT_LIGHT),oe[fe+de++]=pe,oe[fe+de++]=ce.color.r,oe[fe+de++]=ce.color.g,oe[fe+de++]=ce.color.b,oe[fe+de++]=ce.intensity,ce.getWorldQuaternion(worldQuaternion),ce.isRectAreaLight)u$c.set(ce.width,0,0).applyQuaternion(worldQuaternion),oe[fe+de++]=u$c.x,oe[fe+de++]=u$c.y,oe[fe+de++]=u$c.z,de++,v.set(0,ce.height,0).applyQuaternion(worldQuaternion),oe[fe+de++]=v.x,oe[fe+de++]=v.y,oe[fe+de++]=v.z,oe[fe+de++]=u$c.cross(v).length()*(ce.isCircular?Math.PI/4:1);else if(ce.isSpotLight){const he=ce.radius||0;eye.setFromMatrixPosition(ce.matrixWorld),target$1.setFromMatrixPosition(ce.target.matrixWorld),m.lookAt(eye,target$1,up),worldQuaternion.setFromRotationMatrix(m),u$c.set(1,0,0).applyQuaternion(worldQuaternion),oe[fe+de++]=u$c.x,oe[fe+de++]=u$c.y,oe[fe+de++]=u$c.z,de++,v.set(0,1,0).applyQuaternion(worldQuaternion),oe[fe+de++]=v.x,oe[fe+de++]=v.y,oe[fe+de++]=v.z,oe[fe+de++]=Math.PI*he*he,oe[fe+de++]=he,oe[fe+de++]=ce.decay,oe[fe+de++]=ce.distance,oe[fe+de++]=Math.cos(ce.angle),oe[fe+de++]=Math.cos(ce.angle*(1-ce.penumbra)),oe[fe+de++]=ce.iesMap?Z.indexOf(ce.iesMap):-1}else if(ce.isPointLight){const he=u$c.setFromMatrixPosition(ce.matrixWorld);oe[fe+de++]=he.x,oe[fe+de++]=he.y,oe[fe+de++]=he.z,de++,de+=4,de+=1,oe[fe+de++]=ce.decay,oe[fe+de++]=ce.distance}else if(ce.isDirectionalLight){const he=u$c.setFromMatrixPosition(ce.matrixWorld),ge=v.setFromMatrixPosition(ce.target.matrixWorld);target$1.subVectors(he,ge).normalize(),oe[fe+de++]=target$1.x,oe[fe+de++]=target$1.y,oe[fe+de++]=target$1.z}}this.count=_.length;const se=bufferToHash(oe.buffer);return this.hash!==se?(this.hash=se,te.needsUpdate=!0,!0):!1}}function copyArrayToArray(K,_,Z,te,ne){if(_>te)throw new Error;const ie=K.length/_,oe=K.constructor.BYTES_PER_ELEMENT*8;let se=1;switch(K.constructor){case Uint8Array:case Uint16Array:case Uint32Array:se=2**oe-1;break;case Int8Array:case Int16Array:case Int32Array:se=2**(oe-1)-1;break}for(let ae=0;ae<ie;ae++){const le=4*ae,ce=_*ae;for(let fe=0;fe<te;fe++)Z[ne+le+fe]=_>=fe+1?K[ce+fe]/se:0}}class FloatAttributeTextureArray extends DataArrayTexture{constructor(){super(),this._textures=[],this.type=FloatType,this.format=RGBAFormat,this.internalFormat="RGBA32F"}updateAttribute(_,Z){const te=this._textures[_];te.updateFrom(Z);const ne=te.image,ie=this.image;if(ne.width!==ie.width||ne.height!==ie.height)throw new Error("FloatAttributeTextureArray: Attribute must be the same dimensions when updating single layer.");const{width:oe,height:se,data:ae}=ie,ce=oe*se*4*_;let fe=Z.itemSize;fe===3&&(fe=4),copyArrayToArray(te.image.data,fe,ae,4,ce),this.dispose(),this.needsUpdate=!0}setAttributes(_){const Z=_[0].count,te=_.length;for(let fe=0,de=te;fe<de;fe++)if(_[fe].count!==Z)throw new Error("FloatAttributeTextureArray: All attributes must have the same item count.");const ne=this._textures;for(;ne.length<te;){const fe=new FloatVertexAttributeTexture;ne.push(fe)}for(;ne.length>te;)ne.pop();for(let fe=0,de=te;fe<de;fe++)ne[fe].updateFrom(_[fe]);const oe=ne[0].image,se=this.image;(oe.width!==se.width||oe.height!==se.height||oe.depth!==te)&&(se.width=oe.width,se.height=oe.height,se.depth=te,se.data=new Float32Array(se.width*se.height*se.depth*4));const{data:ae,width:le,height:ce}=se;for(let fe=0,de=te;fe<de;fe++){const pe=ne[fe],ge=le*ce*4*fe;let me=_[fe].itemSize;me===3&&(me=4),copyArrayToArray(pe.image.data,me,ae,4,ge)}this.dispose(),this.needsUpdate=!0}}class AttributesTextureArray extends FloatAttributeTextureArray{updateNormalAttribute(_){this.updateAttribute(0,_)}updateTangentAttribute(_){this.updateAttribute(1,_)}updateUvAttribute(_){this.updateAttribute(2,_)}updateColorAttribute(_){this.updateAttribute(3,_)}updateFrom(_,Z,te,ne){this.setAttributes([_,Z,te,ne])}}function uuidSort(K,_){return K.uuid<_.uuid?1:K.uuid>_.uuid?-1:0}function getTextureHash$1(K){return`${K.source.uuid}:${K.colorSpace}`}function reduceTexturesToUniqueSources(K){const _=new Set,Z=[];for(let te=0,ne=K.length;te<ne;te++){const ie=K[te],oe=getTextureHash$1(ie);_.has(oe)||(_.add(oe),Z.push(ie))}return Z}function getIesTextures(K){const _=K.map(te=>te.iesMap||null).filter(te=>te),Z=new Set(_);return Array.from(Z).sort(uuidSort)}function getTextures$1(K){const _=new Set;for(let te=0,ne=K.length;te<ne;te++){const ie=K[te];for(const oe in ie){const se=ie[oe];se&&se.isTexture&&_.add(se)}}const Z=Array.from(_);return reduceTexturesToUniqueSources(Z).sort(uuidSort)}function getLights(K){const _=[];return K.traverse(Z=>{Z.visible&&(Z.isRectAreaLight||Z.isSpotLight||Z.isPointLight||Z.isDirectionalLight)&&_.push(Z)}),_.sort(uuidSort)}const MATERIAL_PIXELS=45,MATERIAL_STRIDE=MATERIAL_PIXELS*4;class MaterialFeatures{constructor(){this._features={}}isUsed(_){return _ in this._features}setUsed(_,Z=!0){Z===!1?delete this._features[_]:this._features[_]=!0}reset(){this._features={}}}class MaterialsTexture extends DataTexture{constructor(){super(new Float32Array(4),1,1),this.format=RGBAFormat,this.type=FloatType,this.wrapS=ClampToEdgeWrapping,this.wrapT=ClampToEdgeWrapping,this.minFilter=NearestFilter,this.magFilter=NearestFilter,this.generateMipmaps=!1,this.features=new MaterialFeatures}updateFrom(_,Z){function te(he,ge,me=-1){if(ge in he&&he[ge]){const Ae=getTextureHash$1(he[ge]);return fe[Ae]}else return me}function ne(he,ge,me){return ge in he?he[ge]:me}function ie(he,ge,me,Ae){const ye=he[ge]&&he[ge].isTexture?he[ge]:null;if(ye){ye.matrixAutoUpdate&&ye.updateMatrix();const ve=ye.matrix.elements;let _e=0;me[Ae+_e++]=ve[0],me[Ae+_e++]=ve[3],me[Ae+_e++]=ve[6],_e++,me[Ae+_e++]=ve[1],me[Ae+_e++]=ve[4],me[Ae+_e++]=ve[7],_e++}return 8}let oe=0;const se=_.length*MATERIAL_PIXELS,ae=Math.ceil(Math.sqrt(se))||1,{image:le,features:ce}=this,fe={};for(let he=0,ge=Z.length;he<ge;he++)fe[getTextureHash$1(Z[he])]=he;le.width!==ae&&(this.dispose(),le.data=new Float32Array(ae*ae*4),le.width=ae,le.height=ae);const de=le.data;ce.reset();for(let he=0,ge=_.length;he<ge;he++){const me=_[he];if(me.isFogVolumeMaterial){ce.setUsed("FOG");for(let ve=0;ve<MATERIAL_STRIDE;ve++)de[oe+ve]=0;de[oe+0*4+0]=me.color.r,de[oe+0*4+1]=me.color.g,de[oe+0*4+2]=me.color.b,de[oe+2*4+3]=ne(me,"emissiveIntensity",0),de[oe+3*4+0]=me.emissive.r,de[oe+3*4+1]=me.emissive.g,de[oe+3*4+2]=me.emissive.b,de[oe+13*4+1]=me.density,de[oe+13*4+3]=0,de[oe+14*4+2]=4,oe+=MATERIAL_STRIDE;continue}de[oe++]=me.color.r,de[oe++]=me.color.g,de[oe++]=me.color.b,de[oe++]=te(me,"map"),de[oe++]=ne(me,"metalness",0),de[oe++]=te(me,"metalnessMap"),de[oe++]=ne(me,"roughness",0),de[oe++]=te(me,"roughnessMap"),de[oe++]=ne(me,"ior",1.5),de[oe++]=ne(me,"transmission",0),de[oe++]=te(me,"transmissionMap"),de[oe++]=ne(me,"emissiveIntensity",0),"emissive"in me?(de[oe++]=me.emissive.r,de[oe++]=me.emissive.g,de[oe++]=me.emissive.b):(de[oe++]=0,de[oe++]=0,de[oe++]=0),de[oe++]=te(me,"emissiveMap"),de[oe++]=te(me,"normalMap"),"normalScale"in me?(de[oe++]=me.normalScale.x,de[oe++]=me.normalScale.y):(de[oe++]=1,de[oe++]=1),de[oe++]=ne(me,"clearcoat",0),de[oe++]=te(me,"clearcoatMap"),de[oe++]=ne(me,"clearcoatRoughness",0),de[oe++]=te(me,"clearcoatRoughnessMap"),de[oe++]=te(me,"clearcoatNormalMap"),"clearcoatNormalScale"in me?(de[oe++]=me.clearcoatNormalScale.x,de[oe++]=me.clearcoatNormalScale.y):(de[oe++]=1,de[oe++]=1),oe++,de[oe++]=ne(me,"sheen",0),"sheenColor"in me?(de[oe++]=me.sheenColor.r,de[oe++]=me.sheenColor.g,de[oe++]=me.sheenColor.b):(de[oe++]=0,de[oe++]=0,de[oe++]=0),de[oe++]=te(me,"sheenColorMap"),de[oe++]=ne(me,"sheenRoughness",0),de[oe++]=te(me,"sheenRoughnessMap"),de[oe++]=te(me,"iridescenceMap"),de[oe++]=te(me,"iridescenceThicknessMap"),de[oe++]=ne(me,"iridescence",0),de[oe++]=ne(me,"iridescenceIOR",1.3);const Ae=ne(me,"iridescenceThicknessRange",[100,400]);de[oe++]=Ae[0],de[oe++]=Ae[1],"specularColor"in me?(de[oe++]=me.specularColor.r,de[oe++]=me.specularColor.g,de[oe++]=me.specularColor.b):(de[oe++]=1,de[oe++]=1,de[oe++]=1),de[oe++]=te(me,"specularColorMap"),de[oe++]=ne(me,"specularIntensity",1),de[oe++]=te(me,"specularIntensityMap");const ye=ne(me,"thickness",0)===0&&ne(me,"attenuationDistance",1/0)===1/0;if(de[oe++]=Number(ye),oe++,"attenuationColor"in me?(de[oe++]=me.attenuationColor.r,de[oe++]=me.attenuationColor.g,de[oe++]=me.attenuationColor.b):(de[oe++]=1,de[oe++]=1,de[oe++]=1),de[oe++]=ne(me,"attenuationDistance",1/0),de[oe++]=te(me,"alphaMap"),de[oe++]=me.opacity,de[oe++]=me.alphaTest,!ye&&me.transmission>0)de[oe++]=0;else switch(me.side){case FrontSide:de[oe++]=1;break;case BackSide:de[oe++]=-1;break;case DoubleSide:de[oe++]=0;break}de[oe++]=Number(ne(me,"matte",!1)),de[oe++]=Number(ne(me,"castShadow",!0)),de[oe++]=Number(me.vertexColors)|Number(me.flatShading)<<1,de[oe++]=Number(me.transparent),oe+=ie(me,"map",de,oe),oe+=ie(me,"metalnessMap",de,oe),oe+=ie(me,"roughnessMap",de,oe),oe+=ie(me,"transmissionMap",de,oe),oe+=ie(me,"emissiveMap",de,oe),oe+=ie(me,"normalMap",de,oe),oe+=ie(me,"clearcoatMap",de,oe),oe+=ie(me,"clearcoatNormalMap",de,oe),oe+=ie(me,"clearcoatRoughnessMap",de,oe),oe+=ie(me,"sheenColorMap",de,oe),oe+=ie(me,"sheenRoughnessMap",de,oe),oe+=ie(me,"iridescenceMap",de,oe),oe+=ie(me,"iridescenceThicknessMap",de,oe),oe+=ie(me,"specularColorMap",de,oe),oe+=ie(me,"specularIntensityMap",de,oe)}const pe=bufferToHash(de.buffer);return this.hash!==pe?(this.hash=pe,this.needsUpdate=!0,!0):!1}}const prevColor=new Color$1;function getTextureHash(K){return K?`${K.uuid}:${K.version}`:null}function assignOptions(K,_){for(const Z in _)Z in K&&(K[Z]=_[Z])}class RenderTarget2DArray extends WebGLArrayRenderTarget{constructor(_,Z,te){const ne={format:RGBAFormat,type:UnsignedByteType,minFilter:LinearFilter,magFilter:LinearFilter,wrapS:RepeatWrapping,wrapT:RepeatWrapping,generateMipmaps:!1,...te};super(_,Z,1,ne),assignOptions(this.texture,ne),this.texture.setTextures=(...oe)=>{this.setTextures(...oe)},this.hashes=[null];const ie=new FullScreenQuad(new CopyMaterial);this.fsQuad=ie}setTextures(_,Z,te=this.width,ne=this.height){const ie=_.getRenderTarget(),oe=_.toneMapping,se=_.getClearAlpha();_.getClearColor(prevColor);const ae=Z.length||1;(te!==this.width||ne!==this.height||this.depth!==ae)&&(this.setSize(te,ne,ae),this.hashes=new Array(ae).fill(null)),_.setClearColor(0,0),_.toneMapping=NoToneMapping;const le=this.fsQuad,ce=this.hashes;let fe=!1;for(let de=0,pe=ae;de<pe;de++){const he=Z[de],ge=getTextureHash(he);he&&(ce[de]!==ge||he.isWebGLRenderTarget)&&(he.matrixAutoUpdate=!1,he.matrix.identity(),le.material.map=he,_.setRenderTarget(this,de),le.render(_),he.updateMatrix(),he.matrixAutoUpdate=!0,ce[de]=ge,fe=!0)}return le.material.map=null,_.setClearColor(prevColor,se),_.setRenderTarget(ie),_.toneMapping=oe,fe}dispose(){super.dispose(),this.fsQuad.dispose()}}class CopyMaterial extends ShaderMaterial{get map(){return this.uniforms.map.value}set map(_){this.uniforms.map.value=_}constructor(){super({uniforms:{map:{value:null}},vertexShader:`
				varying vec2 vUv;
				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}
			`,fragmentShader:`
				uniform sampler2D map;
				varying vec2 vUv;
				void main() {

					gl_FragColor = texture2D( map, vUv );

				}
			`})}}function shuffle(K,_=Math.random()){for(let Z=K.length-1;Z>0;Z--){const te=Math.floor(_()*(Z+1)),ne=K[Z];K[Z]=K[te],K[te]=ne}return K}class StratifiedSampler{constructor(_,Z,te=Math.random){const ne=_**Z,ie=new Uint16Array(ne);let oe=ne;for(let se=0;se<ne;se++)ie[se]=se;this.samples=new Float32Array(Z),this.strataCount=_,this.reset=function(){for(let se=0;se<ne;se++)ie[se]=se;oe=0},this.reshuffle=function(){oe=0},this.next=function(){const{samples:se}=this;oe>=ie.length&&(shuffle(ie,te),this.reshuffle());let ae=ie[oe++];for(let le=0;le<Z;le++)se[le]=(ae%_+te())/_,ae=Math.floor(ae/_);return se}}}class StratifiedSamplerCombined{constructor(_,Z,te=Math.random){let ne=0;for(const ae of Z)ne+=ae;const ie=new Float32Array(ne),oe=[];let se=0;for(const ae of Z){const le=new StratifiedSampler(_,ae,te);le.samples=new Float32Array(ie.buffer,se,le.samples.length),se+=le.samples.length*4,oe.push(le)}this.samples=ie,this.strataCount=_,this.next=function(){for(const ae of oe)ae.next();return ie},this.reshuffle=function(){for(const ae of oe)ae.reshuffle()},this.reset=function(){for(const ae of oe)ae.reset()}}}class RandomGenerator{constructor(_=0){this.m=2147483648,this.a=1103515245,this.c=12345,this.seed=_}nextInt(){return this.seed=(this.a*this.seed+this.c)%this.m,this.seed}nextFloat(){return this.nextInt()/(this.m-1)}}class StratifiedSamplesTexture extends DataTexture{constructor(_=1,Z=1,te=8){super(new Float32Array(1),1,1,RGBAFormat,FloatType),this.minFilter=NearestFilter,this.magFilter=NearestFilter,this.strata=te,this.sampler=null,this.generator=new RandomGenerator,this.stableNoise=!1,this.random=()=>this.stableNoise?this.generator.nextFloat():Math.random(),this.init(_,Z,te)}init(_=this.image.height,Z=this.image.width,te=this.strata){const{image:ne}=this;if(ne.width===Z&&ne.height===_&&this.sampler!==null)return;const ie=new Array(_*Z).fill(4),oe=new StratifiedSamplerCombined(te,ie,this.random);ne.width=Z,ne.height=_,ne.data=oe.samples,this.sampler=oe,this.dispose(),this.next()}next(){this.sampler.next(),this.needsUpdate=!0}reset(){this.sampler.reset(),this.generator.seed=0}}function shuffleArray(K,_=Math.random){for(let Z=K.length-1;Z>0;Z--){const te=~~((_()-1e-6)*Z),ne=K[Z];K[Z]=K[te],K[te]=ne}}function fillWithOnes(K,_){K.fill(0);for(let Z=0;Z<_;Z++)K[Z]=1}class BlueNoiseSamples{constructor(_){this.count=0,this.size=-1,this.sigma=-1,this.radius=-1,this.lookupTable=null,this.score=null,this.binaryPattern=null,this.resize(_),this.setSigma(1.5)}findVoid(){const{score:_,binaryPattern:Z}=this;let te=1/0,ne=-1;for(let ie=0,oe=Z.length;ie<oe;ie++){if(Z[ie]!==0)continue;const se=_[ie];se<te&&(te=se,ne=ie)}return ne}findCluster(){const{score:_,binaryPattern:Z}=this;let te=-1/0,ne=-1;for(let ie=0,oe=Z.length;ie<oe;ie++){if(Z[ie]!==1)continue;const se=_[ie];se>te&&(te=se,ne=ie)}return ne}setSigma(_){if(_===this.sigma)return;const Z=~~(Math.sqrt(10*2*_**2)+1),te=2*Z+1,ne=new Float32Array(te*te),ie=_*_;for(let oe=-Z;oe<=Z;oe++)for(let se=-Z;se<=Z;se++){const ae=(Z+se)*te+oe+Z,le=oe*oe+se*se;ne[ae]=Math.E**(-le/(2*ie))}this.lookupTable=ne,this.sigma=_,this.radius=Z}resize(_){this.size!==_&&(this.size=_,this.score=new Float32Array(_*_),this.binaryPattern=new Uint8Array(_*_))}invert(){const{binaryPattern:_,score:Z,size:te}=this;Z.fill(0);for(let ne=0,ie=_.length;ne<ie;ne++)if(_[ne]===0){const oe=~~(ne/te),se=ne-oe*te;this.updateScore(se,oe,1),_[ne]=1}else _[ne]=0}updateScore(_,Z,te){const{size:ne,score:ie,lookupTable:oe}=this,se=this.radius,ae=2*se+1;for(let le=-se;le<=se;le++)for(let ce=-se;ce<=se;ce++){const fe=(se+ce)*ae+le+se,de=oe[fe];let pe=_+le;pe=pe<0?ne+pe:pe%ne;let he=Z+ce;he=he<0?ne+he:he%ne;const ge=he*ne+pe;ie[ge]+=te*de}}addPointIndex(_){this.binaryPattern[_]=1;const Z=this.size,te=~~(_/Z),ne=_-te*Z;this.updateScore(ne,te,1),this.count++}removePointIndex(_){this.binaryPattern[_]=0;const Z=this.size,te=~~(_/Z),ne=_-te*Z;this.updateScore(ne,te,-1),this.count--}copy(_){this.resize(_.size),this.score.set(_.score),this.binaryPattern.set(_.binaryPattern),this.setSigma(_.sigma),this.count=_.count}}class BlueNoiseGenerator{constructor(){this.random=Math.random,this.sigma=1.5,this.size=64,this.majorityPointsRatio=.1,this.samples=new BlueNoiseSamples(1),this.savedSamples=new BlueNoiseSamples(1)}generate(){const{samples:_,savedSamples:Z,sigma:te,majorityPointsRatio:ne,size:ie}=this;_.resize(ie),_.setSigma(te);const oe=Math.floor(ie*ie*ne),se=_.binaryPattern;fillWithOnes(se,oe),shuffleArray(se,this.random);for(let fe=0,de=se.length;fe<de;fe++)se[fe]===1&&_.addPointIndex(fe);for(;;){const fe=_.findCluster();_.removePointIndex(fe);const de=_.findVoid();if(fe===de){_.addPointIndex(fe);break}_.addPointIndex(de)}const ae=new Uint32Array(ie*ie);Z.copy(_);let le;for(le=_.count-1;le>=0;){const fe=_.findCluster();_.removePointIndex(fe),ae[fe]=le,le--}const ce=ie*ie;for(le=Z.count;le<ce/2;){const fe=Z.findVoid();Z.addPointIndex(fe),ae[fe]=le,le++}for(Z.invert();le<ce;){const fe=Z.findCluster();Z.removePointIndex(fe),ae[fe]=le,le++}return{data:ae,maxValue:ce}}}function getStride(K){return K>=3?4:K}function getFormat(K){switch(K){case 1:return RedFormat;case 2:return RGFormat;default:return RGBAFormat}}class BlueNoiseTexture extends DataTexture{constructor(_=64,Z=1){super(new Float32Array(4),1,1,RGBAFormat,FloatType),this.minFilter=NearestFilter,this.magFilter=NearestFilter,this.size=_,this.channels=Z,this.update()}update(){const _=this.channels,Z=this.size,te=new BlueNoiseGenerator;te.channels=_,te.size=Z;const ne=getStride(_),ie=getFormat(ne);(this.image.width!==Z||ie!==this.format)&&(this.image.width=Z,this.image.height=Z,this.image.data=new Float32Array(Z**2*ne),this.format=ie,this.dispose());const oe=this.image.data;for(let se=0,ae=_;se<ae;se++){const le=te.generate(),ce=le.data,fe=le.maxValue;for(let de=0,pe=ce.length;de<pe;de++){const he=ce[de]/fe;oe[de*ne+se]=he}}this.needsUpdate=!0}}const camera_struct=`

	struct PhysicalCamera {

		float focusDistance;
		float anamorphicRatio;
		float bokehSize;
		int apertureBlades;
		float apertureRotation;

	};

`,equirect_struct=`

	struct EquirectHdrInfo {

		sampler2D marginalWeights;
		sampler2D conditionalWeights;
		sampler2D map;

		float totalSum;

	};

`,lights_struct=`

	#define RECT_AREA_LIGHT_TYPE 0
	#define CIRC_AREA_LIGHT_TYPE 1
	#define SPOT_LIGHT_TYPE 2
	#define DIR_LIGHT_TYPE 3
	#define POINT_LIGHT_TYPE 4

	struct LightsInfo {

		sampler2D tex;
		uint count;

	};

	struct Light {

		vec3 position;
		int type;

		vec3 color;
		float intensity;

		vec3 u;
		vec3 v;
		float area;

		// spot light fields
		float radius;
		float near;
		float decay;
		float distance;
		float coneCos;
		float penumbraCos;
		int iesProfile;

	};

	Light readLightInfo( sampler2D tex, uint index ) {

		uint i = index * 6u;

		vec4 s0 = texelFetch1D( tex, i + 0u );
		vec4 s1 = texelFetch1D( tex, i + 1u );
		vec4 s2 = texelFetch1D( tex, i + 2u );
		vec4 s3 = texelFetch1D( tex, i + 3u );

		Light l;
		l.position = s0.rgb;
		l.type = int( round( s0.a ) );

		l.color = s1.rgb;
		l.intensity = s1.a;

		l.u = s2.rgb;
		l.v = s3.rgb;
		l.area = s3.a;

		if ( l.type == SPOT_LIGHT_TYPE || l.type == POINT_LIGHT_TYPE ) {

			vec4 s4 = texelFetch1D( tex, i + 4u );
			vec4 s5 = texelFetch1D( tex, i + 5u );
			l.radius = s4.r;
			l.decay = s4.g;
			l.distance = s4.b;
			l.coneCos = s4.a;

			l.penumbraCos = s5.r;
			l.iesProfile = int( round( s5.g ) );

		} else {

			l.radius = 0.0;
			l.decay = 0.0;
			l.distance = 0.0;

			l.coneCos = 0.0;
			l.penumbraCos = 0.0;
			l.iesProfile = - 1;

		}

		return l;

	}

`,material_struct=`

	struct Material {

		vec3 color;
		int map;

		float metalness;
		int metalnessMap;

		float roughness;
		int roughnessMap;

		float ior;
		float transmission;
		int transmissionMap;

		float emissiveIntensity;
		vec3 emissive;
		int emissiveMap;

		int normalMap;
		vec2 normalScale;

		float clearcoat;
		int clearcoatMap;
		int clearcoatNormalMap;
		vec2 clearcoatNormalScale;
		float clearcoatRoughness;
		int clearcoatRoughnessMap;

		int iridescenceMap;
		int iridescenceThicknessMap;
		float iridescence;
		float iridescenceIor;
		float iridescenceThicknessMinimum;
		float iridescenceThicknessMaximum;

		vec3 specularColor;
		int specularColorMap;

		float specularIntensity;
		int specularIntensityMap;
		bool thinFilm;

		vec3 attenuationColor;
		float attenuationDistance;

		int alphaMap;

		bool castShadow;
		float opacity;
		float alphaTest;

		float side;
		bool matte;

		float sheen;
		vec3 sheenColor;
		int sheenColorMap;
		float sheenRoughness;
		int sheenRoughnessMap;

		bool vertexColors;
		bool flatShading;
		bool transparent;
		bool fogVolume;

		mat3 mapTransform;
		mat3 metalnessMapTransform;
		mat3 roughnessMapTransform;
		mat3 transmissionMapTransform;
		mat3 emissiveMapTransform;
		mat3 normalMapTransform;
		mat3 clearcoatMapTransform;
		mat3 clearcoatNormalMapTransform;
		mat3 clearcoatRoughnessMapTransform;
		mat3 sheenColorMapTransform;
		mat3 sheenRoughnessMapTransform;
		mat3 iridescenceMapTransform;
		mat3 iridescenceThicknessMapTransform;
		mat3 specularColorMapTransform;
		mat3 specularIntensityMapTransform;

	};

	mat3 readTextureTransform( sampler2D tex, uint index ) {

		mat3 textureTransform;

		vec4 row1 = texelFetch1D( tex, index );
		vec4 row2 = texelFetch1D( tex, index + 1u );

		textureTransform[0] = vec3(row1.r, row2.r, 0.0);
		textureTransform[1] = vec3(row1.g, row2.g, 0.0);
		textureTransform[2] = vec3(row1.b, row2.b, 1.0);

		return textureTransform;

	}

	Material readMaterialInfo( sampler2D tex, uint index ) {

		uint i = index * 45u;

		vec4 s0 = texelFetch1D( tex, i + 0u );
		vec4 s1 = texelFetch1D( tex, i + 1u );
		vec4 s2 = texelFetch1D( tex, i + 2u );
		vec4 s3 = texelFetch1D( tex, i + 3u );
		vec4 s4 = texelFetch1D( tex, i + 4u );
		vec4 s5 = texelFetch1D( tex, i + 5u );
		vec4 s6 = texelFetch1D( tex, i + 6u );
		vec4 s7 = texelFetch1D( tex, i + 7u );
		vec4 s8 = texelFetch1D( tex, i + 8u );
		vec4 s9 = texelFetch1D( tex, i + 9u );
		vec4 s10 = texelFetch1D( tex, i + 10u );
		vec4 s11 = texelFetch1D( tex, i + 11u );
		vec4 s12 = texelFetch1D( tex, i + 12u );
		vec4 s13 = texelFetch1D( tex, i + 13u );
		vec4 s14 = texelFetch1D( tex, i + 14u );

		Material m;
		m.color = s0.rgb;
		m.map = int( round( s0.a ) );

		m.metalness = s1.r;
		m.metalnessMap = int( round( s1.g ) );
		m.roughness = s1.b;
		m.roughnessMap = int( round( s1.a ) );

		m.ior = s2.r;
		m.transmission = s2.g;
		m.transmissionMap = int( round( s2.b ) );
		m.emissiveIntensity = s2.a;

		m.emissive = s3.rgb;
		m.emissiveMap = int( round( s3.a ) );

		m.normalMap = int( round( s4.r ) );
		m.normalScale = s4.gb;

		m.clearcoat = s4.a;
		m.clearcoatMap = int( round( s5.r ) );
		m.clearcoatRoughness = s5.g;
		m.clearcoatRoughnessMap = int( round( s5.b ) );
		m.clearcoatNormalMap = int( round( s5.a ) );
		m.clearcoatNormalScale = s6.rg;

		m.sheen = s6.a;
		m.sheenColor = s7.rgb;
		m.sheenColorMap = int( round( s7.a ) );
		m.sheenRoughness = s8.r;
		m.sheenRoughnessMap = int( round( s8.g ) );

		m.iridescenceMap = int( round( s8.b ) );
		m.iridescenceThicknessMap = int( round( s8.a ) );
		m.iridescence = s9.r;
		m.iridescenceIor = s9.g;
		m.iridescenceThicknessMinimum = s9.b;
		m.iridescenceThicknessMaximum = s9.a;

		m.specularColor = s10.rgb;
		m.specularColorMap = int( round( s10.a ) );

		m.specularIntensity = s11.r;
		m.specularIntensityMap = int( round( s11.g ) );
		m.thinFilm = bool( s11.b );

		m.attenuationColor = s12.rgb;
		m.attenuationDistance = s12.a;

		m.alphaMap = int( round( s13.r ) );

		m.opacity = s13.g;
		m.alphaTest = s13.b;
		m.side = s13.a;

		m.matte = bool( s14.r );
		m.castShadow = bool( s14.g );
		m.vertexColors = bool( int( s14.b ) & 1 );
		m.flatShading = bool( int( s14.b ) & 2 );
		m.fogVolume = bool( int( s14.b ) & 4 );
		m.transparent = bool( s14.a );

		uint firstTextureTransformIdx = i + 15u;

		// mat3( 1.0 ) is an identity matrix
		m.mapTransform = m.map == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx );
		m.metalnessMapTransform = m.metalnessMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 2u );
		m.roughnessMapTransform = m.roughnessMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 4u );
		m.transmissionMapTransform = m.transmissionMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 6u );
		m.emissiveMapTransform = m.emissiveMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 8u );
		m.normalMapTransform = m.normalMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 10u );
		m.clearcoatMapTransform = m.clearcoatMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 12u );
		m.clearcoatNormalMapTransform = m.clearcoatNormalMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 14u );
		m.clearcoatRoughnessMapTransform = m.clearcoatRoughnessMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 16u );
		m.sheenColorMapTransform = m.sheenColorMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 18u );
		m.sheenRoughnessMapTransform = m.sheenRoughnessMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 20u );
		m.iridescenceMapTransform = m.iridescenceMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 22u );
		m.iridescenceThicknessMapTransform = m.iridescenceThicknessMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 24u );
		m.specularColorMapTransform = m.specularColorMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 26u );
		m.specularIntensityMapTransform = m.specularIntensityMap == - 1 ? mat3( 1.0 ) : readTextureTransform( tex, firstTextureTransformIdx + 28u );

		return m;

	}

`,surface_record_struct=`

	struct SurfaceRecord {

		// surface type
		bool volumeParticle;

		// geometry
		vec3 faceNormal;
		bool frontFace;
		vec3 normal;
		mat3 normalBasis;
		mat3 normalInvBasis;

		// cached properties
		float eta;
		float f0;

		// material
		float roughness;
		float filteredRoughness;
		float metalness;
		vec3 color;
		vec3 emission;

		// transmission
		float ior;
		float transmission;
		bool thinFilm;
		vec3 attenuationColor;
		float attenuationDistance;

		// clearcoat
		vec3 clearcoatNormal;
		mat3 clearcoatBasis;
		mat3 clearcoatInvBasis;
		float clearcoat;
		float clearcoatRoughness;
		float filteredClearcoatRoughness;

		// sheen
		float sheen;
		vec3 sheenColor;
		float sheenRoughness;

		// iridescence
		float iridescence;
		float iridescenceIor;
		float iridescenceThickness;

		// specular
		vec3 specularColor;
		float specularIntensity;
	};

	struct ScatterRecord {
		float specularPdf;
		float pdf;
		vec3 direction;
		vec3 color;
	};

`,equirect_functions=`

	// samples the the given environment map in the given direction
	vec3 sampleEquirectColor( sampler2D envMap, vec3 direction ) {

		return texture2D( envMap, equirectDirectionToUv( direction ) ).rgb;

	}

	// gets the pdf of the given direction to sample
	float equirectDirectionPdf( vec3 direction ) {

		vec2 uv = equirectDirectionToUv( direction );
		float theta = uv.y * PI;
		float sinTheta = sin( theta );
		if ( sinTheta == 0.0 ) {

			return 0.0;

		}

		return 1.0 / ( 2.0 * PI * PI * sinTheta );

	}

	// samples the color given env map with CDF and returns the pdf of the direction
	float sampleEquirect( vec3 direction, inout vec3 color ) {

		float totalSum = envMapInfo.totalSum;
		if ( totalSum == 0.0 ) {

			color = vec3( 0.0 );
			return 1.0;

		}

		vec2 uv = equirectDirectionToUv( direction );
		color = texture2D( envMapInfo.map, uv ).rgb;

		float lum = luminance( color );
		ivec2 resolution = textureSize( envMapInfo.map, 0 );
		float pdf = lum / totalSum;

		return float( resolution.x * resolution.y ) * pdf * equirectDirectionPdf( direction );

	}

	// samples a direction of the envmap with color and retrieves pdf
	float sampleEquirectProbability( vec2 r, inout vec3 color, inout vec3 direction ) {

		// sample env map cdf
		float v = texture2D( envMapInfo.marginalWeights, vec2( r.x, 0.0 ) ).x;
		float u = texture2D( envMapInfo.conditionalWeights, vec2( r.y, v ) ).x;
		vec2 uv = vec2( u, v );

		vec3 derivedDirection = equirectUvToDirection( uv );
		direction = derivedDirection;
		color = texture2D( envMapInfo.map, uv ).rgb;

		float totalSum = envMapInfo.totalSum;
		float lum = luminance( color );
		ivec2 resolution = textureSize( envMapInfo.map, 0 );
		float pdf = lum / totalSum;

		return float( resolution.x * resolution.y ) * pdf * equirectDirectionPdf( direction );

	}
`,light_sampling_functions=`

	float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

		return smoothstep( coneCosine, penumbraCosine, angleCosine );

	}

	float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), EPSILON );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	}

	float getPhotometricAttenuation( sampler2DArray iesProfiles, int iesProfile, vec3 posToLight, vec3 lightDir, vec3 u, vec3 v ) {

		float cosTheta = dot( posToLight, lightDir );
		float angle = acos( cosTheta ) / PI;

		return texture2D( iesProfiles, vec3( angle, 0.0, iesProfile ) ).r;

	}

	struct LightRecord {

		float dist;
		vec3 direction;
		float pdf;
		vec3 emission;
		int type;

	};

	bool intersectLightAtIndex( sampler2D lights, vec3 rayOrigin, vec3 rayDirection, uint l, inout LightRecord lightRec ) {

		bool didHit = false;
		Light light = readLightInfo( lights, l );

		vec3 u = light.u;
		vec3 v = light.v;

		// check for backface
		vec3 normal = normalize( cross( u, v ) );
		if ( dot( normal, rayDirection ) > 0.0 ) {

			u *= 1.0 / dot( u, u );
			v *= 1.0 / dot( v, v );

			float dist;

			// MIS / light intersection is not supported for punctual lights.
			if(
				( light.type == RECT_AREA_LIGHT_TYPE && intersectsRectangle( light.position, normal, u, v, rayOrigin, rayDirection, dist ) ) ||
				( light.type == CIRC_AREA_LIGHT_TYPE && intersectsCircle( light.position, normal, u, v, rayOrigin, rayDirection, dist ) )
			) {

				float cosTheta = dot( rayDirection, normal );
				didHit = true;
				lightRec.dist = dist;
				lightRec.pdf = ( dist * dist ) / ( light.area * cosTheta );
				lightRec.emission = light.color * light.intensity;
				lightRec.direction = rayDirection;
				lightRec.type = light.type;

			}

		}

		return didHit;

	}

	LightRecord randomAreaLightSample( Light light, vec3 rayOrigin, vec2 ruv ) {

		vec3 randomPos;
		if( light.type == RECT_AREA_LIGHT_TYPE ) {

			// rectangular area light
			randomPos = light.position + light.u * ( ruv.x - 0.5 ) + light.v * ( ruv.y - 0.5 );

		} else if( light.type == CIRC_AREA_LIGHT_TYPE ) {

			// circular area light
			float r = 0.5 * sqrt( ruv.x );
			float theta = ruv.y * 2.0 * PI;
			float x = r * cos( theta );
			float y = r * sin( theta );

			randomPos = light.position + light.u * x + light.v * y;

		}

		vec3 toLight = randomPos - rayOrigin;
		float lightDistSq = dot( toLight, toLight );
		float dist = sqrt( lightDistSq );
		vec3 direction = toLight / dist;
		vec3 lightNormal = normalize( cross( light.u, light.v ) );

		LightRecord lightRec;
		lightRec.type = light.type;
		lightRec.emission = light.color * light.intensity;
		lightRec.dist = dist;
		lightRec.direction = direction;

		// TODO: the denominator is potentially zero
		lightRec.pdf = lightDistSq / ( light.area * dot( direction, lightNormal ) );

		return lightRec;

	}

	LightRecord randomSpotLightSample( Light light, sampler2DArray iesProfiles, vec3 rayOrigin, vec2 ruv ) {

		float radius = light.radius * sqrt( ruv.x );
		float theta = ruv.y * 2.0 * PI;
		float x = radius * cos( theta );
		float y = radius * sin( theta );

		vec3 u = light.u;
		vec3 v = light.v;
		vec3 normal = normalize( cross( u, v ) );

		float angle = acos( light.coneCos );
		float angleTan = tan( angle );
		float startDistance = light.radius / max( angleTan, EPSILON );

		vec3 randomPos = light.position - normal * startDistance + u * x + v * y;
		vec3 toLight = randomPos - rayOrigin;
		float lightDistSq = dot( toLight, toLight );
		float dist = sqrt( lightDistSq );

		vec3 direction = toLight / max( dist, EPSILON );
		float cosTheta = dot( direction, normal );

		float spotAttenuation = light.iesProfile != - 1 ?
			getPhotometricAttenuation( iesProfiles, light.iesProfile, direction, normal, u, v ) :
			getSpotAttenuation( light.coneCos, light.penumbraCos, cosTheta );

		float distanceAttenuation = getDistanceAttenuation( dist, light.distance, light.decay );
		LightRecord lightRec;
		lightRec.type = light.type;
		lightRec.dist = dist;
		lightRec.direction = direction;
		lightRec.emission = light.color * light.intensity * distanceAttenuation * spotAttenuation;
		lightRec.pdf = 1.0;

		return lightRec;

	}

	LightRecord randomLightSample( sampler2D lights, sampler2DArray iesProfiles, uint lightCount, vec3 rayOrigin, vec3 ruv ) {

		LightRecord result;

		// pick a random light
		uint l = uint( ruv.x * float( lightCount ) );
		Light light = readLightInfo( lights, l );

		if ( light.type == SPOT_LIGHT_TYPE ) {

			result = randomSpotLightSample( light, iesProfiles, rayOrigin, ruv.yz );

		} else if ( light.type == POINT_LIGHT_TYPE ) {

			vec3 lightRay = light.u - rayOrigin;
			float lightDist = length( lightRay );
			float cutoffDistance = light.distance;
			float distanceFalloff = 1.0 / max( pow( lightDist, light.decay ), 0.01 );
			if ( cutoffDistance > 0.0 ) {

				distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDist / cutoffDistance ) ) );

			}

			LightRecord rec;
			rec.direction = normalize( lightRay );
			rec.dist = length( lightRay );
			rec.pdf = 1.0;
			rec.emission = light.color * light.intensity * distanceFalloff;
			rec.type = light.type;
			result = rec;

		} else if ( light.type == DIR_LIGHT_TYPE ) {

			LightRecord rec;
			rec.dist = 1e10;
			rec.direction = light.u;
			rec.pdf = 1.0;
			rec.emission = light.color * light.intensity;
			rec.type = light.type;

			result = rec;

		} else {

			// sample the light
			result = randomAreaLightSample( light, rayOrigin, ruv.yz );

		}

		return result;

	}

`,shape_sampling_functions=`

	vec3 sampleHemisphere( vec3 n, vec2 uv ) {

		// https://www.rorydriscoll.com/2009/01/07/better-sampling/
		// https://graphics.pixar.com/library/OrthonormalB/paper.pdf
		float sign = n.z == 0.0 ? 1.0 : sign( n.z );
		float a = - 1.0 / ( sign + n.z );
		float b = n.x * n.y * a;
		vec3 b1 = vec3( 1.0 + sign * n.x * n.x * a, sign * b, - sign * n.x );
		vec3 b2 = vec3( b, sign + n.y * n.y * a, - n.y );

		float r = sqrt( uv.x );
		float theta = 2.0 * PI * uv.y;
		float x = r * cos( theta );
		float y = r * sin( theta );
		return x * b1 + y * b2 + sqrt( 1.0 - uv.x ) * n;

	}

	vec2 sampleTriangle( vec2 a, vec2 b, vec2 c, vec2 r ) {

		// get the edges of the triangle and the diagonal across the
		// center of the parallelogram
		vec2 e1 = a - b;
		vec2 e2 = c - b;
		vec2 diag = normalize( e1 + e2 );

		// pick the point in the parallelogram
		if ( r.x + r.y > 1.0 ) {

			r = vec2( 1.0 ) - r;

		}

		return e1 * r.x + e2 * r.y;

	}

	vec2 sampleCircle( vec2 uv ) {

		float angle = 2.0 * PI * uv.x;
		float radius = sqrt( uv.y );
		return vec2( cos( angle ), sin( angle ) ) * radius;

	}

	vec3 sampleSphere( vec2 uv ) {

		float u = ( uv.x - 0.5 ) * 2.0;
		float t = uv.y * PI * 2.0;
		float f = sqrt( 1.0 - u * u );

		return vec3( f * cos( t ), f * sin( t ), u );

	}

	vec2 sampleRegularPolygon( int sides, vec3 uvw ) {

		sides = max( sides, 3 );

		vec3 r = uvw;
		float anglePerSegment = 2.0 * PI / float( sides );
		float segment = floor( float( sides ) * r.x );

		float angle1 = anglePerSegment * segment;
		float angle2 = angle1 + anglePerSegment;
		vec2 a = vec2( sin( angle1 ), cos( angle1 ) );
		vec2 b = vec2( 0.0, 0.0 );
		vec2 c = vec2( sin( angle2 ), cos( angle2 ) );

		return sampleTriangle( a, b, c, r.yz );

	}

	// samples an aperture shape with the given number of sides. 0 means circle
	vec2 sampleAperture( int blades, vec3 uvw ) {

		return blades == 0 ?
			sampleCircle( uvw.xy ) :
			sampleRegularPolygon( blades, uvw );

	}


`,fresnel_functions=`

	bool totalInternalReflection( float cosTheta, float eta ) {

		float sinTheta = sqrt( 1.0 - cosTheta * cosTheta );
		return eta * sinTheta > 1.0;

	}

	// https://google.github.io/filament/Filament.md.html#materialsystem/diffusebrdf
	float schlickFresnel( float cosine, float f0 ) {

		return f0 + ( 1.0 - f0 ) * pow( 1.0 - cosine, 5.0 );

	}

	vec3 schlickFresnel( float cosine, vec3 f0 ) {

		return f0 + ( 1.0 - f0 ) * pow( 1.0 - cosine, 5.0 );

	}

	vec3 schlickFresnel( float cosine, vec3 f0, vec3 f90 ) {

		return f0 + ( f90 - f0 ) * pow( 1.0 - cosine, 5.0 );

	}

	float dielectricFresnel( float cosThetaI, float eta ) {

		// https://schuttejoe.github.io/post/disneybsdf/
		float ni = eta;
		float nt = 1.0;

		// Check for total internal reflection
		float sinThetaISq = 1.0f - cosThetaI * cosThetaI;
		float sinThetaTSq = eta * eta * sinThetaISq;
		if( sinThetaTSq >= 1.0 ) {

			return 1.0;

		}

		float sinThetaT = sqrt( sinThetaTSq );

		float cosThetaT = sqrt( max( 0.0, 1.0f - sinThetaT * sinThetaT ) );
		float rParallel = ( ( nt * cosThetaI ) - ( ni * cosThetaT ) ) / ( ( nt * cosThetaI ) + ( ni * cosThetaT ) );
		float rPerpendicular = ( ( ni * cosThetaI ) - ( nt * cosThetaT ) ) / ( ( ni * cosThetaI ) + ( nt * cosThetaT ) );
		return ( rParallel * rParallel + rPerpendicular * rPerpendicular ) / 2.0;

	}

	// https://raytracing.github.io/books/RayTracingInOneWeekend.html#dielectrics/schlickapproximation
	float iorRatioToF0( float eta ) {

		return pow( ( 1.0 - eta ) / ( 1.0 + eta ), 2.0 );

	}

	vec3 evaluateFresnel( float cosTheta, float eta, vec3 f0, vec3 f90 ) {

		if ( totalInternalReflection( cosTheta, eta ) ) {

			return f90;

		}

		return schlickFresnel( cosTheta, f0, f90 );

	}

	// TODO: disney fresnel was removed and replaced with this fresnel function to better align with
	// the glTF but is causing blown out pixels. Should be revisited
	// float evaluateFresnelWeight( float cosTheta, float eta, float f0 ) {

	// 	if ( totalInternalReflection( cosTheta, eta ) ) {

	// 		return 1.0;

	// 	}

	// 	return schlickFresnel( cosTheta, f0 );

	// }

	// https://schuttejoe.github.io/post/disneybsdf/
	float disneyFresnel( vec3 wo, vec3 wi, vec3 wh, float f0, float eta, float metalness ) {

		float dotHV = dot( wo, wh );
		if ( totalInternalReflection( dotHV, eta ) ) {

			return 1.0;

		}

		float dotHL = dot( wi, wh );
		float dielectricFresnel = dielectricFresnel( abs( dotHV ), eta );
		float metallicFresnel = schlickFresnel( dotHL, f0 );

		return mix( dielectricFresnel, metallicFresnel, metalness );

	}

`,math_functions=`

	// Fast arccos approximation used to remove banding artifacts caused by numerical errors in acos.
	// This is a cubic Lagrange interpolating polynomial for x = [-1, -1/2, 0, 1/2, 1].
	// For more information see: https://github.com/gkjohnson/three-gpu-pathtracer/pull/171#issuecomment-1152275248
	float acosApprox( float x ) {

		x = clamp( x, -1.0, 1.0 );
		return ( - 0.69813170079773212 * x * x - 0.87266462599716477 ) * x + 1.5707963267948966;

	}

	// An acos with input values bound to the range [-1, 1].
	float acosSafe( float x ) {

		return acos( clamp( x, -1.0, 1.0 ) );

	}

	float saturateCos( float val ) {

		return clamp( val, 0.001, 1.0 );

	}

	float square( float t ) {

		return t * t;

	}

	vec2 square( vec2 t ) {

		return t * t;

	}

	vec3 square( vec3 t ) {

		return t * t;

	}

	vec4 square( vec4 t ) {

		return t * t;

	}

	vec2 rotateVector( vec2 v, float t ) {

		float ac = cos( t );
		float as = sin( t );
		return vec2(
			v.x * ac - v.y * as,
			v.x * as + v.y * ac
		);

	}

	// forms a basis with the normal vector as Z
	mat3 getBasisFromNormal( vec3 normal ) {

		vec3 other;
		if ( abs( normal.x ) > 0.5 ) {

			other = vec3( 0.0, 1.0, 0.0 );

		} else {

			other = vec3( 1.0, 0.0, 0.0 );

		}

		vec3 ortho = normalize( cross( normal, other ) );
		vec3 ortho2 = normalize( cross( normal, ortho ) );
		return mat3( ortho2, ortho, normal );

	}

`,shape_intersection_functions=`

	// Finds the point where the ray intersects the plane defined by u and v and checks if this point
	// falls in the bounds of the rectangle on that same plane.
	// Plane intersection: https://lousodrome.net/blog/light/2020/07/03/intersection-of-a-ray-and-a-plane/
	bool intersectsRectangle( vec3 center, vec3 normal, vec3 u, vec3 v, vec3 rayOrigin, vec3 rayDirection, inout float dist ) {

		float t = dot( center - rayOrigin, normal ) / dot( rayDirection, normal );

		if ( t > EPSILON ) {

			vec3 p = rayOrigin + rayDirection * t;
			vec3 vi = p - center;

			// check if p falls inside the rectangle
			float a1 = dot( u, vi );
			if ( abs( a1 ) <= 0.5 ) {

				float a2 = dot( v, vi );
				if ( abs( a2 ) <= 0.5 ) {

					dist = t;
					return true;

				}

			}

		}

		return false;

	}

	// Finds the point where the ray intersects the plane defined by u and v and checks if this point
	// falls in the bounds of the circle on that same plane. See above URL for a description of the plane intersection algorithm.
	bool intersectsCircle( vec3 position, vec3 normal, vec3 u, vec3 v, vec3 rayOrigin, vec3 rayDirection, inout float dist ) {

		float t = dot( position - rayOrigin, normal ) / dot( rayDirection, normal );

		if ( t > EPSILON ) {

			vec3 hit = rayOrigin + rayDirection * t;
			vec3 vi = hit - position;

			float a1 = dot( u, vi );
			float a2 = dot( v, vi );

			if( length( vec2( a1, a2 ) ) <= 0.5 ) {

				dist = t;
				return true;

			}

		}

		return false;

	}

`,texture_sample_functions=`

	// add texel fetch functions for texture arrays
	vec4 texelFetch1D( sampler2DArray tex, int layer, uint index ) {

		uint width = uint( textureSize( tex, 0 ).x );
		uvec2 uv;
		uv.x = index % width;
		uv.y = index / width;

		return texelFetch( tex, ivec3( uv, layer ), 0 );

	}

	vec4 textureSampleBarycoord( sampler2DArray tex, int layer, vec3 barycoord, uvec3 faceIndices ) {

		return
			barycoord.x * texelFetch1D( tex, layer, faceIndices.x ) +
			barycoord.y * texelFetch1D( tex, layer, faceIndices.y ) +
			barycoord.z * texelFetch1D( tex, layer, faceIndices.z );

	}

`,util_functions=`

	// TODO: possibly this should be renamed something related to material or path tracing logic

	#ifndef RAY_OFFSET
	#define RAY_OFFSET 1e-4
	#endif

	// adjust the hit point by the surface normal by a factor of some offset and the
	// maximum component-wise value of the current point to accommodate floating point
	// error as values increase.
	vec3 stepRayOrigin( vec3 rayOrigin, vec3 rayDirection, vec3 offset, float dist ) {

		vec3 point = rayOrigin + rayDirection * dist;
		vec3 absPoint = abs( point );
		float maxPoint = max( absPoint.x, max( absPoint.y, absPoint.z ) );
		return point + offset * ( maxPoint + 1.0 ) * RAY_OFFSET;

	}

	// https://github.com/KhronosGroup/glTF/blob/main/extensions/2.0/Khronos/KHR_materials_volume/README.md#attenuation
	vec3 transmissionAttenuation( float dist, vec3 attColor, float attDist ) {

		vec3 ot = - log( attColor ) / attDist;
		return exp( - ot * dist );

	}

	vec3 getHalfVector( vec3 wi, vec3 wo, float eta ) {

		// get the half vector - assuming if the light incident vector is on the other side
		// of the that it's transmissive.
		vec3 h;
		if ( wi.z > 0.0 ) {

			h = normalize( wi + wo );

		} else {

			// Scale by the ior ratio to retrieve the appropriate half vector
			// From Section 2.2 on computing the transmission half vector:
			// https://blog.selfshadow.com/publications/s2015-shading-course/burley/s2015_pbs_disney_bsdf_notes.pdf
			h = normalize( wi + wo * eta );

		}

		h *= sign( h.z );
		return h;

	}

	vec3 getHalfVector( vec3 a, vec3 b ) {

		return normalize( a + b );

	}

	// The discrepancy between interpolated surface normal and geometry normal can cause issues when a ray
	// is cast that is on the top side of the geometry normal plane but below the surface normal plane. If
	// we find a ray like that we ignore it to avoid artifacts.
	// This function returns if the direction is on the same side of both planes.
	bool isDirectionValid( vec3 direction, vec3 surfaceNormal, vec3 geometryNormal ) {

		bool aboveSurfaceNormal = dot( direction, surfaceNormal ) > 0.0;
		bool aboveGeometryNormal = dot( direction, geometryNormal ) > 0.0;
		return aboveSurfaceNormal == aboveGeometryNormal;

	}

	// ray sampling x and z are swapped to align with expected background view
	vec2 equirectDirectionToUv( vec3 direction ) {

		// from Spherical.setFromCartesianCoords
		vec2 uv = vec2( atan( direction.z, direction.x ), acos( direction.y ) );
		uv /= vec2( 2.0 * PI, PI );

		// apply adjustments to get values in range [0, 1] and y right side up
		uv.x += 0.5;
		uv.y = 1.0 - uv.y;
		return uv;

	}

	vec3 equirectUvToDirection( vec2 uv ) {

		// undo above adjustments
		uv.x -= 0.5;
		uv.y = 1.0 - uv.y;

		// from Vector3.setFromSphericalCoords
		float theta = uv.x * 2.0 * PI;
		float phi = uv.y * PI;

		float sinPhi = sin( phi );

		return vec3( sinPhi * cos( theta ), cos( phi ), sinPhi * sin( theta ) );

	}

	// power heuristic for multiple importance sampling
	float misHeuristic( float a, float b ) {

		float aa = a * a;
		float bb = b * b;
		return aa / ( aa + bb );

	}

	// tentFilter from Peter Shirley's 'Realistic Ray Tracing (2nd Edition)' book, pg. 60
	// erichlof/THREE.js-PathTracing-Renderer/
	float tentFilter( float x ) {

		return x < 0.5 ? sqrt( 2.0 * x ) - 1.0 : 1.0 - sqrt( 2.0 - ( 2.0 * x ) );

	}
`,pcg_functions=`

	// https://www.shadertoy.com/view/wltcRS
	uvec4 WHITE_NOISE_SEED;

	void rng_initialize( vec2 p, int frame ) {

		// white noise seed
		WHITE_NOISE_SEED = uvec4( p, uint( frame ), uint( p.x ) + uint( p.y ) );

	}

	// https://www.pcg-random.org/
	void pcg4d( inout uvec4 v ) {

		v = v * 1664525u + 1013904223u;
		v.x += v.y * v.w;
		v.y += v.z * v.x;
		v.z += v.x * v.y;
		v.w += v.y * v.z;
		v = v ^ ( v >> 16u );
		v.x += v.y*v.w;
		v.y += v.z*v.x;
		v.z += v.x*v.y;
		v.w += v.y*v.z;

	}

	// returns [ 0, 1 ]
	float pcgRand() {

		pcg4d( WHITE_NOISE_SEED );
		return float( WHITE_NOISE_SEED.x ) / float( 0xffffffffu );

	}

	vec2 pcgRand2() {

		pcg4d( WHITE_NOISE_SEED );
		return vec2( WHITE_NOISE_SEED.xy ) / float(0xffffffffu);

	}

	vec3 pcgRand3() {

		pcg4d( WHITE_NOISE_SEED );
		return vec3( WHITE_NOISE_SEED.xyz ) / float( 0xffffffffu );

	}

	vec4 pcgRand4() {

		pcg4d( WHITE_NOISE_SEED );
		return vec4( WHITE_NOISE_SEED ) / float( 0xffffffffu );

	}
`,stratified_functions=`

	uniform sampler2D stratifiedTexture;
	uniform sampler2D stratifiedOffsetTexture;

	uint sobolPixelIndex = 0u;
	uint sobolPathIndex = 0u;
	uint sobolBounceIndex = 0u;
	vec4 pixelSeed = vec4( 0 );

	vec4 rand4( int v ) {

		ivec2 uv = ivec2( v, sobolBounceIndex );
		vec4 stratifiedSample = texelFetch( stratifiedTexture, uv, 0 );
		return fract( stratifiedSample + pixelSeed.r ); // blue noise + stratified samples

	}

	vec3 rand3( int v ) {

		return rand4( v ).xyz;

	}

	vec2 rand2( int v ) {

		return rand4( v ).xy;

	}

	float rand( int v ) {

		return rand4( v ).x;

	}

	void rng_initialize( vec2 screenCoord, int frame ) {

		// tile the small noise texture across the entire screen
		ivec2 noiseSize = ivec2( textureSize( stratifiedOffsetTexture, 0 ) );
		ivec2 pixel = ivec2( screenCoord.xy ) % noiseSize;
		vec2 pixelWidth = 1.0 / vec2( noiseSize );
		vec2 uv = vec2( pixel ) * pixelWidth + pixelWidth * 0.5;

		// note that using "texelFetch" here seems to break Android for some reason
		pixelSeed = texture( stratifiedOffsetTexture, uv );

	}

`,bsdf_functions=`

	// diffuse
	float diffuseEval( vec3 wo, vec3 wi, vec3 wh, SurfaceRecord surf, inout vec3 color ) {

		// https://schuttejoe.github.io/post/disneybsdf/
		float fl = schlickFresnel( wi.z, 0.0 );
		float fv = schlickFresnel( wo.z, 0.0 );

		float metalFactor = ( 1.0 - surf.metalness );
		float transFactor = ( 1.0 - surf.transmission );
		float rr = 0.5 + 2.0 * surf.roughness * fl * fl;
		float retro = rr * ( fl + fv + fl * fv * ( rr - 1.0f ) );
		float lambert = ( 1.0f - 0.5f * fl ) * ( 1.0f - 0.5f * fv );

		// TODO: subsurface approx?

		// float F = evaluateFresnelWeight( dot( wo, wh ), surf.eta, surf.f0 );
		float F = disneyFresnel( wo, wi, wh, surf.f0, surf.eta, surf.metalness );
		color = ( 1.0 - F ) * transFactor * metalFactor * wi.z * surf.color * ( retro + lambert ) / PI;

		return wi.z / PI;

	}

	vec3 diffuseDirection( vec3 wo, SurfaceRecord surf ) {

		vec3 lightDirection = sampleSphere( rand2( 11 ) );
		lightDirection.z += 1.0;
		lightDirection = normalize( lightDirection );

		return lightDirection;

	}

	// specular
	float specularEval( vec3 wo, vec3 wi, vec3 wh, SurfaceRecord surf, inout vec3 color ) {

		// if roughness is set to 0 then D === NaN which results in black pixels
		float metalness = surf.metalness;
		float roughness = surf.filteredRoughness;

		float eta = surf.eta;
		float f0 = surf.f0;

		vec3 f0Color = mix( f0 * surf.specularColor * surf.specularIntensity, surf.color, surf.metalness );
		vec3 f90Color = vec3( mix( surf.specularIntensity, 1.0, surf.metalness ) );
		vec3 F = evaluateFresnel( dot( wo, wh ), eta, f0Color, f90Color );

		vec3 iridescenceF = evalIridescence( 1.0, surf.iridescenceIor, dot( wi, wh ), surf.iridescenceThickness, f0Color );
		F = mix( F, iridescenceF,  surf.iridescence );

		// PDF
		// See 14.1.1 Microfacet BxDFs in https://www.pbr-book.org/
		float incidentTheta = acos( wo.z );
		float G = ggxShadowMaskG2( wi, wo, roughness );
		float D = ggxDistribution( wh, roughness );
		float G1 = ggxShadowMaskG1( incidentTheta, roughness );
		float ggxPdf = D * G1 * max( 0.0, abs( dot( wo, wh ) ) ) / abs ( wo.z );

		color = wi.z * F * G * D / ( 4.0 * abs( wi.z * wo.z ) );
		return ggxPdf / ( 4.0 * dot( wo, wh ) );

	}

	vec3 specularDirection( vec3 wo, SurfaceRecord surf ) {

		// sample ggx vndf distribution which gives a new normal
		float roughness = surf.filteredRoughness;
		vec3 halfVector = ggxDirection(
			wo,
			vec2( roughness ),
			rand2( 12 )
		);

		// apply to new ray by reflecting off the new normal
		return - reflect( wo, halfVector );

	}


	// transmission
	/*
	float transmissionEval( vec3 wo, vec3 wi, vec3 wh, SurfaceRecord surf, inout vec3 color ) {

		// See section 4.2 in https://www.cs.cornell.edu/~srm/publications/EGSR07-btdf.pdf

		float filteredRoughness = surf.filteredRoughness;
		float eta = surf.eta;
		bool frontFace = surf.frontFace;
		bool thinFilm = surf.thinFilm;

		color = surf.transmission * surf.color;

		float denom = pow( eta * dot( wi, wh ) + dot( wo, wh ), 2.0 );
		return ggxPDF( wo, wh, filteredRoughness ) / denom;

	}

	vec3 transmissionDirection( vec3 wo, SurfaceRecord surf ) {

		float filteredRoughness = surf.filteredRoughness;
		float eta = surf.eta;
		bool frontFace = surf.frontFace;

		// sample ggx vndf distribution which gives a new normal
		vec3 halfVector = ggxDirection(
			wo,
			vec2( filteredRoughness ),
			rand2( 13 )
		);

		vec3 lightDirection = refract( normalize( - wo ), halfVector, eta );
		if ( surf.thinFilm ) {

			lightDirection = - refract( normalize( - lightDirection ), - vec3( 0.0, 0.0, 1.0 ), 1.0 / eta );

		}

		return normalize( lightDirection );

	}
	*/

	// TODO: This is just using a basic cosine-weighted specular distribution with an
	// incorrect PDF value at the moment. Update it to correctly use a GGX distribution
	float transmissionEval( vec3 wo, vec3 wi, vec3 wh, SurfaceRecord surf, inout vec3 color ) {

		color = surf.transmission * surf.color;

		// PDF
		// float F = evaluateFresnelWeight( dot( wo, wh ), surf.eta, surf.f0 );
		// float F = disneyFresnel( wo, wi, wh, surf.f0, surf.eta, surf.metalness );
		// if ( F >= 1.0 ) {

		// 	return 0.0;

		// }

		// return 1.0 / ( 1.0 - F );

		// reverted to previous to transmission. The above was causing black pixels
		float eta = surf.eta;
		float f0 = surf.f0;
		float cosTheta = min( wo.z, 1.0 );
		float sinTheta = sqrt( 1.0 - cosTheta * cosTheta );
		float reflectance = schlickFresnel( cosTheta, f0 );
		bool cannotRefract = eta * sinTheta > 1.0;
		if ( cannotRefract ) {

			return 0.0;

		}

		return 1.0 / ( 1.0 - reflectance );

	}

	vec3 transmissionDirection( vec3 wo, SurfaceRecord surf ) {

		float roughness = surf.filteredRoughness;
		float eta = surf.eta;
		vec3 halfVector = normalize( vec3( 0.0, 0.0, 1.0 ) + sampleSphere( rand2( 13 ) ) * roughness );
		vec3 lightDirection = refract( normalize( - wo ), halfVector, eta );

		if ( surf.thinFilm ) {

			lightDirection = - refract( normalize( - lightDirection ), - vec3( 0.0, 0.0, 1.0 ), 1.0 / eta );

		}
		return normalize( lightDirection );

	}

	// clearcoat
	float clearcoatEval( vec3 wo, vec3 wi, vec3 wh, SurfaceRecord surf, inout vec3 color ) {

		float ior = 1.5;
		float f0 = iorRatioToF0( ior );
		bool frontFace = surf.frontFace;
		float roughness = surf.filteredClearcoatRoughness;

		float eta = frontFace ? 1.0 / ior : ior;
		float G = ggxShadowMaskG2( wi, wo, roughness );
		float D = ggxDistribution( wh, roughness );
		float F = schlickFresnel( dot( wi, wh ), f0 );

		float fClearcoat = F * D * G / ( 4.0 * abs( wi.z * wo.z ) );
		color = color * ( 1.0 - surf.clearcoat * F ) + fClearcoat * surf.clearcoat * wi.z;

		// PDF
		// See equation (27) in http://jcgt.org/published/0003/02/03/
		return ggxPDF( wo, wh, roughness ) / ( 4.0 * dot( wi, wh ) );

	}

	vec3 clearcoatDirection( vec3 wo, SurfaceRecord surf ) {

		// sample ggx vndf distribution which gives a new normal
		float roughness = surf.filteredClearcoatRoughness;
		vec3 halfVector = ggxDirection(
			wo,
			vec2( roughness ),
			rand2( 14 )
		);

		// apply to new ray by reflecting off the new normal
		return - reflect( wo, halfVector );

	}

	// sheen
	vec3 sheenColor( vec3 wo, vec3 wi, vec3 wh, SurfaceRecord surf ) {

		float cosThetaO = saturateCos( wo.z );
		float cosThetaI = saturateCos( wi.z );
		float cosThetaH = wh.z;

		float D = velvetD( cosThetaH, surf.sheenRoughness );
		float G = velvetG( cosThetaO, cosThetaI, surf.sheenRoughness );

		// See equation (1) in http://www.aconty.com/pdf/s2017_pbs_imageworks_sheen.pdf
		vec3 color = surf.sheenColor;
		color *= D * G / ( 4.0 * abs( cosThetaO * cosThetaI ) );
		color *= wi.z;

		return color;

	}

	// bsdf
	void getLobeWeights(
		vec3 wo, vec3 wi, vec3 wh, vec3 clearcoatWo, SurfaceRecord surf,
		inout float diffuseWeight, inout float specularWeight, inout float transmissionWeight, inout float clearcoatWeight
	) {

		float metalness = surf.metalness;
		float transmission = surf.transmission;
		// float fEstimate = evaluateFresnelWeight( dot( wo, wh ), surf.eta, surf.f0 );
		float fEstimate = disneyFresnel( wo, wi, wh, surf.f0, surf.eta, surf.metalness );

		float transSpecularProb = mix( max( 0.25, fEstimate ), 1.0, metalness );
		float diffSpecularProb = 0.5 + 0.5 * metalness;

		diffuseWeight = ( 1.0 - transmission ) * ( 1.0 - diffSpecularProb );
		specularWeight = transmission * transSpecularProb + ( 1.0 - transmission ) * diffSpecularProb;
		transmissionWeight = transmission * ( 1.0 - transSpecularProb );
		clearcoatWeight = surf.clearcoat * schlickFresnel( clearcoatWo.z, 0.04 );

		float totalWeight = diffuseWeight + specularWeight + transmissionWeight + clearcoatWeight;
		diffuseWeight /= totalWeight;
		specularWeight /= totalWeight;
		transmissionWeight /= totalWeight;
		clearcoatWeight /= totalWeight;
	}

	float bsdfEval(
		vec3 wo, vec3 clearcoatWo, vec3 wi, vec3 clearcoatWi, SurfaceRecord surf,
		float diffuseWeight, float specularWeight, float transmissionWeight, float clearcoatWeight, inout float specularPdf, inout vec3 color
	) {

		float metalness = surf.metalness;
		float transmission = surf.transmission;

		float spdf = 0.0;
		float dpdf = 0.0;
		float tpdf = 0.0;
		float cpdf = 0.0;
		color = vec3( 0.0 );

		vec3 halfVector = getHalfVector( wi, wo, surf.eta );

		// diffuse
		if ( diffuseWeight > 0.0 && wi.z > 0.0 ) {

			dpdf = diffuseEval( wo, wi, halfVector, surf, color );
			color *= 1.0 - surf.transmission;

		}

		// ggx specular
		if ( specularWeight > 0.0 && wi.z > 0.0 ) {

			vec3 outColor;
			spdf = specularEval( wo, wi, getHalfVector( wi, wo ), surf, outColor );
			color += outColor;

		}

		// transmission
		if ( transmissionWeight > 0.0 && wi.z < 0.0 ) {

			tpdf = transmissionEval( wo, wi, halfVector, surf, color );

		}

		// sheen
		color *= mix( 1.0, sheenAlbedoScaling( wo, wi, surf ), surf.sheen );
		color += sheenColor( wo, wi, halfVector, surf ) * surf.sheen;

		// clearcoat
		if ( clearcoatWi.z >= 0.0 && clearcoatWeight > 0.0 ) {

			vec3 clearcoatHalfVector = getHalfVector( clearcoatWo, clearcoatWi );
			cpdf = clearcoatEval( clearcoatWo, clearcoatWi, clearcoatHalfVector, surf, color );

		}

		float pdf =
			dpdf * diffuseWeight
			+ spdf * specularWeight
			+ tpdf * transmissionWeight
			+ cpdf * clearcoatWeight;

		// retrieve specular rays for the shadows flag
		specularPdf = spdf * specularWeight + cpdf * clearcoatWeight;

		return pdf;

	}

	float bsdfResult( vec3 worldWo, vec3 worldWi, SurfaceRecord surf, inout vec3 color ) {

		if ( surf.volumeParticle ) {

			color = surf.color / ( 4.0 * PI );
			return 1.0 / ( 4.0 * PI );

		}

		vec3 wo = normalize( surf.normalInvBasis * worldWo );
		vec3 wi = normalize( surf.normalInvBasis * worldWi );

		vec3 clearcoatWo = normalize( surf.clearcoatInvBasis * worldWo );
		vec3 clearcoatWi = normalize( surf.clearcoatInvBasis * worldWi );

		vec3 wh = getHalfVector( wo, wi, surf.eta );
		float diffuseWeight;
		float specularWeight;
		float transmissionWeight;
		float clearcoatWeight;
		getLobeWeights( wo, wi, wh, clearcoatWo, surf, diffuseWeight, specularWeight, transmissionWeight, clearcoatWeight );

		float specularPdf;
		return bsdfEval( wo, clearcoatWo, wi, clearcoatWi, surf, diffuseWeight, specularWeight, transmissionWeight, clearcoatWeight, specularPdf, color );

	}

	ScatterRecord bsdfSample( vec3 worldWo, SurfaceRecord surf ) {

		if ( surf.volumeParticle ) {

			ScatterRecord sampleRec;
			sampleRec.specularPdf = 0.0;
			sampleRec.pdf = 1.0 / ( 4.0 * PI );
			sampleRec.direction = sampleSphere( rand2( 16 ) );
			sampleRec.color = surf.color / ( 4.0 * PI );
			return sampleRec;

		}

		vec3 wo = normalize( surf.normalInvBasis * worldWo );
		vec3 clearcoatWo = normalize( surf.clearcoatInvBasis * worldWo );
		mat3 normalBasis = surf.normalBasis;
		mat3 invBasis = surf.normalInvBasis;
		mat3 clearcoatNormalBasis = surf.clearcoatBasis;
		mat3 clearcoatInvBasis = surf.clearcoatInvBasis;

		float diffuseWeight;
		float specularWeight;
		float transmissionWeight;
		float clearcoatWeight;
		// using normal and basically-reflected ray since we don't have proper half vector here
		getLobeWeights( wo, wo, vec3( 0, 0, 1 ), clearcoatWo, surf, diffuseWeight, specularWeight, transmissionWeight, clearcoatWeight );

		float pdf[4];
		pdf[0] = diffuseWeight;
		pdf[1] = specularWeight;
		pdf[2] = transmissionWeight;
		pdf[3] = clearcoatWeight;

		float cdf[4];
		cdf[0] = pdf[0];
		cdf[1] = pdf[1] + cdf[0];
		cdf[2] = pdf[2] + cdf[1];
		cdf[3] = pdf[3] + cdf[2];

		if( cdf[3] != 0.0 ) {

			float invMaxCdf = 1.0 / cdf[3];
			cdf[0] *= invMaxCdf;
			cdf[1] *= invMaxCdf;
			cdf[2] *= invMaxCdf;
			cdf[3] *= invMaxCdf;

		} else {

			cdf[0] = 1.0;
			cdf[1] = 0.0;
			cdf[2] = 0.0;
			cdf[3] = 0.0;

		}

		vec3 wi;
		vec3 clearcoatWi;

		float r = rand( 15 );
		if ( r <= cdf[0] ) { // diffuse

			wi = diffuseDirection( wo, surf );
			clearcoatWi = normalize( clearcoatInvBasis * normalize( normalBasis * wi ) );

		} else if ( r <= cdf[1] ) { // specular

			wi = specularDirection( wo, surf );
			clearcoatWi = normalize( clearcoatInvBasis * normalize( normalBasis * wi ) );

		} else if ( r <= cdf[2] ) { // transmission / refraction

			wi = transmissionDirection( wo, surf );
			clearcoatWi = normalize( clearcoatInvBasis * normalize( normalBasis * wi ) );

		} else if ( r <= cdf[3] ) { // clearcoat

			clearcoatWi = clearcoatDirection( clearcoatWo, surf );
			wi = normalize( invBasis * normalize( clearcoatNormalBasis * clearcoatWi ) );

		}

		ScatterRecord result;
		result.pdf = bsdfEval( wo, clearcoatWo, wi, clearcoatWi, surf, diffuseWeight, specularWeight, transmissionWeight, clearcoatWeight, result.specularPdf, result.color );
		result.direction = normalize( surf.normalBasis * wi );

		return result;

	}

`,fog_functions=`

	// returns the hit distance given the material density
	float intersectFogVolume( Material material, float u ) {

		// https://raytracing.github.io/books/RayTracingTheNextWeek.html#volumes/constantdensitymediums
		return material.opacity == 0.0 ? INFINITY : ( - 1.0 / material.opacity ) * log( u );

	}

	ScatterRecord sampleFogVolume( SurfaceRecord surf, vec2 uv ) {

		ScatterRecord sampleRec;
		sampleRec.specularPdf = 0.0;
		sampleRec.pdf = 1.0 / ( 2.0 * PI );
		sampleRec.direction = sampleSphere( uv );
		sampleRec.color = surf.color;
		return sampleRec;

	}

`,ggx_functions=`

	// The GGX functions provide sampling and distribution information for normals as output so
	// in order to get probability of scatter direction the half vector must be computed and provided.
	// [0] https://www.cs.cornell.edu/~srm/publications/EGSR07-btdf.pdf
	// [1] https://hal.archives-ouvertes.fr/hal-01509746/document
	// [2] http://jcgt.org/published/0007/04/01/
	// [4] http://jcgt.org/published/0003/02/03/

	// trowbridge-reitz === GGX === GTR

	vec3 ggxDirection( vec3 incidentDir, vec2 roughness, vec2 uv ) {

		// TODO: try GGXVNDF implementation from reference [2], here. Needs to update ggxDistribution
		// function below, as well

		// Implementation from reference [1]
		// stretch view
		vec3 V = normalize( vec3( roughness * incidentDir.xy, incidentDir.z ) );

		// orthonormal basis
		vec3 T1 = ( V.z < 0.9999 ) ? normalize( cross( V, vec3( 0.0, 0.0, 1.0 ) ) ) : vec3( 1.0, 0.0, 0.0 );
		vec3 T2 = cross( T1, V );

		// sample point with polar coordinates (r, phi)
		float a = 1.0 / ( 1.0 + V.z );
		float r = sqrt( uv.x );
		float phi = ( uv.y < a ) ? uv.y / a * PI : PI + ( uv.y - a ) / ( 1.0 - a ) * PI;
		float P1 = r * cos( phi );
		float P2 = r * sin( phi ) * ( ( uv.y < a ) ? 1.0 : V.z );

		// compute normal
		vec3 N = P1 * T1 + P2 * T2 + V * sqrt( max( 0.0, 1.0 - P1 * P1 - P2 * P2 ) );

		// unstretch
		N = normalize( vec3( roughness * N.xy, max( 0.0, N.z ) ) );

		return N;

	}

	// Below are PDF and related functions for use in a Monte Carlo path tracer
	// as specified in Appendix B of the following paper
	// See equation (34) from reference [0]
	float ggxLamda( float theta, float roughness ) {

		float tanTheta = tan( theta );
		float tanTheta2 = tanTheta * tanTheta;
		float alpha2 = roughness * roughness;

		float numerator = - 1.0 + sqrt( 1.0 + alpha2 * tanTheta2 );
		return numerator / 2.0;

	}

	// See equation (34) from reference [0]
	float ggxShadowMaskG1( float theta, float roughness ) {

		return 1.0 / ( 1.0 + ggxLamda( theta, roughness ) );

	}

	// See equation (125) from reference [4]
	float ggxShadowMaskG2( vec3 wi, vec3 wo, float roughness ) {

		float incidentTheta = acos( wi.z );
		float scatterTheta = acos( wo.z );
		return 1.0 / ( 1.0 + ggxLamda( incidentTheta, roughness ) + ggxLamda( scatterTheta, roughness ) );

	}

	// See equation (33) from reference [0]
	float ggxDistribution( vec3 halfVector, float roughness ) {

		float a2 = roughness * roughness;
		a2 = max( EPSILON, a2 );
		float cosTheta = halfVector.z;
		float cosTheta4 = pow( cosTheta, 4.0 );

		if ( cosTheta == 0.0 ) return 0.0;

		float theta = acosSafe( halfVector.z );
		float tanTheta = tan( theta );
		float tanTheta2 = pow( tanTheta, 2.0 );

		float denom = PI * cosTheta4 * pow( a2 + tanTheta2, 2.0 );
		return ( a2 / denom );

	}

	// See equation (3) from reference [2]
	float ggxPDF( vec3 wi, vec3 halfVector, float roughness ) {

		float incidentTheta = acos( wi.z );
		float D = ggxDistribution( halfVector, roughness );
		float G1 = ggxShadowMaskG1( incidentTheta, roughness );

		return D * G1 * max( 0.0, dot( wi, halfVector ) ) / wi.z;

	}

`,iridescence_functions=`

	// XYZ to sRGB color space
	const mat3 XYZ_TO_REC709 = mat3(
		3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);

	vec3 fresnel0ToIor( vec3 fresnel0 ) {

		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );

	}

	// Conversion FO/IOR
	vec3 iorToFresnel0( vec3 transmittedIor, float incidentIor ) {

		return square( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );

	}

	// ior is a value between 1.0 and 3.0. 1.0 is air interface
	float iorToFresnel0( float transmittedIor, float incidentIor ) {

		return square( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ) );

	}

	// Fresnel equations for dielectric/dielectric interfaces. See https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html
	vec3 evalSensitivity( float OPD, vec3 shift ) {

		float phase = 2.0 * PI * OPD * 1.0e-9;

		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );

		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - square( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * square( phase ) );
		xyz /= 1.0685e-7;

		vec3 srgb = XYZ_TO_REC709 * xyz;
		return srgb;

	}

	// See Section 4. Analytic Spectral Integration, A Practical Extension to Microfacet Theory for the Modeling of Varying Iridescence, https://hal.archives-ouvertes.fr/hal-01518344/document
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {

		vec3 I;

		// Force iridescenceIor -> outsideIOR when thinFilmThickness -> 0.0
		float iridescenceIor = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );

		// Evaluate the cosTheta on the base layer (Snell law)
		float sinTheta2Sq = square( outsideIOR / iridescenceIor ) * ( 1.0 - square( cosTheta1 ) );

		// Handle TIR:
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {

			return vec3( 1.0 );

		}

		float cosTheta2 = sqrt( cosTheta2Sq );

		// First interface
		float R0 = iorToFresnel0( iridescenceIor, outsideIOR );
		float R12 = schlickFresnel( cosTheta1, R0 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIor < outsideIOR ) {

			phi12 = PI;

		}

		float phi21 = PI - phi12;

		// Second interface
		vec3 baseIOR = fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) ); // guard against 1.0
		vec3 R1 = iorToFresnel0( baseIOR, iridescenceIor );
		vec3 R23 = schlickFresnel( cosTheta2, R1 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[0] < iridescenceIor ) {

			phi23[ 0 ] = PI;

		}

		if ( baseIOR[1] < iridescenceIor ) {

			phi23[ 1 ] = PI;

		}

		if ( baseIOR[2] < iridescenceIor ) {

			phi23[ 2 ] = PI;

		}

		// Phase shift
		float OPD = 2.0 * iridescenceIor * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;

		// Compound terms
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = square( T121 ) * R23 / ( vec3( 1.0 ) - R123 );

		// Reflectance term for m = 0 (DC term amplitude)
		vec3 C0 = R12 + Rs;
		I = C0;

		// Reflectance term for m > 0 (pairs of diracs)
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {

			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;

		}

		// Since out of gamut colors might be produced, negative color values are clamped to 0.
		return max( I, vec3( 0.0 ) );

	}

`,sheen_functions=`

	// See equation (2) in http://www.aconty.com/pdf/s2017_pbs_imageworks_sheen.pdf
	float velvetD( float cosThetaH, float roughness ) {

		float alpha = max( roughness, 0.07 );
		alpha = alpha * alpha;

		float invAlpha = 1.0 / alpha;

		float sqrCosThetaH = cosThetaH * cosThetaH;
		float sinThetaH = max( 1.0 - sqrCosThetaH, 0.001 );

		return ( 2.0 + invAlpha ) * pow( sinThetaH, 0.5 * invAlpha ) / ( 2.0 * PI );

	}

	float velvetParamsInterpolate( int i, float oneMinusAlphaSquared ) {

		const float p0[5] = float[5]( 25.3245, 3.32435, 0.16801, -1.27393, -4.85967 );
		const float p1[5] = float[5]( 21.5473, 3.82987, 0.19823, -1.97760, -4.32054 );

		return mix( p1[i], p0[i], oneMinusAlphaSquared );

	}

	float velvetL( float x, float alpha ) {

		float oneMinusAlpha = 1.0 - alpha;
		float oneMinusAlphaSquared = oneMinusAlpha * oneMinusAlpha;

		float a = velvetParamsInterpolate( 0, oneMinusAlphaSquared );
		float b = velvetParamsInterpolate( 1, oneMinusAlphaSquared );
		float c = velvetParamsInterpolate( 2, oneMinusAlphaSquared );
		float d = velvetParamsInterpolate( 3, oneMinusAlphaSquared );
		float e = velvetParamsInterpolate( 4, oneMinusAlphaSquared );

		return a / ( 1.0 + b * pow( abs( x ), c ) ) + d * x + e;

	}

	// See equation (3) in http://www.aconty.com/pdf/s2017_pbs_imageworks_sheen.pdf
	float velvetLambda( float cosTheta, float alpha ) {

		return abs( cosTheta ) < 0.5 ? exp( velvetL( cosTheta, alpha ) ) : exp( 2.0 * velvetL( 0.5, alpha ) - velvetL( 1.0 - cosTheta, alpha ) );

	}

	// See Section 3, Shadowing Term, in http://www.aconty.com/pdf/s2017_pbs_imageworks_sheen.pdf
	float velvetG( float cosThetaO, float cosThetaI, float roughness ) {

		float alpha = max( roughness, 0.07 );
		alpha = alpha * alpha;

		return 1.0 / ( 1.0 + velvetLambda( cosThetaO, alpha ) + velvetLambda( cosThetaI, alpha ) );

	}

	float directionalAlbedoSheen( float cosTheta, float alpha ) {

		cosTheta = saturate( cosTheta );

		float c = 1.0 - cosTheta;
		float c3 = c * c * c;

		return 0.65584461 * c3 + 1.0 / ( 4.16526551 + exp( -7.97291361 * sqrt( alpha ) + 6.33516894 ) );

	}

	float sheenAlbedoScaling( vec3 wo, vec3 wi, SurfaceRecord surf ) {

		float alpha = max( surf.sheenRoughness, 0.07 );
		alpha = alpha * alpha;

		float maxSheenColor = max( max( surf.sheenColor.r, surf.sheenColor.g ), surf.sheenColor.b );

		float eWo = directionalAlbedoSheen( saturateCos( wo.z ), alpha );
		float eWi = directionalAlbedoSheen( saturateCos( wi.z ), alpha );

		return min( 1.0 - maxSheenColor * eWo, 1.0 - maxSheenColor * eWi );

	}

	// See Section 5, Layering, in http://www.aconty.com/pdf/s2017_pbs_imageworks_sheen.pdf
	float sheenAlbedoScaling( vec3 wo, SurfaceRecord surf ) {

		float alpha = max( surf.sheenRoughness, 0.07 );
		alpha = alpha * alpha;

		float maxSheenColor = max( max( surf.sheenColor.r, surf.sheenColor.g ), surf.sheenColor.b );

		float eWo = directionalAlbedoSheen( saturateCos( wo.z ), alpha );

		return 1.0 - maxSheenColor * eWo;

	}

`,inside_fog_volume_function=`

#ifndef FOG_CHECK_ITERATIONS
#define FOG_CHECK_ITERATIONS 30
#endif

// returns whether the given material is a fog material or not
bool isMaterialFogVolume( sampler2D materials, uint materialIndex ) {

	uint i = materialIndex * 45u;
	vec4 s14 = texelFetch1D( materials, i + 14u );
	return bool( int( s14.b ) & 4 );

}

// returns true if we're within the first fog volume we hit
bool bvhIntersectFogVolumeHit(
	vec3 rayOrigin, vec3 rayDirection,
	usampler2D materialIndexAttribute, sampler2D materials,
	inout Material material
) {

	material.fogVolume = false;

	for ( int i = 0; i < FOG_CHECK_ITERATIONS; i ++ ) {

		// find nearest hit
		uvec4 faceIndices = uvec4( 0u );
		vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );
		vec3 barycoord = vec3( 0.0 );
		float side = 1.0;
		float dist = 0.0;
		bool hit = bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );
		if ( hit ) {

			// if it's a fog volume return whether we hit the front or back face
			uint materialIndex = uTexelFetch1D( materialIndexAttribute, faceIndices.x ).r;
			if ( isMaterialFogVolume( materials, materialIndex ) ) {

				material = readMaterialInfo( materials, materialIndex );
				return side == - 1.0;

			} else {

				// move the ray forward
				rayOrigin = stepRayOrigin( rayOrigin, rayDirection, - faceNormal, dist );

			}

		} else {

			return false;

		}

	}

	return false;

}

`,attenuate_hit_function=`

	// step through multiple surface hits and accumulate color attenuation based on transmissive surfaces
	// returns true if a solid surface was hit
	bool attenuateHit(
		RenderState state,
		Ray ray, float rayDist,
		out vec3 color
	) {

		// store the original bounce index so we can reset it after
		uint originalBounceIndex = sobolBounceIndex;

		int traversals = state.traversals;
		int transmissiveTraversals = state.transmissiveTraversals;
		bool isShadowRay = state.isShadowRay;
		Material fogMaterial = state.fogMaterial;

		vec3 startPoint = ray.origin;

		// hit results
		SurfaceHit surfaceHit;

		color = vec3( 1.0 );

		bool result = true;
		for ( int i = 0; i < traversals; i ++ ) {

			sobolBounceIndex ++;

			int hitType = traceScene( ray, fogMaterial, surfaceHit );

			if ( hitType == FOG_HIT ) {

				result = true;
				break;

			} else if ( hitType == SURFACE_HIT ) {

				float totalDist = distance( startPoint, ray.origin + ray.direction * surfaceHit.dist );
				if ( totalDist > rayDist ) {

					result = false;
					break;

				}

				// TODO: attenuate the contribution based on the PDF of the resulting ray including refraction values
				// Should be able to work using the material BSDF functions which will take into account specularity, etc.
				// TODO: should we account for emissive surfaces here?

				uint materialIndex = uTexelFetch1D( materialIndexAttribute, surfaceHit.faceIndices.x ).r;
				Material material = readMaterialInfo( materials, materialIndex );

				// adjust the ray to the new surface
				bool isEntering = surfaceHit.side == 1.0;
				ray.origin = stepRayOrigin( ray.origin, ray.direction, - surfaceHit.faceNormal, surfaceHit.dist );

				#if FEATURE_FOG

				if ( material.fogVolume ) {

					fogMaterial = material;
					fogMaterial.fogVolume = surfaceHit.side == 1.0;
					i -= sign( transmissiveTraversals );
					transmissiveTraversals --;
					continue;

				}

				#endif

				if ( ! material.castShadow && isShadowRay ) {

					continue;

				}

				vec2 uv = textureSampleBarycoord( attributesArray, ATTR_UV, surfaceHit.barycoord, surfaceHit.faceIndices.xyz ).xy;
				vec4 vertexColor = textureSampleBarycoord( attributesArray, ATTR_COLOR, surfaceHit.barycoord, surfaceHit.faceIndices.xyz );

				// albedo
				vec4 albedo = vec4( material.color, material.opacity );
				if ( material.map != - 1 ) {

					vec3 uvPrime = material.mapTransform * vec3( uv, 1 );
					albedo *= texture2D( textures, vec3( uvPrime.xy, material.map ) );

				}

				if ( material.vertexColors ) {

					albedo *= vertexColor;

				}

				// alphaMap
				if ( material.alphaMap != - 1 ) {

					albedo.a *= texture2D( textures, vec3( uv, material.alphaMap ) ).x;

				}

				// transmission
				float transmission = material.transmission;
				if ( material.transmissionMap != - 1 ) {

					vec3 uvPrime = material.transmissionMapTransform * vec3( uv, 1 );
					transmission *= texture2D( textures, vec3( uvPrime.xy, material.transmissionMap ) ).r;

				}

				// metalness
				float metalness = material.metalness;
				if ( material.metalnessMap != - 1 ) {

					vec3 uvPrime = material.metalnessMapTransform * vec3( uv, 1 );
					metalness *= texture2D( textures, vec3( uvPrime.xy, material.metalnessMap ) ).b;

				}

				float alphaTest = material.alphaTest;
				bool useAlphaTest = alphaTest != 0.0;
				float transmissionFactor = ( 1.0 - metalness ) * transmission;
				if (
					transmissionFactor < rand( 9 ) && ! (
						// material sidedness
						material.side != 0.0 && surfaceHit.side == material.side

						// alpha test
						|| useAlphaTest && albedo.a < alphaTest

						// opacity
						|| material.transparent && ! useAlphaTest && albedo.a < rand( 10 )
					)
				) {

					result = true;
					break;

				}

				if ( surfaceHit.side == 1.0 && isEntering ) {

					// only attenuate by surface color on the way in
					color *= mix( vec3( 1.0 ), albedo.rgb, transmissionFactor );

				} else if ( surfaceHit.side == - 1.0 ) {

					// attenuate by medium once we hit the opposite side of the model
					color *= transmissionAttenuation( surfaceHit.dist, material.attenuationColor, material.attenuationDistance );

				}

				bool isTransmissiveRay = dot( ray.direction, surfaceHit.faceNormal * surfaceHit.side ) < 0.0;
				if ( ( isTransmissiveRay || isEntering ) && transmissiveTraversals > 0 ) {

					i -= sign( transmissiveTraversals );
					transmissiveTraversals --;

				}

			} else {

				result = false;
				break;

			}

		}

		// reset the bounce index
		sobolBounceIndex = originalBounceIndex;
		return result;

	}

`,camera_util_functions=`

	vec3 ndcToRayOrigin( vec2 coord ) {

		vec4 rayOrigin4 = cameraWorldMatrix * invProjectionMatrix * vec4( coord, - 1.0, 1.0 );
		return rayOrigin4.xyz / rayOrigin4.w;
	}

	Ray getCameraRay() {

		vec2 ssd = vec2( 1.0 ) / resolution;

		// Jitter the camera ray by finding a uv coordinate at a random sample
		// around this pixel's UV coordinate for AA
		vec2 ruv = rand2( 0 );
		vec2 jitteredUv = vUv + vec2( tentFilter( ruv.x ) * ssd.x, tentFilter( ruv.y ) * ssd.y );
		Ray ray;

		#if CAMERA_TYPE == 2

			// Equirectangular projection
			vec4 rayDirection4 = vec4( equirectUvToDirection( jitteredUv ), 0.0 );
			vec4 rayOrigin4 = vec4( 0.0, 0.0, 0.0, 1.0 );

			rayDirection4 = cameraWorldMatrix * rayDirection4;
			rayOrigin4 = cameraWorldMatrix * rayOrigin4;

			ray.direction = normalize( rayDirection4.xyz );
			ray.origin = rayOrigin4.xyz / rayOrigin4.w;

		#else

			// get [- 1, 1] normalized device coordinates
			vec2 ndc = 2.0 * jitteredUv - vec2( 1.0 );
			ray.origin = ndcToRayOrigin( ndc );

			#if CAMERA_TYPE == 1

				// Orthographic projection
				ray.direction = ( cameraWorldMatrix * vec4( 0.0, 0.0, - 1.0, 0.0 ) ).xyz;
				ray.direction = normalize( ray.direction );

			#else

				// Perspective projection
				ray.direction = normalize( mat3( cameraWorldMatrix ) * ( invProjectionMatrix * vec4( ndc, 0.0, 1.0 ) ).xyz );

			#endif

		#endif

		#if FEATURE_DOF
		{

			// depth of field
			vec3 focalPoint = ray.origin + normalize( ray.direction ) * physicalCamera.focusDistance;

			// get the aperture sample
			// if blades === 0 then we assume a circle
			vec3 shapeUVW= rand3( 1 );
			int blades = physicalCamera.apertureBlades;
			float anamorphicRatio = physicalCamera.anamorphicRatio;
			vec2 apertureSample = blades == 0 ? sampleCircle( shapeUVW.xy ) : sampleRegularPolygon( blades, shapeUVW );
			apertureSample *= physicalCamera.bokehSize * 0.5 * 1e-3;

			// rotate the aperture shape
			apertureSample =
				rotateVector( apertureSample, physicalCamera.apertureRotation ) *
				saturate( vec2( anamorphicRatio, 1.0 / anamorphicRatio ) );

			// create the new ray
			ray.origin += ( cameraWorldMatrix * vec4( apertureSample, 0.0, 0.0 ) ).xyz;
			ray.direction = focalPoint - ray.origin;

		}
		#endif

		ray.direction = normalize( ray.direction );

		return ray;

	}

`,direct_light_contribution_function=`

	vec3 directLightContribution( vec3 worldWo, SurfaceRecord surf, RenderState state, vec3 rayOrigin ) {

		vec3 result = vec3( 0.0 );

		// uniformly pick a light or environment map
		if( lightsDenom != 0.0 && rand( 5 ) < float( lights.count ) / lightsDenom ) {

			// sample a light or environment
			LightRecord lightRec = randomLightSample( lights.tex, iesProfiles, lights.count, rayOrigin, rand3( 6 ) );

			bool isSampleBelowSurface = ! surf.volumeParticle && dot( surf.faceNormal, lightRec.direction ) < 0.0;
			if ( isSampleBelowSurface ) {

				lightRec.pdf = 0.0;

			}

			// check if a ray could even reach the light area
			Ray lightRay;
			lightRay.origin = rayOrigin;
			lightRay.direction = lightRec.direction;
			vec3 attenuatedColor;
			if (
				lightRec.pdf > 0.0 &&
				isDirectionValid( lightRec.direction, surf.normal, surf.faceNormal ) &&
				! attenuateHit( state, lightRay, lightRec.dist, attenuatedColor )
			) {

				// get the material pdf
				vec3 sampleColor;
				float lightMaterialPdf = bsdfResult( worldWo, lightRec.direction, surf, sampleColor );
				bool isValidSampleColor = all( greaterThanEqual( sampleColor, vec3( 0.0 ) ) );
				if ( lightMaterialPdf > 0.0 && isValidSampleColor ) {

					// weight the direct light contribution
					float lightPdf = lightRec.pdf / lightsDenom;
					float misWeight = lightRec.type == SPOT_LIGHT_TYPE || lightRec.type == DIR_LIGHT_TYPE || lightRec.type == POINT_LIGHT_TYPE ? 1.0 : misHeuristic( lightPdf, lightMaterialPdf );
					result = attenuatedColor * lightRec.emission * state.throughputColor * sampleColor * misWeight / lightPdf;

				}

			}

		} else if ( envMapInfo.totalSum != 0.0 && environmentIntensity != 0.0 ) {

			// find a sample in the environment map to include in the contribution
			vec3 envColor, envDirection;
			float envPdf = sampleEquirectProbability( rand2( 7 ), envColor, envDirection );
			envDirection = invEnvRotation3x3 * envDirection;

			// this env sampling is not set up for transmissive sampling and yields overly bright
			// results so we ignore the sample in this case.
			// TODO: this should be improved but how? The env samples could traverse a few layers?
			bool isSampleBelowSurface = ! surf.volumeParticle && dot( surf.faceNormal, envDirection ) < 0.0;
			if ( isSampleBelowSurface ) {

				envPdf = 0.0;

			}

			// check if a ray could even reach the surface
			Ray envRay;
			envRay.origin = rayOrigin;
			envRay.direction = envDirection;
			vec3 attenuatedColor;
			if (
				envPdf > 0.0 &&
				isDirectionValid( envDirection, surf.normal, surf.faceNormal ) &&
				! attenuateHit( state, envRay, INFINITY, attenuatedColor )
			) {

				// get the material pdf
				vec3 sampleColor;
				float envMaterialPdf = bsdfResult( worldWo, envDirection, surf, sampleColor );
				bool isValidSampleColor = all( greaterThanEqual( sampleColor, vec3( 0.0 ) ) );
				if ( envMaterialPdf > 0.0 && isValidSampleColor ) {

					// weight the direct light contribution
					envPdf /= lightsDenom;
					float misWeight = misHeuristic( envPdf, envMaterialPdf );
					result = attenuatedColor * environmentIntensity * envColor * state.throughputColor * sampleColor * misWeight / envPdf;

				}

			}

		}

		// Function changed to have a single return statement to potentially help with crashes on Mac OS.
		// See issue #470
		return result;

	}

`,get_surface_record_function=`

	#define SKIP_SURFACE 0
	#define HIT_SURFACE 1
	int getSurfaceRecord(
		Material material, SurfaceHit surfaceHit, sampler2DArray attributesArray,
		float accumulatedRoughness,
		inout SurfaceRecord surf
	) {

		if ( material.fogVolume ) {

			vec3 normal = vec3( 0, 0, 1 );

			SurfaceRecord fogSurface;
			fogSurface.volumeParticle = true;
			fogSurface.color = material.color;
			fogSurface.emission = material.emissiveIntensity * material.emissive;
			fogSurface.normal = normal;
			fogSurface.faceNormal = normal;
			fogSurface.clearcoatNormal = normal;

			surf = fogSurface;
			return HIT_SURFACE;

		}

		// uv coord for textures
		vec2 uv = textureSampleBarycoord( attributesArray, ATTR_UV, surfaceHit.barycoord, surfaceHit.faceIndices.xyz ).xy;
		vec4 vertexColor = textureSampleBarycoord( attributesArray, ATTR_COLOR, surfaceHit.barycoord, surfaceHit.faceIndices.xyz );

		// albedo
		vec4 albedo = vec4( material.color, material.opacity );
		if ( material.map != - 1 ) {

			vec3 uvPrime = material.mapTransform * vec3( uv, 1 );
			albedo *= texture2D( textures, vec3( uvPrime.xy, material.map ) );

		}

		if ( material.vertexColors ) {

			albedo *= vertexColor;

		}

		// alphaMap
		if ( material.alphaMap != - 1 ) {

			albedo.a *= texture2D( textures, vec3( uv, material.alphaMap ) ).x;

		}

		// possibly skip this sample if it's transparent, alpha test is enabled, or we hit the wrong material side
		// and it's single sided.
		// - alpha test is disabled when it === 0
		// - the material sidedness test is complicated because we want light to pass through the back side but still
		// be able to see the front side. This boolean checks if the side we hit is the front side on the first ray
		// and we're rendering the other then we skip it. Do the opposite on subsequent bounces to get incoming light.
		float alphaTest = material.alphaTest;
		bool useAlphaTest = alphaTest != 0.0;
		if (
			// material sidedness
			material.side != 0.0 && surfaceHit.side != material.side

			// alpha test
			|| useAlphaTest && albedo.a < alphaTest

			// opacity
			|| material.transparent && ! useAlphaTest && albedo.a < rand( 3 )
		) {

			return SKIP_SURFACE;

		}

		// fetch the interpolated smooth normal
		vec3 normal = normalize( textureSampleBarycoord(
			attributesArray,
			ATTR_NORMAL,
			surfaceHit.barycoord,
			surfaceHit.faceIndices.xyz
		).xyz );

		// roughness
		float roughness = material.roughness;
		if ( material.roughnessMap != - 1 ) {

			vec3 uvPrime = material.roughnessMapTransform * vec3( uv, 1 );
			roughness *= texture2D( textures, vec3( uvPrime.xy, material.roughnessMap ) ).g;

		}

		// metalness
		float metalness = material.metalness;
		if ( material.metalnessMap != - 1 ) {

			vec3 uvPrime = material.metalnessMapTransform * vec3( uv, 1 );
			metalness *= texture2D( textures, vec3( uvPrime.xy, material.metalnessMap ) ).b;

		}

		// emission
		vec3 emission = material.emissiveIntensity * material.emissive;
		if ( material.emissiveMap != - 1 ) {

			vec3 uvPrime = material.emissiveMapTransform * vec3( uv, 1 );
			emission *= texture2D( textures, vec3( uvPrime.xy, material.emissiveMap ) ).xyz;

		}

		// transmission
		float transmission = material.transmission;
		if ( material.transmissionMap != - 1 ) {

			vec3 uvPrime = material.transmissionMapTransform * vec3( uv, 1 );
			transmission *= texture2D( textures, vec3( uvPrime.xy, material.transmissionMap ) ).r;

		}

		// normal
		if ( material.flatShading ) {

			// if we're rendering a flat shaded object then use the face normals - the face normal
			// is provided based on the side the ray hits the mesh so flip it to align with the
			// interpolated vertex normals.
			normal = surfaceHit.faceNormal * surfaceHit.side;

		}

		vec3 baseNormal = normal;
		if ( material.normalMap != - 1 ) {

			vec4 tangentSample = textureSampleBarycoord(
				attributesArray,
				ATTR_TANGENT,
				surfaceHit.barycoord,
				surfaceHit.faceIndices.xyz
			);

			// some provided tangents can be malformed (0, 0, 0) causing the normal to be degenerate
			// resulting in NaNs and slow path tracing.
			if ( length( tangentSample.xyz ) > 0.0 ) {

				vec3 tangent = normalize( tangentSample.xyz );
				vec3 bitangent = normalize( cross( normal, tangent ) * tangentSample.w );
				mat3 vTBN = mat3( tangent, bitangent, normal );

				vec3 uvPrime = material.normalMapTransform * vec3( uv, 1 );
				vec3 texNormal = texture2D( textures, vec3( uvPrime.xy, material.normalMap ) ).xyz * 2.0 - 1.0;
				texNormal.xy *= material.normalScale;
				normal = vTBN * texNormal;

			}

		}

		normal *= surfaceHit.side;

		// clearcoat
		float clearcoat = material.clearcoat;
		if ( material.clearcoatMap != - 1 ) {

			vec3 uvPrime = material.clearcoatMapTransform * vec3( uv, 1 );
			clearcoat *= texture2D( textures, vec3( uvPrime.xy, material.clearcoatMap ) ).r;

		}

		// clearcoatRoughness
		float clearcoatRoughness = material.clearcoatRoughness;
		if ( material.clearcoatRoughnessMap != - 1 ) {

			vec3 uvPrime = material.clearcoatRoughnessMapTransform * vec3( uv, 1 );
			clearcoatRoughness *= texture2D( textures, vec3( uvPrime.xy, material.clearcoatRoughnessMap ) ).g;

		}

		// clearcoatNormal
		vec3 clearcoatNormal = baseNormal;
		if ( material.clearcoatNormalMap != - 1 ) {

			vec4 tangentSample = textureSampleBarycoord(
				attributesArray,
				ATTR_TANGENT,
				surfaceHit.barycoord,
				surfaceHit.faceIndices.xyz
			);

			// some provided tangents can be malformed (0, 0, 0) causing the normal to be degenerate
			// resulting in NaNs and slow path tracing.
			if ( length( tangentSample.xyz ) > 0.0 ) {

				vec3 tangent = normalize( tangentSample.xyz );
				vec3 bitangent = normalize( cross( clearcoatNormal, tangent ) * tangentSample.w );
				mat3 vTBN = mat3( tangent, bitangent, clearcoatNormal );

				vec3 uvPrime = material.clearcoatNormalMapTransform * vec3( uv, 1 );
				vec3 texNormal = texture2D( textures, vec3( uvPrime.xy, material.clearcoatNormalMap ) ).xyz * 2.0 - 1.0;
				texNormal.xy *= material.clearcoatNormalScale;
				clearcoatNormal = vTBN * texNormal;

			}

		}

		clearcoatNormal *= surfaceHit.side;

		// sheenColor
		vec3 sheenColor = material.sheenColor;
		if ( material.sheenColorMap != - 1 ) {

			vec3 uvPrime = material.sheenColorMapTransform * vec3( uv, 1 );
			sheenColor *= texture2D( textures, vec3( uvPrime.xy, material.sheenColorMap ) ).rgb;

		}

		// sheenRoughness
		float sheenRoughness = material.sheenRoughness;
		if ( material.sheenRoughnessMap != - 1 ) {

			vec3 uvPrime = material.sheenRoughnessMapTransform * vec3( uv, 1 );
			sheenRoughness *= texture2D( textures, vec3( uvPrime.xy, material.sheenRoughnessMap ) ).a;

		}

		// iridescence
		float iridescence = material.iridescence;
		if ( material.iridescenceMap != - 1 ) {

			vec3 uvPrime = material.iridescenceMapTransform * vec3( uv, 1 );
			iridescence *= texture2D( textures, vec3( uvPrime.xy, material.iridescenceMap ) ).r;

		}

		// iridescence thickness
		float iridescenceThickness = material.iridescenceThicknessMaximum;
		if ( material.iridescenceThicknessMap != - 1 ) {

			vec3 uvPrime = material.iridescenceThicknessMapTransform * vec3( uv, 1 );
			float iridescenceThicknessSampled = texture2D( textures, vec3( uvPrime.xy, material.iridescenceThicknessMap ) ).g;
			iridescenceThickness = mix( material.iridescenceThicknessMinimum, material.iridescenceThicknessMaximum, iridescenceThicknessSampled );

		}

		iridescence = iridescenceThickness == 0.0 ? 0.0 : iridescence;

		// specular color
		vec3 specularColor = material.specularColor;
		if ( material.specularColorMap != - 1 ) {

			vec3 uvPrime = material.specularColorMapTransform * vec3( uv, 1 );
			specularColor *= texture2D( textures, vec3( uvPrime.xy, material.specularColorMap ) ).rgb;

		}

		// specular intensity
		float specularIntensity = material.specularIntensity;
		if ( material.specularIntensityMap != - 1 ) {

			vec3 uvPrime = material.specularIntensityMapTransform * vec3( uv, 1 );
			specularIntensity *= texture2D( textures, vec3( uvPrime.xy, material.specularIntensityMap ) ).a;

		}

		surf.volumeParticle = false;

		surf.faceNormal = surfaceHit.faceNormal;
		surf.normal = normal;

		surf.metalness = metalness;
		surf.color = albedo.rgb;
		surf.emission = emission;

		surf.ior = material.ior;
		surf.transmission = transmission;
		surf.thinFilm = material.thinFilm;
		surf.attenuationColor = material.attenuationColor;
		surf.attenuationDistance = material.attenuationDistance;

		surf.clearcoatNormal = clearcoatNormal;
		surf.clearcoat = clearcoat;

		surf.sheen = material.sheen;
		surf.sheenColor = sheenColor;

		surf.iridescence = iridescence;
		surf.iridescenceIor = material.iridescenceIor;
		surf.iridescenceThickness = iridescenceThickness;

		surf.specularColor = specularColor;
		surf.specularIntensity = specularIntensity;

		// apply perceptual roughness factor from gltf. sheen perceptual roughness is
		// applied by its brdf function
		// https://registry.khronos.org/glTF/specs/2.0/glTF-2.0.html#microfacet-surfaces
		surf.roughness = roughness * roughness;
		surf.clearcoatRoughness = clearcoatRoughness * clearcoatRoughness;
		surf.sheenRoughness = sheenRoughness;

		// frontFace is used to determine transmissive properties and PDF. If no transmission is used
		// then we can just always assume this is a front face.
		surf.frontFace = surfaceHit.side == 1.0 || transmission == 0.0;
		surf.eta = material.thinFilm || surf.frontFace ? 1.0 / material.ior : material.ior;
		surf.f0 = iorRatioToF0( surf.eta );

		// Compute the filtered roughness value to use during specular reflection computations.
		// The accumulated roughness value is scaled by a user setting and a "magic value" of 5.0.
		// If we're exiting something transmissive then scale the factor down significantly so we can retain
		// sharp internal reflections
		surf.filteredRoughness = applyFilteredGlossy( surf.roughness, accumulatedRoughness );
		surf.filteredClearcoatRoughness = applyFilteredGlossy( surf.clearcoatRoughness, accumulatedRoughness );

		// get the normal frames
		surf.normalBasis = getBasisFromNormal( surf.normal );
		surf.normalInvBasis = inverse( surf.normalBasis );

		surf.clearcoatBasis = getBasisFromNormal( surf.clearcoatNormal );
		surf.clearcoatInvBasis = inverse( surf.clearcoatBasis );

		return HIT_SURFACE;

	}
`,render_structs=`

	struct Ray {

		vec3 origin;
		vec3 direction;

	};

	struct SurfaceHit {

		uvec4 faceIndices;
		vec3 barycoord;
		vec3 faceNormal;
		float side;
		float dist;

	};

	struct RenderState {

		bool firstRay;
		bool transmissiveRay;
		bool isShadowRay;
		float accumulatedRoughness;
		int transmissiveTraversals;
		int traversals;
		uint depth;
		vec3 throughputColor;
		Material fogMaterial;

	};

	RenderState initRenderState() {

		RenderState result;
		result.firstRay = true;
		result.transmissiveRay = true;
		result.isShadowRay = false;
		result.accumulatedRoughness = 0.0;
		result.transmissiveTraversals = 0;
		result.traversals = 0;
		result.throughputColor = vec3( 1.0 );
		result.depth = 0u;
		result.fogMaterial.fogVolume = false;
		return result;

	}

`,trace_scene_function=`

	#define NO_HIT 0
	#define SURFACE_HIT 1
	#define LIGHT_HIT 2
	#define FOG_HIT 3

	// Passing the global variable 'lights' into this function caused shader program errors.
	// So global variables like 'lights' and 'bvh' were moved out of the function parameters.
	// For more information, refer to: https://github.com/gkjohnson/three-gpu-pathtracer/pull/457
	int traceScene(
		Ray ray, Material fogMaterial, inout SurfaceHit surfaceHit
	) {

		int result = NO_HIT;
		bool hit = bvhIntersectFirstHit( bvh, ray.origin, ray.direction, surfaceHit.faceIndices, surfaceHit.faceNormal, surfaceHit.barycoord, surfaceHit.side, surfaceHit.dist );

		#if FEATURE_FOG

		if ( fogMaterial.fogVolume ) {

			// offset the distance so we don't run into issues with particles on the same surface
			// as other objects
			float particleDist = intersectFogVolume( fogMaterial, rand( 1 ) );
			if ( particleDist + RAY_OFFSET < surfaceHit.dist ) {

				surfaceHit.side = 1.0;
				surfaceHit.faceNormal = normalize( - ray.direction );
				surfaceHit.dist = particleDist;
				return FOG_HIT;

			}

		}

		#endif

		if ( hit ) {

			result = SURFACE_HIT;

		}

		return result;

	}

`;class PhysicalPathTracingMaterial extends MaterialBase{onBeforeRender(){this.setDefine("FEATURE_DOF",this.physicalCamera.bokehSize===0?0:1),this.setDefine("FEATURE_BACKGROUND_MAP",this.backgroundMap?1:0),this.setDefine("FEATURE_FOG",this.materials.features.isUsed("FOG")?1:0)}constructor(_){super({transparent:!0,depthWrite:!1,defines:{FEATURE_MIS:1,FEATURE_RUSSIAN_ROULETTE:1,FEATURE_DOF:1,FEATURE_BACKGROUND_MAP:0,FEATURE_FOG:1,RANDOM_TYPE:2,CAMERA_TYPE:0,DEBUG_MODE:0,ATTR_NORMAL:0,ATTR_TANGENT:1,ATTR_UV:2,ATTR_COLOR:3},uniforms:{resolution:{value:new Vector2},opacity:{value:1},bounces:{value:10},transmissiveBounces:{value:10},filterGlossyFactor:{value:0},physicalCamera:{value:new PhysicalCameraUniform},cameraWorldMatrix:{value:new Matrix4},invProjectionMatrix:{value:new Matrix4},bvh:{value:new MeshBVHUniformStruct},attributesArray:{value:new AttributesTextureArray},materialIndexAttribute:{value:new UIntVertexAttributeTexture},materials:{value:new MaterialsTexture},textures:{value:new RenderTarget2DArray().texture},lights:{value:new LightsInfoUniformStruct},iesProfiles:{value:new RenderTarget2DArray(360,180,{type:HalfFloatType,wrapS:ClampToEdgeWrapping,wrapT:ClampToEdgeWrapping}).texture},environmentIntensity:{value:1},environmentRotation:{value:new Matrix4},envMapInfo:{value:new EquirectHdrInfoUniform},backgroundBlur:{value:0},backgroundMap:{value:null},backgroundAlpha:{value:1},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix4},seed:{value:0},sobolTexture:{value:null},stratifiedTexture:{value:new StratifiedSamplesTexture},stratifiedOffsetTexture:{value:new BlueNoiseTexture(64,1)}},vertexShader:`

				varying vec2 vUv;
				void main() {

					vec4 mvPosition = vec4( position, 1.0 );
					mvPosition = modelViewMatrix * mvPosition;
					gl_Position = projectionMatrix * mvPosition;

					vUv = uv;

				}

			`,fragmentShader:`
				#define RAY_OFFSET 1e-4
				#define INFINITY 1e20

				precision highp isampler2D;
				precision highp usampler2D;
				precision highp sampler2DArray;
				vec4 envMapTexelToLinear( vec4 a ) { return a; }
				#include <common>

				// bvh intersection
				${common_functions}
				${bvh_struct_definitions}
				${bvh_ray_functions}

				// uniform structs
				${camera_struct}
				${lights_struct}
				${equirect_struct}
				${material_struct}
				${surface_record_struct}

				// random
				#if RANDOM_TYPE == 2 	// Stratified List

					${stratified_functions}

				#elif RANDOM_TYPE == 1 	// Sobol

					${pcg_functions}
					${sobol_common}
					${sobol_functions}

					#define rand(v) sobol(v)
					#define rand2(v) sobol2(v)
					#define rand3(v) sobol3(v)
					#define rand4(v) sobol4(v)

				#else 					// PCG

				${pcg_functions}

					// Using the sobol functions seems to break the the compiler on MacOS
					// - specifically the "sobolReverseBits" function.
					uint sobolPixelIndex = 0u;
					uint sobolPathIndex = 0u;
					uint sobolBounceIndex = 0u;

					#define rand(v) pcgRand()
					#define rand2(v) pcgRand2()
					#define rand3(v) pcgRand3()
					#define rand4(v) pcgRand4()

				#endif

				// common
				${texture_sample_functions}
				${fresnel_functions}
				${util_functions}
				${math_functions}
				${shape_intersection_functions}

				// environment
				uniform EquirectHdrInfo envMapInfo;
				uniform mat4 environmentRotation;
				uniform float environmentIntensity;

				// lighting
				uniform sampler2DArray iesProfiles;
				uniform LightsInfo lights;

				// background
				uniform float backgroundBlur;
				uniform float backgroundAlpha;
				#if FEATURE_BACKGROUND_MAP

				uniform sampler2D backgroundMap;
				uniform mat4 backgroundRotation;
				uniform float backgroundIntensity;

				#endif

				// camera
				uniform mat4 cameraWorldMatrix;
				uniform mat4 invProjectionMatrix;
				#if FEATURE_DOF

				uniform PhysicalCamera physicalCamera;

				#endif

				// geometry
				uniform sampler2DArray attributesArray;
				uniform usampler2D materialIndexAttribute;
				uniform sampler2D materials;
				uniform sampler2DArray textures;
				uniform BVH bvh;

				// path tracer
				uniform int bounces;
				uniform int transmissiveBounces;
				uniform float filterGlossyFactor;
				uniform int seed;

				// image
				uniform vec2 resolution;
				uniform float opacity;

				varying vec2 vUv;

				// globals
				mat3 envRotation3x3;
				mat3 invEnvRotation3x3;
				float lightsDenom;

				// sampling
				${shape_sampling_functions}
				${equirect_functions}
				${light_sampling_functions}

				${inside_fog_volume_function}
				${ggx_functions}
				${sheen_functions}
				${iridescence_functions}
				${fog_functions}
				${bsdf_functions}

				float applyFilteredGlossy( float roughness, float accumulatedRoughness ) {

					return clamp(
						max(
							roughness,
							accumulatedRoughness * filterGlossyFactor * 5.0 ),
						0.0,
						1.0
					);

				}

				vec3 sampleBackground( vec3 direction, vec2 uv ) {

					vec3 sampleDir = sampleHemisphere( direction, uv ) * 0.5 * backgroundBlur;

					#if FEATURE_BACKGROUND_MAP

					sampleDir = normalize( mat3( backgroundRotation ) * direction + sampleDir );
					return backgroundIntensity * sampleEquirectColor( backgroundMap, sampleDir );

					#else

					sampleDir = normalize( envRotation3x3 * direction + sampleDir );
					return environmentIntensity * sampleEquirectColor( envMapInfo.map, sampleDir );

					#endif

				}

				${render_structs}
				${camera_util_functions}
				${trace_scene_function}
				${attenuate_hit_function}
				${direct_light_contribution_function}
				${get_surface_record_function}

				void main() {

					// init
					rng_initialize( gl_FragCoord.xy, seed );
					sobolPixelIndex = ( uint( gl_FragCoord.x ) << 16 ) | uint( gl_FragCoord.y );
					sobolPathIndex = uint( seed );

					// get camera ray
					Ray ray = getCameraRay();

					// inverse environment rotation
					envRotation3x3 = mat3( environmentRotation );
					invEnvRotation3x3 = inverse( envRotation3x3 );
					lightsDenom =
						( environmentIntensity == 0.0 || envMapInfo.totalSum == 0.0 ) && lights.count != 0u ?
							float( lights.count ) :
							float( lights.count + 1u );

					// final color
					gl_FragColor = vec4( 0, 0, 0, 1 );

					// surface results
					SurfaceHit surfaceHit;
					ScatterRecord scatterRec;

					// path tracing state
					RenderState state = initRenderState();
					state.transmissiveTraversals = transmissiveBounces;
					#if FEATURE_FOG

					state.fogMaterial.fogVolume = bvhIntersectFogVolumeHit(
						ray.origin, - ray.direction,
						materialIndexAttribute, materials,
						state.fogMaterial
					);

					#endif

					for ( int i = 0; i < bounces; i ++ ) {

						sobolBounceIndex ++;

						state.depth ++;
						state.traversals = bounces - i;
						state.firstRay = i == 0 && state.transmissiveTraversals == transmissiveBounces;

						int hitType = traceScene( ray, state.fogMaterial, surfaceHit );

						// check if we intersect any lights and accumulate the light contribution
						// TODO: we can add support for light surface rendering in the else condition if we
						// add the ability to toggle visibility of the the light
						if ( ! state.firstRay && ! state.transmissiveRay ) {

							LightRecord lightRec;
							float lightDist = hitType == NO_HIT ? INFINITY : surfaceHit.dist;
							for ( uint i = 0u; i < lights.count; i ++ ) {

								if (
									intersectLightAtIndex( lights.tex, ray.origin, ray.direction, i, lightRec ) &&
									lightRec.dist < lightDist
								) {

									#if FEATURE_MIS

									// weight the contribution
									// NOTE: Only area lights are supported for forward sampling and can be hit
									float misWeight = misHeuristic( scatterRec.pdf, lightRec.pdf / lightsDenom );
									gl_FragColor.rgb += lightRec.emission * state.throughputColor * misWeight;

									#else

									gl_FragColor.rgb += lightRec.emission * state.throughputColor;

									#endif

								}

							}

						}

						if ( hitType == NO_HIT ) {

							if ( state.firstRay || state.transmissiveRay ) {

								gl_FragColor.rgb += sampleBackground( ray.direction, rand2( 2 ) ) * state.throughputColor;
								gl_FragColor.a = backgroundAlpha;

							} else {

								#if FEATURE_MIS

								// get the PDF of the hit envmap point
								vec3 envColor;
								float envPdf = sampleEquirect( envRotation3x3 * ray.direction, envColor );
								envPdf /= lightsDenom;

								// and weight the contribution
								float misWeight = misHeuristic( scatterRec.pdf, envPdf );
								gl_FragColor.rgb += environmentIntensity * envColor * state.throughputColor * misWeight;

								#else

								gl_FragColor.rgb +=
									environmentIntensity *
									sampleEquirectColor( envMapInfo.map, envRotation3x3 * ray.direction ) *
									state.throughputColor;

								#endif

							}
							break;

						}

						uint materialIndex = uTexelFetch1D( materialIndexAttribute, surfaceHit.faceIndices.x ).r;
						Material material = readMaterialInfo( materials, materialIndex );

						#if FEATURE_FOG

						if ( hitType == FOG_HIT ) {

							material = state.fogMaterial;
							state.accumulatedRoughness += 0.2;

						} else if ( material.fogVolume ) {

							state.fogMaterial = material;
							state.fogMaterial.fogVolume = surfaceHit.side == 1.0;

							ray.origin = stepRayOrigin( ray.origin, ray.direction, - surfaceHit.faceNormal, surfaceHit.dist );

							i -= sign( state.transmissiveTraversals );
							state.transmissiveTraversals -= sign( state.transmissiveTraversals );
							continue;

						}

						#endif

						// early out if this is a matte material
						if ( material.matte && state.firstRay ) {

							gl_FragColor = vec4( 0.0 );
							break;

						}

						// if we've determined that this is a shadow ray and we've hit an item with no shadow casting
						// then skip it
						if ( ! material.castShadow && state.isShadowRay ) {

							ray.origin = stepRayOrigin( ray.origin, ray.direction, - surfaceHit.faceNormal, surfaceHit.dist );
							continue;

						}

						SurfaceRecord surf;
						if (
							getSurfaceRecord(
								material, surfaceHit, attributesArray, state.accumulatedRoughness,
								surf
							) == SKIP_SURFACE
						) {

							// only allow a limited number of transparency discards otherwise we could
							// crash the context with too long a loop.
							i -= sign( state.transmissiveTraversals );
							state.transmissiveTraversals -= sign( state.transmissiveTraversals );

							ray.origin = stepRayOrigin( ray.origin, ray.direction, - surfaceHit.faceNormal, surfaceHit.dist );
							continue;

						}

						scatterRec = bsdfSample( - ray.direction, surf );
						state.isShadowRay = scatterRec.specularPdf < rand( 4 );

						bool isBelowSurface = ! surf.volumeParticle && dot( scatterRec.direction, surf.faceNormal ) < 0.0;
						vec3 hitPoint = stepRayOrigin( ray.origin, ray.direction, isBelowSurface ? - surf.faceNormal : surf.faceNormal, surfaceHit.dist );

						// next event estimation
						#if FEATURE_MIS

						gl_FragColor.rgb += directLightContribution( - ray.direction, surf, state, hitPoint );

						#endif

						// accumulate a roughness value to offset diffuse, specular, diffuse rays that have high contribution
						// to a single pixel resulting in fireflies
						// TODO: handle transmissive surfaces
						if ( ! surf.volumeParticle && ! isBelowSurface ) {

							// determine if this is a rough normal or not by checking how far off straight up it is
							vec3 halfVector = normalize( - ray.direction + scatterRec.direction );
							state.accumulatedRoughness += max(
								sin( acosApprox( dot( halfVector, surf.normal ) ) ),
								sin( acosApprox( dot( halfVector, surf.clearcoatNormal ) ) )
							);

							state.transmissiveRay = false;

						}

						// accumulate emissive color
						gl_FragColor.rgb += ( surf.emission * state.throughputColor );

						// skip the sample if our PDF or ray is impossible
						if ( scatterRec.pdf <= 0.0 || ! isDirectionValid( scatterRec.direction, surf.normal, surf.faceNormal ) ) {

							break;

						}

						// if we're bouncing around the inside a transmissive material then decrement
						// perform this separate from a bounce
						bool isTransmissiveRay = ! surf.volumeParticle && dot( scatterRec.direction, surf.faceNormal * surfaceHit.side ) < 0.0;
						if ( ( isTransmissiveRay || isBelowSurface ) && state.transmissiveTraversals > 0 ) {

							state.transmissiveTraversals --;
							i --;

						}

						//

						// handle throughput color transformation
						// attenuate the throughput color by the medium color
						if ( ! surf.frontFace ) {

							state.throughputColor *= transmissionAttenuation( surfaceHit.dist, surf.attenuationColor, surf.attenuationDistance );

						}

						#if FEATURE_RUSSIAN_ROULETTE

						// russian roulette path termination
						// https://www.arnoldrenderer.com/research/physically_based_shader_design_in_arnold.pdf
						uint minBounces = 3u;
						float depthProb = float( state.depth < minBounces );

						float rrProb = luminance( state.throughputColor * scatterRec.color / scatterRec.pdf );
						rrProb /= luminance( state.throughputColor );
						rrProb = sqrt( rrProb );
						rrProb = max( rrProb, depthProb );
						rrProb = min( rrProb, 1.0 );
						if ( rand( 8 ) > rrProb ) {

							break;

						}

						// perform sample clamping here to avoid bright pixels
						state.throughputColor *= min( 1.0 / rrProb, 20.0 );

						#endif

						// adjust the throughput and discard and exit if we find discard the sample if there are any NaNs
						state.throughputColor *= scatterRec.color / scatterRec.pdf;
						if ( any( isnan( state.throughputColor ) ) || any( isinf( state.throughputColor ) ) ) {

							break;

						}

						//

						// prepare for next ray
						ray.direction = scatterRec.direction;
						ray.origin = hitPoint;

					}

					gl_FragColor.a *= opacity;

					#if DEBUG_MODE == 1

					// output the number of rays checked in the path and number of
					// transmissive rays encountered.
					gl_FragColor.rgb = vec3(
						float( state.depth ),
						transmissiveBounces - state.transmissiveTraversals,
						0.0
					);
					gl_FragColor.a = 1.0;

					#endif

				}

			`}),this.setValues(_)}}function*renderTask(){const{_renderer:K,_fsQuad:_,_blendQuad:Z,_primaryTarget:te,_blendTargets:ne,_sobolTarget:ie,_subframe:oe,alpha:se,material:ae}=this,le=new Vector4,ce=new Vector4,fe=Z.material;let[de,pe]=ne;for(;;){se?(fe.opacity=this._opacityFactor/(this.samples+1),ae.blending=NoBlending,ae.opacity=1):(ae.opacity=this._opacityFactor/(this.samples+1),ae.blending=NormalBlending);const[he,ge,me,Ae]=oe,ye=te.width,ve=te.height;ae.resolution.set(ye*me,ve*Ae),ae.sobolTexture=ie.texture,ae.stratifiedTexture.init(20,ae.bounces+ae.transmissiveBounces+5),ae.stratifiedTexture.next(),ae.seed++;const _e=this.tiles.x||1,Te=this.tiles.y||1,be=_e*Te,Re=Math.ceil(ye*me),we=Math.ceil(ve*Ae),Pe=Math.floor(he*ye),Ie=Math.floor(ge*ve),$e=Math.ceil(Re/_e),Ue=Math.ceil(we/Te);for(let ke=0;ke<Te;ke++)for(let Ge=0;Ge<_e;Ge++){const He=K.getRenderTarget(),ze=K.autoClear,Ke=K.getScissorTest();K.getScissor(le),K.getViewport(ce);let tt=Ge,Je=ke;if(!this.stableTiles){const Fe=this._currentTile%(_e*Te);tt=Fe%_e,Je=~~(Fe/_e),this._currentTile=Fe+1}const ot=Te-Je-1;te.scissor.set(Pe+tt*$e,Ie+ot*Ue,Math.min($e,Re-tt*$e),Math.min(Ue,we-ot*Ue)),te.viewport.set(Pe,Ie,Re,we),K.setRenderTarget(te),K.setScissorTest(!0),K.autoClear=!1,_.render(K),K.setViewport(ce),K.setScissor(le),K.setScissorTest(Ke),K.setRenderTarget(He),K.autoClear=ze,se&&(fe.target1=de.texture,fe.target2=te.texture,K.setRenderTarget(pe),Z.render(K),K.setRenderTarget(He)),this.samples+=1/be,Ge===_e-1&&ke===Te-1&&(this.samples=Math.round(this.samples)),yield}[de,pe]=[pe,de]}}const ogClearColor=new Color$1;class PathTracingRenderer{get material(){return this._fsQuad.material}set material(_){this._fsQuad.material.removeEventListener("recompilation",this._compileFunction),_.addEventListener("recompilation",this._compileFunction),this._fsQuad.material=_}get target(){return this._alpha?this._blendTargets[1]:this._primaryTarget}set alpha(_){this._alpha!==_&&(_||(this._blendTargets[0].dispose(),this._blendTargets[1].dispose()),this._alpha=_,this.reset())}get alpha(){return this._alpha}get isCompiling(){return!!this._compilePromise}constructor(_){this.camera=null,this.tiles=new Vector2(3,3),this.stableNoise=!1,this.stableTiles=!0,this.samples=0,this._subframe=new Vector4(0,0,1,1),this._opacityFactor=1,this._renderer=_,this._alpha=!1,this._fsQuad=new FullScreenQuad(new PhysicalPathTracingMaterial),this._blendQuad=new FullScreenQuad(new BlendMaterial),this._task=null,this._currentTile=0,this._compilePromise=null,this._sobolTarget=new SobolNumberMapGenerator().generate(_),this._primaryTarget=new WebGLRenderTarget(1,1,{format:RGBAFormat,type:FloatType,magFilter:NearestFilter,minFilter:NearestFilter}),this._blendTargets=[new WebGLRenderTarget(1,1,{format:RGBAFormat,type:FloatType,magFilter:NearestFilter,minFilter:NearestFilter}),new WebGLRenderTarget(1,1,{format:RGBAFormat,type:FloatType,magFilter:NearestFilter,minFilter:NearestFilter})],this._compileFunction=()=>{const Z=this.compileMaterial(this._fsQuad._mesh);Z.then(()=>{this._compilePromise===Z&&(this._compilePromise=null)}),this._compilePromise=Z},this.material.addEventListener("recompilation",this._compileFunction)}compileMaterial(){return this._renderer.compileAsync(this._fsQuad._mesh)}setCamera(_){const{material:Z}=this;Z.cameraWorldMatrix.copy(_.matrixWorld),Z.invProjectionMatrix.copy(_.projectionMatrixInverse),Z.physicalCamera.updateFrom(_);let te=0;_.projectionMatrix.elements[15]>0&&(te=1),_.isEquirectCamera&&(te=2),Z.setDefine("CAMERA_TYPE",te),this.camera=_}setSize(_,Z){_=Math.ceil(_),Z=Math.ceil(Z),!(this._primaryTarget.width===_&&this._primaryTarget.height===Z)&&(this._primaryTarget.setSize(_,Z),this._blendTargets[0].setSize(_,Z),this._blendTargets[1].setSize(_,Z),this.reset())}getSize(_){_.x=this._primaryTarget.width,_.y=this._primaryTarget.height}dispose(){this._primaryTarget.dispose(),this._blendTargets[0].dispose(),this._blendTargets[1].dispose(),this._sobolTarget.dispose(),this._fsQuad.dispose(),this._blendQuad.dispose(),this._task=null}reset(){const{_renderer:_,_primaryTarget:Z,_blendTargets:te}=this,ne=_.getRenderTarget(),ie=_.getClearAlpha();_.getClearColor(ogClearColor),_.setRenderTarget(Z),_.setClearColor(0,0),_.clearColor(),_.setRenderTarget(te[0]),_.setClearColor(0,0),_.clearColor(),_.setRenderTarget(te[1]),_.setClearColor(0,0),_.clearColor(),_.setClearColor(ogClearColor,ie),_.setRenderTarget(ne),this.samples=0,this._task=null,this.material.stratifiedTexture.stableNoise=this.stableNoise,this.stableNoise&&(this.material.seed=0,this.material.stratifiedTexture.reset())}update(){this.material.onBeforeRender(),!this.isCompiling&&(this._task||(this._task=renderTask.call(this)),this._task.next())}}const _uv=new Vector2,_coord=new Vector2,_polar=new Spherical,_color=new Color$1;class ProceduralEquirectTexture extends DataTexture{constructor(_=512,Z=512){super(new Float32Array(_*Z*4),_,Z,RGBAFormat,FloatType,EquirectangularReflectionMapping,RepeatWrapping,ClampToEdgeWrapping,LinearFilter,LinearFilter),this.generationCallback=null}update(){this.dispose(),this.needsUpdate=!0;const{data:_,width:Z,height:te}=this.image;for(let ne=0;ne<Z;ne++)for(let ie=0;ie<te;ie++){_coord.set(Z,te),_uv.set(ne/Z,ie/te),_uv.x-=.5,_uv.y=1-_uv.y,_polar.theta=_uv.x*2*Math.PI,_polar.phi=_uv.y*Math.PI,_polar.radius=1,this.generationCallback(_polar,_uv,_coord,_color);const se=4*(ie*Z+ne);_[se+0]=_color.r,_[se+1]=_color.g,_[se+2]=_color.b,_[se+3]=1}}copy(_){return super.copy(_),this.generationCallback=_.generationCallback,this}}const _direction=new Vector3;class GradientEquirectTexture extends ProceduralEquirectTexture{constructor(_=512){super(_,_),this.topColor=new Color$1().set(16777215),this.bottomColor=new Color$1().set(0),this.exponent=2,this.generationCallback=(Z,te,ne,ie)=>{_direction.setFromSpherical(Z);const oe=_direction.y*.5+.5;ie.lerpColors(this.bottomColor,this.topColor,oe**this.exponent)}}copy(_){return super.copy(_),this.topColor.copy(_.topColor),this.bottomColor.copy(_.bottomColor),this}}class ClampedInterpolationMaterial extends ShaderMaterial{get map(){return this.uniforms.map.value}set map(_){this.uniforms.map.value=_}get opacity(){return this.uniforms.opacity.value}set opacity(_){this.uniforms&&(this.uniforms.opacity.value=_)}constructor(_){super({uniforms:{map:{value:null},opacity:{value:1}},vertexShader:`
				varying vec2 vUv;
				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}
			`,fragmentShader:`
				uniform sampler2D map;
				uniform float opacity;
				varying vec2 vUv;

				vec4 clampedTexelFatch( sampler2D map, ivec2 px, int lod ) {

					vec4 res = texelFetch( map, ivec2( px.x, px.y ), 0 );

					#if defined( TONE_MAPPING )

					res.xyz = toneMapping( res.xyz );

					#endif

			  		return linearToOutputTexel( res );

				}

				void main() {

					vec2 size = vec2( textureSize( map, 0 ) );
					vec2 pxUv = vUv * size;
					vec2 pxCurr = floor( pxUv );
					vec2 pxFrac = fract( pxUv ) - 0.5;
					vec2 pxOffset;
					pxOffset.x = pxFrac.x > 0.0 ? 1.0 : - 1.0;
					pxOffset.y = pxFrac.y > 0.0 ? 1.0 : - 1.0;

					vec2 pxNext = clamp( pxOffset + pxCurr, vec2( 0.0 ), size - 1.0 );
					vec2 alpha = abs( pxFrac );

					vec4 p1 = mix(
						clampedTexelFatch( map, ivec2( pxCurr.x, pxCurr.y ), 0 ),
						clampedTexelFatch( map, ivec2( pxNext.x, pxCurr.y ), 0 ),
						alpha.x
					);

					vec4 p2 = mix(
						clampedTexelFatch( map, ivec2( pxCurr.x, pxNext.y ), 0 ),
						clampedTexelFatch( map, ivec2( pxNext.x, pxNext.y ), 0 ),
						alpha.x
					);

					gl_FragColor = mix( p1, p2, alpha.y );
					gl_FragColor.a *= opacity;
					#include <premultiplied_alpha_fragment>

				}
			`}),this.setValues(_)}}class CubeToEquirectMaterial extends ShaderMaterial{constructor(){super({uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:`
				varying vec2 vUv;
				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}`,fragmentShader:`
				#define ENVMAP_TYPE_CUBE_UV

				uniform samplerCube envMap;
				uniform float flipEnvMap;
				varying vec2 vUv;

				#include <common>
				#include <cube_uv_reflection_fragment>

				${util_functions}

				void main() {

					vec3 rayDirection = equirectUvToDirection( vUv );
					rayDirection.x *= flipEnvMap;
					gl_FragColor = textureCube( envMap, rayDirection );

				}`}),this.depthWrite=!1,this.depthTest=!1}}class CubeToEquirectGenerator{constructor(_){this._renderer=_,this._quad=new FullScreenQuad(new CubeToEquirectMaterial)}generate(_,Z=null,te=null){if(!_.isCubeTexture)throw new Error("CubeToEquirectMaterial: Source can only be cube textures.");const ne=_.images[0],ie=this._renderer,oe=this._quad;Z===null&&(Z=4*ne.height),te===null&&(te=2*ne.height);const se=new WebGLRenderTarget(Z,te,{type:FloatType,colorSpace:ne.colorSpace}),ae=ne.height,le=Math.log2(ae)-2,ce=1/ae,fe=1/(3*Math.max(Math.pow(2,le),7*16));oe.material.defines.CUBEUV_MAX_MIP=`${le}.0`,oe.material.defines.CUBEUV_TEXEL_WIDTH=fe,oe.material.defines.CUBEUV_TEXEL_HEIGHT=ce,oe.material.uniforms.envMap.value=_,oe.material.uniforms.flipEnvMap.value=_.isRenderTargetTexture?1:-1,oe.material.needsUpdate=!0;const de=ie.getRenderTarget(),pe=ie.autoClear;ie.autoClear=!0,ie.setRenderTarget(se),oe.render(ie),ie.setRenderTarget(de),ie.autoClear=pe;const he=new Uint16Array(Z*te*4),ge=new Float32Array(Z*te*4);ie.readRenderTargetPixels(se,0,0,Z,te,ge),se.dispose();for(let Ae=0,ye=ge.length;Ae<ye;Ae++)he[Ae]=DataUtils.toHalfFloat(ge[Ae]);const me=new DataTexture(he,Z,te,RGBAFormat,HalfFloatType);return me.minFilter=LinearMipMapLinearFilter,me.magFilter=LinearFilter,me.wrapS=RepeatWrapping,me.wrapT=RepeatWrapping,me.mapping=EquirectangularReflectionMapping,me.needsUpdate=!0,me}dispose(){this._quad.dispose()}}function supportsFloatBlending(K){return K.extensions.get("EXT_float_blend")}const _resolution=new Vector2;class WebGLPathTracer{get multipleImportanceSampling(){return!!this._pathTracer.material.defines.FEATURE_MIS}set multipleImportanceSampling(_){this._pathTracer.material.setDefine("FEATURE_MIS",_?1:0)}get transmissiveBounces(){return this._pathTracer.material.transmissiveBounces}set transmissiveBounces(_){this._pathTracer.material.transmissiveBounces=_}get bounces(){return this._pathTracer.material.bounces}set bounces(_){this._pathTracer.material.bounces=_}get filterGlossyFactor(){return this._pathTracer.material.filterGlossyFactor}set filterGlossyFactor(_){this._pathTracer.material.filterGlossyFactor=_}get samples(){return this._pathTracer.samples}get target(){return this._pathTracer.target}get tiles(){return this._pathTracer.tiles}get stableNoise(){return this._pathTracer.stableNoise}set stableNoise(_){this._pathTracer.stableNoise=_}get isCompiling(){return!!this._pathTracer.isCompiling}constructor(_){this._renderer=_,this._generator=new PathTracingSceneGenerator,this._pathTracer=new PathTracingRenderer(_),this._queueReset=!1,this._clock=new Clock,this._compilePromise=null,this._lowResPathTracer=new PathTracingRenderer(_),this._lowResPathTracer.tiles.set(1,1),this._quad=new FullScreenQuad(new ClampedInterpolationMaterial({map:null,transparent:!0,blending:NoBlending,premultipliedAlpha:_.getContextAttributes().premultipliedAlpha})),this._materials=null,this._previousEnvironment=null,this._previousBackground=null,this._internalBackground=null,this.renderDelay=100,this.minSamples=5,this.fadeDuration=500,this.enablePathTracing=!0,this.pausePathTracing=!1,this.dynamicLowRes=!1,this.lowResScale=.25,this.renderScale=1,this.synchronizeRenderSize=!0,this.rasterizeScene=!0,this.renderToCanvas=!0,this.textureSize=new Vector2(1024,1024),this.rasterizeSceneCallback=(Z,te)=>{this._renderer.render(Z,te)},this.renderToCanvasCallback=(Z,te,ne)=>{const ie=te.autoClear;te.autoClear=!1,ne.render(te),te.autoClear=ie},this.setScene(new Scene$1,new PerspectiveCamera$2)}setBVHWorker(_){this._generator.setBVHWorker(_)}setScene(_,Z,te={}){_.updateMatrixWorld(!0),Z.updateMatrixWorld();const ne=this._generator;if(ne.setObjects(_),this._buildAsync)return ne.generateAsync(te.onProgress).then(ie=>this._updateFromResults(_,Z,ie));{const ie=ne.generate();return this._updateFromResults(_,Z,ie)}}setSceneAsync(..._){this._buildAsync=!0;const Z=this.setScene(..._);return this._buildAsync=!1,Z}setCamera(_){this.camera=_,this.updateCamera()}updateCamera(){const _=this.camera;_.updateMatrixWorld(),this._pathTracer.setCamera(_),this._lowResPathTracer.setCamera(_),this.reset()}updateMaterials(){const _=this._pathTracer.material,Z=this._renderer,te=this._materials,ne=this.textureSize,ie=getTextures$1(te);_.textures.setTextures(Z,ie,ne.x,ne.y),_.materials.updateFrom(te,ie),this.reset()}updateLights(){const _=this.scene,Z=this._renderer,te=this._pathTracer.material,ne=getLights(_),ie=getIesTextures(ne);te.lights.updateFrom(ne,ie),te.iesProfiles.setTextures(Z,ie),this.reset()}updateEnvironment(){const _=this.scene,Z=this._pathTracer.material;if(this._internalBackground&&(this._internalBackground.dispose(),this._internalBackground=null),Z.backgroundBlur=_.backgroundBlurriness,Z.backgroundIntensity=_.backgroundIntensity??1,Z.backgroundRotation.makeRotationFromEuler(_.backgroundRotation).invert(),_.background===null)Z.backgroundMap=null,Z.backgroundAlpha=0;else if(_.background.isColor){this._colorBackground=this._colorBackground||new GradientEquirectTexture(16);const te=this._colorBackground;te.topColor.equals(_.background)||(te.topColor.set(_.background),te.bottomColor.set(_.background),te.update()),Z.backgroundMap=te,Z.backgroundAlpha=1}else if(_.background.isCubeTexture){if(_.background!==this._previousBackground){const te=new CubeToEquirectGenerator(this._renderer).generate(_.background);this._internalBackground=te,Z.backgroundMap=te,Z.backgroundAlpha=1}}else Z.backgroundMap=_.background,Z.backgroundAlpha=1;if(Z.environmentIntensity=_.environmentIntensity??1,Z.environmentRotation.makeRotationFromEuler(_.environmentRotation).invert(),this._previousEnvironment!==_.environment)if(_.environment!==null)if(_.environment.isCubeTexture){const te=new CubeToEquirectGenerator(this._renderer).generate(_.environment);Z.envMapInfo.updateFrom(te)}else Z.envMapInfo.updateFrom(_.environment);else Z.environmentIntensity=0;this._previousEnvironment=_.environment,this._previousBackground=_.background,this.reset()}_updateFromResults(_,Z,te){const{materials:ne,geometry:ie,bvh:oe,bvhChanged:se}=te;this._materials=ne;const le=this._pathTracer.material;return se&&(le.bvh.updateFrom(oe),le.attributesArray.updateFrom(ie.attributes.normal,ie.attributes.tangent,ie.attributes.uv,ie.attributes.color),le.materialIndexAttribute.updateFrom(ie.attributes.materialIndex)),this._previousScene=_,this.scene=_,this.camera=Z,this.updateCamera(),this.updateMaterials(),this.updateEnvironment(),this.updateLights(),te}renderSample(){const _=this._lowResPathTracer,Z=this._pathTracer,te=this._renderer,ne=this._clock,ie=this._quad;this._updateScale(),this._queueReset&&(Z.reset(),_.reset(),this._queueReset=!1,ie.material.opacity=0,ne.start());const oe=ne.getDelta()*1e3,se=ne.getElapsedTime()*1e3;if(!this.pausePathTracing&&this.enablePathTracing&&this.renderDelay<=se&&!this.isCompiling&&Z.update(),Z.alpha=Z.material.backgroundAlpha!==1||!supportsFloatBlending(te),_.alpha=Z.alpha,this.renderToCanvas){const ae=this._renderer,le=this.minSamples;if(se>=this.renderDelay&&this.samples>=this.minSamples&&(this.fadeDuration!==0?ie.material.opacity=Math.min(ie.material.opacity+oe/this.fadeDuration,1):ie.material.opacity=1),!this.enablePathTracing||this.samples<le||ie.material.opacity<1){if(this.dynamicLowRes&&!this.isCompiling){_.samples<1&&(_.material=Z.material,_.update());const ce=ie.material.opacity;ie.material.opacity=1-ie.material.opacity,ie.material.map=_.target.texture,ie.render(ae),ie.material.opacity=ce}(!this.dynamicLowRes&&this.rasterizeScene||this.dynamicLowRes&&this.isCompiling)&&this.rasterizeSceneCallback(this.scene,this.camera)}this.enablePathTracing&&ie.material.opacity>0&&(ie.material.opacity<1&&(ie.material.blending=this.dynamicLowRes?AdditiveBlending:NormalBlending),ie.material.map=Z.target.texture,this.renderToCanvasCallback(Z.target,ae,ie),ie.material.blending=NoBlending)}}reset(){this._queueReset=!0,this._pathTracer.samples=0}dispose(){this._renderQuad.dispose(),this._renderQuad.material.dispose(),this._pathTracer.dispose()}_updateScale(){if(this.synchronizeRenderSize){this._renderer.getDrawingBufferSize(_resolution);const _=Math.floor(this.renderScale*_resolution.x),Z=Math.floor(this.renderScale*_resolution.y);if(this._pathTracer.getSize(_resolution),_resolution.x!==_||_resolution.y!==Z){const te=this.lowResScale;this._pathTracer.setSize(_,Z),this._lowResPathTracer.setSize(Math.floor(_*te),Math.floor(Z*te))}}}}class PhysicalSpotLight extends SpotLight$2{constructor(..._){super(..._),this.iesMap=null,this.radius=0}copy(_,Z){return super.copy(_,Z),this.iesMap=_.iesMap,this.radius=_.radius,this}}class ShapedAreaLight extends RectAreaLight$1{constructor(..._){super(..._),this.isCircular=!1}copy(_,Z){return super.copy(_,Z),this.isCircular=_.isCircular,this}}class PMREMCopyMaterial extends MaterialBase{constructor(){super({uniforms:{envMap:{value:null},blur:{value:0}},vertexShader:`

				varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}

			`,fragmentShader:`

				#include <common>
				#include <cube_uv_reflection_fragment>

				${util_functions}

				uniform sampler2D envMap;
				uniform float blur;
				varying vec2 vUv;
				void main() {

					vec3 rayDirection = equirectUvToDirection( vUv );
					gl_FragColor = textureCubeUV( envMap, rayDirection, blur );

				}

			`})}}class BlurredEnvMapGenerator{constructor(_){this.renderer=_,this.pmremGenerator=new PMREMGenerator(_),this.copyQuad=new FullScreenQuad(new PMREMCopyMaterial),this.renderTarget=new WebGLRenderTarget(1,1,{type:FloatType,format:RGBAFormat})}dispose(){this.pmremGenerator.dispose(),this.copyQuad.dispose(),this.renderTarget.dispose()}generate(_,Z){const{pmremGenerator:te,renderTarget:ne,copyQuad:ie,renderer:oe}=this,se=te.fromEquirectangular(_),{width:ae,height:le}=_.image;ne.setSize(ae,le),ie.material.envMap=se.texture,ie.material.blur=Z;const ce=oe.getRenderTarget(),fe=oe.autoClear;oe.setRenderTarget(ne),oe.autoClear=!0,ie.render(oe),oe.setRenderTarget(ce),oe.autoClear=fe;const de=new Uint16Array(ae*le*4),pe=new Float32Array(ae*le*4);oe.readRenderTargetPixels(ne,0,0,ae,le,pe);for(let ge=0,me=pe.length;ge<me;ge++)de[ge]=DataUtils.toHalfFloat(pe[ge]);const he=new DataTexture(de,ae,le,RGBAFormat,HalfFloatType);return he.minFilter=_.minFilter,he.magFilter=_.magFilter,he.wrapS=_.wrapS,he.wrapT=_.wrapT,he.mapping=EquirectangularReflectionMapping,he.needsUpdate=!0,se.dispose(),he}}class DenoiseMaterial extends MaterialBase{constructor(_){super({blending:NoBlending,transparent:!1,depthWrite:!1,depthTest:!1,defines:{USE_SLIDER:0},uniforms:{sigma:{value:5},threshold:{value:.03},kSigma:{value:1},map:{value:null},opacity:{value:1}},vertexShader:`

				varying vec2 vUv;

				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}

			`,fragmentShader:`

				//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
				//  Copyright (c) 2018-2019 Michele Morrone
				//  All rights reserved.
				//
				//  https://michelemorrone.eu - https://BrutPitt.com
				//
				//  me@michelemorrone.eu - brutpitt@gmail.com
				//  twitter: @BrutPitt - github: BrutPitt
				//
				//  https://github.com/BrutPitt/glslSmartDeNoise/
				//
				//  This software is distributed under the terms of the BSD 2-Clause license
				//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

				uniform sampler2D map;

				uniform float sigma;
				uniform float threshold;
				uniform float kSigma;
				uniform float opacity;

				varying vec2 vUv;

				#define INV_SQRT_OF_2PI 0.39894228040143267793994605993439
				#define INV_PI 0.31830988618379067153776752674503

				// Parameters:
				//	 sampler2D tex	 - sampler image / texture
				//	 vec2 uv		   - actual fragment coord
				//	 float sigma  >  0 - sigma Standard Deviation
				//	 float kSigma >= 0 - sigma coefficient
				//		 kSigma * sigma  -->  radius of the circular kernel
				//	 float threshold   - edge sharpening threshold
				vec4 smartDeNoise( sampler2D tex, vec2 uv, float sigma, float kSigma, float threshold ) {

					float radius = round( kSigma * sigma );
					float radQ = radius * radius;

					float invSigmaQx2 = 0.5 / ( sigma * sigma );
					float invSigmaQx2PI = INV_PI * invSigmaQx2;

					float invThresholdSqx2 = 0.5 / ( threshold * threshold );
					float invThresholdSqrt2PI = INV_SQRT_OF_2PI / threshold;

					vec4 centrPx = texture2D( tex, uv );
					centrPx.rgb *= centrPx.a;

					float zBuff = 0.0;
					vec4 aBuff = vec4( 0.0 );
					vec2 size = vec2( textureSize( tex, 0 ) );

					vec2 d;
					for ( d.x = - radius; d.x <= radius; d.x ++ ) {

						float pt = sqrt( radQ - d.x * d.x );

						for ( d.y = - pt; d.y <= pt; d.y ++ ) {

							float blurFactor = exp( - dot( d, d ) * invSigmaQx2 ) * invSigmaQx2PI;

							vec4 walkPx = texture2D( tex, uv + d / size );
							walkPx.rgb *= walkPx.a;

							vec4 dC = walkPx - centrPx;
							float deltaFactor = exp( - dot( dC.rgba, dC.rgba ) * invThresholdSqx2 ) * invThresholdSqrt2PI * blurFactor;

							zBuff += deltaFactor;
							aBuff += deltaFactor * walkPx;

						}

					}

					return aBuff / zBuff;

				}

				void main() {

					gl_FragColor = smartDeNoise( map, vec2( vUv.x, vUv.y ), sigma, kSigma, threshold );
					#include <tonemapping_fragment>
					#include <colorspace_fragment>
					#include <premultiplied_alpha_fragment>

					gl_FragColor.a *= opacity;

				}

			`}),this.setValues(_)}}class FogVolumeMaterial extends MeshStandardMaterial{constructor(_){super(_),this.isFogVolumeMaterial=!0,this.density=.015,this.emissive=new Color$1,this.emissiveIntensity=0,this.opacity=.15,this.transparent=!0,this.roughness=1,this.metalness=0,this.setValues(_)}}(function(){try{if(typeof document<"u"){var K=document.createElement("style");K.appendChild(document.createTextNode(`._panel_1frsq_1 ._folder_1frsq_1 ._item_1frsq_1{cursor:pointer;width:100%;border-radius:7px;margin:0}._panel_1frsq_1{display:flex;flex-direction:column;padding:18px 16px}._folder_1frsq_1{padding-left:12px;overflow:hidden}._item_1frsq_1{width:100%;padding:4px 14px;line-height:14px;font-size:14px;height:22px;white-space:nowrap;overflow:hidden}._item_1frsq_1:hover{background-color:var(--surface-color)}._style_17ukg_1{position:absolute;bottom:24px;left:50%;transform:translate(-50%);z-index:99999}._style_17ukg_1 button:first-of-type{border-top-left-radius:4px;border-bottom-left-radius:4px;border-left:1px solid white;border-top:1px solid white;border-bottom:1px solid white}._style_17ukg_1 button:last-of-type{border-top-right-radius:4px;border-bottom-right-radius:4px;border-right:1px solid white;border-top:1px solid white;border-bottom:1px solid white}._style_17ukg_1 button:not(:first-of-type){border-left-color:transparent;margin-left:-1px}._style_17ukg_1 button:not(:last-of-type){border-right:1px solid white}._buttonStyle_17ukg_30{cursor:pointer;border-radius:0;background:#0000001a;color:#fff;font: .8125rem sans-serif;padding:12px 24px;outline:none;user-select:none;-webkit-user-select:none}._buttonStyle_17ukg_30:hover{background:#23aaffde}._buttonStyle_17ukg_30:active{background:#ffffff1a}._iframeVuerLinkButton_gxqj6_1{position:absolute;display:block;bottom:24px;left:50%;transform:translate(-50%);height:36px;text-decoration:none;vertical-align:middle;padding:10px;line-height:16px;color:#fff;border:1px solid #fff;border-radius:5px;background-color:transparent;z-index:20}._perfS_eu9ak_1{position:fixed;top:0;right:0;z-index:9999;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;background-color:#242424e6;color:#fff;margin:0;min-height:100px;padding:4px 0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-user-select:none;user-select:none;border:0;font-size:100%;line-height:1;vertical-align:baseline}._perfS_eu9ak_1._top-right_eu9ak_21{margin:0;padding:0;border:0;top:0;right:0;font-size:100%;line-height:1;vertical-align:baseline}._perfS_eu9ak_1._top-left_eu9ak_31{right:initial;left:0}._perfS_eu9ak_1._bottom-left_eu9ak_35{right:initial;top:initial;bottom:0;left:0}._perfS_eu9ak_1._bottom-left_eu9ak_35._toggle_eu9ak_41{top:-20px;bottom:initial}._perfS_eu9ak_1._bottom-right_eu9ak_45{top:initial;bottom:0}._perfS_eu9ak_1._bottom-right_eu9ak_45._toggle_eu9ak_41{top:-20px;bottom:initial}._minimal_eu9ak_54{background-color:#242424bf}._perfIContainer_eu9ak_58{display:flex}._perfI_eu9ak_58{display:inline-flex;font-style:normal;padding:0;line-height:13px;font-size:14px;width:62px;position:relative;pointer-events:auto;cursor:default;font-weight:500;letter-spacing:0;text-align:left;height:29px;white-space:nowrap;justify-content:space-evenly;font-variant-numeric:tabular-nums}._perfI_eu9ak_58 small{padding-left:12px}._perfI_eu9ak_58 svg{padding:0;color:#ffffff4d;font-size:40px;position:absolute;z-index:1;max-height:20px;left:50%;margin-left:13px;top:3px}._perfI_eu9ak_58 ._perfSmall_eu9ak_94{position:absolute;right:0;font-size:10px}._perfI_eu9ak_58 *{margin:0;padding:0;border:0;font-size:100%;line-height:1;vertical-align:baseline}._perfB_eu9ak_108{vertical-align:bottom;position:absolute;bottom:5px;color:#65c5bc;text-align:right;letter-spacing:1px;font-size:8px;font-weight:500;width:60px}._programHeader_eu9ak_120{background-color:#404040;padding:6px;display:block;font-size:12px;margin-bottom:6px;cursor:pointer}._programHeader_eu9ak_120 *{cursor:pointer!important}._programHeader_eu9ak_120 small{font-size:9px}._programHeader_eu9ak_120>b{margin-right:4px;cursor:pointer}._graph_eu9ak_139{height:66px;overflow:hidden;position:absolute;pointer-events:none;display:flex;top:0;justify-content:center;width:100%;min-width:310px;margin:0 auto}._graph_eu9ak_139 canvas{background:transparent!important;position:absolute!important}._graphpc_eu9ak_156{text-align:center;font-weight:700;font-size:12px;line-height:12px;display:flex;justify-content:center;align-items:center;vertical-align:middle;color:#f1f1f1;padding:7px;width:100%;background-color:#242425cc;z-index:1;position:absolute;height:100%}._toggle_eu9ak_41{pointer-events:auto;justify-content:center;cursor:pointer;font-size:12px;background-color:#292b2d;width:auto;margin:0;color:#919191;text-align:center;display:inline-block;vertical-align:middle;padding:4px 6px}._toggle_eu9ak_41._active_eu9ak_189{background-color:#1f1f1f}._toggle_eu9ak_41 svg{width:12px;height:12px;float:left}._toggleVisible_eu9ak_198{pointer-events:auto;justify-content:center;cursor:pointer;font-size:12px;float:right;background-color:#292b2d;width:auto;margin:0;color:#919191;text-align:center;display:inline-block;vertical-align:middle;padding:4px 6px}._toggleVisible_eu9ak_198 ._active_eu9ak_189{background-color:#1f1f1f}._toggleVisible_eu9ak_198 svg{width:12px;height:12px;float:left}._programGeo_eu9ak_222{padding:4px 6px;font-size:12px;pointer-events:auto}._programTitle_eu9ak_228{font-weight:700;letter-spacing:.08em;max-width:145px;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:middle;font-size:11px;margin-right:10px}._containerScroll_eu9ak_240{max-height:50vh;overflow-y:auto;margin-top:38px}._programsContainer_eu9ak_246{margin-top:0}._programsULHeader_eu9ak_250{display:flex;position:relative;font-weight:700;color:#fff;line-height:14px}._programsULHeader_eu9ak_250 svg{margin-right:4px;display:inline-block}._programsUL_eu9ak_250{display:block;position:relative;padding-left:10px;margin:6px}._programsUL_eu9ak_250 img{max-height:60px;max-width:100%;margin:6px auto;display:block}._programsUL_eu9ak_250:after{content:"";position:absolute;left:0;top:-5px;width:1px;height:100%;background-color:gray;transform:translate(-50%);max-height:50vh;overflow-y:auto}._programsUL_eu9ak_250 li{border-bottom:1px solid #313131;display:block;padding:4px;margin:0;line-height:1;vertical-align:middle;height:24px}._programsUL_eu9ak_250 b{font-weight:700}._programsUL_eu9ak_250 small{text-align:revert;letter-spacing:1px;font-size:10px;font-weight:500;margin-left:2px;color:#65c5bc}._programConsole_eu9ak_307{font-weight:700;letter-spacing:.02em;background-color:#292b2d;color:#d3d3d3;overflow:hidden;text-overflow:ellipsis;cursor:pointer;display:block;vertical-align:middle;font-size:11px;padding:5px;margin:4px auto}._toggleContainer_eu9ak_322{display:flex;justify-content:center;cursor:pointer;font-size:12px;background-color:#292b2d;width:auto;margin:0 auto;color:#919191;text-align:center;position:absolute;right:0;bottom:-20px}._toggleContainer_eu9ak_322 svg{width:12px;height:12px;float:left}._programsGeoLi_eu9ak_343{display:flex!important;height:auto!important}._programsGeoLi_eu9ak_343 span{height:40px;display:block;position:relative}._programsGeoLi_eu9ak_343 b{padding-left:12px}._vuerRoot_evnl7_1{position:absolute;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;color:#fff}._dropContainer_evnl7_12{width:100%;height:100%}._dropPrompt_evnl7_17{position:absolute;display:flex;justify-content:center;align-items:center;width:100%;height:100%}._dropPrompt_evnl7_17:after{max-width:calc(100% - 100px);max-height:calc(100% - 100px);margin:100px;width:300px;height:200px;border:2px dashed white;border-radius:24px;content:attr(data-text);display:flex;justify-content:center;align-items:center}._dropContainer_nrs9w_1{position:relative;width:100%;height:100%}._fadeContainer_nrs9w_7{transition:opacity .5s;width:100%;height:100%}._dropPrompt_nrs9w_13{position:absolute;display:flex;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0}._dropPrompt_nrs9w_13:after{max-width:300px;max-height:200px;margin:40px;width:calc(100% - 80px);height:calc(100% - 80px);padding:0 8px;border:2px dashed white;border-radius:24px;color:#999;font-size:13px;content:attr(data-text);display:flex;justify-content:center;align-items:center}._playhead_at0ov_1{position:absolute;width:0;border-left:1px solid var(--theme);margin-left:-50%;top:6px;bottom:0;background-color:var(--theme);pointer-events:none;display:flex;align-items:flex-start;justify-content:center}._playhead_at0ov_1:before{display:block;padding:0 4px;border-radius:var(--radius);background-color:var(--theme);font-family:var(--font-family-mono);font-size:var(--font-size-small);line-height:20px;font-weight:700;color:#000}._playhead_at0ov_1:before{content:attr(data-seeking)}._tsStyle_skfcc_1{-webkit-user-select:none;user-select:none;pointer-events:none;position:absolute;top:32px;bottom:0;border-left:1px solid rgba(0,0,0,.2);border-right:1px solid rgba(0,0,0,.2);width:0;display:flex;justify-content:center}._tsStyle_skfcc_1:after{font-family:var(--font-family-mono);font-size:var(--font-size-small);line-height:32px;margin-top:-32px;text-align:center;color:#ffffff8a;content:attr(data-label)}._svg_ohgsw_1{width:18px;height:18px;vertical-align:middle}@keyframes _breathAnimation_1aomm_1{0%{opacity:1}50%{opacity:.2}to{opacity:1}}._activeStyle_1aomm_12{fill:red;stroke:transparent;stroke-width:0;animation:_breathAnimation_1aomm_1 5s infinite}._activeStyle_1aomm_12:hover{animation:none;fill:transparent;stroke:#fff;stroke-width:10}._disabledStyle_1aomm_25{fill:transparent;stroke:#ffffff8a;stroke-width:10}._disabledStyle_1aomm_25:hover{fill:red;stroke:#fff;opacity:1!important}._container_p79ru_1{height:32px;cursor:pointer;width:100%}._rangeStyle_p79ru_7{border-radius:var(--radius);cursor:move;position:absolute;height:32px;background-color:#24242400;border:2px solid rgba(255,255,255,.24);display:flex;align-items:center;justify-content:center;pointer-events:auto;max-width:100%;opacity:.4}._rangeStyle_p79ru_7:hover{opacity:.8}._style_p79ru_25{flex-grow:1;flex-shrink:1}._dragIndStyle_p79ru_30{margin-top:2px;color:#fff;opacity:.5;z-index:auto;min-width:0;cursor:ew-resize}._dragIndStyle_p79ru_30:hover{opacity:.9;z-index:1;min-width:24px}._dragIndStyle_p79ru_30:active{opacity:1}._timelineContainer_qu5eg_1{--theme: #33a6ff;--theme-light: #52bbff;--theme-overlay: rgba(51, 166, 255, .16);--background-color: #181818;--background-color-dark: #141414;--surface-color: #242424;--surface-color-light: #444444;--surface-color-hover: #333333;--border-color: var(--background-color-dark);--scrollbar-background: var(--surface-color);--input-background: var(--surface-color-light);--input-background-hover: var(--surface-color-hover);--radius: 4px;--timing-ease-out: cubic-bezier(.33, 1, .68, 1);--timing-ease-in-out: cubic-bezier(.65, 0, .35, 1);--duration-normal: .2s;--duration-fast: .1s;--font-family: "Roboto", sans-serif;--font-family-mono: "JetBrains Mono", monospace;--font-size: 14px;--font-size-small: 12px;--font-size-big: 16px;--red: #e13238;--yellow: #e6a700;--blue: #4cb3d4;font-family:var(--font-family),sans-serif;font-size:var(--font-size);line-height:24px;color:#fff9;width:100%;height:100%;transition:opacity var(--duration-normal);display:flex;align-items:stretch;position:relative;background-color:var(--background-color)}._timeline_qu5eg_1{overflow-x:scroll;overscroll-behavior-x:none;overflow-y:hidden;flex-grow:1;position:relative;background-color:transparent;--scrollbar-background: var(--background-color);height:100%;width:100%}._visibleContainer_qu5eg_52{position:relative;overflow:hidden;height:100%}._scrollContainer_qu5eg_58{position:relative;overflow:visible;height:calc(100% - 19px)}._playheadCursor_qu5eg_64{position:absolute;width:2px;top:32px;bottom:0;background-color:#fff;pointer-events:none;box-sizing:border-box;border:1px solid #444;margin-left:-1.5px}._trackContainer_qu5eg_76{width:100%;height:calc(100% - 32px);background-color:var(--surface-color)}._trackPlaceholder_qu5eg_82{position:absolute;width:200px;left:calc(50% - 100px);bottom:50%;opacity:.8;font-size:1.5em;white-space:nowrap}._codeStyle_1tml4_1{height:24px;padding:0;background:transparent}._frameStyle_1tml4_7{color:#ffffff8a}._frameTimeStyle_1tml4_11{margin:0 8px;color:#ffffff52}._buttonStyle_1voiw_1{display:block;cursor:pointer;margin:0;color:#ffffff8a;background:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;padding:0}._buttonStyle_1voiw_1:hover{color:#fff!important;accent-color:#fff!important}._buttonStyle_1voiw_1:active{color:#23aaff!important;accent-color:#23aaff!important}._disabledStyle_1voiw_22{cursor:default;pointer-events:none;color:#ffffff29}._buttonStyle_10wsy_1{display:block;cursor:pointer;margin:0;color:#ffffff8a;background:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;padding:0}._buttonStyle_10wsy_1:hover{color:#fff}._buttonStyle_10wsy_1:active{color:var(--theme)}._disabledStyle_10wsy_20{cursor:default;pointer-events:none;color:#ffffff29}._containerStyle_10utv_1{font-family:var(--font-family-mono);background-color:var(--input-background);color:#fff9;border-radius:var(--radius);border:0;padding:0 8px;height:24px;flex-shrink:1;flex-grow:1;min-width:0;display:inline-block;text-wrap:nowrap}._containerStyle_10utv_1:before{content:attr(data-prefix);z-index:1;color:#fff9;display:inline}._containerStyle_10utv_1:after{content:attr(data-postfix);z-index:1;color:#fff9;display:inline}._containerStyle_10utv_1 :hover{background-color:var(--input-background-hover)}._containerStyle_10utv_1._main_10utv_30{--loading-stripe-color: var(--theme-light);background-color:var(--theme);color:#000000de;font-weight:700}._containerStyle_10utv_1._main_10utv_30:hover{box-shadow:0 0 0 2px #fff inset}._containerStyle_10utv_1:disabled{pointer-events:none;opacity:.54}._inputStyle_10utv_44{display:inline;border:0;margin:0;padding:0;height:24px;background-color:transparent;color:#fff9;padding-block:0;padding-inline:0;-moz-appearance:textfield}._inputStyle_10utv_44:focus{outline:none}._inputStyle_10utv_44::-webkit-inner-spin-button,._inputStyle_10utv_44::-webkit-outer-spin-button{-webkit-appearance:none;margin:0;width:0;height:0}._style_1gufv_1{cursor:pointer;font-family:var(--font-family-mono);background-color:var(--input-background);color:#fff9;border:0;border-radius:var(--radius);padding:0 8px;height:24px;flex-shrink:1;flex-grow:1;min-width:0}._style_1gufv_1:hover{background-color:var(--input-background-hover)}._style_1gufv_1:disabled{pointer-events:none;opacity:.54}._style_1h298_1{height:16px;display:flex;justify-content:center;align-items:center;gap:16px}._playbackBar_1kd28_1{--theme: #33a6ff;--theme-light: #52bbff;--theme-overlay: rgba(51, 166, 255, .16);--background-color: #181818;--background-color-dark: #141414;--surface-color: #242424;--surface-color-light: #444444;--surface-color-hover: #333333;--border-color: var(--background-color-dark);--scrollbar-background: var(--surface-color);--input-background: var(--surface-color-light);--input-background-hover: var(--surface-color-hover);--radius: 4px;--timing-ease-out: cubic-bezier(.33, 1, .68, 1);--timing-ease-in-out: cubic-bezier(.65, 0, .35, 1);--duration-normal: .2s;--duration-fast: .1s;--font-family: "Roboto", sans-serif;--font-family-mono: "JetBrains Mono", monospace;--font-size: 14px;--font-size-small: 12px;--font-size-big: 16px;--red: #e13238;--yellow: #e6a700;--blue: #4cb3d4;font-family:var(--font-family),sans-serif;font-size:var(--font-size);line-height:24px;background-color:var(--background-color);color:#fff9;background:var(--surface-color);display:grid;grid-template-columns:1fr min-content 1fr;padding:10px 12px 12px;-webkit-user-select:none;user-select:none;align-items:center;opacity:.99}._progressBar_1kd28_41{margin-top:-12px;z-index:-1;content:"";position:absolute;left:0;height:48px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 304 304' width='150' height='150'%3E%3Cpath fill='%23333333' fill-opacity='0.8' d='M44.1 224a5 5 0 1 1 0 2H0v-2h44.1zm160 48a5 5 0 1 1 0 2H82v-2h122.1zm57.8-46a5 5 0 1 1 0-2H304v2h-42.1zm0 16a5 5 0 1 1 0-2H304v2h-42.1zm6.2-114a5 5 0 1 1 0 2h-86.2a5 5 0 1 1 0-2h86.2zm-256-48a5 5 0 1 1 0 2H0v-2h12.1zm185.8 34a5 5 0 1 1 0-2h86.2a5 5 0 1 1 0 2h-86.2zM258 12.1a5 5 0 1 1-2 0V0h2v12.1zm-64 208a5 5 0 1 1-2 0v-54.2a5 5 0 1 1 2 0v54.2zm48-198.2V80h62v2h-64V21.9a5 5 0 1 1 2 0zm16 16V64h46v2h-48V37.9a5 5 0 1 1 2 0zm-128 96V208h16v12.1a5 5 0 1 1-2 0V210h-16v-76.1a5 5 0 1 1 2 0zm-5.9-21.9a5 5 0 1 1 0 2H114v48H85.9a5 5 0 1 1 0-2H112v-48h12.1zm-6.2 130a5 5 0 1 1 0-2H176v-74.1a5 5 0 1 1 2 0V242h-60.1zm-16-64a5 5 0 1 1 0-2H114v48h10.1a5 5 0 1 1 0 2H112v-48h-10.1zM66 284.1a5 5 0 1 1-2 0V274H50v30h-2v-32h18v12.1zM236.1 176a5 5 0 1 1 0 2H226v94h48v32h-2v-30h-48v-98h12.1zm25.8-30a5 5 0 1 1 0-2H274v44.1a5 5 0 1 1-2 0V146h-10.1zm-64 96a5 5 0 1 1 0-2H208v-80h16v-14h-42.1a5 5 0 1 1 0-2H226v18h-16v80h-12.1zm86.2-210a5 5 0 1 1 0 2H272V0h2v32h10.1zM98 101.9V146H53.9a5 5 0 1 1 0-2H96v-42.1a5 5 0 1 1 2 0zM53.9 34a5 5 0 1 1 0-2H80V0h2v34H53.9zm60.1 3.9V66H82v64H69.9a5 5 0 1 1 0-2H80V64h32V37.9a5 5 0 1 1 2 0zM101.9 82a5 5 0 1 1 0-2H128V37.9a5 5 0 1 1 2 0V82h-28.1zm16-64a5 5 0 1 1 0-2H146v44.1a5 5 0 1 1-2 0V18h-26.1zm102.2 270a5 5 0 1 1 0 2H98v14h-2v-16h124.1zM242 149.9V160h16v34h-16v62h48v48h-2v-46h-48v-66h16v-30h-16v-12.1a5 5 0 1 1 2 0zM53.9 18a5 5 0 1 1 0-2H64V2H48V0h18v18H53.9zm112 32a5 5 0 1 1 0-2H192V0h50v2h-48v48h-28.1zm-48-48a5 5 0 0 1-9.8-2h2.07a3 3 0 1 0 5.66 0H178v34h-18V21.9a5 5 0 1 1 2 0V32h14V2h-58.1zm0 96a5 5 0 1 1 0-2H137l32-32h39V21.9a5 5 0 1 1 2 0V66h-40.17l-32 32H117.9zm28.1 90.1a5 5 0 1 1-2 0v-76.51L175.59 80H224V21.9a5 5 0 1 1 2 0V82h-49.59L146 112.41v75.69zm16 32a5 5 0 1 1-2 0v-99.51L184.59 96H300.1a5 5 0 0 1 3.9-3.9v2.07a3 3 0 0 0 0 5.66v2.07a5 5 0 0 1-3.9-3.9H185.41L162 121.41v98.69zm-144-64a5 5 0 1 1-2 0v-3.51l48-48V48h32V0h2v50H66v55.41l-48 48v2.69zM50 53.9v43.51l-48 48V208h26.1a5 5 0 1 1 0 2H0v-65.41l48-48V53.9a5 5 0 1 1 2 0zm-16 16V89.41l-34 34v-2.82l32-32V69.9a5 5 0 1 1 2 0zM12.1 32a5 5 0 1 1 0 2H9.41L0 43.41V40.6L8.59 32h3.51zm265.8 18a5 5 0 1 1 0-2h18.69l7.41-7.41v2.82L297.41 50H277.9zm-16 160a5 5 0 1 1 0-2H288v-71.41l16-16v2.82l-14 14V210h-28.1zm-208 32a5 5 0 1 1 0-2H64v-22.59L40.59 194H21.9a5 5 0 1 1 0-2H41.41L66 216.59V242H53.9zm150.2 14a5 5 0 1 1 0 2H96v-56.6L56.6 162H37.9a5 5 0 1 1 0-2h19.5L98 200.6V256h106.1zm-150.2 2a5 5 0 1 1 0-2H80v-46.59L48.59 178H21.9a5 5 0 1 1 0-2H49.41L82 208.59V258H53.9zM34 39.8v1.61L9.41 66H0v-2h8.59L32 40.59V0h2v39.8zM2 300.1a5 5 0 0 1 3.9 3.9H3.83A3 3 0 0 0 0 302.17V256h18v48h-2v-46H2v42.1zM34 241v63h-2v-62H0v-2h34v1zM17 18H0v-2h16V0h2v18h-1zm273-2h14v2h-16V0h2v16zm-32 273v15h-2v-14h-14v14h-2v-16h18v1zM0 92.1A5.02 5.02 0 0 1 6 97a5 5 0 0 1-6 4.9v-2.07a3 3 0 1 0 0-5.66V92.1zM80 272h2v32h-2v-32zm37.9 32h-2.07a3 3 0 0 0-5.66 0h-2.07a5 5 0 0 1 9.8 0zM5.9 0A5.02 5.02 0 0 1 0 5.9V3.83A3 3 0 0 0 3.83 0H5.9zm294.2 0h2.07A3 3 0 0 0 304 3.83V5.9a5 5 0 0 1-3.9-5.9zm3.9 300.1v2.07a3 3 0 0 0-1.83 1.83h-2.07a5 5 0 0 1 3.9-3.9zM97 100a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-48 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 96a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-144a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-96 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm96 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-32 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM49 36a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-32 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM33 68a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 240a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm80-176a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm112 176a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM17 180a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM17 84a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6z'%3E%3C/path%3E%3C/svg%3E")}._container_5gc8u_1{display:flex;position:relative;width:100%;height:100%;overflow:hidden;justify-content:stretch}._primaryStyle_5gc8u_10{flex-grow:0;overflow:hidden}._resizable_5gc8u_15{touch-action:none;flex-shrink:0;z-index:1;-webkit-user-select:none;user-select:none}._resizable_5gc8u_15:before{content:"";width:100%;height:100%;display:block;background-color:#1b1b1b;z-index:10000}._resizable_5gc8u_15:hover:before{background-color:#23aaff}._resizable_5gc8u_15:active:before{background-color:#23aaff!important}._resizableInner_5gc8u_36{flex-grow:1;flex-shrink:1;overflow:hidden}._containerStyle_iy53z_1{display:flex;position:relative;width:10px;height:100%;overflow:hidden;justify-content:stretch}._primaryStyle_iy53z_10{flex-grow:0;overflow:hidden}._panelContainerStyle_iy53z_15{touch-action:none;flex-shrink:0;z-index:1;-webkit-user-select:none;user-select:none}._panelContainerStyle_iy53z_15:before{content:"";width:100%;height:100%;display:block;background-color:#1b1b1b;z-index:1}._panelContainerStyle_iy53z_15:hover:before{background-color:#23aaff}._panelContainerStyle_iy53z_15:active:before{background-color:#23aaff!important}._shrunkStyle_iy53z_36,._panelStyle_iy53z_43{flex-grow:1;flex-shrink:1;overflow:hidden;-webkit-user-select:none;user-select:none}._listName_1s0ny_1{color:red;font-size:40px}`)),document.head.appendChild(K)}}catch(_){console.error("vite-plugin-css-injected-by-js",_)}})();var lr=Object.defineProperty,cr=(K,_,Z)=>_ in K?lr(K,_,{enumerable:!0,configurable:!0,writable:!0,value:Z}):K[_]=Z,ue=(K,_,Z)=>cr(K,typeof _!="symbol"?_+"":_,Z);function _mergeNamespaces(K,_){for(var Z=0;Z<_.length;Z++){const te=_[Z];if(typeof te!="string"&&!Array.isArray(te)){for(const ne in te)if(ne!=="default"&&!(ne in K)){const ie=Object.getOwnPropertyDescriptor(te,ne);ie&&Object.defineProperty(K,ne,ie.get?ie:{enumerable:!0,get:()=>te[ne]})}}}return Object.freeze(Object.defineProperty(K,Symbol.toStringTag,{value:"Module"}))}const comp_list=Object.freeze(Object.defineProperty({__proto__:null,get AccumulativeShadows(){return AccumulativeShadows},get AdaptiveDpr(){return AdaptiveDpr},get AdaptiveEvents(){return AdaptiveEvents},get AmbientLight(){return AmbientLight},get AmbientLightStage(){return AmbientLightStage},get AnnotatedPivotControls(){return AnnotatedPivotControls},get Arrow(){return Arrow},get AsciiRenderer(){return AsciiRenderer},get AutoScroll(){return AutoScroll},get BBAnchor(){return BBAnchor},get BBox(){return BBox},get Backdrop(){return Backdrop},get BakeShadows(){return BakeShadows},get Billboard(){return Billboard},get Bounds(){return Bounds},get Box(){return Box},get Button(){return Button},get Bvh(){return Bvh},get Camera(){return Camera},get CameraShake(){return CameraShake},get CameraView(){return CameraView},get Capsule(){return Capsule},get CatmullRomLine(){return CatmullRomLine},get Caustics(){return Caustics},get Center(){return Center},get Circle(){return Circle},get Clone(){return Clone},get Cloud(){return Cloud},get ComputedAttribute(){return ComputedAttribute},get Cone(){return Cone},get ContactShadows(){return ContactShadows},get ContribLoader(){return ContribLoader},get CoordsMarker(){return CoordsMarker},get CubicBezierLine(){return CubicBezierLine},get CurveModifier(){return CurveModifier},get CycleRaycast(){return CycleRaycast},get Cylinder(){return Cylinder},get Dae(){return Dae},get Decal(){return Decal},get Detailed(){return Detailed},get DirectionalLight(){return DirectionalLight},get Div(){return Div},get Dodecahedron(){return Dodecahedron},get Edges(){return Edges},get Effects(){return Effects},get Environment(){return Environment},get Extrude(){return Extrude},get FaceLandmarker(){return FaceLandmarker},get Facemesh(){return Facemesh},get Fisheye(){return Fisheye},get Float(){return Float},get Frustum(){return Frustum},get Gamepad(){return Gamepad},get Glb(){return Glb},get Gltf(){return Glb},get GrabRender(){return GrabRender},get GradientTexture(){return GradientTexture},get Grid(){return Grid},get Gripper(){return Gripper},get HAND_MODEL_JOINT_KEYS(){return HAND_MODEL_JOINT_KEYS},get HUDPlane(){return HUDPlane},get Hands(){return Hands},get HandsView(){return HandsView},get HemisphereLight(){return HemisphereLight},get HemisphereLightStage(){return HemisphereLightStage},get Html(){return Html},get Hud(){return Hud},get Icosahedron(){return Icosahedron},get Image(){return Image$1},get ImageBackground(){return ImageBackground},get ImagePlane(){return ImagePlane},get ImageUpload(){return ImageUpload},get Img(){return Img},get Input(){return Input},get Instances(){return Instances},get Lathe(){return Lathe},get Lightformer(){return Lightformer},get Line(){return Line},get LumaSplats(){return LumaSplats},get MarchingCubes(){return MarchingCubes},get Markdown(){return Markdown},get Mask(){return Mask},get Merged(){return Merged},get MeshDiscardMaterial(){return MeshDiscardMaterial},get MeshDistortMaterial(){return MeshDistortMaterial},get MeshPortalMaterial(){return MeshPortalMaterial},get MeshReflectorMaterial(){return MeshReflectorMaterial},get MeshRefractionMaterial(){return MeshRefractionMaterial},get MeshTransmissionMaterial(){return MeshTransmissionMaterial},get MeshWobbleMaterial(){return MeshWobbleMaterial},get MotionControllers(){return MotionControllers},get Movable(){return Movable},get Obj(){return Obj},get Octahedron(){return Octahedron},get Outlines(){return Outlines},get Pcd(){return Pcd},get PerformanceMonitor(){return PerformanceMonitor},get Pivot(){return Pivot},get PivotXR(){return PivotXR},get Plane(){return Plane},get Playback(){return Playback},get PlaybackBar(){return PlaybackBar},get PlaybackContext(){return PlaybackContext},get PlaybackControls(){return PlaybackControls},get PlaybackProvider(){return PlaybackProvider},get PlaybackStateContext(){return PlaybackStateContext},get PlaybackStateProvider(){return PlaybackStateProvider},get Playhead(){return Playhead},get Ply(){return Ply},get PointCloud(){return PointCloud},get PointLight(){return PointLight},get PointMaterial(){return PointMaterial},get Pointer(){return Pointer},get PointerControls(){return PointerControls},get Points(){return Points},get Polyhedron(){return Polyhedron},get PositionalAudio(){return PositionalAudio},get Preload(){return Preload},get QuadraticBezierLine(){return QuadraticBezierLine},get RandomizedLight(){return RandomizedLight},get Range(){return Range},get RectAreaLight(){return RectAreaLight},get Render(){return Render},get RenderCubeTexture(){return RenderCubeTexture},get RenderLayer(){return RenderLayer},get RenderTexture(){return RenderTexture},get Resize(){return Resize},get Ring(){return Ring},get RoundedBox(){return RoundedBox},get Sampler(){return Sampler},get Scene(){return Scene},get SceneBackground(){return SceneBackground},get ScreenQuad(){return ScreenQuad},get ScreenSpace(){return ScreenSpace},get Segments(){return Segments},get Select(){return Select$2},get Shadow(){return Shadow},get Shape(){return Shape},get SkeletalGripper(){return SkeletalGripper},get Sky(){return Sky},get Slider(){return Slider},get SoftShadows(){return SoftShadows},get Span(){return Span},get SparkSplats(){return SparkSplats},get Sparkles(){return Sparkles},get Sphere(){return Sphere},get Splat(){return VuerSplat},get SpotLight(){return SpotLight},get SpotLightShadow(){return SpotLightShadow},get SpriteAnimator(){return SpriteAnimator},get Stage(){return Stage},get Stars(){return Stars},get StereoVideoPlane(){return StereoVideoPlane},get Stl(){return Stl},get Svg(){return Svg$1},get Tetrahedron(){return Tetrahedron},get Text(){return Text},get Text3D(){return Text3D},get Timeline(){return Timeline},get TimelineControls(){return TimelineControls},get TimelineFileDrop(){return TimelineFileDrop},get TimelineStateContext(){return TimelineStateContext},get TimelineStateProvider(){return TimelineStateProvider},get Timestamp(){return Timestamp},get Torus(){return Torus},get TorusKnot(){return TorusKnot},get Trail(){return Trail},get TriMesh(){return TriMesh},get Tube(){return Tube},get Urdf(){return Urdf},get VideoPlane(){return VideoPlane},get View(){return View},get VuerGroup(){return VuerGroup},get WebRTCStereoVideoPlane(){return WebRTCStereoVideoPlane},get WebRTCVideoPlane(){return WebRTCVideoPlane},get Wireframe(){return Wireframe},get XrMovableAnchor(){return XrMovableAnchor},get XrMovableLocal(){return XrMovableLocal},get XrMovableMimic(){return XrMovableMimic},get controllerState(){return controllerState},get getLandmark(){return getLandmark},get getState(){return getState},get handState(){return handState},get l2(){return l2},get list2menu(){return list2menu},get mat2Pos(){return mat2Pos},get resetGlobalLoader(){return resetGlobalLoader},get sentinel(){return sentinel},get transposeTuple(){return transposeTuple},get useMotionControllerState(){return useMotionControllerState},get usePlayback(){return usePlayback},get usePlaybackStates(){return usePlaybackStates},get useSourceState(){return useSourceState},get useTimelineStates(){return useTimelineStates}},Symbol.toStringTag,{value:"Module"})),token="%[a-f0-9]{2}",singleMatcher=new RegExp("("+token+")|([^%]+?)","gi"),multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(K,_){try{return[decodeURIComponent(K.join(""))]}catch{}if(K.length===1)return K;_=_||1;const Z=K.slice(0,_),te=K.slice(_);return Array.prototype.concat.call([],decodeComponents(Z),decodeComponents(te))}function decode$2(K){try{return decodeURIComponent(K)}catch{let _=K.match(singleMatcher)||[];for(let Z=1;Z<_.length;Z++)K=decodeComponents(_,Z).join(""),_=K.match(singleMatcher)||[];return K}}function customDecodeURIComponent(K){const _={"%FE%FF":"��","%FF%FE":"��"};let Z=multiMatcher.exec(K);for(;Z;){try{_[Z[0]]=decodeURIComponent(Z[0])}catch{const ne=decode$2(Z[0]);ne!==Z[0]&&(_[Z[0]]=ne)}Z=multiMatcher.exec(K)}_["%C2"]="�";const te=Object.keys(_);for(const ne of te)K=K.replace(new RegExp(ne,"g"),_[ne]);return K}function decodeUriComponent(K){if(typeof K!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof K+"`");try{return decodeURIComponent(K)}catch{return customDecodeURIComponent(K)}}function includeKeys(K,_){const Z={};if(Array.isArray(_))for(const te of _){const ne=Object.getOwnPropertyDescriptor(K,te);ne!=null&&ne.enumerable&&Object.defineProperty(Z,te,ne)}else for(const te of Reflect.ownKeys(K)){const ne=Object.getOwnPropertyDescriptor(K,te);if(ne.enumerable){const ie=K[te];_(te,ie,K)&&Object.defineProperty(Z,te,ne)}}return Z}function splitOnFirst(K,_){if(!(typeof K=="string"&&typeof _=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(K===""||_==="")return[];const Z=K.indexOf(_);return Z===-1?[]:[K.slice(0,Z),K.slice(Z+_.length)]}const isNullOrUndefined=K=>K==null,strictUriEncode=K=>encodeURIComponent(K).replaceAll(/[!'()*]/g,_=>`%${_.charCodeAt(0).toString(16).toUpperCase()}`),encodeFragmentIdentifier=Symbol("encodeFragmentIdentifier");function encoderForArrayFormat(K){switch(K.arrayFormat){case"index":return _=>(Z,te)=>{const ne=Z.length;return te===void 0||K.skipNull&&te===null||K.skipEmptyString&&te===""?Z:te===null?[...Z,[encode$1(_,K),"[",ne,"]"].join("")]:[...Z,[encode$1(_,K),"[",encode$1(ne,K),"]=",encode$1(te,K)].join("")]};case"bracket":return _=>(Z,te)=>te===void 0||K.skipNull&&te===null||K.skipEmptyString&&te===""?Z:te===null?[...Z,[encode$1(_,K),"[]"].join("")]:[...Z,[encode$1(_,K),"[]=",encode$1(te,K)].join("")];case"colon-list-separator":return _=>(Z,te)=>te===void 0||K.skipNull&&te===null||K.skipEmptyString&&te===""?Z:te===null?[...Z,[encode$1(_,K),":list="].join("")]:[...Z,[encode$1(_,K),":list=",encode$1(te,K)].join("")];case"comma":case"separator":case"bracket-separator":{const _=K.arrayFormat==="bracket-separator"?"[]=":"=";return Z=>(te,ne)=>ne===void 0||K.skipNull&&ne===null||K.skipEmptyString&&ne===""?te:(ne=ne===null?"":ne,te.length===0?[[encode$1(Z,K),_,encode$1(ne,K)].join("")]:[[te,encode$1(ne,K)].join(K.arrayFormatSeparator)])}default:return _=>(Z,te)=>te===void 0||K.skipNull&&te===null||K.skipEmptyString&&te===""?Z:te===null?[...Z,encode$1(_,K)]:[...Z,[encode$1(_,K),"=",encode$1(te,K)].join("")]}}function parserForArrayFormat(K){let _;switch(K.arrayFormat){case"index":return(Z,te,ne)=>{if(_=/\[(\d*)]$/.exec(Z),Z=Z.replace(/\[\d*]$/,""),!_){ne[Z]=te;return}ne[Z]===void 0&&(ne[Z]={}),ne[Z][_[1]]=te};case"bracket":return(Z,te,ne)=>{if(_=/(\[])$/.exec(Z),Z=Z.replace(/\[]$/,""),!_){ne[Z]=te;return}if(ne[Z]===void 0){ne[Z]=[te];return}ne[Z]=[...ne[Z],te]};case"colon-list-separator":return(Z,te,ne)=>{if(_=/(:list)$/.exec(Z),Z=Z.replace(/:list$/,""),!_){ne[Z]=te;return}if(ne[Z]===void 0){ne[Z]=[te];return}ne[Z]=[...ne[Z],te]};case"comma":case"separator":return(Z,te,ne)=>{const ie=typeof te=="string"&&te.includes(K.arrayFormatSeparator),oe=typeof te=="string"&&!ie&&decode$1(te,K).includes(K.arrayFormatSeparator);te=oe?decode$1(te,K):te;const se=ie||oe?te.split(K.arrayFormatSeparator).map(ae=>decode$1(ae,K)):te===null?te:decode$1(te,K);ne[Z]=se};case"bracket-separator":return(Z,te,ne)=>{const ie=/(\[])$/.test(Z);if(Z=Z.replace(/\[]$/,""),!ie){ne[Z]=te&&decode$1(te,K);return}const oe=te===null?[]:decode$1(te,K).split(K.arrayFormatSeparator);if(ne[Z]===void 0){ne[Z]=oe;return}ne[Z]=[...ne[Z],...oe]};default:return(Z,te,ne)=>{if(ne[Z]===void 0){ne[Z]=te;return}ne[Z]=[...[ne[Z]].flat(),te]}}}function validateArrayFormatSeparator(K){if(typeof K!="string"||K.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function encode$1(K,_){return _.encode?_.strict?strictUriEncode(K):encodeURIComponent(K):K}function decode$1(K,_){return _.decode?decodeUriComponent(K):K}function keysSorter(K){return Array.isArray(K)?K.sort():typeof K=="object"?keysSorter(Object.keys(K)).sort((_,Z)=>Number(_)-Number(Z)).map(_=>K[_]):K}function removeHash(K){const _=K.indexOf("#");return _!==-1&&(K=K.slice(0,_)),K}function getHash(K){let _="";const Z=K.indexOf("#");return Z!==-1&&(_=K.slice(Z)),_}function parseValue(K,_,Z){return Z==="string"&&typeof K=="string"?K:typeof Z=="function"&&typeof K=="string"?Z(K):Z==="boolean"&&K!==null&&(K.toLowerCase()==="true"||K.toLowerCase()==="false")?K.toLowerCase()==="true":Z==="boolean"&&K!==null&&(K.toLowerCase()==="1"||K.toLowerCase()==="0")?K.toLowerCase()==="1":Z==="string[]"&&_.arrayFormat!=="none"&&typeof K=="string"?[K]:Z==="number[]"&&_.arrayFormat!=="none"&&!Number.isNaN(Number(K))&&typeof K=="string"&&K.trim()!==""?[Number(K)]:Z==="number"&&!Number.isNaN(Number(K))&&typeof K=="string"&&K.trim()!==""?Number(K):_.parseBooleans&&K!==null&&(K.toLowerCase()==="true"||K.toLowerCase()==="false")?K.toLowerCase()==="true":_.parseNumbers&&!Number.isNaN(Number(K))&&typeof K=="string"&&K.trim()!==""?Number(K):K}function extract(K){K=removeHash(K);const _=K.indexOf("?");return _===-1?"":K.slice(_+1)}function parse$9(K,_){_={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),..._},validateArrayFormatSeparator(_.arrayFormatSeparator);const Z=parserForArrayFormat(_),te=Object.create(null);if(typeof K!="string"||(K=K.trim().replace(/^[?#&]/,""),!K))return te;for(const ne of K.split("&")){if(ne==="")continue;const ie=_.decode?ne.replaceAll("+"," "):ne;let[oe,se]=splitOnFirst(ie,"=");oe===void 0&&(oe=ie),se=se===void 0?null:["comma","separator","bracket-separator"].includes(_.arrayFormat)?se:decode$1(se,_),Z(decode$1(oe,_),se,te)}for(const[ne,ie]of Object.entries(te))if(typeof ie=="object"&&ie!==null&&_.types[ne]!=="string")for(const[oe,se]of Object.entries(ie)){const ae=_.types[ne]?_.types[ne].replace("[]",""):void 0;ie[oe]=parseValue(se,_,ae)}else typeof ie=="object"&&ie!==null&&_.types[ne]==="string"?te[ne]=Object.values(ie).join(_.arrayFormatSeparator):te[ne]=parseValue(ie,_,_.types[ne]);return _.sort===!1?te:(_.sort===!0?Object.keys(te).sort():Object.keys(te).sort(_.sort)).reduce((ne,ie)=>{const oe=te[ie];return ne[ie]=oe&&typeof oe=="object"&&!Array.isArray(oe)?keysSorter(oe):oe,ne},Object.create(null))}function stringify$6(K,_){if(!K)return"";_={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",..._},validateArrayFormatSeparator(_.arrayFormatSeparator);const Z=oe=>_.skipNull&&isNullOrUndefined(K[oe])||_.skipEmptyString&&K[oe]==="",te=encoderForArrayFormat(_),ne={};for(const[oe,se]of Object.entries(K))Z(oe)||(ne[oe]=se);const ie=Object.keys(ne);return _.sort!==!1&&ie.sort(_.sort),ie.map(oe=>{const se=K[oe];return se===void 0?"":se===null?encode$1(oe,_):Array.isArray(se)?se.length===0&&_.arrayFormat==="bracket-separator"?encode$1(oe,_)+"[]":se.reduce(te(oe),[]).join("&"):encode$1(oe,_)+"="+encode$1(se,_)}).filter(oe=>oe.length>0).join("&")}function parseUrl(K,_){var Z;_={decode:!0,..._};let[te,ne]=splitOnFirst(K,"#");return te===void 0&&(te=K),{url:((Z=te==null?void 0:te.split("?"))==null?void 0:Z[0])??"",query:parse$9(extract(K),_),..._&&_.parseFragmentIdentifier&&ne?{fragmentIdentifier:decode$1(ne,_)}:{}}}function stringifyUrl(K,_){_={encode:!0,strict:!0,[encodeFragmentIdentifier]:!0,..._};const Z=removeHash(K.url).split("?")[0]||"",te=extract(K.url),ne={...parse$9(te,{sort:!1,..._}),...K.query};let ie=stringify$6(ne,_);ie&&(ie=`?${ie}`);let oe=getHash(K.url);if(typeof K.fragmentIdentifier=="string"){const se=new URL(Z);se.hash=K.fragmentIdentifier,oe=_[encodeFragmentIdentifier]?se.hash:`#${K.fragmentIdentifier}`}return`${Z}${ie}${oe}`}function pick(K,_,Z){Z={parseFragmentIdentifier:!0,[encodeFragmentIdentifier]:!1,...Z};const{url:te,query:ne,fragmentIdentifier:ie}=parseUrl(K,Z);return stringifyUrl({url:te,query:includeKeys(ne,_),fragmentIdentifier:ie},Z)}function exclude(K,_,Z){const te=Array.isArray(_)?ne=>!_.includes(ne):(ne,ie)=>!_(ne,ie);return pick(K,te,Z)}const queryString=Object.freeze(Object.defineProperty({__proto__:null,exclude,extract,parse:parse$9,parseUrl,pick,stringify:stringify$6,stringifyUrl},Symbol.toStringTag,{value:"Module"}));var n,r=((n=function(){return r}).toString=n.toLocaleString=n[Symbol.toPrimitive]=function(){return""},n.valueOf=function(){return!1},new Proxy(Object.freeze(n),{get:function(K,_){return K.hasOwnProperty(_)?K[_]:r}}));const window$1=typeof globalThis.window<"u"?globalThis.window:r,document$4=typeof window$1.document<"u"?window$1.document:r;typeof window$1.navigator<"u"&&window$1.navigator;var decoder;try{decoder=new TextDecoder}catch{}var src,srcEnd,position$6=0,currentUnpackr={},currentStructures,srcString,srcStringStart=0,srcStringEnd=0,bundledStrings$1,referenceMap,currentExtensions=[],dataView,defaultOptions={useRecords:!1,mapsAsObjects:!0};class C1Type{}const C1=new C1Type;C1.name="MessagePack 0xC1";var sequentialMode=!1,inlineObjectReadThreshold=2,readStruct;try{new Function("")}catch{inlineObjectReadThreshold=1/0}class Unpackr{constructor(_){_&&(_.useRecords===!1&&_.mapsAsObjects===void 0&&(_.mapsAsObjects=!0),_.sequential&&_.trusted!==!1&&(_.trusted=!0,!_.structures&&_.useRecords!=!1&&(_.structures=[],_.maxSharedStructures||(_.maxSharedStructures=0))),_.structures?_.structures.sharedLength=_.structures.length:_.getStructures&&((_.structures=[]).uninitialized=!0,_.structures.sharedLength=0),_.int64AsNumber&&(_.int64AsType="number")),Object.assign(this,_)}unpack(_,Z){if(src)return saveState(()=>(clearSource(),this?this.unpack(_,Z):Unpackr.prototype.unpack.call(defaultOptions,_,Z)));!_.buffer&&_.constructor===ArrayBuffer&&(_=typeof Buffer<"u"?Buffer.from(_):new Uint8Array(_)),typeof Z=="object"?(srcEnd=Z.end||_.length,position$6=Z.start||0):(position$6=0,srcEnd=Z>-1?Z:_.length),srcStringEnd=0,srcString=null,bundledStrings$1=null,src=_;try{dataView=_.dataView||(_.dataView=new DataView(_.buffer,_.byteOffset,_.byteLength))}catch(te){throw src=null,_ instanceof Uint8Array?te:new Error("Source must be a Uint8Array or Buffer but was a "+(_&&typeof _=="object"?_.constructor.name:typeof _))}if(this instanceof Unpackr){if(currentUnpackr=this,this.structures)return currentStructures=this.structures,checkedRead();(!currentStructures||currentStructures.length>0)&&(currentStructures=[])}else currentUnpackr=defaultOptions,(!currentStructures||currentStructures.length>0)&&(currentStructures=[]);return checkedRead()}unpackMultiple(_,Z){let te,ne=0;try{sequentialMode=!0;let ie=_.length,oe=this?this.unpack(_,ie):defaultUnpackr.unpack(_,ie);if(Z){if(Z(oe,ne,position$6)===!1)return;for(;position$6<ie;)if(ne=position$6,Z(checkedRead(),ne,position$6)===!1)return}else{for(te=[oe];position$6<ie;)ne=position$6,te.push(checkedRead());return te}}catch(ie){throw ie.lastPosition=ne,ie.values=te,ie}finally{sequentialMode=!1,clearSource()}}_mergeStructures(_,Z){_=_||[],Object.isFrozen(_)&&(_=_.map(te=>te.slice(0)));for(let te=0,ne=_.length;te<ne;te++){let ie=_[te];ie&&(ie.isShared=!0,te>=32&&(ie.highByte=te-32>>5))}_.sharedLength=_.length;for(let te in Z||[])if(te>=0){let ne=_[te],ie=Z[te];ie&&(ne&&((_.restoreStructures||(_.restoreStructures=[]))[te]=ne),_[te]=ie)}return this.structures=_}decode(_,Z){return this.unpack(_,Z)}}function checkedRead(K){try{if(!currentUnpackr.trusted&&!sequentialMode){let Z=currentStructures.sharedLength||0;Z<currentStructures.length&&(currentStructures.length=Z)}let _;if(currentUnpackr.randomAccessStructure&&src[position$6]<64&&src[position$6]>=32&&readStruct||(_=read()),bundledStrings$1&&(position$6=bundledStrings$1.postBundlePosition,bundledStrings$1=null),sequentialMode&&(currentStructures.restoreStructures=null),position$6==srcEnd)currentStructures&&currentStructures.restoreStructures&&restoreStructures(),currentStructures=null,src=null,referenceMap&&(referenceMap=null);else{if(position$6>srcEnd)throw new Error("Unexpected end of MessagePack data");if(!sequentialMode){let Z;try{Z=JSON.stringify(_,(te,ne)=>typeof ne=="bigint"?`${ne}n`:ne).slice(0,100)}catch(te){Z="(JSON view not available "+te+")"}throw new Error("Data read, but end of buffer not reached "+Z)}}return _}catch(_){throw currentStructures&&currentStructures.restoreStructures&&restoreStructures(),clearSource(),(_ instanceof RangeError||_.message.startsWith("Unexpected end of buffer")||position$6>srcEnd)&&(_.incomplete=!0),_}}function restoreStructures(){for(let K in currentStructures.restoreStructures)currentStructures[K]=currentStructures.restoreStructures[K];currentStructures.restoreStructures=null}function read(){let K=src[position$6++];if(K<160)if(K<128){if(K<64)return K;{let _=currentStructures[K&63]||currentUnpackr.getStructures&&loadStructures()[K&63];return _?(_.read||(_.read=createStructureReader(_,K&63)),_.read()):K}}else if(K<144)if(K-=128,currentUnpackr.mapsAsObjects){let _={};for(let Z=0;Z<K;Z++){let te=readKey();te==="__proto__"&&(te="__proto_"),_[te]=read()}return _}else{let _=new Map;for(let Z=0;Z<K;Z++)_.set(read(),read());return _}else{K-=144;let _=new Array(K);for(let Z=0;Z<K;Z++)_[Z]=read();return currentUnpackr.freezeData?Object.freeze(_):_}else if(K<192){let _=K-160;if(srcStringEnd>=position$6)return srcString.slice(position$6-srcStringStart,(position$6+=_)-srcStringStart);if(srcStringEnd==0&&srcEnd<140){let Z=_<16?shortStringInJS(_):longStringInJS(_);if(Z!=null)return Z}return readFixedString(_)}else{let _;switch(K){case 192:return null;case 193:return bundledStrings$1?(_=read(),_>0?bundledStrings$1[1].slice(bundledStrings$1.position1,bundledStrings$1.position1+=_):bundledStrings$1[0].slice(bundledStrings$1.position0,bundledStrings$1.position0-=_)):C1;case 194:return!1;case 195:return!0;case 196:if(_=src[position$6++],_===void 0)throw new Error("Unexpected end of buffer");return readBin(_);case 197:return _=dataView.getUint16(position$6),position$6+=2,readBin(_);case 198:return _=dataView.getUint32(position$6),position$6+=4,readBin(_);case 199:return readExt(src[position$6++]);case 200:return _=dataView.getUint16(position$6),position$6+=2,readExt(_);case 201:return _=dataView.getUint32(position$6),position$6+=4,readExt(_);case 202:if(_=dataView.getFloat32(position$6),currentUnpackr.useFloat32>2){let Z=mult10[(src[position$6]&127)<<1|src[position$6+1]>>7];return position$6+=4,(Z*_+(_>0?.5:-.5)>>0)/Z}return position$6+=4,_;case 203:return _=dataView.getFloat64(position$6),position$6+=8,_;case 204:return src[position$6++];case 205:return _=dataView.getUint16(position$6),position$6+=2,_;case 206:return _=dataView.getUint32(position$6),position$6+=4,_;case 207:return currentUnpackr.int64AsType==="number"?(_=dataView.getUint32(position$6)*4294967296,_+=dataView.getUint32(position$6+4)):currentUnpackr.int64AsType==="string"?_=dataView.getBigUint64(position$6).toString():currentUnpackr.int64AsType==="auto"?(_=dataView.getBigUint64(position$6),_<=BigInt(2)<<BigInt(52)&&(_=Number(_))):_=dataView.getBigUint64(position$6),position$6+=8,_;case 208:return dataView.getInt8(position$6++);case 209:return _=dataView.getInt16(position$6),position$6+=2,_;case 210:return _=dataView.getInt32(position$6),position$6+=4,_;case 211:return currentUnpackr.int64AsType==="number"?(_=dataView.getInt32(position$6)*4294967296,_+=dataView.getUint32(position$6+4)):currentUnpackr.int64AsType==="string"?_=dataView.getBigInt64(position$6).toString():currentUnpackr.int64AsType==="auto"?(_=dataView.getBigInt64(position$6),_>=BigInt(-2)<<BigInt(52)&&_<=BigInt(2)<<BigInt(52)&&(_=Number(_))):_=dataView.getBigInt64(position$6),position$6+=8,_;case 212:if(_=src[position$6++],_==114)return recordDefinition(src[position$6++]&63);{let Z=currentExtensions[_];if(Z)return Z.read?(position$6++,Z.read(read())):Z.noBuffer?(position$6++,Z()):Z(src.subarray(position$6,++position$6));throw new Error("Unknown extension "+_)}case 213:return _=src[position$6],_==114?(position$6++,recordDefinition(src[position$6++]&63,src[position$6++])):readExt(2);case 214:return readExt(4);case 215:return readExt(8);case 216:return readExt(16);case 217:return _=src[position$6++],srcStringEnd>=position$6?srcString.slice(position$6-srcStringStart,(position$6+=_)-srcStringStart):readString8(_);case 218:return _=dataView.getUint16(position$6),position$6+=2,srcStringEnd>=position$6?srcString.slice(position$6-srcStringStart,(position$6+=_)-srcStringStart):readString16(_);case 219:return _=dataView.getUint32(position$6),position$6+=4,srcStringEnd>=position$6?srcString.slice(position$6-srcStringStart,(position$6+=_)-srcStringStart):readString32(_);case 220:return _=dataView.getUint16(position$6),position$6+=2,readArray(_);case 221:return _=dataView.getUint32(position$6),position$6+=4,readArray(_);case 222:return _=dataView.getUint16(position$6),position$6+=2,readMap(_);case 223:return _=dataView.getUint32(position$6),position$6+=4,readMap(_);default:if(K>=224)return K-256;if(K===void 0){let Z=new Error("Unexpected end of MessagePack data");throw Z.incomplete=!0,Z}throw new Error("Unknown MessagePack token "+K)}}}const validName=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function createStructureReader(K,_){function Z(){if(Z.count++>inlineObjectReadThreshold){let ne=K.read=new Function("r","return function(){return "+(currentUnpackr.freezeData?"Object.freeze":"")+"({"+K.map(ie=>ie==="__proto__"?"__proto_:r()":validName.test(ie)?ie+":r()":"["+JSON.stringify(ie)+"]:r()").join(",")+"})}")(read);return K.highByte===0&&(K.read=createSecondByteReader(_,K.read)),ne()}let te={};for(let ne=0,ie=K.length;ne<ie;ne++){let oe=K[ne];oe==="__proto__"&&(oe="__proto_"),te[oe]=read()}return currentUnpackr.freezeData?Object.freeze(te):te}return Z.count=0,K.highByte===0?createSecondByteReader(_,Z):Z}const createSecondByteReader=(K,_)=>function(){let Z=src[position$6++];if(Z===0)return _();let te=K<32?-(K+(Z<<5)):K+(Z<<5),ne=currentStructures[te]||loadStructures()[te];if(!ne)throw new Error("Record id is not defined for "+te);return ne.read||(ne.read=createStructureReader(ne,K)),ne.read()};function loadStructures(){let K=saveState(()=>(src=null,currentUnpackr.getStructures()));return currentStructures=currentUnpackr._mergeStructures(K,currentStructures)}var readFixedString=readStringJS,readString8=readStringJS,readString16=readStringJS,readString32=readStringJS;function readStringJS(K){let _;if(K<16&&(_=shortStringInJS(K)))return _;if(K>64&&decoder)return decoder.decode(src.subarray(position$6,position$6+=K));const Z=position$6+K,te=[];for(_="";position$6<Z;){const ne=src[position$6++];if(!(ne&128))te.push(ne);else if((ne&224)===192){const ie=src[position$6++]&63;te.push((ne&31)<<6|ie)}else if((ne&240)===224){const ie=src[position$6++]&63,oe=src[position$6++]&63;te.push((ne&31)<<12|ie<<6|oe)}else if((ne&248)===240){const ie=src[position$6++]&63,oe=src[position$6++]&63,se=src[position$6++]&63;let ae=(ne&7)<<18|ie<<12|oe<<6|se;ae>65535&&(ae-=65536,te.push(ae>>>10&1023|55296),ae=56320|ae&1023),te.push(ae)}else te.push(ne);te.length>=4096&&(_+=fromCharCode$5.apply(String,te),te.length=0)}return te.length>0&&(_+=fromCharCode$5.apply(String,te)),_}function readArray(K){let _=new Array(K);for(let Z=0;Z<K;Z++)_[Z]=read();return currentUnpackr.freezeData?Object.freeze(_):_}function readMap(K){if(currentUnpackr.mapsAsObjects){let _={};for(let Z=0;Z<K;Z++){let te=readKey();te==="__proto__"&&(te="__proto_"),_[te]=read()}return _}else{let _=new Map;for(let Z=0;Z<K;Z++)_.set(read(),read());return _}}var fromCharCode$5=String.fromCharCode;function longStringInJS(K){let _=position$6,Z=new Array(K);for(let te=0;te<K;te++){const ne=src[position$6++];if((ne&128)>0){position$6=_;return}Z[te]=ne}return fromCharCode$5.apply(String,Z)}function shortStringInJS(K){if(K<4)if(K<2){if(K===0)return"";{let _=src[position$6++];if((_&128)>1){position$6-=1;return}return fromCharCode$5(_)}}else{let _=src[position$6++],Z=src[position$6++];if((_&128)>0||(Z&128)>0){position$6-=2;return}if(K<3)return fromCharCode$5(_,Z);let te=src[position$6++];if((te&128)>0){position$6-=3;return}return fromCharCode$5(_,Z,te)}else{let _=src[position$6++],Z=src[position$6++],te=src[position$6++],ne=src[position$6++];if((_&128)>0||(Z&128)>0||(te&128)>0||(ne&128)>0){position$6-=4;return}if(K<6){if(K===4)return fromCharCode$5(_,Z,te,ne);{let ie=src[position$6++];if((ie&128)>0){position$6-=5;return}return fromCharCode$5(_,Z,te,ne,ie)}}else if(K<8){let ie=src[position$6++],oe=src[position$6++];if((ie&128)>0||(oe&128)>0){position$6-=6;return}if(K<7)return fromCharCode$5(_,Z,te,ne,ie,oe);let se=src[position$6++];if((se&128)>0){position$6-=7;return}return fromCharCode$5(_,Z,te,ne,ie,oe,se)}else{let ie=src[position$6++],oe=src[position$6++],se=src[position$6++],ae=src[position$6++];if((ie&128)>0||(oe&128)>0||(se&128)>0||(ae&128)>0){position$6-=8;return}if(K<10){if(K===8)return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae);{let le=src[position$6++];if((le&128)>0){position$6-=9;return}return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae,le)}}else if(K<12){let le=src[position$6++],ce=src[position$6++];if((le&128)>0||(ce&128)>0){position$6-=10;return}if(K<11)return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae,le,ce);let fe=src[position$6++];if((fe&128)>0){position$6-=11;return}return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae,le,ce,fe)}else{let le=src[position$6++],ce=src[position$6++],fe=src[position$6++],de=src[position$6++];if((le&128)>0||(ce&128)>0||(fe&128)>0||(de&128)>0){position$6-=12;return}if(K<14){if(K===12)return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de);{let pe=src[position$6++];if((pe&128)>0){position$6-=13;return}return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de,pe)}}else{let pe=src[position$6++],he=src[position$6++];if((pe&128)>0||(he&128)>0){position$6-=14;return}if(K<15)return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de,pe,he);let ge=src[position$6++];if((ge&128)>0){position$6-=15;return}return fromCharCode$5(_,Z,te,ne,ie,oe,se,ae,le,ce,fe,de,pe,he,ge)}}}}}function readOnlyJSString(){let K=src[position$6++],_;if(K<192)_=K-160;else switch(K){case 217:_=src[position$6++];break;case 218:_=dataView.getUint16(position$6),position$6+=2;break;case 219:_=dataView.getUint32(position$6),position$6+=4;break;default:throw new Error("Expected string")}return readStringJS(_)}function readBin(K){return currentUnpackr.copyBuffers?Uint8Array.prototype.slice.call(src,position$6,position$6+=K):src.subarray(position$6,position$6+=K)}function readExt(K){let _=src[position$6++];if(currentExtensions[_]){let Z;return currentExtensions[_](src.subarray(position$6,Z=position$6+=K),te=>{position$6=te;try{return read()}finally{position$6=Z}})}else throw new Error("Unknown extension type "+_)}var keyCache=new Array(4096);function readKey(){let K=src[position$6++];if(K>=160&&K<192){if(K=K-160,srcStringEnd>=position$6)return srcString.slice(position$6-srcStringStart,(position$6+=K)-srcStringStart);if(!(srcStringEnd==0&&srcEnd<180))return readFixedString(K)}else return position$6--,asSafeString(read());let _=(K<<5^(K>1?dataView.getUint16(position$6):K>0?src[position$6]:0))&4095,Z=keyCache[_],te=position$6,ne=position$6+K-3,ie,oe=0;if(Z&&Z.bytes==K){for(;te<ne;){if(ie=dataView.getUint32(te),ie!=Z[oe++]){te=1879048192;break}te+=4}for(ne+=3;te<ne;)if(ie=src[te++],ie!=Z[oe++]){te=1879048192;break}if(te===ne)return position$6=te,Z.string;ne-=3,te=position$6}for(Z=[],keyCache[_]=Z,Z.bytes=K;te<ne;)ie=dataView.getUint32(te),Z.push(ie),te+=4;for(ne+=3;te<ne;)ie=src[te++],Z.push(ie);let se=K<16?shortStringInJS(K):longStringInJS(K);return se!=null?Z.string=se:Z.string=readFixedString(K)}function asSafeString(K){if(typeof K=="string")return K;if(typeof K=="number"||typeof K=="boolean"||typeof K=="bigint")return K.toString();if(K==null)return K+"";if(currentUnpackr.allowArraysInMapKeys&&Array.isArray(K)&&K.flat().every(_=>["string","number","boolean","bigint"].includes(typeof _)))return K.flat().toString();throw new Error(`Invalid property type for record: ${typeof K}`)}const recordDefinition=(K,_)=>{let Z=read().map(asSafeString),te=K;_!==void 0&&(K=K<32?-((_<<5)+K):(_<<5)+K,Z.highByte=_);let ne=currentStructures[K];return ne&&(ne.isShared||sequentialMode)&&((currentStructures.restoreStructures||(currentStructures.restoreStructures=[]))[K]=ne),currentStructures[K]=Z,Z.read=createStructureReader(Z,te),Z.read()};currentExtensions[0]=()=>{};currentExtensions[0].noBuffer=!0;currentExtensions[66]=K=>{let _=K.length,Z=BigInt(K[0]&128?K[0]-256:K[0]);for(let te=1;te<_;te++)Z<<=BigInt(8),Z+=BigInt(K[te]);return Z};let errors={Error,TypeError,ReferenceError};currentExtensions[101]=()=>{let K=read();return(errors[K[0]]||Error)(K[1],{cause:K[2]})};currentExtensions[105]=K=>{if(currentUnpackr.structuredClone===!1)throw new Error("Structured clone extension is disabled");let _=dataView.getUint32(position$6-4);referenceMap||(referenceMap=new Map);let Z=src[position$6],te;Z>=144&&Z<160||Z==220||Z==221?te=[]:Z>=128&&Z<144||Z==222||Z==223?te=new Map:(Z>=199&&Z<=201||Z>=212&&Z<=216)&&src[position$6+1]===115?te=new Set:te={};let ne={target:te};referenceMap.set(_,ne);let ie=read();if(ne.used)Object.assign(te,ie);else return ne.target=ie;if(te instanceof Map)for(let[oe,se]of ie.entries())te.set(oe,se);if(te instanceof Set)for(let oe of Array.from(ie))te.add(oe);return te};currentExtensions[112]=K=>{if(currentUnpackr.structuredClone===!1)throw new Error("Structured clone extension is disabled");let _=dataView.getUint32(position$6-4),Z=referenceMap.get(_);return Z.used=!0,Z.target};currentExtensions[115]=()=>new Set(read());const typedArrays=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(K=>K+"Array");let glbl=typeof globalThis=="object"?globalThis:window;currentExtensions[116]=K=>{let _=K[0],Z=Uint8Array.prototype.slice.call(K,1).buffer,te=typedArrays[_];if(!te){if(_===16)return Z;if(_===17)return new DataView(Z);throw new Error("Could not find typed array for code "+_)}return new glbl[te](Z)};currentExtensions[120]=()=>{let K=read();return new RegExp(K[0],K[1])};const TEMP_BUNDLE=[];currentExtensions[98]=K=>{let _=(K[0]<<24)+(K[1]<<16)+(K[2]<<8)+K[3],Z=position$6;return position$6+=_-K.length,bundledStrings$1=TEMP_BUNDLE,bundledStrings$1=[readOnlyJSString(),readOnlyJSString()],bundledStrings$1.position0=0,bundledStrings$1.position1=0,bundledStrings$1.postBundlePosition=position$6,position$6=Z,read()};currentExtensions[255]=K=>K.length==4?new Date((K[0]*16777216+(K[1]<<16)+(K[2]<<8)+K[3])*1e3):K.length==8?new Date(((K[0]<<22)+(K[1]<<14)+(K[2]<<6)+(K[3]>>2))/1e6+((K[3]&3)*4294967296+K[4]*16777216+(K[5]<<16)+(K[6]<<8)+K[7])*1e3):K.length==12?new Date(((K[0]<<24)+(K[1]<<16)+(K[2]<<8)+K[3])/1e6+((K[4]&128?-281474976710656:0)+K[6]*1099511627776+K[7]*4294967296+K[8]*16777216+(K[9]<<16)+(K[10]<<8)+K[11])*1e3):new Date("invalid");function saveState(K){let _=srcEnd,Z=position$6,te=srcStringStart,ne=srcStringEnd,ie=srcString,oe=referenceMap,se=bundledStrings$1,ae=new Uint8Array(src.slice(0,srcEnd)),le=currentStructures,ce=currentStructures.slice(0,currentStructures.length),fe=currentUnpackr,de=sequentialMode,pe=K();return srcEnd=_,position$6=Z,srcStringStart=te,srcStringEnd=ne,srcString=ie,referenceMap=oe,bundledStrings$1=se,src=ae,sequentialMode=de,currentStructures=le,currentStructures.splice(0,currentStructures.length,...ce),currentUnpackr=fe,dataView=new DataView(src.buffer,src.byteOffset,src.byteLength),pe}function clearSource(){src=null,referenceMap=null,currentStructures=null}const mult10=new Array(147);for(let K=0;K<256;K++)mult10[K]=+("1e"+Math.floor(45.15-K*.30103));var defaultUnpackr=new Unpackr({useRecords:!1});const unpack=defaultUnpackr.unpack;defaultUnpackr.unpackMultiple;defaultUnpackr.unpack;let f32Array=new Float32Array(1);new Uint8Array(f32Array.buffer,0,4);let textEncoder;try{textEncoder=new TextEncoder}catch{}let extensions,extensionClasses;const hasNodeBuffer=typeof Buffer<"u",ByteArrayAllocate=hasNodeBuffer?function(K){return Buffer.allocUnsafeSlow(K)}:Uint8Array,ByteArray=hasNodeBuffer?Buffer:Uint8Array,MAX_BUFFER_SIZE=hasNodeBuffer?4294967296:2144337920;let target,keysTarget,targetView,position$5=0,safeEnd,bundledStrings=null,writeStructSlots;const MAX_BUNDLE_SIZE=21760,hasNonLatin=/[\u0080-\uFFFF]/,RECORD_SYMBOL=Symbol("record-id");class Packr extends Unpackr{constructor(_){super(_),this.offset=0;let Z,te,ne,ie,oe=ByteArray.prototype.utf8Write?function(ke,Ge){return target.utf8Write(ke,Ge,target.byteLength-Ge)}:textEncoder&&textEncoder.encodeInto?function(ke,Ge){return textEncoder.encodeInto(ke,target.subarray(Ge)).written}:!1,se=this;_||(_={});let ae=_&&_.sequential,le=_.structures||_.saveStructures,ce=_.maxSharedStructures;if(ce==null&&(ce=le?32:0),ce>8160)throw new Error("Maximum maxSharedStructure is 8160");_.structuredClone&&_.moreTypes==null&&(this.moreTypes=!0);let fe=_.maxOwnStructures;fe==null&&(fe=le?32:64),!this.structures&&_.useRecords!=!1&&(this.structures=[]);let de=ce>32||fe+ce>64,pe=ce+64,he=ce+fe+64;if(he>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let ge=[],me=0,Ae=0;this.pack=this.encode=function(ke,Ge){if(target||(target=new ByteArrayAllocate(8192),targetView=target.dataView||(target.dataView=new DataView(target.buffer,0,8192)),position$5=0),safeEnd=target.length-10,safeEnd-position$5<2048?(target=new ByteArrayAllocate(target.length),targetView=target.dataView||(target.dataView=new DataView(target.buffer,0,target.length)),safeEnd=target.length-10,position$5=0):position$5=position$5+7&2147483640,Z=position$5,Ge&RESERVE_START_SPACE&&(position$5+=Ge&255),ie=se.structuredClone?new Map:null,se.bundleStrings&&typeof ke!="string"?(bundledStrings=[],bundledStrings.size=1/0):bundledStrings=null,ne=se.structures,ne){ne.uninitialized&&(ne=se._mergeStructures(se.getStructures()));let ze=ne.sharedLength||0;if(ze>ce)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+ne.sharedLength);if(!ne.transitions){ne.transitions=Object.create(null);for(let Ke=0;Ke<ze;Ke++){let tt=ne[Ke];if(!tt)continue;let Je,ot=ne.transitions;for(let Fe=0,ct=tt.length;Fe<ct;Fe++){let ht=tt[Fe];Je=ot[ht],Je||(Je=ot[ht]=Object.create(null)),ot=Je}ot[RECORD_SYMBOL]=Ke+64}this.lastNamedStructuresLength=ze}ae||(ne.nextId=ze+64)}te&&(te=!1);let He;try{se.randomAccessStructure&&ke&&ke.constructor&&ke.constructor===Object?Ue(ke):_e(ke);let ze=bundledStrings;if(bundledStrings&&writeBundles(Z,_e,0),ie&&ie.idsToInsert){let Ke=ie.idsToInsert.sort((Fe,ct)=>Fe.offset>ct.offset?1:-1),tt=Ke.length,Je=-1;for(;ze&&tt>0;){let Fe=Ke[--tt].offset+Z;Fe<ze.stringsPosition+Z&&Je===-1&&(Je=0),Fe>ze.position+Z?Je>=0&&(Je+=6):(Je>=0&&(targetView.setUint32(ze.position+Z,targetView.getUint32(ze.position+Z)+Je),Je=-1),ze=ze.previous,tt++)}Je>=0&&ze&&targetView.setUint32(ze.position+Z,targetView.getUint32(ze.position+Z)+Je),position$5+=Ke.length*6,position$5>safeEnd&&Pe(position$5),se.offset=position$5;let ot=insertIds(target.subarray(Z,position$5),Ke);return ie=null,ot}return se.offset=position$5,Ge&REUSE_BUFFER_MODE?(target.start=Z,target.end=position$5,target):target.subarray(Z,position$5)}catch(ze){throw He=ze,ze}finally{if(ne&&(ye(),te&&se.saveStructures)){let ze=ne.sharedLength||0,Ke=target.subarray(Z,position$5),tt=prepareStructures(ne,se);if(!He)return se.saveStructures(tt,tt.isCompatible)===!1?se.pack(ke,Ge):(se.lastNamedStructuresLength=ze,target.length>1073741824&&(target=null),Ke)}target.length>1073741824&&(target=null),Ge&RESET_BUFFER_MODE&&(position$5=Z)}};const ye=()=>{Ae<10&&Ae++;let ke=ne.sharedLength||0;if(ne.length>ke&&!ae&&(ne.length=ke),me>1e4)ne.transitions=null,Ae=0,me=0,ge.length>0&&(ge=[]);else if(ge.length>0&&!ae){for(let Ge=0,He=ge.length;Ge<He;Ge++)ge[Ge][RECORD_SYMBOL]=0;ge=[]}},ve=ke=>{var Ge=ke.length;Ge<16?target[position$5++]=144|Ge:Ge<65536?(target[position$5++]=220,target[position$5++]=Ge>>8,target[position$5++]=Ge&255):(target[position$5++]=221,targetView.setUint32(position$5,Ge),position$5+=4);for(let He=0;He<Ge;He++)_e(ke[He])},_e=ke=>{position$5>safeEnd&&(target=Pe(position$5));var Ge=typeof ke,He;if(Ge==="string"){let ze=ke.length;if(bundledStrings&&ze>=4&&ze<4096){if((bundledStrings.size+=ze)>MAX_BUNDLE_SIZE){let ot,Fe=(bundledStrings[0]?bundledStrings[0].length*3+bundledStrings[1].length:0)+10;position$5+Fe>safeEnd&&(target=Pe(position$5+Fe));let ct;bundledStrings.position?(ct=bundledStrings,target[position$5]=200,position$5+=3,target[position$5++]=98,ot=position$5-Z,position$5+=4,writeBundles(Z,_e,0),targetView.setUint16(ot+Z-3,position$5-Z-ot)):(target[position$5++]=214,target[position$5++]=98,ot=position$5-Z,position$5+=4),bundledStrings=["",""],bundledStrings.previous=ct,bundledStrings.size=0,bundledStrings.position=ot}let Je=hasNonLatin.test(ke);bundledStrings[Je?0:1]+=ke,target[position$5++]=193,_e(Je?-ze:ze);return}let Ke;ze<32?Ke=1:ze<256?Ke=2:ze<65536?Ke=3:Ke=5;let tt=ze*3;if(position$5+tt>safeEnd&&(target=Pe(position$5+tt)),ze<64||!oe){let Je,ot,Fe,ct=position$5+Ke;for(Je=0;Je<ze;Je++)ot=ke.charCodeAt(Je),ot<128?target[ct++]=ot:ot<2048?(target[ct++]=ot>>6|192,target[ct++]=ot&63|128):(ot&64512)===55296&&((Fe=ke.charCodeAt(Je+1))&64512)===56320?(ot=65536+((ot&1023)<<10)+(Fe&1023),Je++,target[ct++]=ot>>18|240,target[ct++]=ot>>12&63|128,target[ct++]=ot>>6&63|128,target[ct++]=ot&63|128):(target[ct++]=ot>>12|224,target[ct++]=ot>>6&63|128,target[ct++]=ot&63|128);He=ct-position$5-Ke}else He=oe(ke,position$5+Ke);He<32?target[position$5++]=160|He:He<256?(Ke<2&&target.copyWithin(position$5+2,position$5+1,position$5+1+He),target[position$5++]=217,target[position$5++]=He):He<65536?(Ke<3&&target.copyWithin(position$5+3,position$5+2,position$5+2+He),target[position$5++]=218,target[position$5++]=He>>8,target[position$5++]=He&255):(Ke<5&&target.copyWithin(position$5+5,position$5+3,position$5+3+He),target[position$5++]=219,targetView.setUint32(position$5,He),position$5+=4),position$5+=He}else if(Ge==="number")if(ke>>>0===ke)ke<32||ke<128&&this.useRecords===!1||ke<64&&!this.randomAccessStructure?target[position$5++]=ke:ke<256?(target[position$5++]=204,target[position$5++]=ke):ke<65536?(target[position$5++]=205,target[position$5++]=ke>>8,target[position$5++]=ke&255):(target[position$5++]=206,targetView.setUint32(position$5,ke),position$5+=4);else if(ke>>0===ke)ke>=-32?target[position$5++]=256+ke:ke>=-128?(target[position$5++]=208,target[position$5++]=ke+256):ke>=-32768?(target[position$5++]=209,targetView.setInt16(position$5,ke),position$5+=2):(target[position$5++]=210,targetView.setInt32(position$5,ke),position$5+=4);else{let ze;if((ze=this.useFloat32)>0&&ke<4294967296&&ke>=-2147483648){target[position$5++]=202,targetView.setFloat32(position$5,ke);let Ke;if(ze<4||(Ke=ke*mult10[(target[position$5]&127)<<1|target[position$5+1]>>7])>>0===Ke){position$5+=4;return}else position$5--}target[position$5++]=203,targetView.setFloat64(position$5,ke),position$5+=8}else if(Ge==="object"||Ge==="function")if(!ke)target[position$5++]=192;else{if(ie){let Ke=ie.get(ke);if(Ke){if(!Ke.id){let tt=ie.idsToInsert||(ie.idsToInsert=[]);Ke.id=tt.push(Ke)}target[position$5++]=214,target[position$5++]=112,targetView.setUint32(position$5,Ke.id),position$5+=4;return}else ie.set(ke,{offset:position$5-Z})}let ze=ke.constructor;if(ze===Object)we(ke);else if(ze===Array)ve(ke);else if(ze===Map)if(this.mapAsEmptyObject)target[position$5++]=128;else{He=ke.size,He<16?target[position$5++]=128|He:He<65536?(target[position$5++]=222,target[position$5++]=He>>8,target[position$5++]=He&255):(target[position$5++]=223,targetView.setUint32(position$5,He),position$5+=4);for(let[Ke,tt]of ke)_e(Ke),_e(tt)}else{for(let Ke=0,tt=extensions.length;Ke<tt;Ke++){let Je=extensionClasses[Ke];if(ke instanceof Je){let ot=extensions[Ke];if(ot.write){ot.type&&(target[position$5++]=212,target[position$5++]=ot.type,target[position$5++]=0);let Qe=ot.write.call(this,ke);Qe===ke?Array.isArray(ke)?ve(ke):we(ke):_e(Qe);return}let Fe=target,ct=targetView,ht=position$5;target=null;let lt;try{lt=ot.pack.call(this,ke,Qe=>(target=Fe,Fe=null,position$5+=Qe,position$5>safeEnd&&Pe(position$5),{target,targetView,position:position$5-Qe}),_e)}finally{Fe&&(target=Fe,targetView=ct,position$5=ht,safeEnd=target.length-10)}lt&&(lt.length+position$5>safeEnd&&Pe(lt.length+position$5),position$5=writeExtensionData(lt,target,position$5,ot.type));return}}if(Array.isArray(ke))ve(ke);else{if(ke.toJSON){const Ke=ke.toJSON();if(Ke!==ke)return _e(Ke)}if(Ge==="function")return _e(this.writeFunction&&this.writeFunction(ke));we(ke)}}}else if(Ge==="boolean")target[position$5++]=ke?195:194;else if(Ge==="bigint"){if(ke<9223372036854776e3&&ke>=-9223372036854776e3)target[position$5++]=211,targetView.setBigInt64(position$5,ke);else if(ke<18446744073709552e3&&ke>0)target[position$5++]=207,targetView.setBigUint64(position$5,ke);else if(this.largeBigIntToFloat)target[position$5++]=203,targetView.setFloat64(position$5,Number(ke));else{if(this.largeBigIntToString)return _e(ke.toString());if((this.useBigIntExtension||this.moreTypes)&&ke<BigInt(2)**BigInt(1023)&&ke>-(BigInt(2)**BigInt(1023))){target[position$5++]=199,position$5++,target[position$5++]=66;let ze=[],Ke;do{let tt=ke&BigInt(255);Ke=(tt&BigInt(128))===(ke<BigInt(0)?BigInt(128):BigInt(0)),ze.push(tt),ke>>=BigInt(8)}while(!((ke===BigInt(0)||ke===BigInt(-1))&&Ke));target[position$5-2]=ze.length;for(let tt=ze.length;tt>0;)target[position$5++]=Number(ze[--tt]);return}else throw new RangeError(ke+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}position$5+=8}else if(Ge==="undefined")this.encodeUndefinedAsNil?target[position$5++]=192:(target[position$5++]=212,target[position$5++]=0,target[position$5++]=0);else throw new Error("Unknown type: "+Ge)},Te=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?ke=>{let Ge;if(this.skipValues){Ge=[];for(let Ke in ke)(typeof ke.hasOwnProperty!="function"||ke.hasOwnProperty(Ke))&&!this.skipValues.includes(ke[Ke])&&Ge.push(Ke)}else Ge=Object.keys(ke);let He=Ge.length;He<16?target[position$5++]=128|He:He<65536?(target[position$5++]=222,target[position$5++]=He>>8,target[position$5++]=He&255):(target[position$5++]=223,targetView.setUint32(position$5,He),position$5+=4);let ze;if(this.coercibleKeyAsNumber)for(let Ke=0;Ke<He;Ke++){ze=Ge[Ke];let tt=Number(ze);_e(isNaN(tt)?ze:tt),_e(ke[ze])}else for(let Ke=0;Ke<He;Ke++)_e(ze=Ge[Ke]),_e(ke[ze])}:ke=>{target[position$5++]=222;let Ge=position$5-Z;position$5+=2;let He=0;for(let ze in ke)(typeof ke.hasOwnProperty!="function"||ke.hasOwnProperty(ze))&&(_e(ze),_e(ke[ze]),He++);if(He>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');target[Ge+++Z]=He>>8,target[Ge+Z]=He&255},be=this.useRecords===!1?Te:_.progressiveRecords&&!de?ke=>{let Ge,He=ne.transitions||(ne.transitions=Object.create(null)),ze=position$5++-Z,Ke;for(let tt in ke)if(typeof ke.hasOwnProperty!="function"||ke.hasOwnProperty(tt)){if(Ge=He[tt],Ge)He=Ge;else{let Je=Object.keys(ke),ot=He;He=ne.transitions;let Fe=0;for(let ct=0,ht=Je.length;ct<ht;ct++){let lt=Je[ct];Ge=He[lt],Ge||(Ge=He[lt]=Object.create(null),Fe++),He=Ge}ze+Z+1==position$5?(position$5--,Ie(He,Je,Fe)):$e(He,Je,ze,Fe),Ke=!0,He=ot[tt]}_e(ke[tt])}if(!Ke){let tt=He[RECORD_SYMBOL];tt?target[ze+Z]=tt:$e(He,Object.keys(ke),ze,0)}}:ke=>{let Ge,He=ne.transitions||(ne.transitions=Object.create(null)),ze=0;for(let tt in ke)(typeof ke.hasOwnProperty!="function"||ke.hasOwnProperty(tt))&&(Ge=He[tt],Ge||(Ge=He[tt]=Object.create(null),ze++),He=Ge);let Ke=He[RECORD_SYMBOL];Ke?Ke>=96&&de?(target[position$5++]=((Ke-=96)&31)+96,target[position$5++]=Ke>>5):target[position$5++]=Ke:Ie(He,He.__keys__||Object.keys(ke),ze);for(let tt in ke)(typeof ke.hasOwnProperty!="function"||ke.hasOwnProperty(tt))&&_e(ke[tt])},Re=typeof this.useRecords=="function"&&this.useRecords,we=Re?ke=>{Re(ke)?be(ke):Te(ke)}:be,Pe=ke=>{let Ge;if(ke>16777216){if(ke-Z>MAX_BUFFER_SIZE)throw new Error("Packed buffer would be larger than maximum buffer size");Ge=Math.min(MAX_BUFFER_SIZE,Math.round(Math.max((ke-Z)*(ke>67108864?1.25:2),4194304)/4096)*4096)}else Ge=(Math.max(ke-Z<<2,target.length-1)>>12)+1<<12;let He=new ByteArrayAllocate(Ge);return targetView=He.dataView||(He.dataView=new DataView(He.buffer,0,Ge)),ke=Math.min(ke,target.length),target.copy?target.copy(He,0,Z,ke):He.set(target.slice(Z,ke)),position$5-=Z,Z=0,safeEnd=He.length-10,target=He},Ie=(ke,Ge,He)=>{let ze=ne.nextId;ze||(ze=64),ze<pe&&this.shouldShareStructure&&!this.shouldShareStructure(Ge)?(ze=ne.nextOwnId,ze<he||(ze=pe),ne.nextOwnId=ze+1):(ze>=he&&(ze=pe),ne.nextId=ze+1);let Ke=Ge.highByte=ze>=96&&de?ze-96>>5:-1;ke[RECORD_SYMBOL]=ze,ke.__keys__=Ge,ne[ze-64]=Ge,ze<pe?(Ge.isShared=!0,ne.sharedLength=ze-63,te=!0,Ke>=0?(target[position$5++]=(ze&31)+96,target[position$5++]=Ke):target[position$5++]=ze):(Ke>=0?(target[position$5++]=213,target[position$5++]=114,target[position$5++]=(ze&31)+96,target[position$5++]=Ke):(target[position$5++]=212,target[position$5++]=114,target[position$5++]=ze),He&&(me+=Ae*He),ge.length>=fe&&(ge.shift()[RECORD_SYMBOL]=0),ge.push(ke),_e(Ge))},$e=(ke,Ge,He,ze)=>{let Ke=target,tt=position$5,Je=safeEnd,ot=Z;target=keysTarget,position$5=0,Z=0,target||(keysTarget=target=new ByteArrayAllocate(8192)),safeEnd=target.length-10,Ie(ke,Ge,ze),keysTarget=target;let Fe=position$5;if(target=Ke,position$5=tt,safeEnd=Je,Z=ot,Fe>1){let ct=position$5+Fe-1;ct>safeEnd&&Pe(ct);let ht=He+Z;target.copyWithin(ht+Fe,ht+1,position$5),target.set(keysTarget.slice(0,Fe),ht),position$5=ct}else target[He+Z]=keysTarget[0]},Ue=ke=>{let Ge=writeStructSlots(ke,target,Z,position$5,ne,Pe,(He,ze,Ke)=>{if(Ke)return te=!0;position$5=ze;let tt=target;return _e(He),ye(),tt!==target?{position:position$5,targetView,target}:position$5},this);if(Ge===0)return we(ke);position$5=Ge}}useBuffer(_){target=_,target.dataView||(target.dataView=new DataView(target.buffer,target.byteOffset,target.byteLength)),position$5=0}set position(_){position$5=_}get position(){return position$5}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}extensionClasses=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,C1Type];extensions=[{pack(K,_,Z){let te=K.getTime()/1e3;if((this.useTimestamp32||K.getMilliseconds()===0)&&te>=0&&te<4294967296){let{target:ne,targetView:ie,position:oe}=_(6);ne[oe++]=214,ne[oe++]=255,ie.setUint32(oe,te)}else if(te>0&&te<4294967296){let{target:ne,targetView:ie,position:oe}=_(10);ne[oe++]=215,ne[oe++]=255,ie.setUint32(oe,K.getMilliseconds()*4e6+(te/1e3/4294967296>>0)),ie.setUint32(oe+4,te)}else if(isNaN(te)){if(this.onInvalidDate)return _(0),Z(this.onInvalidDate());let{target:ne,targetView:ie,position:oe}=_(3);ne[oe++]=212,ne[oe++]=255,ne[oe++]=255}else{let{target:ne,targetView:ie,position:oe}=_(15);ne[oe++]=199,ne[oe++]=12,ne[oe++]=255,ie.setUint32(oe,K.getMilliseconds()*1e6),ie.setBigInt64(oe+4,BigInt(Math.floor(te)))}}},{pack(K,_,Z){if(this.setAsEmptyObject)return _(0),Z({});let te=Array.from(K),{target:ne,position:ie}=_(this.moreTypes?3:0);this.moreTypes&&(ne[ie++]=212,ne[ie++]=115,ne[ie++]=0),Z(te)}},{pack(K,_,Z){let{target:te,position:ne}=_(this.moreTypes?3:0);this.moreTypes&&(te[ne++]=212,te[ne++]=101,te[ne++]=0),Z([K.name,K.message,K.cause])}},{pack(K,_,Z){let{target:te,position:ne}=_(this.moreTypes?3:0);this.moreTypes&&(te[ne++]=212,te[ne++]=120,te[ne++]=0),Z([K.source,K.flags])}},{pack(K,_){this.moreTypes?writeExtBuffer(K,16,_):writeBuffer(hasNodeBuffer?Buffer.from(K):new Uint8Array(K),_)}},{pack(K,_){let Z=K.constructor;Z!==ByteArray&&this.moreTypes?writeExtBuffer(K,typedArrays.indexOf(Z.name),_):writeBuffer(K,_)}},{pack(K,_){this.moreTypes?writeExtBuffer(K,17,_):writeBuffer(hasNodeBuffer?Buffer.from(K):new Uint8Array(K),_)}},{pack(K,_){let{target:Z,position:te}=_(1);Z[te]=193}}];function writeExtBuffer(K,_,Z,te){let ne=K.byteLength;if(ne+1<256){var{target:ie,position:oe}=Z(4+ne);ie[oe++]=199,ie[oe++]=ne+1}else if(ne+1<65536){var{target:ie,position:oe}=Z(5+ne);ie[oe++]=200,ie[oe++]=ne+1>>8,ie[oe++]=ne+1&255}else{var{target:ie,position:oe,targetView:se}=Z(7+ne);ie[oe++]=201,se.setUint32(oe,ne+1),oe+=4}ie[oe++]=116,ie[oe++]=_,K.buffer||(K=new Uint8Array(K)),ie.set(new Uint8Array(K.buffer,K.byteOffset,K.byteLength),oe)}function writeBuffer(K,_){let Z=K.byteLength;var te,ne;if(Z<256){var{target:te,position:ne}=_(Z+2);te[ne++]=196,te[ne++]=Z}else if(Z<65536){var{target:te,position:ne}=_(Z+3);te[ne++]=197,te[ne++]=Z>>8,te[ne++]=Z&255}else{var{target:te,position:ne,targetView:ie}=_(Z+5);te[ne++]=198,ie.setUint32(ne,Z),ne+=4}te.set(K,ne)}function writeExtensionData(K,_,Z,te){let ne=K.length;switch(ne){case 1:_[Z++]=212;break;case 2:_[Z++]=213;break;case 4:_[Z++]=214;break;case 8:_[Z++]=215;break;case 16:_[Z++]=216;break;default:ne<256?(_[Z++]=199,_[Z++]=ne):ne<65536?(_[Z++]=200,_[Z++]=ne>>8,_[Z++]=ne&255):(_[Z++]=201,_[Z++]=ne>>24,_[Z++]=ne>>16&255,_[Z++]=ne>>8&255,_[Z++]=ne&255)}return _[Z++]=te,_.set(K,Z),Z+=ne,Z}function insertIds(K,_){let Z,te=_.length*6,ne=K.length-te;for(;Z=_.pop();){let ie=Z.offset,oe=Z.id;K.copyWithin(ie+te,ie,ne),te-=6;let se=ie+te;K[se++]=214,K[se++]=105,K[se++]=oe>>24,K[se++]=oe>>16&255,K[se++]=oe>>8&255,K[se++]=oe&255,ne=ie}return K}function writeBundles(K,_,Z){if(bundledStrings.length>0){targetView.setUint32(bundledStrings.position+K,position$5+Z-bundledStrings.position-K),bundledStrings.stringsPosition=position$5-K;let te=bundledStrings;bundledStrings=null,_(te[0]),_(te[1])}}function prepareStructures(K,_){return K.isCompatible=Z=>{let te=!Z||(_.lastNamedStructuresLength||0)===Z.length;return te||_._mergeStructures(Z),te},K}let defaultPackr=new Packr({useRecords:!1});const pack=defaultPackr.pack;defaultPackr.pack;const REUSE_BUFFER_MODE=512,RESET_BUFFER_MODE=1024,RESERVE_START_SPACE=2048,uuidPattern=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function valid$3(K){return uuidPattern.test(K)}function uuid4(){var K=URL.createObjectURL(new Blob),_=K.toString();return URL.revokeObjectURL(K),_.split(/[:\/]/g).pop().toLowerCase()}uuid4.valid=valid$3;class Store{constructor(){ue(this,"reducers"),ue(this,"subscribers"),this.reducers={},this.subscribers={}}addReducer(_,Z,te){const ne=te||uuid4();return this.reducers[_]||(this.reducers[_]={}),this.reducers[_][ne]=Z,()=>{delete this.reducers[_][ne]}}subscribe(_,Z,te){const ne=te||uuid4();return this.subscribers[_]||(this.subscribers[_]={}),this.subscribers[_][ne]=Z,()=>{delete this.subscribers[_][ne]}}publish(_){if(!_)return;const Z=_.etype,te=this.reducers[Z]||{};for(const oe in te){const se=this.reducers[Z][oe];_=se(_)}const ne=this.subscribers[Z]||{};for(const oe in ne){const se=this.subscribers[Z][oe];setTimeout(()=>{se(_)},0)}const ie=this.subscribers["*"]||{};for(const oe in ie){const se=ie[oe];setTimeout(()=>{se(_)},0)}return _}}function useStateRef(K){const[_,Z]=reactExports.useState(K),te=reactExports.useRef(_);return[_,ne=>{const ie=ne instanceof Function?ne(te.current):ne;te.current=ie,Z(ie)},te]}const useWebSocket=index$2,SocketContext=reactExports.createContext(void 0),useSocket=()=>{const K=reactExports.useContext(SocketContext);if(K===void 0)throw new Error("useSocket must be used within a SocketProvider");return K},DEFAULT_PORT=8012;function getSocketURI(K){return K||(window.location.hostname=="vuer.ai"?`ws://localhost:${DEFAULT_PORT}`:window.location.protocol=="https:"?`wss://${window.location.hostname}`:`ws://${window.location.hostname}:${window.location.port||DEFAULT_PORT}`)}function WebSocketProvider({onMessage:K,children:_}){const[Z,te]=useStateRef(!1),[ne,ie]=reactExports.useState(!0),[oe,se]=reactExports.useState(!0),[,,ae]=useStateRef(!0),le=reactExports.useMemo(()=>queryString.parse(document$4.location.search),[]),ce=reactExports.useMemo(()=>new Store,[]),fe=reactExports.useMemo(()=>new Store,[]),{socketURI:de}=useControls("Connection",{socketURI:{value:getSocketURI(le.ws),order:0,label:"Socket URI"},reconnect:button(()=>{ie(!1),se(!1),setTimeout(()=>{ie(!0)},100)},{disabled:!oe,label:Z?"Reconnect":"Disconnected",order:-10})},[]),pe=reactExports.useCallback(({data:Re})=>{Re!=null&&Re.arrayBuffer&&Re.arrayBuffer().then(we=>{const Pe=unpack(we);typeof K=="function"&&K(Pe),fe.publish(Pe)})},[de]);function he(){Te({etype:"INIT"}),te(!0),se(!0)}function ge(){te(!1),se(!1)}function me(){te(!1),se(!1)}function Ae(){se(!0)}const ye=reactExports.useMemo(()=>({onOpen:he,onError:me,onClose:ge,onMessage:pe,onReconnectStop:Ae,share:!0,retryOnError:!0,shouldReconnect(){return ae.current},reconnectAttempts:le.reconnect?parseInt(le.reconnect):3,reconnectInterval:le.interval?parseInt(le.interval):3e3}),[le.reconnect,le.interval,ae.current]),{sendMessage:ve,readyState:_e}=useWebSocket(de,ye,!!de&&ne),Te=reactExports.useCallback(Re=>{if(!_e)return;const we=pack(Re);Re&&ve(we)},[_e]),be=reactExports.useMemo(()=>({sendMsg:Te,uplink:ce,downlink:fe}),[_e]);return reactExports.useEffect(()=>ce.subscribe("*",Te),[Te,ce]),jsxRuntimeExports.jsx(SocketContext.Provider,{value:be,children:_})}const identity$3=K=>K;function parseArray(K,_=identity$3){if(K)return K.split(",").map(parseFloat).map(_)}const CAMERA_TYPES={PerspectiveCamera:PerspectiveCamera$1,OrthographicCamera,CubeCamera};function Camera({_ref:K,animate:_,type:Z="PerspectiveCamera",label:te,near:ne=.1,far:ie=.2,fov:oe=75,position:se,rotation:ae,matrix:le,makeDefault:ce=!1,helper:fe=!1,...de}){const pe=reactExports.useRef(null);useHelper(fe?pe:null,CameraHelper);const he=reactExports.useMemo(()=>new Vector3(0,0,0),[]),ge=reactExports.useMemo(()=>({matrix:new Matrix4,position:new Vector3(0,0,0),rotation:new Euler(0,0,0),quaternion:new Quaternion(0,0,0,0),scale:new Vector3(0,0,0)}),[]);reactExports.useEffect(()=>{if(pe.current&&le){const Ae=pe.current;ge.matrix.fromArray(le),ge.matrix.decompose(Ae.position,ge.quaternion,Ae.scale),Ae.rotation.setFromQuaternion(ge.quaternion),Ae.updateMatrixWorld(!0),Ae.updateWorldMatrix(!0,!0),invalidate()}},[pe.current,le]),reactExports.useEffect(()=>{if(!pe.current)return;const Ae=pe.current;Ae.near=ne,Ae.far=ie,Ae.fov=oe},[pe.current,oe,ne,ie]),useFrame(Ae=>{_&&pe.current&&(typeof _=="function"?(_(pe.current,Ae),pe.current.lookAt(he)):console.log("animated camera motion is not implemented yet"))});const me=CAMERA_TYPES[Z];return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(me,{ref:pe,position:se||void 0,rotation:ae||void 0,makeDefault:ce,...de}),te&&te.length?jsxRuntimeExports.jsxs(Html,{wrapperClass:"label",as:"span",style:{display:"inline-block",borderRadius:"0.25rem",padding:"0.25rem 0.5rem 0.25rem 0.5rem ",background:"white",color:"black",width:"max-content",maxWidth:"200px",height:"fit-content"},children:[" ",te," "]}):null]})}function zoomToFov(K,_,Z){const te=Z/K;return 360/Math.PI*Math.atan(te/(2*_))}function fovToZoom(K,_,Z){const te=2*_*Math.tan(K/360*Math.PI);return Z/te}function MyKeyboardControls({parent:K,controls:_,panSpeed:Z=.016,viewHeight:te}){return reactExports.useLayoutEffect(()=>{if(!_)return;const ne=function(){const oe=new Vector3;return function(se){let ae=!1;const le=_.object,ce=Z*te,fe=Math.max(ce,.001),de=se.shiftKey?fe*10:fe;se.code==="KeyW"&&(oe.setFromMatrixColumn(_.object.matrix,0),oe.crossVectors(_.object.up,oe),oe.normalize(),oe.multiplyScalar(de),_.target.add(oe),le.position.add(oe),ae=!0),se.code==="KeyS"&&(oe.setFromMatrixColumn(_.object.matrix,0),oe.crossVectors(_.object.up,oe),oe.normalize(),oe.multiplyScalar(de),oe.negate(),_.target.add(oe),le.position.add(oe),ae=!0),se.code==="KeyA"&&(oe.copy(_.target),oe.sub(_.object.position),oe.crossVectors(_.object.up,oe),oe.normalize(),oe.multiplyScalar(de),_.target.add(oe),le.position.add(oe),ae=!0),se.code==="KeyD"&&(oe.copy(_.target),oe.sub(_.object.position),oe.crossVectors(_.object.up,oe),oe.normalize(),oe.multiplyScalar(de),oe.negate(),_.target.add(oe),le.position.add(oe),ae=!0),se.code==="KeyE"&&(oe.set(0,de,0),_.target.add(oe),le.position.add(oe),ae=!0),se.code==="KeyQ"&&(oe.set(0,-de,0),_.target.add(oe),le.position.add(oe),ae=!0),ae&&invalidate()}}(),ie=()=>{};if(K){const oe=K;return oe.tabIndex=1,oe.addEventListener("keydown",ne),oe.addEventListener("keyup",ie),()=>{oe.removeEventListener("keydown",ne),oe.removeEventListener("keyup",ie)}}},[_,K,Z,te]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}function deg2rad$1(K){return K*Math.PI/180}function OrbitCamera({parent:K,ctrlRef:_,onChange:Z,panSpeed:te=1,fov:ne=75,zoom:ie=1,near:oe,far:se,enableOrbitControl:ae=!0,initPosition:le=[-.5,.75,.8],initRotation:ce=[0,0,0]}){var fe,de;let pe=reactExports.useRef(null);pe=_||pe;const he=reactExports.useRef(null),ge=reactExports.useRef(null),me=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{var Ge,He;(Ge=ge.current)==null||Ge.up.copy(Object3D.DEFAULT_UP),(He=me.current)==null||He.up.copy(Object3D.DEFAULT_UP)},[Object3D.DEFAULT_UP]);const Ae=reactExports.useMemo(()=>queryString.parse(document$4.location.search),[]),[ye,ve]=useControls("Camera Control",()=>({zoom:{label:"Zoom (px)",value:Number(Ae.zoom)||ie||1,step:.001,min:.001,pad:4},fov:{label:"Fov°",value:Number(Ae.fov)||ne||75,step:.1,min:.1,max:220},position:{value:parseArray(Ae.initCamPos)||le,step:.01,min:-100,max:100},rotation:{value:parseArray(Ae.initCamRot,deg2rad$1)||ce,step:.01}}),[le,ce]),{enableControl:_e}=useControls("Camera Control",{enableControl:{value:!0,label:"lock upright"}},[ae]),{ctype:Te,...be}=useControls("Camera Control",{ctype:{value:"Perspective",options:["Perspective","Orthographic"],label:"Cam Type"},zoomSpeed:1,near:{label:"Near (cm)",value:parseFloat(Ae.near)||oe||.01,min:.001,step:1e-4},far:{label:"Far (m)",value:parseFloat(Ae.far)||se||200,min:.001,step:.001},panSpeed:{value:Number(Ae.panSpeed)||te||1,pad:5,step:.01,min:.001,max:5}}),Re=useThree(({set:Ge})=>Ge);useThree(({controls:Ge})=>Ge);const we=(fe=K.current)==null?void 0:fe.clientHeight,Pe=(de=K.current)==null?void 0:de.clientWidth;reactExports.useLayoutEffect(()=>{var Ge,He,ze;if(!Re)return;let Ke,tt,Je;if(he.current){const{target:ot}=pe.current;Je=he.current.position.distanceTo(ot),Ke=he.current.position,tt=he.current.rotation}else Ke=new Vector3(...ye.position),tt=new Euler(...ye.rotation);if(Te.toLowerCase()==="perspective"){const ot=(Ge=he==null?void 0:he.current)==null?void 0:Ge.zoom;if(!me.current){console.warn("perspective camera reference is undefined.");return}me.current.position.copy(Ke),me.current.rotation.copy(tt);const Fe=he.current=me.current;if(pe.current.object=Fe,ot&&Je){const ct=zoomToFov(ot,Je,we);Fe.fov=ct,Fe.updateProjectionMatrix(),ve({fov:ct})}}else if(Te.toLowerCase()==="orthographic"){const ot=(He=he==null?void 0:he.current)==null?void 0:He.fov;ge.current.position.copy(Ke),me.current.rotation.copy(tt),(ze=he.current)!=null&&ze.far&&(ge.current.far=he.current.far);const Fe=he.current=ge.current;if(pe.current.object=Fe,ot&&Je){Fe.near=-Fe.far;const ct=fovToZoom(ot,Je,we);Fe.zoom=ct,Fe.updateProjectionMatrix(),ve({zoom:we/ct})}else console.warn(`camera type ${Te} is not defined`)}he.current&&Re({camera:he.current})},[Te]);function Ie(){var Ge,He;const ze=(Ge=pe.current)==null?void 0:Ge.object;if(!ze)return;const Ke=ze.position.distanceTo((He=pe.current)==null?void 0:He.target);if(typeof Z=="function"){if(ze.type==="PerspectiveCamera"){const{type:tt,near:Je,far:ot,matrix:Fe,position:ct,rotation:ht,up:lt,fov:Qe,focus:Ze,aspect:it}=ze;Z({type:tt,near:Je,far:ot,matrix:Fe.elements,position:ct.toArray(),rotation:ht.toArray(),up:lt.toArray(),fov:Qe,focus:Ze,aspect:it,orbit_distance:Ke})}else if(ze.type==="OrthographicCamera"){const{type:tt,near:Je,far:ot,matrix:Fe,position:ct,rotation:ht,up:lt,zoom:Qe,left:Ze,top:it,bottom:nt,right:Tt}=ze;Z({type:tt,near:Je,far:ot,matrix:Fe.elements,position:ct.toArray(),rotation:ht.toArray(),up:lt.toArray(),aspect:(Tt-Ze)/(it-nt),zoom:we/Qe,left:Ze,top:it,bottom:nt,right:Tt,orbit_distance:Ke})}}}const{uplink:$e}=useSocket();reactExports.useEffect(()=>$e.subscribe("CAMERA_UPDATE",()=>Ie()),[]);const Ue=reactExports.useMemo(()=>({matrix:""}),[]),ke=reactExports.useCallback(()=>{var Ge;const He=(Ge=pe.current)==null?void 0:Ge.object;if(!He)return;const ze=JSON.stringify([He.projectionMatrix.toArray(),He.position.toArray(),He.rotation.toArray(),He.fov]);Ue.matrix!==ze&&Ie(),Ue.matrix=ze},[he.current,Z,we,ve]);return reactExports.useLayoutEffect(()=>Ie(),[pe.current,be.near,be.far,ye.fov,ye.zoom,we,Pe,ve,Z]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(OrbitControls,{ref:pe,makeDefault:!0,enableDamping:!1,enablePan:!0,screenSpacePanning:!0,onChange:ke,maxPolarAngle:135/180*Math.PI,minPolarAngle:0/180*Math.PI,maxZoom:1/0,maxDistance:1/0,zoomSpeed:be.zoomSpeed}),jsxRuntimeExports.jsx(PerspectiveCamera$1,{makeDefault:!0,ref:me,fov:ye.fov,near:be.near,far:be.far},"perspective"),jsxRuntimeExports.jsx(OrthographicCamera,{makeDefault:!0,ref:ge,zoom:we/ye.zoom,near:be.near,far:be.far},"orthographic"),jsxRuntimeExports.jsx(MyKeyboardControls,{parent:K.current,viewHeight:ye.zoom,controls:pe.current,panSpeed:be.panSpeed/600})]})}function Gamepad({_key:K,children:_}){const{sendMsg:Z}=useSocket();return useGamepads(te=>{const{axes:ne,buttons:ie}=te[0];Z({ts:Date.now(),etype:"GAMEPADS",key:K,value:{axes:ne,buttons:ie.map(oe=>oe.value)}})}),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:_})}function Download({_key:K}){const{sendMsg:_}=useSocket(),{gl:Z}=useThree(),te=reactExports.useCallback(()=>{const ne=Z.domElement.toDataURL("image/png");_({etype:"SNAPSHOT",key:K,value:{screen:ne}});const ie=document.createElement("a");ie.setAttribute("download","canvas.png"),ie.setAttribute("href",ne.replace("image/png","image/octet-stream")),ie.click()},[_]);return useControls({"Take Screenshot":button(te,{disabled:!1})},[]),null}const ChildrenKey="children",ALL_SCENE_KEYS=[ChildrenKey,"rawChildren","bgChildren","htmlChildren","wrappers"];function findByKey(K,_,Z=["children"]){if(K.key===_)return K;for(const te of Z)if(K[te])for(const ne of K[te]){const ie=findByKey(ne,_);if(ie)return ie}}function removeByKey(K,_,Z=ALL_SCENE_KEYS){for(const te of Z){const ne=K[te];if(ne){for(const ie of ne)if(ie.key===_)return K[te]=ne.filter(oe=>oe.key!==_),ie}}return!1}function updateNode(K,_,Z){const te=findByKey(K,_,ALL_SCENE_KEYS);return te?(Object.assign(te,Z),!0):!1}function addNode(K,_,Z){if(!K)throw"scene is undefined";if(ALL_SCENE_KEYS.indexOf(Z)>=0&&Array.isArray(K[Z]))return K[Z].push(_),!0;{const te=Z?findByKey(K,Z,ALL_SCENE_KEYS):K;return te.children||(te.children=[]),te.children.push(_),!0}}function upsertNode(K,_,Z){const te=Z?[Z]:ALL_SCENE_KEYS,ne=findByKey(K,_.key,te);return ne?Object.assign(ne,_):K[Z||ChildrenKey].push(_),!0}const panel="_panel_1frsq_1",folder="_folder_1frsq_1",item="_item_1frsq_1",SetOp=(K,_)=>({ts:_||Date.now(),etype:"SET",data:K}),AddOp=(K,_="children",Z)=>({ts:Z||Date.now(),etype:"ADD",data:{nodes:K,to:_}}),UpdateOp=(K,_)=>({ts:_||Date.now(),etype:"UPDATE",data:{nodes:K}}),UpsertOp=(K,_,Z)=>({ts:Z||Date.now(),etype:"UPSERT",data:{nodes:K,to:_}}),RemoveOp=(K,_)=>({ts:_||Date.now(),etype:"REMOVE",data:{keys:K}}),TimeoutOp=(fn,timeout,ts)=>(typeof fn=="string"&&(fn=eval(fn)),{ts:ts||Date.now(),etype:"TIMEOUT",data:{timeout,fn}}),NodeList=(K,_)=>K.map(Z=>{if(typeof Z=="string")return jsxRuntimeExports.jsx(NodeItem,{tag:"text",sceneOps:_,children:[Z]});{const{key:te,...ne}=Z;return jsxRuntimeExports.jsx(NodeItem,{_key:te,sceneOps:_,...ne},te)}}),NodeItem=({tag:K,_key:_,sceneOps:Z,children:te=[]})=>{const[ne,ie]=reactExports.useState(!0),{show:oe}=useControls(`Scene.${_}`,{show:{value:!0,label:"Show in View"}});return reactExports.useEffect(()=>{Z.update(UpdateOp([{tag:K,key:_,hide:!oe}]))},[oe,Z.update]),jsxRuntimeExports.jsxs("div",{className:folder,onClick:se=>{se.stopPropagation(),ie(!ne)},children:[jsxRuntimeExports.jsxs("div",{className:item,children:[K," ",_]}),ne&&NodeList(te,Z)]})},GraphView=({title:K,nodes:_,sceneOps:Z})=>{const[te,ne]=reactExports.useState(!0);return jsxRuntimeExports.jsxs("div",{className:panel,onClick:ie=>{ie.stopPropagation(),ne(!te)},children:[K&&jsxRuntimeExports.jsx("h3",{children:K}),te&&NodeList(_,Z)]})},useSceneStore=create$d((K,_)=>({position:[0,0,0],rotation:[0,0,0,"XYZ"],scale:[1,1,1],up:[0,1,0],children:[],bgChildren:[],htmlChildren:[],rawChildren:[],wrappers:[],ops:{rawUpdate(Z){K(te=>({...te,...Z}))},set({ts:Z,data:te}){delete te.key,te.tag!=="Scene"&&console.error(`
        The top level node of the SET operation must be a <Scene/> object, 
        got <${te.tag}/> instead.
      `),K(te)},add({ts:Z,data:{nodes:te,to:ne}}){K(ie=>{let oe;for(const se of te)try{oe=addNode(ie,se,ne)||oe}catch(ae){console.error(`Failed to add node ${se.key} to ${ne}. ${ae}`)}return oe?{...ie}:ie})},update({ts:Z,data:{nodes:te}}){K(ne=>{let ie;for(const{key:oe,...se}of te)ie=updateNode(ne,oe,se)||ie;return ie?{...ne}:ne})},upsert({ts:Z,data:{nodes:te,to:ne}}){K(ie=>{let oe;for(const se of te)oe=upsertNode(ie,se,ne);return oe?{...ie}:ie})},removeByKey({ts:Z,data:{keys:te}}){K(ne=>{let ie;for(const oe of te){const se=removeByKey(ne,oe);ie=ie||!!se}return ie?{...ne}:ne})},timeout({ts:Z,data:{timeout:te,fn:ne}}){setTimeout(ne,te)}}}));function deg2rad(K){return{x:K.x*Math.PI/180,y:K.y*Math.PI/180,z:K.z*Math.PI/180,order:K.order||"XYZ"}}const v3array=({x:K,y:_,z:Z})=>[K,_,Z],euler2array=({x:K,y:_,z:Z,order:te=void 0})=>typeof te>"u"?[K,_,Z]:[K,_,Z,te],rot2array=K=>euler2array(deg2rad(K)),scale2array=K=>typeof K=="number"?[K,K,K]:v3array(K);function SceneGroup({levaPrefix:K="Scene.World Transform",position:_,rotation:Z,scale:te,children:ne}){const{uplink:ie}=useSocket(),oe=reactExports.useMemo(()=>{const fe=queryString.parse(document$4.location.search);let de,pe,he;if(fe.rotation){const[ge,me,Ae]=fe.rotation.split(",").filter(ye=>ye&&ye===ye).map(parseFloat);de={x:ge,y:me,z:Ae}}if(fe.position){const[ge,me,Ae]=fe.position.split(",").filter(ye=>ye&&ye===ye).map(parseFloat);pe={x:ge,y:me,z:Ae}}return fe.scale&&(he=parseFloat(fe.scale)),{rotation:de,position:pe,scale:he}},[]),{position:se,rotation:ae,scale:le}=useControls(K,{rotation:{value:Z||oe.rotation||{x:0,y:0,z:0},order:1,lock:!0},position:{value:_||oe.position||{x:0,y:0,z:0},order:-1,lock:!0},scale:{value:te||oe.scale||1,min:1e-4,step:.01,label:"Scale",order:2,pad:4}},{collapsed:!0}),ce=useSceneStore(({ops:fe})=>fe);return reactExports.useEffect(()=>{setTimeout(()=>ie==null?void 0:ie.publish({etype:"CAMERA_UPDATE"}),0);const fe={position:[se.x,se.y,se.z],rotation:[ae.x,ae.y,ae.z],scale:le};return ce.rawUpdate(fe),ie.addReducer("CAMERA_MOVE",de=>{var pe;return{...de,value:{...de.value,world:{...(pe=de.value)==null?void 0:pe.world,...fe}}}})},[ce,ie,se,ae,le]),jsxRuntimeExports.jsx("group",{position:se,rotation:ae,scale:le,children:ne})}function GroupSlave({children:K}){const _=useSceneStore(ne=>ne.position),Z=useSceneStore(ne=>ne.rotation),te=useSceneStore(ne=>ne.scale);return jsxRuntimeExports.jsx("group",{position:_,rotation:Z,scale:te,children:K})}const preferredTheme=()=>{var K,_;return(_=(K=window==null?void 0:window.matchMedia)==null?void 0:K.call(window,"(prefers-color-scheme:dark)"))!=null&&_.matches?"dark":"light"};function BackgroundColor({levaPrefix:K="Scene",color:_=1250326}){const Z=reactExports.useMemo(()=>queryString.parse(document.location.search),[document.location.search]),te=reactExports.useMemo(()=>{let oe,se;Z.background&&([oe,se]=Z.background.split(",")),Z.darkBg&&(oe=Z.darkBg),Z.lightBg&&(se=Z.lightBg);const ae=preferredTheme();let le;return ae==="dark"?le=oe||se:ae==="light"?le=se||oe:console.warn("Unknown theme",ae),le?`#${le}`:_},[_,document.location.search]),{background:ne}=useControls(K,{background:{value:te,label:"Background Color"}},{collapsed:!0},[_]),{uplink:ie}=useSocket();return reactExports.useEffect(()=>ie.addReducer("CAMERA_MOVE",({value:{world:oe,...se},...ae})=>({...ae,value:{...se,world:{...oe,background:ne}}})),[ie,ne]),jsxRuntimeExports.jsx("color",{attach:"background",args:[ne]})}const style$5="_style_17ukg_1",buttonStyle$2="_buttonStyle_17ukg_30",XRButton=({store:K})=>jsxRuntimeExports.jsxs("div",{className:style$5,children:[jsxRuntimeExports.jsx("button",{className:buttonStyle$2,onClick:()=>K.enterVR(),children:"Virtual Reality"}),jsxRuntimeExports.jsx("button",{className:buttonStyle$2,onClick:()=>K.enterAR(),children:"Pass-through"})]}),iframeVuerLinkButton="_iframeVuerLinkButton_gxqj6_1",IframeVuerLink=K=>window.self!==window.top?jsxRuntimeExports.jsx("a",{className:iframeVuerLinkButton,href:window.location.href,target:"_top",children:"Full Screen"}):null;function XrStereoPatch(){const K=useThree(({gl:te})=>te),_=useThree(({camera:te})=>te),Z=useXR(({mode:te})=>te);return reactExports.useEffect(()=>{K.xr.cameraAutoUpdate=!1},[Z,K,_]),useFrame(()=>{K.xr.updateCamera(_),!(Z!=="immersive-ar"&&Z!=="immersive-vr")&&_ instanceof ArrayCamera&&(_.cameras[0].layers.mask=3,_.cameras[1].layers.mask=5)}),null}function getDefaultExportFromCjs(K){return K&&K.__esModule&&Object.prototype.hasOwnProperty.call(K,"default")?K.default:K}var withSelector={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var K=React;function _(fe,de){return fe===de&&(fe!==0||1/fe===1/de)||fe!==fe&&de!==de}var Z=typeof Object.is=="function"?Object.is:_,te=K.useState,ne=K.useEffect,ie=K.useLayoutEffect,oe=K.useDebugValue;function se(fe,de){var pe=de(),he=te({inst:{value:pe,getSnapshot:de}}),ge=he[0].inst,me=he[1];return ie(function(){ge.value=pe,ge.getSnapshot=de,ae(ge)&&me({inst:ge})},[fe,pe,de]),ne(function(){return ae(ge)&&me({inst:ge}),fe(function(){ae(ge)&&me({inst:ge})})},[fe]),oe(pe),pe}function ae(fe){var de=fe.getSnapshot;fe=fe.value;try{var pe=de();return!Z(fe,pe)}catch{return!0}}function le(fe,de){return de()}var ce=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?le:se;return useSyncExternalStoreShim_production.useSyncExternalStore=K.useSyncExternalStore!==void 0?K.useSyncExternalStore:ce,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var K=React,_=requireShim();function Z(le,ce){return le===ce&&(le!==0||1/le===1/ce)||le!==le&&ce!==ce}var te=typeof Object.is=="function"?Object.is:Z,ne=_.useSyncExternalStore,ie=K.useRef,oe=K.useEffect,se=K.useMemo,ae=K.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(le,ce,fe,de,pe){var he=ie(null);if(he.current===null){var ge={hasValue:!1,value:null};he.current=ge}else ge=he.current;he=se(function(){function Ae(be){if(!ye){if(ye=!0,ve=be,be=de(be),pe!==void 0&&ge.hasValue){var Re=ge.value;if(pe(Re,be))return _e=Re}return _e=be}if(Re=_e,te(ve,be))return Re;var we=de(be);return pe!==void 0&&pe(Re,we)?(ve=be,Re):(ve=be,_e=we)}var ye=!1,ve,_e,Te=fe===void 0?null:fe;return[function(){return Ae(ce())},Te===null?void 0:function(){return Ae(Te())}]},[ce,fe,de,pe]);var me=ne(le,he[0],he[1]);return oe(function(){ge.hasValue=!0,ge.value=me},[me]),ae(me),me},withSelector_production}withSelector.exports=requireWithSelector_production();var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),createStoreImpl=K=>{let _;const Z=new Set,te=(se,ae)=>{const le=typeof se=="function"?se(_):se;if(!Object.is(le,_)){const ce=_;_=ae??(typeof le!="object"||le===null)?le:Object.assign({},_,le),Z.forEach(fe=>fe(_,ce))}},ne=()=>_,ie={setState:te,getState:ne,getInitialState:()=>oe,subscribe:se=>(Z.add(se),()=>Z.delete(se))},oe=_=K(te,ne,ie);return ie},createStore=K=>K?createStoreImpl(K):createStoreImpl,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports,identity$2=K=>K;function useStoreWithEqualityFn(K,_=identity$2,Z){const te=useSyncExternalStoreWithSelector(K.subscribe,K.getState,K.getInitialState,_,Z);return React.useDebugValue(te),te}const createWithEqualityFnImpl=(K,_)=>{const Z=createStore(K),te=(ne,ie=_)=>useStoreWithEqualityFn(Z,ne,ie);return Object.assign(te,Z),te},createWithEqualityFn=(K,_)=>K?createWithEqualityFnImpl(K,_):createWithEqualityFnImpl,isIterable=K=>Symbol.iterator in K,hasIterableEntries=K=>"entries"in K,compareEntries=(K,_)=>{const Z=K instanceof Map?K:new Map(K.entries()),te=_ instanceof Map?_:new Map(_.entries());if(Z.size!==te.size)return!1;for(const[ne,ie]of Z)if(!Object.is(ie,te.get(ne)))return!1;return!0},compareIterables=(K,_)=>{const Z=K[Symbol.iterator](),te=_[Symbol.iterator]();let ne=Z.next(),ie=te.next();for(;!ne.done&&!ie.done;){if(!Object.is(ne.value,ie.value))return!1;ne=Z.next(),ie=te.next()}return!!ne.done&&!!ie.done};function shallow$7(K,_){return Object.is(K,_)?!0:typeof K!="object"||K===null||typeof _!="object"||_===null?!1:!isIterable(K)||!isIterable(_)?compareEntries({entries:()=>Object.entries(K)},{entries:()=>Object.entries(_)}):hasIterableEntries(K)&&hasIterableEntries(_)?compareEntries(K,_):compareIterables(K,_)}const usePerfImpl=createWithEqualityFn((K,_)=>{function Z(){var te;const{accumulated:ne,startTime:ie,infos:oe}=_(),se=(te=_().log)==null?void 0:te.maxMemory,{totalFrames:ae,log:le,gl:ce,max:fe}=ne,de={calls:ce.calls/ae,triangles:ce.triangles/ae,points:ce.points/ae,lines:ce.lines/ae},pe={gpu:le.gpu/ae,cpu:le.cpu/ae,mem:le.mem/ae,fps:le.fps/ae};return{sessionTime:(window.performance.now()-ie)/1e3,infos:oe,log:pe,gl:de,max:fe,maxMemory:se,totalFrames:ae}}return{log:null,paused:!1,triggerProgramsUpdate:0,startTime:0,customData:0,fpsLimit:60,overclockingFps:!1,accumulated:{totalFrames:0,gl:{calls:0,triangles:0,points:0,lines:0,counts:0},log:{gpu:0,cpu:0,mem:0,fps:0},max:{gl:{calls:0,triangles:0,points:0,lines:0,counts:0},log:{gpu:0,cpu:0,mem:0,fps:0}}},chart:{data:{fps:[],cpu:[],gpu:[],mem:[]},circularId:0},gl:void 0,objectWithMaterials:null,scene:void 0,programs:new Map,sceneLength:void 0,tab:"infos",getReport:Z}}),usePerf=K=>usePerfImpl(K,shallow$7);Object.assign(usePerf,usePerfImpl);const{getState:getPerf,setState:setPerf}=usePerfImpl;function ActivityLogIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M0 1.5C0 1.22386 0.223858 1 0.5 1H2.5C2.77614 1 3 1.22386 3 1.5C3 1.77614 2.77614 2 2.5 2H0.5C0.223858 2 0 1.77614 0 1.5ZM4 1.5C4 1.22386 4.22386 1 4.5 1H14.5C14.7761 1 15 1.22386 15 1.5C15 1.77614 14.7761 2 14.5 2H4.5C4.22386 2 4 1.77614 4 1.5ZM4 4.5C4 4.22386 4.22386 4 4.5 4H11.5C11.7761 4 12 4.22386 12 4.5C12 4.77614 11.7761 5 11.5 5H4.5C4.22386 5 4 4.77614 4 4.5ZM0 7.5C0 7.22386 0.223858 7 0.5 7H2.5C2.77614 7 3 7.22386 3 7.5C3 7.77614 2.77614 8 2.5 8H0.5C0.223858 8 0 7.77614 0 7.5ZM4 7.5C4 7.22386 4.22386 7 4.5 7H14.5C14.7761 7 15 7.22386 15 7.5C15 7.77614 14.7761 8 14.5 8H4.5C4.22386 8 4 7.77614 4 7.5ZM4 10.5C4 10.2239 4.22386 10 4.5 10H11.5C11.7761 10 12 10.2239 12 10.5C12 10.7761 11.7761 11 11.5 11H4.5C4.22386 11 4 10.7761 4 10.5ZM0 13.5C0 13.2239 0.223858 13 0.5 13H2.5C2.77614 13 3 13.2239 3 13.5C3 13.7761 2.77614 14 2.5 14H0.5C0.223858 14 0 13.7761 0 13.5ZM4 13.5C4 13.2239 4.22386 13 4.5 13H14.5C14.7761 13 15 13.2239 15 13.5C15 13.7761 14.7761 14 14.5 14H4.5C4.22386 14 4 13.7761 4 13.5Z"})})}function ButtonIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M2 5H13C13.5523 5 14 5.44772 14 6V9C14 9.55228 13.5523 10 13 10H2C1.44772 10 1 9.55228 1 9V6C1 5.44772 1.44772 5 2 5ZM0 6C0 4.89543 0.895431 4 2 4H13C14.1046 4 15 4.89543 15 6V9C15 10.1046 14.1046 11 13 11H2C0.89543 11 0 10.1046 0 9V6ZM4.5 6.75C4.08579 6.75 3.75 7.08579 3.75 7.5C3.75 7.91421 4.08579 8.25 4.5 8.25C4.91421 8.25 5.25 7.91421 5.25 7.5C5.25 7.08579 4.91421 6.75 4.5 6.75ZM6.75 7.5C6.75 7.08579 7.08579 6.75 7.5 6.75C7.91421 6.75 8.25 7.08579 8.25 7.5C8.25 7.91421 7.91421 8.25 7.5 8.25C7.08579 8.25 6.75 7.91421 6.75 7.5ZM10.5 6.75C10.0858 6.75 9.75 7.08579 9.75 7.5C9.75 7.91421 10.0858 8.25 10.5 8.25C10.9142 8.25 11.25 7.91421 11.25 7.5C11.25 7.08579 10.9142 6.75 10.5 6.75Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function BarChartIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M11.5 1C11.7761 1 12 1.22386 12 1.5V13.5C12 13.7761 11.7761 14 11.5 14C11.2239 14 11 13.7761 11 13.5V1.5C11 1.22386 11.2239 1 11.5 1ZM9.5 3C9.77614 3 10 3.22386 10 3.5V13.5C10 13.7761 9.77614 14 9.5 14C9.22386 14 9 13.7761 9 13.5V3.5C9 3.22386 9.22386 3 9.5 3ZM13.5 3C13.7761 3 14 3.22386 14 3.5V13.5C14 13.7761 13.7761 14 13.5 14C13.2239 14 13 13.7761 13 13.5V3.5C13 3.22386 13.2239 3 13.5 3ZM5.5 4C5.77614 4 6 4.22386 6 4.5V13.5C6 13.7761 5.77614 14 5.5 14C5.22386 14 5 13.7761 5 13.5V4.5C5 4.22386 5.22386 4 5.5 4ZM1.5 5C1.77614 5 2 5.22386 2 5.5V13.5C2 13.7761 1.77614 14 1.5 14C1.22386 14 1 13.7761 1 13.5V5.5C1 5.22386 1.22386 5 1.5 5ZM7.5 5C7.77614 5 8 5.22386 8 5.5V13.5C8 13.7761 7.77614 14 7.5 14C7.22386 14 7 13.7761 7 13.5V5.5C7 5.22386 7.22386 5 7.5 5ZM3.5 7C3.77614 7 4 7.22386 4 7.5V13.5C4 13.7761 3.77614 14 3.5 14C3.22386 14 3 13.7761 3 13.5V7.5C3 7.22386 3.22386 7 3.5 7Z"})})}function CubeIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M7.28856 0.796908C7.42258 0.734364 7.57742 0.734364 7.71144 0.796908L13.7114 3.59691C13.8875 3.67906 14 3.85574 14 4.05V10.95C14 11.1443 13.8875 11.3209 13.7114 11.4031L7.71144 14.2031C7.57742 14.2656 7.42258 14.2656 7.28856 14.2031L1.28856 11.4031C1.11252 11.3209 1 11.1443 1 10.95V4.05C1 3.85574 1.11252 3.67906 1.28856 3.59691L7.28856 0.796908ZM2 4.80578L7 6.93078V12.9649L2 10.6316V4.80578ZM8 12.9649L13 10.6316V4.80578L8 6.93078V12.9649ZM7.5 6.05672L12.2719 4.02866L7.5 1.80176L2.72809 4.02866L7.5 6.05672Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function EyeNoneIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M13.3536 2.35355C13.5488 2.15829 13.5488 1.84171 13.3536 1.64645C13.1583 1.45118 12.8417 1.45118 12.6464 1.64645L10.6828 3.61012C9.70652 3.21671 8.63759 3 7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C0.902945 9.08812 2.02314 10.1861 3.36061 10.9323L1.64645 12.6464C1.45118 12.8417 1.45118 13.1583 1.64645 13.3536C1.84171 13.5488 2.15829 13.5488 2.35355 13.3536L4.31723 11.3899C5.29348 11.7833 6.36241 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C14.0971 5.9119 12.9769 4.81391 11.6394 4.06771L13.3536 2.35355ZM9.90428 4.38861C9.15332 4.1361 8.34759 4 7.5 4C4.80285 4 2.52952 5.37816 1.09622 7.50001C1.87284 8.6497 2.89609 9.58106 4.09974 10.1931L9.90428 4.38861ZM5.09572 10.6114L10.9003 4.80685C12.1039 5.41894 13.1272 6.35031 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11C6.65241 11 5.84668 10.8639 5.09572 10.6114Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function EyeOpenIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M7.5 11C4.80285 11 2.52952 9.62184 1.09622 7.50001C2.52952 5.37816 4.80285 4 7.5 4C10.1971 4 12.4705 5.37816 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11ZM7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C1.65639 10.2936 4.30786 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C13.3436 4.70638 10.6921 3 7.5 3ZM7.5 9.5C8.60457 9.5 9.5 8.60457 9.5 7.5C9.5 6.39543 8.60457 5.5 7.5 5.5C6.39543 5.5 5.5 6.39543 5.5 7.5C5.5 8.60457 6.39543 9.5 7.5 9.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function ImageIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M2.5 1H12.5C13.3284 1 14 1.67157 14 2.5V12.5C14 13.3284 13.3284 14 12.5 14H2.5C1.67157 14 1 13.3284 1 12.5V2.5C1 1.67157 1.67157 1 2.5 1ZM2.5 2C2.22386 2 2 2.22386 2 2.5V8.3636L3.6818 6.6818C3.76809 6.59551 3.88572 6.54797 4.00774 6.55007C4.12975 6.55216 4.24568 6.60372 4.32895 6.69293L7.87355 10.4901L10.6818 7.6818C10.8575 7.50607 11.1425 7.50607 11.3182 7.6818L13 9.3636V2.5C13 2.22386 12.7761 2 12.5 2H2.5ZM2 12.5V9.6364L3.98887 7.64753L7.5311 11.4421L8.94113 13H2.5C2.22386 13 2 12.7761 2 12.5ZM12.5 13H10.155L8.48336 11.153L11 8.6364L13 10.6364V12.5C13 12.7761 12.7761 13 12.5 13ZM6.64922 5.5C6.64922 5.03013 7.03013 4.64922 7.5 4.64922C7.96987 4.64922 8.35078 5.03013 8.35078 5.5C8.35078 5.96987 7.96987 6.35078 7.5 6.35078C7.03013 6.35078 6.64922 5.96987 6.64922 5.5ZM7.5 3.74922C6.53307 3.74922 5.74922 4.53307 5.74922 5.5C5.74922 6.46693 6.53307 7.25078 7.5 7.25078C8.46693 7.25078 9.25078 6.46693 9.25078 5.5C9.25078 4.53307 8.46693 3.74922 7.5 3.74922Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function LayersIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M7.75432 0.819537C7.59742 0.726821 7.4025 0.726821 7.24559 0.819537L1.74559 4.06954C1.59336 4.15949 1.49996 4.32317 1.49996 4.5C1.49996 4.67683 1.59336 4.84051 1.74559 4.93046L7.24559 8.18046C7.4025 8.27318 7.59742 8.27318 7.75432 8.18046L13.2543 4.93046C13.4066 4.84051 13.5 4.67683 13.5 4.5C13.5 4.32317 13.4066 4.15949 13.2543 4.06954L7.75432 0.819537ZM7.49996 7.16923L2.9828 4.5L7.49996 1.83077L12.0171 4.5L7.49996 7.16923ZM1.5695 7.49564C1.70998 7.2579 2.01659 7.17906 2.25432 7.31954L7.49996 10.4192L12.7456 7.31954C12.9833 7.17906 13.2899 7.2579 13.4304 7.49564C13.5709 7.73337 13.4921 8.03998 13.2543 8.18046L7.75432 11.4305C7.59742 11.5232 7.4025 11.5232 7.24559 11.4305L1.74559 8.18046C1.50786 8.03998 1.42901 7.73337 1.5695 7.49564ZM1.56949 10.4956C1.70998 10.2579 2.01658 10.1791 2.25432 10.3195L7.49996 13.4192L12.7456 10.3195C12.9833 10.1791 13.2899 10.2579 13.4304 10.4956C13.5709 10.7334 13.4921 11.04 13.2543 11.1805L7.75432 14.4305C7.59742 14.5232 7.4025 14.5232 7.24559 14.4305L1.74559 11.1805C1.50785 11.04 1.42901 10.7334 1.56949 10.4956Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function PauseIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M6.04995 2.74998C6.04995 2.44623 5.80371 2.19998 5.49995 2.19998C5.19619 2.19998 4.94995 2.44623 4.94995 2.74998V12.25C4.94995 12.5537 5.19619 12.8 5.49995 12.8C5.80371 12.8 6.04995 12.5537 6.04995 12.25V2.74998ZM10.05 2.74998C10.05 2.44623 9.80371 2.19998 9.49995 2.19998C9.19619 2.19998 8.94995 2.44623 8.94995 2.74998V12.25C8.94995 12.5537 9.19619 12.8 9.49995 12.8C9.80371 12.8 10.05 12.5537 10.05 12.25V2.74998Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function RocketIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function TriangleDownIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M4 6H11L7.5 10.5L4 6Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function TriangleUpIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M4 9H11L7.5 4.5L4 9Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function VercelLogoIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M7.49998 1L6.92321 2.00307L1.17498 12L0.599976 13H1.7535H13.2464H14.4L13.825 12L8.07674 2.00307L7.49998 1ZM7.49998 3.00613L2.3285 12H12.6714L7.49998 3.00613Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function MinusIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 7.5C2.25 7.22386 2.47386 7 2.75 7H12.25C12.5261 7 12.75 7.22386 12.75 7.5C12.75 7.77614 12.5261 8 12.25 8H2.75C2.47386 8 2.25 7.77614 2.25 7.5Z"})})}function DotIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M7.5 9.125C8.39746 9.125 9.125 8.39746 9.125 7.5C9.125 6.60254 8.39746 5.875 7.5 5.875C6.60254 5.875 5.875 6.60254 5.875 7.5C5.875 8.39746 6.60254 9.125 7.5 9.125ZM7.5 10.125C8.94975 10.125 10.125 8.94975 10.125 7.5C10.125 6.05025 8.94975 4.875 7.5 4.875C6.05025 4.875 4.875 6.05025 4.875 7.5C4.875 8.94975 6.05025 10.125 7.5 10.125Z"})})}function DropdownMenuIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{d:"M7.49999 3.09998C7.27907 3.09998 7.09999 3.27906 7.09999 3.49998C7.09999 3.72089 7.27907 3.89998 7.49999 3.89998H14.5C14.7209 3.89998 14.9 3.72089 14.9 3.49998C14.9 3.27906 14.7209 3.09998 14.5 3.09998H7.49999ZM7.49998 5.1C7.27907 5.1 7.09998 5.27908 7.09998 5.5C7.09998 5.72091 7.27907 5.9 7.49998 5.9H14.5C14.7209 5.9 14.9 5.72091 14.9 5.5C14.9 5.27908 14.7209 5.1 14.5 5.1H7.49998ZM7.1 7.5C7.1 7.27908 7.27909 7.1 7.5 7.1H14.5C14.7209 7.1 14.9 7.27908 14.9 7.5C14.9 7.72091 14.7209 7.9 14.5 7.9H7.5C7.27909 7.9 7.1 7.72091 7.1 7.5ZM7.49998 9.1C7.27907 9.1 7.09998 9.27908 7.09998 9.5C7.09998 9.72091 7.27907 9.9 7.49998 9.9H14.5C14.7209 9.9 14.9 9.72091 14.9 9.5C14.9 9.27908 14.7209 9.1 14.5 9.1H7.49998ZM7.09998 11.5C7.09998 11.2791 7.27907 11.1 7.49998 11.1H14.5C14.7209 11.1 14.9 11.2791 14.9 11.5C14.9 11.7209 14.7209 11.9 14.5 11.9H7.49998C7.27907 11.9 7.09998 11.7209 7.09998 11.5ZM2.5 9.25003L5 6.00003H0L2.5 9.25003Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function LightningBoltIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M8.69667 0.0403541C8.90859 0.131038 9.03106 0.354857 8.99316 0.582235L8.0902 6.00001H12.5C12.6893 6.00001 12.8625 6.10701 12.9472 6.27641C13.0319 6.4458 13.0136 6.6485 12.8999 6.80001L6.89997 14.8C6.76167 14.9844 6.51521 15.0503 6.30328 14.9597C6.09135 14.869 5.96888 14.6452 6.00678 14.4178L6.90974 9H2.49999C2.31061 9 2.13748 8.893 2.05278 8.72361C1.96809 8.55422 1.98636 8.35151 2.09999 8.2L8.09997 0.200038C8.23828 0.0156255 8.48474 -0.0503301 8.69667 0.0403541ZM3.49999 8.00001H7.49997C7.64695 8.00001 7.78648 8.06467 7.88148 8.17682C7.97648 8.28896 8.01733 8.43723 7.99317 8.5822L7.33027 12.5596L11.5 7.00001H7.49997C7.353 7.00001 7.21347 6.93534 7.11846 6.8232C7.02346 6.71105 6.98261 6.56279 7.00678 6.41781L7.66968 2.44042L3.49999 8.00001Z"})})}function LapTimerIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M5.49998 0.5C5.49998 0.223858 5.72383 0 5.99998 0H7.49998H8.99998C9.27612 0 9.49998 0.223858 9.49998 0.5C9.49998 0.776142 9.27612 1 8.99998 1H7.99998V2.11922C9.09832 2.20409 10.119 2.56622 10.992 3.13572C11.0116 3.10851 11.0336 3.08252 11.058 3.05806L12.058 2.05806C12.3021 1.81398 12.6978 1.81398 12.9419 2.05806C13.186 2.30214 13.186 2.69786 12.9419 2.94194L11.967 3.91682C13.1595 5.07925 13.9 6.70314 13.9 8.49998C13.9 12.0346 11.0346 14.9 7.49998 14.9C3.96535 14.9 1.09998 12.0346 1.09998 8.49998C1.09998 5.13361 3.69904 2.3743 6.99998 2.11922V1H5.99998C5.72383 1 5.49998 0.776142 5.49998 0.5ZM2.09998 8.49998C2.09998 5.51764 4.51764 3.09998 7.49998 3.09998C10.4823 3.09998 12.9 5.51764 12.9 8.49998C12.9 11.4823 10.4823 13.9 7.49998 13.9C4.51764 13.9 2.09998 11.4823 2.09998 8.49998ZM7.49998 8.49998V4.09998C5.06992 4.09998 3.09998 6.06992 3.09998 8.49998C3.09998 10.93 5.06992 12.9 7.49998 12.9C8.715 12.9 9.815 12.4075 10.6112 11.6112L7.49998 8.49998Z"})})}function MarginIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M1.49988 2.00012C1.77602 2.00012 1.99988 1.77626 1.99988 1.50012C1.99988 1.22398 1.77602 1.00012 1.49988 1.00012C1.22374 1.00012 0.999878 1.22398 0.999878 1.50012C0.999878 1.77626 1.22374 2.00012 1.49988 2.00012ZM4.49988 2.00012C4.77602 2.00012 4.99988 1.77626 4.99988 1.50012C4.99988 1.22398 4.77602 1.00012 4.49988 1.00012C4.22374 1.00012 3.99988 1.22398 3.99988 1.50012C3.99988 1.77626 4.22374 2.00012 4.49988 2.00012ZM7.99988 1.50012C7.99988 1.77626 7.77602 2.00012 7.49988 2.00012C7.22374 2.00012 6.99988 1.77626 6.99988 1.50012C6.99988 1.22398 7.22374 1.00012 7.49988 1.00012C7.77602 1.00012 7.99988 1.22398 7.99988 1.50012ZM10.4999 2.00012C10.776 2.00012 10.9999 1.77626 10.9999 1.50012C10.9999 1.22398 10.776 1.00012 10.4999 1.00012C10.2237 1.00012 9.99988 1.22398 9.99988 1.50012C9.99988 1.77626 10.2237 2.00012 10.4999 2.00012ZM13.9999 1.50012C13.9999 1.77626 13.776 2.00012 13.4999 2.00012C13.2237 2.00012 12.9999 1.77626 12.9999 1.50012C12.9999 1.22398 13.2237 1.00012 13.4999 1.00012C13.776 1.00012 13.9999 1.22398 13.9999 1.50012ZM1.49988 14.0001C1.77602 14.0001 1.99988 13.7763 1.99988 13.5001C1.99988 13.224 1.77602 13.0001 1.49988 13.0001C1.22374 13.0001 0.999878 13.224 0.999878 13.5001C0.999878 13.7763 1.22374 14.0001 1.49988 14.0001ZM1.99988 10.5001C1.99988 10.7763 1.77602 11.0001 1.49988 11.0001C1.22374 11.0001 0.999878 10.7763 0.999878 10.5001C0.999878 10.224 1.22374 10.0001 1.49988 10.0001C1.77602 10.0001 1.99988 10.224 1.99988 10.5001ZM1.49988 8.00012C1.77602 8.00012 1.99988 7.77626 1.99988 7.50012C1.99988 7.22398 1.77602 7.00012 1.49988 7.00012C1.22374 7.00012 0.999878 7.22398 0.999878 7.50012C0.999878 7.77626 1.22374 8.00012 1.49988 8.00012ZM1.99988 4.50012C1.99988 4.77626 1.77602 5.00012 1.49988 5.00012C1.22374 5.00012 0.999878 4.77626 0.999878 4.50012C0.999878 4.22398 1.22374 4.00012 1.49988 4.00012C1.77602 4.00012 1.99988 4.22398 1.99988 4.50012ZM13.4999 11.0001C13.776 11.0001 13.9999 10.7763 13.9999 10.5001C13.9999 10.224 13.776 10.0001 13.4999 10.0001C13.2237 10.0001 12.9999 10.224 12.9999 10.5001C12.9999 10.7763 13.2237 11.0001 13.4999 11.0001ZM13.9999 7.50012C13.9999 7.77626 13.776 8.00012 13.4999 8.00012C13.2237 8.00012 12.9999 7.77626 12.9999 7.50012C12.9999 7.22398 13.2237 7.00012 13.4999 7.00012C13.776 7.00012 13.9999 7.22398 13.9999 7.50012ZM13.4999 5.00012C13.776 5.00012 13.9999 4.77626 13.9999 4.50012C13.9999 4.22398 13.776 4.00012 13.4999 4.00012C13.2237 4.00012 12.9999 4.22398 12.9999 4.50012C12.9999 4.77626 13.2237 5.00012 13.4999 5.00012ZM4.99988 13.5001C4.99988 13.7763 4.77602 14.0001 4.49988 14.0001C4.22374 14.0001 3.99988 13.7763 3.99988 13.5001C3.99988 13.224 4.22374 13.0001 4.49988 13.0001C4.77602 13.0001 4.99988 13.224 4.99988 13.5001ZM7.49988 14.0001C7.77602 14.0001 7.99988 13.7763 7.99988 13.5001C7.99988 13.224 7.77602 13.0001 7.49988 13.0001C7.22374 13.0001 6.99988 13.224 6.99988 13.5001C6.99988 13.7763 7.22374 14.0001 7.49988 14.0001ZM10.9999 13.5001C10.9999 13.7763 10.776 14.0001 10.4999 14.0001C10.2237 14.0001 9.99988 13.7763 9.99988 13.5001C9.99988 13.224 10.2237 13.0001 10.4999 13.0001C10.776 13.0001 10.9999 13.224 10.9999 13.5001ZM13.4999 14.0001C13.776 14.0001 13.9999 13.7763 13.9999 13.5001C13.9999 13.224 13.776 13.0001 13.4999 13.0001C13.2237 13.0001 12.9999 13.224 12.9999 13.5001C12.9999 13.7763 13.2237 14.0001 13.4999 14.0001ZM3.99988 5.00012C3.99988 4.44784 4.44759 4.00012 4.99988 4.00012H9.99988C10.5522 4.00012 10.9999 4.44784 10.9999 5.00012V10.0001C10.9999 10.5524 10.5522 11.0001 9.99988 11.0001H4.99988C4.44759 11.0001 3.99988 10.5524 3.99988 10.0001V5.00012ZM4.99988 5.00012H9.99988V10.0001H4.99988V5.00012Z"})})}function RulerHorizontalIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M0.5 4C0.223858 4 0 4.22386 0 4.5V10.5C0 10.7761 0.223858 11 0.5 11H14.5C14.7761 11 15 10.7761 15 10.5V4.5C15 4.22386 14.7761 4 14.5 4H0.5ZM1 10V5H2.075V7.5C2.075 7.73472 2.26528 7.925 2.5 7.925C2.73472 7.925 2.925 7.73472 2.925 7.5V5H4.075V6.5C4.075 6.73472 4.26528 6.925 4.5 6.925C4.73472 6.925 4.925 6.73472 4.925 6.5V5H6.075V6.5C6.075 6.73472 6.26528 6.925 6.5 6.925C6.73472 6.925 6.925 6.73472 6.925 6.5V5H8.075V7.5C8.075 7.73472 8.26528 7.925 8.5 7.925C8.73472 7.925 8.925 7.73472 8.925 7.5V5H10.075V6.5C10.075 6.73472 10.2653 6.925 10.5 6.925C10.7347 6.925 10.925 6.73472 10.925 6.5V5H12.075V6.5C12.075 6.73472 12.2653 6.925 12.5 6.925C12.7347 6.925 12.925 6.73472 12.925 6.5V5H14V10H1Z"})})}function TextAlignJustifyIcon({width:K="11px",height:_="11px",viewBox:Z="0 0 15 15",...te}){return jsxRuntimeExports.jsx("svg",{width:K,height:_,viewBox:Z,fill:"white",xmlns:"http://www.w3.org/2000/svg",...te,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M2.5 4C2.22386 4 2 4.22386 2 4.5C2 4.77614 2.22386 5 2.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H2.5ZM2 7.5C2 7.22386 2.22386 7 2.5 7H12.5C12.7761 7 13 7.22386 13 7.5C13 7.77614 12.7761 8 12.5 8H2.5C2.22386 8 2 7.77614 2 7.5ZM2 10.5C2 10.2239 2.22386 10 2.5 10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H2.5C2.22386 11 2 10.7761 2 10.5Z"})})}const perfS="_perfS_eu9ak_1",topRight="_top-right_eu9ak_21",topLeft="_top-left_eu9ak_31",bottomLeft="_bottom-left_eu9ak_35",toggle="_toggle_eu9ak_41",bottomRight="_bottom-right_eu9ak_45",minimal="_minimal_eu9ak_54",perfIContainer="_perfIContainer_eu9ak_58",perfI="_perfI_eu9ak_58",perfSmall="_perfSmall_eu9ak_94",perfB="_perfB_eu9ak_108",programHeader="_programHeader_eu9ak_120",graph="_graph_eu9ak_139",graphpc="_graphpc_eu9ak_156",active="_active_eu9ak_189",toggleVisible="_toggleVisible_eu9ak_198",programGeo="_programGeo_eu9ak_222",programTitle="_programTitle_eu9ak_228",containerScroll="_containerScroll_eu9ak_240",programsContainer="_programsContainer_eu9ak_246",programsUlHeader="_programsULHeader_eu9ak_250",programsUl="_programsUL_eu9ak_250",programConsole="_programConsole_eu9ak_307",toggleContainer="_toggleContainer_eu9ak_322",programsGeoLi="_programsGeoLi_eu9ak_343",styles$1={perfS,topRight,topLeft,bottomLeft,toggle,bottomRight,minimal,perfIContainer,perfI,perfSmall,perfB,programHeader,graph,graphpc,active,toggleVisible,programGeo,programTitle,containerScroll,programsContainer,programsUlHeader,programsUl,programConsole,toggleContainer,programsGeoLi},HtmlMinimal=reactExports.forwardRef(({portal:K,className:_,children:Z,name:te,...ne},ie)=>{const oe=useThree(ce=>ce.gl),se=reactExports.useRef(null),ae=reactExports.useRef(null),le=(K==null?void 0:K.current)!=null?K.current:oe.domElement.parentNode;return reactExports.useLayoutEffect(()=>{if(!se.current||!le)return;const ce=document.createElement("div"),fe=ae.current=createRoot$1(ce);return le.appendChild(ce),()=>{fe.unmount(),ae.current=null,le.removeChild(ce)}},[le]),reactExports.useLayoutEffect(()=>{const ce=ae.current;ce&&ce.render(jsxRuntimeExports.jsx("div",{ref:ie,className:_,children:Z}))}),jsxRuntimeExports.jsx("group",{name:te,...ne,ref:se})}),overLimitFps={value:0,fpsLimit:60,isOverLimit:0},average=K=>(K==null?void 0:K.reduce((_,Z)=>_+Z,0))/K.length;class GLPerf{constructor(_={}){ue(this,"names",[""]),ue(this,"finished",[]),ue(this,"gl"),ue(this,"extension"),ue(this,"query"),ue(this,"paused",!1),ue(this,"overClock",!1),ue(this,"queryHasResult",!1),ue(this,"queryCreated",!1),ue(this,"isWebGL2",!0),ue(this,"memAccums",[]),ue(this,"gpuAccums",[]),ue(this,"activeAccums",[]),ue(this,"logsAccums",{mem:[],gpu:[],cpu:[],fps:[],fpsFixed:[]}),ue(this,"fpsChart",[]),ue(this,"gpuChart",[]),ue(this,"cpuChart",[]),ue(this,"memChart",[]),ue(this,"paramLogger",()=>{}),ue(this,"glFinish",()=>{}),ue(this,"chartLogger",()=>{}),ue(this,"chartLen",60),ue(this,"logsPerSecond",10),ue(this,"maxMemory",1500),ue(this,"chartHz",10),ue(this,"startCpuProfiling",!1),ue(this,"lastCalculateFixed",0),ue(this,"chartFrame",0),ue(this,"gpuTimeProcess",0),ue(this,"chartTime",0),ue(this,"activeQueries",0),ue(this,"circularId",0),ue(this,"detected",0),ue(this,"frameId",0),ue(this,"rafId",0),ue(this,"idleCbId",0),ue(this,"checkQueryId",0),ue(this,"uuid"),ue(this,"currentCpu",0),ue(this,"currentMem",0),ue(this,"paramFrame",0),ue(this,"paramTime",0),ue(this,"now",()=>{}),ue(this,"t0",0),window.GLPerf=window.GLPerf||{},Object.assign(this,_),this.fpsChart=new Array(this.chartLen).fill(0),this.gpuChart=new Array(this.chartLen).fill(0),this.cpuChart=new Array(this.chartLen).fill(0),this.memChart=new Array(this.chartLen).fill(0),this.now=()=>window.performance&&window.performance.now?window.performance.now():Date.now(),this.initGpu(),this.is120hz()}initGpu(){this.uuid=MathUtils.generateUUID(),this.gl&&(this.isWebGL2=!0,this.extension||(this.extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")),this.extension===null&&(this.isWebGL2=!1))}is120hz(){let _=0;const Z=te=>{++_<20?this.rafId=window.requestAnimationFrame(Z):(this.detected=Math.ceil(1e3*_/(te-this.t0)/70),window.cancelAnimationFrame(this.rafId)),this.t0||(this.t0=te)};this.rafId=window.requestAnimationFrame(Z)}addUI(_){this.names.indexOf(_)===-1&&(this.names.push(_),this.gpuAccums.push(0),this.activeAccums.push(!1))}nextFps(_){const Z=16.666666666666668,te=Z-_.timeRemaining(),ne=Z*overLimitFps.fpsLimit/10/te;ne<0||(overLimitFps.value=ne,overLimitFps.isOverLimit<25?overLimitFps.isOverLimit++:setPerf({overclockingFps:!0}))}nextFrame(_){this.frameId++;const Z=_||this.now();let te=Z-this.paramTime,ne=0;if(this.frameId<=1)this.paramFrame=this.frameId,this.paramTime=Z;else if(Z>=this.paramTime){this.maxMemory=window.performance.memory?window.performance.memory.jsHeapSizeLimit/1048576:0;const ie=this.frameId-this.paramFrame,oe=ie*1e3/te,se=getPerf().overclockingFps?overLimitFps.value:oe;if(ne=this.isWebGL2?this.gpuAccums[0]:this.gpuAccums[0]/te,this.isWebGL2?this.gpuAccums[0]=0:Promise.all(this.finished).then(()=>{this.gpuAccums[0]=0,this.finished=[]}),this.currentMem=Math.round(window.performance&&window.performance.memory?window.performance.memory.usedJSHeapSize/1048576:0),window.performance&&this.startCpuProfiling){window.performance.mark("cpu-finished");const ae=performance.measure("cpu-duration","cpu-started","cpu-finished");this.currentCpu=(ae==null?void 0:ae.duration)||0,this.logsAccums.cpu.push(this.currentCpu),this.startCpuProfiling=!1}this.logsAccums.mem.push(this.currentMem),this.logsAccums.fpsFixed.push(oe),this.logsAccums.fps.push(se),this.logsAccums.gpu.push(ne),this.overClock&&typeof window.requestIdleCallback<"u"&&(overLimitFps.isOverLimit>0&&se>oe?overLimitFps.isOverLimit--:getPerf().overclockingFps&&setPerf({overclockingFps:!1})),Z>=this.paramTime+1e3/this.logsPerSecond&&(this.paramLogger({cpu:average(this.logsAccums.cpu),gpu:average(this.logsAccums.gpu),mem:average(this.logsAccums.mem),fps:average(this.logsAccums.fps),duration:Math.round(te),maxMemory:this.maxMemory,frameCount:ie}),this.logsAccums.mem=[],this.logsAccums.fps=[],this.logsAccums.gpu=[],this.logsAccums.cpu=[],this.paramFrame=this.frameId,this.paramTime=Z),this.overClock&&Z-this.lastCalculateFixed>=2*1e3&&(this.lastCalculateFixed=_,overLimitFps.fpsLimit=Math.round(average(this.logsAccums.fpsFixed)/10)*100,setPerf({fpsLimit:overLimitFps.fpsLimit/10}),this.logsAccums.fpsFixed=[],this.paramFrame=this.frameId,this.paramTime=Z)}if(!this.detected||!this.chartFrame)this.chartFrame=this.frameId,this.chartTime=Z,this.circularId=0;else{const ie=Z-this.chartTime;let oe=this.chartHz*ie/1e3;for(;--oe>0&&this.detected;){const se=(this.frameId-this.chartFrame)/ie*1e3,ae=getPerf().overclockingFps?overLimitFps.value:se;this.fpsChart[this.circularId%this.chartLen]=ae;const le=1e3/this.currentMem,ce=this.currentCpu,fe=(this.isWebGL2?this.gpuAccums[1]*2:Math.round(this.gpuAccums[1]/te*100))+4;fe>0&&(this.gpuChart[this.circularId%this.chartLen]=fe),ce>0&&(this.cpuChart[this.circularId%this.chartLen]=ce),le>0&&(this.memChart[this.circularId%this.chartLen]=le);for(let de=0;de<this.names.length;de++)this.chartLogger({i:de,data:{fps:this.fpsChart,gpu:this.gpuChart,cpu:this.cpuChart,mem:this.memChart},circularId:this.circularId});this.circularId++,this.chartFrame=this.frameId,this.chartTime=Z}}}startGpu(){const _=this.gl,Z=this.extension;if(!(!_||!Z)&&this.isWebGL2){let te=!1,ne,ie;if(this.query){this.queryHasResult=!1;let oe=this.query;if(te=_.getQueryParameter(oe,_.QUERY_RESULT_AVAILABLE),ne=_.getParameter(Z.GPU_DISJOINT_EXT),te&&!ne){ie=_.getQueryParameter(this.query,_.QUERY_RESULT);const se=ie*1e-6;(te||ne)&&(_.deleteQuery(this.query),oe=null),te&&se>0&&(ne||this.activeAccums.forEach((ae,le)=>{this.gpuAccums[le]=se}))}}(te||!this.query)&&(this.queryCreated=!0,this.query=_.createQuery(),_.beginQuery(Z.TIME_ELAPSED_EXT,this.query))}}endGpu(){const _=this.extension,Z=this.gl;this.isWebGL2&&this.queryCreated&&Z.getQuery(_.TIME_ELAPSED_EXT,Z.CURRENT_QUERY)&&Z.endQuery(_.TIME_ELAPSED_EXT)}begin(_){this.startGpu(),this.updateAccums(_)}end(_){this.endGpu(),this.updateAccums(_)}updateAccums(_){let Z=this.names.indexOf(_);Z===-1&&(Z=this.names.length,this.addUI(_));const te=this.now();this.activeAccums[Z]=!this.activeAccums[Z],this.t0=te}}const countGeoDrawCalls=K=>{K.forEach((_,Z)=>{const{meshes:te}=_;if(!te)return;let ne={total:0,type:"Triangle",data:[]};Object.keys(te).forEach(ie=>{const oe=te[ie],{geometry:se,material:ae}=oe;let le=se.index;const ce=se.attributes.position;if(!ce)return;let fe=1;ae.wireframe===!0&&(fe=0);const de=le!==null?le.count:ce.count,pe=se.drawRange.start*fe,he=se.drawRange.count*fe,ge=pe,me=Math.min(de,pe+he)-1;let Ae=1;const ye=oe.count||1;let ve="Triangle",_e=0;oe.isMesh?ae.wireframe===!0?(ve="Line",Ae=Ae/2):(ve="Triangle",Ae=Ae/3):oe.isLine?(ve="Line",oe.isLineSegments?Ae=Ae/2:oe.isLineLoop?Ae=Ae:Ae=Ae-1):oe.isPoints?(ve="Point",Ae=Ae):oe.isSprite&&(ve="Triangle",Ae=Ae/3);const Te=Math.round(Math.max(0,me-ge+1)*(Ae*ye));Te>_e&&(_e=Te,ne.type=ve),ne.total+=Te,ne.data.push({drawCount:Te,type:ve}),oe.userData.drawCount={type:ve,count:Te}}),_.drawCounts=ne})};var eventemitter3={exports:{}};(function(K){var _=Object.prototype.hasOwnProperty,Z="~";function te(){}Object.create&&(te.prototype=Object.create(null),new te().__proto__||(Z=!1));function ne(ae,le,ce){this.fn=ae,this.context=le,this.once=ce||!1}function ie(ae,le,ce,fe,de){if(typeof ce!="function")throw new TypeError("The listener must be a function");var pe=new ne(ce,fe||ae,de),he=Z?Z+le:le;return ae._events[he]?ae._events[he].fn?ae._events[he]=[ae._events[he],pe]:ae._events[he].push(pe):(ae._events[he]=pe,ae._eventsCount++),ae}function oe(ae,le){--ae._eventsCount===0?ae._events=new te:delete ae._events[le]}function se(){this._events=new te,this._eventsCount=0}se.prototype.eventNames=function(){var ae=[],le,ce;if(this._eventsCount===0)return ae;for(ce in le=this._events)_.call(le,ce)&&ae.push(Z?ce.slice(1):ce);return Object.getOwnPropertySymbols?ae.concat(Object.getOwnPropertySymbols(le)):ae},se.prototype.listeners=function(ae){var le=Z?Z+ae:ae,ce=this._events[le];if(!ce)return[];if(ce.fn)return[ce.fn];for(var fe=0,de=ce.length,pe=new Array(de);fe<de;fe++)pe[fe]=ce[fe].fn;return pe},se.prototype.listenerCount=function(ae){var le=Z?Z+ae:ae,ce=this._events[le];return ce?ce.fn?1:ce.length:0},se.prototype.emit=function(ae,le,ce,fe,de,pe){var he=Z?Z+ae:ae;if(!this._events[he])return!1;var ge=this._events[he],me=arguments.length,Ae,ye;if(ge.fn){switch(ge.once&&this.removeListener(ae,ge.fn,void 0,!0),me){case 1:return ge.fn.call(ge.context),!0;case 2:return ge.fn.call(ge.context,le),!0;case 3:return ge.fn.call(ge.context,le,ce),!0;case 4:return ge.fn.call(ge.context,le,ce,fe),!0;case 5:return ge.fn.call(ge.context,le,ce,fe,de),!0;case 6:return ge.fn.call(ge.context,le,ce,fe,de,pe),!0}for(ye=1,Ae=new Array(me-1);ye<me;ye++)Ae[ye-1]=arguments[ye];ge.fn.apply(ge.context,Ae)}else{var ve=ge.length,_e;for(ye=0;ye<ve;ye++)switch(ge[ye].once&&this.removeListener(ae,ge[ye].fn,void 0,!0),me){case 1:ge[ye].fn.call(ge[ye].context);break;case 2:ge[ye].fn.call(ge[ye].context,le);break;case 3:ge[ye].fn.call(ge[ye].context,le,ce);break;case 4:ge[ye].fn.call(ge[ye].context,le,ce,fe);break;default:if(!Ae)for(_e=1,Ae=new Array(me-1);_e<me;_e++)Ae[_e-1]=arguments[_e];ge[ye].fn.apply(ge[ye].context,Ae)}}return!0},se.prototype.on=function(ae,le,ce){return ie(this,ae,le,ce,!1)},se.prototype.once=function(ae,le,ce){return ie(this,ae,le,ce,!0)},se.prototype.removeListener=function(ae,le,ce,fe){var de=Z?Z+ae:ae;if(!this._events[de])return this;if(!le)return oe(this,de),this;var pe=this._events[de];if(pe.fn)pe.fn===le&&(!fe||pe.once)&&(!ce||pe.context===ce)&&oe(this,de);else{for(var he=0,ge=[],me=pe.length;he<me;he++)(pe[he].fn!==le||fe&&!pe[he].once||ce&&pe[he].context!==ce)&&ge.push(pe[he]);ge.length?this._events[de]=ge.length===1?ge[0]:ge:oe(this,de)}return this},se.prototype.removeAllListeners=function(ae){var le;return ae?(le=Z?Z+ae:ae,this._events[le]&&oe(this,le)):(this._events=new te,this._eventsCount=0),this},se.prototype.off=se.prototype.removeListener,se.prototype.addListener=se.prototype.on,se.prefixed=Z,se.EventEmitter=se,K.exports=se})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter$1=getDefaultExportFromCjs(eventemitter3Exports),eventEmitter=new EventEmitter$1;function onEvent(K,_,Z){return eventEmitter.on(K,_)}function offEvent(K,_,Z){var te;eventEmitter.removeListener(K,_,(te=Z==null?void 0:Z.context)!=null?te:null,Z==null?void 0:Z.once)}function emitEvent(K,_){eventEmitter.emit(K,_)}function useEvent(K,_,Z=[],te){const ne=reactExports.useRef(_);reactExports.useEffect(()=>void(ne.current=_),[_]),reactExports.useEffect(()=>{const ie=se=>{var ae;return(ae=ne.current)==null?void 0:ae.call(ne,se)},oe=onEvent(K,ie);return()=>offEvent(K,ie,{...te,context:oe})},[K,void 0,...Z])}const updateMatrixWorldTemp=Object3D.prototype.updateMatrixWorld,updateWorldMatrixTemp=Object3D.prototype.updateWorldMatrix,updateMatrixTemp=Object3D.prototype.updateMatrix,maxGl=["calls","triangles","points","lines"],maxLog=["gpu","cpu","mem","fps"];let matriceWorldCount={value:0},matriceCount={value:0};const isUUID=K=>{let _=""+K;return _=_.match("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"),_!==null},addMuiPerfID=(K,_)=>{K.defines||(K.defines={}),K.defines&&!K.defines.muiPerf&&(K.defines=Object.assign(K.defines||{},{muiPerf:K.uuid}));const Z=K.uuid;return _[Z]||(_[Z]={meshes:{},material:K},K.needsUpdate=!0),K.needsUpdate=!1,Z},getMUIIndex=K=>K==="muiPerf",PerfHeadless=({overClock:K,logsPerSecond:_,chart:Z,deepAnalyze:te,matrixUpdate:ne})=>{const{gl:ie,scene:oe}=useThree();setPerf({gl:ie,scene:oe});const se=reactExports.useMemo(()=>{const ae=new GLPerf({trackGPU:!0,overClock:K,chartLen:Z?Z.length:120,chartHz:Z?Z.hz:60,logsPerSecond:_||10,gl:ie.getContext(),chartLogger:me=>{setPerf({chart:me})},paramLogger:me=>{const Ae={maxMemory:me.maxMemory,gpu:me.gpu,cpu:me.cpu,mem:me.mem,fps:me.fps,totalTime:me.duration,frameCount:me.frameCount};setPerf({log:Ae});const{accumulated:ye}=getPerf(),ve=ie.info.render;ye.totalFrames++,ye.gl.calls+=ve.calls,ye.gl.triangles+=ve.triangles,ye.gl.points+=ve.points,ye.gl.lines+=ve.lines,ye.log.gpu+=me.gpu,ye.log.cpu+=me.cpu,ye.log.mem+=me.mem,ye.log.fps+=me.fps;for(let _e=0;_e<maxGl.length;_e++){const Te=maxGl[_e],be=ve[Te];be>ye.max.gl[Te]&&(ye.max.gl[Te]=be)}for(let _e=0;_e<maxLog.length;_e++){const Te=maxLog[_e],be=me[Te];be>ye.max.log[Te]&&(ye.max.log[Te]=be)}setPerf({accumulated:ye}),emitEvent("log",[Ae,ie])}}),le=ie.getContext();let ce=null,fe=null;const de=le.getExtension("WEBGL_debug_renderer_info"),pe=le.getParameter(le.VERSION);de!=null&&(ce=le.getParameter(de.UNMASKED_RENDERER_WEBGL),fe=le.getParameter(de.UNMASKED_VENDOR_WEBGL)),fe||(fe="Unknown vendor"),ce||(ce=le.getParameter(le.RENDERER)),setPerf({startTime:window.performance.now(),infos:{version:pe,renderer:ce,vendor:fe}});const he=new Map,ge=new Map;return Object.defineProperty(Scene$1.prototype,"onBeforeRender",{get(){return(...me)=>{var Ae;ae&&ae.begin("profiler"),(Ae=he.get(this))==null||Ae(...me)}},set(me){he.set(this,me)},configurable:!0}),Object.defineProperty(Scene$1.prototype,"onAfterRender",{get(){return(...me)=>{var Ae;ae&&ae.end("profiler"),(Ae=ge.get(this))==null||Ae(...me)}},set(me){ge.set(this,me)},configurable:!0}),ae},[]);return reactExports.useEffect(()=>{se&&(se.overClock=K||!1,K===!1&&(setPerf({overclockingFps:!1}),overLimitFps.value=0,overLimitFps.isOverLimit=0),se.chartHz=(Z==null?void 0:Z.hz)||60,se.chartLen=(Z==null?void 0:Z.length)||120)},[K,se,Z==null?void 0:Z.length,Z==null?void 0:Z.hz]),reactExports.useEffect(()=>{ne&&(Object3D.prototype.updateMatrixWorld=function(){(this.matrixWorldNeedsUpdate||arguments[0])&&matriceWorldCount.value++,updateMatrixWorldTemp.apply(this,arguments)},Object3D.prototype.updateWorldMatrix=function(){matriceWorldCount.value++,updateWorldMatrixTemp.apply(this,arguments)},Object3D.prototype.updateMatrix=function(){matriceCount.value++,updateMatrixTemp.apply(this,arguments)}),ie.info.autoReset=!1;let ae=null,le=null;if(ie.info)return ae=addEffect(function(){getPerf().paused&&setPerf({paused:!1}),window.performance&&(window.performance.mark("cpu-started"),se.startCpuProfiling=!0),matriceCount.value-=1,matriceWorldCount.value=0,matriceCount.value=0,ie.info&&ie.info.reset()}),le=addAfterEffect(function(){var ce,fe;if(se&&!se.paused&&(se.nextFrame(window.performance.now()),K&&typeof window.requestIdleCallback<"u"&&(se.idleCbId=requestIdleCallback(se.nextFps))),te){const de={},pe=new Map;oe.traverse(function(he){if((he instanceof Mesh||he instanceof Points$1)&&he.material){let ge=he.material.uuid;Array.isArray(he.material)&&he.material.length>1?ge=addMuiPerfID(he.material[1],de):ge=addMuiPerfID(he.material,de),de[ge].meshes[he.uuid]=he}}),(fe=(ce=ie==null?void 0:ie.info)==null?void 0:ce.programs)==null||fe.forEach(he=>{const ge=he.cacheKey.split(","),me=ge[ge.findIndex(getMUIIndex)+1];if(isUUID(me)&&de[me]){const{material:Ae,meshes:ye}=de[me],ve={program:he,material:Ae,meshes:ye,drawCounts:{total:0,type:"triangle",data:[]},expand:!1,visible:!0};pe.set(me,ve)}}),pe.size!==getPerf().programs.size&&(countGeoDrawCalls(pe),setPerf({programs:pe,triggerProgramsUpdate:getPerf().triggerProgramsUpdate++}))}}),()=>{se&&(typeof window.cancelIdleCallback<"u"&&window.cancelIdleCallback(se.idleCbId),window.cancelAnimationFrame(se.rafId),window.cancelAnimationFrame(se.checkQueryId)),ne&&(Object3D.prototype.updateMatrixWorld=updateMatrixTemp),ae(),le()}},[se,ie,Z,ne]),reactExports.useEffect(()=>{const ae=addTail(function(){return se&&(se.paused=!0,matriceCount.value=0,matriceWorldCount.value=0,setPerf({paused:!0,log:{maxMemory:0,gpu:0,mem:0,cpu:0,fps:0,totalTime:0,frameCount:0}})),!1});return()=>{ae()}},[]),null};function estimateBytesUsed(K){let _=0;for(let te in K.attributes){const ne=K.getAttribute(te);_+=ne.count*ne.itemSize*ne.array.BYTES_PER_ELEMENT}const Z=K.getIndex();return _+=Z?Z.count*Z.itemSize*Z.array.BYTES_PER_ELEMENT:0,_}const addTextureUniforms=(K,_)=>{const Z=ne=>{switch(ne){case 1e3:return"RepeatWrapping";case 1001:return"ClampToEdgeWrapping";case 1002:return"MirroredRepeatWrapping";default:return"ClampToEdgeWrapping"}},te=ne=>{switch(ne){case 3e3:return"LinearEncoding";case 3001:return"sRGBEncoding";case 3002:return"RGBEEncoding";case 3003:return"LogLuvEncoding";case 3004:return"RGBM7Encoding";case 3005:return"RGBM16Encoding";case 3006:return"RGBDEncoding";case 3007:return"GammaEncoding";default:return"ClampToEdgeWrapping"}};return{name:K,url:_.image.currentSrc,encoding:te(_.encoding),wrapT:Z(_.wrapT),flipY:_.flipY.toString()}},UniformsGL=({program:K,material:_,setTexNumber:Z})=>{const te=usePerf(oe=>oe.gl),[ne,ie]=reactExports.useState(null);return reactExports.useEffect(()=>{if(te){const oe=K==null?void 0:K.getUniforms();let se=0;const ae=new Map;oe.seq.forEach(le=>{if(!le.id.includes("uTroika")&&le.id!=="isOrthographic"&&le.id!=="uvTransform"&&le.id!=="lightProbe"&&le.id!=="projectionMatrix"&&le.id!=="viewMatrix"&&le.id!=="normalMatrix"&&le.id!=="modelMatrix"&&le.id!=="modelViewMatrix"){let ce=[],fe={name:le.id};le.cache&&(le.cache.forEach(de=>{typeof de<"u"&&ce.push(de.toString().substring(0,4))}),fe.value=ce.join(),_[le.id]&&_[le.id].image&&_[le.id].image&&(se++,fe.value=addTextureUniforms(le.id,_[le.id])),fe.value||(fe.value="empty"),ae.set(le.id,fe))}}),_.uniforms&&Object.keys(_.uniforms).forEach(le=>{const ce=_.uniforms[le];if(ce.value){const{value:fe}=ce;let de={name:le};if(le.includes("uTroika"))return;if(fe.isTexture)se++,de.value=addTextureUniforms(le,fe);else{let pe=JSON.stringify(fe);try{pe=JSON.stringify(fe)}catch{pe=fe.toString()}de.value=pe}ae.set(le,de)}}),se>0&&Z(se),ie(ae)}},[]),jsxRuntimeExports.jsx("div",{className:styles$1.programsUL,children:ne&&Array.from(ne.values()).map(oe=>jsxRuntimeExports.jsx("span",{children:typeof oe.value=="string"?jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("span",{children:[oe.name," :"," ",jsxRuntimeExports.jsxs("b",{children:[oe.value.substring(0,30),oe.value.length>30?"...":""]})]})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("b",{children:[oe.value.name,":"]})}),jsxRuntimeExports.jsxs("div",{children:[Object.keys(oe.value).map(se=>se!=="name"?jsxRuntimeExports.jsx("div",{children:se==="url"?jsxRuntimeExports.jsx("a",{href:oe.value[se],target:"_blank",children:jsxRuntimeExports.jsx("img",{src:oe.value[se]})}):jsxRuntimeExports.jsxs("li",{children:[se,": ",jsxRuntimeExports.jsx("b",{children:oe.value[se]})]})},se):null),jsxRuntimeExports.jsxs("button",{className:styles$1.programConsole,onClick:()=>{var se;console.info(_[oe.value.name]||((se=_==null?void 0:_.uniforms[oe.value.name])==null?void 0:se.value))},children:["console.info(",oe.value.name,");"]})]})]})},oe.name))})},DynamicDrawCallInfo=({el:K})=>{usePerf(te=>te.log);const _=usePerf(te=>te.gl),Z=te=>{if(!_)return 0;const ne=Math.round(te.drawCounts.total/(_.info.render.triangles+_.info.render.lines+_.info.render.points)*100*10)/10;return isFinite(ne)&&ne||0};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K.drawCounts.total>0&&jsxRuntimeExports.jsxs("div",{className:styles$1.perfS,style:{height:"auto",width:"auto",margin:"0 4px"},children:[K.drawCounts.type==="Triangle"?jsxRuntimeExports.jsx(VercelLogoIcon,{style:{top:"-1px"}}):jsxRuntimeExports.jsx(ActivityLogIcon,{style:{top:"-1px"}}),K.drawCounts.total,jsxRuntimeExports.jsxs("small",{children:[K.drawCounts.type,"s"]}),_&&jsxRuntimeExports.jsxs("span",{className:styles$1.perfB,style:{bottom:"-10px",width:"40px",fontWeight:"bold"},children:[K.visible&&!K.material.wireframe?Z(K):0,"%"]})]})})},ProgramUI=({el:K})=>{const[_,Z]=reactExports.useState(K.visible),[te,ne]=reactExports.useState(K.expand),[ie,oe]=reactExports.useState(0),{meshes:se,program:ae,material:le}=K;return jsxRuntimeExports.jsxs("div",{className:styles$1.programGeo,children:[jsxRuntimeExports.jsxs("div",{className:styles$1.programHeader,onClick:()=>{K.expand=!te,Object.keys(se).forEach(ce=>{const fe=se[ce];fe.material.wireframe=!1}),ne(!te)},children:[jsxRuntimeExports.jsx("div",{className:styles$1.toggle,style:{marginRight:"6px"},children:te?jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(TriangleDownIcon,{})}):jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(TriangleUpIcon,{})})}),ae&&jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("span",{className:styles$1.programTitle,children:ae.name}),jsxRuntimeExports.jsxs("div",{className:styles$1.perfS,style:{height:"auto",width:"auto",margin:"0 4px"},children:[jsxRuntimeExports.jsx(LayersIcon,{style:{top:"-1px"}}),Object.keys(se).length,jsxRuntimeExports.jsx("small",{children:Object.keys(se).length>1?"users":"user"})]}),ie>0&&jsxRuntimeExports.jsxs("div",{className:styles$1.perfS,style:{height:"auto",width:"auto",margin:"0 4px"},children:[ie>1?jsxRuntimeExports.jsx(ImageIcon,{style:{top:"-1px"}}):jsxRuntimeExports.jsx(ImageIcon,{style:{top:"-1px"}}),ie,jsxRuntimeExports.jsx("small",{children:"tex"})]}),jsxRuntimeExports.jsx(DynamicDrawCallInfo,{el:K}),le.glslVersion==="300 es"&&jsxRuntimeExports.jsxs("div",{className:styles$1.perfS,style:{height:"auto",width:"auto",margin:"0 4px"},children:[jsxRuntimeExports.jsx(RocketIcon,{style:{top:"-1px"}}),"300",jsxRuntimeExports.jsx("small",{children:"es"}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,style:{bottom:"-10px",width:"40px"},children:"glsl"})]})]}),jsxRuntimeExports.jsx("div",{className:styles$1.toggle,onPointerEnter:()=>{Object.keys(se).forEach(ce=>{const fe=se[ce];fe.material.wireframe=!0})},onPointerLeave:()=>{Object.keys(se).forEach(ce=>{const fe=se[ce];fe.material.wireframe=!1})},onClick:ce=>{ce.stopPropagation(),Object.keys(se).forEach(fe=>{const de=se[fe],pe=!_;de.visible=pe,K.visible=pe,Z(pe)})},children:_?jsxRuntimeExports.jsx(EyeOpenIcon,{}):jsxRuntimeExports.jsx(EyeNoneIcon,{})})]}),jsxRuntimeExports.jsxs("div",{style:{maxHeight:te?"9999px":0,overflow:"hidden"},children:[jsxRuntimeExports.jsxs("div",{className:styles$1.programsULHeader,children:[jsxRuntimeExports.jsx(ButtonIcon,{})," Uniforms:"]}),jsxRuntimeExports.jsx(UniformsGL,{program:ae,material:le,setTexNumber:oe}),jsxRuntimeExports.jsxs("div",{className:styles$1.programsULHeader,children:[jsxRuntimeExports.jsx(CubeIcon,{})," Geometries:"]}),jsxRuntimeExports.jsx("div",{className:styles$1.programsUL,children:se&&Object.keys(se).map(ce=>se[ce]&&se[ce].geometry&&jsxRuntimeExports.jsxs("li",{className:styles$1.programsGeoLi,children:[jsxRuntimeExports.jsxs("span",{children:[se[ce].geometry.type,": "]}),se[ce].userData&&se[ce].userData.drawCount&&jsxRuntimeExports.jsxs("b",{children:[jsxRuntimeExports.jsxs("div",{children:[se[ce].userData.drawCount.count,jsxRuntimeExports.jsxs("small",{children:[" ",se[ce].userData.drawCount.type,"s"]})]}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsxs("div",{children:[Math.round(estimateBytesUsed(se[ce].geometry)/1024*1e3)/1e3,"Kb",jsxRuntimeExports.jsx("small",{children:" memory used"})]})]})]},ce))}),jsxRuntimeExports.jsxs("button",{className:styles$1.programConsole,onClick:()=>{console.info(le)},children:["console.info(",le.type,")"]})]})]})},ProgramsUI=()=>{usePerf(_=>_.triggerProgramsUpdate);const K=usePerf(_=>_.programs);return jsxRuntimeExports.jsx("div",{className:styles$1.programsContainer,children:K&&Array.from(K.values()).map(_=>_&&_?jsxRuntimeExports.jsx(ProgramUI,{el:_},_.material.uuid):null)})},localFont="data:font/woff;base64,d09GRk9UVE8AAC6gAA0AAAAAQzgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABDRkYgAAAFIAAAIfMAAChRZFKn5EZGVE0AAC1EAAAAHAAAAByCRgjeR0RFRgAAJxQAAAArAAAANACwACRHUE9TAAAn9AAABU8AAA+MgotnaUdTVUIAACdAAAAAsQAAAWRlFnIQT1MvMgAAAZAAAABUAAAAYJf2spxjbWFwAAAEcAAAAJkAAAFCnGFvpGhlYWQAAAEwAAAANgAAADYNzYU0aGhlYQAAAWgAAAAgAAAAJA8QBSlobXR4AAAtYAAAAT8AAAGAjJsgS21heHAAAAGIAAAABgAAAAYAYFAAbmFtZQAAAeQAAAKJAAAFH4LLI15wb3N0AAAFDAAAABMAAAAg/20AZAABAAAAAiMSbAClT18PPPUACwgAAAAAAMTwES4AAAAA4yMHK/+1/jEG5QabAAAACAACAAAAAAAAeJxjYGRg4Cj+u5aBgV3j/9b/n9meMgBFUEACAKj9B0gAAFAAAGAAAHicY2BmUWT8wsDKwMI6i9WYgYFRHkIzX2RIY2JgYABhCHjAwPQ/gEEhGshUAPHd/f3dGRyA7Do2hn9APkcxU7ACA+N8kByLFesGoIwCAxMAY8AM0niclZS/TttQFMY/O5CIkiAQZUFVdSdUIWKTMEQCtWoUIYQEDKHqhKoa+5JYGN/IdojoC3Tt0k4dO1V9gj5Cxy59g459gg797BxCoHRoLF//7vlzz/E5xwHw2IphYfxz8VrYQg1fhG1U8E24RPkv4RmsWE+EZ7FsnQmXUbM+CFegrJ/CcyjbK8LzeGA3hatYtrVwDY79Q3gB66UT4UWUS++Fl8ifmYk1M8fdqyKrnC2s4p2wTe+vwiXKvwvPYB2/hWexZj0TLmPVeiNcwXPrk/AcqnZFeB4P7UfCVazZT4VrOLGvhBfwolQWXkS19FZ4ifwRHRgMcIUEIXroI4NCE5to8FLYo9ZQHkFzt48YPhxSm5KIz+7EKy12mk/Nsy65BrRExwyukrDXz1Rzs9FQe8b0Iq32Y99R7ShS3VyVqq5OdXKpAzp0Ge+Ud8Zb4bA4J8QQF1SZU5MZdaiDcJhvqetRE8FjRHR1bxh5yf+d8C9L9dfp055qEutl8bYpvQxrk1fOYd220MLOpI4tmukkDU2smk5jq7WTl6J1O3r9vjzr9+cZFrX2eGeM7dFL0yfP8pwyg7M7fXMm2Yep8lSWeIG+8JJzZc6kH7SYdsBYijun+OSLa6XjG3KHrU+KhDKuXlGCcbJ5WfKhyMuCTj8J0yz0YsVEdJKlhsIDevi0i4uRCeg5JAeFZ/5q/WLk2hxOj3bj3W2fDUrua8AmDw99Hac6UMM40InK+lq1B57Ph2g21E1PaJ9PcMZQ2/y/cTEqLoeBb4I7DJCwFi6rMZ1ESskBv4wOdnGEY6716yT6WTbYdt3RaOR4RXDHJD03GieQugf7nd2j4916kcB0i6VduD0TMgx/AIq26g8AAAB4nGNgYGBmgGAZBkYGELAB8hjBfBYGBSDNAoQgft3//0BS4f///w+hKhkY2RhgTJyAkYmZhZWNnYOTi5uHl49fQFBIWERUTFxCUkpaRlZOXkFRSVlFVU1dQ1NLW0dXT9/A0MjYxNTM3MLSytrG1s7ewdHJ2cXVzd3D08vbx9fPPyAwKDgkNCw8IjIqOiY2Lp6A7bQHAPlYGQAAAAB4nGNgZgCD/1kMKQxYAAAqHwHRAHiclXoHXFRX0/ddYXcvllVYF42uig07dkWpoiIWkKYodekKKEhbrPjkMWKcmKDJEyxBsSIgRUS6xqgIYsOuiA01diOJZu7uWfi+uWie8v7e7/u973KWPew9Zc7/zPxn5hwknLExJ5FIFJ6xIbGJsaNcw8OWJi3jJB04Ceci9OYEtUTo00HoayT0MGb+nY1+62zctyNnvGloP4B/VjrLHQ2hatkztWyXVM1d6armuG5qybemas5KPeShGWcsjtaZs+HcuYBxVmPHT7axGDdm7OTpsXEr45dGLkkU/xprMSs2NjIm3GL28lAri2kxMRae4qMEC8/whPD45PAwq08SWnySkL6OTIoJjv+PLzl6SbgOnBFnzEk5GSfnlnAmXEeuE03ehVNwXblunClnxim57pyKM+d6cD25L7heXG9OzfXh+nL9OAuuPzeAG8gN4gZzltwQbig3jBvOjeBGcqM4K240N4Yby43jxnMTuIncJG4yZ81N4abSwmw5O86ec+AcuTWcEzedm8HN5Jy5WZwLN5ubw83l5nGunBs3nwDw4Dw5L86bW8At5Hy4Rdxizpfz4/y5AC6QC+I0IlKDaOKvuArJqA5Ko+HGQ4znGVdLR0lXSfdKG6UtMmOZWlYmeyjX8GP5BBMTk59NnnZ83Wl/p986L+m8uXNe58tdtnX9ouv8rn9222FqZupgGmlmYjbVzNss1+yZ0li5WLmlu3P3fNUKVbN5hfnDHtY9gnvs6XG9p1HPET0Deqb0PNSzrufdnvjFuV6Ler3tnaruro7oM6LPyj63+wb23dm3pJ9jv20WIyxO9p/ff+sAvwE5AyUDBw8MGvj9wAeD5IO0g7YO5gdvYaHQoqtrkbS0CIYWoxZzXZ3+h9Y6WUublUpXJxha6+SK1nBFq/1a3KE2rtCa4UA8zDZjuPIR1eQqiMhYtj9+f3x+ahmUQX7G/gP7D2TkQBGvbICjqXnxB+IPRGVoQANRqfHxfHx8ajSE89vUUjvVvrYMDIf9+gypwnBBv0nIMnuPTswJ++GkT5/KrPf6TSrsB1LlKYuOyk34iyHr05/pFh0Vu7OSBSsch5dwvDBBK3ktWKlwNTgYrNAWbtOTxPa6TXv9OwAcx1ZADbX+kurjWRhI7woTmA3YGSawJPhX/SAAG49p4MEusR0gFaaZi50Sxb+lilW4SH9fGG/2G6ax+ZiGxjRSP5yA3TFN+eo3Yb4KWM+C/tdsrtm0+GPPNTxbiOPRR45dt78uabjacLXgV0Ap1H7588ryleUrjkXlR+WH5Pge8j3kcnhSLj8p1y0/soBX3oosWFUBNXAxs7qwoLDgxE8X4CKcSDjqd9RvtwtM5nGjDLBH9Md59+fdH1vF+J94jGMT2HI5k68brXGZ4TJj6RhgRsAm32XdcLR1ZfzF2IfLHi6rjSqMKIzIDABPHtxS/EIjQiM8VjqAPbjtC67gla+CK5IvwkNegQe1OEjogZa0wYMFc7SUvEN7zEW7B+0f9kbv9M9UYHXYsca7xvtW3DN4Dreyz9Ar+zo089fl8GvsTa8zXmccDlvBaJi23NPL0yt2Oozn0d5edVMOlRnFBw4fOJy/4zgchyNrDy4/uHx7BATwTnLwXRceHxsfu3RNCARD1M4V2Suy1xVBBX+xbbgKTafr/NTG8cz0upRtbtujgjHZTme9znrdjn0BLz6LcEgU4ZocXi6/5XHa47RT9hgYC9NiPbw9vJc7wTgSwU4UoXp78cHsg9lHdpRAiShC7MFYEsGfd5TD4nXhCbEJsVFrNRACS3auOLziMIlQzivuanEhG5WslkrQx+wxaUBXTMFajKzASGXpY6EPbX7XsiGPHR47oDwcB4FYuhX/cZdXLr8/HAuAReFW6UOUH8chgLN4FimDYdpxITY8y8dH765Lr548cTKXfnaehjp4vvTOrPOzzk/M6w/MBEYtdZ7tPHvJWGAyHvwz/PYu3ru42O3sDMbZT58V4cVHeK10BRdeWYpp36vg7rGGe3V87l68ZugkneFtHzcFnMAjS3Oc1xxPOg2XeaXVB52fCqp3HMvOy847uquSLLdw7eG4w3E7yDrBM9k/JIKPiWdGDlLnR0uvwhle0WaiTxe2m91HV+aK45VZ9/XpKhwvWuZBoTegKXMFMuMdZAkrjLC78JTAmJLFRpSwvlTqmOIe60Dlkf3TIL4Ke0sHPbDBLp44jkosugAG8t88lqajxxG0qUFLKrexw8trvB8OkI4LmuRgwyRU3JhpCOtLJZlZArPiFYatggRTjI6xJlUV6y19Vvq48QFKqdShaQn2pbIHBwAO5TfflW7EfgnYW4PmVNywo80Hmw/WNyeV8H5MnRsrfTX6Out6ko2kcoDZAXPlE+XANMvZHA82nooN6zjEnlewRrW0SGsmSHEWs8ZhyqxD+nIV1oxnoewAWg5GZ8xDF1aCgz8yf9yN9U8WoCM7weQE0078nc0ivLJ2sjfsNJpIFWOF2xgvERbieqMrwm2VYGaYieuFmUI3jDd0E4ax9YZhBjOZonUvaxJqJWiOy42y2bcq7GEnPV1Rfq7gWsG1zKvfXOO/wekslljLQ7rZf0PA2sC1gXE+YW6EzhkhExdJrgl7ja4JmSphLy4y7KXxhqzHPRLsjYVG9KuLqn9HhWGKuCzJFmaqQi8Qrqplo5gX7ScpvP45+kg+4EZhCaYZfRBeqLawoBI26t7AewOxow+OBZwA2OmXux/vfjyG4wDDeUyXf41BoTjKrsWuhXU+ycYDmwiss4/dALsBYYx0mNpsZPtU+EC+BbvveVlUW1R7LrcRmqA2pmhu0dzdQ4D14dl9+desh3Z4hGuEq8cyO5gK84+EXw6/nPIeUM0rssgOj2sltKiNRmirz1OhDhWgZrG4EYAexYDhIguXKoCWcJ2W0IRpQhgtoUn0KGkyeLD3UmlVaVXd/ka4BKeSizXFmt1e4AwL1/oso5/Fs2fa8YaVhoPAbPSR5DEWtloDCoKp9MX7K89K7pXc23MbbpDeh7ybcm3KNWZUwPrDMJigdQxzDPP0Dp3Bh85ItiG+ETEUlqG34Eak0UhCBBFxrMCNyg+NQi8ykm7lQ586PnVEeQRaAFoCmhQ/u/PsTvkfxPDQlHw1+FzwufmlNof4S4d/KTtewyuF4zV76sgfoHnIe+sb1jeYvIgNhvFgs3LG0hlLvf1C3ULdUmaBIy+usi6r6vjR40d/2X0RbsHplMLwwvDd3rTK6cneQeFB4e4pjpt5NpR540DZU7iSXB7CKz+Uh+xzJ5/gkOShCdWEztc6iuSxR3NMcyz5Z7ggIo930Edvp5XoZhCgPwsxqm1sqM6ENPAO+U2gp7Pptw+j33o79h1IDSZtdir8P8KNzDwwfGhXK+EBLsJSjJCgClOFWBoHVcSg21i3qqFPHJ44YIdw/AJwGOFR9ujJoyelaEJ2DDg8DDvZP7V/alHG+gE/CRxSXML4Y/heuENTRrTuA9vWeFzoJy3MP7I3NyM3o2hrGelV/YoKnwqffc4wDkYnOwUvDF7oGecIvAssyAw5GnJ0xS9fXhM3apHwlKQ6iQESNKGdisevjNBEqKVdcipn/Z9ZPLPATgtwMGB/QFlF8/Pm52XYqV2sgRFoMu3Xab8OLmcq4FkXGBJiN2UnflH9e9ONphsoKUL1Fj4HA+JlbC2wWdNZNzZYfM9j/sC+p61iJuSVsk4cOVaWU5ZTvfMUXIMzsaXepd5Z5DdhfPKM4AXBCzzjpgM/HdzzAi8EXkh8BMi124HxW9LvBvpQ6b4Cw101U+L3IBBTEXq92776ZMdCHPoILqSDf9BkEbS6oWSDkRS2/P6H0J9WqCwd3OzY7Ih8uLhA8lzyouZbzbdKWwC7w53kqyF1IXUe1Q4FfH3eibKiM7zyTdGZzHoSE7uFvrW5YXODcYWsDzA1MC7SxsnGKXQYKTfM2D2v0Isv9KoOqo92jPLwC3HlQ1yTZ4Idr/wd0zJUcCOr5njZ8bKze6+JS04qDSoN2usO02Ga1iOEXh7JTsA7gWdWcCkfXJp8Fq7RzEd0A1RwOfNUYXFhcfWe83AeqrVFIUUhmQthHrisXBgZFhm2WOsKvCss3hNZzEcWrzxFXk/xFQbgUfQU/iRWfIEbhEjijhd6f1q95VHW8fbY22Nbgmi1KIFXpU2Pv2QWmoH2LvYurMNSNvBrfgkLOCzD1C048yp2wr7i+xz6A+7ir8gB52pwyESUUGH8aTYERoF10gzNDI23W5hdmF3KBBjB44ZtKniSdeN4zfGa09lX4SqcjSqbUzZn7wSw4EfKE32jwjSxmtjAtb4wE7yyg88En0m+Cb/yitYZxNhCo8ja5iJrm7eztu6ZMYRtj6H4Or4gtRTKoWD7AXpl5MJRKE7NjT8Yf3DJ9kDgA2HpuvgV8StSYyCMxlqjo4HMUIKFbBMuV2ZV/E9cCv/ZpyhP1auNz6r+F/Pyf03MPPXNWkm9kK/S3TWQMacZmjFRaMYUqrbeNfBSxSQUaIMSMFCCg1FQ6X7HgNbfZZhgTLVAqinYFHEICjGmqHQfBB5wQav4wf4utDGtoY2tkSpYairu0H1MRhcMMqvFtBzMZj+iluJ15Z+1+rvt1H86s6wgryCv4qezUAvlq3OjcqN2+ZHm+K8LigtZFRcSNGceP2dekEfSwqSF62eKMaNW9s3rfTfKTvDYFbtI3384+aeoJKiIeOV4xfHKgHzWC5g5DFhq68zbOodabWYdeaUeD7aFUXb043+bHf17asRTpLsuPoGPT6DciJAS3hoW40iy4gAMwQHMAq11zjiaNHeYWQtOV0vVOEb5XYsQrdrAFh1itvWsfx1T/zoQu0wXi+UStANeOf8qNPzQsKth1+mskkNk1H2kmsRFK93W8cpCt3XuG7yA9QXG54yoG1E3/WkA8lRSsO/3OHErjjuC/c9hNypNL99f5N9fRPkRcka4lHz9nI+sB5Uq5r6ebU5jfOLIIKcgJ6/IWUSt4Ze2Y0/+Z6FW6lG26LBmh2aH7zYvch4zE+b4zfFb6BI8IXhC3LD1TJLKeu2xOGHDK/udsLkZ+gaqoXJ7+YHyA8eO5p8k+UoG3VuEXQCV8Fv1zdc3X5dgj+/R5nuctwInumMfKuP+YJ1viGVgEZtKfGsNbEgo6z6ViiUznsYseXqHMOu/s7m8rqOvajuqD7dUXq28WltwE3LhyFdH1vGBhr9Jtd4rgqKjSY7o6KVrImEBhO2Pr4yv/PuVH8jqsCd5uueo0Q/WSjLNcRdgR3wu1FG0w57jT2CoopiJaUE6rG2wCiOF9xhpeC9V0PNAwQ/dhFGoMcOhuFVIw3S2DNOVH3CouZAtw8mAZkVPbjy5UfoBsA88SLqmOac5N/+YbVbD4VPHC0+Riy88lVkLlykC0LydeGniJWZ6hE0B3pAmw61q1ktF45+W03ijN92hUHUEzEzyDgwLDHPV2hIW+TqViibfLG+G+tUltDihJDrLhxh1TtKioMigSNdV1ErxUUsLu47BkhbcpuuH6UYtur4U2vU6wDpWWVZZNtg+8X7i3RKHZGRTAb8o/a35t+azqNiJo3mWLls3MHra4sDFgY5JQ4FJwLrE64HXg1jsDDiWR5X8Gxydgx3P3Tt371EJdoBXcD2xOqA6IMchYwBFh7LVON4Tuw1rHtbMVGViaNgJ+seO8Rzj6WzjO8B3QAK5T4r/FGRjgfoC1EjaUbyN24xEACfLRFXks1vOtpxtvHf6w+kPh0Rd6cvfIBJWx2EX7w/eH+zvDzk75CyTHha9scHpM2w02Ew59X4X3GDdYJ0vTjOOnyrfzEZHss4zrGdYDw5hXxA2TuIWeqO/YPl5cnFi/TzioPmCt/AK/Q2vBEudC2raZsoU/bOShVZqP/Pf2pK4rRTgBBoeCDN1E6jdWJkCJ2uplQkFgvswSPKRULcg1D/qhhHqfQ6xLicHnRx03fal90tv5GIpkqXA4mPmi4IXBTd+PtXAC6cN1RSlnWJH5d7uo5fTslhHGF06u3l281Ls2g67MQXT43Kx07n75+4/LkEp4HRoGZ/NpvP4jSwFR3igfOS9kfeY6hibRMROFuM6gHWjspA5AIsjfU/MStb1xiDhd237StrVon01ut66fq29MV1U+HTD7639hN/ZVkok+otBOOUNOFlsOdn8cwuZYhStVW2s10rKMV3wooflwngSuU9J/wf2D+zRJBxHUsxEMUZJ8/3m+6VoBNiP129l6W3pcrDVuoYGhgZ6J84i7vDaHV4cXpxyDu7witq/pvsXzL4ynILThTmtJngKDA26n4Wjui/YOTDYG7YxCzYNdA5sKwVAjDAiiX79V2e9Je3nMPpKXIlw7tPQosGms3TU6oE+tahVPhLnSRcSZcob8TqVMK3tIwW3gpP+T6myLr7VHAyJmE5J3Q1x4ffkhslt7w3W+vesiebEhH+Tl8D87pPM+kyZrk9bJm4V05QiCo+hbW9rP/3edjlxrhbD9PUUF7dQH08StUVnr/qG9TvAup6wOGFxfcpzj+ceH2Oxo6ggH7Kf1zyvuXa/GjkqB9CUQOWb5JtxQDx2W/zn4j9n3h99dvTZAYfJwqgMiB3tMdpjpvViJqGygpkCI3vcOk31kCx2bB52Of/4/ONHx0XPZgzNmrqJdRNzKIRjE3kHyoWtY5jp/EnzJ03UMGPxcGlCmWuza3MMdiOvwCvukhkcJd1J/8te736yV6odxV9k5JKwx7GXjS8bK8TNpq3v54fGIx6NeMS6H2eTyUipzdZWfxUNcEH+cPOlhCr/Kv/988AWbBLc/IP9g52TxpJp/guf1+34bDN6/d/jYwKVUPpdyQ881rOv0RqHsm/RR9p4rq6p7H3Z+ywxbO/7H1DN+AuqzqJp/T+hekRQjfkM1cO/oAqum1Q3KVeEyvq/QiUVoZpY5vrU9WnMJ0NVVBJUNQTVmr+gOvxPda7BAhmWG2pwP8B2dk/4Q/qw4NLJykuVl/Y1wRvCLQAlY26NucXMjzJiccMPImguKhpqj/zJ5ktJZZoyzb75YAeOCe5+Gj+NS/IkAi1di/76Rgw0u4lbWRhNk49blS9uCvNUMOaATbVztXPDgidhT8LepJBDGk/eqfDF9RfXK18DEeut1Reiz/DRZxZXO5c6l44pZtJ8KlPyfQt55R3fwvgyOAX1e09UFFQUXMh8AGISWaWpEoVwEKkeHibeDmwIbJj3i22RbdGY3ZbARlFaED7CYYSD/3DxZIv1usQk+IU136B5GYomS6jcX1JOP3t9YS64JwaIPmv2yvEwGOz2eZfzyhfe5XEX4AGvyBBTn6cEovB3sq1yqquEhWqmxu+oKviiRs3WyhR//EVFaEp23CQSlamQQmQ0rpp1fTvu7TjsGYg2gFNIQSvePXv37IRIvqN5fTCxka+cBQ8fxHz6jgCng74nfU/G34I3vD6EpcsVLz9bdyb9Vgm71Xp3/BqELNGmc8EgU7Mthg5q4wSpQrjyuaUYMKjwqdgyDbBQX4U5bVW4EeirdiJgiW1NLFvfxJYAy21rZMn6Rqni4ufOJeZYCXhZyMVLhlysAsNCXbwwTxfByoGdM+xj54R9VBVcWyOkip8+9xE2kIFsa5dvbdtIMBzBbQDCEWGNfiQ7AuxJqzN7onOWKrb85WnvmesbiBZ3y3Qb9Y1k123HKAfQ6NZD61dtN6SK1nGU4XuoZT7oaYY9hZGGkRRWP8Ke7I5KGIkeMmUDm0JPZfTdFPQ0jJQpDJ3aBdnTLsMHte46bgDDB7Vs1H8OliFYsTRxrAzWW8U8BCu1/JrBinnKlQ1oo9blUOgvtA90SrdMhSGAzkIwzjIEYzCwk7pocmBE8bXMC70k35ozL/0w9JIrDFfUxlfxjKRaiDGqVss4Fe5jZzAQmA+eET2CFn2YVTIRzij8AV3NnlFObEkyVD/DM2QY+fYNrg2uT2I+mfirY3eaeOWa7/1/iPoxmRzqT7K4mrV3SReENfKvUR721PGC4wXLPKYEa3BYM2v5rOULQ8J8wny03uDefhBTmllQkF2QXbH9NFyAqlW5S3OX7goCL34GGyYXD8i6xkx05Se6BlNVTh0OqODsvvLy3PLcK7ueAY89mEaWHBYdHZzIK6uDEwNS/cAHQrbHZMdkry6CSl5hp0VfNjZZ3xv9BGfyY90oy0/DOGE1rSgZu5ljHGSgiVRZeW3M2wCKrCkM+uPErXe33hVhL0BbfgdFTzMoS3B86/h2YDXrKfqLUSEzrSnyYGlyTFMzB5XgKS99frPiAzRC7fIS9xL3LJLWhI+hCEqeNCnEM8TTPdYB+oNjpeYl5XvjtbhQtwJ9JOKpVwiuNGoUcsjuppWx3k+HPR2GnX1xBNyFGz9dzr+c/0tlcU1xTVb9t5d5tlK2ySc5KHRJ6JLFK93ABtyyg2uCa5KeAJrwxcS/fFZz6dnSs7XZjVAHJ7THQo+FZi361pXHlbI0VAS/m3pr6q0BRWKMNBJYZ9/xQ8cPDRJXNIVXOP4nTJ8kS2NxGKesbBQqqMv0Ytbv7uC7g39fJKLUBd6U3XjCK1dlMGOCUKoUFYmlGU7KZ9wbfYzJxbRv4CJ7S97eMoxiR2ZDe5esAjTNelV6vvR8bW4jvIPrmvIJvCFEHjDOKWgokfP8nODzweeTHgN2IJh6EkxYis6YSVDpCnGD0QPhHyTIxEqmej389XA09UUreAZNmdcLrxeeqy69yLMeaCqdOXZMIPkWW5h90Odnn59jrm14yut83soAHUPwC5uXNi+ZrJINASuYnODo7+jv4RI8KXhS8ghgHI9b3ql+fHDwYkllSeUv+y5TqnEq+Wjw0eC9bulT+ZVkOluykvW9KIfORn8JRmCaUbm+lwqntPXCNPo+Dl1Y3GsZdqqpRb5vAeRuOrSR34qeUr+MwK0awhysolzmuMyJsqI6P5RNkStmGuzRG6PQV7cU/bRas/u4UVhKyMdirLLpfjvyzsdYv3uW9yz/WCwibwIviq/eFa+EJiXO8w/yD5qXNFXMNUaXOT7lmZxZSosX1mhuR92OurOKqGo4YOeSJ/ef3C8ja8UBvLJRn89i5ZRsSpVvZjweXkoRIOsBAxbbDuFth4Sx3sBsedwo7lXXvS/L6svq6/PuwVu4HlIxhTfEyf0nOwUPI3Bd84LOB51PekT5Pq8YlfWX5kiwC6nOKPHYsos5pul2yKqab5S+gXqoXJ0Xkxfzkw848q1u9MRHvgl3MRMiydVAGYdlgO1oXmggm1K0LqLhLmtxGv5oRs4pm20nW32Ppmqp16djg4T9Cfnr2o8Ntu+nV/uxQVFqbsKBhANLM4KAD4KlqQnxfEL8+hiIIMe4U63PV9EGXWZpFJyHGGajv1o65PMEMppgG03wwpGlqJi3vGR96Vfl8BGaDp+uOV1ziBZoxKuNdzKy9AD51+NDgiivjobl38Zv5Uko4unJn256Sagj/3+hoj4JlSoKpWCT2hcpLG93wASXKcGFH2XIoRHeNIRhPhg8dJ0ES8FH9GQ/s2cOI0HfkaURo4sAkblRTwuxpwX1bLc+iterPu2E9hPTibwtvrurlU0i16XpDshKGhuOvRHPEC7O/ZYp+VZ/TJNv1q2S7qjaf7QgpyCnYudpaIATq3Oic6J3LgZnvtWb+vlRRKha9sbjkselsUfEqHkgsA7etsxoIRoNPc0GA/HIwCCHccTCG1DKVpKUo/8lymedUN75pBQ/yqqe3ih7S9ZVtTonKidq5yJxGg96EiRPwx+ZHFUsqf3gyM9mOK8s34Cm7SPO+XfizMSNRJyFZB925Uz9fPDzwahYjKPgN3i673bF7YpzF0seljzc8wr+5DeflW7A0YvRdMzLMS9Zx0pmCUNhQpJDgEOA+5zPxt//L4La97KyvpKUXrx2qY+unFs5d/8E0b5Y18RRAXMD5s6LngL8FJibG1AfUJ/4RFQPhZ2hX7JgQcIt+yf05GQShWTcqHyF3QwTSPuEf8iu2b0KEwPs7tBy4vZvt387Kp7k2/A7ycVMj0B1u4s5IRJyVxiumTGBV976G3ZgicSurzCtdZ9KSJSX3r9e8g7uwfno0nml87ImEmkBUyaNCnINcp0fbQ/8EJh+POghr5j1l0iEl/YToQeTVDEYo2xqFCpFWhEJ3fKu5R+LUCVevj8vunaLN6STOigb1dJGFiNfayFyxKORx8UTgZ7EEfZDefuh7Rxh9xmu7ntflZ0vO38+9w68gqthlba8Yb3cf8qMkBFgD/Nzg+qD6pOa2zEyfE9ZtIDrPuNDAUy7QqbIih/dEhPdfDiyKW8j/w2mSBN/iE1fAgNhqr/7KF5Z9BV2YWvEQMZJi3N0m3GO2S1cz/zxb4IS/658cQtfqmDO7vnFXsVevwQ1RDdEN65+KvrxDzlNtU21x+5RglCztnpFCb+iJLRgweEFhx32j8wamTU3KyaLYvWYrNWHyVRLdh3JP5B/oCzjFJyFijUFMQUxP4WBf3uM0hL6wOaCzYWBeaLr7AJDYmzn2c4LsyMPwozqJmEX99NxDUkPVvEPVp3TFiYWJv4UBRoIWxUVlRCV4Js6F2bDwp2huUREoblJ5ZvOEhaVWgzQhaOLBIkKjb4XfYizQSdjIS8G4fy+J+GX70/v5NFdvnxD7KZYCIblP6zOXJ35ZS6U8MJ79CI340XkmcZ2MWe5wuqz775MyHaifbYidMuxk2BK0prnDq11rnV+ulS8JuoBLcevPeSVKVv740oAkQ8BWjOlyvKQSTbBlN3xTObZgH366dxEHmbL2ylKsld/WSUo2i5jJAidqBMF5Ctbd7I1up2Ul5d9anOE2mA1tfEHTNGtxjWtq8VqFTX/GzDH1lSWpEtlc4HFt2rZdJ2WdjPgU89cc9wHGC3IMMYgwyxgr4QKfCjksH3AQpjAAlFgWYAPDDnUZx1xd5BaOkgryRCF6tZ2fomVdOXChIiYpJgk/1Q34AO+BeYuLU0t/qoAxGtX418v4RxecFIbP2AZwOJa49lKXbw4PZBxuOAiyX1zfQdcaLghE37WxQNatT6h2H6RUAiGitZoqcJQIhxEZwluoUDtjHBQhaoLjmx4P7ZUns5SsTMbjqmz+SrsL2XyovktaWTPuJQMeoTHn0xeh/K6Gsodh/MYI/8ObWpbUF7E+6GFlJlEjV0wf9r8aTHDv6ZQgC2RsxFzHZmqr6I1+NPZiBPaGKGTeBtso5adZDayf0oSiilGh1isqor1l2KX/Gdnam/X3j78G3EXj4vlOPziLVT1RWc5U825hcP7oT+J03XZe/fb7rfHnGZd8nk/ZiFFk/Dagd8ye56FUrA2ps4Cu3iyLp5u/cX/H2Bh8k3Mfv5AZhLOK9Bc6IFB+8TbBxNcoFuH7uLln50KF8jgTEb5wYKDBQU/lcMBOPDV3vV71xfFnQw4GVAZfTzleEr5l9XAv4LGovqb9Tfz3ohxKnOXgdda/9iI2IjIlEBYAfFbk35M+jEy26/MrywgL2hP0B6/H3yBHwq2kW5Obk7LRon/2qFQG3/TXW18RaXdo7+8B//cUwsyg/0/5NC5IwZ2RJ9tnTtjGun+Pzp3UXNWSq6DRNLZoUDoAdiHOYG003+5l8lov5fJa7+XyWu/l8n4dC+T2n4fJF42dPq/PLzfuwB4nGNgZGBi4GNgYJAAYgUgmxEI44GYBchnAmJGMMkDxAJANojPAAAadADVAHicY2BkYGDgYmhjWMDA4uLmE8IglVxZlMOgkV6Ums1glpNYksfgwsACVMPw/z8DE5BixMvTY2B3jHJVYNBzDgoBkm5BjkDS198HSPo5hgHJIH9fIBkS5A0kkfQxJSfnFjDwpRUlJjOIgEUYwCRQhoGNQQKIGYBYisGIwYshgaGMoQcswsgwgYEZTPMBsQhUhxdYN6a4N5q4ENQeaokyAt0JEgcBJiBLEOhesBwAlTAg4wAAAHicpVfrT1xFFP/dZSmw7MKyVrSIL6zYilYsAVo0jUGkmDQVRQrFplqxagqpiEbTpGn8oA3xo/+AJNpgYqQmpTE+SGmCjxZF2liF2IrQAgssIG35Zvb4m7l7dy+wy+7G2ZyzM+fMecyZM+fOwADgwj68A2dV9a7nkdd8pL0Vm15rP9iCstYDbx9GFZycAxE4+GckMXI0t73VhqyWg+2HsV5ToDE5WIcsPTbg07MdKHZUcORCKjaihmMne6nkpPFnIAd5pBXgMbhhGIPaUj4qObMGu+n/y2jDMXTgPIbwOy5jHv8aLiPf2GLUGnuMl4wPjU6j2+gxviH0U1+pKNyITKSgnN5tQyEqkEuaV9JJu0dOol4W0CijHLlkEjvkJvaT4sBOmSd9Bl54gvPIJhTIEyiSYpRSU6X8hSqZxVOEakINoZbwHKGOevZQskH8aCLQAzmr8c/E9YyJk56NolyuYZsEUCFXaL1UBkmZ42iII4Oe18kZylzgbBct7mB06mQc+3GLpmST4iZllpQspCONPDUvU34lx0f/Z8gd5vpmtIyyP8F1FXFdZQQXrXgp5w1p93E9fq7Hz/X4uR4/1+LXkqnkBMgJkBMgJ0BOgNI7KVePrYxvDrXX0r5Bmoc2PPI+sgnKWoDWAuTkE1JoL4MWC7j7hXgAD+FhPEoNJYxpOXengjv/OHXsQh01N1BzE3fd4T6qMiHTndlPqfthbz6rI1cZTavlYHnLsdPkGuOwqjGOVu9zucR9MPszhGnbrDE5Tryk6Ks1yJDclCXdX5JBWZAOOaRZbk1bJHQQRqRfftT+0Hs5pXnnmA/q/0oUvYu2/j/h3mcRj+305Jt8mcCcORPzZJjjSaL1MebG9MWK6jLa4moaqQvxfVolsxRNK/PCHr/rCWm6EZWagKwpaVqMvjLdsm0Se+WPODqX5Zp91xNrMiljxBNmHssUa0LisvsIn4RHZxjNYeIROSRnZUAC0sk89vHE/CDj3HdPaN60ym4VC9mg91Ll+eshXmf06K7hwwyrldkLROF28Tx3STG96pBG+Vq6SfSyvp+UHp6zyHk5paIuizIQDMoxZqJXvguSK0cJm1bvVbTdjtintb4Y3g5bJ+D/nMmwtll10ojnVGwZb6tyeZLWNClTWpPOH2bBWBwBq2ZmcfYrhAtrar+arD9aSsczmXyMqcmsT5c1Hoftu7CseW0SdTE03bCw7NYVJXRW5b3Q/y+WndD4jWCrdK3QUZOE50vx53BWn8bX+TUmlg/ELyXBaTUK8XlCgn+rsypfSW+YunWZDtYZ+V5n0Qn1JeJ9w8791Nb/MwGPAhGcaIu+02Ym8ss6x+/uqMpSmFk3EFPPm+Fef1ybE3Iu7hx/uBeqTfKbzoCLrC2niUesXZKemDo2h3vNa1hKunqvoet0VOqRWDbWPqPysXyxgtK3MnLyk8ZTya4jmEB1kHrpJbzK2lwiL3J8AOarANIixyPVhzeqVP3/UbBMsvUcBO/i2J2MR+GWRB2NdiexfRF65NsYcpcIvTIt3epkygm+Oczm09/Fi1FlzgfftfTJdkTuoOoOvRcbwhMjvXtDEL85eBdX74HUMMXFF9LtIf25IVoWqXfiDvroXnGfXseY38b/dD1yhulO/lLUfuDWECUD6paobvym35EbY6SXh7sJibR12ndrDardZ1uTCV6uRPmdS5/dkfqoWxrMd6n5Io20FP6U54ZeNRiXDL2GDNZ+g68U9WrxsF9Aexv5/ijEZjyIIv162YJHUMw3TCnK9Atmu37DVOJJvqir8TRfrc+gFs/yPdPA9Tfhhf8AO0d8HwAAAAABAAAAANoy8IQAAAAAxPARLgAAAADjIwcreJwdzs0rxFEUxvHv79xzjcwskGyGNAs11IgiLyklUiyYIUkp5SUvKzSJTKGJRKR+CwsLZcOGlX/A0grJxkYie8USh8Wnp3vvc++5CgTfINUcyBFT+sK47jHpn5nwlQwHo2TkhnW5J+l2iGuWruCaCjmhR9rZdrWI9WfNmUmbftNoNkzWdJsZMyZVbAbv1GkJHbrKoday7l5pjyRt3iClPkboW5n2bYS6ZaZsvcicvySUTk51gZSP2v4QYSSwswuzZf3K/xzXbzt7oFefrNdMzqcojRRR74up0WcieseANJB3I5RZxtw8Te4YJyEN9uaobrCm9fb/vOljUB5J6Q4Zm7siUXIS/FxpyjLKXsGXdZdY0X3r/t3bpV9uLRP0yTmFusiy+6Tcf5DQAqrcGzHLjFzSIsKFZdynyf4CCpdPRgA=",TextHighHZ=reactExports.memo(({isPerf:K,color:_,colorBlind:Z,customData:te,isMemory:ne,isShadersInfo:ie,metric:oe,fontSize:se,offsetY:ae=0,offsetX:le,round:ce,hasInstance:fe})=>{const{width:de,height:pe}=useThree(me=>me.viewport),he=reactExports.useRef(null),ge=reactExports.useRef(null);return useEvent("log",function([me,Ae]){var ye;if(!me||!he.current||(te&&(he.current.text=(Math.round(getPerf().customData*Math.pow(10,ce))/Math.pow(10,ce)).toFixed(ce)),!oe))return;let ve=me[oe];if(ie?ve=(ye=Ae.info.programs)==null?void 0:ye.length:oe==="matriceCount"?ve=matriceCount.value:!K&&Ae.info.render&&(ve=(ne?Ae.info.memory:Ae.info.render)[oe]),oe==="fps"&&(he.current.color=getPerf().overclockingFps?colorsGraph(Z).overClock.toString():`rgb(${colorsGraph(Z).fps.toString()})`),he.current.text=(Math.round(ve*Math.pow(10,ce))/Math.pow(10,ce)).toFixed(ce),fe){const _e=Ae.info.instance;if(typeof _e>"u"&&oe!=="matriceCount")return;let Te;oe==="matriceCount"?Te=matriceWorldCount.value:Te=_e[oe],Te>0?(he.current.fontSize=se/1.15,ge.current.fontSize=ve>0?se/1.4:se,he.current.position.y=pe/2-ae-se/1.9,ge.current.text=" ±	"+(Math.round(Te*Math.pow(10,ce))/Math.pow(10,ce)).toFixed(ce)):(ge.current.text&&(ge.current.text=""),he.current.position.y=pe/2-ae-se,he.current.fontSize=se)}matriceCount.value-=1,he.current.updateMatrix(),he.current.matrixWorld.copy(he.current.matrix)}),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:null,children:[jsxRuntimeExports.jsxs(Text,{textAlign:"justify",matrixAutoUpdate:!1,ref:he,font:localFont,fontSize:se,position:[-de/2+le+se,pe/2-ae-se,0],color:_,characters:"0123456789",onUpdate:me=>{me.updateMatrix(),matriceCount.value-=1,me.matrixWorld.copy(me.matrix)},children:[jsxRuntimeExports.jsx("meshBasicMaterial",{blending:NormalBlending}),"0"]}),fe&&jsxRuntimeExports.jsx(Text,{textAlign:"justify",matrixAutoUpdate:!1,ref:ge,font:localFont,fontSize:8,position:[-de/2+le+se,pe/2-ae-se*1.15,0],color:"lightgrey",characters:"0123456789",onUpdate:me=>{me.updateMatrix(),matriceCount.value-=1,me.matrixWorld.copy(me.matrix)},children:jsxRuntimeExports.jsx("meshBasicMaterial",{blending:NormalBlending})})]})}),TextsHighHZ=({colorBlind:K,customData:_,minimal:Z,matrixUpdate:te})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(TextHighHZ,{colorBlind:K,color:`rgb(${colorsGraph(K).fps.toString()})`,isPerf:!0,metric:"fps",fontSize:14,offsetX:140,round:0}),jsxRuntimeExports.jsx(TextHighHZ,{color:`rgb(${colorsGraph(K).cpu.toString()})`,isPerf:!0,metric:"cpu",fontSize:14,offsetX:72,round:3}),jsxRuntimeExports.jsx(TextHighHZ,{color:`rgb(${colorsGraph(K).gpu.toString()})`,isPerf:!0,metric:"gpu",fontSize:14,offsetX:10,round:3}),Z?null:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(TextHighHZ,{metric:"calls",fontSize:14,offsetX:200,round:0,hasInstance:!0}),jsxRuntimeExports.jsx(TextHighHZ,{metric:"triangles",fontSize:14,offsetX:260,round:0,hasInstance:!0}),jsxRuntimeExports.jsx(TextHighHZ,{isMemory:!0,metric:"geometries",fontSize:14,offsetY:30,offsetX:0,round:0}),jsxRuntimeExports.jsx(TextHighHZ,{isMemory:!0,metric:"textures",fontSize:14,offsetY:30,offsetX:80,round:0}),jsxRuntimeExports.jsx(TextHighHZ,{isShadersInfo:!0,metric:"programs",fontSize:14,offsetY:30,offsetX:140,round:0}),jsxRuntimeExports.jsx(TextHighHZ,{metric:"lines",fontSize:14,offsetY:30,offsetX:200,round:0,hasInstance:!0}),jsxRuntimeExports.jsx(TextHighHZ,{metric:"points",fontSize:14,offsetY:30,offsetX:260,round:0,hasInstance:!0}),te&&jsxRuntimeExports.jsx(TextHighHZ,{isPerf:!0,metric:"matriceCount",fontSize:14,offsetY:30,offsetX:320,round:0,hasInstance:!0})]}),_&&jsxRuntimeExports.jsx(TextHighHZ,{color:`rgb(${colorsGraph(K).custom.toString()})`,customData:_,fontSize:14,offsetY:0,offsetX:Z?200:320,round:_.round||2})]}),ChartCurve=({colorBlind:K,minimal:_,chart:Z={length:120,hz:60}})=>{const te=reactExports.useMemo(()=>({fps:new Float32Array(Z.length*3),cpu:new Float32Array(Z.length*3),gpu:new Float32Array(Z.length*3)}),[Z]),ne=reactExports.useRef(null),ie=reactExports.useRef(null),oe=reactExports.useRef(null),se=reactExports.useRef(null),ae=reactExports.useMemo(()=>new Vector3(0,0,0),[]),le=(ce,fe=1,de,pe)=>{let he=0;const{width:ge,height:me}=pe,Ae=getPerf().chart.data[ce];if(!Ae||Ae.length===0)return;const ye=_?2:6,ve=_?12:50;let _e=Ae.length;for(let Te=0;Te<_e;Te++){let be=(getPerf().chart.circularId+Te+1)%_e;Ae[be]!==void 0&&(Ae[be]>he&&(he=Ae[be]*fe),ae.set(ye+Te/(_e-1)*(ge-ye*2)-ge/2,Math.min(100,Ae[be])*fe/100*(me-ye*2-ve)-me/2,0),ae.toArray(de.attributes.position.array,Te*3))}de.attributes.position.needsUpdate=!0};return useFrame(function({viewport:ce}){le("fps",1,ne.current,ce),ie.current&&ie.current.color.set(getPerf().overclockingFps?colorsGraph(K).overClock.toString():`rgb(${colorsGraph(K).fps.toString()})`),le("gpu",5,oe.current,ce),le("cpu",5,se.current,ce)}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("line",{onUpdate:ce=>{ce.updateMatrix(),matriceCount.value-=1,ce.matrixWorld.copy(ce.matrix)},children:[jsxRuntimeExports.jsx("bufferGeometry",{ref:ne,children:jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-position",count:Z.length,array:te.fps,itemSize:3,usage:DynamicDrawUsage,needsUpdate:!0})}),jsxRuntimeExports.jsx("lineBasicMaterial",{ref:ie,color:`rgb(${colorsGraph(K).fps.toString()})`,transparent:!0,opacity:.5})]}),jsxRuntimeExports.jsxs("line",{onUpdate:ce=>{ce.updateMatrix(),matriceCount.value-=1,ce.matrixWorld.copy(ce.matrix)},children:[jsxRuntimeExports.jsx("bufferGeometry",{ref:oe,children:jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-position",count:Z.length,array:te.gpu,itemSize:3,usage:DynamicDrawUsage,needsUpdate:!0})}),jsxRuntimeExports.jsx("lineBasicMaterial",{color:`rgb(${colorsGraph(K).gpu.toString()})`,transparent:!0,opacity:.5})]}),jsxRuntimeExports.jsxs("line",{onUpdate:ce=>{ce.updateMatrix(),matriceCount.value-=1,ce.matrixWorld.copy(ce.matrix)},children:[jsxRuntimeExports.jsx("bufferGeometry",{ref:se,children:jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-position",count:Z.length,array:te.cpu,itemSize:3,usage:DynamicDrawUsage,needsUpdate:!0})}),jsxRuntimeExports.jsx("lineBasicMaterial",{color:`rgb(${colorsGraph(K).cpu.toString()})`,transparent:!0,opacity:.5})]})]})},ChartUI=({colorBlind:K,chart:_,customData:Z,matrixUpdate:te,showGraph:ne=!0,antialias:ie=!0,minimal:oe})=>{const se=reactExports.useRef(void 0),ae=usePerf(le=>le.paused);return jsxRuntimeExports.jsxs("div",{className:styles$1.graph,style:{display:"flex",position:"absolute",height:`${oe?37:ne?100:60}px`,minWidth:`${oe?"100px":Z?"370px":"310px"}`},children:[jsxRuntimeExports.jsx(Canvas$1,{ref:se,orthographic:!0,camera:{rotation:[0,0,0]},dpr:ie?[1,2]:1,gl:{antialias:!0,alpha:!0,stencil:!1,depth:!1},onCreated:({scene:le})=>{le.traverse(ce=>{ce.matrixWorldAutoUpdate=!1,ce.matrixAutoUpdate=!1})},flat:!0,style:{marginBottom:"-42px",position:"relative",pointerEvents:"none",background:"transparent !important",height:`${oe?37:ne?100:60}px`},children:ae?null:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Renderer,{}),jsxRuntimeExports.jsx(TextsHighHZ,{customData:Z,minimal:oe,matrixUpdate:te}),ne&&jsxRuntimeExports.jsx(ChartCurve,{colorBlind:K,minimal:oe,chart:_})]})}),ae&&jsxRuntimeExports.jsx("div",{className:styles$1.graphpc,children:jsxRuntimeExports.jsx(PauseIcon,{})})]})},Renderer=()=>(useFrame(function({gl:K,scene:_,camera:Z}){Z.updateMatrix(),matriceCount.value-=1,Z.matrixWorld.copy(Z.matrix),Z.matrixWorldInverse.copy(Z.matrixWorld).invert(),K.render(_,Z),matriceWorldCount.value=0,matriceCount.value=0},1/0),null),colorsGraph=K=>({overClock:"#ff6eff",fps:K?"100, 143, 255":"238,38,110",cpu:K?"254, 254, 98":"66,226,46",gpu:K?"254,254,254":"253,151,31",custom:K?"86,180,233":"40,255,255"}),DynamicUIPerf=({showGraph:K,colorBlind:_})=>{const Z=usePerf(ne=>ne.overclockingFps),te=usePerf(ne=>ne.fpsLimit);return jsxRuntimeExports.jsxs("span",{className:styles$1.perfB,style:K?{color:Z?colorsGraph(_).overClock.toString():`rgb(${colorsGraph(_).fps})`}:{},children:["FPS ",Z?`${te}🚀`:""]})},DynamicUI=({showGraph:K,colorBlind:_,customData:Z,minimal:te})=>{const ne=usePerf(ie=>ie.gl);return ne?jsxRuntimeExports.jsxs("div",{className:styles$1.perfIContainer,children:[jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(LightningBoltIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,style:K?{color:`rgb(${colorsGraph(_).gpu.toString()})`}:{},children:"GPU"}),jsxRuntimeExports.jsx("small",{className:styles$1.perfSmall,children:"ms"})]}),jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(RulerHorizontalIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,style:K?{color:`rgb(${colorsGraph(_).cpu.toString()})`}:{},children:"CPU"}),jsxRuntimeExports.jsx("small",{className:styles$1.perfSmall,children:"ms"})]}),jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(LapTimerIcon,{}),jsxRuntimeExports.jsx(DynamicUIPerf,{showGraph:K,colorBlind:_})]}),!te&&ne&&jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(TextAlignJustifyIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:ne.info.render.calls===1?"call":"calls"})]}),!te&&ne&&jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(VercelLogoIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:"Triangles"})]}),Z&&jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(BarChartIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,style:K?{color:`rgb(${colorsGraph(_).custom})`}:{},children:Z.name}),Z.info&&jsxRuntimeExports.jsx("small",{className:styles$1.perfSmall,children:Z.info})]})]}):null},PerfUI=({showGraph:K,colorBlind:_,deepAnalyze:Z,customData:te,matrixUpdate:ne,openByDefault:ie,minimal:oe})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DynamicUI,{showGraph:K,colorBlind:_,customData:te,minimal:oe}),!oe&&jsxRuntimeExports.jsx(PerfThree,{matrixUpdate:ne,openByDefault:ie,deepAnalyze:Z,showGraph:K})]}),InfoUI=({matrixUpdate:K})=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(MarginIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:"Geometries"})]}),jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(ImageIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:"Textures"})]}),jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(ActivityLogIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:"shaders"})]}),jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(MinusIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:"Lines"})]}),jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(DotIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:"Points"})]}),K&&jsxRuntimeExports.jsxs("div",{className:styles$1.perfI,children:[jsxRuntimeExports.jsx(DropdownMenuIcon,{}),jsxRuntimeExports.jsx("span",{className:styles$1.perfB,children:"Matrices"})]})]}),ToggleEl=({tab:K,title:_,set:Z})=>{const te=usePerf(ne=>ne.tab);return jsxRuntimeExports.jsx("div",{className:styles$1.toggle,style:{background:te===K?"backgroundColor: 'rgb(41 43 45)'":"backgroundColor: 'rgb(31 31 31)'"},onClick:()=>{Z(!0),setPerf({tab:K})},children:jsxRuntimeExports.jsx("span",{children:_})})},PerfThree=({openByDefault:K,showGraph:_,deepAnalyze:Z,matrixUpdate:te})=>{const[ne,ie]=React.useState(K);return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(TabContainers,{show:ne,showGraph:_,matrixUpdate:te}),K&&!Z?null:jsxRuntimeExports.jsxs("div",{className:styles$1.toggleContainer+" "+styles$1.toggle,children:[Z&&jsxRuntimeExports.jsx(ToggleEl,{tab:"programs",title:"Programs",set:ie}),Z&&jsxRuntimeExports.jsx(ToggleEl,{tab:"infos",title:"Infos",set:ie}),jsxRuntimeExports.jsx("div",{className:styles$1.toggle,onClick:()=>{ie(!ne)},children:ne?jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx(TriangleDownIcon,{})," Minimize"]}):jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx(TriangleUpIcon,{})," More"]})})]})]})},TabContainers=({show:K,showGraph:_,matrixUpdate:Z})=>{const te=usePerf(ne=>ne.tab);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(InfoUI,{matrixUpdate:Z}),K&&jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{className:styles$1.containerScroll,style:{marginTop:_?"38px":0},children:te==="programs"&&jsxRuntimeExports.jsx(ProgramsUI,{})})})]})},Perf=({showGraph:K=!0,colorBlind:_=!1,openByDefault:Z=!0,className:te,overClock:ne=!1,style:ie,position:oe="top-right",chart:se,logsPerSecond:ae,deepAnalyze:le=!1,antialias:ce=!0,customData:fe,matrixUpdate:de,minimal:pe})=>{const he=reactExports.useRef(null);let ge=styles$1.perfS+" "+styles$1[oe];return te&&(ge+=` ${te}`),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(PerfHeadless,{logsPerSecond:ae,chart:se,overClock:ne,deepAnalyze:le,matrixUpdate:de}),jsxRuntimeExports.jsx(HtmlMinimal,{name:"r3f-perf",children:jsxRuntimeExports.jsxs("div",{className:ge,style:{minHeight:pe?"37px":K?"100px":"60px",backgroundColor:pe?"rgba(36, 36, 36, .75)":"rgba(36, 36, 36, .9)",...ie},ref:he,children:[jsxRuntimeExports.jsx(ChartUI,{perfContainerRef:he,colorBlind:_,chart:se,showGraph:K,antialias:ce,customData:fe,minimal:pe,matrixUpdate:de}),jsxRuntimeExports.jsx(PerfUI,{colorBlind:_,showGraph:K,deepAnalyze:le,openByDefault:Z,customData:fe,matrixUpdate:de,minimal:pe})]})})]})};function XrHandsPatch({delay:K=2e3}){const _=useThree(({scene:ne})=>ne),Z=useXR(({mode:ne})=>ne),te=Z==="immersive-ar"||Z==="immersive-vr";return reactExports.useEffect(()=>{if(!te)return;const ne=setInterval(()=>{const ie=_.getObjectByName("l_handMeshNode");ie&&(ie.visible=!1),ie&&_.remove(ie);const oe=_.getObjectByName("r_handMeshNode");oe&&(oe.visible=!1),oe&&_.remove(oe)},K||1e3);return()=>clearInterval(ne)},[_,Z]),null}const Gizmo=({...K})=>{const _=queryString.parse(document.location.search,{parseBooleans:!0,parseNumbers:!0}),Z=useRenderMode(({mode:ne})=>ne);(Z==="postprocess"||Z==="pathtracer")&&(K.renderPriority=2);const{enable:te}=useControls("Scene.Gizmo",{enable:!0});return!te||_.gizmo===!1?null:_.gizmo==="cube"?jsxRuntimeExports.jsx(GizmoHelper,{alignment:"bottom-left",margin:[80,80],...K,children:jsxRuntimeExports.jsx(GizmoViewcube,{})}):jsxRuntimeExports.jsx(GizmoHelper,{alignment:"bottom-left",margin:[80,80],...K,children:jsxRuntimeExports.jsx(GizmoViewport,{axisColors:["#df3636","#00c84e","#3d7cff"],labelColor:"white"})})},Posteffects=({children:K})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[K,jsxRuntimeExports.jsxs(IfInSessionMode,{deny:["immersive-vr","immersive-ar"],children:[jsxRuntimeExports.jsx(Gizmo,{}),jsxRuntimeExports.jsxs(EffectComposer,{enableNormalPass:!0,children:[jsxRuntimeExports.jsx(N8AO,{aoRadius:1.5,intensity:1}),jsxRuntimeExports.jsx(Bloom,{luminanceThreshold:1,intensity:.15,levels:9,mipmapBlur:!0})]})]})]}),SimpleRender=({children:K})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Gizmo,{}),K]});React.createContext(null);function fiberVec2ToArr(K){return Array.isArray(K)?K:K instanceof Vector2?[K.x,K.y]:typeof K=="number"?[K,K]:[K.x,K.y]}const PathtracerProvider=React.forwardRef(({enabled:K=!0,samples:_=10,minSamples:Z=5,tiles:te=3,bounces:ne=10,resolutionFactor:ie=1,filterGlossFactor:oe=.5,children:se,renderPriority:ae=1,multipleImportanceSampling:le=!0,iesProfile:ce=-1,...fe},de)=>{const{gl:pe,size:he,viewport:ge,camera:me,scene:Ae,controls:ye,frameloop:ve,set:_e}=useThree(),Te=reactExports.useMemo(()=>{if(!K)return null;const be=new WebGLPathTracer(pe);return be.synchronizeRenderSize=!0,be},[pe,K]);return reactExports.useImperativeHandle(de,()=>Te,[Te]),reactExports.useEffect(()=>{if(!Te)return;Te.bounces=ne,Te.minSamples=Z,Te.renderScale=ie,Te.multipleImportanceSampling=le,Te.filterGlossyFactor=oe;const be=fiberVec2ToArr(te);Te.tiles.set(...be)},[Te,ne,Z,ie,te,le,oe]),reactExports.useEffect(()=>{if(Te)try{Te.setScene(Ae,me),Te.reset(),invalidate()}catch(be){console.error("pathtracer error:",be)}},[Ae,me,Te,K]),reactExports.useMemo(()=>({update:()=>{Te&&(Te.setScene(Ae,me),Te.updateCamera(),invalidate())},reset:()=>{Te&&(Te.reset(),Te.updateCamera(),invalidate())},pathtracer:Te,enabled:K}),[Te,Ae,me,K]),reactExports.useEffect(()=>{const be=()=>{Te&&Te.updateCamera()};return ye&&ye.addEventListener("change",be),()=>{ye==null||ye.removeEventListener("change",be)}},[ye,Te,K]),useFrame(({camera:be,gl:Re,scene:we})=>{K&&Te.samples<=(_??1/0)?(Te.renderSample(),Te.samples<=(_??1/0)&&invalidate()):Re.render(we,be)},ae),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:se})});extend$6({PhysicalSpotLight,ShapedAreaLight});const PBRSpotLight=({_key:K,levaPrefix:_="Scene.SpotLight",intensity:Z=1,color:te,...ne})=>{const ie=K?`${_}-[${K}]`:_,{color:oe,intensity:se,distance:ae,angle:le,penumbra:ce,decay:fe}=useControls(ie,{color:te||"#ffffff",intensity:1,distance:10,angle:.15,penumbra:.15,decay:.01},[Z]);return jsxRuntimeExports.jsx("physicalSpotLight",{args:[oe,se,ae,le,ce,fe],...ne})},PBRAreaLight=({_key:K,levaPrefix:_="Scene.AreaLight",castShadow:Z,intensity:te=1,color:ne,...ie})=>{const oe=K?`${_}-[${K}]`:_,{color:se,intensity:ae,width:le,height:ce}=useControls(oe,{color:ne||"#ffffff",intensity:1,width:1,height:1},[te]);return jsxRuntimeExports.jsx("shapedAreaLight",{args:[se,ae,le,ce],...ie})};extend$6({PhysicalSpotLight,ShapedAreaLight,BlurredEnvMapGenerator,GradientEquirectTexture,FogVolumeMaterial,DenoiseMaterial,WebGLPathTracer});const Pathtracer=({children:K})=>{const _=useControls("Render.Pathtracer",{enabled:{value:!0},minSamples:{value:1,step:1},samples:{value:20,step:1},tiles:{value:3,step:1},bounces:{value:4,step:1},resolutionFactor:{value:2,step:.01},renderPriority:{value:1,step:1,max:10,min:-1},multipleImportanceSampling:!0,iesProfile:-1},[]);return jsxRuntimeExports.jsx(PathtracerProvider,{..._,children:K})},RenderContext$1=reactExports.createContext(null),RenderRoot=({children:K})=>{const _=useControls("Render",{mode:{value:"postprocess",options:["postprocess","rgb","depth","normal","pathtracer"],label:"Mode"}});return console.log("engine is",_.mode),_.mode==="postprocess"?jsxRuntimeExports.jsx(RenderContext$1.Provider,{value:_,children:jsxRuntimeExports.jsx(Posteffects,{children:K})}):_.mode==="rgb"?jsxRuntimeExports.jsx(RenderContext$1.Provider,{value:_,children:jsxRuntimeExports.jsx(SimpleRender,{children:K})}):_.mode==="pathtracer"?jsxRuntimeExports.jsx(RenderContext$1.Provider,{value:_,children:jsxRuntimeExports.jsx(Pathtracer,{children:K})}):null},useRenderMode=K=>{const _=reactExports.useContext(RenderContext$1);return K?K(_):_};Mesh.prototype.raycast=acceleratedRaycast;const Scene=({containerRef:K,className:_,frameloop:Z="demand",style:te,shadows:ne=!0,logarithmicDepthBuffer:ie=!0,children:oe,bgChildren:se,rawChildren:ae,htmlChildren:le,wrappers:ce,up:fe=null,background:de="#131416",enableOrbitControl:pe=!0,camPosition:he,camRotation:ge,toneMapping:me="ACE Film",toneMappingExposure:Ae=1})=>{const ye=reactExports.useRef(null),{sendMsg:ve,uplink:_e}=useSocket(),Te=reactExports.useMemo(()=>queryString.parse(document$4.location.search),[]);reactExports.useEffect(()=>{fe&&Object3D.DEFAULT_UP.copy(new Vector3(...fe))},[fe]);const be=reactExports.useCallback(Je=>{var ot,Fe;_e==null||_e.publish({etype:"CAMERA_MOVE",key:"defaultCamera",value:{camera:{...Je,height:(ot=ye.current)==null?void 0:ot.clientHeight,width:(Fe=ye.current)==null?void 0:Fe.clientWidth}}})},[ve,_e]),Re=reactExports.useMemo(()=>({position:"relative",overflow:"hidden",...te||{height:"100%",width:"100%",margin:"0px",border:"0px"}}),[te]),we=reactExports.useRef(null);useControls("Render",{},[]);const Pe=reactExports.useMemo(()=>createXRStore({hand:!0,handTracking:!0,emulate:!1}),[]),{alpha:Ie,legacy:$e,linear:Ue,flat:ke}=useControls("Render",{flat:!1,legacy:!1,linear:!1,alpha:!0},{collapsed:!0},[]),Ge={none:NoToneMapping,linear:LinearToneMapping,Reinhard:ReinhardToneMapping,Cineon:CineonToneMapping,"ACE Film":ACESFilmicToneMapping,custom:CustomToneMapping},[{toneMapping:He,toneMappingExposure:ze},Ke]=useControls("Scene",()=>({toneMapping:{value:Ge[me],options:Ge},toneMappingExposure:{value:Ae}}),[]);reactExports.useEffect(()=>Ke({toneMapping:Ge[me],toneMappingExposure:Ae}),[me,Ae]);const tt=window.self!==window.top;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{style:Re,className:_,ref:K,children:[tt?jsxRuntimeExports.jsx(IframeVuerLink,{}):jsxRuntimeExports.jsx(XRButton,{store:Pe}),jsxRuntimeExports.jsx(Canvas$1,{ref:ye,shadows:ne,linear:Ue,flat:ke,legacy:$e,gl:{alpha:Ie,antialias:!0,toneMapping:He,toneMappingExposure:ze,preserveDrawingBuffer:!0,logarithmicDepthBuffer:ie},frameloop:Z,tabIndex:1,children:jsxRuntimeExports.jsx(XR,{store:Pe,children:jsxRuntimeExports.jsxs(RenderRoot,{children:[jsxRuntimeExports.jsx(XrStereoPatch,{}),jsxRuntimeExports.jsx(XrHandsPatch,{}),Te.debug||Te.perf?jsxRuntimeExports.jsx(Perf,{position:"top-left"}):null,jsxRuntimeExports.jsx(Gamepad,{}),jsxRuntimeExports.jsx(SceneGroup,{}),jsxRuntimeExports.jsx(BackgroundColor,{color:de}),jsxRuntimeExports.jsx(OrbitCamera,{ctrlRef:we,parent:ye,onChange:be,panSpeed:1,enableOrbitControl:pe,initPosition:he,initRotation:ge}),se,jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(GroupSlave,{children:oe})}),ae,jsxRuntimeExports.jsx(Download,{})]})})})]}),le]})};function getImageData(K,_){const Z=document.createElement("canvas");Z.width=K.width,Z.height=K.height;const te=Z.getContext("2d");if(te)return te.drawImage(K,0,0),te.getImageData(0,0,K.width,K.height,{colorSpace:_})}function height2normal(K,_,Z=!1){const{width:te}=K,{height:ne}=K,ie=getImageData(K,"srgb");if(!ie)return;const oe=ie.data;for(let se=0,ae=te*ne*4;se<ae;se+=4){let le,ce,fe,de;se%(te*4)===0?(le=oe[se],ce=oe[se+4]):se%(te*4)===(te-1)*4?(le=oe[se-4],ce=oe[se]):(le=oe[se-4],ce=oe[se+4]),se<te*2?(fe=oe[se],de=oe[se+te*4]):se>te*(ne-1)*4?(fe=oe[se-te*4],de=oe[se]):(fe=oe[se-te*4],de=oe[se+te*4]),_[se+0]=le-ce+127,Z?_[se+1]=de-fe+127:_[se+1]=fe-de+127,_[se+2]=255,_[se+3]=255}return _}const isLoaded=K=>(K==null?void 0:K.complete)&&K.naturalHeight!==0;function HeightMaterial({_key:K,_ref:_,type:Z="standard",normalMap:te,displacementMap:ne,normalScale:ie=[1,1],displacementScale:oe=1,...se}){var ae,le;const ce=`mesh${Z.charAt(0).toUpperCase()}${Z.slice(1)}Material`,fe=useLoader(TextureLoader,ne||[]);fe&&(fe.colorSpace=NoColorSpace$1);const de=(ae=fe.image)==null?void 0:ae.width,pe=(le=fe.image)==null?void 0:le.height,he=useLoader(TextureLoader,te||[]);he&&(he.colorSpace=NoColorSpace$1);const ge=reactExports.useMemo(()=>{const _e=new Uint8ClampedArray(4*de*pe);return _e.fill(255),_e},[de,pe]),me=reactExports.useMemo(()=>{if(te||te===!1)return null;const _e=new DataTexture(ge,de,pe);return _e.flipY=!0,_e.colorSpace=NoColorSpace$1,_e},[te,de,pe]);reactExports.useLayoutEffect(()=>{te||te===!1||isLoaded(fe.image)&&(!me||!me.image||(height2normal(fe.image,ge,me.flipY),me.image={data:ge,width:de,height:pe},me.colorSpace=NoColorSpace$1,me.needsUpdate=!0))},[te,fe.image,de,pe]);const Ae=`${K} Height Map`,ye=useControls(Ae,{displacementScale:{value:oe,render:()=>!!ne,options:{min:0,step:.01}},normalScale:{value:ie,render:()=>!!ne&&te!==!1,options:{min:0,step:.01}}},[ne,oe,te,ie]),ve={};return ne&&(ve.displacementMap=fe,ve["displacementMap-colorSpace"]=NoColorSpace$1),te?ve.normalMap=he:ne&&(ve.normalMap=me),ve.normalMap&&(ve.normalMapType=TangentSpaceNormalMap,ve["normalMap-colorSpace"]=NoColorSpace$1),jsxRuntimeExports.jsx(ce,{ref:_,attach:"material",...ve,...ye,...se},K)}function Primitive({_ref:K,_key:_="Box",geometry:Z,hide:te,args:ne,materialType:ie="physical",material:{map:oe,mapRepeat:se,displacementMap:ae,normalMap:le,...ce}={},outlines:fe,onClick:de,...pe}){const he=reactExports.useRef(null),ge=K||he,me=Object.keys(ce).join(","),Ae=reactExports.useRef(1);reactExports.useLayoutEffect(()=>{Ae.current+=1},[ie,me]);const ye=useLoader(TextureLoader,oe||[]);oe&&se&&(ye.wrapS=ye.wrapT=RepeatWrapping,ye.repeat.set(...se));const{uplink:ve}=useSocket(),_e=reactExports.useCallback(Te=>{ve.publish({ts:Date.now(),etype:"ON_CLICK",value:{key:_}}),de==null||de(Te)},[de]);return te?null:jsxRuntimeExports.jsxs("mesh",{ref:ge,onClick:_e,...pe,children:[jsxRuntimeExports.jsx(Z,{attach:"geometry",args:ne}),jsxRuntimeExports.jsx(HeightMaterial,{_key:`${Ae.current}`,type:ie,displacementMap:ae,normalMap:le,normalScale:[1,1],displacementScale:1,map:oe&&ye,...ce}),fe?jsxRuntimeExports.jsx(Outlines,{...fe}):null]},_)}function Box(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"boxGeometry",...K})}function Capsule(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"capsuleGeometry",...K})}function Circle(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"circleGeometry",...K})}function Cone(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"coneGeometry",...K})}function Cylinder(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"cylinderGeometry",...K})}function Dodecahedron(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"dodecahedronGeometry",...K})}function Edges(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"edgesGeometry",...K})}function Extrude(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"extrudeGeometry",...K})}function Icosahedron(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"icosahedronGeometry",...K})}function Lathe(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"latheGeometry",...K})}function Octahedron(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"octahedronGeometry",...K})}function Plane(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"planeGeometry",...K})}function Polyhedron(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"polyhedronGeometry",...K})}function Ring(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"ringGeometry",...K})}function Shape(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"shapeGeometry",...K})}function Sphere(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"sphereGeometry",...K})}function Tetrahedron(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"tetrahedronGeometry",...K})}function Torus(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"torusGeometry",...K})}function TorusKnot(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"torusKnotGeometry",...K})}function Tube(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"tubeGeometry",...K})}function Wireframe(K){return jsxRuntimeExports.jsx(Primitive,{geometry:"wireframeGeometry",...K})}const VuerGroup=({_ref:K,_key:_,matrix:Z,scale:te,...ne})=>{const ie=reactExports.useRef(null),oe=K||ie;return reactExports.useLayoutEffect(()=>{const se=oe.current;if(se)return Z?(se.matrix.fromArray(Z),typeof te=="number"&&se.matrix.scale(te),se.matrixAutoUpdate=!1):se.matrixAutoUpdate=!0,()=>{se.matrixAutoUpdate=!0}},[Z,te]),jsxRuntimeExports.jsx("group",{ref:oe,scale:te,...ne},_)};function SkeletalGripper({_ref:K,color:_,pinchWidth:Z=.07,opacity:te=.9,hide:ne,...ie}){const oe=reactExports.useRef(null),se=K||oe;return ne?null:jsxRuntimeExports.jsxs(VuerGroup,{_ref:se,scale:1,...ie,children:[jsxRuntimeExports.jsxs("mesh",{position:[0,.07,0],rotation:[Math.PI/2,0,0],scale:[1,1,1],children:[jsxRuntimeExports.jsx("cylinderGeometry",{attach:"geometry",args:[.005,.005,Z*2,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{color:_||"#ffffff",transparent:!0,opacity:te})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.02,Z],scale:1,children:[jsxRuntimeExports.jsx("cylinderGeometry",{attach:"geometry",args:[.005,.005,.1,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#23aaff",transparent:!0,opacity:te})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.02,-Z],scale:1,children:[jsxRuntimeExports.jsx("cylinderGeometry",{attach:"geometry",args:[.005,.005,.1,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#ff5656",transparent:!0,opacity:te})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.09,0],rotation:[0,0,0],scale:[.8,1,1],children:[jsxRuntimeExports.jsx("cylinderGeometry",{attach:"geometry",args:[.01,.01,.06,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"gray",transparent:!0,opacity:te})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,0,0],rotation:[0,0,0],children:[jsxRuntimeExports.jsx("sphereGeometry",{attach:"geometry",args:[.01,32,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"green",transparent:!0,opacity:te})]})]})}class Fuse extends Store{constructor(_,Z){super(),this.reducers=this.fuse(this.reducers,_.reducers),this.reducers=this.fuse(this.reducers,Z.reducers),this.subscribers=this.fuse(this.subscribers,_.subscribers),this.subscribers=this.fuse(this.subscribers,Z.subscribers)}fuse(_,Z){const te={..._};return Object.keys(Z).forEach(ne=>{if(!te[ne])return te[ne]={...Z[ne]};Object.keys(Z[ne]).forEach(ie=>{if(!te[ne][ie])return te[ne][ie]=Z[ne][ie];te[ne][ie]=Z[ne][ie]})}),te}}class Combine extends Store{constructor(_,Z){super(),_.subscribe("*",te=>this.publish(te)),Z.subscribe("*",te=>this.publish(te))}}class EventEmitter{constructor(){ue(this,"listeners"),this.listeners={}}on(_,Z){return this.listeners[_]||(this.listeners[_]=[]),this.listeners[_].push(Z),()=>{this.off(_,Z)}}off(_,Z){this.listeners[_]&&(this.listeners[_]=this.listeners[_].filter(te=>te!==Z))}emit(_,Z){this.listeners[_]&&this.listeners[_].forEach(te=>te(Z))}}function imageToBase64(K){return new Promise((_,Z)=>{const te=new FileReader;te.onload=()=>{_(te.result)},te.onerror=ne=>{Z(ne)},te.readAsDataURL(K)})}/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function isNothing(K){return typeof K>"u"||K===null}function isObject$2(K){return typeof K=="object"&&K!==null}function toArray(K){return Array.isArray(K)?K:isNothing(K)?[]:[K]}function extend$3(K,_){var Z,te,ne,ie;if(_)for(ie=Object.keys(_),Z=0,te=ie.length;Z<te;Z+=1)ne=ie[Z],K[ne]=_[ne];return K}function repeat(K,_){var Z="",te;for(te=0;te<_;te+=1)Z+=K;return Z}function isNegativeZero(K){return K===0&&Number.NEGATIVE_INFINITY===1/K}var isNothing_1=isNothing,isObject_1=isObject$2,toArray_1=toArray,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend$3,common={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function formatError(K,_){var Z="",te=K.reason||"(unknown reason)";return K.mark?(K.mark.name&&(Z+='in "'+K.mark.name+'" '),Z+="("+(K.mark.line+1)+":"+(K.mark.column+1)+")",!_&&K.mark.snippet&&(Z+=`

`+K.mark.snippet),te+" "+Z):te}function YAMLException$1(K,_){Error.call(this),this.name="YAMLException",this.reason=K,this.mark=_,this.message=formatError(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}YAMLException$1.prototype=Object.create(Error.prototype);YAMLException$1.prototype.constructor=YAMLException$1;YAMLException$1.prototype.toString=function K(_){return this.name+": "+formatError(this,_)};var exception=YAMLException$1;function getLine(K,_,Z,te,ne){var ie="",oe="",se=Math.floor(ne/2)-1;return te-_>se&&(ie=" ... ",_=te-se+ie.length),Z-te>se&&(oe=" ...",Z=te+se-oe.length),{str:ie+K.slice(_,Z).replace(/\t/g,"→")+oe,pos:te-_+ie.length}}function padStart(K,_){return common.repeat(" ",_-K.length)+K}function makeSnippet(K,_){if(_=Object.create(_||null),!K.buffer)return null;_.maxLength||(_.maxLength=79),typeof _.indent!="number"&&(_.indent=1),typeof _.linesBefore!="number"&&(_.linesBefore=3),typeof _.linesAfter!="number"&&(_.linesAfter=2);for(var Z=/\r?\n|\r|\0/g,te=[0],ne=[],ie,oe=-1;ie=Z.exec(K.buffer);)ne.push(ie.index),te.push(ie.index+ie[0].length),K.position<=ie.index&&oe<0&&(oe=te.length-2);oe<0&&(oe=te.length-1);var se="",ae,le,ce=Math.min(K.line+_.linesAfter,ne.length).toString().length,fe=_.maxLength-(_.indent+ce+3);for(ae=1;ae<=_.linesBefore&&!(oe-ae<0);ae++)le=getLine(K.buffer,te[oe-ae],ne[oe-ae],K.position-(te[oe]-te[oe-ae]),fe),se=common.repeat(" ",_.indent)+padStart((K.line-ae+1).toString(),ce)+" | "+le.str+`
`+se;for(le=getLine(K.buffer,te[oe],ne[oe],K.position,fe),se+=common.repeat(" ",_.indent)+padStart((K.line+1).toString(),ce)+" | "+le.str+`
`,se+=common.repeat("-",_.indent+ce+3+le.pos)+`^
`,ae=1;ae<=_.linesAfter&&!(oe+ae>=ne.length);ae++)le=getLine(K.buffer,te[oe+ae],ne[oe+ae],K.position-(te[oe]-te[oe+ae]),fe),se+=common.repeat(" ",_.indent)+padStart((K.line+ae+1).toString(),ce)+" | "+le.str+`
`;return se.replace(/\n$/,"")}var snippet=makeSnippet,TYPE_CONSTRUCTOR_OPTIONS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(K){var _={};return K!==null&&Object.keys(K).forEach(function(Z){K[Z].forEach(function(te){_[String(te)]=Z})}),_}function Type$1(K,_){if(_=_||{},Object.keys(_).forEach(function(Z){if(TYPE_CONSTRUCTOR_OPTIONS.indexOf(Z)===-1)throw new exception('Unknown option "'+Z+'" is met in definition of "'+K+'" YAML type.')}),this.options=_,this.tag=K,this.kind=_.kind||null,this.resolve=_.resolve||function(){return!0},this.construct=_.construct||function(Z){return Z},this.instanceOf=_.instanceOf||null,this.predicate=_.predicate||null,this.represent=_.represent||null,this.representName=_.representName||null,this.defaultStyle=_.defaultStyle||null,this.multi=_.multi||!1,this.styleAliases=compileStyleAliases(_.styleAliases||null),YAML_NODE_KINDS.indexOf(this.kind)===-1)throw new exception('Unknown kind "'+this.kind+'" is specified for "'+K+'" YAML type.')}var type=Type$1;function compileList(K,_){var Z=[];return K[_].forEach(function(te){var ne=Z.length;Z.forEach(function(ie,oe){ie.tag===te.tag&&ie.kind===te.kind&&ie.multi===te.multi&&(ne=oe)}),Z[ne]=te}),Z}function compileMap(){var K={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},_,Z;function te(ne){ne.multi?(K.multi[ne.kind].push(ne),K.multi.fallback.push(ne)):K[ne.kind][ne.tag]=K.fallback[ne.tag]=ne}for(_=0,Z=arguments.length;_<Z;_+=1)arguments[_].forEach(te);return K}function Schema$1$1(K){return this.extend(K)}Schema$1$1.prototype.extend=function K(_){var Z=[],te=[];if(_ instanceof type)te.push(_);else if(Array.isArray(_))te=te.concat(_);else if(_&&(Array.isArray(_.implicit)||Array.isArray(_.explicit)))_.implicit&&(Z=Z.concat(_.implicit)),_.explicit&&(te=te.concat(_.explicit));else throw new exception("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");Z.forEach(function(ie){if(!(ie instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(ie.loadKind&&ie.loadKind!=="scalar")throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(ie.multi)throw new exception("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),te.forEach(function(ie){if(!(ie instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var ne=Object.create(Schema$1$1.prototype);return ne.implicit=(this.implicit||[]).concat(Z),ne.explicit=(this.explicit||[]).concat(te),ne.compiledImplicit=compileList(ne,"implicit"),ne.compiledExplicit=compileList(ne,"explicit"),ne.compiledTypeMap=compileMap(ne.compiledImplicit,ne.compiledExplicit),ne};var schema$1=Schema$1$1,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(K){return K!==null?K:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(K){return K!==null?K:[]}}),map=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(K){return K!==null?K:{}}}),failsafe=new schema$1({explicit:[str,seq,map]});function resolveYamlNull(K){if(K===null)return!0;var _=K.length;return _===1&&K==="~"||_===4&&(K==="null"||K==="Null"||K==="NULL")}function constructYamlNull(){return null}function isNull(K){return K===null}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function resolveYamlBoolean(K){if(K===null)return!1;var _=K.length;return _===4&&(K==="true"||K==="True"||K==="TRUE")||_===5&&(K==="false"||K==="False"||K==="FALSE")}function constructYamlBoolean(K){return K==="true"||K==="True"||K==="TRUE"}function isBoolean(K){return Object.prototype.toString.call(K)==="[object Boolean]"}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean,represent:{lowercase:function(K){return K?"true":"false"},uppercase:function(K){return K?"TRUE":"FALSE"},camelcase:function(K){return K?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(K){return 48<=K&&K<=57||65<=K&&K<=70||97<=K&&K<=102}function isOctCode(K){return 48<=K&&K<=55}function isDecCode(K){return 48<=K&&K<=57}function resolveYamlInteger(K){if(K===null)return!1;var _=K.length,Z=0,te=!1,ne;if(!_)return!1;if(ne=K[Z],(ne==="-"||ne==="+")&&(ne=K[++Z]),ne==="0"){if(Z+1===_)return!0;if(ne=K[++Z],ne==="b"){for(Z++;Z<_;Z++)if(ne=K[Z],ne!=="_"){if(ne!=="0"&&ne!=="1")return!1;te=!0}return te&&ne!=="_"}if(ne==="x"){for(Z++;Z<_;Z++)if(ne=K[Z],ne!=="_"){if(!isHexCode(K.charCodeAt(Z)))return!1;te=!0}return te&&ne!=="_"}if(ne==="o"){for(Z++;Z<_;Z++)if(ne=K[Z],ne!=="_"){if(!isOctCode(K.charCodeAt(Z)))return!1;te=!0}return te&&ne!=="_"}}if(ne==="_")return!1;for(;Z<_;Z++)if(ne=K[Z],ne!=="_"){if(!isDecCode(K.charCodeAt(Z)))return!1;te=!0}return!(!te||ne==="_")}function constructYamlInteger(K){var _=K,Z=1,te;if(_.indexOf("_")!==-1&&(_=_.replace(/_/g,"")),te=_[0],(te==="-"||te==="+")&&(te==="-"&&(Z=-1),_=_.slice(1),te=_[0]),_==="0")return 0;if(te==="0"){if(_[1]==="b")return Z*parseInt(_.slice(2),2);if(_[1]==="x")return Z*parseInt(_.slice(2),16);if(_[1]==="o")return Z*parseInt(_.slice(2),8)}return Z*parseInt(_,10)}function isInteger(K){return Object.prototype.toString.call(K)==="[object Number]"&&K%1===0&&!common.isNegativeZero(K)}var int=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(K){return K>=0?"0b"+K.toString(2):"-0b"+K.toString(2).slice(1)},octal:function(K){return K>=0?"0o"+K.toString(8):"-0o"+K.toString(8).slice(1)},decimal:function(K){return K.toString(10)},hexadecimal:function(K){return K>=0?"0x"+K.toString(16).toUpperCase():"-0x"+K.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(K){return!(K===null||!YAML_FLOAT_PATTERN.test(K)||K[K.length-1]==="_")}function constructYamlFloat(K){var _,Z;return _=K.replace(/_/g,"").toLowerCase(),Z=_[0]==="-"?-1:1,"+-".indexOf(_[0])>=0&&(_=_.slice(1)),_===".inf"?Z===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:_===".nan"?NaN:Z*parseFloat(_,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(K,_){var Z;if(isNaN(K))switch(_){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===K)switch(_){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===K)switch(_){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(K))return"-0.0";return Z=K.toString(10),SCIENTIFIC_WITHOUT_DOT.test(Z)?Z.replace("e",".e"):Z}function isFloat(K){return Object.prototype.toString.call(K)==="[object Number]"&&(K%1!==0||common.isNegativeZero(K))}var float=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=failsafe.extend({implicit:[_null,bool,int,float]}),core$1=json,YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(K){return K===null?!1:YAML_DATE_REGEXP.exec(K)!==null||YAML_TIMESTAMP_REGEXP.exec(K)!==null}function constructYamlTimestamp(K){var _,Z,te,ne,ie,oe,se,ae=0,le=null,ce,fe,de;if(_=YAML_DATE_REGEXP.exec(K),_===null&&(_=YAML_TIMESTAMP_REGEXP.exec(K)),_===null)throw new Error("Date resolve error");if(Z=+_[1],te=+_[2]-1,ne=+_[3],!_[4])return new Date(Date.UTC(Z,te,ne));if(ie=+_[4],oe=+_[5],se=+_[6],_[7]){for(ae=_[7].slice(0,3);ae.length<3;)ae+="0";ae=+ae}return _[9]&&(ce=+_[10],fe=+(_[11]||0),le=(ce*60+fe)*6e4,_[9]==="-"&&(le=-le)),de=new Date(Date.UTC(Z,te,ne,ie,oe,se,ae)),le&&de.setTime(de.getTime()-le),de}function representYamlTimestamp(K){return K.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(K){return K==="<<"||K===null}var merge$5=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),BASE64_MAP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function resolveYamlBinary(K){if(K===null)return!1;var _,Z,te=0,ne=K.length,ie=BASE64_MAP;for(Z=0;Z<ne;Z++)if(_=ie.indexOf(K.charAt(Z)),!(_>64)){if(_<0)return!1;te+=6}return te%8===0}function constructYamlBinary(K){var _,Z,te=K.replace(/[\r\n=]/g,""),ne=te.length,ie=BASE64_MAP,oe=0,se=[];for(_=0;_<ne;_++)_%4===0&&_&&(se.push(oe>>16&255),se.push(oe>>8&255),se.push(oe&255)),oe=oe<<6|ie.indexOf(te.charAt(_));return Z=ne%4*6,Z===0?(se.push(oe>>16&255),se.push(oe>>8&255),se.push(oe&255)):Z===18?(se.push(oe>>10&255),se.push(oe>>2&255)):Z===12&&se.push(oe>>4&255),new Uint8Array(se)}function representYamlBinary(K){var _="",Z=0,te,ne,ie=K.length,oe=BASE64_MAP;for(te=0;te<ie;te++)te%3===0&&te&&(_+=oe[Z>>18&63],_+=oe[Z>>12&63],_+=oe[Z>>6&63],_+=oe[Z&63]),Z=(Z<<8)+K[te];return ne=ie%3,ne===0?(_+=oe[Z>>18&63],_+=oe[Z>>12&63],_+=oe[Z>>6&63],_+=oe[Z&63]):ne===2?(_+=oe[Z>>10&63],_+=oe[Z>>4&63],_+=oe[Z<<2&63],_+=oe[64]):ne===1&&(_+=oe[Z>>2&63],_+=oe[Z<<4&63],_+=oe[64],_+=oe[64]),_}function isBinary(K){return Object.prototype.toString.call(K)==="[object Uint8Array]"}var binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty$3=Object.prototype.hasOwnProperty,_toString$2=Object.prototype.toString;function resolveYamlOmap(K){if(K===null)return!0;var _=[],Z,te,ne,ie,oe,se=K;for(Z=0,te=se.length;Z<te;Z+=1){if(ne=se[Z],oe=!1,_toString$2.call(ne)!=="[object Object]")return!1;for(ie in ne)if(_hasOwnProperty$3.call(ne,ie))if(!oe)oe=!0;else return!1;if(!oe)return!1;if(_.indexOf(ie)===-1)_.push(ie);else return!1}return!0}function constructYamlOmap(K){return K!==null?K:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(K){if(K===null)return!0;var _,Z,te,ne,ie,oe=K;for(ie=new Array(oe.length),_=0,Z=oe.length;_<Z;_+=1){if(te=oe[_],_toString$1.call(te)!=="[object Object]"||(ne=Object.keys(te),ne.length!==1))return!1;ie[_]=[ne[0],te[ne[0]]]}return!0}function constructYamlPairs(K){if(K===null)return[];var _,Z,te,ne,ie,oe=K;for(ie=new Array(oe.length),_=0,Z=oe.length;_<Z;_+=1)te=oe[_],ne=Object.keys(te),ie[_]=[ne[0],te[ne[0]]];return ie}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$2=Object.prototype.hasOwnProperty;function resolveYamlSet(K){if(K===null)return!0;var _,Z=K;for(_ in Z)if(_hasOwnProperty$2.call(Z,_)&&Z[_]!==null)return!1;return!0}function constructYamlSet(K){return K!==null?K:{}}var set=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),_default=core$1.extend({implicit:[timestamp,merge$5],explicit:[binary,omap,pairs,set]}),_hasOwnProperty$1=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(K){return Object.prototype.toString.call(K)}function is_EOL(K){return K===10||K===13}function is_WHITE_SPACE(K){return K===9||K===32}function is_WS_OR_EOL(K){return K===9||K===32||K===10||K===13}function is_FLOW_INDICATOR(K){return K===44||K===91||K===93||K===123||K===125}function fromHexCode(K){var _;return 48<=K&&K<=57?K-48:(_=K|32,97<=_&&_<=102?_-97+10:-1)}function escapedHexLen(K){return K===120?2:K===117?4:K===85?8:0}function fromDecimalCode(K){return 48<=K&&K<=57?K-48:-1}function simpleEscapeSequence(K){return K===48?"\0":K===97?"\x07":K===98?"\b":K===116||K===9?"	":K===110?`
`:K===118?"\v":K===102?"\f":K===114?"\r":K===101?"\x1B":K===32?" ":K===34?'"':K===47?"/":K===92?"\\":K===78?"":K===95?" ":K===76?"\u2028":K===80?"\u2029":""}function charFromCodepoint(K){return K<=65535?String.fromCharCode(K):String.fromCharCode((K-65536>>10)+55296,(K-65536&1023)+56320)}var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256);for(var i$1=0;i$1<256;i$1++)simpleEscapeCheck[i$1]=simpleEscapeSequence(i$1)?1:0,simpleEscapeMap[i$1]=simpleEscapeSequence(i$1);function State$1(K,_){this.input=K,this.filename=_.filename||null,this.schema=_.schema||_default,this.onWarning=_.onWarning||null,this.legacy=_.legacy||!1,this.json=_.json||!1,this.listener=_.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=K.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function generateError(K,_){var Z={name:K.filename,buffer:K.input.slice(0,-1),position:K.position,line:K.line,column:K.position-K.lineStart};return Z.snippet=snippet(Z),new exception(_,Z)}function throwError(K,_){throw generateError(K,_)}function throwWarning(K,_){K.onWarning&&K.onWarning.call(null,generateError(K,_))}var directiveHandlers={YAML:function K(_,Z,te){var ne,ie,oe;_.version!==null&&throwError(_,"duplication of %YAML directive"),te.length!==1&&throwError(_,"YAML directive accepts exactly one argument"),ne=/^([0-9]+)\.([0-9]+)$/.exec(te[0]),ne===null&&throwError(_,"ill-formed argument of the YAML directive"),ie=parseInt(ne[1],10),oe=parseInt(ne[2],10),ie!==1&&throwError(_,"unacceptable YAML version of the document"),_.version=te[0],_.checkLineBreaks=oe<2,oe!==1&&oe!==2&&throwWarning(_,"unsupported YAML version of the document")},TAG:function K(_,Z,te){var ne,ie;te.length!==2&&throwError(_,"TAG directive accepts exactly two arguments"),ne=te[0],ie=te[1],PATTERN_TAG_HANDLE.test(ne)||throwError(_,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$1.call(_.tagMap,ne)&&throwError(_,'there is a previously declared suffix for "'+ne+'" tag handle'),PATTERN_TAG_URI.test(ie)||throwError(_,"ill-formed tag prefix (second argument) of the TAG directive");try{ie=decodeURIComponent(ie)}catch{throwError(_,"tag prefix is malformed: "+ie)}_.tagMap[ne]=ie}};function captureSegment(K,_,Z,te){var ne,ie,oe,se;if(_<Z){if(se=K.input.slice(_,Z),te)for(ne=0,ie=se.length;ne<ie;ne+=1)oe=se.charCodeAt(ne),oe===9||32<=oe&&oe<=1114111||throwError(K,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(se)&&throwError(K,"the stream contains non-printable characters");K.result+=se}}function mergeMappings(K,_,Z,te){var ne,ie,oe,se;for(common.isObject(Z)||throwError(K,"cannot merge mappings; the provided source object is unacceptable"),ne=Object.keys(Z),oe=0,se=ne.length;oe<se;oe+=1)ie=ne[oe],_hasOwnProperty$1.call(_,ie)||(_[ie]=Z[ie],te[ie]=!0)}function storeMappingPair(K,_,Z,te,ne,ie,oe,se,ae){var le,ce;if(Array.isArray(ne))for(ne=Array.prototype.slice.call(ne),le=0,ce=ne.length;le<ce;le+=1)Array.isArray(ne[le])&&throwError(K,"nested arrays are not supported inside keys"),typeof ne=="object"&&_class(ne[le])==="[object Object]"&&(ne[le]="[object Object]");if(typeof ne=="object"&&_class(ne)==="[object Object]"&&(ne="[object Object]"),ne=String(ne),_===null&&(_={}),te==="tag:yaml.org,2002:merge")if(Array.isArray(ie))for(le=0,ce=ie.length;le<ce;le+=1)mergeMappings(K,_,ie[le],Z);else mergeMappings(K,_,ie,Z);else!K.json&&!_hasOwnProperty$1.call(Z,ne)&&_hasOwnProperty$1.call(_,ne)&&(K.line=oe||K.line,K.lineStart=se||K.lineStart,K.position=ae||K.position,throwError(K,"duplicated mapping key")),ne==="__proto__"?Object.defineProperty(_,ne,{configurable:!0,enumerable:!0,writable:!0,value:ie}):_[ne]=ie,delete Z[ne];return _}function readLineBreak(K){var _;_=K.input.charCodeAt(K.position),_===10?K.position++:_===13?(K.position++,K.input.charCodeAt(K.position)===10&&K.position++):throwError(K,"a line break is expected"),K.line+=1,K.lineStart=K.position,K.firstTabInLine=-1}function skipSeparationSpace(K,_,Z){for(var te=0,ne=K.input.charCodeAt(K.position);ne!==0;){for(;is_WHITE_SPACE(ne);)ne===9&&K.firstTabInLine===-1&&(K.firstTabInLine=K.position),ne=K.input.charCodeAt(++K.position);if(_&&ne===35)do ne=K.input.charCodeAt(++K.position);while(ne!==10&&ne!==13&&ne!==0);if(is_EOL(ne))for(readLineBreak(K),ne=K.input.charCodeAt(K.position),te++,K.lineIndent=0;ne===32;)K.lineIndent++,ne=K.input.charCodeAt(++K.position);else break}return Z!==-1&&te!==0&&K.lineIndent<Z&&throwWarning(K,"deficient indentation"),te}function testDocumentSeparator(K){var _=K.position,Z;return Z=K.input.charCodeAt(_),!!((Z===45||Z===46)&&Z===K.input.charCodeAt(_+1)&&Z===K.input.charCodeAt(_+2)&&(_+=3,Z=K.input.charCodeAt(_),Z===0||is_WS_OR_EOL(Z)))}function writeFoldedLines(K,_){_===1?K.result+=" ":_>1&&(K.result+=common.repeat(`
`,_-1))}function readPlainScalar(K,_,Z){var te,ne,ie,oe,se,ae,le,ce,fe=K.kind,de=K.result,pe;if(pe=K.input.charCodeAt(K.position),is_WS_OR_EOL(pe)||is_FLOW_INDICATOR(pe)||pe===35||pe===38||pe===42||pe===33||pe===124||pe===62||pe===39||pe===34||pe===37||pe===64||pe===96||(pe===63||pe===45)&&(ne=K.input.charCodeAt(K.position+1),is_WS_OR_EOL(ne)||Z&&is_FLOW_INDICATOR(ne)))return!1;for(K.kind="scalar",K.result="",ie=oe=K.position,se=!1;pe!==0;){if(pe===58){if(ne=K.input.charCodeAt(K.position+1),is_WS_OR_EOL(ne)||Z&&is_FLOW_INDICATOR(ne))break}else if(pe===35){if(te=K.input.charCodeAt(K.position-1),is_WS_OR_EOL(te))break}else{if(K.position===K.lineStart&&testDocumentSeparator(K)||Z&&is_FLOW_INDICATOR(pe))break;if(is_EOL(pe))if(ae=K.line,le=K.lineStart,ce=K.lineIndent,skipSeparationSpace(K,!1,-1),K.lineIndent>=_){se=!0,pe=K.input.charCodeAt(K.position);continue}else{K.position=oe,K.line=ae,K.lineStart=le,K.lineIndent=ce;break}}se&&(captureSegment(K,ie,oe,!1),writeFoldedLines(K,K.line-ae),ie=oe=K.position,se=!1),is_WHITE_SPACE(pe)||(oe=K.position+1),pe=K.input.charCodeAt(++K.position)}return captureSegment(K,ie,oe,!1),K.result?!0:(K.kind=fe,K.result=de,!1)}function readSingleQuotedScalar(K,_){var Z,te,ne;if(Z=K.input.charCodeAt(K.position),Z!==39)return!1;for(K.kind="scalar",K.result="",K.position++,te=ne=K.position;(Z=K.input.charCodeAt(K.position))!==0;)if(Z===39)if(captureSegment(K,te,K.position,!0),Z=K.input.charCodeAt(++K.position),Z===39)te=K.position,K.position++,ne=K.position;else return!0;else is_EOL(Z)?(captureSegment(K,te,ne,!0),writeFoldedLines(K,skipSeparationSpace(K,!1,_)),te=ne=K.position):K.position===K.lineStart&&testDocumentSeparator(K)?throwError(K,"unexpected end of the document within a single quoted scalar"):(K.position++,ne=K.position);throwError(K,"unexpected end of the stream within a single quoted scalar")}function readDoubleQuotedScalar(K,_){var Z,te,ne,ie,oe,se;if(se=K.input.charCodeAt(K.position),se!==34)return!1;for(K.kind="scalar",K.result="",K.position++,Z=te=K.position;(se=K.input.charCodeAt(K.position))!==0;){if(se===34)return captureSegment(K,Z,K.position,!0),K.position++,!0;if(se===92){if(captureSegment(K,Z,K.position,!0),se=K.input.charCodeAt(++K.position),is_EOL(se))skipSeparationSpace(K,!1,_);else if(se<256&&simpleEscapeCheck[se])K.result+=simpleEscapeMap[se],K.position++;else if((oe=escapedHexLen(se))>0){for(ne=oe,ie=0;ne>0;ne--)se=K.input.charCodeAt(++K.position),(oe=fromHexCode(se))>=0?ie=(ie<<4)+oe:throwError(K,"expected hexadecimal character");K.result+=charFromCodepoint(ie),K.position++}else throwError(K,"unknown escape sequence");Z=te=K.position}else is_EOL(se)?(captureSegment(K,Z,te,!0),writeFoldedLines(K,skipSeparationSpace(K,!1,_)),Z=te=K.position):K.position===K.lineStart&&testDocumentSeparator(K)?throwError(K,"unexpected end of the document within a double quoted scalar"):(K.position++,te=K.position)}throwError(K,"unexpected end of the stream within a double quoted scalar")}function readFlowCollection(K,_){var Z=!0,te,ne,ie,oe=K.tag,se,ae=K.anchor,le,ce,fe,de,pe,he=Object.create(null),ge,me,Ae,ye;if(ye=K.input.charCodeAt(K.position),ye===91)ce=93,pe=!1,se=[];else if(ye===123)ce=125,pe=!0,se={};else return!1;for(K.anchor!==null&&(K.anchorMap[K.anchor]=se),ye=K.input.charCodeAt(++K.position);ye!==0;){if(skipSeparationSpace(K,!0,_),ye=K.input.charCodeAt(K.position),ye===ce)return K.position++,K.tag=oe,K.anchor=ae,K.kind=pe?"mapping":"sequence",K.result=se,!0;Z?ye===44&&throwError(K,"expected the node content, but found ','"):throwError(K,"missed comma between flow collection entries"),me=ge=Ae=null,fe=de=!1,ye===63&&(le=K.input.charCodeAt(K.position+1),is_WS_OR_EOL(le)&&(fe=de=!0,K.position++,skipSeparationSpace(K,!0,_))),te=K.line,ne=K.lineStart,ie=K.position,composeNode(K,_,CONTEXT_FLOW_IN,!1,!0),me=K.tag,ge=K.result,skipSeparationSpace(K,!0,_),ye=K.input.charCodeAt(K.position),(de||K.line===te)&&ye===58&&(fe=!0,ye=K.input.charCodeAt(++K.position),skipSeparationSpace(K,!0,_),composeNode(K,_,CONTEXT_FLOW_IN,!1,!0),Ae=K.result),pe?storeMappingPair(K,se,he,me,ge,Ae,te,ne,ie):fe?se.push(storeMappingPair(K,null,he,me,ge,Ae,te,ne,ie)):se.push(ge),skipSeparationSpace(K,!0,_),ye=K.input.charCodeAt(K.position),ye===44?(Z=!0,ye=K.input.charCodeAt(++K.position)):Z=!1}throwError(K,"unexpected end of the stream within a flow collection")}function readBlockScalar(K,_){var Z,te,ne=CHOMPING_CLIP,ie=!1,oe=!1,se=_,ae=0,le=!1,ce,fe;if(fe=K.input.charCodeAt(K.position),fe===124)te=!1;else if(fe===62)te=!0;else return!1;for(K.kind="scalar",K.result="";fe!==0;)if(fe=K.input.charCodeAt(++K.position),fe===43||fe===45)CHOMPING_CLIP===ne?ne=fe===43?CHOMPING_KEEP:CHOMPING_STRIP:throwError(K,"repeat of a chomping mode identifier");else if((ce=fromDecimalCode(fe))>=0)ce===0?throwError(K,"bad explicit indentation width of a block scalar; it cannot be less than one"):oe?throwError(K,"repeat of an indentation width identifier"):(se=_+ce-1,oe=!0);else break;if(is_WHITE_SPACE(fe)){do fe=K.input.charCodeAt(++K.position);while(is_WHITE_SPACE(fe));if(fe===35)do fe=K.input.charCodeAt(++K.position);while(!is_EOL(fe)&&fe!==0)}for(;fe!==0;){for(readLineBreak(K),K.lineIndent=0,fe=K.input.charCodeAt(K.position);(!oe||K.lineIndent<se)&&fe===32;)K.lineIndent++,fe=K.input.charCodeAt(++K.position);if(!oe&&K.lineIndent>se&&(se=K.lineIndent),is_EOL(fe)){ae++;continue}if(K.lineIndent<se){ne===CHOMPING_KEEP?K.result+=common.repeat(`
`,ie?1+ae:ae):ne===CHOMPING_CLIP&&ie&&(K.result+=`
`);break}for(te?is_WHITE_SPACE(fe)?(le=!0,K.result+=common.repeat(`
`,ie?1+ae:ae)):le?(le=!1,K.result+=common.repeat(`
`,ae+1)):ae===0?ie&&(K.result+=" "):K.result+=common.repeat(`
`,ae):K.result+=common.repeat(`
`,ie?1+ae:ae),ie=!0,oe=!0,ae=0,Z=K.position;!is_EOL(fe)&&fe!==0;)fe=K.input.charCodeAt(++K.position);captureSegment(K,Z,K.position,!1)}return!0}function readBlockSequence(K,_){var Z,te=K.tag,ne=K.anchor,ie=[],oe,se=!1,ae;if(K.firstTabInLine!==-1)return!1;for(K.anchor!==null&&(K.anchorMap[K.anchor]=ie),ae=K.input.charCodeAt(K.position);ae!==0&&(K.firstTabInLine!==-1&&(K.position=K.firstTabInLine,throwError(K,"tab characters must not be used in indentation")),!(ae!==45||(oe=K.input.charCodeAt(K.position+1),!is_WS_OR_EOL(oe))));){if(se=!0,K.position++,skipSeparationSpace(K,!0,-1)&&K.lineIndent<=_){ie.push(null),ae=K.input.charCodeAt(K.position);continue}if(Z=K.line,composeNode(K,_,CONTEXT_BLOCK_IN,!1,!0),ie.push(K.result),skipSeparationSpace(K,!0,-1),ae=K.input.charCodeAt(K.position),(K.line===Z||K.lineIndent>_)&&ae!==0)throwError(K,"bad indentation of a sequence entry");else if(K.lineIndent<_)break}return se?(K.tag=te,K.anchor=ne,K.kind="sequence",K.result=ie,!0):!1}function readBlockMapping(K,_,Z){var te,ne,ie,oe,se,ae,le=K.tag,ce=K.anchor,fe={},de=Object.create(null),pe=null,he=null,ge=null,me=!1,Ae=!1,ye;if(K.firstTabInLine!==-1)return!1;for(K.anchor!==null&&(K.anchorMap[K.anchor]=fe),ye=K.input.charCodeAt(K.position);ye!==0;){if(!me&&K.firstTabInLine!==-1&&(K.position=K.firstTabInLine,throwError(K,"tab characters must not be used in indentation")),te=K.input.charCodeAt(K.position+1),ie=K.line,(ye===63||ye===58)&&is_WS_OR_EOL(te))ye===63?(me&&(storeMappingPair(K,fe,de,pe,he,null,oe,se,ae),pe=he=ge=null),Ae=!0,me=!0,ne=!0):me?(me=!1,ne=!0):throwError(K,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),K.position+=1,ye=te;else{if(oe=K.line,se=K.lineStart,ae=K.position,!composeNode(K,Z,CONTEXT_FLOW_OUT,!1,!0))break;if(K.line===ie){for(ye=K.input.charCodeAt(K.position);is_WHITE_SPACE(ye);)ye=K.input.charCodeAt(++K.position);if(ye===58)ye=K.input.charCodeAt(++K.position),is_WS_OR_EOL(ye)||throwError(K,"a whitespace character is expected after the key-value separator within a block mapping"),me&&(storeMappingPair(K,fe,de,pe,he,null,oe,se,ae),pe=he=ge=null),Ae=!0,me=!1,ne=!1,pe=K.tag,he=K.result;else if(Ae)throwError(K,"can not read an implicit mapping pair; a colon is missed");else return K.tag=le,K.anchor=ce,!0}else if(Ae)throwError(K,"can not read a block mapping entry; a multiline key may not be an implicit key");else return K.tag=le,K.anchor=ce,!0}if((K.line===ie||K.lineIndent>_)&&(me&&(oe=K.line,se=K.lineStart,ae=K.position),composeNode(K,_,CONTEXT_BLOCK_OUT,!0,ne)&&(me?he=K.result:ge=K.result),me||(storeMappingPair(K,fe,de,pe,he,ge,oe,se,ae),pe=he=ge=null),skipSeparationSpace(K,!0,-1),ye=K.input.charCodeAt(K.position)),(K.line===ie||K.lineIndent>_)&&ye!==0)throwError(K,"bad indentation of a mapping entry");else if(K.lineIndent<_)break}return me&&storeMappingPair(K,fe,de,pe,he,null,oe,se,ae),Ae&&(K.tag=le,K.anchor=ce,K.kind="mapping",K.result=fe),Ae}function readTagProperty(K){var _,Z=!1,te=!1,ne,ie,oe;if(oe=K.input.charCodeAt(K.position),oe!==33)return!1;if(K.tag!==null&&throwError(K,"duplication of a tag property"),oe=K.input.charCodeAt(++K.position),oe===60?(Z=!0,oe=K.input.charCodeAt(++K.position)):oe===33?(te=!0,ne="!!",oe=K.input.charCodeAt(++K.position)):ne="!",_=K.position,Z){do oe=K.input.charCodeAt(++K.position);while(oe!==0&&oe!==62);K.position<K.length?(ie=K.input.slice(_,K.position),oe=K.input.charCodeAt(++K.position)):throwError(K,"unexpected end of the stream within a verbatim tag")}else{for(;oe!==0&&!is_WS_OR_EOL(oe);)oe===33&&(te?throwError(K,"tag suffix cannot contain exclamation marks"):(ne=K.input.slice(_-1,K.position+1),PATTERN_TAG_HANDLE.test(ne)||throwError(K,"named tag handle cannot contain such characters"),te=!0,_=K.position+1)),oe=K.input.charCodeAt(++K.position);ie=K.input.slice(_,K.position),PATTERN_FLOW_INDICATORS.test(ie)&&throwError(K,"tag suffix cannot contain flow indicator characters")}ie&&!PATTERN_TAG_URI.test(ie)&&throwError(K,"tag name cannot contain such characters: "+ie);try{ie=decodeURIComponent(ie)}catch{throwError(K,"tag name is malformed: "+ie)}return Z?K.tag=ie:_hasOwnProperty$1.call(K.tagMap,ne)?K.tag=K.tagMap[ne]+ie:ne==="!"?K.tag="!"+ie:ne==="!!"?K.tag="tag:yaml.org,2002:"+ie:throwError(K,'undeclared tag handle "'+ne+'"'),!0}function readAnchorProperty(K){var _,Z;if(Z=K.input.charCodeAt(K.position),Z!==38)return!1;for(K.anchor!==null&&throwError(K,"duplication of an anchor property"),Z=K.input.charCodeAt(++K.position),_=K.position;Z!==0&&!is_WS_OR_EOL(Z)&&!is_FLOW_INDICATOR(Z);)Z=K.input.charCodeAt(++K.position);return K.position===_&&throwError(K,"name of an anchor node must contain at least one character"),K.anchor=K.input.slice(_,K.position),!0}function readAlias(K){var _,Z,te;if(te=K.input.charCodeAt(K.position),te!==42)return!1;for(te=K.input.charCodeAt(++K.position),_=K.position;te!==0&&!is_WS_OR_EOL(te)&&!is_FLOW_INDICATOR(te);)te=K.input.charCodeAt(++K.position);return K.position===_&&throwError(K,"name of an alias node must contain at least one character"),Z=K.input.slice(_,K.position),_hasOwnProperty$1.call(K.anchorMap,Z)||throwError(K,'unidentified alias "'+Z+'"'),K.result=K.anchorMap[Z],skipSeparationSpace(K,!0,-1),!0}function composeNode(K,_,Z,te,ne){var ie,oe,se,ae=1,le=!1,ce=!1,fe,de,pe,he,ge,me;if(K.listener!==null&&K.listener("open",K),K.tag=null,K.anchor=null,K.kind=null,K.result=null,ie=oe=se=CONTEXT_BLOCK_OUT===Z||CONTEXT_BLOCK_IN===Z,te&&skipSeparationSpace(K,!0,-1)&&(le=!0,K.lineIndent>_?ae=1:K.lineIndent===_?ae=0:K.lineIndent<_&&(ae=-1)),ae===1)for(;readTagProperty(K)||readAnchorProperty(K);)skipSeparationSpace(K,!0,-1)?(le=!0,se=ie,K.lineIndent>_?ae=1:K.lineIndent===_?ae=0:K.lineIndent<_&&(ae=-1)):se=!1;if(se&&(se=le||ne),(ae===1||CONTEXT_BLOCK_OUT===Z)&&(CONTEXT_FLOW_IN===Z||CONTEXT_FLOW_OUT===Z?ge=_:ge=_+1,me=K.position-K.lineStart,ae===1?se&&(readBlockSequence(K,me)||readBlockMapping(K,me,ge))||readFlowCollection(K,ge)?ce=!0:(oe&&readBlockScalar(K,ge)||readSingleQuotedScalar(K,ge)||readDoubleQuotedScalar(K,ge)?ce=!0:readAlias(K)?(ce=!0,(K.tag!==null||K.anchor!==null)&&throwError(K,"alias node should not have any properties")):readPlainScalar(K,ge,CONTEXT_FLOW_IN===Z)&&(ce=!0,K.tag===null&&(K.tag="?")),K.anchor!==null&&(K.anchorMap[K.anchor]=K.result)):ae===0&&(ce=se&&readBlockSequence(K,me))),K.tag===null)K.anchor!==null&&(K.anchorMap[K.anchor]=K.result);else if(K.tag==="?"){for(K.result!==null&&K.kind!=="scalar"&&throwError(K,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+K.kind+'"'),fe=0,de=K.implicitTypes.length;fe<de;fe+=1)if(he=K.implicitTypes[fe],he.resolve(K.result)){K.result=he.construct(K.result),K.tag=he.tag,K.anchor!==null&&(K.anchorMap[K.anchor]=K.result);break}}else if(K.tag!=="!"){if(_hasOwnProperty$1.call(K.typeMap[K.kind||"fallback"],K.tag))he=K.typeMap[K.kind||"fallback"][K.tag];else for(he=null,pe=K.typeMap.multi[K.kind||"fallback"],fe=0,de=pe.length;fe<de;fe+=1)if(K.tag.slice(0,pe[fe].tag.length)===pe[fe].tag){he=pe[fe];break}he||throwError(K,"unknown tag !<"+K.tag+">"),K.result!==null&&he.kind!==K.kind&&throwError(K,"unacceptable node kind for !<"+K.tag+'> tag; it should be "'+he.kind+'", not "'+K.kind+'"'),he.resolve(K.result,K.tag)?(K.result=he.construct(K.result,K.tag),K.anchor!==null&&(K.anchorMap[K.anchor]=K.result)):throwError(K,"cannot resolve a node with !<"+K.tag+"> explicit tag")}return K.listener!==null&&K.listener("close",K),K.tag!==null||K.anchor!==null||ce}function readDocument(K){var _=K.position,Z,te,ne,ie=!1,oe;for(K.version=null,K.checkLineBreaks=K.legacy,K.tagMap=Object.create(null),K.anchorMap=Object.create(null);(oe=K.input.charCodeAt(K.position))!==0&&(skipSeparationSpace(K,!0,-1),oe=K.input.charCodeAt(K.position),!(K.lineIndent>0||oe!==37));){for(ie=!0,oe=K.input.charCodeAt(++K.position),Z=K.position;oe!==0&&!is_WS_OR_EOL(oe);)oe=K.input.charCodeAt(++K.position);for(te=K.input.slice(Z,K.position),ne=[],te.length<1&&throwError(K,"directive name must not be less than one character in length");oe!==0;){for(;is_WHITE_SPACE(oe);)oe=K.input.charCodeAt(++K.position);if(oe===35){do oe=K.input.charCodeAt(++K.position);while(oe!==0&&!is_EOL(oe));break}if(is_EOL(oe))break;for(Z=K.position;oe!==0&&!is_WS_OR_EOL(oe);)oe=K.input.charCodeAt(++K.position);ne.push(K.input.slice(Z,K.position))}oe!==0&&readLineBreak(K),_hasOwnProperty$1.call(directiveHandlers,te)?directiveHandlers[te](K,te,ne):throwWarning(K,'unknown document directive "'+te+'"')}if(skipSeparationSpace(K,!0,-1),K.lineIndent===0&&K.input.charCodeAt(K.position)===45&&K.input.charCodeAt(K.position+1)===45&&K.input.charCodeAt(K.position+2)===45?(K.position+=3,skipSeparationSpace(K,!0,-1)):ie&&throwError(K,"directives end mark is expected"),composeNode(K,K.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(K,!0,-1),K.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(K.input.slice(_,K.position))&&throwWarning(K,"non-ASCII line breaks are interpreted as content"),K.documents.push(K.result),K.position===K.lineStart&&testDocumentSeparator(K)){K.input.charCodeAt(K.position)===46&&(K.position+=3,skipSeparationSpace(K,!0,-1));return}if(K.position<K.length-1)throwError(K,"end of the stream or a document separator is expected");else return}function loadDocuments(K,_){K=String(K),_=_||{},K.length!==0&&(K.charCodeAt(K.length-1)!==10&&K.charCodeAt(K.length-1)!==13&&(K+=`
`),K.charCodeAt(0)===65279&&(K=K.slice(1)));var Z=new State$1(K,_),te=K.indexOf("\0");for(te!==-1&&(Z.position=te,throwError(Z,"null byte is not allowed in input")),Z.input+="\0";Z.input.charCodeAt(Z.position)===32;)Z.lineIndent+=1,Z.position+=1;for(;Z.position<Z.length-1;)readDocument(Z);return Z.documents}function loadAll$1(K,_,Z){_!==null&&typeof _=="object"&&typeof Z>"u"&&(Z=_,_=null);var te=loadDocuments(K,Z);if(typeof _!="function")return te;for(var ne=0,ie=te.length;ne<ie;ne+=1)_(te[ne])}function load$1(K,_){var Z=loadDocuments(K,_);if(Z.length!==0){if(Z.length===1)return Z[0];throw new exception("expected a single document in the stream, but found more")}}var loadAll_1=loadAll$1,load_1=load$1,loader={loadAll:loadAll_1,load:load_1},_toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,CHAR_BOM=65279,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK$1=42,CHAR_COMMA$1=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET$1=91,CHAR_RIGHT_SQUARE_BRACKET$1=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={};ESCAPE_SEQUENCES[0]="\\0";ESCAPE_SEQUENCES[7]="\\a";ESCAPE_SEQUENCES[8]="\\b";ESCAPE_SEQUENCES[9]="\\t";ESCAPE_SEQUENCES[10]="\\n";ESCAPE_SEQUENCES[11]="\\v";ESCAPE_SEQUENCES[12]="\\f";ESCAPE_SEQUENCES[13]="\\r";ESCAPE_SEQUENCES[27]="\\e";ESCAPE_SEQUENCES[34]='\\"';ESCAPE_SEQUENCES[92]="\\\\";ESCAPE_SEQUENCES[133]="\\N";ESCAPE_SEQUENCES[160]="\\_";ESCAPE_SEQUENCES[8232]="\\L";ESCAPE_SEQUENCES[8233]="\\P";var DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],DEPRECATED_BASE60_SYNTAX=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function compileStyleMap(K,_){var Z,te,ne,ie,oe,se,ae;if(_===null)return{};for(Z={},te=Object.keys(_),ne=0,ie=te.length;ne<ie;ne+=1)oe=te[ne],se=String(_[oe]),oe.slice(0,2)==="!!"&&(oe="tag:yaml.org,2002:"+oe.slice(2)),ae=K.compiledTypeMap.fallback[oe],ae&&_hasOwnProperty.call(ae.styleAliases,se)&&(se=ae.styleAliases[se]),Z[oe]=se;return Z}function encodeHex(K){var _,Z,te;if(_=K.toString(16).toUpperCase(),K<=255)Z="x",te=2;else if(K<=65535)Z="u",te=4;else if(K<=4294967295)Z="U",te=8;else throw new exception("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+Z+common.repeat("0",te-_.length)+_}var QUOTING_TYPE_SINGLE=1,QUOTING_TYPE_DOUBLE=2;function State$2(K){this.schema=K.schema||_default,this.indent=Math.max(1,K.indent||2),this.noArrayIndent=K.noArrayIndent||!1,this.skipInvalid=K.skipInvalid||!1,this.flowLevel=common.isNothing(K.flowLevel)?-1:K.flowLevel,this.styleMap=compileStyleMap(this.schema,K.styles||null),this.sortKeys=K.sortKeys||!1,this.lineWidth=K.lineWidth||80,this.noRefs=K.noRefs||!1,this.noCompatMode=K.noCompatMode||!1,this.condenseFlow=K.condenseFlow||!1,this.quotingType=K.quotingType==='"'?QUOTING_TYPE_DOUBLE:QUOTING_TYPE_SINGLE,this.forceQuotes=K.forceQuotes||!1,this.replacer=typeof K.replacer=="function"?K.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(K,_){for(var Z=common.repeat(" ",_),te=0,ne=-1,ie="",oe,se=K.length;te<se;)ne=K.indexOf(`
`,te),ne===-1?(oe=K.slice(te),te=se):(oe=K.slice(te,ne+1),te=ne+1),oe.length&&oe!==`
`&&(ie+=Z),ie+=oe;return ie}function generateNextLine(K,_){return`
`+common.repeat(" ",K.indent*_)}function testImplicitResolving(K,_){var Z,te,ne;for(Z=0,te=K.implicitTypes.length;Z<te;Z+=1)if(ne=K.implicitTypes[Z],ne.resolve(_))return!0;return!1}function isWhitespace$1(K){return K===CHAR_SPACE||K===CHAR_TAB}function isPrintable(K){return 32<=K&&K<=126||161<=K&&K<=55295&&K!==8232&&K!==8233||57344<=K&&K<=65533&&K!==CHAR_BOM||65536<=K&&K<=1114111}function isNsCharOrWhitespace(K){return isPrintable(K)&&K!==CHAR_BOM&&K!==CHAR_CARRIAGE_RETURN&&K!==CHAR_LINE_FEED}function isPlainSafe(K,_,Z){var te=isNsCharOrWhitespace(K),ne=te&&!isWhitespace$1(K);return(Z?te:te&&K!==CHAR_COMMA$1&&K!==CHAR_LEFT_SQUARE_BRACKET$1&&K!==CHAR_RIGHT_SQUARE_BRACKET$1&&K!==CHAR_LEFT_CURLY_BRACKET&&K!==CHAR_RIGHT_CURLY_BRACKET)&&K!==CHAR_SHARP&&!(_===CHAR_COLON&&!ne)||isNsCharOrWhitespace(_)&&!isWhitespace$1(_)&&K===CHAR_SHARP||_===CHAR_COLON&&ne}function isPlainSafeFirst(K){return isPrintable(K)&&K!==CHAR_BOM&&!isWhitespace$1(K)&&K!==CHAR_MINUS&&K!==CHAR_QUESTION&&K!==CHAR_COLON&&K!==CHAR_COMMA$1&&K!==CHAR_LEFT_SQUARE_BRACKET$1&&K!==CHAR_RIGHT_SQUARE_BRACKET$1&&K!==CHAR_LEFT_CURLY_BRACKET&&K!==CHAR_RIGHT_CURLY_BRACKET&&K!==CHAR_SHARP&&K!==CHAR_AMPERSAND&&K!==CHAR_ASTERISK$1&&K!==CHAR_EXCLAMATION&&K!==CHAR_VERTICAL_LINE&&K!==CHAR_EQUALS&&K!==CHAR_GREATER_THAN&&K!==CHAR_SINGLE_QUOTE&&K!==CHAR_DOUBLE_QUOTE&&K!==CHAR_PERCENT&&K!==CHAR_COMMERCIAL_AT&&K!==CHAR_GRAVE_ACCENT}function isPlainSafeLast(K){return!isWhitespace$1(K)&&K!==CHAR_COLON}function codePointAt(K,_){var Z=K.charCodeAt(_),te;return Z>=55296&&Z<=56319&&_+1<K.length&&(te=K.charCodeAt(_+1),te>=56320&&te<=57343)?(Z-55296)*1024+te-56320+65536:Z}function needIndentIndicator(K){var _=/^\n* /;return _.test(K)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(K,_,Z,te,ne,ie,oe,se){var ae,le=0,ce=null,fe=!1,de=!1,pe=te!==-1,he=-1,ge=isPlainSafeFirst(codePointAt(K,0))&&isPlainSafeLast(codePointAt(K,K.length-1));if(_||oe)for(ae=0;ae<K.length;le>=65536?ae+=2:ae++){if(le=codePointAt(K,ae),!isPrintable(le))return STYLE_DOUBLE;ge=ge&&isPlainSafe(le,ce,se),ce=le}else{for(ae=0;ae<K.length;le>=65536?ae+=2:ae++){if(le=codePointAt(K,ae),le===CHAR_LINE_FEED)fe=!0,pe&&(de=de||ae-he-1>te&&K[he+1]!==" ",he=ae);else if(!isPrintable(le))return STYLE_DOUBLE;ge=ge&&isPlainSafe(le,ce,se),ce=le}de=de||pe&&ae-he-1>te&&K[he+1]!==" "}return!fe&&!de?ge&&!oe&&!ne(K)?STYLE_PLAIN:ie===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:Z>9&&needIndentIndicator(K)?STYLE_DOUBLE:oe?ie===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:de?STYLE_FOLDED:STYLE_LITERAL}function writeScalar(K,_,Z,te,ne){K.dump=function(){if(_.length===0)return K.quotingType===QUOTING_TYPE_DOUBLE?'""':"''";if(!K.noCompatMode&&(DEPRECATED_BOOLEANS_SYNTAX.indexOf(_)!==-1||DEPRECATED_BASE60_SYNTAX.test(_)))return K.quotingType===QUOTING_TYPE_DOUBLE?'"'+_+'"':"'"+_+"'";var ie=K.indent*Math.max(1,Z),oe=K.lineWidth===-1?-1:Math.max(Math.min(K.lineWidth,40),K.lineWidth-ie),se=te||K.flowLevel>-1&&Z>=K.flowLevel;function ae(le){return testImplicitResolving(K,le)}switch(chooseScalarStyle(_,se,K.indent,oe,ae,K.quotingType,K.forceQuotes&&!te,ne)){case STYLE_PLAIN:return _;case STYLE_SINGLE:return"'"+_.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(_,K.indent)+dropEndingNewline(indentString(_,ie));case STYLE_FOLDED:return">"+blockHeader(_,K.indent)+dropEndingNewline(indentString(foldString(_,oe),ie));case STYLE_DOUBLE:return'"'+escapeString(_)+'"';default:throw new exception("impossible error: invalid scalar style")}}()}function blockHeader(K,_){var Z=needIndentIndicator(K)?String(_):"",te=K[K.length-1]===`
`,ne=te&&(K[K.length-2]===`
`||K===`
`),ie=ne?"+":te?"":"-";return Z+ie+`
`}function dropEndingNewline(K){return K[K.length-1]===`
`?K.slice(0,-1):K}function foldString(K,_){for(var Z=/(\n+)([^\n]*)/g,te=function(){var le=K.indexOf(`
`);return le=le!==-1?le:K.length,Z.lastIndex=le,foldLine(K.slice(0,le),_)}(),ne=K[0]===`
`||K[0]===" ",ie,oe;oe=Z.exec(K);){var se=oe[1],ae=oe[2];ie=ae[0]===" ",te+=se+(!ne&&!ie&&ae!==""?`
`:"")+foldLine(ae,_),ne=ie}return te}function foldLine(K,_){if(K===""||K[0]===" ")return K;for(var Z=/ [^ ]/g,te,ne=0,ie,oe=0,se=0,ae="";te=Z.exec(K);)se=te.index,se-ne>_&&(ie=oe>ne?oe:se,ae+=`
`+K.slice(ne,ie),ne=ie+1),oe=se;return ae+=`
`,K.length-ne>_&&oe>ne?ae+=K.slice(ne,oe)+`
`+K.slice(oe+1):ae+=K.slice(ne),ae.slice(1)}function escapeString(K){for(var _="",Z=0,te,ne=0;ne<K.length;Z>=65536?ne+=2:ne++)Z=codePointAt(K,ne),te=ESCAPE_SEQUENCES[Z],!te&&isPrintable(Z)?(_+=K[ne],Z>=65536&&(_+=K[ne+1])):_+=te||encodeHex(Z);return _}function writeFlowSequence(K,_,Z){var te="",ne=K.tag,ie,oe,se;for(ie=0,oe=Z.length;ie<oe;ie+=1)se=Z[ie],K.replacer&&(se=K.replacer.call(Z,String(ie),se)),(writeNode(K,_,se,!1,!1)||typeof se>"u"&&writeNode(K,_,null,!1,!1))&&(te!==""&&(te+=","+(K.condenseFlow?"":" ")),te+=K.dump);K.tag=ne,K.dump="["+te+"]"}function writeBlockSequence(K,_,Z,te){var ne="",ie=K.tag,oe,se,ae;for(oe=0,se=Z.length;oe<se;oe+=1)ae=Z[oe],K.replacer&&(ae=K.replacer.call(Z,String(oe),ae)),(writeNode(K,_+1,ae,!0,!0,!1,!0)||typeof ae>"u"&&writeNode(K,_+1,null,!0,!0,!1,!0))&&((!te||ne!=="")&&(ne+=generateNextLine(K,_)),K.dump&&CHAR_LINE_FEED===K.dump.charCodeAt(0)?ne+="-":ne+="- ",ne+=K.dump);K.tag=ie,K.dump=ne||"[]"}function writeFlowMapping(K,_,Z){var te="",ne=K.tag,ie=Object.keys(Z),oe,se,ae,le,ce;for(oe=0,se=ie.length;oe<se;oe+=1)ce="",te!==""&&(ce+=", "),K.condenseFlow&&(ce+='"'),ae=ie[oe],le=Z[ae],K.replacer&&(le=K.replacer.call(Z,ae,le)),writeNode(K,_,ae,!1,!1)&&(K.dump.length>1024&&(ce+="? "),ce+=K.dump+(K.condenseFlow?'"':"")+":"+(K.condenseFlow?"":" "),writeNode(K,_,le,!1,!1)&&(ce+=K.dump,te+=ce));K.tag=ne,K.dump="{"+te+"}"}function writeBlockMapping(K,_,Z,te){var ne="",ie=K.tag,oe=Object.keys(Z),se,ae,le,ce,fe,de;if(K.sortKeys===!0)oe.sort();else if(typeof K.sortKeys=="function")oe.sort(K.sortKeys);else if(K.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(se=0,ae=oe.length;se<ae;se+=1)de="",(!te||ne!=="")&&(de+=generateNextLine(K,_)),le=oe[se],ce=Z[le],K.replacer&&(ce=K.replacer.call(Z,le,ce)),writeNode(K,_+1,le,!0,!0,!0)&&(fe=K.tag!==null&&K.tag!=="?"||K.dump&&K.dump.length>1024,fe&&(K.dump&&CHAR_LINE_FEED===K.dump.charCodeAt(0)?de+="?":de+="? "),de+=K.dump,fe&&(de+=generateNextLine(K,_)),writeNode(K,_+1,ce,!0,fe)&&(K.dump&&CHAR_LINE_FEED===K.dump.charCodeAt(0)?de+=":":de+=": ",de+=K.dump,ne+=de));K.tag=ie,K.dump=ne||"{}"}function detectType(K,_,Z){var te,ne,ie,oe,se,ae;for(ne=Z?K.explicitTypes:K.implicitTypes,ie=0,oe=ne.length;ie<oe;ie+=1)if(se=ne[ie],(se.instanceOf||se.predicate)&&(!se.instanceOf||typeof _=="object"&&_ instanceof se.instanceOf)&&(!se.predicate||se.predicate(_))){if(Z?se.multi&&se.representName?K.tag=se.representName(_):K.tag=se.tag:K.tag="?",se.represent){if(ae=K.styleMap[se.tag]||se.defaultStyle,_toString.call(se.represent)==="[object Function]")te=se.represent(_,ae);else if(_hasOwnProperty.call(se.represent,ae))te=se.represent[ae](_,ae);else throw new exception("!<"+se.tag+'> tag resolver accepts not "'+ae+'" style');K.dump=te}return!0}return!1}function writeNode(K,_,Z,te,ne,ie,oe){K.tag=null,K.dump=Z,detectType(K,Z,!1)||detectType(K,Z,!0);var se=_toString.call(K.dump),ae=te,le;te&&(te=K.flowLevel<0||K.flowLevel>_);var ce=se==="[object Object]"||se==="[object Array]",fe,de;if(ce&&(fe=K.duplicates.indexOf(Z),de=fe!==-1),(K.tag!==null&&K.tag!=="?"||de||K.indent!==2&&_>0)&&(ne=!1),de&&K.usedDuplicates[fe])K.dump="*ref_"+fe;else{if(ce&&de&&!K.usedDuplicates[fe]&&(K.usedDuplicates[fe]=!0),se==="[object Object]")te&&Object.keys(K.dump).length!==0?(writeBlockMapping(K,_,K.dump,ne),de&&(K.dump="&ref_"+fe+K.dump)):(writeFlowMapping(K,_,K.dump),de&&(K.dump="&ref_"+fe+" "+K.dump));else if(se==="[object Array]")te&&K.dump.length!==0?(K.noArrayIndent&&!oe&&_>0?writeBlockSequence(K,_-1,K.dump,ne):writeBlockSequence(K,_,K.dump,ne),de&&(K.dump="&ref_"+fe+K.dump)):(writeFlowSequence(K,_,K.dump),de&&(K.dump="&ref_"+fe+" "+K.dump));else if(se==="[object String]")K.tag!=="?"&&writeScalar(K,K.dump,_,ie,ae);else{if(se==="[object Undefined]"||K.skipInvalid)return!1;throw new exception("unacceptable kind of an object to dump "+se)}K.tag!==null&&K.tag!=="?"&&(le=encodeURI(K.tag[0]==="!"?K.tag.slice(1):K.tag).replace(/!/g,"%21"),K.tag[0]==="!"?le="!"+le:le.slice(0,18)==="tag:yaml.org,2002:"?le="!!"+le.slice(18):le="!<"+le+">",K.dump=le+" "+K.dump)}return!0}function getDuplicateReferences(K,_){var Z=[],te=[],ne,ie;for(inspectNode(K,Z,te),ne=0,ie=te.length;ne<ie;ne+=1)_.duplicates.push(Z[te[ne]]);_.usedDuplicates=new Array(ie)}function inspectNode(K,_,Z){var te,ne,ie;if(K!==null&&typeof K=="object")if(ne=_.indexOf(K),ne!==-1)Z.indexOf(ne)===-1&&Z.push(ne);else if(_.push(K),Array.isArray(K))for(ne=0,ie=K.length;ne<ie;ne+=1)inspectNode(K[ne],_,Z);else for(te=Object.keys(K),ne=0,ie=te.length;ne<ie;ne+=1)inspectNode(K[te[ne]],_,Z)}function dump$1(K,_){_=_||{};var Z=new State$2(_);Z.noRefs||getDuplicateReferences(K,Z);var te=K;return Z.replacer&&(te=Z.replacer.call({"":te},"",te)),writeNode(Z,0,te,!0,!0)?Z.dump+`
`:""}var dump_1=dump$1,dumper={dump:dump_1};function renamed(K,_){return function(){throw new Error("Function yaml."+K+" is removed in js-yaml 4. Use yaml."+_+" instead, which is now safe by default.")}}var Type=type,Schema$5=schema$1,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core$1,DEFAULT_SCHEMA=_default,load=loader.load,loadAll=loader.loadAll,dump=dumper.dump,YAMLException=exception,types$7={binary,float,map,null:_null,pairs,set,timestamp,bool,int,merge:merge$5,omap,seq,str},safeLoad=renamed("safeLoad","load"),safeLoadAll=renamed("safeLoadAll","loadAll"),safeDump=renamed("safeDump","dump"),jsYaml={Type,Schema:Schema$5,FAILSAFE_SCHEMA,JSON_SCHEMA,CORE_SCHEMA,DEFAULT_SCHEMA,load,loadAll,dump,YAMLException,types:types$7,safeLoad,safeLoadAll,safeDump};function useFetch(K,_){const[Z,te]=reactExports.useState("idle"),[ne,ie]=reactExports.useState(null),[oe,se]=reactExports.useState(null),ae=reactExports.useCallback(()=>{if(!K){te("idle");return}const le=new AbortController,ce=le.signal;return te("loading"),ie(null),se(null),fetch(K,{..._,signal:ce}).then(async fe=>{if(!fe.ok)throw new Error(`HTTP error! Status: ${fe.status}`);let de=null,pe=null;const he={...fe,json:()=>{if(de===null)throw new Error("JSON not yet loaded.");return de},text:()=>{if(pe===null)throw new Error("Text not yet loaded.");return pe},yaml:()=>{try{return jsYaml.load(pe||"")}catch(ge){throw new Error("YAML parsing failed",ge)}}};de=await fe.clone().json().catch(()=>null),pe=await fe.clone().text().catch(()=>null),ie(he),te("done")}).catch(fe=>{ce.aborted||(se(fe instanceof Error?fe:new Error(String(fe))),te("done"))}),()=>le.abort()},[K,_]);return reactExports.useEffect(()=>{ae()},[ae]),{state:Z,response:ne,error:oe,refetch:ae}}var buffer$3={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code$1.length;i<len;++i)lookup[i]=code$1[i],revLookup[code$1.charCodeAt(i)]=i;revLookup[45]=62;revLookup[95]=63;function getLens(K){var _=K.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Z=K.indexOf("=");Z===-1&&(Z=_);var te=Z===_?0:4-Z%4;return[Z,te]}function byteLength(K){var _=getLens(K),Z=_[0],te=_[1];return(Z+te)*3/4-te}function _byteLength(K,_,Z){return(_+Z)*3/4-Z}function toByteArray(K){var _,Z=getLens(K),te=Z[0],ne=Z[1],ie=new Arr(_byteLength(K,te,ne)),oe=0,se=ne>0?te-4:te,ae;for(ae=0;ae<se;ae+=4)_=revLookup[K.charCodeAt(ae)]<<18|revLookup[K.charCodeAt(ae+1)]<<12|revLookup[K.charCodeAt(ae+2)]<<6|revLookup[K.charCodeAt(ae+3)],ie[oe++]=_>>16&255,ie[oe++]=_>>8&255,ie[oe++]=_&255;return ne===2&&(_=revLookup[K.charCodeAt(ae)]<<2|revLookup[K.charCodeAt(ae+1)]>>4,ie[oe++]=_&255),ne===1&&(_=revLookup[K.charCodeAt(ae)]<<10|revLookup[K.charCodeAt(ae+1)]<<4|revLookup[K.charCodeAt(ae+2)]>>2,ie[oe++]=_>>8&255,ie[oe++]=_&255),ie}function tripletToBase64(K){return lookup[K>>18&63]+lookup[K>>12&63]+lookup[K>>6&63]+lookup[K&63]}function encodeChunk(K,_,Z){for(var te,ne=[],ie=_;ie<Z;ie+=3)te=(K[ie]<<16&16711680)+(K[ie+1]<<8&65280)+(K[ie+2]&255),ne.push(tripletToBase64(te));return ne.join("")}function fromByteArray(K){for(var _,Z=K.length,te=Z%3,ne=[],ie=16383,oe=0,se=Z-te;oe<se;oe+=ie)ne.push(encodeChunk(K,oe,oe+ie>se?se:oe+ie));return te===1?(_=K[Z-1],ne.push(lookup[_>>2]+lookup[_<<4&63]+"==")):te===2&&(_=(K[Z-2]<<8)+K[Z-1],ne.push(lookup[_>>10]+lookup[_>>4&63]+lookup[_<<2&63]+"=")),ne.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(K,_,Z,te,ne){var ie,oe,se=ne*8-te-1,ae=(1<<se)-1,le=ae>>1,ce=-7,fe=Z?ne-1:0,de=Z?-1:1,pe=K[_+fe];for(fe+=de,ie=pe&(1<<-ce)-1,pe>>=-ce,ce+=se;ce>0;ie=ie*256+K[_+fe],fe+=de,ce-=8);for(oe=ie&(1<<-ce)-1,ie>>=-ce,ce+=te;ce>0;oe=oe*256+K[_+fe],fe+=de,ce-=8);if(ie===0)ie=1-le;else{if(ie===ae)return oe?NaN:(pe?-1:1)*(1/0);oe=oe+Math.pow(2,te),ie=ie-le}return(pe?-1:1)*oe*Math.pow(2,ie-te)};ieee754.write=function(K,_,Z,te,ne,ie){var oe,se,ae,le=ie*8-ne-1,ce=(1<<le)-1,fe=ce>>1,de=ne===23?Math.pow(2,-24)-Math.pow(2,-77):0,pe=te?0:ie-1,he=te?1:-1,ge=_<0||_===0&&1/_<0?1:0;for(_=Math.abs(_),isNaN(_)||_===1/0?(se=isNaN(_)?1:0,oe=ce):(oe=Math.floor(Math.log(_)/Math.LN2),_*(ae=Math.pow(2,-oe))<1&&(oe--,ae*=2),oe+fe>=1?_+=de/ae:_+=de*Math.pow(2,1-fe),_*ae>=2&&(oe++,ae/=2),oe+fe>=ce?(se=0,oe=ce):oe+fe>=1?(se=(_*ae-1)*Math.pow(2,ne),oe=oe+fe):(se=_*Math.pow(2,fe-1)*Math.pow(2,ne),oe=0));ne>=8;K[Z+pe]=se&255,pe+=he,se/=256,ne-=8);for(oe=oe<<ne|se,le+=ne;le>0;K[Z+pe]=oe&255,pe+=he,oe/=256,le-=8);K[Z+pe-he]|=ge*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(K){const _=base64Js,Z=ieee754,te=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;K.Buffer=se,K.SlowBuffer=ye,K.INSPECT_MAX_BYTES=50;const ne=2147483647;K.kMaxLength=ne,se.TYPED_ARRAY_SUPPORT=ie(),!se.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function ie(){try{const Le=new Uint8Array(1),De={foo:function(){return 42}};return Object.setPrototypeOf(De,Uint8Array.prototype),Object.setPrototypeOf(Le,De),Le.foo()===42}catch{return!1}}Object.defineProperty(se.prototype,"parent",{enumerable:!0,get:function(){if(se.isBuffer(this))return this.buffer}}),Object.defineProperty(se.prototype,"offset",{enumerable:!0,get:function(){if(se.isBuffer(this))return this.byteOffset}});function oe(Le){if(Le>ne)throw new RangeError('The value "'+Le+'" is invalid for option "size"');const De=new Uint8Array(Le);return Object.setPrototypeOf(De,se.prototype),De}function se(Le,De,Be){if(typeof Le=="number"){if(typeof De=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return fe(Le)}return ae(Le,De,Be)}se.poolSize=8192;function ae(Le,De,Be){if(typeof Le=="string")return de(Le,De);if(ArrayBuffer.isView(Le))return he(Le);if(Le==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Le);if(st(Le,ArrayBuffer)||Le&&st(Le.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(st(Le,SharedArrayBuffer)||Le&&st(Le.buffer,SharedArrayBuffer)))return ge(Le,De,Be);if(typeof Le=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const rt=Le.valueOf&&Le.valueOf();if(rt!=null&&rt!==Le)return se.from(rt,De,Be);const at=me(Le);if(at)return at;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Le[Symbol.toPrimitive]=="function")return se.from(Le[Symbol.toPrimitive]("string"),De,Be);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Le)}se.from=function(Le,De,Be){return ae(Le,De,Be)},Object.setPrototypeOf(se.prototype,Uint8Array.prototype),Object.setPrototypeOf(se,Uint8Array);function le(Le){if(typeof Le!="number")throw new TypeError('"size" argument must be of type number');if(Le<0)throw new RangeError('The value "'+Le+'" is invalid for option "size"')}function ce(Le,De,Be){return le(Le),Le<=0?oe(Le):De!==void 0?typeof Be=="string"?oe(Le).fill(De,Be):oe(Le).fill(De):oe(Le)}se.alloc=function(Le,De,Be){return ce(Le,De,Be)};function fe(Le){return le(Le),oe(Le<0?0:Ae(Le)|0)}se.allocUnsafe=function(Le){return fe(Le)},se.allocUnsafeSlow=function(Le){return fe(Le)};function de(Le,De){if((typeof De!="string"||De==="")&&(De="utf8"),!se.isEncoding(De))throw new TypeError("Unknown encoding: "+De);const Be=ve(Le,De)|0;let rt=oe(Be);const at=rt.write(Le,De);return at!==Be&&(rt=rt.slice(0,at)),rt}function pe(Le){const De=Le.length<0?0:Ae(Le.length)|0,Be=oe(De);for(let rt=0;rt<De;rt+=1)Be[rt]=Le[rt]&255;return Be}function he(Le){if(st(Le,Uint8Array)){const De=new Uint8Array(Le);return ge(De.buffer,De.byteOffset,De.byteLength)}return pe(Le)}function ge(Le,De,Be){if(De<0||Le.byteLength<De)throw new RangeError('"offset" is outside of buffer bounds');if(Le.byteLength<De+(Be||0))throw new RangeError('"length" is outside of buffer bounds');let rt;return De===void 0&&Be===void 0?rt=new Uint8Array(Le):Be===void 0?rt=new Uint8Array(Le,De):rt=new Uint8Array(Le,De,Be),Object.setPrototypeOf(rt,se.prototype),rt}function me(Le){if(se.isBuffer(Le)){const De=Ae(Le.length)|0,Be=oe(De);return Be.length===0||Le.copy(Be,0,0,De),Be}if(Le.length!==void 0)return typeof Le.length!="number"||vt(Le.length)?oe(0):pe(Le);if(Le.type==="Buffer"&&Array.isArray(Le.data))return pe(Le.data)}function Ae(Le){if(Le>=ne)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ne.toString(16)+" bytes");return Le|0}function ye(Le){return+Le!=Le&&(Le=0),se.alloc(+Le)}se.isBuffer=function(Le){return Le!=null&&Le._isBuffer===!0&&Le!==se.prototype},se.compare=function(Le,De){if(st(Le,Uint8Array)&&(Le=se.from(Le,Le.offset,Le.byteLength)),st(De,Uint8Array)&&(De=se.from(De,De.offset,De.byteLength)),!se.isBuffer(Le)||!se.isBuffer(De))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Le===De)return 0;let Be=Le.length,rt=De.length;for(let at=0,xt=Math.min(Be,rt);at<xt;++at)if(Le[at]!==De[at]){Be=Le[at],rt=De[at];break}return Be<rt?-1:rt<Be?1:0},se.isEncoding=function(Le){switch(String(Le).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},se.concat=function(Le,De){if(!Array.isArray(Le))throw new TypeError('"list" argument must be an Array of Buffers');if(Le.length===0)return se.alloc(0);let Be;if(De===void 0)for(De=0,Be=0;Be<Le.length;++Be)De+=Le[Be].length;const rt=se.allocUnsafe(De);let at=0;for(Be=0;Be<Le.length;++Be){let xt=Le[Be];if(st(xt,Uint8Array))at+xt.length>rt.length?(se.isBuffer(xt)||(xt=se.from(xt)),xt.copy(rt,at)):Uint8Array.prototype.set.call(rt,xt,at);else if(se.isBuffer(xt))xt.copy(rt,at);else throw new TypeError('"list" argument must be an Array of Buffers');at+=xt.length}return rt};function ve(Le,De){if(se.isBuffer(Le))return Le.length;if(ArrayBuffer.isView(Le)||st(Le,ArrayBuffer))return Le.byteLength;if(typeof Le!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Le);const Be=Le.length,rt=arguments.length>2&&arguments[2]===!0;if(!rt&&Be===0)return 0;let at=!1;for(;;)switch(De){case"ascii":case"latin1":case"binary":return Be;case"utf8":case"utf-8":return Ot(Le).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be*2;case"hex":return Be>>>1;case"base64":return pt(Le).length;default:if(at)return rt?-1:Ot(Le).length;De=(""+De).toLowerCase(),at=!0}}se.byteLength=ve;function _e(Le,De,Be){let rt=!1;if((De===void 0||De<0)&&(De=0),De>this.length||((Be===void 0||Be>this.length)&&(Be=this.length),Be<=0)||(Be>>>=0,De>>>=0,Be<=De))return"";for(Le||(Le="utf8");;)switch(Le){case"hex":return Je(this,De,Be);case"utf8":case"utf-8":return Ge(this,De,Be);case"ascii":return Ke(this,De,Be);case"latin1":case"binary":return tt(this,De,Be);case"base64":return ke(this,De,Be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ot(this,De,Be);default:if(rt)throw new TypeError("Unknown encoding: "+Le);Le=(Le+"").toLowerCase(),rt=!0}}se.prototype._isBuffer=!0;function Te(Le,De,Be){const rt=Le[De];Le[De]=Le[Be],Le[Be]=rt}se.prototype.swap16=function(){const Le=this.length;if(Le%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let De=0;De<Le;De+=2)Te(this,De,De+1);return this},se.prototype.swap32=function(){const Le=this.length;if(Le%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let De=0;De<Le;De+=4)Te(this,De,De+3),Te(this,De+1,De+2);return this},se.prototype.swap64=function(){const Le=this.length;if(Le%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let De=0;De<Le;De+=8)Te(this,De,De+7),Te(this,De+1,De+6),Te(this,De+2,De+5),Te(this,De+3,De+4);return this},se.prototype.toString=function(){const Le=this.length;return Le===0?"":arguments.length===0?Ge(this,0,Le):_e.apply(this,arguments)},se.prototype.toLocaleString=se.prototype.toString,se.prototype.equals=function(Le){if(!se.isBuffer(Le))throw new TypeError("Argument must be a Buffer");return this===Le?!0:se.compare(this,Le)===0},se.prototype.inspect=function(){let Le="";const De=K.INSPECT_MAX_BYTES;return Le=this.toString("hex",0,De).replace(/(.{2})/g,"$1 ").trim(),this.length>De&&(Le+=" ... "),"<Buffer "+Le+">"},te&&(se.prototype[te]=se.prototype.inspect),se.prototype.compare=function(Le,De,Be,rt,at){if(st(Le,Uint8Array)&&(Le=se.from(Le,Le.offset,Le.byteLength)),!se.isBuffer(Le))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Le);if(De===void 0&&(De=0),Be===void 0&&(Be=Le?Le.length:0),rt===void 0&&(rt=0),at===void 0&&(at=this.length),De<0||Be>Le.length||rt<0||at>this.length)throw new RangeError("out of range index");if(rt>=at&&De>=Be)return 0;if(rt>=at)return-1;if(De>=Be)return 1;if(De>>>=0,Be>>>=0,rt>>>=0,at>>>=0,this===Le)return 0;let xt=at-rt,Ct=Be-De;const Qt=Math.min(xt,Ct),qt=this.slice(rt,at),It=Le.slice(De,Be);for(let Gt=0;Gt<Qt;++Gt)if(qt[Gt]!==It[Gt]){xt=qt[Gt],Ct=It[Gt];break}return xt<Ct?-1:Ct<xt?1:0};function be(Le,De,Be,rt,at){if(Le.length===0)return-1;if(typeof Be=="string"?(rt=Be,Be=0):Be>2147483647?Be=2147483647:Be<-2147483648&&(Be=-2147483648),Be=+Be,vt(Be)&&(Be=at?0:Le.length-1),Be<0&&(Be=Le.length+Be),Be>=Le.length){if(at)return-1;Be=Le.length-1}else if(Be<0)if(at)Be=0;else return-1;if(typeof De=="string"&&(De=se.from(De,rt)),se.isBuffer(De))return De.length===0?-1:Re(Le,De,Be,rt,at);if(typeof De=="number")return De=De&255,typeof Uint8Array.prototype.indexOf=="function"?at?Uint8Array.prototype.indexOf.call(Le,De,Be):Uint8Array.prototype.lastIndexOf.call(Le,De,Be):Re(Le,[De],Be,rt,at);throw new TypeError("val must be string, number or Buffer")}function Re(Le,De,Be,rt,at){let xt=1,Ct=Le.length,Qt=De.length;if(rt!==void 0&&(rt=String(rt).toLowerCase(),rt==="ucs2"||rt==="ucs-2"||rt==="utf16le"||rt==="utf-16le")){if(Le.length<2||De.length<2)return-1;xt=2,Ct/=2,Qt/=2,Be/=2}function qt(Gt,Jt){return xt===1?Gt[Jt]:Gt.readUInt16BE(Jt*xt)}let It;if(at){let Gt=-1;for(It=Be;It<Ct;It++)if(qt(Le,It)===qt(De,Gt===-1?0:It-Gt)){if(Gt===-1&&(Gt=It),It-Gt+1===Qt)return Gt*xt}else Gt!==-1&&(It-=It-Gt),Gt=-1}else for(Be+Qt>Ct&&(Be=Ct-Qt),It=Be;It>=0;It--){let Gt=!0;for(let Jt=0;Jt<Qt;Jt++)if(qt(Le,It+Jt)!==qt(De,Jt)){Gt=!1;break}if(Gt)return It}return-1}se.prototype.includes=function(Le,De,Be){return this.indexOf(Le,De,Be)!==-1},se.prototype.indexOf=function(Le,De,Be){return be(this,Le,De,Be,!0)},se.prototype.lastIndexOf=function(Le,De,Be){return be(this,Le,De,Be,!1)};function we(Le,De,Be,rt){Be=Number(Be)||0;const at=Le.length-Be;rt?(rt=Number(rt),rt>at&&(rt=at)):rt=at;const xt=De.length;rt>xt/2&&(rt=xt/2);let Ct;for(Ct=0;Ct<rt;++Ct){const Qt=parseInt(De.substr(Ct*2,2),16);if(vt(Qt))return Ct;Le[Be+Ct]=Qt}return Ct}function Pe(Le,De,Be,rt){return ft(Ot(De,Le.length-Be),Le,Be,rt)}function Ie(Le,De,Be,rt){return ft(Mt(De),Le,Be,rt)}function $e(Le,De,Be,rt){return ft(pt(De),Le,Be,rt)}function Ue(Le,De,Be,rt){return ft(_t(De,Le.length-Be),Le,Be,rt)}se.prototype.write=function(Le,De,Be,rt){if(De===void 0)rt="utf8",Be=this.length,De=0;else if(Be===void 0&&typeof De=="string")rt=De,Be=this.length,De=0;else if(isFinite(De))De=De>>>0,isFinite(Be)?(Be=Be>>>0,rt===void 0&&(rt="utf8")):(rt=Be,Be=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const at=this.length-De;if((Be===void 0||Be>at)&&(Be=at),Le.length>0&&(Be<0||De<0)||De>this.length)throw new RangeError("Attempt to write outside buffer bounds");rt||(rt="utf8");let xt=!1;for(;;)switch(rt){case"hex":return we(this,Le,De,Be);case"utf8":case"utf-8":return Pe(this,Le,De,Be);case"ascii":case"latin1":case"binary":return Ie(this,Le,De,Be);case"base64":return $e(this,Le,De,Be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ue(this,Le,De,Be);default:if(xt)throw new TypeError("Unknown encoding: "+rt);rt=(""+rt).toLowerCase(),xt=!0}},se.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ke(Le,De,Be){return De===0&&Be===Le.length?_.fromByteArray(Le):_.fromByteArray(Le.slice(De,Be))}function Ge(Le,De,Be){Be=Math.min(Le.length,Be);const rt=[];let at=De;for(;at<Be;){const xt=Le[at];let Ct=null,Qt=xt>239?4:xt>223?3:xt>191?2:1;if(at+Qt<=Be){let qt,It,Gt,Jt;switch(Qt){case 1:xt<128&&(Ct=xt);break;case 2:qt=Le[at+1],(qt&192)===128&&(Jt=(xt&31)<<6|qt&63,Jt>127&&(Ct=Jt));break;case 3:qt=Le[at+1],It=Le[at+2],(qt&192)===128&&(It&192)===128&&(Jt=(xt&15)<<12|(qt&63)<<6|It&63,Jt>2047&&(Jt<55296||Jt>57343)&&(Ct=Jt));break;case 4:qt=Le[at+1],It=Le[at+2],Gt=Le[at+3],(qt&192)===128&&(It&192)===128&&(Gt&192)===128&&(Jt=(xt&15)<<18|(qt&63)<<12|(It&63)<<6|Gt&63,Jt>65535&&Jt<1114112&&(Ct=Jt))}}Ct===null?(Ct=65533,Qt=1):Ct>65535&&(Ct-=65536,rt.push(Ct>>>10&1023|55296),Ct=56320|Ct&1023),rt.push(Ct),at+=Qt}return ze(rt)}const He=4096;function ze(Le){const De=Le.length;if(De<=He)return String.fromCharCode.apply(String,Le);let Be="",rt=0;for(;rt<De;)Be+=String.fromCharCode.apply(String,Le.slice(rt,rt+=He));return Be}function Ke(Le,De,Be){let rt="";Be=Math.min(Le.length,Be);for(let at=De;at<Be;++at)rt+=String.fromCharCode(Le[at]&127);return rt}function tt(Le,De,Be){let rt="";Be=Math.min(Le.length,Be);for(let at=De;at<Be;++at)rt+=String.fromCharCode(Le[at]);return rt}function Je(Le,De,Be){const rt=Le.length;(!De||De<0)&&(De=0),(!Be||Be<0||Be>rt)&&(Be=rt);let at="";for(let xt=De;xt<Be;++xt)at+=Pt[Le[xt]];return at}function ot(Le,De,Be){const rt=Le.slice(De,Be);let at="";for(let xt=0;xt<rt.length-1;xt+=2)at+=String.fromCharCode(rt[xt]+rt[xt+1]*256);return at}se.prototype.slice=function(Le,De){const Be=this.length;Le=~~Le,De=De===void 0?Be:~~De,Le<0?(Le+=Be,Le<0&&(Le=0)):Le>Be&&(Le=Be),De<0?(De+=Be,De<0&&(De=0)):De>Be&&(De=Be),De<Le&&(De=Le);const rt=this.subarray(Le,De);return Object.setPrototypeOf(rt,se.prototype),rt};function Fe(Le,De,Be){if(Le%1!==0||Le<0)throw new RangeError("offset is not uint");if(Le+De>Be)throw new RangeError("Trying to access beyond buffer length")}se.prototype.readUintLE=se.prototype.readUIntLE=function(Le,De,Be){Le=Le>>>0,De=De>>>0,Be||Fe(Le,De,this.length);let rt=this[Le],at=1,xt=0;for(;++xt<De&&(at*=256);)rt+=this[Le+xt]*at;return rt},se.prototype.readUintBE=se.prototype.readUIntBE=function(Le,De,Be){Le=Le>>>0,De=De>>>0,Be||Fe(Le,De,this.length);let rt=this[Le+--De],at=1;for(;De>0&&(at*=256);)rt+=this[Le+--De]*at;return rt},se.prototype.readUint8=se.prototype.readUInt8=function(Le,De){return Le=Le>>>0,De||Fe(Le,1,this.length),this[Le]},se.prototype.readUint16LE=se.prototype.readUInt16LE=function(Le,De){return Le=Le>>>0,De||Fe(Le,2,this.length),this[Le]|this[Le+1]<<8},se.prototype.readUint16BE=se.prototype.readUInt16BE=function(Le,De){return Le=Le>>>0,De||Fe(Le,2,this.length),this[Le]<<8|this[Le+1]},se.prototype.readUint32LE=se.prototype.readUInt32LE=function(Le,De){return Le=Le>>>0,De||Fe(Le,4,this.length),(this[Le]|this[Le+1]<<8|this[Le+2]<<16)+this[Le+3]*16777216},se.prototype.readUint32BE=se.prototype.readUInt32BE=function(Le,De){return Le=Le>>>0,De||Fe(Le,4,this.length),this[Le]*16777216+(this[Le+1]<<16|this[Le+2]<<8|this[Le+3])},se.prototype.readBigUInt64LE=Lt(function(Le){Le=Le>>>0,zt(Le,"offset");const De=this[Le],Be=this[Le+7];(De===void 0||Be===void 0)&&yt(Le,this.length-8);const rt=De+this[++Le]*2**8+this[++Le]*2**16+this[++Le]*2**24,at=this[++Le]+this[++Le]*2**8+this[++Le]*2**16+Be*2**24;return BigInt(rt)+(BigInt(at)<<BigInt(32))}),se.prototype.readBigUInt64BE=Lt(function(Le){Le=Le>>>0,zt(Le,"offset");const De=this[Le],Be=this[Le+7];(De===void 0||Be===void 0)&&yt(Le,this.length-8);const rt=De*2**24+this[++Le]*2**16+this[++Le]*2**8+this[++Le],at=this[++Le]*2**24+this[++Le]*2**16+this[++Le]*2**8+Be;return(BigInt(rt)<<BigInt(32))+BigInt(at)}),se.prototype.readIntLE=function(Le,De,Be){Le=Le>>>0,De=De>>>0,Be||Fe(Le,De,this.length);let rt=this[Le],at=1,xt=0;for(;++xt<De&&(at*=256);)rt+=this[Le+xt]*at;return at*=128,rt>=at&&(rt-=Math.pow(2,8*De)),rt},se.prototype.readIntBE=function(Le,De,Be){Le=Le>>>0,De=De>>>0,Be||Fe(Le,De,this.length);let rt=De,at=1,xt=this[Le+--rt];for(;rt>0&&(at*=256);)xt+=this[Le+--rt]*at;return at*=128,xt>=at&&(xt-=Math.pow(2,8*De)),xt},se.prototype.readInt8=function(Le,De){return Le=Le>>>0,De||Fe(Le,1,this.length),this[Le]&128?(255-this[Le]+1)*-1:this[Le]},se.prototype.readInt16LE=function(Le,De){Le=Le>>>0,De||Fe(Le,2,this.length);const Be=this[Le]|this[Le+1]<<8;return Be&32768?Be|4294901760:Be},se.prototype.readInt16BE=function(Le,De){Le=Le>>>0,De||Fe(Le,2,this.length);const Be=this[Le+1]|this[Le]<<8;return Be&32768?Be|4294901760:Be},se.prototype.readInt32LE=function(Le,De){return Le=Le>>>0,De||Fe(Le,4,this.length),this[Le]|this[Le+1]<<8|this[Le+2]<<16|this[Le+3]<<24},se.prototype.readInt32BE=function(Le,De){return Le=Le>>>0,De||Fe(Le,4,this.length),this[Le]<<24|this[Le+1]<<16|this[Le+2]<<8|this[Le+3]},se.prototype.readBigInt64LE=Lt(function(Le){Le=Le>>>0,zt(Le,"offset");const De=this[Le],Be=this[Le+7];(De===void 0||Be===void 0)&&yt(Le,this.length-8);const rt=this[Le+4]+this[Le+5]*2**8+this[Le+6]*2**16+(Be<<24);return(BigInt(rt)<<BigInt(32))+BigInt(De+this[++Le]*2**8+this[++Le]*2**16+this[++Le]*2**24)}),se.prototype.readBigInt64BE=Lt(function(Le){Le=Le>>>0,zt(Le,"offset");const De=this[Le],Be=this[Le+7];(De===void 0||Be===void 0)&&yt(Le,this.length-8);const rt=(De<<24)+this[++Le]*2**16+this[++Le]*2**8+this[++Le];return(BigInt(rt)<<BigInt(32))+BigInt(this[++Le]*2**24+this[++Le]*2**16+this[++Le]*2**8+Be)}),se.prototype.readFloatLE=function(Le,De){return Le=Le>>>0,De||Fe(Le,4,this.length),Z.read(this,Le,!0,23,4)},se.prototype.readFloatBE=function(Le,De){return Le=Le>>>0,De||Fe(Le,4,this.length),Z.read(this,Le,!1,23,4)},se.prototype.readDoubleLE=function(Le,De){return Le=Le>>>0,De||Fe(Le,8,this.length),Z.read(this,Le,!0,52,8)},se.prototype.readDoubleBE=function(Le,De){return Le=Le>>>0,De||Fe(Le,8,this.length),Z.read(this,Le,!1,52,8)};function ct(Le,De,Be,rt,at,xt){if(!se.isBuffer(Le))throw new TypeError('"buffer" argument must be a Buffer instance');if(De>at||De<xt)throw new RangeError('"value" argument is out of bounds');if(Be+rt>Le.length)throw new RangeError("Index out of range")}se.prototype.writeUintLE=se.prototype.writeUIntLE=function(Le,De,Be,rt){if(Le=+Le,De=De>>>0,Be=Be>>>0,!rt){const Ct=Math.pow(2,8*Be)-1;ct(this,Le,De,Be,Ct,0)}let at=1,xt=0;for(this[De]=Le&255;++xt<Be&&(at*=256);)this[De+xt]=Le/at&255;return De+Be},se.prototype.writeUintBE=se.prototype.writeUIntBE=function(Le,De,Be,rt){if(Le=+Le,De=De>>>0,Be=Be>>>0,!rt){const Ct=Math.pow(2,8*Be)-1;ct(this,Le,De,Be,Ct,0)}let at=Be-1,xt=1;for(this[De+at]=Le&255;--at>=0&&(xt*=256);)this[De+at]=Le/xt&255;return De+Be},se.prototype.writeUint8=se.prototype.writeUInt8=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,1,255,0),this[De]=Le&255,De+1},se.prototype.writeUint16LE=se.prototype.writeUInt16LE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,2,65535,0),this[De]=Le&255,this[De+1]=Le>>>8,De+2},se.prototype.writeUint16BE=se.prototype.writeUInt16BE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,2,65535,0),this[De]=Le>>>8,this[De+1]=Le&255,De+2},se.prototype.writeUint32LE=se.prototype.writeUInt32LE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,4,4294967295,0),this[De+3]=Le>>>24,this[De+2]=Le>>>16,this[De+1]=Le>>>8,this[De]=Le&255,De+4},se.prototype.writeUint32BE=se.prototype.writeUInt32BE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,4,4294967295,0),this[De]=Le>>>24,this[De+1]=Le>>>16,this[De+2]=Le>>>8,this[De+3]=Le&255,De+4};function ht(Le,De,Be,rt,at){Nt(De,rt,at,Le,Be,7);let xt=Number(De&BigInt(4294967295));Le[Be++]=xt,xt=xt>>8,Le[Be++]=xt,xt=xt>>8,Le[Be++]=xt,xt=xt>>8,Le[Be++]=xt;let Ct=Number(De>>BigInt(32)&BigInt(4294967295));return Le[Be++]=Ct,Ct=Ct>>8,Le[Be++]=Ct,Ct=Ct>>8,Le[Be++]=Ct,Ct=Ct>>8,Le[Be++]=Ct,Be}function lt(Le,De,Be,rt,at){Nt(De,rt,at,Le,Be,7);let xt=Number(De&BigInt(4294967295));Le[Be+7]=xt,xt=xt>>8,Le[Be+6]=xt,xt=xt>>8,Le[Be+5]=xt,xt=xt>>8,Le[Be+4]=xt;let Ct=Number(De>>BigInt(32)&BigInt(4294967295));return Le[Be+3]=Ct,Ct=Ct>>8,Le[Be+2]=Ct,Ct=Ct>>8,Le[Be+1]=Ct,Ct=Ct>>8,Le[Be]=Ct,Be+8}se.prototype.writeBigUInt64LE=Lt(function(Le,De=0){return ht(this,Le,De,BigInt(0),BigInt("0xffffffffffffffff"))}),se.prototype.writeBigUInt64BE=Lt(function(Le,De=0){return lt(this,Le,De,BigInt(0),BigInt("0xffffffffffffffff"))}),se.prototype.writeIntLE=function(Le,De,Be,rt){if(Le=+Le,De=De>>>0,!rt){const Qt=Math.pow(2,8*Be-1);ct(this,Le,De,Be,Qt-1,-Qt)}let at=0,xt=1,Ct=0;for(this[De]=Le&255;++at<Be&&(xt*=256);)Le<0&&Ct===0&&this[De+at-1]!==0&&(Ct=1),this[De+at]=(Le/xt>>0)-Ct&255;return De+Be},se.prototype.writeIntBE=function(Le,De,Be,rt){if(Le=+Le,De=De>>>0,!rt){const Qt=Math.pow(2,8*Be-1);ct(this,Le,De,Be,Qt-1,-Qt)}let at=Be-1,xt=1,Ct=0;for(this[De+at]=Le&255;--at>=0&&(xt*=256);)Le<0&&Ct===0&&this[De+at+1]!==0&&(Ct=1),this[De+at]=(Le/xt>>0)-Ct&255;return De+Be},se.prototype.writeInt8=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,1,127,-128),Le<0&&(Le=255+Le+1),this[De]=Le&255,De+1},se.prototype.writeInt16LE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,2,32767,-32768),this[De]=Le&255,this[De+1]=Le>>>8,De+2},se.prototype.writeInt16BE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,2,32767,-32768),this[De]=Le>>>8,this[De+1]=Le&255,De+2},se.prototype.writeInt32LE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,4,2147483647,-2147483648),this[De]=Le&255,this[De+1]=Le>>>8,this[De+2]=Le>>>16,this[De+3]=Le>>>24,De+4},se.prototype.writeInt32BE=function(Le,De,Be){return Le=+Le,De=De>>>0,Be||ct(this,Le,De,4,2147483647,-2147483648),Le<0&&(Le=4294967295+Le+1),this[De]=Le>>>24,this[De+1]=Le>>>16,this[De+2]=Le>>>8,this[De+3]=Le&255,De+4},se.prototype.writeBigInt64LE=Lt(function(Le,De=0){return ht(this,Le,De,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),se.prototype.writeBigInt64BE=Lt(function(Le,De=0){return lt(this,Le,De,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Qe(Le,De,Be,rt,at,xt){if(Be+rt>Le.length)throw new RangeError("Index out of range");if(Be<0)throw new RangeError("Index out of range")}function Ze(Le,De,Be,rt,at){return De=+De,Be=Be>>>0,at||Qe(Le,De,Be,4),Z.write(Le,De,Be,rt,23,4),Be+4}se.prototype.writeFloatLE=function(Le,De,Be){return Ze(this,Le,De,!0,Be)},se.prototype.writeFloatBE=function(Le,De,Be){return Ze(this,Le,De,!1,Be)};function it(Le,De,Be,rt,at){return De=+De,Be=Be>>>0,at||Qe(Le,De,Be,8),Z.write(Le,De,Be,rt,52,8),Be+8}se.prototype.writeDoubleLE=function(Le,De,Be){return it(this,Le,De,!0,Be)},se.prototype.writeDoubleBE=function(Le,De,Be){return it(this,Le,De,!1,Be)},se.prototype.copy=function(Le,De,Be,rt){if(!se.isBuffer(Le))throw new TypeError("argument should be a Buffer");if(Be||(Be=0),!rt&&rt!==0&&(rt=this.length),De>=Le.length&&(De=Le.length),De||(De=0),rt>0&&rt<Be&&(rt=Be),rt===Be||Le.length===0||this.length===0)return 0;if(De<0)throw new RangeError("targetStart out of bounds");if(Be<0||Be>=this.length)throw new RangeError("Index out of range");if(rt<0)throw new RangeError("sourceEnd out of bounds");rt>this.length&&(rt=this.length),Le.length-De<rt-Be&&(rt=Le.length-De+Be);const at=rt-Be;return this===Le&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(De,Be,rt):Uint8Array.prototype.set.call(Le,this.subarray(Be,rt),De),at},se.prototype.fill=function(Le,De,Be,rt){if(typeof Le=="string"){if(typeof De=="string"?(rt=De,De=0,Be=this.length):typeof Be=="string"&&(rt=Be,Be=this.length),rt!==void 0&&typeof rt!="string")throw new TypeError("encoding must be a string");if(typeof rt=="string"&&!se.isEncoding(rt))throw new TypeError("Unknown encoding: "+rt);if(Le.length===1){const xt=Le.charCodeAt(0);(rt==="utf8"&&xt<128||rt==="latin1")&&(Le=xt)}}else typeof Le=="number"?Le=Le&255:typeof Le=="boolean"&&(Le=Number(Le));if(De<0||this.length<De||this.length<Be)throw new RangeError("Out of range index");if(Be<=De)return this;De=De>>>0,Be=Be===void 0?this.length:Be>>>0,Le||(Le=0);let at;if(typeof Le=="number")for(at=De;at<Be;++at)this[at]=Le;else{const xt=se.isBuffer(Le)?Le:se.from(Le,rt),Ct=xt.length;if(Ct===0)throw new TypeError('The value "'+Le+'" is invalid for argument "value"');for(at=0;at<Be-De;++at)this[at+De]=xt[at%Ct]}return this};const nt={};function Tt(Le,De,Be){nt[Le]=class extends Be{constructor(){super(),Object.defineProperty(this,"message",{value:De.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Le}]`,this.stack,delete this.name}get code(){return Le}set code(rt){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:rt,writable:!0})}toString(){return`${this.name} [${Le}]: ${this.message}`}}}Tt("ERR_BUFFER_OUT_OF_BOUNDS",function(Le){return Le?`${Le} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Tt("ERR_INVALID_ARG_TYPE",function(Le,De){return`The "${Le}" argument must be of type number. Received type ${typeof De}`},TypeError),Tt("ERR_OUT_OF_RANGE",function(Le,De,Be){let rt=`The value of "${Le}" is out of range.`,at=Be;return Number.isInteger(Be)&&Math.abs(Be)>2**32?at=St(String(Be)):typeof Be=="bigint"&&(at=String(Be),(Be>BigInt(2)**BigInt(32)||Be<-(BigInt(2)**BigInt(32)))&&(at=St(at)),at+="n"),rt+=` It must be ${De}. Received ${at}`,rt},RangeError);function St(Le){let De="",Be=Le.length;const rt=Le[0]==="-"?1:0;for(;Be>=rt+4;Be-=3)De=`_${Le.slice(Be-3,Be)}${De}`;return`${Le.slice(0,Be)}${De}`}function Et(Le,De,Be){zt(De,"offset"),(Le[De]===void 0||Le[De+Be]===void 0)&&yt(De,Le.length-(Be+1))}function Nt(Le,De,Be,rt,at,xt){if(Le>Be||Le<De){const Ct=typeof De=="bigint"?"n":"";let Qt;throw De===0||De===BigInt(0)?Qt=`>= 0${Ct} and < 2${Ct} ** ${(xt+1)*8}${Ct}`:Qt=`>= -(2${Ct} ** ${(xt+1)*8-1}${Ct}) and < 2 ** ${(xt+1)*8-1}${Ct}`,new nt.ERR_OUT_OF_RANGE("value",Qt,Le)}Et(rt,at,xt)}function zt(Le,De){if(typeof Le!="number")throw new nt.ERR_INVALID_ARG_TYPE(De,"number",Le)}function yt(Le,De,Be){throw Math.floor(Le)!==Le?(zt(Le,Be),new nt.ERR_OUT_OF_RANGE("offset","an integer",Le)):De<0?new nt.ERR_BUFFER_OUT_OF_BOUNDS:new nt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${De}`,Le)}const Ut=/[^+/0-9A-Za-z-_]/g;function bt(Le){if(Le=Le.split("=")[0],Le=Le.trim().replace(Ut,""),Le.length<2)return"";for(;Le.length%4!==0;)Le=Le+"=";return Le}function Ot(Le,De){De=De||1/0;let Be;const rt=Le.length;let at=null;const xt=[];for(let Ct=0;Ct<rt;++Ct){if(Be=Le.charCodeAt(Ct),Be>55295&&Be<57344){if(!at){if(Be>56319){(De-=3)>-1&&xt.push(239,191,189);continue}else if(Ct+1===rt){(De-=3)>-1&&xt.push(239,191,189);continue}at=Be;continue}if(Be<56320){(De-=3)>-1&&xt.push(239,191,189),at=Be;continue}Be=(at-55296<<10|Be-56320)+65536}else at&&(De-=3)>-1&&xt.push(239,191,189);if(at=null,Be<128){if((De-=1)<0)break;xt.push(Be)}else if(Be<2048){if((De-=2)<0)break;xt.push(Be>>6|192,Be&63|128)}else if(Be<65536){if((De-=3)<0)break;xt.push(Be>>12|224,Be>>6&63|128,Be&63|128)}else if(Be<1114112){if((De-=4)<0)break;xt.push(Be>>18|240,Be>>12&63|128,Be>>6&63|128,Be&63|128)}else throw new Error("Invalid code point")}return xt}function Mt(Le){const De=[];for(let Be=0;Be<Le.length;++Be)De.push(Le.charCodeAt(Be)&255);return De}function _t(Le,De){let Be,rt,at;const xt=[];for(let Ct=0;Ct<Le.length&&!((De-=2)<0);++Ct)Be=Le.charCodeAt(Ct),rt=Be>>8,at=Be%256,xt.push(at),xt.push(rt);return xt}function pt(Le){return _.toByteArray(bt(Le))}function ft(Le,De,Be,rt){let at;for(at=0;at<rt&&!(at+Be>=De.length||at>=Le.length);++at)De[at+Be]=Le[at];return at}function st(Le,De){return Le instanceof De||Le!=null&&Le.constructor!=null&&Le.constructor.name!=null&&Le.constructor.name===De.name}function vt(Le){return Le!==Le}const Pt=function(){const Le="0123456789abcdef",De=new Array(256);for(let Be=0;Be<16;++Be){const rt=Be*16;for(let at=0;at<16;++at)De[rt+at]=Le[Be]+Le[at]}return De}();function Lt(Le){return typeof BigInt>"u"?Vt:Le}function Vt(){throw new Error("BigInt not supported")}})(buffer$3);const index$1=getDefaultExportFromCjs(buffer$3),bufferLib=_mergeNamespaces({__proto__:null,default:index$1},[buffer$3]),vuerRoot="_vuerRoot_evnl7_1";var utils$4={};const WIN_SLASH="\\\\/",WIN_NO_SLASH=`[^${WIN_SLASH}]`,DOT_LITERAL="\\.",PLUS_LITERAL="\\+",QMARK_LITERAL="\\?",SLASH_LITERAL="\\/",ONE_CHAR="(?=.)",QMARK="[^/]",END_ANCHOR=`(?:${SLASH_LITERAL}|$)`,START_ANCHOR=`(?:^|${SLASH_LITERAL})`,DOTS_SLASH=`${DOT_LITERAL}{1,2}${END_ANCHOR}`,NO_DOT=`(?!${DOT_LITERAL})`,NO_DOTS=`(?!${START_ANCHOR}${DOTS_SLASH})`,NO_DOT_SLASH=`(?!${DOT_LITERAL}{0,1}${END_ANCHOR})`,NO_DOTS_SLASH=`(?!${DOTS_SLASH})`,QMARK_NO_DOT=`[^.${SLASH_LITERAL}]`,STAR=`${QMARK}*?`,SEP="/",POSIX_CHARS={DOT_LITERAL,PLUS_LITERAL,QMARK_LITERAL,SLASH_LITERAL,ONE_CHAR,QMARK,END_ANCHOR,DOTS_SLASH,NO_DOT,NO_DOTS,NO_DOT_SLASH,NO_DOTS_SLASH,QMARK_NO_DOT,STAR,START_ANCHOR,SEP},WINDOWS_CHARS={...POSIX_CHARS,SLASH_LITERAL:`[${WIN_SLASH}]`,QMARK:WIN_NO_SLASH,STAR:`${WIN_NO_SLASH}*?`,DOTS_SLASH:`${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$)`,NO_DOT:`(?!${DOT_LITERAL})`,NO_DOTS:`(?!(?:^|[${WIN_SLASH}])${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,NO_DOT_SLASH:`(?!${DOT_LITERAL}{0,1}(?:[${WIN_SLASH}]|$))`,NO_DOTS_SLASH:`(?!${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,QMARK_NO_DOT:`[^.${WIN_SLASH}]`,START_ANCHOR:`(?:^|[${WIN_SLASH}])`,END_ANCHOR:`(?:[${WIN_SLASH}]|$)`,SEP:"\\"},POSIX_REGEX_SOURCE$1={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};var constants$2={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:POSIX_REGEX_SOURCE$1,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(K){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${K.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(K){return K===!0?WINDOWS_CHARS:POSIX_CHARS}};(function(K){const{REGEX_BACKSLASH:_,REGEX_REMOVE_BACKSLASH:Z,REGEX_SPECIAL_CHARS:te,REGEX_SPECIAL_CHARS_GLOBAL:ne}=constants$2;K.isObject=ie=>ie!==null&&typeof ie=="object"&&!Array.isArray(ie),K.hasRegexChars=ie=>te.test(ie),K.isRegexChar=ie=>ie.length===1&&K.hasRegexChars(ie),K.escapeRegex=ie=>ie.replace(ne,"\\$1"),K.toPosixSlashes=ie=>ie.replace(_,"/"),K.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){const ie=navigator.platform.toLowerCase();return ie==="win32"||ie==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1},K.removeBackslashes=ie=>ie.replace(Z,oe=>oe==="\\"?"":oe),K.escapeLast=(ie,oe,se)=>{const ae=ie.lastIndexOf(oe,se);return ae===-1?ie:ie[ae-1]==="\\"?K.escapeLast(ie,oe,ae-1):`${ie.slice(0,ae)}\\${ie.slice(ae)}`},K.removePrefix=(ie,oe={})=>{let se=ie;return se.startsWith("./")&&(se=se.slice(2),oe.prefix="./"),se},K.wrapOutput=(ie,oe={},se={})=>{const ae=se.contains?"":"^",le=se.contains?"":"$";let ce=`${ae}(?:${ie})${le}`;return oe.negated===!0&&(ce=`(?:^(?!${ce}).*$)`),ce},K.basename=(ie,{windows:oe}={})=>{const se=ie.split(oe?/[\\/]/:"/"),ae=se[se.length-1];return ae===""?se[se.length-2]:ae}})(utils$4);const utils$3=utils$4,{CHAR_ASTERISK,CHAR_AT,CHAR_BACKWARD_SLASH,CHAR_COMMA,CHAR_DOT,CHAR_EXCLAMATION_MARK,CHAR_FORWARD_SLASH,CHAR_LEFT_CURLY_BRACE,CHAR_LEFT_PARENTHESES,CHAR_LEFT_SQUARE_BRACKET,CHAR_PLUS,CHAR_QUESTION_MARK,CHAR_RIGHT_CURLY_BRACE,CHAR_RIGHT_PARENTHESES,CHAR_RIGHT_SQUARE_BRACKET}=constants$2,isPathSeparator=K=>K===CHAR_FORWARD_SLASH||K===CHAR_BACKWARD_SLASH,depth=K=>{K.isPrefix!==!0&&(K.depth=K.isGlobstar?1/0:1)},scan$1=(K,_)=>{const Z=_||{},te=K.length-1,ne=Z.parts===!0||Z.scanToEnd===!0,ie=[],oe=[],se=[];let ae=K,le=-1,ce=0,fe=0,de=!1,pe=!1,he=!1,ge=!1,me=!1,Ae=!1,ye=!1,ve=!1,_e=!1,Te=!1,be=0,Re,we,Pe={value:"",depth:0,isGlob:!1};const Ie=()=>le>=te,$e=()=>ae.charCodeAt(le+1),Ue=()=>(Re=we,ae.charCodeAt(++le));for(;le<te;){we=Ue();let Ke;if(we===CHAR_BACKWARD_SLASH){ye=Pe.backslashes=!0,we=Ue(),we===CHAR_LEFT_CURLY_BRACE&&(Ae=!0);continue}if(Ae===!0||we===CHAR_LEFT_CURLY_BRACE){for(be++;Ie()!==!0&&(we=Ue());){if(we===CHAR_BACKWARD_SLASH){ye=Pe.backslashes=!0,Ue();continue}if(we===CHAR_LEFT_CURLY_BRACE){be++;continue}if(Ae!==!0&&we===CHAR_DOT&&(we=Ue())===CHAR_DOT){if(de=Pe.isBrace=!0,he=Pe.isGlob=!0,Te=!0,ne===!0)continue;break}if(Ae!==!0&&we===CHAR_COMMA){if(de=Pe.isBrace=!0,he=Pe.isGlob=!0,Te=!0,ne===!0)continue;break}if(we===CHAR_RIGHT_CURLY_BRACE&&(be--,be===0)){Ae=!1,de=Pe.isBrace=!0,Te=!0;break}}if(ne===!0)continue;break}if(we===CHAR_FORWARD_SLASH){if(ie.push(le),oe.push(Pe),Pe={value:"",depth:0,isGlob:!1},Te===!0)continue;if(Re===CHAR_DOT&&le===ce+1){ce+=2;continue}fe=le+1;continue}if(Z.noext!==!0&&(we===CHAR_PLUS||we===CHAR_AT||we===CHAR_ASTERISK||we===CHAR_QUESTION_MARK||we===CHAR_EXCLAMATION_MARK)&&$e()===CHAR_LEFT_PARENTHESES){if(he=Pe.isGlob=!0,ge=Pe.isExtglob=!0,Te=!0,we===CHAR_EXCLAMATION_MARK&&le===ce&&(_e=!0),ne===!0){for(;Ie()!==!0&&(we=Ue());){if(we===CHAR_BACKWARD_SLASH){ye=Pe.backslashes=!0,we=Ue();continue}if(we===CHAR_RIGHT_PARENTHESES){he=Pe.isGlob=!0,Te=!0;break}}continue}break}if(we===CHAR_ASTERISK){if(Re===CHAR_ASTERISK&&(me=Pe.isGlobstar=!0),he=Pe.isGlob=!0,Te=!0,ne===!0)continue;break}if(we===CHAR_QUESTION_MARK){if(he=Pe.isGlob=!0,Te=!0,ne===!0)continue;break}if(we===CHAR_LEFT_SQUARE_BRACKET){for(;Ie()!==!0&&(Ke=Ue());){if(Ke===CHAR_BACKWARD_SLASH){ye=Pe.backslashes=!0,Ue();continue}if(Ke===CHAR_RIGHT_SQUARE_BRACKET){pe=Pe.isBracket=!0,he=Pe.isGlob=!0,Te=!0;break}}if(ne===!0)continue;break}if(Z.nonegate!==!0&&we===CHAR_EXCLAMATION_MARK&&le===ce){ve=Pe.negated=!0,ce++;continue}if(Z.noparen!==!0&&we===CHAR_LEFT_PARENTHESES){if(he=Pe.isGlob=!0,ne===!0){for(;Ie()!==!0&&(we=Ue());){if(we===CHAR_LEFT_PARENTHESES){ye=Pe.backslashes=!0,we=Ue();continue}if(we===CHAR_RIGHT_PARENTHESES){Te=!0;break}}continue}break}if(he===!0){if(Te=!0,ne===!0)continue;break}}Z.noext===!0&&(ge=!1,he=!1);let ke=ae,Ge="",He="";ce>0&&(Ge=ae.slice(0,ce),ae=ae.slice(ce),fe-=ce),ke&&he===!0&&fe>0?(ke=ae.slice(0,fe),He=ae.slice(fe)):he===!0?(ke="",He=ae):ke=ae,ke&&ke!==""&&ke!=="/"&&ke!==ae&&isPathSeparator(ke.charCodeAt(ke.length-1))&&(ke=ke.slice(0,-1)),Z.unescape===!0&&(He&&(He=utils$3.removeBackslashes(He)),ke&&ye===!0&&(ke=utils$3.removeBackslashes(ke)));const ze={prefix:Ge,input:K,start:ce,base:ke,glob:He,isBrace:de,isBracket:pe,isGlob:he,isExtglob:ge,isGlobstar:me,negated:ve,negatedExtglob:_e};if(Z.tokens===!0&&(ze.maxDepth=0,isPathSeparator(we)||oe.push(Pe),ze.tokens=oe),Z.parts===!0||Z.tokens===!0){let Ke;for(let tt=0;tt<ie.length;tt++){const Je=Ke?Ke+1:ce,ot=ie[tt],Fe=K.slice(Je,ot);Z.tokens&&(tt===0&&ce!==0?(oe[tt].isPrefix=!0,oe[tt].value=Ge):oe[tt].value=Fe,depth(oe[tt]),ze.maxDepth+=oe[tt].depth),(tt!==0||Fe!=="")&&se.push(Fe),Ke=ot}if(Ke&&Ke+1<K.length){const tt=K.slice(Ke+1);se.push(tt),Z.tokens&&(oe[oe.length-1].value=tt,depth(oe[oe.length-1]),ze.maxDepth+=oe[oe.length-1].depth)}ze.slashes=ie,ze.parts=se}return ze};var scan_1=scan$1;const constants$1=constants$2,utils$2=utils$4,{MAX_LENGTH,POSIX_REGEX_SOURCE,REGEX_NON_SPECIAL_CHARS,REGEX_SPECIAL_CHARS_BACKREF,REPLACEMENTS}=constants$1,expandRange=(K,_)=>{if(typeof _.expandRange=="function")return _.expandRange(...K,_);K.sort();const Z=`[${K.join("-")}]`;try{new RegExp(Z)}catch{return K.map(te=>utils$2.escapeRegex(te)).join("..")}return Z},syntaxError=(K,_)=>`Missing ${K}: "${_}" - use "\\\\${_}" to match literal characters`,parse$8=(K,_)=>{if(typeof K!="string")throw new TypeError("Expected a string");K=REPLACEMENTS[K]||K;const Z={..._},te=typeof Z.maxLength=="number"?Math.min(MAX_LENGTH,Z.maxLength):MAX_LENGTH;let ne=K.length;if(ne>te)throw new SyntaxError(`Input length: ${ne}, exceeds maximum allowed length: ${te}`);const ie={type:"bos",value:"",output:Z.prepend||""},oe=[ie],se=Z.capture?"":"?:",ae=constants$1.globChars(Z.windows),le=constants$1.extglobChars(ae),{DOT_LITERAL:ce,PLUS_LITERAL:fe,SLASH_LITERAL:de,ONE_CHAR:pe,DOTS_SLASH:he,NO_DOT:ge,NO_DOT_SLASH:me,NO_DOTS_SLASH:Ae,QMARK:ye,QMARK_NO_DOT:ve,STAR:_e,START_ANCHOR:Te}=ae,be=nt=>`(${se}(?:(?!${Te}${nt.dot?he:ce}).)*?)`,Re=Z.dot?"":ge,we=Z.dot?ye:ve;let Pe=Z.bash===!0?be(Z):_e;Z.capture&&(Pe=`(${Pe})`),typeof Z.noext=="boolean"&&(Z.noextglob=Z.noext);const Ie={input:K,index:-1,start:0,dot:Z.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:oe};K=utils$2.removePrefix(K,Ie),ne=K.length;const $e=[],Ue=[],ke=[];let Ge=ie,He;const ze=()=>Ie.index===ne-1,Ke=Ie.peek=(nt=1)=>K[Ie.index+nt],tt=Ie.advance=()=>K[++Ie.index]||"",Je=()=>K.slice(Ie.index+1),ot=(nt="",Tt=0)=>{Ie.consumed+=nt,Ie.index+=Tt},Fe=nt=>{Ie.output+=nt.output!=null?nt.output:nt.value,ot(nt.value)},ct=()=>{let nt=1;for(;Ke()==="!"&&(Ke(2)!=="("||Ke(3)==="?");)tt(),Ie.start++,nt++;return nt%2===0?!1:(Ie.negated=!0,Ie.start++,!0)},ht=nt=>{Ie[nt]++,ke.push(nt)},lt=nt=>{Ie[nt]--,ke.pop()},Qe=nt=>{if(Ge.type==="globstar"){const Tt=Ie.braces>0&&(nt.type==="comma"||nt.type==="brace"),St=nt.extglob===!0||$e.length&&(nt.type==="pipe"||nt.type==="paren");nt.type!=="slash"&&nt.type!=="paren"&&!Tt&&!St&&(Ie.output=Ie.output.slice(0,-Ge.output.length),Ge.type="star",Ge.value="*",Ge.output=Pe,Ie.output+=Ge.output)}if($e.length&&nt.type!=="paren"&&($e[$e.length-1].inner+=nt.value),(nt.value||nt.output)&&Fe(nt),Ge&&Ge.type==="text"&&nt.type==="text"){Ge.output=(Ge.output||Ge.value)+nt.value,Ge.value+=nt.value;return}nt.prev=Ge,oe.push(nt),Ge=nt},Ze=(nt,Tt)=>{const St={...le[Tt],conditions:1,inner:""};St.prev=Ge,St.parens=Ie.parens,St.output=Ie.output;const Et=(Z.capture?"(":"")+St.open;ht("parens"),Qe({type:nt,value:Tt,output:Ie.output?"":pe}),Qe({type:"paren",extglob:!0,value:tt(),output:Et}),$e.push(St)},it=nt=>{let Tt=nt.close+(Z.capture?")":""),St;if(nt.type==="negate"){let Et=Pe;if(nt.inner&&nt.inner.length>1&&nt.inner.includes("/")&&(Et=be(Z)),(Et!==Pe||ze()||/^\)+$/.test(Je()))&&(Tt=nt.close=`)$))${Et}`),nt.inner.includes("*")&&(St=Je())&&/^\.[^\\/.]+$/.test(St)){const Nt=parse$8(St,{..._,fastpaths:!1}).output;Tt=nt.close=`)${Nt})${Et})`}nt.prev.type==="bos"&&(Ie.negatedExtglob=!0)}Qe({type:"paren",extglob:!0,value:He,output:Tt}),lt("parens")};if(Z.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(K)){let nt=!1,Tt=K.replace(REGEX_SPECIAL_CHARS_BACKREF,(St,Et,Nt,zt,yt,Ut)=>zt==="\\"?(nt=!0,St):zt==="?"?Et?Et+zt+(yt?ye.repeat(yt.length):""):Ut===0?we+(yt?ye.repeat(yt.length):""):ye.repeat(Nt.length):zt==="."?ce.repeat(Nt.length):zt==="*"?Et?Et+zt+(yt?Pe:""):Pe:Et?St:`\\${St}`);return nt===!0&&(Z.unescape===!0?Tt=Tt.replace(/\\/g,""):Tt=Tt.replace(/\\+/g,St=>St.length%2===0?"\\\\":St?"\\":"")),Tt===K&&Z.contains===!0?(Ie.output=K,Ie):(Ie.output=utils$2.wrapOutput(Tt,Ie,_),Ie)}for(;!ze();){if(He=tt(),He==="\0")continue;if(He==="\\"){const St=Ke();if(St==="/"&&Z.bash!==!0||St==="."||St===";")continue;if(!St){He+="\\",Qe({type:"text",value:He});continue}const Et=/^\\+/.exec(Je());let Nt=0;if(Et&&Et[0].length>2&&(Nt=Et[0].length,Ie.index+=Nt,Nt%2!==0&&(He+="\\")),Z.unescape===!0?He=tt():He+=tt(),Ie.brackets===0){Qe({type:"text",value:He});continue}}if(Ie.brackets>0&&(He!=="]"||Ge.value==="["||Ge.value==="[^")){if(Z.posix!==!1&&He===":"){const St=Ge.value.slice(1);if(St.includes("[")&&(Ge.posix=!0,St.includes(":"))){const Et=Ge.value.lastIndexOf("["),Nt=Ge.value.slice(0,Et),zt=Ge.value.slice(Et+2),yt=POSIX_REGEX_SOURCE[zt];if(yt){Ge.value=Nt+yt,Ie.backtrack=!0,tt(),!ie.output&&oe.indexOf(Ge)===1&&(ie.output=pe);continue}}}(He==="["&&Ke()!==":"||He==="-"&&Ke()==="]")&&(He=`\\${He}`),He==="]"&&(Ge.value==="["||Ge.value==="[^")&&(He=`\\${He}`),Z.posix===!0&&He==="!"&&Ge.value==="["&&(He="^"),Ge.value+=He,Fe({value:He});continue}if(Ie.quotes===1&&He!=='"'){He=utils$2.escapeRegex(He),Ge.value+=He,Fe({value:He});continue}if(He==='"'){Ie.quotes=Ie.quotes===1?0:1,Z.keepQuotes===!0&&Qe({type:"text",value:He});continue}if(He==="("){ht("parens"),Qe({type:"paren",value:He});continue}if(He===")"){if(Ie.parens===0&&Z.strictBrackets===!0)throw new SyntaxError(syntaxError("opening","("));const St=$e[$e.length-1];if(St&&Ie.parens===St.parens+1){it($e.pop());continue}Qe({type:"paren",value:He,output:Ie.parens?")":"\\)"}),lt("parens");continue}if(He==="["){if(Z.nobracket===!0||!Je().includes("]")){if(Z.nobracket!==!0&&Z.strictBrackets===!0)throw new SyntaxError(syntaxError("closing","]"));He=`\\${He}`}else ht("brackets");Qe({type:"bracket",value:He});continue}if(He==="]"){if(Z.nobracket===!0||Ge&&Ge.type==="bracket"&&Ge.value.length===1){Qe({type:"text",value:He,output:`\\${He}`});continue}if(Ie.brackets===0){if(Z.strictBrackets===!0)throw new SyntaxError(syntaxError("opening","["));Qe({type:"text",value:He,output:`\\${He}`});continue}lt("brackets");const St=Ge.value.slice(1);if(Ge.posix!==!0&&St[0]==="^"&&!St.includes("/")&&(He=`/${He}`),Ge.value+=He,Fe({value:He}),Z.literalBrackets===!1||utils$2.hasRegexChars(St))continue;const Et=utils$2.escapeRegex(Ge.value);if(Ie.output=Ie.output.slice(0,-Ge.value.length),Z.literalBrackets===!0){Ie.output+=Et,Ge.value=Et;continue}Ge.value=`(${se}${Et}|${Ge.value})`,Ie.output+=Ge.value;continue}if(He==="{"&&Z.nobrace!==!0){ht("braces");const St={type:"brace",value:He,output:"(",outputIndex:Ie.output.length,tokensIndex:Ie.tokens.length};Ue.push(St),Qe(St);continue}if(He==="}"){const St=Ue[Ue.length-1];if(Z.nobrace===!0||!St){Qe({type:"text",value:He,output:He});continue}let Et=")";if(St.dots===!0){const Nt=oe.slice(),zt=[];for(let yt=Nt.length-1;yt>=0&&(oe.pop(),Nt[yt].type!=="brace");yt--)Nt[yt].type!=="dots"&&zt.unshift(Nt[yt].value);Et=expandRange(zt,Z),Ie.backtrack=!0}if(St.comma!==!0&&St.dots!==!0){const Nt=Ie.output.slice(0,St.outputIndex),zt=Ie.tokens.slice(St.tokensIndex);St.value=St.output="\\{",He=Et="\\}",Ie.output=Nt;for(const yt of zt)Ie.output+=yt.output||yt.value}Qe({type:"brace",value:He,output:Et}),lt("braces"),Ue.pop();continue}if(He==="|"){$e.length>0&&$e[$e.length-1].conditions++,Qe({type:"text",value:He});continue}if(He===","){let St=He;const Et=Ue[Ue.length-1];Et&&ke[ke.length-1]==="braces"&&(Et.comma=!0,St="|"),Qe({type:"comma",value:He,output:St});continue}if(He==="/"){if(Ge.type==="dot"&&Ie.index===Ie.start+1){Ie.start=Ie.index+1,Ie.consumed="",Ie.output="",oe.pop(),Ge=ie;continue}Qe({type:"slash",value:He,output:de});continue}if(He==="."){if(Ie.braces>0&&Ge.type==="dot"){Ge.value==="."&&(Ge.output=ce);const St=Ue[Ue.length-1];Ge.type="dots",Ge.output+=He,Ge.value+=He,St.dots=!0;continue}if(Ie.braces+Ie.parens===0&&Ge.type!=="bos"&&Ge.type!=="slash"){Qe({type:"text",value:He,output:ce});continue}Qe({type:"dot",value:He,output:ce});continue}if(He==="?"){if(!(Ge&&Ge.value==="(")&&Z.noextglob!==!0&&Ke()==="("&&Ke(2)!=="?"){Ze("qmark",He);continue}if(Ge&&Ge.type==="paren"){const St=Ke();let Et=He;(Ge.value==="("&&!/[!=<:]/.test(St)||St==="<"&&!/<([!=]|\w+>)/.test(Je()))&&(Et=`\\${He}`),Qe({type:"text",value:He,output:Et});continue}if(Z.dot!==!0&&(Ge.type==="slash"||Ge.type==="bos")){Qe({type:"qmark",value:He,output:ve});continue}Qe({type:"qmark",value:He,output:ye});continue}if(He==="!"){if(Z.noextglob!==!0&&Ke()==="("&&(Ke(2)!=="?"||!/[!=<:]/.test(Ke(3)))){Ze("negate",He);continue}if(Z.nonegate!==!0&&Ie.index===0){ct();continue}}if(He==="+"){if(Z.noextglob!==!0&&Ke()==="("&&Ke(2)!=="?"){Ze("plus",He);continue}if(Ge&&Ge.value==="("||Z.regex===!1){Qe({type:"plus",value:He,output:fe});continue}if(Ge&&(Ge.type==="bracket"||Ge.type==="paren"||Ge.type==="brace")||Ie.parens>0){Qe({type:"plus",value:He});continue}Qe({type:"plus",value:fe});continue}if(He==="@"){if(Z.noextglob!==!0&&Ke()==="("&&Ke(2)!=="?"){Qe({type:"at",extglob:!0,value:He,output:""});continue}Qe({type:"text",value:He});continue}if(He!=="*"){(He==="$"||He==="^")&&(He=`\\${He}`);const St=REGEX_NON_SPECIAL_CHARS.exec(Je());St&&(He+=St[0],Ie.index+=St[0].length),Qe({type:"text",value:He});continue}if(Ge&&(Ge.type==="globstar"||Ge.star===!0)){Ge.type="star",Ge.star=!0,Ge.value+=He,Ge.output=Pe,Ie.backtrack=!0,Ie.globstar=!0,ot(He);continue}let nt=Je();if(Z.noextglob!==!0&&/^\([^?]/.test(nt)){Ze("star",He);continue}if(Ge.type==="star"){if(Z.noglobstar===!0){ot(He);continue}const St=Ge.prev,Et=St.prev,Nt=St.type==="slash"||St.type==="bos",zt=Et&&(Et.type==="star"||Et.type==="globstar");if(Z.bash===!0&&(!Nt||nt[0]&&nt[0]!=="/")){Qe({type:"star",value:He,output:""});continue}const yt=Ie.braces>0&&(St.type==="comma"||St.type==="brace"),Ut=$e.length&&(St.type==="pipe"||St.type==="paren");if(!Nt&&St.type!=="paren"&&!yt&&!Ut){Qe({type:"star",value:He,output:""});continue}for(;nt.slice(0,3)==="/**";){const bt=K[Ie.index+4];if(bt&&bt!=="/")break;nt=nt.slice(3),ot("/**",3)}if(St.type==="bos"&&ze()){Ge.type="globstar",Ge.value+=He,Ge.output=be(Z),Ie.output=Ge.output,Ie.globstar=!0,ot(He);continue}if(St.type==="slash"&&St.prev.type!=="bos"&&!zt&&ze()){Ie.output=Ie.output.slice(0,-(St.output+Ge.output).length),St.output=`(?:${St.output}`,Ge.type="globstar",Ge.output=be(Z)+(Z.strictSlashes?")":"|$)"),Ge.value+=He,Ie.globstar=!0,Ie.output+=St.output+Ge.output,ot(He);continue}if(St.type==="slash"&&St.prev.type!=="bos"&&nt[0]==="/"){const bt=nt[1]!==void 0?"|$":"";Ie.output=Ie.output.slice(0,-(St.output+Ge.output).length),St.output=`(?:${St.output}`,Ge.type="globstar",Ge.output=`${be(Z)}${de}|${de}${bt})`,Ge.value+=He,Ie.output+=St.output+Ge.output,Ie.globstar=!0,ot(He+tt()),Qe({type:"slash",value:"/",output:""});continue}if(St.type==="bos"&&nt[0]==="/"){Ge.type="globstar",Ge.value+=He,Ge.output=`(?:^|${de}|${be(Z)}${de})`,Ie.output=Ge.output,Ie.globstar=!0,ot(He+tt()),Qe({type:"slash",value:"/",output:""});continue}Ie.output=Ie.output.slice(0,-Ge.output.length),Ge.type="globstar",Ge.output=be(Z),Ge.value+=He,Ie.output+=Ge.output,Ie.globstar=!0,ot(He);continue}const Tt={type:"star",value:He,output:Pe};if(Z.bash===!0){Tt.output=".*?",(Ge.type==="bos"||Ge.type==="slash")&&(Tt.output=Re+Tt.output),Qe(Tt);continue}if(Ge&&(Ge.type==="bracket"||Ge.type==="paren")&&Z.regex===!0){Tt.output=He,Qe(Tt);continue}(Ie.index===Ie.start||Ge.type==="slash"||Ge.type==="dot")&&(Ge.type==="dot"?(Ie.output+=me,Ge.output+=me):Z.dot===!0?(Ie.output+=Ae,Ge.output+=Ae):(Ie.output+=Re,Ge.output+=Re),Ke()!=="*"&&(Ie.output+=pe,Ge.output+=pe)),Qe(Tt)}for(;Ie.brackets>0;){if(Z.strictBrackets===!0)throw new SyntaxError(syntaxError("closing","]"));Ie.output=utils$2.escapeLast(Ie.output,"["),lt("brackets")}for(;Ie.parens>0;){if(Z.strictBrackets===!0)throw new SyntaxError(syntaxError("closing",")"));Ie.output=utils$2.escapeLast(Ie.output,"("),lt("parens")}for(;Ie.braces>0;){if(Z.strictBrackets===!0)throw new SyntaxError(syntaxError("closing","}"));Ie.output=utils$2.escapeLast(Ie.output,"{"),lt("braces")}if(Z.strictSlashes!==!0&&(Ge.type==="star"||Ge.type==="bracket")&&Qe({type:"maybe_slash",value:"",output:`${de}?`}),Ie.backtrack===!0){Ie.output="";for(const nt of Ie.tokens)Ie.output+=nt.output!=null?nt.output:nt.value,nt.suffix&&(Ie.output+=nt.suffix)}return Ie};parse$8.fastpaths=(K,_)=>{const Z={..._},te=typeof Z.maxLength=="number"?Math.min(MAX_LENGTH,Z.maxLength):MAX_LENGTH,ne=K.length;if(ne>te)throw new SyntaxError(`Input length: ${ne}, exceeds maximum allowed length: ${te}`);K=REPLACEMENTS[K]||K;const{DOT_LITERAL:ie,SLASH_LITERAL:oe,ONE_CHAR:se,DOTS_SLASH:ae,NO_DOT:le,NO_DOTS:ce,NO_DOTS_SLASH:fe,STAR:de,START_ANCHOR:pe}=constants$1.globChars(Z.windows),he=Z.dot?ce:le,ge=Z.dot?fe:le,me=Z.capture?"":"?:",Ae={negated:!1,prefix:""};let ye=Z.bash===!0?".*?":de;Z.capture&&(ye=`(${ye})`);const ve=Re=>Re.noglobstar===!0?ye:`(${me}(?:(?!${pe}${Re.dot?ae:ie}).)*?)`,_e=Re=>{switch(Re){case"*":return`${he}${se}${ye}`;case".*":return`${ie}${se}${ye}`;case"*.*":return`${he}${ye}${ie}${se}${ye}`;case"*/*":return`${he}${ye}${oe}${se}${ge}${ye}`;case"**":return he+ve(Z);case"**/*":return`(?:${he}${ve(Z)}${oe})?${ge}${se}${ye}`;case"**/*.*":return`(?:${he}${ve(Z)}${oe})?${ge}${ye}${ie}${se}${ye}`;case"**/.*":return`(?:${he}${ve(Z)}${oe})?${ie}${se}${ye}`;default:{const we=/^(.*?)\.(\w+)$/.exec(Re);if(!we)return;const Pe=_e(we[1]);return Pe?Pe+ie+we[2]:void 0}}},Te=utils$2.removePrefix(K,Ae);let be=_e(Te);return be&&Z.strictSlashes!==!0&&(be+=`${oe}?`),be};var parse_1$1=parse$8;const scan=scan_1,parse$7=parse_1$1,utils$1=utils$4,constants=constants$2,isObject$1=K=>K&&typeof K=="object"&&!Array.isArray(K),picomatch$2=(K,_,Z=!1)=>{if(Array.isArray(K)){const ce=K.map(fe=>picomatch$2(fe,_,Z));return fe=>{for(const de of ce){const pe=de(fe);if(pe)return pe}return!1}}const te=isObject$1(K)&&K.tokens&&K.input;if(K===""||typeof K!="string"&&!te)throw new TypeError("Expected pattern to be a non-empty string");const ne=_||{},ie=ne.windows,oe=te?picomatch$2.compileRe(K,_):picomatch$2.makeRe(K,_,!1,!0),se=oe.state;delete oe.state;let ae=()=>!1;if(ne.ignore){const ce={..._,ignore:null,onMatch:null,onResult:null};ae=picomatch$2(ne.ignore,ce,Z)}const le=(ce,fe=!1)=>{const{isMatch:de,match:pe,output:he}=picomatch$2.test(ce,oe,_,{glob:K,posix:ie}),ge={glob:K,state:se,regex:oe,posix:ie,input:ce,output:he,match:pe,isMatch:de};return typeof ne.onResult=="function"&&ne.onResult(ge),de===!1?(ge.isMatch=!1,fe?ge:!1):ae(ce)?(typeof ne.onIgnore=="function"&&ne.onIgnore(ge),ge.isMatch=!1,fe?ge:!1):(typeof ne.onMatch=="function"&&ne.onMatch(ge),fe?ge:!0)};return Z&&(le.state=se),le};picomatch$2.test=(K,_,Z,{glob:te,posix:ne}={})=>{if(typeof K!="string")throw new TypeError("Expected input to be a string");if(K==="")return{isMatch:!1,output:""};const ie=Z||{},oe=ie.format||(ne?utils$1.toPosixSlashes:null);let se=K===te,ae=se&&oe?oe(K):K;return se===!1&&(ae=oe?oe(K):K,se=ae===te),(se===!1||ie.capture===!0)&&(ie.matchBase===!0||ie.basename===!0?se=picomatch$2.matchBase(K,_,Z,ne):se=_.exec(ae)),{isMatch:!!se,match:se,output:ae}};picomatch$2.matchBase=(K,_,Z)=>(_ instanceof RegExp?_:picomatch$2.makeRe(_,Z)).test(utils$1.basename(K));picomatch$2.isMatch=(K,_,Z)=>picomatch$2(_,Z)(K);picomatch$2.parse=(K,_)=>Array.isArray(K)?K.map(Z=>picomatch$2.parse(Z,_)):parse$7(K,{..._,fastpaths:!1});picomatch$2.scan=(K,_)=>scan(K,_);picomatch$2.compileRe=(K,_,Z=!1,te=!1)=>{if(Z===!0)return K.output;const ne=_||{},ie=ne.contains?"":"^",oe=ne.contains?"":"$";let se=`${ie}(?:${K.output})${oe}`;K&&K.negated===!0&&(se=`^(?!${se}).*$`);const ae=picomatch$2.toRegex(se,_);return te===!0&&(ae.state=K),ae};picomatch$2.makeRe=(K,_={},Z=!1,te=!1)=>{if(!K||typeof K!="string")throw new TypeError("Expected a non-empty string");let ne={negated:!1,fastpaths:!0};return _.fastpaths!==!1&&(K[0]==="."||K[0]==="*")&&(ne.output=parse$7.fastpaths(K,_)),ne.output||(ne=parse$7(K,_)),picomatch$2.compileRe(ne,_,Z,te)};picomatch$2.toRegex=(K,_)=>{try{const Z=_||{};return new RegExp(K,Z.flags||(Z.nocase?"i":""))}catch(Z){if(_&&_.debug===!0)throw Z;return/$^/}};picomatch$2.constants=constants;var picomatch_1$1=picomatch$2;const pico=picomatch_1$1,utils=utils$4;function picomatch(K,_,Z=!1){return _&&(_.windows===null||_.windows===void 0)&&(_={..._,windows:utils.isWindows()}),pico(K,_,Z)}Object.assign(picomatch,pico);var picomatch_1=picomatch;const picomatch$1=getDefaultExportFromCjs(picomatch_1);function readDirectory(K,_,Z=""){if(!K){console.log("entry is null");return}const te=Z?`${Z}/${K.name}`:K.name;if(K.isDirectory){let ne=function(oe,se){oe.readEntries(ae=>{ae.length&&(se(ae),ne(oe,se))})};const ie=K.createReader();_(te,null),ne(ie,oe=>{oe.map(se=>{se&&readDirectory(se,_,te)}),_(te,!1)})}else if(K.isFile){const ne=K;_(te,null),ne.file(ie=>{const oe=URL.createObjectURL(ie);_(te,oe)},ie=>{_(te,!1),console.error(ie)})}}function useFileDrop(K,_=null,Z="**/.DS_Store"){const te=reactExports.useRef(null),[ne,ie]=reactExports.useState(!1),oe=reactExports.useMemo(()=>({}),[]),se=reactExports.useCallback((ye,ve)=>{oe[ye]=ve},[oe]),[ae,le]=reactExports.useState(null),{isIncluded:ce,shouldIgnore:fe}=reactExports.useMemo(()=>({isIncluded:_?picomatch$1(_):null,shouldIgnore:picomatch$1(Z)}),[_,Z]),de=reactExports.useCallback((ye,ve)=>{if(fe(ye)||_&&!ce(ye))return;se(ye,ve);const _e=Object.values(oe||{}),Te=_e.filter(be=>be===null);if(_e.length&&Te.length===0){console.log("all files are loaded",_e.length);const be={};for(const[Re,we]of Object.entries(oe||{}))we&&(be[Re]=we);le(be)}},[ce,fe]);reactExports.useEffect(()=>{Object.values(ae||{}).length&&K&&K(ae,pe)},[ae]);const pe=reactExports.useCallback((ye=!1)=>{Object.entries(oe).forEach(([ve,_e])=>{_e&&_e.startsWith("blob:")&&URL.revokeObjectURL(_e),delete oe[ve]})},[oe]),he=reactExports.useCallback(ye=>{ye.preventDefault(),ye.stopPropagation(),ie(!0)},[]),ge=reactExports.useCallback(ye=>{ye.preventDefault(),ye.stopPropagation(),ie(!1)},[]),me=reactExports.useCallback(ye=>{ye.preventDefault(),ye.stopPropagation()},[]),Ae=reactExports.useCallback(ye=>{var ve;ye.preventDefault(),ye.stopPropagation();const _e=(ve=ye.dataTransfer)==null?void 0:ve.items;console.info(_e),(Array.from(_e)||[]).map(Te=>{const be=Te.webkitGetAsEntry();be&&readDirectory(be,de)}),ie(!1)},[oe,de,pe]);return reactExports.useEffect(()=>{if(!te.current)return;te.current.addEventListener("dragenter",he),te.current.addEventListener("dragleave",ge),te.current.addEventListener("dragover",me),te.current.addEventListener("drop",Ae);const ye=te.current;return()=>{ye==null||ye.removeEventListener("dragenter",he),ye==null||ye.removeEventListener("dragleave",ge),ye==null||ye.removeEventListener("dragover",me),ye==null||ye.removeEventListener("drop",Ae)}},[te.current,he,ge,me,Ae]),{ref:te,loaded:ae,isDragActive:ne,_files:oe}}const dropContainer="_dropContainer_nrs9w_1",fadeContainer="_fadeContainer_nrs9w_7",dropPrompt="_dropPrompt_nrs9w_13",FileDropContainer=({onLoad:K,prompt:_="Drop files here",children:Z,style:te,innerStyle:ne={},...ie})=>{const{ref:oe,isDragActive:se}=useFileDrop(K);return jsxRuntimeExports.jsxs("div",{ref:oe,className:dropContainer,style:{backgroundColor:se?"#000":null,...te},...ie,children:[se&&jsxRuntimeExports.jsx("div",{className:dropPrompt,"data-text":_}),jsxRuntimeExports.jsx("div",{className:fadeContainer,style:{opacity:se?.1:null,...ne},children:Z})]})},CONTRIB_COMPONENT_LIST={},CONTRIB_MODULE_ENTRYPOINTS={},FILE_REGISTER={},DEFAULT_EULER=[-90,0,0].map(K=>K*Math.PI/180);function containUrdfs(K,_,{scale:Z=1,rotation:te=DEFAULT_EULER,...ne}={}){const ie=[];return Object.keys(K).forEach(oe=>{oe.toLowerCase().split(".").pop()==="urdf"&&ie.push(oe)}),ie.forEach(oe=>{_.publish(UpsertOp([{tag:"Urdf",src:oe,key:oe,assets:K,scale:Z,rotation:te,...ne}],"children"))}),ie.length<=0?K:{}}function containMuJoCoScenes(K,_,{scale:Z=1,rotation:te=DEFAULT_EULER,...ne}={}){const ie=[],oe=/\.(mjcf|mjcf\.xml|\.mjb)$/;return Object.keys(K).forEach(se=>{oe.test(se.toLowerCase())&&ie.push(se)}),ie.forEach(se=>{_.publish(UpsertOp([{tag:"MuJoCo",src:se,key:se,assets:K,scale:Z,rotation:te,...ne}],"children"))}),ie.length<=0?K:{}}const SceneFileDropContainer=({stream:K,callback:_=null,children:Z,...te})=>{const ne=reactExports.useCallback((ie,oe)=>{ie=containUrdfs(ie,K,te),ie=containMuJoCoScenes(ie,K,te),Object.keys(ie).forEach(se=>{const ae=se.toLowerCase().split(".").pop();let le,ce,fe=[0,0,0];if(ae==="vuer")fetch(ie[se]).then(de=>{de.text().then(pe=>{try{const he=jsYaml.load(pe);he&&K.publish(SetOp(he))}catch(he){console.error(he)}})});else if(ae==="obj")le="Obj",ce=se;else if(ae==="dae")le="Dae",ce=ie[se];else if(ae==="stl")le="Stl",ce=ie[se];else if(ae==="pcd")le="Pcd",ce=ie[se];else if(ae==="ply")le="Ply",ce=ie[se];else if(ae==="splat")le="Splat",ce=ie[se],fe=[-90,0,-90].map(de=>de*Math.PI/180);else if(ae==="spz")le="SparkSplats",ce=ie[se];else if(ae==="glb")le="Glb",ce=ie[se];else if(ae==="gltf")le="Glb",ce=ie[se];else for(const de of Object.keys(FILE_REGISTER)){const pe=FILE_REGISTER[de];if(picomatch$1(pe.pattern)(se)){le=pe.tag,ce=ie[se];break}}if(!le){console.warn(`Unsupported file type: ${ae}`);return}K.publish(UpsertOp([{tag:le,src:ce,key:`${se}`,assets:ie,castsShadow:!0,receiveShadow:!0,rotation:fe}],"children")),_&&K.publish(TimeoutOp(_,200))})},[K]);return jsxRuntimeExports.jsx(FileDropContainer,{onLoad:ne,...te,children:Z})},AppContext=reactExports.createContext({showError:K=>console.error(K),showInfo:K=>console.info(K),showSuccess:K=>console.log(K),showWarning:K=>console.warn(K),showModal:K=>{console.log(K)}}),AppProvider=AppContext.Provider,VuerRoot=({style:K={display:"flex",flexDirection:"row"},..._})=>{const Z=reactExports.useMemo(()=>{const ie=queryString.parse(document$4.location.search);return typeof ie.collapseMenu=="string"&&(ie.collapseMenu=ie.collapseMenu.toLowerCase()),ie},[]),te=reactExports.useMemo(()=>Z.collapseMenu==="true",[Z.collapseMenu]),{downlink:ne}=useSocket();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SceneFileDropContainer,{stream:ne,style:K,innerStyle:{display:"flex",flexDirection:"row"},children:jsxRuntimeExports.jsx(SceneContainer,{className:vuerRoot,stream:ne,..._})}),jsxRuntimeExports.jsx(Leva,{theme:{sizes:{rootWidth:"380px",controlWidth:"200px",numberInputMinWidth:"56px"}},collapsed:te})]})};function hydrate(K){return!K||K.length===0?null:(Array.isArray(K)?K:[K]).filter(_=>_!==null).filter(_=>!(_!=null&&_.hide)).map(_=>{if(typeof _=="string")return _;{const{key:Z,...te}=_;return jsxRuntimeExports.jsx(Hydrate,{_key:Z,...te},Z)}})}function Hydrate({_key:K,tag:_,children:Z,className:te,...ne}){const ie=comp_list[_]||CONTRIB_COMPONENT_LIST[_]||_,{showWarning:oe}=reactExports.useContext(AppContext);if(!_)return oe(`No tag provided for component <${_} ${K} className="${te}">${Z} </...>`),Z;const se=(Z||[]).map(ae=>{if(typeof ae=="string")return ae;const{key:le,...ce}=ae;return jsxRuntimeExports.jsx(Hydrate,{_key:le,...ce},le)});return typeof ie=="string"?jsxRuntimeExports.jsx(ie,{className:te,...ne,children:se},K):jsxRuntimeExports.jsx(ie,{_key:K,className:te,...ne,children:se},K)}const{Buffer:Buffer$1}=bufferLib;function SceneContainer({stream:K,children:_,rawChildren:Z,htmlChildren:te,bgChildren:ne,wrappers:ie=[],...oe}){const{children:se,rawChildren:ae,bgChildren:le,htmlChildren:ce,wrappers:fe,ops:de,...pe}=useSceneStore(),he=reactExports.useMemo(()=>queryString.parse(document$4.location.search),[]);reactExports.useEffect(()=>{const ye=[K.subscribe("SET",de.set),K.subscribe("ADD",de.add),K.subscribe("UPDATE",de.update),K.subscribe("UPSERT",de.upsert),K.subscribe("REMOVE",de.removeByKey),K.subscribe("TIMEOUT",de.timeout)];return()=>ye.forEach(ve=>ve())},[K]);const{showError:ge}=reactExports.useContext(AppContext),{response:me,state:Ae}=useFetch(he.scene);return reactExports.useEffect(()=>{if(!he.scene)return;const ye=he.scene.toLowerCase();let ve;if(ye.endsWith(".json"))ve=me==null?void 0:me.json();else if(ye.endsWith(".yml")||ye.endsWith(".yaml")||ye.endsWith(".vuer"))ve=me==null?void 0:me.yaml();else if(he.scene)try{const _e=new Buffer$1(he.scene,"base64");ve=unpack(_e)}catch(_e){console.warn("Failed to parse scene",_e)}else return;ve&&setTimeout(()=>de.set(SetOp({tag:"Scene",...ve})),100)},[he.scene,me,Ae]),useControls(()=>({"Camera Control":folder$1({show_cameras:{value:!1,label:"Show Cameras"}},{collapsed:!0}),"Save Scene":button(()=>{const ye=(_e,Te,be)=>{const Re=new Blob([_e],{type:be}),we=document$4.createElement("a");we.href=URL.createObjectURL(Re),we.download=Te,we.click()},ve=jsYaml.dump({children:se,rawChildren:ae,bgChildren:le,htmlChildren:ce,...pe});ye(ve,"scene.vuer","application/x-yaml")}),"Share Scene":button(()=>{const ye=pack({children:se,rawChildren:ae,bgChildren:le,htmlChildren:ce,...pe});if(ye.length>1e4)return ge(`
              The scene likely contains a large amount of data. To share, please replace 
              geometry data with an URI. Length is ${ye.length} bytes.
            `);const ve=String.fromCharCode.apply(null,ye),_e=btoa(ve),Te=new URL(document$4.location);Te.searchParams.set("scene",_e),document$4.location.href=Te.toString()}),Scene:folder$1({},{collapsed:!0}),Render:folder$1({},{collapsed:!0}),"Scene.Options":folder$1({},{collapsed:!0})}),[pe]),jsxRuntimeExports.jsx(Scene,{rawChildren:hydrate(ae)||Z,bgChildren:hydrate(le)||ne,htmlChildren:hydrate(ce)||te,wrappers:hydrate(fe)||ie,frameloop:he.frameloop||"demand",...pe,...oe,children:hydrate(se)||_})}function StlView({data:K,_ref:_,color:Z,matrix:te,hide:ne,...ie}){const{scene:oe}=useThree(),se=reactExports.useRef(null),ae=_||se;return reactExports.useLayoutEffect(()=>{const le=ae.current;te&&te.length===16&&(le.matrix.fromArray(te),le.matrix.decompose(le.position,le.quaternion,le.scale),le.rotation.setFromQuaternion(le.quaternion))},[ae.current,te]),ne?null:(reactExports.useEffect(()=>()=>K.dispose(),[K]),jsxRuntimeExports.jsx("mesh",{ref:ae,geometry:K,...ie,children:jsxRuntimeExports.jsx("meshPhysicalMaterial",{color:Z||"#ffffff",roughness:0})}))}function DaeView({data:K,_ref:_,matrix:Z,color:te,hide:ne,...ie}){const{scene:oe}=useThree(),se=reactExports.useRef(null),ae=_||se;return reactExports.useLayoutEffect(()=>{Z&&Z.length===16&&(K.matrix.fromArray(Z),K.matrix.decompose(K.position,K.quaternion,K.scale),K.rotation.setFromQuaternion(K.quaternion))},[K,Z]),reactExports.useLayoutEffect(()=>{te&&K.traverse(le=>{le.isMesh&&le.material.color.set(te)})},[K,te]),reactExports.useEffect(()=>()=>{oe.remove(K)},[K]),ne?null:jsxRuntimeExports.jsx("primitive",{ref:ae,object:K,...ie})}const ALL_MATERIALS={undefined:MeshPhysicalMaterial,null:MeshPhysicalMaterial,basic:MeshBasicMaterial,phong:MeshPhongMaterial,lambert:MeshLambertMaterial,standard:MeshStandardMaterial,normal:MeshNormalMaterial,depth:MeshDepthMaterial,physical:MeshPhysicalMaterial,points:PointsMaterial,line:LineBasicMaterial,lineDashed:LineDashedMaterial,sprite:SpriteMaterial,shadow:ShadowMaterial,rawShader:RawShaderMaterial};function ObjView({data:K,_ref:_,wireframe:Z=!1,color:te=null,matrix:ne,material:ie,materialType:oe,hide:se,...ae}){const le=reactExports.useRef(null),ce=_||le;reactExports.useEffect(()=>{const pe=ce.current;pe&&ne&&(pe.matrix.fromArray(ne),pe.matrix.decompose(pe.position,pe.quaternion,pe.scale),pe.rotation.setFromQuaternion(pe.quaternion))},[ne,ce.current]);const fe=reactExports.useMemo(()=>{if(!oe)return null;const pe=ALL_MATERIALS[oe];return new pe({color:te,...ie})},[]),{scene:de}=useThree();return reactExports.useEffect(()=>(K==null||K.traverse(pe=>{var he;pe.castShadow=!0,pe.receiveShadow=!0,fe&&(pe==null?void 0:pe.material)!==fe&&(pe.material.dispose(),pe.material=fe),pe.material&&(pe.material.wireframe=Z,(he=pe.material.color)==null||he.set(te),pe.material.needsUpdate=!0)}),()=>{de.remove(K),fe==null||fe.dispose()}),[K,te,Z,oe,ie]),!K||se?null:jsxRuntimeExports.jsx("primitive",{ref:ce,receiveShadow:!0,castShadow:!0,object:K,...ae})}function PlyView({data:K,_ref:_,size:Z=.005,color:te,matrix:ne,hide:ie,map:oe,...se}){const ae=reactExports.useRef(null),le=_||ae;if(reactExports.useEffect(()=>{const de=le.current;de&&ne&&(de.matrix.fromArray(ne),de.matrix.decompose(de.position,de.quaternion,de.scale),de.rotation.setFromQuaternion(de.quaternion))},[ne,le.current]),!K||ie)return null;K.attributes.normal||console.log("data.attributes.normal is missing"),K.attributes.uv&&console.log("data.attributes.uv found"),K&&!K.attributes.normal&&(K.index||K.attributes.uv?(console.log("compute normals for data. "),K.computeVertexNormals()):console.log("Both data.index and data.attributes.normal are missing. Won't be able to compute surface normals."));const ce=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{const de=ce.current;de&&(de.needsUpdate=!0)},[oe]);const fe=te||K.attributes.color||"#ffffff";return K.attributes.normal?jsxRuntimeExports.jsxs("mesh",{ref:le,castShadow:!0,receiveShadow:!0,...se,children:[jsxRuntimeExports.jsx("bufferGeometry",{...K}),jsxRuntimeExports.jsx("meshPhysicalMaterial",{ref:ce,attach:"material",side:2,vertexColors:!!K.attributes.color,color:fe,map:oe})]}):jsxRuntimeExports.jsxs("points",{ref:le,...se,children:[jsxRuntimeExports.jsx("bufferGeometry",{...K}),jsxRuntimeExports.jsx("pointsMaterial",{ref:ce,size:Z,vertexColors:!!K.attributes.color,color:fe,sizeAttenuation:!0})]})}function PcdView({data:K,_ref:_,size:Z=.0015,hide:te,matrix:ne,...ie}){const oe=reactExports.useRef(null),se=_||oe,ae=useXR(({mode:ce})=>ce),le=ae==="immersive-ar"||ae==="immersive-vr";return reactExports.useLayoutEffect(()=>{const ce=se.current;ce&&ne&&(ce.matrix.fromArray(ne),ce.matrix.decompose(ce.position,ce.quaternion,ce.scale),ce.rotation.setFromQuaternion(ce.quaternion))},[ne,se.current]),!K||te?null:jsxRuntimeExports.jsx("points",{ref:se,...ie,geometry:K.geometry,children:jsxRuntimeExports.jsx("pointsMaterial",{attach:"material",vertexColors:!0,size:le?Z*1e3:Z,sizeAttenuation:!0,transparent:!0,alphaTest:1,opacity:1})})}function UrdfView({robot:K,_ref:_,jointValues:Z={},matrix:te,materialType:ne="physical",material:ie,hide:oe,...se}){const{scene:ae}=useThree();return reactExports.useEffect(()=>{te&&te.length===16&&(K.matrix.fromArray(te),K.matrix.decompose(K.position,K.quaternion,K.scale),K.rotation.setFromQuaternion(K.quaternion))},[K,te]),reactExports.useEffect(()=>{if(!ne)return;const le=ALL_MATERIALS[ne];return K.traverseVisible(ce=>{ce.isMesh&&ce.material&&(ce.material=new le(ie),ce.material.needsUpdate=!0)}),()=>{}},[K,ne]),reactExports.useEffect(()=>{if(ne)return K.traverseVisible(le=>{!le.isMesh||!le.material||(Array.isArray(le.material)?le.material.forEach((ce,fe)=>{Object.assign(ce,ie),le.material[fe].needsUpdate=!0}):(Object.assign(le.material,ie),le.material.needsUpdate=!0))}),()=>{}},[K,JSON.stringify(ie)]),reactExports.useEffect(()=>(Z&&(K==null||K.setJointValues(Z)),()=>{ae.remove(K)}),[K,Z]),oe?null:jsxRuntimeExports.jsx("primitive",{ref:_,object:K,...se})}function GltfView({data:K,_ref:_,matrix:Z,color:te,materialType:ne,material:ie,hide:oe,...se}){const{scene:ae}=useThree();return reactExports.useLayoutEffect(()=>{Z&&Z.length===16&&(K.scene.matrix.fromArray(Z),K.scene.matrix.decompose(K.scene.position,K.scene.quaternion,K.scene.scale),K.scene.rotation.setFromQuaternion(K.scene.quaternion))},[K,Z]),reactExports.useLayoutEffect(()=>{if(ne){const le=ALL_MATERIALS[ne],ce=new le({color:te,...ie});return K.scene.traverse(fe=>{fe.material=ce}),()=>ce.dispose()}else te&&K.scene.traverse(le=>{var ce,fe;le!=null&&le.isMesh&&((fe=(ce=le.material)==null?void 0:ce.color)==null||fe.set(te))})},[K,te,ne,ie]),reactExports.useEffect(()=>()=>{ae.remove(K.scene)},[K]),oe?null:jsxRuntimeExports.jsx("primitive",{ref:_,object:K.scene,...se})}const THREE_PATH=`https://unpkg.com/three@0.${REVISION}.x`,ktx2path=`${THREE_PATH}/examples/jsm/libs/basis/`;let globalLoaderPromise=null;function resetGlobalLoader(){globalLoaderPromise=null}function createGlobalLoader(K){return globalLoaderPromise||(globalLoaderPromise=(async()=>{const _=new DRACOLoader;_.setDecoderConfig({type:"js"}),_.setDecoderPath(`${THREE_PATH}/examples/jsm/libs/draco/`);const Z=new KTX2Loader().setTranscoderPath(ktx2path);await Z.detectSupport(K);const te=new GLTFLoader$1,ne=await __vitePreload(()=>import("./chunk-DmN89Kj7.js"),[]);return await ne.ready,te.setMeshoptDecoder(ne.MeshoptDecoder),te.setDRACOLoader(_),te.setKTX2Loader(Z),te})(),globalLoaderPromise)}function Glb({_key:K,src:_,text:Z,buff:te,hide:ne,encoding:ie="ascii",onLoad:oe,...se}){const[ae,le]=reactExports.useState(),{gl:ce}=useThree();reactExports.useEffect(()=>{!ae&&ne||(async()=>{const de=await createGlobalLoader(ce);let pe=Z;if(te&&(pe=new TextDecoder(ie).decode(te)),pe)de.parse(pe,"",le);else if(_){const he=await(await fetch(_)).arrayBuffer();de.parse(he,"",le,ge=>{ge&&console.error("[Glb] parse error:",ge)})}})()},[_,ne,ce]);const{sendMsg:fe}=useSocket();return reactExports.useEffect(()=>{ae&&(typeof oe=="function"&&oe(),typeof oe=="string"&&fe({ts:Date.now(),etype:"LOAD",key:K,value:oe}))},[ae]),ae?jsxRuntimeExports.jsx(GltfView,{data:ae,hide:ne,...se}):null}const getMTL=K=>{const _=[],Z=K.split(`
`);for(const te of Z){const ne=te.trim();ne.trim().startsWith("mtllib")&&_.push(ne.replace("mtllib ","").trim())}return _};function getFileName(K){var _;return((_=K.split("/").pop())==null?void 0:_.split("?")[0].split("#")[0])||""}function getDir(K){try{const _=new URL(K);if(_.protocol==="http:"||_.protocol==="https:"){const Z=_.pathname.split("/").slice(0,-1);return`${_.origin}${Z.length>0?Z.join("/"):"/"}`}else if(_.protocol==="file:"){const Z=_.pathname.split("/").slice(0,-1);return decodeURI(Z.join("/"))}else{if(_.protocol==="blob:")return"/"+new URL(_.pathname).pathname.split("/").filter(Boolean).slice(0,-1).join("/");throw new Error("Invalid URL provided: unsupported protocol")}}catch{const _=K.replace(/\/+$/,"").split("/");return _.length<=1?"":_.slice(0,-1).join("/")}}function join$1(...K){return K.filter(_=>_).reduce((_,Z,te)=>{if(!_)return Z.replace(/\/+$/,"");try{return new URL(Z).href}catch{return _.replace(/\/+$/,"")+"/"+Z.replace(/^\/+/,"")}},"")}function simplifyPath(K){const _=K.startsWith("/"),Z=K.split("/").filter(ie=>ie!==""&&ie!=="."),te=[];for(const ie of Z)ie===".."?te.length>0&&te[te.length-1]!==".."?te.pop():_||te.push(".."):te.push(ie);const ne=(_?"/":"")+te.join("/");return ne===""?"/":ne}function Obj({_key:K,src:_,text:Z,buff:te,mtl:ne,assets:ie,hide:oe,encoding:se="ascii",onLoad:ae,...le}){const[ce,fe]=reactExports.useState();reactExports.useEffect(()=>{if(!ce&&oe)return;const pe=new LoadingManager;pe.setURLModifier(Ae=>{const ye=picomatch$1(Ae);if(!ie)return Ae;const ve=Object.keys(ie).find(_e=>_e===Ae||ye(_e));return ve?ie[ve]:Ae});const he=new OBJLoader(pe),ge=new MTLLoader(pe),me=getDir(_||"");(async()=>{te&&(Z=new TextDecoder(se).decode(te)),_&&(Z=await fetch((ie==null?void 0:ie[_])||_).then(_e=>_e.text()));const Ae=getMTL(Z).map(_e=>simplifyPath(join$1(me,_e)));ne=ne||(Ae==null?void 0:Ae[0]);const ye=()=>Z&&fe(he.parse(Z)),ve=_e=>{he.setMaterials(_e),ye()};ne?ge.load(ne,ve,void 0,ye):ye()})()},[_,oe]);const{sendMsg:de}=useSocket();return reactExports.useEffect(()=>{ce&&(typeof ae=="function"&&ae(),typeof ae=="string"&&de({ts:Date.now(),etype:"LOAD",key:K,value:ae}))},[ce]),ce?jsxRuntimeExports.jsx(ObjView,{data:ce,hide:oe,...le}):null}function Pcd({_key:K,src:_,text:Z,buff:te,hide:ne,encoding:ie="ascii",onLoad:oe,...se}){const[ae,le]=reactExports.useState();reactExports.useEffect(()=>{if(!ae&&ne)return;const fe=new PCDLoader;te&&(Z=new TextDecoder(ie).decode(te)),Z?le(fe.parse(Z,"")):_&&fe.load(_,le)},[_,ne]);const{sendMsg:ce}=useSocket();return reactExports.useEffect(()=>{ae&&(typeof oe=="function"&&oe(),typeof oe=="string"&&ce({ts:Date.now(),etype:"LOAD",key:K,value:oe}))},[ae]),ae?jsxRuntimeExports.jsx(PcdView,{data:ae,hide:ne,...se}):null}const getTextures=K=>{const _=[],Z=K.split(`
`);for(const te of Z)te.startsWith("comment TextureFile")&&_.push(te.replace("comment TextureFile ","").trim());return _};function Ply({_key:K,src:_,text:Z,buff:te,hide:ne,assets:ie,encoding:oe="ascii",onLoad:se,...ae}){const[le,ce]=reactExports.useState(),[fe,de]=reactExports.useState();reactExports.useEffect(()=>{if(!le&&ne)return;const he=new PLYLoader;ie&&he.setPropertyNameMapping(ie),(async()=>{if(te){Z=new TextDecoder(oe).decode(te);const ge=he.parse(te);ce(ge)}else _&&(Z=await fetch(_).then(ge=>ge.text()),he.load(_,ce));if(Z){const ge=getTextures(Z);if(!(ge!=null&&ge.length))return;const me=ge==null?void 0:ge[0],Ae=ie==null?void 0:ie[me];new TextureLoader().load(Ae,ye=>{ye.needsUpdate=!0,de(ye)})}})()},[_,ne,ce,de]);const{sendMsg:pe}=useSocket();return reactExports.useEffect(()=>{le&&(typeof se=="function"&&se(),typeof se=="string"&&(pe==null||pe({ts:Date.now(),etype:"LOAD",key:K,value:se})))},[le]),le?jsxRuntimeExports.jsx(PlyView,{data:le,hide:ne,map:fe,...ae}):null}const _tempAxis=new Vector3,_tempEuler=new Euler,_tempTransform=new Matrix4,_tempOrigTransform=new Matrix4,_tempQuat=new Quaternion,_tempScale=new Vector3(1,1,1),_tempPosition=new Vector3;class URDFBase extends Object3D{constructor(){super(),ue(this,"urdfNode"),ue(this,"urdfName"),this.urdfNode=null,this.urdfName=""}copy(_,Z=!1){return super.copy(_,Z),this.urdfNode=_.urdfNode,this.urdfName=_.urdfName,this}}class URDFCollider extends URDFBase{constructor(){super(),ue(this,"isURDFCollider"),this.isURDFCollider=!0,this.type="URDFCollider"}}class URDFVisual extends URDFBase{constructor(){super(),ue(this,"isURDFVisual"),this.isURDFVisual=!0,this.type="URDFVisual"}}class URDFLink extends URDFBase{constructor(){super(),ue(this,"isURDFLink"),this.isURDFLink=!0,this.type="URDFLink"}}class URDFJoint extends URDFBase{constructor(){super(),ue(this,"isURDFJoint"),ue(this,"_jointType"),ue(this,"jointValue"),ue(this,"axis"),ue(this,"limit"),ue(this,"ignoreLimits"),ue(this,"origPosition"),ue(this,"origQuaternion"),ue(this,"mimicJoints"),this.isURDFJoint=!0,this.type="URDFJoint",this.jointValue=null,this._jointType="fixed",this.axis=new Vector3(1,0,0),this.limit={lower:0,upper:0},this.ignoreLimits=!1,this.origPosition=null,this.origQuaternion=null,this.mimicJoints=[]}get jointType(){return this._jointType}set jointType(_){if(this.jointType!==_)switch(this._jointType=_,this.matrixWorldNeedsUpdate=!0,_){case"fixed":this.jointValue=[];break;case"continuous":case"revolute":case"prismatic":this.jointValue=new Array(1).fill(0);break;case"planar":this.jointValue=new Array(3).fill(0),this.axis=new Vector3(0,0,1);break;case"floating":this.jointValue=new Array(6).fill(0);break}}get angle(){return this.jointValue?this.jointValue[0]:0}copy(_,Z=!1){return super.copy(_,Z),this.jointType=_.jointType,this.axis=_.axis.clone(),this.limit.lower=_.limit.lower,this.limit.upper=_.limit.upper,this.ignoreLimits=_.ignoreLimits,this.jointValue=_.jointValue?[..._.jointValue]:null,this.origPosition=_.origPosition?_.origPosition.clone():null,this.origQuaternion=_.origQuaternion?_.origQuaternion.clone():null,this.mimicJoints=_.mimicJoints?[..._.mimicJoints]:[],this}setJointValue(..._){_=_.map(te=>te===null?null:parseFloat(te)),(!this.origPosition||!this.origQuaternion)&&(this.origPosition=this.position.clone(),this.origQuaternion=this.quaternion.clone());let Z=!1;switch(this.mimicJoints.forEach(te=>{Z=te.updateFromMimickedJoint(..._)||Z}),this.jointType){case"fixed":return Z;case"continuous":case"revolute":{let te=_[0];return te==null||te===this.jointValue[0]?Z:(!this.ignoreLimits&&this.jointType==="revolute"&&(te=Math.min(this.limit.upper,te),te=Math.max(this.limit.lower,te)),this.quaternion.setFromAxisAngle(this.axis,te).premultiply(this.origQuaternion),this.jointValue[0]!==te?(this.jointValue[0]=te,this.matrixWorldNeedsUpdate=!0,!0):Z)}case"prismatic":{let te=_[0];return te==null||te===this.jointValue[0]?Z:(this.ignoreLimits||(te=Math.min(this.limit.upper,te),te=Math.max(this.limit.lower,te)),this.position.copy(this.origPosition),_tempAxis.copy(this.axis).applyEuler(this.rotation),this.position.addScaledVector(_tempAxis,te),this.jointValue[0]!==te?(this.jointValue[0]=te,this.matrixWorldNeedsUpdate=!0,!0):Z)}case"floating":return this.jointValue.every((te,ne)=>_[ne]===te||_[ne]===null)?Z:(this.jointValue[0]=_[0]!==null?_[0]:this.jointValue[0],this.jointValue[1]=_[1]!==null?_[1]:this.jointValue[1],this.jointValue[2]=_[2]!==null?_[2]:this.jointValue[2],this.jointValue[3]=_[3]!==null?_[3]:this.jointValue[3],this.jointValue[4]=_[4]!==null?_[4]:this.jointValue[4],this.jointValue[5]=_[5]!==null?_[5]:this.jointValue[5],_tempOrigTransform.compose(this.origPosition,this.origQuaternion,_tempScale),_tempQuat.setFromEuler(_tempEuler.set(this.jointValue[3],this.jointValue[4],this.jointValue[5],"XYZ")),_tempPosition.set(this.jointValue[0],this.jointValue[1],this.jointValue[2]),_tempTransform.compose(_tempPosition,_tempQuat,_tempScale),_tempOrigTransform.premultiply(_tempTransform),this.position.setFromMatrixPosition(_tempOrigTransform),this.rotation.setFromRotationMatrix(_tempOrigTransform),this.matrixWorldNeedsUpdate=!0,!0);case"planar":return this.jointValue.every((te,ne)=>_[ne]===te||_[ne]===null)?Z:(this.jointValue[0]=_[0]!==null?_[0]:this.jointValue[0],this.jointValue[1]=_[1]!==null?_[1]:this.jointValue[1],this.jointValue[2]=_[2]!==null?_[2]:this.jointValue[2],_tempOrigTransform.compose(this.origPosition,this.origQuaternion,_tempScale),_tempQuat.setFromAxisAngle(this.axis,this.jointValue[2]),_tempPosition.set(this.jointValue[0],this.jointValue[1],0),_tempTransform.compose(_tempPosition,_tempQuat,_tempScale),_tempOrigTransform.premultiply(_tempTransform),this.position.setFromMatrixPosition(_tempOrigTransform),this.rotation.setFromRotationMatrix(_tempOrigTransform),this.matrixWorldNeedsUpdate=!0,!0);default:return Z}}}class URDFMimicJoint extends URDFJoint{constructor(){super(),ue(this,"mimicJoint"),ue(this,"offset"),ue(this,"multiplier"),this.type="URDFMimicJoint",this.mimicJoint=null,this.offset=0,this.multiplier=1}updateFromMimickedJoint(..._){const Z=_.map(te=>te*this.multiplier+this.offset);return super.setJointValue(...Z)}copy(_,Z=!1){return super.copy(_,Z),this.mimicJoint=_.mimicJoint,this.offset=_.offset,this.multiplier=_.multiplier,this}}class URDFRobot extends URDFLink{constructor(){super(),ue(this,"isURDFRobot"),ue(this,"urdfRobotNode"),ue(this,"robotName"),ue(this,"links"),ue(this,"joints"),ue(this,"colliders"),ue(this,"visual"),ue(this,"frames"),this.isURDFRobot=!0,this.urdfNode=null,this.urdfRobotNode=null,this.robotName=null,this.links={},this.joints={},this.colliders={},this.visual={},this.frames={}}copy(_,Z=!1){super.copy(_,Z),this.urdfRobotNode=_.urdfRobotNode,this.robotName=_.robotName,this.links={},this.joints={},this.colliders={},this.visual={},this.traverse(te=>{te instanceof URDFJoint&&te.urdfName in _.joints&&(this.joints[te.urdfName]=te),te instanceof URDFLink&&te.urdfName in _.links&&(this.links[te.urdfName]=te),te instanceof URDFCollider&&te.urdfName in _.colliders&&(this.colliders[te.urdfName]=te),te instanceof URDFVisual&&te.urdfName in _.visual&&(this.visual[te.urdfName]=te)});for(const te in this.joints){const ne=this.joints[te];ne.mimicJoints=ne.mimicJoints.map(ie=>this.joints[ie.urdfName])}return this.frames={...this.colliders,...this.visual,...this.links,...this.joints},this}getFrame(_){return this.frames[_]}setJointValue(_,...Z){const te=this.joints?this.joints[_]:null;return te?te.setJointValue(...Z):!1}setJointValues(_){let Z=!1;for(const te in _){const ne=_[te];Array.isArray(ne)?Z=this.setJointValue(te,...ne)||Z:Z=this.setJointValue(te,ne)||Z}return Z}}new Vector3;new Vector3;new Vector3;new Vector3;new Vector3;new Vector3;new Vector3;new Plane$2;class STLLoader extends Loader{constructor(_){super(_)}load(_,Z,te,ne){const ie=this,oe=new FileLoader(this.manager);oe.setPath(this.path),oe.setResponseType("arraybuffer"),oe.setRequestHeader(this.requestHeader),oe.setWithCredentials(this.withCredentials),oe.load(_,function(se){try{Z(ie.parse(se))}catch(ae){ne?ne(ae):console.error(ae),ie.manager.itemError(_)}},te,ne)}parse(_){function Z(le){const ce=new DataView(le),fe=32/8*3+32/8*3*3+16/8,de=ce.getUint32(80,!0);if(80+32/8+de*fe===ce.byteLength)return!0;const pe=[115,111,108,105,100];for(let he=0;he<5;he++)if(te(pe,ce,he))return!1;return!0}function te(le,ce,fe){for(let de=0,pe=le.length;de<pe;de++)if(le[de]!==ce.getUint8(fe+de))return!1;return!0}function ne(le){const ce=new DataView(le),fe=ce.getUint32(80,!0);let de,pe,he,ge=!1,me,Ae,ye,ve,_e;for(let $e=0;$e<70;$e++)ce.getUint32($e,!1)==1129270351&&ce.getUint8($e+4)==82&&ce.getUint8($e+5)==61&&(ge=!0,me=new Float32Array(fe*3*3),Ae=ce.getUint8($e+6)/255,ye=ce.getUint8($e+7)/255,ve=ce.getUint8($e+8)/255,_e=ce.getUint8($e+9)/255);const Te=84,be=12*4+2,Re=new BufferGeometry,we=new Float32Array(fe*3*3),Pe=new Float32Array(fe*3*3),Ie=new Color$1;for(let $e=0;$e<fe;$e++){const Ue=Te+$e*be,ke=ce.getFloat32(Ue,!0),Ge=ce.getFloat32(Ue+4,!0),He=ce.getFloat32(Ue+8,!0);if(ge){const ze=ce.getUint16(Ue+48,!0);ze&32768?(de=Ae,pe=ye,he=ve):(de=(ze&31)/31,pe=(ze>>5&31)/31,he=(ze>>10&31)/31)}for(let ze=1;ze<=3;ze++){const Ke=Ue+ze*12,tt=$e*3*3+(ze-1)*3;we[tt]=ce.getFloat32(Ke,!0),we[tt+1]=ce.getFloat32(Ke+4,!0),we[tt+2]=ce.getFloat32(Ke+8,!0),Pe[tt]=ke,Pe[tt+1]=Ge,Pe[tt+2]=He,ge&&(Ie.setRGB(de,pe,he,SRGBColorSpace$2),me[tt]=Ie.r,me[tt+1]=Ie.g,me[tt+2]=Ie.b)}}return Re.setAttribute("position",new BufferAttribute(we,3)),Re.setAttribute("normal",new BufferAttribute(Pe,3)),ge&&(Re.setAttribute("color",new BufferAttribute(me,3)),Re.hasColors=!0,Re.alpha=_e),Re}function ie(le){const ce=new BufferGeometry,fe=/solid([\s\S]*?)endsolid/g,de=/facet([\s\S]*?)endfacet/g,pe=/solid\s(.+)/;let he=0;const ge=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,me=new RegExp("vertex"+ge+ge+ge,"g"),Ae=new RegExp("normal"+ge+ge+ge,"g"),ye=[],ve=[],_e=[],Te=new Vector3;let be,Re=0,we=0,Pe=0;for(;(be=fe.exec(le))!==null;){we=Pe;const Ie=be[0],$e=(be=pe.exec(Ie))!==null?be[1]:"";for(_e.push($e);(be=de.exec(Ie))!==null;){let Ge=0,He=0;const ze=be[0];for(;(be=Ae.exec(ze))!==null;)Te.x=parseFloat(be[1]),Te.y=parseFloat(be[2]),Te.z=parseFloat(be[3]),He++;for(;(be=me.exec(ze))!==null;)ye.push(parseFloat(be[1]),parseFloat(be[2]),parseFloat(be[3])),ve.push(Te.x,Te.y,Te.z),Ge++,Pe++;He!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+he),Ge!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+he),he++}const Ue=we,ke=Pe-we;ce.userData.groupNames=_e,ce.addGroup(Ue,ke,Re),Re++}return ce.setAttribute("position",new Float32BufferAttribute(ye,3)),ce.setAttribute("normal",new Float32BufferAttribute(ve,3)),ce}function oe(le){return typeof le!="string"?new TextDecoder().decode(le):le}function se(le){if(typeof le=="string"){const ce=new Uint8Array(le.length);for(let fe=0;fe<le.length;fe++)ce[fe]=le.charCodeAt(fe)&255;return ce.buffer||ce}else return le}const ae=se(_);return Z(ae)?ne(ae):ie(oe(_))}}class TGALoader extends DataTextureLoader{constructor(_){super(_)}parse(_){function Z(ze){switch(ze.image_type){case de:case ge:if(ze.colormap_length>256||ze.colormap_size!==24||ze.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case pe:case he:case me:case Ae:if(ze.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case fe:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+ze.image_type)}if(ze.width<=0||ze.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(ze.pixel_size!==8&&ze.pixel_size!==16&&ze.pixel_size!==24&&ze.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+ze.pixel_size)}function te(ze,Ke,tt,Je,ot){let Fe,ct;const ht=tt.pixel_size>>3,lt=tt.width*tt.height*ht;if(Ke&&(ct=ot.subarray(Je,Je+=tt.colormap_length*(tt.colormap_size>>3))),ze){Fe=new Uint8Array(lt);let Qe,Ze,it,nt=0;const Tt=new Uint8Array(ht);for(;nt<lt;)if(Qe=ot[Je++],Ze=(Qe&127)+1,Qe&128){for(it=0;it<ht;++it)Tt[it]=ot[Je++];for(it=0;it<Ze;++it)Fe.set(Tt,nt+it*ht);nt+=ht*Ze}else{for(Ze*=ht,it=0;it<Ze;++it)Fe[nt+it]=ot[Je++];nt+=Ze}}else Fe=ot.subarray(Je,Je+=Ke?tt.width*tt.height:lt);return{pixel_data:Fe,palettes:ct}}function ne(ze,Ke,tt,Je,ot,Fe,ct,ht,lt){const Qe=lt;let Ze,it=0,nt,Tt;const St=Ie.width;for(Tt=Ke;Tt!==Je;Tt+=tt)for(nt=ot;nt!==ct;nt+=Fe,it++)Ze=ht[it],ze[(nt+St*Tt)*4+3]=255,ze[(nt+St*Tt)*4+2]=Qe[Ze*3+0],ze[(nt+St*Tt)*4+1]=Qe[Ze*3+1],ze[(nt+St*Tt)*4+0]=Qe[Ze*3+2];return ze}function ie(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt,Qe=0,Ze,it;const nt=Ie.width;for(it=Ke;it!==Je;it+=tt)for(Ze=ot;Ze!==ct;Ze+=Fe,Qe+=2)lt=ht[Qe+0]+(ht[Qe+1]<<8),ze[(Ze+nt*it)*4+0]=(lt&31744)>>7,ze[(Ze+nt*it)*4+1]=(lt&992)>>2,ze[(Ze+nt*it)*4+2]=(lt&31)<<3,ze[(Ze+nt*it)*4+3]=lt&32768?0:255;return ze}function oe(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt=0,Qe,Ze;const it=Ie.width;for(Ze=Ke;Ze!==Je;Ze+=tt)for(Qe=ot;Qe!==ct;Qe+=Fe,lt+=3)ze[(Qe+it*Ze)*4+3]=255,ze[(Qe+it*Ze)*4+2]=ht[lt+0],ze[(Qe+it*Ze)*4+1]=ht[lt+1],ze[(Qe+it*Ze)*4+0]=ht[lt+2];return ze}function se(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt=0,Qe,Ze;const it=Ie.width;for(Ze=Ke;Ze!==Je;Ze+=tt)for(Qe=ot;Qe!==ct;Qe+=Fe,lt+=4)ze[(Qe+it*Ze)*4+2]=ht[lt+0],ze[(Qe+it*Ze)*4+1]=ht[lt+1],ze[(Qe+it*Ze)*4+0]=ht[lt+2],ze[(Qe+it*Ze)*4+3]=ht[lt+3];return ze}function ae(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt,Qe=0,Ze,it;const nt=Ie.width;for(it=Ke;it!==Je;it+=tt)for(Ze=ot;Ze!==ct;Ze+=Fe,Qe++)lt=ht[Qe],ze[(Ze+nt*it)*4+0]=lt,ze[(Ze+nt*it)*4+1]=lt,ze[(Ze+nt*it)*4+2]=lt,ze[(Ze+nt*it)*4+3]=255;return ze}function le(ze,Ke,tt,Je,ot,Fe,ct,ht){let lt=0,Qe,Ze;const it=Ie.width;for(Ze=Ke;Ze!==Je;Ze+=tt)for(Qe=ot;Qe!==ct;Qe+=Fe,lt+=2)ze[(Qe+it*Ze)*4+0]=ht[lt+0],ze[(Qe+it*Ze)*4+1]=ht[lt+0],ze[(Qe+it*Ze)*4+2]=ht[lt+0],ze[(Qe+it*Ze)*4+3]=ht[lt+1];return ze}function ce(ze,Ke,tt,Je,ot){let Fe,ct,ht,lt,Qe,Ze;switch((Ie.flags&ye)>>ve){default:case be:Fe=0,ht=1,Qe=Ke,ct=0,lt=1,Ze=tt;break;case _e:Fe=0,ht=1,Qe=Ke,ct=tt-1,lt=-1,Ze=-1;break;case Re:Fe=Ke-1,ht=-1,Qe=-1,ct=0,lt=1,Ze=tt;break;case Te:Fe=Ke-1,ht=-1,Qe=-1,ct=tt-1,lt=-1,Ze=-1;break}if(ke)switch(Ie.pixel_size){case 8:ae(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;case 16:le(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(Ie.pixel_size){case 8:ne(ze,ct,lt,Ze,Fe,ht,Qe,Je,ot);break;case 16:ie(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;case 24:oe(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;case 32:se(ze,ct,lt,Ze,Fe,ht,Qe,Je);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return ze}const fe=0,de=1,pe=2,he=3,ge=9,me=10,Ae=11,ye=48,ve=4,_e=0,Te=1,be=2,Re=3;if(_.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let we=0;const Pe=new Uint8Array(_),Ie={id_length:Pe[we++],colormap_type:Pe[we++],image_type:Pe[we++],colormap_index:Pe[we++]|Pe[we++]<<8,colormap_length:Pe[we++]|Pe[we++]<<8,colormap_size:Pe[we++],origin:[Pe[we++]|Pe[we++]<<8,Pe[we++]|Pe[we++]<<8],width:Pe[we++]|Pe[we++]<<8,height:Pe[we++]|Pe[we++]<<8,pixel_size:Pe[we++],flags:Pe[we++]};if(Z(Ie),Ie.id_length+we>_.length)throw new Error("THREE.TGALoader: No data.");we+=Ie.id_length;let $e=!1,Ue=!1,ke=!1;switch(Ie.image_type){case ge:$e=!0,Ue=!0;break;case de:Ue=!0;break;case me:$e=!0;break;case pe:break;case Ae:$e=!0,ke=!0;break;case he:ke=!0;break}const Ge=new Uint8Array(Ie.width*Ie.height*4),He=te($e,Ue,Ie,we,Pe);return ce(Ge,Ie.width,Ie.height,He.pixel_data,He.palettes),{data:Ge,width:Ie.width,height:Ie.height,flipY:!0,generateMipmaps:!0,minFilter:LinearMipmapLinearFilter}}}class ColladaLoader extends Loader{load(_,Z,te,ne){const ie=this,oe=ie.path===""?LoaderUtils.extractUrlBase(_):ie.path,se=new FileLoader(ie.manager);se.setPath(ie.path),se.setRequestHeader(ie.requestHeader),se.setWithCredentials(ie.withCredentials),se.load(_,function(ae){try{Z(ie.parse(ae,oe))}catch(le){ne?ne(le):console.error(le),ie.manager.itemError(_)}},te,ne)}parse(_,Z){function te(Ve,We){const Ye=[],qe=Ve.childNodes;for(let dt=0,Ft=qe.length;dt<Ft;dt++){const Xt=qe[dt];Xt.nodeName===We&&Ye.push(Xt)}return Ye}function ne(Ve){if(Ve.length===0)return[];const We=Ve.trim().split(/\s+/),Ye=new Array(We.length);for(let qe=0,dt=We.length;qe<dt;qe++)Ye[qe]=We[qe];return Ye}function ie(Ve){if(Ve.length===0)return[];const We=Ve.trim().split(/\s+/),Ye=new Array(We.length);for(let qe=0,dt=We.length;qe<dt;qe++)Ye[qe]=parseFloat(We[qe]);return Ye}function oe(Ve){if(Ve.length===0)return[];const We=Ve.trim().split(/\s+/),Ye=new Array(We.length);for(let qe=0,dt=We.length;qe<dt;qe++)Ye[qe]=parseInt(We[qe]);return Ye}function se(Ve){return Ve.substring(1)}function ae(){return"three_default_"+Hn++}function le(Ve){return Object.keys(Ve).length===0}function ce(Ve){return{unit:fe(te(Ve,"unit")[0]),upAxis:de(te(Ve,"up_axis")[0])}}function fe(Ve){return Ve!==void 0&&Ve.hasAttribute("meter")===!0?parseFloat(Ve.getAttribute("meter")):1}function de(Ve){return Ve!==void 0?Ve.textContent:"Y_UP"}function pe(Ve,We,Ye,qe){const dt=te(Ve,We)[0];if(dt!==void 0){const Ft=te(dt,Ye);for(let Xt=0;Xt<Ft.length;Xt++)qe(Ft[Xt])}}function he(Ve,We){for(const Ye in Ve){const qe=Ve[Ye];qe.build=We(Ve[Ye])}}function ge(Ve,We){return Ve.build!==void 0||(Ve.build=We(Ve)),Ve.build}function me(Ve){const We={sources:{},samplers:{},channels:{}};let Ye=!1;for(let qe=0,dt=Ve.childNodes.length;qe<dt;qe++){const Ft=Ve.childNodes[qe];if(Ft.nodeType!==1)continue;let Xt;switch(Ft.nodeName){case"source":Xt=Ft.getAttribute("id"),We.sources[Xt]=Yt(Ft);break;case"sampler":Xt=Ft.getAttribute("id"),We.samplers[Xt]=Ae(Ft);break;case"channel":Xt=Ft.getAttribute("target"),We.channels[Xt]=ye(Ft);break;case"animation":me(Ft),Ye=!0;break;default:console.log(Ft)}}Ye===!1&&(qn.animations[Ve.getAttribute("id")||MathUtils.generateUUID()]=We)}function Ae(Ve){const We={inputs:{}};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"input":const Ft=se(dt.getAttribute("source")),Xt=dt.getAttribute("semantic");We.inputs[Xt]=Ft;break}}return We}function ye(Ve){const We={};let Ye=Ve.getAttribute("target").split("/");const qe=Ye.shift();let dt=Ye.shift();const Ft=dt.indexOf("(")!==-1,Xt=dt.indexOf(".")!==-1;if(Xt)Ye=dt.split("."),dt=Ye.shift(),We.member=Ye.shift();else if(Ft){const an=dt.split("(");dt=an.shift();for(let Kt=0;Kt<an.length;Kt++)an[Kt]=parseInt(an[Kt].replace(/\)/,""));We.indices=an}return We.id=qe,We.sid=dt,We.arraySyntax=Ft,We.memberSyntax=Xt,We.sampler=se(Ve.getAttribute("source")),We}function ve(Ve){const We=[],Ye=Ve.channels,qe=Ve.samplers,dt=Ve.sources;for(const Ft in Ye)if(Ye.hasOwnProperty(Ft)){const Xt=Ye[Ft],an=qe[Xt.sampler],Kt=an.inputs.INPUT,on=an.inputs.OUTPUT,sn=dt[Kt],nn=dt[on],mn=Te(Xt,sn,nn);Ie(mn,We)}return We}function _e(Ve){return ge(qn.animations[Ve],ve)}function Te(Ve,We,Ye){const qe=qn.nodes[Ve.id],dt=wn(qe.id),Ft=qe.transforms[Ve.sid],Xt=qe.matrix.clone().transpose();let an,Kt,on,sn,nn,mn;const yn={};switch(Ft){case"matrix":for(on=0,sn=We.array.length;on<sn;on++)if(an=We.array[on],Kt=on*Ye.stride,yn[an]===void 0&&(yn[an]={}),Ve.arraySyntax===!0){const Mn=Ye.array[Kt],Yn=Ve.indices[0]+4*Ve.indices[1];yn[an][Yn]=Mn}else for(nn=0,mn=Ye.stride;nn<mn;nn++)yn[an][nn]=Ye.array[Kt+nn];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Ft);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Ft);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Ft);break}const vn=be(yn,Xt);return{name:dt.uuid,keyframes:vn}}function be(Ve,We){const Ye=[];for(const dt in Ve)Ye.push({time:parseFloat(dt),value:Ve[dt]});Ye.sort(qe);for(let dt=0;dt<16;dt++)$e(Ye,dt,We.elements[dt]);return Ye;function qe(dt,Ft){return dt.time-Ft.time}}const Re=new Vector3,we=new Vector3,Pe=new Quaternion;function Ie(Ve,We){const Ye=Ve.keyframes,qe=Ve.name,dt=[],Ft=[],Xt=[],an=[];for(let Kt=0,on=Ye.length;Kt<on;Kt++){const sn=Ye[Kt],nn=sn.time,mn=sn.value;Dt.fromArray(mn).transpose(),Dt.decompose(Re,Pe,we),dt.push(nn),Ft.push(Re.x,Re.y,Re.z),Xt.push(Pe.x,Pe.y,Pe.z,Pe.w),an.push(we.x,we.y,we.z)}return Ft.length>0&&We.push(new VectorKeyframeTrack(qe+".position",dt,Ft)),Xt.length>0&&We.push(new QuaternionKeyframeTrack(qe+".quaternion",dt,Xt)),an.length>0&&We.push(new VectorKeyframeTrack(qe+".scale",dt,an)),We}function $e(Ve,We,Ye){let qe,dt=!0,Ft,Xt;for(Ft=0,Xt=Ve.length;Ft<Xt;Ft++)qe=Ve[Ft],qe.value[We]===void 0?qe.value[We]=null:dt=!1;if(dt===!0)for(Ft=0,Xt=Ve.length;Ft<Xt;Ft++)qe=Ve[Ft],qe.value[We]=Ye;else Ue(Ve,We)}function Ue(Ve,We){let Ye,qe;for(let dt=0,Ft=Ve.length;dt<Ft;dt++){const Xt=Ve[dt];if(Xt.value[We]===null){if(Ye=ke(Ve,dt,We),qe=Ge(Ve,dt,We),Ye===null){Xt.value[We]=qe.value[We];continue}if(qe===null){Xt.value[We]=Ye.value[We];continue}He(Xt,Ye,qe,We)}}}function ke(Ve,We,Ye){for(;We>=0;){const qe=Ve[We];if(qe.value[Ye]!==null)return qe;We--}return null}function Ge(Ve,We,Ye){for(;We<Ve.length;){const qe=Ve[We];if(qe.value[Ye]!==null)return qe;We++}return null}function He(Ve,We,Ye,qe){if(Ye.time-We.time===0){Ve.value[qe]=We.value[qe];return}Ve.value[qe]=(Ve.time-We.time)*(Ye.value[qe]-We.value[qe])/(Ye.time-We.time)+We.value[qe]}function ze(Ve){const We={name:Ve.getAttribute("id")||"default",start:parseFloat(Ve.getAttribute("start")||0),end:parseFloat(Ve.getAttribute("end")||0),animations:[]};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"instance_animation":We.animations.push(se(dt.getAttribute("url")));break}}qn.clips[Ve.getAttribute("id")]=We}function Ke(Ve){const We=[],Ye=Ve.name,qe=Ve.end-Ve.start||-1,dt=Ve.animations;for(let Ft=0,Xt=dt.length;Ft<Xt;Ft++){const an=_e(dt[Ft]);for(let Kt=0,on=an.length;Kt<on;Kt++)We.push(an[Kt])}return new AnimationClip(Ye,qe,We)}function tt(Ve){return ge(qn.clips[Ve],Ke)}function Je(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"skin":We.id=se(dt.getAttribute("source")),We.skin=ot(dt);break;case"morph":We.id=se(dt.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}qn.controllers[Ve.getAttribute("id")]=We}function ot(Ve){const We={sources:{}};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"bind_shape_matrix":We.bindShapeMatrix=ie(dt.textContent);break;case"source":const Ft=dt.getAttribute("id");We.sources[Ft]=Yt(dt);break;case"joints":We.joints=Fe(dt);break;case"vertex_weights":We.vertexWeights=ct(dt);break}}return We}function Fe(Ve){const We={inputs:{}};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"input":const Ft=dt.getAttribute("semantic"),Xt=se(dt.getAttribute("source"));We.inputs[Ft]=Xt;break}}return We}function ct(Ve){const We={inputs:{}};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"input":const Ft=dt.getAttribute("semantic"),Xt=se(dt.getAttribute("source")),an=parseInt(dt.getAttribute("offset"));We.inputs[Ft]={id:Xt,offset:an};break;case"vcount":We.vcount=oe(dt.textContent);break;case"v":We.v=oe(dt.textContent);break}}return We}function ht(Ve){const We={id:Ve.id},Ye=qn.geometries[We.id];return Ve.skin!==void 0&&(We.skin=lt(Ve.skin),Ye.sources.skinIndices=We.skin.indices,Ye.sources.skinWeights=We.skin.weights),We}function lt(Ve){const We={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},Ye=Ve.sources,qe=Ve.vertexWeights,dt=qe.vcount,Ft=qe.v,Xt=qe.inputs.JOINT.offset,an=qe.inputs.WEIGHT.offset,Kt=Ve.sources[Ve.joints.inputs.JOINT],on=Ve.sources[Ve.joints.inputs.INV_BIND_MATRIX],sn=Ye[qe.inputs.WEIGHT.id].array;let nn=0,mn,yn,vn;for(mn=0,vn=dt.length;mn<vn;mn++){const Yn=dt[mn],jn=[];for(yn=0;yn<Yn;yn++){const Wn=Ft[nn+Xt],ir=Ft[nn+an],gr=sn[ir];jn.push({index:Wn,weight:gr}),nn+=2}for(jn.sort(Mn),yn=0;yn<4;yn++){const Wn=jn[yn];Wn!==void 0?(We.indices.array.push(Wn.index),We.weights.array.push(Wn.weight)):(We.indices.array.push(0),We.weights.array.push(0))}}for(Ve.bindShapeMatrix?We.bindMatrix=new Matrix4().fromArray(Ve.bindShapeMatrix).transpose():We.bindMatrix=new Matrix4().identity(),mn=0,vn=Kt.array.length;mn<vn;mn++){const Yn=Kt.array[mn],jn=new Matrix4().fromArray(on.array,mn*on.stride).transpose();We.joints.push({name:Yn,boneInverse:jn})}return We;function Mn(Yn,jn){return jn.weight-Yn.weight}}function Qe(Ve){return ge(qn.controllers[Ve],ht)}function Ze(Ve){const We={init_from:te(Ve,"init_from")[0].textContent};qn.images[Ve.getAttribute("id")]=We}function it(Ve){return Ve.build!==void 0?Ve.build:Ve.init_from}function nt(Ve){const We=qn.images[Ve];return We!==void 0?ge(We,it):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",Ve),null)}function Tt(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"profile_COMMON":We.profile=St(dt);break}}qn.effects[Ve.getAttribute("id")]=We}function St(Ve){const We={surfaces:{},samplers:{}};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"newparam":Et(dt,We);break;case"technique":We.technique=yt(dt);break;case"extra":We.extra=pt(dt);break}}return We}function Et(Ve,We){const Ye=Ve.getAttribute("sid");for(let qe=0,dt=Ve.childNodes.length;qe<dt;qe++){const Ft=Ve.childNodes[qe];if(Ft.nodeType===1)switch(Ft.nodeName){case"surface":We.surfaces[Ye]=Nt(Ft);break;case"sampler2D":We.samplers[Ye]=zt(Ft);break}}}function Nt(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"init_from":We.init_from=dt.textContent;break}}return We}function zt(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"source":We.source=dt.textContent;break}}return We}function yt(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"constant":case"lambert":case"blinn":case"phong":We.type=dt.nodeName,We.parameters=Ut(dt);break;case"extra":We.extra=pt(dt);break}}return We}function Ut(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":We[dt.nodeName]=bt(dt);break;case"transparent":We[dt.nodeName]={opaque:dt.hasAttribute("opaque")?dt.getAttribute("opaque"):"A_ONE",data:bt(dt)};break}}return We}function bt(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"color":We[dt.nodeName]=ie(dt.textContent);break;case"float":We[dt.nodeName]=parseFloat(dt.textContent);break;case"texture":We[dt.nodeName]={id:dt.getAttribute("texture"),extra:Ot(dt)};break}}return We}function Ot(Ve){const We={technique:{}};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"extra":Mt(dt,We);break}}return We}function Mt(Ve,We){for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"technique":_t(dt,We);break}}}function _t(Ve,We){for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":We.technique[dt.nodeName]=parseFloat(dt.textContent);break;case"wrapU":case"wrapV":dt.textContent.toUpperCase()==="TRUE"?We.technique[dt.nodeName]=1:dt.textContent.toUpperCase()==="FALSE"?We.technique[dt.nodeName]=0:We.technique[dt.nodeName]=parseInt(dt.textContent);break;case"bump":We[dt.nodeName]=st(dt);break}}}function pt(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"technique":We.technique=ft(dt);break}}return We}function ft(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"double_sided":We[dt.nodeName]=parseInt(dt.textContent);break;case"bump":We[dt.nodeName]=st(dt);break}}return We}function st(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"texture":We[dt.nodeName]={id:dt.getAttribute("texture"),texcoord:dt.getAttribute("texcoord"),extra:Ot(dt)};break}}return We}function vt(Ve){return Ve}function Pt(Ve){return ge(qn.effects[Ve],vt)}function Lt(Ve){const We={name:Ve.getAttribute("name")};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"instance_effect":We.url=se(dt.getAttribute("url"));break}}qn.materials[Ve.getAttribute("id")]=We}function Vt(Ve){let We,Ye=Ve.slice((Ve.lastIndexOf(".")-1>>>0)+2);switch(Ye=Ye.toLowerCase(),Ye){case"tga":We=fr;break;default:We=sr}return We}function Le(Ve){const We=Pt(Ve.url),Ye=We.profile.technique;let qe;switch(Ye.type){case"phong":case"blinn":qe=new MeshPhongMaterial;break;case"lambert":qe=new MeshLambertMaterial;break;default:qe=new MeshBasicMaterial;break}qe.name=Ve.name||"";function dt(Kt,on=null){const sn=We.profile.samplers[Kt.id];let nn=null;if(sn!==void 0){const mn=We.profile.surfaces[sn.source];nn=nt(mn.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),nn=nt(Kt.id);if(nn!==null){const mn=Vt(nn);if(mn!==void 0){const yn=mn.load(nn),vn=Kt.extra;if(vn!==void 0&&vn.technique!==void 0&&le(vn.technique)===!1){const Mn=vn.technique;yn.wrapS=Mn.wrapU?RepeatWrapping:ClampToEdgeWrapping,yn.wrapT=Mn.wrapV?RepeatWrapping:ClampToEdgeWrapping,yn.offset.set(Mn.offsetU||0,Mn.offsetV||0),yn.repeat.set(Mn.repeatU||1,Mn.repeatV||1)}else yn.wrapS=RepeatWrapping,yn.wrapT=RepeatWrapping;return on!==null&&(yn.colorSpace=on),yn}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",nn),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",Kt.id),null}const Ft=Ye.parameters;for(const Kt in Ft){const on=Ft[Kt];switch(Kt){case"diffuse":on.color&&qe.color.fromArray(on.color),on.texture&&(qe.map=dt(on.texture,SRGBColorSpace$2));break;case"specular":on.color&&qe.specular&&qe.specular.fromArray(on.color),on.texture&&(qe.specularMap=dt(on.texture));break;case"bump":on.texture&&(qe.normalMap=dt(on.texture));break;case"ambient":on.texture&&(qe.lightMap=dt(on.texture,SRGBColorSpace$2));break;case"shininess":on.float&&qe.shininess&&(qe.shininess=on.float);break;case"emission":on.color&&qe.emissive&&qe.emissive.fromArray(on.color),on.texture&&(qe.emissiveMap=dt(on.texture,SRGBColorSpace$2));break}}ColorManagement.toWorkingColorSpace(qe.color,SRGBColorSpace$2),qe.specular&&ColorManagement.toWorkingColorSpace(qe.specular,SRGBColorSpace$2),qe.emissive&&ColorManagement.toWorkingColorSpace(qe.emissive,SRGBColorSpace$2);let Xt=Ft.transparent,an=Ft.transparency;if(an===void 0&&Xt&&(an={float:1}),Xt===void 0&&an&&(Xt={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Xt&&an)if(Xt.data.texture)qe.transparent=!0;else{const Kt=Xt.data.color;switch(Xt.opaque){case"A_ONE":qe.opacity=Kt[3]*an.float;break;case"RGB_ZERO":qe.opacity=1-Kt[0]*an.float;break;case"A_ZERO":qe.opacity=1-Kt[3]*an.float;break;case"RGB_ONE":qe.opacity=Kt[0]*an.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Xt.opaque)}qe.opacity<1&&(qe.transparent=!0)}if(Ye.extra!==void 0&&Ye.extra.technique!==void 0){const Kt=Ye.extra.technique;for(const on in Kt){const sn=Kt[on];switch(on){case"double_sided":qe.side=sn===1?DoubleSide:FrontSide;break;case"bump":qe.normalMap=dt(sn.texture),qe.normalScale=new Vector2(1,1);break}}}return qe}function De(Ve){return ge(qn.materials[Ve],Le)}function Be(Ve){const We={name:Ve.getAttribute("name")};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"optics":We.optics=rt(dt);break}}qn.cameras[Ve.getAttribute("id")]=We}function rt(Ve){for(let We=0;We<Ve.childNodes.length;We++){const Ye=Ve.childNodes[We];switch(Ye.nodeName){case"technique_common":return at(Ye)}}return{}}function at(Ve){const We={};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];switch(qe.nodeName){case"perspective":case"orthographic":We.technique=qe.nodeName,We.parameters=xt(qe);break}}return We}function xt(Ve){const We={};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];switch(qe.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":We[qe.nodeName]=parseFloat(qe.textContent);break}}return We}function Ct(Ve){let We;switch(Ve.optics.technique){case"perspective":We=new PerspectiveCamera$2(Ve.optics.parameters.yfov,Ve.optics.parameters.aspect_ratio,Ve.optics.parameters.znear,Ve.optics.parameters.zfar);break;case"orthographic":let Ye=Ve.optics.parameters.ymag,qe=Ve.optics.parameters.xmag;const dt=Ve.optics.parameters.aspect_ratio;qe=qe===void 0?Ye*dt:qe,Ye=Ye===void 0?qe/dt:Ye,qe*=.5,Ye*=.5,We=new OrthographicCamera$1(-qe,qe,Ye,-Ye,Ve.optics.parameters.znear,Ve.optics.parameters.zfar);break;default:We=new PerspectiveCamera$2;break}return We.name=Ve.name||"",We}function Qt(Ve){const We=qn.cameras[Ve];return We!==void 0?ge(We,Ct):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",Ve),null)}function qt(Ve){let We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"technique_common":We=It(dt);break}}qn.lights[Ve.getAttribute("id")]=We}function It(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"directional":case"point":case"spot":case"ambient":We.technique=dt.nodeName,We.parameters=Gt(dt)}}return We}function Gt(Ve){const We={};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"color":const Ft=ie(dt.textContent);We.color=new Color$1().fromArray(Ft),ColorManagement.toWorkingColorSpace(We.color,SRGBColorSpace$2);break;case"falloff_angle":We.falloffAngle=parseFloat(dt.textContent);break;case"quadratic_attenuation":const Xt=parseFloat(dt.textContent);We.distance=Xt?Math.sqrt(1/Xt):0;break}}return We}function Jt(Ve){let We;switch(Ve.technique){case"directional":We=new DirectionalLight$1;break;case"point":We=new PointLight$1;break;case"spot":We=new SpotLight$2;break;case"ambient":We=new AmbientLight$1;break}return Ve.parameters.color&&We.color.copy(Ve.parameters.color),Ve.parameters.distance&&(We.distance=Ve.parameters.distance),We}function kt(Ve){const We=qn.lights[Ve];return We!==void 0?ge(We,Jt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",Ve),null)}function Ht(Ve){const We={name:Ve.getAttribute("name"),sources:{},vertices:{},primitives:[]},Ye=te(Ve,"mesh")[0];if(Ye!==void 0){for(let qe=0;qe<Ye.childNodes.length;qe++){const dt=Ye.childNodes[qe];if(dt.nodeType!==1)continue;const Ft=dt.getAttribute("id");switch(dt.nodeName){case"source":We.sources[Ft]=Yt(dt);break;case"vertices":We.vertices=hn(dt);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",dt.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":We.primitives.push(_n(dt));break;default:console.log(dt)}}qn.geometries[Ve.getAttribute("id")]=We}}function Yt(Ve){const We={array:[],stride:3};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"float_array":We.array=ie(qe.textContent);break;case"Name_array":We.array=ne(qe.textContent);break;case"technique_common":const dt=te(qe,"accessor")[0];dt!==void 0&&(We.stride=parseInt(dt.getAttribute("stride")));break}}return We}function hn(Ve){const We={};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];qe.nodeType===1&&(We[qe.getAttribute("semantic")]=se(qe.getAttribute("source")))}return We}function _n(Ve){const We={type:Ve.nodeName,material:Ve.getAttribute("material"),count:parseInt(Ve.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let Ye=0,qe=Ve.childNodes.length;Ye<qe;Ye++){const dt=Ve.childNodes[Ye];if(dt.nodeType===1)switch(dt.nodeName){case"input":const Ft=se(dt.getAttribute("source")),Xt=dt.getAttribute("semantic"),an=parseInt(dt.getAttribute("offset")),Kt=parseInt(dt.getAttribute("set")),on=Kt>0?Xt+Kt:Xt;We.inputs[on]={id:Ft,offset:an},We.stride=Math.max(We.stride,an+1),Xt==="TEXCOORD"&&(We.hasUV=!0);break;case"vcount":We.vcount=oe(dt.textContent);break;case"p":We.p=oe(dt.textContent);break}}return We}function xn(Ve){const We={};for(let Ye=0;Ye<Ve.length;Ye++){const qe=Ve[Ye];We[qe.type]===void 0&&(We[qe.type]=[]),We[qe.type].push(qe)}return We}function Ln(Ve){let We=0;for(let Ye=0,qe=Ve.length;Ye<qe;Ye++)Ve[Ye].hasUV===!0&&We++;We>0&&We<Ve.length&&(Ve.uvsNeedsFix=!0)}function Vn(Ve){const We={},Ye=Ve.sources,qe=Ve.vertices,dt=Ve.primitives;if(dt.length===0)return{};const Ft=xn(dt);for(const Xt in Ft){const an=Ft[Xt];Ln(an),We[Xt]=kn(an,Ye,qe)}return We}function kn(Ve,We,Ye){const qe={},dt={array:[],stride:0},Ft={array:[],stride:0},Xt={array:[],stride:0},an={array:[],stride:0},Kt={array:[],stride:0},on={array:[],stride:4},sn={array:[],stride:4},nn=new BufferGeometry,mn=[];let yn=0;for(let vn=0;vn<Ve.length;vn++){const Mn=Ve[vn],Yn=Mn.inputs;let jn=0;switch(Mn.type){case"lines":case"linestrips":jn=Mn.count*2;break;case"triangles":jn=Mn.count*3;break;case"polylist":for(let Wn=0;Wn<Mn.count;Wn++){const ir=Mn.vcount[Wn];switch(ir){case 3:jn+=3;break;case 4:jn+=6;break;default:jn+=(ir-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknown primitive type:",Mn.type)}nn.addGroup(yn,jn,vn),yn+=jn,Mn.material&&mn.push(Mn.material);for(const Wn in Yn){const ir=Yn[Wn];switch(Wn){case"VERTEX":for(const gr in Ye){const wr=Ye[gr];switch(gr){case"POSITION":const ei=dt.array.length;if(Rn(Mn,We[wr],ir.offset,dt.array),dt.stride=We[wr].stride,We.skinWeights&&We.skinIndices&&(Rn(Mn,We.skinIndices,ir.offset,on.array),Rn(Mn,We.skinWeights,ir.offset,sn.array)),Mn.hasUV===!1&&Ve.uvsNeedsFix===!0){const Or=(dt.array.length-ei)/dt.stride;for(let kr=0;kr<Or;kr++)Xt.array.push(0,0)}break;case"NORMAL":Rn(Mn,We[wr],ir.offset,Ft.array),Ft.stride=We[wr].stride;break;case"COLOR":Rn(Mn,We[wr],ir.offset,Kt.array),Kt.stride=We[wr].stride;break;case"TEXCOORD":Rn(Mn,We[wr],ir.offset,Xt.array),Xt.stride=We[wr].stride;break;case"TEXCOORD1":Rn(Mn,We[wr],ir.offset,an.array),Xt.stride=We[wr].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',gr)}}break;case"NORMAL":Rn(Mn,We[ir.id],ir.offset,Ft.array),Ft.stride=We[ir.id].stride;break;case"COLOR":Rn(Mn,We[ir.id],ir.offset,Kt.array,!0),Kt.stride=We[ir.id].stride;break;case"TEXCOORD":Rn(Mn,We[ir.id],ir.offset,Xt.array),Xt.stride=We[ir.id].stride;break;case"TEXCOORD1":Rn(Mn,We[ir.id],ir.offset,an.array),an.stride=We[ir.id].stride;break}}}return dt.array.length>0&&nn.setAttribute("position",new Float32BufferAttribute(dt.array,dt.stride)),Ft.array.length>0&&nn.setAttribute("normal",new Float32BufferAttribute(Ft.array,Ft.stride)),Kt.array.length>0&&nn.setAttribute("color",new Float32BufferAttribute(Kt.array,Kt.stride)),Xt.array.length>0&&nn.setAttribute("uv",new Float32BufferAttribute(Xt.array,Xt.stride)),an.array.length>0&&nn.setAttribute("uv1",new Float32BufferAttribute(an.array,an.stride)),on.array.length>0&&nn.setAttribute("skinIndex",new Float32BufferAttribute(on.array,on.stride)),sn.array.length>0&&nn.setAttribute("skinWeight",new Float32BufferAttribute(sn.array,sn.stride)),qe.data=nn,qe.type=Ve[0].type,qe.materialKeys=mn,qe}function Rn(Ve,We,Ye,qe,dt=!1){const Ft=Ve.p,Xt=Ve.stride,an=Ve.vcount;function Kt(nn){let mn=Ft[nn+Ye]*sn;const yn=mn+sn;for(;mn<yn;mn++)qe.push(on[mn]);if(dt){const vn=qe.length-sn-1;hr.setRGB(qe[vn+0],qe[vn+1],qe[vn+2],SRGBColorSpace$2),qe[vn+0]=hr.r,qe[vn+1]=hr.g,qe[vn+2]=hr.b}}const on=We.array,sn=We.stride;if(Ve.vcount!==void 0){let nn=0;for(let mn=0,yn=an.length;mn<yn;mn++){const vn=an[mn];if(vn===4){const Mn=nn+Xt*0,Yn=nn+Xt*1,jn=nn+Xt*2,Wn=nn+Xt*3;Kt(Mn),Kt(Yn),Kt(Wn),Kt(Yn),Kt(jn),Kt(Wn)}else if(vn===3){const Mn=nn+Xt*0,Yn=nn+Xt*1,jn=nn+Xt*2;Kt(Mn),Kt(Yn),Kt(jn)}else if(vn>4)for(let Mn=1,Yn=vn-2;Mn<=Yn;Mn++){const jn=nn+Xt*0,Wn=nn+Xt*Mn,ir=nn+Xt*(Mn+1);Kt(jn),Kt(Wn),Kt(ir)}nn+=Xt*vn}}else for(let nn=0,mn=Ft.length;nn<mn;nn+=Xt)Kt(nn)}function or(Ve){return ge(qn.geometries[Ve],Vn)}function pr(Ve){const We={name:Ve.getAttribute("name")||"",joints:{},links:[]};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"technique_common":Sr(qe,We);break}}qn.kinematicsModels[Ve.getAttribute("id")]=We}function vr(Ve){return Ve.build!==void 0?Ve.build:Ve}function Nr(Ve){return ge(qn.kinematicsModels[Ve],vr)}function Sr(Ve,We){for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"joint":We.joints[qe.getAttribute("sid")]=Pr(qe);break;case"link":We.links.push(Cr(qe));break}}}function Pr(Ve){let We;for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"prismatic":case"revolute":We=Dr(qe);break}}return We}function Dr(Ve){const We={sid:Ve.getAttribute("sid"),name:Ve.getAttribute("name")||"",axis:new Vector3,limits:{min:0,max:0},type:Ve.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"axis":const dt=ie(qe.textContent);We.axis.fromArray(dt);break;case"limits":const Ft=qe.getElementsByTagName("max")[0],Xt=qe.getElementsByTagName("min")[0];We.limits.max=parseFloat(Ft.textContent),We.limits.min=parseFloat(Xt.textContent);break}}return We.limits.min>=We.limits.max&&(We.static=!0),We.middlePosition=(We.limits.min+We.limits.max)/2,We}function Cr(Ve){const We={sid:Ve.getAttribute("sid"),name:Ve.getAttribute("name")||"",attachments:[],transforms:[]};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"attachment_full":We.attachments.push(Kn(qe));break;case"matrix":case"translate":case"rotate":We.transforms.push(Er(qe));break}}return We}function Kn(Ve){const We={joint:Ve.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"link":We.links.push(Cr(qe));break;case"matrix":case"translate":case"rotate":We.transforms.push(Er(qe));break}}return We}function Er(Ve){const We={type:Ve.nodeName},Ye=ie(Ve.textContent);switch(We.type){case"matrix":We.obj=new Matrix4,We.obj.fromArray(Ye).transpose();break;case"translate":We.obj=new Vector3,We.obj.fromArray(Ye);break;case"rotate":We.obj=new Vector3,We.obj.fromArray(Ye),We.angle=MathUtils.degToRad(Ye[3]);break}return We}function $r(Ve){const We={name:Ve.getAttribute("name")||"",rigidBodies:{}};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"rigid_body":We.rigidBodies[qe.getAttribute("name")]={},gt(qe,We.rigidBodies[qe.getAttribute("name")]);break}}qn.physicsModels[Ve.getAttribute("id")]=We}function gt(Ve,We){for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"technique_common":wt(qe,We);break}}}function wt(Ve,We){for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"inertia":We.inertia=ie(qe.textContent);break;case"mass":We.mass=ie(qe.textContent)[0];break}}}function jt(Ve){const We={bindJointAxis:[]};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"bind_joint_axis":We.bindJointAxis.push(rn(qe));break}}qn.kinematicsScenes[se(Ve.getAttribute("url"))]=We}function rn(Ve){const We={target:Ve.getAttribute("target").split("/").pop()};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType===1)switch(qe.nodeName){case"axis":const dt=qe.getElementsByTagName("param")[0];We.axis=dt.textContent;const Ft=We.axis.split("inst_").pop().split("axis")[0];We.jointIndex=Ft.substring(0,Ft.length-1);break}}return We}function un(Ve){return Ve.build!==void 0?Ve.build:Ve}function dn(Ve){return ge(qn.kinematicsScenes[Ve],un)}function Tn(){const Ve=Object.keys(qn.kinematicsModels)[0],We=Object.keys(qn.kinematicsScenes)[0],Ye=Object.keys(qn.visualScenes)[0];if(Ve===void 0||We===void 0)return;const qe=Nr(Ve),dt=dn(We),Ft=On(Ye),Xt=dt.bindJointAxis,an={};for(let sn=0,nn=Xt.length;sn<nn;sn++){const mn=Xt[sn],yn=Un.querySelector('[sid="'+mn.target+'"]');if(yn){const vn=yn.parentElement;Kt(mn.jointIndex,vn)}}function Kt(sn,nn){const mn=nn.getAttribute("name"),yn=qe.joints[sn];Ft.traverse(function(vn){vn.name===mn&&(an[sn]={object:vn,transforms:Sn(nn),joint:yn,position:yn.zeroPosition})})}const on=new Matrix4;Vr={joints:qe&&qe.joints,getJointValue:function(sn){const nn=an[sn];if(nn)return nn.position;console.warn("THREE.ColladaLoader: Joint "+sn+" doesn't exist.")},setJointValue:function(sn,nn){const mn=an[sn];if(mn){const yn=mn.joint;if(nn>yn.limits.max||nn<yn.limits.min)console.warn("THREE.ColladaLoader: Joint "+sn+" value "+nn+" outside of limits (min: "+yn.limits.min+", max: "+yn.limits.max+").");else if(yn.static)console.warn("THREE.ColladaLoader: Joint "+sn+" is static.");else{const vn=mn.object,Mn=yn.axis,Yn=mn.transforms;Dt.identity();for(let jn=0;jn<Yn.length;jn++){const Wn=Yn[jn];if(Wn.sid&&Wn.sid.indexOf(sn)!==-1)switch(yn.type){case"revolute":Dt.multiply(on.makeRotationAxis(Mn,MathUtils.degToRad(nn)));break;case"prismatic":Dt.multiply(on.makeTranslation(Mn.x*nn,Mn.y*nn,Mn.z*nn));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+yn.type);break}else switch(Wn.type){case"matrix":Dt.multiply(Wn.obj);break;case"translate":Dt.multiply(on.makeTranslation(Wn.obj.x,Wn.obj.y,Wn.obj.z));break;case"scale":Dt.scale(Wn.obj);break;case"rotate":Dt.multiply(on.makeRotationAxis(Wn.obj,Wn.angle));break}}vn.matrix.copy(Dt),vn.matrix.decompose(vn.position,vn.quaternion,vn.scale),an[sn].position=nn}}else console.log("THREE.ColladaLoader: "+sn+" does not exist.")}}}function Sn(Ve){const We=[],Ye=Un.querySelector('[id="'+Ve.id+'"]');for(let qe=0;qe<Ye.childNodes.length;qe++){const dt=Ye.childNodes[qe];if(dt.nodeType!==1)continue;let Ft,Xt;switch(dt.nodeName){case"matrix":Ft=ie(dt.textContent);const an=new Matrix4().fromArray(Ft).transpose();We.push({sid:dt.getAttribute("sid"),type:dt.nodeName,obj:an});break;case"translate":case"scale":Ft=ie(dt.textContent),Xt=new Vector3().fromArray(Ft),We.push({sid:dt.getAttribute("sid"),type:dt.nodeName,obj:Xt});break;case"rotate":Ft=ie(dt.textContent),Xt=new Vector3().fromArray(Ft);const Kt=MathUtils.degToRad(Ft[3]);We.push({sid:dt.getAttribute("sid"),type:dt.nodeName,obj:Xt,angle:Kt});break}}return We}function At(Ve){const We=Ve.getElementsByTagName("node");for(let Ye=0;Ye<We.length;Ye++){const qe=We[Ye];qe.hasAttribute("id")===!1&&qe.setAttribute("id",ae())}}const Dt=new Matrix4,$t=new Vector3;function Bt(Ve){const We={name:Ve.getAttribute("name")||"",type:Ve.getAttribute("type"),id:Ve.getAttribute("id"),sid:Ve.getAttribute("sid"),matrix:new Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];if(qe.nodeType!==1)continue;let dt;switch(qe.nodeName){case"node":We.nodes.push(qe.getAttribute("id")),Bt(qe);break;case"instance_camera":We.instanceCameras.push(se(qe.getAttribute("url")));break;case"instance_controller":We.instanceControllers.push(Wt(qe));break;case"instance_light":We.instanceLights.push(se(qe.getAttribute("url")));break;case"instance_geometry":We.instanceGeometries.push(Wt(qe));break;case"instance_node":We.instanceNodes.push(se(qe.getAttribute("url")));break;case"matrix":dt=ie(qe.textContent),We.matrix.multiply(Dt.fromArray(dt).transpose()),We.transforms[qe.getAttribute("sid")]=qe.nodeName;break;case"translate":dt=ie(qe.textContent),$t.fromArray(dt),We.matrix.multiply(Dt.makeTranslation($t.x,$t.y,$t.z)),We.transforms[qe.getAttribute("sid")]=qe.nodeName;break;case"rotate":dt=ie(qe.textContent);const Ft=MathUtils.degToRad(dt[3]);We.matrix.multiply(Dt.makeRotationAxis($t.fromArray(dt),Ft)),We.transforms[qe.getAttribute("sid")]=qe.nodeName;break;case"scale":dt=ie(qe.textContent),We.matrix.scale($t.fromArray(dt)),We.transforms[qe.getAttribute("sid")]=qe.nodeName;break;case"extra":break;default:console.log(qe)}}return Cn(We.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",We.id):qn.nodes[We.id]=We,We}function Wt(Ve){const We={id:se(Ve.getAttribute("url")),materials:{},skeletons:[]};for(let Ye=0;Ye<Ve.childNodes.length;Ye++){const qe=Ve.childNodes[Ye];switch(qe.nodeName){case"bind_material":const dt=qe.getElementsByTagName("instance_material");for(let Ft=0;Ft<dt.length;Ft++){const Xt=dt[Ft],an=Xt.getAttribute("symbol"),Kt=Xt.getAttribute("target");We.materials[an]=se(Kt)}break;case"skeleton":We.skeletons.push(se(qe.textContent));break}}return We}function tn(Ve,We){const Ye=[],qe=[];let dt,Ft,Xt;for(dt=0;dt<Ve.length;dt++){const on=Ve[dt];let sn;if(Cn(on))sn=wn(on),cn(sn,We,Ye);else if(Fn(on)){const nn=qn.visualScenes[on].children;for(let mn=0;mn<nn.length;mn++){const yn=nn[mn];if(yn.type==="JOINT"){const vn=wn(yn.id);cn(vn,We,Ye)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",on)}for(dt=0;dt<We.length;dt++)for(Ft=0;Ft<Ye.length;Ft++)if(Xt=Ye[Ft],Xt.bone.name===We[dt].name){qe[dt]=Xt,Xt.processed=!0;break}for(dt=0;dt<Ye.length;dt++)Xt=Ye[dt],Xt.processed===!1&&(qe.push(Xt),Xt.processed=!0);const an=[],Kt=[];for(dt=0;dt<qe.length;dt++)Xt=qe[dt],an.push(Xt.bone),Kt.push(Xt.boneInverse);return new Skeleton(an,Kt)}function cn(Ve,We,Ye){Ve.traverse(function(qe){if(qe.isBone===!0){let dt;for(let Ft=0;Ft<We.length;Ft++){const Xt=We[Ft];if(Xt.name===qe.name){dt=Xt.boneInverse;break}}dt===void 0&&(dt=new Matrix4),Ye.push({bone:qe,boneInverse:dt,processed:!1})}})}function An(Ve){const We=[],Ye=Ve.matrix,qe=Ve.nodes,dt=Ve.type,Ft=Ve.instanceCameras,Xt=Ve.instanceControllers,an=Ve.instanceLights,Kt=Ve.instanceGeometries,on=Ve.instanceNodes;for(let nn=0,mn=qe.length;nn<mn;nn++)We.push(wn(qe[nn]));for(let nn=0,mn=Ft.length;nn<mn;nn++){const yn=Qt(Ft[nn]);yn!==null&&We.push(yn.clone())}for(let nn=0,mn=Xt.length;nn<mn;nn++){const yn=Xt[nn],vn=Qe(yn.id),Mn=or(vn.id),Yn=In(Mn,yn.materials),jn=yn.skeletons,Wn=vn.skin.joints,ir=tn(jn,Wn);for(let gr=0,wr=Yn.length;gr<wr;gr++){const ei=Yn[gr];ei.isSkinnedMesh&&(ei.bind(ir,vn.skin.bindMatrix),ei.normalizeSkinWeights()),We.push(ei)}}for(let nn=0,mn=an.length;nn<mn;nn++){const yn=kt(an[nn]);yn!==null&&We.push(yn.clone())}for(let nn=0,mn=Kt.length;nn<mn;nn++){const yn=Kt[nn],vn=or(yn.id),Mn=In(vn,yn.materials);for(let Yn=0,jn=Mn.length;Yn<jn;Yn++)We.push(Mn[Yn])}for(let nn=0,mn=on.length;nn<mn;nn++)We.push(wn(on[nn]).clone());let sn;if(qe.length===0&&We.length===1)sn=We[0];else{sn=dt==="JOINT"?new Bone:new Group;for(let nn=0;nn<We.length;nn++)sn.add(We[nn])}return sn.name=dt==="JOINT"?Ve.sid:Ve.name,sn.matrix.copy(Ye),sn.matrix.decompose(sn.position,sn.quaternion,sn.scale),sn}const En=new MeshBasicMaterial({name:Loader.DEFAULT_MATERIAL_NAME,color:16711935});function Bn(Ve,We){const Ye=[];for(let qe=0,dt=Ve.length;qe<dt;qe++){const Ft=We[Ve[qe]];Ft===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",Ve[qe]),Ye.push(En)):Ye.push(De(Ft))}return Ye}function In(Ve,We){const Ye=[];for(const qe in Ve){const dt=Ve[qe],Ft=Bn(dt.materialKeys,We);if(Ft.length===0&&(qe==="lines"||qe==="linestrips"?Ft.push(new LineBasicMaterial):Ft.push(new MeshPhongMaterial)),qe==="lines"||qe==="linestrips")for(let on=0,sn=Ft.length;on<sn;on++){const nn=Ft[on];if(nn.isMeshPhongMaterial===!0||nn.isMeshLambertMaterial===!0){const mn=new LineBasicMaterial;mn.color.copy(nn.color),mn.opacity=nn.opacity,mn.transparent=nn.transparent,Ft[on]=mn}}const Xt=dt.data.attributes.skinIndex!==void 0,an=Ft.length===1?Ft[0]:Ft;let Kt;switch(qe){case"lines":Kt=new LineSegments(dt.data,an);break;case"linestrips":Kt=new Line$2(dt.data,an);break;case"triangles":case"polylist":Xt?Kt=new SkinnedMesh(dt.data,an):Kt=new Mesh(dt.data,an);break}Ye.push(Kt)}return Ye}function Cn(Ve){return qn.nodes[Ve]!==void 0}function wn(Ve){return ge(qn.nodes[Ve],An)}function bn(Ve){const We={name:Ve.getAttribute("name"),children:[]};At(Ve);const Ye=te(Ve,"node");for(let qe=0;qe<Ye.length;qe++)We.children.push(Bt(Ye[qe]));qn.visualScenes[Ve.getAttribute("id")]=We}function nr(Ve){const We=new Group;We.name=Ve.name;const Ye=Ve.children;for(let qe=0;qe<Ye.length;qe++){const dt=Ye[qe];We.add(wn(dt.id))}return We}function Fn(Ve){return qn.visualScenes[Ve]!==void 0}function On(Ve){return ge(qn.visualScenes[Ve],nr)}function Nn(Ve){const We=te(Ve,"instance_visual_scene")[0];return On(se(We.getAttribute("url")))}function mr(){const Ve=qn.clips;if(le(Ve)===!0){if(le(qn.animations)===!1){const We=[];for(const Ye in qn.animations){const qe=_e(Ye);for(let dt=0,Ft=qe.length;dt<Ft;dt++)We.push(qe[dt])}_r.push(new AnimationClip("default",-1,We))}}else for(const We in Ve)_r.push(tt(We))}function zn(Ve){let We="";const Ye=[Ve];for(;Ye.length;){const qe=Ye.shift();qe.nodeType===Node.TEXT_NODE?We+=qe.textContent:(We+=`
`,Ye.push(...qe.childNodes))}return We.trim()}if(_.length===0)return{scene:new Scene$1};const Zn=new DOMParser().parseFromString(_,"application/xml"),Un=te(Zn,"COLLADA")[0],er=Zn.getElementsByTagName("parsererror")[0];if(er!==void 0){const Ve=te(er,"div")[0];let We;return Ve?We=Ve.textContent:We=zn(er),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,We),null}const Jn=Un.getAttribute("version");console.debug("THREE.ColladaLoader: File version",Jn);const rr=ce(te(Un,"asset")[0]),sr=new TextureLoader(this.manager);sr.setPath(this.resourcePath||Z).setCrossOrigin(this.crossOrigin);let fr;TGALoader&&(fr=new TGALoader(this.manager),fr.setPath(this.resourcePath||Z));const hr=new Color$1,_r=[];let Vr={},Hn=0;const qn={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};pe(Un,"library_animations","animation",me),pe(Un,"library_animation_clips","animation_clip",ze),pe(Un,"library_controllers","controller",Je),pe(Un,"library_images","image",Ze),pe(Un,"library_effects","effect",Tt),pe(Un,"library_materials","material",Lt),pe(Un,"library_cameras","camera",Be),pe(Un,"library_lights","light",qt),pe(Un,"library_geometries","geometry",Ht),pe(Un,"library_nodes","node",Bt),pe(Un,"library_visual_scenes","visual_scene",bn),pe(Un,"library_kinematics_models","kinematics_model",pr),pe(Un,"library_physics_models","physics_model",$r),pe(Un,"scene","instance_kinematics_scene",jt),he(qn.animations,ve),he(qn.clips,Ke),he(qn.controllers,ht),he(qn.images,it),he(qn.effects,vt),he(qn.materials,Le),he(qn.cameras,Ct),he(qn.lights,Jt),he(qn.geometries,Vn),he(qn.visualScenes,nr),mr(),Tn();const mt=Nn(te(Un,"scene")[0]);return mt.animations=_r,rr.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),mt.rotation.set(-Math.PI/2,0,0)),mt.scale.multiplyScalar(rr.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),_r},kinematics:Vr,library:qn,scene:mt}}}const tempQuaternion=new Quaternion,tempEuler=new Euler;function processTuple(K){if(!K)return[0,0,0];const _=K.trim().split(/\s+/g).map(Number);return[_[0]||0,_[1]||0,_[2]||0]}function applyRotation(K,_,Z=!1){Z||K.rotation.set(0,0,0),tempEuler.set(_[0],_[1],_[2],"ZYX"),tempQuaternion.setFromEuler(tempEuler),tempQuaternion.multiply(K.quaternion),K.quaternion.copy(tempQuaternion)}class URDFLoader{constructor(_){ue(this,"manager"),ue(this,"loadMeshCb"),ue(this,"parseVisual"),ue(this,"parseCollision"),ue(this,"packages"),ue(this,"workingPath"),ue(this,"fetchOptions"),this.manager=_||DefaultLoadingManager,this.loadMeshCb=this.defaultMeshLoader.bind(this),this.parseVisual=!0,this.parseCollision=!1,this.packages="",this.workingPath="",this.fetchOptions={}}loadAsync(_){return new Promise((Z,te)=>{this.load(_,Z,void 0,te)})}load(_,Z,te,ne){const ie=this.manager,oe=LoaderUtils.extractUrlBase(_),se=this.manager.resolveURL(_);ie.itemStart(se),fetch(se,this.fetchOptions).then(ae=>{if(ae.ok)return te&&te(null),ae.text();throw new Error(`URDFLoader: Failed to load url '${se}' with error code ${ae.status} : ${ae.statusText}.`)}).then(ae=>{this.workingPath===""&&(this.workingPath=oe);const le=this.parse(ae);Z(le),ie.itemEnd(se)}).catch(ae=>{ne?ne(ae):console.error("URDFLoader: Error loading file.",ae),ie.itemError(se),ie.itemEnd(se)})}parse(_){const Z=this.packages,te=this.loadMeshCb,ne=this.parseVisual,ie=this.parseCollision,oe=this.workingPath,se=this.manager,ae={},le={},ce={};function fe(ye){if(!/^package:\/\//.test(ye))return oe?LoaderUtils.resolveURL(ye,oe):ye;const[ve,_e]=ye.replace(/^package:\/\//,"").split(/\/(.+)/);return typeof Z=="string"?Z.endsWith(ve)?`${Z}/${_e}`:`${Z}/${ve}/${_e}`:typeof Z=="function"?`${Z(ve)}/${_e}`:typeof Z=="object"?ve in Z?`${Z[ve]}/${_e}`:(console.error(`URDFLoader : ${ve} not found in provided package list.`),null):(console.error("URDFLoader: Invalid packages configuration."),null)}function de(ye){let ve;if(ye instanceof Document)ve=Array.from(ye.children);else if(ye instanceof Element)ve=[ye];else{const Te=new DOMParser().parseFromString(ye,"text/xml");ve=Array.from(Te.children)}const _e=ve.find(Te=>Te.nodeName==="robot");if(!_e)throw new Error("URDFLoader: No <robot> element found in URDF.");return pe(_e)}function pe(ye){const ve=Array.from(ye.children),_e=ve.filter($e=>$e.nodeName.toLowerCase()==="link"),Te=ve.filter($e=>$e.nodeName.toLowerCase()==="joint"),be=ve.filter($e=>$e.nodeName.toLowerCase()==="material"),Re=new URDFRobot;Re.robotName=ye.getAttribute("name")||"",Re.urdfRobotNode=ye,be.forEach($e=>{const Ue=$e.getAttribute("name")||"";ce[Ue]=me($e)});const we={},Pe={};_e.forEach($e=>{const Ue=$e.getAttribute("name")||"",ke=ye.querySelector(`child[link="${Ue}"]`)===null;ae[Ue]=ge($e,we,Pe,ke?Re:void 0)}),Te.forEach($e=>{const Ue=$e.getAttribute("name")||"";le[Ue]=he($e)}),Re.joints=le,Re.links=ae,Re.colliders=Pe,Re.visual=we;const Ie=Object.values(le);return Ie.forEach($e=>{if($e instanceof URDFMimicJoint){const Ue=le[$e.mimicJoint];Ue?Ue.mimicJoints.push($e):console.warn(`URDFLoader: Mimic joint '${$e.mimicJoint}' not found.`)}}),Ie.forEach($e=>{const Ue=new Set,ke=Ge=>{if(Ue.has(Ge))throw new Error("URDFLoader: Detected an infinite loop of mimic joints.");Ue.add(Ge),Ge.mimicJoints.forEach(He=>{ke(He)})};ke($e)}),Re.frames={...Pe,...we,...ae,...le},Re}function he(ye){const ve=Array.from(ye.children),_e=ye.getAttribute("type")||"";let Te;const be=ve.find(Ue=>Ue.nodeName.toLowerCase()==="mimic");if(be){const Ue=new URDFMimicJoint;Ue.mimicJoint=be.getAttribute("joint")||"",Ue.multiplier=parseFloat(be.getAttribute("multiplier")||"1.0"),Ue.offset=parseFloat(be.getAttribute("offset")||"0.0"),Te=Ue}else Te=new URDFJoint;Te.urdfNode=ye,Te.name=ye.getAttribute("name")||"",Te.urdfName=Te.name,Te.jointType=_e;let Re=null,we=null,Pe=[0,0,0],Ie=[0,0,0];ve.forEach(Ue=>{const ke=Ue.nodeName.toLowerCase();if(ke==="origin")Pe=processTuple(Ue.getAttribute("xyz")),Ie=processTuple(Ue.getAttribute("rpy"));else if(ke==="child"){const Ge=Ue.getAttribute("link")||"";we=ae[Ge]||null}else if(ke==="parent"){const Ge=Ue.getAttribute("link")||"";Re=ae[Ge]||null}else if(ke==="limit"){const Ge=Ue.getAttribute("lower"),He=Ue.getAttribute("upper");Ge!==null&&(Te.limit.lower=parseFloat(Ge)),He!==null&&(Te.limit.upper=parseFloat(He))}}),Re?Re.add(Te):console.warn(`URDFLoader: Joint '${Te.name}' has no parent.`),we?Te.add(we):console.warn(`URDFLoader: Joint '${Te.name}' has no child.`),applyRotation(Te,Ie),Te.position.set(Pe[0],Pe[1],Pe[2]);const $e=ve.find(Ue=>Ue.nodeName.toLowerCase()==="axis");if($e){const Ue=$e.getAttribute("xyz");if(Ue){const ke=processTuple(Ue);Te.axis=new Vector3(ke[0],ke[1],ke[2]),Te.axis.normalize()}}return Te}function ge(ye,ve,_e,Te){const be=Te||new URDFLink,Re=Array.from(ye.children);return be.name=ye.getAttribute("name")||"",be.urdfName=be.name,be.urdfNode=ye,ne&&Re.filter(we=>we.nodeName.toLowerCase()==="visual").forEach(we=>{const Pe=Ae(we,ce);if(be.add(Pe),we.hasAttribute("name")){const Ie=we.getAttribute("name")||"";Pe.name=Ie,Pe.urdfName=Ie,ve[Ie]=Pe}}),ie&&Re.filter(we=>we.nodeName.toLowerCase()==="collision").forEach(we=>{const Pe=Ae(we);if(be.add(Pe),we.hasAttribute("name")){const Ie=we.getAttribute("name")||"";Pe.name=Ie,Pe.urdfName=Ie,_e[Ie]=Pe}}),be}function me(ye){const ve=Array.from(ye.children),_e=new MeshPhysicalMaterial;return _e.name=ye.getAttribute("name")||"",_e.roughness=0,_e.metalness=.4,_e.ior=1.6,ve.forEach(Te=>{const be=Te.nodeName.toLowerCase();if(be==="color"){const Re=(Te.getAttribute("rgba")||"1 1 1 1").split(/\s/g).map(Number);_e.color.setRGB(Re[0],Re[1],Re[2]),_e.opacity=Re[3],_e.transparent=Re[3]<1,_e.depthWrite=!_e.transparent}else if(be==="texture"){const Re=Te.getAttribute("filename");if(Re){const we=new TextureLoader(se),Pe=fe(Re);Pe&&(_e.map=we.load(Pe),_e.map.colorSpace=SRGBColorSpace$2)}}}),_e}function Ae(ye,ve={}){const _e=ye.nodeName.toLowerCase()==="collision",Te=Array.from(ye.children);let be=null;const Re=Te.find(Pe=>Pe.nodeName.toLowerCase()==="material");if(Re){const Pe=Re.getAttribute("name")||"";Pe&&Pe in ve?be=ve[Pe]:be=me(Re)}else be=new MeshPhysicalMaterial;const we=_e?new URDFCollider:new URDFVisual;return we.urdfNode=ye,Te.forEach(Pe=>{const Ie=Pe.nodeName.toLowerCase();if(Ie==="geometry"){const $e=Pe.firstElementChild;if(!$e)return;const Ue=$e.nodeName.toLowerCase();if(Ue==="mesh"){const ke=$e.getAttribute("filename");if(!ke)return;const Ge=fe(ke);if(Ge!==null){const He=$e.getAttribute("scale");if(He){const ze=processTuple(He);we.scale.set(ze[0],ze[1],ze[2])}te(Ge,se,(ze,Ke)=>{Ke?console.error("URDFLoader: Error loading mesh.",Ke):ze&&(ze instanceof Mesh&&(ze.material=be),ze.position.set(0,0,0),ze.quaternion.identity(),we.add(ze))})}}else if(Ue==="box"){const ke=new Mesh;ke.geometry=new BoxGeometry(1,1,1),ke.material=be;const Ge=$e.getAttribute("size")||"1 1 1",He=processTuple(Ge);ke.scale.set(He[0],He[1],He[2]),we.add(ke)}else if(Ue==="sphere"){const ke=new Mesh;ke.geometry=new SphereGeometry(1,30,30),ke.material=be;const Ge=parseFloat($e.getAttribute("radius")||"1");ke.scale.set(Ge,Ge,Ge),we.add(ke)}else if(Ue==="cylinder"){const ke=new Mesh;ke.geometry=new CylinderGeometry(1,1,1,30),ke.material=be;const Ge=parseFloat($e.getAttribute("radius")||"1"),He=parseFloat($e.getAttribute("length")||"1");ke.scale.set(Ge,He,Ge),ke.rotation.set(Math.PI/2,0,0),we.add(ke)}}else if(Ie==="origin"){const $e=processTuple(Pe.getAttribute("xyz")),Ue=processTuple(Pe.getAttribute("rpy"));we.position.set($e[0],$e[1],$e[2]),we.rotation.set(0,0,0),applyRotation(we,Ue)}}),we}return de(_)}defaultMeshLoader(_,Z,te){/\.stl$/i.test(_)?new STLLoader(Z).load(_,ne=>{const ie=new Mesh(ne,new MeshPhysicalMaterial);te(ie)},void 0,ne=>{console.error("URDFLoader: STLLoader error:",ne),te(null,ne)}):/\.dae$/i.test(_)?new ColladaLoader(Z).load(_,ne=>{te(ne.scene)},void 0,ne=>{console.error("URDFLoader: ColladaLoader error:",ne),te(null,ne)}):(console.warn(`URDFLoader: Could not load model at ${_}.
No loader available`),te(null,new Error(`No loader available for ${_}`)))}}function normalizePath(K){const _=K.split("/"),Z=[];for(const te of _)te===".."?Z.pop():te!=="."&&Z.push(te);return Z.join("/")}const DEFAULT_MATERIAL_PARAMS={roughness:.01,metalness:.2,ior:1.6,reflectivity:1};function Urdf({_key:K,src:_,text:Z,buff:te,assets:ne,hide:ie,encoding:oe="ascii",jointValues:se,workingPath:ae,fetchOptions:le,parseVisual:ce,parseCollision:fe,packages:de,onLoad:pe,color:he,material:ge,materialType:me,...Ae}){const[ye,ve]=reactExports.useState(),{showError:_e,showInfo:Te}=reactExports.useContext(AppContext);ge=ge||DEFAULT_MATERIAL_PARAMS;const be=reactExports.useMemo(()=>{const we=new URDFLoader;if(!ae){const Pe=getDir(_);ae=Pe?Pe+"/":"./"}return we.workingPath=ae,le&&(we.fetchOptions=le),ce&&(we.parseVisual=ce),fe&&(we.parseCollision=fe),de&&de.length&&(we.packages=de),we.manager.setURLModifier(Pe=>{if(Pe.startsWith("blob:"))return Pe;const Ie=normalizePath(Pe),$e=join$1(ae,Ie);return(ne==null?void 0:ne[$e])||(ne==null?void 0:ne[Ie])||Ie}),we.loadMeshCb=function(Pe,Ie,$e){if(typeof Pe!="string")return;const Ue=normalizePath(Pe),ke=join$1(ae,Ue),Ge=getFileName(Ue).toLowerCase().split(".").pop(),He=(ne==null?void 0:ne[ke])||(ne==null?void 0:ne[Ue])||Ue,ze=getDir(He),Ke=ze?ze+"/":"./";console.log(ke);const tt=Je=>{_e(`Failed to load mesh: ${He}`),$e(void 0,Je)};if(Ge==="obj"){const Je=new OBJLoader(Ie);Je.setResourcePath(Ke),Je.load(He,$e,void 0,tt)}else if(Ge==="stl"){const Je=new STLLoader$1(Ie);Je.setResourcePath(Ke),Je.load(He,ot=>{const Fe=new MeshPhysicalMaterial({emissive:5526612,roughness:.01,metalness:.4,reflectivity:.5,ior:1.6}),ct=new Mesh(ot,Fe);$e(ct)},void 0,tt)}else if(Ge==="glb"){const Je=new GLTFLoader$1(Ie);Je.setResourcePath(Ke),Je.load(He,ot=>$e(ot.scene),void 0,tt)}else if(Ge==="gltf"){const Je=new GLTFLoader$1(Ie);Je.setResourcePath(Ke),Je.load(He,ot=>$e(ot.scene),void 0,tt)}else if(Ge==="pcd")new PCDLoader(Ie).load(He,$e,void 0,tt);else if(Ge==="dae"){const Je=new ColladaLoader$1(Ie);Je.setResourcePath(Ke),Je.load(He,ot=>$e(ot.scene),void 0,tt)}else Te(`Unknown mesh type: ${He}`)},we},[_,ne,ae,le,ce,fe,de]);reactExports.useEffect(()=>{!ye&&ie||(te&&(Z=new TextDecoder(oe).decode(te)),Z?ve(be.parse(Z)):_!=null&&_.length&&be.load(_,ve))},[be,_,ie]);const{sendMsg:Re}=useSocket();return reactExports.useEffect(()=>{ye&&(typeof pe=="function"?pe():Re({ts:Date.now(),etype:"LOAD",key:K,value:pe}))},[ye]),ye?jsxRuntimeExports.jsx(UrdfView,{robot:ye,jointValues:se,hide:ie,materialType:me,material:ge,...Ae}):null}function Stl({_key:K,src:_,text:Z,buff:te,hide:ne,encoding:ie="ascii",onLoad:oe,...se}){const[ae,le]=reactExports.useState();reactExports.useEffect(()=>{if(!ae&&ne)return;const fe=new STLLoader$1;if(te&&(Z=new TextDecoder(ie).decode(te)),Z){const de=fe.parse(Z);le(de)}else _&&fe.load(_,le)},[_,ne]);const{sendMsg:ce}=useSocket();return reactExports.useEffect(()=>{ae&&(typeof oe=="function"&&oe(),typeof oe=="string"&&ce({ts:Date.now(),etype:"LOAD",key:K,value:oe}))},[ae]),ae?jsxRuntimeExports.jsx(StlView,{data:ae,hide:ne,...se}):null}function Dae({_key:K,src:_,text:Z,buff:te,hide:ne,encoding:ie="utf8",onLoad:oe,...se}){const[ae,le]=reactExports.useState();reactExports.useEffect(()=>{if(!ae&&ne)return;const fe=new ColladaLoader$1;if(te&&(Z=new TextDecoder(ie).decode(te)),Z){const de=fe.parse(Z,"");le(de.scene)}else _&&fe.load(_,de=>le(de.scene))},[_,ne]);const{sendMsg:ce}=useSocket();return reactExports.useEffect(()=>{ae&&(typeof oe=="function"&&oe(),typeof oe=="string"&&ce({ts:Date.now(),etype:"LOAD",key:K,value:oe}))},[ae]),ae?jsxRuntimeExports.jsx(DaeView,{data:ae,hide:ne,...se}):null}function toFixed(K){var _;return((_=K==null?void 0:K.toFixed)==null?void 0:_.call(K,4))||K}const AnnotatedPivotControls=reactExports.forwardRef(({fontSize:K,onDrag:_,onDragEnd:Z,children:te,...ne},ie)=>{const[oe,se]=reactExports.useState(null),[ae,le]=reactExports.useState(!1),[ce,fe]=reactExports.useState(0),de=reactExports.useRef(null),pe=ie||de,he=pe==null?void 0:pe.current,ge=reactExports.useRef([]),me=reactExports.useCallback((...ve)=>{var _e,Te;if(_&&_(...ve),!!he)if(he.matrixAutoUpdate||((_e=he.matrix)==null||_e.decompose(he==null?void 0:he.position,he==null?void 0:he.quaternion,he==null?void 0:he.scale),(Te=he.rotation)==null||Te.setFromQuaternion(he==null?void 0:he.quaternion)),ge.current&&(ge.current.map(clearTimeout),ge.current=[]),ae){const be=he?[`pos: [ ${he==null?void 0:he.position.toArray().map(toFixed).join(", ")} ]`,`rot: [ ${he==null?void 0:he.rotation.toArray().map(toFixed).join(", ")} ]`,`quat: [ ${he==null?void 0:he.quaternion.toArray().map(toFixed).join(", ")} ]`,`scale: [ ${he==null?void 0:he.scale.toArray().map(toFixed).join(", ")} ]`].join(`
`):null;be&&se(be)}else le(!0),!ce&&fe(100)},[he,ae,ce,_]),Ae=reactExports.useCallback((...ve)=>{Z&&Z(...ve),ge.current.push(setTimeout(()=>fe(0),3e3),setTimeout(()=>le(!1),4500))},[ae,ce,Z]),ye=reactExports.useCallback(()=>{navigator.clipboard.writeText(oe).then(()=>console.info("Copied to clipboard!"),ve=>console.error("Failed to copy: ",ve))},[oe]);return jsxRuntimeExports.jsxs(PivotControls,{ref:pe,onDrag:me,onDragEnd:Ae,...ne,children:[ae&&jsxRuntimeExports.jsxs(Html,{style:{fontSize:K,lineHeight:"1.7",zIndex:-100,top:30,left:10,background:"rgba(0.1,0.1,0.1,0.7)",padding:"10px 17px",borderRadius:5,opacity:`${ce}%`,transition:ce>1?"none":"opacity 1.5s ease-in-out"},children:[jsxRuntimeExports.jsx("pre",{style:{userSelect:"none",color:"white",zIndex:-10,top:100,margin:0},children:oe}),jsxRuntimeExports.jsx("button",{style:{color:"#aaaaaa",cursor:"pointer"},title:"copy to clipboard",onClick:ye,children:"copy"})]}),te]})}),useSourceState=(K,_)=>useXR(({session:Z})=>{const te=Z==null?void 0:Z.inputSources;if(te){for(const ne of te)if((ne==null?void 0:ne.handedness)===_&&ne[K])return ne[K]}}),l2=(K=null,_=null)=>{if(!K||!_)return null;try{return Math.sqrt(Math.pow(K[0]-_[0],2)+Math.pow(K[1]-_[1],2)+Math.pow(K[2]-_[2],2))}catch{return null}},mat2Pos=(K=null)=>K?[K[12],K[13],K[14]]:null,INDICES=[0,4,8,12,1,5,9,13,2,6,10,14,3,7,11,15];function transposeTuple(K){return INDICES.map(_=>K==null?void 0:K[_])}const instances=[{position:new Vector3(1,0,0),rotation:new Euler(0,0,-.5*Math.PI),quaternion:new Quaternion(0,0,-Math.sin(.5*Math.PI/2),Math.cos(.5*Math.PI/2)),color:new Color$1(16711680)},{position:new Vector3(0,1,0),rotation:new Euler(0,0,0),quaternion:new Quaternion(0,0,0,1),color:new Color$1(65280)},{position:new Vector3(0,0,1),rotation:new Euler(.5*Math.PI,0,0),quaternion:new Quaternion(1/Math.sqrt(2),0,0,1/Math.sqrt(2)),color:new Color$1(255)}];function Arrow({matrix:K,position:_,rotation:Z,direction:te=[1,0,0],scale:ne=1,headScale:ie=1,lod:oe=10,color:se="red",opacity:ae=1,wireframe:le=!1}){const ce=reactExports.useRef(null),fe=reactExports.useRef(null),de=reactExports.useRef(null),pe=reactExports.useMemo(()=>new Color$1(se),[se]),he=reactExports.useMemo(()=>new Object3D,[]),ge=reactExports.useMemo(()=>new Vector3(...te),[te]),me=reactExports.useMemo(()=>new Quaternion().setFromUnitVectors(new Vector3(0,1,0),ge.clone().normalize()),[ge]);reactExports.useLayoutEffect(()=>{const ve=fe.current;ve&&(he.position.set(te[0],te[1],te[2]),he.rotation.setFromQuaternion(me),he.updateMatrix(),ve.setMatrixAt(0,he.matrix));const _e=de.current;_e&&(he.position.set(te[0],te[1],te[2]).multiplyScalar(.5),he.rotation.setFromQuaternion(me),he.updateMatrix(),_e.setMatrixAt(0,he.matrix))},[]),reactExports.useLayoutEffect(()=>{var ve,_e;(ve=fe.current)==null||ve.setColorAt(0,pe),(_e=de.current)==null||_e.setColorAt(0,pe)},[pe]);const Ae={};(ae==0||ae<1)&&(Ae.transparent=!0,Ae.opacity=ae);const ye=le?jsxRuntimeExports.jsx("meshStandardMaterial",{wireframe:!0,...Ae}):jsxRuntimeExports.jsx("meshBasicMaterial",{...Ae});return jsxRuntimeExports.jsxs(VuerGroup,{ref:ce,position:_,rotation:Z,scale:ne,matrix:K,children:[jsxRuntimeExports.jsxs("instancedMesh",{ref:fe,args:[null,null,1],children:[jsxRuntimeExports.jsx("coneGeometry",{args:[.05*ie,.1*ie,oe,oe]}),ye]}),jsxRuntimeExports.jsxs("instancedMesh",{ref:de,args:[null,null,1],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.025,.025,ge.length(),oe,oe]}),ye]})]})}function CoordsMarker({matrix:K,position:_,rotation:Z,quaternion:te,scale:ne=1,headScale:ie=1,lod:oe=10,color:se,opacity:ae=1,wireframe:le=!1}){const ce=reactExports.useRef(null),fe=reactExports.useRef(null),de=reactExports.useRef(null),pe=reactExports.useMemo(()=>se&&new Color$1(se),[se]),he=reactExports.useMemo(()=>new Object3D,[]);reactExports.useLayoutEffect(()=>{const Ae=fe.current;Ae&&instances.forEach(({position:ye,rotation:ve,color:_e},Te)=>{he.position.set(ye.x,ye.y,ye.z),he.rotation.set(ve.x,ve.y,ve.z),he.updateMatrix(),Ae.setMatrixAt(Te,he.matrix),Ae.setColorAt(Te,pe||_e)})},[]),reactExports.useLayoutEffect(()=>{const Ae=de.current;Ae&&instances.forEach(({position:ye,rotation:ve,color:_e},Te)=>{he.position.set(ye.x/2,ye.y/2,ye.z/2),he.rotation.set(ve.x,ve.y,ve.z),he.updateMatrix(),Ae.setMatrixAt(Te,he.matrix),Ae.setColorAt(Te,pe||_e)})},[]);const ge={};(ae==0||ae<1)&&(ge.transparent=!0,ge.opacity=ae),se&&(ge.color=pe);const me=le?jsxRuntimeExports.jsx("meshStandardMaterial",{wireframe:!0,...ge}):jsxRuntimeExports.jsx("meshBasicMaterial",{...ge});return jsxRuntimeExports.jsxs(VuerGroup,{_ref:ce,position:_,rotation:Z,quaternion:te,scale:ne,matrix:K,children:[jsxRuntimeExports.jsxs("instancedMesh",{ref:fe,args:[null,null,3],children:[jsxRuntimeExports.jsx("coneGeometry",{args:[.05*ie,.1*ie,oe,oe]}),me]}),jsxRuntimeExports.jsxs("instancedMesh",{ref:de,args:[null,null,3],children:[jsxRuntimeExports.jsx("cylinderGeometry",{args:[.025,.025,1,oe,oe]}),me]})]})}function useInterval(K,_){const Z=reactExports.useRef(null),te=reactExports.useRef(K),ne=reactExports.useRef(performance.now()),ie=reactExports.useRef(null);return reactExports.useEffect(()=>{ie.current=_},[_]),reactExports.useEffect(()=>{te.current=K},[K]),reactExports.useEffect(()=>{ne.current=performance.now()},[typeof _=="number",_<=0]),reactExports.useEffect(()=>{const oe=()=>{if(ie.current<=0){ne.current=performance.now();return}const se=performance.now(),ae=se-ne.current;ne.current=se,te!=null&&te.current&&te.current(ae)};if(ie.current>0){const se=setInterval(oe,ie.current);return Z.current=se,()=>clearInterval(se)}},[_,K]),Z}const HAND_MODEL_JOINT_KEYS=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],handState={};function getTransformVisibility(K,_,Z){if(!K)return[null,null];try{let te=_.getJointPose(K,Z),ne=te==null?void 0:te.transform,ie=(te==null?void 0:te.emulatedPosition)||!!ne;return[ne==null?void 0:ne.matrix,ie]}catch(te){return console.error(`error when get getJointPose in Hands. 
It usually happen in Pico, Do not know why the xrReferenceSpace is null.`,te,"xrReferenceSpace:",Z),[null,null]}}function getLandmark(K,_,Z,te){if(!_||!Z)return null;const ne=_.get(Z),[ie,oe]=getTransformVisibility(ne,K,te);return ie}function getHandLandmarks(K,_,Z,te,ne=1){if(!_)return;const ie=[],oe={},se=getLandmark(K,_,"wrist",te);if(!se)return;const ae=new Vector3(se[12],se[13],se[14]);HAND_MODEL_JOINT_KEYS.forEach((de,pe)=>{const he=_.get(de),[ge,me]=getTransformVisibility(he,K,te);if(ne==1)ie.push(...ge),oe[de]=ge;else if(ge){const ye=new Vector3(ge[12],ge[13],ge[14]).clone().sub(ae);ye.multiplyScalar(ne);const ve=ae.clone().add(ye),_e=[...ge];_e[12]=ve.x,_e[13]=ve.y,_e[14]=ve.z,ie.push(..._e),oe[de]=_e}if(!Z)return;const Ae=Z==null?void 0:Z.children[pe];Ae.visible=me,Ae.matrix.set(...transposeTuple(ge))});const le=l2(mat2Pos(oe["thumb-tip"]),mat2Pos(oe["index-finger-tip"])),ce=l2(mat2Pos(oe["middle-finger-tip"]),mat2Pos(oe["middle-finger-phalanx-proximal"])),fe=l2(mat2Pos(oe["thumb-tip"]),mat2Pos(oe["index-finger-tip"]));return{poses:ie,landmarks:oe,pinch:le<.01,pinchValue:le,squeeze:ce<.07,squeezeValue:ce,tap:fe<.01,tapValue:fe}}function Hands({_key:K="hands",children:_,fps:Z=30,disableLeft:te=!1,disableRight:ne=!1,hideLeft:ie=!1,hideRight:oe=!1,showFrame:se=!0,frameScale:ae=.02,stream:le=!1,scale:ce=1,...fe}){const{sendMsg:de}=useSocket(),pe=useXR(({mode:Re})=>Re),he=useXR(({originReferenceSpace:Re})=>Re),ge=useSourceState("hand","left"),me=useSourceState("hand","right"),Ae=pe==="immersive-ar"||pe==="immersive-vr",ye=reactExports.useRef(null),ve=reactExports.useRef(null),_e=useControls("Render.Hands",{showFrame:{value:se,hidden:!0}},[se]),Te=reactExports.useMemo(()=>({}),[]);useFrame(function(Re,we,Pe){if(!Ae)return;const Ie=ye.current,$e=ve.current;if(!te){const{poses:Ue,landmarks:ke,...Ge}=getHandLandmarks(Pe,ge,Ie,he,ce)||{};handState.left=Ge,handState.leftLandmarks=ke,Te.left=Ue,Te.leftState=Ge}if(!ne){const{poses:Ue,landmarks:ke,...Ge}=getHandLandmarks(Pe,me,$e,he,ce)||{};Te.right=Ue,Te.rightState=Ge,handState.right=Ge,handState.rightLandmarks=ke}});const be=reactExports.useCallback(()=>{Ae&&(!le||te&&ne||de({ts:Date.now(),etype:"HAND_MOVE",key:K,value:{...Te}}))},[Ae,le,te,ne,Te]);return useInterval(be,1e3/Z),!Ae||!ge&&!me?null:jsxRuntimeExports.jsxs("group",{children:[!te&&!ie&&jsxRuntimeExports.jsx("group",{ref:ye,castShadow:!0,matrixAutoUpdate:!1,children:HAND_MODEL_JOINT_KEYS.map((Re,we)=>jsxRuntimeExports.jsx("group",{matrixAutoUpdate:!1,children:_e!=null&&_e.showFrame?jsxRuntimeExports.jsx(CoordsMarker,{scale:ae}):jsxRuntimeExports.jsxs("mesh",{children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.01,.01,.01]}),jsxRuntimeExports.jsx("meshStandardMaterial",{attach:"material",color:"#ff4444",roughness:.1})]})},Re))}),!ne&&!oe&&jsxRuntimeExports.jsx("group",{ref:ve,castShadow:!0,matrixAutoUpdate:!1,children:HAND_MODEL_JOINT_KEYS.map((Re,we)=>jsxRuntimeExports.jsx("group",{matrixAutoUpdate:!1,children:_e!=null&&_e.showFrame?jsxRuntimeExports.jsx(CoordsMarker,{scale:ae}):jsxRuntimeExports.jsxs("mesh",{children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.01,.01,.01]}),jsxRuntimeExports.jsx("meshStandardMaterial",{attach:"material",color:"#23aaff",roughness:.1})]})},Re))})]})}const useMotionControllerState=(K,_)=>useXR(({session:Z})=>{const te=Z==null?void 0:Z.inputSources;if(te){for(const ne of te)if((ne==null?void 0:ne.handedness)===_&&ne[K]&&ne.gamepad.buttons.length>=6)return ne}}),controllerState={};function getTargetRayTransform(K,_,Z){try{if(_&&K.targetRayMode==="tracked-pointer"&&K.targetRaySpace){const te=_.getPose(K.targetRaySpace,Z),ne=te==null?void 0:te.transform,ie=te!==null;return[ne==null?void 0:ne.matrix,ie]}return[null,null]}catch(te){return console.error(`Error getting target ray transform in MotionControllers: 
It usually happen in Pico, Do not know why the xrReferenceSpace is null.`,te,"xrReferenceSpace:",Z),[null,null]}}function getState(K,_,Z){var te,ne,ie,oe,se,ae,le,ce,fe,de;if(!_)return;const[pe,he]=getTargetRayTransform(_,K,Z);if(!pe)return;const ge=_.gamepad,me=(ge==null?void 0:ge.buttons)||[];return{transform:Array.from(pe),trigger:((te=me[0])==null?void 0:te.pressed)||!1,squeeze:((ne=me[1])==null?void 0:ne.pressed)||!1,touchpad:((ie=me[2])==null?void 0:ie.pressed)||!1,thumbstick:((oe=me[3])==null?void 0:oe.pressed)||!1,aButton:((se=me[4])==null?void 0:se.pressed)||!1,bButton:((ae=me[5])==null?void 0:ae.pressed)||!1,triggerValue:((le=me[0])==null?void 0:le.value)||0,squeezeValue:((ce=me[1])==null?void 0:ce.value)||0,touchpadValue:[(ge==null?void 0:ge.axes[0])||0,(ge==null?void 0:ge.axes[1])||0],thumbstickValue:[(ge==null?void 0:ge.axes[2])||0,(ge==null?void 0:ge.axes[3])||0],aButtonValue:((fe=me[4])==null?void 0:fe.pressed)||!1,bButtonValue:((de=me[5])==null?void 0:de.pressed)||!1}}function MotionControllers({_key:K="motionControllers",children:_,fps:Z=30,left:te,right:ne,stream:ie=!1,...oe}){const{sendMsg:se}=useSocket(),ae=useXR(({mode:ge})=>ge),le=useXR(({originReferenceSpace:ge})=>ge),ce=useMotionControllerState("gamepad","left"),fe=useMotionControllerState("gamepad","right"),de=ae==="immersive-ar"||ae==="immersive-vr";reactExports.useRef(null),reactExports.useRef(null),reactExports.useRef(new MeshStandardMaterial({color:"#ff4444"})),reactExports.useRef(new MeshStandardMaterial({color:"#23aaff"})),new LineBasicMaterial({color:65280}),new BufferGeometry().setFromPoints([new Vector3(0,0,0),new Vector3(0,0,-1)]);const pe=reactExports.useMemo(()=>({}),[]);useFrame(function(ge,me,Ae){if(!de)return;const{transform:ye,...ve}=getState(Ae,ce,le)||{},{transform:_e,...Te}=getState(Ae,fe,le)||{};te&&ve?(pe.left=ye,pe.leftState=ve,controllerState.leftPose=ye,controllerState.left=ve):(controllerState.leftPose=null,controllerState.left=null),ne&&Te?(pe.right=_e,pe.rightState=Te,controllerState.rightPose=_e,controllerState.right=Te):(controllerState.rightPose=null,controllerState.right=null)});const he=reactExports.useCallback(()=>{!de||!ie||se({ts:Date.now(),etype:"CONTROLLER_MOVE",key:K,value:{...pe}})},[ie,de]);return useInterval(he,1e3/Z),null}const XrMovableLocal=({offset:K=[0,0,0],position:_=[0,1,-1],quaternion:Z,rotation:te,markerScale:ne=.1,handleSize:ie,onMove:oe,onMoveEnd:se,showFrame:ae=!0,wireframe:le=!1,children:ce,...fe})=>{var de;const pe=reactExports.useRef(null),he=reactExports.useRef(null),ge=reactExports.useRef(null),me=reactExports.useRef(null);reactExports.useRef(null);const Ae=useXR(({mode:ze})=>ze),ye=Ae==="immersive-ar"||Ae==="immersive-vr",[ve,_e,Te]=useStateRef(!1),[be,Re]=reactExports.useState(!1),we=reactExports.useCallback(()=>Re(!0),[Re]),Pe=reactExports.useCallback(()=>Re(!1),[Re]);useFrame((ze,Ke,tt)=>{var Je,ot,Fe,ct;if(!ye||!Te.current)return;const ht=(Ze,it)=>{var nt,Tt,St,Et;if(it&&ge.current&&me.current){const Nt=new Matrix4().fromArray(me.current).invert(),zt=new Matrix4().fromArray(Ze).multiply(Nt),yt=new Matrix4().extractRotation(zt);(nt=pe.current)==null||nt.matrix.extractRotation(ge.current),(Tt=pe.current)==null||Tt.matrix.premultiply(yt);const Ut=new Vector3().setFromMatrixPosition(ge.current),bt=new Matrix4().fromArray(me.current),Ot=new Vector3().setFromMatrixPosition(bt),Mt=new Vector3(Ze[12],Ze[13],Ze[14]);Mt.sub(Ot),Mt.add(Ut);const _t=new Matrix4().makeTranslation(Mt);(St=pe.current)==null||St.matrix.premultiply(_t),pe.current.matrixAutoUpdate=!1,oe==null||oe({world:pe.current.matrix.clone()})}else ge.current=(Et=pe.current)==null?void 0:Et.matrix.clone(),me.current=Ze};let lt,Qe;ve==="right"&&handState.rightLandmarks?(lt=handState.rightLandmarks.wrist,Qe=(Je=handState.right)==null?void 0:Je.squeeze):ve==="left"&&handState.leftLandmarks?(lt=handState.leftLandmarks.wrist,Qe=(ot=handState.left)==null?void 0:ot.squeeze):ve==="rightController"&&controllerState.rightPose?(lt=controllerState.rightPose,Qe=(Fe=controllerState.right)==null?void 0:Fe.squeeze):ve==="leftController"&&controllerState.leftPose&&(lt=controllerState.leftPose,Qe=(ct=controllerState.left)==null?void 0:ct.squeeze),lt&&ht(lt,Qe)});let Ie=be?1:.7,$e=be?"#ffff88":"#777";typeof ve=="string"&&(ve.startsWith("left")&&($e="#ff4444"),ve.startsWith("right")&&($e="#23aaff"));const Ue=reactExports.useMemo(()=>new Vector3(_[0]+K[0],_[1]+K[1],_[2]+K[2]),[...K,..._]),ke=reactExports.useMemo(()=>new Vector3(-K[0],-K[1],-K[2]),[K]),Ge=reactExports.useMemo(()=>{const ze=ie||ne;return typeof ze=="number"?[ze,ze,ze]:ze},[ne,ie]);reactExports.useEffect(()=>{pe.current&&(pe.current.matrixAutoUpdate=!0)},[...K,..._,te,Z]);const He=reactExports.useCallback(ze=>{var Ke,tt,Je,ot,Fe,ct,ht,lt,Qe;ze.stopPropagation();let Ze;(Ke=handState.left)!=null&&Ke.pinch&&!((tt=handState.right)!=null&&tt.pinch)?Ze=Te.current==="left"?null:"left":(Je=handState.right)!=null&&Je.pinch&&!((ot=handState.left)!=null&&ot.pinch)?Ze=Te.current==="right"?null:"right":(Fe=controllerState.left)!=null&&Fe.trigger&&!((ct=controllerState.right)!=null&&ct.trigger)?Ze=Te.current==="leftController"?null:"leftController":(ht=controllerState.right)!=null&&ht.trigger&&!((lt=controllerState.left)!=null&&lt.trigger)&&(Ze=Te.current==="rightController"?null:"rightController"),_e(Ze),ge.current=(Qe=pe.current)==null?void 0:Qe.matrix.clone()},[Te.current,(de=pe.current)==null?void 0:de.matrix,ge.current]);return console.log("xrMovableLocal",Z,te),jsxRuntimeExports.jsxs("group",{ref:pe,position:Ue,quaternion:Z,rotation:te,...fe,children:[jsxRuntimeExports.jsxs("mesh",{ref:he,onPointerEnter:we,onPointerLeave:Pe,onPointerMissed:Pe,onClick:He,scale:Ge,children:[jsxRuntimeExports.jsx("meshPhysicalMaterial",{attach:"material",color:$e,transparent:!0,opacity:Ie,wireframe:le}),jsxRuntimeExports.jsx("boxGeometry",{attach:"geometry",args:[1,1,1]})]}),ae&&jsxRuntimeExports.jsx(CoordsMarker,{scale:ne}),jsxRuntimeExports.jsx("group",{position:ke,children:ce})]})},XrMovableAnchor=({offset:K=[0,0,0],position:_=[0,1,-1],quaternion:Z,rotation:te,scale:ne=.1,handle:ie,onMove:oe,onMoveEnd:se,showFrame:ae=!0,wireframe:le=!1,children:ce,...fe})=>{var de;const pe=reactExports.useRef(null),he=reactExports.useRef(null),ge=reactExports.useRef(null),me=reactExports.useRef(null),Ae=useXR(({mode:ze})=>ze),ye=Ae==="immersive-ar"||Ae==="immersive-vr",[ve,_e,Te]=useStateRef(null),[be,Re]=reactExports.useState(!1),we=reactExports.useCallback(()=>Re(!0),[Re]),Pe=reactExports.useCallback(()=>Re(!1),[Re]);useFrame((ze,Ke,tt)=>{var Je,ot,Fe,ct;if(!ye||!Te.current)return;const ht=(Ze,it)=>{var nt,Tt,St;if(it&&ge.current&&me.current){const Et=new Matrix4().fromArray(me.current).invert(),Nt=new Matrix4().fromArray(Ze).multiply(Et);(nt=pe.current)==null||nt.matrix.copy(ge.current),(Tt=pe.current)==null||Tt.matrix.premultiply(Nt),pe.current.matrixAutoUpdate=!1,oe({world:pe.current.matrix.clone()})}else ge.current=(St=pe.current)==null?void 0:St.matrix.clone(),me.current=Ze};let lt,Qe;Te.current==="right"&&handState.rightLandmarks?(lt=handState.rightLandmarks.wrist,Qe=(Je=handState.right)==null?void 0:Je.squeeze):Te.current==="left"&&handState.leftLandmarks?(lt=handState.leftLandmarks.wrist,Qe=(ot=handState.left)==null?void 0:ot.squeeze):ve==="leftController"&&controllerState.leftPose?(lt=controllerState.leftPose,Qe=(Fe=controllerState.left)==null?void 0:Fe.squeeze):ve==="rightController"&&controllerState.rightPose&&(lt=controllerState.rightPose,Qe=(ct=controllerState.right)==null?void 0:ct.squeeze),lt&&ht(lt,Qe)});let Ie=be?1:.7,$e=be?"#ffff88":"#777";typeof ve=="string"&&(ve.startsWith("left")&&($e="#ff4444"),ve.startsWith("right")&&($e="#23aaff"));const Ue=reactExports.useMemo(()=>new Vector3(_[0]+K[0],_[1]+K[1],_[2]+K[2]),[...K,..._]),ke=reactExports.useMemo(()=>new Vector3(-K[0],-K[1],-K[2]),[K]),Ge=reactExports.useMemo(()=>{const ze=ie||ne;return typeof ze=="number"?[ze,ze,ze]:ze},[ne,ie]);reactExports.useEffect(()=>{pe.current&&(pe.current.matrixAutoUpdate=!0)},[...K,..._,te,Z]);const He=reactExports.useCallback(ze=>{var Ke,tt,Je,ot,Fe,ct,ht,lt,Qe;ze.stopPropagation();let Ze;(Ke=handState.left)!=null&&Ke.pinch&&!((tt=handState.right)!=null&&tt.pinch)?Ze=Te.current==="left"?null:"left":(Je=handState.right)!=null&&Je.pinch&&!((ot=handState.left)!=null&&ot.pinch)?Ze=Te.current==="right"?null:"right":(Fe=controllerState.left)!=null&&Fe.trigger&&!((ct=controllerState.right)!=null&&ct.trigger)?Ze=Te.current==="leftController"?null:"leftController":(ht=controllerState.right)!=null&&ht.trigger&&!((lt=controllerState.left)!=null&&lt.trigger)&&(Ze=Te.current==="rightController"?null:"rightController"),_e(Ze),ge.current=(Qe=pe.current)==null?void 0:Qe.matrix.clone()},[Te.current,(de=pe.current)==null?void 0:de.matrix,ge.current]);return jsxRuntimeExports.jsxs("group",{ref:pe,position:Ue,quaternion:Z,rotation:te,...fe,children:[jsxRuntimeExports.jsxs("mesh",{ref:he,onPointerEnter:we,onPointerLeave:Pe,onPointerMissed:Pe,onClick:He,scale:Ge,children:[jsxRuntimeExports.jsx("meshPhysicalMaterial",{attach:"material",color:$e,transparent:!0,opacity:Ie,wireframe:le}),jsxRuntimeExports.jsx("boxGeometry",{attach:"geometry",args:[1,1,1]})]}),ae&&jsxRuntimeExports.jsx(CoordsMarker,{scale:ne}),jsxRuntimeExports.jsx("group",{position:ke,children:ce})]})};function Pivot({children:K,_key:_,_ref:Z,anchor:te,offset:ne,scale:ie=.4,lineWidth:oe=1,matrix:se,position:ae,rotation:le,quaternion:ce,onMove:fe,onMoveEnd:de,...pe}){const[he,ge]=reactExports.useState({}),me=reactExports.useRef(null),Ae=Z||me,{sendMsg:ye}=useSocket(),ve=reactExports.useMemo(()=>({position:new Vector3(...ae||[0,0,0]),rotation:new Euler(...le||[0,0,0]),quaternion:new Quaternion(...ce||[0,0,0,1]),scale:new Vector3(1,1,1)}),[]);reactExports.useEffect(()=>{if(!Ae.current)return;const be=Ae.current;se&&(be.matrix.fromArray(se),be.matrix.decompose(be.position,be.quaternion,be.scale),be.rotation.setFromQuaternion(be.quaternion))},[se,Ae.current]),reactExports.useEffect(()=>{if(!Ae.current)return;const be=Ae.current;if(se)return;let Re=!1;ae&&(be.position.fromArray(ae),Re=!0),le&&(be.rotation.fromArray(le),Re=!0),ce&&(be.quaternion.fromArray(ce),Re=!0),Re&&(be==null||be.updateMatrix())},[ae,le,ce,Ae.current]);const _e=reactExports.useCallback((be,Re)=>{be.decompose(ve.position,ve.quaternion,ve.scale),ve.rotation.setFromQuaternion(ve.quaternion);const we={matrix:be.toArray(),matrixWorld:Re.toArray(),position:ve.position.toArray(),rotation:ve.rotation.toArray(),quaternion:ve.quaternion.toArray()};ye({ts:Date.now(),etype:"OBJECT_MOVE",key:_,value:we}),fe&&fe(we),ge(we)},[he,ye,fe]),Te=reactExports.useCallback(()=>{ye({ts:Date.now(),etype:"OBJECT_MOVE_END",key:_,value:he})},[he,ye]);return jsxRuntimeExports.jsx(AnnotatedPivotControls,{ref:Ae,annotations:!0,scale:ie,anchor:te,offset:ne,onDrag:_e,onDragEnd:Te,lineWidth:oe,...pe,children:K})}function PivotXR({_key:K,_ref:_,offset:Z,scale:te,position:ne,rotation:ie,children:oe=[],onMove:se,onMoveEnd:ae,localRotation:le=!1,...ce}){const fe=reactExports.useRef(null),de=_||fe,{sendMsg:pe}=useSocket(),he=reactExports.useMemo(()=>({position:new Vector3,rotation:new Euler,quaternion:new Quaternion,scale:new Vector3}),[]);reactExports.useCallback(()=>{var me,Ae;const ye=(me=de.current)==null?void 0:me.matrix,ve=(Ae=de.current)==null?void 0:Ae.matrixWorld;ve.decompose(he.position,he.quaternion,he.scale),he.rotation.setFromQuaternion(he.quaternion);const _e={matrix:ye.toArray(),matrixWorld:ve.toArray(),position:he.position.toArray(),rotation:he.rotation.toArray(),quaternion:he.quaternion.toArray()};ae&&ae(_e),pe({ts:Date.now(),etype:"OBJECT_MOVE_END",key:K,value:_e})},[]);const ge=reactExports.useCallback(({world:me})=>{me.decompose(he.position,he.quaternion,he.scale),he.rotation.setFromQuaternion(he.quaternion);const Ae={matrixWorld:me.toArray(),position:he.position.toArray(),rotation:he.rotation.toArray(),quaternion:he.quaternion.toArray()};se&&se(Ae),pe({ts:Date.now(),etype:"OBJECT_MOVE",key:K,value:Ae})},[]);return le?jsxRuntimeExports.jsx(XrMovableLocal,{offset:Z,position:ne,rotation:ie,markerScale:te,onMove:ge,...ce,children:oe}):jsxRuntimeExports.jsx(XrMovableAnchor,{offset:Z,position:ne,rotation:ie,scale:te,onMove:ge,...ce,children:oe})}function Movable({_key:K,_ref:_,children:Z,anchor:te,offset:ne,scale:ie=.4,lineWidth:oe=2,hide:se,...ae}){const le=useXR(({mode:fe})=>fe);return se?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Z}):le==="immersive-ar"||le==="immersive-vr"?jsxRuntimeExports.jsx(PivotXR,{_key:K,_ref:_,scale:ie*.1,offset:ne,...ae,children:Z}):jsxRuntimeExports.jsx(Pivot,{_key:K,_ref:_,anchor:te,offset:ne,scale:ie*.1,lineWidth:oe,...ae,children:Z})}const XrMovableMimic=({markerScale:K=.02,jointName:_,position:Z=[0,0,0],quaternion:te,hand:ne,onMove:ie,relativeTracking:oe=!1,showFrame:se=!1,...ae})=>{const le=reactExports.useRef(null),ce=useXR(({mode:he})=>he),fe=ce==="immersive-ar"||ce==="immersive-vr",de=reactExports.useRef(null),pe=reactExports.useRef(null);return useFrame((he,ge)=>{var me,Ae,ye,ve;if(!fe||!_||!ne)return;const _e=ne==="left"?handState.leftLandmarks:handState.rightLandmarks,Te=_e==null?void 0:_e[_];if(Te)if(((me=handState.left)!=null&&me.squeeze&&ne==="right"||(Ae=handState.right)!=null&&Ae.squeeze&&ne==="left"||!oe)&&de.current&&pe.current){const be=new Matrix4().fromArray(Te),Re=new Vector3,we=new Quaternion;if(be.decompose(Re,we,new Vector3),oe){const Pe=new Matrix4().fromArray(pe.current).invert(),Ie=new Matrix4().fromArray(Te).multiply(Pe),$e=new Matrix4().extractRotation(Ie);(ye=le.current)==null||ye.matrix.extractRotation(de.current),(ve=le.current)==null||ve.matrix.premultiply($e);const Ue=new Vector3().setFromMatrixPosition(de.current),ke=new Matrix4().fromArray(pe.current),Ge=new Vector3().setFromMatrixPosition(ke),He=new Vector3(Te[12],Te[13],Te[14]);He.sub(Ge),He.add(Ue);const ze=new Matrix4().makeTranslation(Re);le.current.matrix.premultiply(ze),le.current.matrixAutoUpdate=!1,ie==null||ie({world:le.current.matrix.clone()})}else{if(!le.current)return;le.current.position.copy(Re),le.current.quaternion.copy(we),ie==null||ie({world:le.current.matrix.clone()})}}else de.current=le.current.matrix.clone(),pe.current=Te}),jsxRuntimeExports.jsx("group",{ref:le,position:Z,quaternion:te,...ae,children:se&&jsxRuntimeExports.jsx(CoordsMarker,{scale:K})})};function getPosition(K,_,Z,te,ne){_.setFromCamera(Z,K);const ie=_.intersectObjects(te,!0);if(ne){const oe=ie.slice(0,ne);return oe.reduce((se,{point:ae})=>se.add(ae),new Vector3(0,0,0)).divideScalar(oe.length)}if(ie)return ie[0].point}function flattenGroups(K){return K.reduce((_,Z)=>Z.type==="Group"?_.concat(flattenGroups(Z.children)):_.concat(Z),[])}function Pointer({parent:K,thres:_=.01,color:Z="red",onClick:te,childSelector:ne=({type:se})=>se==="Points",average:ie,disable:oe=!1}){const{scene:se,camera:ae,raycaster:le,pointer:ce}=useThree(),fe=reactExports.useRef(null);return reactExports.useEffect(()=>{var de,pe,he,ge;le.params.Points.threshold=_;const me={is_down:!1},Ae=()=>{me.is_down=!0},ye=()=>{me.is_down=!1},ve=()=>{if(me.is_down)return;const Te=flattenGroups(se.children).filter(ne),be=getPosition(ae,le,ce,Te,ie);me.pos=be,fe.current.position.set(...be),invalidate()},_e=Te=>{if(typeof te!="function")return;const be=Te.target;te({position:fe.current.position.clone(),radius:_,x:Te.offsetX/be.offsetWidth,y:Te.offsetY/be.offsetHeight,offsetX:Te.offsetX,offsetY:Te.offsetY,offsetHeight:be.offsetHeight,offsetWidth:be.offsetWidth})};return(de=K.current)==null||de.addEventListener("mousedown",Ae),(pe=K.current)==null||pe.addEventListener("mouseup",ye),(he=K.current)==null||he.addEventListener("mousemove",ve),(ge=K.current)==null||ge.addEventListener("click",_e),()=>{var Te,be,Re,we;(Te=K.current)==null||Te.removeEventListener("mousedown",Ae),(be=K.current)==null||be.removeEventListener("mouseup",ye),(Re=K.current)==null||Re.removeEventListener("mousemove",ve),(we=K.current)==null||we.removeEventListener("click",_e)}},[_,te,oe]),jsxRuntimeExports.jsx(Sphere$1,{ref:fe,args:[_],children:jsxRuntimeExports.jsx("meshBasicMaterial",{color:Z,opacity:1,transparent:!0})})}function PointerControls({parentKey:K,parent:_}){const{gl:Z}=useThree(),te=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{_||(te.current=Z.domElement)},[]);const ne=_||te,{sendMsg:ie}=useSocket(),{enableMarker:oe,markerSize:se,markerAvg:ae,color:le}=useControls("Scene.Pointer",{color:"red",enableMarker:{value:!1,label:"Enable"},markerSize:{value:10,min:.1,max:100,step:.1,pad:1,label:"Pointer Size"},markerAvg:{value:5,min:0,max:20,step:1,label:"Average k"}},{collapsed:!0}),ce=({position:fe,radius:de,x:pe,y:he,...ge})=>{let me;!fe||fe.x!==fe.x||fe.y!==fe.y||fe.z!==fe.z?me={etype:"MOUSE_CLICK",key:K,value:{pointerX:pe,pointerY:he,...ge}}:me={etype:"ADD_MARKER",key:K,value:{position:fe,radius:de,pointerX:pe,pointerY:he,...ge}},typeof ie=="function"&&ie(me)};return jsxRuntimeExports.jsx(Pointer,{parent:ne,thres:se/1e3,onClick:ce,average:ae,disable:!oe,color:le})}function HandsView({_key:K="hands-view",left:_,right:Z,children:te,showFrame:ne=!1,frameScale:ie=.02,scale:oe=1,...se}){const ae=reactExports.useRef(null),le=reactExports.useRef(null),ce=useControls("Render.Hands",{showFrame:{value:ne,hidden:!0}});return reactExports.useEffect(()=>{_&&ae.current.children.forEach((fe,de)=>{const pe=_.slice(16*de,16*(de+1));fe.matrix.set(...pe),fe.matrixAutoUpdate=!1})},[_]),reactExports.useEffect(()=>{Z&&le.current.children.forEach((fe,de)=>{const pe=Z.slice(16*de,16*(de+1));fe.matrix.set(...pe),fe.matrixAutoUpdate=!1})},[Z]),reactExports.useEffect(()=>{},[Z]),jsxRuntimeExports.jsxs("group",{children:[_&&jsxRuntimeExports.jsx("group",{ref:ae,castShadow:!0,children:HAND_MODEL_JOINT_KEYS.map((fe,de)=>jsxRuntimeExports.jsx("group",{children:ce!=null&&ce.showFrame?jsxRuntimeExports.jsx(CoordsMarker,{scale:ie}):jsxRuntimeExports.jsxs("mesh",{children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.01,.01,.01]}),jsxRuntimeExports.jsx("meshStandardMaterial",{attach:"material",color:"#ff4444",roughness:.1})]})},fe))}),Z&&jsxRuntimeExports.jsx("group",{ref:le,castShadow:!0,children:HAND_MODEL_JOINT_KEYS.map((fe,de)=>jsxRuntimeExports.jsx("group",{children:ce!=null&&ce.showFrame?jsxRuntimeExports.jsx(CoordsMarker,{scale:ie}):jsxRuntimeExports.jsxs("mesh",{children:[jsxRuntimeExports.jsx("boxGeometry",{args:[.01,.01,.01]}),jsxRuntimeExports.jsx("meshStandardMaterial",{attach:"material",color:"#23aaff",roughness:.1})]})},fe))})]})}function BBox({min:K={x:-1,y:-1,z:-1},max:_={x:1,y:1,z:1},color:Z="0xffffff",scale:te=1.01,...ne}){const ie=[_.x-K.x,_.y-K.y,_.z-K.z],oe=[K.x+ie[0]/2,K.y+ie[1]/2,K.z+ie[2]/2];return jsxRuntimeExports.jsxs("mesh",{position:oe,...ne,children:[jsxRuntimeExports.jsx("boxGeometry",{args:ie}),jsxRuntimeExports.jsx("meshBasicMaterial",{transparent:!0,depthWrite:!1,opacity:0}),jsxRuntimeExports.jsx(Edges$1,{scale:te,color:Z})]})}function mergeRefs(){for(var K=[],_=0;_<arguments.length;_++)K[_]=arguments[_];var Z=K.filter(Boolean);if(Z.length<=1){var te=Z[0];return te||null}return function(ne){Z.forEach(function(ie){typeof ie=="function"?ie(ne):ie&&(ie.current=ne)})}}const isFunction=K=>typeof K=="function",PerspectiveCamera=reactExports.forwardRef(({envMap:K,resolution:_=256,frames:Z=1/0,makeDefault:te,children:ne,...ie},oe)=>{const se=useThree(({set:ge})=>ge),ae=useThree(({camera:ge})=>ge),le=reactExports.useRef(null),ce=reactExports.useRef(null),fe=useFBO(_);let de=0,pe=null;const he=isFunction(ne);if(useFrame(ge=>{he&&(Z===1/0||de<Z)&&(ce.current.visible=!1,ge.gl.setRenderTarget(fe),pe=ge.scene.background,K&&(ge.scene.background=K),ge.gl.render(ge.scene,le.current),ge.scene.background=pe,ge.gl.setRenderTarget(null),ce.current.visible=!0,de++)}),reactExports.useLayoutEffect(()=>{if(te){const ge=ae;return se(()=>({camera:le.current})),()=>se(()=>({camera:ge}))}},[le,te,se]),he){const ge=ne;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("perspectiveCamera",{ref:mergeRefs(le,oe),...ie}),jsxRuntimeExports.jsx("group",{ref:ce,children:ge(fe.texture)})]})}else return jsxRuntimeExports.jsx("perspectiveCamera",{ref:mergeRefs(le,oe),...ie,children:ne})});function equals(K,_){for(let Z=0;Z<K.length;Z++)if(K[Z]!==_[Z])return!1;return!0}function Frustum({_key:K,_ref:_,position:Z,rotation:te,matrix:ne,aspect:ie=4/3,focus:oe=10,fov:se=50,near:ae=.1,far:le=.2,scale:ce=1,upScale:fe=1,focalLength:de=.035,showUp:pe=!0,showFrustum:he=!0,showFocalPlane:ge=!0,showImagePlane:me=!1,colorFrustum:Ae=16755200,colorCone:ye=16711680,colorFocalPlane:ve="white",colorUp:_e=43775,colorTarget:Te="green",colorCross:be=3355443,children:Re}){const we=reactExports.useMemo(()=>({raw:null,matrix:new Matrix4,position:new Vector3(0,0,0),rotation:new Euler(0,0,0),quaternion:new Quaternion(0,0,0,0),scale:new Vector3(0,0,0)}),[]);let Pe=reactExports.useRef(null);_&&(Pe=_),reactExports.useLayoutEffect(()=>{if(Pe.current)if(ne){if(we.raw&&equals(we.raw,ne))return;we.raw=ne,we.matrix.fromArray(ne),we.matrix.decompose(Pe.current.position,we.quaternion,we.scale),Pe.current.rotation.setFromQuaternion(we.quaternion)}else Z&&te&&(Pe.current.position.set(...Z),Pe.current.rotation.set(...te),Pe.current.updateMatrix())},[ne,se,oe,ae,le]);const Ie=reactExports.useMemo(()=>{const $e=Math.tan(se/360*Math.PI),Ue=$e*oe,ke=ie*Ue,Ge=$e*de,He=ie*Ge,ze=$e*ae,Ke=ie*ze,tt=$e*le,Je=ie*tt;return{up:[[-He*.6,Ge*1.05,-de],[He*.6,Ge*1.05,-de],[0,Ge+Math.max(Ge*.4,He*.25),-de],[-He*.6,Ge*1.05,-de]],imagePlaneCone:[[0,0,0],[-He,-Ge,-de],[0,0,0],[He,-Ge,-de],[0,0,0],[He,Ge,-de],[0,0,0],[-He,Ge,-de]],imagePlane:[[-He,-Ge,-de],[He,-Ge,-de],[He,Ge,-de],[-He,Ge,-de],[-He,-Ge,-de]],nearPlane:[[-Ke,-ze,-ae],[Ke,-ze,-ae],[Ke,ze,-ae],[-Ke,ze,-ae],[-Ke,-ze,-ae]],cone:[[0,0,0],[-Ke,-ze,-ae],[0,0,0],[Ke,-ze,-ae],[0,0,0],[Ke,ze,-ae],[0,0,0],[-Ke,ze,-ae],[0,0,0],[-Ke,-ze,-ae]],farPlane:[[-Je,-tt,-le],[Je,-tt,-le],[Je,tt,-le],[-Je,tt,-le],[-Je,-tt,-le]],farPlaneFrustum:[[-Ke,-ze,-ae],[-Je,-tt,-le],[Ke,-ze,-ae],[Je,-tt,-le],[Ke,ze,-ae],[Je,tt,-le],[-Ke,ze,-ae],[-Je,tt,-le]],focalPlane:[[-ke,-Ue,-oe],[ke,-Ue,-oe],[ke,Ue,-oe],[-ke,Ue,-oe],[-ke,-Ue,-oe]],crossHair:[[0,Ue,-oe],[0,-Ue,-oe],[ke,0,-oe],[-ke,0,-oe]]}},[se,oe,ie,ae,le]);return jsxRuntimeExports.jsxs("group",{ref:Pe,position:Z,rotation:te,children:[pe?jsxRuntimeExports.jsx(Line$1,{scale:ce*fe,points:Ie.up,color:_e,lineWidth:1},"up"):null,me?jsxRuntimeExports.jsx(Line$1,{scale:ce,points:Ie.imagePlaneCone,color:ye,lineWidth:2,segments:!0},"image-plane-cone"):null,me?jsxRuntimeExports.jsx(Line$1,{scale:ce,points:Ie.imagePlane,color:ve,lineWidth:2},"image-plane"):null,he?[jsxRuntimeExports.jsx(Line$1,{points:Ie.nearPlane,color:Ae,lineWidth:1},"near-plane"),jsxRuntimeExports.jsx(Line$1,{points:Ie.cone,color:ye,lineWidth:1,segments:!0},"cone"),jsxRuntimeExports.jsx(Line$1,{points:Ie.farPlane,color:Ae,lineWidth:1},"far-plane"),jsxRuntimeExports.jsx(Line$1,{points:Ie.farPlaneFrustum,color:Ae,lineWidth:1,segments:!0},"far-plane-frustum")]:null,ge?[jsxRuntimeExports.jsx(Sphere$1,{position:[0,0,-oe],"material-color":Te,scale:.2},"focus"),jsxRuntimeExports.jsx(Line$1,{points:Ie.focalPlane,color:ve,lineWidth:1},"focal-plane"),jsxRuntimeExports.jsx(Line$1,{points:Ie.crossHair,color:be,lineWidth:1,segments:!0},"cross-hair")]:null,Re]},K)}const useDepthRender=(K=!1)=>{const[_,Z,te]=reactExports.useMemo(()=>{if(K)return[null,null,null];const ne=new OrthographicCamera$1(-1,1,1,-1,0,1),ie=new ShaderMaterial({vertexShader:`
      varying vec2 vUv;
      void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }`,fragmentShader:`
      #include <packing>
    
      varying vec2 vUv;
      uniform sampler2D tDepth;
      uniform float cameraNear;
      uniform float cameraFar;
      
      float readDepth( sampler2D depthSampler, vec2 coord ) {
        float fragCoordZ = texture2D( depthSampler, coord ).x;
        float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
        return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );
      }
      
      void main() {
        float depth = readDepth( tDepth, vUv );
        
        gl_FragColor.rgb = 1.0 - vec3( depth );
        gl_FragColor.a = 1.0;

        // this works. 
        // float d_normal = depth;
        // 
        // // Initialize the color as black
        // vec3 color = vec3(0.0);

        // // Calculate RGB values based on the normalized depth
        // if (d_normal <= 0.167) {
        //   color.r = 1.0;
        //   color.g = d_normal;
        // } else if (d_normal < 0.333) {
        //   color.r = 0.333 - d_normal;
        //   color.g = 1.0;
        // } else if (d_normal < 0.5) {
        //   color.g = 1.0;
        //   color.b = d_normal - 0.5;
        // } else if (d_normal < 0.667) {
        //   color.g = 0.667 - d_normal;
        //   color.b = 1.0;
        // } else if (d_normal < 0.833) {
        //   color.r = d_normal - 0.833;
        //   color.b = 1.0;
        // } else {
        //   color.r = 1.0;
        //   color.b = 1.0 - d_normal;
        // }

        // // Set the fragment's color
        // gl_FragColor.rgb = color;
        
      }`,uniforms:{cameraNear:{value:.1},cameraFar:{value:10},tDepth:{value:null}}}),oe=new PlaneGeometry(2,2),se=new Mesh(oe,ie),ae=new Scene$1;return ae.add(se),[ae,ie,ne]},[K]);return reactExports.useCallback(({renderer:ne,depthTexture:ie,near:oe,far:se})=>{Z&&(Z.uniforms.tDepth.value=ie,Z.uniforms.cameraNear.value=oe,Z.uniforms.cameraFar.value=se,ne.setRenderTarget(null),ne.render(_,te))},[K])},useRender=(K=!1)=>{const[_,Z,te]=reactExports.useMemo(()=>{if(K)return[null,null,null];const ne=new OrthographicCamera$1(-1,1,1,-1,0,1),ie=new MeshBasicMaterial,oe=new PlaneGeometry(2,2),se=new Mesh(oe,ie),ae=new Scene$1;return ae.add(se),[ae,ie,ne]},[]);return reactExports.useCallback(({renderer:ne,texture:ie})=>{var oe;Z&&(Z.map!==ie&&((oe=Z.map)==null||oe.dispose(),Z.map=ie,Z.needsUpdate=!0),ne.setRenderTarget(null),ne.render(_,te))},[K])};async function grabFrame({renderer:K,quality:_}){const Z=K.getContext(),te=K.domElement.width,ne=K.domElement.height,ie=new Uint8Array(te*ne*4);return Z.readPixels(0,0,te,ne,Z.RGBA,Z.UNSIGNED_BYTE,ie),await(await K.domElement.convertToBlob({quality:_,type:"image/jpeg"})).arrayBuffer().then(oe=>new Uint8Array(oe))}function CameraView({_ref:K,_key:_,hide:Z,width:te=640,height:ne=480,matrix:ie,fov:oe=60,top:se=1,bottom:ae=-1,left:le=-1,right:ce=1,near:fe=.1,far:de=20,renderDepth:pe=!1,origin:he="top-left",distanceToCamera:ge=.5,ctype:me="perspective",showCamera:Ae=!0,scale:ye=10,showFrustum:ve=!0,stream:_e=null,fps:Te=30,downsample:be=2,quality:Re=1,monitor:we=!0,movable:Pe=!0,movableScale:Ie=1,children:$e=[],...Ue}){const ke=reactExports.useRef(null),Ge=reactExports.useRef(null),He=reactExports.useRef(null),ze=reactExports.useRef(null),Ke=reactExports.useMemo(()=>({sinceLastFrame:0}),[]),{size:tt,camera:Je,scene:ot}=useThree(),Fe=window.devicePixelRatio||1,ct=useFBO(te*Fe,ne*Fe,{depth:pe}),ht=reactExports.useMemo(()=>new Vector3,[]),{sendMsg:lt,downlink:Qe,uplink:Ze}=useSocket(),it=useControls(_?`Scene.Camera-${_}`:"Scene.Camera",{showCamera:{value:Ae,label:"Show"},camType:{value:me,options:["perspective","orthographic"]}},[Ae]),nt=useControls(_?`Scene.Camera-${_}`:"Scene.Camera",{near:{value:fe,min:.001,step:.05},far:{value:de,min:.1,step:.1},showImagePlane:{value:!0,label:"Image Plane"},scale:{value:ye,min:.1,step:.1},showFrustum:{value:ve,label:"Frustum"}},[fe,de,ve]),Tt=useControls(_?`Scene.Camera-${_}`:"Scene.Camera",it.camType==="perspective"?{fov:{value:oe,min:0,max:170},aspect:{value:te/ne,min:.1,max:10}}:{},[it.camType,oe,te,ne]),St=useControls(_?`Scene.Camera-${_}`:"Scene.Camera",it.camType==="orthographic"?{top:{value:se,min:-10,step:.1},bottom:{value:ae,min:-10,step:.1},left:{value:le,min:-10,step:.1},right:{value:ce,min:-10,step:.1}}:{},[it.camType,se,ae,le,ce]),Et=reactExports.useMemo(()=>{const bt=new WebGLRenderer({canvas:new OffscreenCanvas(te/be,ne/be),antialias:!1,precision:"highp",preserveDrawingBuffer:!0,depth:!0});return bt.autoClear=!1,bt.setPixelRatio(Fe),bt},[Fe,ne,te,be]);reactExports.useEffect(()=>{let bt;it.camType==="perspective"?bt=Tt.aspect:bt=(St.right-St.left)/(St.top-St.bottom),ke.current.aspect=bt,ke.current.updateProjectionMatrix(),Et.setSize(Math.floor(bt*ne/be),Math.floor(ne/be),!1),Et.setPixelRatio(Fe),ct.setSize(bt*ne*Fe,ne*Fe)},[Fe,ne,te,be,Tt.aspect,St.top,St.bottom,St.left,St.right,it.camType]),reactExports.useLayoutEffect(()=>{if(!ke.current||!ie||ie.length!==16)return;const bt=ke.current;bt.matrix.fromArray(ie),bt.matrix.decompose(bt.position,bt.quaternion,bt.scale),bt.rotation.setFromQuaternion(bt.quaternion);const Ot=Pe?ze==null?void 0:ze.current:He==null?void 0:He.current;Ot&&(Ot.matrix.fromArray(ie),Ot.matrix.decompose(Ot.position,Ot.quaternion,Ot.scale),Ot.rotation.setFromQuaternion(Ot.quaternion))},[ie,ke.current]);const Nt=reactExports.useCallback(()=>{if(!ze.current||!ke.current)return;const bt=ke.current,Ot=ze.current;bt.matrix.copy(Ot.matrix),bt.matrix.decompose(bt.position,bt.quaternion,bt.scale),bt.rotation.setFromQuaternion(bt.quaternion),lt({ts:Date.now(),etype:"CAMERA_MOVE",key:_,value:{matrix:bt.matrix.toArray()}})},[ze.current,ke.current,lt]),zt=reactExports.useRef({});useFrame(({gl:bt,scene:Ot},Mt)=>{if(Ke.sinceLastFrame+=Mt,!ke.current)return;let _t;if(it.camType==="perspective"?_t=Tt.aspect:_t=(St.right-St.left)/(St.top-St.bottom),Ke.sinceLastFrame>1/Te&&_e==="frame"){Ke.sinceLastFrame=0;const pt=Et.getContext(),ft=Et.domElement.width,st=Et.domElement.height;Ge!=null&&Ge.current&&(Ge.current.visible=!1),He!=null&&He.current&&(He.current.visible=!1),Et.render(Ot,ke.current);const vt=new Uint8Array(ft*st*4);pt.readPixels(0,0,ft,st,pt.RGBA,pt.UNSIGNED_BYTE,vt),Et.domElement.convertToBlob({quality:Re,type:"image/jpeg"}).then(Pt=>{Pt.arrayBuffer().then(Lt=>{const Vt={ts:Date.now(),etype:"CAMERA_VIEW",key:_,value:{dpr:Fe,delta:zt,width:te,height:ne,frame:new Uint8Array(Lt)}};lt(Vt)})})}if(we&&Ge!=null&&Ge.current){const pt=Ge.current;pt.visible=!1,He.current&&(He.current.visible=!1),bt.setRenderTarget(ct),bt.render(Ot,ke.current),bt.setRenderTarget(null),ct.texture.colorSpace=NoColorSpace$1,pt.visible=!0,He.current&&(He.current.visible=!0);const ft=tt.width/tt.height,st=new Vector3(0,0,-1).applyEuler(Je.rotation);let vt;switch(he){case"bottom-left":vt=[-1,-1];break;case"bottom-right":vt=[1,-1];break;case"top-left":vt=[-1,1];break;case"top-right":vt=[1,1];break}const Pt=Math.tan(Je.fov/360*Math.PI);ht.set(vt[0]*(1-_t*ne/tt.width)*ft*Pt,vt[1]*(1-ne/tt.height)*Pt,0).applyEuler(Je.rotation);const Lt=2*Pt*ge,Vt=_t*Lt,Le=ne/tt.height;pt.scale.set(Vt*Le,Lt*Le,1),pt.position.copy(Je.position).addScaledVector(st,ge),pt.lookAt(Je.position),pt.position.addScaledVector(ht,ge)}Ge!=null&&Ge.current&&(Ge.current.visible=!0),He!=null&&He.current&&(He.current.visible=!0)},1);const yt=useRender(),Ut=useDepthRender(!pe);return reactExports.useEffect(()=>{if(Qe&&_e==="ondemand")return Qe.subscribe("GRAB_RENDER",async({key:bt,rtype:Ot,data:{quality:Mt=1}})=>{if(!ke.current||bt!==_)return;Ge!=null&&Ge.current&&(Ge.current.visible=!1),He!=null&&He.current&&(He.current.visible=!1),Et.setRenderTarget(ct),Et.render(ot,ke.current);const _t={ts:Date.now(),etype:Ot||"GRAB_RENDER_RESPONSE",key:bt,value:{dpr:Fe,width:te,height:ne}};yt({renderer:Et,texture:ct.texture}),_t.value.frame=await grabFrame({renderer:Et,quality:Mt}),pe&&(Ut({renderer:Et,depthTexture:ct.depthTexture,near:fe,far:de}),_t.value.depthFrame=await grabFrame({renderer:Et,quality:Mt})),lt(_t)})},[lt,Qe,Ze,be,Et,Et.domElement,ct]),console.log("scale",ye),console.log("movalble",Ie),Z?null:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[it.showCamera&&!Pe?jsxRuntimeExports.jsx(Frustum,{_ref:He,...Tt,...nt,showFocalPlane:!1,...Ue,children:$e}):null,it.showCamera&&Pe?jsxRuntimeExports.jsxs(Movable,{_ref:ze,onMove:Nt,matrix:ie,scale:Ie,...Ue,children:[jsxRuntimeExports.jsx(Frustum,{_ref:He,scale:1/Ie,...Tt,...nt,showFocalPlane:!1}),$e]}):null,we?jsxRuntimeExports.jsx(Plane$1,{ref:Ge,args:[1,1,te,ne],renderOrder:1,children:jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",map:ct.texture})},"rgb"):null,it.camType==="perspective"?jsxRuntimeExports.jsx(PerspectiveCamera,{ref:ke,near:nt.near,far:nt.far,...Tt,...Ue}):null,it.camType==="orthographic"?jsxRuntimeExports.jsx(OrthographicCamera,{ref:ke,near:nt.near,far:nt.far,...St,...Ue}):null]})}function AmbientLight({_key:K,children:_,hide:Z=!1,intensity:te=.5,color:ne="#ffffff",levaPrefix:ie="Scene.AmbientLight",...oe}){const se=reactExports.useRef(null),ae=K?`${ie}-[${K}]`:ie;return useControls(ae,{intensity:{value:te,step:.05},color:{value:ne},hide:{value:Z}},{collapsed:!0}).hide?null:jsxRuntimeExports.jsx("ambientLight",{ref:se,args:[ne,te],...oe},K)}function RectAreaLight({_key:K,helper:_=!1,children:Z,hide:te=!1,color:ne="#ffffff",intensity:ie=1,width:oe=1,height:se=1,levaPrefix:ae="Scene.AreaLight",lookAt:le=[0,0,0],...ce}){const fe=reactExports.useRef(null),de=K?`${ae}-[${K}]`:ae,{color:pe,intensity:he,...ge}=useControls(de,{useHelper:{value:_,label:"Show Helper"},intensity:{value:ie,step:.05},color:{value:ne},hide:{value:te}},{collapsed:!0});return reactExports.useLayoutEffect(()=>{var me;(me=fe.current)==null||me.lookAt(new Vector3(...le))},[le]),ge.hide?null:jsxRuntimeExports.jsx("rectAreaLight",{ref:fe,args:[pe,he,oe,se],...ge,...ce},K)}function HemisphereLight({_key:K,children:_,hide:Z=!1,intensity:te=1,color:ne="#ffffff",levaPrefix:ie="Scene.HemisphereLight",helper:oe=!1,...se}){const ae=reactExports.useRef(null),le=K?`${ie}-[${K}]`:ie,ce=useControls(le,{useHelper:{value:oe,label:"Show Helper"},intensity:{value:te,step:.05},color:{value:ne},hide:{value:Z}},{collapsed:!0});return useHelper(ce.useHelper?ae:null,HemisphereLightHelper,1,"red"),ce.hide?null:jsxRuntimeExports.jsx("hemisphereLight",{ref:ae,...ce,...se},K)}function DirectionalLight({_key:K,children:_,hide:Z=!1,intensity:te=.5,color:ne="#ffffff",levaPrefix:ie="Scene.DirectionalLight",helper:oe=!1,...se}){const ae=reactExports.useRef(null),le=K?`${ie}-[${K}]`:ie,ce=useControls(le,{useHelper:{value:oe,label:"Show Helper"},intensity:{value:te,step:.05},color:{value:ne},hide:{value:Z}},{collapsed:!0});return useHelper(ce.useHelper?ae:null,DirectionalLightHelper,1,"red"),ce.hide?null:jsxRuntimeExports.jsx("directionalLight",{ref:ae,"shadow-bias":se["shadow-bias"]||-.01,...ce,...se},K)}function SpotLight({_key:K,children:_,hide:Z=!1,intensity:te=.5,color:ne="#ffffff",levaPrefix:ie="Scene.SpotLight",helper:oe=!1,...se}){const ae=reactExports.useRef(null),le=K?`${ie}-[${K}]`:ie,ce=useControls(le,{useHelper:{value:oe,label:"Show Helper"},intensity:{value:te,step:.05},color:{value:ne},hide:{value:Z}},{collapsed:!0});return useHelper(ce.useHelper?ae:null,SpotLightHelper,"red"),ce.hide?null:jsxRuntimeExports.jsx("spotLight",{ref:ae,"shadow-bias":se["shadow-bias"]||-.01,...ce,...se},K)}function PointLight({_key:K,children:_,hide:Z=!1,intensity:te=20,color:ne="#ffffff",levaPrefix:ie="Scene.PointLight",helper:oe=!1,showSphere:se=!1,radius:ae=.1,...le}){const ce=reactExports.useRef(null),fe=K?`${ie}-[${K}]`:ie,de=useControls(fe,{useHelper:{value:oe,label:"Show Helper"},intensity:{value:te,step:.05},color:{value:ne},hide:{value:Z}},{collapsed:!0});return useHelper(de.useHelper?ce:null,PointLightHelper,1,"red"),de.hide?null:jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsx("pointLight",{ref:ce,"shadow-bias":le["shadow-bias"]||-.01,...de,...le},K),se&&jsxRuntimeExports.jsx(Sphere$1,{args:[ae,32,32],position:le.position})]})}function AmbientLightStage({...K}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DirectionalLight,{castShadow:!0,intensity:1,position:[5,30,5],"shadow-mapSize":[1024,1024]}),jsxRuntimeExports.jsx(AmbientLight,{intensity:.2,color:"#ffffff"})]})}function HemisphereLightStage({}){return useRenderMode(({mode:K})=>K)==="pathtracer"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AmbientLight,{_key:"light-default-ambient",intensity:.5}),jsxRuntimeExports.jsx(PBRAreaLight,{_key:"light-default-area",castShadow:!0,intensity:1.4,width:.2,height:.3,position:[0,4,0],rotation:[Math.PI/2,0,0]}),jsxRuntimeExports.jsx(PBRSpotLight,{castShadow:!0,position:[4,4,4],color:"#ffffff",intensity:.2,angle:Math.PI/4.5,distance:0,penumbra:1,decay:.02})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(HemisphereLight,{_key:"light-default-hemi",groundColor:"#000",intensity:1,position:[0,1,0]}),jsxRuntimeExports.jsx(DirectionalLight,{_key:"light-default-directional",color:"#fff",intensity:1,position:[4,10,1],castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048})]})}const THIS_IS_NOT_AN_OBJECT="This is not an object",THIS_IS_NOT_A_FLOAT16ARRAY_OBJECT="This is not a Float16Array object",THIS_CONSTRUCTOR_IS_NOT_A_SUBCLASS_OF_FLOAT16ARRAY="This constructor is not a subclass of Float16Array",THE_CONSTRUCTOR_PROPERTY_VALUE_IS_NOT_AN_OBJECT="The constructor property value is not an object",SPECIES_CONSTRUCTOR_DIDNT_RETURN_TYPEDARRAY_OBJECT="Species constructor didn't return TypedArray object",DERIVED_CONSTRUCTOR_CREATED_TYPEDARRAY_OBJECT_WHICH_WAS_TOO_SMALL_LENGTH="Derived constructor created TypedArray object which was too small length",ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER="Attempting to access detached ArrayBuffer",CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT="Cannot convert undefined or null to object",CANNOT_MIX_BIGINT_AND_OTHER_TYPES="Cannot mix BigInt and other types, use explicit conversions",ITERATOR_PROPERTY_IS_NOT_CALLABLE="@@iterator property is not callable",REDUCE_OF_EMPTY_ARRAY_WITH_NO_INITIAL_VALUE="Reduce of empty array with no initial value",THE_COMPARISON_FUNCTION_MUST_BE_EITHER_A_FUNCTION_OR_UNDEFINED="The comparison function must be either a function or undefined",OFFSET_IS_OUT_OF_BOUNDS="Offset is out of bounds";function uncurryThis(K){return(_,...Z)=>ReflectApply(K,_,Z)}function uncurryThisGetter(K,_){return uncurryThis(ReflectGetOwnPropertyDescriptor(K,_).get)}const{apply:ReflectApply,construct:ReflectConstruct,defineProperty:ReflectDefineProperty,get:ReflectGet,getOwnPropertyDescriptor:ReflectGetOwnPropertyDescriptor,getPrototypeOf:ReflectGetPrototypeOf,has:ReflectHas,ownKeys:ReflectOwnKeys,set:ReflectSet,setPrototypeOf:ReflectSetPrototypeOf}=Reflect,NativeProxy=Proxy,{EPSILON,MAX_SAFE_INTEGER,isFinite:NumberIsFinite,isNaN:NumberIsNaN}=Number,{iterator:SymbolIterator,species:SymbolSpecies,toStringTag:SymbolToStringTag,for:SymbolFor}=Symbol,NativeObject=Object,{create:ObjectCreate,defineProperty:ObjectDefineProperty,freeze:ObjectFreeze,is:ObjectIs}=NativeObject,ObjectPrototype=NativeObject.prototype,ObjectPrototype__lookupGetter__=ObjectPrototype.__lookupGetter__?uncurryThis(ObjectPrototype.__lookupGetter__):(K,_)=>{if(K==null)throw NativeTypeError(CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT);let Z=NativeObject(K);do{const te=ReflectGetOwnPropertyDescriptor(Z,_);if(te!==void 0)return ObjectHasOwn(te,"get")?te.get:void 0}while((Z=ReflectGetPrototypeOf(Z))!==null)},ObjectHasOwn=NativeObject.hasOwn||uncurryThis(ObjectPrototype.hasOwnProperty),NativeArray=Array,ArrayIsArray=NativeArray.isArray,ArrayPrototype=NativeArray.prototype,ArrayPrototypeJoin=uncurryThis(ArrayPrototype.join),ArrayPrototypePush=uncurryThis(ArrayPrototype.push),ArrayPrototypeToLocaleString=uncurryThis(ArrayPrototype.toLocaleString),NativeArrayPrototypeSymbolIterator=ArrayPrototype[SymbolIterator],ArrayPrototypeSymbolIterator=uncurryThis(NativeArrayPrototypeSymbolIterator),{abs:MathAbs,trunc:MathTrunc}=Math,NativeArrayBuffer=ArrayBuffer,ArrayBufferIsView=NativeArrayBuffer.isView,ArrayBufferPrototype=NativeArrayBuffer.prototype,ArrayBufferPrototypeSlice=uncurryThis(ArrayBufferPrototype.slice),ArrayBufferPrototypeGetByteLength=uncurryThisGetter(ArrayBufferPrototype,"byteLength"),NativeSharedArrayBuffer=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null,SharedArrayBufferPrototypeGetByteLength=NativeSharedArrayBuffer&&uncurryThisGetter(NativeSharedArrayBuffer.prototype,"byteLength"),TypedArray=ReflectGetPrototypeOf(Uint8Array),TypedArrayFrom=TypedArray.from,TypedArrayPrototype=TypedArray.prototype,NativeTypedArrayPrototypeSymbolIterator=TypedArrayPrototype[SymbolIterator],TypedArrayPrototypeKeys=uncurryThis(TypedArrayPrototype.keys),TypedArrayPrototypeValues=uncurryThis(TypedArrayPrototype.values),TypedArrayPrototypeEntries=uncurryThis(TypedArrayPrototype.entries),TypedArrayPrototypeSet=uncurryThis(TypedArrayPrototype.set),TypedArrayPrototypeReverse=uncurryThis(TypedArrayPrototype.reverse),TypedArrayPrototypeFill=uncurryThis(TypedArrayPrototype.fill),TypedArrayPrototypeCopyWithin=uncurryThis(TypedArrayPrototype.copyWithin),TypedArrayPrototypeSort=uncurryThis(TypedArrayPrototype.sort),TypedArrayPrototypeSlice=uncurryThis(TypedArrayPrototype.slice),TypedArrayPrototypeSubarray=uncurryThis(TypedArrayPrototype.subarray),TypedArrayPrototypeGetBuffer=uncurryThisGetter(TypedArrayPrototype,"buffer"),TypedArrayPrototypeGetByteOffset=uncurryThisGetter(TypedArrayPrototype,"byteOffset"),TypedArrayPrototypeGetLength=uncurryThisGetter(TypedArrayPrototype,"length"),TypedArrayPrototypeGetSymbolToStringTag=uncurryThisGetter(TypedArrayPrototype,SymbolToStringTag),NativeUint8Array=Uint8Array,NativeUint16Array=Uint16Array,Uint16ArrayFrom=(...K)=>ReflectApply(TypedArrayFrom,NativeUint16Array,K),NativeUint32Array=Uint32Array,NativeFloat32Array=Float32Array,ArrayIteratorPrototype=ReflectGetPrototypeOf([][SymbolIterator]()),ArrayIteratorPrototypeNext=uncurryThis(ArrayIteratorPrototype.next),GeneratorPrototypeNext=uncurryThis(function*(){}().next),IteratorPrototype=ReflectGetPrototypeOf(ArrayIteratorPrototype),NativeTypeError=TypeError,NativeRangeError=RangeError,NativeWeakSet=WeakSet,WeakSetPrototype=NativeWeakSet.prototype,WeakSetPrototypeAdd=uncurryThis(WeakSetPrototype.add),WeakSetPrototypeHas=uncurryThis(WeakSetPrototype.has),NativeWeakMap=WeakMap,WeakMapPrototype=NativeWeakMap.prototype,WeakMapPrototypeGet=uncurryThis(WeakMapPrototype.get),WeakMapPrototypeHas=uncurryThis(WeakMapPrototype.has),WeakMapPrototypeSet=uncurryThis(WeakMapPrototype.set),arrayIterators=new NativeWeakMap,SafeIteratorPrototype=ObjectCreate(null,{next:{value:function K(){const _=WeakMapPrototypeGet(arrayIterators,this);return ArrayIteratorPrototypeNext(_)}},[SymbolIterator]:{value:function K(){return this}}});function safeIfNeeded(K){if(K[SymbolIterator]===NativeArrayPrototypeSymbolIterator&&ArrayIteratorPrototype.next===ArrayIteratorPrototypeNext)return K;const _=ObjectCreate(SafeIteratorPrototype);return WeakMapPrototypeSet(arrayIterators,_,ArrayPrototypeSymbolIterator(K)),_}const generators=new NativeWeakMap,DummyArrayIteratorPrototype=ObjectCreate(IteratorPrototype,{next:{value:function K(){const _=WeakMapPrototypeGet(generators,this);return GeneratorPrototypeNext(_)},writable:!0,configurable:!0}});for(const K of ReflectOwnKeys(ArrayIteratorPrototype))K!=="next"&&ObjectDefineProperty(DummyArrayIteratorPrototype,K,ReflectGetOwnPropertyDescriptor(ArrayIteratorPrototype,K));function wrap$8(K){const _=ObjectCreate(DummyArrayIteratorPrototype);return WeakMapPrototypeSet(generators,_,K),_}function isObject(K){return K!==null&&typeof K=="object"||typeof K=="function"}function isObjectLike(K){return K!==null&&typeof K=="object"}function isNativeTypedArray(K){return TypedArrayPrototypeGetSymbolToStringTag(K)!==void 0}function isNativeBigIntTypedArray(K){const _=TypedArrayPrototypeGetSymbolToStringTag(K);return _==="BigInt64Array"||_==="BigUint64Array"}function isArrayBuffer(K){try{return ArrayIsArray(K)?!1:(ArrayBufferPrototypeGetByteLength(K),!0)}catch{return!1}}function isSharedArrayBuffer(K){if(NativeSharedArrayBuffer===null)return!1;try{return SharedArrayBufferPrototypeGetByteLength(K),!0}catch{return!1}}function isAnyArrayBuffer(K){return isArrayBuffer(K)||isSharedArrayBuffer(K)}function isOrdinaryArray(K){return ArrayIsArray(K)?K[SymbolIterator]===NativeArrayPrototypeSymbolIterator&&ArrayIteratorPrototype.next===ArrayIteratorPrototypeNext:!1}function isOrdinaryNativeTypedArray(K){return isNativeTypedArray(K)?K[SymbolIterator]===NativeTypedArrayPrototypeSymbolIterator&&ArrayIteratorPrototype.next===ArrayIteratorPrototypeNext:!1}function isCanonicalIntegerIndexString(K){if(typeof K!="string")return!1;const _=+K;return K!==_+""||!NumberIsFinite(_)?!1:_===MathTrunc(_)}const brand=SymbolFor("__Float16Array__");function hasFloat16ArrayBrand(K){if(!isObjectLike(K))return!1;const _=ReflectGetPrototypeOf(K);if(!isObjectLike(_))return!1;const Z=_.constructor;if(Z===void 0)return!1;if(!isObject(Z))throw NativeTypeError(THE_CONSTRUCTOR_PROPERTY_VALUE_IS_NOT_AN_OBJECT);return ReflectHas(Z,brand)}const INVERSE_OF_EPSILON=1/EPSILON;function roundTiesToEven(K){return K+INVERSE_OF_EPSILON-INVERSE_OF_EPSILON}const FLOAT16_MIN_VALUE=6103515625e-14,FLOAT16_MAX_VALUE=65504,FLOAT16_EPSILON=.0009765625,FLOAT16_EPSILON_MULTIPLIED_BY_FLOAT16_MIN_VALUE=FLOAT16_EPSILON*FLOAT16_MIN_VALUE,FLOAT16_EPSILON_DEVIDED_BY_EPSILON=FLOAT16_EPSILON*INVERSE_OF_EPSILON;function roundToFloat16(K){const _=+K;if(!NumberIsFinite(_)||_===0)return _;const Z=_>0?1:-1,te=MathAbs(_);if(te<FLOAT16_MIN_VALUE)return Z*roundTiesToEven(te/FLOAT16_EPSILON_MULTIPLIED_BY_FLOAT16_MIN_VALUE)*FLOAT16_EPSILON_MULTIPLIED_BY_FLOAT16_MIN_VALUE;const ne=(1+FLOAT16_EPSILON_DEVIDED_BY_EPSILON)*te,ie=ne-(ne-te);return ie>FLOAT16_MAX_VALUE||NumberIsNaN(ie)?Z*(1/0):Z*ie}const buffer$2=new NativeArrayBuffer(4),floatView=new NativeFloat32Array(buffer$2),uint32View=new NativeUint32Array(buffer$2),baseTable=new NativeUint16Array(512),shiftTable=new NativeUint8Array(512);for(let K=0;K<256;++K){const _=K-127;_<-24?(baseTable[K]=0,baseTable[K|256]=32768,shiftTable[K]=24,shiftTable[K|256]=24):_<-14?(baseTable[K]=1024>>-_-14,baseTable[K|256]=1024>>-_-14|32768,shiftTable[K]=-_-1,shiftTable[K|256]=-_-1):_<=15?(baseTable[K]=_+15<<10,baseTable[K|256]=_+15<<10|32768,shiftTable[K]=13,shiftTable[K|256]=13):_<128?(baseTable[K]=31744,baseTable[K|256]=64512,shiftTable[K]=24,shiftTable[K|256]=24):(baseTable[K]=31744,baseTable[K|256]=64512,shiftTable[K]=13,shiftTable[K|256]=13)}function roundToFloat16Bits(K){floatView[0]=roundToFloat16(K);const _=uint32View[0],Z=_>>23&511;return baseTable[Z]+((_&8388607)>>shiftTable[Z])}const mantissaTable=new NativeUint32Array(2048);for(let K=1;K<1024;++K){let _=K<<13,Z=0;for(;!(_&8388608);)_<<=1,Z-=8388608;_&=-8388609,Z+=947912704,mantissaTable[K]=_|Z}for(let K=1024;K<2048;++K)mantissaTable[K]=939524096+(K-1024<<13);const exponentTable=new NativeUint32Array(64);for(let K=1;K<31;++K)exponentTable[K]=K<<23;exponentTable[31]=1199570944;exponentTable[32]=2147483648;for(let K=33;K<63;++K)exponentTable[K]=2147483648+(K-32<<23);exponentTable[63]=3347054592;const offsetTable=new NativeUint16Array(64);for(let K=1;K<64;++K)K!==32&&(offsetTable[K]=1024);function convertToNumber(K){const _=K>>10;return uint32View[0]=mantissaTable[offsetTable[_]+(K&1023)]+exponentTable[_],floatView[0]}function ToIntegerOrInfinity(K){const _=+K;return NumberIsNaN(_)||_===0?0:MathTrunc(_)}function ToLength(K){const _=ToIntegerOrInfinity(K);return _<0?0:_<MAX_SAFE_INTEGER?_:MAX_SAFE_INTEGER}function SpeciesConstructor(K,_){if(!isObject(K))throw NativeTypeError(THIS_IS_NOT_AN_OBJECT);const Z=K.constructor;if(Z===void 0)return _;if(!isObject(Z))throw NativeTypeError(THE_CONSTRUCTOR_PROPERTY_VALUE_IS_NOT_AN_OBJECT);return Z[SymbolSpecies]??_}function IsDetachedBuffer(K){if(isSharedArrayBuffer(K))return!1;try{return ArrayBufferPrototypeSlice(K,0,0),!1}catch{}return!0}function defaultCompare(K,_){const Z=NumberIsNaN(K),te=NumberIsNaN(_);if(Z&&te)return 0;if(Z)return 1;if(te||K<_)return-1;if(K>_)return 1;if(K===0&&_===0){const ne=ObjectIs(K,0),ie=ObjectIs(_,0);if(!ne&&ie)return-1;if(ne&&!ie)return 1}return 0}const BYTES_PER_ELEMENT=2,float16bitsArrays=new NativeWeakMap;function isFloat16Array(K){return WeakMapPrototypeHas(float16bitsArrays,K)||!ArrayBufferIsView(K)&&hasFloat16ArrayBrand(K)}function assertFloat16Array(K){if(!isFloat16Array(K))throw NativeTypeError(THIS_IS_NOT_A_FLOAT16ARRAY_OBJECT)}function assertSpeciesTypedArray(K,_){const Z=isFloat16Array(K),te=isNativeTypedArray(K);if(!Z&&!te)throw NativeTypeError(SPECIES_CONSTRUCTOR_DIDNT_RETURN_TYPEDARRAY_OBJECT);if(typeof _=="number"){let ne;if(Z){const ie=getFloat16BitsArray(K);ne=TypedArrayPrototypeGetLength(ie)}else ne=TypedArrayPrototypeGetLength(K);if(ne<_)throw NativeTypeError(DERIVED_CONSTRUCTOR_CREATED_TYPEDARRAY_OBJECT_WHICH_WAS_TOO_SMALL_LENGTH)}if(isNativeBigIntTypedArray(K))throw NativeTypeError(CANNOT_MIX_BIGINT_AND_OTHER_TYPES)}function getFloat16BitsArray(K){const _=WeakMapPrototypeGet(float16bitsArrays,K);if(_!==void 0){const ne=TypedArrayPrototypeGetBuffer(_);if(IsDetachedBuffer(ne))throw NativeTypeError(ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);return _}const Z=K.buffer;if(IsDetachedBuffer(Z))throw NativeTypeError(ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);const te=ReflectConstruct(Float16Array,[Z,K.byteOffset,K.length],K.constructor);return WeakMapPrototypeGet(float16bitsArrays,te)}function copyToArray(K){const _=TypedArrayPrototypeGetLength(K),Z=[];for(let te=0;te<_;++te)Z[te]=convertToNumber(K[te]);return Z}const TypedArrayPrototypeGetters=new NativeWeakSet;for(const K of ReflectOwnKeys(TypedArrayPrototype)){if(K===SymbolToStringTag)continue;const _=ReflectGetOwnPropertyDescriptor(TypedArrayPrototype,K);ObjectHasOwn(_,"get")&&typeof _.get=="function"&&WeakSetPrototypeAdd(TypedArrayPrototypeGetters,_.get)}const handler=ObjectFreeze({get(K,_,Z){return isCanonicalIntegerIndexString(_)&&ObjectHasOwn(K,_)?convertToNumber(ReflectGet(K,_)):WeakSetPrototypeHas(TypedArrayPrototypeGetters,ObjectPrototype__lookupGetter__(K,_))?ReflectGet(K,_):ReflectGet(K,_,Z)},set(K,_,Z,te){return isCanonicalIntegerIndexString(_)&&ObjectHasOwn(K,_)?ReflectSet(K,_,roundToFloat16Bits(Z)):ReflectSet(K,_,Z,te)},getOwnPropertyDescriptor(K,_){if(isCanonicalIntegerIndexString(_)&&ObjectHasOwn(K,_)){const Z=ReflectGetOwnPropertyDescriptor(K,_);return Z.value=convertToNumber(Z.value),Z}return ReflectGetOwnPropertyDescriptor(K,_)},defineProperty(K,_,Z){return isCanonicalIntegerIndexString(_)&&ObjectHasOwn(K,_)&&ObjectHasOwn(Z,"value")&&(Z.value=roundToFloat16Bits(Z.value)),ReflectDefineProperty(K,_,Z)}});class Float16Array{constructor(_,Z,te){let ne;if(isFloat16Array(_))ne=ReflectConstruct(NativeUint16Array,[getFloat16BitsArray(_)],new.target);else if(isObject(_)&&!isAnyArrayBuffer(_)){let oe,se;if(isNativeTypedArray(_)){oe=_,se=TypedArrayPrototypeGetLength(_);const ae=TypedArrayPrototypeGetBuffer(_);if(IsDetachedBuffer(ae))throw NativeTypeError(ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);if(isNativeBigIntTypedArray(_))throw NativeTypeError(CANNOT_MIX_BIGINT_AND_OTHER_TYPES);const le=new NativeArrayBuffer(se*BYTES_PER_ELEMENT);ne=ReflectConstruct(NativeUint16Array,[le],new.target)}else{const ae=_[SymbolIterator];if(ae!=null&&typeof ae!="function")throw NativeTypeError(ITERATOR_PROPERTY_IS_NOT_CALLABLE);ae!=null?isOrdinaryArray(_)?(oe=_,se=_.length):(oe=[..._],se=oe.length):(oe=_,se=ToLength(oe.length)),ne=ReflectConstruct(NativeUint16Array,[se],new.target)}for(let ae=0;ae<se;++ae)ne[ae]=roundToFloat16Bits(oe[ae])}else ne=ReflectConstruct(NativeUint16Array,arguments,new.target);const ie=new NativeProxy(ne,handler);return WeakMapPrototypeSet(float16bitsArrays,ie,ne),ie}static from(_,...Z){const te=this;if(!ReflectHas(te,brand))throw NativeTypeError(THIS_CONSTRUCTOR_IS_NOT_A_SUBCLASS_OF_FLOAT16ARRAY);if(te===Float16Array){if(isFloat16Array(_)&&Z.length===0){const ce=getFloat16BitsArray(_),fe=new NativeUint16Array(TypedArrayPrototypeGetBuffer(ce),TypedArrayPrototypeGetByteOffset(ce),TypedArrayPrototypeGetLength(ce));return new Float16Array(TypedArrayPrototypeGetBuffer(TypedArrayPrototypeSlice(fe)))}if(Z.length===0)return new Float16Array(TypedArrayPrototypeGetBuffer(Uint16ArrayFrom(_,roundToFloat16Bits)));const ae=Z[0],le=Z[1];return new Float16Array(TypedArrayPrototypeGetBuffer(Uint16ArrayFrom(_,function(ce,...fe){return roundToFloat16Bits(ReflectApply(ae,this,[ce,...safeIfNeeded(fe)]))},le)))}let ne,ie;const oe=_[SymbolIterator];if(oe!=null&&typeof oe!="function")throw NativeTypeError(ITERATOR_PROPERTY_IS_NOT_CALLABLE);if(oe!=null)isOrdinaryArray(_)?(ne=_,ie=_.length):isOrdinaryNativeTypedArray(_)?(ne=_,ie=TypedArrayPrototypeGetLength(_)):(ne=[..._],ie=ne.length);else{if(_==null)throw NativeTypeError(CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT);ne=NativeObject(_),ie=ToLength(ne.length)}const se=new te(ie);if(Z.length===0)for(let ae=0;ae<ie;++ae)se[ae]=ne[ae];else{const ae=Z[0],le=Z[1];for(let ce=0;ce<ie;++ce)se[ce]=ReflectApply(ae,le,[ne[ce],ce])}return se}static of(..._){const Z=this;if(!ReflectHas(Z,brand))throw NativeTypeError(THIS_CONSTRUCTOR_IS_NOT_A_SUBCLASS_OF_FLOAT16ARRAY);const te=_.length;if(Z===Float16Array){const ie=new Float16Array(te),oe=getFloat16BitsArray(ie);for(let se=0;se<te;++se)oe[se]=roundToFloat16Bits(_[se]);return ie}const ne=new Z(te);for(let ie=0;ie<te;++ie)ne[ie]=_[ie];return ne}keys(){assertFloat16Array(this);const _=getFloat16BitsArray(this);return TypedArrayPrototypeKeys(_)}values(){assertFloat16Array(this);const _=getFloat16BitsArray(this);return wrap$8(function*(){for(const Z of TypedArrayPrototypeValues(_))yield convertToNumber(Z)}())}entries(){assertFloat16Array(this);const _=getFloat16BitsArray(this);return wrap$8(function*(){for(const[Z,te]of TypedArrayPrototypeEntries(_))yield[Z,convertToNumber(te)]}())}at(_){assertFloat16Array(this);const Z=getFloat16BitsArray(this),te=TypedArrayPrototypeGetLength(Z),ne=ToIntegerOrInfinity(_),ie=ne>=0?ne:te+ne;if(!(ie<0||ie>=te))return convertToNumber(Z[ie])}with(_,Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=ToIntegerOrInfinity(_),oe=ie>=0?ie:ne+ie,se=+Z;if(oe<0||oe>=ne)throw NativeRangeError(OFFSET_IS_OUT_OF_BOUNDS);const ae=new NativeUint16Array(TypedArrayPrototypeGetBuffer(te),TypedArrayPrototypeGetByteOffset(te),TypedArrayPrototypeGetLength(te)),le=new Float16Array(TypedArrayPrototypeGetBuffer(TypedArrayPrototypeSlice(ae))),ce=getFloat16BitsArray(le);return ce[oe]=roundToFloat16Bits(se),le}map(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0],oe=SpeciesConstructor(te,Float16Array);if(oe===Float16Array){const ae=new Float16Array(ne),le=getFloat16BitsArray(ae);for(let ce=0;ce<ne;++ce){const fe=convertToNumber(te[ce]);le[ce]=roundToFloat16Bits(ReflectApply(_,ie,[fe,ce,this]))}return ae}const se=new oe(ne);assertSpeciesTypedArray(se,ne);for(let ae=0;ae<ne;++ae){const le=convertToNumber(te[ae]);se[ae]=ReflectApply(_,ie,[le,ae,this])}return se}filter(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0],oe=[];for(let le=0;le<ne;++le){const ce=convertToNumber(te[le]);ReflectApply(_,ie,[ce,le,this])&&ArrayPrototypePush(oe,ce)}const se=SpeciesConstructor(te,Float16Array),ae=new se(oe);return assertSpeciesTypedArray(ae),ae}reduce(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te);if(ne===0&&Z.length===0)throw NativeTypeError(REDUCE_OF_EMPTY_ARRAY_WITH_NO_INITIAL_VALUE);let ie,oe;Z.length===0?(ie=convertToNumber(te[0]),oe=1):(ie=Z[0],oe=0);for(let se=oe;se<ne;++se)ie=_(ie,convertToNumber(te[se]),se,this);return ie}reduceRight(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te);if(ne===0&&Z.length===0)throw NativeTypeError(REDUCE_OF_EMPTY_ARRAY_WITH_NO_INITIAL_VALUE);let ie,oe;Z.length===0?(ie=convertToNumber(te[ne-1]),oe=ne-2):(ie=Z[0],oe=ne-1);for(let se=oe;se>=0;--se)ie=_(ie,convertToNumber(te[se]),se,this);return ie}forEach(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0];for(let oe=0;oe<ne;++oe)ReflectApply(_,ie,[convertToNumber(te[oe]),oe,this])}find(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0];for(let oe=0;oe<ne;++oe){const se=convertToNumber(te[oe]);if(ReflectApply(_,ie,[se,oe,this]))return se}}findIndex(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0];for(let oe=0;oe<ne;++oe){const se=convertToNumber(te[oe]);if(ReflectApply(_,ie,[se,oe,this]))return oe}return-1}findLast(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0];for(let oe=ne-1;oe>=0;--oe){const se=convertToNumber(te[oe]);if(ReflectApply(_,ie,[se,oe,this]))return se}}findLastIndex(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0];for(let oe=ne-1;oe>=0;--oe){const se=convertToNumber(te[oe]);if(ReflectApply(_,ie,[se,oe,this]))return oe}return-1}every(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0];for(let oe=0;oe<ne;++oe)if(!ReflectApply(_,ie,[convertToNumber(te[oe]),oe,this]))return!1;return!0}some(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te),ie=Z[0];for(let oe=0;oe<ne;++oe)if(ReflectApply(_,ie,[convertToNumber(te[oe]),oe,this]))return!0;return!1}set(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=ToIntegerOrInfinity(Z[0]);if(ne<0)throw NativeRangeError(OFFSET_IS_OUT_OF_BOUNDS);if(_==null)throw NativeTypeError(CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT);if(isNativeBigIntTypedArray(_))throw NativeTypeError(CANNOT_MIX_BIGINT_AND_OTHER_TYPES);if(isFloat16Array(_))return TypedArrayPrototypeSet(getFloat16BitsArray(this),getFloat16BitsArray(_),ne);if(isNativeTypedArray(_)){const ae=TypedArrayPrototypeGetBuffer(_);if(IsDetachedBuffer(ae))throw NativeTypeError(ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER)}const ie=TypedArrayPrototypeGetLength(te),oe=NativeObject(_),se=ToLength(oe.length);if(ne===1/0||se+ne>ie)throw NativeRangeError(OFFSET_IS_OUT_OF_BOUNDS);for(let ae=0;ae<se;++ae)te[ae+ne]=roundToFloat16Bits(oe[ae])}reverse(){assertFloat16Array(this);const _=getFloat16BitsArray(this);return TypedArrayPrototypeReverse(_),this}toReversed(){assertFloat16Array(this);const _=getFloat16BitsArray(this),Z=new NativeUint16Array(TypedArrayPrototypeGetBuffer(_),TypedArrayPrototypeGetByteOffset(_),TypedArrayPrototypeGetLength(_)),te=new Float16Array(TypedArrayPrototypeGetBuffer(TypedArrayPrototypeSlice(Z))),ne=getFloat16BitsArray(te);return TypedArrayPrototypeReverse(ne),te}fill(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this);return TypedArrayPrototypeFill(te,roundToFloat16Bits(_),...safeIfNeeded(Z)),this}copyWithin(_,Z,...te){assertFloat16Array(this);const ne=getFloat16BitsArray(this);return TypedArrayPrototypeCopyWithin(ne,_,Z,...safeIfNeeded(te)),this}sort(_){assertFloat16Array(this);const Z=getFloat16BitsArray(this),te=_!==void 0?_:defaultCompare;return TypedArrayPrototypeSort(Z,(ne,ie)=>te(convertToNumber(ne),convertToNumber(ie))),this}toSorted(_){assertFloat16Array(this);const Z=getFloat16BitsArray(this);if(_!==void 0&&typeof _!="function")throw new NativeTypeError(THE_COMPARISON_FUNCTION_MUST_BE_EITHER_A_FUNCTION_OR_UNDEFINED);const te=_!==void 0?_:defaultCompare,ne=new NativeUint16Array(TypedArrayPrototypeGetBuffer(Z),TypedArrayPrototypeGetByteOffset(Z),TypedArrayPrototypeGetLength(Z)),ie=new Float16Array(TypedArrayPrototypeGetBuffer(TypedArrayPrototypeSlice(ne))),oe=getFloat16BitsArray(ie);return TypedArrayPrototypeSort(oe,(se,ae)=>te(convertToNumber(se),convertToNumber(ae))),ie}slice(_,Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=SpeciesConstructor(te,Float16Array);if(ne===Float16Array){const he=new NativeUint16Array(TypedArrayPrototypeGetBuffer(te),TypedArrayPrototypeGetByteOffset(te),TypedArrayPrototypeGetLength(te));return new Float16Array(TypedArrayPrototypeGetBuffer(TypedArrayPrototypeSlice(he,_,Z)))}const ie=TypedArrayPrototypeGetLength(te),oe=ToIntegerOrInfinity(_),se=Z===void 0?ie:ToIntegerOrInfinity(Z);let ae;oe===-1/0?ae=0:oe<0?ae=ie+oe>0?ie+oe:0:ae=ie<oe?ie:oe;let le;se===-1/0?le=0:se<0?le=ie+se>0?ie+se:0:le=ie<se?ie:se;const ce=le-ae>0?le-ae:0,fe=new ne(ce);if(assertSpeciesTypedArray(fe,ce),ce===0)return fe;const de=TypedArrayPrototypeGetBuffer(te);if(IsDetachedBuffer(de))throw NativeTypeError(ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);let pe=0;for(;ae<le;)fe[pe]=convertToNumber(te[ae]),++ae,++pe;return fe}subarray(_,Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=SpeciesConstructor(te,Float16Array),ie=new NativeUint16Array(TypedArrayPrototypeGetBuffer(te),TypedArrayPrototypeGetByteOffset(te),TypedArrayPrototypeGetLength(te)),oe=TypedArrayPrototypeSubarray(ie,_,Z),se=new ne(TypedArrayPrototypeGetBuffer(oe),TypedArrayPrototypeGetByteOffset(oe),TypedArrayPrototypeGetLength(oe));return assertSpeciesTypedArray(se),se}indexOf(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te);let ie=ToIntegerOrInfinity(Z[0]);if(ie===1/0)return-1;ie<0&&(ie+=ne,ie<0&&(ie=0));for(let oe=ie;oe<ne;++oe)if(ObjectHasOwn(te,oe)&&convertToNumber(te[oe])===_)return oe;return-1}lastIndexOf(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te);let ie=Z.length>=1?ToIntegerOrInfinity(Z[0]):ne-1;if(ie===-1/0)return-1;ie>=0?ie=ie<ne-1?ie:ne-1:ie+=ne;for(let oe=ie;oe>=0;--oe)if(ObjectHasOwn(te,oe)&&convertToNumber(te[oe])===_)return oe;return-1}includes(_,...Z){assertFloat16Array(this);const te=getFloat16BitsArray(this),ne=TypedArrayPrototypeGetLength(te);let ie=ToIntegerOrInfinity(Z[0]);if(ie===1/0)return!1;ie<0&&(ie+=ne,ie<0&&(ie=0));const oe=NumberIsNaN(_);for(let se=ie;se<ne;++se){const ae=convertToNumber(te[se]);if(oe&&NumberIsNaN(ae)||ae===_)return!0}return!1}join(_){assertFloat16Array(this);const Z=getFloat16BitsArray(this),te=copyToArray(Z);return ArrayPrototypeJoin(te,_)}toLocaleString(..._){assertFloat16Array(this);const Z=getFloat16BitsArray(this),te=copyToArray(Z);return ArrayPrototypeToLocaleString(te,...safeIfNeeded(_))}get[SymbolToStringTag](){if(isFloat16Array(this))return"Float16Array"}}ObjectDefineProperty(Float16Array,"BYTES_PER_ELEMENT",{value:BYTES_PER_ELEMENT});ObjectDefineProperty(Float16Array,brand,{});ReflectSetPrototypeOf(Float16Array,TypedArray);const Float16ArrayPrototype=Float16Array.prototype;ObjectDefineProperty(Float16ArrayPrototype,"BYTES_PER_ELEMENT",{value:BYTES_PER_ELEMENT});ObjectDefineProperty(Float16ArrayPrototype,SymbolIterator,{value:Float16ArrayPrototype.values,writable:!0,configurable:!0});ReflectSetPrototypeOf(Float16ArrayPrototype,TypedArrayPrototype);function half2float(K){const _=new Float16Array(K.buffer.slice(K.byteOffset),0,K.length/2),Z=[];return _.forEach(te=>Z.push(te)),new Float32Array(Z)}function PointCloud({_ref:K,_key:_,position:Z=[0,0,0],rotation:te=[0,0,0],vertices:ne,matrix:ie,colors:oe,size:se=.01,color:ae,...le}){const ce=reactExports.useRef(null),fe=K||ce,de=reactExports.useMemo(()=>({now:Date.now(),vertices:half2float(ne),colors:oe&&Float32Array.from(oe,pe=>pe/255)}),[ne,oe]);return reactExports.useLayoutEffect(()=>{const pe=fe.current;pe&&ie&&(pe.matrix.fromArray(ie),pe.matrix.decompose(pe.position,pe.quaternion,pe.scale),pe.rotation.setFromQuaternion(pe.quaternion))},[ie,fe.current]),jsxRuntimeExports.jsxs("points",{ref:K,position:Z,rotation:te,castShadow:!0,receiveShadow:!0,...le,children:[jsxRuntimeExports.jsxs("bufferGeometry",{children:[jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-position",array:de.vertices,count:de.vertices.length/3,itemSize:3}),de.colors&&jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-color",array:de.colors,count:de.colors.length/3,itemSize:3})]}),jsxRuntimeExports.jsx("pointsMaterial",{attach:"material",vertexColors:oe!==void 0,color:ae,size:se})]},_+de.now)}var Side=(K=>(K[K.front=0]="front",K[K.back=1]="back",K[K.double=2]="double",K))(Side||{});function TriMesh({position:K=[0,0,0],rotation:_=[0,0,0],vertices:Z,faces:te,colors:ne,color:ie,uv:oe,materialType:se="standard",wireframe:ae,opacity:le,side:ce="double",material:fe,...de}){var pe;const he=reactExports.useMemo(()=>{const we=Uint8Array.BYTES_PER_ELEMENT/Float32Array.BYTES_PER_ELEMENT;return{vertices:half2float(Z),faces:new Uint32Array(te.buffer.slice(te.byteOffset),0,we*te.byteLength),colors:ne&&Float32Array.from(ne,Pe=>Pe/255),uv:oe&&half2float(oe)}},[Z,te,ne,oe]),[ge,me]=reactExports.useState({}),[Ae,ye]=reactExports.useState({}),ve=reactExports.useMemo(()=>new TextureLoader,[]),_e=reactExports.useRef(null),Te=reactExports.useRef(!1),be=fe?Object.values(fe):[];if(reactExports.useLayoutEffect(()=>{for(const we in fe){const Pe=fe[we],Ie=we.endsWith("map")||we.endsWith("Map");typeof Pe=="string"&&Ie?ve&&ve.load(Pe,$e=>{const Ue=fe[`${we}Repeat`];Ue&&($e.wrapS=$e.wrapT=RepeatWrapping,$e.repeat.set(...Ue)),ye(ke=>({...ke,[we]:$e})),Te.current=!0}):(me($e=>({...$e,[we]:Pe})),Te.current=!0)}},be),Te.current){Te.current=!1;const we=(pe=_e==null?void 0:_e.current)==null?void 0:pe.material;we&&(we.needsUpdate=!0)}reactExports.useLayoutEffect(()=>{var we;const Pe=(we=_e==null?void 0:_e.current)==null?void 0:we.geometry;!Pe||!he.uv||(Pe.attributes.uv=new BufferAttribute(he.uv,2))},[he.uv]);const Re=`mesh${se.charAt(0).toUpperCase()}${se.slice(1)}Material`;return jsxRuntimeExports.jsxs("mesh",{ref:_e,position:K,rotation:_,castShadow:!0,receiveShadow:!0,...de,children:[jsxRuntimeExports.jsxs("bufferGeometry",{onUpdate:we=>we.computeVertexNormals(),children:[jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-position",array:he.vertices,count:he.vertices.length/3,itemSize:3}),he.colors&&jsxRuntimeExports.jsx("bufferAttribute",{attach:"attributes-color",array:he.colors,count:he.colors.length/3,itemSize:3}),jsxRuntimeExports.jsx("bufferAttribute",{attach:"index",array:he.faces,count:he.faces.length,itemSize:1})]}),jsxRuntimeExports.jsx(Re,{attach:"material",wireframe:ae,vertexColors:!!ne,color:ie,transparent:!0,alphaTest:1,opacity:le,side:Side[ce],...ge,...Ae})]})}function SceneBackground({src:K}){const{scene:_}=useThree(),Z=reactExports.useMemo(()=>new TextureLoader,[]),[te,ne]=reactExports.useState(),ie=typeof K=="string"&&(K==null?void 0:K.length)===0,{backgroundIntensity:oe,backgroundBlurriness:se}=useControls("Scene Background Image",{backgroundIntensity:-.5,backgroundBlurriness:0});return reactExports.useEffect(()=>{if(!K||ie)return ne(void 0);if(typeof K=="string")Z.load(K,ne);else{const ae=new Blob([K],{type:"image"}),le=new Texture$1;createImageBitmap(ae,{imageOrientation:"flipY"}).then(ce=>{le.image=ce,le.needsUpdate=!0,le.colorSpace=NoColorSpace$1,ne(le)})}},[K]),reactExports.useEffect(()=>{_.backgroundIntensity=oe,_.backgroundBlurriness=se},[oe,se]),reactExports.useEffect(()=>{te&&(_.background=te)},[te,te==null?void 0:te.needsUpdate]),null}function ImagePlane({matRef:K,rgb:_,alpha:Z,depth:te,depthScale:ne=1,depthBias:ie=0,distanceToCamera:oe=10,aspect:se,height:ae,position:le,rotation:ce,quaternion:fe,matrix:de,opacity:pe=1,fixed:he=!1,side:ge=2,layers:me=null,wireframe:Ae=!1,material:ye={}}){var ve;const _e=reactExports.useRef(null),{camera:Te}=useThree(),be=useXR(({mode:Ie})=>Ie),Re=be==="immersive-ar"||be==="immersive-vr";reactExports.useLayoutEffect(()=>{Re&&typeof me=="number"&&Re&&_e.current.layers.set(me)},[me,Re]),reactExports.useLayoutEffect(()=>{if(!_e.current||!he)return;const Ie=_e.current;de?(Ie.matrix.fromArray(de),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.rotation.setFromQuaternion(Ie.quaternion)):(fe?Ie.quaternion.fromArray(fe):ce&&Ie.rotation.set(...ce),le&&Ie.position.set(...le))},[de,fe,ce,le,he]),useFrame(()=>{const Ie=_e.current;let $e,Ue,ke;if(typeof ae=="number"&&typeof se=="number")Ie.scale.set(ae*se,ae,1);else if(Te.type==="PerspectiveCamera"){const tt=Te;typeof ae=="number"?$e=ae:$e=2*Math.tan(tt.fov/360*Math.PI)*oe,typeof se=="number"?ke=se:ke=tt.aspect,Ue=ke*$e,Ie.scale.set(Ue,$e,1)}else if(Te.type==="OrthographicCamera"){const tt=Te;$e=(tt.top-tt.bottom)/Te.zoom,Ue=(tt.right-tt.left)/Te.zoom,Ie.scale.set(Ue,$e,1)}else console.warn("Unsupported camera type",Te.type);if(he)return;if(de){Ie.matrix.fromArray(de),Ie.matrix.premultiply(Te.matrixWorld),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.rotation.setFromQuaternion(Ie.quaternion);return}Te.matrixWorld.decompose(Ie.position,Te.quaternion,[]),fe?(Ie.quaternion.fromArray(fe),Ie.quaternion.premultiply(Te.quaternion)):ce?(Ie.quaternion.setFromEuler(new Euler().fromArray(ce)),Ie.quaternion.premultiply(Te.quaternion)):Ie.quaternion.copy(Te.quaternion);const[Ge,He,ze]=le||[0,0,0],Ke=new Vector3(Ge,He,ze-oe).applyQuaternion(Te.quaternion);Ie.position.add(Ke)});const we=reactExports.useMemo(()=>te!=null&&te.image?{"displacementMap-colorSpace":NoColorSpace$1,...ye}:ye,[te,ye]),Pe=(ve=_||te)==null?void 0:ve.image;return te!=null&&te.image?jsxRuntimeExports.jsxs("mesh",{ref:_e,scale:[1,1,1],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[1,1,Pe==null?void 0:Pe.width,Pe==null?void 0:Pe.height]}),jsxRuntimeExports.jsx("meshStandardMaterial",{attach:"material",ref:K,map:_,alphaMap:Z,displacementMap:te,displacementScale:-ne,displacementBias:ie,wireframe:Ae,transparent:!!Z||typeof pe=="number",opacity:pe,side:ge,...we})]}):jsxRuntimeExports.jsxs("mesh",{ref:_e,scale:[1,1,1],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[1,1,Pe==null?void 0:Pe.width,Pe==null?void 0:Pe.height]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",ref:K,map:_,alphaMap:Z,displacementScale:-ne,displacementBias:ie,wireframe:Ae,transparent:!!Z||typeof pe=="number",opacity:pe,side:ge,...ye})]})}function HUDPlane({distanceToCamera:K=10,aspect:_,height:Z,position:te,rotation:ne,quaternion:ie,matrix:oe,fixed:se=!1,layers:ae=null,children:le}){const ce=reactExports.useRef(null),fe=useThree(({camera:he})=>he),de=useXR(({mode:he})=>he),pe=de==="immersive-ar"||de==="immersive-vr";return reactExports.useEffect(()=>{ce.current&&typeof ae=="number"&&pe&&ce.current.layers.set(ae)},[ae,ce.current,pe]),reactExports.useLayoutEffect(()=>{if(!ce.current||!se)return;const he=ce.current;oe?(he.matrix.fromArray(oe),he.matrix.decompose(he.position,he.quaternion,he.scale),he.rotation.setFromQuaternion(he.quaternion)):(ie?he.quaternion.fromArray(ie):ne&&he.rotation.set(...ne),te&&he.position.set(...te))},[oe,ie,ne,te,se]),useFrame(()=>{const he=ce.current;let ge,me,Ae;if(typeof Z=="number"&&typeof _=="number")he.scale.set(Z*_,Z,1);else if(fe.type==="PerspectiveCamera"){const be=fe;typeof Z=="number"?ge=Z:ge=2*Math.tan(be.fov/360*Math.PI)*K,typeof _=="number"?Ae=_:Ae=be.aspect,me=Ae*ge,he.scale.set(me,ge,1)}else if(fe.type==="OrthographicCamera"){const be=fe;ge=(be.top-be.bottom)/fe.zoom,me=(be.right-be.left)/fe.zoom,he.scale.set(me,ge,1)}else console.warn("Unsupported camera type",fe.type);if(se)return;if(oe){he.matrix.fromArray(oe),he.matrix.premultiply(fe.matrixWorld),he.matrix.decompose(he.position,he.quaternion,he.scale),he.rotation.setFromQuaternion(he.quaternion);return}fe.matrixWorld.decompose(he.position,fe.quaternion,[]),ie?(he.quaternion.fromArray(ie),he.quaternion.premultiply(fe.quaternion)):ne?(he.quaternion.setFromEuler(new Euler().fromArray(ne)),he.quaternion.premultiply(fe.quaternion)):he.quaternion.copy(fe.quaternion);const[ye,ve,_e]=te||[0,0,0],Te=new Vector3(ye,ve,_e-K).applyQuaternion(fe.quaternion);he.position.add(Te)}),jsxRuntimeExports.jsxs("mesh",{ref:ce,scale:[1,1,1],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[1,1]}),le]})}const VideoShaderMaterial=shaderMaterial({diffuse:null,texCoordScaleOffset:[1,1,0,0,1,1,0,0],EYE_INDEX:0},`
  uniform int EYE_INDEX;
  uniform vec4 texCoordScaleOffset[2];
  varying vec2 vTexCoord;

  void main() {
    vec4 scaleOffset = texCoordScaleOffset[EYE_INDEX];
    vTexCoord = (uv * scaleOffset.xy) + scaleOffset.zw;
    vec4 out_vec = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    gl_Position = out_vec;
  }`,`
  uniform sampler2D diffuse;
  varying vec2 vTexCoord;

  void main() {
    gl_FragColor = texture2D(diffuse, vTexCoord);
  }`);extend$6({VideoShaderMaterial});const VideoMaterial=({map:K,layout:_="mono",eyeIndex:Z=0,...te})=>{const ne=reactExports.useRef(null),ie=reactExports.useMemo(()=>{if(_==="stereo-top-bottom")return[1,.5,0,Z===0?0:.5,1,.5,0,Z===0?0:.5];if(_==="stereo-left-right")return[.5,1,Z===0?0:.5,0,.5,1,Z===0?0:.5,0];if(_==="mono")return[1,1,0,0,1,1,0,0]},[_,Z]);return reactExports.useEffect(()=>{if(!ne.current)return;const oe=ne.current;oe.uniforms.diffuse.value=K,oe.uniforms.texCoordScaleOffset.value=ie,oe.uniforms.EYE_INDEX.value=Z},[K,ie,Z]),jsxRuntimeExports.jsx("videoShaderMaterial",{ref:ne,transparent:!0,...te})};function useVuerVideoTexture(K,{start:_=!1,repeat:Z,offset:te}={}){const ne=useThree(ae=>ae.gl),ie=reactExports.useMemo(()=>{if(!K)return null;const ae=new VideoTexture(K);return"colorSpace"in ae?ae.colorSpace=ne.outputColorSpace:ae.encoding=ne.outputEncoding,ae},[K]),oe=useXR(({mode:ae})=>ae),se=oe==="immersive-ar"||oe==="immersive-vr";return useFrame(()=>{ie&&se&&!ie.image.paused&&(ie.needsUpdate=!0)}),reactExports.useEffect(()=>{ie&&(Z&&(ie.repeat=new Vector2(...Z)),te&&(ie.offset=new Vector2(...te)))},[Z,te]),reactExports.useEffect(()=>{if(ie&&_)return ie.image.play(),()=>{ie.image.pause()}},[ie,_,se]),ie}const isPromise=K=>typeof K=="object"&&typeof K.then=="function",globalCache=[];function shallowEqualArrays(K,_,Z=(te,ne)=>te===ne){if(K===_)return!0;if(!K||!_)return!1;const te=K.length;if(_.length!==te)return!1;for(let ne=0;ne<te;ne++)if(!Z(K[ne],_[ne]))return!1;return!0}function query(K,_=null,Z=!1,te={}){_===null&&(_=[K]);for(const ie of globalCache)if(shallowEqualArrays(_,ie.keys,ie.equal)){if(Z)return;if(Object.prototype.hasOwnProperty.call(ie,"error"))throw ie.error;if(Object.prototype.hasOwnProperty.call(ie,"response"))return te.lifespan&&te.lifespan>0&&(ie.timeout&&clearTimeout(ie.timeout),ie.timeout=setTimeout(ie.remove,te.lifespan)),ie.response;if(!Z)throw ie.promise}const ne={keys:_,equal:te.equal,remove:()=>{const ie=globalCache.indexOf(ne);ie!==-1&&globalCache.splice(ie,1)},promise:(isPromise(K)?K:K(..._)).then(ie=>{ne.response=ie,te.lifespan&&te.lifespan>0&&(ne.timeout=setTimeout(ne.remove,te.lifespan))}).catch(ie=>ne.error=ie)};if(globalCache.push(ne),!Z)throw ne.promise}const suspend=(K,_,Z)=>query(K,_,!1,Z);function useVideo(K,{unsuspend:_="loadedmetadata",crossOrigin:Z="Anonymous",muted:te=!0,loop:ne=!0,start:ie=!0,playsInline:oe=!0,...se}={}){const ae=suspend(()=>new Promise((ce,fe)=>{if(!K)return ce(null);const de=Object.assign(document.createElement("video"),{src:typeof K=="string"&&K||void 0,srcObject:K instanceof MediaStream&&K||void 0,autoplay:ie,crossOrigin:Z,loop:ne,muted:te,playsInline:oe,...se});de.addEventListener(_,()=>ce(de)),de.addEventListener("error",()=>fe(null))}),[K]),le=useXR(({mode:ce})=>ce);return reactExports.useEffect(()=>{if(ae&&ie)return ae.play(),()=>ae.pause()},[ae,ie,le==="immersive-ar"||le==="immersive-vr"]),ae}function VideoPlane({src:K,start:_=!0,...Z}){const te=useVideo(K,{start:_}),ne=useVuerVideoTexture(te);return ne!=null&&ne.image?jsxRuntimeExports.jsx(HUDPlane,{...Z,children:jsxRuntimeExports.jsx(VideoMaterial,{attach:"material",map:ne})}):null}function ImageSphere({matRef:K,rgb:_,alpha:Z,depth:te,depthScale:ne=1,depthBias:ie=0,distanceToCamera:oe=1,opacity:se=1,fixed:ae=!1,layers:le=null,side:ce=2,wireframe:fe=!1,material:de={}}){const pe=reactExports.useRef(null),{camera:he}=useThree(),ge=useXR(({mode:ve})=>ve),me=ge==="immersive-ar"||ge==="immersive-vr";reactExports.useEffect(()=>{pe.current&&typeof le=="number"&&me&&pe.current.layers.set(le)},[le,pe.current,me]);const Ae=reactExports.useMemo(()=>{var ve;if(he.type!=="PerspectiveCamera"){console.warn("ImageSphere only works with perspective camera");return}const _e=he,Te=_e.fov/360*Math.PI,be=Math.atan(Math.tan(Te)*_e.aspect),Re=(ve=_||te)==null?void 0:ve.image;return[oe,Re==null?void 0:Re.width,Re==null?void 0:Re.height,-.5*Math.PI-be,2*be,.5*Math.PI-Te,2*Te]},[he.fov,he.aspect]);useFrame(()=>{if(!pe.current||ae)return;const ve=pe.current;he.matrixWorld.decompose(ve.position,he.quaternion,[]),ve.quaternion.copy(he.quaternion)});const ye=reactExports.useMemo(()=>te!=null&&te.image?{"displacementMap-colorSpace":NoColorSpace$1,...de}:de,[te,de]);return te!=null&&te.image?jsxRuntimeExports.jsxs("mesh",{ref:pe,scale:[1,1,1],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:Ae}),jsxRuntimeExports.jsx("meshStandardMaterial",{ref:K,attach:"material",map:_,alphaMap:Z,displacementMap:te,displacementScale:ne,displacementBias:ie,wireframe:fe,transparent:!!Z||typeof se=="number",opacity:se,side:ce,...ye})]}):jsxRuntimeExports.jsxs("mesh",{ref:pe,scale:[1,1,1],children:[jsxRuntimeExports.jsx("sphereGeometry",{args:Ae}),jsxRuntimeExports.jsx("meshBasicMaterial",{ref:K,attach:"material",map:_,alphaMap:Z,displacementScale:ne,displacementBias:ie,wireframe:fe,transparent:!!Z||typeof se=="number",opacity:se,side:ce,...de})]})}function interpolateTexture(K,_){K&&(_?(K.minFilter=LinearFilter,K.magFilter=LinearFilter):(K.minFilter=NearestFilter,K.magFilter=NearestFilter))}function ImageBackground({_key:K,geometry:_,src:Z,alphaSrc:te,depthSrc:ne,interpolate:ie=!1,depthScale:oe=1,depthBias:se=0,fixed:ae=!1,levaPrefix:le="Scene.",...ce}){const fe=reactExports.useRef(null),{camera:de}=useThree(),[pe,he]=reactExports.useState(),[ge,me]=reactExports.useState(),[Ae,ye]=reactExports.useState(),ve=reactExports.useMemo(()=>new TextureLoader,[]),_e=reactExports.useMemo(()=>Ae&&de.type==="PerspectiveCamera"?{}:{imageOrientation:"flipY"},[de.type,Ae]);reactExports.useEffect(()=>{if(!Z)he(void 0);else if(typeof Z=="string")ve.load(Z,he);else{const Re=new Blob([Z],{type:"image"}),we=new Texture$1;createImageBitmap(Re,_e).then(Pe=>{we.image=Pe,we.needsUpdate=!0,fe.current&&(fe.current.needsUpdate=!0),he(we)})}},[Z,_e]),reactExports.useEffect(()=>{if(!te)me(void 0);else if(typeof te=="string")ve.load(te,me);else{const Re=new Blob([te],{type:"image"}),we=new Texture$1;createImageBitmap(Re,_e).then(Pe=>{we.image=Pe,we.needsUpdate=!0,fe.current&&(fe.current.needsUpdate=!0),me(we)})}},[te,_e]),reactExports.useEffect(()=>{if(!ne)ye(void 0);else if(typeof ne=="string")ve.load(ne,ye);else{const Re=new Blob([ne],{type:"image"}),we=new Texture$1;createImageBitmap(Re,_e).then(Pe=>{we.image=Pe,we.needsUpdate=!0,fe.current&&(fe.current.needsUpdate=!0),ye(we)})}},[ne,_e]),reactExports.useEffect(()=>{pe&&interpolateTexture(pe,ie),ge&&interpolateTexture(ge,ie),Ae&&interpolateTexture(Ae,ie)},[pe,ge,Ae,ie]);let Te=le?`${le}Image Background`:"Image Background";Te=K?`${Te}-[${K}]`:Te;const be=useControls(Te,{fixed:ae,depthScale:{value:oe,step:.01,label:"Depth Scale"},depthBias:{value:se,step:.01,label:"Depth Offset"}},[ae,oe,se]);if(_==="plane")return jsxRuntimeExports.jsx(ImagePlane,{matRef:fe,rgb:pe,alpha:ge,depth:Ae,...be,...ce});if(_==="sphere")return jsxRuntimeExports.jsx(ImageSphere,{matRef:fe,rgb:pe,alpha:ge,...be,depth:Ae,...ce});if(Ae){if(de.type==="OrthographicCamera")return jsxRuntimeExports.jsx(ImagePlane,{matRef:fe,rgb:pe,alpha:ge,depth:Ae,...be,...ce});if(de.type==="PerspectiveCamera")return jsxRuntimeExports.jsx(ImageSphere,{matRef:fe,rgb:pe,alpha:ge,...be,depth:Ae,...ce})}else return jsxRuntimeExports.jsx(ImagePlane,{matRef:fe,rgb:pe,alpha:ge,...be,...ce});return null}const StereoVideoPlane=({src:K,side:_=2,crossOrigin:Z="Anonymous",muted:te=!0,loop:ne=!0,start:ie=!0,playsInline:oe=!0,...se})=>{const ae=useVideo(K,{crossOrigin:Z,muted:te,loop:ne,start:ie,playsInline:oe}),le=useVuerVideoTexture(ae);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(HUDPlane,{layers:1,...se,children:jsxRuntimeExports.jsx(VideoMaterial,{attach:"material",map:le,toneMapped:!1,side:2,eyeIndex:0,...se})}),jsxRuntimeExports.jsx(HUDPlane,{layers:2,...se,children:jsxRuntimeExports.jsx(VideoMaterial,{attach:"material",map:le,toneMapped:!1,side:2,eyeIndex:1,...se})})]})};function negotiate_webrtc(K,_){return K.addTransceiver("video",{direction:"recvonly"}),K.addTransceiver("audio",{direction:"recvonly"}),K.createOffer().then(Z=>K.setLocalDescription(Z)).then(()=>new Promise(Z=>{if(K.iceGatheringState==="complete")Z();else{const te=()=>{K.iceGatheringState==="complete"&&(K.removeEventListener("icegatheringstatechange",te),Z())};K.addEventListener("icegatheringstatechange",te)}})).then(()=>{const Z=K.localDescription;return fetch(_,{body:JSON.stringify({sdp:Z.sdp,type:Z.type}),headers:{"Content-Type":"application/json"},method:"POST"})}).then(Z=>Z.json()).then(Z=>K.setRemoteDescription(Z))}const DEFAULT_ICE_SERVER={urls:"stun:stun.l.google.com:19302"};function useWebRTC(K,{iceServer:_=DEFAULT_ICE_SERVER,iceServers:Z=[],retry:te={maxAttempts:3,delay:1e3},...ne}){const[ie,oe]=reactExports.useState(null),[se,ae]=reactExports.useState(null),[le,ce]=reactExports.useState(null);return reactExports.useEffect(()=>{const fe=_?[_,...Z]:Z,de=new RTCPeerConnection({iceServers:fe,...ne});return de.addEventListener("track",pe=>{pe.track.kind=="video"?oe(pe.streams[0]):ae(pe.streams[0])}),negotiate_webrtc(de,K).catch(pe=>{console.error("WebRTC negotiation error:",pe)}),()=>de.close()},[K]),{srcObj:ie,audioSrc:se,error:le}}function WebRTCVideoPlane({src:K,start:_=!0,iceServer:Z={urls:"stun:stun.l.google.com:19302"},webRTCOptions:te,...ne}){const{srcObj:ie}=useWebRTC(K,{iceServer:Z,...te}),oe=useVideo(ie),se=useVuerVideoTexture(oe,{start:_});return se!=null&&se.image?jsxRuntimeExports.jsx(HUDPlane,{...ne,children:jsxRuntimeExports.jsx(VideoMaterial,{attach:"material",map:se})}):null}const WebRTCStereoVideoPlane=({src:K,iceServer:_={urls:"stun:stun.l.google.com:19302"},side:Z=2,rtcOptions:te,crossOrigin:ne="Anonymous",muted:ie=!0,loop:oe=!0,start:se=!0,playsInline:ae=!0,...le})=>{const{srcObj:ce}=useWebRTC(K,{iceServer:_,...te});return jsxRuntimeExports.jsx(StereoVideoPlane,{src:ce,side:Z,crossOrigin:ne,muted:ie,loop:oe,start:se,playsInline:ae,...le})},GrabRender=({_key:K="DEFAULT"})=>{const _=window.devicePixelRatio||1,{sendMsg:Z,downlink:te,uplink:ne}=useSocket(),{gl:ie}=useThree(),oe=reactExports.useMemo(()=>({lastFrame:Date.now()}),[]),se=reactExports.useMemo(()=>new OffscreenCanvas(1,1),[]);return reactExports.useEffect(()=>te?te.subscribe("GRAB_RENDER",({key:ae,rtype:le,data:{downsample:ce=1,quality:fe=1}})=>{if(ae!==K||!ie.domElement)return;const{width:de,height:pe}=ie.domElement,he=Date.now(),ge=he-oe.lastFrame;oe.lastFrame=he;const me=se.getContext("2d");se.width=de/ce,se.height=pe/ce;const Ae=ie.domElement;me.drawImage(Ae,0,0,Ae.width,Ae.height,0,0,se.width,se.height),se.convertToBlob({type:"image/jpeg",quality:fe}).then(ye=>ye.arrayBuffer()).then(ye=>{const ve={ts:Date.now(),etype:le||"GRAB_RENDER_RESPONSE",key:ae,value:{dpr:_,delta:ge,width:de,height:pe,frame:new Uint8Array(ye)}};Z(ve)})}):void 0,[ie.domElement,Z,te,ne,oe]),null};function Grid({_key:K,far:_,levaPrefix:Z="Scene.",hide:te}){var ne;const ie=reactExports.useMemo(()=>queryString.parse(document$4.location.search),[]),{camera:oe}=useThree(),se=((ne=ie.grid)==null?void 0:ne.toLowerCase())!=="false";let ae=Z?`${Z}Grid Plane`:"Grid Plane";ae=K?`${ae}-[${K}]`:ae;const{showGrid:le,offset:ce,fadeDistance:fe,...de}=useControls(ae,{showGrid:{value:typeof te>"u"?se:te,label:"Show Grid"},offset:0,cellSize:.2,cellThickness:.6,cellColor:"#6f6f6f",sectionSize:1,sectionThickness:1.5,sectionColor:"#23aaff",fadeDistance:_||10,fadeStrength:1,followCamera:!0,infiniteGrid:!0},{collapsed:!0},[_,oe.far]),{rot:pe,pos:he}=reactExports.useMemo(()=>{const me=new Vector3(0,1,0),Ae=new Quaternion;Ae.setFromUnitVectors(me,Object3D.DEFAULT_UP);const ye=new Euler;ye.setFromQuaternion(Ae,"XYZ");const ve=Object3D.DEFAULT_UP.clone().multiplyScalar(ce);return{rot:ye,pos:ve}},[Object3D.DEFAULT_UP,ce]),ge=useRenderMode(({mode:me})=>me);return le?ge==="postprocess"?jsxRuntimeExports.jsx(Grid$1,{position:he,rotation:pe,args:[10,10],fadeDistance:Math.min(oe.far||5,fe),...de}):ge==="pathtracer"?null:jsxRuntimeExports.jsx(Grid$1,{position:he,rotation:pe,args:[10,10],fadeDistance:Math.min(oe.far||5,fe),...de}):null}function list2menu(K,_){const Z={};return K.forEach(te=>{const{label:ne,color:ie,threshold:oe,hide:se,...ae}=te;ie?(Z[`${ne}`]=folder$1({[`${ne}_color`]:{value:ie,label:"color"}},{collapsed:!_,color:ie}),Z[`${ne}_show`]={value:!se,label:"show"}):Z[`${ne}_show`]={value:!se,label:ne}}),Z}function Gripper({_ref:K,color:_,pinchWidth:Z=.04,skeleton:te=!1,axes:ne=!1,showOrigin:ie=!0,hide:oe,...se}){const ae=reactExports.useRef(null),le=K||ae;return oe?null:te?jsxRuntimeExports.jsx(SkeletalGripper,{_ref:K,color:_,pinchWidth:Z,...se}):jsxRuntimeExports.jsxs(VuerGroup,{_ref:le,...se,children:[ne&&jsxRuntimeExports.jsx("axesHelper",{args:[.1]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.07,0],rotation:[0,0,Math.PI/2],scale:[1,1,1],children:[jsxRuntimeExports.jsx("cylinderGeometry",{attach:"geometry",args:[.015,.015,.12,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#cecece"})]}),jsxRuntimeExports.jsxs("mesh",{position:[-Z-.005,0,0],scale:1,children:[jsxRuntimeExports.jsx("boxGeometry",{attach:"geometry",args:[.01,.02,.025,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#23aaff"})]}),jsxRuntimeExports.jsxs("mesh",{position:[-Z-.005,.0275+.01,0],scale:1,children:[jsxRuntimeExports.jsx("boxGeometry",{attach:"geometry",args:[.01,.055,.025,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#8ed6ff"})]}),jsxRuntimeExports.jsxs("mesh",{position:[Z+.005,0,0],scale:1,children:[jsxRuntimeExports.jsx("boxGeometry",{attach:"geometry",args:[.01,.02,.025,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#ff5656"})]}),jsxRuntimeExports.jsxs("mesh",{position:[Z+.005,.0275+.01,0],scale:1,children:[jsxRuntimeExports.jsx("boxGeometry",{attach:"geometry",args:[.01,.055,.025,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#ff9595"})]}),jsxRuntimeExports.jsxs("mesh",{position:[0,.075+.025,0],rotation:[0,0,0],scale:[1,1,1],children:[jsxRuntimeExports.jsx("cylinderGeometry",{attach:"geometry",args:[.0125,.0125,.05,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_||"#5b5b5b"})]}),ie?jsxRuntimeExports.jsxs("mesh",{position:[0,0,0],rotation:[0,0,0],children:[jsxRuntimeExports.jsx("sphereGeometry",{attach:"geometry",args:[.0075,32,32]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:"green"})]}):null]})}function VuerSplat({_ref:K,matrix:_,flipCoords:Z=!0,rotation:te,position:ne,scale:ie,...oe}){return jsxRuntimeExports.jsx(VuerGroup,{_ref:K,rotation:te,position:ne,scale:ie,matrix:_,children:Z?jsxRuntimeExports.jsx(Splat,{rotation:[Math.PI,0,0],...oe}):jsxRuntimeExports.jsx(Splat,{...oe})})}const Line=({lineWidth:K,..._})=>{const Z=useXR(({mode:te})=>te);return Z==="immersive-ar"||Z==="immersive-vr"?jsxRuntimeExports.jsx(Line$1,{lineWidth:K/1e3,..._}):jsxRuntimeExports.jsx(Line$1,{lineWidth:K,..._})},playhead="_playhead_at0ov_1";function Playhead({seeking:K,leftPos:_}){return jsxRuntimeExports.jsx("div",{"data-seeking":K,className:playhead,style:{left:`calc(50% + ${_}px)`}})}const tsStyle="_tsStyle_skfcc_1";function Timestamps({start:K,end:_,firstVisibleFrame:Z,lastVisibleFrame:te,segmentDensity:ne=1}){const ie=reactExports.useMemo(()=>{const oe=[],se=Math.max(1,ne),ae=Math.floor((Z-K)/se)*se+K;for(let le=ae;le<te;le+=se){const ce=Math.max(_-K,1),fe=ne>0&&(le-K)/ne%2!==0;oe.push(jsxRuntimeExports.jsx("div",{"data-label":fe?"":le,"data-left":(le-K)/ce*100,className:tsStyle,style:{left:(le-K)/ce*100+"%",opacity:fe?.5:1}},le))}return oe},[Z,te,ne]);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ie})}const svg$8="_svg_ohgsw_1";function FastForward(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4L224 214.3V256v41.7L52.5 440.6zM256 352V256 128 96c0-12.4 7.2-23.7 18.4-29s24.5-3.6 34.1 4.4l192 160c7.3 6.1 11.5 15.1 11.5 24.6s-4.2 18.5-11.5 24.6l-192 160c-9.5 7.9-22.8 9.7-34.1 4.4s-18.4-16.6-18.4-29V352z"})})}function FastRewind(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M459.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4L288 214.3V256v41.7L459.5 440.6zM256 352V256 128 96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160C4.2 237.5 0 246.5 0 256s4.2 18.5 11.5 24.6l192 160c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V352z"})})}function Pause(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 320 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"})})}function PhotoCamera(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M149.1 64.8L138.7 96H64C28.7 96 0 124.7 0 160V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H373.3L362.9 64.8C356.4 45.2 338.1 32 317.4 32H194.6c-20.7 0-39 13.2-45.5 32.8zM256 192a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"})})}function Repeat(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"})})}function SkipNext(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 320 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4l192 160L256 241V96c0-17.7 14.3-32 32-32s32 14.3 32 32V416c0 17.7-14.3 32-32 32s-32-14.3-32-32V271l-11.5 9.6-192 160z"})})}function SkipPrevious(){return jsxRuntimeExports.jsx("svg",{fill:"currentColor",viewBox:"0 0 320 512",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"})})}function DragIndicator(K){return jsxRuntimeExports.jsx("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",...K,children:jsxRuntimeExports.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})})}const PlayArrow=()=>jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"})}),activeStyle="_activeStyle_1aomm_12",disabledStyle$2="_disabledStyle_1aomm_25",styles={activeStyle,disabledStyle:disabledStyle$2},Recording=({active:K})=>{const _=K?styles.activeStyle:styles.disabledStyle;return jsxRuntimeExports.jsx("svg",{width:"24",height:"24",viewBox:"0 0 100 100",children:jsxRuntimeExports.jsx("circle",{className:_,cx:"50",cy:"50",r:"30"})})};function Save(K){return jsxRuntimeExports.jsxs("svg",{width:24,height:24,viewBox:"0 0 100 100",fill:"currentColor",className:svg$8,...K,children:[jsxRuntimeExports.jsx("path",{d:"M85.6250076,79.687439h-71.249939c-3.2645864,0-5.9375668,2.6671753-5.9375668,5.9375V91.5625  c0,3.2584839,2.6729803,5.9375,5.9375668,5.9375h71.249939c3.2643433,0,5.9374924-2.6790161,5.9374924-5.9375v-5.937561  C91.5625,82.3546143,88.8893509,79.687439,85.6250076,79.687439z"}),jsxRuntimeExports.jsx("path",{d:"M16.6536942,40.0267334L47.721138,65.9106445c1.2522583,1.0438843,3.3054199,1.0438843,4.5575562,0L83.346138,40.0267334  C84.5983353,38.9829712,84.2913284,38.125,82.6562576,38.125h-20.78125V8.4375048C61.8750076,5.1671143,59.2018509,2.5,55.9375,2.5  h-11.875c-3.2645187,0-5.9374924,2.6671143-5.9374924,5.9375048V38.125h-20.78125  C15.7085037,38.125,15.4015579,38.9829712,16.6536942,40.0267334z"})]})}var MouseButton=(K=>(K[K.Left=0]="Left",K[K.Middle=1]="Middle",K[K.Right=2]="Right",K))(MouseButton||{}),MouseMask=(K=>(K[K.None=0]="None",K[K.Primary=1]="Primary",K[K.Secondary=2]="Secondary",K[K.Auxiliary=4]="Auxiliary",K[K.Back=8]="Back",K[K.Forward=16]="Forward",K))(MouseMask||{});function clamp(K,_,Z){return K<_?_:K>Z?Z:K}const container$1="_container_p79ru_1",rangeStyle="_rangeStyle_p79ru_7",style$4="_style_p79ru_25",dragIndStyle="_dragIndStyle_p79ru_30";function RangeSelector({rangeRef:K,viewWidth:_,playback:Z}){const[te,ne]=reactExports.useState(Z.range.start),[ie,oe]=reactExports.useState(Z.range.end);reactExports.useEffect(()=>{ne(Z.range.start)},[Z.range.start]),reactExports.useEffect(()=>{oe(Z.range.end)},[Z.range.end]);const se=reactExports.useCallback(le=>{Z.setRange({start:le}),ne(le)},[Z]),ae=reactExports.useCallback(le=>{Z.setRange({end:le}),oe(le)},[Z]);return jsxRuntimeExports.jsx("div",{className:container$1,children:jsxRuntimeExports.jsxs("div",{ref:K,className:rangeStyle,style:{left:`${(te-Z.start)/(Z.end-Z.start)*100}%`,right:`${(Z.duration+Z.end-ie)%Z.duration/(Z.end-Z.start)*100}%`},children:[jsxRuntimeExports.jsx(RangeHandle,{onChange:se,roundUp:!0,start:Z.start,end:Z.end,viewWidth:_}),jsxRuntimeExports.jsx("div",{className:style$4}),jsxRuntimeExports.jsx(RangeHandle,{onChange:ae,roundUp:!0,start:Z.start,end:Z.end,viewWidth:_})]})})}function RangeHandle({onChange:K,start:_,end:Z,viewWidth:te,roundUp:ne=!1}){return jsxRuntimeExports.jsx(DragIndicator,{className:dragIndStyle,onPointerDown:ie=>{ie.button===MouseButton.Left&&(ie.preventDefault(),ie.stopPropagation(),ie.currentTarget.setPointerCapture(ie.pointerId))},onPointerMove:ie=>{if(!ie.currentTarget.hasPointerCapture(ie.pointerId))return;ie.stopPropagation();const oe=ie.movementX/te*(Z-_);K(se=>clamp(se+oe,_,Z))},onPointerUp:ie=>{if(ie.button!==MouseButton.Left)return;ie.stopPropagation(),ie.currentTarget.releasePointerCapture(ie.pointerId);const oe=ie.movementX/te*(Z-_);K(se=>{const ae=clamp(se+oe,_,Z);return ne?Math.round(ae):ae})}})}function useSize(K){const[_,Z]=reactExports.useState(new DOMRect),te=reactExports.useMemo(()=>new ResizeObserver(()=>Z(K.current.getBoundingClientRect())),[]);return reactExports.useLayoutEffect(()=>{if(K.current)return te.observe(K.current),()=>te.unobserve(K.current)},[K.current]),_}function useStorage(K,_=null,Z="vuer-default"){const te=`${Z}-${K}`,[ne,ie,oe]=reactExports.useMemo(()=>{const he=localStorage.getItem(te);if(he===null){const ge=JSON.stringify(_);return localStorage.setItem(te,ge),console.log("initialized",te,ge),[_,ge,!1]}else{const ge=JSON.parse(he);return console.log("loaded",te,he),[ge,he,!0]}},[te]),[se,ae,le]=useStateRef(ne),[ce,fe,de]=useStateRef(ie),pe=reactExports.useCallback(he=>{typeof he=="function"&&(he=he(le.current));const ge=JSON.stringify(he);ge!==de.current&&te&&(localStorage.setItem(te,ge),ae(he),fe(ge),console.log("saved",te,[de.current]))},[te,ae,de]);return[se,pe,oe]}const useAnimationFrame=K=>{const _=reactExports.useRef(null),Z=reactExports.useRef(null),te=ne=>{if(Z.current!=null){const ie=ne-Z.current;K(ie)}Z.current=ne,_.current=requestAnimationFrame(te)};reactExports.useEffect(()=>{if(K)return _.current=requestAnimationFrame(te),()=>cancelAnimationFrame(_.current)},[K])};class Deque{constructor(_,Z){ue(this,"buffer"),ue(this,"maxlen"),ue(this,"head"),ue(this,"tail"),ue(this,"size"),this.buffer=new Array(Z),this.maxlen=Z,this.head=0,this.tail=0,this.size=0,_!=null&&_.length&&_.forEach(te=>this.push(te))}get(_,Z){return _<0||_>=this.size?Z:this.buffer[(this.head+_)%this.maxlen]}push(_){this.size===this.maxlen?this.head=(this.head+1)%this.maxlen:this.size++,this.buffer[this.tail]=_,this.tail=(this.tail+1)%this.maxlen}prepend(_){this.size===this.maxlen?this.tail=(this.tail-1+this.maxlen)%this.maxlen:this.size++,this.head=(this.head-1+this.maxlen)%this.maxlen,this.buffer[this.head]=_}toArray(){const _=[];for(let Z=0;Z<this.size;Z++)_.push(this.buffer[(this.head+Z)%this.maxlen]);return _}clear(){this.buffer=new Array(this.maxlen),this.size=0,this.head=0,this.tail=0}}class Range{constructor(_,Z){ue(this,"start"),ue(this,"end"),this.start=_,this.end=Z}}function sentinel(K){function _(Z,te,ne){const ie=ne.value;return ne.value=function(...oe){const se=ie.call(this,...oe);return this.signal.emit(K,{}),se},ne}return _}class Playback{constructor(_=1e3,Z=60,te=1,ne=[],ie=0,oe=0,se=0,ae=0,le=0,ce=!0,fe=!1,de=!0){ue(this,"maxlen"),ue(this,"fps"),ue(this,"speed"),ue(this,"start"),ue(this,"end"),ue(this,"curr"),ue(this,"isPaused"),ue(this,"isRecording"),ue(this,"loop"),ue(this,"_keyFrames"),ue(this,"clips"),ue(this,"store"),ue(this,"range"),ue(this,"signal"),ue(this,"changeBufferLength",pe=>{this._keyFrames=new Deque(this.keyFrames.toArray(),pe),this.maxlen=pe}),ue(this,"setMaxlen",pe=>{this.changeBufferLength(pe),this.keyFrames.size===0?(this.start=this.end,this.curr=this.end,this.range.start=this.end,this.range.end=this.end):(this.start=this.end+1-this.keyFrames.size,this.range.start=Math.max(this.start,this.range.start),this.range.end=Math.min(this.end,this.range.end)),this.signal.emit("UPDATE_STATE",{}),this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"deltaTime",0),ue(this,"render",pe=>{if(this.isPaused||(this.deltaTime+=pe,this.deltaTime<1e3/this.fps))return;const he=this.step(this.speed);this.deltaTime-=1e3/this.fps,he&&(this.store.publish(he),this.signal.emit("UPDATE_TIMELINE",{}))}),ue(this,"addKeyFrame",(pe,he=!1)=>{!this.isRecording&&!he||(this.curr===this.end&&this.keyFrames.size&&(this.curr+=1),this.range.end===this.end&&this.keyFrames.size&&(this.range.end+=1),this.keyFrames.size&&(this.end+=1),this.keyFrames.push(pe),this.end-this.start>=this.keyFrames.maxlen&&(this.range.start===this.start&&(this.range.start+=1),this.start+=1),this.signal.emit("UPDATE_TIMELINE",{}),this.signal.emit("UPDATE_FRAME_BUFFER",{}))}),ue(this,"addClip",({data:pe})=>{const he=(pe==null?void 0:pe.name)||`clip-${Object.keys(this.clips).length}`;typeof pe.start!="number"&&(pe.start=0,pe.end=pe.frames.length),this.clips[he]=pe,this.signal.emit("UPDATE_CLIPS",{})}),ue(this,"moveClip",(pe,he,ge)=>{const me=this.clips[pe];me&&(typeof he=="number"&&(me.start=he),typeof ge=="number"&&(me.end=ge),this.signal.emit("UPDATE_CLIPS",{}))}),ue(this,"clear",()=>{this.keyFrames.clear(),this.start=0,this.end=0,this.range.start=this.start,this.range.end=this.end,this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"seekNext",()=>{this.step(),this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"seekPrevious",()=>{this.step(-1),this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"reset",()=>{this.curr=this.range.start,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"seekEnd",()=>{this.curr=this.range.end,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"emitSeek",pe=>{this.curr=pe,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"setFrameRate",pe=>{this.fps=pe,this.signal.emit("UPDATE_STATE",{})}),ue(this,"setSpeed",pe=>{this.speed=pe,this.signal.emit("UPDATE_STATE",{})}),ue(this,"setRange",({start:pe,end:he})=>{typeof pe=="number"&&(this.range.start=pe),typeof pe=="function"&&(this.range.start=pe(this.range.start)),typeof he=="number"&&(this.range.end=he),typeof he=="function"&&(this.range.end=he(this.range.end)),this.signal.emit("UPDATE_TIMELINE",{})}),ue(this,"toggleRecording",()=>{this.isRecording=!this.isRecording,this.isPaused=!0,this.signal.emit("UPDATE_STATE",{})}),ue(this,"pausePlayback",()=>{const pe=this.isPaused;this.isPaused=!0,pe!==this.isPaused&&this.signal.emit("UPDATE_STATE",{})}),ue(this,"togglePlayback",()=>{const pe=this.isPaused,he=this.isRecording;this.isPaused?(this.isRecording=!1,this.curr===this.range.end?(this.curr=this.range.start,this.store.publish(this.currentFrame),this.signal.emit("UPDATE_TIMELINE",{}),this.loop&&(this.isPaused=!1)):this.isPaused=!1):this.isPaused=!0,(pe!==this.isPaused||he!==this.isRecording)&&this.signal.emit("UPDATE_STATE",{})}),ue(this,"toggleLoop",()=>{this.loop=!this.loop,this.signal.emit("UPDATE_STATE",{})}),this.maxlen=_,this.fps=Z,this.speed=te,this.start=ie,this.end=oe,this.curr=se,this.isPaused=ce,this.isRecording=de,this.loop=fe,this._keyFrames=new Deque(ne,_),this.store=new Store,this.range=new Range(ae,le),this.signal=new EventEmitter}get keyFrames(){return this._keyFrames}loadFrameBuffer(_){this.maxlen=Math.max(this.maxlen,_.length),this._keyFrames=new Deque(_,this.maxlen)}get duration(){return this.keyFrames.size}get progress(){const _=this.range.end-this.range.start;return 100*(this.curr-this.range.start)/Math.max(_,1)}step(_=1){const Z=this.curr;let te=Z+_;return _>0?(te>this.range.end&&(this.loop?te=this.range.start:(te=this.range.end,this.keyFrames.size&&(this.isPaused=!0,this.signal.emit("UPDATE_STATE",{})))),te<this.range.start&&(te=this.range.start)):_<0&&(te<this.range.start&&(this.loop?te=this.range.end:(te=this.range.start,this.keyFrames.size&&(this.isPaused=!0))),te>this.range.end&&(te=this.range.end)),Z===te||!this.keyFrames.size?null:(this.curr=te,this.currentFrame)}get currentFrame(){return this.keyFrames.get(Math.round(this.curr)-this.start)}get firstFrame(){return this.keyFrames.get(0)}get lastFrame(){return this.keyFrames.get(this.keyFrames.size-1)}}const PlaybackContext=reactExports.createContext(null),PlaybackStateContext=reactExports.createContext(null),TimelineStateContext=reactExports.createContext(null),PlaybackProvider=({children:K})=>{const[_,Z]=reactExports.useState(null);return reactExports.useEffect(()=>(Z(new Playback),()=>{console.log("cleanup"),Z(null)}),[]),useAnimationFrame(_==null?void 0:_.render),jsxRuntimeExports.jsx(PlaybackContext.Provider,{value:_,children:K})},usePlayback=()=>reactExports.useContext(PlaybackContext),PlaybackStateProvider=({children:K})=>{const _=usePlayback(),[Z,te]=reactExports.useState();return reactExports.useEffect(()=>_?(te({fps:_.fps,speed:_.speed,maxlen:_.maxlen,recording:_.isRecording,loop:_.loop,paused:_.isPaused}),_.signal.on("UPDATE_STATE",()=>{te(ne=>({...ne,fps:_.fps,speed:_.speed,maxlen:_.maxlen,recording:_.isRecording,loop:_.loop,paused:_.isPaused}))})):void 0,[_]),reactExports.useEffect(()=>_?_.signal.on("UPDATE_FRAME_BUFFER",()=>{}):void 0,[_]),jsxRuntimeExports.jsx(PlaybackStateContext.Provider,{value:Z,children:K})},usePlaybackStates=()=>reactExports.useContext(PlaybackStateContext),TimelineStateProvider=({children:K})=>{const _=usePlayback(),[Z,te]=reactExports.useState();return reactExports.useEffect(()=>_?(te({curr:_.curr,start:_.start,end:_.end,rangeStart:_.range.start,rangeEnd:_.range.end}),_.signal.on("UPDATE_TIMELINE",()=>{te(ne=>({...ne,curr:_.curr,start:_.start,end:_.end,rangeStart:_.range.start,rangeEnd:_.range.end}))})):void 0,[_]),jsxRuntimeExports.jsx(TimelineStateContext.Provider,{value:Z,children:K})},useTimelineStates=()=>reactExports.useContext(TimelineStateContext),timelineContainer="_timelineContainer_qu5eg_1",timeline="_timeline_qu5eg_1",visibleContainer="_visibleContainer_qu5eg_52",scrollContainer="_scrollContainer_qu5eg_58",playheadCursor="_playheadCursor_qu5eg_64",trackContainer="_trackContainer_qu5eg_76",trackPlaceholder="_trackPlaceholder_qu5eg_82",ZOOM_SPEED=25e-6,ZOOM_MIN=.05,MAX_SCALE=.5,MIN_SCALE=50;function Timeline({children:K}){var _;const Z=reactExports.useRef(null),te=reactExports.useRef(null),ne=reactExports.useRef(null),ie=useSize(Z),[{scale:oe,offset:se},ae]=useStorage("timeline-scale-offset",{scale:1,offset:.5*ie.width}),le=oe*ie.width;reactExports.useEffect(()=>{Z.current&&(Z.current.scrollLeft=se)},[se,ie.width>0]);const ce=usePlayback(),fe=useTimelineStates();if(!ce||!fe)return jsxRuntimeExports.jsx("div",{children:"loading timeline"});const de=ce.duration>0,pe=(_=Z.current)==null?void 0:_.scrollLeft,{start:he,end:ge,rangeStart:me,rangeEnd:Ae,curr:ye}=fe;return jsxRuntimeExports.jsxs("div",{className:timelineContainer,children:[!de&&jsxRuntimeExports.jsx("div",{className:trackPlaceholder,children:"Playback buffer is empty"}),jsxRuntimeExports.jsx("div",{ref:Z,className:timeline,onWheel:ve=>{var _e;ve.stopPropagation();const Te=(_e=Z.current)==null?void 0:_e.scrollLeft;if(Math.abs(ve.deltaX)>Math.abs(ve.deltaY))return ae({offset:clamp(se+ve.deltaX,0,le),scale:oe});if(!ve.altKey)return ae({offset:clamp(se+ve.deltaY,0,le),scale:oe});const be=ve.clientX-.5*ie.width+Te;te.current.style.left=`${be}px`;const Re=Math.max(1,Math.abs(ve.deltaY));let we=(1-Math.sign(ve.deltaY)*Math.max(ZOOM_MIN,Re*ZOOM_SPEED))*oe;we=Math.max(MAX_SCALE,we),we=Math.min(MIN_SCALE*Math.max(ce.end-ce.start,1)/ie.width,we);const Pe=Te+(we-oe)/oe*be;ae({scale:we,offset:clamp(Pe,0,le)})},onPointerDown:ve=>{var _e;if(ve.button!==MouseButton.Left)return;const Te=(_e=Z.current)==null?void 0:_e.scrollLeft;let be=ve.clientX-.5*ie.width+Te;be=Math.max(0,be),be=Math.min(le,be),te.current.style.left=`${be}px`;const Re=Math.round(be/le*(ce.end-ce.start)+ce.start);ce.emitSeek(Re)},onPointerUp:ve=>{ve.button===MouseButton.Left&&(Z.current.style.cursor="",te.current.style.display="")},onPointerMove:ve=>{var _e;const Te=(_e=Z.current)==null?void 0:_e.scrollLeft;let be=ve.clientX-.5*ie.width+Te;try{te.current.style.left=`${be}px`}catch(we){console.error(we)}be=Math.max(0,be),be=Math.min(le,be);const Re=Math.round(be/le*Math.max(ce.end-ce.start,1)+ce.start);ve.buttons&MouseMask.Primary&&ce.emitSeek(Re)},children:jsxRuntimeExports.jsx("div",{className:visibleContainer,style:{width:`calc(100% + ${le}px)`},children:jsxRuntimeExports.jsxs("div",{className:scrollContainer,style:{width:`${le}px`,left:`calc((100% - ${le}px) * 0.5)`},children:[jsxRuntimeExports.jsx(Timestamps,{start:he,end:ge,firstVisibleFrame:he-(.5*ie.width-pe)/le*Math.max(ge-he,1),lastVisibleFrame:he+(ie.width-.5*ie.width+pe)/le*Math.max(ge-he,1),segmentDensity:Math.floor(40*Math.max(ge-he,1)/le)}),jsxRuntimeExports.jsx("div",{ref:te,className:playheadCursor}),jsxRuntimeExports.jsx(Playhead,{seeking:ye,leftPos:(ye-he)/Math.max(ge-he,1)*le}),ce&&jsxRuntimeExports.jsx(RangeSelector,{rangeRef:ne,rangeStart:me,rangeEnd:Ae,viewWidth:le,playback:ce}),jsxRuntimeExports.jsx("div",{className:trackContainer,style:{opacity:de?1:0},children:K})]})})})]})}function parseCSV(K,_={}){const{delimiter:Z=",",hasHeader:te=!0}=_,ne=K.trim().split(`
`);if(ne.length===0)return[];let ie=[];const oe=[];return te&&(ie=ne[0].split(Z).map(se=>se.trim()),ne.shift()),ne.forEach(se=>{const ae=se.split(Z).map(ce=>ce.trim()),le={};ae.forEach((ce,fe)=>{const de=te?ie[fe]??`column${fe+1}`:`column${fe+1}`;le[de]=ce}),oe.push(le)}),oe}function isCsv(K){const _=K.trim().split(`
`);if(_.length===0)return!1;const Z=_.some(ne=>ne.includes(",")),te=_.every(ne=>!ne.trim().startsWith("{")&&!ne.trim().endsWith("}"));return Z&&te}function isJson(K){try{return JSON.parse(K),!0}catch{return!1}}const TimelineFileDrop=({children:K})=>{const _=usePlayback(),Z=reactExports.useCallback(async(te,ne)=>{const ie=Object.keys(te)[0],oe=te[ie],se=await fetch(oe).then(ae=>ae.text()).then(ae=>{if(isCsv(ae))return parseCSV(ae);if(isJson(ae))return JSON.parse(ae)});se==null||se.map(ae=>_.addKeyFrame(ae,!0)),ne()},[_]);return jsxRuntimeExports.jsx(FileDropContainer,{onLoad:Z,style:{height:"calc(100% - 47px)"},prompt:"timeline files supported: *.csv *.json",children:K})},codeStyle="_codeStyle_1tml4_1",frameStyle="_frameStyle_1tml4_7",frameTimeStyle="_frameTimeStyle_1tml4_11";function Timestamp({title:K="Current Time",frame:_,frameTime:Z,right:te=!1,fps:ne,speed:ie,...oe}){const se=ie%1!==0?2:0,ae=_/ne;return jsxRuntimeExports.jsxs("code",{title:`${K} ${_} ${ae}`,className:codeStyle,style:{textAlign:te?"right":"left"},...oe,children:[!te&&jsxRuntimeExports.jsxs("span",{className:frameStyle,children:["[",_==null?void 0:_.toFixed(se),"]"]}),jsxRuntimeExports.jsx("span",{title:`${K} [HH:MM:SS:FF]`,className:frameTimeStyle,children:Z==null?void 0:Z.toFixed(se)}),te&&jsxRuntimeExports.jsxs("span",{className:frameStyle,children:["[",_==null?void 0:_.toFixed(se),"]"]})]})}const buttonStyle$1="_buttonStyle_1voiw_1",disabledStyle$1="_disabledStyle_1voiw_22";function IconButton({children:K,onClick:_,title:Z,disabled:te}){return jsxRuntimeExports.jsx("button",{disabled:te,title:Z,className:`${buttonStyle$1} ${te&&disabledStyle$1}`,type:"button",onClick:te?null:_,children:K})}const buttonStyle="_buttonStyle_10wsy_1",disabledStyle="_disabledStyle_10wsy_20";function IconCheckbox({children:K,title:_,titleOff:Z,onChange:te,active:ne,disabled:ie}){Array.isArray(K)||(K=[K]);const[oe,se,...ae]=[...K,null];return jsxRuntimeExports.jsx("button",{title:ne?_:Z,onClick:te,className:`${buttonStyle} ${ie&&disabledStyle}`,style:{color:ne&&"var(--theme) !important"},children:ne?oe:se||oe})}const containerStyle$1="_containerStyle_10utv_1",inputStyle="_inputStyle_10utv_44";function Input$1({value:K,onChange:_,width:Z,prefix:te,postfix:ne,...ie}){const oe=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{oe.current&&(oe.current.size=Math.max(oe.current.value.length,1))},[K]);const se=reactExports.useCallback(ae=>{const le=ae.target.value,ce=parseFloat(le);Number.isNaN(ce)||_(ce)},[]);return jsxRuntimeExports.jsx("div",{className:containerStyle$1,"data-postfix":ne,"data-prefix":te,children:jsxRuntimeExports.jsx("input",{ref:oe,className:inputStyle,style:{width:`${Z}`},value:K,onChange:se,onSubmit:se,...ie})})}const style$3="_style_1gufv_1";function Select({title:K,options:_,width:Z,value:te,onChange:ne=null,disabled:ie}){const oe=reactExports.useCallback(se=>{ne&&(ne(_[parseInt(se.target.value)].value),se.target.blur())},[ne]);return jsxRuntimeExports.jsx("select",{title:K,disabled:ie,className:style$3,style:{width:typeof Z=="number"?`${Z}px`:Z},value:_.findIndex(se=>se.value===te),onChange:oe,children:_.map((se,ae)=>jsxRuntimeExports.jsx("option",{value:ae,children:se.text},String(se.value)))})}function Trash(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 448 512",fill:"currentColor",className:svg$8,children:jsxRuntimeExports.jsx("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"})})}const style$2="_style_1h298_1",SavePlayback=({})=>{const K=usePlayback(),_=usePlaybackStates(),Z=useTimelineStates();if(!_||!Z)return null;const{fps:te,speed:ne,paused:ie,maxlen:oe,recording:se,loop:ae}=_,{start:le,end:ce,rangeStart:fe,rangeEnd:de}=Z;return jsxRuntimeExports.jsx(IconButton,{title:"Save snapshot",onClick:()=>{const pe=K.keyFrames.toArray();if(!pe){console.error("No keyFrames to save.");return}const he=new Blob([JSON.stringify(pe,null,2)],{type:"application/json"}),ge=URL.createObjectURL(he),me=document.createElement("a");me.href=ge,me.download="keyframes.json",me.click(),URL.revokeObjectURL(ge)},children:jsxRuntimeExports.jsx(Save,{})})};function PlaybackControls({playback:K,maxlen:_,speed:Z,paused:te,loop:ne,recording:ie}){const oe=reactExports.useMemo(()=>[{value:.125,text:"12.5%"},{value:.25,text:"25%"},{value:.5,text:"50%"},{value:1,text:"✕1"},{value:1.5,text:"✕1.5"},{value:2,text:"✕2"},{value:4,text:"✕4"}],[]);return jsxRuntimeExports.jsxs("div",{className:style$2,children:[jsxRuntimeExports.jsx(Select,{title:"Playback speed",width:60,options:oe,value:Z,onChange:se=>K.setSpeed(se)}),jsxRuntimeExports.jsx(IconButton,{title:"Start [Shift + Left arrow]",onClick:()=>K.reset(),children:jsxRuntimeExports.jsx(SkipPrevious,{})}),jsxRuntimeExports.jsx(IconButton,{title:"Previous frame [Left arrow]",onClick:()=>K.seekPrevious(),children:jsxRuntimeExports.jsx(FastRewind,{})}),jsxRuntimeExports.jsx(IconButton,{title:te?"Pause [Space]":"Play [Space]",onClick:()=>K.togglePlayback(),children:te?jsxRuntimeExports.jsx(PlayArrow,{}):jsxRuntimeExports.jsx(Pause,{})}),jsxRuntimeExports.jsx(IconButton,{title:"Next frame [Right arrow]",onClick:()=>K.seekNext(),children:jsxRuntimeExports.jsx(FastForward,{})}),jsxRuntimeExports.jsx(IconButton,{title:"End [Shift + Right arrow]",onClick:()=>K.seekEnd(),children:jsxRuntimeExports.jsx(SkipNext,{})}),jsxRuntimeExports.jsx(IconCheckbox,{title:"Disable looping [L]",titleOff:"Enable looping [L]",active:ne,onChange:()=>K.toggleLoop(),children:jsxRuntimeExports.jsx(Repeat,{})}),jsxRuntimeExports.jsx(Input$1,{title:"Current framerate",value:K.fps,postfix:"FPS",onChange:se=>K.setFrameRate(se),type:"number",width:K.fps>=100?"33px":"25px"}),jsxRuntimeExports.jsx(IconButton,{title:"Save snapshot",children:jsxRuntimeExports.jsx(PhotoCamera,{})}),jsxRuntimeExports.jsx(SavePlayback,{}),jsxRuntimeExports.jsx(Input$1,{title:"Current framerate",value:_,prefix:"Maxlen ",onChange:se=>K.setMaxlen(se),type:"number",width:"50px"}),jsxRuntimeExports.jsx(IconButton,{title:ie?"Stop Recording":"Record",onClick:()=>K.toggleRecording(),children:jsxRuntimeExports.jsx(Recording,{active:ie})}),jsxRuntimeExports.jsx(IconButton,{title:"clear the key frames buffer",onClick:()=>K.clear(),children:jsxRuntimeExports.jsx(Trash,{})})]})}const playbackBar="_playbackBar_1kd28_1",progressBar="_progressBar_1kd28_41",PlaybackBar=({})=>{const K=usePlayback(),_=usePlaybackStates(),Z=useTimelineStates();if(!_||!Z)return null;const{fps:te,speed:ne,paused:ie,maxlen:oe,recording:se,loop:ae}=_,{start:le,end:ce,rangeStart:fe,rangeEnd:de}=Z;return jsxRuntimeExports.jsxs("div",{className:playbackBar,children:[jsxRuntimeExports.jsx(Timestamp,{title:"Current time",frame:fe,frameTime:(fe-le)/te,fps:te,speed:ne}),jsxRuntimeExports.jsx(PlaybackControls,{playback:K,maxlen:oe,speed:ne,paused:ie,loop:ae,recording:se}),jsxRuntimeExports.jsx(Timestamp,{title:"Duration",frame:de,frameTime:(de-le)/te,right:!0,fps:te,speed:ne}),jsxRuntimeExports.jsx("div",{className:progressBar,style:{width:`${K.progress||0}%`}})]})};function AutoScroll({_key:K,children:_,...Z}){const te=reactExports.useRef(null),ne=reactExports.useMemo(()=>()=>{setTimeout(()=>{var ie;(ie=te.current)==null||ie.scrollIntoView({behavior:"smooth"})},.016)},[]);return reactExports.useEffect(()=>{ne()},[_,ne]),jsxRuntimeExports.jsxs("div",{...Z,children:[_,jsxRuntimeExports.jsx("div",{ref:te})]},K)}function Button({_key:K,value:_,...Z}){const{sendMsg:te}=useSocket();return jsxRuntimeExports.jsx("button",{onClick:()=>te({etype:"CLICK",key:K}),...Z,children:_})}function Slider({_key:K,value:_,children:Z,...te}){const{sendMsg:ne}=useSocket(),[ie,oe]=reactExports.useState(_||0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("input",{type:"range",value:ie,onMouseUp:({target:se})=>{const{value:ae}=se;ne({etype:"SET",key:K,value:ae})},onChange:({target:se})=>{oe(Number(se.value))},...te}),jsxRuntimeExports.jsx("span",{children:ie})]})}function Img({_key:K,children:_,alt:Z,...te}){const{sendMsg:ne}=useSocket();return jsxRuntimeExports.jsx("img",{alt:Z||K,className:"input-image",onClick:ie=>{console.log("click on image"),ie.preventDefault(),ie.stopPropagation();const oe=ie.target.getBoundingClientRect(),se=ie.clientX-oe.left,ae=ie.clientY-oe.top;ne({etype:"CLICK",key:K,value:{x:se,y:ae,w:oe.width,h:oe.height}})},...te})}function Input({_key:K,value:_,style:Z,textareaStyle:te={},placeholder:ne,defaultValue:ie,clearOnSubmit:oe,children:se,...ae}){const[le,ce]=reactExports.useState(_),{sendMsg:fe}=useSocket(),de=reactExports.useMemo(()=>({target:he})=>{ce(he.value)},[]),pe=reactExports.useMemo(()=>he=>{if(he.keyCode==39&&!le){if(!ie)return;he.preventDefault(),ce(ie)}he.keyCode==13&&!he.shiftKey&&(he.preventDefault(),fe({etype:"INPUT",key:K,value:le}),oe&&ce(""))},[le]);return jsxRuntimeExports.jsx("form",{style:{flex:"0 0 auto",height:"200px",display:"flex",flexDirection:"column",...Z},...ae,children:jsxRuntimeExports.jsx("textarea",{placeholder:ne||`"${ie}" [ press ➡ for default, ⏎ to submit ]`,value:le,onChange:de,onKeyUp:pe,style:{flex:"1 1 auto",height:"100%",width:"100%",padding:"10px",marginTop:"5px",border:"1.5px solid #eee",borderRadius:"5px",...te}})})}function ImageUpload({_key:K,label:_}){const{sendMsg:Z}=useSocket(),[te,ne]=reactExports.useState(null),ie=reactExports.useCallback(oe=>{var se,ae;const le=(ae=(se=oe==null?void 0:oe.target)==null?void 0:se.files)==null?void 0:ae[0];le&&ne(le)},[]);return jsxRuntimeExports.jsxs("form",{onSubmit:oe=>{oe.preventDefault(),te&&imageToBase64(te).then(se=>{const ae=se.slice(22);Z({etype:"UPLOAD",key:K,value:ae})})},children:[jsxRuntimeExports.jsxs("label",{htmlFor:"file",children:[_," "]}),jsxRuntimeExports.jsx("input",{type:"file",onChange:ie}),jsxRuntimeExports.jsx("input",{type:"submit",value:"Submit"})]})}function Div({_key:K,..._}){return jsxRuntimeExports.jsx("div",{..._},K)}function Span({_key:K,text:_,...Z}){return jsxRuntimeExports.jsx("span",{...Z,children:_})}function getJsDeliverUrl(K,_,Z="latest",te="dist/index.js",ne=!1){return K?(console.warn(`loading third party scripts from ${K}`),K):ne?`dev_modules/${_}/${te}?ts=${Date.now()}`:`https://cdn.jsdelivr.net/npm/${_}@${Z}/${te}`}const ContribLoader=({_key:K="contrib-loader",url:_,async:Z=!1,library:te,version:ne="latest",main:ie="dist/index.js",dev:oe=!1,prodOnly:se=!1,dependencies:ae,onLoad:le,onError:ce})=>{var fe,de;const pe=_||getJsDeliverUrl(_,te,ne,ie,oe),[he,ge]=React.useState(!1),{uplink:me}=useSocket(),Ae=typeof le=="string"?le:"ON_CONTRIB_LOAD",ye=reactExports.useCallback(()=>{typeof le=="function"&&le(),console.info(`loaded script from ${pe}`),ge(!0);const be=CONTRIB_MODULE_ENTRYPOINTS[te];be&&be(),delete CONTRIB_MODULE_ENTRYPOINTS[te],console.info("called entrypoint, removing from CONTRIB_LOADER_ENTRIES",CONTRIB_MODULE_ENTRYPOINTS),me.publish({etype:Ae,key:K,value:{url:pe,library:te,version:ne,main:ie}})},[_,me]),ve=reactExports.useCallback(be=>{const Re=`Failed to load script from library ${te} at ${pe}: ${be}`;ce&&ce(new Error(Re))},[ce]),_e=queryString.parse(document$4.location.search),Te=(de=(fe=document$4.location.host)==null?void 0:fe.startsWith)==null?void 0:de.call(fe,"localhost");if(_e.safemode)return console.info("safemode is enabled. skipping script loading."),le&&ye(),null;if(!oe&&se&&Te)return console.info("running in debug mode locally. Skipping script loading."),le&&ye(),null;reactExports.useEffect(()=>{if(he)return;for(let we=0;we<(ae==null?void 0:ae.length);we++){const Pe=ae[we];if(!window[Pe]){console.warn(`${Pe} is not loaded or does not exist on window.`);return}}const be=`contrib-loader-${te}`;if(![...document$4.querySelectorAll("script")].filter(we=>we.src===pe||we.id===be).length){console.log("loading script",pe);var Re=document$4.createElement("script");Re.src=pe,Re.id=be,Re.async=Z,Re.type="text/javascript",Re.onload=ye,Re.onError=ve,document$4.getElementsByTagName("body")[0].appendChild(Re)}},[he,pe])},RenderContext=reactExports.createContext({});function buttonHelper(K,{type:_,etype:Z,...te},ne){return _==="BUTTON"?button(()=>ne({key:K,etype:Z}),te):{type:_,...te}}function Render({layers:K=[],settings:_={},children:Z=[]}){let te,ne;const ie=reactExports.useMemo(()=>({layers:new Set}),[]),{uplink:oe}=useSocket();[te,ne]=useControls("Render",()=>({renderHeight:{value:768,min:1,max:2304,step:1,pad:1,label:"Height"},"Res Presets":buttonGroup({opts:{384:()=>ne({renderHeight:384}),480:()=>ne({renderHeight:480}),768:()=>ne({renderHeight:768}),960:()=>ne({renderHeight:960}),1536:()=>ne({renderHeight:1536})}}),progressive:{value:-2,min:-3,max:0,step:.5,label:"Progressive Scale"},Presets:buttonGroup({opts:{"-3":()=>ne({progressive:-3}),"-2.5":()=>ne({progressive:-2.5}),"-2":()=>ne({progressive:-2}),"-1.5":()=>ne({progressive:-1.5}),"-1":()=>ne({progressive:-1}),"-1/2":()=>ne({progressive:-.5}),"/":()=>ne({progressive:0})}})}),[K]);const se=reactExports.useMemo(()=>Object.entries(_||{}).reduce((de,[pe,he])=>({...de,[pe]:buttonHelper(pe,he,oe.publish)}),{}),[_]),ae=reactExports.useMemo(()=>{const de=Z.map(pe=>[pe.key,{value:K.indexOf(pe.key)>=0,label:`[${pe.key}]`}]);return Object.fromEntries(de)},[]),le=useControls("Render.Layers",ae,[K]),ce=reactExports.useMemo(()=>Z.filter(de=>le[de.key]),[le]),fe=useControls("Render.more․․․",se,{collapsed:!0});return reactExports.useEffect(()=>(setTimeout(()=>oe==null?void 0:oe.publish({etype:"CAMERA_UPDATE",ts:Date.now()}),0),oe.addReducer("CAMERA_MOVE",({value:{render:de,...pe},...he})=>({...he,value:{...pe,render:{...de,...te,...fe,layers:ce.map(ge=>ge.key)}}}))),[ce,oe,fe,te]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[fe.use_aabb?jsxRuntimeExports.jsx(GroupSlave,{children:jsxRuntimeExports.jsx(BBox,{min:fe.aabb_min,max:fe.aabb_max})}):null,jsxRuntimeExports.jsx(RenderContext.Provider,{value:ie,children:ce})]})}function RenderLayer({_key:K,title:_=`Render.Channel [${K}]`,channel:Z,alphaChannel:te,settings:ne,distance:ie=10,interpolate:oe=!1,opacity:se=1,folderOptions:ae}){const[le,ce]=reactExports.useState(),[fe,de]=reactExports.useState(),{uplink:pe,downlink:he}=useSocket(),ge=reactExports.useMemo(()=>Object.entries(ne||{}).reduce((ve,[_e,Te])=>({...ve,[_e]:buttonHelper(_e,Te,pe.publish)}),{}),[ne,pe.publish]),me=useControls(_,ge,ae,[ne]);reactExports.useLayoutEffect(()=>(setTimeout(()=>pe==null?void 0:pe.publish({etype:"CAMERA_UPDATE",ts:Date.now()}),0),pe.addReducer("CAMERA_MOVE",({value:{render:ve={},..._e},...Te})=>({...Te,value:{..._e,render:{...ve,[K]:me}}}),Z)),[pe,me]);const Ae=useControls(`${_}.more․․․`,{interpolate:oe,distance:ie,opacity:{value:se||1,label:"Opacity",min:0,max:1}},{label:"Options",collapsed:!0},[]),ye=reactExports.useCallback(({etype:ve,data:_e})=>{if(ve==="RENDER"){if(Z in _e){const Te=_e[me.channel||Z];if(!Te)return;ce(Te)}if(te in _e){const Te=_e[me.alphaChannel||te];if(!Te)return;de(Te)}}},[me.useAlpha]);return reactExports.useLayoutEffect(()=>he.subscribe("RENDER",ye),[he]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[me.use_aabb?jsxRuntimeExports.jsx(GroupSlave,{children:jsxRuntimeExports.jsx("group",{position:v3array(me.position),rotation:rot2array(me.rotation),scale:scale2array(me.scale),children:jsxRuntimeExports.jsx(BBox,{min:me.aabb_min,max:me.aabb_max})})}):null,le?jsxRuntimeExports.jsx(ImageBackground,{src:le,alphaSrc:me.useAlpha?fe:void 0,distanceToCamera:Ae.distance,interpolate:Ae.interpolate,opacity:Ae.opacity}):null]})}const VOID=-1,PRIMITIVE=0,ARRAY=1,OBJECT=2,DATE=3,REGEXP=4,MAP=5,SET=6,ERROR=7,BIGINT=8,env=typeof self=="object"?self:globalThis,deserializer=(K,_)=>{const Z=(ne,ie)=>(K.set(ie,ne),ne),te=ne=>{if(K.has(ne))return K.get(ne);const[ie,oe]=_[ne];switch(ie){case PRIMITIVE:case VOID:return Z(oe,ne);case ARRAY:{const se=Z([],ne);for(const ae of oe)se.push(te(ae));return se}case OBJECT:{const se=Z({},ne);for(const[ae,le]of oe)se[te(ae)]=te(le);return se}case DATE:return Z(new Date(oe),ne);case REGEXP:{const{source:se,flags:ae}=oe;return Z(new RegExp(se,ae),ne)}case MAP:{const se=Z(new Map,ne);for(const[ae,le]of oe)se.set(te(ae),te(le));return se}case SET:{const se=Z(new Set,ne);for(const ae of oe)se.add(te(ae));return se}case ERROR:{const{name:se,message:ae}=oe;return Z(new env[se](ae),ne)}case BIGINT:return Z(BigInt(oe),ne);case"BigInt":return Z(Object(BigInt(oe)),ne);case"ArrayBuffer":return Z(new Uint8Array(oe).buffer,oe);case"DataView":{const{buffer:se}=new Uint8Array(oe);return Z(new DataView(se),oe)}}return Z(new env[ie](oe),ne)};return te},deserialize=K=>deserializer(new Map,K)(0),EMPTY="",{toString:toString$3}={},{keys:keys$1}=Object,typeOf$1=K=>{const _=typeof K;if(_!=="object"||!K)return[PRIMITIVE,_];const Z=toString$3.call(K).slice(8,-1);switch(Z){case"Array":return[ARRAY,EMPTY];case"Object":return[OBJECT,EMPTY];case"Date":return[DATE,EMPTY];case"RegExp":return[REGEXP,EMPTY];case"Map":return[MAP,EMPTY];case"Set":return[SET,EMPTY];case"DataView":return[ARRAY,Z]}return Z.includes("Array")?[ARRAY,Z]:Z.includes("Error")?[ERROR,Z]:[OBJECT,Z]},shouldSkip=([K,_])=>K===PRIMITIVE&&(_==="function"||_==="symbol"),serializer=(K,_,Z,te)=>{const ne=(oe,se)=>{const ae=te.push(oe)-1;return Z.set(se,ae),ae},ie=oe=>{if(Z.has(oe))return Z.get(oe);let[se,ae]=typeOf$1(oe);switch(se){case PRIMITIVE:{let ce=oe;switch(ae){case"bigint":se=BIGINT,ce=oe.toString();break;case"function":case"symbol":if(K)throw new TypeError("unable to serialize "+ae);ce=null;break;case"undefined":return ne([VOID],oe)}return ne([se,ce],oe)}case ARRAY:{if(ae){let de=oe;return ae==="DataView"?de=new Uint8Array(oe.buffer):ae==="ArrayBuffer"&&(de=new Uint8Array(oe)),ne([ae,[...de]],oe)}const ce=[],fe=ne([se,ce],oe);for(const de of oe)ce.push(ie(de));return fe}case OBJECT:{if(ae)switch(ae){case"BigInt":return ne([ae,oe.toString()],oe);case"Boolean":case"Number":case"String":return ne([ae,oe.valueOf()],oe)}if(_&&"toJSON"in oe)return ie(oe.toJSON());const ce=[],fe=ne([se,ce],oe);for(const de of keys$1(oe))(K||!shouldSkip(typeOf$1(oe[de])))&&ce.push([ie(de),ie(oe[de])]);return fe}case DATE:return ne([se,oe.toISOString()],oe);case REGEXP:{const{source:ce,flags:fe}=oe;return ne([se,{source:ce,flags:fe}],oe)}case MAP:{const ce=[],fe=ne([se,ce],oe);for(const[de,pe]of oe)(K||!(shouldSkip(typeOf$1(de))||shouldSkip(typeOf$1(pe))))&&ce.push([ie(de),ie(pe)]);return fe}case SET:{const ce=[],fe=ne([se,ce],oe);for(const de of oe)(K||!shouldSkip(typeOf$1(de)))&&ce.push(ie(de));return fe}}const{message:le}=oe;return ne([se,{name:ae,message:le}],oe)};return ie},serialize=(K,{json:_,lossy:Z}={})=>{const te=[];return serializer(!(_||Z),!!_,new Map,te)(K),te},structuredClone$1=typeof structuredClone=="function"?(K,_)=>_&&("json"in _||"lossy"in _)?deserialize(serialize(K,_)):structuredClone(K):(K,_)=>deserialize(serialize(K,_));let Schema$4=class{constructor(K,_,Z){this.normal=_,this.property=K,Z&&(this.space=Z)}};Schema$4.prototype.normal={};Schema$4.prototype.property={};Schema$4.prototype.space=void 0;function merge$4(K,_){const Z={},te={};for(const ne of K)Object.assign(Z,ne.property),Object.assign(te,ne.normal);return new Schema$4(Z,te,_)}function normalize$9(K){return K.toLowerCase()}let Info$4=class{constructor(K,_){this.attribute=_,this.property=K}};Info$4.prototype.attribute="";Info$4.prototype.booleanish=!1;Info$4.prototype.boolean=!1;Info$4.prototype.commaOrSpaceSeparated=!1;Info$4.prototype.commaSeparated=!1;Info$4.prototype.defined=!1;Info$4.prototype.mustUseProperty=!1;Info$4.prototype.number=!1;Info$4.prototype.overloadedBoolean=!1;Info$4.prototype.property="";Info$4.prototype.spaceSeparated=!1;Info$4.prototype.space=void 0;let powers$2=0;const boolean$3=increment$2(),booleanish$3=increment$2(),overloadedBoolean$2=increment$2(),number$4=increment$2(),spaceSeparated$4=increment$2(),commaSeparated$3=increment$2(),commaOrSpaceSeparated$2=increment$2();function increment$2(){return 2**++powers$2}const types$6=Object.freeze(Object.defineProperty({__proto__:null,boolean:boolean$3,booleanish:booleanish$3,commaOrSpaceSeparated:commaOrSpaceSeparated$2,commaSeparated:commaSeparated$3,number:number$4,overloadedBoolean:overloadedBoolean$2,spaceSeparated:spaceSeparated$4},Symbol.toStringTag,{value:"Module"})),checks$2=Object.keys(types$6);let DefinedInfo$4=class extends Info$4{constructor(K,_,Z,te){let ne=-1;if(super(K,_),mark$2(this,"space",te),typeof Z=="number")for(;++ne<checks$2.length;){const ie=checks$2[ne];mark$2(this,checks$2[ne],(Z&types$6[ie])===types$6[ie])}}};DefinedInfo$4.prototype.defined=!0;function mark$2(K,_,Z){Z&&(K[_]=Z)}function create$8(K){const _={},Z={};for(const[te,ne]of Object.entries(K.properties)){const ie=new DefinedInfo$4(te,K.transform(K.attributes||{},te),ne,K.space);K.mustUseProperty&&K.mustUseProperty.includes(te)&&(ie.mustUseProperty=!0),_[te]=ie,Z[normalize$9(te)]=te,Z[normalize$9(ie.attribute)]=te}return new Schema$4(_,Z,K.space)}const aria$4=create$8({properties:{ariaActiveDescendant:null,ariaAtomic:booleanish$3,ariaAutoComplete:null,ariaBusy:booleanish$3,ariaChecked:booleanish$3,ariaColCount:number$4,ariaColIndex:number$4,ariaColSpan:number$4,ariaControls:spaceSeparated$4,ariaCurrent:null,ariaDescribedBy:spaceSeparated$4,ariaDetails:null,ariaDisabled:booleanish$3,ariaDropEffect:spaceSeparated$4,ariaErrorMessage:null,ariaExpanded:booleanish$3,ariaFlowTo:spaceSeparated$4,ariaGrabbed:booleanish$3,ariaHasPopup:null,ariaHidden:booleanish$3,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated$4,ariaLevel:number$4,ariaLive:null,ariaModal:booleanish$3,ariaMultiLine:booleanish$3,ariaMultiSelectable:booleanish$3,ariaOrientation:null,ariaOwns:spaceSeparated$4,ariaPlaceholder:null,ariaPosInSet:number$4,ariaPressed:booleanish$3,ariaReadOnly:booleanish$3,ariaRelevant:null,ariaRequired:booleanish$3,ariaRoleDescription:spaceSeparated$4,ariaRowCount:number$4,ariaRowIndex:number$4,ariaRowSpan:number$4,ariaSelected:booleanish$3,ariaSetSize:number$4,ariaSort:null,ariaValueMax:number$4,ariaValueMin:number$4,ariaValueNow:number$4,ariaValueText:null,role:null},transform(K,_){return _==="role"?_:"aria-"+_.slice(4).toLowerCase()}});function caseSensitiveTransform$4(K,_){return _ in K?K[_]:_}function caseInsensitiveTransform$4(K,_){return caseSensitiveTransform$4(K,_.toLowerCase())}const html$8=create$8({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated$3,acceptCharset:spaceSeparated$4,accessKey:spaceSeparated$4,action:null,allow:null,allowFullScreen:boolean$3,allowPaymentRequest:boolean$3,allowUserMedia:boolean$3,alt:null,as:null,async:boolean$3,autoCapitalize:null,autoComplete:spaceSeparated$4,autoFocus:boolean$3,autoPlay:boolean$3,blocking:spaceSeparated$4,capture:null,charSet:null,checked:boolean$3,cite:null,className:spaceSeparated$4,cols:number$4,colSpan:null,content:null,contentEditable:booleanish$3,controls:boolean$3,controlsList:spaceSeparated$4,coords:number$4|commaSeparated$3,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean$3,defer:boolean$3,dir:null,dirName:null,disabled:boolean$3,download:overloadedBoolean$2,draggable:booleanish$3,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean$3,formTarget:null,headers:spaceSeparated$4,height:number$4,hidden:overloadedBoolean$2,high:number$4,href:null,hrefLang:null,htmlFor:spaceSeparated$4,httpEquiv:spaceSeparated$4,id:null,imageSizes:null,imageSrcSet:null,inert:boolean$3,inputMode:null,integrity:null,is:null,isMap:boolean$3,itemId:null,itemProp:spaceSeparated$4,itemRef:spaceSeparated$4,itemScope:boolean$3,itemType:spaceSeparated$4,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean$3,low:number$4,manifest:null,max:null,maxLength:number$4,media:null,method:null,min:null,minLength:number$4,multiple:boolean$3,muted:boolean$3,name:null,nonce:null,noModule:boolean$3,noValidate:boolean$3,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean$3,optimum:number$4,pattern:null,ping:spaceSeparated$4,placeholder:null,playsInline:boolean$3,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:boolean$3,referrerPolicy:null,rel:spaceSeparated$4,required:boolean$3,reversed:boolean$3,rows:number$4,rowSpan:number$4,sandbox:spaceSeparated$4,scope:null,scoped:boolean$3,seamless:boolean$3,selected:boolean$3,shadowRootClonable:boolean$3,shadowRootDelegatesFocus:boolean$3,shadowRootMode:null,shape:null,size:number$4,sizes:null,slot:null,span:number$4,spellCheck:booleanish$3,src:null,srcDoc:null,srcLang:null,srcSet:null,start:number$4,step:null,style:null,tabIndex:number$4,target:null,title:null,translate:null,type:null,typeMustMatch:boolean$3,useMap:null,value:booleanish$3,width:number$4,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:spaceSeparated$4,axis:null,background:null,bgColor:null,border:number$4,borderColor:null,bottomMargin:number$4,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean$3,declare:boolean$3,event:null,face:null,frame:null,frameBorder:null,hSpace:number$4,leftMargin:number$4,link:null,longDesc:null,lowSrc:null,marginHeight:number$4,marginWidth:number$4,noResize:boolean$3,noHref:boolean$3,noShade:boolean$3,noWrap:boolean$3,object:null,profile:null,prompt:null,rev:null,rightMargin:number$4,rules:null,scheme:null,scrolling:booleanish$3,standby:null,summary:null,text:null,topMargin:number$4,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number$4,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean$3,disableRemotePlayback:boolean$3,prefix:null,property:null,results:number$4,security:null,unselectable:null},space:"html",transform:caseInsensitiveTransform$4}),svg$7=create$8({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:commaOrSpaceSeparated$2,accentHeight:number$4,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number$4,amplitude:number$4,arabicForm:null,ascent:number$4,attributeName:null,attributeType:null,azimuth:number$4,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number$4,by:null,calcMode:null,capHeight:number$4,className:spaceSeparated$4,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number$4,diffuseConstant:number$4,direction:null,display:null,dur:null,divisor:number$4,dominantBaseline:null,download:boolean$3,dx:null,dy:null,edgeMode:null,editable:null,elevation:number$4,enableBackground:null,end:null,event:null,exponent:number$4,externalResourcesRequired:null,fill:null,fillOpacity:number$4,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated$3,g2:commaSeparated$3,glyphName:commaSeparated$3,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number$4,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number$4,horizOriginX:number$4,horizOriginY:number$4,id:null,ideographic:number$4,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number$4,k:number$4,k1:number$4,k2:number$4,k3:number$4,k4:number$4,kernelMatrix:commaOrSpaceSeparated$2,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number$4,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number$4,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number$4,overlineThickness:number$4,paintOrder:null,panose1:null,path:null,pathLength:number$4,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated$4,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number$4,pointsAtY:number$4,pointsAtZ:number$4,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated$2,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated$2,rev:commaOrSpaceSeparated$2,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated$2,requiredFeatures:commaOrSpaceSeparated$2,requiredFonts:commaOrSpaceSeparated$2,requiredFormats:commaOrSpaceSeparated$2,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number$4,specularExponent:number$4,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number$4,strikethroughThickness:number$4,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated$2,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number$4,strokeOpacity:number$4,strokeWidth:null,style:null,surfaceScale:number$4,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated$2,tabIndex:number$4,tableValues:null,target:null,targetX:number$4,targetY:number$4,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated$2,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:number$4,underlineThickness:number$4,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number$4,values:null,vAlphabetic:number$4,vMathematical:number$4,vectorEffect:null,vHanging:number$4,vIdeographic:number$4,version:null,vertAdvY:number$4,vertOriginX:number$4,vertOriginY:number$4,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number$4,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:caseSensitiveTransform$4}),xlink$5=create$8({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(K,_){return"xlink:"+_.slice(5).toLowerCase()}}),xmlns$5=create$8({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:caseInsensitiveTransform$4}),xml$5=create$8({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(K,_){return"xml:"+_.slice(3).toLowerCase()}}),cap$2=/[A-Z]/g,dash$2=/-[a-z]/g,valid$2=/^data[-\w.:]+$/i;function find$3(K,_){const Z=normalize$9(_);let te=_,ne=Info$4;if(Z in K.normal)return K.property[K.normal[Z]];if(Z.length>4&&Z.slice(0,4)==="data"&&valid$2.test(_)){if(_.charAt(4)==="-"){const ie=_.slice(5).replace(dash$2,camelcase$2);te="data"+ie.charAt(0).toUpperCase()+ie.slice(1)}else{const ie=_.slice(4);if(!dash$2.test(ie)){let oe=ie.replace(cap$2,kebab$2);oe.charAt(0)!=="-"&&(oe="-"+oe),_="data"+oe}}ne=DefinedInfo$4}return new ne(te,_)}function kebab$2(K){return"-"+K.toLowerCase()}function camelcase$2(K){return K.charAt(1).toUpperCase()}const html$7=merge$4([aria$4,html$8,xlink$5,xmlns$5,xml$5],"html"),svg$6=merge$4([aria$4,svg$7,xlink$5,xmlns$5,xml$5],"svg");function parse$6(K){const _=[],Z=String(K||"");let te=Z.indexOf(","),ne=0,ie=!1;for(;!ie;){te===-1&&(te=Z.length,ie=!0);const oe=Z.slice(ne,te).trim();(oe||!ie)&&_.push(oe),ne=te+1,te=Z.indexOf(",",ne)}return _}function stringify$5(K,_){const Z={};return(K[K.length-1]===""?[...K,""]:K).join((Z.padRight?" ":"")+","+(Z.padLeft===!1?"":" ")).trim()}const search$1=/[#.]/g;function parseSelector(K,_){const Z=K||"",te={};let ne=0,ie,oe;for(;ne<Z.length;){search$1.lastIndex=ne;const se=search$1.exec(Z),ae=Z.slice(ne,se?se.index:Z.length);ae&&(ie?ie==="#"?te.id=ae:Array.isArray(te.className)?te.className.push(ae):te.className=[ae]:oe=ae,ne+=ae.length),se&&(ie=se[0],ne++)}return{type:"element",tagName:oe||_||"div",properties:te,children:[]}}function parse$5(K){const _=String(K||"").trim();return _?_.split(/[ \t\n\r\f]+/g):[]}function stringify$4(K){return K.join(" ").trim()}function createH(K,_,Z){const te=Z?createAdjustMap(Z):void 0;function ne(ie,oe,...se){let ae;if(ie==null){ae={type:"root",children:[]};const le=oe;se.unshift(le)}else{ae=parseSelector(ie,_);const le=ae.tagName.toLowerCase(),ce=te?te.get(le):void 0;if(ae.tagName=ce||le,isChild(oe))se.unshift(oe);else for(const[fe,de]of Object.entries(oe))addProperty(K,ae.properties,fe,de)}for(const le of se)addChild(ae.children,le);return ae.type==="element"&&ae.tagName==="template"&&(ae.content={type:"root",children:ae.children},ae.children=[]),ae}return ne}function isChild(K){if(K===null||typeof K!="object"||Array.isArray(K))return!0;if(typeof K.type!="string")return!1;const _=K,Z=Object.keys(K);for(const te of Z){const ne=_[te];if(ne&&typeof ne=="object"){if(!Array.isArray(ne))return!0;const ie=ne;for(const oe of ie)if(typeof oe!="number"&&typeof oe!="string")return!0}}return!!("children"in K&&Array.isArray(K.children))}function addProperty(K,_,Z,te){const ne=find$3(K,Z);let ie;if(te!=null){if(typeof te=="number"){if(Number.isNaN(te))return;ie=te}else typeof te=="boolean"?ie=te:typeof te=="string"?ne.spaceSeparated?ie=parse$5(te):ne.commaSeparated?ie=parse$6(te):ne.commaOrSpaceSeparated?ie=parse$5(parse$6(te).join(" ")):ie=parsePrimitive(ne,ne.property,te):Array.isArray(te)?ie=[...te]:ie=ne.property==="style"?style$1(te):String(te);if(Array.isArray(ie)){const oe=[];for(const se of ie)oe.push(parsePrimitive(ne,ne.property,se));ie=oe}ne.property==="className"&&Array.isArray(_.className)&&(ie=_.className.concat(ie)),_[ne.property]=ie}}function addChild(K,_){if(_!=null)if(typeof _=="number"||typeof _=="string")K.push({type:"text",value:String(_)});else if(Array.isArray(_))for(const Z of _)addChild(K,Z);else if(typeof _=="object"&&"type"in _)_.type==="root"?addChild(K,_.children):K.push(_);else throw new Error("Expected node, nodes, or string, got `"+_+"`")}function parsePrimitive(K,_,Z){if(typeof Z=="string"){if(K.number&&Z&&!Number.isNaN(Number(Z)))return Number(Z);if((K.boolean||K.overloadedBoolean)&&(Z===""||normalize$9(Z)===normalize$9(_)))return!0}return Z}function style$1(K){const _=[];for(const[Z,te]of Object.entries(K))_.push([Z,te].join(": "));return _.join("; ")}function createAdjustMap(K){const _=new Map;for(const Z of K)_.set(Z.toLowerCase(),Z);return _}const svgCaseSensitiveTagNames=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],h=createH(html$7,"div"),s=createH(svg$6,"g",svgCaseSensitiveTagNames);function location$1(K){const _=String(K),Z=[];return{toOffset:ne,toPoint:te};function te(ie){if(typeof ie=="number"&&ie>-1&&ie<=_.length){let oe=0;for(;;){let se=Z[oe];if(se===void 0){const ae=next(_,Z[oe-1]);se=ae===-1?_.length+1:ae+1,Z[oe]=se}if(se>ie)return{line:oe+1,column:ie-(oe>0?Z[oe-1]:0)+1,offset:ie};oe++}}}function ne(ie){if(ie&&typeof ie.line=="number"&&typeof ie.column=="number"&&!Number.isNaN(ie.line)&&!Number.isNaN(ie.column)){for(;Z.length<ie.line;){const se=Z[Z.length-1],ae=next(_,se),le=ae===-1?_.length+1:ae+1;if(se===le)break;Z.push(le)}const oe=(ie.line>1?Z[ie.line-2]:0)+ie.column-1;if(oe<Z[ie.line-1])return oe}}}function next(K,_){const Z=K.indexOf("\r",_),te=K.indexOf(`
`,_);return te===-1?Z:Z===-1||Z+1===te?te:Z<te?Z:te}const webNamespaces={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},own$b={}.hasOwnProperty,proto$3=Object.prototype;function fromParse5(K,_){const Z=_||{};return one$2({file:Z.file||void 0,location:!1,schema:Z.space==="svg"?svg$6:html$7,verbose:Z.verbose||!1},K)}function one$2(K,_){let Z;switch(_.nodeName){case"#comment":{const te=_;return Z={type:"comment",value:te.data},patch$1(K,te,Z),Z}case"#document":case"#document-fragment":{const te=_,ne="mode"in te?te.mode==="quirks"||te.mode==="limited-quirks":!1;if(Z={type:"root",children:all$g(K,_.childNodes),data:{quirksMode:ne}},K.file&&K.location){const ie=String(K.file),oe=location$1(ie),se=oe.toPoint(0),ae=oe.toPoint(ie.length);Z.position={start:se,end:ae}}return Z}case"#documentType":{const te=_;return Z={type:"doctype"},patch$1(K,te,Z),Z}case"#text":{const te=_;return Z={type:"text",value:te.value},patch$1(K,te,Z),Z}default:return Z=element$3(K,_),Z}}function all$g(K,_){let Z=-1;const te=[];for(;++Z<_.length;){const ne=one$2(K,_[Z]);te.push(ne)}return te}function element$3(K,_){const Z=K.schema;K.schema=_.namespaceURI===webNamespaces.svg?svg$6:html$7;let te=-1;const ne={};for(;++te<_.attrs.length;){const oe=_.attrs[te],se=(oe.prefix?oe.prefix+":":"")+oe.name;own$b.call(proto$3,se)||(ne[se]=oe.value)}const ie=(K.schema.space==="svg"?s:h)(_.tagName,ne,all$g(K,_.childNodes));if(patch$1(K,_,ie),ie.tagName==="template"){const oe=_,se=oe.sourceCodeLocation,ae=se&&se.startTag&&position$4(se.startTag),le=se&&se.endTag&&position$4(se.endTag),ce=one$2(K,oe.content);ae&&le&&K.file&&(ce.position={start:ae.end,end:le.start}),ie.content=ce}return K.schema=Z,ie}function patch$1(K,_,Z){if("sourceCodeLocation"in _&&_.sourceCodeLocation&&K.file){const te=createLocation(K,Z,_.sourceCodeLocation);te&&(K.location=!0,Z.position=te)}}function createLocation(K,_,Z){const te=position$4(Z);if(_.type==="element"){const ne=_.children[_.children.length-1];if(te&&!Z.endTag&&ne&&ne.position&&ne.position.end&&(te.end=Object.assign({},ne.position.end)),K.verbose){const ie={};let oe;if(Z.attrs)for(oe in Z.attrs)own$b.call(Z.attrs,oe)&&(ie[find$3(K.schema,oe).property]=position$4(Z.attrs[oe]));Z.startTag;const se=position$4(Z.startTag),ae=Z.endTag?position$4(Z.endTag):void 0,le={opening:se};ae&&(le.closing=ae),le.properties=ie,_.data={position:le}}}return te}function position$4(K){const _=point$2({line:K.startLine,column:K.startCol,offset:K.startOffset}),Z=point$2({line:K.endLine,column:K.endCol,offset:K.endOffset});return _||Z?{start:_,end:Z}:void 0}function point$2(K){return K.line&&K.column?K:void 0}let Schema$3=class{constructor(K,_,Z){this.property=K,this.normal=_,Z&&(this.space=Z)}};Schema$3.prototype.property={};Schema$3.prototype.normal={};Schema$3.prototype.space=null;function merge$3(K,_){const Z={},te={};let ne=-1;for(;++ne<K.length;)Object.assign(Z,K[ne].property),Object.assign(te,K[ne].normal);return new Schema$3(Z,te,_)}function normalize$8(K){return K.toLowerCase()}let Info$3=class{constructor(K,_){this.property=K,this.attribute=_}};Info$3.prototype.space=null;Info$3.prototype.boolean=!1;Info$3.prototype.booleanish=!1;Info$3.prototype.overloadedBoolean=!1;Info$3.prototype.number=!1;Info$3.prototype.commaSeparated=!1;Info$3.prototype.spaceSeparated=!1;Info$3.prototype.commaOrSpaceSeparated=!1;Info$3.prototype.mustUseProperty=!1;Info$3.prototype.defined=!1;let powers$1=0;const boolean$2=increment$1(),booleanish$2=increment$1(),overloadedBoolean$1=increment$1(),number$3=increment$1(),spaceSeparated$3=increment$1(),commaSeparated$2=increment$1(),commaOrSpaceSeparated$1=increment$1();function increment$1(){return 2**++powers$1}const types$5=Object.freeze(Object.defineProperty({__proto__:null,boolean:boolean$2,booleanish:booleanish$2,commaOrSpaceSeparated:commaOrSpaceSeparated$1,commaSeparated:commaSeparated$2,number:number$3,overloadedBoolean:overloadedBoolean$1,spaceSeparated:spaceSeparated$3},Symbol.toStringTag,{value:"Module"})),checks$1=Object.keys(types$5);let DefinedInfo$3=class extends Info$3{constructor(K,_,Z,te){let ne=-1;if(super(K,_),mark$1(this,"space",te),typeof Z=="number")for(;++ne<checks$1.length;){const ie=checks$1[ne];mark$1(this,checks$1[ne],(Z&types$5[ie])===types$5[ie])}}};DefinedInfo$3.prototype.defined=!0;function mark$1(K,_,Z){Z&&(K[_]=Z)}const own$a={}.hasOwnProperty;function create$7(K){const _={},Z={};let te;for(te in K.properties)if(own$a.call(K.properties,te)){const ne=K.properties[te],ie=new DefinedInfo$3(te,K.transform(K.attributes||{},te),ne,K.space);K.mustUseProperty&&K.mustUseProperty.includes(te)&&(ie.mustUseProperty=!0),_[te]=ie,Z[normalize$8(te)]=te,Z[normalize$8(ie.attribute)]=te}return new Schema$3(_,Z,K.space)}const xlink$4=create$7({space:"xlink",transform(K,_){return"xlink:"+_.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),xml$4=create$7({space:"xml",transform(K,_){return"xml:"+_.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function caseSensitiveTransform$3(K,_){return _ in K?K[_]:_}function caseInsensitiveTransform$3(K,_){return caseSensitiveTransform$3(K,_.toLowerCase())}const xmlns$4=create$7({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:caseInsensitiveTransform$3,properties:{xmlns:null,xmlnsXLink:null}}),aria$3=create$7({transform(K,_){return _==="role"?_:"aria-"+_.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:booleanish$2,ariaAutoComplete:null,ariaBusy:booleanish$2,ariaChecked:booleanish$2,ariaColCount:number$3,ariaColIndex:number$3,ariaColSpan:number$3,ariaControls:spaceSeparated$3,ariaCurrent:null,ariaDescribedBy:spaceSeparated$3,ariaDetails:null,ariaDisabled:booleanish$2,ariaDropEffect:spaceSeparated$3,ariaErrorMessage:null,ariaExpanded:booleanish$2,ariaFlowTo:spaceSeparated$3,ariaGrabbed:booleanish$2,ariaHasPopup:null,ariaHidden:booleanish$2,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated$3,ariaLevel:number$3,ariaLive:null,ariaModal:booleanish$2,ariaMultiLine:booleanish$2,ariaMultiSelectable:booleanish$2,ariaOrientation:null,ariaOwns:spaceSeparated$3,ariaPlaceholder:null,ariaPosInSet:number$3,ariaPressed:booleanish$2,ariaReadOnly:booleanish$2,ariaRelevant:null,ariaRequired:booleanish$2,ariaRoleDescription:spaceSeparated$3,ariaRowCount:number$3,ariaRowIndex:number$3,ariaRowSpan:number$3,ariaSelected:booleanish$2,ariaSetSize:number$3,ariaSort:null,ariaValueMax:number$3,ariaValueMin:number$3,ariaValueNow:number$3,ariaValueText:null,role:null}}),html$6=create$7({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:caseInsensitiveTransform$3,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated$2,acceptCharset:spaceSeparated$3,accessKey:spaceSeparated$3,action:null,allow:null,allowFullScreen:boolean$2,allowPaymentRequest:boolean$2,allowUserMedia:boolean$2,alt:null,as:null,async:boolean$2,autoCapitalize:null,autoComplete:spaceSeparated$3,autoFocus:boolean$2,autoPlay:boolean$2,blocking:spaceSeparated$3,capture:null,charSet:null,checked:boolean$2,cite:null,className:spaceSeparated$3,cols:number$3,colSpan:null,content:null,contentEditable:booleanish$2,controls:boolean$2,controlsList:spaceSeparated$3,coords:number$3|commaSeparated$2,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean$2,defer:boolean$2,dir:null,dirName:null,disabled:boolean$2,download:overloadedBoolean$1,draggable:booleanish$2,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean$2,formTarget:null,headers:spaceSeparated$3,height:number$3,hidden:boolean$2,high:number$3,href:null,hrefLang:null,htmlFor:spaceSeparated$3,httpEquiv:spaceSeparated$3,id:null,imageSizes:null,imageSrcSet:null,inert:boolean$2,inputMode:null,integrity:null,is:null,isMap:boolean$2,itemId:null,itemProp:spaceSeparated$3,itemRef:spaceSeparated$3,itemScope:boolean$2,itemType:spaceSeparated$3,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean$2,low:number$3,manifest:null,max:null,maxLength:number$3,media:null,method:null,min:null,minLength:number$3,multiple:boolean$2,muted:boolean$2,name:null,nonce:null,noModule:boolean$2,noValidate:boolean$2,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean$2,optimum:number$3,pattern:null,ping:spaceSeparated$3,placeholder:null,playsInline:boolean$2,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:boolean$2,referrerPolicy:null,rel:spaceSeparated$3,required:boolean$2,reversed:boolean$2,rows:number$3,rowSpan:number$3,sandbox:spaceSeparated$3,scope:null,scoped:boolean$2,seamless:boolean$2,selected:boolean$2,shadowRootClonable:boolean$2,shadowRootDelegatesFocus:boolean$2,shadowRootMode:null,shape:null,size:number$3,sizes:null,slot:null,span:number$3,spellCheck:booleanish$2,src:null,srcDoc:null,srcLang:null,srcSet:null,start:number$3,step:null,style:null,tabIndex:number$3,target:null,title:null,translate:null,type:null,typeMustMatch:boolean$2,useMap:null,value:booleanish$2,width:number$3,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:spaceSeparated$3,axis:null,background:null,bgColor:null,border:number$3,borderColor:null,bottomMargin:number$3,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean$2,declare:boolean$2,event:null,face:null,frame:null,frameBorder:null,hSpace:number$3,leftMargin:number$3,link:null,longDesc:null,lowSrc:null,marginHeight:number$3,marginWidth:number$3,noResize:boolean$2,noHref:boolean$2,noShade:boolean$2,noWrap:boolean$2,object:null,profile:null,prompt:null,rev:null,rightMargin:number$3,rules:null,scheme:null,scrolling:booleanish$2,standby:null,summary:null,text:null,topMargin:number$3,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number$3,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean$2,disableRemotePlayback:boolean$2,prefix:null,property:null,results:number$3,security:null,unselectable:null}}),svg$5=create$7({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:caseSensitiveTransform$3,properties:{about:commaOrSpaceSeparated$1,accentHeight:number$3,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number$3,amplitude:number$3,arabicForm:null,ascent:number$3,attributeName:null,attributeType:null,azimuth:number$3,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number$3,by:null,calcMode:null,capHeight:number$3,className:spaceSeparated$3,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number$3,diffuseConstant:number$3,direction:null,display:null,dur:null,divisor:number$3,dominantBaseline:null,download:boolean$2,dx:null,dy:null,edgeMode:null,editable:null,elevation:number$3,enableBackground:null,end:null,event:null,exponent:number$3,externalResourcesRequired:null,fill:null,fillOpacity:number$3,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated$2,g2:commaSeparated$2,glyphName:commaSeparated$2,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number$3,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number$3,horizOriginX:number$3,horizOriginY:number$3,id:null,ideographic:number$3,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number$3,k:number$3,k1:number$3,k2:number$3,k3:number$3,k4:number$3,kernelMatrix:commaOrSpaceSeparated$1,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number$3,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number$3,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number$3,overlineThickness:number$3,paintOrder:null,panose1:null,path:null,pathLength:number$3,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated$3,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number$3,pointsAtY:number$3,pointsAtZ:number$3,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated$1,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated$1,rev:commaOrSpaceSeparated$1,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated$1,requiredFeatures:commaOrSpaceSeparated$1,requiredFonts:commaOrSpaceSeparated$1,requiredFormats:commaOrSpaceSeparated$1,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number$3,specularExponent:number$3,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number$3,strikethroughThickness:number$3,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated$1,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number$3,strokeOpacity:number$3,strokeWidth:null,style:null,surfaceScale:number$3,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated$1,tabIndex:number$3,tableValues:null,target:null,targetX:number$3,targetY:number$3,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated$1,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:number$3,underlineThickness:number$3,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number$3,values:null,vAlphabetic:number$3,vMathematical:number$3,vectorEffect:null,vHanging:number$3,vIdeographic:number$3,version:null,vertAdvY:number$3,vertOriginX:number$3,vertOriginY:number$3,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number$3,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),valid$1=/^data[-\w.:]+$/i,dash$1=/-[a-z]/g,cap$1=/[A-Z]/g;function find$2(K,_){const Z=normalize$8(_);let te=_,ne=Info$3;if(Z in K.normal)return K.property[K.normal[Z]];if(Z.length>4&&Z.slice(0,4)==="data"&&valid$1.test(_)){if(_.charAt(4)==="-"){const ie=_.slice(5).replace(dash$1,camelcase$1);te="data"+ie.charAt(0).toUpperCase()+ie.slice(1)}else{const ie=_.slice(4);if(!dash$1.test(ie)){let oe=ie.replace(cap$1,kebab$1);oe.charAt(0)!=="-"&&(oe="-"+oe),_="data"+oe}}ne=DefinedInfo$3}return new ne(te,_)}function kebab$1(K){return"-"+K.toLowerCase()}function camelcase$1(K){return K.charAt(1).toUpperCase()}const html$5=merge$3([xml$4,xlink$4,xmlns$4,aria$3,html$6],"html"),svg$4=merge$3([xml$4,xlink$4,xmlns$4,aria$3,svg$5],"svg"),own$9={}.hasOwnProperty;function zwitch(K,_){const Z=_||{};function te(ne,...ie){let oe=te.invalid;const se=te.handlers;if(ne&&own$9.call(ne,K)){const ae=String(ne[K]);oe=own$9.call(se,ae)?se[ae]:te.unknown}if(oe)return oe.call(this,ne,...ie)}return te.handlers=Z.handlers||{},te.invalid=Z.invalid,te.unknown=Z.unknown,te}const emptyOptions={},own$8={}.hasOwnProperty,one$1=zwitch("type",{handlers:{root:root$3,element:element$2,text:text$7,comment:comment$1,doctype:doctype$1}});function toParse5(K,_){const Z=(_||emptyOptions).space;return one$1(K,Z==="svg"?svg$4:html$5)}function root$3(K,_){const Z={nodeName:"#document",mode:(K.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return Z.childNodes=all$f(K.children,Z,_),patch(K,Z),Z}function fragment(K,_){const Z={nodeName:"#document-fragment",childNodes:[]};return Z.childNodes=all$f(K.children,Z,_),patch(K,Z),Z}function doctype$1(K){const _={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return patch(K,_),_}function text$7(K){const _={nodeName:"#text",value:K.value,parentNode:null};return patch(K,_),_}function comment$1(K){const _={nodeName:"#comment",data:K.value,parentNode:null};return patch(K,_),_}function element$2(K,_){const Z=_;let te=Z;K.type==="element"&&K.tagName.toLowerCase()==="svg"&&Z.space==="html"&&(te=svg$4);const ne=[];let ie;if(K.properties){for(ie in K.properties)if(ie!=="children"&&own$8.call(K.properties,ie)){const ae=createProperty(te,ie,K.properties[ie]);ae&&ne.push(ae)}}const oe=te.space,se={nodeName:K.tagName,tagName:K.tagName,attrs:ne,namespaceURI:webNamespaces[oe],childNodes:[],parentNode:null};return se.childNodes=all$f(K.children,se,te),patch(K,se),K.tagName==="template"&&K.content&&(se.content=fragment(K.content,te)),se}function createProperty(K,_,Z){const te=find$2(K,_);if(Z===!1||Z===null||Z===void 0||typeof Z=="number"&&Number.isNaN(Z)||!Z&&te.boolean)return;Array.isArray(Z)&&(Z=te.commaSeparated?stringify$5(Z):stringify$4(Z));const ne={name:te.attribute,value:Z===!0?"":String(Z)};if(te.space&&te.space!=="html"&&te.space!=="svg"){const ie=ne.name.indexOf(":");ie<0?ne.prefix="":(ne.name=ne.name.slice(ie+1),ne.prefix=te.attribute.slice(0,ie)),ne.namespace=webNamespaces[te.space]}return ne}function all$f(K,_,Z){let te=-1;const ne=[];if(K)for(;++te<K.length;){const ie=one$1(K[te],Z);ie.parentNode=_,ne.push(ie)}return ne}function patch(K,_){const Z=K.position;Z&&Z.start&&Z.end&&(Z.start.offset,Z.end.offset,_.sourceCodeLocation={startLine:Z.start.line,startCol:Z.start.column,startOffset:Z.start.offset,endLine:Z.end.line,endCol:Z.end.column,endOffset:Z.end.offset})}const htmlVoidElements=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],UNDEFINED_CODE_POINTS=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),REPLACEMENT_CHARACTER="�";var CODE_POINTS;(function(K){K[K.EOF=-1]="EOF",K[K.NULL=0]="NULL",K[K.TABULATION=9]="TABULATION",K[K.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",K[K.LINE_FEED=10]="LINE_FEED",K[K.FORM_FEED=12]="FORM_FEED",K[K.SPACE=32]="SPACE",K[K.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",K[K.QUOTATION_MARK=34]="QUOTATION_MARK",K[K.AMPERSAND=38]="AMPERSAND",K[K.APOSTROPHE=39]="APOSTROPHE",K[K.HYPHEN_MINUS=45]="HYPHEN_MINUS",K[K.SOLIDUS=47]="SOLIDUS",K[K.DIGIT_0=48]="DIGIT_0",K[K.DIGIT_9=57]="DIGIT_9",K[K.SEMICOLON=59]="SEMICOLON",K[K.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",K[K.EQUALS_SIGN=61]="EQUALS_SIGN",K[K.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",K[K.QUESTION_MARK=63]="QUESTION_MARK",K[K.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",K[K.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",K[K.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",K[K.GRAVE_ACCENT=96]="GRAVE_ACCENT",K[K.LATIN_SMALL_A=97]="LATIN_SMALL_A",K[K.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(CODE_POINTS||(CODE_POINTS={}));const SEQUENCES={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function isSurrogate(K){return K>=55296&&K<=57343}function isSurrogatePair(K){return K>=56320&&K<=57343}function getSurrogatePairCodePoint(K,_){return(K-55296)*1024+9216+_}function isControlCodePoint(K){return K!==32&&K!==10&&K!==13&&K!==9&&K!==12&&K>=1&&K<=31||K>=127&&K<=159}function isUndefinedCodePoint(K){return K>=64976&&K<=65007||UNDEFINED_CODE_POINTS.has(K)}var ERR;(function(K){K.controlCharacterInInputStream="control-character-in-input-stream",K.noncharacterInInputStream="noncharacter-in-input-stream",K.surrogateInInputStream="surrogate-in-input-stream",K.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",K.endTagWithAttributes="end-tag-with-attributes",K.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",K.unexpectedSolidusInTag="unexpected-solidus-in-tag",K.unexpectedNullCharacter="unexpected-null-character",K.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",K.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",K.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",K.missingEndTagName="missing-end-tag-name",K.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",K.unknownNamedCharacterReference="unknown-named-character-reference",K.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",K.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",K.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",K.eofBeforeTagName="eof-before-tag-name",K.eofInTag="eof-in-tag",K.missingAttributeValue="missing-attribute-value",K.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",K.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",K.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",K.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",K.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",K.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",K.missingDoctypePublicIdentifier="missing-doctype-public-identifier",K.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",K.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",K.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",K.cdataInHtmlContent="cdata-in-html-content",K.incorrectlyOpenedComment="incorrectly-opened-comment",K.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",K.eofInDoctype="eof-in-doctype",K.nestedComment="nested-comment",K.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",K.eofInComment="eof-in-comment",K.incorrectlyClosedComment="incorrectly-closed-comment",K.eofInCdata="eof-in-cdata",K.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",K.nullCharacterReference="null-character-reference",K.surrogateCharacterReference="surrogate-character-reference",K.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",K.controlCharacterReference="control-character-reference",K.noncharacterCharacterReference="noncharacter-character-reference",K.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",K.missingDoctypeName="missing-doctype-name",K.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",K.duplicateAttribute="duplicate-attribute",K.nonConformingDoctype="non-conforming-doctype",K.missingDoctype="missing-doctype",K.misplacedDoctype="misplaced-doctype",K.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",K.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",K.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",K.openElementsLeftAfterEof="open-elements-left-after-eof",K.abandonedHeadElementChild="abandoned-head-element-child",K.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",K.nestedNoscriptInHead="nested-noscript-in-head",K.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(ERR||(ERR={}));const DEFAULT_BUFFER_WATERLINE=65536;class Preprocessor{constructor(_){this.handler=_,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=DEFAULT_BUFFER_WATERLINE,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(_,Z){const{line:te,col:ne,offset:ie}=this,oe=ne+Z,se=ie+Z;return{code:_,startLine:te,endLine:te,startCol:oe,endCol:oe,startOffset:se,endOffset:se}}_err(_){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(_,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(_){if(this.pos!==this.html.length-1){const Z=this.html.charCodeAt(this.pos+1);if(isSurrogatePair(Z))return this.pos++,this._addGap(),getSurrogatePairCodePoint(_,Z)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,CODE_POINTS.EOF;return this._err(ERR.surrogateInInputStream),_}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(_,Z){this.html.length>0?this.html+=_:this.html=_,this.endOfChunkHit=!1,this.lastChunkWritten=Z}insertHtmlAtCurrentPos(_){this.html=this.html.substring(0,this.pos+1)+_+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(_,Z){if(this.pos+_.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(Z)return this.html.startsWith(_,this.pos);for(let te=0;te<_.length;te++)if((this.html.charCodeAt(this.pos+te)|32)!==_.charCodeAt(te))return!1;return!0}peek(_){const Z=this.pos+_;if(Z>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,CODE_POINTS.EOF;const te=this.html.charCodeAt(Z);return te===CODE_POINTS.CARRIAGE_RETURN?CODE_POINTS.LINE_FEED:te}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,CODE_POINTS.EOF;let _=this.html.charCodeAt(this.pos);return _===CODE_POINTS.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,CODE_POINTS.LINE_FEED):_===CODE_POINTS.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,isSurrogate(_)&&(_=this._processSurrogate(_)),this.handler.onParseError===null||_>31&&_<127||_===CODE_POINTS.LINE_FEED||_===CODE_POINTS.CARRIAGE_RETURN||_>159&&_<64976||this._checkForProblematicCharacters(_),_)}_checkForProblematicCharacters(_){isControlCodePoint(_)?this._err(ERR.controlCharacterInInputStream):isUndefinedCodePoint(_)&&this._err(ERR.noncharacterInInputStream)}retreat(_){for(this.pos-=_;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var TokenType;(function(K){K[K.CHARACTER=0]="CHARACTER",K[K.NULL_CHARACTER=1]="NULL_CHARACTER",K[K.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",K[K.START_TAG=3]="START_TAG",K[K.END_TAG=4]="END_TAG",K[K.COMMENT=5]="COMMENT",K[K.DOCTYPE=6]="DOCTYPE",K[K.EOF=7]="EOF",K[K.HIBERNATION=8]="HIBERNATION"})(TokenType||(TokenType={}));function getTokenAttr(K,_){for(let Z=K.attrs.length-1;Z>=0;Z--)if(K.attrs[Z].name===_)return K.attrs[Z].value;return null}const htmlDecodeTree=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(K=>K.charCodeAt(0))),decodeMap=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function replaceCodePoint(K){var _;return K>=55296&&K<=57343||K>1114111?65533:(_=decodeMap.get(K))!==null&&_!==void 0?_:K}var CharCodes;(function(K){K[K.NUM=35]="NUM",K[K.SEMI=59]="SEMI",K[K.EQUALS=61]="EQUALS",K[K.ZERO=48]="ZERO",K[K.NINE=57]="NINE",K[K.LOWER_A=97]="LOWER_A",K[K.LOWER_F=102]="LOWER_F",K[K.LOWER_X=120]="LOWER_X",K[K.LOWER_Z=122]="LOWER_Z",K[K.UPPER_A=65]="UPPER_A",K[K.UPPER_F=70]="UPPER_F",K[K.UPPER_Z=90]="UPPER_Z"})(CharCodes||(CharCodes={}));const TO_LOWER_BIT=32;var BinTrieFlags;(function(K){K[K.VALUE_LENGTH=49152]="VALUE_LENGTH",K[K.BRANCH_LENGTH=16256]="BRANCH_LENGTH",K[K.JUMP_TABLE=127]="JUMP_TABLE"})(BinTrieFlags||(BinTrieFlags={}));function isNumber(K){return K>=CharCodes.ZERO&&K<=CharCodes.NINE}function isHexadecimalCharacter(K){return K>=CharCodes.UPPER_A&&K<=CharCodes.UPPER_F||K>=CharCodes.LOWER_A&&K<=CharCodes.LOWER_F}function isAsciiAlphaNumeric$1(K){return K>=CharCodes.UPPER_A&&K<=CharCodes.UPPER_Z||K>=CharCodes.LOWER_A&&K<=CharCodes.LOWER_Z||isNumber(K)}function isEntityInAttributeInvalidEnd(K){return K===CharCodes.EQUALS||isAsciiAlphaNumeric$1(K)}var EntityDecoderState;(function(K){K[K.EntityStart=0]="EntityStart",K[K.NumericStart=1]="NumericStart",K[K.NumericDecimal=2]="NumericDecimal",K[K.NumericHex=3]="NumericHex",K[K.NamedEntity=4]="NamedEntity"})(EntityDecoderState||(EntityDecoderState={}));var DecodingMode;(function(K){K[K.Legacy=0]="Legacy",K[K.Strict=1]="Strict",K[K.Attribute=2]="Attribute"})(DecodingMode||(DecodingMode={}));class EntityDecoder{constructor(_,Z,te){this.decodeTree=_,this.emitCodePoint=Z,this.errors=te,this.state=EntityDecoderState.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=DecodingMode.Strict}startEntity(_){this.decodeMode=_,this.state=EntityDecoderState.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(_,Z){switch(this.state){case EntityDecoderState.EntityStart:return _.charCodeAt(Z)===CharCodes.NUM?(this.state=EntityDecoderState.NumericStart,this.consumed+=1,this.stateNumericStart(_,Z+1)):(this.state=EntityDecoderState.NamedEntity,this.stateNamedEntity(_,Z));case EntityDecoderState.NumericStart:return this.stateNumericStart(_,Z);case EntityDecoderState.NumericDecimal:return this.stateNumericDecimal(_,Z);case EntityDecoderState.NumericHex:return this.stateNumericHex(_,Z);case EntityDecoderState.NamedEntity:return this.stateNamedEntity(_,Z)}}stateNumericStart(_,Z){return Z>=_.length?-1:(_.charCodeAt(Z)|TO_LOWER_BIT)===CharCodes.LOWER_X?(this.state=EntityDecoderState.NumericHex,this.consumed+=1,this.stateNumericHex(_,Z+1)):(this.state=EntityDecoderState.NumericDecimal,this.stateNumericDecimal(_,Z))}addToNumericResult(_,Z,te,ne){if(Z!==te){const ie=te-Z;this.result=this.result*Math.pow(ne,ie)+Number.parseInt(_.substr(Z,ie),ne),this.consumed+=ie}}stateNumericHex(_,Z){const te=Z;for(;Z<_.length;){const ne=_.charCodeAt(Z);if(isNumber(ne)||isHexadecimalCharacter(ne))Z+=1;else return this.addToNumericResult(_,te,Z,16),this.emitNumericEntity(ne,3)}return this.addToNumericResult(_,te,Z,16),-1}stateNumericDecimal(_,Z){const te=Z;for(;Z<_.length;){const ne=_.charCodeAt(Z);if(isNumber(ne))Z+=1;else return this.addToNumericResult(_,te,Z,10),this.emitNumericEntity(ne,2)}return this.addToNumericResult(_,te,Z,10),-1}emitNumericEntity(_,Z){var te;if(this.consumed<=Z)return(te=this.errors)===null||te===void 0||te.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(_===CharCodes.SEMI)this.consumed+=1;else if(this.decodeMode===DecodingMode.Strict)return 0;return this.emitCodePoint(replaceCodePoint(this.result),this.consumed),this.errors&&(_!==CharCodes.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(_,Z){const{decodeTree:te}=this;let ne=te[this.treeIndex],ie=(ne&BinTrieFlags.VALUE_LENGTH)>>14;for(;Z<_.length;Z++,this.excess++){const oe=_.charCodeAt(Z);if(this.treeIndex=determineBranch(te,ne,this.treeIndex+Math.max(1,ie),oe),this.treeIndex<0)return this.result===0||this.decodeMode===DecodingMode.Attribute&&(ie===0||isEntityInAttributeInvalidEnd(oe))?0:this.emitNotTerminatedNamedEntity();if(ne=te[this.treeIndex],ie=(ne&BinTrieFlags.VALUE_LENGTH)>>14,ie!==0){if(oe===CharCodes.SEMI)return this.emitNamedEntityData(this.treeIndex,ie,this.consumed+this.excess);this.decodeMode!==DecodingMode.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var _;const{result:Z,decodeTree:te}=this,ne=(te[Z]&BinTrieFlags.VALUE_LENGTH)>>14;return this.emitNamedEntityData(Z,ne,this.consumed),(_=this.errors)===null||_===void 0||_.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(_,Z,te){const{decodeTree:ne}=this;return this.emitCodePoint(Z===1?ne[_]&~BinTrieFlags.VALUE_LENGTH:ne[_+1],te),Z===3&&this.emitCodePoint(ne[_+2],te),te}end(){var _;switch(this.state){case EntityDecoderState.NamedEntity:return this.result!==0&&(this.decodeMode!==DecodingMode.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case EntityDecoderState.NumericDecimal:return this.emitNumericEntity(0,2);case EntityDecoderState.NumericHex:return this.emitNumericEntity(0,3);case EntityDecoderState.NumericStart:return(_=this.errors)===null||_===void 0||_.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case EntityDecoderState.EntityStart:return 0}}}function determineBranch(K,_,Z,te){const ne=(_&BinTrieFlags.BRANCH_LENGTH)>>7,ie=_&BinTrieFlags.JUMP_TABLE;if(ne===0)return ie!==0&&te===ie?Z:-1;if(ie){const ae=te-ie;return ae<0||ae>=ne?-1:K[Z+ae]-1}let oe=Z,se=oe+ne-1;for(;oe<=se;){const ae=oe+se>>>1,le=K[ae];if(le<te)oe=ae+1;else if(le>te)se=ae-1;else return K[ae+ne]}return-1}var NS;(function(K){K.HTML="http://www.w3.org/1999/xhtml",K.MATHML="http://www.w3.org/1998/Math/MathML",K.SVG="http://www.w3.org/2000/svg",K.XLINK="http://www.w3.org/1999/xlink",K.XML="http://www.w3.org/XML/1998/namespace",K.XMLNS="http://www.w3.org/2000/xmlns/"})(NS||(NS={}));var ATTRS;(function(K){K.TYPE="type",K.ACTION="action",K.ENCODING="encoding",K.PROMPT="prompt",K.NAME="name",K.COLOR="color",K.FACE="face",K.SIZE="size"})(ATTRS||(ATTRS={}));var DOCUMENT_MODE;(function(K){K.NO_QUIRKS="no-quirks",K.QUIRKS="quirks",K.LIMITED_QUIRKS="limited-quirks"})(DOCUMENT_MODE||(DOCUMENT_MODE={}));var TAG_NAMES;(function(K){K.A="a",K.ADDRESS="address",K.ANNOTATION_XML="annotation-xml",K.APPLET="applet",K.AREA="area",K.ARTICLE="article",K.ASIDE="aside",K.B="b",K.BASE="base",K.BASEFONT="basefont",K.BGSOUND="bgsound",K.BIG="big",K.BLOCKQUOTE="blockquote",K.BODY="body",K.BR="br",K.BUTTON="button",K.CAPTION="caption",K.CENTER="center",K.CODE="code",K.COL="col",K.COLGROUP="colgroup",K.DD="dd",K.DESC="desc",K.DETAILS="details",K.DIALOG="dialog",K.DIR="dir",K.DIV="div",K.DL="dl",K.DT="dt",K.EM="em",K.EMBED="embed",K.FIELDSET="fieldset",K.FIGCAPTION="figcaption",K.FIGURE="figure",K.FONT="font",K.FOOTER="footer",K.FOREIGN_OBJECT="foreignObject",K.FORM="form",K.FRAME="frame",K.FRAMESET="frameset",K.H1="h1",K.H2="h2",K.H3="h3",K.H4="h4",K.H5="h5",K.H6="h6",K.HEAD="head",K.HEADER="header",K.HGROUP="hgroup",K.HR="hr",K.HTML="html",K.I="i",K.IMG="img",K.IMAGE="image",K.INPUT="input",K.IFRAME="iframe",K.KEYGEN="keygen",K.LABEL="label",K.LI="li",K.LINK="link",K.LISTING="listing",K.MAIN="main",K.MALIGNMARK="malignmark",K.MARQUEE="marquee",K.MATH="math",K.MENU="menu",K.META="meta",K.MGLYPH="mglyph",K.MI="mi",K.MO="mo",K.MN="mn",K.MS="ms",K.MTEXT="mtext",K.NAV="nav",K.NOBR="nobr",K.NOFRAMES="noframes",K.NOEMBED="noembed",K.NOSCRIPT="noscript",K.OBJECT="object",K.OL="ol",K.OPTGROUP="optgroup",K.OPTION="option",K.P="p",K.PARAM="param",K.PLAINTEXT="plaintext",K.PRE="pre",K.RB="rb",K.RP="rp",K.RT="rt",K.RTC="rtc",K.RUBY="ruby",K.S="s",K.SCRIPT="script",K.SEARCH="search",K.SECTION="section",K.SELECT="select",K.SOURCE="source",K.SMALL="small",K.SPAN="span",K.STRIKE="strike",K.STRONG="strong",K.STYLE="style",K.SUB="sub",K.SUMMARY="summary",K.SUP="sup",K.TABLE="table",K.TBODY="tbody",K.TEMPLATE="template",K.TEXTAREA="textarea",K.TFOOT="tfoot",K.TD="td",K.TH="th",K.THEAD="thead",K.TITLE="title",K.TR="tr",K.TRACK="track",K.TT="tt",K.U="u",K.UL="ul",K.SVG="svg",K.VAR="var",K.WBR="wbr",K.XMP="xmp"})(TAG_NAMES||(TAG_NAMES={}));var TAG_ID;(function(K){K[K.UNKNOWN=0]="UNKNOWN",K[K.A=1]="A",K[K.ADDRESS=2]="ADDRESS",K[K.ANNOTATION_XML=3]="ANNOTATION_XML",K[K.APPLET=4]="APPLET",K[K.AREA=5]="AREA",K[K.ARTICLE=6]="ARTICLE",K[K.ASIDE=7]="ASIDE",K[K.B=8]="B",K[K.BASE=9]="BASE",K[K.BASEFONT=10]="BASEFONT",K[K.BGSOUND=11]="BGSOUND",K[K.BIG=12]="BIG",K[K.BLOCKQUOTE=13]="BLOCKQUOTE",K[K.BODY=14]="BODY",K[K.BR=15]="BR",K[K.BUTTON=16]="BUTTON",K[K.CAPTION=17]="CAPTION",K[K.CENTER=18]="CENTER",K[K.CODE=19]="CODE",K[K.COL=20]="COL",K[K.COLGROUP=21]="COLGROUP",K[K.DD=22]="DD",K[K.DESC=23]="DESC",K[K.DETAILS=24]="DETAILS",K[K.DIALOG=25]="DIALOG",K[K.DIR=26]="DIR",K[K.DIV=27]="DIV",K[K.DL=28]="DL",K[K.DT=29]="DT",K[K.EM=30]="EM",K[K.EMBED=31]="EMBED",K[K.FIELDSET=32]="FIELDSET",K[K.FIGCAPTION=33]="FIGCAPTION",K[K.FIGURE=34]="FIGURE",K[K.FONT=35]="FONT",K[K.FOOTER=36]="FOOTER",K[K.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",K[K.FORM=38]="FORM",K[K.FRAME=39]="FRAME",K[K.FRAMESET=40]="FRAMESET",K[K.H1=41]="H1",K[K.H2=42]="H2",K[K.H3=43]="H3",K[K.H4=44]="H4",K[K.H5=45]="H5",K[K.H6=46]="H6",K[K.HEAD=47]="HEAD",K[K.HEADER=48]="HEADER",K[K.HGROUP=49]="HGROUP",K[K.HR=50]="HR",K[K.HTML=51]="HTML",K[K.I=52]="I",K[K.IMG=53]="IMG",K[K.IMAGE=54]="IMAGE",K[K.INPUT=55]="INPUT",K[K.IFRAME=56]="IFRAME",K[K.KEYGEN=57]="KEYGEN",K[K.LABEL=58]="LABEL",K[K.LI=59]="LI",K[K.LINK=60]="LINK",K[K.LISTING=61]="LISTING",K[K.MAIN=62]="MAIN",K[K.MALIGNMARK=63]="MALIGNMARK",K[K.MARQUEE=64]="MARQUEE",K[K.MATH=65]="MATH",K[K.MENU=66]="MENU",K[K.META=67]="META",K[K.MGLYPH=68]="MGLYPH",K[K.MI=69]="MI",K[K.MO=70]="MO",K[K.MN=71]="MN",K[K.MS=72]="MS",K[K.MTEXT=73]="MTEXT",K[K.NAV=74]="NAV",K[K.NOBR=75]="NOBR",K[K.NOFRAMES=76]="NOFRAMES",K[K.NOEMBED=77]="NOEMBED",K[K.NOSCRIPT=78]="NOSCRIPT",K[K.OBJECT=79]="OBJECT",K[K.OL=80]="OL",K[K.OPTGROUP=81]="OPTGROUP",K[K.OPTION=82]="OPTION",K[K.P=83]="P",K[K.PARAM=84]="PARAM",K[K.PLAINTEXT=85]="PLAINTEXT",K[K.PRE=86]="PRE",K[K.RB=87]="RB",K[K.RP=88]="RP",K[K.RT=89]="RT",K[K.RTC=90]="RTC",K[K.RUBY=91]="RUBY",K[K.S=92]="S",K[K.SCRIPT=93]="SCRIPT",K[K.SEARCH=94]="SEARCH",K[K.SECTION=95]="SECTION",K[K.SELECT=96]="SELECT",K[K.SOURCE=97]="SOURCE",K[K.SMALL=98]="SMALL",K[K.SPAN=99]="SPAN",K[K.STRIKE=100]="STRIKE",K[K.STRONG=101]="STRONG",K[K.STYLE=102]="STYLE",K[K.SUB=103]="SUB",K[K.SUMMARY=104]="SUMMARY",K[K.SUP=105]="SUP",K[K.TABLE=106]="TABLE",K[K.TBODY=107]="TBODY",K[K.TEMPLATE=108]="TEMPLATE",K[K.TEXTAREA=109]="TEXTAREA",K[K.TFOOT=110]="TFOOT",K[K.TD=111]="TD",K[K.TH=112]="TH",K[K.THEAD=113]="THEAD",K[K.TITLE=114]="TITLE",K[K.TR=115]="TR",K[K.TRACK=116]="TRACK",K[K.TT=117]="TT",K[K.U=118]="U",K[K.UL=119]="UL",K[K.SVG=120]="SVG",K[K.VAR=121]="VAR",K[K.WBR=122]="WBR",K[K.XMP=123]="XMP"})(TAG_ID||(TAG_ID={}));const TAG_NAME_TO_ID=new Map([[TAG_NAMES.A,TAG_ID.A],[TAG_NAMES.ADDRESS,TAG_ID.ADDRESS],[TAG_NAMES.ANNOTATION_XML,TAG_ID.ANNOTATION_XML],[TAG_NAMES.APPLET,TAG_ID.APPLET],[TAG_NAMES.AREA,TAG_ID.AREA],[TAG_NAMES.ARTICLE,TAG_ID.ARTICLE],[TAG_NAMES.ASIDE,TAG_ID.ASIDE],[TAG_NAMES.B,TAG_ID.B],[TAG_NAMES.BASE,TAG_ID.BASE],[TAG_NAMES.BASEFONT,TAG_ID.BASEFONT],[TAG_NAMES.BGSOUND,TAG_ID.BGSOUND],[TAG_NAMES.BIG,TAG_ID.BIG],[TAG_NAMES.BLOCKQUOTE,TAG_ID.BLOCKQUOTE],[TAG_NAMES.BODY,TAG_ID.BODY],[TAG_NAMES.BR,TAG_ID.BR],[TAG_NAMES.BUTTON,TAG_ID.BUTTON],[TAG_NAMES.CAPTION,TAG_ID.CAPTION],[TAG_NAMES.CENTER,TAG_ID.CENTER],[TAG_NAMES.CODE,TAG_ID.CODE],[TAG_NAMES.COL,TAG_ID.COL],[TAG_NAMES.COLGROUP,TAG_ID.COLGROUP],[TAG_NAMES.DD,TAG_ID.DD],[TAG_NAMES.DESC,TAG_ID.DESC],[TAG_NAMES.DETAILS,TAG_ID.DETAILS],[TAG_NAMES.DIALOG,TAG_ID.DIALOG],[TAG_NAMES.DIR,TAG_ID.DIR],[TAG_NAMES.DIV,TAG_ID.DIV],[TAG_NAMES.DL,TAG_ID.DL],[TAG_NAMES.DT,TAG_ID.DT],[TAG_NAMES.EM,TAG_ID.EM],[TAG_NAMES.EMBED,TAG_ID.EMBED],[TAG_NAMES.FIELDSET,TAG_ID.FIELDSET],[TAG_NAMES.FIGCAPTION,TAG_ID.FIGCAPTION],[TAG_NAMES.FIGURE,TAG_ID.FIGURE],[TAG_NAMES.FONT,TAG_ID.FONT],[TAG_NAMES.FOOTER,TAG_ID.FOOTER],[TAG_NAMES.FOREIGN_OBJECT,TAG_ID.FOREIGN_OBJECT],[TAG_NAMES.FORM,TAG_ID.FORM],[TAG_NAMES.FRAME,TAG_ID.FRAME],[TAG_NAMES.FRAMESET,TAG_ID.FRAMESET],[TAG_NAMES.H1,TAG_ID.H1],[TAG_NAMES.H2,TAG_ID.H2],[TAG_NAMES.H3,TAG_ID.H3],[TAG_NAMES.H4,TAG_ID.H4],[TAG_NAMES.H5,TAG_ID.H5],[TAG_NAMES.H6,TAG_ID.H6],[TAG_NAMES.HEAD,TAG_ID.HEAD],[TAG_NAMES.HEADER,TAG_ID.HEADER],[TAG_NAMES.HGROUP,TAG_ID.HGROUP],[TAG_NAMES.HR,TAG_ID.HR],[TAG_NAMES.HTML,TAG_ID.HTML],[TAG_NAMES.I,TAG_ID.I],[TAG_NAMES.IMG,TAG_ID.IMG],[TAG_NAMES.IMAGE,TAG_ID.IMAGE],[TAG_NAMES.INPUT,TAG_ID.INPUT],[TAG_NAMES.IFRAME,TAG_ID.IFRAME],[TAG_NAMES.KEYGEN,TAG_ID.KEYGEN],[TAG_NAMES.LABEL,TAG_ID.LABEL],[TAG_NAMES.LI,TAG_ID.LI],[TAG_NAMES.LINK,TAG_ID.LINK],[TAG_NAMES.LISTING,TAG_ID.LISTING],[TAG_NAMES.MAIN,TAG_ID.MAIN],[TAG_NAMES.MALIGNMARK,TAG_ID.MALIGNMARK],[TAG_NAMES.MARQUEE,TAG_ID.MARQUEE],[TAG_NAMES.MATH,TAG_ID.MATH],[TAG_NAMES.MENU,TAG_ID.MENU],[TAG_NAMES.META,TAG_ID.META],[TAG_NAMES.MGLYPH,TAG_ID.MGLYPH],[TAG_NAMES.MI,TAG_ID.MI],[TAG_NAMES.MO,TAG_ID.MO],[TAG_NAMES.MN,TAG_ID.MN],[TAG_NAMES.MS,TAG_ID.MS],[TAG_NAMES.MTEXT,TAG_ID.MTEXT],[TAG_NAMES.NAV,TAG_ID.NAV],[TAG_NAMES.NOBR,TAG_ID.NOBR],[TAG_NAMES.NOFRAMES,TAG_ID.NOFRAMES],[TAG_NAMES.NOEMBED,TAG_ID.NOEMBED],[TAG_NAMES.NOSCRIPT,TAG_ID.NOSCRIPT],[TAG_NAMES.OBJECT,TAG_ID.OBJECT],[TAG_NAMES.OL,TAG_ID.OL],[TAG_NAMES.OPTGROUP,TAG_ID.OPTGROUP],[TAG_NAMES.OPTION,TAG_ID.OPTION],[TAG_NAMES.P,TAG_ID.P],[TAG_NAMES.PARAM,TAG_ID.PARAM],[TAG_NAMES.PLAINTEXT,TAG_ID.PLAINTEXT],[TAG_NAMES.PRE,TAG_ID.PRE],[TAG_NAMES.RB,TAG_ID.RB],[TAG_NAMES.RP,TAG_ID.RP],[TAG_NAMES.RT,TAG_ID.RT],[TAG_NAMES.RTC,TAG_ID.RTC],[TAG_NAMES.RUBY,TAG_ID.RUBY],[TAG_NAMES.S,TAG_ID.S],[TAG_NAMES.SCRIPT,TAG_ID.SCRIPT],[TAG_NAMES.SEARCH,TAG_ID.SEARCH],[TAG_NAMES.SECTION,TAG_ID.SECTION],[TAG_NAMES.SELECT,TAG_ID.SELECT],[TAG_NAMES.SOURCE,TAG_ID.SOURCE],[TAG_NAMES.SMALL,TAG_ID.SMALL],[TAG_NAMES.SPAN,TAG_ID.SPAN],[TAG_NAMES.STRIKE,TAG_ID.STRIKE],[TAG_NAMES.STRONG,TAG_ID.STRONG],[TAG_NAMES.STYLE,TAG_ID.STYLE],[TAG_NAMES.SUB,TAG_ID.SUB],[TAG_NAMES.SUMMARY,TAG_ID.SUMMARY],[TAG_NAMES.SUP,TAG_ID.SUP],[TAG_NAMES.TABLE,TAG_ID.TABLE],[TAG_NAMES.TBODY,TAG_ID.TBODY],[TAG_NAMES.TEMPLATE,TAG_ID.TEMPLATE],[TAG_NAMES.TEXTAREA,TAG_ID.TEXTAREA],[TAG_NAMES.TFOOT,TAG_ID.TFOOT],[TAG_NAMES.TD,TAG_ID.TD],[TAG_NAMES.TH,TAG_ID.TH],[TAG_NAMES.THEAD,TAG_ID.THEAD],[TAG_NAMES.TITLE,TAG_ID.TITLE],[TAG_NAMES.TR,TAG_ID.TR],[TAG_NAMES.TRACK,TAG_ID.TRACK],[TAG_NAMES.TT,TAG_ID.TT],[TAG_NAMES.U,TAG_ID.U],[TAG_NAMES.UL,TAG_ID.UL],[TAG_NAMES.SVG,TAG_ID.SVG],[TAG_NAMES.VAR,TAG_ID.VAR],[TAG_NAMES.WBR,TAG_ID.WBR],[TAG_NAMES.XMP,TAG_ID.XMP]]);function getTagID(K){var _;return(_=TAG_NAME_TO_ID.get(K))!==null&&_!==void 0?_:TAG_ID.UNKNOWN}const $=TAG_ID,SPECIAL_ELEMENTS={[NS.HTML]:new Set([$.ADDRESS,$.APPLET,$.AREA,$.ARTICLE,$.ASIDE,$.BASE,$.BASEFONT,$.BGSOUND,$.BLOCKQUOTE,$.BODY,$.BR,$.BUTTON,$.CAPTION,$.CENTER,$.COL,$.COLGROUP,$.DD,$.DETAILS,$.DIR,$.DIV,$.DL,$.DT,$.EMBED,$.FIELDSET,$.FIGCAPTION,$.FIGURE,$.FOOTER,$.FORM,$.FRAME,$.FRAMESET,$.H1,$.H2,$.H3,$.H4,$.H5,$.H6,$.HEAD,$.HEADER,$.HGROUP,$.HR,$.HTML,$.IFRAME,$.IMG,$.INPUT,$.LI,$.LINK,$.LISTING,$.MAIN,$.MARQUEE,$.MENU,$.META,$.NAV,$.NOEMBED,$.NOFRAMES,$.NOSCRIPT,$.OBJECT,$.OL,$.P,$.PARAM,$.PLAINTEXT,$.PRE,$.SCRIPT,$.SECTION,$.SELECT,$.SOURCE,$.STYLE,$.SUMMARY,$.TABLE,$.TBODY,$.TD,$.TEMPLATE,$.TEXTAREA,$.TFOOT,$.TH,$.THEAD,$.TITLE,$.TR,$.TRACK,$.UL,$.WBR,$.XMP]),[NS.MATHML]:new Set([$.MI,$.MO,$.MN,$.MS,$.MTEXT,$.ANNOTATION_XML]),[NS.SVG]:new Set([$.TITLE,$.FOREIGN_OBJECT,$.DESC]),[NS.XLINK]:new Set,[NS.XML]:new Set,[NS.XMLNS]:new Set},NUMBERED_HEADERS=new Set([$.H1,$.H2,$.H3,$.H4,$.H5,$.H6]);TAG_NAMES.STYLE,TAG_NAMES.SCRIPT,TAG_NAMES.XMP,TAG_NAMES.IFRAME,TAG_NAMES.NOEMBED,TAG_NAMES.NOFRAMES,TAG_NAMES.PLAINTEXT;var State;(function(K){K[K.DATA=0]="DATA",K[K.RCDATA=1]="RCDATA",K[K.RAWTEXT=2]="RAWTEXT",K[K.SCRIPT_DATA=3]="SCRIPT_DATA",K[K.PLAINTEXT=4]="PLAINTEXT",K[K.TAG_OPEN=5]="TAG_OPEN",K[K.END_TAG_OPEN=6]="END_TAG_OPEN",K[K.TAG_NAME=7]="TAG_NAME",K[K.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",K[K.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",K[K.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",K[K.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",K[K.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",K[K.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",K[K.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",K[K.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",K[K.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",K[K.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",K[K.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",K[K.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",K[K.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",K[K.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",K[K.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",K[K.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",K[K.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",K[K.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",K[K.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",K[K.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",K[K.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",K[K.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",K[K.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",K[K.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",K[K.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",K[K.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",K[K.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",K[K.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",K[K.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",K[K.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",K[K.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",K[K.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",K[K.BOGUS_COMMENT=40]="BOGUS_COMMENT",K[K.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",K[K.COMMENT_START=42]="COMMENT_START",K[K.COMMENT_START_DASH=43]="COMMENT_START_DASH",K[K.COMMENT=44]="COMMENT",K[K.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",K[K.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",K[K.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",K[K.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",K[K.COMMENT_END_DASH=49]="COMMENT_END_DASH",K[K.COMMENT_END=50]="COMMENT_END",K[K.COMMENT_END_BANG=51]="COMMENT_END_BANG",K[K.DOCTYPE=52]="DOCTYPE",K[K.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",K[K.DOCTYPE_NAME=54]="DOCTYPE_NAME",K[K.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",K[K.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",K[K.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",K[K.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",K[K.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",K[K.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",K[K.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",K[K.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",K[K.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",K[K.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",K[K.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",K[K.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",K[K.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",K[K.CDATA_SECTION=68]="CDATA_SECTION",K[K.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",K[K.CDATA_SECTION_END=70]="CDATA_SECTION_END",K[K.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",K[K.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(State||(State={}));const TokenizerMode={DATA:State.DATA,RCDATA:State.RCDATA,RAWTEXT:State.RAWTEXT,SCRIPT_DATA:State.SCRIPT_DATA,PLAINTEXT:State.PLAINTEXT,CDATA_SECTION:State.CDATA_SECTION};function isAsciiDigit(K){return K>=CODE_POINTS.DIGIT_0&&K<=CODE_POINTS.DIGIT_9}function isAsciiUpper(K){return K>=CODE_POINTS.LATIN_CAPITAL_A&&K<=CODE_POINTS.LATIN_CAPITAL_Z}function isAsciiLower(K){return K>=CODE_POINTS.LATIN_SMALL_A&&K<=CODE_POINTS.LATIN_SMALL_Z}function isAsciiLetter(K){return isAsciiLower(K)||isAsciiUpper(K)}function isAsciiAlphaNumeric(K){return isAsciiLetter(K)||isAsciiDigit(K)}function toAsciiLower(K){return K+32}function isWhitespace(K){return K===CODE_POINTS.SPACE||K===CODE_POINTS.LINE_FEED||K===CODE_POINTS.TABULATION||K===CODE_POINTS.FORM_FEED}function isScriptDataDoubleEscapeSequenceEnd(K){return isWhitespace(K)||K===CODE_POINTS.SOLIDUS||K===CODE_POINTS.GREATER_THAN_SIGN}function getErrorForNumericCharacterReference(K){return K===CODE_POINTS.NULL?ERR.nullCharacterReference:K>1114111?ERR.characterReferenceOutsideUnicodeRange:isSurrogate(K)?ERR.surrogateCharacterReference:isUndefinedCodePoint(K)?ERR.noncharacterCharacterReference:isControlCodePoint(K)||K===CODE_POINTS.CARRIAGE_RETURN?ERR.controlCharacterReference:null}class Tokenizer{constructor(_,Z){this.options=_,this.handler=Z,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=State.DATA,this.returnState=State.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new Preprocessor(Z),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new EntityDecoder(htmlDecodeTree,(te,ne)=>{this.preprocessor.pos=this.entityStartPos+ne-1,this._flushCodePointConsumedAsCharacterReference(te)},Z.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(ERR.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:te=>{this._err(ERR.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+te)},validateNumericCharacterReference:te=>{const ne=getErrorForNumericCharacterReference(te);ne&&this._err(ne,1)}}:void 0)}_err(_,Z=0){var te,ne;(ne=(te=this.handler).onParseError)===null||ne===void 0||ne.call(te,this.preprocessor.getError(_,Z))}getCurrentLocation(_){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-_,startOffset:this.preprocessor.offset-_,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const _=this._consume();this._ensureHibernation()||this._callState(_)}this.inLoop=!1}}pause(){this.paused=!0}resume(_){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||_==null||_())}write(_,Z,te){this.active=!0,this.preprocessor.write(_,Z),this._runParsingLoop(),this.paused||te==null||te()}insertHtmlAtCurrentPos(_){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(_),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(_){this.consumedAfterSnapshot+=_;for(let Z=0;Z<_;Z++)this.preprocessor.advance()}_consumeSequenceIfMatch(_,Z){return this.preprocessor.startsWith(_,Z)?(this._advanceBy(_.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:TokenType.START_TAG,tagName:"",tagID:TAG_ID.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:TokenType.END_TAG,tagName:"",tagID:TAG_ID.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(_){this.currentToken={type:TokenType.COMMENT,data:"",location:this.getCurrentLocation(_)}}_createDoctypeToken(_){this.currentToken={type:TokenType.DOCTYPE,name:_,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(_,Z){this.currentCharacterToken={type:_,chars:Z,location:this.currentLocation}}_createAttr(_){this.currentAttr={name:_,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var _,Z;const te=this.currentToken;if(getTokenAttr(te,this.currentAttr.name)===null){if(te.attrs.push(this.currentAttr),te.location&&this.currentLocation){const ne=(_=(Z=te.location).attrs)!==null&&_!==void 0?_:Z.attrs=Object.create(null);ne[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(ERR.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(_){this._emitCurrentCharacterToken(_.location),this.currentToken=null,_.location&&(_.location.endLine=this.preprocessor.line,_.location.endCol=this.preprocessor.col+1,_.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const _=this.currentToken;this.prepareToken(_),_.tagID=getTagID(_.tagName),_.type===TokenType.START_TAG?(this.lastStartTagName=_.tagName,this.handler.onStartTag(_)):(_.attrs.length>0&&this._err(ERR.endTagWithAttributes),_.selfClosing&&this._err(ERR.endTagWithTrailingSolidus),this.handler.onEndTag(_)),this.preprocessor.dropParsedChunk()}emitCurrentComment(_){this.prepareToken(_),this.handler.onComment(_),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(_){this.prepareToken(_),this.handler.onDoctype(_),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(_){if(this.currentCharacterToken){switch(_&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=_.startLine,this.currentCharacterToken.location.endCol=_.startCol,this.currentCharacterToken.location.endOffset=_.startOffset),this.currentCharacterToken.type){case TokenType.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case TokenType.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case TokenType.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const _=this.getCurrentLocation(0);_&&(_.endLine=_.startLine,_.endCol=_.startCol,_.endOffset=_.startOffset),this._emitCurrentCharacterToken(_),this.handler.onEof({type:TokenType.EOF,location:_}),this.active=!1}_appendCharToCurrentCharacterToken(_,Z){if(this.currentCharacterToken)if(this.currentCharacterToken.type===_){this.currentCharacterToken.chars+=Z;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(_,Z)}_emitCodePoint(_){const Z=isWhitespace(_)?TokenType.WHITESPACE_CHARACTER:_===CODE_POINTS.NULL?TokenType.NULL_CHARACTER:TokenType.CHARACTER;this._appendCharToCurrentCharacterToken(Z,String.fromCodePoint(_))}_emitChars(_){this._appendCharToCurrentCharacterToken(TokenType.CHARACTER,_)}_startCharacterReference(){this.returnState=this.state,this.state=State.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?DecodingMode.Attribute:DecodingMode.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===State.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===State.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===State.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(_){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(_):this._emitCodePoint(_)}_callState(_){switch(this.state){case State.DATA:{this._stateData(_);break}case State.RCDATA:{this._stateRcdata(_);break}case State.RAWTEXT:{this._stateRawtext(_);break}case State.SCRIPT_DATA:{this._stateScriptData(_);break}case State.PLAINTEXT:{this._statePlaintext(_);break}case State.TAG_OPEN:{this._stateTagOpen(_);break}case State.END_TAG_OPEN:{this._stateEndTagOpen(_);break}case State.TAG_NAME:{this._stateTagName(_);break}case State.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(_);break}case State.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(_);break}case State.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(_);break}case State.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(_);break}case State.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(_);break}case State.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(_);break}case State.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(_);break}case State.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(_);break}case State.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(_);break}case State.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(_);break}case State.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(_);break}case State.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(_);break}case State.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(_);break}case State.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(_);break}case State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(_);break}case State.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(_);break}case State.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(_);break}case State.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(_);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(_);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(_);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(_);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(_);break}case State.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(_);break}case State.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(_);break}case State.ATTRIBUTE_NAME:{this._stateAttributeName(_);break}case State.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(_);break}case State.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(_);break}case State.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(_);break}case State.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(_);break}case State.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(_);break}case State.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(_);break}case State.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(_);break}case State.BOGUS_COMMENT:{this._stateBogusComment(_);break}case State.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(_);break}case State.COMMENT_START:{this._stateCommentStart(_);break}case State.COMMENT_START_DASH:{this._stateCommentStartDash(_);break}case State.COMMENT:{this._stateComment(_);break}case State.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(_);break}case State.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(_);break}case State.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(_);break}case State.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(_);break}case State.COMMENT_END_DASH:{this._stateCommentEndDash(_);break}case State.COMMENT_END:{this._stateCommentEnd(_);break}case State.COMMENT_END_BANG:{this._stateCommentEndBang(_);break}case State.DOCTYPE:{this._stateDoctype(_);break}case State.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(_);break}case State.DOCTYPE_NAME:{this._stateDoctypeName(_);break}case State.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(_);break}case State.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(_);break}case State.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(_);break}case State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(_);break}case State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(_);break}case State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(_);break}case State.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(_);break}case State.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(_);break}case State.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(_);break}case State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(_);break}case State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(_);break}case State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(_);break}case State.BOGUS_DOCTYPE:{this._stateBogusDoctype(_);break}case State.CDATA_SECTION:{this._stateCdataSection(_);break}case State.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(_);break}case State.CDATA_SECTION_END:{this._stateCdataSectionEnd(_);break}case State.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case State.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(_);break}default:throw new Error("Unknown state")}}_stateData(_){switch(_){case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.TAG_OPEN;break}case CODE_POINTS.AMPERSAND:{this._startCharacterReference();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitCodePoint(_);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(_)}}_stateRcdata(_){switch(_){case CODE_POINTS.AMPERSAND:{this._startCharacterReference();break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.RCDATA_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(_)}}_stateRawtext(_){switch(_){case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.RAWTEXT_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(_)}}_stateScriptData(_){switch(_){case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(_)}}_statePlaintext(_){switch(_){case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(_)}}_stateTagOpen(_){if(isAsciiLetter(_))this._createStartTagToken(),this.state=State.TAG_NAME,this._stateTagName(_);else switch(_){case CODE_POINTS.EXCLAMATION_MARK:{this.state=State.MARKUP_DECLARATION_OPEN;break}case CODE_POINTS.SOLIDUS:{this.state=State.END_TAG_OPEN;break}case CODE_POINTS.QUESTION_MARK:{this._err(ERR.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=State.BOGUS_COMMENT,this._stateBogusComment(_);break}case CODE_POINTS.EOF:{this._err(ERR.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(ERR.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=State.DATA,this._stateData(_)}}_stateEndTagOpen(_){if(isAsciiLetter(_))this._createEndTagToken(),this.state=State.TAG_NAME,this._stateTagName(_);else switch(_){case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingEndTagName),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(ERR.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=State.BOGUS_COMMENT,this._stateBogusComment(_)}}_stateTagName(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_ATTRIBUTE_NAME;break}case CODE_POINTS.SOLIDUS:{this.state=State.SELF_CLOSING_START_TAG;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.tagName+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:Z.tagName+=String.fromCodePoint(isAsciiUpper(_)?toAsciiLower(_):_)}}_stateRcdataLessThanSign(_){_===CODE_POINTS.SOLIDUS?this.state=State.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=State.RCDATA,this._stateRcdata(_))}_stateRcdataEndTagOpen(_){isAsciiLetter(_)?(this.state=State.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(_)):(this._emitChars("</"),this.state=State.RCDATA,this._stateRcdata(_))}handleSpecialEndTag(_){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const Z=this.currentToken;switch(Z.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=State.BEFORE_ATTRIBUTE_NAME,!1;case CODE_POINTS.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=State.SELF_CLOSING_START_TAG,!1;case CODE_POINTS.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=State.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(_){this.handleSpecialEndTag(_)&&(this._emitChars("</"),this.state=State.RCDATA,this._stateRcdata(_))}_stateRawtextLessThanSign(_){_===CODE_POINTS.SOLIDUS?this.state=State.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=State.RAWTEXT,this._stateRawtext(_))}_stateRawtextEndTagOpen(_){isAsciiLetter(_)?(this.state=State.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(_)):(this._emitChars("</"),this.state=State.RAWTEXT,this._stateRawtext(_))}_stateRawtextEndTagName(_){this.handleSpecialEndTag(_)&&(this._emitChars("</"),this.state=State.RAWTEXT,this._stateRawtext(_))}_stateScriptDataLessThanSign(_){switch(_){case CODE_POINTS.SOLIDUS:{this.state=State.SCRIPT_DATA_END_TAG_OPEN;break}case CODE_POINTS.EXCLAMATION_MARK:{this.state=State.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=State.SCRIPT_DATA,this._stateScriptData(_)}}_stateScriptDataEndTagOpen(_){isAsciiLetter(_)?(this.state=State.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(_)):(this._emitChars("</"),this.state=State.SCRIPT_DATA,this._stateScriptData(_))}_stateScriptDataEndTagName(_){this.handleSpecialEndTag(_)&&(this._emitChars("</"),this.state=State.SCRIPT_DATA,this._stateScriptData(_))}_stateScriptDataEscapeStart(_){_===CODE_POINTS.HYPHEN_MINUS?(this.state=State.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=State.SCRIPT_DATA,this._stateScriptData(_))}_stateScriptDataEscapeStartDash(_){_===CODE_POINTS.HYPHEN_MINUS?(this.state=State.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=State.SCRIPT_DATA,this._stateScriptData(_))}_stateScriptDataEscaped(_){switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(_)}}_stateScriptDataEscapedDash(_){switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_ESCAPED,this._emitCodePoint(_)}}_stateScriptDataEscapedDashDash(_){switch(_){case CODE_POINTS.HYPHEN_MINUS:{this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.SCRIPT_DATA,this._emitChars(">");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_ESCAPED,this._emitCodePoint(_)}}_stateScriptDataEscapedLessThanSign(_){_===CODE_POINTS.SOLIDUS?this.state=State.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:isAsciiLetter(_)?(this._emitChars("<"),this.state=State.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(_)):(this._emitChars("<"),this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(_))}_stateScriptDataEscapedEndTagOpen(_){isAsciiLetter(_)?(this.state=State.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(_)):(this._emitChars("</"),this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(_))}_stateScriptDataEscapedEndTagName(_){this.handleSpecialEndTag(_)&&(this._emitChars("</"),this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(_))}_stateScriptDataDoubleEscapeStart(_){if(this.preprocessor.startsWith(SEQUENCES.SCRIPT,!1)&&isScriptDataDoubleEscapeSequenceEnd(this.preprocessor.peek(SEQUENCES.SCRIPT.length))){this._emitCodePoint(_);for(let Z=0;Z<SEQUENCES.SCRIPT.length;Z++)this._emitCodePoint(this._consume());this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(_))}_stateScriptDataDoubleEscaped(_){switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(_)}}_stateScriptDataDoubleEscapedDash(_){switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(_)}}_stateScriptDataDoubleEscapedDashDash(_){switch(_){case CODE_POINTS.HYPHEN_MINUS:{this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.SCRIPT_DATA,this._emitChars(">");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(_)}}_stateScriptDataDoubleEscapedLessThanSign(_){_===CODE_POINTS.SOLIDUS?(this.state=State.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(_))}_stateScriptDataDoubleEscapeEnd(_){if(this.preprocessor.startsWith(SEQUENCES.SCRIPT,!1)&&isScriptDataDoubleEscapeSequenceEnd(this.preprocessor.peek(SEQUENCES.SCRIPT.length))){this._emitCodePoint(_);for(let Z=0;Z<SEQUENCES.SCRIPT.length;Z++)this._emitCodePoint(this._consume());this.state=State.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(_))}_stateBeforeAttributeName(_){switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.SOLIDUS:case CODE_POINTS.GREATER_THAN_SIGN:case CODE_POINTS.EOF:{this.state=State.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(_);break}case CODE_POINTS.EQUALS_SIGN:{this._err(ERR.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=State.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=State.ATTRIBUTE_NAME,this._stateAttributeName(_)}}_stateAttributeName(_){switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:case CODE_POINTS.SOLIDUS:case CODE_POINTS.GREATER_THAN_SIGN:case CODE_POINTS.EOF:{this._leaveAttrName(),this.state=State.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(_);break}case CODE_POINTS.EQUALS_SIGN:{this._leaveAttrName(),this.state=State.BEFORE_ATTRIBUTE_VALUE;break}case CODE_POINTS.QUOTATION_MARK:case CODE_POINTS.APOSTROPHE:case CODE_POINTS.LESS_THAN_SIGN:{this._err(ERR.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(_);break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.name+=REPLACEMENT_CHARACTER;break}default:this.currentAttr.name+=String.fromCodePoint(isAsciiUpper(_)?toAsciiLower(_):_)}}_stateAfterAttributeName(_){switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.SOLIDUS:{this.state=State.SELF_CLOSING_START_TAG;break}case CODE_POINTS.EQUALS_SIGN:{this.state=State.BEFORE_ATTRIBUTE_VALUE;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=State.ATTRIBUTE_NAME,this._stateAttributeName(_)}}_stateBeforeAttributeValue(_){switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.QUOTATION_MARK:{this.state=State.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this.state=State.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingAttributeValue),this.state=State.DATA,this.emitCurrentTagToken();break}default:this.state=State.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(_)}}_stateAttributeValueDoubleQuoted(_){switch(_){case CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case CODE_POINTS.AMPERSAND:{this._startCharacterReference();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.value+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(_)}}_stateAttributeValueSingleQuoted(_){switch(_){case CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case CODE_POINTS.AMPERSAND:{this._startCharacterReference();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.value+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(_)}}_stateAttributeValueUnquoted(_){switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this._leaveAttrValue(),this.state=State.BEFORE_ATTRIBUTE_NAME;break}case CODE_POINTS.AMPERSAND:{this._startCharacterReference();break}case CODE_POINTS.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.value+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.QUOTATION_MARK:case CODE_POINTS.APOSTROPHE:case CODE_POINTS.LESS_THAN_SIGN:case CODE_POINTS.EQUALS_SIGN:case CODE_POINTS.GRAVE_ACCENT:{this._err(ERR.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(_);break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(_)}}_stateAfterAttributeValueQuoted(_){switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this._leaveAttrValue(),this.state=State.BEFORE_ATTRIBUTE_NAME;break}case CODE_POINTS.SOLIDUS:{this._leaveAttrValue(),this.state=State.SELF_CLOSING_START_TAG;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this._err(ERR.missingWhitespaceBetweenAttributes),this.state=State.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(_)}}_stateSelfClosingStartTag(_){switch(_){case CODE_POINTS.GREATER_THAN_SIGN:{const Z=this.currentToken;Z.selfClosing=!0,this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this._err(ERR.unexpectedSolidusInTag),this.state=State.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(_)}}_stateBogusComment(_){const Z=this.currentToken;switch(_){case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentComment(Z);break}case CODE_POINTS.EOF:{this.emitCurrentComment(Z),this._emitEOFToken();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.data+=REPLACEMENT_CHARACTER;break}default:Z.data+=String.fromCodePoint(_)}}_stateMarkupDeclarationOpen(_){this._consumeSequenceIfMatch(SEQUENCES.DASH_DASH,!0)?(this._createCommentToken(SEQUENCES.DASH_DASH.length+1),this.state=State.COMMENT_START):this._consumeSequenceIfMatch(SEQUENCES.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(SEQUENCES.DOCTYPE.length+1),this.state=State.DOCTYPE):this._consumeSequenceIfMatch(SEQUENCES.CDATA_START,!0)?this.inForeignNode?this.state=State.CDATA_SECTION:(this._err(ERR.cdataInHtmlContent),this._createCommentToken(SEQUENCES.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=State.BOGUS_COMMENT):this._ensureHibernation()||(this._err(ERR.incorrectlyOpenedComment),this._createCommentToken(2),this.state=State.BOGUS_COMMENT,this._stateBogusComment(_))}_stateCommentStart(_){switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_START_DASH;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptClosingOfEmptyComment),this.state=State.DATA;const Z=this.currentToken;this.emitCurrentComment(Z);break}default:this.state=State.COMMENT,this._stateComment(_)}}_stateCommentStartDash(_){const Z=this.currentToken;switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptClosingOfEmptyComment),this.state=State.DATA,this.emitCurrentComment(Z);break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Z),this._emitEOFToken();break}default:Z.data+="-",this.state=State.COMMENT,this._stateComment(_)}}_stateComment(_){const Z=this.currentToken;switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END_DASH;break}case CODE_POINTS.LESS_THAN_SIGN:{Z.data+="<",this.state=State.COMMENT_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.data+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Z),this._emitEOFToken();break}default:Z.data+=String.fromCodePoint(_)}}_stateCommentLessThanSign(_){const Z=this.currentToken;switch(_){case CODE_POINTS.EXCLAMATION_MARK:{Z.data+="!",this.state=State.COMMENT_LESS_THAN_SIGN_BANG;break}case CODE_POINTS.LESS_THAN_SIGN:{Z.data+="<";break}default:this.state=State.COMMENT,this._stateComment(_)}}_stateCommentLessThanSignBang(_){_===CODE_POINTS.HYPHEN_MINUS?this.state=State.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=State.COMMENT,this._stateComment(_))}_stateCommentLessThanSignBangDash(_){_===CODE_POINTS.HYPHEN_MINUS?this.state=State.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=State.COMMENT_END_DASH,this._stateCommentEndDash(_))}_stateCommentLessThanSignBangDashDash(_){_!==CODE_POINTS.GREATER_THAN_SIGN&&_!==CODE_POINTS.EOF&&this._err(ERR.nestedComment),this.state=State.COMMENT_END,this._stateCommentEnd(_)}_stateCommentEndDash(_){const Z=this.currentToken;switch(_){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END;break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Z),this._emitEOFToken();break}default:Z.data+="-",this.state=State.COMMENT,this._stateComment(_)}}_stateCommentEnd(_){const Z=this.currentToken;switch(_){case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentComment(Z);break}case CODE_POINTS.EXCLAMATION_MARK:{this.state=State.COMMENT_END_BANG;break}case CODE_POINTS.HYPHEN_MINUS:{Z.data+="-";break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Z),this._emitEOFToken();break}default:Z.data+="--",this.state=State.COMMENT,this._stateComment(_)}}_stateCommentEndBang(_){const Z=this.currentToken;switch(_){case CODE_POINTS.HYPHEN_MINUS:{Z.data+="--!",this.state=State.COMMENT_END_DASH;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.incorrectlyClosedComment),this.state=State.DATA,this.emitCurrentComment(Z);break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Z),this._emitEOFToken();break}default:Z.data+="--!",this.state=State.COMMENT,this._stateComment(_)}}_stateDoctype(_){switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_NAME;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(_);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),this._createDoctypeToken(null);const Z=this.currentToken;Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.missingWhitespaceBeforeDoctypeName),this.state=State.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(_)}}_stateBeforeDoctypeName(_){if(isAsciiUpper(_))this._createDoctypeToken(String.fromCharCode(toAsciiLower(_))),this.state=State.DOCTYPE_NAME;else switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._createDoctypeToken(REPLACEMENT_CHARACTER),this.state=State.DOCTYPE_NAME;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypeName),this._createDoctypeToken(null);const Z=this.currentToken;Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),this._createDoctypeToken(null);const Z=this.currentToken;Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(_)),this.state=State.DOCTYPE_NAME}}_stateDoctypeName(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.AFTER_DOCTYPE_NAME;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentDoctype(Z);break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.name+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:Z.name+=String.fromCodePoint(isAsciiUpper(_)?toAsciiLower(_):_)}}_stateAfterDoctypeName(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentDoctype(Z);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(SEQUENCES.PUBLIC,!1)?this.state=State.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(SEQUENCES.SYSTEM,!1)?this.state=State.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(ERR.invalidCharacterSequenceAfterDoctypeName),Z.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_))}}_stateAfterDoctypePublicKeyword(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case CODE_POINTS.QUOTATION_MARK:{this._err(ERR.missingWhitespaceAfterDoctypePublicKeyword),Z.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this._err(ERR.missingWhitespaceAfterDoctypePublicKeyword),Z.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypePublicIdentifier),Z.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Z);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypePublicIdentifier),Z.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_)}}_stateBeforeDoctypePublicIdentifier(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.QUOTATION_MARK:{Z.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{Z.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypePublicIdentifier),Z.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Z);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypePublicIdentifier),Z.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_)}}_stateDoctypePublicIdentifierDoubleQuoted(_){const Z=this.currentToken;switch(_){case CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.publicId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypePublicIdentifier),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:Z.publicId+=String.fromCodePoint(_)}}_stateDoctypePublicIdentifierSingleQuoted(_){const Z=this.currentToken;switch(_){case CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.publicId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypePublicIdentifier),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:Z.publicId+=String.fromCodePoint(_)}}_stateAfterDoctypePublicIdentifier(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentDoctype(Z);break}case CODE_POINTS.QUOTATION_MARK:{this._err(ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this._err(ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Z.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_)}}_stateBetweenDoctypePublicAndSystemIdentifiers(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.QUOTATION_MARK:{Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Z.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_)}}_stateAfterDoctypeSystemKeyword(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case CODE_POINTS.QUOTATION_MARK:{this._err(ERR.missingWhitespaceAfterDoctypeSystemKeyword),Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this._err(ERR.missingWhitespaceAfterDoctypeSystemKeyword),Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypeSystemIdentifier),Z.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Z);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Z.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_)}}_stateBeforeDoctypeSystemIdentifier(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.QUOTATION_MARK:{Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{Z.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypeSystemIdentifier),Z.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Z);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Z.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_)}}_stateDoctypeSystemIdentifierDoubleQuoted(_){const Z=this.currentToken;switch(_){case CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.systemId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypeSystemIdentifier),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:Z.systemId+=String.fromCodePoint(_)}}_stateDoctypeSystemIdentifierSingleQuoted(_){const Z=this.currentToken;switch(_){case CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Z.systemId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypeSystemIdentifier),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:Z.systemId+=String.fromCodePoint(_)}}_stateAfterDoctypeSystemIdentifier(_){const Z=this.currentToken;switch(_){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Z.forceQuirks=!0,this.emitCurrentDoctype(Z),this._emitEOFToken();break}default:this._err(ERR.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype(_)}}_stateBogusDoctype(_){const Z=this.currentToken;switch(_){case CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(Z),this.state=State.DATA;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter);break}case CODE_POINTS.EOF:{this.emitCurrentDoctype(Z),this._emitEOFToken();break}}}_stateCdataSection(_){switch(_){case CODE_POINTS.RIGHT_SQUARE_BRACKET:{this.state=State.CDATA_SECTION_BRACKET;break}case CODE_POINTS.EOF:{this._err(ERR.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(_)}}_stateCdataSectionBracket(_){_===CODE_POINTS.RIGHT_SQUARE_BRACKET?this.state=State.CDATA_SECTION_END:(this._emitChars("]"),this.state=State.CDATA_SECTION,this._stateCdataSection(_))}_stateCdataSectionEnd(_){switch(_){case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;break}case CODE_POINTS.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=State.CDATA_SECTION,this._stateCdataSection(_)}}_stateCharacterReference(){let _=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(_<0)if(this.preprocessor.lastChunkWritten)_=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}_===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(CODE_POINTS.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&isAsciiAlphaNumeric(this.preprocessor.peek(1))?State.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(_){isAsciiAlphaNumeric(_)?this._flushCodePointConsumedAsCharacterReference(_):(_===CODE_POINTS.SEMICOLON&&this._err(ERR.unknownNamedCharacterReference),this.state=this.returnState,this._callState(_))}}const IMPLICIT_END_TAG_REQUIRED=new Set([TAG_ID.DD,TAG_ID.DT,TAG_ID.LI,TAG_ID.OPTGROUP,TAG_ID.OPTION,TAG_ID.P,TAG_ID.RB,TAG_ID.RP,TAG_ID.RT,TAG_ID.RTC]),IMPLICIT_END_TAG_REQUIRED_THOROUGHLY=new Set([...IMPLICIT_END_TAG_REQUIRED,TAG_ID.CAPTION,TAG_ID.COLGROUP,TAG_ID.TBODY,TAG_ID.TD,TAG_ID.TFOOT,TAG_ID.TH,TAG_ID.THEAD,TAG_ID.TR]),SCOPING_ELEMENTS_HTML=new Set([TAG_ID.APPLET,TAG_ID.CAPTION,TAG_ID.HTML,TAG_ID.MARQUEE,TAG_ID.OBJECT,TAG_ID.TABLE,TAG_ID.TD,TAG_ID.TEMPLATE,TAG_ID.TH]),SCOPING_ELEMENTS_HTML_LIST=new Set([...SCOPING_ELEMENTS_HTML,TAG_ID.OL,TAG_ID.UL]),SCOPING_ELEMENTS_HTML_BUTTON=new Set([...SCOPING_ELEMENTS_HTML,TAG_ID.BUTTON]),SCOPING_ELEMENTS_MATHML=new Set([TAG_ID.ANNOTATION_XML,TAG_ID.MI,TAG_ID.MN,TAG_ID.MO,TAG_ID.MS,TAG_ID.MTEXT]),SCOPING_ELEMENTS_SVG=new Set([TAG_ID.DESC,TAG_ID.FOREIGN_OBJECT,TAG_ID.TITLE]),TABLE_ROW_CONTEXT=new Set([TAG_ID.TR,TAG_ID.TEMPLATE,TAG_ID.HTML]),TABLE_BODY_CONTEXT=new Set([TAG_ID.TBODY,TAG_ID.TFOOT,TAG_ID.THEAD,TAG_ID.TEMPLATE,TAG_ID.HTML]),TABLE_CONTEXT=new Set([TAG_ID.TABLE,TAG_ID.TEMPLATE,TAG_ID.HTML]),TABLE_CELLS=new Set([TAG_ID.TD,TAG_ID.TH]);class OpenElementStack{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(_,Z,te){this.treeAdapter=Z,this.handler=te,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=TAG_ID.UNKNOWN,this.current=_}_indexOf(_){return this.items.lastIndexOf(_,this.stackTop)}_isInTemplate(){return this.currentTagId===TAG_ID.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===NS.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(_,Z){this.stackTop++,this.items[this.stackTop]=_,this.current=_,this.tagIDs[this.stackTop]=Z,this.currentTagId=Z,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(_,Z,!0)}pop(){const _=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(_,!0)}replace(_,Z){const te=this._indexOf(_);this.items[te]=Z,te===this.stackTop&&(this.current=Z)}insertAfter(_,Z,te){const ne=this._indexOf(_)+1;this.items.splice(ne,0,Z),this.tagIDs.splice(ne,0,te),this.stackTop++,ne===this.stackTop&&this._updateCurrentElement(),this.current&&this.currentTagId!==void 0&&this.handler.onItemPush(this.current,this.currentTagId,ne===this.stackTop)}popUntilTagNamePopped(_){let Z=this.stackTop+1;do Z=this.tagIDs.lastIndexOf(_,Z-1);while(Z>0&&this.treeAdapter.getNamespaceURI(this.items[Z])!==NS.HTML);this.shortenToLength(Math.max(Z,0))}shortenToLength(_){for(;this.stackTop>=_;){const Z=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(Z,this.stackTop<_)}}popUntilElementPopped(_){const Z=this._indexOf(_);this.shortenToLength(Math.max(Z,0))}popUntilPopped(_,Z){const te=this._indexOfTagNames(_,Z);this.shortenToLength(Math.max(te,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(NUMBERED_HEADERS,NS.HTML)}popUntilTableCellPopped(){this.popUntilPopped(TABLE_CELLS,NS.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(_,Z){for(let te=this.stackTop;te>=0;te--)if(_.has(this.tagIDs[te])&&this.treeAdapter.getNamespaceURI(this.items[te])===Z)return te;return-1}clearBackTo(_,Z){const te=this._indexOfTagNames(_,Z);this.shortenToLength(te+1)}clearBackToTableContext(){this.clearBackTo(TABLE_CONTEXT,NS.HTML)}clearBackToTableBodyContext(){this.clearBackTo(TABLE_BODY_CONTEXT,NS.HTML)}clearBackToTableRowContext(){this.clearBackTo(TABLE_ROW_CONTEXT,NS.HTML)}remove(_){const Z=this._indexOf(_);Z>=0&&(Z===this.stackTop?this.pop():(this.items.splice(Z,1),this.tagIDs.splice(Z,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(_,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===TAG_ID.BODY?this.items[1]:null}contains(_){return this._indexOf(_)>-1}getCommonAncestor(_){const Z=this._indexOf(_)-1;return Z>=0?this.items[Z]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===TAG_ID.HTML}hasInDynamicScope(_,Z){for(let te=this.stackTop;te>=0;te--){const ne=this.tagIDs[te];switch(this.treeAdapter.getNamespaceURI(this.items[te])){case NS.HTML:{if(ne===_)return!0;if(Z.has(ne))return!1;break}case NS.SVG:{if(SCOPING_ELEMENTS_SVG.has(ne))return!1;break}case NS.MATHML:{if(SCOPING_ELEMENTS_MATHML.has(ne))return!1;break}}}return!0}hasInScope(_){return this.hasInDynamicScope(_,SCOPING_ELEMENTS_HTML)}hasInListItemScope(_){return this.hasInDynamicScope(_,SCOPING_ELEMENTS_HTML_LIST)}hasInButtonScope(_){return this.hasInDynamicScope(_,SCOPING_ELEMENTS_HTML_BUTTON)}hasNumberedHeaderInScope(){for(let _=this.stackTop;_>=0;_--){const Z=this.tagIDs[_];switch(this.treeAdapter.getNamespaceURI(this.items[_])){case NS.HTML:{if(NUMBERED_HEADERS.has(Z))return!0;if(SCOPING_ELEMENTS_HTML.has(Z))return!1;break}case NS.SVG:{if(SCOPING_ELEMENTS_SVG.has(Z))return!1;break}case NS.MATHML:{if(SCOPING_ELEMENTS_MATHML.has(Z))return!1;break}}}return!0}hasInTableScope(_){for(let Z=this.stackTop;Z>=0;Z--)if(this.treeAdapter.getNamespaceURI(this.items[Z])===NS.HTML)switch(this.tagIDs[Z]){case _:return!0;case TAG_ID.TABLE:case TAG_ID.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let _=this.stackTop;_>=0;_--)if(this.treeAdapter.getNamespaceURI(this.items[_])===NS.HTML)switch(this.tagIDs[_]){case TAG_ID.TBODY:case TAG_ID.THEAD:case TAG_ID.TFOOT:return!0;case TAG_ID.TABLE:case TAG_ID.HTML:return!1}return!0}hasInSelectScope(_){for(let Z=this.stackTop;Z>=0;Z--)if(this.treeAdapter.getNamespaceURI(this.items[Z])===NS.HTML)switch(this.tagIDs[Z]){case _:return!0;case TAG_ID.OPTION:case TAG_ID.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;this.currentTagId!==void 0&&IMPLICIT_END_TAG_REQUIRED.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;this.currentTagId!==void 0&&IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(_){for(;this.currentTagId!==void 0&&this.currentTagId!==_&&IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId);)this.pop()}}const NOAH_ARK_CAPACITY=3;var EntryType;(function(K){K[K.Marker=0]="Marker",K[K.Element=1]="Element"})(EntryType||(EntryType={}));const MARKER={type:EntryType.Marker};class FormattingElementList{constructor(_){this.treeAdapter=_,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(_,Z){const te=[],ne=Z.length,ie=this.treeAdapter.getTagName(_),oe=this.treeAdapter.getNamespaceURI(_);for(let se=0;se<this.entries.length;se++){const ae=this.entries[se];if(ae.type===EntryType.Marker)break;const{element:le}=ae;if(this.treeAdapter.getTagName(le)===ie&&this.treeAdapter.getNamespaceURI(le)===oe){const ce=this.treeAdapter.getAttrList(le);ce.length===ne&&te.push({idx:se,attrs:ce})}}return te}_ensureNoahArkCondition(_){if(this.entries.length<NOAH_ARK_CAPACITY)return;const Z=this.treeAdapter.getAttrList(_),te=this._getNoahArkConditionCandidates(_,Z);if(te.length<NOAH_ARK_CAPACITY)return;const ne=new Map(Z.map(oe=>[oe.name,oe.value]));let ie=0;for(let oe=0;oe<te.length;oe++){const se=te[oe];se.attrs.every(ae=>ne.get(ae.name)===ae.value)&&(ie+=1,ie>=NOAH_ARK_CAPACITY&&this.entries.splice(se.idx,1))}}insertMarker(){this.entries.unshift(MARKER)}pushElement(_,Z){this._ensureNoahArkCondition(_),this.entries.unshift({type:EntryType.Element,element:_,token:Z})}insertElementAfterBookmark(_,Z){const te=this.entries.indexOf(this.bookmark);this.entries.splice(te,0,{type:EntryType.Element,element:_,token:Z})}removeEntry(_){const Z=this.entries.indexOf(_);Z!==-1&&this.entries.splice(Z,1)}clearToLastMarker(){const _=this.entries.indexOf(MARKER);_===-1?this.entries.length=0:this.entries.splice(0,_+1)}getElementEntryInScopeWithTagName(_){const Z=this.entries.find(te=>te.type===EntryType.Marker||this.treeAdapter.getTagName(te.element)===_);return Z&&Z.type===EntryType.Element?Z:null}getElementEntry(_){return this.entries.find(Z=>Z.type===EntryType.Element&&Z.element===_)}}const defaultTreeAdapter={createDocument(){return{nodeName:"#document",mode:DOCUMENT_MODE.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(K,_,Z){return{nodeName:K,tagName:K,attrs:Z,namespaceURI:_,childNodes:[],parentNode:null}},createCommentNode(K){return{nodeName:"#comment",data:K,parentNode:null}},createTextNode(K){return{nodeName:"#text",value:K,parentNode:null}},appendChild(K,_){K.childNodes.push(_),_.parentNode=K},insertBefore(K,_,Z){const te=K.childNodes.indexOf(Z);K.childNodes.splice(te,0,_),_.parentNode=K},setTemplateContent(K,_){K.content=_},getTemplateContent(K){return K.content},setDocumentType(K,_,Z,te){const ne=K.childNodes.find(ie=>ie.nodeName==="#documentType");if(ne)ne.name=_,ne.publicId=Z,ne.systemId=te;else{const ie={nodeName:"#documentType",name:_,publicId:Z,systemId:te,parentNode:null};defaultTreeAdapter.appendChild(K,ie)}},setDocumentMode(K,_){K.mode=_},getDocumentMode(K){return K.mode},detachNode(K){if(K.parentNode){const _=K.parentNode.childNodes.indexOf(K);K.parentNode.childNodes.splice(_,1),K.parentNode=null}},insertText(K,_){if(K.childNodes.length>0){const Z=K.childNodes[K.childNodes.length-1];if(defaultTreeAdapter.isTextNode(Z)){Z.value+=_;return}}defaultTreeAdapter.appendChild(K,defaultTreeAdapter.createTextNode(_))},insertTextBefore(K,_,Z){const te=K.childNodes[K.childNodes.indexOf(Z)-1];te&&defaultTreeAdapter.isTextNode(te)?te.value+=_:defaultTreeAdapter.insertBefore(K,defaultTreeAdapter.createTextNode(_),Z)},adoptAttributes(K,_){const Z=new Set(K.attrs.map(te=>te.name));for(let te=0;te<_.length;te++)Z.has(_[te].name)||K.attrs.push(_[te])},getFirstChild(K){return K.childNodes[0]},getChildNodes(K){return K.childNodes},getParentNode(K){return K.parentNode},getAttrList(K){return K.attrs},getTagName(K){return K.tagName},getNamespaceURI(K){return K.namespaceURI},getTextNodeContent(K){return K.value},getCommentNodeContent(K){return K.data},getDocumentTypeNodeName(K){return K.name},getDocumentTypeNodePublicId(K){return K.publicId},getDocumentTypeNodeSystemId(K){return K.systemId},isTextNode(K){return K.nodeName==="#text"},isCommentNode(K){return K.nodeName==="#comment"},isDocumentTypeNode(K){return K.nodeName==="#documentType"},isElementNode(K){return Object.prototype.hasOwnProperty.call(K,"tagName")},setNodeSourceCodeLocation(K,_){K.sourceCodeLocation=_},getNodeSourceCodeLocation(K){return K.sourceCodeLocation},updateNodeSourceCodeLocation(K,_){K.sourceCodeLocation={...K.sourceCodeLocation,..._}}},VALID_DOCTYPE_NAME="html",VALID_SYSTEM_ID="about:legacy-compat",QUIRKS_MODE_SYSTEM_ID="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",QUIRKS_MODE_PUBLIC_ID_PREFIXES=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES=[...QUIRKS_MODE_PUBLIC_ID_PREFIXES,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],QUIRKS_MODE_PUBLIC_IDS=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),LIMITED_QUIRKS_PUBLIC_ID_PREFIXES=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES=[...LIMITED_QUIRKS_PUBLIC_ID_PREFIXES,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function hasPrefix(K,_){return _.some(Z=>K.startsWith(Z))}function isConforming(K){return K.name===VALID_DOCTYPE_NAME&&K.publicId===null&&(K.systemId===null||K.systemId===VALID_SYSTEM_ID)}function getDocumentMode(K){if(K.name!==VALID_DOCTYPE_NAME)return DOCUMENT_MODE.QUIRKS;const{systemId:_}=K;if(_&&_.toLowerCase()===QUIRKS_MODE_SYSTEM_ID)return DOCUMENT_MODE.QUIRKS;let{publicId:Z}=K;if(Z!==null){if(Z=Z.toLowerCase(),QUIRKS_MODE_PUBLIC_IDS.has(Z))return DOCUMENT_MODE.QUIRKS;let te=_===null?QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES:QUIRKS_MODE_PUBLIC_ID_PREFIXES;if(hasPrefix(Z,te))return DOCUMENT_MODE.QUIRKS;if(te=_===null?LIMITED_QUIRKS_PUBLIC_ID_PREFIXES:LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES,hasPrefix(Z,te))return DOCUMENT_MODE.LIMITED_QUIRKS}return DOCUMENT_MODE.NO_QUIRKS}const MIME_TYPES={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},DEFINITION_URL_ATTR="definitionurl",ADJUSTED_DEFINITION_URL_ATTR="definitionURL",SVG_ATTRS_ADJUSTMENT_MAP=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(K=>[K.toLowerCase(),K])),XML_ATTRS_ADJUSTMENT_MAP=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:NS.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:NS.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:NS.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:NS.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:NS.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:NS.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:NS.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:NS.XML}],["xml:space",{prefix:"xml",name:"space",namespace:NS.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:NS.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:NS.XMLNS}]]),SVG_TAG_NAMES_ADJUSTMENT_MAP=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(K=>[K.toLowerCase(),K])),EXITS_FOREIGN_CONTENT=new Set([TAG_ID.B,TAG_ID.BIG,TAG_ID.BLOCKQUOTE,TAG_ID.BODY,TAG_ID.BR,TAG_ID.CENTER,TAG_ID.CODE,TAG_ID.DD,TAG_ID.DIV,TAG_ID.DL,TAG_ID.DT,TAG_ID.EM,TAG_ID.EMBED,TAG_ID.H1,TAG_ID.H2,TAG_ID.H3,TAG_ID.H4,TAG_ID.H5,TAG_ID.H6,TAG_ID.HEAD,TAG_ID.HR,TAG_ID.I,TAG_ID.IMG,TAG_ID.LI,TAG_ID.LISTING,TAG_ID.MENU,TAG_ID.META,TAG_ID.NOBR,TAG_ID.OL,TAG_ID.P,TAG_ID.PRE,TAG_ID.RUBY,TAG_ID.S,TAG_ID.SMALL,TAG_ID.SPAN,TAG_ID.STRONG,TAG_ID.STRIKE,TAG_ID.SUB,TAG_ID.SUP,TAG_ID.TABLE,TAG_ID.TT,TAG_ID.U,TAG_ID.UL,TAG_ID.VAR]);function causesExit(K){const _=K.tagID;return _===TAG_ID.FONT&&K.attrs.some(({name:Z})=>Z===ATTRS.COLOR||Z===ATTRS.SIZE||Z===ATTRS.FACE)||EXITS_FOREIGN_CONTENT.has(_)}function adjustTokenMathMLAttrs(K){for(let _=0;_<K.attrs.length;_++)if(K.attrs[_].name===DEFINITION_URL_ATTR){K.attrs[_].name=ADJUSTED_DEFINITION_URL_ATTR;break}}function adjustTokenSVGAttrs(K){for(let _=0;_<K.attrs.length;_++){const Z=SVG_ATTRS_ADJUSTMENT_MAP.get(K.attrs[_].name);Z!=null&&(K.attrs[_].name=Z)}}function adjustTokenXMLAttrs(K){for(let _=0;_<K.attrs.length;_++){const Z=XML_ATTRS_ADJUSTMENT_MAP.get(K.attrs[_].name);Z&&(K.attrs[_].prefix=Z.prefix,K.attrs[_].name=Z.name,K.attrs[_].namespace=Z.namespace)}}function adjustTokenSVGTagName(K){const _=SVG_TAG_NAMES_ADJUSTMENT_MAP.get(K.tagName);_!=null&&(K.tagName=_,K.tagID=getTagID(K.tagName))}function isMathMLTextIntegrationPoint(K,_){return _===NS.MATHML&&(K===TAG_ID.MI||K===TAG_ID.MO||K===TAG_ID.MN||K===TAG_ID.MS||K===TAG_ID.MTEXT)}function isHtmlIntegrationPoint(K,_,Z){if(_===NS.MATHML&&K===TAG_ID.ANNOTATION_XML){for(let te=0;te<Z.length;te++)if(Z[te].name===ATTRS.ENCODING){const ne=Z[te].value.toLowerCase();return ne===MIME_TYPES.TEXT_HTML||ne===MIME_TYPES.APPLICATION_XML}}return _===NS.SVG&&(K===TAG_ID.FOREIGN_OBJECT||K===TAG_ID.DESC||K===TAG_ID.TITLE)}function isIntegrationPoint(K,_,Z,te){return(!te||te===NS.HTML)&&isHtmlIntegrationPoint(K,_,Z)||(!te||te===NS.MATHML)&&isMathMLTextIntegrationPoint(K,_)}const HIDDEN_INPUT_TYPE="hidden",AA_OUTER_LOOP_ITER=8,AA_INNER_LOOP_ITER=3;var InsertionMode;(function(K){K[K.INITIAL=0]="INITIAL",K[K.BEFORE_HTML=1]="BEFORE_HTML",K[K.BEFORE_HEAD=2]="BEFORE_HEAD",K[K.IN_HEAD=3]="IN_HEAD",K[K.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",K[K.AFTER_HEAD=5]="AFTER_HEAD",K[K.IN_BODY=6]="IN_BODY",K[K.TEXT=7]="TEXT",K[K.IN_TABLE=8]="IN_TABLE",K[K.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",K[K.IN_CAPTION=10]="IN_CAPTION",K[K.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",K[K.IN_TABLE_BODY=12]="IN_TABLE_BODY",K[K.IN_ROW=13]="IN_ROW",K[K.IN_CELL=14]="IN_CELL",K[K.IN_SELECT=15]="IN_SELECT",K[K.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",K[K.IN_TEMPLATE=17]="IN_TEMPLATE",K[K.AFTER_BODY=18]="AFTER_BODY",K[K.IN_FRAMESET=19]="IN_FRAMESET",K[K.AFTER_FRAMESET=20]="AFTER_FRAMESET",K[K.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",K[K.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(InsertionMode||(InsertionMode={}));const BASE_LOC={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},TABLE_STRUCTURE_TAGS=new Set([TAG_ID.TABLE,TAG_ID.TBODY,TAG_ID.TFOOT,TAG_ID.THEAD,TAG_ID.TR]),defaultParserOptions={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:defaultTreeAdapter,onParseError:null};class Parser{constructor(_,Z,te=null,ne=null){this.fragmentContext=te,this.scriptHandler=ne,this.currentToken=null,this.stopped=!1,this.insertionMode=InsertionMode.INITIAL,this.originalInsertionMode=InsertionMode.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...defaultParserOptions,..._},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=Z??this.treeAdapter.createDocument(),this.tokenizer=new Tokenizer(this.options,this),this.activeFormattingElements=new FormattingElementList(this.treeAdapter),this.fragmentContextID=te?getTagID(this.treeAdapter.getTagName(te)):TAG_ID.UNKNOWN,this._setContextModes(te??this.document,this.fragmentContextID),this.openElements=new OpenElementStack(this.document,this.treeAdapter,this)}static parse(_,Z){const te=new this(Z);return te.tokenizer.write(_,!0),te.document}static getFragmentParser(_,Z){const te={...defaultParserOptions,...Z};_??(_=te.treeAdapter.createElement(TAG_NAMES.TEMPLATE,NS.HTML,[]));const ne=te.treeAdapter.createElement("documentmock",NS.HTML,[]),ie=new this(te,ne,_);return ie.fragmentContextID===TAG_ID.TEMPLATE&&ie.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE),ie._initTokenizerForFragmentParsing(),ie._insertFakeRootElement(),ie._resetInsertionMode(),ie._findFormInFragmentContext(),ie}getFragment(){const _=this.treeAdapter.getFirstChild(this.document),Z=this.treeAdapter.createDocumentFragment();return this._adoptNodes(_,Z),Z}_err(_,Z,te){var ne;if(!this.onParseError)return;const ie=(ne=_.location)!==null&&ne!==void 0?ne:BASE_LOC,oe={code:Z,startLine:ie.startLine,startCol:ie.startCol,startOffset:ie.startOffset,endLine:te?ie.startLine:ie.endLine,endCol:te?ie.startCol:ie.endCol,endOffset:te?ie.startOffset:ie.endOffset};this.onParseError(oe)}onItemPush(_,Z,te){var ne,ie;(ie=(ne=this.treeAdapter).onItemPush)===null||ie===void 0||ie.call(ne,_),te&&this.openElements.stackTop>0&&this._setContextModes(_,Z)}onItemPop(_,Z){var te,ne;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(_,this.currentToken),(ne=(te=this.treeAdapter).onItemPop)===null||ne===void 0||ne.call(te,_,this.openElements.current),Z){let ie,oe;this.openElements.stackTop===0&&this.fragmentContext?(ie=this.fragmentContext,oe=this.fragmentContextID):{current:ie,currentTagId:oe}=this.openElements,this._setContextModes(ie,oe)}}_setContextModes(_,Z){const te=_===this.document||_&&this.treeAdapter.getNamespaceURI(_)===NS.HTML;this.currentNotInHTML=!te,this.tokenizer.inForeignNode=!te&&_!==void 0&&Z!==void 0&&!this._isIntegrationPoint(Z,_)}_switchToTextParsing(_,Z){this._insertElement(_,NS.HTML),this.tokenizer.state=Z,this.originalInsertionMode=this.insertionMode,this.insertionMode=InsertionMode.TEXT}switchToPlaintextParsing(){this.insertionMode=InsertionMode.TEXT,this.originalInsertionMode=InsertionMode.IN_BODY,this.tokenizer.state=TokenizerMode.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let _=this.fragmentContext;for(;_;){if(this.treeAdapter.getTagName(_)===TAG_NAMES.FORM){this.formElement=_;break}_=this.treeAdapter.getParentNode(_)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==NS.HTML))switch(this.fragmentContextID){case TAG_ID.TITLE:case TAG_ID.TEXTAREA:{this.tokenizer.state=TokenizerMode.RCDATA;break}case TAG_ID.STYLE:case TAG_ID.XMP:case TAG_ID.IFRAME:case TAG_ID.NOEMBED:case TAG_ID.NOFRAMES:case TAG_ID.NOSCRIPT:{this.tokenizer.state=TokenizerMode.RAWTEXT;break}case TAG_ID.SCRIPT:{this.tokenizer.state=TokenizerMode.SCRIPT_DATA;break}case TAG_ID.PLAINTEXT:{this.tokenizer.state=TokenizerMode.PLAINTEXT;break}}}_setDocumentType(_){const Z=_.name||"",te=_.publicId||"",ne=_.systemId||"";if(this.treeAdapter.setDocumentType(this.document,Z,te,ne),_.location){const ie=this.treeAdapter.getChildNodes(this.document).find(oe=>this.treeAdapter.isDocumentTypeNode(oe));ie&&this.treeAdapter.setNodeSourceCodeLocation(ie,_.location)}}_attachElementToTree(_,Z){if(this.options.sourceCodeLocationInfo){const te=Z&&{...Z,startTag:Z};this.treeAdapter.setNodeSourceCodeLocation(_,te)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(_);else{const te=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(te??this.document,_)}}_appendElement(_,Z){const te=this.treeAdapter.createElement(_.tagName,Z,_.attrs);this._attachElementToTree(te,_.location)}_insertElement(_,Z){const te=this.treeAdapter.createElement(_.tagName,Z,_.attrs);this._attachElementToTree(te,_.location),this.openElements.push(te,_.tagID)}_insertFakeElement(_,Z){const te=this.treeAdapter.createElement(_,NS.HTML,[]);this._attachElementToTree(te,null),this.openElements.push(te,Z)}_insertTemplate(_){const Z=this.treeAdapter.createElement(_.tagName,NS.HTML,_.attrs),te=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(Z,te),this._attachElementToTree(Z,_.location),this.openElements.push(Z,_.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(te,null)}_insertFakeRootElement(){const _=this.treeAdapter.createElement(TAG_NAMES.HTML,NS.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(_,null),this.treeAdapter.appendChild(this.openElements.current,_),this.openElements.push(_,TAG_ID.HTML)}_appendCommentNode(_,Z){const te=this.treeAdapter.createCommentNode(_.data);this.treeAdapter.appendChild(Z,te),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(te,_.location)}_insertCharacters(_){let Z,te;if(this._shouldFosterParentOnInsertion()?({parent:Z,beforeElement:te}=this._findFosterParentingLocation(),te?this.treeAdapter.insertTextBefore(Z,_.chars,te):this.treeAdapter.insertText(Z,_.chars)):(Z=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(Z,_.chars)),!_.location)return;const ne=this.treeAdapter.getChildNodes(Z),ie=te?ne.lastIndexOf(te):ne.length,oe=ne[ie-1];if(this.treeAdapter.getNodeSourceCodeLocation(oe)){const{endLine:se,endCol:ae,endOffset:le}=_.location;this.treeAdapter.updateNodeSourceCodeLocation(oe,{endLine:se,endCol:ae,endOffset:le})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(oe,_.location)}_adoptNodes(_,Z){for(let te=this.treeAdapter.getFirstChild(_);te;te=this.treeAdapter.getFirstChild(_))this.treeAdapter.detachNode(te),this.treeAdapter.appendChild(Z,te)}_setEndLocation(_,Z){if(this.treeAdapter.getNodeSourceCodeLocation(_)&&Z.location){const te=Z.location,ne=this.treeAdapter.getTagName(_),ie=Z.type===TokenType.END_TAG&&ne===Z.tagName?{endTag:{...te},endLine:te.endLine,endCol:te.endCol,endOffset:te.endOffset}:{endLine:te.startLine,endCol:te.startCol,endOffset:te.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(_,ie)}}shouldProcessStartTagTokenInForeignContent(_){if(!this.currentNotInHTML)return!1;let Z,te;return this.openElements.stackTop===0&&this.fragmentContext?(Z=this.fragmentContext,te=this.fragmentContextID):{current:Z,currentTagId:te}=this.openElements,_.tagID===TAG_ID.SVG&&this.treeAdapter.getTagName(Z)===TAG_NAMES.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(Z)===NS.MATHML?!1:this.tokenizer.inForeignNode||(_.tagID===TAG_ID.MGLYPH||_.tagID===TAG_ID.MALIGNMARK)&&te!==void 0&&!this._isIntegrationPoint(te,Z,NS.HTML)}_processToken(_){switch(_.type){case TokenType.CHARACTER:{this.onCharacter(_);break}case TokenType.NULL_CHARACTER:{this.onNullCharacter(_);break}case TokenType.COMMENT:{this.onComment(_);break}case TokenType.DOCTYPE:{this.onDoctype(_);break}case TokenType.START_TAG:{this._processStartTag(_);break}case TokenType.END_TAG:{this.onEndTag(_);break}case TokenType.EOF:{this.onEof(_);break}case TokenType.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(_);break}}}_isIntegrationPoint(_,Z,te){const ne=this.treeAdapter.getNamespaceURI(Z),ie=this.treeAdapter.getAttrList(Z);return isIntegrationPoint(_,ne,ie,te)}_reconstructActiveFormattingElements(){const _=this.activeFormattingElements.entries.length;if(_){const Z=this.activeFormattingElements.entries.findIndex(ne=>ne.type===EntryType.Marker||this.openElements.contains(ne.element)),te=Z===-1?_-1:Z-1;for(let ne=te;ne>=0;ne--){const ie=this.activeFormattingElements.entries[ne];this._insertElement(ie.token,this.treeAdapter.getNamespaceURI(ie.element)),ie.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=InsertionMode.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(TAG_ID.P),this.openElements.popUntilTagNamePopped(TAG_ID.P)}_resetInsertionMode(){for(let _=this.openElements.stackTop;_>=0;_--)switch(_===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[_]){case TAG_ID.TR:{this.insertionMode=InsertionMode.IN_ROW;return}case TAG_ID.TBODY:case TAG_ID.THEAD:case TAG_ID.TFOOT:{this.insertionMode=InsertionMode.IN_TABLE_BODY;return}case TAG_ID.CAPTION:{this.insertionMode=InsertionMode.IN_CAPTION;return}case TAG_ID.COLGROUP:{this.insertionMode=InsertionMode.IN_COLUMN_GROUP;return}case TAG_ID.TABLE:{this.insertionMode=InsertionMode.IN_TABLE;return}case TAG_ID.BODY:{this.insertionMode=InsertionMode.IN_BODY;return}case TAG_ID.FRAMESET:{this.insertionMode=InsertionMode.IN_FRAMESET;return}case TAG_ID.SELECT:{this._resetInsertionModeForSelect(_);return}case TAG_ID.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case TAG_ID.HTML:{this.insertionMode=this.headElement?InsertionMode.AFTER_HEAD:InsertionMode.BEFORE_HEAD;return}case TAG_ID.TD:case TAG_ID.TH:{if(_>0){this.insertionMode=InsertionMode.IN_CELL;return}break}case TAG_ID.HEAD:{if(_>0){this.insertionMode=InsertionMode.IN_HEAD;return}break}}this.insertionMode=InsertionMode.IN_BODY}_resetInsertionModeForSelect(_){if(_>0)for(let Z=_-1;Z>0;Z--){const te=this.openElements.tagIDs[Z];if(te===TAG_ID.TEMPLATE)break;if(te===TAG_ID.TABLE){this.insertionMode=InsertionMode.IN_SELECT_IN_TABLE;return}}this.insertionMode=InsertionMode.IN_SELECT}_isElementCausesFosterParenting(_){return TABLE_STRUCTURE_TAGS.has(_)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this.openElements.currentTagId!==void 0&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let _=this.openElements.stackTop;_>=0;_--){const Z=this.openElements.items[_];switch(this.openElements.tagIDs[_]){case TAG_ID.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(Z)===NS.HTML)return{parent:this.treeAdapter.getTemplateContent(Z),beforeElement:null};break}case TAG_ID.TABLE:{const te=this.treeAdapter.getParentNode(Z);return te?{parent:te,beforeElement:Z}:{parent:this.openElements.items[_-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(_){const Z=this._findFosterParentingLocation();Z.beforeElement?this.treeAdapter.insertBefore(Z.parent,_,Z.beforeElement):this.treeAdapter.appendChild(Z.parent,_)}_isSpecialElement(_,Z){const te=this.treeAdapter.getNamespaceURI(_);return SPECIAL_ELEMENTS[te].has(Z)}onCharacter(_){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){characterInForeignContent(this,_);return}switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,_);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,_);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,_);break}case InsertionMode.IN_HEAD:{tokenInHead(this,_);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,_);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,_);break}case InsertionMode.IN_BODY:case InsertionMode.IN_CAPTION:case InsertionMode.IN_CELL:case InsertionMode.IN_TEMPLATE:{characterInBody(this,_);break}case InsertionMode.TEXT:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:{this._insertCharacters(_);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,_);break}case InsertionMode.IN_TABLE_TEXT:{characterInTableText(this,_);break}case InsertionMode.IN_COLUMN_GROUP:{tokenInColumnGroup(this,_);break}case InsertionMode.AFTER_BODY:{tokenAfterBody(this,_);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,_);break}}}onNullCharacter(_){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){nullCharacterInForeignContent(this,_);return}switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,_);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,_);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,_);break}case InsertionMode.IN_HEAD:{tokenInHead(this,_);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,_);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,_);break}case InsertionMode.TEXT:{this._insertCharacters(_);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,_);break}case InsertionMode.IN_COLUMN_GROUP:{tokenInColumnGroup(this,_);break}case InsertionMode.AFTER_BODY:{tokenAfterBody(this,_);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,_);break}}}onComment(_){if(this.skipNextNewLine=!1,this.currentNotInHTML){appendComment(this,_);return}switch(this.insertionMode){case InsertionMode.INITIAL:case InsertionMode.BEFORE_HTML:case InsertionMode.BEFORE_HEAD:case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:case InsertionMode.IN_BODY:case InsertionMode.IN_TABLE:case InsertionMode.IN_CAPTION:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:case InsertionMode.IN_CELL:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:case InsertionMode.IN_TEMPLATE:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:{appendComment(this,_);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,_);break}case InsertionMode.AFTER_BODY:{appendCommentToRootHtmlElement(this,_);break}case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{appendCommentToDocument(this,_);break}}}onDoctype(_){switch(this.skipNextNewLine=!1,this.insertionMode){case InsertionMode.INITIAL:{doctypeInInitialMode(this,_);break}case InsertionMode.BEFORE_HEAD:case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:{this._err(_,ERR.misplacedDoctype);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,_);break}}}onStartTag(_){this.skipNextNewLine=!1,this.currentToken=_,this._processStartTag(_),_.selfClosing&&!_.ackSelfClosing&&this._err(_,ERR.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(_){this.shouldProcessStartTagTokenInForeignContent(_)?startTagInForeignContent(this,_):this._startTagOutsideForeignContent(_)}_startTagOutsideForeignContent(_){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,_);break}case InsertionMode.BEFORE_HTML:{startTagBeforeHtml(this,_);break}case InsertionMode.BEFORE_HEAD:{startTagBeforeHead(this,_);break}case InsertionMode.IN_HEAD:{startTagInHead(this,_);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{startTagInHeadNoScript(this,_);break}case InsertionMode.AFTER_HEAD:{startTagAfterHead(this,_);break}case InsertionMode.IN_BODY:{startTagInBody(this,_);break}case InsertionMode.IN_TABLE:{startTagInTable(this,_);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,_);break}case InsertionMode.IN_CAPTION:{startTagInCaption(this,_);break}case InsertionMode.IN_COLUMN_GROUP:{startTagInColumnGroup(this,_);break}case InsertionMode.IN_TABLE_BODY:{startTagInTableBody(this,_);break}case InsertionMode.IN_ROW:{startTagInRow(this,_);break}case InsertionMode.IN_CELL:{startTagInCell(this,_);break}case InsertionMode.IN_SELECT:{startTagInSelect(this,_);break}case InsertionMode.IN_SELECT_IN_TABLE:{startTagInSelectInTable(this,_);break}case InsertionMode.IN_TEMPLATE:{startTagInTemplate(this,_);break}case InsertionMode.AFTER_BODY:{startTagAfterBody(this,_);break}case InsertionMode.IN_FRAMESET:{startTagInFrameset(this,_);break}case InsertionMode.AFTER_FRAMESET:{startTagAfterFrameset(this,_);break}case InsertionMode.AFTER_AFTER_BODY:{startTagAfterAfterBody(this,_);break}case InsertionMode.AFTER_AFTER_FRAMESET:{startTagAfterAfterFrameset(this,_);break}}}onEndTag(_){this.skipNextNewLine=!1,this.currentToken=_,this.currentNotInHTML?endTagInForeignContent(this,_):this._endTagOutsideForeignContent(_)}_endTagOutsideForeignContent(_){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,_);break}case InsertionMode.BEFORE_HTML:{endTagBeforeHtml(this,_);break}case InsertionMode.BEFORE_HEAD:{endTagBeforeHead(this,_);break}case InsertionMode.IN_HEAD:{endTagInHead(this,_);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{endTagInHeadNoScript(this,_);break}case InsertionMode.AFTER_HEAD:{endTagAfterHead(this,_);break}case InsertionMode.IN_BODY:{endTagInBody(this,_);break}case InsertionMode.TEXT:{endTagInText(this,_);break}case InsertionMode.IN_TABLE:{endTagInTable(this,_);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,_);break}case InsertionMode.IN_CAPTION:{endTagInCaption(this,_);break}case InsertionMode.IN_COLUMN_GROUP:{endTagInColumnGroup(this,_);break}case InsertionMode.IN_TABLE_BODY:{endTagInTableBody(this,_);break}case InsertionMode.IN_ROW:{endTagInRow(this,_);break}case InsertionMode.IN_CELL:{endTagInCell(this,_);break}case InsertionMode.IN_SELECT:{endTagInSelect(this,_);break}case InsertionMode.IN_SELECT_IN_TABLE:{endTagInSelectInTable(this,_);break}case InsertionMode.IN_TEMPLATE:{endTagInTemplate(this,_);break}case InsertionMode.AFTER_BODY:{endTagAfterBody(this,_);break}case InsertionMode.IN_FRAMESET:{endTagInFrameset(this,_);break}case InsertionMode.AFTER_FRAMESET:{endTagAfterFrameset(this,_);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,_);break}}}onEof(_){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,_);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,_);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,_);break}case InsertionMode.IN_HEAD:{tokenInHead(this,_);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,_);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,_);break}case InsertionMode.IN_BODY:case InsertionMode.IN_TABLE:case InsertionMode.IN_CAPTION:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:case InsertionMode.IN_CELL:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:{eofInBody(this,_);break}case InsertionMode.TEXT:{eofInText(this,_);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,_);break}case InsertionMode.IN_TEMPLATE:{eofInTemplate(this,_);break}case InsertionMode.AFTER_BODY:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{stopParsing(this,_);break}}}onWhitespaceCharacter(_){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,_.chars.charCodeAt(0)===CODE_POINTS.LINE_FEED)){if(_.chars.length===1)return;_.chars=_.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(_);return}switch(this.insertionMode){case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:case InsertionMode.TEXT:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:{this._insertCharacters(_);break}case InsertionMode.IN_BODY:case InsertionMode.IN_CAPTION:case InsertionMode.IN_CELL:case InsertionMode.IN_TEMPLATE:case InsertionMode.AFTER_BODY:case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{whitespaceCharacterInBody(this,_);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,_);break}case InsertionMode.IN_TABLE_TEXT:{whitespaceCharacterInTableText(this,_);break}}}}function aaObtainFormattingElementEntry(K,_){let Z=K.activeFormattingElements.getElementEntryInScopeWithTagName(_.tagName);return Z?K.openElements.contains(Z.element)?K.openElements.hasInScope(_.tagID)||(Z=null):(K.activeFormattingElements.removeEntry(Z),Z=null):genericEndTagInBody(K,_),Z}function aaObtainFurthestBlock(K,_){let Z=null,te=K.openElements.stackTop;for(;te>=0;te--){const ne=K.openElements.items[te];if(ne===_.element)break;K._isSpecialElement(ne,K.openElements.tagIDs[te])&&(Z=ne)}return Z||(K.openElements.shortenToLength(Math.max(te,0)),K.activeFormattingElements.removeEntry(_)),Z}function aaInnerLoop(K,_,Z){let te=_,ne=K.openElements.getCommonAncestor(_);for(let ie=0,oe=ne;oe!==Z;ie++,oe=ne){ne=K.openElements.getCommonAncestor(oe);const se=K.activeFormattingElements.getElementEntry(oe),ae=se&&ie>=AA_INNER_LOOP_ITER;!se||ae?(ae&&K.activeFormattingElements.removeEntry(se),K.openElements.remove(oe)):(oe=aaRecreateElementFromEntry(K,se),te===_&&(K.activeFormattingElements.bookmark=se),K.treeAdapter.detachNode(te),K.treeAdapter.appendChild(oe,te),te=oe)}return te}function aaRecreateElementFromEntry(K,_){const Z=K.treeAdapter.getNamespaceURI(_.element),te=K.treeAdapter.createElement(_.token.tagName,Z,_.token.attrs);return K.openElements.replace(_.element,te),_.element=te,te}function aaInsertLastNodeInCommonAncestor(K,_,Z){const te=K.treeAdapter.getTagName(_),ne=getTagID(te);if(K._isElementCausesFosterParenting(ne))K._fosterParentElement(Z);else{const ie=K.treeAdapter.getNamespaceURI(_);ne===TAG_ID.TEMPLATE&&ie===NS.HTML&&(_=K.treeAdapter.getTemplateContent(_)),K.treeAdapter.appendChild(_,Z)}}function aaReplaceFormattingElement(K,_,Z){const te=K.treeAdapter.getNamespaceURI(Z.element),{token:ne}=Z,ie=K.treeAdapter.createElement(ne.tagName,te,ne.attrs);K._adoptNodes(_,ie),K.treeAdapter.appendChild(_,ie),K.activeFormattingElements.insertElementAfterBookmark(ie,ne),K.activeFormattingElements.removeEntry(Z),K.openElements.remove(Z.element),K.openElements.insertAfter(_,ie,ne.tagID)}function callAdoptionAgency(K,_){for(let Z=0;Z<AA_OUTER_LOOP_ITER;Z++){const te=aaObtainFormattingElementEntry(K,_);if(!te)break;const ne=aaObtainFurthestBlock(K,te);if(!ne)break;K.activeFormattingElements.bookmark=te;const ie=aaInnerLoop(K,ne,te.element),oe=K.openElements.getCommonAncestor(te.element);K.treeAdapter.detachNode(ie),oe&&aaInsertLastNodeInCommonAncestor(K,oe,ie),aaReplaceFormattingElement(K,ne,te)}}function appendComment(K,_){K._appendCommentNode(_,K.openElements.currentTmplContentOrNode)}function appendCommentToRootHtmlElement(K,_){K._appendCommentNode(_,K.openElements.items[0])}function appendCommentToDocument(K,_){K._appendCommentNode(_,K.document)}function stopParsing(K,_){if(K.stopped=!0,_.location){const Z=K.fragmentContext?0:2;for(let te=K.openElements.stackTop;te>=Z;te--)K._setEndLocation(K.openElements.items[te],_);if(!K.fragmentContext&&K.openElements.stackTop>=0){const te=K.openElements.items[0],ne=K.treeAdapter.getNodeSourceCodeLocation(te);if(ne&&!ne.endTag&&(K._setEndLocation(te,_),K.openElements.stackTop>=1)){const ie=K.openElements.items[1],oe=K.treeAdapter.getNodeSourceCodeLocation(ie);oe&&!oe.endTag&&K._setEndLocation(ie,_)}}}}function doctypeInInitialMode(K,_){K._setDocumentType(_);const Z=_.forceQuirks?DOCUMENT_MODE.QUIRKS:getDocumentMode(_);isConforming(_)||K._err(_,ERR.nonConformingDoctype),K.treeAdapter.setDocumentMode(K.document,Z),K.insertionMode=InsertionMode.BEFORE_HTML}function tokenInInitialMode(K,_){K._err(_,ERR.missingDoctype,!0),K.treeAdapter.setDocumentMode(K.document,DOCUMENT_MODE.QUIRKS),K.insertionMode=InsertionMode.BEFORE_HTML,K._processToken(_)}function startTagBeforeHtml(K,_){_.tagID===TAG_ID.HTML?(K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.BEFORE_HEAD):tokenBeforeHtml(K,_)}function endTagBeforeHtml(K,_){const Z=_.tagID;(Z===TAG_ID.HTML||Z===TAG_ID.HEAD||Z===TAG_ID.BODY||Z===TAG_ID.BR)&&tokenBeforeHtml(K,_)}function tokenBeforeHtml(K,_){K._insertFakeRootElement(),K.insertionMode=InsertionMode.BEFORE_HEAD,K._processToken(_)}function startTagBeforeHead(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.HEAD:{K._insertElement(_,NS.HTML),K.headElement=K.openElements.current,K.insertionMode=InsertionMode.IN_HEAD;break}default:tokenBeforeHead(K,_)}}function endTagBeforeHead(K,_){const Z=_.tagID;Z===TAG_ID.HEAD||Z===TAG_ID.BODY||Z===TAG_ID.HTML||Z===TAG_ID.BR?tokenBeforeHead(K,_):K._err(_,ERR.endTagWithoutMatchingOpenElement)}function tokenBeforeHead(K,_){K._insertFakeElement(TAG_NAMES.HEAD,TAG_ID.HEAD),K.headElement=K.openElements.current,K.insertionMode=InsertionMode.IN_HEAD,K._processToken(_)}function startTagInHead(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.BASE:case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.LINK:case TAG_ID.META:{K._appendElement(_,NS.HTML),_.ackSelfClosing=!0;break}case TAG_ID.TITLE:{K._switchToTextParsing(_,TokenizerMode.RCDATA);break}case TAG_ID.NOSCRIPT:{K.options.scriptingEnabled?K._switchToTextParsing(_,TokenizerMode.RAWTEXT):(K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_HEAD_NO_SCRIPT);break}case TAG_ID.NOFRAMES:case TAG_ID.STYLE:{K._switchToTextParsing(_,TokenizerMode.RAWTEXT);break}case TAG_ID.SCRIPT:{K._switchToTextParsing(_,TokenizerMode.SCRIPT_DATA);break}case TAG_ID.TEMPLATE:{K._insertTemplate(_),K.activeFormattingElements.insertMarker(),K.framesetOk=!1,K.insertionMode=InsertionMode.IN_TEMPLATE,K.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE);break}case TAG_ID.HEAD:{K._err(_,ERR.misplacedStartTagForHeadElement);break}default:tokenInHead(K,_)}}function endTagInHead(K,_){switch(_.tagID){case TAG_ID.HEAD:{K.openElements.pop(),K.insertionMode=InsertionMode.AFTER_HEAD;break}case TAG_ID.BODY:case TAG_ID.BR:case TAG_ID.HTML:{tokenInHead(K,_);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(K,_);break}default:K._err(_,ERR.endTagWithoutMatchingOpenElement)}}function templateEndTagInHead(K,_){K.openElements.tmplCount>0?(K.openElements.generateImpliedEndTagsThoroughly(),K.openElements.currentTagId!==TAG_ID.TEMPLATE&&K._err(_,ERR.closingOfElementWithOpenChildElements),K.openElements.popUntilTagNamePopped(TAG_ID.TEMPLATE),K.activeFormattingElements.clearToLastMarker(),K.tmplInsertionModeStack.shift(),K._resetInsertionMode()):K._err(_,ERR.endTagWithoutMatchingOpenElement)}function tokenInHead(K,_){K.openElements.pop(),K.insertionMode=InsertionMode.AFTER_HEAD,K._processToken(_)}function startTagInHeadNoScript(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.HEAD:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.NOFRAMES:case TAG_ID.STYLE:{startTagInHead(K,_);break}case TAG_ID.NOSCRIPT:{K._err(_,ERR.nestedNoscriptInHead);break}default:tokenInHeadNoScript(K,_)}}function endTagInHeadNoScript(K,_){switch(_.tagID){case TAG_ID.NOSCRIPT:{K.openElements.pop(),K.insertionMode=InsertionMode.IN_HEAD;break}case TAG_ID.BR:{tokenInHeadNoScript(K,_);break}default:K._err(_,ERR.endTagWithoutMatchingOpenElement)}}function tokenInHeadNoScript(K,_){const Z=_.type===TokenType.EOF?ERR.openElementsLeftAfterEof:ERR.disallowedContentInNoscriptInHead;K._err(_,Z),K.openElements.pop(),K.insertionMode=InsertionMode.IN_HEAD,K._processToken(_)}function startTagAfterHead(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.BODY:{K._insertElement(_,NS.HTML),K.framesetOk=!1,K.insertionMode=InsertionMode.IN_BODY;break}case TAG_ID.FRAMESET:{K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_FRAMESET;break}case TAG_ID.BASE:case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.NOFRAMES:case TAG_ID.SCRIPT:case TAG_ID.STYLE:case TAG_ID.TEMPLATE:case TAG_ID.TITLE:{K._err(_,ERR.abandonedHeadElementChild),K.openElements.push(K.headElement,TAG_ID.HEAD),startTagInHead(K,_),K.openElements.remove(K.headElement);break}case TAG_ID.HEAD:{K._err(_,ERR.misplacedStartTagForHeadElement);break}default:tokenAfterHead(K,_)}}function endTagAfterHead(K,_){switch(_.tagID){case TAG_ID.BODY:case TAG_ID.HTML:case TAG_ID.BR:{tokenAfterHead(K,_);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(K,_);break}default:K._err(_,ERR.endTagWithoutMatchingOpenElement)}}function tokenAfterHead(K,_){K._insertFakeElement(TAG_NAMES.BODY,TAG_ID.BODY),K.insertionMode=InsertionMode.IN_BODY,modeInBody(K,_)}function modeInBody(K,_){switch(_.type){case TokenType.CHARACTER:{characterInBody(K,_);break}case TokenType.WHITESPACE_CHARACTER:{whitespaceCharacterInBody(K,_);break}case TokenType.COMMENT:{appendComment(K,_);break}case TokenType.START_TAG:{startTagInBody(K,_);break}case TokenType.END_TAG:{endTagInBody(K,_);break}case TokenType.EOF:{eofInBody(K,_);break}}}function whitespaceCharacterInBody(K,_){K._reconstructActiveFormattingElements(),K._insertCharacters(_)}function characterInBody(K,_){K._reconstructActiveFormattingElements(),K._insertCharacters(_),K.framesetOk=!1}function htmlStartTagInBody(K,_){K.openElements.tmplCount===0&&K.treeAdapter.adoptAttributes(K.openElements.items[0],_.attrs)}function bodyStartTagInBody(K,_){const Z=K.openElements.tryPeekProperlyNestedBodyElement();Z&&K.openElements.tmplCount===0&&(K.framesetOk=!1,K.treeAdapter.adoptAttributes(Z,_.attrs))}function framesetStartTagInBody(K,_){const Z=K.openElements.tryPeekProperlyNestedBodyElement();K.framesetOk&&Z&&(K.treeAdapter.detachNode(Z),K.openElements.popAllUpToHtmlElement(),K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_FRAMESET)}function addressStartTagInBody(K,_){K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._insertElement(_,NS.HTML)}function numberedHeaderStartTagInBody(K,_){K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K.openElements.currentTagId!==void 0&&NUMBERED_HEADERS.has(K.openElements.currentTagId)&&K.openElements.pop(),K._insertElement(_,NS.HTML)}function preStartTagInBody(K,_){K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._insertElement(_,NS.HTML),K.skipNextNewLine=!0,K.framesetOk=!1}function formStartTagInBody(K,_){const Z=K.openElements.tmplCount>0;(!K.formElement||Z)&&(K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._insertElement(_,NS.HTML),Z||(K.formElement=K.openElements.current))}function listItemStartTagInBody(K,_){K.framesetOk=!1;const Z=_.tagID;for(let te=K.openElements.stackTop;te>=0;te--){const ne=K.openElements.tagIDs[te];if(Z===TAG_ID.LI&&ne===TAG_ID.LI||(Z===TAG_ID.DD||Z===TAG_ID.DT)&&(ne===TAG_ID.DD||ne===TAG_ID.DT)){K.openElements.generateImpliedEndTagsWithExclusion(ne),K.openElements.popUntilTagNamePopped(ne);break}if(ne!==TAG_ID.ADDRESS&&ne!==TAG_ID.DIV&&ne!==TAG_ID.P&&K._isSpecialElement(K.openElements.items[te],ne))break}K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._insertElement(_,NS.HTML)}function plaintextStartTagInBody(K,_){K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._insertElement(_,NS.HTML),K.tokenizer.state=TokenizerMode.PLAINTEXT}function buttonStartTagInBody(K,_){K.openElements.hasInScope(TAG_ID.BUTTON)&&(K.openElements.generateImpliedEndTags(),K.openElements.popUntilTagNamePopped(TAG_ID.BUTTON)),K._reconstructActiveFormattingElements(),K._insertElement(_,NS.HTML),K.framesetOk=!1}function aStartTagInBody(K,_){const Z=K.activeFormattingElements.getElementEntryInScopeWithTagName(TAG_NAMES.A);Z&&(callAdoptionAgency(K,_),K.openElements.remove(Z.element),K.activeFormattingElements.removeEntry(Z)),K._reconstructActiveFormattingElements(),K._insertElement(_,NS.HTML),K.activeFormattingElements.pushElement(K.openElements.current,_)}function bStartTagInBody(K,_){K._reconstructActiveFormattingElements(),K._insertElement(_,NS.HTML),K.activeFormattingElements.pushElement(K.openElements.current,_)}function nobrStartTagInBody(K,_){K._reconstructActiveFormattingElements(),K.openElements.hasInScope(TAG_ID.NOBR)&&(callAdoptionAgency(K,_),K._reconstructActiveFormattingElements()),K._insertElement(_,NS.HTML),K.activeFormattingElements.pushElement(K.openElements.current,_)}function appletStartTagInBody(K,_){K._reconstructActiveFormattingElements(),K._insertElement(_,NS.HTML),K.activeFormattingElements.insertMarker(),K.framesetOk=!1}function tableStartTagInBody(K,_){K.treeAdapter.getDocumentMode(K.document)!==DOCUMENT_MODE.QUIRKS&&K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._insertElement(_,NS.HTML),K.framesetOk=!1,K.insertionMode=InsertionMode.IN_TABLE}function areaStartTagInBody(K,_){K._reconstructActiveFormattingElements(),K._appendElement(_,NS.HTML),K.framesetOk=!1,_.ackSelfClosing=!0}function isHiddenInput(K){const _=getTokenAttr(K,ATTRS.TYPE);return _!=null&&_.toLowerCase()===HIDDEN_INPUT_TYPE}function inputStartTagInBody(K,_){K._reconstructActiveFormattingElements(),K._appendElement(_,NS.HTML),isHiddenInput(_)||(K.framesetOk=!1),_.ackSelfClosing=!0}function paramStartTagInBody(K,_){K._appendElement(_,NS.HTML),_.ackSelfClosing=!0}function hrStartTagInBody(K,_){K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._appendElement(_,NS.HTML),K.framesetOk=!1,_.ackSelfClosing=!0}function imageStartTagInBody(K,_){_.tagName=TAG_NAMES.IMG,_.tagID=TAG_ID.IMG,areaStartTagInBody(K,_)}function textareaStartTagInBody(K,_){K._insertElement(_,NS.HTML),K.skipNextNewLine=!0,K.tokenizer.state=TokenizerMode.RCDATA,K.originalInsertionMode=K.insertionMode,K.framesetOk=!1,K.insertionMode=InsertionMode.TEXT}function xmpStartTagInBody(K,_){K.openElements.hasInButtonScope(TAG_ID.P)&&K._closePElement(),K._reconstructActiveFormattingElements(),K.framesetOk=!1,K._switchToTextParsing(_,TokenizerMode.RAWTEXT)}function iframeStartTagInBody(K,_){K.framesetOk=!1,K._switchToTextParsing(_,TokenizerMode.RAWTEXT)}function rawTextStartTagInBody(K,_){K._switchToTextParsing(_,TokenizerMode.RAWTEXT)}function selectStartTagInBody(K,_){K._reconstructActiveFormattingElements(),K._insertElement(_,NS.HTML),K.framesetOk=!1,K.insertionMode=K.insertionMode===InsertionMode.IN_TABLE||K.insertionMode===InsertionMode.IN_CAPTION||K.insertionMode===InsertionMode.IN_TABLE_BODY||K.insertionMode===InsertionMode.IN_ROW||K.insertionMode===InsertionMode.IN_CELL?InsertionMode.IN_SELECT_IN_TABLE:InsertionMode.IN_SELECT}function optgroupStartTagInBody(K,_){K.openElements.currentTagId===TAG_ID.OPTION&&K.openElements.pop(),K._reconstructActiveFormattingElements(),K._insertElement(_,NS.HTML)}function rbStartTagInBody(K,_){K.openElements.hasInScope(TAG_ID.RUBY)&&K.openElements.generateImpliedEndTags(),K._insertElement(_,NS.HTML)}function rtStartTagInBody(K,_){K.openElements.hasInScope(TAG_ID.RUBY)&&K.openElements.generateImpliedEndTagsWithExclusion(TAG_ID.RTC),K._insertElement(_,NS.HTML)}function mathStartTagInBody(K,_){K._reconstructActiveFormattingElements(),adjustTokenMathMLAttrs(_),adjustTokenXMLAttrs(_),_.selfClosing?K._appendElement(_,NS.MATHML):K._insertElement(_,NS.MATHML),_.ackSelfClosing=!0}function svgStartTagInBody(K,_){K._reconstructActiveFormattingElements(),adjustTokenSVGAttrs(_),adjustTokenXMLAttrs(_),_.selfClosing?K._appendElement(_,NS.SVG):K._insertElement(_,NS.SVG),_.ackSelfClosing=!0}function genericStartTagInBody(K,_){K._reconstructActiveFormattingElements(),K._insertElement(_,NS.HTML)}function startTagInBody(K,_){switch(_.tagID){case TAG_ID.I:case TAG_ID.S:case TAG_ID.B:case TAG_ID.U:case TAG_ID.EM:case TAG_ID.TT:case TAG_ID.BIG:case TAG_ID.CODE:case TAG_ID.FONT:case TAG_ID.SMALL:case TAG_ID.STRIKE:case TAG_ID.STRONG:{bStartTagInBody(K,_);break}case TAG_ID.A:{aStartTagInBody(K,_);break}case TAG_ID.H1:case TAG_ID.H2:case TAG_ID.H3:case TAG_ID.H4:case TAG_ID.H5:case TAG_ID.H6:{numberedHeaderStartTagInBody(K,_);break}case TAG_ID.P:case TAG_ID.DL:case TAG_ID.OL:case TAG_ID.UL:case TAG_ID.DIV:case TAG_ID.DIR:case TAG_ID.NAV:case TAG_ID.MAIN:case TAG_ID.MENU:case TAG_ID.ASIDE:case TAG_ID.CENTER:case TAG_ID.FIGURE:case TAG_ID.FOOTER:case TAG_ID.HEADER:case TAG_ID.HGROUP:case TAG_ID.DIALOG:case TAG_ID.DETAILS:case TAG_ID.ADDRESS:case TAG_ID.ARTICLE:case TAG_ID.SEARCH:case TAG_ID.SECTION:case TAG_ID.SUMMARY:case TAG_ID.FIELDSET:case TAG_ID.BLOCKQUOTE:case TAG_ID.FIGCAPTION:{addressStartTagInBody(K,_);break}case TAG_ID.LI:case TAG_ID.DD:case TAG_ID.DT:{listItemStartTagInBody(K,_);break}case TAG_ID.BR:case TAG_ID.IMG:case TAG_ID.WBR:case TAG_ID.AREA:case TAG_ID.EMBED:case TAG_ID.KEYGEN:{areaStartTagInBody(K,_);break}case TAG_ID.HR:{hrStartTagInBody(K,_);break}case TAG_ID.RB:case TAG_ID.RTC:{rbStartTagInBody(K,_);break}case TAG_ID.RT:case TAG_ID.RP:{rtStartTagInBody(K,_);break}case TAG_ID.PRE:case TAG_ID.LISTING:{preStartTagInBody(K,_);break}case TAG_ID.XMP:{xmpStartTagInBody(K,_);break}case TAG_ID.SVG:{svgStartTagInBody(K,_);break}case TAG_ID.HTML:{htmlStartTagInBody(K,_);break}case TAG_ID.BASE:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.STYLE:case TAG_ID.TITLE:case TAG_ID.SCRIPT:case TAG_ID.BGSOUND:case TAG_ID.BASEFONT:case TAG_ID.TEMPLATE:{startTagInHead(K,_);break}case TAG_ID.BODY:{bodyStartTagInBody(K,_);break}case TAG_ID.FORM:{formStartTagInBody(K,_);break}case TAG_ID.NOBR:{nobrStartTagInBody(K,_);break}case TAG_ID.MATH:{mathStartTagInBody(K,_);break}case TAG_ID.TABLE:{tableStartTagInBody(K,_);break}case TAG_ID.INPUT:{inputStartTagInBody(K,_);break}case TAG_ID.PARAM:case TAG_ID.TRACK:case TAG_ID.SOURCE:{paramStartTagInBody(K,_);break}case TAG_ID.IMAGE:{imageStartTagInBody(K,_);break}case TAG_ID.BUTTON:{buttonStartTagInBody(K,_);break}case TAG_ID.APPLET:case TAG_ID.OBJECT:case TAG_ID.MARQUEE:{appletStartTagInBody(K,_);break}case TAG_ID.IFRAME:{iframeStartTagInBody(K,_);break}case TAG_ID.SELECT:{selectStartTagInBody(K,_);break}case TAG_ID.OPTION:case TAG_ID.OPTGROUP:{optgroupStartTagInBody(K,_);break}case TAG_ID.NOEMBED:case TAG_ID.NOFRAMES:{rawTextStartTagInBody(K,_);break}case TAG_ID.FRAMESET:{framesetStartTagInBody(K,_);break}case TAG_ID.TEXTAREA:{textareaStartTagInBody(K,_);break}case TAG_ID.NOSCRIPT:{K.options.scriptingEnabled?rawTextStartTagInBody(K,_):genericStartTagInBody(K,_);break}case TAG_ID.PLAINTEXT:{plaintextStartTagInBody(K,_);break}case TAG_ID.COL:case TAG_ID.TH:case TAG_ID.TD:case TAG_ID.TR:case TAG_ID.HEAD:case TAG_ID.FRAME:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:case TAG_ID.CAPTION:case TAG_ID.COLGROUP:break;default:genericStartTagInBody(K,_)}}function bodyEndTagInBody(K,_){if(K.openElements.hasInScope(TAG_ID.BODY)&&(K.insertionMode=InsertionMode.AFTER_BODY,K.options.sourceCodeLocationInfo)){const Z=K.openElements.tryPeekProperlyNestedBodyElement();Z&&K._setEndLocation(Z,_)}}function htmlEndTagInBody(K,_){K.openElements.hasInScope(TAG_ID.BODY)&&(K.insertionMode=InsertionMode.AFTER_BODY,endTagAfterBody(K,_))}function addressEndTagInBody(K,_){const Z=_.tagID;K.openElements.hasInScope(Z)&&(K.openElements.generateImpliedEndTags(),K.openElements.popUntilTagNamePopped(Z))}function formEndTagInBody(K){const _=K.openElements.tmplCount>0,{formElement:Z}=K;_||(K.formElement=null),(Z||_)&&K.openElements.hasInScope(TAG_ID.FORM)&&(K.openElements.generateImpliedEndTags(),_?K.openElements.popUntilTagNamePopped(TAG_ID.FORM):Z&&K.openElements.remove(Z))}function pEndTagInBody(K){K.openElements.hasInButtonScope(TAG_ID.P)||K._insertFakeElement(TAG_NAMES.P,TAG_ID.P),K._closePElement()}function liEndTagInBody(K){K.openElements.hasInListItemScope(TAG_ID.LI)&&(K.openElements.generateImpliedEndTagsWithExclusion(TAG_ID.LI),K.openElements.popUntilTagNamePopped(TAG_ID.LI))}function ddEndTagInBody(K,_){const Z=_.tagID;K.openElements.hasInScope(Z)&&(K.openElements.generateImpliedEndTagsWithExclusion(Z),K.openElements.popUntilTagNamePopped(Z))}function numberedHeaderEndTagInBody(K){K.openElements.hasNumberedHeaderInScope()&&(K.openElements.generateImpliedEndTags(),K.openElements.popUntilNumberedHeaderPopped())}function appletEndTagInBody(K,_){const Z=_.tagID;K.openElements.hasInScope(Z)&&(K.openElements.generateImpliedEndTags(),K.openElements.popUntilTagNamePopped(Z),K.activeFormattingElements.clearToLastMarker())}function brEndTagInBody(K){K._reconstructActiveFormattingElements(),K._insertFakeElement(TAG_NAMES.BR,TAG_ID.BR),K.openElements.pop(),K.framesetOk=!1}function genericEndTagInBody(K,_){const Z=_.tagName,te=_.tagID;for(let ne=K.openElements.stackTop;ne>0;ne--){const ie=K.openElements.items[ne],oe=K.openElements.tagIDs[ne];if(te===oe&&(te!==TAG_ID.UNKNOWN||K.treeAdapter.getTagName(ie)===Z)){K.openElements.generateImpliedEndTagsWithExclusion(te),K.openElements.stackTop>=ne&&K.openElements.shortenToLength(ne);break}if(K._isSpecialElement(ie,oe))break}}function endTagInBody(K,_){switch(_.tagID){case TAG_ID.A:case TAG_ID.B:case TAG_ID.I:case TAG_ID.S:case TAG_ID.U:case TAG_ID.EM:case TAG_ID.TT:case TAG_ID.BIG:case TAG_ID.CODE:case TAG_ID.FONT:case TAG_ID.NOBR:case TAG_ID.SMALL:case TAG_ID.STRIKE:case TAG_ID.STRONG:{callAdoptionAgency(K,_);break}case TAG_ID.P:{pEndTagInBody(K);break}case TAG_ID.DL:case TAG_ID.UL:case TAG_ID.OL:case TAG_ID.DIR:case TAG_ID.DIV:case TAG_ID.NAV:case TAG_ID.PRE:case TAG_ID.MAIN:case TAG_ID.MENU:case TAG_ID.ASIDE:case TAG_ID.BUTTON:case TAG_ID.CENTER:case TAG_ID.FIGURE:case TAG_ID.FOOTER:case TAG_ID.HEADER:case TAG_ID.HGROUP:case TAG_ID.DIALOG:case TAG_ID.ADDRESS:case TAG_ID.ARTICLE:case TAG_ID.DETAILS:case TAG_ID.SEARCH:case TAG_ID.SECTION:case TAG_ID.SUMMARY:case TAG_ID.LISTING:case TAG_ID.FIELDSET:case TAG_ID.BLOCKQUOTE:case TAG_ID.FIGCAPTION:{addressEndTagInBody(K,_);break}case TAG_ID.LI:{liEndTagInBody(K);break}case TAG_ID.DD:case TAG_ID.DT:{ddEndTagInBody(K,_);break}case TAG_ID.H1:case TAG_ID.H2:case TAG_ID.H3:case TAG_ID.H4:case TAG_ID.H5:case TAG_ID.H6:{numberedHeaderEndTagInBody(K);break}case TAG_ID.BR:{brEndTagInBody(K);break}case TAG_ID.BODY:{bodyEndTagInBody(K,_);break}case TAG_ID.HTML:{htmlEndTagInBody(K,_);break}case TAG_ID.FORM:{formEndTagInBody(K);break}case TAG_ID.APPLET:case TAG_ID.OBJECT:case TAG_ID.MARQUEE:{appletEndTagInBody(K,_);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(K,_);break}default:genericEndTagInBody(K,_)}}function eofInBody(K,_){K.tmplInsertionModeStack.length>0?eofInTemplate(K,_):stopParsing(K,_)}function endTagInText(K,_){var Z;_.tagID===TAG_ID.SCRIPT&&((Z=K.scriptHandler)===null||Z===void 0||Z.call(K,K.openElements.current)),K.openElements.pop(),K.insertionMode=K.originalInsertionMode}function eofInText(K,_){K._err(_,ERR.eofInElementThatCanContainOnlyText),K.openElements.pop(),K.insertionMode=K.originalInsertionMode,K.onEof(_)}function characterInTable(K,_){if(K.openElements.currentTagId!==void 0&&TABLE_STRUCTURE_TAGS.has(K.openElements.currentTagId))switch(K.pendingCharacterTokens.length=0,K.hasNonWhitespacePendingCharacterToken=!1,K.originalInsertionMode=K.insertionMode,K.insertionMode=InsertionMode.IN_TABLE_TEXT,_.type){case TokenType.CHARACTER:{characterInTableText(K,_);break}case TokenType.WHITESPACE_CHARACTER:{whitespaceCharacterInTableText(K,_);break}}else tokenInTable(K,_)}function captionStartTagInTable(K,_){K.openElements.clearBackToTableContext(),K.activeFormattingElements.insertMarker(),K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_CAPTION}function colgroupStartTagInTable(K,_){K.openElements.clearBackToTableContext(),K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_COLUMN_GROUP}function colStartTagInTable(K,_){K.openElements.clearBackToTableContext(),K._insertFakeElement(TAG_NAMES.COLGROUP,TAG_ID.COLGROUP),K.insertionMode=InsertionMode.IN_COLUMN_GROUP,startTagInColumnGroup(K,_)}function tbodyStartTagInTable(K,_){K.openElements.clearBackToTableContext(),K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_TABLE_BODY}function tdStartTagInTable(K,_){K.openElements.clearBackToTableContext(),K._insertFakeElement(TAG_NAMES.TBODY,TAG_ID.TBODY),K.insertionMode=InsertionMode.IN_TABLE_BODY,startTagInTableBody(K,_)}function tableStartTagInTable(K,_){K.openElements.hasInTableScope(TAG_ID.TABLE)&&(K.openElements.popUntilTagNamePopped(TAG_ID.TABLE),K._resetInsertionMode(),K._processStartTag(_))}function inputStartTagInTable(K,_){isHiddenInput(_)?K._appendElement(_,NS.HTML):tokenInTable(K,_),_.ackSelfClosing=!0}function formStartTagInTable(K,_){!K.formElement&&K.openElements.tmplCount===0&&(K._insertElement(_,NS.HTML),K.formElement=K.openElements.current,K.openElements.pop())}function startTagInTable(K,_){switch(_.tagID){case TAG_ID.TD:case TAG_ID.TH:case TAG_ID.TR:{tdStartTagInTable(K,_);break}case TAG_ID.STYLE:case TAG_ID.SCRIPT:case TAG_ID.TEMPLATE:{startTagInHead(K,_);break}case TAG_ID.COL:{colStartTagInTable(K,_);break}case TAG_ID.FORM:{formStartTagInTable(K,_);break}case TAG_ID.TABLE:{tableStartTagInTable(K,_);break}case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{tbodyStartTagInTable(K,_);break}case TAG_ID.INPUT:{inputStartTagInTable(K,_);break}case TAG_ID.CAPTION:{captionStartTagInTable(K,_);break}case TAG_ID.COLGROUP:{colgroupStartTagInTable(K,_);break}default:tokenInTable(K,_)}}function endTagInTable(K,_){switch(_.tagID){case TAG_ID.TABLE:{K.openElements.hasInTableScope(TAG_ID.TABLE)&&(K.openElements.popUntilTagNamePopped(TAG_ID.TABLE),K._resetInsertionMode());break}case TAG_ID.TEMPLATE:{templateEndTagInHead(K,_);break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TBODY:case TAG_ID.TD:case TAG_ID.TFOOT:case TAG_ID.TH:case TAG_ID.THEAD:case TAG_ID.TR:break;default:tokenInTable(K,_)}}function tokenInTable(K,_){const Z=K.fosterParentingEnabled;K.fosterParentingEnabled=!0,modeInBody(K,_),K.fosterParentingEnabled=Z}function whitespaceCharacterInTableText(K,_){K.pendingCharacterTokens.push(_)}function characterInTableText(K,_){K.pendingCharacterTokens.push(_),K.hasNonWhitespacePendingCharacterToken=!0}function tokenInTableText(K,_){let Z=0;if(K.hasNonWhitespacePendingCharacterToken)for(;Z<K.pendingCharacterTokens.length;Z++)tokenInTable(K,K.pendingCharacterTokens[Z]);else for(;Z<K.pendingCharacterTokens.length;Z++)K._insertCharacters(K.pendingCharacterTokens[Z]);K.insertionMode=K.originalInsertionMode,K._processToken(_)}const TABLE_VOID_ELEMENTS=new Set([TAG_ID.CAPTION,TAG_ID.COL,TAG_ID.COLGROUP,TAG_ID.TBODY,TAG_ID.TD,TAG_ID.TFOOT,TAG_ID.TH,TAG_ID.THEAD,TAG_ID.TR]);function startTagInCaption(K,_){const Z=_.tagID;TABLE_VOID_ELEMENTS.has(Z)?K.openElements.hasInTableScope(TAG_ID.CAPTION)&&(K.openElements.generateImpliedEndTags(),K.openElements.popUntilTagNamePopped(TAG_ID.CAPTION),K.activeFormattingElements.clearToLastMarker(),K.insertionMode=InsertionMode.IN_TABLE,startTagInTable(K,_)):startTagInBody(K,_)}function endTagInCaption(K,_){const Z=_.tagID;switch(Z){case TAG_ID.CAPTION:case TAG_ID.TABLE:{K.openElements.hasInTableScope(TAG_ID.CAPTION)&&(K.openElements.generateImpliedEndTags(),K.openElements.popUntilTagNamePopped(TAG_ID.CAPTION),K.activeFormattingElements.clearToLastMarker(),K.insertionMode=InsertionMode.IN_TABLE,Z===TAG_ID.TABLE&&endTagInTable(K,_));break}case TAG_ID.BODY:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TBODY:case TAG_ID.TD:case TAG_ID.TFOOT:case TAG_ID.TH:case TAG_ID.THEAD:case TAG_ID.TR:break;default:endTagInBody(K,_)}}function startTagInColumnGroup(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.COL:{K._appendElement(_,NS.HTML),_.ackSelfClosing=!0;break}case TAG_ID.TEMPLATE:{startTagInHead(K,_);break}default:tokenInColumnGroup(K,_)}}function endTagInColumnGroup(K,_){switch(_.tagID){case TAG_ID.COLGROUP:{K.openElements.currentTagId===TAG_ID.COLGROUP&&(K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(K,_);break}case TAG_ID.COL:break;default:tokenInColumnGroup(K,_)}}function tokenInColumnGroup(K,_){K.openElements.currentTagId===TAG_ID.COLGROUP&&(K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE,K._processToken(_))}function startTagInTableBody(K,_){switch(_.tagID){case TAG_ID.TR:{K.openElements.clearBackToTableBodyContext(),K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_ROW;break}case TAG_ID.TH:case TAG_ID.TD:{K.openElements.clearBackToTableBodyContext(),K._insertFakeElement(TAG_NAMES.TR,TAG_ID.TR),K.insertionMode=InsertionMode.IN_ROW,startTagInRow(K,_);break}case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{K.openElements.hasTableBodyContextInTableScope()&&(K.openElements.clearBackToTableBodyContext(),K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE,startTagInTable(K,_));break}default:startTagInTable(K,_)}}function endTagInTableBody(K,_){const Z=_.tagID;switch(_.tagID){case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{K.openElements.hasInTableScope(Z)&&(K.openElements.clearBackToTableBodyContext(),K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE);break}case TAG_ID.TABLE:{K.openElements.hasTableBodyContextInTableScope()&&(K.openElements.clearBackToTableBodyContext(),K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE,endTagInTable(K,_));break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TD:case TAG_ID.TH:case TAG_ID.TR:break;default:endTagInTable(K,_)}}function startTagInRow(K,_){switch(_.tagID){case TAG_ID.TH:case TAG_ID.TD:{K.openElements.clearBackToTableRowContext(),K._insertElement(_,NS.HTML),K.insertionMode=InsertionMode.IN_CELL,K.activeFormattingElements.insertMarker();break}case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:case TAG_ID.TR:{K.openElements.hasInTableScope(TAG_ID.TR)&&(K.openElements.clearBackToTableRowContext(),K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE_BODY,startTagInTableBody(K,_));break}default:startTagInTable(K,_)}}function endTagInRow(K,_){switch(_.tagID){case TAG_ID.TR:{K.openElements.hasInTableScope(TAG_ID.TR)&&(K.openElements.clearBackToTableRowContext(),K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE_BODY);break}case TAG_ID.TABLE:{K.openElements.hasInTableScope(TAG_ID.TR)&&(K.openElements.clearBackToTableRowContext(),K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE_BODY,endTagInTableBody(K,_));break}case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{(K.openElements.hasInTableScope(_.tagID)||K.openElements.hasInTableScope(TAG_ID.TR))&&(K.openElements.clearBackToTableRowContext(),K.openElements.pop(),K.insertionMode=InsertionMode.IN_TABLE_BODY,endTagInTableBody(K,_));break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TD:case TAG_ID.TH:break;default:endTagInTable(K,_)}}function startTagInCell(K,_){const Z=_.tagID;TABLE_VOID_ELEMENTS.has(Z)?(K.openElements.hasInTableScope(TAG_ID.TD)||K.openElements.hasInTableScope(TAG_ID.TH))&&(K._closeTableCell(),startTagInRow(K,_)):startTagInBody(K,_)}function endTagInCell(K,_){const Z=_.tagID;switch(Z){case TAG_ID.TD:case TAG_ID.TH:{K.openElements.hasInTableScope(Z)&&(K.openElements.generateImpliedEndTags(),K.openElements.popUntilTagNamePopped(Z),K.activeFormattingElements.clearToLastMarker(),K.insertionMode=InsertionMode.IN_ROW);break}case TAG_ID.TABLE:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:case TAG_ID.TR:{K.openElements.hasInTableScope(Z)&&(K._closeTableCell(),endTagInRow(K,_));break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:break;default:endTagInBody(K,_)}}function startTagInSelect(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.OPTION:{K.openElements.currentTagId===TAG_ID.OPTION&&K.openElements.pop(),K._insertElement(_,NS.HTML);break}case TAG_ID.OPTGROUP:{K.openElements.currentTagId===TAG_ID.OPTION&&K.openElements.pop(),K.openElements.currentTagId===TAG_ID.OPTGROUP&&K.openElements.pop(),K._insertElement(_,NS.HTML);break}case TAG_ID.HR:{K.openElements.currentTagId===TAG_ID.OPTION&&K.openElements.pop(),K.openElements.currentTagId===TAG_ID.OPTGROUP&&K.openElements.pop(),K._appendElement(_,NS.HTML),_.ackSelfClosing=!0;break}case TAG_ID.INPUT:case TAG_ID.KEYGEN:case TAG_ID.TEXTAREA:case TAG_ID.SELECT:{K.openElements.hasInSelectScope(TAG_ID.SELECT)&&(K.openElements.popUntilTagNamePopped(TAG_ID.SELECT),K._resetInsertionMode(),_.tagID!==TAG_ID.SELECT&&K._processStartTag(_));break}case TAG_ID.SCRIPT:case TAG_ID.TEMPLATE:{startTagInHead(K,_);break}}}function endTagInSelect(K,_){switch(_.tagID){case TAG_ID.OPTGROUP:{K.openElements.stackTop>0&&K.openElements.currentTagId===TAG_ID.OPTION&&K.openElements.tagIDs[K.openElements.stackTop-1]===TAG_ID.OPTGROUP&&K.openElements.pop(),K.openElements.currentTagId===TAG_ID.OPTGROUP&&K.openElements.pop();break}case TAG_ID.OPTION:{K.openElements.currentTagId===TAG_ID.OPTION&&K.openElements.pop();break}case TAG_ID.SELECT:{K.openElements.hasInSelectScope(TAG_ID.SELECT)&&(K.openElements.popUntilTagNamePopped(TAG_ID.SELECT),K._resetInsertionMode());break}case TAG_ID.TEMPLATE:{templateEndTagInHead(K,_);break}}}function startTagInSelectInTable(K,_){const Z=_.tagID;Z===TAG_ID.CAPTION||Z===TAG_ID.TABLE||Z===TAG_ID.TBODY||Z===TAG_ID.TFOOT||Z===TAG_ID.THEAD||Z===TAG_ID.TR||Z===TAG_ID.TD||Z===TAG_ID.TH?(K.openElements.popUntilTagNamePopped(TAG_ID.SELECT),K._resetInsertionMode(),K._processStartTag(_)):startTagInSelect(K,_)}function endTagInSelectInTable(K,_){const Z=_.tagID;Z===TAG_ID.CAPTION||Z===TAG_ID.TABLE||Z===TAG_ID.TBODY||Z===TAG_ID.TFOOT||Z===TAG_ID.THEAD||Z===TAG_ID.TR||Z===TAG_ID.TD||Z===TAG_ID.TH?K.openElements.hasInTableScope(Z)&&(K.openElements.popUntilTagNamePopped(TAG_ID.SELECT),K._resetInsertionMode(),K.onEndTag(_)):endTagInSelect(K,_)}function startTagInTemplate(K,_){switch(_.tagID){case TAG_ID.BASE:case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.NOFRAMES:case TAG_ID.SCRIPT:case TAG_ID.STYLE:case TAG_ID.TEMPLATE:case TAG_ID.TITLE:{startTagInHead(K,_);break}case TAG_ID.CAPTION:case TAG_ID.COLGROUP:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{K.tmplInsertionModeStack[0]=InsertionMode.IN_TABLE,K.insertionMode=InsertionMode.IN_TABLE,startTagInTable(K,_);break}case TAG_ID.COL:{K.tmplInsertionModeStack[0]=InsertionMode.IN_COLUMN_GROUP,K.insertionMode=InsertionMode.IN_COLUMN_GROUP,startTagInColumnGroup(K,_);break}case TAG_ID.TR:{K.tmplInsertionModeStack[0]=InsertionMode.IN_TABLE_BODY,K.insertionMode=InsertionMode.IN_TABLE_BODY,startTagInTableBody(K,_);break}case TAG_ID.TD:case TAG_ID.TH:{K.tmplInsertionModeStack[0]=InsertionMode.IN_ROW,K.insertionMode=InsertionMode.IN_ROW,startTagInRow(K,_);break}default:K.tmplInsertionModeStack[0]=InsertionMode.IN_BODY,K.insertionMode=InsertionMode.IN_BODY,startTagInBody(K,_)}}function endTagInTemplate(K,_){_.tagID===TAG_ID.TEMPLATE&&templateEndTagInHead(K,_)}function eofInTemplate(K,_){K.openElements.tmplCount>0?(K.openElements.popUntilTagNamePopped(TAG_ID.TEMPLATE),K.activeFormattingElements.clearToLastMarker(),K.tmplInsertionModeStack.shift(),K._resetInsertionMode(),K.onEof(_)):stopParsing(K,_)}function startTagAfterBody(K,_){_.tagID===TAG_ID.HTML?startTagInBody(K,_):tokenAfterBody(K,_)}function endTagAfterBody(K,_){var Z;if(_.tagID===TAG_ID.HTML){if(K.fragmentContext||(K.insertionMode=InsertionMode.AFTER_AFTER_BODY),K.options.sourceCodeLocationInfo&&K.openElements.tagIDs[0]===TAG_ID.HTML){K._setEndLocation(K.openElements.items[0],_);const te=K.openElements.items[1];te&&!(!((Z=K.treeAdapter.getNodeSourceCodeLocation(te))===null||Z===void 0)&&Z.endTag)&&K._setEndLocation(te,_)}}else tokenAfterBody(K,_)}function tokenAfterBody(K,_){K.insertionMode=InsertionMode.IN_BODY,modeInBody(K,_)}function startTagInFrameset(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.FRAMESET:{K._insertElement(_,NS.HTML);break}case TAG_ID.FRAME:{K._appendElement(_,NS.HTML),_.ackSelfClosing=!0;break}case TAG_ID.NOFRAMES:{startTagInHead(K,_);break}}}function endTagInFrameset(K,_){_.tagID===TAG_ID.FRAMESET&&!K.openElements.isRootHtmlElementCurrent()&&(K.openElements.pop(),!K.fragmentContext&&K.openElements.currentTagId!==TAG_ID.FRAMESET&&(K.insertionMode=InsertionMode.AFTER_FRAMESET))}function startTagAfterFrameset(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.NOFRAMES:{startTagInHead(K,_);break}}}function endTagAfterFrameset(K,_){_.tagID===TAG_ID.HTML&&(K.insertionMode=InsertionMode.AFTER_AFTER_FRAMESET)}function startTagAfterAfterBody(K,_){_.tagID===TAG_ID.HTML?startTagInBody(K,_):tokenAfterAfterBody(K,_)}function tokenAfterAfterBody(K,_){K.insertionMode=InsertionMode.IN_BODY,modeInBody(K,_)}function startTagAfterAfterFrameset(K,_){switch(_.tagID){case TAG_ID.HTML:{startTagInBody(K,_);break}case TAG_ID.NOFRAMES:{startTagInHead(K,_);break}}}function nullCharacterInForeignContent(K,_){_.chars=REPLACEMENT_CHARACTER,K._insertCharacters(_)}function characterInForeignContent(K,_){K._insertCharacters(_),K.framesetOk=!1}function popUntilHtmlOrIntegrationPoint(K){for(;K.treeAdapter.getNamespaceURI(K.openElements.current)!==NS.HTML&&K.openElements.currentTagId!==void 0&&!K._isIntegrationPoint(K.openElements.currentTagId,K.openElements.current);)K.openElements.pop()}function startTagInForeignContent(K,_){if(causesExit(_))popUntilHtmlOrIntegrationPoint(K),K._startTagOutsideForeignContent(_);else{const Z=K._getAdjustedCurrentElement(),te=K.treeAdapter.getNamespaceURI(Z);te===NS.MATHML?adjustTokenMathMLAttrs(_):te===NS.SVG&&(adjustTokenSVGTagName(_),adjustTokenSVGAttrs(_)),adjustTokenXMLAttrs(_),_.selfClosing?K._appendElement(_,te):K._insertElement(_,te),_.ackSelfClosing=!0}}function endTagInForeignContent(K,_){if(_.tagID===TAG_ID.P||_.tagID===TAG_ID.BR){popUntilHtmlOrIntegrationPoint(K),K._endTagOutsideForeignContent(_);return}for(let Z=K.openElements.stackTop;Z>0;Z--){const te=K.openElements.items[Z];if(K.treeAdapter.getNamespaceURI(te)===NS.HTML){K._endTagOutsideForeignContent(_);break}const ne=K.treeAdapter.getTagName(te);if(ne.toLowerCase()===_.tagName){_.tagName=ne,K.openElements.shortenToLength(Z);break}}}TAG_NAMES.AREA,TAG_NAMES.BASE,TAG_NAMES.BASEFONT,TAG_NAMES.BGSOUND,TAG_NAMES.BR,TAG_NAMES.COL,TAG_NAMES.EMBED,TAG_NAMES.FRAME,TAG_NAMES.HR,TAG_NAMES.IMG,TAG_NAMES.INPUT,TAG_NAMES.KEYGEN,TAG_NAMES.LINK,TAG_NAMES.META,TAG_NAMES.PARAM,TAG_NAMES.SOURCE,TAG_NAMES.TRACK,TAG_NAMES.WBR;const pointEnd=point$1("end"),pointStart=point$1("start");function point$1(K){return _;function _(Z){const te=Z&&Z.position&&Z.position[K]||{};if(typeof te.line=="number"&&te.line>0&&typeof te.column=="number"&&te.column>0)return{line:te.line,column:te.column,offset:typeof te.offset=="number"&&te.offset>-1?te.offset:void 0}}}const convert$6=function(K){if(K==null)return ok$2;if(typeof K=="function")return castFactory(K);if(typeof K=="object")return Array.isArray(K)?anyFactory$2(K):propsFactory(K);if(typeof K=="string")return typeFactory$2(K);throw new Error("Expected function, string, or object as test")};function anyFactory$2(K){const _=[];let Z=-1;for(;++Z<K.length;)_[Z]=convert$6(K[Z]);return castFactory(te);function te(...ne){let ie=-1;for(;++ie<_.length;)if(_[ie].apply(this,ne))return!0;return!1}}function propsFactory(K){const _=K;return castFactory(Z);function Z(te){const ne=te;let ie;for(ie in K)if(ne[ie]!==_[ie])return!1;return!0}}function typeFactory$2(K){return castFactory(_);function _(Z){return Z&&Z.type===K}}function castFactory(K){return _;function _(Z,te,ne){return!!(looksLikeANode(Z)&&K.call(this,Z,typeof te=="number"?te:void 0,ne||void 0))}}function ok$2(){return!0}function looksLikeANode(K){return K!==null&&typeof K=="object"&&"type"in K}const empty$2=[],CONTINUE$6=!0,EXIT$6=!1,SKIP$6="skip";function visitParents$6(K,_,Z,te){let ne;typeof _=="function"&&typeof Z!="function"?(te=Z,Z=_):ne=_;const ie=convert$6(ne),oe=te?-1:1;se(K,void 0,[])();function se(ae,le,ce){const fe=ae&&typeof ae=="object"?ae:{};if(typeof fe.type=="string"){const pe=typeof fe.tagName=="string"?fe.tagName:typeof fe.name=="string"?fe.name:void 0;Object.defineProperty(de,"name",{value:"node ("+(ae.type+(pe?"<"+pe+">":""))+")"})}return de;function de(){let pe=empty$2,he,ge,me;if((!_||ie(ae,le,ce[ce.length-1]||void 0))&&(pe=toResult$3(Z(ae,ce)),pe[0]===EXIT$6))return pe;if("children"in ae&&ae.children){const Ae=ae;if(Ae.children&&pe[0]!==SKIP$6)for(ge=(te?Ae.children.length:-1)+oe,me=ce.concat(Ae);ge>-1&&ge<Ae.children.length;){const ye=Ae.children[ge];if(he=se(ye,ge,me)(),he[0]===EXIT$6)return he;ge=typeof he[1]=="number"?he[1]:ge+oe}}return pe}}}function toResult$3(K){return Array.isArray(K)?K:typeof K=="number"?[CONTINUE$6,K]:K==null?empty$2:[K]}function visit$6(K,_,Z,te){let ne,ie,oe;ie=_,oe=Z,ne=te,visitParents$6(K,ie,se,ne);function se(ae,le){const ce=le[le.length-1],fe=ce?ce.children.indexOf(ae):void 0;return oe(ae,fe,ce)}}const gfmTagfilterExpression=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,knownMdxNames=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),parseOptions={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function raw(K,_){const Z=documentMode(K),te=zwitch("type",{handlers:{root:root$2,element:element$1,text:text$6,comment,doctype,raw:handleRaw},unknown}),ne={parser:Z?new Parser(parseOptions):Parser.getFragmentParser(void 0,parseOptions),handle(se){te(se,ne)},stitches:!1,options:_||{}};te(K,ne),resetTokenizer(ne,pointStart());const ie=Z?ne.parser.document:ne.parser.getFragment(),oe=fromParse5(ie,{file:ne.options.file});return ne.stitches&&visit$6(oe,"comment",function(se,ae,le){const ce=se;if(ce.value.stitch&&le&&ae!==void 0){const fe=le.children;return fe[ae]=ce.value.stitch,ae}}),oe.type==="root"&&oe.children.length===1&&oe.children[0].type===K.type?oe.children[0]:oe}function all$e(K,_){let Z=-1;if(K)for(;++Z<K.length;)_.handle(K[Z])}function root$2(K,_){all$e(K.children,_)}function element$1(K,_){startTag(K,_),all$e(K.children,_),endTag(K,_)}function text$6(K,_){_.parser.tokenizer.state>4&&(_.parser.tokenizer.state=0);const Z={type:TokenType.CHARACTER,chars:K.value,location:createParse5Location(K)};resetTokenizer(_,pointStart(K)),_.parser.currentToken=Z,_.parser._processToken(_.parser.currentToken)}function doctype(K,_){const Z={type:TokenType.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:createParse5Location(K)};resetTokenizer(_,pointStart(K)),_.parser.currentToken=Z,_.parser._processToken(_.parser.currentToken)}function stitch(K,_){_.stitches=!0;const Z=cloneWithoutChildren(K);if("children"in K&&"children"in Z){const te=raw({type:"root",children:K.children},_.options);Z.children=te.children}comment({type:"comment",value:{stitch:Z}},_)}function comment(K,_){const Z=K.value,te={type:TokenType.COMMENT,data:Z,location:createParse5Location(K)};resetTokenizer(_,pointStart(K)),_.parser.currentToken=te,_.parser._processToken(_.parser.currentToken)}function handleRaw(K,_){if(_.parser.tokenizer.preprocessor.html="",_.parser.tokenizer.preprocessor.pos=-1,_.parser.tokenizer.preprocessor.lastGapPos=-2,_.parser.tokenizer.preprocessor.gapStack=[],_.parser.tokenizer.preprocessor.skipNextNewLine=!1,_.parser.tokenizer.preprocessor.lastChunkWritten=!1,_.parser.tokenizer.preprocessor.endOfChunkHit=!1,_.parser.tokenizer.preprocessor.isEol=!1,setPoint(_,pointStart(K)),_.parser.tokenizer.write(_.options.tagfilter?K.value.replace(gfmTagfilterExpression,"&lt;$1$2"):K.value,!1),_.parser.tokenizer._runParsingLoop(),_.parser.tokenizer.state===72||_.parser.tokenizer.state===78){_.parser.tokenizer.preprocessor.lastChunkWritten=!0;const Z=_.parser.tokenizer._consume();_.parser.tokenizer._callState(Z)}}function unknown(K,_){const Z=K;if(_.options.passThrough&&_.options.passThrough.includes(Z.type))stitch(Z,_);else{let te="";throw knownMdxNames.has(Z.type)&&(te=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+Z.type+"` node"+te)}}function resetTokenizer(K,_){setPoint(K,_);const Z=K.parser.tokenizer.currentCharacterToken;Z&&Z.location&&(Z.location.endLine=K.parser.tokenizer.preprocessor.line,Z.location.endCol=K.parser.tokenizer.preprocessor.col+1,Z.location.endOffset=K.parser.tokenizer.preprocessor.offset+1,K.parser.currentToken=Z,K.parser._processToken(K.parser.currentToken)),K.parser.tokenizer.paused=!1,K.parser.tokenizer.inLoop=!1,K.parser.tokenizer.active=!1,K.parser.tokenizer.returnState=TokenizerMode.DATA,K.parser.tokenizer.charRefCode=-1,K.parser.tokenizer.consumedAfterSnapshot=-1,K.parser.tokenizer.currentLocation=null,K.parser.tokenizer.currentCharacterToken=null,K.parser.tokenizer.currentToken=null,K.parser.tokenizer.currentAttr={name:"",value:""}}function setPoint(K,_){if(_&&_.offset!==void 0){const Z={startLine:_.line,startCol:_.column,startOffset:_.offset,endLine:-1,endCol:-1,endOffset:-1};K.parser.tokenizer.preprocessor.lineStartPos=-_.column+1,K.parser.tokenizer.preprocessor.droppedBufferSize=_.offset,K.parser.tokenizer.preprocessor.line=_.line,K.parser.tokenizer.currentLocation=Z}}function startTag(K,_){const Z=K.tagName.toLowerCase();if(_.parser.tokenizer.state===TokenizerMode.PLAINTEXT)return;resetTokenizer(_,pointStart(K));const te=_.parser.openElements.current;let ne="namespaceURI"in te?te.namespaceURI:webNamespaces.html;ne===webNamespaces.html&&Z==="svg"&&(ne=webNamespaces.svg);const ie=toParse5({...K,children:[]},{space:ne===webNamespaces.svg?"svg":"html"}),oe={type:TokenType.START_TAG,tagName:Z,tagID:getTagID(Z),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in ie?ie.attrs:[],location:createParse5Location(K)};_.parser.currentToken=oe,_.parser._processToken(_.parser.currentToken),_.parser.tokenizer.lastStartTagName=Z}function endTag(K,_){const Z=K.tagName.toLowerCase();if(!_.parser.tokenizer.inForeignNode&&htmlVoidElements.includes(Z)||_.parser.tokenizer.state===TokenizerMode.PLAINTEXT)return;resetTokenizer(_,pointEnd(K));const te={type:TokenType.END_TAG,tagName:Z,tagID:getTagID(Z),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:createParse5Location(K)};_.parser.currentToken=te,_.parser._processToken(_.parser.currentToken),Z===_.parser.tokenizer.lastStartTagName&&(_.parser.tokenizer.state===TokenizerMode.RCDATA||_.parser.tokenizer.state===TokenizerMode.RAWTEXT||_.parser.tokenizer.state===TokenizerMode.SCRIPT_DATA)&&(_.parser.tokenizer.state=TokenizerMode.DATA)}function documentMode(K){const _=K.type==="root"?K.children[0]:K;return!!(_&&(_.type==="doctype"||_.type==="element"&&_.tagName.toLowerCase()==="html"))}function createParse5Location(K){const _=pointStart(K)||{line:void 0,column:void 0,offset:void 0},Z=pointEnd(K)||{line:void 0,column:void 0,offset:void 0};return{startLine:_.line,startCol:_.column,startOffset:_.offset,endLine:Z.line,endCol:Z.column,endOffset:Z.offset}}function cloneWithoutChildren(K){return"children"in K?structuredClone$1({...K,children:[]}):structuredClone$1(K)}function rehypeRaw(K){return function(_,Z){return raw(_,{...K,file:Z})}}var bail_1=bail$1;function bail$1(K){if(K)throw K}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var isBuffer=function K(_){return _!=null&&_.constructor!=null&&typeof _.constructor.isBuffer=="function"&&_.constructor.isBuffer(_)},hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,isArray=function K(_){return typeof Array.isArray=="function"?Array.isArray(_):toStr.call(_)==="[object Array]"},isPlainObject=function K(_){if(!_||toStr.call(_)!=="[object Object]")return!1;var Z=hasOwn.call(_,"constructor"),te=_.constructor&&_.constructor.prototype&&hasOwn.call(_.constructor.prototype,"isPrototypeOf");if(_.constructor&&!Z&&!te)return!1;var ne;for(ne in _);return typeof ne>"u"||hasOwn.call(_,ne)},setProperty=function K(_,Z){defineProperty&&Z.name==="__proto__"?defineProperty(_,Z.name,{enumerable:!0,configurable:!0,value:Z.newValue,writable:!0}):_[Z.name]=Z.newValue},getProperty=function K(_,Z){if(Z==="__proto__")if(hasOwn.call(_,Z)){if(gOPD)return gOPD(_,Z).value}else return;return _[Z]},extend$2=function K(){var _,Z,te,ne,ie,oe,se=arguments[0],ae=1,le=arguments.length,ce=!1;for(typeof se=="boolean"&&(ce=se,se=arguments[1]||{},ae=2),(se==null||typeof se!="object"&&typeof se!="function")&&(se={});ae<le;++ae)if(_=arguments[ae],_!=null)for(Z in _)te=getProperty(se,Z),ne=getProperty(_,Z),se!==ne&&(ce&&ne&&(isPlainObject(ne)||(ie=isArray(ne)))?(ie?(ie=!1,oe=te&&isArray(te)?te:[]):oe=te&&isPlainObject(te)?te:{},setProperty(se,{name:Z,newValue:K(ce,oe,ne)})):typeof ne<"u"&&setProperty(se,{name:Z,newValue:ne}));return se},isPlainObj=K=>{if(Object.prototype.toString.call(K)!=="[object Object]")return!1;const _=Object.getPrototypeOf(K);return _===null||_===Object.prototype},slice$2=[].slice,wrap_1$1=wrap$7;function wrap$7(K,_){var Z;return te;function te(){var oe=slice$2.call(arguments,0),se=K.length>oe.length,ae;se&&oe.push(ne);try{ae=K.apply(null,oe)}catch(le){if(se&&Z)throw le;return ne(le)}se||(ae&&typeof ae.then=="function"?ae.then(ie,ne):ae instanceof Error?ne(ae):ie(ae))}function ne(){Z||(Z=!0,_.apply(null,arguments))}function ie(oe){ne(null,oe)}}var wrap$6=wrap_1$1,trough_1=trough$1;trough$1.wrap=wrap$6;var slice$1=[].slice;function trough$1(){var K=[],_={};return _.run=Z,_.use=te,_;function Z(){var ne=-1,ie=slice$1.call(arguments,0,-1),oe=arguments[arguments.length-1];if(typeof oe!="function")throw new Error("Expected function as last argument, not "+oe);se.apply(null,[null].concat(ie));function se(ae){var le=K[++ne],ce=slice$1.call(arguments,0),fe=ce.slice(1),de=ie.length,pe=-1;if(ae){oe(ae);return}for(;++pe<de;)(fe[pe]===null||fe[pe]===void 0)&&(fe[pe]=ie[pe]);ie=fe,le?wrap$6(le,se).apply(null,ie):oe.apply(null,[null].concat(ie))}}function te(ne){if(typeof ne!="function")throw new Error("Expected `fn` to be a function, not "+ne);return K.push(ne),_}}var own$7={}.hasOwnProperty,unistUtilStringifyPosition=stringify$3;function stringify$3(K){return!K||typeof K!="object"?"":own$7.call(K,"position")||own$7.call(K,"type")?position$3(K.position):own$7.call(K,"start")||own$7.call(K,"end")?position$3(K):own$7.call(K,"line")||own$7.call(K,"column")?point(K):""}function point(K){return(!K||typeof K!="object")&&(K={}),index(K.line)+":"+index(K.column)}function position$3(K){return(!K||typeof K!="object")&&(K={}),point(K.start)+"-"+point(K.end)}function index(K){return K&&typeof K=="number"?K:1}var stringify$2=unistUtilStringifyPosition,vfileMessage=VMessage$1;function VMessagePrototype(){}VMessagePrototype.prototype=Error.prototype;VMessage$1.prototype=new VMessagePrototype;var proto$2=VMessage$1.prototype;proto$2.file="";proto$2.name="";proto$2.reason="";proto$2.message="";proto$2.stack="";proto$2.fatal=null;proto$2.column=null;proto$2.line=null;function VMessage$1(K,_,Z){var te,ne,ie;typeof _=="string"&&(Z=_,_=null),te=parseOrigin(Z),ne=stringify$2(_)||"1:1",ie={start:{line:null,column:null},end:{line:null,column:null}},_&&_.position&&(_=_.position),_&&(_.start?(ie=_,_=_.start):ie.start=_),K.stack&&(this.stack=K.stack,K=K.message),this.message=K,this.name=ne,this.reason=K,this.line=_?_.line:null,this.column=_?_.column:null,this.location=ie,this.source=te[0],this.ruleId=te[1]}function parseOrigin(K){var _=[null,null],Z;return typeof K=="string"&&(Z=K.indexOf(":"),Z===-1?_[1]=K:(_[0]=K.slice(0,Z),_[1]=K.slice(Z+1))),_}var minpath_browser={};minpath_browser.basename=basename;minpath_browser.dirname=dirname;minpath_browser.extname=extname;minpath_browser.join=join;minpath_browser.sep="/";function basename(K,_){var Z=0,te=-1,ne,ie,oe,se;if(_!==void 0&&typeof _!="string")throw new TypeError('"ext" argument must be a string');if(assertPath$1(K),ne=K.length,_===void 0||!_.length||_.length>K.length){for(;ne--;)if(K.charCodeAt(ne)===47){if(oe){Z=ne+1;break}}else te<0&&(oe=!0,te=ne+1);return te<0?"":K.slice(Z,te)}if(_===K)return"";for(ie=-1,se=_.length-1;ne--;)if(K.charCodeAt(ne)===47){if(oe){Z=ne+1;break}}else ie<0&&(oe=!0,ie=ne+1),se>-1&&(K.charCodeAt(ne)===_.charCodeAt(se--)?se<0&&(te=ne):(se=-1,te=ie));return Z===te?te=ie:te<0&&(te=K.length),K.slice(Z,te)}function dirname(K){var _,Z,te;if(assertPath$1(K),!K.length)return".";for(_=-1,te=K.length;--te;)if(K.charCodeAt(te)===47){if(Z){_=te;break}}else Z||(Z=!0);return _<0?K.charCodeAt(0)===47?"/":".":_===1&&K.charCodeAt(0)===47?"//":K.slice(0,_)}function extname(K){var _=-1,Z=0,te=-1,ne=0,ie,oe,se;for(assertPath$1(K),se=K.length;se--;){if(oe=K.charCodeAt(se),oe===47){if(ie){Z=se+1;break}continue}te<0&&(ie=!0,te=se+1),oe===46?_<0?_=se:ne!==1&&(ne=1):_>-1&&(ne=-1)}return _<0||te<0||ne===0||ne===1&&_===te-1&&_===Z+1?"":K.slice(_,te)}function join(){for(var K=-1,_;++K<arguments.length;)assertPath$1(arguments[K]),arguments[K]&&(_=_===void 0?arguments[K]:_+"/"+arguments[K]);return _===void 0?".":normalize$7(_)}function normalize$7(K){var _,Z;return assertPath$1(K),_=K.charCodeAt(0)===47,Z=normalizeString(K,!_),!Z.length&&!_&&(Z="."),Z.length&&K.charCodeAt(K.length-1)===47&&(Z+="/"),_?"/"+Z:Z}function normalizeString(K,_){for(var Z="",te=0,ne=-1,ie=0,oe=-1,se,ae;++oe<=K.length;){if(oe<K.length)se=K.charCodeAt(oe);else{if(se===47)break;se=47}if(se===47){if(!(ne===oe-1||ie===1))if(ne!==oe-1&&ie===2){if(Z.length<2||te!==2||Z.charCodeAt(Z.length-1)!==46||Z.charCodeAt(Z.length-2)!==46){if(Z.length>2){if(ae=Z.lastIndexOf("/"),ae!==Z.length-1){ae<0?(Z="",te=0):(Z=Z.slice(0,ae),te=Z.length-1-Z.lastIndexOf("/")),ne=oe,ie=0;continue}}else if(Z.length){Z="",te=0,ne=oe,ie=0;continue}}_&&(Z=Z.length?Z+"/..":"..",te=2)}else Z.length?Z+="/"+K.slice(ne+1,oe):Z=K.slice(ne+1,oe),te=oe-ne-1;ne=oe,ie=0}else se===46&&ie>-1?ie++:ie=-1}return Z}function assertPath$1(K){if(typeof K!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(K))}var minproc_browser={};minproc_browser.cwd=cwd;function cwd(){return"/"}var p=minpath_browser,proc=minproc_browser,buffer$1=isBuffer,core=VFile$1,own$6={}.hasOwnProperty,order=["history","path","basename","stem","extname","dirname"];VFile$1.prototype.toString=toString$2;Object.defineProperty(VFile$1.prototype,"path",{get:getPath,set:setPath});Object.defineProperty(VFile$1.prototype,"dirname",{get:getDirname,set:setDirname});Object.defineProperty(VFile$1.prototype,"basename",{get:getBasename,set:setBasename});Object.defineProperty(VFile$1.prototype,"extname",{get:getExtname,set:setExtname});Object.defineProperty(VFile$1.prototype,"stem",{get:getStem,set:setStem});function VFile$1(K){var _,Z;if(!K)K={};else if(typeof K=="string"||buffer$1(K))K={contents:K};else if("message"in K&&"messages"in K)return K;if(!(this instanceof VFile$1))return new VFile$1(K);for(this.data={},this.messages=[],this.history=[],this.cwd=proc.cwd(),Z=-1;++Z<order.length;)_=order[Z],own$6.call(K,_)&&(this[_]=K[_]);for(_ in K)order.indexOf(_)<0&&(this[_]=K[_])}function getPath(){return this.history[this.history.length-1]}function setPath(K){assertNonEmpty(K,"path"),this.path!==K&&this.history.push(K)}function getDirname(){return typeof this.path=="string"?p.dirname(this.path):void 0}function setDirname(K){assertPath(this.path,"dirname"),this.path=p.join(K||"",this.basename)}function getBasename(){return typeof this.path=="string"?p.basename(this.path):void 0}function setBasename(K){assertNonEmpty(K,"basename"),assertPart(K,"basename"),this.path=p.join(this.dirname||"",K)}function getExtname(){return typeof this.path=="string"?p.extname(this.path):void 0}function setExtname(K){if(assertPart(K,"extname"),assertPath(this.path,"extname"),K){if(K.charCodeAt(0)!==46)throw new Error("`extname` must start with `.`");if(K.indexOf(".",1)>-1)throw new Error("`extname` cannot contain multiple dots")}this.path=p.join(this.dirname,this.stem+(K||""))}function getStem(){return typeof this.path=="string"?p.basename(this.path,this.extname):void 0}function setStem(K){assertNonEmpty(K,"stem"),assertPart(K,"stem"),this.path=p.join(this.dirname||"",K+(this.extname||""))}function toString$2(K){return(this.contents||"").toString(K)}function assertPart(K,_){if(K&&K.indexOf(p.sep)>-1)throw new Error("`"+_+"` cannot be a path: did not expect `"+p.sep+"`")}function assertNonEmpty(K,_){if(!K)throw new Error("`"+_+"` cannot be empty")}function assertPath(K,_){if(!K)throw new Error("Setting `"+_+"` requires `path` to be set too")}var VMessage=vfileMessage,VFile=core,lib$1=VFile;VFile.prototype.message=message;VFile.prototype.info=info$1;VFile.prototype.fail=fail;function message(K,_,Z){var te=new VMessage(K,_,Z);return this.path&&(te.name=this.path+":"+te.name,te.file=this.path),te.fatal=!1,this.messages.push(te),te}function fail(){var K=this.message.apply(this,arguments);throw K.fatal=!0,K}function info$1(){var K=this.message.apply(this,arguments);return K.fatal=null,K}var vfile$1=lib$1,bail=bail_1,buffer=isBuffer,extend$1=extend$2,plain=isPlainObj,trough=trough_1,vfile=vfile$1,unified_1=unified().freeze(),slice=[].slice,own$5={}.hasOwnProperty,pipeline=trough().use(pipelineParse).use(pipelineRun).use(pipelineStringify);function pipelineParse(K,_){_.tree=K.parse(_.file)}function pipelineRun(K,_,Z){K.run(_.tree,_.file,te);function te(ne,ie,oe){ne?Z(ne):(_.tree=ie,_.file=oe,Z())}}function pipelineStringify(K,_){var Z=K.stringify(_.tree,_.file);Z==null||(typeof Z=="string"||buffer(Z)?("value"in _.file&&(_.file.value=Z),_.file.contents=Z):_.file.result=Z)}function unified(){var K=[],_=trough(),Z={},te=-1,ne;return ie.data=se,ie.freeze=oe,ie.attachers=K,ie.use=ae,ie.parse=ce,ie.stringify=pe,ie.run=fe,ie.runSync=de,ie.process=he,ie.processSync=ge,ie;function ie(){for(var me=unified(),Ae=-1;++Ae<K.length;)me.use.apply(null,K[Ae]);return me.data(extend$1(!0,{},Z)),me}function oe(){var me,Ae;if(ne)return ie;for(;++te<K.length;)me=K[te],me[1]!==!1&&(me[1]===!0&&(me[1]=void 0),Ae=me[0].apply(ie,me.slice(1)),typeof Ae=="function"&&_.use(Ae));return ne=!0,te=1/0,ie}function se(me,Ae){return typeof me=="string"?arguments.length===2?(assertUnfrozen("data",ne),Z[me]=Ae,ie):own$5.call(Z,me)&&Z[me]||null:me?(assertUnfrozen("data",ne),Z=me,ie):Z}function ae(me){var Ae;if(assertUnfrozen("use",ne),me!=null)if(typeof me=="function")Te.apply(null,arguments);else if(typeof me=="object")"length"in me?_e(me):ye(me);else throw new Error("Expected usable value, not `"+me+"`");return Ae&&(Z.settings=extend$1(Z.settings||{},Ae)),ie;function ye(be){_e(be.plugins),be.settings&&(Ae=extend$1(Ae||{},be.settings))}function ve(be){if(typeof be=="function")Te(be);else if(typeof be=="object")"length"in be?Te.apply(null,be):ye(be);else throw new Error("Expected usable value, not `"+be+"`")}function _e(be){var Re=-1;if(be!=null)if(typeof be=="object"&&"length"in be)for(;++Re<be.length;)ve(be[Re]);else throw new Error("Expected a list of plugins, not `"+be+"`")}function Te(be,Re){var we=le(be);we?(plain(we[1])&&plain(Re)&&(Re=extend$1(!0,we[1],Re)),we[1]=Re):K.push(slice.call(arguments))}}function le(me){for(var Ae=-1;++Ae<K.length;)if(K[Ae][0]===me)return K[Ae]}function ce(me){var Ae=vfile(me),ye;return oe(),ye=ie.Parser,assertParser("parse",ye),newable(ye,"parse")?new ye(String(Ae),Ae).parse():ye(String(Ae),Ae)}function fe(me,Ae,ye){if(assertNode(me),oe(),!ye&&typeof Ae=="function"&&(ye=Ae,Ae=null),!ye)return new Promise(ve);ve(null,ye);function ve(_e,Te){_.run(me,vfile(Ae),be);function be(Re,we,Pe){we=we||me,Re?Te(Re):_e?_e(we):ye(null,we,Pe)}}}function de(me,Ae){var ye,ve;return fe(me,Ae,_e),assertDone("runSync","run",ve),ye;function _e(Te,be){ve=!0,ye=be,bail(Te)}}function pe(me,Ae){var ye=vfile(Ae),ve;return oe(),ve=ie.Compiler,assertCompiler("stringify",ve),assertNode(me),newable(ve,"compile")?new ve(me,ye).compile():ve(me,ye)}function he(me,Ae){if(oe(),assertParser("process",ie.Parser),assertCompiler("process",ie.Compiler),!Ae)return new Promise(ye);ye(null,Ae);function ye(ve,_e){var Te=vfile(me);pipeline.run(ie,{file:Te},be);function be(Re){Re?_e(Re):ve?ve(Te):Ae(null,Te)}}}function ge(me){var Ae,ye;return oe(),assertParser("processSync",ie.Parser),assertCompiler("processSync",ie.Compiler),Ae=vfile(me),he(Ae,ve),assertDone("processSync","process",ye),Ae;function ve(_e){ye=!0,bail(_e)}}}function newable(K,_){return typeof K=="function"&&K.prototype&&(keys(K.prototype)||_ in K.prototype)}function keys(K){var _;for(_ in K)return!0;return!1}function assertParser(K,_){if(typeof _!="function")throw new Error("Cannot `"+K+"` without `Parser`")}function assertCompiler(K,_){if(typeof _!="function")throw new Error("Cannot `"+K+"` without `Compiler`")}function assertUnfrozen(K,_){if(_)throw new Error("Cannot invoke `"+K+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function assertNode(K){if(!K||typeof K.type!="string")throw new Error("Expected node, got `"+K+"`")}function assertDone(K,_,Z){if(!Z)throw new Error("`"+K+"` finished async. Use `"+_+"` instead")}const unified$1=getDefaultExportFromCjs(unified_1);var mdastUtilToString=toString$1;function toString$1(K){return K&&(K.value||K.alt||K.title||"children"in K&&all$d(K.children)||"length"in K&&all$d(K))||""}function all$d(K){for(var _=[],Z=-1;++Z<K.length;)_[Z]=toString$1(K[Z]);return _.join("")}var assign$5=Object.assign,assign_1=assign$5,own$4={}.hasOwnProperty,hasOwnProperty$3=own$4;function normalizeIdentifier$3(K){return K.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}var normalizeIdentifier_1=normalizeIdentifier$3,fromCharCode$4=String.fromCharCode,fromCharCode_1=fromCharCode$4,fromCharCode$3=fromCharCode_1;function safeFromInt$1(K,_){var Z=parseInt(K,_);return Z<9||Z===11||Z>13&&Z<32||Z>126&&Z<160||Z>55295&&Z<57344||Z>64975&&Z<65008||(Z&65535)===65535||(Z&65535)===65534||Z>1114111?"�":fromCharCode$3(Z)}var safeFromInt_1=safeFromInt$1,content$3={};function markdownLineEnding$j(K){return K<-2}var markdownLineEnding_1=markdownLineEnding$j;function markdownSpace$9(K){return K===-2||K===-1||K===32}var markdownSpace_1=markdownSpace$9,markdownSpace$8=markdownSpace_1;function spaceFactory(K,_,Z,te){var ne=te?te-1:1/0,ie=0;return oe;function oe(ae){return markdownSpace$8(ae)?(K.enter(Z),se(ae)):_(ae)}function se(ae){return markdownSpace$8(ae)&&ie++<ne?(K.consume(ae),se):(K.exit(Z),_(ae))}}var factorySpace$h=spaceFactory;Object.defineProperty(content$3,"__esModule",{value:!0});var markdownLineEnding$i=markdownLineEnding_1,factorySpace$g=factorySpace$h,tokenize$2=initializeContent;function initializeContent(K){var _=K.attempt(this.parser.constructs.contentInitial,te,ne),Z;return _;function te(se){if(se===null){K.consume(se);return}return K.enter("lineEnding"),K.consume(se),K.exit("lineEnding"),factorySpace$g(K,_,"linePrefix")}function ne(se){return K.enter("paragraph"),ie(se)}function ie(se){var ae=K.enter("chunkText",{contentType:"text",previous:Z});return Z&&(Z.next=ae),Z=ae,oe(se)}function oe(se){if(se===null){K.exit("chunkText"),K.exit("paragraph"),K.consume(se);return}return markdownLineEnding$i(se)?(K.consume(se),K.exit("chunkText"),ie):(K.consume(se),oe)}}content$3.tokenize=tokenize$2;var document$3={},markdownLineEnding$h=markdownLineEnding_1,factorySpace$f=factorySpace$h,partialBlankLine$4={tokenize:tokenizePartialBlankLine,partial:!0};function tokenizePartialBlankLine(K,_,Z){return factorySpace$f(K,te,"linePrefix");function te(ne){return ne===null||markdownLineEnding$h(ne)?_(ne):Z(ne)}}var partialBlankLine_1=partialBlankLine$4;Object.defineProperty(document$3,"__esModule",{value:!0});var markdownLineEnding$g=markdownLineEnding_1,factorySpace$e=factorySpace$h,partialBlankLine$3=partialBlankLine_1,tokenize$1=initializeDocument,containerConstruct={tokenize:tokenizeContainer},lazyFlowConstruct={tokenize:tokenizeLazyFlow};function initializeDocument(K){var _=this,Z=[],te=0,ne={tokenize:Ae,partial:!0},ie,oe,se;return ae;function ae(ye){return te<Z.length?(_.containerState=Z[te][1],K.attempt(Z[te][0].continuation,le,ce)(ye)):ce(ye)}function le(ye){return te++,ae(ye)}function ce(ye){return ie&&ie.flowContinue?de(ye):(_.interrupt=oe&&oe.currentConstruct&&oe.currentConstruct.interruptible,_.containerState={},K.attempt(containerConstruct,fe,de)(ye))}function fe(ye){return Z.push([_.currentConstruct,_.containerState]),_.containerState=void 0,ce(ye)}function de(ye){if(ye===null){me(0,!0),K.consume(ye);return}return oe=oe||_.parser.flow(_.now()),K.enter("chunkFlow",{contentType:"flow",previous:se,_tokenizer:oe}),pe(ye)}function pe(ye){return ye===null?(ge(K.exit("chunkFlow")),de(ye)):markdownLineEnding$g(ye)?(K.consume(ye),ge(K.exit("chunkFlow")),K.check(ne,he)):(K.consume(ye),pe)}function he(ye){return me(ie.continued,ie&&ie.flowEnd),te=0,ae(ye)}function ge(ye){se&&(se.next=ye),se=ye,oe.lazy=ie&&ie.lazy,oe.defineSkip(ye.start),oe.write(_.sliceStream(ye))}function me(ye,ve){var _e=Z.length;for(oe&&ve&&(oe.write([null]),se=oe=void 0);_e-- >ye;)_.containerState=Z[_e][1],Z[_e][0].exit.call(_,K);Z.length=ye}function Ae(ye,ve){var _e=0;return ie={},Te;function Te($e){return _e<Z.length?(_.containerState=Z[_e][1],ye.attempt(Z[_e][0].continuation,be,Re)($e)):oe.currentConstruct&&oe.currentConstruct.concrete?(ie.flowContinue=!0,Ie($e)):(_.interrupt=oe.currentConstruct&&oe.currentConstruct.interruptible,_.containerState={},ye.attempt(containerConstruct,Pe,Ie)($e))}function be($e){return _e++,_.containerState._closeFlow?Pe($e):Te($e)}function Re($e){return oe.currentConstruct&&oe.currentConstruct.lazy?(_.containerState={},ye.attempt(containerConstruct,Pe,ye.attempt(lazyFlowConstruct,Pe,ye.check(partialBlankLine$3,Pe,we)))($e)):Pe($e)}function we($e){return _e=Z.length,ie.lazy=!0,ie.flowContinue=!0,Ie($e)}function Pe($e){return ie.flowEnd=!0,Ie($e)}function Ie($e){return ie.continued=_e,_.interrupt=_.containerState=void 0,ve($e)}}}function tokenizeContainer(K,_,Z){return factorySpace$e(K,K.attempt(this.parser.constructs.document,_,Z),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function tokenizeLazyFlow(K,_,Z){return factorySpace$e(K,K.lazy(this.parser.constructs.flow,_,Z),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}document$3.tokenize=tokenize$1;var flow$2={};function sizeChunks$2(K){for(var _=-1,Z=0;++_<K.length;)Z+=typeof K[_]=="string"?K[_].length:1;return Z}var sizeChunks_1=sizeChunks$2,sizeChunks$1=sizeChunks_1;function prefixSize$4(K,_){var Z=K[K.length-1];return!Z||Z[1].type!==_?0:sizeChunks$1(Z[2].sliceStream(Z[1]))}var prefixSize_1=prefixSize$4,splice$1=[].splice,splice_1=splice$1,splice=splice_1;function chunkedSplice$8(K,_,Z,te){var ne=K.length,ie=0,oe;if(_<0?_=-_>ne?0:ne+_:_=_>ne?ne:_,Z=Z>0?Z:0,te.length<1e4)oe=Array.from(te),oe.unshift(_,Z),splice.apply(K,oe);else for(Z&&splice.apply(K,[_,Z]);ie<te.length;)oe=te.slice(ie,ie+1e4),oe.unshift(_,0),splice.apply(K,oe),ie+=1e4,_+=1e4}var chunkedSplice_1=chunkedSplice$8,assign$4=assign_1;function shallow$6(K){return assign$4({},K)}var shallow_1=shallow$6,assign$3=assign_1,chunkedSplice$7=chunkedSplice_1,shallow$5=shallow_1;function subtokenize$2(K){for(var _={},Z=-1,te,ne,ie,oe,se,ae,le;++Z<K.length;){for(;Z in _;)Z=_[Z];if(te=K[Z],Z&&te[1].type==="chunkFlow"&&K[Z-1][1].type==="listItemPrefix"&&(ae=te[1]._tokenizer.events,ie=0,ie<ae.length&&ae[ie][1].type==="lineEndingBlank"&&(ie+=2),ie<ae.length&&ae[ie][1].type==="content"))for(;++ie<ae.length&&ae[ie][1].type!=="content";)ae[ie][1].type==="chunkText"&&(ae[ie][1].isInFirstContentOfListItem=!0,ie++);if(te[0]==="enter")te[1].contentType&&(assign$3(_,subcontent(K,Z)),Z=_[Z],le=!0);else if(te[1]._container||te[1]._movePreviousLineEndings){for(ie=Z,ne=void 0;ie--&&(oe=K[ie],oe[1].type==="lineEnding"||oe[1].type==="lineEndingBlank");)oe[0]==="enter"&&(ne&&(K[ne][1].type="lineEndingBlank"),oe[1].type="lineEnding",ne=ie);ne&&(te[1].end=shallow$5(K[ne][1].start),se=K.slice(ne,Z),se.unshift(te),chunkedSplice$7(K,ne,Z-ne+1,se))}}return!le}function subcontent(K,_){for(var Z=K[_][1],te=K[_][2],ne=_-1,ie=[],oe=Z._tokenizer||te.parser[Z.contentType](Z.start),se=oe.events,ae=[],le={},ce,fe,de,pe,he,ge;Z;){for(;K[++ne][1]!==Z;);ie.push(ne),Z._tokenizer||(ce=te.sliceStream(Z),Z.next||ce.push(null),fe&&oe.defineSkip(Z.start),Z.isInFirstContentOfListItem&&(oe._gfmTasklistFirstContentOfListItem=!0),oe.write(ce),Z.isInFirstContentOfListItem&&(oe._gfmTasklistFirstContentOfListItem=void 0)),fe=Z,Z=Z.next}for(Z=fe,de=se.length;de--;)se[de][0]==="enter"?pe=!0:pe&&se[de][1].type===se[de-1][1].type&&se[de][1].start.line!==se[de][1].end.line&&(me(se.slice(de+1,he)),Z._tokenizer=Z.next=void 0,Z=Z.previous,he=de+1);for(oe.events=Z._tokenizer=Z.next=void 0,me(se.slice(0,he)),de=-1,ge=0;++de<ae.length;)le[ge+ae[de][0]]=ge+ae[de][1],ge+=ae[de][1]-ae[de][0]-1;return le;function me(Ae){var ye=ie.pop();ae.unshift([ye,ye+Ae.length-1]),chunkedSplice$7(K,ye,2,Ae)}}var subtokenize_1=subtokenize$2,markdownLineEnding$f=markdownLineEnding_1,prefixSize$3=prefixSize_1,subtokenize$1=subtokenize_1,factorySpace$d=factorySpace$h,content$2={tokenize:tokenizeContent,resolve:resolveContent,interruptible:!0,lazy:!0},continuationConstruct={tokenize:tokenizeContinuation,partial:!0};function resolveContent(K){return subtokenize$1(K),K}function tokenizeContent(K,_){var Z;return te;function te(se){return K.enter("content"),Z=K.enter("chunkContent",{contentType:"content"}),ne(se)}function ne(se){return se===null?ie(se):markdownLineEnding$f(se)?K.check(continuationConstruct,oe,ie)(se):(K.consume(se),ne)}function ie(se){return K.exit("chunkContent"),K.exit("content"),_(se)}function oe(se){return K.consume(se),K.exit("chunkContent"),Z=Z.next=K.enter("chunkContent",{contentType:"content",previous:Z}),ne}}function tokenizeContinuation(K,_,Z){var te=this;return ne;function ne(oe){return K.enter("lineEnding"),K.consume(oe),K.exit("lineEnding"),factorySpace$d(K,ie,"linePrefix")}function ie(oe){return oe===null||markdownLineEnding$f(oe)?Z(oe):te.parser.constructs.disable.null.indexOf("codeIndented")>-1||prefixSize$3(te.events,"linePrefix")<4?K.interrupt(te.parser.constructs.flow,Z,_)(oe):_(oe)}}var content_1=content$2;Object.defineProperty(flow$2,"__esModule",{value:!0});var content$1=content_1,factorySpace$c=factorySpace$h,partialBlankLine$2=partialBlankLine_1,tokenize=initializeFlow;function initializeFlow(K){var _=this,Z=K.attempt(partialBlankLine$2,te,K.attempt(this.parser.constructs.flowInitial,ne,factorySpace$c(K,K.attempt(this.parser.constructs.flow,ne,K.attempt(content$1,ne)),"linePrefix")));return Z;function te(ie){if(ie===null){K.consume(ie);return}return K.enter("lineEndingBlank"),K.consume(ie),K.exit("lineEndingBlank"),_.currentConstruct=void 0,Z}function ne(ie){if(ie===null){K.consume(ie);return}return K.enter("lineEnding"),K.consume(ie),K.exit("lineEnding"),_.currentConstruct=void 0,Z}}flow$2.tokenize=tokenize;var text$5={};Object.defineProperty(text$5,"__esModule",{value:!0});var assign$2=assign_1,shallow$4=shallow_1,text$4=initializeFactory("text"),string$1=initializeFactory("string"),resolver={resolveAll:createResolver()};function initializeFactory(K){return{tokenize:_,resolveAll:createResolver(K==="text"?resolveAllLineSuffixes:void 0)};function _(Z){var te=this,ne=this.parser.constructs[K],ie=Z.attempt(ne,oe,se);return oe;function oe(ce){return le(ce)?ie(ce):se(ce)}function se(ce){if(ce===null){Z.consume(ce);return}return Z.enter("data"),Z.consume(ce),ae}function ae(ce){return le(ce)?(Z.exit("data"),ie(ce)):(Z.consume(ce),ae)}function le(ce){var fe=ne[ce],de=-1;if(ce===null)return!0;if(fe){for(;++de<fe.length;)if(!fe[de].previous||fe[de].previous.call(te,te.previous))return!0}}}}function createResolver(K){return _;function _(Z,te){for(var ne=-1,ie;++ne<=Z.length;)ie===void 0?Z[ne]&&Z[ne][1].type==="data"&&(ie=ne,ne++):(!Z[ne]||Z[ne][1].type!=="data")&&(ne!==ie+2&&(Z[ie][1].end=Z[ne-1][1].end,Z.splice(ie+2,ne-ie-2),ne=ie+2),ie=void 0);return K?K(Z,te):Z}}function resolveAllLineSuffixes(K,_){for(var Z=-1,te,ne,ie,oe,se,ae,le,ce;++Z<=K.length;)if((Z===K.length||K[Z][1].type==="lineEnding")&&K[Z-1][1].type==="data"){for(ne=K[Z-1][1],te=_.sliceStream(ne),oe=te.length,se=-1,ae=0,le=void 0;oe--;)if(ie=te[oe],typeof ie=="string"){for(se=ie.length;ie.charCodeAt(se-1)===32;)ae++,se--;if(se)break;se=-1}else if(ie===-2)le=!0,ae++;else if(ie!==-1){oe++;break}ae&&(ce={type:Z===K.length||le||ae<2?"lineSuffix":"hardBreakTrailing",start:{line:ne.end.line,column:ne.end.column-ae,offset:ne.end.offset-ae,_index:ne.start._index+oe,_bufferIndex:oe?se:ne.start._bufferIndex+se},end:shallow$4(ne.end)},ne.end=shallow$4(ce.start),ne.start.offset===ne.end.offset?assign$2(ne,ce):(K.splice(Z,0,["enter",ce,_],["exit",ce,_]),Z+=2)),Z++}return K}text$5.resolver=resolver;text$5.string=string$1;text$5.text=text$4;function miniflat$3(K){return K==null?[]:"length"in K?K:[K]}var miniflat_1=miniflat$3,hasOwnProperty$2=hasOwnProperty$3,chunkedSplice$6=chunkedSplice_1,miniflat$2=miniflat_1;function combineExtensions$1(K){for(var _={},Z=-1;++Z<K.length;)extension$1(_,K[Z]);return _}function extension$1(K,_){var Z,te,ne,ie;for(Z in _){te=hasOwnProperty$2.call(K,Z)?K[Z]:K[Z]={},ne=_[Z];for(ie in ne)te[ie]=constructs$2(miniflat$2(ne[ie]),hasOwnProperty$2.call(te,ie)?te[ie]:[])}}function constructs$2(K,_){for(var Z=-1,te=[];++Z<K.length;)(K[Z].add==="after"?_:te).push(K[Z]);return chunkedSplice$6(_,0,0,te),_}var combineExtensions_1=combineExtensions$1,chunkedSplice$5=chunkedSplice_1;function chunkedPush$3(K,_){return K.length?(chunkedSplice$5(K,K.length,0,_),K):_}var chunkedPush_1=chunkedPush$3;function resolveAll$3(K,_,Z){for(var te=[],ne=-1,ie;++ne<K.length;)ie=K[ne].resolveAll,ie&&te.indexOf(ie)<0&&(_=ie(_,Z),te.push(ie));return _}var resolveAll_1=resolveAll$3,fromCharCode$2=fromCharCode_1;function serializeChunks$1(K){for(var _=-1,Z=[],te,ne,ie;++_<K.length;){if(te=K[_],typeof te=="string")ne=te;else if(te===-5)ne="\r";else if(te===-4)ne=`
`;else if(te===-3)ne=`\r
`;else if(te===-2)ne="	";else if(te===-1){if(ie)continue;ne=" "}else ne=fromCharCode$2(te);ie=te===-2,Z.push(ne)}return Z.join("")}var serializeChunks_1=serializeChunks$1;function sliceChunks$1(K,_){var Z=_.start._index,te=_.start._bufferIndex,ne=_.end._index,ie=_.end._bufferIndex,oe;return Z===ne?oe=[K[Z].slice(te,ie)]:(oe=K.slice(Z,ne),te>-1&&(oe[0]=oe[0].slice(te)),ie>0&&oe.push(K[ne].slice(0,ie))),oe}var sliceChunks_1=sliceChunks$1,assign$1=assign_1,markdownLineEnding$e=markdownLineEnding_1,chunkedPush$2=chunkedPush_1,chunkedSplice$4=chunkedSplice_1,miniflat$1=miniflat_1,resolveAll$2=resolveAll_1,serializeChunks=serializeChunks_1,shallow$3=shallow_1,sliceChunks=sliceChunks_1;function createTokenizer$1(K,_,Z){var te=Z?shallow$3(Z):{line:1,column:1,offset:0},ne={},ie=[],oe=[],se=[],ae={consume:ye,enter:ve,exit:_e,attempt:Re(Te),check:Re(be),interrupt:Re(be,{interrupt:!0}),lazy:Re(be,{lazy:!0})},le={previous:null,events:[],parser:K,sliceStream:pe,sliceSerialize:de,now:he,defineSkip:ge,write:fe},ce=_.tokenize.call(le,ae);return _.resolveAll&&ie.push(_),te._index=0,te._bufferIndex=-1,le;function fe($e){return oe=chunkedPush$2(oe,$e),me(),oe[oe.length-1]!==null?[]:(we(_,0),le.events=resolveAll$2(ie,le.events,le),le.events)}function de($e){return serializeChunks(pe($e))}function pe($e){return sliceChunks(oe,$e)}function he(){return shallow$3(te)}function ge($e){ne[$e.line]=$e.column,Ie()}function me(){for(var $e,Ue;te._index<oe.length;)if(Ue=oe[te._index],typeof Ue=="string")for($e=te._index,te._bufferIndex<0&&(te._bufferIndex=0);te._index===$e&&te._bufferIndex<Ue.length;)Ae(Ue.charCodeAt(te._bufferIndex));else Ae(Ue)}function Ae($e){ce=ce($e)}function ye($e){markdownLineEnding$e($e)?(te.line++,te.column=1,te.offset+=$e===-3?2:1,Ie()):$e!==-1&&(te.column++,te.offset++),te._bufferIndex<0?te._index++:(te._bufferIndex++,te._bufferIndex===oe[te._index].length&&(te._bufferIndex=-1,te._index++)),le.previous=$e}function ve($e,Ue){var ke=Ue||{};return ke.type=$e,ke.start=he(),le.events.push(["enter",ke,le]),se.push(ke),ke}function _e($e){var Ue=se.pop();return Ue.end=he(),le.events.push(["exit",Ue,le]),Ue}function Te($e,Ue){we($e,Ue.from)}function be($e,Ue){Ue.restore()}function Re($e,Ue){return ke;function ke(Ge,He,ze){var Ke,tt,Je,ot;return Ge.tokenize||"length"in Ge?ct(miniflat$1(Ge)):Fe;function Fe(Ze){return Ze in Ge||null in Ge?ct(Ge.null?miniflat$1(Ge[Ze]).concat(miniflat$1(Ge.null)):Ge[Ze])(Ze):ze(Ze)}function ct(Ze){return Ke=Ze,tt=0,ht(Ze[tt])}function ht(Ze){return it;function it(nt){return ot=Pe(),Je=Ze,Ze.partial||(le.currentConstruct=Ze),Ze.name&&le.parser.constructs.disable.null.indexOf(Ze.name)>-1?Qe():Ze.tokenize.call(Ue?assign$1({},le,Ue):le,ae,lt,Qe)(nt)}}function lt(Ze){return $e(Je,ot),He}function Qe(Ze){return ot.restore(),++tt<Ke.length?ht(Ke[tt]):ze}}}function we($e,Ue){$e.resolveAll&&ie.indexOf($e)<0&&ie.push($e),$e.resolve&&chunkedSplice$4(le.events,Ue,le.events.length-Ue,$e.resolve(le.events.slice(Ue),le)),$e.resolveTo&&(le.events=$e.resolveTo(le.events,le))}function Pe(){var $e=he(),Ue=le.previous,ke=le.currentConstruct,Ge=le.events.length,He=Array.from(se);return{restore:ze,from:Ge};function ze(){te=$e,le.previous=Ue,le.currentConstruct=ke,le.events.length=Ge,se=He,Ie()}}function Ie(){te.line in ne&&te.column<2&&(te.column=ne[te.line],te.offset+=ne[te.line]-1)}}var createTokenizer_1=createTokenizer$1,constructs$1={};function markdownLineEndingOrSpace$8(K){return K<0||K===32}var markdownLineEndingOrSpace_1=markdownLineEndingOrSpace$8,unicodePunctuation$2=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,unicodePunctuationRegex$1=unicodePunctuation$2,fromCharCode$1=fromCharCode_1;function regexCheck$8(K){return _;function _(Z){return K.test(fromCharCode$1(Z))}}var regexCheck_1=regexCheck$8,unicodePunctuationRegex=unicodePunctuationRegex$1,regexCheck$7=regexCheck_1,unicodePunctuation$1=regexCheck$7(unicodePunctuationRegex),unicodePunctuation_1=unicodePunctuation$1,regexCheck$6=regexCheck_1,unicodeWhitespace$1=regexCheck$6(/\s/),unicodeWhitespace_1=unicodeWhitespace$1,markdownLineEndingOrSpace$7=markdownLineEndingOrSpace_1,unicodePunctuation=unicodePunctuation_1,unicodeWhitespace=unicodeWhitespace_1;function classifyCharacter$1(K){if(K===null||markdownLineEndingOrSpace$7(K)||unicodeWhitespace(K))return 1;if(unicodePunctuation(K))return 2}var classifyCharacter_1=classifyCharacter$1;function movePoint$1(K,_){return K.column+=_,K.offset+=_,K._bufferIndex+=_,K}var movePoint_1=movePoint$1,chunkedPush$1=chunkedPush_1,chunkedSplice$3=chunkedSplice_1,classifyCharacter=classifyCharacter_1,movePoint=movePoint_1,resolveAll$1=resolveAll_1,shallow$2=shallow_1,attention$1={name:"attention",tokenize:tokenizeAttention,resolveAll:resolveAllAttention};function resolveAllAttention(K,_){for(var Z=-1,te,ne,ie,oe,se,ae,le,ce;++Z<K.length;)if(K[Z][0]==="enter"&&K[Z][1].type==="attentionSequence"&&K[Z][1]._close){for(te=Z;te--;)if(K[te][0]==="exit"&&K[te][1].type==="attentionSequence"&&K[te][1]._open&&_.sliceSerialize(K[te][1]).charCodeAt(0)===_.sliceSerialize(K[Z][1]).charCodeAt(0)){if((K[te][1]._close||K[Z][1]._open)&&(K[Z][1].end.offset-K[Z][1].start.offset)%3&&!((K[te][1].end.offset-K[te][1].start.offset+K[Z][1].end.offset-K[Z][1].start.offset)%3))continue;ae=K[te][1].end.offset-K[te][1].start.offset>1&&K[Z][1].end.offset-K[Z][1].start.offset>1?2:1,oe={type:ae>1?"strongSequence":"emphasisSequence",start:movePoint(shallow$2(K[te][1].end),-ae),end:shallow$2(K[te][1].end)},se={type:ae>1?"strongSequence":"emphasisSequence",start:shallow$2(K[Z][1].start),end:movePoint(shallow$2(K[Z][1].start),ae)},ie={type:ae>1?"strongText":"emphasisText",start:shallow$2(K[te][1].end),end:shallow$2(K[Z][1].start)},ne={type:ae>1?"strong":"emphasis",start:shallow$2(oe.start),end:shallow$2(se.end)},K[te][1].end=shallow$2(oe.start),K[Z][1].start=shallow$2(se.end),le=[],K[te][1].end.offset-K[te][1].start.offset&&(le=chunkedPush$1(le,[["enter",K[te][1],_],["exit",K[te][1],_]])),le=chunkedPush$1(le,[["enter",ne,_],["enter",oe,_],["exit",oe,_],["enter",ie,_]]),le=chunkedPush$1(le,resolveAll$1(_.parser.constructs.insideSpan.null,K.slice(te+1,Z),_)),le=chunkedPush$1(le,[["exit",ie,_],["enter",se,_],["exit",se,_],["exit",ne,_]]),K[Z][1].end.offset-K[Z][1].start.offset?(ce=2,le=chunkedPush$1(le,[["enter",K[Z][1],_],["exit",K[Z][1],_]])):ce=0,chunkedSplice$3(K,te-1,Z-te+3,le),Z=te+le.length-ce-2;break}}for(Z=-1;++Z<K.length;)K[Z][1].type==="attentionSequence"&&(K[Z][1].type="data");return K}function tokenizeAttention(K,_){var Z=classifyCharacter(this.previous),te;return ne;function ne(oe){return K.enter("attentionSequence"),te=oe,ie(oe)}function ie(oe){var se,ae,le,ce;return oe===te?(K.consume(oe),ie):(se=K.exit("attentionSequence"),ae=classifyCharacter(oe),le=!ae||ae===2&&Z,ce=!Z||Z===2&&ae,se._open=te===42?le:le&&(Z||!ce),se._close=te===42?ce:ce&&(ae||!le),_(oe))}}var attention_1=attention$1,regexCheck$5=regexCheck_1,asciiAlpha$3=regexCheck$5(/[A-Za-z]/),asciiAlpha_1=asciiAlpha$3,regexCheck$4=regexCheck_1,asciiAlphanumeric$4=regexCheck$4(/[\dA-Za-z]/),asciiAlphanumeric_1=asciiAlphanumeric$4,regexCheck$3=regexCheck_1,asciiAtext$1=regexCheck$3(/[#-'*+\--9=?A-Z^-~]/),asciiAtext_1=asciiAtext$1;function asciiControl$2(K){return K<32||K===127}var asciiControl_1=asciiControl$2,asciiAlpha$2=asciiAlpha_1,asciiAlphanumeric$3=asciiAlphanumeric_1,asciiAtext=asciiAtext_1,asciiControl$1=asciiControl_1,autolink$1={name:"autolink",tokenize:tokenizeAutolink};function tokenizeAutolink(K,_,Z){var te=1;return ne;function ne(he){return K.enter("autolink"),K.enter("autolinkMarker"),K.consume(he),K.exit("autolinkMarker"),K.enter("autolinkProtocol"),ie}function ie(he){return asciiAlpha$2(he)?(K.consume(he),oe):asciiAtext(he)?le(he):Z(he)}function oe(he){return he===43||he===45||he===46||asciiAlphanumeric$3(he)?se(he):le(he)}function se(he){return he===58?(K.consume(he),ae):(he===43||he===45||he===46||asciiAlphanumeric$3(he))&&te++<32?(K.consume(he),se):le(he)}function ae(he){return he===62?(K.exit("autolinkProtocol"),pe(he)):he===32||he===60||asciiControl$1(he)?Z(he):(K.consume(he),ae)}function le(he){return he===64?(K.consume(he),te=0,ce):asciiAtext(he)?(K.consume(he),le):Z(he)}function ce(he){return asciiAlphanumeric$3(he)?fe(he):Z(he)}function fe(he){return he===46?(K.consume(he),te=0,ce):he===62?(K.exit("autolinkProtocol").type="autolinkEmail",pe(he)):de(he)}function de(he){return(he===45||asciiAlphanumeric$3(he))&&te++<63?(K.consume(he),he===45?de:fe):Z(he)}function pe(he){return K.enter("autolinkMarker"),K.consume(he),K.exit("autolinkMarker"),K.exit("autolink"),_}}var autolink_1=autolink$1,markdownSpace$7=markdownSpace_1,factorySpace$b=factorySpace$h,blockQuote$1={name:"blockQuote",tokenize:tokenizeBlockQuoteStart,continuation:{tokenize:tokenizeBlockQuoteContinuation},exit};function tokenizeBlockQuoteStart(K,_,Z){var te=this;return ne;function ne(oe){return oe===62?(te.containerState.open||(K.enter("blockQuote",{_container:!0}),te.containerState.open=!0),K.enter("blockQuotePrefix"),K.enter("blockQuoteMarker"),K.consume(oe),K.exit("blockQuoteMarker"),ie):Z(oe)}function ie(oe){return markdownSpace$7(oe)?(K.enter("blockQuotePrefixWhitespace"),K.consume(oe),K.exit("blockQuotePrefixWhitespace"),K.exit("blockQuotePrefix"),_):(K.exit("blockQuotePrefix"),_(oe))}}function tokenizeBlockQuoteContinuation(K,_,Z){return factorySpace$b(K,K.attempt(blockQuote$1,_,Z),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function exit(K){K.exit("blockQuote")}var blockQuote_1=blockQuote$1,regexCheck$2=regexCheck_1,asciiPunctuation$1=regexCheck$2(/[!-/:-@[-`{-~]/),asciiPunctuation_1=asciiPunctuation$1,asciiPunctuation=asciiPunctuation_1,characterEscape$1={name:"characterEscape",tokenize:tokenizeCharacterEscape};function tokenizeCharacterEscape(K,_,Z){return te;function te(ie){return K.enter("characterEscape"),K.enter("escapeMarker"),K.consume(ie),K.exit("escapeMarker"),ne}function ne(ie){return asciiPunctuation(ie)?(K.enter("characterEscapeValue"),K.consume(ie),K.exit("characterEscapeValue"),K.exit("characterEscape"),_):Z(ie)}}var characterEscape_1=characterEscape$1,el,semicolon=59,decodeEntity_browser=decodeEntity$1;function decodeEntity$1(K){var _="&"+K+";",Z;return el=el||document.createElement("i"),el.innerHTML=_,Z=el.textContent,Z.charCodeAt(Z.length-1)===semicolon&&K!=="semi"||Z===_?!1:Z}var regexCheck$1=regexCheck_1,asciiDigit$2=regexCheck$1(/\d/),asciiDigit_1=asciiDigit$2,regexCheck=regexCheck_1,asciiHexDigit$1=regexCheck(/[\dA-Fa-f]/),asciiHexDigit_1=asciiHexDigit$1,decodeEntity=decodeEntity_browser,asciiAlphanumeric$2=asciiAlphanumeric_1,asciiDigit$1=asciiDigit_1,asciiHexDigit=asciiHexDigit_1;function _interopDefaultLegacy(K){return K&&typeof K=="object"&&"default"in K?K:{default:K}}var decodeEntity__default=_interopDefaultLegacy(decodeEntity),characterReference$1={name:"characterReference",tokenize:tokenizeCharacterReference};function tokenizeCharacterReference(K,_,Z){var te=this,ne=0,ie,oe;return se;function se(fe){return K.enter("characterReference"),K.enter("characterReferenceMarker"),K.consume(fe),K.exit("characterReferenceMarker"),ae}function ae(fe){return fe===35?(K.enter("characterReferenceMarkerNumeric"),K.consume(fe),K.exit("characterReferenceMarkerNumeric"),le):(K.enter("characterReferenceValue"),ie=31,oe=asciiAlphanumeric$2,ce(fe))}function le(fe){return fe===88||fe===120?(K.enter("characterReferenceMarkerHexadecimal"),K.consume(fe),K.exit("characterReferenceMarkerHexadecimal"),K.enter("characterReferenceValue"),ie=6,oe=asciiHexDigit,ce):(K.enter("characterReferenceValue"),ie=7,oe=asciiDigit$1,ce(fe))}function ce(fe){var de;return fe===59&&ne?(de=K.exit("characterReferenceValue"),oe===asciiAlphanumeric$2&&!decodeEntity__default.default(te.sliceSerialize(de))?Z(fe):(K.enter("characterReferenceMarker"),K.consume(fe),K.exit("characterReferenceMarker"),K.exit("characterReference"),_)):oe(fe)&&ne++<ie?(K.consume(fe),ce):Z(fe)}}var characterReference_1=characterReference$1,markdownLineEnding$d=markdownLineEnding_1,markdownLineEndingOrSpace$6=markdownLineEndingOrSpace_1,prefixSize$2=prefixSize_1,factorySpace$a=factorySpace$h,codeFenced$1={name:"codeFenced",tokenize:tokenizeCodeFenced,concrete:!0};function tokenizeCodeFenced(K,_,Z){var te=this,ne={tokenize:ye,partial:!0},ie=prefixSize$2(this.events,"linePrefix"),oe=0,se;return ae;function ae(ve){return K.enter("codeFenced"),K.enter("codeFencedFence"),K.enter("codeFencedFenceSequence"),se=ve,le(ve)}function le(ve){return ve===se?(K.consume(ve),oe++,le):(K.exit("codeFencedFenceSequence"),oe<3?Z(ve):factorySpace$a(K,ce,"whitespace")(ve))}function ce(ve){return ve===null||markdownLineEnding$d(ve)?he(ve):(K.enter("codeFencedFenceInfo"),K.enter("chunkString",{contentType:"string"}),fe(ve))}function fe(ve){return ve===null||markdownLineEndingOrSpace$6(ve)?(K.exit("chunkString"),K.exit("codeFencedFenceInfo"),factorySpace$a(K,de,"whitespace")(ve)):ve===96&&ve===se?Z(ve):(K.consume(ve),fe)}function de(ve){return ve===null||markdownLineEnding$d(ve)?he(ve):(K.enter("codeFencedFenceMeta"),K.enter("chunkString",{contentType:"string"}),pe(ve))}function pe(ve){return ve===null||markdownLineEnding$d(ve)?(K.exit("chunkString"),K.exit("codeFencedFenceMeta"),he(ve)):ve===96&&ve===se?Z(ve):(K.consume(ve),pe)}function he(ve){return K.exit("codeFencedFence"),te.interrupt?_(ve):ge(ve)}function ge(ve){return ve===null?Ae(ve):markdownLineEnding$d(ve)?(K.enter("lineEnding"),K.consume(ve),K.exit("lineEnding"),K.attempt(ne,Ae,ie?factorySpace$a(K,ge,"linePrefix",ie+1):ge)):(K.enter("codeFlowValue"),me(ve))}function me(ve){return ve===null||markdownLineEnding$d(ve)?(K.exit("codeFlowValue"),ge(ve)):(K.consume(ve),me)}function Ae(ve){return K.exit("codeFenced"),_(ve)}function ye(ve,_e,Te){var be=0;return factorySpace$a(ve,Re,"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function Re(Ie){return ve.enter("codeFencedFence"),ve.enter("codeFencedFenceSequence"),we(Ie)}function we(Ie){return Ie===se?(ve.consume(Ie),be++,we):be<oe?Te(Ie):(ve.exit("codeFencedFenceSequence"),factorySpace$a(ve,Pe,"whitespace")(Ie))}function Pe(Ie){return Ie===null||markdownLineEnding$d(Ie)?(ve.exit("codeFencedFence"),_e(Ie)):Te(Ie)}}}var codeFenced_1=codeFenced$1,markdownLineEnding$c=markdownLineEnding_1,chunkedSplice$2=chunkedSplice_1,prefixSize$1=prefixSize_1,factorySpace$9=factorySpace$h,codeIndented$1={name:"codeIndented",tokenize:tokenizeCodeIndented,resolve:resolveCodeIndented},indentedContentConstruct={tokenize:tokenizeIndentedContent,partial:!0};function resolveCodeIndented(K,_){var Z={type:"codeIndented",start:K[0][1].start,end:K[K.length-1][1].end};return chunkedSplice$2(K,0,0,[["enter",Z,_]]),chunkedSplice$2(K,K.length,0,[["exit",Z,_]]),K}function tokenizeCodeIndented(K,_,Z){return K.attempt(indentedContentConstruct,te,Z);function te(ie){return ie===null?_(ie):markdownLineEnding$c(ie)?K.attempt(indentedContentConstruct,te,_)(ie):(K.enter("codeFlowValue"),ne(ie))}function ne(ie){return ie===null||markdownLineEnding$c(ie)?(K.exit("codeFlowValue"),te(ie)):(K.consume(ie),ne)}}function tokenizeIndentedContent(K,_,Z){var te=this;return factorySpace$9(K,ne,"linePrefix",5);function ne(ie){return markdownLineEnding$c(ie)?(K.enter("lineEnding"),K.consume(ie),K.exit("lineEnding"),factorySpace$9(K,ne,"linePrefix",5)):prefixSize$1(te.events,"linePrefix")<4?Z(ie):_(ie)}}var codeIndented_1=codeIndented$1,markdownLineEnding$b=markdownLineEnding_1,codeText$1={name:"codeText",tokenize:tokenizeCodeText,resolve:resolveCodeText,previous};function resolveCodeText(K){var _=K.length-4,Z=3,te,ne;if((K[Z][1].type==="lineEnding"||K[Z][1].type==="space")&&(K[_][1].type==="lineEnding"||K[_][1].type==="space")){for(te=Z;++te<_;)if(K[te][1].type==="codeTextData"){K[_][1].type=K[Z][1].type="codeTextPadding",Z+=2,_-=2;break}}for(te=Z-1,_++;++te<=_;)ne===void 0?te!==_&&K[te][1].type!=="lineEnding"&&(ne=te):(te===_||K[te][1].type==="lineEnding")&&(K[ne][1].type="codeTextData",te!==ne+2&&(K[ne][1].end=K[te-1][1].end,K.splice(ne+2,te-ne-2),_-=te-ne-2,te=ne+2),ne=void 0);return K}function previous(K){return K!==96||this.events[this.events.length-1][1].type==="characterEscape"}function tokenizeCodeText(K,_,Z){var te=0,ne,ie;return oe;function oe(fe){return K.enter("codeText"),K.enter("codeTextSequence"),se(fe)}function se(fe){return fe===96?(K.consume(fe),te++,se):(K.exit("codeTextSequence"),ae(fe))}function ae(fe){return fe===null?Z(fe):fe===96?(ie=K.enter("codeTextSequence"),ne=0,ce(fe)):fe===32?(K.enter("space"),K.consume(fe),K.exit("space"),ae):markdownLineEnding$b(fe)?(K.enter("lineEnding"),K.consume(fe),K.exit("lineEnding"),ae):(K.enter("codeTextData"),le(fe))}function le(fe){return fe===null||fe===32||fe===96||markdownLineEnding$b(fe)?(K.exit("codeTextData"),ae(fe)):(K.consume(fe),le)}function ce(fe){return fe===96?(K.consume(fe),ne++,ce):ne===te?(K.exit("codeTextSequence"),K.exit("codeText"),_(fe)):(ie.type="codeTextData",le(fe))}}var codeText_1=codeText$1,asciiControl=asciiControl_1,markdownLineEndingOrSpace$5=markdownLineEndingOrSpace_1,markdownLineEnding$a=markdownLineEnding_1;function destinationFactory(K,_,Z,te,ne,ie,oe,se,ae){var le=ae||1/0,ce=0;return fe;function fe(Ae){return Ae===60?(K.enter(te),K.enter(ne),K.enter(ie),K.consume(Ae),K.exit(ie),de):asciiControl(Ae)||Ae===41?Z(Ae):(K.enter(te),K.enter(oe),K.enter(se),K.enter("chunkString",{contentType:"string"}),ge(Ae))}function de(Ae){return Ae===62?(K.enter(ie),K.consume(Ae),K.exit(ie),K.exit(ne),K.exit(te),_):(K.enter(se),K.enter("chunkString",{contentType:"string"}),pe(Ae))}function pe(Ae){return Ae===62?(K.exit("chunkString"),K.exit(se),de(Ae)):Ae===null||Ae===60||markdownLineEnding$a(Ae)?Z(Ae):(K.consume(Ae),Ae===92?he:pe)}function he(Ae){return Ae===60||Ae===62||Ae===92?(K.consume(Ae),pe):pe(Ae)}function ge(Ae){return Ae===40?++ce>le?Z(Ae):(K.consume(Ae),ge):Ae===41?ce--?(K.consume(Ae),ge):(K.exit("chunkString"),K.exit(se),K.exit(oe),K.exit(te),_(Ae)):Ae===null||markdownLineEndingOrSpace$5(Ae)?ce?Z(Ae):(K.exit("chunkString"),K.exit(se),K.exit(oe),K.exit(te),_(Ae)):asciiControl(Ae)?Z(Ae):(K.consume(Ae),Ae===92?me:ge)}function me(Ae){return Ae===40||Ae===41||Ae===92?(K.consume(Ae),ge):ge(Ae)}}var factoryDestination$2=destinationFactory,markdownLineEnding$9=markdownLineEnding_1,markdownSpace$6=markdownSpace_1;function labelFactory(K,_,Z,te,ne,ie){var oe=this,se=0,ae;return le;function le(pe){return K.enter(te),K.enter(ne),K.consume(pe),K.exit(ne),K.enter(ie),ce}function ce(pe){return pe===null||pe===91||pe===93&&!ae||pe===94&&!se&&"_hiddenFootnoteSupport"in oe.parser.constructs||se>999?Z(pe):pe===93?(K.exit(ie),K.enter(ne),K.consume(pe),K.exit(ne),K.exit(te),_):markdownLineEnding$9(pe)?(K.enter("lineEnding"),K.consume(pe),K.exit("lineEnding"),ce):(K.enter("chunkString",{contentType:"string"}),fe(pe))}function fe(pe){return pe===null||pe===91||pe===93||markdownLineEnding$9(pe)||se++>999?(K.exit("chunkString"),ce(pe)):(K.consume(pe),ae=ae||!markdownSpace$6(pe),pe===92?de:fe)}function de(pe){return pe===91||pe===92||pe===93?(K.consume(pe),se++,fe):fe(pe)}}var factoryLabel$2=labelFactory,markdownLineEnding$8=markdownLineEnding_1,markdownSpace$5=markdownSpace_1,factorySpace$8=factorySpace$h;function whitespaceFactory(K,_){var Z;return te;function te(ne){return markdownLineEnding$8(ne)?(K.enter("lineEnding"),K.consume(ne),K.exit("lineEnding"),Z=!0,te):markdownSpace$5(ne)?factorySpace$8(K,te,Z?"linePrefix":"lineSuffix")(ne):_(ne)}}var factoryWhitespace$2=whitespaceFactory,markdownLineEnding$7=markdownLineEnding_1,factorySpace$7=factorySpace$h;function titleFactory(K,_,Z,te,ne,ie){var oe;return se;function se(de){return K.enter(te),K.enter(ne),K.consume(de),K.exit(ne),oe=de===40?41:de,ae}function ae(de){return de===oe?(K.enter(ne),K.consume(de),K.exit(ne),K.exit(te),_):(K.enter(ie),le(de))}function le(de){return de===oe?(K.exit(ie),ae(oe)):de===null?Z(de):markdownLineEnding$7(de)?(K.enter("lineEnding"),K.consume(de),K.exit("lineEnding"),factorySpace$7(K,le,"linePrefix")):(K.enter("chunkString",{contentType:"string"}),ce(de))}function ce(de){return de===oe||de===null||markdownLineEnding$7(de)?(K.exit("chunkString"),le(de)):(K.consume(de),de===92?fe:ce)}function fe(de){return de===oe||de===92?(K.consume(de),ce):ce(de)}}var factoryTitle$2=titleFactory,markdownLineEnding$6=markdownLineEnding_1,markdownLineEndingOrSpace$4=markdownLineEndingOrSpace_1,normalizeIdentifier$2=normalizeIdentifier_1,factoryDestination$1=factoryDestination$2,factoryLabel$1=factoryLabel$2,factorySpace$6=factorySpace$h,factoryWhitespace$1=factoryWhitespace$2,factoryTitle$1=factoryTitle$2,definition$1={name:"definition",tokenize:tokenizeDefinition},titleConstruct={tokenize:tokenizeTitle,partial:!0};function tokenizeDefinition(K,_,Z){var te=this,ne;return ie;function ie(ae){return K.enter("definition"),factoryLabel$1.call(te,K,oe,Z,"definitionLabel","definitionLabelMarker","definitionLabelString")(ae)}function oe(ae){return ne=normalizeIdentifier$2(te.sliceSerialize(te.events[te.events.length-1][1]).slice(1,-1)),ae===58?(K.enter("definitionMarker"),K.consume(ae),K.exit("definitionMarker"),factoryWhitespace$1(K,factoryDestination$1(K,K.attempt(titleConstruct,factorySpace$6(K,se,"whitespace"),factorySpace$6(K,se,"whitespace")),Z,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):Z(ae)}function se(ae){return ae===null||markdownLineEnding$6(ae)?(K.exit("definition"),te.parser.defined.indexOf(ne)<0&&te.parser.defined.push(ne),_(ae)):Z(ae)}}function tokenizeTitle(K,_,Z){return te;function te(oe){return markdownLineEndingOrSpace$4(oe)?factoryWhitespace$1(K,ne)(oe):Z(oe)}function ne(oe){return oe===34||oe===39||oe===40?factoryTitle$1(K,factorySpace$6(K,ie,"whitespace"),Z,"definitionTitle","definitionTitleMarker","definitionTitleString")(oe):Z(oe)}function ie(oe){return oe===null||markdownLineEnding$6(oe)?_(oe):Z(oe)}}var definition_1=definition$1,markdownLineEnding$5=markdownLineEnding_1,hardBreakEscape$1={name:"hardBreakEscape",tokenize:tokenizeHardBreakEscape};function tokenizeHardBreakEscape(K,_,Z){return te;function te(ie){return K.enter("hardBreakEscape"),K.enter("escapeMarker"),K.consume(ie),ne}function ne(ie){return markdownLineEnding$5(ie)?(K.exit("escapeMarker"),K.exit("hardBreakEscape"),_(ie)):Z(ie)}}var hardBreakEscape_1=hardBreakEscape$1,markdownLineEnding$4=markdownLineEnding_1,markdownLineEndingOrSpace$3=markdownLineEndingOrSpace_1,markdownSpace$4=markdownSpace_1,chunkedSplice$1=chunkedSplice_1,factorySpace$5=factorySpace$h,headingAtx$1={name:"headingAtx",tokenize:tokenizeHeadingAtx,resolve:resolveHeadingAtx};function resolveHeadingAtx(K,_){var Z=K.length-2,te=3,ne,ie;return K[te][1].type==="whitespace"&&(te+=2),Z-2>te&&K[Z][1].type==="whitespace"&&(Z-=2),K[Z][1].type==="atxHeadingSequence"&&(te===Z-1||Z-4>te&&K[Z-2][1].type==="whitespace")&&(Z-=te+1===Z?2:4),Z>te&&(ne={type:"atxHeadingText",start:K[te][1].start,end:K[Z][1].end},ie={type:"chunkText",start:K[te][1].start,end:K[Z][1].end,contentType:"text"},chunkedSplice$1(K,te,Z-te+1,[["enter",ne,_],["enter",ie,_],["exit",ie,_],["exit",ne,_]])),K}function tokenizeHeadingAtx(K,_,Z){var te=this,ne=0;return ie;function ie(ce){return K.enter("atxHeading"),K.enter("atxHeadingSequence"),oe(ce)}function oe(ce){return ce===35&&ne++<6?(K.consume(ce),oe):ce===null||markdownLineEndingOrSpace$3(ce)?(K.exit("atxHeadingSequence"),te.interrupt?_(ce):se(ce)):Z(ce)}function se(ce){return ce===35?(K.enter("atxHeadingSequence"),ae(ce)):ce===null||markdownLineEnding$4(ce)?(K.exit("atxHeading"),_(ce)):markdownSpace$4(ce)?factorySpace$5(K,se,"whitespace")(ce):(K.enter("atxHeadingText"),le(ce))}function ae(ce){return ce===35?(K.consume(ce),ae):(K.exit("atxHeadingSequence"),se(ce))}function le(ce){return ce===null||ce===35||markdownLineEndingOrSpace$3(ce)?(K.exit("atxHeadingText"),se(ce)):(K.consume(ce),le)}}var headingAtx_1=headingAtx$1,basics=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],htmlBlockNames$1=basics,raws=["pre","script","style","textarea"],htmlRawNames$1=raws,asciiAlpha$1=asciiAlpha_1,asciiAlphanumeric$1=asciiAlphanumeric_1,markdownLineEnding$3=markdownLineEnding_1,markdownLineEndingOrSpace$2=markdownLineEndingOrSpace_1,markdownSpace$3=markdownSpace_1,fromCharCode=fromCharCode_1,htmlBlockNames=htmlBlockNames$1,htmlRawNames=htmlRawNames$1,partialBlankLine$1=partialBlankLine_1,htmlFlow$1={name:"htmlFlow",tokenize:tokenizeHtmlFlow,resolveTo:resolveToHtmlFlow,concrete:!0},nextBlankConstruct={tokenize:tokenizeNextBlank,partial:!0};function resolveToHtmlFlow(K){for(var _=K.length;_--&&!(K[_][0]==="enter"&&K[_][1].type==="htmlFlow"););return _>1&&K[_-2][1].type==="linePrefix"&&(K[_][1].start=K[_-2][1].start,K[_+1][1].start=K[_-2][1].start,K.splice(_-2,2)),K}function tokenizeHtmlFlow(K,_,Z){var te=this,ne,ie,oe,se,ae;return le;function le(Fe){return K.enter("htmlFlow"),K.enter("htmlFlowData"),K.consume(Fe),ce}function ce(Fe){return Fe===33?(K.consume(Fe),fe):Fe===47?(K.consume(Fe),he):Fe===63?(K.consume(Fe),ne=3,te.interrupt?_:tt):asciiAlpha$1(Fe)?(K.consume(Fe),oe=fromCharCode(Fe),ie=!0,ge):Z(Fe)}function fe(Fe){return Fe===45?(K.consume(Fe),ne=2,de):Fe===91?(K.consume(Fe),ne=5,oe="CDATA[",se=0,pe):asciiAlpha$1(Fe)?(K.consume(Fe),ne=4,te.interrupt?_:tt):Z(Fe)}function de(Fe){return Fe===45?(K.consume(Fe),te.interrupt?_:tt):Z(Fe)}function pe(Fe){return Fe===oe.charCodeAt(se++)?(K.consume(Fe),se===oe.length?te.interrupt?_:$e:pe):Z(Fe)}function he(Fe){return asciiAlpha$1(Fe)?(K.consume(Fe),oe=fromCharCode(Fe),ge):Z(Fe)}function ge(Fe){return Fe===null||Fe===47||Fe===62||markdownLineEndingOrSpace$2(Fe)?Fe!==47&&ie&&htmlRawNames.indexOf(oe.toLowerCase())>-1?(ne=1,te.interrupt?_(Fe):$e(Fe)):htmlBlockNames.indexOf(oe.toLowerCase())>-1?(ne=6,Fe===47?(K.consume(Fe),me):te.interrupt?_(Fe):$e(Fe)):(ne=7,te.interrupt?Z(Fe):ie?ye(Fe):Ae(Fe)):Fe===45||asciiAlphanumeric$1(Fe)?(K.consume(Fe),oe+=fromCharCode(Fe),ge):Z(Fe)}function me(Fe){return Fe===62?(K.consume(Fe),te.interrupt?_:$e):Z(Fe)}function Ae(Fe){return markdownSpace$3(Fe)?(K.consume(Fe),Ae):Pe(Fe)}function ye(Fe){return Fe===47?(K.consume(Fe),Pe):Fe===58||Fe===95||asciiAlpha$1(Fe)?(K.consume(Fe),ve):markdownSpace$3(Fe)?(K.consume(Fe),ye):Pe(Fe)}function ve(Fe){return Fe===45||Fe===46||Fe===58||Fe===95||asciiAlphanumeric$1(Fe)?(K.consume(Fe),ve):_e(Fe)}function _e(Fe){return Fe===61?(K.consume(Fe),Te):markdownSpace$3(Fe)?(K.consume(Fe),_e):ye(Fe)}function Te(Fe){return Fe===null||Fe===60||Fe===61||Fe===62||Fe===96?Z(Fe):Fe===34||Fe===39?(K.consume(Fe),ae=Fe,be):markdownSpace$3(Fe)?(K.consume(Fe),Te):(ae=void 0,Re(Fe))}function be(Fe){return Fe===ae?(K.consume(Fe),we):Fe===null||markdownLineEnding$3(Fe)?Z(Fe):(K.consume(Fe),be)}function Re(Fe){return Fe===null||Fe===34||Fe===39||Fe===60||Fe===61||Fe===62||Fe===96||markdownLineEndingOrSpace$2(Fe)?_e(Fe):(K.consume(Fe),Re)}function we(Fe){return Fe===47||Fe===62||markdownSpace$3(Fe)?ye(Fe):Z(Fe)}function Pe(Fe){return Fe===62?(K.consume(Fe),Ie):Z(Fe)}function Ie(Fe){return markdownSpace$3(Fe)?(K.consume(Fe),Ie):Fe===null||markdownLineEnding$3(Fe)?$e(Fe):Z(Fe)}function $e(Fe){return Fe===45&&ne===2?(K.consume(Fe),Ge):Fe===60&&ne===1?(K.consume(Fe),He):Fe===62&&ne===4?(K.consume(Fe),Je):Fe===63&&ne===3?(K.consume(Fe),tt):Fe===93&&ne===5?(K.consume(Fe),Ke):markdownLineEnding$3(Fe)&&(ne===6||ne===7)?K.check(nextBlankConstruct,Je,Ue)(Fe):Fe===null||markdownLineEnding$3(Fe)?Ue(Fe):(K.consume(Fe),$e)}function Ue(Fe){return K.exit("htmlFlowData"),ke(Fe)}function ke(Fe){return Fe===null?ot(Fe):markdownLineEnding$3(Fe)?(K.enter("lineEnding"),K.consume(Fe),K.exit("lineEnding"),ke):(K.enter("htmlFlowData"),$e(Fe))}function Ge(Fe){return Fe===45?(K.consume(Fe),tt):$e(Fe)}function He(Fe){return Fe===47?(K.consume(Fe),oe="",ze):$e(Fe)}function ze(Fe){return Fe===62&&htmlRawNames.indexOf(oe.toLowerCase())>-1?(K.consume(Fe),Je):asciiAlpha$1(Fe)&&oe.length<8?(K.consume(Fe),oe+=fromCharCode(Fe),ze):$e(Fe)}function Ke(Fe){return Fe===93?(K.consume(Fe),tt):$e(Fe)}function tt(Fe){return Fe===62?(K.consume(Fe),Je):$e(Fe)}function Je(Fe){return Fe===null||markdownLineEnding$3(Fe)?(K.exit("htmlFlowData"),ot(Fe)):(K.consume(Fe),Je)}function ot(Fe){return K.exit("htmlFlow"),_(Fe)}}function tokenizeNextBlank(K,_,Z){return te;function te(ne){return K.exit("htmlFlowData"),K.enter("lineEndingBlank"),K.consume(ne),K.exit("lineEndingBlank"),K.attempt(partialBlankLine$1,_,Z)}}var htmlFlow_1=htmlFlow$1,asciiAlpha=asciiAlpha_1,asciiAlphanumeric=asciiAlphanumeric_1,markdownLineEnding$2=markdownLineEnding_1,markdownLineEndingOrSpace$1=markdownLineEndingOrSpace_1,markdownSpace$2=markdownSpace_1,factorySpace$4=factorySpace$h,htmlText$1={name:"htmlText",tokenize:tokenizeHtmlText};function tokenizeHtmlText(K,_,Z){var te=this,ne,ie,oe,se;return ae;function ae(Fe){return K.enter("htmlText"),K.enter("htmlTextData"),K.consume(Fe),le}function le(Fe){return Fe===33?(K.consume(Fe),ce):Fe===47?(K.consume(Fe),Re):Fe===63?(K.consume(Fe),Te):asciiAlpha(Fe)?(K.consume(Fe),Ie):Z(Fe)}function ce(Fe){return Fe===45?(K.consume(Fe),fe):Fe===91?(K.consume(Fe),ie="CDATA[",oe=0,me):asciiAlpha(Fe)?(K.consume(Fe),_e):Z(Fe)}function fe(Fe){return Fe===45?(K.consume(Fe),de):Z(Fe)}function de(Fe){return Fe===null||Fe===62?Z(Fe):Fe===45?(K.consume(Fe),pe):he(Fe)}function pe(Fe){return Fe===null||Fe===62?Z(Fe):he(Fe)}function he(Fe){return Fe===null?Z(Fe):Fe===45?(K.consume(Fe),ge):markdownLineEnding$2(Fe)?(se=he,tt(Fe)):(K.consume(Fe),he)}function ge(Fe){return Fe===45?(K.consume(Fe),ot):he(Fe)}function me(Fe){return Fe===ie.charCodeAt(oe++)?(K.consume(Fe),oe===ie.length?Ae:me):Z(Fe)}function Ae(Fe){return Fe===null?Z(Fe):Fe===93?(K.consume(Fe),ye):markdownLineEnding$2(Fe)?(se=Ae,tt(Fe)):(K.consume(Fe),Ae)}function ye(Fe){return Fe===93?(K.consume(Fe),ve):Ae(Fe)}function ve(Fe){return Fe===62?ot(Fe):Fe===93?(K.consume(Fe),ve):Ae(Fe)}function _e(Fe){return Fe===null||Fe===62?ot(Fe):markdownLineEnding$2(Fe)?(se=_e,tt(Fe)):(K.consume(Fe),_e)}function Te(Fe){return Fe===null?Z(Fe):Fe===63?(K.consume(Fe),be):markdownLineEnding$2(Fe)?(se=Te,tt(Fe)):(K.consume(Fe),Te)}function be(Fe){return Fe===62?ot(Fe):Te(Fe)}function Re(Fe){return asciiAlpha(Fe)?(K.consume(Fe),we):Z(Fe)}function we(Fe){return Fe===45||asciiAlphanumeric(Fe)?(K.consume(Fe),we):Pe(Fe)}function Pe(Fe){return markdownLineEnding$2(Fe)?(se=Pe,tt(Fe)):markdownSpace$2(Fe)?(K.consume(Fe),Pe):ot(Fe)}function Ie(Fe){return Fe===45||asciiAlphanumeric(Fe)?(K.consume(Fe),Ie):Fe===47||Fe===62||markdownLineEndingOrSpace$1(Fe)?$e(Fe):Z(Fe)}function $e(Fe){return Fe===47?(K.consume(Fe),ot):Fe===58||Fe===95||asciiAlpha(Fe)?(K.consume(Fe),Ue):markdownLineEnding$2(Fe)?(se=$e,tt(Fe)):markdownSpace$2(Fe)?(K.consume(Fe),$e):ot(Fe)}function Ue(Fe){return Fe===45||Fe===46||Fe===58||Fe===95||asciiAlphanumeric(Fe)?(K.consume(Fe),Ue):ke(Fe)}function ke(Fe){return Fe===61?(K.consume(Fe),Ge):markdownLineEnding$2(Fe)?(se=ke,tt(Fe)):markdownSpace$2(Fe)?(K.consume(Fe),ke):$e(Fe)}function Ge(Fe){return Fe===null||Fe===60||Fe===61||Fe===62||Fe===96?Z(Fe):Fe===34||Fe===39?(K.consume(Fe),ne=Fe,He):markdownLineEnding$2(Fe)?(se=Ge,tt(Fe)):markdownSpace$2(Fe)?(K.consume(Fe),Ge):(K.consume(Fe),ne=void 0,Ke)}function He(Fe){return Fe===ne?(K.consume(Fe),ze):Fe===null?Z(Fe):markdownLineEnding$2(Fe)?(se=He,tt(Fe)):(K.consume(Fe),He)}function ze(Fe){return Fe===62||Fe===47||markdownLineEndingOrSpace$1(Fe)?$e(Fe):Z(Fe)}function Ke(Fe){return Fe===null||Fe===34||Fe===39||Fe===60||Fe===61||Fe===96?Z(Fe):Fe===62||markdownLineEndingOrSpace$1(Fe)?$e(Fe):(K.consume(Fe),Ke)}function tt(Fe){return K.exit("htmlTextData"),K.enter("lineEnding"),K.consume(Fe),K.exit("lineEnding"),factorySpace$4(K,Je,"linePrefix",te.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function Je(Fe){return K.enter("htmlTextData"),se(Fe)}function ot(Fe){return Fe===62?(K.consume(Fe),K.exit("htmlTextData"),K.exit("htmlText"),_):Z(Fe)}}var htmlText_1=htmlText$1,markdownLineEndingOrSpace=markdownLineEndingOrSpace_1,chunkedPush=chunkedPush_1,chunkedSplice=chunkedSplice_1,normalizeIdentifier$1=normalizeIdentifier_1,resolveAll=resolveAll_1,shallow$1=shallow_1,factoryDestination=factoryDestination$2,factoryLabel=factoryLabel$2,factoryTitle=factoryTitle$2,factoryWhitespace=factoryWhitespace$2,labelEnd$3={name:"labelEnd",tokenize:tokenizeLabelEnd,resolveTo:resolveToLabelEnd,resolveAll:resolveAllLabelEnd},resourceConstruct={tokenize:tokenizeResource},fullReferenceConstruct={tokenize:tokenizeFullReference},collapsedReferenceConstruct={tokenize:tokenizeCollapsedReference};function resolveAllLabelEnd(K){for(var _=-1,Z;++_<K.length;)Z=K[_][1],!Z._used&&(Z.type==="labelImage"||Z.type==="labelLink"||Z.type==="labelEnd")&&(K.splice(_+1,Z.type==="labelImage"?4:2),Z.type="data",_++);return K}function resolveToLabelEnd(K,_){for(var Z=K.length,te=0,ne,ie,oe,se,ae,le,ce;Z--;)if(se=K[Z][1],ae){if(se.type==="link"||se.type==="labelLink"&&se._inactive)break;K[Z][0]==="enter"&&se.type==="labelLink"&&(se._inactive=!0)}else if(le){if(K[Z][0]==="enter"&&(se.type==="labelImage"||se.type==="labelLink")&&!se._balanced&&(ae=Z,se.type!=="labelLink")){te=2;break}}else se.type==="labelEnd"&&(le=Z);return ne={type:K[ae][1].type==="labelLink"?"link":"image",start:shallow$1(K[ae][1].start),end:shallow$1(K[K.length-1][1].end)},ie={type:"label",start:shallow$1(K[ae][1].start),end:shallow$1(K[le][1].end)},oe={type:"labelText",start:shallow$1(K[ae+te+2][1].end),end:shallow$1(K[le-2][1].start)},ce=[["enter",ne,_],["enter",ie,_]],ce=chunkedPush(ce,K.slice(ae+1,ae+te+3)),ce=chunkedPush(ce,[["enter",oe,_]]),ce=chunkedPush(ce,resolveAll(_.parser.constructs.insideSpan.null,K.slice(ae+te+4,le-3),_)),ce=chunkedPush(ce,[["exit",oe,_],K[le-2],K[le-1],["exit",ie,_]]),ce=chunkedPush(ce,K.slice(le+1)),ce=chunkedPush(ce,[["exit",ne,_]]),chunkedSplice(K,ae,K.length,ce),K}function tokenizeLabelEnd(K,_,Z){for(var te=this,ne=te.events.length,ie,oe;ne--;)if((te.events[ne][1].type==="labelImage"||te.events[ne][1].type==="labelLink")&&!te.events[ne][1]._balanced){ie=te.events[ne][1];break}return se;function se(ce){return ie?ie._inactive?le(ce):(oe=te.parser.defined.indexOf(normalizeIdentifier$1(te.sliceSerialize({start:ie.end,end:te.now()})))>-1,K.enter("labelEnd"),K.enter("labelMarker"),K.consume(ce),K.exit("labelMarker"),K.exit("labelEnd"),ae):Z(ce)}function ae(ce){return ce===40?K.attempt(resourceConstruct,_,oe?_:le)(ce):ce===91?K.attempt(fullReferenceConstruct,_,oe?K.attempt(collapsedReferenceConstruct,_,le):le)(ce):oe?_(ce):le(ce)}function le(ce){return ie._balanced=!0,Z(ce)}}function tokenizeResource(K,_,Z){return te;function te(ae){return K.enter("resource"),K.enter("resourceMarker"),K.consume(ae),K.exit("resourceMarker"),factoryWhitespace(K,ne)}function ne(ae){return ae===41?se(ae):factoryDestination(K,ie,Z,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(ae)}function ie(ae){return markdownLineEndingOrSpace(ae)?factoryWhitespace(K,oe)(ae):se(ae)}function oe(ae){return ae===34||ae===39||ae===40?factoryTitle(K,factoryWhitespace(K,se),Z,"resourceTitle","resourceTitleMarker","resourceTitleString")(ae):se(ae)}function se(ae){return ae===41?(K.enter("resourceMarker"),K.consume(ae),K.exit("resourceMarker"),K.exit("resource"),_):Z(ae)}}function tokenizeFullReference(K,_,Z){var te=this;return ne;function ne(oe){return factoryLabel.call(te,K,ie,Z,"reference","referenceMarker","referenceString")(oe)}function ie(oe){return te.parser.defined.indexOf(normalizeIdentifier$1(te.sliceSerialize(te.events[te.events.length-1][1]).slice(1,-1)))<0?Z(oe):_(oe)}}function tokenizeCollapsedReference(K,_,Z){return te;function te(ie){return K.enter("reference"),K.enter("referenceMarker"),K.consume(ie),K.exit("referenceMarker"),ne}function ne(ie){return ie===93?(K.enter("referenceMarker"),K.consume(ie),K.exit("referenceMarker"),K.exit("reference"),_):Z(ie)}}var labelEnd_1=labelEnd$3,labelEnd$2=labelEnd_1,labelStartImage$1={name:"labelStartImage",tokenize:tokenizeLabelStartImage,resolveAll:labelEnd$2.resolveAll};function tokenizeLabelStartImage(K,_,Z){var te=this;return ne;function ne(se){return K.enter("labelImage"),K.enter("labelImageMarker"),K.consume(se),K.exit("labelImageMarker"),ie}function ie(se){return se===91?(K.enter("labelMarker"),K.consume(se),K.exit("labelMarker"),K.exit("labelImage"),oe):Z(se)}function oe(se){return se===94&&"_hiddenFootnoteSupport"in te.parser.constructs?Z(se):_(se)}}var labelStartImage_1=labelStartImage$1,labelEnd$1=labelEnd_1,labelStartLink$1={name:"labelStartLink",tokenize:tokenizeLabelStartLink,resolveAll:labelEnd$1.resolveAll};function tokenizeLabelStartLink(K,_,Z){var te=this;return ne;function ne(oe){return K.enter("labelLink"),K.enter("labelMarker"),K.consume(oe),K.exit("labelMarker"),K.exit("labelLink"),ie}function ie(oe){return oe===94&&"_hiddenFootnoteSupport"in te.parser.constructs?Z(oe):_(oe)}}var labelStartLink_1=labelStartLink$1,factorySpace$3=factorySpace$h,lineEnding$1={name:"lineEnding",tokenize:tokenizeLineEnding};function tokenizeLineEnding(K,_){return Z;function Z(te){return K.enter("lineEnding"),K.consume(te),K.exit("lineEnding"),factorySpace$3(K,_,"linePrefix")}}var lineEnding_1=lineEnding$1,markdownLineEnding$1=markdownLineEnding_1,markdownSpace$1=markdownSpace_1,factorySpace$2=factorySpace$h,thematicBreak$4={name:"thematicBreak",tokenize:tokenizeThematicBreak};function tokenizeThematicBreak(K,_,Z){var te=0,ne;return ie;function ie(ae){return K.enter("thematicBreak"),ne=ae,oe(ae)}function oe(ae){return ae===ne?(K.enter("thematicBreakSequence"),se(ae)):markdownSpace$1(ae)?factorySpace$2(K,oe,"whitespace")(ae):te<3||ae!==null&&!markdownLineEnding$1(ae)?Z(ae):(K.exit("thematicBreak"),_(ae))}function se(ae){return ae===ne?(K.consume(ae),te++,se):(K.exit("thematicBreakSequence"),oe(ae))}}var thematicBreak_1$1=thematicBreak$4,asciiDigit=asciiDigit_1,markdownSpace=markdownSpace_1,prefixSize=prefixSize_1,sizeChunks=sizeChunks_1,factorySpace$1=factorySpace$h,partialBlankLine=partialBlankLine_1,thematicBreak$3=thematicBreak_1$1,list$3={name:"list",tokenize:tokenizeListStart,continuation:{tokenize:tokenizeListContinuation},exit:tokenizeListEnd},listItemPrefixWhitespaceConstruct={tokenize:tokenizeListItemPrefixWhitespace,partial:!0},indentConstruct={tokenize:tokenizeIndent,partial:!0};function tokenizeListStart(K,_,Z){var te=this,ne=prefixSize(te.events,"linePrefix"),ie=0;return oe;function oe(de){var pe=te.containerState.type||(de===42||de===43||de===45?"listUnordered":"listOrdered");if(pe==="listUnordered"?!te.containerState.marker||de===te.containerState.marker:asciiDigit(de)){if(te.containerState.type||(te.containerState.type=pe,K.enter(pe,{_container:!0})),pe==="listUnordered")return K.enter("listItemPrefix"),de===42||de===45?K.check(thematicBreak$3,Z,ae)(de):ae(de);if(!te.interrupt||de===49)return K.enter("listItemPrefix"),K.enter("listItemValue"),se(de)}return Z(de)}function se(de){return asciiDigit(de)&&++ie<10?(K.consume(de),se):(!te.interrupt||ie<2)&&(te.containerState.marker?de===te.containerState.marker:de===41||de===46)?(K.exit("listItemValue"),ae(de)):Z(de)}function ae(de){return K.enter("listItemMarker"),K.consume(de),K.exit("listItemMarker"),te.containerState.marker=te.containerState.marker||de,K.check(partialBlankLine,te.interrupt?Z:le,K.attempt(listItemPrefixWhitespaceConstruct,fe,ce))}function le(de){return te.containerState.initialBlankLine=!0,ne++,fe(de)}function ce(de){return markdownSpace(de)?(K.enter("listItemPrefixWhitespace"),K.consume(de),K.exit("listItemPrefixWhitespace"),fe):Z(de)}function fe(de){return te.containerState.size=ne+sizeChunks(te.sliceStream(K.exit("listItemPrefix"))),_(de)}}function tokenizeListContinuation(K,_,Z){var te=this;return te.containerState._closeFlow=void 0,K.check(partialBlankLine,ne,ie);function ne(se){return te.containerState.furtherBlankLines=te.containerState.furtherBlankLines||te.containerState.initialBlankLine,factorySpace$1(K,_,"listItemIndent",te.containerState.size+1)(se)}function ie(se){return te.containerState.furtherBlankLines||!markdownSpace(se)?(te.containerState.furtherBlankLines=te.containerState.initialBlankLine=void 0,oe(se)):(te.containerState.furtherBlankLines=te.containerState.initialBlankLine=void 0,K.attempt(indentConstruct,_,oe)(se))}function oe(se){return te.containerState._closeFlow=!0,te.interrupt=void 0,factorySpace$1(K,K.attempt(list$3,_,Z),"linePrefix",te.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(se)}}function tokenizeIndent(K,_,Z){var te=this;return factorySpace$1(K,ne,"listItemIndent",te.containerState.size+1);function ne(ie){return prefixSize(te.events,"listItemIndent")===te.containerState.size?_(ie):Z(ie)}}function tokenizeListEnd(K){K.exit(this.containerState.type)}function tokenizeListItemPrefixWhitespace(K,_,Z){var te=this;return factorySpace$1(K,ne,"listItemPrefixWhitespace",te.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5);function ne(ie){return markdownSpace(ie)||!prefixSize(te.events,"listItemPrefixWhitespace")?Z(ie):_(ie)}}var list_1$1=list$3,markdownLineEnding=markdownLineEnding_1,shallow=shallow_1,factorySpace=factorySpace$h,setextUnderline$1={name:"setextUnderline",tokenize:tokenizeSetextUnderline,resolveTo:resolveToSetextUnderline};function resolveToSetextUnderline(K,_){for(var Z=K.length,te,ne,ie,oe;Z--;)if(K[Z][0]==="enter"){if(K[Z][1].type==="content"){te=Z;break}K[Z][1].type==="paragraph"&&(ne=Z)}else K[Z][1].type==="content"&&K.splice(Z,1),!ie&&K[Z][1].type==="definition"&&(ie=Z);return oe={type:"setextHeading",start:shallow(K[ne][1].start),end:shallow(K[K.length-1][1].end)},K[ne][1].type="setextHeadingText",ie?(K.splice(ne,0,["enter",oe,_]),K.splice(ie+1,0,["exit",K[te][1],_]),K[te][1].end=shallow(K[ie][1].end)):K[te][1]=oe,K.push(["exit",oe,_]),K}function tokenizeSetextUnderline(K,_,Z){for(var te=this,ne=te.events.length,ie,oe;ne--;)if(te.events[ne][1].type!=="lineEnding"&&te.events[ne][1].type!=="linePrefix"&&te.events[ne][1].type!=="content"){oe=te.events[ne][1].type==="paragraph";break}return se;function se(ce){return!te.lazy&&(te.interrupt||oe)?(K.enter("setextHeadingLine"),K.enter("setextHeadingLineSequence"),ie=ce,ae(ce)):Z(ce)}function ae(ce){return ce===ie?(K.consume(ce),ae):(K.exit("setextHeadingLineSequence"),factorySpace(K,le,"lineSuffix")(ce))}function le(ce){return ce===null||markdownLineEnding(ce)?(K.exit("setextHeadingLine"),_(ce)):Z(ce)}}var setextUnderline_1=setextUnderline$1;Object.defineProperty(constructs$1,"__esModule",{value:!0});var text$1$1=text$5,attention=attention_1,autolink=autolink_1,blockQuote=blockQuote_1,characterEscape=characterEscape_1,characterReference=characterReference_1,codeFenced=codeFenced_1,codeIndented=codeIndented_1,codeText=codeText_1,definition=definition_1,hardBreakEscape=hardBreakEscape_1,headingAtx=headingAtx_1,htmlFlow=htmlFlow_1,htmlText=htmlText_1,labelEnd=labelEnd_1,labelStartImage=labelStartImage_1,labelStartLink=labelStartLink_1,lineEnding=lineEnding_1,list$2=list_1$1,setextUnderline=setextUnderline_1,thematicBreak$2=thematicBreak_1$1,document$2={42:list$2,43:list$2,45:list$2,48:list$2,49:list$2,50:list$2,51:list$2,52:list$2,53:list$2,54:list$2,55:list$2,56:list$2,57:list$2,62:blockQuote},contentInitial={91:definition},flowInitial={"-2":codeIndented,"-1":codeIndented,32:codeIndented},flow$1={35:headingAtx,42:thematicBreak$2,45:[setextUnderline,thematicBreak$2],60:htmlFlow,61:setextUnderline,95:thematicBreak$2,96:codeFenced,126:codeFenced},string={38:characterReference,92:characterEscape},text$3={"-5":lineEnding,"-4":lineEnding,"-3":lineEnding,33:labelStartImage,38:characterReference,42:attention,60:[autolink,htmlText],91:labelStartLink,92:[hardBreakEscape,characterEscape],93:labelEnd,95:attention,96:codeText},insideSpan={null:[attention,text$1$1.resolver]},disable={null:[]};constructs$1.contentInitial=contentInitial;constructs$1.disable=disable;constructs$1.document=document$2;constructs$1.flow=flow$1;constructs$1.flowInitial=flowInitial;constructs$1.insideSpan=insideSpan;constructs$1.string=string;constructs$1.text=text$3;var content=content$3,document$1=document$3,flow=flow$2,text$2=text$5,combineExtensions=combineExtensions_1,createTokenizer=createTokenizer_1,miniflat=miniflat_1,constructs=constructs$1;function parse$4(K){var _=K||{},Z={defined:[],constructs:combineExtensions([constructs].concat(miniflat(_.extensions))),content:te(content),document:te(document$1),flow:te(flow),string:te(text$2.string),text:te(text$2.text)};return Z;function te(ne){return ie;function ie(oe){return createTokenizer(Z,ne,oe)}}}var parse_1=parse$4,search=/[\0\t\n\r]/g;function preprocess(){var K=!0,_=1,Z="",te;return ne;function ne(ie,oe,se){var ae=[],le,ce,fe,de,pe;for(ie=Z+ie.toString(oe),fe=0,Z="",K&&(ie.charCodeAt(0)===65279&&fe++,K=void 0);fe<ie.length;){if(search.lastIndex=fe,le=search.exec(ie),de=le?le.index:ie.length,pe=ie.charCodeAt(de),!le){Z=ie.slice(fe);break}if(pe===10&&fe===de&&te)ae.push(-3),te=void 0;else if(te&&(ae.push(-5),te=void 0),fe<de&&(ae.push(ie.slice(fe,de)),_+=de-fe),pe===0)ae.push(65533),_++;else if(pe===9)for(ce=Math.ceil(_/4)*4,ae.push(-2);_++<ce;)ae.push(-1);else pe===10?(ae.push(-4),_=1):(te=!0,_=1);fe=de+1}return se&&(te&&ae.push(-5),Z&&ae.push(Z),ae.push(null)),ae}}var preprocess_1=preprocess,subtokenize=subtokenize_1;function postprocess$1(K){for(;!subtokenize(K););return K}var postprocess_1=postprocess$1,dist=fromMarkdown$1,toString=mdastUtilToString,assign=assign_1,own$3=hasOwnProperty$3,normalizeIdentifier=normalizeIdentifier_1,safeFromInt=safeFromInt_1,parser=parse_1,preprocessor=preprocess_1,postprocess=postprocess_1,decode=decodeEntity_browser,stringifyPosition=unistUtilStringifyPosition;function fromMarkdown$1(K,_,Z){return typeof _!="string"&&(Z=_,_=void 0),compiler(Z)(postprocess(parser(Z).document().write(preprocessor()(K,_,!0))))}function compiler(K){var _=K||{},Z=configure({transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:le(st),autolinkProtocol:ke,autolinkEmail:ke,atxHeading:le(Mt),blockQuote:le(zt),characterEscape:ke,characterReference:ke,codeFenced:le(yt),codeFencedFenceInfo:ce,codeFencedFenceMeta:ce,codeIndented:le(yt,ce),codeText:le(Ut,ce),codeTextData:ke,data:ke,codeFlowValue:ke,definition:le(bt),definitionDestinationString:ce,definitionLabelString:ce,definitionTitleString:ce,emphasis:le(Ot),hardBreakEscape:le(_t),hardBreakTrailing:le(_t),htmlFlow:le(pt,ce),htmlFlowData:ke,htmlText:le(pt,ce),htmlTextData:ke,image:le(ft),label:ce,link:le(st),listItem:le(Pt),listItemValue:me,listOrdered:le(vt,ge),listUnordered:le(vt),paragraph:le(Lt),reference:it,referenceString:ce,resourceDestinationString:ce,resourceTitleString:ce,setextHeading:le(Mt),strong:le(Vt),thematicBreak:le(De)},exit:{atxHeading:de(),atxHeadingSequence:Pe,autolink:de(),autolinkEmail:Nt,autolinkProtocol:Et,blockQuote:de(),characterEscapeValue:Ge,characterReferenceMarkerHexadecimal:Tt,characterReferenceMarkerNumeric:Tt,characterReferenceValue:St,codeFenced:de(_e),codeFencedFence:ve,codeFencedFenceInfo:Ae,codeFencedFenceMeta:ye,codeFlowValue:Ge,codeIndented:de(Te),codeText:de(Je),codeTextData:Ge,data:Ge,definition:de(),definitionDestinationString:we,definitionLabelString:be,definitionTitleString:Re,emphasis:de(),hardBreakEscape:de(ze),hardBreakTrailing:de(ze),htmlFlow:de(Ke),htmlFlowData:Ge,htmlText:de(tt),htmlTextData:Ge,image:de(Fe),label:ht,labelText:ct,lineEnding:He,link:de(ot),listItem:de(),listOrdered:de(),listUnordered:de(),paragraph:de(),referenceString:nt,resourceDestinationString:lt,resourceTitleString:Qe,resource:Ze,setextHeading:de(Ue),setextHeadingLineSequence:$e,setextHeadingText:Ie,strong:de(),thematicBreak:de()}},_.mdastExtensions||[]),te={};return ne;function ne(Be){for(var rt={type:"root",children:[]},at=[rt],xt=[],Ct=[],Qt=-1,qt,It,Gt={stack:at,tokenStack:xt,config:Z,enter:fe,exit:pe,buffer:ce,resume:he,setData:oe,getData:se};++Qt<Be.length;)(Be[Qt][1].type==="listOrdered"||Be[Qt][1].type==="listUnordered")&&(Be[Qt][0]==="enter"?Ct.push(Qt):(It=Ct.pop(Qt),Qt=ie(Be,It,Qt)));for(Qt=-1;++Qt<Be.length;)qt=Z[Be[Qt][0]],own$3.call(qt,Be[Qt][1].type)&&qt[Be[Qt][1].type].call(assign({sliceSerialize:Be[Qt][2].sliceSerialize},Gt),Be[Qt][1]);if(xt.length)throw new Error("Cannot close document, a token (`"+xt[xt.length-1].type+"`, "+stringifyPosition({start:xt[xt.length-1].start,end:xt[xt.length-1].end})+") is still open");for(rt.position={start:ae(Be.length?Be[0][1].start:{line:1,column:1,offset:0}),end:ae(Be.length?Be[Be.length-2][1].end:{line:1,column:1,offset:0})},Qt=-1;++Qt<Z.transforms.length;)rt=Z.transforms[Qt](rt)||rt;return rt}function ie(Be,rt,at){for(var xt=rt-1,Ct=-1,Qt=!1,qt,It,Gt,Jt,kt,Ht,Yt;++xt<=at;)if(kt=Be[xt],kt[1].type==="listUnordered"||kt[1].type==="listOrdered"||kt[1].type==="blockQuote"?(kt[0]==="enter"?Ct++:Ct--,Yt=void 0):kt[1].type==="lineEndingBlank"?kt[0]==="enter"&&(qt&&!Yt&&!Ct&&!Ht&&(Ht=xt),Yt=void 0):kt[1].type==="linePrefix"||kt[1].type==="listItemValue"||kt[1].type==="listItemMarker"||kt[1].type==="listItemPrefix"||kt[1].type==="listItemPrefixWhitespace"||(Yt=void 0),!Ct&&kt[0]==="enter"&&kt[1].type==="listItemPrefix"||Ct===-1&&kt[0]==="exit"&&(kt[1].type==="listUnordered"||kt[1].type==="listOrdered")){if(qt){for(It=xt,Gt=void 0;It--;)if(Jt=Be[It],Jt[1].type==="lineEnding"||Jt[1].type==="lineEndingBlank"){if(Jt[0]==="exit")continue;Gt&&(Be[Gt][1].type="lineEndingBlank",Qt=!0),Jt[1].type="lineEnding",Gt=It}else if(!(Jt[1].type==="linePrefix"||Jt[1].type==="blockQuotePrefix"||Jt[1].type==="blockQuotePrefixWhitespace"||Jt[1].type==="blockQuoteMarker"||Jt[1].type==="listItemIndent"))break;Ht&&(!Gt||Ht<Gt)&&(qt._spread=!0),qt.end=ae(Gt?Be[Gt][1].start:kt[1].end),Be.splice(Gt||xt,0,["exit",qt,kt[2]]),xt++,at++}kt[1].type==="listItemPrefix"&&(qt={type:"listItem",_spread:!1,start:ae(kt[1].start)},Be.splice(xt,0,["enter",qt,kt[2]]),xt++,at++,Ht=void 0,Yt=!0)}return Be[rt][1]._spread=Qt,at}function oe(Be,rt){te[Be]=rt}function se(Be){return te[Be]}function ae(Be){return{line:Be.line,column:Be.column,offset:Be.offset}}function le(Be,rt){return at;function at(xt){fe.call(this,Be(xt),xt),rt&&rt.call(this,xt)}}function ce(){this.stack.push({type:"fragment",children:[]})}function fe(Be,rt){return this.stack[this.stack.length-1].children.push(Be),this.stack.push(Be),this.tokenStack.push(rt),Be.position={start:ae(rt.start)},Be}function de(Be){return rt;function rt(at){Be&&Be.call(this,at),pe.call(this,at)}}function pe(Be){var rt=this.stack.pop(),at=this.tokenStack.pop();if(at){if(at.type!==Be.type)throw new Error("Cannot close `"+Be.type+"` ("+stringifyPosition({start:Be.start,end:Be.end})+"): a different token (`"+at.type+"`, "+stringifyPosition({start:at.start,end:at.end})+") is open")}else throw new Error("Cannot close `"+Be.type+"` ("+stringifyPosition({start:Be.start,end:Be.end})+"): it’s not open");return rt.position.end=ae(Be.end),rt}function he(){return toString(this.stack.pop())}function ge(){oe("expectingFirstListItemValue",!0)}function me(Be){se("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(Be),10),oe("expectingFirstListItemValue"))}function Ae(){var Be=this.resume();this.stack[this.stack.length-1].lang=Be}function ye(){var Be=this.resume();this.stack[this.stack.length-1].meta=Be}function ve(){se("flowCodeInside")||(this.buffer(),oe("flowCodeInside",!0))}function _e(){var Be=this.resume();this.stack[this.stack.length-1].value=Be.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),oe("flowCodeInside")}function Te(){var Be=this.resume();this.stack[this.stack.length-1].value=Be}function be(Be){var rt=this.resume();this.stack[this.stack.length-1].label=rt,this.stack[this.stack.length-1].identifier=normalizeIdentifier(this.sliceSerialize(Be)).toLowerCase()}function Re(){var Be=this.resume();this.stack[this.stack.length-1].title=Be}function we(){var Be=this.resume();this.stack[this.stack.length-1].url=Be}function Pe(Be){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(Be).length)}function Ie(){oe("setextHeadingSlurpLineEnding",!0)}function $e(Be){this.stack[this.stack.length-1].depth=this.sliceSerialize(Be).charCodeAt(0)===61?1:2}function Ue(){oe("setextHeadingSlurpLineEnding")}function ke(Be){var rt=this.stack[this.stack.length-1].children,at=rt[rt.length-1];(!at||at.type!=="text")&&(at=Le(),at.position={start:ae(Be.start)},this.stack[this.stack.length-1].children.push(at)),this.stack.push(at)}function Ge(Be){var rt=this.stack.pop();rt.value+=this.sliceSerialize(Be),rt.position.end=ae(Be.end)}function He(Be){var rt=this.stack[this.stack.length-1];if(se("atHardBreak")){rt.children[rt.children.length-1].position.end=ae(Be.end),oe("atHardBreak");return}!se("setextHeadingSlurpLineEnding")&&Z.canContainEols.indexOf(rt.type)>-1&&(ke.call(this,Be),Ge.call(this,Be))}function ze(){oe("atHardBreak",!0)}function Ke(){var Be=this.resume();this.stack[this.stack.length-1].value=Be}function tt(){var Be=this.resume();this.stack[this.stack.length-1].value=Be}function Je(){var Be=this.resume();this.stack[this.stack.length-1].value=Be}function ot(){var Be=this.stack[this.stack.length-1];se("inReference")?(Be.type+="Reference",Be.referenceType=se("referenceType")||"shortcut",delete Be.url,delete Be.title):(delete Be.identifier,delete Be.label,delete Be.referenceType),oe("referenceType")}function Fe(){var Be=this.stack[this.stack.length-1];se("inReference")?(Be.type+="Reference",Be.referenceType=se("referenceType")||"shortcut",delete Be.url,delete Be.title):(delete Be.identifier,delete Be.label,delete Be.referenceType),oe("referenceType")}function ct(Be){this.stack[this.stack.length-2].identifier=normalizeIdentifier(this.sliceSerialize(Be)).toLowerCase()}function ht(){var Be=this.stack[this.stack.length-1],rt=this.resume();this.stack[this.stack.length-1].label=rt,oe("inReference",!0),this.stack[this.stack.length-1].type==="link"?this.stack[this.stack.length-1].children=Be.children:this.stack[this.stack.length-1].alt=rt}function lt(){var Be=this.resume();this.stack[this.stack.length-1].url=Be}function Qe(){var Be=this.resume();this.stack[this.stack.length-1].title=Be}function Ze(){oe("inReference")}function it(){oe("referenceType","collapsed")}function nt(Be){var rt=this.resume();this.stack[this.stack.length-1].label=rt,this.stack[this.stack.length-1].identifier=normalizeIdentifier(this.sliceSerialize(Be)).toLowerCase(),oe("referenceType","full")}function Tt(Be){oe("characterReferenceType",Be.type)}function St(Be){var rt=this.sliceSerialize(Be),at=se("characterReferenceType"),xt,Ct;at?(xt=safeFromInt(rt,at==="characterReferenceMarkerNumeric"?10:16),oe("characterReferenceType")):xt=decode(rt),Ct=this.stack.pop(),Ct.value+=xt,Ct.position.end=ae(Be.end)}function Et(Be){Ge.call(this,Be),this.stack[this.stack.length-1].url=this.sliceSerialize(Be)}function Nt(Be){Ge.call(this,Be),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(Be)}function zt(){return{type:"blockquote",children:[]}}function yt(){return{type:"code",lang:null,meta:null,value:""}}function Ut(){return{type:"inlineCode",value:""}}function bt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ot(){return{type:"emphasis",children:[]}}function Mt(){return{type:"heading",depth:void 0,children:[]}}function _t(){return{type:"break"}}function pt(){return{type:"html",value:""}}function ft(){return{type:"image",title:null,url:"",alt:null}}function st(){return{type:"link",title:null,url:"",children:[]}}function vt(Be){return{type:"list",ordered:Be.type==="listOrdered",start:null,spread:Be._spread,children:[]}}function Pt(Be){return{type:"listItem",spread:Be._spread,checked:null,children:[]}}function Lt(){return{type:"paragraph",children:[]}}function Vt(){return{type:"strong",children:[]}}function Le(){return{type:"text",value:""}}function De(){return{type:"thematicBreak"}}}function configure(K,_){for(var Z=-1;++Z<_.length;)extension(K,_[Z]);return K}function extension(K,_){var Z,te;for(Z in _)te=own$3.call(K,Z)?K[Z]:K[Z]={},Z==="canContainEols"||Z==="transforms"?K[Z]=[].concat(te,_[Z]):Object.assign(te,_[Z])}var mdastUtilFromMarkdown=dist,remarkParse=parse$3,fromMarkdown=mdastUtilFromMarkdown;function parse$3(K){var _=this;this.Parser=Z;function Z(te){return fromMarkdown(te,Object.assign({},_.data("settings"),K,{extensions:_.data("micromarkExtensions")||[],mdastExtensions:_.data("fromMarkdownExtensions")||[]}))}}const remarkParse$1=getDefaultExportFromCjs(remarkParse);var unistBuilder=u$b;function u$b(K,_,Z){var te;return Z==null&&(typeof _!="object"||Array.isArray(_))&&(Z=_,_={}),te=Object.assign({type:String(K)},_),Array.isArray(Z)?te.children=Z:Z!=null&&(te.value=String(Z)),te}var convert_1$1=convert$5;function convert$5(K){if(K==null)return ok$1;if(typeof K=="string")return typeFactory$1(K);if(typeof K=="object")return"length"in K?anyFactory$1(K):allFactory(K);if(typeof K=="function")return K;throw new Error("Expected function, string, or object as test")}function allFactory(K){return _;function _(Z){var te;for(te in K)if(Z[te]!==K[te])return!1;return!0}}function anyFactory$1(K){for(var _=[],Z=-1;++Z<K.length;)_[Z]=convert$5(K[Z]);return te;function te(){for(var ne=-1;++ne<_.length;)if(_[ne].apply(this,arguments))return!0;return!1}}function typeFactory$1(K){return _;function _(Z){return!!(Z&&Z.type===K)}}function ok$1(){return!0}var color_browser$1=identity$1;function identity$1(K){return K}var unistUtilVisitParents$2=visitParents$5,convert$4=convert_1$1,color$1=color_browser$1,CONTINUE$5=!0,SKIP$5="skip",EXIT$5=!1;visitParents$5.CONTINUE=CONTINUE$5;visitParents$5.SKIP=SKIP$5;visitParents$5.EXIT=EXIT$5;function visitParents$5(K,_,Z,te){var ne,ie;typeof _=="function"&&typeof Z!="function"&&(te=Z,Z=_,_=null),ie=convert$4(_),ne=te?-1:1,oe(K,null,[])();function oe(se,ae,le){var ce=typeof se=="object"&&se!==null?se:{},fe;return typeof ce.type=="string"&&(fe=typeof ce.tagName=="string"?ce.tagName:typeof ce.name=="string"?ce.name:void 0,de.displayName="node ("+color$1(ce.type+(fe?"<"+fe+">":""))+")"),de;function de(){var pe=le.concat(se),he=[],ge,me;if((!_||ie(se,ae,le[le.length-1]||null))&&(he=toResult$2(Z(se,le)),he[0]===EXIT$5))return he;if(se.children&&he[0]!==SKIP$5)for(me=(te?se.children.length:-1)+ne;me>-1&&me<se.children.length;){if(ge=oe(se.children[me],me,pe)(),ge[0]===EXIT$5)return ge;me=typeof ge[1]=="number"?ge[1]:me+ne}return he}}}function toResult$2(K){return K!==null&&typeof K=="object"&&"length"in K?K:typeof K=="number"?[CONTINUE$5,K]:[K]}var unistUtilVisit$2=visit$5,visitParents$4=unistUtilVisitParents$2,CONTINUE$4=visitParents$4.CONTINUE,SKIP$4=visitParents$4.SKIP,EXIT$4=visitParents$4.EXIT;visit$5.CONTINUE=CONTINUE$4;visit$5.SKIP=SKIP$4;visit$5.EXIT=EXIT$4;function visit$5(K,_,Z,te){typeof _=="function"&&typeof Z!="function"&&(te=Z,Z=_,_=null),visitParents$4(K,_,ne,te);function ne(ie,oe){var se=oe[oe.length-1],ae=se?se.children.indexOf(ie):null;return Z(ie,ae,se)}}var start=factory$1("start"),end=factory$1("end"),unistUtilPosition=position$2;position$2.start=start;position$2.end=end;function position$2(K){return{start:start(K),end:end(K)}}function factory$1(K){return _.displayName=K,_;function _(Z){var te=Z&&Z.position&&Z.position[K]||{};return{line:te.line||null,column:te.column||null,offset:isNaN(te.offset)?null:te.offset}}}var unistUtilGenerated=generated$1;function generated$1(K){return!K||!K.position||!K.position.start||!K.position.start.line||!K.position.start.column||!K.position.end||!K.position.end.line||!K.position.end.column}var color_browser=identity;function identity(K){return K}var unistUtilVisitParents$1=visitParents$3,convert$3=convert_1$1,color=color_browser,CONTINUE$3=!0,SKIP$3="skip",EXIT$3=!1;visitParents$3.CONTINUE=CONTINUE$3;visitParents$3.SKIP=SKIP$3;visitParents$3.EXIT=EXIT$3;function visitParents$3(K,_,Z,te){var ne,ie;typeof _=="function"&&typeof Z!="function"&&(te=Z,Z=_,_=null),ie=convert$3(_),ne=te?-1:1,oe(K,null,[])();function oe(se,ae,le){var ce=typeof se=="object"&&se!==null?se:{},fe;return typeof ce.type=="string"&&(fe=typeof ce.tagName=="string"?ce.tagName:typeof ce.name=="string"?ce.name:void 0,de.displayName="node ("+color(ce.type+(fe?"<"+fe+">":""))+")"),de;function de(){var pe=le.concat(se),he=[],ge,me;if((!_||ie(se,ae,le[le.length-1]||null))&&(he=toResult$1(Z(se,le)),he[0]===EXIT$3))return he;if(se.children&&he[0]!==SKIP$3)for(me=(te?se.children.length:-1)+ne;me>-1&&me<se.children.length;){if(ge=oe(se.children[me],me,pe)(),ge[0]===EXIT$3)return ge;me=typeof ge[1]=="number"?ge[1]:me+ne}return he}}}function toResult$1(K){return K!==null&&typeof K=="object"&&"length"in K?K:typeof K=="number"?[CONTINUE$3,K]:[K]}var unistUtilVisit$1=visit$4,visitParents$2=unistUtilVisitParents$1,CONTINUE$2=visitParents$2.CONTINUE,SKIP$2=visitParents$2.SKIP,EXIT$2=visitParents$2.EXIT;visit$4.CONTINUE=CONTINUE$2;visit$4.SKIP=SKIP$2;visit$4.EXIT=EXIT$2;function visit$4(K,_,Z,te){typeof _=="function"&&typeof Z!="function"&&(te=Z,Z=_,_=null),visitParents$2(K,_,ne,te);function ne(ie,oe){var se=oe[oe.length-1],ae=se?se.children.indexOf(ie):null;return Z(ie,ae,se)}}var visit$3=unistUtilVisit$1,mdastUtilDefinitions=getDefinitionFactory,own$2={}.hasOwnProperty;function getDefinitionFactory(K,_){return getterFactory(gather(K))}function gather(K){var _={};if(!K||!K.type)throw new Error("mdast-util-definitions expected node");return visit$3(K,"definition",Z),_;function Z(te){var ne=normalise(te.identifier);own$2.call(_,ne)||(_[ne]=te)}}function getterFactory(K){return _;function _(Z){var te=Z&&normalise(Z);return te&&own$2.call(K,te)?K[te]:null}}function normalise(K){return K.toUpperCase()}var all_1,hasRequiredAll;function requireAll(){if(hasRequiredAll)return all_1;hasRequiredAll=1,all_1=_;var K=requireOne();function _(Z,te){for(var ne=te.children||[],ie=ne.length,oe=[],se=-1,ae,le;++se<ie;)ae=K(Z,ne[se],te),ae&&(se&&ne[se-1].type==="break"&&(ae.value&&(ae.value=ae.value.replace(/^\s+/,"")),le=ae.children&&ae.children[0],le&&le.value&&(le.value=le.value.replace(/^\s+/,""))),oe=oe.concat(ae));return oe}return all_1}var one_1,hasRequiredOne;function requireOne(){if(hasRequiredOne)return one_1;hasRequiredOne=1,one_1=ne;var K=unistBuilder,_=requireAll(),Z={}.hasOwnProperty;function te(se,ae){return ie(ae)?se.augment(ae,K("text",ae.value)):se(ae,"div",_(se,ae))}function ne(se,ae,le){var ce=ae&&ae.type,fe;if(!ce)throw new Error("Expected node, got `"+ae+"`");return Z.call(se.handlers,ce)?fe=se.handlers[ce]:se.passThrough&&se.passThrough.indexOf(ce)>-1?fe=oe:fe=se.unknownHandler,(typeof fe=="function"?fe:te)(se,ae,le)}function ie(se){var ae=se.data||{};return Z.call(ae,"hName")||Z.call(ae,"hProperties")||Z.call(ae,"hChildren")?!1:"value"in se}function oe(se,ae){var le;return ae.children?(le=Object.assign({},ae),le.children=_(se,ae),le):ae}return one_1}var thematicBreak_1=thematicBreak$1;function thematicBreak$1(K,_){return K(_,"hr")}var wrap_1=wrap$5,u$a=unistBuilder;function wrap$5(K,_){var Z=[],te=-1,ne=K.length;for(_&&Z.push(u$a("text",`
`));++te<ne;)te&&Z.push(u$a("text",`
`)),Z.push(K[te]);return _&&K.length>0&&Z.push(u$a("text",`
`)),Z}var list_1=list$1,wrap$4=wrap_1,all$c=requireAll();function list$1(K,_){var Z={},te=_.ordered?"ol":"ul",ne,ie=-1,oe;for(typeof _.start=="number"&&_.start!==1&&(Z.start=_.start),ne=all$c(K,_),oe=ne.length;++ie<oe;)if(ne[ie].properties.className&&ne[ie].properties.className.indexOf("task-list-item")!==-1){Z.className=["contains-task-list"];break}return K(_,te,Z,wrap$4(ne,!0))}var footer$1=generateFootnotes,thematicBreak=thematicBreak_1,list=list_1,wrap$3=wrap_1;function generateFootnotes(K){for(var _=K.footnoteById,Z=K.footnoteOrder,te=Z.length,ne=-1,ie=[],oe,se,ae,le;++ne<te;)oe=_[Z[ne].toUpperCase()],oe&&(ae=oe.children.concat(),le=ae[ae.length-1],se={type:"link",url:"#fnref-"+oe.identifier,data:{hProperties:{className:["footnote-backref"]}},children:[{type:"text",value:"↩"}]},(!le||le.type!=="paragraph")&&(le={type:"paragraph",children:[]},ae.push(le)),le.children.push(se),ie.push({type:"listItem",data:{hProperties:{id:"fn-"+oe.identifier}},children:ae,position:oe.position}));return ie.length===0?null:K(null,"div",{className:["footnotes"]},wrap$3([thematicBreak(K),list(K,{type:"list",ordered:!0,children:ie})],!0))}var blockquote_1=blockquote,wrap$2=wrap_1,all$b=requireAll();function blockquote(K,_){return K(_,"blockquote",wrap$2(all$b(K,_),!0))}var _break=hardBreak,u$9=unistBuilder;function hardBreak(K,_){return[K(_,"br"),u$9("text",`
`)]}var code_1=code,u$8=unistBuilder;function code(K,_){var Z=_.value?_.value+`
`:"",te=_.lang&&_.lang.match(/^[^ \t]+(?=[ \t]|$)/),ne={},ie;return te&&(ne.className=["language-"+te]),ie=K(_,"code",ne,[u$8("text",Z)]),_.meta&&(ie.data={meta:_.meta}),K(_.position,"pre",[ie])}var _delete=strikethrough,all$a=requireAll();function strikethrough(K,_){return K(_,"del",all$a(K,_))}var emphasis_1=emphasis,all$9=requireAll();function emphasis(K,_){return K(_,"em",all$9(K,_))}var footnoteReference_1=footnoteReference$1,u$7=unistBuilder;function footnoteReference$1(K,_){var Z=K.footnoteOrder,te=String(_.identifier);return Z.indexOf(te)===-1&&Z.push(te),K(_.position,"sup",{id:"fnref-"+te},[K(_,"a",{href:"#fn-"+te,className:["footnote-ref"]},[u$7("text",_.label||te)])])}var footnote_1=footnote,footnoteReference=footnoteReference_1;function footnote(K,_){for(var Z=K.footnoteById,te=K.footnoteOrder,ne=1;ne in Z;)ne++;return ne=String(ne),te.push(ne),Z[ne]={type:"footnoteDefinition",identifier:ne,children:[{type:"paragraph",children:_.children}],position:_.position},footnoteReference(K,{type:"footnoteReference",identifier:ne,position:_.position})}var heading_1=heading,all$8=requireAll();function heading(K,_){return K(_,"h"+_.depth,all$8(K,_))}var html_1$1=html$4,u$6=unistBuilder;function html$4(K,_){return K.dangerous?K.augment(_,u$6("raw",_.value)):null}var encodeCache={};function getEncodeCache(K){var _,Z,te=encodeCache[K];if(te)return te;for(te=encodeCache[K]=[],_=0;_<128;_++)Z=String.fromCharCode(_),/^[0-9a-z]$/i.test(Z)?te.push(Z):te.push("%"+("0"+_.toString(16).toUpperCase()).slice(-2));for(_=0;_<K.length;_++)te[K.charCodeAt(_)]=K[_];return te}function encode(K,_,Z){var te,ne,ie,oe,se,ae="";for(typeof _!="string"&&(Z=_,_=encode.defaultChars),typeof Z>"u"&&(Z=!0),se=getEncodeCache(_),te=0,ne=K.length;te<ne;te++){if(ie=K.charCodeAt(te),Z&&ie===37&&te+2<ne&&/^[0-9a-f]{2}$/i.test(K.slice(te+1,te+3))){ae+=K.slice(te,te+3),te+=2;continue}if(ie<128){ae+=se[ie];continue}if(ie>=55296&&ie<=57343){if(ie>=55296&&ie<=56319&&te+1<ne&&(oe=K.charCodeAt(te+1),oe>=56320&&oe<=57343)){ae+=encodeURIComponent(K[te]+K[te+1]),te++;continue}ae+="%EF%BF%BD";continue}ae+=encodeURIComponent(K[te])}return ae}encode.defaultChars=";/?:@&=+$,-_.!~*'()#";encode.componentChars="-_.!~*'()";var encode_1=encode,revert_1=revert$2,u$5=unistBuilder,all$7=requireAll();function revert$2(K,_){var Z=_.referenceType,te="]",ne,ie,oe;return Z==="collapsed"?te+="[]":Z==="full"&&(te+="["+(_.label||_.identifier)+"]"),_.type==="imageReference"?u$5("text","!["+_.alt+te):(ne=all$7(K,_),ie=ne[0],ie&&ie.type==="text"?ie.value="["+ie.value:ne.unshift(u$5("text","[")),oe=ne[ne.length-1],oe&&oe.type==="text"?oe.value+=te:ne.push(u$5("text",te)),ne)}var imageReference_1=imageReference,normalize$6=encode_1,revert$1=revert_1;function imageReference(K,_){var Z=K.definition(_.identifier),te;return Z?(te={src:normalize$6(Z.url||""),alt:_.alt},Z.title!==null&&Z.title!==void 0&&(te.title=Z.title),K(_,"img",te)):revert$1(K,_)}var normalize$5=encode_1,image_1=image;function image(K,_){var Z={src:normalize$5(_.url),alt:_.alt};return _.title!==null&&_.title!==void 0&&(Z.title=_.title),K(_,"img",Z)}var inlineCode_1=inlineCode,u$4=unistBuilder;function inlineCode(K,_){var Z=_.value.replace(/\r?\n|\r/g," ");return K(_,"code",[u$4("text",Z)])}var linkReference_1=linkReference,normalize$4=encode_1,revert=revert_1,all$6=requireAll();function linkReference(K,_){var Z=K.definition(_.identifier),te;return Z?(te={href:normalize$4(Z.url||"")},Z.title!==null&&Z.title!==void 0&&(te.title=Z.title),K(_,"a",te,all$6(K,_))):revert(K,_)}var normalize$3=encode_1,all$5=requireAll(),link_1=link;function link(K,_){var Z={href:normalize$3(_.url)};return _.title!==null&&_.title!==void 0&&(Z.title=_.title),K(_,"a",Z,all$5(K,_))}var listItem_1=listItem,u$3=unistBuilder,all$4=requireAll();function listItem(K,_,Z){var te=all$4(K,_),ne=te[0],ie=Z?listLoose(Z):listItemLoose(_),oe={},se=[],ae,le,ce;for(typeof _.checked=="boolean"&&((!ne||ne.tagName!=="p")&&(ne=K(null,"p",[]),te.unshift(ne)),ne.children.length>0&&ne.children.unshift(u$3("text"," ")),ne.children.unshift(K(null,"input",{type:"checkbox",checked:_.checked,disabled:!0})),oe.className=["task-list-item"]),ae=te.length,le=-1;++le<ae;)ce=te[le],(ie||le!==0||ce.tagName!=="p")&&se.push(u$3("text",`
`)),ce.tagName==="p"&&!ie?se=se.concat(ce.children):se.push(ce);return ae&&(ie||ce.tagName!=="p")&&se.push(u$3("text",`
`)),K(_,"li",oe,se)}function listLoose(K){for(var _=K.spread,Z=K.children,te=Z.length,ne=-1;!_&&++ne<te;)_=listItemLoose(Z[ne]);return _}function listItemLoose(K){var _=K.spread;return _??K.children.length>1}var paragraph_1=paragraph,all$3=requireAll();function paragraph(K,_){return K(_,"p",all$3(K,_))}var root_1=root$1,u$2=unistBuilder,wrap$1=wrap_1,all$2=requireAll();function root$1(K,_){return K.augment(_,u$2("root",wrap$1(all$2(K,_))))}var strong_1=strong,all$1=requireAll();function strong(K,_){return K(_,"strong",all$1(K,_))}var table_1=table,position$1=unistUtilPosition,wrap=wrap_1,all=requireAll();function table(K,_){for(var Z=_.children,te=Z.length,ne=_.align||[],ie=ne.length,oe=[],se,ae,le,ce,fe;te--;){for(ae=Z[te].children,ce=te===0?"th":"td",se=ie||ae.length,le=[];se--;)fe=ae[se],le[se]=K(fe,ce,{align:ne[se]},fe?all(K,fe):[]);oe[te]=K(Z[te],"tr",wrap(le,!0))}return K(_,"table",wrap([K(oe[0].position,"thead",wrap([oe[0]],!0))].concat(oe[1]?K({start:position$1.start(oe[1]),end:position$1.end(oe[oe.length-1])},"tbody",wrap(oe.slice(1),!0)):[]),!0))}var text_1=text$1,u$1=unistBuilder;function text$1(K,_){return K.augment(_,u$1("text",String(_.value).replace(/[ \t]*(\r?\n|\r)[ \t]*/g,"$1")))}var handlers$1={blockquote:blockquote_1,break:_break,code:code_1,delete:_delete,emphasis:emphasis_1,footnoteReference:footnoteReference_1,footnote:footnote_1,heading:heading_1,html:html_1$1,imageReference:imageReference_1,image:image_1,inlineCode:inlineCode_1,linkReference:linkReference_1,link:link_1,listItem:listItem_1,list:list_1,paragraph:paragraph_1,root:root_1,strong:strong_1,table:table_1,text:text_1,thematicBreak:thematicBreak_1,toml:ignore,yaml:ignore,definition:ignore,footnoteDefinition:ignore};function ignore(){return null}var lib=toHast,u=unistBuilder,visit$2=unistUtilVisit$2,position=unistUtilPosition,generated=unistUtilGenerated,definitions=mdastUtilDefinitions,one=requireOne(),footer=footer$1,handlers=handlers$1,own$1={}.hasOwnProperty,deprecationWarningIssued=!1;function factory(K,_){var Z=_||{};Z.allowDangerousHTML!==void 0&&!deprecationWarningIssued&&(deprecationWarningIssued=!0,console.warn("mdast-util-to-hast: deprecation: `allowDangerousHTML` is nonstandard, use `allowDangerousHtml` instead"));var te=Z.allowDangerousHtml||Z.allowDangerousHTML,ne={};return oe.dangerous=te,oe.definition=definitions(K),oe.footnoteById=ne,oe.footnoteOrder=[],oe.augment=ie,oe.handlers=Object.assign({},handlers,Z.handlers),oe.unknownHandler=Z.unknownHandler,oe.passThrough=Z.passThrough,visit$2(K,"footnoteDefinition",se),oe;function ie(ae,le){var ce,fe;return ae&&ae.data&&(ce=ae.data,ce.hName&&(le.type!=="element"&&(le={type:"element",tagName:"",properties:{},children:[]}),le.tagName=ce.hName),le.type==="element"&&ce.hProperties&&(le.properties=Object.assign({},le.properties,ce.hProperties)),le.children&&ce.hChildren&&(le.children=ce.hChildren)),fe=ae&&ae.position?ae:{position:ae},generated(fe)||(le.position={start:position.start(fe),end:position.end(fe)}),le}function oe(ae,le,ce,fe){return fe==null&&typeof ce=="object"&&"length"in ce&&(fe=ce,ce={}),ie(ae,{type:"element",tagName:le,properties:ce||{},children:fe||[]})}function se(ae){var le=String(ae.identifier).toUpperCase();own$1.call(ne,le)||(ne[le]=ae)}}function toHast(K,_){var Z=factory(K,_),te=one(Z,K),ne=footer(Z);return ne&&(te.children=te.children.concat(u("text",`
`),ne)),te}var mdastUtilToHast=lib,mdast2hast=mdastUtilToHast,remarkRehype=remark2rehype;function remark2rehype(K,_){return K&&!K.process&&(_=K,K=null),K?bridge(K,_):mutate(_)}function bridge(K,_){return Z;function Z(te,ne,ie){K.run(mdast2hast(te,_),ne,oe);function oe(se){ie(se)}}}function mutate(K){return _;function _(Z){return mdast2hast(Z,K)}}const remarkToRehype=getDefaultExportFromCjs(remarkRehype);var immutable=extend,hasOwnProperty$1=Object.prototype.hasOwnProperty;function extend(){for(var K={},_=0;_<arguments.length;_++){var Z=arguments[_];for(var te in Z)hasOwnProperty$1.call(Z,te)&&(K[te]=Z[te])}return K}var schema=Schema$2,proto$1=Schema$2.prototype;proto$1.space=null;proto$1.normal={};proto$1.property={};function Schema$2(K,_,Z){this.property=K,this.normal=_,Z&&(this.space=Z)}var xtend=immutable,Schema$1=schema,merge_1=merge$2;function merge$2(K){for(var _=K.length,Z=[],te=[],ne=-1,ie,oe;++ne<_;)ie=K[ne],Z.push(ie.property),te.push(ie.normal),oe=ie.space;return new Schema$1(xtend.apply(null,Z),xtend.apply(null,te),oe)}var normalize_1=normalize$2;function normalize$2(K){return K.toLowerCase()}var info=Info$2,proto=Info$2.prototype;proto.space=null;proto.attribute=null;proto.property=null;proto.boolean=!1;proto.booleanish=!1;proto.overloadedBoolean=!1;proto.number=!1;proto.commaSeparated=!1;proto.spaceSeparated=!1;proto.commaOrSpaceSeparated=!1;proto.mustUseProperty=!1;proto.defined=!1;function Info$2(K,_){this.property=K,this.attribute=_}var types$4={},powers=0;types$4.boolean=increment();types$4.booleanish=increment();types$4.overloadedBoolean=increment();types$4.number=increment();types$4.spaceSeparated=increment();types$4.commaSeparated=increment();types$4.commaOrSpaceSeparated=increment();function increment(){return Math.pow(2,++powers)}var Info$1=info,types$3=types$4,definedInfo=DefinedInfo$2;DefinedInfo$2.prototype=new Info$1;DefinedInfo$2.prototype.defined=!0;var checks=["boolean","booleanish","overloadedBoolean","number","commaSeparated","spaceSeparated","commaOrSpaceSeparated"],checksLength=checks.length;function DefinedInfo$2(K,_,Z,te){var ne=-1,ie;for(mark(this,"space",te),Info$1.call(this,K,_);++ne<checksLength;)ie=checks[ne],mark(this,ie,(Z&types$3[ie])===types$3[ie])}function mark(K,_,Z){Z&&(K[_]=Z)}var normalize$1=normalize_1,Schema=schema,DefinedInfo$1=definedInfo,create_1=create$6;function create$6(K){var _=K.space,Z=K.mustUseProperty||[],te=K.attributes||{},ne=K.properties,ie=K.transform,oe={},se={},ae,le;for(ae in ne)le=new DefinedInfo$1(ae,ie(te,ae),ne[ae],_),Z.indexOf(ae)!==-1&&(le.mustUseProperty=!0),oe[ae]=le,se[normalize$1(ae)]=ae,se[normalize$1(le.attribute)]=ae;return new Schema(oe,se,_)}var create$5=create_1,xlink$3=create$5({space:"xlink",transform:xlinkTransform,properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}});function xlinkTransform(K,_){return"xlink:"+_.slice(5).toLowerCase()}var create$4=create_1,xml$3=create$4({space:"xml",transform:xmlTransform,properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function xmlTransform(K,_){return"xml:"+_.slice(3).toLowerCase()}var caseSensitiveTransform_1=caseSensitiveTransform$2;function caseSensitiveTransform$2(K,_){return _ in K?K[_]:_}var caseSensitiveTransform$1=caseSensitiveTransform_1,caseInsensitiveTransform_1=caseInsensitiveTransform$2;function caseInsensitiveTransform$2(K,_){return caseSensitiveTransform$1(K,_.toLowerCase())}var create$3=create_1,caseInsensitiveTransform$1=caseInsensitiveTransform_1,xmlns$3=create$3({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:caseInsensitiveTransform$1,properties:{xmlns:null,xmlnsXLink:null}}),types$2=types$4,create$2=create_1,booleanish$1=types$2.booleanish,number$2=types$2.number,spaceSeparated$2=types$2.spaceSeparated,aria$2=create$2({transform:ariaTransform,properties:{ariaActiveDescendant:null,ariaAtomic:booleanish$1,ariaAutoComplete:null,ariaBusy:booleanish$1,ariaChecked:booleanish$1,ariaColCount:number$2,ariaColIndex:number$2,ariaColSpan:number$2,ariaControls:spaceSeparated$2,ariaCurrent:null,ariaDescribedBy:spaceSeparated$2,ariaDetails:null,ariaDisabled:booleanish$1,ariaDropEffect:spaceSeparated$2,ariaErrorMessage:null,ariaExpanded:booleanish$1,ariaFlowTo:spaceSeparated$2,ariaGrabbed:booleanish$1,ariaHasPopup:null,ariaHidden:booleanish$1,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated$2,ariaLevel:number$2,ariaLive:null,ariaModal:booleanish$1,ariaMultiLine:booleanish$1,ariaMultiSelectable:booleanish$1,ariaOrientation:null,ariaOwns:spaceSeparated$2,ariaPlaceholder:null,ariaPosInSet:number$2,ariaPressed:booleanish$1,ariaReadOnly:booleanish$1,ariaRelevant:null,ariaRequired:booleanish$1,ariaRoleDescription:spaceSeparated$2,ariaRowCount:number$2,ariaRowIndex:number$2,ariaRowSpan:number$2,ariaSelected:booleanish$1,ariaSetSize:number$2,ariaSort:null,ariaValueMax:number$2,ariaValueMin:number$2,ariaValueNow:number$2,ariaValueText:null,role:null}});function ariaTransform(K,_){return _==="role"?_:"aria-"+_.slice(4).toLowerCase()}var types$1=types$4,create$1=create_1,caseInsensitiveTransform=caseInsensitiveTransform_1,boolean$1=types$1.boolean,overloadedBoolean=types$1.overloadedBoolean,booleanish=types$1.booleanish,number$1=types$1.number,spaceSeparated$1=types$1.spaceSeparated,commaSeparated$1=types$1.commaSeparated,html$3=create$1({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:caseInsensitiveTransform,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated$1,acceptCharset:spaceSeparated$1,accessKey:spaceSeparated$1,action:null,allow:null,allowFullScreen:boolean$1,allowPaymentRequest:boolean$1,allowUserMedia:boolean$1,alt:null,as:null,async:boolean$1,autoCapitalize:null,autoComplete:spaceSeparated$1,autoFocus:boolean$1,autoPlay:boolean$1,capture:boolean$1,charSet:null,checked:boolean$1,cite:null,className:spaceSeparated$1,cols:number$1,colSpan:null,content:null,contentEditable:booleanish,controls:boolean$1,controlsList:spaceSeparated$1,coords:number$1|commaSeparated$1,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean$1,defer:boolean$1,dir:null,dirName:null,disabled:boolean$1,download:overloadedBoolean,draggable:booleanish,encType:null,enterKeyHint:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean$1,formTarget:null,headers:spaceSeparated$1,height:number$1,hidden:boolean$1,high:number$1,href:null,hrefLang:null,htmlFor:spaceSeparated$1,httpEquiv:spaceSeparated$1,id:null,imageSizes:null,imageSrcSet:commaSeparated$1,inputMode:null,integrity:null,is:null,isMap:boolean$1,itemId:null,itemProp:spaceSeparated$1,itemRef:spaceSeparated$1,itemScope:boolean$1,itemType:spaceSeparated$1,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean$1,low:number$1,manifest:null,max:null,maxLength:number$1,media:null,method:null,min:null,minLength:number$1,multiple:boolean$1,muted:boolean$1,name:null,nonce:null,noModule:boolean$1,noValidate:boolean$1,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforePrint:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextMenu:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean$1,optimum:number$1,pattern:null,ping:spaceSeparated$1,placeholder:null,playsInline:boolean$1,poster:null,preload:null,readOnly:boolean$1,referrerPolicy:null,rel:spaceSeparated$1,required:boolean$1,reversed:boolean$1,rows:number$1,rowSpan:number$1,sandbox:spaceSeparated$1,scope:null,scoped:boolean$1,seamless:boolean$1,selected:boolean$1,shape:null,size:number$1,sizes:null,slot:null,span:number$1,spellCheck:booleanish,src:null,srcDoc:null,srcLang:null,srcSet:commaSeparated$1,start:number$1,step:null,style:null,tabIndex:number$1,target:null,title:null,translate:null,type:null,typeMustMatch:boolean$1,useMap:null,value:booleanish,width:number$1,wrap:null,align:null,aLink:null,archive:spaceSeparated$1,axis:null,background:null,bgColor:null,border:number$1,borderColor:null,bottomMargin:number$1,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean$1,declare:boolean$1,event:null,face:null,frame:null,frameBorder:null,hSpace:number$1,leftMargin:number$1,link:null,longDesc:null,lowSrc:null,marginHeight:number$1,marginWidth:number$1,noResize:boolean$1,noHref:boolean$1,noShade:boolean$1,noWrap:boolean$1,object:null,profile:null,prompt:null,rev:null,rightMargin:number$1,rules:null,scheme:null,scrolling:booleanish,standby:null,summary:null,text:null,topMargin:number$1,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number$1,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean$1,disableRemotePlayback:boolean$1,prefix:null,property:null,results:number$1,security:null,unselectable:null}}),merge$1=merge_1,xlink$2=xlink$3,xml$2=xml$3,xmlns$2=xmlns$3,aria$1=aria$2,html$2=html$3,html_1=merge$1([xml$2,xlink$2,xmlns$2,aria$1,html$2]),types=types$4,create=create_1,caseSensitiveTransform=caseSensitiveTransform_1,boolean=types.boolean,number=types.number,spaceSeparated=types.spaceSeparated,commaSeparated=types.commaSeparated,commaOrSpaceSeparated=types.commaOrSpaceSeparated,svg$3=create({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:caseSensitiveTransform,properties:{about:commaOrSpaceSeparated,accentHeight:number,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number,amplitude:number,arabicForm:null,ascent:number,attributeName:null,attributeType:null,azimuth:number,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number,by:null,calcMode:null,capHeight:number,className:spaceSeparated,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number,diffuseConstant:number,direction:null,display:null,dur:null,divisor:number,dominantBaseline:null,download:boolean,dx:null,dy:null,edgeMode:null,editable:null,elevation:number,enableBackground:null,end:null,event:null,exponent:number,externalResourcesRequired:null,fill:null,fillOpacity:number,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated,g2:commaSeparated,glyphName:commaSeparated,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number,horizOriginX:number,horizOriginY:number,id:null,ideographic:number,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number,k:number,k1:number,k2:number,k3:number,k4:number,kernelMatrix:commaOrSpaceSeparated,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number,overlineThickness:number,paintOrder:null,panose1:null,path:null,pathLength:number,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number,pointsAtY:number,pointsAtZ:number,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated,rev:commaOrSpaceSeparated,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated,requiredFeatures:commaOrSpaceSeparated,requiredFonts:commaOrSpaceSeparated,requiredFormats:commaOrSpaceSeparated,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number,specularExponent:number,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number,strikethroughThickness:number,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number,strokeOpacity:number,strokeWidth:null,style:null,surfaceScale:number,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated,tabIndex:number,tableValues:null,target:null,targetX:number,targetY:number,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated,to:null,transform:null,u1:null,u2:null,underlinePosition:number,underlineThickness:number,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number,values:null,vAlphabetic:number,vMathematical:number,vectorEffect:null,vHanging:number,vIdeographic:number,version:null,vertAdvY:number,vertOriginX:number,vertOriginY:number,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),merge=merge_1,xlink$1=xlink$3,xml$1=xml$3,xmlns$1=xmlns$3,aria=aria$2,svg$2=svg$3,svg_1=merge([xml$1,xlink$1,xmlns$1,aria,svg$2]),normalize=normalize_1,DefinedInfo=definedInfo,Info=info,data="data",find_1=find$1,valid=/^data[-\w.:]+$/i,dash=/-[a-z]/g,cap=/[A-Z]/g;function find$1(K,_){var Z=normalize(_),te=_,ne=Info;return Z in K.normal?K.property[K.normal[Z]]:(Z.length>4&&Z.slice(0,4)===data&&valid.test(_)&&(_.charAt(4)==="-"?te=datasetToProperty(_):_=datasetToAttribute(_),ne=DefinedInfo),new ne(te,_))}function datasetToProperty(K){var _=K.slice(5).replace(dash,camelcase);return data+_.charAt(0).toUpperCase()+_.slice(1)}function datasetToAttribute(K){var _=K.slice(4);return dash.test(_)?K:(_=_.replace(cap,kebab),_.charAt(0)!=="-"&&(_="-"+_),data+_)}function kebab(K){return"-"+K.toLowerCase()}function camelcase(K){return K.charAt(1).toUpperCase()}const classId="classID",dataType="datatype",itemId="itemID",strokeDashArray="strokeDasharray",strokeDashOffset="strokeDashoffset",strokeLineCap="strokeLinecap",strokeLineJoin="strokeLinejoin",strokeMiterLimit="strokeMiterlimit",typeOf="typeof",xLinkActuate="xlinkActuate",xLinkArcRole="xlinkArcrole",xLinkHref="xlinkHref",xLinkRole="xlinkRole",xLinkShow="xlinkShow",xLinkTitle="xlinkTitle",xLinkType="xlinkType",xmlnsXLink="xmlnsXlink",require$$3={classId,dataType,itemId,strokeDashArray,strokeDashOffset,strokeLineCap,strokeLineJoin,strokeMiterLimit,typeOf,xLinkActuate,xLinkArcRole,xLinkHref,xLinkRole,xLinkShow,xLinkTitle,xLinkType,xmlnsXLink};var spaceSeparatedTokens={};spaceSeparatedTokens.parse=parse$2;spaceSeparatedTokens.stringify=stringify$1;var empty$1="",space$1=" ",whiteSpace=/[ \t\n\r\f]+/g;function parse$2(K){var _=String(K||empty$1).trim();return _===empty$1?[]:_.split(whiteSpace)}function stringify$1(K){return K.join(space$1).trim()}var commaSeparatedTokens={};commaSeparatedTokens.parse=parse$1;commaSeparatedTokens.stringify=stringify;var comma=",",space=" ",empty="";function parse$1(K){for(var _=[],Z=String(K||empty),te=Z.indexOf(comma),ne=0,ie=!1,oe;!ie;)te===-1&&(te=Z.length,ie=!0),oe=Z.slice(ne,te).trim(),(oe||!ie)&&_.push(oe),ne=te+1,te=Z.indexOf(comma,ne);return _}function stringify(K,_){var Z=_||{},te=Z.padLeft===!1?empty:space,ne=Z.padRight?space:empty;return K[K.length-1]===empty&&(K=K.concat(empty)),K.join(ne+comma+te).trim()}var COMMENT_REGEX=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,NEWLINE_REGEX=/\n/g,WHITESPACE_REGEX=/^\s*/,PROPERTY_REGEX=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,COLON_REGEX=/^:\s*/,VALUE_REGEX=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,SEMICOLON_REGEX=/^[;\s]*/,TRIM_REGEX=/^\s+|\s+$/g,NEWLINE=`
`,FORWARD_SLASH="/",ASTERISK="*",EMPTY_STRING="",TYPE_COMMENT="comment",TYPE_DECLARATION="declaration",inlineStyleParser=function(K,_){if(typeof K!="string")throw new TypeError("First argument must be a string");if(!K)return[];_=_||{};var Z=1,te=1;function ne(he){var ge=he.match(NEWLINE_REGEX);ge&&(Z+=ge.length);var me=he.lastIndexOf(NEWLINE);te=~me?he.length-me:te+he.length}function ie(){var he={line:Z,column:te};return function(ge){return ge.position=new oe(he),le(),ge}}function oe(he){this.start=he,this.end={line:Z,column:te},this.source=_.source}oe.prototype.content=K;function se(he){var ge=new Error(_.source+":"+Z+":"+te+": "+he);if(ge.reason=he,ge.filename=_.source,ge.line=Z,ge.column=te,ge.source=K,!_.silent)throw ge}function ae(he){var ge=he.exec(K);if(ge){var me=ge[0];return ne(me),K=K.slice(me.length),ge}}function le(){ae(WHITESPACE_REGEX)}function ce(he){var ge;for(he=he||[];ge=fe();)ge!==!1&&he.push(ge);return he}function fe(){var he=ie();if(!(FORWARD_SLASH!=K.charAt(0)||ASTERISK!=K.charAt(1))){for(var ge=2;EMPTY_STRING!=K.charAt(ge)&&(ASTERISK!=K.charAt(ge)||FORWARD_SLASH!=K.charAt(ge+1));)++ge;if(ge+=2,EMPTY_STRING===K.charAt(ge-1))return se("End of comment missing");var me=K.slice(2,ge-2);return te+=2,ne(me),K=K.slice(ge),te+=2,he({type:TYPE_COMMENT,comment:me})}}function de(){var he=ie(),ge=ae(PROPERTY_REGEX);if(ge){if(fe(),!ae(COLON_REGEX))return se("property missing ':'");var me=ae(VALUE_REGEX),Ae=he({type:TYPE_DECLARATION,property:trim(ge[0].replace(COMMENT_REGEX,EMPTY_STRING)),value:me?trim(me[0].replace(COMMENT_REGEX,EMPTY_STRING)):EMPTY_STRING});return ae(SEMICOLON_REGEX),Ae}}function pe(){var he=[];ce(he);for(var ge;ge=de();)ge!==!1&&(he.push(ge),ce(he));return he}return le(),pe()};function trim(K){return K?K.replace(TRIM_REGEX,EMPTY_STRING):EMPTY_STRING}var parse=inlineStyleParser;function StyleToObject(K,_){var Z=null;if(!K||typeof K!="string")return Z;for(var te,ne=parse(K),ie=typeof _=="function",oe,se,ae=0,le=ne.length;ae<le;ae++)te=ne[ae],oe=te.property,se=te.value,ie?_(oe,se,te):se&&(Z||(Z={}),Z[oe]=se);return Z}var styleToObject=StyleToObject;const html$1="http://www.w3.org/1999/xhtml",mathml="http://www.w3.org/1998/Math/MathML",svg$1="http://www.w3.org/2000/svg",xlink="http://www.w3.org/1999/xlink",xml="http://www.w3.org/XML/1998/namespace",xmlns="http://www.w3.org/2000/xmlns/",require$$7={html:html$1,mathml,svg:svg$1,xlink,xml,xmlns};var html=html_1,svg=svg_1,find=find_1,hastToReact=require$$3,spaces=spaceSeparatedTokens,commas=commaSeparatedTokens,style=styleToObject,ns=require$$7,convert$2=convert_1$1,root=convert$2("root"),element=convert$2("element"),text=convert$2("text"),hastToHyperscript=wrapper;function wrapper(K,_,Z){var te=Z||{},ne=react(K),ie=vue(K),oe=vdom(K),se;if(typeof K!="function")throw new Error("h is not a function");if(typeof te=="string"||typeof te=="boolean"?(se=te,te={}):se=te.prefix,root(_))_=_.children.length===1&&element(_.children[0])?_.children[0]:{type:"element",tagName:"div",properties:{},children:_.children};else if(!element(_))throw new Error("Expected root or element, not `"+(_&&_.type||_)+"`");return toH$1(K,_,{schema:te.space==="svg"?svg:html,prefix:se??(ne||ie||oe?"h-":null),key:0,react:ne,vue:ie,vdom:oe,hyperscript:hyperscript(K)})}function toH$1(K,_,Z){var te=Z.schema,ne=te,ie=_.tagName,oe={},se=[],ae=-1,le,ce;te.space==="html"&&ie.toLowerCase()==="svg"&&(ne=svg,Z.schema=ne);for(le in _.properties)addAttribute(oe,le,_.properties[le],Z,ie);if(Z.vdom&&(ne.space==="html"?ie=ie.toUpperCase():oe.namespace=ns[ne.space]),Z.prefix&&(Z.key++,oe.key=Z.prefix+Z.key),_.children)for(;++ae<_.children.length;)ce=_.children[ae],element(ce)?se.push(toH$1(K,ce,Z)):text(ce)&&se.push(ce.value);return Z.schema=te,se.length?K.call(_,ie,oe,se):K.call(_,ie,oe)}function addAttribute(K,_,Z,te,ne){var ie=find(te.schema,_),oe;Z==null||Z!==Z||Z===!1&&(te.vue||te.vdom||te.hyperscript)||!Z&&ie.boolean&&(te.vue||te.vdom||te.hyperscript)||(Z&&typeof Z=="object"&&"length"in Z&&(Z=(ie.commaSeparated?commas:spaces).stringify(Z)),ie.boolean&&te.hyperscript&&(Z=""),ie.property==="style"&&typeof Z=="string"&&(te.react||te.vue||te.vdom)&&(Z=parseStyle(Z,ne)),te.vue?ie.property!=="style"&&(oe="attrs"):ie.mustUseProperty||(te.vdom?ie.property!=="style"&&(oe="attributes"):te.hyperscript&&(oe="attrs")),oe?(K[oe]||(K[oe]={}),K[oe][ie.attribute]=Z):ie.space&&te.react?K[hastToReact[ie.property]||ie.property]=Z:K[ie.attribute]=Z)}function react(K){var _=K&&K("div");return!!(_&&("_owner"in _||"_store"in _)&&_.key==null)}function hyperscript(K){return!!(K&&K.context&&K.cleanup)}function vdom(K){return K&&K("div").type==="VirtualNode"}function vue(K){var _=K&&K("div");return!!(_&&_.context&&_.context._isVue)}function parseStyle(K,_){var Z={};try{style(K,te)}catch(ne){throw ne.message=_+"[style]"+ne.message.slice(9),ne}return Z;function te(ne,ie){ne.slice(0,4)==="-ms-"&&(ne="ms-"+ne.slice(4)),Z[ne.replace(/-([a-z])/g,styleReplacer)]=ie}}function styleReplacer(K,_){return _.toUpperCase()}var convert_1=convert$1;function convert$1(K){if(typeof K=="string")return typeFactory(K);if(K==null)return ok;if(typeof K=="object")return("length"in K?anyFactory:matchesFactory)(K);if(typeof K=="function")return K;throw new Error("Expected function, string, or object as test")}function convertAll(K){for(var _=[],Z=K.length,te=-1;++te<Z;)_[te]=convert$1(K[te]);return _}function matchesFactory(K){return _;function _(Z){var te;for(te in K)if(Z[te]!==K[te])return!1;return!0}}function anyFactory(K){var _=convertAll(K),Z=_.length;return te;function te(){for(var ne=-1;++ne<Z;)if(_[ne].apply(this,arguments))return!0;return!1}}function typeFactory(K){return _;function _(Z){return!!(Z&&Z.type===K)}}function ok(){return!0}var unistUtilVisitParents=visitParents$1,convert=convert_1,CONTINUE$1=!0,SKIP$1="skip",EXIT$1=!1;visitParents$1.CONTINUE=CONTINUE$1;visitParents$1.SKIP=SKIP$1;visitParents$1.EXIT=EXIT$1;function visitParents$1(K,_,Z,te){var ne;typeof _=="function"&&typeof Z!="function"&&(te=Z,Z=_,_=null),ne=convert(_),ie(K,null,[]);function ie(se,ae,le){var ce=[],fe;return(!_||ne(se,ae,le[le.length-1]||null))&&(ce=toResult(Z(se,le)),ce[0]===EXIT$1)?ce:se.children&&ce[0]!==SKIP$1?(fe=toResult(oe(se.children,le.concat(se))),fe[0]===EXIT$1?fe:ce):ce}function oe(se,ae){for(var le=-1,ce=te?-1:1,fe=(te?se.length:le)+ce,de;fe>le&&fe<se.length;){if(de=ie(se[fe],fe,ae),de[0]===EXIT$1)return de;fe=typeof de[1]=="number"?de[1]:fe+ce}}}function toResult(K){return K!==null&&typeof K=="object"&&"length"in K?K:typeof K=="number"?[CONTINUE$1,K]:[K]}var unistUtilVisit=visit$1,visitParents=unistUtilVisitParents,CONTINUE=visitParents.CONTINUE,SKIP=visitParents.SKIP,EXIT=visitParents.EXIT;visit$1.CONTINUE=CONTINUE;visit$1.SKIP=SKIP;visit$1.EXIT=EXIT;function visit$1(K,_,Z,te){typeof _=="function"&&typeof Z!="function"&&(te=Z,Z=_,_=null),visitParents(K,_,ne,te);function ne(ie,oe){var se=oe[oe.length-1],ae=se?se.children.indexOf(ie):null;return Z(ie,ae,se)}}var visit=unistUtilVisit,hasOwnProperty=Object.prototype.hasOwnProperty,hastCssPropertyMap={align:"text-align",valign:"vertical-align",height:"height",width:"width"},hastUtilTableCellStyle=function K(_){return visit(_,"element",visitor),_};function visitor(K){if(!(K.tagName!=="tr"&&K.tagName!=="td"&&K.tagName!=="th")){var _,Z;for(_ in hastCssPropertyMap)!hasOwnProperty.call(hastCssPropertyMap,_)||K.properties[_]===void 0||(Z=hastCssPropertyMap[_],appendStyle(K,Z,K.properties[_]),delete K.properties[_])}}function appendStyle(K,_,Z){var te=(K.properties.style||"").trim();te&&!/;\s*/.test(te)&&(te+=";"),te&&(te+=" ");var ne=te+_+": "+Z+";";K.properties.style=ne}var toH=hastToHyperscript,tableCellStyle=hastUtilTableCellStyle,rehypeReact_1=rehypeReact,own={}.hasOwnProperty,tableElements=new Set(["table","thead","tbody","tfoot","tr","th","td"]);function rehypeReact(K){var _=K||{},Z=_.createElement;this.Compiler=te;function te(ie){var oe=toH(ne,tableCellStyle(ie),_.prefix);return ie.type==="root"?(oe=oe.type==="div"&&(ie.children.length!==1||ie.children[0].type!=="element")?oe.props.children:[oe],Z(_.Fragment||"div",{},oe)):oe}function ne(ie,oe,se){var ae=ie;return se&&tableElements.has(ie)&&(se=se.filter(function(le){return le!==`
`})),_.components&&own.call(_.components,ie)&&(ae=_.components[ie],_.passNode&&(oe.node=this)),Z(ae,oe,se)}}const rehypeReact$1=getDefaultExportFromCjs(rehypeReact_1);function _extends(){return _extends=Object.assign||function(K){for(var _=1;_<arguments.length;_++){var Z=arguments[_];for(var te in Z)Object.prototype.hasOwnProperty.call(Z,te)&&(K[te]=Z[te])}return K},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(K,_){if(K==null)return{};var Z={},te=Object.keys(K),ne,ie;for(ie=0;ie<te.length;ie++)ne=te[ie],!(_.indexOf(ne)>=0)&&(Z[ne]=K[ne]);return Z}var _excluded=["children"],useRemark=function K(_){var Z=_===void 0?{}:_,te=Z.remarkParseOptions,ne=Z.remarkToRehypeOptions,ie=Z.rehypeReactOptions,oe=Z.remarkPlugins,se=oe===void 0?[]:oe,ae=Z.rehypePlugins,le=ae===void 0?[]:ae,ce=Z.onError,fe=ce===void 0?function(){}:ce,de=reactExports.useState(null),pe=de[0],he=de[1],ge=reactExports.useCallback(function(me){unified$1().use(remarkParse$1,te).use(se).use(remarkToRehype,ne).use(le).use(rehypeReact$1,_extends({createElement:reactExports.createElement,Fragment:reactExports.Fragment},ie)).process(me).then(function(Ae){return he(Ae.result)}).catch(fe)},[]);return[pe,ge]},Remark=function K(_){var Z=_.children,te=_objectWithoutPropertiesLoose(_,_excluded),ne=useRemark(te),ie=ne[0],oe=ne[1];return reactExports.useEffect(function(){oe(Z)},[Z,oe]),ie};function Markdown({_key:K,children:_,style:Z,...te}){const{markdown:ne}=reactExports.useMemo(()=>({markdown:typeof _=="string"?_:_.join(" ")}),[_,Z]);return jsxRuntimeExports.jsx(Remark,{rehypePlugins:[rehypeRaw],remarkToRehypeOptions:{allowDangerousHtml:!0},...te,children:ne})}function TimelineControls({_key:K,start:_=0,end:Z,stepSize:te=1,play:ne=!1}){const{sendMsg:ie}=useSocket(),{clock:oe}=useThree();reactExports.useEffect(()=>ne?oe.start():oe.stop(),[]);const se=reactExports.useCallback(fe=>{const de={etype:"TIMELINE_STEP",key:K,value:{step:fe,elapsedTime:oe.getElapsedTime(),delta:oe.getDelta()}};try{ie(de)}catch{return}},[]),ae=useControls("Timeline",{stepSize:{value:te,min:-5,max:10,step:.5}},[]),[le,ce]=useControls("Timeline",()=>({step:{value:0,min:_,max:Z,step:ae.stepSize,onChange:fe=>{typeof fe>"u"||se(fe)},transient:!1},frameRate:{value:30,min:1,max:240,step:1},play:button(()=>{oe.running?oe.stop():oe.start()},{label:function(){return oe.running?"Pause":"Play"}})}),[ae.stepSize]);return reactExports.useEffect(()=>{if(le.frameRate<=0)return;const fe=setInterval(()=>{oe.running&&(le.step+=1,ce({step:le.step}),se(le.step))},1e3/le.frameRate);return()=>{clearInterval(fe)}},[oe,le,le.frameRate]),null}const LumaSplats=React.lazy(()=>__vitePreload(()=>import("./chunk-Bazdu1RU.js"),__vite__mapDeps([4,3,1,2]))),SparkSplats=React.lazy(()=>__vitePreload(()=>import("./chunk-C92vmGZt.js"),__vite__mapDeps([5,1,2,3]))),container="_container_5gc8u_1",primaryStyle$1="_primaryStyle_5gc8u_10",resizable="_resizable_5gc8u_15",resizableInner="_resizableInner_5gc8u_36";function Resizable({_key:K,children:[_,Z],vertical:te=!1,offset:ne=0,hidden:ie=!1,defaultSize:oe=1}){const se=ne<0,ae=reactExports.useRef(null),[le,ce]=reactExports.useState({size:se?1-oe:oe,isHidden:ie}),fe=te?"width":"height",de=te?"x":"y";reactExports.useEffect(()=>{ie!==null&&ce({...le,isHidden:ie})},[ie]);const pe=le.isHidden?"100%":`calc(${le.size*100}% - ${Math.abs(ne)}px)`,he=le.isHidden?null:jsxRuntimeExports.jsx("div",{className:resizableInner,children:Z}),ge=jsxRuntimeExports.jsx("div",{className:primaryStyle$1,style:{flexShrink:le.isHidden?0:1,height:te?"100%":pe,width:te?pe:"100%"},children:_});return jsxRuntimeExports.jsxs("div",{ref:ae,className:container,style:{flexDirection:te?"row":"column"},children:[se?he:ge,jsxRuntimeExports.jsx("div",{className:resizable,style:{width:te?"16px":"auto",height:te?"auto":"16px",cursor:te?"ew-resize":"ns-resize",padding:te?"0 7px":"7px 0",margin:te?"0 -7px":"-7px 0"},onPointerDown:me=>{me.currentTarget.setPointerCapture(me.pointerId)},onPointerMove:me=>{const Ae=me.currentTarget;if(ae.current&&Ae.hasPointerCapture(me.pointerId)){const ye=ae.current.getBoundingClientRect(),ve=(me[de]||me[`client${de.toUpperCase()}`])-ye[de],_e=se?ve<-ne/2:ye[fe]-ve<ne/2,Te=se?ye[fe]-ve:ve,be=clamp((Te+Math.abs(ne))/ye[fe],0,1);ce({size:be,isHidden:_e})}},onPointerUp:me=>{me.currentTarget.releasePointerCapture(me.pointerId)}}),se?ge:he]})}const containerStyle="_containerStyle_iy53z_1",primaryStyle="_primaryStyle_iy53z_10",panelContainerStyle="_panelContainerStyle_iy53z_15",shrunkStyle="_shrunkStyle_iy53z_36",panelStyle="_panelStyle_iy53z_43";function ResizableSwitch({_key:K,style:_={},children:[Z,te,ne],vertical:ie=!1,offset:oe=0,minOffset:se=0,hidden:ae=null}){const le=oe<0,ce=reactExports.useRef(null),[fe,de]=reactExports.useState({size:le?1:0,isHidden:ae}),pe=ie?"width":"height",he=ie?"x":"y";reactExports.useEffect(()=>{ae!==null&&de({...fe,isHidden:ae})},[ae]);const ge=fe.isHidden?`calc(100% - ${se}px)`:`calc(${fe.size*100}% - ${Math.abs(oe)}px)`;return jsxRuntimeExports.jsxs("div",{ref:ce,className:containerStyle,style:{flexDirection:ie?"row":"column",..._},children:[jsxRuntimeExports.jsx("div",{className:primaryStyle,style:{flexShrink:fe.isHidden?0:1,height:ie?"100%":ge,width:ie?ge:"100%"},children:Z}),jsxRuntimeExports.jsx("div",{className:panelContainerStyle,style:{width:ie?"16px":"auto",height:ie?"auto":"16px",cursor:ie?"ew-resize":"ns-resize",padding:ie?"0 7px":"7px 0",margin:ie?"0 -7px":"-7px 0"},onPointerDown:me=>{me.currentTarget.setPointerCapture(me.pointerId)},onPointerMove:me=>{if(ce.current&&me.currentTarget.hasPointerCapture(me.pointerId)){const Ae=ce.current.getBoundingClientRect(),ye=(me[he]||me[`client${he.toUpperCase()}`])-Ae[he],ve=le?ye<-oe/2:Ae[pe]-ye<oe/2,_e=le?Ae[pe]-ye:ye,Te=clamp((_e+Math.abs(oe))/Ae[pe],0,1);de({size:Te,isHidden:ve})}},onPointerUp:me=>{me.currentTarget.releasePointerCapture(me.pointerId)}}),fe.isHidden?jsxRuntimeExports.jsx("div",{className:shrunkStyle,children:ne}):jsxRuntimeExports.jsx("div",{className:panelStyle,children:te})]})}const listName="_listName_1s0ny_1",simpleContext=reactExports.createContext({value:!1}),SimpleProvider=({children:K})=>jsxRuntimeExports.jsx(simpleContext.Provider,{value:{value:!0},children:K}),useSimple=()=>reactExports.useContext(simpleContext),SimpleComponent=()=>{const K=useSimple();return console.log("Simple:",K),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Helmet,{children:jsxRuntimeExports.jsx("title",{children:"Simple Helmet works"})}),jsxRuntimeExports.jsx("h1",{className:listName,children:"Simple Component"}),jsxRuntimeExports.jsx("p",{children:K!=null&&K.value?"This is cool!":"context value did not load"})]})},VUER=Object.freeze(Object.defineProperty({__proto__:null,ALL_SCENE_KEYS,AccumulativeShadows,AdaptiveDpr,AdaptiveEvents,AddOp,AmbientLight,AmbientLightStage,AnnotatedPivotControls,AppContext,AppProvider,Arrow,AsciiRenderer,AutoScroll,BBAnchor,BBox,Backdrop,BakeShadows,Billboard,Bounds,Box,Button,Bvh,CONTRIB_COMPONENT_LIST,CONTRIB_MODULE_ENTRYPOINTS,Camera,CameraShake,CameraView,Capsule,CatmullRomLine,Caustics,Center,ChildrenKey,Circle,Clone,Cloud,Combine,ComputedAttribute,Cone,ContactShadows,ContribLoader,CoordsMarker,CubicBezierLine,CurveModifier,CycleRaycast,Cylinder,Dae,Decal,Detailed,DirectionalLight,Div,Dodecahedron,Edges,Effects,Environment,EventEmitter,Extrude,FIBER,FILE_REGISTER,FaceLandmarker,Facemesh,FileDropContainer,Fisheye,Float,Frustum,Fuse,Gamepad,Glb,Gltf:Glb,GrabRender,GradientTexture,GraphView,Grid,Gripper,HAND_MODEL_JOINT_KEYS,HUDPlane,Hands,HandsView,HemisphereLight,HemisphereLightStage,Html,Hud,Icosahedron,Image:Image$1,ImageBackground,ImagePlane,ImageUpload,Img,Input,Instances,LEVA,Lathe,Lightformer,Line,LumaSplats,MarchingCubes,Markdown,Mask,Merged,MeshDiscardMaterial,MeshDistortMaterial,MeshPortalMaterial,MeshReflectorMaterial,MeshRefractionMaterial,MeshTransmissionMaterial,MeshWobbleMaterial,MotionControllers,Movable,NodeItem,NodeList,Obj,Octahedron,Outlines,Pcd,PerformanceMonitor,Pivot,PivotXR,Plane,Playback,PlaybackBar,PlaybackContext,PlaybackControls,PlaybackProvider,PlaybackStateContext,PlaybackStateProvider,Playhead,Ply,PointCloud,PointLight,PointMaterial,Pointer,PointerControls,Points,Polyhedron,PositionalAudio,Preload,QuadraticBezierLine,RandomizedLight,Range,RectAreaLight,RemoveOp,Render,RenderCubeTexture,RenderLayer,RenderTexture,Resizable,ResizableSwitch,Resize,Ring,RoundedBox,Sampler,Scene,SceneBackground,SceneContainer,SceneFileDropContainer,ScreenQuad,ScreenSpace,Segments,Select:Select$2,SetOp,Shadow,Shape,SimpleComponent,SimpleProvider,SkeletalGripper,Sky,Slider,SocketContext,SoftShadows,Span,SparkSplats,Sparkles,Sphere,Splat:VuerSplat,SpotLight,SpotLightShadow,SpriteAnimator,Stage,Stars,StereoVideoPlane,Stl,Store,Svg:Svg$1,THREE,Tetrahedron,Text,Text3D,Timeline,TimelineControls,TimelineFileDrop,TimelineStateContext,TimelineStateProvider,TimeoutOp,Timestamp,Torus,TorusKnot,Trail,TriMesh,Tube,UpdateOp,UpsertOp,Urdf,VideoPlane,View,VuerGroup,VuerRoot,WebRTCStereoVideoPlane,WebRTCVideoPlane,WebSocketProvider,Wireframe,XrMovableAnchor,XrMovableLocal,XrMovableMimic,ZUSTAND,addNode,controllerState,findByKey,getLandmark,getState,handState,imageToBase64,l2,list2menu,mat2Pos,removeByKey,resetGlobalLoader,sentinel,transposeTuple,updateNode,upsertNode,useMotionControllerState,usePlayback,usePlaybackStates,useSceneStore,useSimple,useSocket,useSourceState,useTimelineStates},Symbol.toStringTag,{value:"Module"}));export{CylinderGeometry as $,AppProvider as A,useFrame as B,Combine as C,DefaultLoadingManager as D,Euler as E,FIBER as F,GraphView as G,HemisphereLightStage as H,context$8 as I,MathUtils as J,EventDispatcher as K,LEVA as L,MotionControllers as M,Raycaster as N,Object3D as O,PlaybackProvider as P,Quaternion as Q,Resizable as R,SceneFileDropContainer as S,THREE as T,MeshBasicMaterial as U,VUER as V,WebSocketProvider as W,DoubleSide as X,LineBasicMaterial as Y,ZUSTAND as Z,_extends$3 as _,Leva as a,UnsignedShortType as a$,BoxGeometry as a0,BufferGeometry as a1,Float32BufferAttribute as a2,Mesh as a3,Line$2 as a4,PlaneGeometry as a5,OctahedronGeometry as a6,SphereGeometry as a7,TorusGeometry as a8,MOUSE as a9,Skeleton as aA,AmbientLight$1 as aB,Uint16BufferAttribute as aC,AnimationClip as aD,VectorKeyframeTrack as aE,QuaternionKeyframeTrack as aF,NumberKeyframeTrack as aG,UV1 as aH,calculateScaleFactor as aI,useLoader as aJ,Clone as aK,GLTFLoader$1 as aL,DRACOLoader as aM,MapControls as aN,extend$6 as aO,CurvePath as aP,useInstanceHandle as aQ,CatmullRomCurve3 as aR,CubeTextureLoader as aS,IsObject as aT,KTX2Loader as aU,suspend$1 as aV,VideoTexture as aW,addEffect as aX,addAfterEffect as aY,DepthTexture as aZ,DepthFormat as a_,Group as aa,Box3 as ab,Sphere$2 as ac,EllipseCurve as ad,PerspectiveCamera$2 as ae,OrthographicCamera$1 as af,GridHelper as ag,Curve as ah,Loader as ai,LoaderUtils as aj,FileLoader as ak,TextureLoader as al,unzlibSync as am,decodeText$1 as an,RepeatWrapping as ao,ClampToEdgeWrapping as ap,Texture$1 as aq,MeshPhongMaterial as ar,MeshLambertMaterial as as,EquirectangularReflectionMapping as at,Bone as au,PropertyBinding as av,PointLight$1 as aw,SpotLight$2 as ax,DirectionalLight$1 as ay,SkinnedMesh as az,usePlayback as b,GizmoViewport as b$,useFBO as b0,applyProps as b1,Camera$1 as b2,AnimationMixer as b3,ShaderChunk as b4,Center as b5,Text3D as b6,useTexture as b7,shaderMaterial as b8,BufferAttribute as b9,Cone$1 as bA,ContactShadows as bB,CubeCamera as bC,CubicBezierLine as bD,CurveModifier as bE,CycleRaycast as bF,Cylinder$1 as bG,Decal as bH,Detailed as bI,Dodecahedron$1 as bJ,Edges$1 as bK,Effects as bL,Environment as bM,EnvironmentCube as bN,EnvironmentMap as bO,EnvironmentPortal as bP,Extrude$1 as bQ,FaceLandmarker as bR,FaceLandmarkerDefaults as bS,FacemeshDatas as bT,FacemeshEye as bU,FacemeshEyeDefaults as bV,Fbo as bW,Fisheye as bX,Float as bY,GizmoHelper as bZ,GizmoViewcube as b_,RGBADepthPacking as ba,Ray as bb,clear$1 as bc,useFaceLandmarker as bd,EventDispatcher$1 as be,Facemesh as bf,AccumulativeShadows as bg,AdaptiveDpr as bh,AdaptiveEvents as bi,AsciiRenderer as bj,BBAnchor as bk,Backdrop as bl,BakeShadows as bm,Billboard as bn,Bounds as bo,Box$1 as bp,Bvh as bq,CameraShake as br,Capsule$1 as bs,CatmullRomLine as bt,Caustics as bu,Circle$1 as bv,Cloud as bw,CloudInstance as bx,Clouds as by,ComputedAttribute as bz,useSocket as c,Sphere$1 as c$,GradientTexture as c0,GradientType as c1,Grid$1 as c2,Helper as c3,Html as c4,Hud as c5,Icosahedron$1 as c6,Image$1 as c7,Instance as c8,InstancedAttribute as c9,PointMaterialImpl as cA,Points as cB,PointsBuffer as cC,Polyhedron$1 as cD,PositionMesh as cE,PositionPoint as cF,PositionalAudio as cG,Preload as cH,QuadraticBezierLine as cI,RandomizedLight as cJ,RenderCubeTexture as cK,RenderTexture as cL,Resize as cM,Ring$1 as cN,RoundedBox as cO,Sampler as cP,ScreenQuad as cQ,ScreenSpace as cR,Segment as cS,SegmentObject as cT,Segments as cU,Select$2 as cV,Shadow as cW,Shape$1 as cX,Sky as cY,SoftShadows as cZ,Sparkles as c_,Instances as ca,Lathe$1 as cb,Lightformer as cc,Line$1 as cd,MarchingCube as ce,MarchingCubes as cf,MarchingPlane as cg,Mask as ch,Merged as ci,MeshDiscardMaterial as cj,MeshDistortMaterial as ck,MeshPortalMaterial as cl,MeshReflectorMaterial as cm,MeshRefractionMaterial as cn,MeshTransmissionMaterial as co,MeshWobbleMaterial as cp,Octahedron$1 as cq,OrbitControls as cr,OrthographicCamera as cs,Outlines as ct,PerformanceMonitor as cu,PerspectiveCamera$1 as cv,PivotControls as cw,Plane$1 as cx,Point as cy,PointMaterial as cz,SceneContainer as d,RootCombinedPointer as d$,Splat as d0,SpotLight$1 as d1,SpotLightShadow as d2,SpriteAnimator as d3,Stage as d4,Stars as d5,Svg$1 as d6,Tetrahedron$1 as d7,Text as d8,Texture as d9,useTrail as dA,isFacingCamera as dB,useXRSessionModeSupported as dC,useXRSessionVisibilityState as dD,useXRStore as dE,requestXRAnchor as dF,createXRControllerLocomotionUpdate as dG,forwardHtmlEvents as dH,ARButton as dI,CombinedPointer as dJ,DefaultXRController as dK,DefaultXRControllerGrabPointer as dL,DefaultXRGaze as dM,DefaultXRHand as dN,DefaultXRHandGrabPointer as dO,DefaultXRHandTouchPointer as dP,DefaultXRInputSourceRayPointer as dQ,DefaultXRInputSourceTeleportPointer as dR,DefaultXRScreenInput as dS,DefaultXRTransientPointer as dT,FallbackXRLayerImplementation as dU,IfInSessionMode as dV,Interactive as dW,NotInXR as dX,PointerCursorModel as dY,PointerRayModel as dZ,RayGrab as d_,Torus$1 as da,TorusKnot$1 as db,Trail as dc,Tube$1 as dd,View as de,accumulativeContext as df,calcPosFromAngles as dg,checkIfFrameIsEmpty as dh,createInstances as di,getFirstFrame as dj,isWebGL2Available as dk,useBVH as dl,useBounds as dm,useCubeCamera as dn,useEnvironment as dp,useFont as dq,useGizmoContext as dr,useHelper as ds,useIntersect as dt,useMask as du,usePerformanceMonitor as dv,useSelect as dw,useSpriteAnimator as dx,useSpriteLoader as dy,useSurfaceSampler as dz,ContribLoader as e,useXRSpace as e$,ShowIfInSessionMode as e0,TeleportPointerRayModel as e1,TeleportTarget as e2,UNSAFE_useXRStore as e3,VRButton as e4,XR as e5,XRButton$1 as e6,XRControllerComponent as e7,XRControllerModel as e8,XRDomOverlay as e9,useLoadXRControllerLayout as eA,useLoadXRControllerModel as eB,usePointerXRInputSourceEvents as eC,useRayPointer as eD,useSessionFeatureEnabled as eE,useSessionModeSupported as eF,useTouchPointer as eG,useXR as eH,useXRControllerButtonEvent as eI,useXRControllerState as eJ,useXREvent as eK,useXRGazeState as eL,useXRHandState as eM,useXRHitTest as eN,useXRHitTestSource as eO,useXRInputSourceEvent as eP,useXRInputSourceState as eQ,useXRInputSourceStateContext as eR,useXRInputSourceStates as eS,useXRMeshGeometry as eT,useXRMeshes as eU,useXRPlaneGeometry as eV,useXRPlanes as eW,useXRReferenceSpace as eX,useXRRequestHitTest as eY,useXRScreenInputState as eZ,useXRSessionFeatureEnabled as e_,XRHandJoint as ea,XRHandModel as eb,XRHitTest as ec,XRLayer as ed,XRLayerImplementation as ee,XRMeshModel as ef,XROrigin as eg,XRPlaneModel as eh,XRSpace$1 as ei,createXRHitTestSource as ej,createXRStore as ek,defaultGrabPointerOpacity as el,defaultRayPointerOpacity as em,defaultTouchPointerOpacity as en,isAppleVisionPro as eo,isXRInputSourceState as ep,privateKeys as eq,requestXRHitTest as er,useApplyXRSpaceMatrix as es,useGetXRSpaceMatrix as et,useGrabPointer as eu,useHover as ev,useInitRoomCapture as ew,useInteraction as ex,useLayerStore as ey,useLinesPointer as ez,Grid as f,useXRTransientPointerState as f0,SimpleProvider as f1,SimpleComponent as f2,DataArrayTexture as f3,RGIntegerFormat as f4,UnsignedIntType as f5,RGBAIntegerFormat as f6,WebGLArrayRenderTarget as f7,NearestFilter as f8,DataTexture as f9,HalfFloatType as fA,CubeTexture as fB,MeshNormalMaterial as fC,GLBufferAttribute as fD,LinearMipmapLinearFilter as fE,Uniform as fF,BackSide as fG,OneMinusSrcAlphaFactor as fH,OneFactor as fI,AddEquation as fJ,CustomBlending as fK,NoBlending as fL,FrontSide as fM,UniformsLib as fN,RawShaderMaterial as fa,GLSL3 as fb,Matrix2 as fc,Scene$1 as fd,ShaderMaterial as fe,NormalBlending as ff,Clock as fg,WebGLCubeRenderTarget as fh,LinearMipMapLinearFilter as fi,RGBAFormat as fj,CubeCamera$1 as fk,PMREMGenerator as fl,MeshStandardMaterial as fm,UnsignedByteType as fn,InstancedBufferGeometry as fo,InstancedBufferAttribute as fp,DynamicDrawUsage as fq,WebGLRenderTarget as fr,SRGBColorSpace$2 as fs,PropTypes as ft,clamp$1 as fu,LineSegments as fv,StaticDrawUsage as fw,IntType as fx,UVMapping as fy,NoColorSpace$1 as fz,Hands as g,ResizableSwitch as h,PlaybackStateProvider as i,TimelineStateProvider as j,PlaybackBar as k,TimelineFileDrop as l,Timeline as m,VuerRoot as n,create$d as o,useThree as p,useGesture as q,Vector2 as r,Vector3 as s,Plane$2 as t,useSceneStore as u,Matrix4 as v,Matrix3 as w,Spherical as x,Vector4 as y,Color$1 as z};
//# sourceMappingURL=chunk-Dd3xtWba.js.map
